\def\funccolor{yellow!25}
\def\opcolor{red!25}
\def\boxcolor{black!15}

\begin{tikzpicture}[
    myvec/.style={},
    myfunc/.style={draw, rectangle, rounded corners, align=center, text centered, fill=\funccolor},
    myop/.style={draw, circle, align=center, text centered, fill=\opcolor},
    mybox/.style={ultra thick, rounded corners, fill=\boxcolor},
    myline/.style={->, ultra thick, rounded corners}
]

    \def\xlstm{0}
    \def\ylstm{0}
    \def\dx{2.0}
    \def\dy{1.25}
    \def\topborder{.75}
    \def\botborder{1.5}
    \def\outxborder{1.5}
    \def\outbotborder{1.0}
    \def\xhigh{6*\dx}
    \def\yhigh{\botborder+4*\dy+\topborder}

    \def\colx{green} % input features line colour
    \def\colh{blue}  % hidden state line colour
    \def\colc{red}   % cell state line colour
    \def\coll{black} % regular line colour

    \draw[mybox] ($(\xlstm, \ylstm) + (0, 0)$) rectangle ++(\xhigh,\yhigh);


    \node[myvec] (ct0) at ($(\xlstm-\outxborder, \ylstm+\botborder+4*\dy)$) {$\vec{c}_{t-1}$};
    \node[myvec] (ht0) at ($(\xlstm-\outxborder, \ylstm+.5*\botborder)$) {$\vec{h}_{t-1}$};
    \node[myvec] (xt1) at ($(\xlstm+.5*\dx, \ylstm-\outbotborder)$) {$\vec{x}_{t}$};
    \coordinate[] (tmpx) at ($(\xlstm+\dx, \ylstm+.25*\botborder)$) {};

    \node[myvec] (ct1) at ($(\xlstm+\xhigh+\outxborder, \ylstm+\yhigh-\topborder)$) {$\vec{c}_{t}$};
    \node[myvec] (ht1) at ($(\xlstm+\xhigh+\outxborder, \ylstm+.5*\botborder)$) {$\vec{h}_{t}$};
    \node[myvec] (OUT) at ($(\xlstm+\xhigh+\outxborder, \ylstm-\outbotborder)$) {};

    \node[myfunc] (wcf) at ($(\xlstm+1*\dx, \ylstm+\botborder+0*\dy)$) {W.Comb.};
    \node[myfunc] (wci) at ($(\xlstm+2*\dx, \ylstm+\botborder+0*\dy)$) {W.Comb.};
    \node[myfunc] (wcc) at ($(\xlstm+3*\dx, \ylstm+\botborder+0*\dy)$) {W.Comb.};
    \node[myfunc] (wco) at ($(\xlstm+4*\dx, \ylstm+\botborder+0*\dy)$) {W.Comb.};

    \node[myfunc] (ff) at ($(\xlstm+1*\dx, \ylstm+\botborder+1*\dy)$) {sigmoid};
    \node[myfunc] (fi) at ($(\xlstm+2*\dx, \ylstm+\botborder+1*\dy)$) {sigmoid};
    \node[myfunc] (fc) at ($(\xlstm+3*\dx, \ylstm+\botborder+1*\dy)$) {tanh};
    \node[myfunc] (fo) at ($(\xlstm+4*\dx, \ylstm+\botborder+1*\dy)$) {sigmoid};
    \node[myfunc] (fh) at ($(\xlstm+5*\dx, \ylstm+\botborder+3*\dy)$) {tanh};

    \node[myvec] (gf) at ($(\xlstm+1*\dx, \ylstm+\botborder+2*\dy)$) {$\myvecw{g}{f}_t$};
    \node[myvec] (gi) at ($(\xlstm+2*\dx, \ylstm+\botborder+2*\dy)$) {$\myvecw{g}{i}_t$};
    \node[myvec] (gc) at ($(\xlstm+3*\dx, \ylstm+\botborder+2*\dy)$) {$\myvecw{g}{c}_t$};
    \node[myvec] (go) at ($(\xlstm+4*\dx, \ylstm+\botborder+2*\dy)$) {$\myvecw{g}{o}_t$};

    \node[myop] (mul1) at ($(\xlstm+1*\dx, \ylstm+\botborder+4*\dy)$) {$\odot$};
    \node[myop] (mul2) at ($(\xlstm+2.5*\dx, \ylstm+\botborder+3*\dy)$) {$\odot$};
    \node[myop] (mul3) at ($(\xlstm+5*\dx, \ylstm+\botborder+2*\dy)$) {$\odot$};
    \node[myop] (sum1) at ($(\xlstm+2.5*\dx, \ylstm+\botborder+4*\dy)$) {$+$};

    % lines from/to c
    \draw[myline, color=\colc] (ct0) -- (mul1);
    \draw[myline, color=\colc] (sum1) -- (ct1);
    \draw[myline, color=\colc] (sum1) -| (fh);

    % lines from/to h
    \draw[myline, color=\colh] (ht0) -| ($(wcf.south)-(.5,0)$);
    \draw[myline, color=\colh] (ht0) -| ($(wci.south)-(.5,0)$);
    \draw[myline, color=\colh] (ht0) -| ($(wcc.south)-(.5,0)$);
    \draw[myline, color=\colh] (ht0) -| ($(wco.south)-(.5,0)$);
    \draw[myline, color=\colh] (mul3) |- (ht1);
    \draw[myline, color=\colh] (ht1) -- (OUT);

    % lines from x
    \draw[myline, color=\colx] (xt1) |- (tmpx) -| ($(wcf.south)+(.5,0)$);
    \draw[myline, color=\colx] (xt1) |- (tmpx) -| ($(wci.south)+(.5,0)$);
    \draw[myline, color=\colx] (xt1) |- (tmpx) -| ($(wcc.south)+(.5,0)$);
    \draw[myline, color=\colx] (xt1) |- (tmpx) -| ($(wco.south)+(.5,0)$);

    % lines from wcomb to functions
    \draw[myline, color=\coll] (wcf) -- (ff);
    \draw[myline, color=\coll] (wci) -- (fi);
    \draw[myline, color=\coll] (wcc) -- (fc);
    \draw[myline, color=\coll] (wco) -- (fo);

    % lines from intermediate functions to operators
    \draw[myline, color=\coll] (ff) -- (gf) -- (mul1);
    \draw[myline, color=\coll] (fi) -- (gi) |- (mul2);
    \draw[myline, color=\coll] (fc) -- (gc) |- (mul2);
    \draw[myline, color=\coll] (fo) -- (go) -- (mul3);

    % other inner lines
    \draw[myline, color=\coll] (mul1) -- (sum1);
    \draw[myline, color=\coll] (mul2) -- (sum1);
    \draw[myline, color=\coll] (fh) -- (mul3);

    % Outer lines
    \draw[myline, color=\colc, dashed] ($(ct0)-(\outxborder, 0)$) -- (ct0);
    \draw[myline, color=\colc, dashed] (ct1) -- ($(ct1)+(\outxborder, 0)$);
    \draw[myline, color=\colh, dashed] ($(ht0)-(\outxborder, 0)$) -- (ht0);
    \draw[myline, color=\colh, dashed] (ht1) -- ($(ht1)+(\outxborder, 0)$);
\end{tikzpicture}
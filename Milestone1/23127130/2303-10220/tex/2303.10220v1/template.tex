%%%%%%%%%%%%%%%%%%%%%%% file template.tex %%%%%%%%%%%%%%%%%%%%%%%%%
%
% This is a general template file for the LaTeX package SVJour3
% for Springer journals.          Springer Heidelberg 2010/09/16
%
% Copy it to a new file with a new name and use it as the basis
% for your article. Delete % signs as needed.
%
% This template includes a few options for different layouts and
% content for various journals. Please consult a previous issue of
% your journal as needed.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% First comes an example EPS file -- just ignore it and
% proceed on the \documentclass line
% your LaTeX will extract the file if required
\begin{filecontents*}{example.eps}
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 19 19 221 221
%%CreationDate: Mon Sep 29 1997
%%Creator: programmed by hand (JK)
%%EndComments
gsave
newpath
  20 20 moveto
  20 220 lineto
  220 220 lineto
  220 20 lineto
closepath
2 setlinewidth
gsave
  .4 setgray fill
grestore
stroke
grestore
\end{filecontents*}
%
\RequirePackage{fix-cm}
%
%\documentclass{svjour3}                     % onecolumn (standard format)
%\documentclass[smallcondensed]{svjour3}     % onecolumn (ditto)
%\documentclass[smallextended]{svjour3}       % onecolumn (second format)
\documentclass[twocolumn]{svjour3}          % twocolumn
%
\smartqed  % flush right qed marks, e.g. at end of proof
\synctex=1
\usepackage{psfrag}
%\usepackage{graphicx}
\usepackage{amsmath}
%\usepackage{epsfig}
\usepackage{url,verbatim}
\usepackage{amsmath,psfrag}
\usepackage{amsfonts}
\usepackage{graphicx}
%\usepackage{algorithmic}
\usepackage{framed}
%\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage{xcolor}
\usepackage{tikz}
%\usepackage{algorithm} 
\usepackage{caption}
\usepackage{array}
% \usepackage{mathptmx}      % use Times fonts if available on your TeX system
%
% insert here the call for the packages your document requires
%\usepackage{latexsym}
% etc.
%
% please place your own definitions here and don't use \def but
% \newcommand{}{}
%
% Insert the name of "your journal" with
% \journalname{myjournal}
%
\begin{document}

%\captionsetup{justification=justified, singlelinecheck=false}
\title{Synchronisation in TCP networks with Drop-Tail Queues}
%\subtitle{Do you have a subtitle?\\ If so, write it here}

%\titlerunning{Short form of title}        % if too long for running head

\author{Nizar~Malangadan\and Gaurav~Raina\and Debayani~Ghosh 
}

%\authorrunning{Short form of author list} % if too long for running head
%N.~Malangadan and G.~Raina are with the Department
%of Electrical Engineering, Indian Institute of Technology Madras, Chennai 600 036, India.
%E-mail: \{ee11s040, gaurav\}@ee.iitm.ac.in. D.~Ghosh is with the Electronics and Communication Engineering Department, Thapar Institute of Engineering and Technology, Patiala, Punjab-147004, India. E-mail: debayani.ghosh@thapar.edu}.
\institute{N.~Malangadan \and G.~Raina \at
              Department of Electrical Engineering\\
              Indian Institute of Technology Madras, Chennai             \\ \email\{ee11s040, gaurav\}@ee.iitm.ac.in           %  \\
%             \emph{Present address:} of F. Author  %  if needed
           \and
           D.~Ghosh \at
              Electronics and Communication Engineering Department\\ Thapar Institute of Engineering and Technology, Patiala\\
              \email{debayani.ghosh@thapar.edu}
}

\date{Received: date / Accepted: date}
% The correct dates will be entered by the editor


\maketitle

\begin{abstract}
The design of transport protocols, embedded in end-systems, and the choice of buffer sizing strategies, within network routers, play an important role in performance analysis of the Internet. In this paper, we take a dynamical systems perspective on the interplay between fluid models for transport protocols and some router buffer sizing regimes. Among the flavours of TCP, we analyse Compound, as well as Reno and Illinois. The models for these TCP variants are coupled with a Drop-Tail policy, currently deployed in routers, in two limiting regimes: a small and an intermediate buffer regime. The topology we consider has two sets of long-lived TCP flows, each passing through separate edge routers, which merge at a common core router. Our analysis is inspired by time delayed coupled oscillators, where we obtain analytical conditions under which the sets of TCP flows synchronise. These conditions are made explicit in terms of coupling strengths, which depend on protocol parameters, and on network parameters like feedback delay, link capacity and buffer sizes. We find that variations in the coupling strengths can lead to limit cycles in the queue size. Packet-level simulations corroborate the analytical insights. For design, small Drop-Tail buffers are preferable over intermediate buffers as they can ensure both low latency and stable queues.
\keywords{Congestion control \and TCP \and Drop-Tail queues \and delayed feedback \and synchronisation}
% \PACS{PACS code1 \and PACS code2 \and more}
\subclass{MSC code1 \and MSC code2 \and more}
\end{abstract}

\section{Introduction}
\label{intro}
The Internet is perhaps the largest manmade engineered system, as viewed from the perspective of the number of users that it supports, and the number of routers needed to forward and route information. Developing mathematical models to develop an understanding of the underlying dynamics, and performance, such a network is a challenging task. The network could be viewed as a large queuing network as also a large feedback system, where explicit or implicit feedback from the network helps to regulate the way transport protocols send traffic into the network.   

In a broader context, understanding the impact of delayed information on the dynamics of queuing systems is beginning to generate significant research interest in the literature \cite{corella,pender4,pender2,pender3,pender11}. Some common scenarios where delayed information can potentially hurt customer experience are the Internet, mobile services, healthcare services and public transportation, where it is important to communicate the waiting times or the queue length information with the customers \cite{Doldo,pender5,pender6}. In this paper, we study queuing systems which arise in the Internet, wherein majority of the traffic is regulated by Transmission Control Protocol (TCP), and congestion notifications are delayed. Our modelling perspective is guided by a dynamical systems approach, where appropriate fluid models for limiting queuing regimes interplay with delayed feedback.  

Queuing delays can build quite easily due to large and unmanaged router buffers~\cite{bufferbloat}. Such delays are reportedly on the rise, and they can hurt network performance and Quality of Service (QoS)~\cite{queue_delay}. If one were to control such delays, it would be important to study the interaction of transport protocols along with queue management policies. In this paper, our focus is on the analysis of three flavours of the Transmission Control Protocol (TCP): Compound TCP~\cite{compound}, which is the default protocol in the Windows operating system, TCP Reno~\cite{renoTowsley,rtw}, a standardised protocol, and TCP Illinois~\cite{illinois}, a new proposal. TCP requires feedback, from the network, to efficiently perform flow and congestion control. So a model should also consider methods for queue management in network routers. In our work, the models for these TCP variants are coupled with a Drop-Tail queue management policy, currently deployed in routers, in two different limiting regimes: a \emph{small buffer} and an \emph{intermediate buffer} regime.         

For some flavours of TCP, it is possible to devise fluid models which inturn can help guide the choice of system parameters. These models are usually deterministic, non-linear, and time delayed equations, whose stability and bifurcation properties can guide network performance studies. For such \textit{fluid models} of Compound TCP see~\cite{ccdc,raja}, for TCP Reno see~\cite{hhtc,rtw,rw}, and for TCP Illinois see~\cite{raja}. Queue management, in routers, has been an active area of research in the networking community but the simple Drop-Tail queue policy continues to be widely used in practice. Drop-Tail simply drops all incoming packets after the router buffer is full. For the development of some Drop-Tail models, with different buffer sizing regimes, see~\cite{rw}. Quite naturally, models of TCP should be studied in conjunction with models of queue management to develop a system level understanding. 

A large component of queuing delays, in the network, are being caused by \emph{large} router buffers that do not employ effective queue management strategies. To that end, we consider models for intermediate and small buffers. Reducing the size of buffers will reduce latency, but without clear design guidelines we may witness the emergence of oscillations and synchronisation effects in the queue size dynamics, which in turn could lead to the loss of link utilisation. A key focus in this paper is to explore and understand this phenomena of synchronisation. In a different context, the authors in \cite{pender2,pender11} study a class of fluid models of queues with delayed feedback and conclude that oscillations emerge if the delay gets too large.

Over the years, a large body of research has been motivated by work on the synchronisation of oscillators; for example, see~\cite{kuramoto1,kuramoto2,tousi,woods}.
An intriguing phenomena in such systems is the spontaneous locking, by the oscillators, into a common frequency.
Our style of analysis is inspired from the study of the time delayed Kuramoto model for coupled oscillators~\cite{sync2,strogatz}. The model was originally developed for coupled \emph{biological oscillators}, such as flashing fireflies \cite{buck} and cardiac pacemaker cells \cite{peskin}. The model continues to provide inspiration in different application areas. For example, recent work on power systems has also been influenced by the Kuramoto model~\cite{syncpower1,syncpower2}. This style of analysis has been used to study the synchronisation of TCP Reno flows coupled with small Drop-Tail buffers~\cite{hhtc}. In our previous work~\cite{ccdc}, we studied Compound TCP coupled with a Drop-Tail queue policy in a small and an intermediate buffer regime. We now generalise the analysis which is readily applicable to different fluid models of TCP. In particular, we also study TCP Reno which is a standardised version of TCP and TCP Illinois which is a new TCP proposal. Compared to~\cite{hhtc}, our work generalises the models and analysis to three flavours of TCP combined with both small and intermediate Drop-Tail buffers. Even though Compound TCP is widely deployed in the Internet, very few analytical models exist for Compound. A key insight obtained is the impact of protocol parameters and the buffer size on the analytical conditions for synchronisation. To that end, we highlight the role of the parameters embedded in Compound. Additionally, using packet-level simulations, we exhibit the emergence of synchronised phenomena, in the form of limit cycles, which corroborates the analytical insights. Limit cycles, in the queue size dynamics, were not exhibited in~\cite{hhtc}. 

Our model setting is as follows. We consider two distinct sets of long lived TCP flows, each regulated by separate edge routers, which merge at a common core network router.
For both the small and the intermediate buffer regimes, we derive analytical conditions under which \emph{synchronisation} would occur. The conditions are made explicit in terms of a coupling strength, which depend on TCP parameters and on network parameters like the feedback delay, link capacity and buffer sizes. It is shown that variations in the coupling strength can lead to non-linear oscillations in the form of limit cycles in the queue size. Such synchronisation phenomena in network queues would affect end-to-end network performance, and should be avoided. Packet-level simulations, conducted using the Network Simulator (NS2)~\cite{ns2}, corroborate our analytical insights. Small buffers, with Drop-Tail, have low latency and can be designed to ensure that the queue size dynamics do not exhibit limit cycles. Thus small router buffers are an appealing design option for future network architectures.    

The rest of this paper is structured as follows. In Section \ref{section:TCPs}, we briefly describe the algorithms of the various TCP flavours. In Section \ref{section:TCPFluidModel}, fluid models for the dynamics of the TCP variants with Drop-Tail are outlined. We derive expressions for coupling strengths in Section \ref{section:coupled}, and analytical conditions for synchronisation in Section \ref{section:synchronisation}. In Section \ref{section:simulations} we conduct some packet-level simulations, and summarise our contributions in Section \ref{section:conclusion}.

%\newpage
\newcommand{\mainw}{\mathsf{w}}
\newcommand{\w}[1]{\mainw_{#1}}
\newcommand{\weqC}[1]{\widetilde{\mainw}_{#1}^*}
\newcommand{\dw}[1]{\varDelta\mainw_{#1}}
\newcommand{\weq}[1]{\mainw^*_{#1}}
\newcommand{\myi}{j}
\newcommand{\myj}{i}
\newcommand{\mym}{m}
\newcommand{\myf}{g}
\section{Transport protocols}
We now briefly outline the congestion control algorithms for the following transport protocols: Compound TCP~\cite{compound}, TCP Reno~\cite{renoTowsley,rtw} and TCP Illinois~\cite{illinois}. 
\label{section:TCPs}
%
%
\subsection{Compound TCP}
\label{subsection:CTCPalgorithm}
%
Compound is the default transport layer protocol  of the Windows operating system, which was introduced as part of the Windows Vista and Windows
Server 2008 TCP stack~\cite{compound}.
Compound TCP uses both \emph{queuing delay} and \emph{packet loss} for managing its flow control algorithms.
To describe the key algorithms of Compound, we use the same notation which was used in the original paper~\cite{compound}.
In Compound, the sending window $\w{}$, which regulates the flow rate, is calculated as follows:
\[\w{} = \min\bigl(cwnd+dwnd, awnd\big), \]
where $cwnd$ is the loss window, $dwnd$ is the delay window, and $awnd$ is the minimum window size. 
To estimate the transmission delay of packets, a state variable called $baseRTT$ \big(base round-trip time (RTT)\big) is maintained. 
The number of backlogged packets of the connection ($diff$) can be estimated by the following 
%
\begin{equation*}
 diff = \bigg( \frac {\w{}}{baseRTT} - \frac {\w{}}{RTT} \bigg) baseRTT.
\end{equation*}
%
The algorithm to determine $dwnd$ is as follows
% 
% {\small 
% \begin{displaymath}
% dwnd(t+1) =  \begin{cases}
% dwnd(t)+\big(\alpha \w{}(t)^k-1\big)^+ & \mbox{if $diff< \gamma$}\\
% \big(dwnd(t)-\zeta  diff\big)^+  & \mbox{if $diff \ge \gamma$}\\
% \big(\w{}(t)(1-\beta)-cwnd/2\big)^+ & \mbox{if loss},\end{cases}
% \end{displaymath} }
\begin{small}
\begin{displaymath} 
dwnd(t+1) =  \begin{cases}
dwnd(t)+\Big(\alpha\,\w{}(t)^k-1\Big)^+ & diff < \gamma\\
\bigl(dwnd(t)-\zeta\,diff\bigr)^+  & diff \ge \gamma\\
\Big(\w{}(t)(1-\beta)-cwnd/2\Big)^+ & \text{if loss},
\end{cases}  
\end{displaymath}
\end{small}
%
where $(z)^+$ is defined as $\max(z,0)$ and $\zeta > 0$. 
The parameters  $\alpha$, $\beta$ and $k$, influence the scalability, smoothness and responsiveness of the window function respectively,  
and $\gamma$ is a protocol threshold. 
The default parameter values are $\alpha = 0.125$, $\beta = 0.5$, $k = 0.75$, $\gamma=30$ and $\zeta=0.5$~\cite{compound}. 
If $diff<\gamma$, the network path is assumed to be underutilised and Compound acts aggressively by increasing the sending rate. If $diff\geq\gamma$, 
%the network path is considered to be congested and 
the delay based
component, $dwnd$, is gracefully reduced. In the event that a packet loss is detected, Compound TCP reduces its congestion window by half, similar to Reno.

\subsection{TCP Reno}
TCP Reno is a standard implementation of the Transmission Control Protocol. 
The protocol relies only on packet loss as the 
%primary 
feedback signal to regulate its flow and congestion control mechanisms.
 The response for the feedback is defined by  the Additive Increase Multiplicative Decrease (AIMD) algorithm, 
where the window size $\w{}$ is updated as follows
\begin{small}
\begin{displaymath} 
\w{}(t_{n+1}) =  \begin{cases}
\w{}(t_n)+ \dfrac{1}{\w{}(t_n)} &\!\!\! \text{if positive acknowledgement}\\[1.5ex]
\dfrac{\w{}(t_n)}{2} &\!\!\! \text{if loss},
\end{cases}  
\end{displaymath}
\end{small}
% \begin{displaymath} 
% \w{}(t_{n+1}) =  \begin{cases}
% \w{}(t_n)+ \dfrac{1}{\w{}(t_n)} & \text{if  +ve acknowledgement}\\[1.5ex]
% \dfrac{\w{}(t_n)}{2} & \text{if packet loss},
% \end{cases}  
% \end{displaymath}
%
where the sequence $t_n$  corresponds to the time instants at which either successful acknowledgements, or loss of packets are detected.

% \begin{itemize}
%  \item Standard TCP
%  \item Based on packet loss
%  \item Additive Increase Multiplicative decrease
%  \item Fast recovery
%  \end{itemize}
%
\subsection{TCP Illinois}

TCP Illinois~\cite{illinois}, like Compound TCP, uses both queuing delay and packet loss for flow and congestion control. 
The protocol aims to achieve concave-shaped curves for the window by varying the parameters 
$\alpha$ and $\beta$ of the standard Additive Increase Multiplicative Decrease (AIMD) TCP Reno  algorithm, based on the observed average queuing delay, $d_a$. These protocol parameters vary according to $\alpha = f_1(d_a)$ and $\beta=f_2(d_a )$,
where $f_1(d_a)$ is an increasing function and $f_2(d_a)$ is a decreasing function. The reader is referred to~\cite{illinois} for a detailed description of these functions.

The additive increase and multiplicative decrease
parameters of TCP Illinois also depend on the delay, but the regime we focus on is where the the queuing delay forms a negligible component of the end to end delay.
%{\color{black}
%Our focus is on a regime where the queuing delay forms a negligible component of the end-to-end delay. 
In this regime, Illinois uses $\alpha=\alpha_{max}$
and $\beta=\beta_{min}$, which would result in the  following algorithm:

\begin{small}
\begin{displaymath} 
\w{}(t_{n+1}) =  \begin{cases}
\w{}(t_n)+ \dfrac{\alpha_{max}}{\w{}(t_n)} &\!\!\! \text{if positive acknowledgement}\\[1.5ex]
(1-\beta_{min})\,\w{}(t_n) &\!\!\! \text{if loss}.
\end{cases}  
\end{displaymath}
\end{small}
The default values of the parameters are $\alpha_{max}=10$ and $\beta_{min}=0.125$~\cite{illinois}.
%}



\section{Fluid models}
\label{section:TCPFluidModel}
We now outline fluid models for the transport protocols in small and intermediate buffer sizing regimes. 
%\label{section:uncoupledCompoundTCP}
\subsection{Generalised TCP}
\label{subsection:FluidmodelGeneralisedTCP}
Consider two distinct sets of TCP flows that are regulated by separate edge routers with Drop-Tail buffers. 
For the $\mym^{th}$ set of flows ($\mym=1,2$), let the \textit{average window size} be $\w{\mym}(t)$ and the round-trip time be $\tau_\mym$. Then the 
\textit{average rate} of flows $x_\mym(t)=\w{\mym}(t)/\tau_\mym$.
Further, consider that  TCP increments the window size $\w{}$ of a flow by $i(\w{})$ per  positive acknowledgement, and decrements it by
$d(\w{})$ when a packet drop is detected. 
Then from~\cite{rw},  a \emph{many flows} fluid model for a generalised TCP is 
%represented by the following dynamical system
%
%\begin{align}
% \dot{\w{}}_\mym(t) =&\, \frac{\w{\mym}(t-\tau_\mym)}{\tau_\mym}\biggl( i\bigl(\w{\mym}(t)\bigr)\bigl(1-p_\mym(t-\tau_\mym)\bigr)  \notag \\
%		  &\qquad- d\bigl(\w{\mym}(t)\big)p_\mym(t-\tau_\mym)\biggr)\,\, ;\,\, \mym=1,2, \label{eq:GenTCP}
%\end{align}


%\begin{equation}
\begin{align}
 \dot{\w{}}_\mym(t) =&\, \frac{\w{\mym}(t-\tau_\mym)}{\tau_\mym}\biggl( i\bigl(\w{\mym}(t)\bigr)\bigl(1-p_\mym(t-\tau_\mym)\bigr)\label{eq:tcpeq} \\ -& d\bigl(\w{\mym}(t)\big)p_\mym(t-\tau_\mym)\biggr)\,\, ;\,\, \mym=1,2,\notag
\end{align}

%\end{equation}
where %$\w{\mym}$ is the average window size, 
$p_\mym(.)$ is the edge buffer
packet loss probability
%, and $\tau_{\mym}$ is  round-trip time 
for the $\mym^{th}$ set of TCP flows.
Whenever there is a packet loss, which would occur with a probability of $p_m(.)$, the window size of a TCP flow decrements. The window size increases when there is no packet loss, which would occur with a probability of $\big(1-p_m(.)\big)$. Thus, multiplying $i(\w{})$ by $\big(1-p_m(.)\big)$ makes the model more realistic in capturing the evolution of the window size dynamics. This would also impact the non-linear structure of the fluid model. This aspect was not incorporated in previous models \cite{hhtc,ccdc,raja}.
Throughout this paper, $\dot{z}(t)$ denotes the derivative of $z(t)$ with respect to time $t$.
The functional forms for $i(\w{})$ and $d(\w{})$ depend on the congestion avoidance algorithms of the transport protocols.
The functional forms of $i(\w{})$ and $d(\w{})$ for TCP Reno are derived in~\cite{rw}, and for Compound and Illinois in~\cite{raja}. 
The functional forms for these protocols are listed in Table~\ref{table:windowfunctions}. Substituting these functional forms in \eqref{eq:tcpeq} will give a fluid model for the corresponding
transport protocols. We now outline the models for the packet loss probability at the bottleneck queue, in small and intermediate buffer regime. For the traffic, we consider both smooth and bursty traffic.
\\
%
%
\begin{table}[t]
\centering
 \begin{tabular}{lccc}
  \hline\\[-1ex]
  TCP &  $ i(\w{})$ &  $d(\w{})$      \\[1ex]
  \hline
  \hline\\[-0.5ex]
   \textit{Compound} & $\displaystyle\,\,\,\,\, \alpha \w{}^{k-1}$ & $\displaystyle \beta \w{}$  &\\[3ex]
 
   \textit{Reno} &  $\displaystyle \frac{1}{\w{}}$ & $\displaystyle \frac{\w{}}{2}$    \\[3ex]
  %\hline
    \textit{Illinois} &  $\displaystyle \frac{\alpha_{max}}{\w{}}$ & $\displaystyle \beta_{min}\w{}$   \\[2ex]
  %\hline

  \hline
  \hline
 \end{tabular}
 %}
 \vspace{8pt}
\caption{ Window increase and decrease functions of the transport protocols. The default values of the protocol parameters are: $\alpha=0.125$, $\beta=0.5$ and $k=0.75$ (for Compound); 
$\alpha_{max}=10$ and $\beta_{min}=0.125$ (for Illinois). }
\label{table:windowfunctions}
\end{table}


\noindent\textit{Small buffers and Drop-Tail}\\

\noindent\textit{Smooth traffic:} In the smooth traffic scenario, the arrival process at the bottleneck queue constitutes a point process, wherein each point represents one packet. When the access links are much slower as compared to the core link, the packets are naturally spaced out, thus ensuring smooth traffic flow into the bottleneck queue. In real networks, the core routers typically operate at a much faster rate than the edge routers and hence the incoming traffic to the core router is inherently smooth \cite{S2,Lakshmikantha}. In such a scenario, with a large number of TCP flows, the blocking probability of an M/M/1
queue has been proposed as a simple fluid model for small Drop-Tail buffers \cite{Poisson_limit,rw}. Thus, with a large number of flows, the edge routers may be represented by the following model:  
%
\begin{equation}
 p_\mym\big(\w{\mym}(t)\big) = \left(  \frac{\w{\mym}(t)}{c'_\mym\tau_\mym} \right)^{b_\mym}, %;\,\, \mym=1,2 
\label{eq:edgeSmall}
\end{equation}
where $b_\mym$ is the router buffer size, $c'_\mym$ is the link capacity per flow, $\tau_\mym$ is the round-trip time and $x_\mym(t)$ is the rate, where 
$\w{\mym}(t) =x_\mym(t)\tau_\mym$. \\
%
%

\noindent\textit{Bursty traffic:} In the bursty traffic scenario, the arrival process at the bottleneck queue can be thought of as a point process. However, each point now represents a batch arrival, \emph{i.e.}, each point represents a clump of packets. This traffic scenario can be realised by operating the access links at faster speeds \cite{Ayesta,S2,Lakshmikantha}. In \cite{Wischik}, the author has modified the blocking probability of an M/M/1/B queue to propose a crude approximation for the packet loss probability in presence of bursty traffic. Note that the model for the packet drop probability is derived by assuming that if the first packet of a batch gets dropped, then all successive packets get dropped.This yields the following fluid model for the edge routers \cite{Wischik}: 
\begin{equation}
 p_\mym\big(\w{\mym}(t)\big) =\frac{1}{\w{\mym}(t)} \left(  \frac{\w{\mym}(t)}{c'_\mym\tau_\mym} \right)^{\frac{b_\mym}{\w{\mym}}}, %;\,\, \mym=1,2 
\label{eq:edgeSmall_bursty}
\end{equation}
Here, $\w{\mym}$ also represents the batch size at time instant $t.$ To simply analysis, in our work, we assume that the batch size is a constant, and refer to it as the \emph{burstiness parameter}. Let the burstiness parameter corresponding to the edge routers be $n_{\mym};$ $m=1,2.$ Then, the packet loss probabilities at the edge routers can be re-written as follows:
\begin{equation}
 p_\mym\big(\w{\mym}(t)\big) =\frac{1}{n_{\mym}} \left(  \frac{\w{\mym}(t)}{c'_\mym\tau_\mym} \right)^{\frac{b_\mym}{n_\mym}}, %;\,\, \mym=1,2 .
\label{eq:edgeSmall_burstyconstant}
\end{equation}
Note that when the burstiness parameter $n_\mym=1,$ it yields the fluid models with smooth traffic. Thus, the model \eqref{eq:edgeSmall_burstyconstant} can be thought of as a generalisation of \eqref{eq:edgeSmall}. Hence, we analyse \eqref{eq:tcpeq} coupled with the packet loss probability model \eqref{eq:edgeSmall_burstyconstant}. Assume $\w{\mym}^*$ to be the equilibrium of the system \eqref{eq:tcpeq} and \eqref{eq:edgeSmall_burstyconstant}.
Then, at equilibrium, we have
%Linearising system  \eqref{eq:GenTCP} and \eqref{eq:edgeSmall}, about the equilibrium~$\w{\mym}^*$, gives
%
%
\begin{align*}
 i(\weq{\mym})\bigl(1-p_\mym(\weq{\mym})\bigr) = d(\weq{\mym})p_\mym(\weq{\mym}).
\end{align*}
Let $\w{\mym}(t)=\w{\mym}^*+\varDelta{}\w{\mym}(t)$, and linearising the non-linear equations about the equilibrium, we get the following system
%
\begin{equation}\small
          \varDelta{}\dot{\w{}}_\mym(t) =  -\frac{i(\weq{\mym})}{\tau_\mym}\biggl( g\big(\weq{\mym}\big)\dw{\mym}(t)+ \frac{b_\mym}{n_\mym}\dw{\mym}(t-\tau_\mym) \biggr), \label{eq:GenTCPLinearSmallBuffer}
\end{equation} 
%
%where $\w{\mym}(t)=\w{\mym}^*+\varDelta{}\w{\mym}(t)$, 
%$p_{\mym}(\weq{\mym})$ is the equilibrium packet loss probability given by $p_\mym(\weq{\mym})=\bigl(\weq{\mym}/(c_\mym\tau_\mym)\bigr)^{b_\mym}$,  
%and
where
{\small\begin{equation*}
 \myf(\weq{\mym})=\left(\frac{\weq{\mym}d'(\weq{\mym})}{d(\weq{\mym})} - \frac{\weq{\mym}i'(\weq{\mym})}{i(\weq{\mym})}\right)\frac{d(\weq{\mym})}{i(\weq{\mym})+d(\weq{\mym})}. 
\end{equation*}}
\hspace{-3pt}We now derive the intrinsic frequency of the model.\\

%Throughout the paper, the notation $g'(\w{})$ denotes the derivative of $g$ with respect to window size $\w{}$. \\


%
\noindent\textit{Intrinsic frequencies:} 
In the multi-bottleneck scenario, it has been shown that with Compound TCP, the dynamical system would undergo a Hopf bifurcation as the underlying fluid model transits from a locally stable to a locally unstable state~\cite{debayani1,debayani2}. The existence of a Hopf highlights that one would expect to observe limit cycles in the neighbourhood of the locally unstable regime~\cite{nonlinear}. While it has not exhibited that with TCP Reno and Illinois, a Hopf bifurcation would occur, we assume that we would also expect non-linear oscillations in the form of limit cycles as the system loses local stability. Packet-level simulations, conducted later in the paper, do confirm the existence of such limit cycles. 
We approximate these emerging limit cycles with harmonic oscillations. 
To obtain their frequency, we substitute $\varDelta{}\w{\mym}(t) = r_\mym e^{\myi\overline{\theta}_\mym(t)}$ into (\ref{eq:GenTCPLinearSmallBuffer}),   and
obtain
%
\begin{align}
  \myi r_\mym e^{\myi\overline{\theta}_\mym(t)}\dot{\overline{\theta}}_\mym(t) =&\, - \Bigl( g(\weq{\mym})r_\mym e^{\myi\overline{\theta}_\mym(t)}\nonumber\\  &+\frac{b_\mym}{n_\mym} r_\mym e^{\myi\overline{\theta}_\mym(t-\tau_\mym)} \Bigr)\frac{i(\weq{\mym})}{\tau_\mym},\label{eq:GenTCPthetaSmall}
\end{align}
%
where  $\overline{\theta}_\mym(t)=\omega_\mym t+\phi_\mym$, $\omega_\mym$ is the intrinsic frequency of the $\mym^{th}$ set of flows and $\phi_\mym$ its phase. From
\eqref{eq:GenTCPthetaSmall} we get
%\
\[
\begin{aligned}
g(\weq{\mym}) + \frac{b_\mym}{n_\mym}\cos(\omega_\mym\tau_\mym) &=0, \notag \\ 
\omega_\mym-\frac{i(\weq{\mym})}{\tau_\mym}b_\mym\sin(\omega_\mym\tau_\mym) &=0 \notag.
\end{aligned}
\]
%
On simplification, we obtain
%
\begin{equation}
\omega_\mym =\frac{i(\weq{\mym})}{\tau_\mym}\sqrt{\left(\frac{b_\mym}{n_\mym}\right)^2 - g^2\big(\weq{\mym}\big)}\,\,. \label{eq:GenTCPFreqSmall} 
\end{equation}
%  
%
Substituting the functional forms for $i(\w{})$ and $d(\w{})$ for Compound, Reno and Illinois (see Table~\ref{table:windowfunctions}), we compute the 
intrinsic frequencies. 
The expressions for the intrinsic frequencies, in the case of small Drop-Tail buffers and smooth traffic $(n_\mym=1)$,  are listed in Table~\ref{table:small_intrinsic_frequencies}.\\


\noindent\textit{Intermediate buffers and Drop-Tail}\\ 
In an intermediate buffer regime, the buffers are sized as $B=c*\overline{RTT}/\sqrt{N}$, where $c$ 
is the link capacity, $\overline{RTT}$ is the average round-trip time of the flows, and $N$ is the number of flows~\cite{mckoewn}. 
In practice, $\overline{RTT}$ is fixed at $250$ ms. We now outline the model for the packet loss probability with smooth and bursty traffic.\\
 
\noindent\textit{Smooth traffic:} In this scenario, when the average arrival rate to the queue $x_{\mym}(t)=\w{\mym}(t)/\tau<c'_{\mym},$ the packet drop probability is zero, when the number of TCP flows is large. On the other hand, when $x_{\mym}(t)>c'_{\mym},$ a fluid model for intermediate buffers with Drop-Tail is \cite{rw}  
%
\begin{equation}
 p_\mym\big(\w{\mym}(t)\big) = \left(\frac{\w{\mym}(t)-c'_\mym\tau_\mym}{\w{\mym}(t)}\right)^+,
\label{eqn:edgeIntermediate}
\end{equation}
where $(z)^+$ is defined as $\max(z,0)$, $c'_\mym$ is the link capacity per flow, $\tau_\mym$ is the round-trip time and $x_\mym(t)$ is the rate, where $\w{\mym}(t)=x_\mym(t)\tau_\mym$.

In a deterministic fluid model, \eqref{eqn:edgeIntermediate} has the interpretation
of the fraction of fluid lost when the arrival rate exceeds capacity~\cite{srikant}.\\
 
\noindent\textit{Bursty traffic:} In this scenario, a batch of size $w(t)$ experiences a drop at time instant $t$ if the empty space in the buffer is less than $w(t).$ This leads to the packet drop probability at edge routers as \cite{rw,Wischik}
 \begin{equation}
 p_\mym\big(\w{\mym}(t)\big) = \frac{1}{\w{\mym}(t)}\left(\frac{\w{\mym}^{\w{\mym}(t)}(t)-\left(c'_\mym\right)^{\w{\mym}(t)}\tau_\mym^{\w{\mym}(t)}}{\w{\mym}^{\w{\mym}(t)}(t)}\right)^+,
\label{eqn:edgeIntermediate_bursty}
\end{equation}
For the sake of analysis, we again assume that the batch size is constant, and is denoted by $n_{\mym};$ $m=1,2.$ This yields the packet drop probability at the edge routers as  
\begin{equation}
 p_\mym\big(\w{\mym}(t)\big) = \frac{1}{n_{\mym}}\left(\frac{\w{\mym}^{n_{\mym}}(t)-\left(c'_\mym\right)^{n_{\mym}}\tau_\mym^{n_{\mym}}}{\w{\mym}^{n_{\mym}}(t)}\right)^+,
\label{eqn:edgeIntermediate_burstyconstant}
\end{equation}

%
%
%Substituting (\ref{eqn:edgeIntermediate}) in (\ref{eq:Compound}), and setting $\dot{\w{}}_\mym(t)=0$, we obtain the equilibrium condition
%\begin{equation}
% \big(\w{}^*_m-c_{\mym}\tau_{\mym}\big){\w{}^*_m}^{1-k} =  \alpha/\beta. \label{eq:condIntermediateEquil}
%\end{equation}
%
% \begin{table*}[t]
% \centering
% \newcolumntype{A}{>{\arraybackslash} m{1.0cm} }
% \newcolumntype{B}{>{\flushright\arraybackslash} m{4.2cm} }
% \newcolumntype{C}{>{\flushright} m{4.5cm} }
% \newcolumntype{D}{>{\arraybackslash} m{0.05ex} }
% \resizebox{12.7cm}{!}{
%  \begin{tabular}{ABCD}
%   \hline
%   \\[-1ex]
%    \textit{TCP } & \centering \textit{Expression for\\ equilibrium window, $\weq{\mym}$}  
%   & \centering \textit{Intrinsic frequency:\\ intermediate buffers,  $\omega_{\mym} $  }   &\\[5ex]
%   \hline
%   \hline
%    \textit{Compound}  &  $\displaystyle \weq{\mym}-c_{\mym}\tau_{\mym} -   \frac{\alpha}{\beta{\weq{\mym}}^{1-k}}=0 $ & 
%  $\displaystyle \beta c_{\mym}\sqrt{1-(k-2)^2\left(\frac{\weq{\mym}}{c_{\mym}\tau_{\mym}}-1\right)^2} $  & \\[9ex]
%  
%    \textit{Reno} &  $\displaystyle \weq{\mym}-c_{\mym}\tau_{\mym} -\frac{2}{\weq{\mym}}=0$  
%   &$\displaystyle \qquad \quad\,\, \frac{c_{\mym}}{2}\sqrt{ 1 -4\left(\frac{\weq{\mym}}{c_{\mym}\tau_{\mym}}-1\right)^2  }$  &  \\[9ex]
%   %\hline
%     \textit{Illinois} &  $\displaystyle  \weq{\mym}-c_{\mym}\tau_{\mym}-\frac{\alpha_{max}}{\beta_{min}\weq{\mym}}=0$ 
%    &$\displaystyle \quad\,\,\, \beta_{min}c_{\mym}\sqrt{ 1 -4\left(\frac{\weq{\mym}}{c_{\mym}\tau_{\mym}}-1\right)^2  }$  &\\[9ex]
%   %\hline
% 
%   \hline
%   \hline
%  \end{tabular}}
% \begin{table}[t]
% \centering
% \newcolumntype{T}{>{\flushleft\arraybackslash} m{1.0cm} }
% \newcolumntype{E}{>{\flushright\arraybackslash} m{3.4cm} }
% \newcolumntype{S}{>{\flushright\arraybackslash}  m{3.5cm} }
% \newcolumntype{F}{ m{0.05cm} }
% \resizebox{8.8cm}{!}{
%  \begin{tabular}{TESF}
%   \hline\\[-3ex]
%   \textit{TCP}  &  \textit{Equilibrium window}, $\weq{\mym}$ 
%    & \centering \textit{Intrinsic frequency:\\ small buffers, $\omega_{\mym} \approx$ \\  $(b_{\mym}>>2)$  }  &\\[9ex]
%   \hline
%   \hline
%    {Compound}  & $\displaystyle\!\left( \frac{\alpha}{\beta} (c_{\mym}\tau_{\mym})^{b_{\mym}}\right)^{\frac{1}{b_{\mym}+2-k}}$ & 
%  $\displaystyle  \frac{\alpha\beta^{\frac{1-k}{b_{\mym}+2-k}} }{c_{\mym}^{1-k}\tau_{\mym}^{2-k}}\sqrt{b_{\mym}^2 - (k-2)^2} $  \\[2ex]
%  
%    {Reno}   & $\displaystyle \Big(2(c_{\mym}\tau_{\mym})^{b_{\mym}}\Big)^{\frac{1}{b_{\mym}+2}}$  
%    &$\displaystyle \frac{\left(\frac{1}{2}\right)^{\frac{1}{b_{\mym}+2}}}{c_{\mym}\tau_{\mym}^2}\sqrt{b_{\mym}^2-4}$  \\[2ex]
%   %\hline
%     {Illinois}  & $\displaystyle\!\left(\frac{\alpha_{max}}{\beta_{min}}(c_{\mym}\tau_{\mym})^{b_{\mym}}\right)^{\frac{1}{b_{\mym}+2}}$  
%     &$\displaystyle \frac{\alpha_{max}\beta_{min}^{\frac{1}{b_{\mym}+2}}}{c_{\mym}\tau_{\mym}^2}\sqrt{b_{\mym}^2 - 4}$  \\[3.5ex]
%   %\hline
% 
%   \hline
%   \hline
%  \end{tabular}
% }
%  \vspace{8pt}
% \caption{ \textit{Intrinsic frequencies} of the transport protocols in \textit{small Drop-Tail} buffers.}
% \label{table:small_intrinsic_frequencies}
% \end{table} 
\begin{table}[t]
\centering
\newcolumntype{T}{>{\flushleft\arraybackslash} m{2.5cm} }
%\newcolumntype{E}{>{\flushright\arraybackslash} m{3.4cm} }
\newcolumntype{S}{>{\flushright\arraybackslash}  m{3.5cm} }
\newcolumntype{F}{ m{0.95cm} }
%\resizebox{8.8cm}{!}{
 \begin{tabular}{TSF}
  \hline\\[-3ex]
  TCP  &   \centering \textit{Intrinsic frequency ($\omega_\mym$):\\ small buffers  }  &\\[7ex]
  \hline
  \hline
  
   \textit{Compound}  & 
\begin{tiny}$\displaystyle  \frac{\alpha{\weq{\mym}}^{k-1}}{\tau_\mym}\sqrt{b_\mym^2-(k-2)^2\big(1-p_\mym(\weq{\mym})\big)^2} $\end{tiny}  \\[2ex]
 
   \textit{Reno}  
   &$\displaystyle \frac{1}{\weq{\mym}\tau_\mym}\sqrt{b_\mym^2-4\big(1-p_\mym(\weq{\mym})\big)^2} $ \\[2ex]
  %\hline
    \textit{Illinois} 
    &$\displaystyle \frac{\alpha_{max}}{\weq{\mym}\tau_\mym}\sqrt{b_\mym^2- 4\big(1-p_\mym(\weq{\mym})\big)^2}$  \\[3.5ex]
  %\hline

  \hline
  \hline
 \end{tabular}
%}
 \vspace{8pt}
\caption{ Intrinsic frequencies of the transport protocols with small Drop-Tail buffers and smooth traffic.}
\label{table:small_intrinsic_frequencies}
\end{table} 
%


We now analyse \eqref{eq:tcpeq} coupled with \eqref{eqn:edgeIntermediate_burstyconstant}. Let   $\w{\mym}(t)=\weq{\mym}+\varDelta{}\w{\mym}(t)$ and linearising system~\eqref{eq:tcpeq} and~\eqref{eqn:edgeIntermediate_burstyconstant}, about the equilibrium~$\w{\mym}^*$, gives

%\begin{equation}
\begin{small}
\begin{align}
 \varDelta{}\dot{\w{}}_\mym(t) =&\,\,- \frac{g(\weq{\mym})i(\weq{\mym})}{\tau_\mym}\varDelta{}\w{\mym}(t)\nonumber\\&-\frac{\bigl( i(\weq{\mym})  + d(\weq{\mym})\bigr)\left(c'_\mym\right)^{n_\mym}\tau_{\mym}^{n_{\mym}-1}}{\left(\weq{\mym}\right)^{n_{\mym}}} \varDelta{}\w{\mym}(t-\tau_\mym). \label{eq:GenTCPLinInter}
\end{align}
\end{small}
 %\end{equation}
%
%where $\w{\mym}(t)=\weq{\mym}+\varDelta{}\w{\mym}(t)$.\\


%
%

\noindent\textit{Intrinsic frequencies:} 
%We assume that as C-TCP system described by (\ref{eq:Compound})
%and (\ref{eqn:edgeIntermediate})  loses stability, the system enters into limit cycles. 
%We approximate the emerging limit cycles with harmonic oscillations. 
As considered earlier, we assume that loss of local stability would give rise to limit cycles. 
Again, we approximate the limit cycles with harmonic oscillations.
To obtain their frequency, we substitute $\varDelta{}\w{\mym}(t) = r_\mym e^{\myi\overline{\theta}_\mym(t)}$ in \eqref{eq:GenTCPLinInter}   to obtain
%

\begin{small}
\begin{align}
   \myi r_\mym e^{\myi\overline{\theta}_\mym(t)}\dot{\overline{\theta}}_\mym(t) =\,\, - \frac{g(\weq{\mym})i(\weq{\mym})}{\tau_\mym}r_\mym e^{\myi\overline{\theta}_\mym(t)}\nonumber\\
   -\frac{\bigl( i(\weq{\mym})  + d(\weq{\mym})\bigr)\left(c'_\mym\right)^{n_\mym}\tau_{\mym}^{n_{\mym}-1}}{\left(\weq{\mym}\right)^{n_{\mym}}}r_\mym e^{\myi\overline{\theta}_\mym(t-\tau_\mym)} ,\label{eq:thetaGeneralInter}
 \end{align}
\end{small}

\noindent{}where  $\overline{\theta}_\mym(t)=\omega_\mym t+\phi_\mym$, $\omega_\mym$ is the intrinsic frequency of the $\mym^{th}$ set of flows and $\phi_\mym$ its phase. From
(\ref{eq:thetaGeneralInter}),
%
\[
\begin{scriptsize}
\begin{aligned}
\frac{g(\weq{\mym})i(\weq{\mym})}{\tau_{\mym}} + \frac{\bigl( i(\weq{\mym})  + d(\weq{\mym})\bigr)\left(c'_\mym\right)^{n_\mym}\tau_{\mym}^{n_{\mym}-1}}{\left(\weq{\mym}\right)^{n_{\mym}}}\cos(\omega_{\mym}\tau_{\mym}) &=0, \notag \\ 
\omega_{\mym}- \frac{\bigl( i(\weq{\mym})  + d(\weq{\mym})\bigr)\left(c'_\mym\right)^{n_\mym}\tau_{\mym}^{n_{\mym}-1}}{\left(\weq{\mym}\right)^{n_{\mym}}}\sin(\omega_{\mym}\tau_{\mym}) &=0 \notag,
\end{aligned}
\end{scriptsize}
\]
which gives
\begin{scriptsize}
\begin{equation}
  \omega_{\mym} =\sqrt{  \left(\frac{\bigl( i(\weq{\mym})  + d(\weq{\mym})\bigr)\left(c'_\mym\right)^{n_\mym}\tau_{\mym}^{n_{\mym}-1}}{\left(\weq{\mym}\right)^{n_{\mym}}}\right)^2 - 
   \left(\frac{i(\weq{\mym})g(\weq{\mym})}{\tau_{\mym}}\right)^2}. \label{eq:GenTCPFreqInter}
\end{equation}
   \end{scriptsize}
% 

Using the functional forms for $i(\w{})$ and $d(\w{})$ listed in Table~\ref{table:windowfunctions}, we compute the %fluid models and 
intrinsic frequencies for the three protocols. 
The intrinsic frequencies in case of intermediate Drop-Tail buffers with smooth traffic $(n_{\mym}=1)$ are outlined in Table~\ref{table:inter_intrinsic_frequencies}.

%
%\subsection{TCP Reno, Compound TCP and TCP Illinois}


%We now analyse the three transport protocols. 
\begin{table}
\centering
\newcolumntype{A}{>{\arraybackslash} m{2.5cm} }
\newcolumntype{B}{>{\flushright\arraybackslash} m{3.2cm} }
\newcolumntype{C}{>{\flushright} m{3.5cm} }
\newcolumntype{D}{>{\arraybackslash} m{0.05ex} }
%\resizebox{12.7cm}{!}{
 \begin{tabular}{ACD}
  \hline
  \\[-3ex]
   TCP
  & \centering \textit{Intrinsic frequency ($\omega_{\mym}$):\\ intermediate buffers  }   &\\[5ex]
  \hline
  \hline
   \textit{Compound}  & 
 $\displaystyle \frac{\beta \weq{\mym}}{\tau_{\mym}}\sqrt{1-(k-2)^2p_{\mym}^2(\weq{\mym})} $  & \\[6ex]
 
   \textit{Reno}  &$\displaystyle \frac{ \weq{\mym}}{2\tau_{\mym}}\sqrt{1-4p_{\mym}^2(\weq{\mym})}$  &  \\[6ex]
  %\hline
    \textit{Illinois}    &$\displaystyle \frac{\beta_{min} \weq{\mym}}{\tau_{\mym}}\sqrt{1-4p_{\mym}^2(\weq{\mym})}$  &\\[9ex]
  %\hline

  \hline
  \hline
 \end{tabular}
 %} 
 \vspace{8pt}
\caption{ Intrinsic frequencies of the transport protocols with intermediate Drop-Tail buffers and smooth traffic.}
\label{table:inter_intrinsic_frequencies}
\end{table} 
%\noindent\textit{Intrinsic frequencies of some transport protocols:} 
% \subsection{Compound, Reno and  Illinois} 
% Note that the fluid models and the intrinsic frequencies depend on the window increment function $i(\w{})$ and the window decrement function $d(\w{})$ of the transport protocols.
% Using the functional forms listed in Table~\ref{table:windowfunctions}, we obtain the %fluid models and 
% intrinsic frequencies for Reno, Compound and Illinois, in both router buffer limiting regimes.
% The intrinsic frequencies in case of intermediate buffers are outlined in Table~\ref{table:inter_intrinsic_frequencies}. 
% Observe that the frequencies depend on both protocol parameters, and the network parameters like buffer size, link capacity and round-trip time.

Now that we have described the underlying fluid models, we go on to analyse their coupled dynamics, in Section \ref{section:coupled}, and the phenomena of synchronisation, 
in Section \ref{section:synchronisation}.

% \begin{figure}[t]
%\centering
% \psfrag{D50}{\hspace{-1.4cm}\scriptsize \textit{Round-trip time = $50$ ms} }
% \psfrag{D100}{\hspace{-1.3cm}\scriptsize \textit{Round-trip time = $100$ ms} }
% \psfrag{D200}{\hspace{-1.3cm}\scriptsize \textit{Round-trip time = $200$ ms} }
% %
% \psfrag{125}[c]{\hspace{0.15cm}\scriptsize$125$}
% \psfrag{100}[c]{\hspace{0.15cm}\scriptsize$100$}
% \psfrag{50}[c]{\hspace{0.2cm}\scriptsize$50$}
% \psfrag{0}[c]{\hspace{0.2cm}\scriptsize$0$}
% \includegraphics[height=2.7in, width=4.15in, angle=-90]{ccdcFreq100_60_100.eps} 
% \caption{\small{ Variation in the frequency as the round-trip is varied.}}
% \label{phasecohenrenceVscapacity}
%\end{figure}

\newcommand{\corep}{p_{c}} 
\section{Coupled dynamics}
\label{section:coupled}
We consider the case where the two sets of TCP flows, from different edge routers, flow through a common core router.
The core router has link capacity $C$, which is less than the sum of the edge router capacities.
Thus the core router forms a bottleneck. Let the link capacity per flow for the core router be $C'$. The queue policy at the core is Drop-Tail. See Figure~\ref{fig:coupled} for the system topology.
 We provide some motivation for the topology that we study. This topology represents a network of three bottlenecked queues; i.e. two edge routers and a core router. Thus it goes beyond a simple single-bottleneck scenario, and is able to account for some network effects. The existence and stability of synchronised states, with TCP and a Drop-Tail queue management policy, is analysed in such a multi-bottlenecked topology.
The dynamical representation for this system for a generalised TCP is 
% We now couple the TCP flows, see Figure \ref{fig:coupled}, where 
% they now also pass through a common core router (with service capacity $C$) which also employs a 
% Drop-Tail queue policy. 
%
%
%
%
%\vspace{-4ex}

\begin{scriptsize}
\begin{align}
  &\dot{\w{}}_{\mym}(t) =\biggl( i\big(\w{\mym}(t)\big)\Bigl(1 - \big(p_{\mym}(t-\tau_{\mym}) +  \corep(t,\tau_1,\tau_2)\big) \Bigr) \label{eq:GenTCPCoupled}   \\
  &- d\bigl(\w{\mym}(t)\bigr)  \bigl(p_{\mym}(t-\tau_{\mym}) +  \corep(t,\tau_1,\tau_2) \bigr) \!\biggr)\!\dfrac{\w{\mym}(t-\tau_{\mym})}{\tau_{\mym}}; \mym=1,2, \notag
\end{align}
\end{scriptsize}
\hspace{-4pt}where $p_{\mym}(t)$ is the packet loss probability in the $\mym^{th}$ \textit{edge} router and $\corep(t,\tau_1,\tau_2)$ is the packet loss probability in the \textit{core} router.
%
%
% 
\begin{figure}[t]
\centering
\begin{tikzpicture}[scale=1.05, transform shape]
%\begin{scope}[transform canvas={scale=0.5}]
    \draw[-] (0.0,2.6) -- (1.1,2.0);
    \draw[-] (0.0,2.0) -- (1.1,2.0);
    \draw[-] (0.0,1.4) -- (1.1,2.0);
    \node at (0.2,1.85) {$\vdots$};
    \draw (1.1,1.6) rectangle(3.0,2.4);
    \draw (2.8,1.6) -- (2.8,2.4);
    \draw (2.6,1.6) -- (2.6,2.4);
    \draw (2.4,1.6) -- (2.4,2.4);   
    \draw (3.42,2.0) circle(0.4cm);
    \node at (3.45,2.0) {$c_1$};
    \node at (1.4,2.0) {$b_1$};
    \node at (2.1,2.0) {$\ldots$};
    \draw[-] (3.82,2.0) -- (4.6,1.2);
    
    \draw[-] (0.0,-0.2) -- (1.1,0.4);
    \node at (0.2,0.25) {$\vdots$};
    \draw[-] (0.0,0.9) -- (1.1,0.4);
    \draw[-] (0.0,0.4) -- (1.1,0.4);
    \draw (1.1,0) rectangle(3.0,0.8);
    \draw (2.8,0) -- (2.8,0.8);
    \draw (2.6,0) -- (2.6,0.8);
    \draw (2.4,0) -- (2.4,0.8);
    \draw (2.2,0) -- (2.2,0.8);
    \node at (1.4,0.4) {$b_2$};
    \node at (3.45,0.4) {$c_2$};
    \node at (1.9,0.4) {$\ldots$};
    \draw (3.42,0.4) circle(0.4cm);
    \draw[-] (3.82,0.4) -- (4.6,1.2);

    \draw (4.6,0.8) rectangle(6.5,1.6);
    \draw (6.3,0.8) -- (6.3,1.6);
    \draw (6.1,0.8) -- (6.1,1.6);
    \draw (5.9,0.8) -- (5.9,1.6);
    \draw (5.7,0.8) -- (5.7,1.6);
    \node at (4.9,1.2) {$B$};
    \node at (6.9,1.2) {$C$};
    \node at (5.4,1.2) {$\ldots$};
    \draw (6.92,1.2) circle(0.4cm);
    \draw[->] (7.32,1.2) -- (8.0,1.2); 
%\end{scope}    
\end{tikzpicture}
\caption{ \small{ \textit{System Topology}: Two sets of  TCP 
flows from distinct edge routers, with different feedback delays, flowing through a common core router. The edge routers have buffer sizes $b_1$ and $b_2$ and the core router has a buffer size of $B$. The edge routers have link capacities $c_1$ and $c_2$ and the core router has a link capacity of $C.$} }
\label{fig:coupled}
\end{figure}
\subsection{Small buffers and Drop-Tail}
From the fluid model approximation for small buffers and Drop-Tail (see Section \ref{subsection:FluidmodelGeneralisedTCP}), the packet loss model at the core router with bursty incoming traffic is
\begin{equation}\small
 \corep(t,\tau_1,\tau_2)=\frac{1}{n_c}\bigg(\frac{\sum_{\myj=1}^{2}\w{\myj}(t-\tau_\myj )/\tau_\myj }{\widetilde{C}}\bigg)^{\frac{B}{n_c}},
\label{eq:corerouterSmall}
\end{equation}
where $B$ is the buffer size, $n_c$ is the burstiness parameter and $\widetilde{C}=2C'.$ Here, $C'$ is the link capacity per flow of the core router. Note that when $n_c=1,$  we obtain the packet loss probability with smooth traffic.
%

%
%We first substitute (\ref{eq:corerouterSmall}) and (\ref{eq:edgeSmall}) into (\ref{eq:GenTCPCoupled}), and let $\weqC{\mym}$
%be the equilibrium of the system~(\ref{eq:GenTCPCoupled}). Then the equilibrium edge and core packet loss probabilities are %$p_{\mym}(\weqC{\mym})$ and $q^*(\weqC{1},\weqC{2})$ are 

%
We first substitute (\ref{eq:corerouterSmall}) and (\ref{eq:edgeSmall_burstyconstant}) into (\ref{eq:GenTCPCoupled}), and
assume that $\weqC{m}$ is the equilibrium of~\eqref{eq:GenTCPCoupled}. Thus, at equilibrium, we have the following packet loss probabilities

\begin{scriptsize}
\begin{equation*}\begin{aligned}
 p_{\mym}(\weqC{\mym}) &= \frac{1}{n_{\mym}}\bigg(\frac{\weqC{\mym}}{c'_{\mym}\tau_{\mym}}\bigg)^{\frac{b_{\mym}}{n_\mym}} \,\,\text{and} & \corep\big(\weqC{1},\weqC{2}\big)&= \frac{1}{n_c}\Biggl(\frac{\sum_{\myj=1}^{2}\weqC{\myj}/\tau_\myj }{\widetilde{C}}\Biggr)^{\frac{B}{n_c}}.
\end{aligned}\end{equation*}
\end{scriptsize}
Let $\w{m}(t)=\weqC{m}+\dw{m}(t)$, and linearising the non-linear system \eqref{eq:GenTCPCoupled}, about the equilibrium $\weqC{m}$, yields

\begin{scriptsize}
\begin{equation}\begin{aligned}
 \varDelta{}\dot{\w{}}_{\mym}(t)  =&\,\,  -\frac{i(\weqC{\mym}) }{\tau_{\mym}} \biggl( g(\weqC{\mym})\dw{\mym}(t)  + \frac{b_{\mym}}{n_{\mym}}\dw{\mym}(t-\tau_{\mym}) \!\biggr) \\ 
	&\,\,    - \Biggl(  \frac{B\weqC{\mym}/\tau_{\mym}}{n_c\sum_{\myj=1}^{2}\weqC{\myj}/\tau_\myj } 
	    \sum_{\myj=1}^{2}\frac{\dw{\myj}(t-\tau_\myj )}{\tau_\myj } \\
	&\,\, - \frac{b_{\mym}}{n_\mym}\frac{\dw{\mym}(t-\tau_{\mym})}{\tau_{\mym}}\Biggr)\frac{i\big(\weqC{\mym}\big)}{1+p_{\mym}\big(\weqC{\mym}\big)/\corep\big(\weqC{1},\weqC{2}\big)} \label{eq:linearSmallCoupledMod2}.
\end{aligned}\end{equation}
\end{scriptsize}
%where $\weqC{\mym}$ is the equilibrium of system (\ref{eq:GenTCPCoupled}).

%
%
%
%
% We work with the assumption that $\corep(.)$ as defined in (\ref{eq:corerouterSmall}) is small, thus the \emph{coupling is weak}.
An underlying assumption in systems that are weakly coupled is that the relative positions of the oscillators would change slowly, compared to their motion around the limit cycle. Thus, the packet loss probability $\corep(.)$ is assumed to be small enough to ensure weak coupling in the system dynamics.    
We now aim to transform (\ref{eq:linearSmallCoupledMod2}) into a model for weakly coupled oscillators.
%  
% This is based on the assumption that the coupling is weak; thus
% $q$ defined as (\ref{eq:corerouterSmall}) is small. 
Hence $\weqC{\mym}\approx\weq{\mym}$, and

\begin{scriptsize}
\begin{equation}\begin{aligned}
 \varDelta{}\dot{\w{}}_{\mym}(t)  =&\,  -\frac{i(\weq{\mym}) }{\tau_{\mym}} \biggl( g(\weq{\mym})\dw{\mym}(t)  + \frac{b_{\mym}}{n_\mym}\dw{\mym}(t-\tau_{\mym}) \biggr) \\ 
	&\,   - \Biggl(  \frac{B\weq{\mym}/\tau_{\mym}}{n_c\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj } 
	    \sum_{\myj=1}^{2}\frac{\dw{\myj}(t-\tau_\myj )}{\tau_\myj } \\
	&\, - \frac{b_{\mym}}{n_m}\frac{\dw{\mym}(t-\tau_{\mym})}{\tau_{\mym}}\Biggr)\frac{i(\weq{\mym})}{1+p_{\mym}(\weq{\mym})/\corep(\weq{1},\weq{2})} \label{eq:linearSmallCoupledMod3}.
\end{aligned}\end{equation}
\end{scriptsize}

We substitute  $\varDelta{}\w{\mym}(t)=r_{\mym} e^{\myi\theta_{\mym}(t)}$ into (\ref{eq:linearSmallCoupledMod3}) to obtain
% 
%
\begin{equation*}\begin{aligned}
 &\myi r_{\mym}e^{\myi\theta_{\mym}(t)}\dot{\theta}_{\mym}(t)   =  -\frac{i(\weq{\mym}) }{\tau_{\mym}} \bigg( g(\weq{\mym})r_{\mym} e^{\myi\theta_{\mym}(t)}  \\ 
	&+ \frac{b_{\mym}}{n_m}r_{\mym} e^{\myi\theta_{\mym}(t-\tau_{\mym})} \bigg)   -  \Biggl(  \frac{B\weq{\mym}/\tau_{\mym}}{n_c\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj } 
	\sum_{\myj=1}^{2}\frac{r_\myj e^{\myi\theta_\myj(t-\tau_\myj )}}{\tau_\myj } \\
	&-  \frac{b_{\mym}}{n_m}\frac{r_{\mym} e^{\myi\theta_{\mym}(t-\tau_{\mym})}}{\tau_{\mym}}  \Biggr)\frac{i(\weq{\mym})}{1+p_{\mym}(\weq{\mym})/\corep(\weq{1},\weq{2})}.
\end{aligned}\end{equation*}
%
Simplifying the above equation, we get
%
\begin{small}
\begin{align}
 \myi\dot{\theta}_{\mym}(t)  =&\,\, - \frac{i(\weq{\mym}) }{\tau_{\mym}} \bigg( g(\weq{\mym}) + \frac{b_{\mym}}{n_\mym} e^{\myi\theta_{\mym}(t-\tau_{\mym})-\myi\theta_{\mym}(t)} \bigg)  \notag \\ 
	&\,\,   - \Biggl( \frac{B\weq{\mym}/\tau_{\mym}}{n_c\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj }\sum_{\myj=1}^{2}\frac{r_\myj e^{\myi\theta_\myj(t-\tau_\myj )-\myi\theta_{\mym}(t)}}{\tau_\myj r_{\mym}} \label{eq:linearSmallCoupledMod1} \\
	&\,\,-  \frac{b_{\mym}}{n_\mym}\frac{e^{\myi\theta_{\mym}(t-\tau_{\mym})-\myi\theta_{\mym}(t)}}{\tau_{\mym}} \Biggr)\frac{i(\weq{\mym})}{1+p_{\mym}(\weq{\mym})/\corep(\weq{1},\weq{2})} \notag .
\end{align}
\end{small}

\vspace{-1ex}
\noindent{}Since the coupling is weak, at the fast time scale, the
oscillators behave almost independently. So $\theta_{\mym}\approx\overline{\theta}_{\mym}$. Thus, (\ref{eq:linearSmallCoupledMod1}) can be written as

\begin{scriptsize}
\begin{equation*}\begin{aligned}
 \myi\dot{\theta}_{\mym}(t)  =&\,\,  -\frac{i(\weq{\mym}) }{\tau_{\mym}} \bigg( g(\weq{\mym})  + \frac{b_{\mym}}{n_\mym} e^{\myi\overline{\theta}_{\mym}(t-\tau_{\mym})-\myi\overline{\theta}_{\mym}(t)} \bigg)   \\
	&\,\, - \Biggl( \frac{B\weq{\mym}/\tau_{\mym}}{n_c\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj }\sum_{\myj=1}^{2}\frac{r_\myj e^{\myi\theta_\myj(t-\tau_\myj )-\myi\theta_{\mym}(t)}}{\tau_\myj r_{\mym}} \\
	&\,\, -  \frac{b_{\mym}}{n_\mym}\frac{e^{\myi\theta_{\mym}(t-\tau_{\mym})-\myi\theta_{\mym}(t)}}{\tau_{\mym}} \Biggr)\frac{i(\weq{\mym})}{1+p_{\mym}(\weq{\mym})/\corep(\weq{1},\weq{2})}.
\end{aligned}\end{equation*}
\end{scriptsize}
%
%
Substituting (\ref{eq:GenTCPthetaSmall}) into the above equation gives

\begin{scriptsize}
\begin{equation*}\begin{aligned}
 \myi\dot{\theta}_{\mym}(t)  =&\,\,  \myi\omega_{\mym}   - \Biggl( \frac{B\weq{\mym}/\tau_{\mym}}{n_c\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj }\sum_{\myj=1}^{2}\frac{r_\myj e^{\myi\theta_\myj(t-\tau_\myj )-\myi\theta_{\mym}(t)}}{\tau_\myj r_{\mym}} \\
 &-  \frac{b_{\mym}}{n_\mym}\frac{e^{\myi\theta_{\mym}(t-\tau_{\mym})-\myi\theta_{\mym}(t)}}{\tau_{\mym}} \Biggr)
 \frac{i(\weq{\mym})}{1+p_{\mym}(\weq{\mym})/\corep(\weq{1},\weq{2})}.
\end{aligned}\end{equation*}
\end{scriptsize}
%
Equating the imaginary part of the above equation, we obtain the following model for coupled oscillators

%
%
\vspace{-2ex}
{\small\begin{align}
 &\dot{\theta}_{\mym}(t)  =  \omega_{\mym}  - \Biggl( \frac{B\weq{\mym}/\tau_{\mym}}{n_c\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj }\sum_{\myj=1}^{2}\frac{r_\myj \sin\big(\theta_\myj(t-\tau_\myj )-\theta_{\mym}(t)\big)}{\tau_\myj r_{\mym}} \notag \\
 &\!\!\!-  \frac{b_{\mym}}{n_\mym}\frac{\sin\big(\theta_{\mym}(t-\tau_{\mym})-\theta_{\mym}(t)\big)}{\tau_{\mym}} \Biggr)\frac{i(\weq{\mym})}{1+p_{\mym}(\weq{\mym})/\corep(\weq{1},\weq{2})}   \label{eq:GenTCPlinearSmallCoupledModFinal}.
\end{align}}
%
%
%
% \paragraph{Remark:} Recall that the $r_{\mym}$ are the oscillation amplitudes.
% They can computed using the techniques followed in \cite{raina}. 
%
\hspace{-3pt}For now we focus on the case where both sets of flows, with respect to the core router, are equally coupled.  \\

\noindent\textit{Equally coupled TCP flows} \\
Let  $b_1=b_2=b$, $c'_1=c'_2=c$, $n_1=n_2=n_e$ and $\tau_1 \approx \tau_2 = \tau$. Then, $\weq{\mym} \,\dot{=}\,\, \w{}^*$ and $r_1 \approx r_2$.
Hence, (\ref{eq:GenTCPlinearSmallCoupledModFinal}) can be expressed as the following model for coupled oscillators
\begin{equation}\begin{aligned}
\dot{\theta}_{\mym}(t) =&\,\, \omega_{\mym} - \frac{B}{2n_c}K_s\!\sum_{\myj=1}^{2}\sin\Bigl(\theta_\myj(t-\tau_\myj )\!-\theta_{\mym}(t)\Bigr)\\ &+ \frac{b}{n_e}K_s\sin\Bigl(\theta_{\mym}(t-\tau_{\mym})-\theta_{\mym}(t)\Bigr) , \label{eq:linearSmallEquallyCoupled}
\end{aligned}\end{equation}
where the \emph{small buffer coupling strength}, $K_s$ is
\begin{equation}\small\begin{aligned}
 K_s   = \frac{i(\weq{})}{\tau\big(1+p(\weq{})/\corep(\weq{},\weq{})\big)}. \label{eq:couplingStrengthSmall}                
\end{aligned}\end{equation}
 %where $c_0=C/2$. \\
%

Note that when the burstiness parameters are set to 1, we obtain the expressions corresponding to smooth traffic. We now consider the intermediate router buffer sizing regime for our analysis.
\subsection{Intermediate buffers and Drop-Tail}
From the fluid model approximation for intermediate buffers and Drop-Tail given in Section \ref{subsection:FluidmodelGeneralisedTCP}, the packet loss model at the core router is
%
\begin{equation}\small
 \corep(t,\tau_1,\tau_2) =\frac{1}{n_c}\biggl(\frac{\big(\sum_{\myj=1}^{2}\w{\myj}(t-\tau_\myj )/\tau_\myj  \big)^{n_c} - \left(\widetilde{C}\right)^{n_c}}{\left(\sum_{\myj=1}^{2}\w{\myj}(t-\tau_\myj )/\tau_\myj\right)^{n_c} } 
\biggr)^+, \label{eq:corerouterIntermediate}
\end{equation}  
where $\widetilde{C}=2C'$, and $C'$ is the link capacity  per flow of the core router.

%We focus on the scenario where the core router is a bottleneck link. 
We first substitute (\ref{eq:corerouterIntermediate}) and (\ref{eqn:edgeIntermediate}) into the coupled TCP model 
(\ref{eq:GenTCPCoupled}), and let $\w{m}(t)=\weqC{m}+\dw{m}(t)$, where $\weqC{m}$ is the equilibrium of (\ref{eq:GenTCPCoupled}). 
Then, linearising the non-linear system~\eqref{eq:GenTCPCoupled},  we get
%

\vspace{-1.5ex}
%\begin{scriptsize}
\begin{align}
  \varDelta{}\dot{\w{}}_{\mym}(t) =  &-\frac{i(\weqC{\mym})g(\weqC{\mym})}{\tau_{\mym}}\dw{\mym}(t) -\bigl( i(\weqC{\mym})  + d(\weqC{\mym})\bigr)  \notag\\ 
		    & \times\Biggl(  \frac{\left(c'_{\mym}\right)^{n_\mym}\tau_{m}^{n_m-1}}{\left(\weqC{\mym}\right)^{n_m}} \dw{\mym}(t-\tau_{\mym})\notag\\
		    &  +  \frac{\left(\widetilde{C}\right)^{n_c}\weqC{\mym}/\tau_{\mym}}{\big(\sum_{\myj=1}^{2}\weqC{\myj}/\tau_\myj \big)^{n_c+1}}\sum_{\myj=1}^{2}\frac{\dw{\myj}(t-\tau_\myj )}{\tau_\myj } \Biggr). \label{eq:GenTCPlinearIntermediateCoupledMod2}    
\end{align}
%\end{scriptsize}
 
Our objective is to transform system (\ref{eq:GenTCPlinearIntermediateCoupledMod2}) into a model for coupled oscillators.
As earlier, we assume that $\corep(.)$ as defined in (\ref{eq:corerouterIntermediate}) is small, thus the \emph{coupling is weak}.
%As done earlier, we aim to transform (\ref{eq:linearIntermediateCoupledMod2}) into a coupled oscillator.
Hence $\weqC{\mym}\approx\weq{\mym}$ and (\ref{eq:GenTCPlinearIntermediateCoupledMod2}) becomes
%
%
%

% \vspace{-2ex}{\small\begin{align}
%   \varDelta{}\dot{\w{}}_{\mym}(t) =&\,\, \frac{i(\weq{\mym})}{\tau_{\mym}}\myf(\weq{\mym})\varDelta{}\w{\mym}(t) -\frac{d(\weq{\mym})c_{\mym}}{\weq{\mym}}\varDelta{}\w{\mym}(t-\tau_{\mym}) \notag \\
% 	 &-\frac{d(\weq{\mym})\weq{\mym}C}{\tau_{\mym}\big({\sum_{\myj=1}^{2}}\weq{\myj}/\tau_\myj \big)^2}\sum_{i=1}^{2}\frac{\varDelta{}w_i(t-\tau_i)}{\tau_i}. \label{eq:GenTCPlinearIntermediateCoupledMod3}
% \end{align}}
\vspace{-1.5ex}\begin{align}
  \varDelta{}\dot{\w{}}_{\mym}(t) &=  -\frac{i(\weq{\mym})g(\weq{\mym})}{\tau_{\mym}}\dw{\mym}(t) -\bigl( i(\weq{\mym})  + d(\weq{\mym})\bigr)  \notag \\ 
		    & \times\Biggl( \frac{ \left(c'_{\mym}\right)^{n_\mym}\tau_{\mym}^{n_m-1}}{\left(\weq{\mym}\right)^{n_\mym}} \dw{\mym}(t-\tau_{\mym})\notag\\
		    & +  \frac{\left(\widetilde{C}\right)^{n_c}\weq{\mym}/\tau_{\mym}}{\big(\sum_{\myj=1}^{2}\weqC{\myj}/\tau_\myj \big)^{n_c+1}}\sum_{\myj=1}^{2}\frac{\dw{\myj}(t-\tau_\myj )}{\tau_\myj } \Biggr).
		     \label{eq:GenTCPlinearIntermediateCoupledMod3}  
\end{align}
%
\hspace{-3.5pt}Substituting  $\varDelta{}\w{\mym}(t)=r_{\mym} e^{\myi\theta_{\mym}(t)}$ into (\ref{eq:GenTCPlinearIntermediateCoupledMod3}), we obtain
% \[\small\begin{aligned}
%     ir_{\mym}&e^{\myi\theta_{\mym}(t)}\dot{\theta}_{\mym}(t) = \frac{i(\weq{\mym})}{\tau_{\mym}}\myf(\weq{\mym})r_{\mym} e^{\myi\theta_{\mym}(t)} -\frac{d(\weq{\mym})c_{\mym}}{\weq{\mym}} \\
% 	&\quad \times r_{\mym} e^{\myi\theta_{\mym}(t-\tau_{\mym})} 
%   -\frac{d(\weq{\mym})\weq{\mym}C}{\tau_{\mym}\big({\scriptstyle\sum_{\myj=1}^{2}}\weq{\myj}/\tau_\myj \big)^2}\sum_{i=1}^{2}\frac{r_i e^{\myi\theta_i(t-\tau_i)}}{\tau_i}.
% \end{aligned}\]
\vspace{0ex}
\begin{scriptsize}\begin{align*}
  \myi r_{\mym}e^{\myi\theta_{\mym}(t)}\dot{\theta}_{\mym}(t) = & -\frac{i(\weq{\mym})g(\weq{\mym})}{\tau_{\mym}}r_{\mym} e^{\myi\theta_{\mym}(t)}  -\bigl( i(\weq{\mym})  + d(\weq{\mym})\bigr)   \notag \\
  & \times\Biggl( \frac{\left(c'_{\mym}\right)^{n_\mym}\tau_{\mym}^{n_m-1}}{\left(\weq{\mym}\right)^{n_\mym}} r_{\mym} e^{\myi\theta_{\mym}(t-\tau_{\mym})}\notag\\
		   & +  \frac{\left(\widetilde{C}\right)^{n_c}\weq{\mym}/\tau_{\mym}}{\big(\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj \big)^{n_c+1}}\sum_{\myj=1}^{2}\frac{r_\myj  e^{\myi\theta_\myj(t-\tau_\myj )}}{\tau_\myj }\Biggr).  
%\label{eq:GenTCPlinearIntermediateCoupledMod2}
\end{align*}
\end{scriptsize}
\hspace{-3pt}Simplifying the above equation, we get
%
% \begin{equation}\small\begin{aligned}
%    i\dot{\theta}_{\mym}(t) =&\,\,\frac{i(\weq{\mym})}{\tau_{\mym}}\myf(\weq{\mym}) -\frac{d(\weq{\mym})c_{\mym}}{\weq{\mym}}e^{\myi\theta_{\mym}(t-\tau_{\mym})-i\theta_{\mym}(t)} \\
% 	 &-\frac{d(\weq{\mym})\weq{\mym}C}{\tau_{\mym}\big(\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj \big)^2}\sum_{i=1}^{2}\frac{r_i e^{\myi\theta_i(t-\tau_i)-i\theta_{\mym}(t)}}{r_{\mym}\tau_i}. \label{eq:linearIntermediateCoupledMod4}
% \end{aligned}\end{equation}
\vspace{0ex}
\begin{scriptsize}\begin{align}
  \myi\dot{\theta}_{\mym}(t) &= -\frac{i(\weq{\mym})g(\weq{\mym})}{\tau_{\mym}} \notag\\
  &- \frac{\bigl( i(\weq{\mym})  + d(\weq{\mym})\bigr)\left(c'_{\mym}\right)^{n_\mym}\tau_{\mym}^{n_m-1}}{\left(\weq{\mym}\right)^{n_\mym}} e^{\myi\theta_{\mym}(t-\tau_{\mym})-\myi\theta_{\mym}(t)}  \notag \\
  &-  \frac{\big( i(\weq{\mym})+d(\weq{\mym}) \big)\left(\widetilde{C}\right)^{n_c}\weq{\mym}/\tau_{\mym}}{\big(\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj \big)^{n_c+1}}\sum_{\myj=1}^{2}\frac{r_\myj e^{\myi\theta_\myj(t-\tau_\myj )-\myi\theta_{\mym}(t)}}{\tau_\myj r_{\mym}}. \label{eq:linearIntermediateCoupledMod4}  
\end{align}
\end{scriptsize}

\vspace{-1ex}\noindent{}Since the coupling is weak, at the fast time scale, the
oscillators behave almost independently. So  $\theta_{\mym}\approx\overline{\theta}_{\mym}$. Thus, (\ref{eq:linearIntermediateCoupledMod4}) can now be written as
%
% \[\small\begin{aligned}
%       i\dot{\theta}_{\mym}(t) =&\,\, \frac{i(\weq{\mym})}{\tau_{\mym}}\myf(\weq{\mym}) -\frac{d(\weq{\mym})c_{\mym}}{\weq{\mym}}e^{\myi\overline{\theta}_{\mym}(t-\tau_{\mym})-i\overline{\theta}_{\mym}(t)}  \\
% 	 &-\frac{d(\weq{\mym})\weq{\mym}C}{\tau_{\mym}\big(\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj \big)^2}\sum_{i=1}^{2}\frac{r_i e^{\myi\theta_i(t-\tau_i)-i\theta_{\mym}(t)}}{r_{\mym}\tau_i}.
% \end{aligned}\]

\begin{scriptsize}
\begin{align}
  \myi\dot{\theta}_{\mym}(t) = &-\frac{i(\weq{\mym})g(\weq{\mym})}{\tau_{\mym}}\notag\\
  & - \frac{\bigl( i(\weq{\mym})  + d(\weq{\mym})\bigr)\left(c'_{\mym}\right)^{n_\mym}\tau_{\mym}^{n_m-1}}{\left(\weq{\mym}\right)^{n_\mym}} e^{\myi\overline{\theta}_{\mym}(t-\tau_{\mym})-\myi\overline{\theta}_{\mym}(t)}  \notag \\
  &-  \frac{\big( i(\weq{\mym})+d(\weq{\mym}) \big)\left(\widetilde{C}\right)^{n_c}\weq{\mym}/\tau_{\mym}}{\big(\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj \big)^{n_c+1}}\sum_{\myj=1}^{2}\frac{r_\myj e^{\myi\theta_\myj(t-\tau_\myj )-\myi\theta_{\mym}(t)}}{\tau_\myj r_{\mym}}.
\end{align}
\end{scriptsize}
Substituting (\ref{eq:thetaGeneralInter}) into the above equation gives
%
% \begin{equation*}\small\begin{aligned}
%        i\dot{\theta}_{\mym}(t) = i\omega_{\mym}  -
%        \frac{d(\weq{\mym})\weq{\mym}C}{\tau_{\mym}\big({\scriptscriptstyle\sum_{\myj=1}^{2}}\weq{\myj}/\tau_\myj \big)^2}{\sum_{i=1}^{2}}\frac{r_i e^{\myi\theta_i(t-\tau_i)-i\theta_{\mym}(t)}}{r_{\mym}\tau_i}.
% \end{aligned}\end{equation*}
\begin{scriptsize}
\begin{equation*}\begin{aligned}
  \myi\dot{\theta}_{\mym}(t) &= \myi\omega_{\mym}-  \frac{\big( i(\weq{\mym})+d(\weq{\mym}) \big)\left(\widetilde{C}\right)^{n_c}\weq{\mym}/\tau_{\mym}}{\big(\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj \big)^{n_c+1}}\sum_{\myj=1}^{2}\frac{r_\myj  e^{\myi\theta_\myj(t-\tau_\myj )-\myi\theta_{\mym}(t)}}{\tau_\myj r_{\mym}}.   
\end{aligned}\end{equation*}
\end{scriptsize}
%
By equating the imaginary part of the above equation, we obtain the following model for
coupled oscillators
%
% \begin{equation}\small\begin{aligned}
% \dot{\theta}_{\mym}&(t)  = \omega_{\mym} \\
%  &\,\,\,\,\,- \frac{d(\weq{\mym})\weq{\mym}C}{\tau_{\mym}\big({\scriptscriptstyle\sum_{\myj=1}^{2}}\weq{\myj}/\tau_\myj \big)^2} 
%    \sum_{i=1}^{2}\frac{r_i \sin\bigl(\theta_i(t-\tau_i)-\theta_{\mym}(t)\bigr)}{r_{\mym}\tau_i}.
%  \label{eq:GenTCPlinearInterCoupledModFinal}
% \end{aligned}\end{equation} \\ 
\begin{scriptsize}
\begin{equation}\begin{aligned}
  &\hspace{-2mm}\dot{\theta}_{\mym}(t) = \omega_{\mym}- \frac{\big( i(\weq{\mym})+d(\weq{\mym}) \big)\left(\widetilde{C}\right)^{n_c}\weq{\mym}/\tau_{\mym}}{\big(\sum_{\myj=1}^{2}\weq{\myj}/\tau_\myj \big)^{n_c+1}}
  \sum_{\myj=1}^{2}\frac{r_\myj  \sin\bigl( \theta_\myj(t-\tau_\myj )- \theta_{\mym}(t)\bigr)}{\tau_\myj r_{\mym}}. \label{eq:GenTCPlinearInterCoupledModFinal}
\end{aligned}\end{equation} 
\end{scriptsize}

\noindent\textit{Equally coupled TCP flows}\\
Let  $c'_1 = c'_2 = c$, $n_1=n_2=n_e$ 
and $\tau_1 \approx \tau_2 = \tau$. Then $\weq{\mym}\,\dot{=}\,\,\weq{}$ and $r_1 \approx r_2$.
Throughout the paper, $\doteq$ is used to denote `defined as'.
Thus (\ref{eq:GenTCPlinearInterCoupledModFinal}) can be expressed as the following model for coupled oscillators
%
\begin{equation} \begin{aligned}
          \dot{\theta}_{\mym}(t) &= \omega_{\mym}  -
   K_i{\sum\limits_{j=1}^{2}}\sin\Bigl(\theta_j(t-\tau_j )-\theta_{\mym}(t)\Bigr), \label{eq:linearIntermediateEquallyCoupled}
\end{aligned}\end{equation}
%
where the \textit{intermediate buffer coupling strength} is
\begin{equation}
 K_i=\frac{\big(i(\weq{}) + d(\weq{})\big)\left(\widetilde{C}\right)^{n_c}}{2^{n_c+1}\left(\weq{}\right)^{n_c}\tau^{1-n_c}}.  \label{eq:couplingStrengthInter}
\end{equation}

Note that when the burstiness parameters are set to 1, we obtain results corresponding to smooth traffic. In the next section, we present the main analytical results of the paper. The results pertain to the phenomenon of \emph{synchronisation} in communication networks when TCP flows are coupled with Drop-Tail queues.
%
\section{Synchronisation}
\label{section:synchronisation}
We now derive the conditions for synchronisation of the small buffer coupled oscillators (\ref{eq:linearSmallEquallyCoupled}) and the intermediate buffer
coupled oscillators (\ref{eq:linearIntermediateEquallyCoupled}) respectively.

%
\subsection{Small buffers}
%The following result provides 
We outline the conditions under which the small buffer coupled oscillators model 
(\ref{eq:linearSmallEquallyCoupled}) would synchronise.\\

%\scalebox{0.8}
{\begin{table}[t]
\centering
\newcolumntype{A}{>{\flushleft\arraybackslash} m{2.4cm} }
\newcolumntype{B}{>{\flushright\arraybackslash} m{2.5cm} }
\newcolumntype{C}{>{\flushright\arraybackslash} m{2.9cm} }
%\newcolumntype{D}{>{\arraybackslash} m{0.05ex} }
\newcolumntype{D}{>{\arraybackslash} l }
\resizebox{8cm}{!}{ 
 \begin{tabular}{ABCD}
 %\begin{tabular}{lrrr}
 \hline \\[-1ex]
     TCP  & \centering \textit{Coupling strength:\\ small buffer  ($K_s$)} 
  & \centering \textit{Coupling strength: \\ intermediate  buffer   ($K_i$)  }  & \\[4ex]
  \hline
  \hline \\[-3ex]
   \textit{Compound}  &  $\displaystyle  \frac{\alpha {\weq{}}^{k-1}}{\tau\left(1  + \frac{(\weq{}/c)^b}{(2\weq{}/\widetilde{C})^B} \right)}$  & 
 $\displaystyle \big( \alpha{\weq{}}^{k-2} + \beta \big)\frac{\widetilde{C}}{4} $   & \\[5ex]
   \textit{Reno} &  $\displaystyle  \frac{1}{\weq{}\tau\left(1  + \frac{(\weq{}/c)^b}{(2\weq{}/\widetilde{C})^B} \right)}$  
  & $\displaystyle \left( \frac{2}{{\weq{}}^2} + 1 \right)\frac{\widetilde{C}}{8}$ &  \\[5ex]
  %\hline
   \textit{Illinois} &  $\displaystyle \frac{\alpha_{max}}{\weq{}\tau\left(1  + \frac{(\weq{}/c)^b}{(2\weq{}/\widetilde{C})^B} \right)}$ 
   & $\displaystyle \left( \frac{1}{{\weq{}}^2} + \beta_{min} \right)\frac{\widetilde{C}}{4}$ &\\[5ex]
  %\hline

  \hline
  \hline
  
 \end{tabular}
 }
 \vspace{8pt}
\caption{Coupling strengths of the transport protocols in small and intermediate Drop-Tail buffers, with smooth traffic.}
\label{table:couplingStrengths}
\end{table}

\newtheorem{thm1}{Theorem}[subsection]
%
\begin{thm1}
Assume that the difference between round-trip delays is small 
for the small buffer coupled oscillators in (\ref{eq:linearSmallEquallyCoupled}), i.e., $\tau_1 \approx \tau_2 = \tau$.
Then $\omega_1 \approx \omega_2 = \omega$. If there exists  $\Omega>0$ and $\phi_0>0$   satisfying
%
\begin{equation}
K_s\frac{B}{n_c}\sin{\phi_0}\cos(\Omega{}\tau)=\omega_2-\omega_1, \label{eq:relOmega1}
\end{equation}
%
and
%
 \begin{equation}
 \Omega{}=\omega+K_s\left(\frac{B}{2n_c}-\frac{b}{n_e}\right)\sin(\Omega\tau)+\frac{K_sB}{2n_c}\sin\bigl(\Omega\tau+\phi_0\bigr), \label{eq:relOmega2}
\end{equation} 
%
then synchronisation between coupled oscillators (\ref{eq:linearSmallEquallyCoupled}) would exist with frequency  $\Omega$ and phase difference $\phi_0$.
The necessary and sufficient condition for local stability of this synchronised state is given by
\begin{equation}
 K_s\left(\frac{B}{n_c}-\frac{b}{n_e}\right)\cos(\Omega\tau) < 0.  \label{eq:couplingstability}
\end{equation}
\end{thm1}
%

\begin{proof}
Using the two relations in (\ref{eq:linearSmallEquallyCoupled}), we form the following phase difference equation
%

\vspace{-2ex}
\begin{scriptsize}
\begin{align}
 &\dot{\theta}_1(t)- \dot{\theta}_2(t) = \omega_1 - \omega_2 \notag\\& -K_s\biggl( \frac{B}{2n_c}-\frac{b}{n_e} \biggr)\biggl[ \sin\Bigl( \theta_1(t-\tau_1) - \theta_1(t) \Bigr) - \sin\Bigl( \theta_2(t-\tau_2) - \theta_2(t) \Bigr) \biggr]\notag\\ &\quad\,\,-\frac{K_sB}{2n_c} \biggl[ \sin\Bigl( \theta_2(t-\tau_2) - \theta_1(t) \Bigr) - \sin\Bigl( \theta_1(t-\tau_1) - \theta_2(t) \Bigr) \biggr]. \label{eq:linearSmallEquallyCoupledMod1} 
\end{align}
\end{scriptsize}

Define $\phi(t)=\theta_1(t)-\theta_2(t)$ as the phase difference between the
oscillators. Let $\phi_0$ be its steady state value obtained by letting $\dot{\phi}=0$. 
%
Then, since $\tau_1 \approx \tau_2$,
 \[ \sin\Bigl( \theta_1(t-\tau_1) - \theta_1(t) \Bigr) - \sin\Bigl(\theta_2(t-\tau_2) - \theta_2(t) \Bigr) = 0, \] 
and
 \[ \theta_1\big(t-\tau_1\big) - \theta_2(t) \approx \theta_2\big(t-\tau_2\big) - \theta_1(t) + 2\phi_0. \] 
From the steady state condition in (\ref{eq:linearSmallEquallyCoupledMod1}), we obtain
%
 \begin{displaymath}
 K_s\frac{B}{n_c}\sin{\phi_0}\cos\Bigl(\theta_2(t-\tau_2) - \theta_1(t) + \phi_0\Bigr) \approx \omega_2 - \omega_1,  
\end{displaymath}
%
which implies that $\theta_2\big(t - \tau_2\big) - \theta_1(t)$, $\theta_2\big(t - \tau_2 \big) - \theta_2(t)$,
 $\theta_1\big(t - \tau_1\big) - \theta_1(t)$, and $\theta_1\big(t-\tau_1\big) - \theta_2(t)$ are constant. Thus
%
 \begin{align}
\dot{\theta}_1(t) 	=& \,\,\, \dot{\theta}_2(t) \notag \\
		=&\,\, \omega_1 - K_s\left(\frac{B}{2n_c} - \frac{b}{n_e}\right)\sin\Bigl(\theta_1\big(t-\tau_1\big) - \theta_1(t)\Bigr) \\
		  &\quad\,\,\,   -\frac{K_sB}{2n_c} \sin\Bigl(\theta_2\big(t-\tau_2\big) - \theta_1(t) \Bigr) \notag \\
		=&\,\, \omega_2 -   \frac{K_sB}{2n_c} \sin\Bigl( \theta_1(t-\tau_1) - \theta_2(t) \Bigr) \\
		   &\quad\,\,\, -K_s\left(\frac{B}{2n_c} - \frac{b}{n_e}\right)\sin\Bigl(\theta_2\big(t-\tau_2\big) - \theta_2(t) \Bigr) \notag \\
		\dot{=}&\,\,  \Omega .\notag
\end{align} 
%
Hence from the steady state conditions,
\[\begin{aligned}
 \theta_1(t)  &=\Omega{}t, \qquad \theta_2(t) =\Omega{}t - \phi_0, \notag \\
 \Omega &= \omega + K_s\left(\frac{B}{2n_c}-\frac{b}{n_e}\right)\sin\bigl(\Omega{}\tau\bigr)+\frac{K_sB}{2}\sin\bigl(\Omega{}\tau+\phi_0\bigr),  \notag
\end{aligned}\]
%
and
\[ K_s
frac{B}{n_c}\sin{\phi_0}\cos(\Omega\tau) = \omega_2 - \omega_1.  \]
%
As $K_s$ increases, $\phi_0$ approaches zero and (\ref{eq:relOmega2}) becomes
\[ \Omega{}=\omega+K_s\left(\frac{B}{n_c}-\frac{b}{n_e}\right)\sin(\Omega\tau). \] 
The expression (\ref{eq:couplingstability}) then follows from the analysis in \cite{strogatzStability}.
%
\end{proof}
%

Note that the theorem provides necessary and sufficient conditions for the local stability of the synchronised state, and the condition for the existence of the state is simply sufficient.

%%
%
\vspace{4pt}
\noindent\textit{Discussion:}

The following insights are worth recapitulating from~\cite{strogatz}: (i) the phenomena of synchronisation occurs spontaneously as the coupling strength crosses a certain critical value, and (ii) that synchronisation occurs even in the presence of distinct delays.           

As far as our system is concerned, it can be shown that synchronisation becomes more prominent as the core buffer size increases. Thus, as the thresholds of the Drop-Tail buffer sizes increase, the more likely we are to witness the onset of synchronised dynamics in the queue sizes. This insight remains consistent for smooth as well as bursty traffic. A similar qualitative insight has been obtained in \cite{debayani1,debayani2}, through a different style of analysis. 

% Our results are in the same spirit as~\cite{hhtc}; however, our analysis is for a generalised TCP model.
We now discuss the stability of the synchronised state for the generalised TCP model.
Let $K_s \in \big(K_{c_s}, K_{u_s}\big)$, where $K_{c_s}$ is the critical coupling strength~\cite{strogatz},  be the range for which equations
(\ref{eq:relOmega1}) -- (\ref{eq:couplingstability}) are feasible. 
 Then,
\begin{enumerate}
 \item[a)] For $K_s < K_{c_s}$, there exists no $\Omega$ and $\phi_0$ for which~\eqref{eq:relOmega1} and~\eqref{eq:relOmega2} are satisfied~\cite{strogatz}.
 Thus synchronisation does not occur.
 \item[b)] For $K_{c_s} < K_s < K_{u_s}$, at least one synchronised state would exist and is locally stable. 
 So the phase difference $\phi_0$ between the oscillators is locked.
 \item[c)] As the coupling strength further increases, the stability condition~\eqref{eq:couplingstability} gets violated. Hence the synchronised state is unstable
 for $K_s > K_{u_s}$. 
\end{enumerate}

Note that in the synchronised range, $\phi_0$ decreases with an increase in the \emph{coupling strength} $K_s$. For large values of $K_s$, $\phi_0$ tends to zero, and the arguments presented in~\cite{hhtc} show that in this limit we get $\Omega \approx \pi/\tau$. Also observe that for large values of $K_s$,  the synchronising frequency is independent of the intrinsic frequencies.

Now consider the complex order parameter, $r(t)e^{\myi\psi(t)}\\= \frac{1}{2}\left(e^{\myi\theta_1(t)}+e^{\myi\theta_2(t)}\right)$. 
The radius $r(t)$ measures the phase coherence between the oscillators, and  the angle $\psi(t)$ is the average phase. 
When the coupled oscillators synchronise, we have $r(t)=\cos(\phi_0/2)$. 
Thus, as the coupling strength $K_s$ increases, $\phi_0$ decreases, which results in increased phase coherence. 
%
%
% \begin{table}[t]
% \centering
% \newcolumntype{A}{>{\arraybackslash} m{1.5cm} }
% \newcolumntype{B}{>{\centering\arraybackslash} m{2.5cm} }
% \newcolumntype{C}{>{\centering\arraybackslash} m{2.5cm} }
% \newcolumntype{D}{>{\arraybackslash} m{0.05ex} }
% %\resizebox{13cm}{!}{
%  \begin{tabular}{ABCD}
%   \hline \\[-2ex]
%     \textit{ TCP}  & \centering \textit{Coupling strength:\\ small buffer  ($K_s$)} 
%   & \centering \textit{Coupling strength: \\ intermediate  buffer   ($K_i$)  }  &\\[7ex]
%   \hline
%   \hline
%    Compound  &  $\displaystyle \quad \beta\frac{C}{2} \left(\frac{2\weq{}}{C\tau}\right)^{B+1}$ & 
%  $\displaystyle\quad \beta\frac{C}{4} $   & \\[7ex]
%    Reno &  $\displaystyle \quad\,\,\, \frac{C}{4}\left(\frac{2\weq{}}{C\tau}\right)^{B+1}$  
%   & $\displaystyle\quad\,\,\, \frac{C}{8}$ &  \\[7ex]
%   %\hline
%    Illinois &  $\displaystyle \beta_{min}\frac{C}{2} \left(\frac{2\weq{}}{C\tau}\right)^{B+1}$ 
%    & $\displaystyle \beta_{min}\frac{C}{4}$ &\\[7ex]
%   %\hline
% 
%   \hline
%   \hline
%  \end{tabular}
%  %}
%  \vspace{8pt}
% \caption{Coupling strengths of the transport protocols in \textit{small} and \textit{intermediate Drop-Tail} buffers. {\color{Green}Change the small buffer coupling strength expressions.}}
% \label{table:couplingStrengths}
% \end{table}

\subsection{Intermediate buffers}
%\label{section:synchronisationIntermediate}
The following result provides the conditions under which the coupled oscillators 
(\ref{eq:linearIntermediateEquallyCoupled}) of the intermediate buffer regime would synchronise.\\

\newtheorem{thm2}{Theorem}[subsection]
%
\begin{thm2}
Assume that the difference between round-trip delays is small 
for the intermediate buffer coupled oscillators in (\ref{eq:linearIntermediateEquallyCoupled}), i.e., $\tau_1 \approx \tau_2 = \tau$.
Then $\omega_1 \approx \omega_2 = \omega$. If there exists  $\Omega>0$ and $\phi_0>0$   satisfying
\begin{equation}
2K_i\sin{\phi_0}\cos(\Omega{}\tau)=\omega_2-\omega_1, \label{eq:relIntermediateOmega1}
\end{equation}
and
\begin{equation}
 \Omega{}=\omega+K_i\sin(\Omega\tau)+K_i\sin\bigl(\Omega\tau+\phi_0\bigr), \label{eq:relIntermediateOmega2}
\end{equation}
then synchronisation between the coupled oscillators (\ref{eq:linearIntermediateEquallyCoupled}) would exist with frequency  $\Omega$ and phase difference $\phi_0$.
The necessary and sufficient condition for local stability of this synchronised state is given by
\begin{equation}
 2K_i\cos(\Omega\tau) < 0.  \label{eq:couplingIntermediatestability}
\end{equation}
\end{thm2}
%
%
\begin{proof}
Using the two relations in (\ref{eq:linearIntermediateEquallyCoupled}), we form the phase difference equation
%

\vspace{-2ex}
{\small \begin{align}
 &\hspace{-1mm}\dot{\theta}_1(t)- \dot{\theta}_2(t) = \omega_1 -\omega_2 \notag \\
      &\hspace{0.5mm} -K_i\biggl[\sin\Bigl(\theta_1(t-\tau_1) - \theta_1(t) \Bigr) 
       - \sin\Bigl(\theta_2(t-\tau_2) - \theta_2(t) \Bigr)\biggr] \label{eq:linearIntermediateEquallyCoupledMod1} \\ 
       &\hspace{0.5mm} -K_i\biggl[ \sin\Bigl( \theta_2(t-\tau_2)- \theta_1(t) \Bigr)
	 - \sin\Bigl(\theta_1(t-\tau_1) - \theta_2(t) \Bigr) \biggr]. \notag	 
\end{align}}
%
\hspace{-4pt}Define $\phi(t)=\theta_1(t)-\theta_2(t)$ as the phase difference between the
oscillators. Let $\phi_0$ denote its steady state value obtained by setting
 $\dot{\phi}=0$. Then, since $\tau_1 \approx \tau_2$,
 \[ \sin\Bigl( \theta_1(t-\tau_1) - \theta_1(t) \Bigr) - \sin\Bigl(\theta_2(t-\tau_2) - \theta_2(t) \Bigr) = 0, \] 
and
 \[ \theta_1(t-\tau_1) - \theta_2(t) \approx \theta_2(t-\tau_2) - \theta_1(t) + 2\phi_0. \]
%
From the steady state condition in (\ref{eq:linearIntermediateEquallyCoupledMod1}), we then obtain
%
 \begin{align}
 2K_i\sin{\phi_0}\cos\Bigl(\theta_2(t-\tau_2) - \theta_1(t) + \phi_0\Bigr) \approx \omega_2 - \omega_1,  
\end{align}
%
which implies that $\theta_2\big(t - \tau_2\big) - \theta_1(t)$, $\theta_2\big(t - \tau_2 \big) - \theta_2(t)$,
 $\theta_1(t - \tau_1) - \theta_1(t)$, and $\theta_1(t-\tau_1) - \theta_2(t)$ are constant. Thus
%
\[\begin{aligned}
\dot{\theta}_1(t) 	=&\,\, \dot{\theta}_2(t) \notag \\
		=&\,\, \omega_1 - K_i\sin\Bigl(\theta_1(t-\tau_1) - \theta_1(t)\Bigr) \\
		       &\quad\,\,\, -  K_i\sin\Bigl(\theta_2(t-\tau_2) - \theta_1(t) \Bigr) \notag \\
		=&\,\, \omega_2 -   K_i\sin\Bigl( \theta_1(t-\tau_1) - \theta_2(t) \Bigr) \\
		     &\quad\,\,\, - K_i\sin\Bigl(\theta_2(t-\tau_2) - \theta_2(t)\Bigr) \notag \\
		\dot{=}&\,\,  \Omega. \notag
\end{aligned}\]
%
%
Thus from the steady state conditions
\begin{displaymath}
\begin{aligned}
 \theta_1(t)  &=\Omega{}t, \qquad \theta_2(t)  =\Omega{}t - \phi_0, \\
 \Omega &= \omega + K_i\sin\bigl(\Omega{}\tau\bigr)+K_i\sin\bigl(\Omega{}\tau+\phi_0\bigr),
\end{aligned}
\end{displaymath}
%
and
\[ 2K_i\sin{\phi_0}\cos\bigl(\Omega\tau\bigr) = \omega_2 - \omega_1.  \]
%
As $K_i$ increases, $\phi_0$ approaches zero and (\ref{eq:relIntermediateOmega2}) becomes
\[ \Omega = \omega + 2K_i\sin\bigl(\Omega{}\tau\bigr). \]
%The expression (\ref{eq:couplingIntermediatestability}) then  follows from the analysis in \cite{strogatzStability}.

We now derive the condition for stability of the synchronised state. In~\cite{strogatzStability}, 
the synchronisation phenomena of the following time delayed coupled oscillators model is studied
\begin{align}
 \dot{\theta}_{\mym}(t) &= \omega + \frac{K}{n}\sum_{\myj=1}^{n}f\Big(\theta_\myj(t-\tau)-\theta_{\mym}(t)\Big). \label{kuramotodelay}
\end{align}
%The coupled oscillators model~\eqref{eq:linearIntermediateEquallyCoupled} is of the form of \eqref{kuramotodelay}, where $n=2$ and $K=-2K_i$.
In~\cite{strogatzStability}, the in-phase ($\phi_0=0$) synchronised state  of~\eqref{kuramotodelay}, which has a collective frequency given by $\Omega=\omega + Kf(-\Omega\tau)$,  
is shown to be linearly stable if and only if
\begin{align*}
 Kf'(-\Omega\tau) > 0.
\end{align*}
Using this result, the \textit{necessary and sufficient} condition for stability  of the  synchronised state 
of the coupled oscillators~\eqref{eq:linearIntermediateEquallyCoupled} may be deduced to be 
\begin{align*}
 2K_i\cos(\Omega\tau) < 0.
\end{align*}

\end{proof}
%

\vspace{2ex}
\noindent\textit{Discussion:}
Note that the coupling strength $K_i$ depends on, and is proportional to, the link capacity. Thus as capacities increase, the phenomena of synchronisation will only get more pronounced.
We also note that as the value of $K_i$ increases, $\phi_0$ decreases, which results in increased phase coherence. Observe that for a large value of $K_i$, the synchronising frequency is independent of the intrinsic frequencies of the two sets of TCP flows.
\\
%\subsection{Discussion on some transport protocols}
%\noindent\textit{Coupling strengths of the transport protocols:}


\subsection{Compound, Reno and Illinois}
Note that the synchronisation phenomena depends on the coupling strengths of the model.
Further, observe from (\ref{eq:couplingStrengthSmall})  and (\ref{eq:couplingStrengthInter}) that both the small and the intermediate buffer coupling strengths depend on the 
functions $i(\w{})$ and $d(\w{})$ of the transport protocols.  
We highlight the coupling strengths for  Compound, Reno and Illinois, in Table \ref{table:couplingStrengths} for both the router buffer limiting regimes. 

As Compound is widely deployed in the Internet, we aim to understand its choice of parameters in greater detail.
We consider the following cases for the Compound parameter $k$.\\

\noindent{}\textit{Case (i)}: $0<k<1$\\
In this case, the small buffer coupling strength is
$$K_s =  \frac{\alpha }{{\weq{}}^{1-k}\tau\big(1+p(\weq{})/\corep(\weq{},\weq{})\big)}.$$
Clearly, an increase in the Compound parameter $\alpha$ can result in the synchronisation of TCP flows.
Further observe that an increase in the window size $\weq{}$ would only make the  system less prone to synchronisation. 
Thus with small buffers, a higher link capacity which would in turn increase $\weq{}$, does not have a synchronising effect on the flows. \\

\noindent{}\textit{Case (ii)}: $k=0$\\
With $k=0$, we obtain
$$K_s =  \frac{\alpha}{\weq{}\tau\big(1+p(\weq{})/\corep(\weq{},\weq{})\big)}.$$
Thus an increase in the window size $\weq{}$ or the round-trip time $\tau$ would make the  system less prone to synchronisation.
Note that with $k=0$, one can get the functional forms for Reno by setting $\alpha=1$ and $\beta=0.5$ and the functional forms for Illinois by setting $\alpha=\alpha_{max}$ and $\beta=\beta_{min}$.
Hence we will have similar conditions in case of Reno and Illinois as the window size is varied.\\

\noindent{}\textit{Case (iii)}: $k=1$\\
In this case,  we have  $i(\weq{})=\alpha$, which does not depend on the equilibrium window size. Hence, we get
$$K_s =  \frac{\alpha}{\tau\big(1+p(\weq{})/\corep(\weq{},\weq{})\big)}.$$
Again, we note that increasing round-trip time $\tau$ would make the system less prone to synchronisation.
 \\
 \begin{figure}[t]
\centering
 \psfrag{100}[c]{\hspace{0.15cm}\scriptsize$100$}
 \psfrag{1000}[c]{\hspace{0.2cm}\scriptsize$1000$}
 \psfrag{10000}[c]{\hspace{0.2cm}\scriptsize$10000$}
 \psfrag{0.9990}{\hspace{-0.20cm}\scriptsize$0.9990$}
 \psfrag{0.9995}{\hspace{-0.20cm}\scriptsize$0.9995$}
 \psfrag{1.0000}{\hspace{-0.25cm}\scriptsize$1.0000$}
 \psfrag{coherence}[b][t]{{Phase coherence, $r(t)$}}
 \psfrag{capacity}[t][t]{{Link capacity, $C$ }}
 \includegraphics[height=3.2in, width=2.15in, angle=-90]{coherence_link_capacity_20_04_14.eps} 
 \caption{\small{ Phase coherence between the oscillators in the intermediate buffer regime as the link capacities are varied. The parameters are as follows:
 the edge and core link capacities $C$ and $1.97\times C$  respectively, with round-trip times $\tau_1=0.10$  and $\tau_2=0.11$.}}
 \label{phasecohenrenceVscapacity}
\end{figure}



 
 
For intermediate buffers, Figure \ref{phasecohenrenceVscapacity} shows the variation in phase coherence, $r(t)$ for Compound TCP with respect to the change in $C$ in the intermediate buffer regime.
The coefficient of the window decrease function, $\beta$ was set to $0.5$. The core link capacity was chosen to be $1.97$ times the edge link capacity so all routers are bottlenecks. 
The round-trip times $\tau_1=0.10$ and $\tau_2=0.11$ were chosen to be close enough so that the synchronisation occurs in the core router. 
%We observe that the phase coherence parameter is close to $1$ and is an increasing function of the link capacity.


\psfrag{0}{\scriptsize$0$}
\psfrag{5}{\scriptsize$5$}
\psfrag{10}{\scriptsize\hspace{-2pt}$10$}
\psfrag{50}{\scriptsize\hspace{-2pt}$50$}
\psfrag{100}{\scriptsize\hspace{-2pt}$100$}
\psfrag{172}{\scriptsize\hspace{-2pt}$172$}
\psfrag{344}{\scriptsize\hspace{-2pt}$344$}
\psfrag{125}{\scriptsize$125$}
\psfrag{(a)}[t][b]{\hspace{1.3cm}{\small\textit{(a) Buffer size = $15$ pkts}}}
\psfrag{(b)}[t][b]{{\small\textit{(b) Buffer size = $100$ pkts}}}
\psfrag{(c)}[t][b]{\hspace{0.2cm}{\small\textit{(c) Buffer size = $344$ pkts}}}
\psfrag{reno}{\small \hspace{-0.7cm}\textit{TCP Reno}}
\psfrag{compound}[c]{\small \hspace{1.6cm}\textit{Compound TCP}}
\psfrag{illinois}[t]{\small \hspace{0.6cm}\textit{TCP Illinois}}
\psfrag{Queue}{\small \hspace{-4.5mm}\textbf{Queue size (pkts)}}
% \newcommand{\myplotHeight}{2.0in}
% \begin{figure*}[p]
% \centering
% 
%           %\psfrag{(c)}{(c)}
%           %\psfrag{Time}[c][t]{\hspace{0.1cm}\begin{tabular}{c} \textbf{Time (s)} \\  $\tau_1=5$ ms and $\tau_2=10$ ms \end{tabular} }
%           %\psfrag{Time}[b]{\hspace{1cm}\begin{tabular}{c} \textbf{Time (s)} \\  $\tau_1=5$ ms and $\tau_2=10$ ms \end{tabular} }
%           \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c}  $\tau_1=5$ ms and $\tau_2=10$ ms \\  \textbf{Time (s)}  \end{tabular} }
%           %
%                 \includegraphics[height=13cm, width=\myplotHeight, angle=-90]{ccdc100_60_5,10} \caption{\small Packet-level simulation traces at the \textit{core} router, for average
%                 round-trip times $\tau_1=5$ ms and $\tau_2=10$ ms. }
%                 \label{fig:5-10droptail}
% \end{figure*}
% %
% \begin{figure*}[p]
% \centering
% %           \psfrag{(a)}{\hspace{1cm}(a) Buffer size = $10$ pkts}
% %           \psfrag{(b)}{\hspace{1cm}(b) Buffer size = $100$ and $358$ pkts}
%           %\psfrag{(c)}{(c)}
%           %\psfrag{Time}[c][t]{\hspace{0.1cm}\begin{tabular}{c} \textbf{Time (s)} \\   \end{tabular} }
%           \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c}  $\tau_1=50$ ms and $\tau_2=55$ ms \\  \textbf{Time (s)}  \end{tabular} }
%           %
%                 \includegraphics[height=13cm, width=\myplotHeight, angle=-90]{ccdc100_60_50,55} \caption{\small Packet-level simulation traces at the \textit{core} router, for average
%                 round-trip times $\tau_1=50$ ms and $\tau_2=55$ ms. }
%                 \label{fig:50-55droptail}
% \end{figure*}
% %
% %
% \begin{figure*}[p]
% \centering
% %           \psfrag{(a)}{\hspace{1cm}(a) Buffer size = $10$ pkts}
% %           \psfrag{(b)}{\hspace{1cm}(b) Buffer size = $100$ and $358$ pkts}
%           %\psfrag{(c)}{(c)}
%           %\psfrag{Time}[c][t]{\hspace{0.1cm}\begin{tabular}{c} \textbf{Time (s)} \\  $\tau_1=50$ ms and $\tau_2=55$ ms \end{tabular} }
%          \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c}  $\tau_1=100$ ms and $\tau_2=110$ ms \\  \textbf{Time (s)}  \end{tabular} }
%           %
%                 \includegraphics[height=13cm, width=\myplotHeight, angle=-90]{ccdc100_60_100,110} \caption{\small Packet-level simulation traces at the \textit{core} router, for average
%                 round-trip times $\tau_1=100$ ms and $\tau_2=110$ ms. As expected from the analysis, note the emergence of limit cycles with a buffer size of $100$ packets, and in the intermediate buffer regime ($344$ packets). 
%                 %As expected from the analysis, the intermediate buffer regime ($344$ packets) also has non-linear oscillations.
%                 }
%                 \label{fig:100-110droptail}
% \end{figure*}
% \begin{figure*}[p]
% \centering
% %           \psfrag{(a)}{\hspace{1cm}(a) Buffer size = $10$ pkts}
% %           \psfrag{(b)}{\hspace{1cm}(b) Buffer size = $100$ and $358$ pkts}
%           %\psfrag{(c)}{(c)}
%           %\psfrag{Time}[c][t]{\hspace{0.1cm}\begin{tabular}{c} \textbf{Time (s)} \\  $\tau_1=50$ ms and $\tau_2=55$ ms \end{tabular} }
%           \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c} {\small $\tau_1=180$ ms and $\tau_2=200$ ms} \\  \textbf{Time (s)}  \end{tabular} }
%           %
%                 \includegraphics[height=13cm, width=\myplotHeight, angle=-90]{ccdc100_60_180,200} \caption{\small Packet-level simulation traces at the \textit{core} router, for average
%                 round-trip times $\tau_1=180$ ms and $\tau_2=200$ ms. As compared to Figure~\ref{fig:100-110droptail}, the non-linear oscillations are more pronounced as the feedback time delays
%                 are larger.
%                 %emerge as buffers vary between $10$ and $100$ packets. 
%                 %Further observe the decrease in the intrinsic frequencies as the round-trip times increase. 
%                 }
%                 \label{fig:180-200droptail}
% \end{figure*}
% 
% 
% 
% 





\input{networkDiagram.tex}




\begin{comment}
\newcommand{\myplotHeight}{3.5in}
\begin{figure*}[p]
\centering
          \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c}  $\tau_1=5$ ms and $\tau_2=10$ ms \\  \textbf{Time (s)}  \end{tabular} }
          %
                \includegraphics[height=15cm, width=15cm, angle=-90]{simulations/RandomCrossTraffic2/ccdc100_60_5,10} 
                \caption{\small Packet-level simulation traces at the \textit{core} router, for average round-trip times $\tau_1=5$ ms and $\tau_2=10$ ms. Observe that for such small round-trip times, the queues do not exhibit oscillations.  }
                \label{fig:5-10droptail}
\end{figure*}
%
\begin{figure*}[p]
\centering
          \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c}  $\tau_1=50$ ms and $\tau_2=55$ ms \\  \textbf{Time (s)}  \end{tabular} }
          %
                \includegraphics[height=13cm, width=\myplotHeight, angle=-90]{simulations/RandomCrossTraffic2/ccdc100_60_50,55} \caption{\small Packet-level simulation traces at the \textit{core} router, for average
                round-trip times $\tau_1=50$ ms and $\tau_2=55$ ms. Observe the onset of oscillations in the queue size dynamics as the buffer size is increased. }
                \label{fig:50-55droptail}
\end{figure*}
%
%
\begin{figure*}[p]
\centering
         \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c}  $\tau_1=100$ ms and $\tau_2=110$ ms \\  \textbf{Time (s)}  \end{tabular} }
          %
                \includegraphics[height=13cm, width=\myplotHeight, angle=-90]{simulations/RandomCrossTraffic2/ccdc100_60_100,110} \caption{\small  Packet-level simulation traces at the \textit{core} router, for average
                round-trip times $\tau_1=100$ ms and $\tau_2=110$ ms. As expected from the analysis, note the emergence of limit cycles with a buffer size of $100$ packets, and in the intermediate buffer regime ($344$ packets). 
                 As expected from the analysis, the intermediate buffer regime ($344$ packets) also has non-linear oscillations. }
                \label{fig:100-110droptail}
\end{figure*}
\begin{figure*}[p]
\centering
%           \psfrag{(a)}{\hspace{1cm}(a) Buffer size = $10$ pkts}
%           \psfrag{(b)}{\hspace{1cm}(b) Buffer size = $100$ and $358$ pkts}
          %\psfrag{(c)}{(c)}
          %\psfrag{Time}[c][t]{\hspace{0.1cm}\begin{tabular}{c} \textbf{Time (s)} \\  $\tau_1=50$ ms and $\tau_2=55$ ms \end{tabular} }
          \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c} {\small $\tau_1=180$ ms and $\tau_2=200$ ms} \\  \textbf{Time (s)}  \end{tabular} }
          \psfrag{Queue}{hspace{1.5cm}\small Queue size (pkts)}
          \psfrag{100}{$100$}
                \includegraphics[height=13cm, width=\myplotHeight, angle=-90]{simulations/RandomCrossTraffic2/ccdc100_60_180,200} \caption{\small  Packet-level simulation traces at the \textit{core} router, for average
                round-trip times $\tau_1=180$ ms and $\tau_2=200$ ms. As compared to Figure~\ref{fig:100-110droptail}, the non-linear oscillations are more pronounced as the feedback time delays
                 are larger.   }
                \label{fig:180-200droptail}
\end{figure*}
\end{comment}





%\newpage
%
\section{Packet-level simulations}   
%
\label{section:simulations}
%
We now conduct some packet-level simulations, using version 2.35 of the Network Simulator~\cite{ns2} for Compound TCP and Illinois. The topology consists of \emph{two edge routers}, each with a capacity of $100$ Mbps, feeding into a \emph{common core router} which has capacity $197$ Mbps. Note that with this choice of capacities, we obtain a bottlenecked system. The system topology is shown in Figure~\ref{fig:crosstraffic}. 
In Figure~\ref{fig:crosstraffic}, $E_1$ and $E_2$ are the edge routers, $C$ is the core router, and $D$ is the destination for the bulk traffic sources. $S_{ct}$ and $D_{ct}$ corresponds
to the source and destination routers for the cross traffic. The router $S_{ct}$ has a capacity of $10$ Mbps.
For the bulk of the traffic, the system has two sets of $60$ long-lived TCP flows, where each flow has a $2$ Mbps access link. To incorporate burstiness in the incoming traffic, we then increase the speed of the access links, keeping the offered load fixed. To achieve this, we consider a scenario with $20$ long-lived TCP flows, each over an access link of $6$ Mbps. Each set of TCP flows goes through a separate edge router. The round-trip times of the flows are varied from $5$ ms to $200$ ms.
The difference between round-trip times of the different sets of flows were kept small.
We also introduce cross traffic which include both short-lived flows and $6$ long-lived flows, each with a $1$ Mbps access link, as shown in Figure~\ref{fig:crosstraffic}. 
For short-lived flows, it is assumed that they are all accessing a web server, and in doing so each flow generates $5$KB of data.
These short-lived HTTP flows are generated at a rate of $50$ flows per second.
%For one set of flows, the average round-trip times are fixed at $10$ ms. 
%For the other set of flows, the average round-trip times are either $100$ ms or $200$ ms. 
The packet size is set to $1500$ bytes. In the case of small buffers, we consider two scenarios to show the impact of buffer sizes on the coupling between the two sets of flows, and in turn on the synchronization: $(i)$ Buffer sizes of all routers are fixed at $15$ packets, and (ii) Buffer sizes of all routers are fixed at $100$ packets. We plot the average window sizes of two sets of Compound TCP flows for these scenarios, see Figure 4. We can observe that, as buffer sizes increase, the system exhibits more pronounced oscillations among the TCP flows, which accurately aligns with our analytical insights. 

In the case of intermediate buffers, the prescribed dimensioning rule is $B=c*\overline{RTT}/\sqrt{N}$.
%where in practice a fixed value of $250$~ms is used for the average round-trip time. 
An estimate of the average round-trip time is needed to dimension router buffers. In practice, this will be highly variable but one needs to choose a fixed value to build routers. Thus, a value of $250$ ms is used for $\overline{RTT}$, by router vendors, to dimension router buffers \cite{part1}. Our analytical insights reveal that in this buffer sizing regime, increasing the capacity would increase the coupling strength, which would in turn increase the degree of synchronization among the two sets of TCP flows. 
In this buffer regime, we consider two scenarios: $(i)$ The edge routers have $270$ packets and the core router has $375$ packets, the edge capacities are fixed at $100$ Mbps, and the core router capacity is considered to be $197$ Mbps, and $(ii)$  The edge routers have $380$ packets and the core router has $530$ packets, the edge capacities are fixed at $200$ Mbps, and the core router capacity is considered to be $395$ Mbps. We now plot the average window sizes of two sets of Compound TCP flows, shown in Figure 5. We note that as capacities increase, the degree of synchronization also increases, thus validating our analysis.  
%\balance



Note that this synchronization among the TCP flows leads to emergence of limit cycles in the queue size dynamics.  Figures~\ref{fig:5-10droptail},~\ref{fig:50-55droptail},~\ref{fig:100-110droptail},~\ref{fig:180-200droptail} show the queue dynamics at the core router with smooth traffic,  as the feedback delay is progressively
increased. There is a clear change in the dynamics of the queue size.
Figure \ref{fig:100-110droptail} represents the scenario where the two sets of TCP flows have round-trip times of $100$ ms and $110$ ms.
In the small buffer regime, as the buffer varies between $15$ and $100$ packets we see the onset of limit cycles in the queue size.
With intermediate buffers, we again observe non-linear oscillations. A similar insight holds even with bursty traffic, see Figure \ref{fig:100-110droptail_bursty}.
When the round-trip times were increased to $180$ and $200$ ms respectively, the limit cycles get more pronounced; see Figure \ref{fig:180-200droptail}. 
Observe from Figures \ref{fig:100-110droptail} and  \ref{fig:180-200droptail} that the intrinsic frequency depends on the transport protocol.
Also note that an increase in the round-trip time results in a decrease in the intrinsic frequency, which is in agreement with the analysis.
Note that with buffers of size $15$ packets, the system did not exhibit limit cycles in the queue~size~dynamics.

In the packet-level simulations, we observed the emergence of a synchronised state in the average window sizes among two sets of TCP flows, and also the  existence of limit cycles in the queue size dynamics, in the regime where the bandwidth-delay product is large and as the Drop-Tail buffer gets larger. An insight obtained is that in large bandwidth-delay environments, the stochastic effects of the queue get drowned out, and the non-linear dynamics of the underlying feedback control system start to dominate. 
%
With very small buffers, we expect a higher average loss rate. Within reason, one may prefer to deal with a higher loss rate, as compared to larger queuing delays. TCP is fairly adept at dealing with packet-losses, but queuing delays only serve to hurt everyone.

%{\color{blue} Early work in~\cite{FloydPhase} suggests that loss synchronisation could be exaggerated by simulations. The extent to which the phenomena of synchronisation itself is exaggerated by simulations, as compared to a real experiment, is currently beyond the scope of this paper. This could be worthy of further investigation, especially for practically implemented transport protocols like Compound.}

\newcommand{\myplotHeight}{3.5in}
\begin{figure*}[p]
\centering
          \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c}  $\tau_1=5$ ms and $\tau_2=10$ ms \\  \textbf{Time (s)}  \end{tabular} }
          \psfrag{530}{$380$}
          \psfrag{200}{$100$}
          \psfrag{250}{$150$}
          \psfrag{40}{$40$}
            \psfrag{10}{$10$}
            \psfrag{a}{\hspace{-10mm}Buffer Size = $15$ packets}
            \psfrag{aaa}{Set $1$}
             \psfrag{xyz}{Set $2$}
             \psfrag{b}{\hspace{-20mm}Buffer Size = $100$ packets}
          \psfrag{y}{\hspace*{2mm}Average Window Size (pkts)}
          \psfrag{x}{\hspace{-5mm}Time (seconds)}
          \psfrag{illinois}{\vspace{-2mm}\hspace{-6mm}\textit{TCP Illinois}}
                \includegraphics[height=15cm, width=7.5cm, angle=-90]{plot_1.eps} 
                \caption{Packet-level simulation traces of average window sizes with smooth traffic, for small buffer regime. Observe that for larger buffers, the degree of synchronization is higher. }
                \label{fig:15-100droptail}
\end{figure*}

\begin{figure*}[p]
\centering
          \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c}  $\tau_1=5$ ms and $\tau_2=10$ ms \\  \textbf{Time (s)}  \end{tabular} }
          \psfrag{530}{$530$}
          \psfrag{200}{$100$}
          \psfrag{250}{$150$}
          \psfrag{40}{$40$}
            \psfrag{10}{$10$}
            \psfrag{a}{\hspace{-10mm}Edge capacity = $100$ Mbps}
            \psfrag{aaa}{Set $1$}
             \psfrag{xyz}{Set $2$}
             \psfrag{b}{\hspace{-20mm}Edge capacity = $200$ Mbps}
          \psfrag{y}{\hspace*{2mm}Average Window Size (pkts)}
          \psfrag{x}{\hspace{-5mm}Time (seconds)}
          \psfrag{illinois}{\vspace{-2mm}\hspace{-6mm}\textit{TCP Illinois}}
                \includegraphics[height=15cm, width=7.5cm, angle=-90]{plot_2.eps} 
                \caption{Packet-level simulation traces of average window sizes with smooth traffic, for intermediate buffer regime. Observe that for larger capacities, the degree of synchronization is higher.  }
                \label{fig:100-200droptail}
\end{figure*}
\begin{figure*}[p]
\centering
          \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c}  $\tau_1=5$ ms and $\tau_2=10$ ms \\  \textbf{Time (s)}  \end{tabular} }
          \psfrag{530}{$375$}
          \psfrag{100}{$100$}
          \psfrag{125}{$125$}
          \psfrag{0}{$0$}
            \psfrag{10}{$15$}
            \psfrag{(c)}{\hspace{-16mm}\small\textit{\vspace{1cm}(c) Buffer size = $375$ pkts }}
          \psfrag{Queue}{\small\hspace{0.75cm}\textbf{Queue Size (pkts)}}
          \psfrag{illinois}{\vspace{-2mm}\hspace{-6mm}\textit{TCP Illinois}}
                \includegraphics[height=15cm, width=15cm, angle=-90]{tcp_5_10.eps} 
                \caption{Packet-level simulation traces at the \textit{core} router with smooth traffic, for average round-trip times $\tau_1=5$ ms and $\tau_2=10$ ms. Observe that for such small round-trip times, the queues do not exhibit oscillations.  }
                \label{fig:5-10droptail}
\end{figure*}
%
\begin{figure*}[p]
\centering
          \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c}  $\tau_1=50$ ms and $\tau_2=55$ ms \\  \textbf{Time (s)}  \end{tabular} }
          \psfrag{530}{$375$}
          \psfrag{100}{$100$}
          \psfrag{125}{$125$}
          \psfrag{0}{$0$}
            \psfrag{10}{$15$}
            \psfrag{(c)}{\hspace{-16mm}\small\textit{\vspace{1cm}(c) Buffer size = $375$ pkts }}
          \psfrag{Queue}{\small\hspace{0.75cm}\textbf{Queue Size (pkts)}}
          \psfrag{illinois}{\vspace{-2mm}\hspace{-6mm}\textit{TCP Illinois}}
                \includegraphics[height=15cm, width=15cm, angle=-90]{tcp_50_55.eps}  \caption{ Packet-level simulation traces at the \textit{core} router with smooth traffic, for average
                round-trip times $\tau_1=50$ ms and $\tau_2=55$ ms. Observe the onset of oscillations in the queue size dynamics as the buffer size is increased. }
                \label{fig:50-55droptail}
\end{figure*}
%
%
\begin{figure*}[p]
\centering
         \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c}  $\tau_1=100$ ms and $\tau_2=110$ ms \\  \textbf{Time (s)}  \end{tabular} }
          \psfrag{530}{$375$}
          \psfrag{100}{$100$}
          \psfrag{125}{$125$}
          \psfrag{0}{$0$}
            \psfrag{10}{$15$}
            \psfrag{(c)}{\hspace{-16mm}\small\textit{\vspace{1cm}(c) Buffer size = $375$ pkts }}
          \psfrag{Queue}{\small\hspace{0.75cm}\textbf{Queue Size (pkts)}}
          \psfrag{illinois}{\vspace{-2mm}\hspace{-6mm}\textit{TCP Illinois}}
                \includegraphics[height=15cm, width=15cm, angle=-90]{tcp_100_110.eps}  \caption{  Packet-level simulation traces at the \textit{core} router with smooth traffic, for average
                round-trip times $\tau_1=100$ ms and $\tau_2=110$ ms. As expected from the analysis, note the emergence of limit cycles with a buffer size of $100$ packets, and in the intermediate buffer regime ($375$ packets). 
                 As expected from the analysis, the intermediate buffer regime ($375$ packets) also has non-linear oscillations. }
                \label{fig:100-110droptail}
\end{figure*}
\begin{figure*}[p]
\centering
%           \psfrag{(a)}{\hspace{1cm}(a) Buffer size = $10$ pkts}
%           \psfrag{(b)}{\hspace{1cm}(b) Buffer size = $100$ and $358$ pkts}
          %\psfrag{(c)}{(c)}
          %\psfrag{Time}[c][t]{\hspace{0.1cm}\begin{tabular}{c} \textbf{Time (s)} \\  $\tau_1=50$ ms and $\tau_2=55$ ms \end{tabular} }
          \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c} {\small $\tau_1=180$ ms and $\tau_2=200$ ms} \\  \textbf{Time (s)}  \end{tabular} }
          \psfrag{530}{$375$}
          \psfrag{100}{$100$}
          \psfrag{125}{$125$}
          \psfrag{0}{$0$}
            \psfrag{10}{$15$}
            \psfrag{(c)}{\hspace{-16mm}\small\textit{\vspace{1cm}(c) Buffer size = $375$ pkts }}
          \psfrag{Queue}{\small\hspace{0.75cm}\textbf{Queue Size (pkts)}}
          \psfrag{illinois}{\vspace{-2mm}\hspace{-6mm}\textit{TCP Illinois}}
                \includegraphics[height=15cm, width=15cm, angle=-90]{tcp_180_200.eps} \caption{  Packet-level simulation traces at the \textit{core} router with smooth traffic, for average
                round-trip times $\tau_1=180$ ms and $\tau_2=200$ ms. As compared to Figure~\ref{fig:100-110droptail}, the non-linear oscillations are more pronounced as the feedback time delays
                 are larger.   }
                \label{fig:180-200droptail}
\end{figure*}
\begin{figure*}[p]
\centering
         \psfrag{Time}[c]{\small \hspace{1cm}\begin{tabular}{c}  $\tau_1=100$ ms and $\tau_2=110$ ms \\  \textbf{Time (s)}  \end{tabular} }
          \psfrag{530}{$375$}
          \psfrag{100}{$100$}
          \psfrag{125}{$125$}
          \psfrag{0}{$0$}
            \psfrag{10}{$15$}
            \psfrag{(c)}{\hspace{-16mm}\small\textit{\vspace{1cm}(c) Buffer size = $375$ pkts }}
          \psfrag{Queue}{\small\hspace{0.75cm}\textbf{Queue Size (pkts)}}
          \psfrag{illinois}{\vspace{-2mm}\hspace{-6mm}\textit{TCP Illinois}}
                \includegraphics[height=15cm, width=15cm, angle=-90]{tcp_100_110_20.eps}  \caption{  Packet-level simulation traces at the \textit{core} router with bursty traffic, for average round-trip times $\tau_1=100$ ms and $\tau_2=110$ ms. As expected from the analysis, note the emergence of limit cycles with a buffer size of $100$ packets, and in the intermediate buffer regime ($375$ packets). 
                 As expected from the analysis, the intermediate buffer regime ($375$ packets) also has non-linear oscillations. }
                \label{fig:100-110droptail_bursty}
\end{figure*}
%\balance
%\newpage
\section{Contributions}
\label{section:conclusion}

We analysed fluid models of Compound, Reno and Illinois coupled with Drop-Tail, in a small and an intermediate buffer regime. As Compound TCP and Drop-Tail queues are both widely implemented, they form an important part of network performance evaluation.
%
% As Compound TCP and Drop-Tail queues are both widely implemented, they form an integral part of network performance evaluation. We analysed fluid models of Compound, Reno and Illinois coupled with Drop-Tail, in a small and an intermediate buffer regime.
%
The style of analysis we employ, for the fluid models, is inspired by time delayed coupled oscillators~\cite{strogatz}. A key focus was on \emph{synchronisation} between the two sets of TCP flows, where each set had a different feedback delay. The two sets of flows were regulated by separate edge routers, which then merge at a common core router. For both buffer sizing regimes the condition under which synchronisation occurs were made explicit in terms of \emph{coupling strengths}.                                    

With \emph{small buffers}, the coupling strength depends on both protocol and network parameters. In particular, larger buffer sizes readily induce synchronisation. With \emph{intermediate buffers}, the coupling strength is directly proportional to the link capacity. So high-speed networks, with intermediate buffers and Drop-Tail would be prone to synchronisation. 
We conducted packet-level simulations to validate some of our analytical insights. Synchronisation, in the form of limit cycles, was indeed observed in the queue size with both larger buffer sizes and feedback delays. In high-speed networks, small buffers can be chosen to ensure low-latency and system stability. So in terms of network design, small buffers appear more appealing than intermediate buffers; at least with Drop-Tail queue management.             

Going forward, it would be valuable to study the underlying system when different queue policies, like 
the well-known RED~\cite{red} and REM~\cite{rem} policies, are employed at the bottleneck queues. Such studies would naturally lead to a better and quantitative understanding of network performance and dynamics.  

% For one-column wide figures use
%\begin{figure}
%% Use the relevant command to insert your figure file.
%% For example, with the graphicx package use
%  \includegraphics{example.eps}
%% figure caption is below the figure
%\caption{Please write your figure caption here}
%\label{fig:1}       % Give a unique label
%\end{figure}
%%
%% For two-column wide figures use
%\begin{figure*}
%% Use the relevant command to insert your figure file.
%% For example, with the graphicx package use
%  \includegraphics[width=0.75\textwidth]{example.eps}
%% figure caption is below the figure
%\caption{Please write your figure caption here}
%\label{fig:2}       % Give a unique label
%\end{figure*}
%%
%% For tables use
%\begin{table}
%% table caption is above the table
%\caption{Please write your table caption here}
%\label{tab:1}       % Give a unique label
%% For LaTeX tables use
%\begin{tabular}{lll}
%\hline\noalign{\smallskip}
%first & second & third  \\
%\noalign{\smallskip}\hline\noalign{\smallskip}
%number & number & number \\
%number & number & number \\
%\noalign{\smallskip}\hline
%\end{tabular}
%\end{table}


%\begin{acknowledgements}
%If you'd like to thank anyone, place your comments here
%and remove the percent signs.
%\end{acknowledgements}


% Authors must disclose all relationships or interests that 
% could have direct or potential influence or impart bias on 
% the work: 
%
% \section*{Conflict of interest}
%
% The authors declare that they have no conflict of interest.


% BibTeX users please use one of
%\bibliographystyle{spbasic}      % basic style, author-year citations
%\bibliographystyle{spmpsci}      % mathematics and physical sciences
%\bibliographystyle{spphys}       % APS-like style for physics
%\bibliography{}   % name your BibTeX data base

% Non-BibTeX users please use
\begin{thebibliography}{}
%
% and use \bibitem to create references. Consult the Instructions
% for authors for reference list style.
%
\bibitem{mckoewn} G.~Appenzeller, I.~Keslassy and N.~McKeown,
``Sizing router buffers'',
\textit{ACM SIGCOMM Computer Communication Review}, vol.~34, pp.~281--292, 2004.
\bibitem{rem}
S.~Athuraliya, S.H.~Low, V.H.~Li and Q.~Yin, 
``REM: Active Queue Management'', 
\emph{IEEE Network}, vol. 15, pp. 48--53, 2001.
\bibitem{Ayesta}
U.~Ayesta, K.E.~Avrachenkov, E.~Altman, C.~Barakat and P.~Dube, ``Multilevel approach for modeling short TCP sessions", \emph{Teletraffic Science and Engineering, Elsevier}, vol.~5, pp.~661--670, 2003.
% \bibitem{syncSensorNetwork} S.~Barbarossa and G.~Scutari, 
% ``Bio-inspired sensor network design'', 
% \textit{IEEE Signal Processing Magazine}, vol.~24, pp.~26-35, 2007. 
%

%



\bibitem{buck}
J.~Buck, 
``Synchronous rhythmic flashing of fireflies II'', 
\textit{The Quarterly Review of Biology}, vol.~63, pp.~265--289, 1988.
%
\bibitem{Poisson_limit}
J.~Cao and K.~Ramanan, ``A Poisson limit for buffer overflow probabilities", in \emph{Proceedings of IEEE INFOCOM}, 2002.
\bibitem{Doldo} P.~Doldo, J.~Pender and R.~Rand ``Breaking the symmetry in queues with delayed information'', \emph{International Journal of Bifurcation and Chaos}, vol.~31, pp.~2130027, 2021.
\bibitem{sync2}
F.~D\"{o}rfler and F.~Bullo, ``On the critical coupling for Kuramoto oscillators'', \textit{SIAM Journal on Applied Dynamical Systems}, vol.~10, pp.~1070-1099, 2011.

\bibitem{syncpower1} F.~D\"{o}rfler  and F.~Bullo, 
``Synchronization and transient stability in power networks and non-uniform Kuramoto oscillators'', 
\textit{SIAM Journal on Control and Optimization}, vol.~50, pp.~1616--1642, 2012.

%
\bibitem{strogatzStability}
M.G.~Earl and S.H.~Strogatz, 
``Synchronization in oscillator networks with delayed coupling: a stability criterion'',
\textit{Physical Review E}, vol.~67, pp.~03624, 2003.

\bibitem{S2}
M.~Enachescu, Y.~Ganjali, A.~Goel, N.~McKeown and  T.~Roughgarden, ``Part III: Routers with very small buffers", \emph{ACM SIGCOMM Computer Communication Review,} vol.~35, pp.~83--90, 2005.
\bibitem{syncpower2} G.~Filatrella, A.H.~Nielsen and N.F.~Pedersen, 
``Analysis of a power grid using a Kuramoto-like model'', 
\textit{The European Physical Journal B}, vol.~61, pp.~485--491, 2008.
%
\bibitem{red}
S. Floyd and V. Jacobson, ``Random Early Detection gateways for congestion avoidance'',
\emph{IEEE/ACM Transactions on Networking}, vol. 1, pp. 397--413, 1993.

\bibitem{FloydPhase}
S.~Floyd and V.~Jacobson, 
``On traffic phase effects in packet-switched gateways'',
\textit{Internetworking: Research and Experience}
vol.~3 pp.~115-156, 1992.

%\newpage
\bibitem{bufferbloat}
J.~Gettys and K.~Nichols, 
``Bufferbloat: dark buffers in the Internet'', 
\textit{Communications of the ACM}, vol.~55, pp.~57--65, 2012.
\bibitem{debayani1}
D.~Ghosh, K.~Jagannathan and G.~Raina, ``Local stability and Hopf bifurcation analysis for Compound TCP", \emph{IEEE Transactions of Control of Network Systems}, vol. 5, pp. 1668--1681, 2018. 
\bibitem{debayani2}
D.~Ghosh, K.~Jagannathan and G.~Raina, ``Right buffer sizing matters: stability, queuing delay and traffic burstiness in compound TCP", \emph{Performance Evaluation}, vol. 139, pp. 102095, 2020.
%
\bibitem{nonlinear} J.~Guckenheimer and P.~Holmes, 
\textit{Nonlinear Oscillations, Dynamical Systems, and Bifurcations of Vector Fields}. New York: Springer-Verlag, 1996.
%
\bibitem{hhtc} H.~Han,  C.V.~Hollot, D.~Towsley and Y.~Chait, 
``Synchronization of TCP flows in networks with small Drop-Tail buffers'', 
in \textit{Proceedings of IEEE Conference on Decision and Control and European Control Conference}, 2005.
\bibitem{corella}A.~Juancho.~Collera, ``Bistable Limit Cycles and Quasi-Periodic Oscillations in Queues with Delayed Information'', \emph{Symmetry}, vol.~14, pp.~376, 2022.
\bibitem{kuramoto1} Y.~Kuramoto, 
\textit{Chemical oscillations, waves, and turbulence}. Dover Publications, 2003.
%
% \bibitem{reno} M.~Hassan and R.~Jain, 
% \textit{High performance TCP/IP networking: concepts, issues and solutions}. 
\bibitem{pender4}
F.~Lakrad, J.~Pender and R.~Rand, ``Queues with delayed information: A dynamical systems perspective'' \textit{SIAM Journal on Applied Dynamical Systems}, vol.~21, pp.~676-713, 2022.
% New Jersey: Prentice Hall, 2004.
\bibitem{Lakshmikantha}
A.~Lakshmikantha, C.~Beck and R.~Srikant, ``Impact of file arrivals and departures on buffer sizing in core routers", \emph{IEEE/ACM Transactions on Networking (TON)}, vol.~19, pp.~347--358, 2011.
\bibitem{illinois} S.~Liu, T.~Basar and R.~Srikant, 
``TCP-Illinois: A loss and delay-based congestion control algorithm for high-speed networks'', 
\textit{Performance Evaluation}, vol.~65, pp.~417--440, 2006.
%
%
\bibitem{ccdc} N.~Malangadan, H.~Rahman and G.~Raina, 
``Non-linear oscillations in TCP networks with Drop-Tail buffers'',
in \textit{Proceedings of Chinese Control and Decision Conference}, 2013.
%
\bibitem{queue_delay}
K.~Nichols and V.~Jacobson, 
``Controlling queue delay'', 
\textit{Communications of the ACM}, vol.~55, pp.~42--50, 2012.
%
%
\bibitem{pender2}
S.~Novitzky, J.~Pender, R.H.~Rand and E.~Wesson,  ``Nonlinear dynamics in queueing theory: Determining the size of oscillations in queues with delay'', \textit{SIAM Journal on Applied Dynamical Systems}, vol.~18, pp.~279--311, 2019.

\bibitem{pender3}
S.~Novitzky, J.~Pender, R.H.~Rand and E.~Wesson, ``Limiting the oscillations in queues with delayed information through a novel type of delay announcement'', \textit{Queueing Systems}, vol.~95, pp.~281-330, 2020.

%
%
%
\bibitem{renoTowsley}
J.~Padhye, V.~Firoiu, D.~Towsley  and  J.F.~Kurose, 
``Modeling TCP Reno performance: a simple model and its empirical validation'',
\textit{IEEE/ACM Transactions on Networking}, vol.~8, pp.~133--145, 2000.
\bibitem{pender11}
J.~Pender, R.H.~Rand and E.~Wesson, ``Queues with choice via delay differential equations'', \textit{International Journal of Bifurcation and Chaos}, vol.~27, pp. 1730016-1--1730016-20, 2017.
\bibitem{pender5}
J.~Pender, R.H.~Rand and E.~Wesson, ``An analysis of queues with delayed information and time-varying arrival rates'', \emph{Nonlinear Dynamics}, vol.~ 91, pp.~2411-2427, 2018.

\bibitem{pender6}
J.~Pender, R.~H.~Rand and E.~Wesson, ``A stochastic analysis of queues with customer choice and delayed information'', \emph{Mathematics of Operations Research}, vol.~45, pp.~1104-1126, 2020.  
%
\bibitem{peskin}  C.S.~Peskin, \textit{Mathematical Aspects of Heart Physiology}.
 New York: New York University, Courant Institute of Mathematical Sciences, 1975.
% 
%
% \bibitem{haseen} H.~Rahman, K.~Giridhar and G.~Raina, 
% ``Performance analysis of Compound TCP with AQM'',
% in \textit{Proceedings of International Symposium on Modeling and Optimization in Mobile, Ad Hoc, and Wireless Networks}, 2013.
%
\bibitem{raina} G.~Raina, 
``Local bifurcation analysis of some dual congestion control algorithms'',
 \textit{IEEE Transactions on Automatic Control}, vol.~50, pp.~1135--1146, 2005.
 \bibitem{raja} G.~Raina, S.~Manjunath, S.~Prasad and K.~Giridhar, ``Stability and performance analysis of compound TCP with REM and drop-tail queue management'', \emph{IEEE/ACM Transactions on Networking}, vol.~24, pp.~1961--1974, 2015.
%
\bibitem{rtw} G.~Raina, D.~Towsley and D.~Wischik, 
``Part II: Control theory for buffer sizing'', 
\textit{ACM SIGCOMM Computer Communication Review}, vol.~35, pp.~79--82, 2005.
%
\bibitem{rw} G.~Raina and D.~Wischik, 
``Buffer sizes for large multiplexers: TCP queueing theory and instability analysis'', 
in \textit{Proceedings of Next Generation Internet Networks}, 2005.
%

%
% \bibitem{renomjs}
% S.~Raman, A.~Mohan and G.~Raina,
% ``TCP Reno and queue management: local stability and Hopf bifurcation analysis'',
% in \textit{Proceedings of IEEE Conference on Decision and Control}, 2013.
%
\bibitem{srikant}
R.~Srikant,  \textit{The mathematics of Internet congestion control}. Birkha\"{a}user, 2004.
%
\bibitem{kuramoto2}
S.H.~Strogatz,   
``From Kuramoto to Crawford: exploring the onset of synchronization in populations of coupled oscillators'',
\textit{Physica D: Nonlinear Phenomena}, vol.~143, pp.~1--20, 2000.
%
\bibitem{compound}
K.~Tan, J.~Song, Q.~Zhang and M.~Sridharan, 
``A Compound TCP approach for high-speed and long distance networks'', 
in \textit{Proceedings of  IEEE International Conference on Computer Communications}, 2006.
\bibitem{tousi}
M.~Tousi, R. Kardehi Moghaddam and N. Pariz, ``Synchronization in oscillator networks with time delay and limited non-homogeneous coupling strength", \emph{Nonlinear Dynamics}, vol.~82, pp.~1--8, 2015.

\bibitem{Wischik}
D.~Wischik, ``Buffer sizing theory for bursty TCP flows",  \emph{in Proceedings of IEEE International Zurich Seminar on Communications}, 2006.
\bibitem{part1}
D.~Wischik and N.~McKeown,
``Part I: Buffer sizes for core routers'',
\textit{ACM SIGCOMM Computer Communication Review}, vol.~35, pp.~75--78, 2005.
\bibitem{woods}
C.~J.~Wood and R.~E.~Camley, ``Synchronization of oscillators arising from second-order, and higher, nonlinear couplings",   \emph{Nonlinear Dynamics}, vol.~108, pp.~597--611, 2022.



\bibitem{strogatz}
M.K.S.~Yeung and S.H.~Strogatz, 
``Time delay in the Kuramoto model of coupled oscillators'',
\textit{Physical Review Letters}, vol.~82, pp.~648--651, 1999.
%
\bibitem{ns2}  The Network Simulator (NS2). [Online]. Available:\\ 
http://nsnam.isi.edu/nsnam/index.php/User\_Information.%
%
% \bibitem{sync_evol_computing} Moioli, Renan C., Patrcia Amncio Vargas, and Phil Husbands. "Exploring the Kuramoto model of coupled oscillators in minimally cognitive evolutionary robotics tasks." In Evolutionary Computation (CEC), 2010 IEEE Congress on, pp. 1-8. IEEE, 2010.
\end{thebibliography}

\end{document}
% end of file template.tex


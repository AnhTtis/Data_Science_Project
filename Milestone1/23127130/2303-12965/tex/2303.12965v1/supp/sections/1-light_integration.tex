\section{Image-based Lighting}

\label{supp:light_integration}
The split sum shading model is widely used in real-time rendering~\cite{akenine2019real}, giving both realism and efficiency against spherical Gaussians (SG) and spherical harmonics (SH)~\cite{bossNeRDNeuralReflectance2021a,chenLearningPredict3D2019,zhangPhySGInverseRendering2021}.
We use a differentiable split sum~\cite{karisRealShadingUnreal2013} shading model to approximate rendering equation~\cite{kajiyaRENDERINGEQUATION1986} for image-based environment light learning as~\cite{munkbergExtractingTriangular3D2022}:
\begin{equation}
\begin{split}
L\left(\omega_o\right) & \approx \int_{\Omega} f\left(\omega_i, \omega_o\right)\left(\omega_i \cdot \mathbf{n}\right) d \omega_i \\
&\quad \int_{\Omega} L_i\left(\omega_i\right) D\left(\omega_i, \omega_o\right)\left(\omega_i \cdot \mathbf{n}\right) d \omega_i.
\label{supp:euq:render}
\end{split}
\end{equation}

\noindent where $D$ is the GGX normal distribution function (NDF)~\cite{walterMicrofacetModelsRefraction} in a Cook-Torrance microfacet specular shading model~\cite{cookReflectanceModelComputer}.
The first term contributes to the specular BSDF \textit{wrt.} a solid white environment light, which depends solely on the roughness $r$ of the BSDF and the light-surface angles $\cos \theta = \omega_i \cdot \mathbf{n}$.
The second term contributes to the integral of the incoming radiance with the GGX normal distribution function, $D$.
Both terms can be pre-computed and filtered to reduce computation~\cite{karisRealShadingUnreal2013}.

The training parameters are texels of a cube light map whose resolution is $6 \times 512 \times 512$.
The pre-integrated lighting for the least roughness values is derived from the base level, and multiple smaller mip levels are constructed from it~\cite{karisRealShadingUnreal2013}.
Each mip-map is filtered by average-pooling the base level of the current resolution and is convolved with the GGX normal distribution function.
The per mip-level filter bounds are pre-computed as well.
We leverage a PyTorch implementation with CUDA extensions from~\cite{munkbergExtractingTriangular3D2022}.
Moreover, a cube map is created to represent the diffuse lighting in a low resolution, akin to the filtered specular probe.
It shares the same optimizable parameters and is average-pooled to the mip level with $r=1$ roughness.
The pre-filtering only involves the first term in Eq.~\ref{supp:euq:render}.


%%%%% separate e_i %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{lemma} 
The cluster deviation error $\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\mathbf e_{i}^{(t)}\Vert$ is upper-bounded as:
\begin{equation}
   \sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\mathbf e_{i}^{(t)}\Vert = \sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\mathbf w_i^{(t)}-\bar{\mathbf w}_c^{(t)}\Vert
    \leq \sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\mathbf w_i^{(t)} - \mathbf w^*\Vert + \Vert\bar{\mathbf w}_c^{(t)}-\mathbf w^*\Vert.
\end{equation}
% where each $\lambda_{{c}}$ is a constant such that $1 > \lambda_{{c}} \geq \rho \big(\mathbf{V}_{{c}}-\frac{\textbf{1} \textbf{1}^\top}{s_c} \big)$.
\end{lemma}

\begin{proof}
{\color{blue}
Using the definition of $\mathbf w_i^{(t)}$ given in \eqref{eq:w_i-gen}, we have:  
\begin{align} \label{eq:wi}
    \mathbf w_i^{(t)} = \chi_c^{(t)}\widetilde{\mathbf{w}}_i^{(t)}+(1-\chi_c^{(t)})\bar{\mathbf w}_c^{(t)}.
\end{align}
Replacing~\eqref{eq:wi} into the definition of $\mathbf e_{i}^{(t)}$ in~\eqref{eq14}, we have 
\begin{align}
    \sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\mathbf e_{i}^{(t)}\Vert = \sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\mathbf w_i^{(t)}-\bar{\mathbf w}_c^{(t)}\Vert
    \leq \underbrace{\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\mathbf w_i^{(t)} - \mathbf w^*\Vert}_{(a)} + \underbrace{\Vert\bar{\mathbf w}_c^{(t)}-\mathbf w^*\Vert}_{(b)},
    % =\chi_c^{(t)}\widetilde{\mathbf{w}}_i^{(t)}-\chi_c^{(t)}\bar{\mathbf w}_c^{(t)}
    % =\chi_c^{(t)}\Big(\widetilde{\mathbf{w}}_i^{(t)}-\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\widetilde{\mathbf{w}}^{(t)}_{{j}}\Big).
\end{align}
% where $\widehat{\mathbf w}_c^{(t_k)}=\bar{\mathbf w}^{(t_k)}$ represents the perfect average of the local models in the cluster with no delay, i.e., $\Delta=0$, at $t=t_k$. 
Consider the case when $t=t_k$, in order to bound (a), we use the definition of $\mathbf w_i^{(t)}$ at $t=t_k$ from~\eqref{eq:aggr_alpha} and~\eqref{eq:w_i-gen} to obtain:
\begin{align} \label{eq:alpha}
    \mathbf w_i^{(t_{k})} =& 
    \alpha\bar{\mathbf{w}}^{(t_{k}-\Delta)}
    +(1-\alpha)\mathbf w_i^{(t_k)}
    \nonumber \\
    =&\alpha\bar{\mathbf{w}}^{(t_{k}-\Delta)}
    +(1-\alpha)\left[\chi_c^{(t_k)}\widetilde{\mathbf{w}}_i^{(t_k)}+(1-\chi_c^{(t_k)})\bar{\mathbf w}_c^{(t_k)}\right]
    \nonumber \\
    =&\alpha\bar{\mathbf{w}}^{(t_{k}-\Delta)}
    +(1-\alpha)\left[\chi_c^{(t_k)}\left(\mathbf w_i^{(t_k-1)} - \eta_{t_{k}-1}\widehat{\mathbf g}_{i}^{(t_k-1)}\right)+(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\left(\mathbf w_j^{(t_k-1)} - \eta_{t_{k}-1}\widehat{\mathbf g}_{j}^{(t_k-1)}\right)\right]
\end{align}
Subtracting $\mathbf w^*$ on both hand sides of~\eqref{eq:w_i-gen}, we obtain
\begin{align}
    &\mathbf w_i^{(t_k)} - \mathbf w^* 
    \nonumber \\&
    =\alpha\bar{\mathbf{w}}^{(t_{k}-\Delta)}
    +(1-\alpha)\left[\chi_c^{(t_k)}\left(\mathbf w_i^{(t_k-1)} - \eta_{t_{k}-1}\widehat{\mathbf g}_{i}^{(t_k-1)}\right)+(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\left(\mathbf w_j^{(t_k-1)} - \eta_{t_{k}-1}\widehat{\mathbf g}_{j}^{(t_k-1)}\right)\right]-\mathbf w^*
    \nonumber \\&
    = \alpha\big(\bar{\mathbf{w}}^{(t_{k}-\Delta)}-\mathbf w^*\big)
    \nonumber \\&
    +(1-\alpha)\left[\chi_c^{(t_k)}\left(\mathbf w_i^{(t_k-1)} - \eta_{t_{k}-1}\widehat{\mathbf g}_{i}^{(t_k-1)}-\mathbf w^*\right)+(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\left(\mathbf w_j^{(t_k-1)} - \eta_{t_{k}-1}\widehat{\mathbf g}_{j}^{(t_k-1)}-\mathbf w^*\right)\right]
    \nonumber \\&
    = \alpha\big(\bar{\mathbf{w}}^{(t_{k}-\Delta)}-\mathbf w^*\big)
    \nonumber \\&
    +(1-\alpha)\left[\chi_c^{(t_k)}\left(\mathbf w_i^{(t_k-1)} - \eta_{t_{k}-1}\nabla F(\mathbf w_i^{(t_k-1)})-\mathbf w^*\right)
    +(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\left(\mathbf w_j^{(t_k-1)} - \eta_{t_{k}-1}\nabla F(\mathbf w_j^{(t_k-1)})-\mathbf w^*\right)\right]
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}\left[\chi_c^{(t_k)}[\nabla F_i(\mathbf w_i^{(t_k-1)})-\widehat{\mathbf g}_{i}^{(t_k-1)}]
    +(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}[\nabla F_j(\mathbf w_j^{(t_k-1)})-\widehat{\mathbf g}_{j}^{(t_k-1)}]\right]
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}\left[\chi_c^{(t_k)}[\nabla F(\mathbf w_i^{(t_k-1)})-\nabla F_i(\mathbf w_i^{(t_k-1)})]
    +(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}[\nabla F(\mathbf w_j^{(t_k-1)})-\nabla F_j(\mathbf w_j^{(t_k-1)})]\right].
    % \nonumber \\&
    % = \alpha\sum\limits_{m=t_k-1}^{t_k-\Delta}\eta_m\sum\limits_{c=1}^N \varrho_c\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\nabla F_j(\mathbf w_j^{(m)}) 
    % \nonumber \\&
    % +\alpha\sum\limits_{m=t_k-1}^{t_k-\Delta}\eta_m\sum\limits_{c=1}^N \varrho_c\sum\limits_{j\in\mathcal S_c}\rho_{j,c}[\widehat{\mathbf g}_{j}^{(m)}-\nabla F_j(\mathbf w_j^{(m)})]
    % \nonumber \\&
    % +(1-\alpha)\left[\mathbf w_i^{(t_k-1)}-\bar{\mathbf w}_c^{(t_k-1)}\right]
    % \nonumber \\&
    % -(1-\alpha) \left[\eta_{t_{k}-1}\big[\nabla F_i(\mathbf w_i^{(t_k-1)})+\widehat{\mathbf g}_{i}^{(t_k-1)}-\nabla F_i(\mathbf w_i^{(t_k-1)})\big]\right]
    % \nonumber \\&
    % +(1-\alpha) \left[\eta_{t_{k}-1}\sum\limits_{c=1}^N \varrho_c\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\big[\nabla F_j(\mathbf w_j^{(t_k-1)})+\widehat{\mathbf g}_{j}^{(t_k-1)}-\nabla F_j(\mathbf w_j^{(t_k-1)})\big]\right],
\end{align}
Taking the norm-2 from the both hand sides of the above equality and applying the triangle inequality yields:
\begin{align} 
    &\Vert\mathbf w_i^{(t_k)} - \mathbf w^* \Vert
    \nonumber \\&
    \leq \alpha\Vert\bar{\mathbf{w}}^{(t_{k}-\Delta)}-\mathbf w^*\Vert
    \nonumber \\&
    +(1-\alpha)\left[\chi_c^{(t_k)}\Vert\mathbf w_i^{(t_k-1)} - \eta_{t_{k}-1}\nabla F(\mathbf w_i^{(t_k-1)})-\mathbf w^*\Vert
    +(1-\chi_c^{(t_k)})\Vert\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\mathbf w_j^{(t_k-1)} - \eta_{t_{k}-1}\nabla F(\mathbf w_j^{(t_k-1)})-\mathbf w^*\Vert\right]
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}\left[\chi_c^{(t_k)}\Vert\nabla F_i(\mathbf w_i^{(t_k-1)})-\widehat{\mathbf g}_{i}^{(t_k-1)}\Vert
    +(1-\chi_c^{(t_k)})\Vert\sum\limits_{j\in\mathcal S_c}\rho_{j,c}[\nabla F_j(\mathbf w_j^{(t_k-1)})-\widehat{\mathbf g}_{j}^{(t_k-1)}]\Vert\right]
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}\left[\chi_c^{(t_k)}\Vert\nabla F(\mathbf w_i^{(t_k-1)})-\nabla F_i(\mathbf w_i^{(t_k-1)})\Vert
    +(1-\chi_c^{(t_k)})\Vert\sum\limits_{j\in\mathcal S_c}\rho_{j,c}[\nabla F(\mathbf w_j^{(t_k-1)})-\nabla F_j(\mathbf w_j^{(t_k-1)})]\Vert\right]
    \nonumber \\&
    \overset{(a)}{\leq}
    \alpha\Vert\bar{\mathbf{w}}^{(t_{k}-\Delta)}-\mathbf w^*\Vert
    \nonumber \\&
    +(1-\alpha)\left[\chi_c^{(t_k)}\Vert\mathbf w_i^{(t_k-1)} - \eta_{t_{k}-1}\nabla F(\mathbf w_i^{(t_k-1)})-\mathbf w^*\Vert
    +(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\Vert\mathbf w_j^{(t_k-1)} - \eta_{t_{k}-1}\nabla F(\mathbf w_j^{(t_k-1)})-\mathbf w^*\Vert\right]
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}\left[\chi_c^{(t_k)}\Vert\nabla F_i(\mathbf w_i^{(t_k-1)})-\widehat{\mathbf g}_{i}^{(t_k-1)}\Vert
    +(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\Vert\nabla F_j(\mathbf w_j^{(t_k-1)})-\widehat{\mathbf g}_{j}^{(t_k-1)}\Vert\right]
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}\left[\chi_c^{(t_k)}\Vert\nabla F(\mathbf w_i^{(t_k-1)})-\nabla F_i(\mathbf w_i^{(t_k-1)})\Vert
    +(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\Vert\nabla F(\mathbf w_j^{(t_k-1)})-\nabla F_j(\mathbf w_j^{(t_k-1)})\Vert\right],
\end{align}
where (a) results from Jensen's inequality. Taking the weighted sum $\sum\limits_{i\in\mathcal S_c}\rho_{i,c}$ from the both hand sides of the above inequality gives us:
\begin{align} \label{eq:tri_e}
    &\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\mathbf w_i^{(t_k)} - \mathbf w^* \Vert
    \leq
    \alpha\Vert\bar{\mathbf{w}}^{(t_{k}-\Delta)}-\mathbf w^*\Vert
    \nonumber \\&
    +(1-\alpha)\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\mathbf w_i^{(t_k-1)} - \eta_{t_{k}-1}\nabla F(\mathbf w_i^{(t_k-1)})-\mathbf w^*\Vert
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\nabla F_i(\mathbf w_i^{(t_k-1)})-\widehat{\mathbf g}_{i}^{(t_k-1)}\Vert
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\nabla F(\mathbf w_i^{(t_k-1)})-\nabla F_i(\mathbf w_i^{(t_k-1)})\Vert,
\end{align}

To bound the terms on the right hand side above, we first use the $\mu$-strong convexity and $\beta$-smoothness of $F(\cdot)$, when $\eta_t\leq\frac{\mu}{\beta^2}$, to get 
    \begin{align} \label{eq:stx}
        &\Vert{\mathbf w}_i^{(t)}-\mathbf w^*-\frac{\tilde{\eta_t}}{\beta} \nabla F({\mathbf w}_i^{(t)})\Vert
        \nonumber \\&
        =
        \sqrt{\Vert{\mathbf w}_i^{(t)}-\mathbf w^*\Vert^2+\eta_t^2\Vert\nabla F({\mathbf w}_i^{(t)})\Vert^2-2\eta_t({\mathbf w}_i^{(t)}-\mathbf w^*)^\top\nabla F({\mathbf w}_i^{(t)})}
        \nonumber \\&
        \overset{(a)}{\leq} 
        \sqrt{(1-2{\eta}_t{\mu})\Vert{\mathbf w}_i^{(t)}-\mathbf w^*\Vert^2+\eta_t^2\Vert\nabla F({\mathbf w}_i^{(t)})\Vert^2}
        \nonumber \\&
        \overset{(b)}{\leq}
        \sqrt{1-2{\eta}_t{\mu}+{\eta}_t^2\beta^2}\Vert{\mathbf w}_i^{(t)}-\mathbf w^*\Vert
        \overset{(c)}{\leq} 
        (1-\frac{{\eta}_t{\mu}}{2})\Vert{\mathbf w}_i^{(t)}-\mathbf w^*\Vert,
    \end{align}
 where $(a)$ results from the property of a strongly convex function, i.e., $({\mathbf w}_i^{(t)}-\mathbf w^*)^\top\nabla F({\mathbf w}_i^{(t)})\geq\mu\Vert{\mathbf w}_i^{(t)}-\mathbf w^*\Vert^2$, $(b)$ comes from the property of smooth functions, i.e., $\Vert\nabla F({\mathbf w}_i^{(t)})\Vert^2\leq\beta^2\Vert{\mathbf w}_i^{(t)}-\mathbf w^*\Vert^2$ and the last step $(c)$ follows from the fact that ${\eta}_t\leq {\eta}_0$ and assuming $ {\eta}_0\leq{\mu}/\beta^2$.
%  , implying $\alpha\geq  \tilde{\gamma}/\tilde{\mu}$.
In addition, using gradient diversity in Definition \ref{gradDiv}, we further bound the right hand side of~\eqref{eq:tri_e} to get
    \begin{align} \label{eq:beta}
        \Vert\nabla F(\mathbf w_i^{(t)})-\nabla F_i(\mathbf w_i^{(t)})\Vert
        \leq
        \delta+ \zeta \Vert\mathbf w_i^{(t)}-\mathbf w^*\Vert.
    \end{align}
Replacing the result of~\eqref{eq:stx} and~\eqref{eq:beta} in~\eqref{eq:tri_e} yields and taking the expectation on both hand sides:
\begin{align} 
    &\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert\mathbf w_i^{(t_k)} - \mathbf w^* \Vert
    \leq
    \alpha\mathbb E\Vert\bar{\mathbf{w}}^{(t_{k}-\Delta)}-\mathbf w^*\Vert
    \nonumber \\&
    +(1-\alpha)(1-\frac{{\eta}_{t_k-1}{\mu}}{2})\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert{\mathbf w}_i^{(t_k-1)}-\mathbf w^*\Vert
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert\nabla F_i(\mathbf w_i^{(t_k-1)})-\widehat{\mathbf g}_{i}^{(t_k-1)}\Vert
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}(\delta+ \zeta \sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert\mathbf w_i^{(t)}-\mathbf w^*\Vert)
    \nonumber \\&
    \overset{(a)}{\leq}
    \alpha\mathbb E\Vert\bar{\mathbf{w}}^{(t_{k}-\Delta)}-\mathbf w^*\Vert
    \nonumber \\&
    +(1-\alpha)[1-{\eta}_{t_k-1}(\frac{{\mu}}{2}+\zeta)]\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert{\mathbf w}_i^{(t_k-1)}-\mathbf w^*\Vert
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\sqrt{\mathbb E\Vert\nabla F_i(\mathbf w_i^{(t_k-1)})-\widehat{\mathbf g}_{i}^{(t_k-1)}\Vert^2}
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}\delta
    \nonumber \\&
    \overset{(b)}{\leq}
    \alpha\underbrace{\mathbb E\Vert\bar{\mathbf{w}}^{(t_{k}-\Delta)}-\mathbf w^*\Vert}_{(i)}
%     \nonumber \\&
    +(1-\alpha)[1-{\eta}_{t_k-1}(\frac{{\mu}}{2}+\zeta)]\underbrace{\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert{\mathbf w}_i^{(t_k-1)}-\mathbf w^*\Vert}_{(ii)}
    \nonumber \\&
    +(1-\alpha)\eta_{t_{k}-1}(\delta+\sigma),
\end{align}
where (a) results from Jensen's inequality and (b) comes from Assumption~\ref{assump:SGD_noise}. To bound (i) and (ii), we consider bounding $\sum\limits_{c=1}^N\varrho_c\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert{\mathbf w}_i^{(t)}-\mathbf w^*\Vert$ and $\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert{\mathbf w}_i^{(t)}-\mathbf w^*\Vert$ under the case when $t\in\mathcal{T}_k\setminus\{t_k\},~\forall k$. 
}


% Using the definition of $\mathbf w_i^{(t)}$ given in \eqref{eq:w_i-gen}, we have:  
% \begin{align} \label{eq:w_i}
%     \mathbf w_i^{(t_{k})} =& 
%     \chi_c^{(t_k)}\widetilde{\mathbf{w}}_i^{(t_k)}+(1-\chi_c^{(t_k)})\bar{\mathbf w}_c^{(t_k)}
%     \nonumber \\
%     =&\chi_c^{(t_k)}\left(\mathbf w_i^{(t_k-1)} - \eta_{t_{k}-1}\widehat{\mathbf g}_{i}^{(t_k-1)}\right)+(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\left(\mathbf w_j^{(t_k-1)} - \eta_{t_{k}-1}\widehat{\mathbf g}_{j}^{(t_k-1)}\right)
% \end{align}
% Subtracting $\mathbf w^*$ on both hand sides of~\eqref{eq:w_i}, we obtain
% \begin{align}
%     &\mathbf w_i^{(t_k)} - \mathbf w^* 
%     \nonumber \\&
%     =\left[\chi_c^{(t_k)}\left(\mathbf w_i^{(t_k-1)} - \eta_{t_{k}-1}\widehat{\mathbf g}_{i}^{(t_k-1)}\right)+(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\left(\mathbf w_j^{(t_k-1)} - \eta_{t_{k}-1}\widehat{\mathbf g}_{j}^{(t_k-1)}\right)\right]-\mathbf w^*
%     \nonumber \\&
%     = \chi_c^{(t_k)}\left(\mathbf w_i^{(t_k-1)} - \eta_{t_{k}-1}\widehat{\mathbf g}_{i}^{(t_k-1)}-\mathbf w^*\right)+(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\left(\mathbf w_j^{(t_k-1)} - \eta_{t_{k}-1}\widehat{\mathbf g}_{j}^{(t_k-1)}-\mathbf w^*\right)
%     \nonumber \\&
%     = \chi_c^{(t_k)}\left(\mathbf w_i^{(t_k-1)} - \eta_{t_{k}-1}\nabla F(\mathbf w_i^{(t_k-1)})-\mathbf w^*\right)
%     +(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\left(\mathbf w_j^{(t_k-1)} - \eta_{t_{k}-1}\nabla F(\mathbf w_j^{(t_k-1)})-\mathbf w^*\right)
%     \nonumber \\&
%     +\eta_{t_{k}-1}\left[\chi_c^{(t_k)}[\nabla F_i(\mathbf w_i^{(t_k-1)})-\widehat{\mathbf g}_{i}^{(t_k-1)}]
%     +(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}[\nabla F_j(\mathbf w_j^{(t_k-1)})-\widehat{\mathbf g}_{j}^{(t_k-1)}]\right]
%     \nonumber \\&
%     +\eta_{t_{k}-1}\left[\chi_c^{(t_k)}[\nabla F(\mathbf w_i^{(t_k-1)})-\nabla F_i(\mathbf w_i^{(t_k-1)})]
%     +(1-\chi_c^{(t_k)})\sum\limits_{j\in\mathcal S_c}\rho_{j,c}[\nabla F(\mathbf w_j^{(t_k-1)})-\nabla F_j(\mathbf w_j^{(t_k-1)})]\right].
%     % \nonumber \\&
%     % = \alpha\sum\limits_{m=t_k-1}^{t_k-\Delta}\eta_m\sum\limits_{c=1}^N \varrho_c\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\nabla F_j(\mathbf w_j^{(m)}) 
%     % \nonumber \\&
%     % +\alpha\sum\limits_{m=t_k-1}^{t_k-\Delta}\eta_m\sum\limits_{c=1}^N \varrho_c\sum\limits_{j\in\mathcal S_c}\rho_{j,c}[\widehat{\mathbf g}_{j}^{(m)}-\nabla F_j(\mathbf w_j^{(m)})]
%     % \nonumber \\&
%     % +(1-\alpha)\left[\mathbf w_i^{(t_k-1)}-\bar{\mathbf w}_c^{(t_k-1)}\right]
%     % \nonumber \\&
%     % -(1-\alpha) \left[\eta_{t_{k}-1}\big[\nabla F_i(\mathbf w_i^{(t_k-1)})+\widehat{\mathbf g}_{i}^{(t_k-1)}-\nabla F_i(\mathbf w_i^{(t_k-1)})\big]\right]
%     % \nonumber \\&
%     % +(1-\alpha) \left[\eta_{t_{k}-1}\sum\limits_{c=1}^N \varrho_c\sum\limits_{j\in\mathcal S_c}\rho_{j,c}\big[\nabla F_j(\mathbf w_j^{(t_k-1)})+\widehat{\mathbf g}_{j}^{(t_k-1)}-\nabla F_j(\mathbf w_j^{(t_k-1)})\big]\right],
% \end{align}
% where (a) results from Jensen's inequality. Taking the weighted sum $\sum\limits_{i\in\mathcal S_c}\rho_{i,c}$ from the both hand sides of the above inequality gives us:
% \begin{align} \label{eq:e}
%     &\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\mathbf w_i^{(t_k)} - \mathbf w^* \Vert
%     \leq
%     \sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\mathbf w_i^{(t_k-1)} - \eta_{t_{k}-1}\nabla F(\mathbf w_i^{(t_k-1)})-\mathbf w^*\Vert
%     \nonumber \\&
%     +\eta_{t_{k}-1}\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\nabla F_i(\mathbf w_i^{(t_k-1)})-\widehat{\mathbf g}_{i}^{(t_k-1)}\Vert
%     \nonumber \\&
%     +\eta_{t_{k}-1}\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\Vert\nabla F(\mathbf w_i^{(t_k-1)})-\nabla F_i(\mathbf w_i^{(t_k-1)})\Vert,
% \end{align}

% Use the $\mu$-strong convexity, $\beta$-smoothness of $F(\cdot)$ and Definition~\ref{gradDiv}, when $\eta_t\leq\frac{\mu}{\beta^2}$, we can bound~\eqref{eq:e} as:
% \begin{align} 
%     &\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert\mathbf w_i^{(t_k)} - \mathbf w^* \Vert
%     \leq
%     (1-\frac{{\eta}_{t_k-1}{\mu}}{2})\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert{\mathbf w}_i^{(t_k-1)}-\mathbf w^*\Vert
%     \nonumber \\&
%     +\eta_{t_{k}-1}\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert\nabla F_i(\mathbf w_i^{(t_k-1)})-\widehat{\mathbf g}_{i}^{(t_k-1)}\Vert
%     \nonumber \\&
%     +\eta_{t_{k}-1}(\delta+ \zeta \sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert\mathbf w_i^{(t)}-\mathbf w^*\Vert)
%     \nonumber \\&
%     \overset{(a)}{\leq}
%     [1-{\eta}_{t_k-1}(\frac{{\mu}}{2}+\zeta)]\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert{\mathbf w}_i^{(t_k-1)}-\mathbf w^*\Vert
%     \nonumber \\&
%     +\eta_{t_{k}-1}\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\sqrt{\mathbb E\Vert\nabla F_i(\mathbf w_i^{(t_k-1)})-\widehat{\mathbf g}_{i}^{(t_k-1)}\Vert^2}
%     \nonumber \\&
%     +\eta_{t_{k}-1}\delta
%     \nonumber \\&
%     \overset{(b)}{\leq}
%     [1-{\eta}_{t_k-1}(\frac{{\mu}}{2}+\zeta)]\sum\limits_{i\in\mathcal S_c}\rho_{i,c}\mathbb E\Vert{\mathbf w}_i^{(t_k-1)}-\mathbf w^*\Vert
%     % \nonumber \\&
%     +\eta_{t_{k}-1}(\delta+\sigma),
% \end{align}
% where (a) results from Jensen's inequality and (b) comes from Assumption~\ref{assump:SGD_noise}.
\end{proof}
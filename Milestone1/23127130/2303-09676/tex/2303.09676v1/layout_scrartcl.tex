%-------------------------------------------------------------------

\usepackage{lmodern}
\linespread{1.04}
\frenchspacing
\usepackage{microtype}


%-------------------------------------------------------------------
% define commands \address, \email like in amsart:

\makeatletter
%\newcounter{author}
\renewcommand*\author[1]{%
  \stepcounter{author}%
  \ifnum\c@author=1
    \gdef\@author{#1}%
  \else
    \xdef\@author{\unexpanded\expandafter{\@author\and#1}}%
  \fi
  \csgdef{author@\the\c@author}{#1}}
\newcommand*\email[1]{%
  \csgdef{email@\the\c@author}{#1}}
\newcommand*\address[1]{%
  \csgdef{address@\the\c@author}{#1}}
\AtEndDocument{%
  \xdef\author@count{\the\c@author}%
  \c@author=1
  \print@authors}
\newcommand*\print@authors{%
  \ifnum\c@author>\author@count
  \else
    \print@author{\the\c@author}%
    \advance\c@author by 1
    \expandafter\print@authors
  \fi}
\newcommand*\print@author[1]{%
  \par\medskip
  \noindent
  \begin{tabular}{@{}l@{}}%
    \csuse{author@#1}\\
    \csuse{address@#1}\\
    \textit{e-mail:}
    \texttt{\csuse{email@#1}}
  \end{tabular}
}

%-------------------------------------------------------------------
% replacement thanks: (to be improved) 
%TODO
\newcommand{\fundingfootnote}[1]{%
        \begin{NoHyper}%
           \renewcommand{\thefootnote}{}%5
           \footnote{#1}%
           \addtocounter{footnote}{-1}%
        \end{NoHyper}%
}

%-------------------------------------------------------------------
% title with optional short title like in amsart:

\renewcommand*{\title}[2][]{%
  \ifstrempty{#1}{
  \gdef\shorttitle{#2}\gdef\@title{#2}
  }{\gdef\shorttitle{#1}\gdef\@title{#2}%
  }
}
\makeatother

%-------------------------------------------------------------------



\RequirePackage{xpatch}


%-------------------------------------------------------------------
% page layout
%-------------------------------------------------------------------

% use authors und shorttitle for running heads:

\RequirePackage{scrlayer-scrpage}

\pagestyle{scrheadings}
\ohead{\pagemark}
\makeatletter 
\cehead[]{\let\thanks\@gobble\@author}
\cohead[]{\shorttitle}
\makeatother
%%\ihead{\headmark}
%%\chead[]{}
\cfoot[\pagemark]{}
\ofoot[]{}
%%\KOMAoptions{markcase=used, 
%%             cleardoublepage=empty}
%%%\setkomafont{pagenumber}{\normalfont\bfseries\sffamily}
%%\setkomafont{pageheadfoot}{\normalfont}

 




%-------------------------------------------------------------------
% some layout modifications
%-------------------------------------------------------------------


\makeatletter
\xpatchcmd{\swappedhead}%
         {~}%
         {.~}% add dot after theorem number
         {}%
         {\typeout{failed to patch swappedhead}}
\makeatother


\KOMAoptions{twoside=semi,headings=small, numbers=enddot}

\setlength{\parindent}{1.5em}

\setkomafont{disposition}{\normalcolor\bfseries}
% hack for nonhuge title:
\addtokomafont{title}{\let\huge=\large} 

\setkomafont{author}{\large}
\setkomafont{date}{\normalfont}

\newkomafont{abstract}{\normalfont\footnotesize}
\newkomafont{abstracttitle}{%
   \usekomafont{disposition}\usesizeofkomafont{abstract}%
}




\renewenvironment{abstract}%
  {\usekomafont{abstract}
   \begin{description}[%
        style=unboxed,
        leftmargin=3em,
        labelindent=\leftmargin,
        rightmargin=\leftmargin,
        labelwidth=0pt,        
        parsep=0pt,
        listparindent=\parindent, 
        font=\normalfont\usekomafont{abstracttitle}]
   \item[\abstractname.]}%
  {\end{description}}


%-------------------------------------------------------------------
% commands \keywords and \subjclass 
% to be used inside abstract environment:  


\newcommand*{\keywordsname}{Keywords}
\newcommand*{\mscname}[1]{Mathematics Subject Classification (#1)}
  
\newcommand{\keywords}[1]{\item[\keywordsname.] #1.}  
\newcommand{\subjclass}[2][2010]{%
\item[\mscname{#1}.] #2.}
 

\documentclass[english,cleveref, autoref, thm-restate, a4paper]{socg-lipics-v2021}



\bibliographystyle{plainurl}%

\hideLIPIcs

\usepackage{algorithm2e}
\usepackage{enumitem}
\usepackage{blkarray}



\newcommand{\squeezelist}{\setlength{\itemsep}{0pt}}

\newcommand{\floor}[1]{\lfloor #1 \rfloor}


\DeclareMathOperator*{\argmin}{arg\,min}


\newtheorem{thm}{Theorem}
\newtheorem{obs}[theorem]{Observation}
\newtheorem{lem}[theorem]{Lemma}
\newtheorem{coro}[theorem]{Corollary}

\newtheorem{assumption}{Assumption}
\newtheorem{assumptions}{Assumptions}


\newcommand{\changed}[1]{{#1}}
\newcommand{\newchanged}[1]{{#1}}
\newcommand{\nnewchanged}[1]{{#1}}
\newcommand{\reviewerchange}[1]{{#1}}



\def\defn#1{\textit{\textbf{\boldmath #1}}}

\title{The Geodesic Edge Center of a Simple Polygon}

\author{Anna Lubiw}
{David R.~Cheriton School of Computer Science, University of Waterloo, Waterloo, Canada}
{alubiw@uwaterloo.ca}
{https://orcid.org/0000-0002-2338-361X}{}


\author{Anurag Murty Naredla}{David R.~Cheriton School of Computer Science, University of Waterloo, Waterloo, Canada \and Institut fÃ¼r Informatik, University of Bonn, Bonn, Germany}{amnaredla@uwaterloo.ca}{}{}

\authorrunning{A.~Lubiw and A.M.~Naredla}

\Copyright{Anna Lubiw and Anurag Murty Naredla} %

\ccsdesc[500]{Theory of computation~Computational geometry}

\keywords{geodesic center of polygon, farthest edges, farthest-segment Voronoi diagram} %

\relatedversion{A full version of the paper is available at \url{https://arxiv.org/abs/papernumber}.}

\acknowledgements{ For helpful comments we thank Boris Aronov, Therese Biedl, John Hershberger, Joseph Mitchell, and the SoCG reviewers.
}

\funding{Research supported by the Natural Sciences and Engineering Research Council of Canada (NSERC).}


\begin{document}
\maketitle

\begin{abstract}
The \emph{geodesic edge center} of a polygon is a point $c$ inside the polygon that minimizes the maximum geodesic distance 
from $c$ to any edge of the polygon, where \emph{geodesic distance} is the shortest path distance inside the polygon.
We give a \reviewerchange{linear-time algorithm} to find a geodesic edge center of a simple polygon. 
This improves on the previous $O(n \log n)$ time algorithm by Lubiw and Naredla [European Symposium on Algorithms, 2021].
The algorithm builds on an  
algorithm to find the geodesic \emph{vertex} center of a simple polygon due to Pollack, Sharir, and Rote [Discrete \& Computational Geometry, 1989] and
an improvement to linear time by Ahn, Barba, Bose, De Carufel, Korman, and Oh [Discrete \& Computational Geometry, 2016].

The
geodesic edge center 
can easily be found from the
\reviewerchange{geodesic farthest-edge} Voronoi diagram of the polygon.
Finding that Voronoi diagram
in linear time is an open question, although
the geodesic \emph{nearest} edge Voronoi diagram 
(the medial axis) can be found in linear time.
As a first step of our geodesic edge center algorithm,  we give a \reviewerchange{linear-time algorithm} to find the \reviewerchange{geodesic farthest-edge} Voronoi diagram  
restricted to the polygon boundary. 
\end{abstract}

\section{Introduction}\label{section:introduction}

The most basic ``center'' problem is Sylvester's problem: given $n$ points in the plane, find the smallest disc that encloses the points. The center of this disc is a point that minimizes the maximum distance to any of the given points.
We consider a center problem that differs in two ways from Sylvester's problem. First, the domain is a simple polygon and the distance measure is not Euclidean distance, but rather the shortest path, or ``geodesic'' distance inside the polygon.
Second, the sites are not points but rather the edges of the polygon.  More precisely, the problem is to find, given a simple polygon in the plane, the \defn{geodesic edge center}, which is a point in the polygon that minimizes the maximum geodesic distance to a polygon edge. 
See Figure~\ref{fig:center-example}.
More formally, let $E$ be the set of edges of the polygon $P$, and for point $p \in P$ and edge $e \in E$, define \defn{$d(p,e)$} to be the geodesic distance from $p$ to $e$.  
\changed{Define the \defn{geodesic radius} of a point $p \in P$ to be $r(p) := \max \{d(p,e): e \in E\}$.
Then the \defn{geodesic edge center} is a point $p \in P$ that minimizes
$r(p)$.}

\begin{figure}[htb]
  \centering
  \includegraphics[width=.65\textwidth]{RS_figures/EdgeCenter-cropped.pdf}
  \caption{Point $c$ is the edge center of this polygon.
  Edges $e, e', e''$ (in blue)
  are geodesically farthest
  from $c$---the geodesic paths (in red) from $c$ to these edges all
have the same length.}
\label{fig:good_four_cell}
\label{fig:center-example}
\end{figure}

Our main result is a linear-time algorithm to find the geodesic edge center of a simple $n$-vertex polygon.  This improves %
\reviewerchange{our} previous 
$O(n \log n)$ time algorithm~\cite{lubiw2021visibility}.
The algorithm follows the strategies used to find the geodesic \emph{vertex} center, which is a point in the polygon that minimizes the maximum geodesic distance to a polygon vertex.  
In 1989, Pollack, Sharir and Rote~\cite{pollack_sharir} gave an $O(n \log n)$ time algorithm for the geodesic vertex center problem.  A main tool---which is used in all subsequent algorithms---is
a \reviewerchange{linear-time} \emph{chord oracle} that finds, given a chord, which side of the chord contains the center. 
In 2016, Ahn, Barba, Bose, De Carufel, Korman, and Oh~\cite{linear_time_geodesic} improved the runtime for the geodesic vertex center to $O(n)$.  
Their most important new contribution is the use of $\epsilon$-nets to perform a divide-and-conquer search. 
Our algorithm follows the approach of Ahn et al., modified to deal with farthest edges rather than farthest vertices.  We simplify some aspects and we repair some  
errors in their approach.  
\newchanged{The \reviewerchange{edge-center problem} is more general than the vertex center problem via the reduction of splitting each vertex into  two vertices joined by a very short edge.}


In general, the center of a set of sites can be determined from the farthest Voronoi diagram of those sites, but computing the Voronoi diagram can be more costly. 
As the first step of 
our center algorithm we give a \reviewerchange{linear-time algorithm} to compute the \reviewerchange{geodesic farthest-edge} Voronoi diagram restricted to the boundary of the polygon. 
\changed{Computing the whole \reviewerchange{geodesic farthest-edge} Voronoi diagram in linear time is an open problem.}




\subparagraph*{Background on Centers and Farthest Voronoi Diagrams.} 

\changed{
Megiddo~\cite{megiddo_linear} gave a \reviewerchange{linear-time} algorithm to find the center of a set of points in the plane (Sylvester's problem) using his ``prune-and-search'' technique, which is used in the final stages of all geodesic center algorithms.
However, computing the farthest Voronoi diagram of points in the plane takes $\Theta(n \log n)$ time~\cite{shamos1975closest}.
}




Our problem involves distances that are geodesic rather that Euclidean, and sites that are segments (edges) rather than points. \changed{These have been studied separately, although there is almost no work
combining them.}

For Euclidean distances, 
Megiddo's method extends to \reviewerchange{linear-time algorithm}s to find the center of %
line segments or lines in the plane~\cite{bhattacharya1994optimal}.
The farthest Voronoi diagram of segments in the plane was considered by Aurenhammer et al.~\cite{aurenhammer2006farthest},
who called it a
``stepchild in
the vast Voronoi diagram literature''.  
They gave an $O(n \log n)$ time algorithm which was improved to output-sensitive time $O(n \log h)$, where $h$ is the number of faces of the diagram~\cite{papadopoulou2013farthest}.





For geodesic 
distances with point sites Ahn et al. gave 
a \reviewerchange{linear-time algorithm} to find the geodesic center of the vertices of a polygon~\cite{linear_time_geodesic}.
The corresponding farthest Voronoi diagram 
can be found in time $O(n \log \log n)$~\cite{oh2020geodesic}, and in expected linear time~\cite{barba2019optimal}. 
More generally, for $m$ points inside an $n$-vertex polygon, an algorithm to find their farthest Voronoi diagram 
was first given by Aronov et al.~\cite{aronov1993farthest} with run-time $O((n+m)\log (n+m))$, and improved in a sequence of papers~\cite{oh2020geodesic,barba2019optimal,oh2020voronoi}, culminating in an optimal run time of   
$O(n + m \log m)$~\cite{wang2021optimal}. \changed{This is also the best-known bound for finding the center of $m$ points in a simple polygon.}
For sites more general than point sites inside a polygon, the only result we are aware of is our 
$O((n+m) \log (n+m))$ time algorithm to find the geodesic center of $m$ \emph{half-polygons}~\cite{lubiw2021visibility}, 
with edges being a special case. 

Finally, we mention a curious difference between nearest and farthest site Voronoi diagrams of edges
in a polygon.
The nearest Voronoi diagram of the edges of a polygon is the medial axis, 
one of the most famous and useful Voronoi diagrams.  The medial axis can be found in linear time~\cite{chin1999finding}.
By contrast,
the \emph{farthest} Voronoi diagram of edges in a polygon has received virtually no attention,
\changed{except for a convex polygon (which avoids geodesic issues)
where there is an $O(n \log n)$ time algorithm~\cite{drysdale2008nlogn}, and a recent 
expected \reviewerchange{linear-time algorithm}~\cite{khramtcova2014expected}.
}






\section{Overview of the Algorithm}
\label{sec:overview}



\changed{Before giving the overview of our algorithm, we outline the previous work that our algorithm builds upon, and explain what is novel about our contributions.}

Pollack et al.~\cite{pollack_sharir} gave an $O(n \log n)$ time algorithm to find the geodesic vertex center of a simple polygon. 
A main ingredient is to solve the problem one dimension down.
In particular, they develop an $O(n)$ time 
\emph{chord oracle}
that, given
a chord of the polygon, finds the \emph{relative center} restricted to the chord
and from that, determines whether the 
center of the polygon lies to left or right of the chord.  
By applying the chord oracle $O(\log n)$ times, they limit the 
search to a convex subpolygon where Euclidean distances can be used.
This reduces the problem to finding 
a minimum disc that encloses some disks, which Megiddo~\cite{megiddo_spanned_ball} solved in linear time using the same approach as  for his linear programming algorithm.
\reviewerchange{We extended the chord oracle to handle farthest \emph{edges} instead of vertices~\cite{lubiw2021visibility}.}

The idea used in the chord oracle algorithm is central to further developments. Expressed in general terms, 
the goal is to find a point in a domain (either a chord or the whole polygon) that minimizes the maximum distance to a %
site (a vertex or edge of the polygon). The idea is to first find what we will call a \defn{coarse cover} of the domain by a linear number of elementary regions $R$ (intervals or triangles), 
\changed{each with an associated easy-to-compute convex function $f_R$ that captures the geodesic distance to a potential farthest edge, and with the property that
the upper envelope of the functions is 
the geodesic radius function.} 
Thus, the goal is to find the point $x$ that minimizes the upper envelope of the  functions $f_R$. 
When the domain is a chord,
the chord oracle solves this in linear time.

\changed{When the domain is the whole polygon, and the sites are vertices, 
Ahn et al.~\cite{linear_time_geodesic} gave a \reviewerchange{linear-time algorithm}.
They find a coarse cover of the whole polygon starting from 
Hershberger and Suri's algorithm~\cite{hershberger1997matrix} to find the farthest vertex from each vertex.  
They then use divide-and-conquer based on $\epsilon$-nets---their big innovation---to reduce the domain to a triangle. After that, the vertex center is found using  
Megiddo-style prune-and-search techniques 
like those used by 
Pollack et al.}

Our algorithm uses a similar approach, modified to deal with farthest \emph{edges} rather than vertices. 
Another difference is that 
we give a simpler method of finding a coarse cover of the polygon by first finding 
the \reviewerchange{geodesic farthest-edge} Voronoi diagram on the polygon boundary.
There is a \reviewerchange{linear-time algorithm} to find the geodesic farthest \emph{vertex} Voronoi diagram on the polygon boundary by Oh, Barba, and Ahn~\cite{oh2020voronoi}.
Our algorithm is considerably simpler, and 
\reviewerchange{it is a novel idea to use the boundary Voronoi diagram to find the center.}

Other differences between our approach and that of Ahn et al. are introduced in order to 
repair 
some flaws in 
their paper.
\changed{
They use $\epsilon$-net techniques, but their range space does not have the necessary properties for finding $\epsilon$-nets in deterministic linear time. We remedy this by using a different range space, thereby repairing and generalizing their result.}

\paragraph*{Algorithm Overview}

\paragraph*{Phase I: Finding the \reviewerchange{Farthest-Edge} Voronoi Diagram Restricted to
the Polygon Boundary (Section~\ref{section:Phase-I})}
We first show that the \reviewerchange{linear-time algorithm} of Hershberger and Suri~\cite{hershberger1997matrix} that finds the farthest \emph{vertex} from each vertex can be modified to find the farthest \emph{edge} from each vertex.
A polygon edge $e$ whose endpoints have the same farthest edge $g$ is then part of the farthest Voronoi region of $g$.
To find the Voronoi diagram on a 
\emph{transition edge}
$e$ 
that has different farthest edges at its endpoints, we must find
the upper envelope of the coarse cover of $e$.   
\changed{We use the fact that the coarse cover of $e$ is 
constructed from two shortest path trees inside a smaller subpolygon called the \emph{hourglass} of $e$. The hourglasses of all transition edges can be found in linear time. 
In each hourglass, 
the shortest path trees \reviewerchange{allow} us to construct the upper envelope incrementally in linear time---this is a main new aspect of our work.}


\paragraph*{Phase II: Finding the Geodesic Edge Center (Section~\ref{section:PhaseII})}
We first find a coarse cover of the polygon by triangles, 
each bounded by two polygon chords plus a segment of an edge, and 
each with an associated convex function that captures the 
geodesic distance to a potential farthest edge---the potential farthest edges are 
those that have 
non-empty Voronoi regions
on the boundary of $P$.
The problem of finding the edge center is then reduced to the problem of finding
the point that minimizes the upper envelope of the coarse cover functions.

To find this point we use divide-and-conquer, reducing in each step to a smaller subpolygon with a constant fraction of the coarse cover elements. 
There are two stages.
In Stage 2, once the subpolygon is a triangle, the prune-and-search approach of Megiddo's can be applied.  
In Stage 1
every coarse cover triangle that intersects the subpolygon has a boundary chord crossing the subpolygon, and $\epsilon$-net techniques are used to reduce the number of such chords, and hence the number of coarse cover elements.
Our approach follows that of Ahn et al.~\cite{linear_time_geodesic} but 
we repair some flaws---another main new aspect of our work.
Ahn et al.~recurse on subpolygons called ``4-cells'' that are the intersection of four half-polygons (a \defn{half-polygon} is the subpolygon to one side of a chord).
\newchanged{We instead recurse on ``$3$-anchor hulls'' that are the geodesic convex hulls of at most three points or subchains of the polygon boundary.} 
These define a 
range space 
whose ground set is 
a set of chords and whose ranges are subsets of chords that cross a
$3$-anchor hull. 
We prove that our range space has finite VC-dimension, which repairs the faulty proof in Ahn et al.~for 4-cells.
Even more crucially, we give a ``subspace oracle'' that permits an $\epsilon$-net to be found in \emph{deterministic} linear time, 
\newchanged{something missing from their approach.}


\section{Preliminaries}
\label{section:prelims}

Although our algorithm follows the pattern of the geodesic vertex center algorithm by Ahn et al.~\cite{linear_time_geodesic}, we must re-do everything from the ground up to deal with farthest edges. 
In this section we summarize
\reviewerchange{some basic results,}
deferring proofs and details to the
appendix.



\subparagraph*{Notation and Definitions.}
\label{sec:notation}
A \defn{chord} of a polygon is a straight line segment in the (closed) polygon with both endpoints on the boundary, $\partial P$. 
For a point $p \in P$ and a point or line segment $s$ in $P$, \defn{$\pi(p,s)$} is the unique \defn{shortest} (or \defn{geodesic}) path from $p$ to $s$, and \defn{$t(p,s)$} is its \defn{terminal point}.
The length of $\pi(p,s)$, denoted \defn{$d(p,s)$}, is the \defn{geodesic distance} from $p$ to $s$.
\reviewerchange{For point $p$ in $P$, a \defn{farthest edge}, \defn{$F(p)$}, is an edge for which $d(p, F(p)) \geq d(p,e)$, for %
every edge $e$ of $P$.}
The \defn{geodesic radius} of point $p$ is \defn{$r(p)$} $:= d(p,F(p))$.
The \defn{geodesic edge center} is a point $p \in P$ that minimizes
$r(p)$.





\subparagraph*{\reviewerchange{General Position} Assumptions.}
\label{sec:general-position}

\changed{As is standard for Voronoi diagrams of segments, e.g., see~\cite{aurenhammer2006farthest}, we use the following tie-breaking rule %
to prevent 2-dimensional Voronoi regions with more than one farthest edge.}





\subparagraph*{Tie-Breaking Rule.} 
Suppose that $p$ is a point of $P$, $e$ and $f$ are two edges that meet at reflex vertex $u$, and
$\pi(p,e) = \pi(p,f) = \pi(p,u)$. 
\changed{Let line $b$ be the angle bisector of $u$.
For $p$ not on $b$, break the tie $d(p,e)=d(p,f)$
by saying that the distance to the edge on the opposite side of $b$ is greater.}


\medskip
\changed{We make the following \reviewerchange{general position} assumptions, which we claim can be effected by perturbing vertices.}

\changed{
\begin{assumptions}
\label{assumptions}
(1) No three vertices of 
    $P$ are collinear.
(2) After imposing the tie-breaking rule, no vertex is equidistant from two or more edges.
(3) No point on the polygon boundary has more than two farthest edges and no point in the interior of the polygon has more than a constant number
\reviewerchange{(six)}
of farthest edges.
\end{assumptions}
}
It follows that the set of points with more than one farthest edge 
is 1-dimensional, does not contain any vertex of $P$, and intersects $\partial P$ in isolated points; see
Lemma~\ref{lem:1D-Voronoi-edges} in Appendix~\ref{appendix:general-position}.





\subparagraph*{Properties of Farthest Edges.}
\label{sec:farthest-properties}
We need the following basic ``triangle property'' (proved in
Appendix~\ref{appendix:farthest-properties}) 
about shortest paths that cross. 

\begin{lem}
\label{lem:new_order}
Suppose the points $p$, $q$ and the edges $e$, $f$ occur in the order $p,q,e,f$ along the polygon boundary $\partial P$.
Then $d(p,e) + d(q,f) \geq d(p,f) + d(q,e)$.
\end{lem}

We then characterize what two paths to farthest edges are like, see Figure~\ref{fig:correct_orderings} and
Appendix~\ref{appendix:farthest-properties}.  
In particular, we generalize the \reviewerchange{farthest-vertex} Ordering Property~\cite{aronov1993farthest} as follows.


\subparagraph*{The Ordering Property.}
As $p$ moves clockwise around $\partial  P$, so does $F(p)$.






\begin{figure}
  \centering
  \includegraphics[width=0.6\textwidth]{RS_figures/possible_and_impossible_orderings_1-cropped.pdf}
  \caption{
Schematics for possible and impossible orderings of points $p$, $q$ and their farthest edges $F(p)$ and $F(q)$.  (a) The only possible ordering if $F(p) = F(q)$. 
(b),(c) The two possible orderings if $F(p) \ne F(q)$.
(d) The impossible ordering if $F(p) \ne F(q)$.  
}
\label{fig:correct_orderings}
\end{figure}


\subparagraph*{Shortest Paths To/From Edges.}
\label{sec:shortest-paths}

As basic tools, we need \reviewerchange{linear-time algorithm}s to find  shortest paths from a  given  point to all edges of the polygon, and to find shortest paths from a  given  edge to all  vertices of the polygon.
See 
Appendix~\ref{appendix:shortest-paths}.


\subparagraph*{Separators and Funnels.}
\label{sec:separators}

A geodesic path between two vertices of $P$ separates $\partial P$ into two parts, and when we focus on which vertices/edges are in opposite parts,
we call the geodesic path 
a ``separator''.
Separators, first introduced by Suri~\cite{suri1989}, are a
main tool for finding all farthest vertices in a polygon. 
In 
Appendix~\ref{appendix:separators} 
we extend the %
basic properties of separators to the case of farthest \emph{edges} and prove:
(1) 
If vertex $v$ and edge $e$
\reviewerchange{($e$ need not be farthest from $v$)}
are separated by a geodesic path $\pi(a,b)$, then the shortest path from $v$ to $e$ is contained, except for one edge, in the shortest path trees of $a$ and $b$;
(2) A constant number of separators suffice to separate every vertex from its farthest edge.

\subsection{Chord Oracles and Coarse Covers}\label{section:chord_oracle}

In this section we 
describe the chord oracle results that we need from previous work, 
and we give a unified explanation of those algorithms and our current algorithm in terms of coarse covers.
The basic function of a chord  oracle is to decide, given a chord $K$, whether the center lies to the left or right (or on) the chord.
Pollack et al.~\cite{pollack_sharir} gave a \reviewerchange{linear-time} chord oracle for the geodesic vertex center, 
which is at the heart of all further geodesic center algorithms.
\reviewerchange{We extended the chord oracle to the case of the geodesic \emph{edge} center~\cite{lubiw2021visibility}.}

In both cases, 
a main 
step is 
the ``one-dimension down''
problem of 
finding 
the \defn{relative center}, which is a point $c_K$ on $K$ that minimizes the 
geodesic radius function $r(x)$.
The directions of the first segments of the paths from $c_K$ to its farthest sites determine
whether the center of $P$ lies 
left/right/on $K$
(see 
Appendix~\ref{appendix:oracles}).







Algorithms to find the relative 
center of a chord 
or the 
center of a polygon
rely on a basic convexity property of the geodesic radius function (see
Lemma~\ref{lem:geodesically-convex} in Appendix~\ref{appendix:oracles}), 
and all
follow the same pattern, which can be 
formalized via the concept of a \emph{coarse cover} of the chord/polygon. 
The idea is that 
a \emph{coarse cover} for a domain (a chord/polygon)  
is a set of elementary regions $R$ (intervals/triangles) covering the domain,
where each region $R$ has 
an associated 
easy-to-compute convex function $f_R$, 
such that the upper envelope of the $f_R$'s is the geodesic radius function.
We give a precise definition 
for the case of farthest edges
(following~\cite{lubiw2021visibility} and specialized for our Assumptions~\ref{assumptions}).

\begin{definition}
\label{defn:coarse-cover}
A \defn{coarse cover} of chord $K$ [or polygon $P$] is  
a set of 
triples $(R,f,e)$
where 
\begin{enumerate}
\item 
$R$ is a subinterval of $K$ [or a triangle of $P$], $f$ is a function defined on domain $R$, and $e$ is an edge of $P$.

\item For all $x \in R$, $f(x) = d(x,e)$ and
either: $f(x) = d_2(x,v) + \kappa$ where $d_2$ is Euclidean distance, $\kappa$ is a constant
and
$v$ is 
a vertex of $P$; or
$f(x) = d_2(x, {\bar e})$, where $d_2$ is Euclidean distance and $\bar e$ is the line through $e$.



\item 
For any point $x \in K$ [or $P$], and any edge $e$ that is farthest from $x$, there is a triple $(R,f,e)$ in the coarse cover with $x \in R$. 


\end{enumerate}
\end{definition}

Condition (3) 
implies that the upper envelope of the functions of the coarse cover is the geodesic radius function. Thus the
[relative] center problem breaks into two subproblems:
(1) find a coarse cover; and (2)  find the point $x$ that minimizes the upper envelope of the coarse cover functions.
The high-level idea for solving step (2) in linear time  (for a chord or polygon domain) is to 
recursively reduce the domain (the search space) to a subinterval or subpolygon while eliminating elements 
of the coarse cover whose functions are strictly dominated by others.
As for step (1)---constructing a coarse cover---see Section~\ref{section:Phase-I} for a chord and Section~\ref{section:Phase-II} for a polygon.

We call the chord oracle in Phase II when we use divide-and-conquer to search for the center in successively smaller subpolygons.  We actually need two variations of the basic chord oracle.  
First, we need a \emph{geodesic oracle} that tests which side of a geodesic contains the center.  Secondly, we 
do not construct a coarse cover of a chord/geodesic from scratch; rather, we intersect the triangles of the coarse cover of the subpolygon with the chord/geodesic, 
thus avoiding runtime dependence on $n$.
These variations are described in
Appendix~\ref{appendix:oracles}.






\section{Phase I: Finding the \reviewerchange{Farthest-Edge} Voronoi Diagram Restricted to the Polygon Boundary}
\label{section:Phase-I}

\changed{Based on Assumptions~\ref{assumptions}, the boundary of $P$ consists of chains with a single farthest edge, separated by %
points (not vertices) that have two farthest edges
\reviewerchange{(see Figure~\ref{fig:coarse-cover})}. 
Our goal is to find these points.}
The first step of the algorithm is to find the farthest edge from each vertex of the polygon in linear time.  To do this, we extend the algorithm of Hershberger and Suri~\cite{hershberger1997matrix} that finds the farthest \emph{vertex} from each vertex.  Details are in
Appendix~\ref{appendix:Hershberger-Suri}.
The next step is to fill in the Voronoi diagram along the polygon edges.
For an edge $ab$ where
vertices $a$ and $b$ have the same farthest edge, i.e., $F(a) = F(b)$,  all points on the edge $ab$ have the same farthest edge, by
the Ordering Property. 
An edge $ab$ with 
$F(a) \ne F(b)$ is a \defn{transition edge}. 
We will find the \reviewerchange{farthest-edge} Voronoi diagram on one transition edge in linear time.  To handle \emph{all} the transition edges in linear time, we will show that for each transition edge $ab$ we can restrict our attention to 
\reviewerchange{the \defn{hourglass} $H(a,b)$ which is
the subpolygon of $P$ bounded by $ab$, $\pi(a,F(b))$, $\pi(b,F(a))$ and the %
portion of $\partial P$ between the terminals $t(a,F(b))$ and $t(b,F(a))$.}
In 
Appendix~\ref{appendix:hourglasses}
we show that the hourglasses of all transition edges can be found in linear time and that the sum of their sizes is linear. 





In this section, we show how to construct the 
\reviewerchange{farthest-edge} Voronoi diagram along one polygon edge $ab$ 
in time linear in the size of the polygon.
We do not assume that the polygon is an hourglass.
For purposes of description, imagine $ab$ horizontal with $a$ at the left, and the polygon interior above $ab$.
We use the \defn{coarse cover} (Definition~\ref{defn:coarse-cover}) of the edge $ab$,
which can be found in linear time (Lubiw and Naredla~\cite{lubiw_et_al:LIPIcs.ESA.2021.65}). 
Elements of the coarse cover are triples $(I,f,e)$ where $I$ is a subinterval of $ab$ and $f(x) = d(x,e)$ for any $x \in I$. 
By resolving overlaps of coarse cover intervals $I$, we find
the upper envelope of the coarse cover functions $f$, which immediately gives the Voronoi diagram on $ab$. 
This is easy if we  
sort the endpoints of the intervals $I$, but 
we cannot afford to sort. Instead, we will insert the coarse cover elements %
one by one, maintaining a list $M$ of [pairwise internally] disjoint subintervals of $ab$ together with an associated distance function $f_M(x)$. 
\changed{An efficient insertion order depends on the fact that}
elements of the coarse cover of edge $ab$ are associated with edges of the shortest path trees ${T}_a$ and ${T}_b$ (that consist of the shortest paths from $a$ and $b$, respectively, to all the edges of $P$). 
We will use the ordering of the trees as embedded in the plane.



Oh, Barba, Ahn~\cite{oh2020geodesic} gave a \reviewerchange{linear-time algorithm} to find the farthest \emph{vertex} Voronoi diagram on the boundary of $P$. 
\changed{The approach is similar, but they add coarse cover elements by iterating over the sites (the vertices in their case), which involves a complicated algorithm to sweep back and forth along $M$ maintaining a shortest path to the current vertex, and a tricky amortized analysis (see~\cite[Lemma 7]{oh2020geodesic}).
Our approach is simpler and more general.} 




\subsection{\reviewerchange{Farthest-edge} Voronoi Diagram on One Edge}
\label{sec:one-edge-Vor}

\reviewerchange{In previous work~\cite{lubiw2021visibility, lubiw_et_al:LIPIcs.ESA.2021.65}
we constructed}
a coarse cover
(see Definition~\ref{defn:coarse-cover})
of an edge $ab$ from the shortest path trees $T_a$ and $T_b$.  
\reviewerchange{The trees are first augmented}
with $0$-length edges so that the paths to every 
polygon edge $e$ end with  
a tree edge perpendicular to $e$. In particular, every polygon edge corresponds to a leaf in each tree.

Direct edges of $T_a$ and $T_b$ away from their roots. 
Each edge $uv$ of $T_a \setminus T_b$ with $u \ne a$
corresponds to an \defn{$a$-side} coarse cover element $(I,f,e)$ where $e$ corresponds to the farthest leaf of $T_a$ descended from $v$.
For example, in Figure~\ref{fig:example_2_e4}, see edge $a_3$ of $T_a$ and interval $I_{a_3}$.
There are symmetrically defined \defn{$b$-side} coarse cover elements.
Each edge $uv$ of $T_a \cap T_b$ with $u$ visible from $ab$ corresponds to a \defn{central triangle} coarse cover element $(I,f,e)$ where $e$ corresponds to the farthest leaf of $T_a$ descended from $v$.
For example, see edge $a_5=b_5$ and interval $I_{a_5}$.
Each polygon edge $e$ that has an interior point visible from $ab$ corresponds to a \defn{central trapezoid} coarse cover element $(I,f,e)$ where $I$ consists of the points on $ab$ whose shortest paths to $e$ arrive perpendicularly.
For example, see edge $e_4$ and interval $I_{e_4}$.



\begin{lem} 
(proved in
Appendix~\ref{appendix:one-edge-Vor})
\label{lem:consecutive-coarse-cover}
\label{cor:consecutive-coarse-cover}
For any edge $e$ of $P$, let $C(e)$ be the set of coarse cover elements $(I,f,e)$ for $e$.
If $C(e)$ is nonempty, then its elements correspond to a (possibly empty) path in $T_a$ directed towards a leaf, followed by a central triangle or trapezoid, followed by a (possibly empty) path in $T_b$ directed towards the root.  Furthermore, the corresponding intervals on $ab$ appear in order, are [internally] disjoint, and their union is an interval.
\end{lem}





\changed{We next construct a single tree $T$ whose edges correspond to coarse cover elements of $ab$.
Then we incrementally construct the \reviewerchange{farthest-edge} Voronoi diagram on $ab$ by adding coarse cover elements in a depth first search (DFS) order of $T$.
}

\subparagraph*{Constructing 
tree $T$.}
Starting with $T_a$,
attach an edge for each central trapezoid element to the associated leaf vertex of $T_a$; add the path of $b$-side triangle elements for each polygon edge $e$ after the central triangle or trapezoid for $e$; and contract original edges of $T_a$ that are not associated with coarse cover elements.
See Figure~\ref{fig:example_2_e4}(right).
We give more detail of these steps in 
Appendix~\ref{appendix:one-edge-Vor}.
The resulting tree $T$ can be constructed in linear time and its edges are in one-to-one correspondence with the coarse cover elements. 

\begin{obs}
\label{obs:consecutive-coarse-cover-T}
If $uv$ and $vw$ are edges of $T$, then the
corresponding coarse cover intervals
$I_1$ and $I_2$
appear in that order along $ab$ and intersect in a single point. 
\end{obs}



\begin{figure}
    \centering
    \begin{subfigure}[t]{0.43\textwidth}
        \centering
        \includegraphics[width=\textwidth]{RS_figures/example_2_for_DFS_algorithm_2_coarse_cover_for_e4_1-cropped.pdf}
    \end{subfigure}%
    \begin{subfigure}[t]{0.43\textwidth}
        \centering
        \includegraphics[width=\textwidth]{RS_figures/example_2_for_DFS_algorithm_2_coarse_cover_for_e7_3-cropped.pdf}
    \end{subfigure}
    \begin{subfigure}[t]{0.13\textwidth}
        \centering
        \includegraphics[width=\textwidth]{RS_figures/Ta_and_T_example_2_1_JUST_T_rotated_1-cropped.pdf}
    \end{subfigure}
    \caption{Coarse cover elements corresponding to some (not all) edges of $T_a$ (red) and $T_b$ (blue):  (left) coarse cover elements for $e_4$; 
(middle) coarse cover elements for $e_7$;
(right) the corresponding part of tree $T$.
\reviewerchange{When $I_{a_6}$ is handled by {\tt Insert} it wins the comparison with $I_{a_4}$ so it replaces $I_{a_4}$ up to the cross-over point $t$, and the algorithm discards the rest of $I_{a_6}$, together with $I_{e_4}$, and $I_{b_3}$.
}
}
\label{fig:example_2_e4}
\end{figure}



\subparagraph*{DFS Algorithm for the Voronoi Diagram.}
We add the coarse cover elements following a DFS of $T$ with children of a node in clockwise order. 
We maintain a list $M$ of interior disjoint subintervals of $ab$ whose union  is an interval starting at $a$. Each subinterval in $M$ records the coarse cover element it came from. 
Define $f_M$ to be the distance function determined by the intervals of $M$.
\changed{Initially, $M$ is the single point $a$, and $f_M$ is $- \infty$.}
At the end $M$ will be the upper envelope of the coarse cover functions (though this property is not guaranteed throughout). To handle edge $uv$ of $T$ with associated coarse cover element $(I,f,e)$, we compare $f$ to $f_M$ beginning at the left endpoint of $I$. We maintain a pointer $p_u$ that gives an interval of $M$ containing this endpoint. 
The recursive routine 
{\tt Insert}$(u,p_u)$ inserts into $M$ the portions of coarse cover elements that are associated with $u$'s subtree and that define the upper envelope.  
At the top level, we call {\tt Insert}$(a,p_a)$, where $p_a$ points to $a$.







\begin{algorithm}[H]
{\tt Insert}$(u, p_u)$ \ \ \ \# $u$ is a node of $T$ and $p_u$ is a pointer to an interval of $M$\\
\ \ \ \ {\bf for} each child $v$ of $u$ in clockwise order {\bf do}\\
\ \ \ \ \ \ $(I,f,e) :=$ the coarse cover element associated with the edge $uv$ of $T$\\
\ \ \ \ \ \ $l :=$ left endpoint of $I$; \ $r :=$ right endpoint of $I$\\
\ \ \ \ \ \ {\bf Invariant:} $p_u$ points to an interval of $M$ that contains $l$\\
\ \ \ \ \ \ {\bf if} $f(l^+) > f_M(l^+)$ where $l^+$ is just to the right of $l$  {\bf then}\\
\ \ \ \ \ \ \ \ replace intervals of $M$ starting at $p_u$ with a subinterval of $I$ ending at\\
\ \ \ \ \ \ \ \ \ \ the ``cross-over'' point $t < r$ where $f_M$ starts to dominate $f$, or at $r$\\
\ \ \ \ \ \ \ \  {\bf if} $f$ dominates until $r$ and $v$ is not a leaf of $T$ {\bf then}\\
\ \ \ \ \ \ \ \ \ \ \ {\bf call} {\tt Insert}$(v,p_v)$, where $p_v$ is a pointer to interval $I$ in $M$
\end{algorithm}

\subparagraph*{Runtime:}
Each edge of ${T}$ is handled once, and causes at most one new interval to be inserted into $M$, so the total number of endpoints inserted into $M$ is $O(n)$.
We can access $f_M(l^+)$ in constant time using the pointer $p_u$. 
Then 
the endpoints of intervals of $M$ that we traverse as we do the insertion vanish from $M$. 
Thus the runtime is $O(n)$.



\subparagraph*{Correctness:}
\changed{The following lemma implies that the final 
$M$ is the upper envelope of the coarse cover functions.}
 %
\begin{lem}
\label{lem:DFS-correct}
The algorithm only discards pieces of coarse cover elements that do not form part of the final upper envelope.
\end{lem}



\begin{proof}
We examine the behaviour of the algorithm for edge $uv$ of $T$ with associated coarse cover element $(I,f,e)$, where $I=[l,r]$.   
We insert the subinterval $[l,t]$ into $M$ (or no subinterval). 
Because  $f(x) \ge f_M(x)$ for $x \in [l,t]$, any subintervals of $M$ that are removed due to the insertion do not determine the upper envelope, so their removal is correct. 

If we insert all of interval $I$ into $M$ and recursively call Insert$(v,p_v)$, then this is correct by induction.  
So suppose we insert a proper subinterval of $I$ or none of $I$.  
We must prove that no later part of $I$, and no element of the coarse cover associated with edges of the subtree rooted at $v$ determines the upper envelope. 
Let $t^+$ be a point just to the right of $t$ (or just to the right of $l$ if we insert no part of $I$).  Then $f_M(t^+) > f(t^+)$.
Number the polygon edges $e_1, e_2, \ldots, e_m$ clockwise from $a$ to $b$.  
Suppose that $e = e_i$, so $f(x) = d(x,e_i)$ for $x \in I$, in particular, $f(t^+) = d(t^+,e_i)$.
Suppose that 
$f_M(t^+) = d(t^+,e_k)$. 
Then $d(t^+,e_k) > d(t^+, e_i)$.  

Now consider the edges of $T$ descended from $v$ plus the edge $uv$.  Consider the corresponding coarse cover elements, $C_v$, and let $e_j$ be 
any polygon edge associated with any element in $C_v$. 
Note that the intervals on $ab$ associated with coarse cover elements of $C_v$ lie to the right of $r$, except for $I$ associated with $uv$.
We will prove that for any point $x \in ab$ to the right of $t^+$, $d(x,e_k) > d(x,e_j)$, which implies that none of the coarse cover elements in $C_v$ determines the upper envelope, nor does any part of $I$ to the right of $t$. Thus the algorithm is correct to discard them.

\changed{We first prove the result for $x = t^+$.}
If $uv$ corresponds to a central triangle/trapezoid for $e_i$
or a $b$-side triangle, then $T$ has a single path descending from $v$, all of whose edges are associated with $e_i$, i.e., $j=i$.  Otherwise, 
\changed{by the definition of
an $a$-side coarse cover element, $e_i$ corresponds to the farthest leaf of $T_a$ descended from $v$, which implies that  
}
$d(x,e_i) \ge d(x,e_j)$ for all $x \in I$, and in particular for $x=t^+$. 
Thus, in either case we have 
$d(t^+,e_k) > d(t^+, e_i) \ge d(t^+,e_j)$.

We next claim that $k < j$.  
The current $f_M$ values arise from tree edges already processed. 
These consist of: (1) edges on the path from $a$ to $u$; and (2)  edges of $T$ counterclockwise from this path.  
Edges on the path from $a$ to $u$ have coarse cover intervals on $ab$ to the left of $l$, by Observation~\ref{obs:consecutive-coarse-cover-T}.
Thus type (1) edges do not determine $f_M(t^+)$. 
By the depth-first-search order, type (2) edges have coarse cover elements corresponding to polygon edges counterclockwise from $e_j$.  Thus $k<j$.


To complete the proof of Lemma~\ref{lem:DFS-correct},
consider any point $x \in ab$ to the right of $t^+$. The clockwise ordering around the polygon boundary is $x,t^+, e_k, e_j$, so by
Lemma~\ref{lem:new_order}
and the fact that  $d(t^+,e_k) > d(t^+,e_j)$, we get $d(x,e_k) >  d(x,e_j)$, as required.  
\end{proof}


\section{Phase II: Finding the Geodesic Edge Center}
\label{section:final_edge_center}
\label{section:PhaseII}
\label{section:Phase-II}


The first step of Phase II is 
to construct a 
\defn{coarse cover} (Definition~\ref{defn:coarse-cover}) 
of the polygon
in linear time.
As shown in Figure~\ref{fig:coarse-cover} the
\reviewerchange{\defn{funnel} $Y(e)$ that consists}
of shortest paths between a chain on $\partial P$ with farthest edge $e$ and $e$ itself can be partitioned into its shortest path map.  If the result includes trapezoids, we partition each one into two triangles\footnote{Thus our triangles are not necessarily ``apexed'' triangles as in~\cite{linear_time_geodesic}.}. 
Each triangle is bounded by two polygon chords and a segment of a polygon edge, and the distance to $e$ has the form required by Definition~\ref{defn:coarse-cover}
(see 
the 
Appendix~\ref{appendix:coarse-cover} 
for details).
We seek the point inside $P$ that minimizes the upper envelope of the functions of the coarse cover. 
\changed{Note that Phase I can detect if the edge center lies \emph{on} $\partial P$ so we may assume that the center is interior to $P$.}


\begin{figure}
\centering
\includegraphics[trim={0 0cm 0 0}, width=.5\textwidth]{RS_figures/farthest_voronoi_one_spm_improved-cropped.pdf}
\caption{
\reviewerchange{The farthest-edge Voronoi diagram restricted to the polygon boundary consists of chains $C(e),C(f),C(g)$ 
farthest from edges $e,f,g$, respectively.
To construct the coarse cover,
the funnel 
$Y(e)$ (shaded) is partitioned (by dashed segments) into a shortest path map from $e$ to $C(e)$.}
}
\label{fig:voronoi_split}
\label{fig:coarse-cover}
\label{fig:flower}
\end{figure}




Our final divide-and-conquer algorithm follows the vertex center algorithm of Ahn et al.~\cite{linear_time_geodesic}, generalized to farthest edges, and repairing flaws in their approach.
At each step of the algorithm we have a subpolygon $Q$ whose interior contains the center together with the coarse cover elements  
\newchanged{needed to compute the edge center}
and we shrink the subpolygon and eliminate a constant fraction of the 
coarse cover.
Each recursive step takes time linear 
in the size of the subproblem (the size of $Q$ plus the size of its coarse cover).
The subpolygons we work with \reviewerchange{are
\defn{$3$-anchor hulls}} defined as follows 
\reviewerchange{(see Figure~\ref{fig:shatter}).}
An \defn{anchor} is a point inside $P$, or a subchain of $\partial P$.  
A \defn{$3$-anchor hull} is the geodesic convex hull of at most three anchors.
These are weakly simple in general, but 
we only recurse on \defn{simple} $3$-anchor hulls.


The algorithm has two stages.
In Stage 1
no triangle of the coarse cover contains $Q$ (this is true initially when $Q=P$), so every triangle
has a chord crossing $Q$ and we
use $\epsilon$-net techniques on the set of such chords to reduce to a smaller cell $Q'$ that is crossed by a fraction of the chords, and hence by a %
fraction of the coarse cover triangles.
Once $Q$ is contained in a triangle of the coarse cover
we show (see
Lemma~\ref{lem:floating_cells_constant_size} in Appendix~\ref{appendix:Q-bounds})
that 
\reviewerchange{the size of $Q$, denoted $|Q|$, is at most 6.}
In fact, we will exit Stage 1 as soon as 
\reviewerchange{$|Q| \le 6$.}
It is then easy to reduce $Q$ to a triangle. 
After that, we switch to Stage 2, where the convexity of $Q$ allows us to use 
a Megiddo-style prune-and-search technique
\newchanged{(as Ahn et al.~do)}
to recursively reduce the size of the subproblem. 
Stage 2 is deferred to
Appendix~\ref{section:constantQ}.


\subsection{Stage 1: Algorithm for Large $Q$}
\label{section:largeQ}

Consider a subproblem corresponding to a 
\newchanged{simple $3$-anchor hull}
$Q$ with $|Q|>6$. %
We give an algorithm that either finds the edge center or reduces to a subproblem with $|Q| \le 6$, which is handled by Stage 2. 
In Stage 1, 
 no triangle of the coarse cover
contains $Q$ 
(this is proved in 
Lemma~\ref{lem:floating_cells_constant_size} in Appendix~\ref{appendix:Q-bounds}), 
so each one has a chord crossing $Q$---we denote this set of 
chords by ${\cal K}(Q)$.

To apply $\epsilon$-net techniques
we define a
\newchanged{\defn{$3$-anchor range space} as follows.
The ground set is 
a set $\cal K$ of chords of $P$,
and for each $3$-anchor hull $H$ of $P$ 
there is a range ${\cal K}(H)$ 
consisting of all chords of 
$\cal K$ that \defn{cross} $H$.
Here a chord \defn{crosses} a set  if both %
open half-polygons 
\reviewerchange{of the chord} contain points of the set.
}



The algorithm finds a constant size $\epsilon$-net of the \newchanged{$3$-anchor range space} on ${\cal K}(Q)$, 
which is 
a 
set $N \subseteq {\cal K}(Q)$ such that any \newchanged{$3$-anchor hull} 
not intersected by a chord of $N$ is intersected by only a constant fraction of the chords of ${\cal K}(Q)$---this is the important property that allows us to discard a fraction of the chords.
The set of chords $N$ forms an arrangement that partitions $Q$ into cells.
We use the chord oracle to determine which cell contains the center. We then 
add geodesic paths to 
subdivide this cell into 
a constant number of
$3$-anchor hulls
and use a \defn{geodesic oracle}
(see 
Appendix~\ref{appendix:geodesic-oracle})
to 
\newchanged{find which $3$-anchor hull contains the center, and to shrink it to a simple $3$-anchor hull 
$Q'$.} The algorithm recurses on $Q'$, whose coarse cover is a fraction of the size.


More details of the algorithm can be found in
Appendix~\ref{appendix:Algorithm-Stage1}.  
For now, we expand on the aspects of the algorithm that differ from the approach of Ahn et al.~\cite{linear_time_geodesic}.
Instead of 
$3$-anchor hulls,
their algorithm works with \emph{$4$-cells}, 
\newchanged{formed by taking the intersection of at most four half-polygons, where a half-polygon is the part of $P$ to one side of a chord}.
The number (three versus four) is not significant, but we 
\newchanged{bound our regions by geodesics instead of chords} 
in order 
to obtain the following two results. 

\subparagraph{1.} The
\newchanged{$3$-anchor}
range space has finite VC-dimension.  This implies that constant-sized $\epsilon$-nets exist. Furthermore, there is a ``subspace oracle'' 
that allows us to find an $\epsilon$-net $N$ in deterministic linear time~\cite[Chapter 47, Theorem 47.4.3]{toth2017handbook}. For 
further 
background see
Appendix~\ref{appendix:epsilon-net-overview}. 


Ahn et al.~claim that their range space 
\newchanged{(of chords crossing $4$-cells)}
has finite VC-dimension but their proof is flawed.
Our proof shows that their range space does in fact have finite VC-dimension.
\newchanged{They do not mention subspace oracles, without which their algorithm runs in expected linear time rather than deterministic linear time as claimed.}
We expand on these aspects in Section~\ref{section:epsilon-net-results} below.

\subparagraph{2.} A cell of the arrangement of $N$ can be partitioned into 
constantly many
$3$-anchor hulls.

The method used by Ahn et al.~to 
subdivide a cell of $N$ into $4$-cells by adding a constant number of chords is
incomplete, 
\reviewerchange{see Figure~\ref{fig:decomposition-1}.}
We see how to repair their partition step
but we find 
$3$-anchor hulls
more natural.

\begin{figure}[ht!]
\centering
\includegraphics[width=.15\textwidth]{RS_figures/counterexample_new-cropped.pdf}
\caption{
\reviewerchange{Ahn et al.~\cite{linear_time_geodesic} subdivide a cell of $N$ by adding 
vertical chords (dashed) at endpoints and intersection points of chords of $N$ (blue), which leaves a $5$-cell in this example.} 
}
\label{fig:decomposition-1}
\end{figure}


\subsection{$\epsilon$-Net Results for Stage 1}
\label{section:epsilon-net-results}

In this section we expand on the $\epsilon$-net results that are needed for Stage 1 of the algorithm as described above.  We also give details of the flaws in the approach of Ahn et al.~\cite{linear_time_geodesic}.
For an overview of $\epsilon$-nets as used for geometric divide-and-conquer, see
Appendix~\ref{appendix:epsilon-net-overview}.
To show that $\epsilon$-nets of
\reviewerchange{constant} size %
exist we need the following result.

\begin{lem}
\label{lem:constant_shattering_dimension}
The \newchanged{$3$-anchor}
range space has 
VC-dimension less than 259.
\end{lem}



Our proof of Lemma~\ref{lem:constant_shattering_dimension} works equally well for
\newchanged{$4$-anchor hulls}---the
bound becomes $372$. 
\newchanged{A $4$-cell is a special case of a $4$-anchor hull %
so}
our proof implies finite VC-dimension ($\le 372$) for the $4$-cell range space, which repairs the claim by Ahn et al.\footnote{In response to our enquiries, Eunjin Oh independently suggested a similar remedy.}.
We explain the flaw in 
their proof.
Let us refer to the set of chords intersecting a $4$-cell as a ``$4$-cell range''. 
Ahn et al.~prove that the $1$-cell range space has 
VC-dimension at most 65,535. 
They note that a $4$-cell is the intersection of four $1$-cells, and then claim in their Lemma 9.1 that
this implies finite VC-dimension for the $4$-cell range space.  As justification, they refer to 
Proposition 10.3.3 of Matousek's text~\cite{matousek2002}, which 
states 
that the VC-dimension is bounded for any family whose sets can be defined by a formula of Boolean connectives (union, intersection, set difference).
However, Matousek's proposition cannot be applied in this situation because, although a $4$-cell is the intersection of four $1$-cells,  
it is not true that 
a $4$-cell \emph{range} is the intersection of four $1$-cell \emph{ranges}.
In particular, a chord can intersect two $1$-cells, but not intersect the intersection of the two $1$-cells.  For example, a line of slope $-1$ can intersect the $+x$ half-plane and the $+y$ half-plane without intersecting the $+x,+y$ quadrant.




\begin{proof}[Proof of Lemma~\ref{lem:constant_shattering_dimension}]
We will prove that the shattering dimension is 6 and then apply the result that a range 
space with shattering dimension $d$ has VC-dimension bounded by $12d \ln{(6d)}$ (Lemma 5.14 from Har-Peled~\cite{har2011geometric}). 
For $d=6$, this is \reviewerchange{less than $259$}.

We must show that for
a set $\cal K$ of chords with 
$| {\cal K}| = m$, the number of distinct ranges is $O(m^6)$.
We prove that 
the range space for ${\cal K}$ is the same 
if we replace 
\newchanged{$3$-anchor hulls}
by   ``expanded $3$-anchor hulls'' that are defined in terms of $\cal K$, more precisely, 
in terms of the arrangement $A({\cal K})$
of the chords ${\cal K}$ plus the edges of $P$.
\newchanged{Define an \defn{expanded anchor} to be an internal face, edge, or vertex of $A({\cal K)}$, or a 
polygon chain
with endpoints in 
$V({\cal K})$, the set of endpoints of chords $\cal K$.
An \defn{expanded $3$-anchor hull} is the geodesic convex hull of at most three 
expanded anchors.}


\begin{figure}
  \centering
  \includegraphics[width=0.7\textwidth]{RS_figures/threeGthreeAcells_4-cropped.pdf}
  \caption{
  A simple 3-anchor hull $Q$ \reviewerchange{(outlined in red)} with anchors $v_1, v_2$ and the polygon chain $c_3$ \reviewerchange{(thick black)}. 
Solid blue chords cross $Q$, while dashed blue chords do not.  The expanded 3-anchor hull $\psi(Q)$ (lightly shaded)
has expanded anchors: $a_1$, the face in the chord arrangement containing $v_1$;
  $a_2$, the edge with $v_2$ in its interior; and
  $a_3$, the polygon chain extending $c_3$ to chord endpoints.
  The same  
  chords cross $Q$ and $\psi(Q)$.
}
\label{fig:shatter}
\end{figure}


\begin{lem}
\label{lem:anchor-ranges}
The set of ranges ${\cal R} = \{ {\cal K}(Q) \mid Q \text{ is 
a $3$-anchor hull}\,\}$ is the same as 
the set of ranges
$\overline{\cal R} = \{ {\cal K}({Q}) \mid {Q} \text{ is 
an expanded $3$-anchor hull}\,\}$.
\end{lem}

\begin{proof}
To prove ${\cal R} \subseteq \overline{\cal R}$, consider a 
\newchanged{$3$-anchor hull $Q$.
Replace any point anchor $p$}
by the 
smallest (by containment) internal vertex, edge, or face of $A({\cal K)}$ that contains $p$.
See Figure~\ref{fig:shatter}.
Replace any 
polygon chain anchor $C$  
by the smallest chain of 
$\partial P$ 
containing $C$ and with endpoints in $V({\cal K})$.
Let 
$\psi(Q)$ be the geodesic convex hull of these expanded anchors.  
Then $\psi(Q)$ is an expanded $3$-anchor hull that contains $Q$, and it is straight-forward to prove that 
${\cal K}(Q) = {\cal K}(\psi(Q))$
(see 
Claim~\ref{claim:same-crossing-chords} in Appendix~\ref{appendix:epsilon-nets}).

For the other direction, let $Q$ be an expanded $3$-anchor hull.
Replace an expanded anchor that is a face, edge, or vertex of $A({\cal K})$ by a point anchor in the interior of that face, edge, or vertex. An expanded anchor that is a polygon chain remains unchanged.
Let $\gamma(Q)$ be the
geodesic convex hull of the resulting anchors.
Observe that
\newchanged{$\gamma(Q)$ is a $3$-anchor hull and}
$\psi(\gamma(Q)) = Q$.
\reviewerchange{As above, this implies that}
${\cal K}(Q) = {\cal K}(\gamma(Q))$.
\end{proof}

\changed{
To complete the proof of Lemma~\ref{lem:constant_shattering_dimension} we claim that the number of expanded $3$-anchor hulls of ${\cal K}$ is $O(m^6)$.
An expanded anchor may be an
internal vertex, edge, 
\reviewerchange{or}
face
of $A(\cal K)$,  of which there are $O(m^2)$ possibilities.
Otherwise, an expanded anchor is 
a chain of $\partial P$ between vertices of $V({\cal K})$, 
also with
$O(m^2)$ possibilities.
Thus the number of expanded $3$-anchor hulls 
is $O((m^2)^3) = O(m^6)$.
}
\end{proof}

\paragraph*{Subspace Oracle}

\reviewerchange{To prove that the $3$-anchor range space has a subspace oracle, we present a deterministic algorithm that, given a subset ${\cal K}' \subseteq {\cal K}$ with $|{\cal K}'| = m$, computes the set
of ranges ${\cal R} = \{ {\cal K}'(Q) \mid Q \text{ is 
a $3$-anchor hull}\}$
in time $O(m^7)$.
The idea is 
to use Lemma~\ref{lem:anchor-ranges} and
to construct $A({\cal K}')$ minus the edges of $P$, 
and find, for each 
chord $K \in {\cal K}'$, which of the $O(m^2)$ expanded anchors in $A({\cal K}')$ \reviewerchange{intersects} each side of $K$, and then, for each of the $O(m^6)$ expanded $3$-anchor hulls, eliminate the chords that have all three expanded anchors to one side, leaving the chords that cross the hull. For further details see~\cite{lubiw2023edge}.
}










\bibliography{RS_refs}

\newpage

\appendix

\input{SoCG-300A_Preliminaries.tex}
\input{SoCG-400A_farthest-properties.tex}
\input{SoCG-500A_shortest-paths}
\input{SoCG-600A_separators}

\input{SoCG-700A_oracles}
\input{SoCG-1450A_Geodesic_Oracles}


\input{SoCG-800A_Hershberger-Suri}
\input{SoCG-860A_Hourglasses}
\input{SoCG-870A_one-edge-Vor.tex}

\input{SoCG-980A_Polygon-cover}

\input{SoCG-1220A_Q-bounds.tex}
\input{SoCG-1470A_Algorithm-Stage1}
\input{SoCG-1465A-Partition-counterex}

\input{SoCG-1400A_Epsilon-nets}
\input{SoCG-1460A-Epsilon-net-overview.tex}

\input{SoCG-1480A_Algorithm-Stage2}


\end{document}
\documentclass{article}
\usepackage{neurodata}


\title{Preserving Derivative Information while Transforming Neuronal Curves}

\author[1,2]{Thomas L. Athey\thanks{tathey1@jhu.edu}}
\author[3, 4]{Daniel J. Tward}
\author[5]{Ulrich Mueller}
\author[2,6,7,8]{Laurent Younes}
\author[1,2,7,8]{Joshua T. Vogelstein}
\author[1,2,7,8]{Michael I. Miller}

\affil[1]{Department of Biomedical Engineering, Johns Hopkins University, Baltimore, MD, USA}
\affil[2]{Institute of Computational Medicine, Johns Hopkins University, Baltimore, MD, USA}
\affil[3]{Department of Computational Medicine, University of California at Los Angeles, Los Angeles, CA, USA}
\affil[4]{Department of Neurology, University of California at Los Angeles, Los Angeles, CA, USA}
\affil[5]{Department of Neuroscience, Johns Hopkins University, Baltimore, MD, USA}
\affil[6]{Department of Applied Mathematics \& Statistics, Johns Hopkins University, Baltimore, MD, USA}
\affil[7]{Center for Imaging Science, Johns Hopkins University, Baltimore, MD, USA}
\affil[8]{Kavli Neuroscience Discovery Institute, Johns Hopkins University, Baltimore, MD, USA}

%\setcounter{tocdepth}{2}

\begin{document}
\maketitle

\begin{abstract}
The international neuroscience community is building the first comprehensive atlases of brain cell types to understand how the brain functions from a higher resolution, and more integrated perspective than ever before. In order to build these atlases, subsets of neurons (e.g. serotonergic neurons, prefrontal cortical neurons etc.) are traced in individual brain samples by placing points along dendrites and axons. Then, the traces are mapped to common coordinate systems by transforming the positions of their points, which neglects how the transformation bends the line segments in between.  In this work, we apply the theory of jets to describe how to preserve derivatives of neuron traces up to any order. We provide a framework to compute possible error introduced by standard mapping methods, which involves the Jacobian of the mapping transformation. We show how our first order method improves mapping accuracy in both simulated and real neuron traces under random diffeomorphisms. Our method is freely available in our open-source Python package brainlit.
\end{abstract}

\section*{Main}

\input{0-intro}

\section*{Results}

\subsection*{Action of Diffeomorphisms on Discrete Samplings}

\input{1-action}
\label{sec:action}

\subsection*{Error Analysis of Zeroth and First Order Mapping}

\input{2-erroranalysis}
\label{sec:firstorder}


\subsection*{Software Implementation}

\input{3-softwaremethod}

\label{sec:software}

\subsection*{Application to Real Neurons}

\input{5-realneurons}

\label{sec:realneurons}

\section*{Discussion}

\input{6-discussion}

\section*{Methods}

\input{methods}

\clearpage



\section*{Data Availability}

The neuron traces used in this work were from the MouseLight project's NeuronBrowser website: https://ml-neuronbrowser.janelia.org/. Specifically, we used traces: AA-1087, 1089-1093, 1149, 1192, 1196, 1223, 1413, 1417, 1477, 1493, 1537-1540, 1543 and 1548.

\section*{Code Availability}

The code used in this work is available in our open-source Python package brainlit: http://brainlit.neurodata.io/.


\section*{Acknowledgements}

This work is supported by the National Institutes of Health grants RF1MH121539, P41EB015909, R01NS086888, U19AG033655, RO1AG066184-01 the National Science Foundation grants 2031985, 2014862, and the CAREER award and the National Institute of General Medical Sciences Grant T32GM119998. We thank the MouseLight team at HHMI Janelia for providing us with access to this data, and answering our questions about it.

\section*{Ethics declaration}

Under a license agreement between AnatomyWorks and the Johns Hopkins University, Dr. Miller and the University are entitled to royalty distributions related to technology described in the study discussed in this paper. Dr. Miller is a founder of and holds equity in AnatomyWorks. This arrangement has been reviewed and approved by the Johns Hopkins University in accordance with its conflict of interest policies. The remaining authors have no conflicts of interest to declare.

\section*{Author Contribution Statement}

T.L.A. developed the mathematical details and the software, executed the experiments and contributed to the writing of this paper. D.J.T. contributed to the experimental design, and writing of the paper. U.M. contributed to the conceptual development, and data availability. L.Y. formulated the mathematical framework, contributed to the experimental design and the writing of the paper. J.T.V. contributed to the scope and design of the experiments. M.I.M. contributed to the scope of the experiments and the writing of the paper.

\section*{Inclusion and Ethics Statement}

The purpose of this work is to investigate a computational technique that is being used in the brain mapping community. The roles and responsibilities of the authors were discussed prior to the research.  Efforts were made to make the work accessible by, for example, providing data used in the experiments, and maintaining an open-source repository of the code with extensive documentation.

\section*{Research Animals Statement}

The mouse projection neuron traces came from the MouseLight project's NeuronBrowser website and the experimental protocols that generated this data can be found in Winnubst et al. 2019 \cite{winnubst2019reconstruction}. 

\bibliographystyle{plainnat}
\bibliography{refs}

\section*{Supplement}
\setcounter{equation}{0}
\setcounter{proposition}{0}
\setcounter{statement}{0}
\input{supplement}


\end{document}


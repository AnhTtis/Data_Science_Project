\documentclass{article}
\usepackage{neurodata}


\title{Preserving Derivative Information while Transforming Neuronal Curves}

\author[1,2]{Thomas L. Athey\thanks{tathey1@jhu.edu}}
\author[3, 4]{Daniel J. Tward}
\author[5]{Ulrich Mueller}
\author[2,6,7,8]{Laurent Younes}
\author[1,2,7,8]{Joshua T. Vogelstein}
\author[1,2,7,8]{Michael I. Miller}

\affil[1]{Department of Biomedical Engineering, Johns Hopkins University, Baltimore, MD, USA}
\affil[2]{Institute of Computational Medicine, Johns Hopkins University, Baltimore, MD, USA}
\affil[3]{Department of Computational Medicine, University of California at Los Angeles, Los Angeles, CA, USA}
\affil[4]{Department of Neurology, University of California at Los Angeles, Los Angeles, CA, USA}
\affil[5]{Department of Neuroscience, Johns Hopkins University, Baltimore, MD, USA}
\affil[6]{Department of Applied Mathematics \& Statistics, Johns Hopkins University, Baltimore, MD, USA}
\affil[7]{Center for Imaging Science, Johns Hopkins University, Baltimore, MD, USA}
\affil[8]{Kavli Neuroscience Discovery Institute, Johns Hopkins University, Baltimore, MD, USA}

%\setcounter{tocdepth}{2}

\begin{document}
\maketitle

\begin{abstract}
The international neuroscience community is building the first comprehensive atlases of brain cell types to understand how the brain functions from a higher resolution, and more integrated perspective than ever before. In order to build these atlases, subsets of neurons (e.g. serotonergic neurons, prefrontal cortical neurons etc.) are traced in individual brain samples by placing points along dendrites and axons. Then, the traces are mapped to common coordinate systems by transforming the positions of their points, which neglects how the transformation bends the line segments in between.  In this work, we apply the theory of jets to describe how to preserve derivatives of neuron traces up to any order. We provide a framework to compute possible error introduced by standard mapping methods, which involves the Jacobian of the mapping transformation. We show how our first order method improves mapping accuracy in both simulated and real neuron traces, though zeroth order mapping is generally adequate in our real data setting. Our method is freely available in our open-source Python package brainlit.
\end{abstract}

\section*{Main}

\input{0-intro}

\section*{Results}

\subsection*{Action of Diffeomorphisms on Discrete Samplings}

\input{1-action}
\label{sec:action}

\subsection*{Error Analysis of Zeroth and First Order Mapping}

\input{2-erroranalysis}
\label{sec:firstorder}


\subsection*{Software Implementation}

\input{3-softwaremethod}

\label{sec:software}

\subsection*{Application to Real Neurons}

\input{5-realneurons}

\label{sec:realneurons}

\section*{Discussion}

\input{6-discussion}

\section*{Methods}

\input{methods}

\clearpage

\bibliographystyle{plainnat}
\bibliography{refs}


\section*{Data and Code Availability}

The data and code used in this work is available in our open-source Python package brainlit: \\
http://brainlit.neurodata.io/.


\section*{Acknowledgements}

NIH Grants RF1MH121539, U19AG033655, and RO1AG066184-01, NSF grants 2031985, 2014862 and the CAREER award

This work is supported by the National Institutes of Health grants RF1MH121539, P41EB015909, R01NS086888, U19AG033655, RO1AG066184-01 the National Science Foundation grants 2031985, 2014862, and the CAREER award and the National Institute of General Medical Sciences Grant T32GM119998. We thank the MouseLight team at HHMI Janelia for providing us with access to this data, and answering our questions about it.

\section*{Ethics declaration}

Under a license agreement between AnatomyWorks and the Johns Hopkins University, Dr. Miller and the University are entitled to royalty distributions related to technology described in the study discussed in this paper. Dr. Miller is a founder of and holds equity in AnatomyWorks. This arrangement has been reviewed and approved by the Johns Hopkins University in accordance with its conflict of interest policies. The remaining authors have no conflicts of interest to declare.

\section*{Supplement}
\setcounter{equation}{0}
\setcounter{proposition}{0}
\setcounter{statement}{0}
\input{supplement}


\end{document}


\documentclass{article}
\usepackage{subcaption}
\usepackage{ifthen}
\usepackage{environ}
\usepackage{tikz}
\usepackage{xspace}
\usepackage{amssymb}
\usepackage[tbtags,fleqn]{amsmath}
\usepackage{multicol}
\usepackage[a4paper, margin=1in]{geometry}
\input{rs_macros_general}
\usetikzlibrary{shapes.geometric,arrows,positioning,backgrounds}
\makeatletter
\newcommand\footnoteref[1]{\protected@xdef\@thefnmark{\ref{#1}}\@footnotemark}
\makeatother
\title{CNF encodings for AIG}
\date{}

\begin{document}
\maketitle

\tikzset{->,>=stealth',shorten >=1pt,auto,node distance=0.8cm,
    thick,font=\footnotesize,
    internal node/.style={circle,draw,minimum size=1.2em},
    negation/.style={
            circle,
            draw,
            fill,
            minimum size=5pt,
            inner sep=0pt,
            anchor=center,
            %near end
            pos=0.6
        },
    and/.style n args={1}{
            internal node,
            label=center:$\wedge$,
            append after command={
                    node [right,red] at (\tikzlastnode.east) {#1}
                },
        },
    or/.style n args={1}{
            internal node,
            label=center:$\vee$,
            append after command={
                    node [right,red] at (\tikzlastnode.east) {#1}
                },
        },
    leaf/.style={rectangle,draw,minimum size=1em},
    distant/.style={node distance=1.5cm}
}

\begin{figure}[h]
    \centering
    \begin{subfigure}{0.4\textwidth}
        \begin{tikzpicture}
            \node(root) {};
            \node[and=$B_1$] (B1) [below of=root] {};
            \node[and={$B_2$}] (B2) [below left of=B1, distant] {};
            \node[and={$B_3$}] (B3) [below right of=B1, distant] {};
            \node[and={$B_4$}] (B4) [below left of=B3] {};
            \node[and={$B_5$}] (B5) [below right of=B3] {};
            \node[and={$B_6$}] (B6) [below left of=B4] {};
            \node[and={$B_7$}] (B7) [below left of=B6, distant] {};
            \node[and={$B_8$}] (B8) [below right of=B6, distant] {};
            \node[leaf] (A1) [below left of=B2] {$A_1$};
            \node[leaf] (A2) [below right of=B2] {$A_2$};
            \node[leaf] (A3) [below left of=B8] {$A_3$};
            \node[leaf] (A4) [below right of=B8] {$A_4$};
            \node[leaf] (A5) [below left of=B7] {$A_5$};
            \node[leaf] (A6) [below right of=B7] {$A_6$};
            \node[leaf] (A7) [below right of=B5] {$A_7$};

            \begin{pgfonlayer}{background}
                \path
                (root) edge node[negation] {} (B1)
                (B1) edge node[negation] {} (B2)
                (B1) edge (B3)
                (B2) edge (A1)
                (B2) edge (A2)
                (B3) edge node[negation] {} (B4)
                (B3) edge node[negation] {} (B5)
                (B4) edge node[negation] {} (B6)
                (B4) edge node[negation] {} (A7)
                (B5) edge (A7)
                (B5) edge (B6)
                (B6) edge node[negation] {} (B7)
                (B6) edge node[negation] {} (B8)
                (B7) edge node[negation] {} (A5)
                (B7) edge node[negation] {} (A6)
                (B8) edge node[negation] {} (A3)
                (B8) edge node[negation] {} (A4);
            \end{pgfonlayer}
        \end{tikzpicture}
        \caption{AIG of \vi}%
        \label{fig:aig}
    \end{subfigure}%
    \hfill%
    \begin{subfigure}{0.6\textwidth}
        \begin{tikzpicture}
            \node(root) {};
            \node[or=$B_1$] (B1) [below of=root] {};
            \node[and={$B_2$}] (B2) [below left of=B1, distant] {};
            \node[or={$B_3$}] (B3) [below right of=B1, distant] {};
            \node[and={$B_4$}] (B4) [below left of=B3] {};
            \node[and={$B_5$}] (B5) [below right of=B3] {};
            \node[or={$\neglab{B_6}$}] (B6n) [below left of=B4, distant] {};
            \node[and={$\poslab{B_7}$}] (B7p) [below left of=B6, distant] {};
            \node[and={$\poslab{B_8}$}] (B8p) [below right of=B6, distant] {};
            \node[and={$\poslab{B_6}$}] (B6p) [below right of=B5, distant] {};
            \node[or={$\neglab{B_7}$}] (B7n) [below left of=B6p] {};
            \node[or={$\neglab{B_8}$}] (B8n) [below right of=B6p] {};
            \node[leaf] (A1) [below left of=B2] {$A_1$};
            \node[leaf] (A2) [below right of=B2] {$A_2$};
            \node[leaf] (A3) [below left=1cm and 0cm of B8] {$A_3$};
            \node[leaf] (A4) [below right=1cm and 0cm of B8] {$A_4$};
            \node[leaf] (A5) [below left=1cm and 0cm of B7] {$A_5$};
            \node[leaf] (A6) [below right=1cm and 0cm of B7] {$A_6$};
            \node[leaf] (A7) [below right of=B4] {$A_7$};

            \begin{pgfonlayer}{background}
                \path
                (root) edge (B1)
                (B1) edge (B2)
                (B1) edge (B3)
                (B2) edge (A1)
                (B2) edge (A2)
                (B3) edge (B4)
                (B3) edge (B5)
                (B4) edge (B6n)
                (B4) edge node[negation] {} (A7)
                (B5) edge (A7)
                (B5) edge (B6p)
                (B6p) edge (B7n)
                (B6p) edge (B8n)
                (B6n) edge (B7p)
                (B6n) edge (B8p)
                (B7p) edge node[negation] {} (A5)
                (B7p) edge node[negation] {} (A6)
                (B8p) edge node[negation] {} (A3)
                (B8p) edge node[negation] {} (A4)
                (B7n) edge (A5)
                (B7n) edge (A6)
                (B8n) edge (A3)
                (B8n) edge (A4);
            \end{pgfonlayer}
        \end{tikzpicture}
        \caption{NNF DAG of \vi}%
        \label{fig:nnf}
    \end{subfigure}
    \caption{AIG and NNF DAG of \vi}%
    \label{fig:aig-nnf}
\end{figure}
Let:
\begin{itemize}
    \item $\vi$ be the formula represented by the AIG in Figure~\ref{fig:aig};
    \item $\NNF{\vi}$ be the NNF DAG of $\vi$ (Figure~\ref{fig:nnf});
    \item \PlaistedCNF{} be the Plaisted and Greenbaum transformation\footnote{\label{note1}Negative occurrences are labelled with a negative label $\neg B_i$ as $(\neg B_i\limp\vi_i)$};
    \item \PlaistedCNFdup{} be the Plaisted and Greenbaum transformation where the positive and negative occurrences of the same subformula $\vi$ use two different labels $\poslab{B_i}$ and $\neglab{B_i}$, respectively\footnoteref{note1};
\end{itemize}
%
Then:
\begin{multicols}{2}
    \begin{math}
        \begin{array}{lr}
            \PlaistedCNFdup({\vi}) \defas                                                         &        \\
            \quad                                                                      (\pos B_1) & \wedge \\
            \quad(\neg B_1 \limp \neg B_2 \wedge \neg B_3)                                        & \wedge \\
            \quad(\pos B_2 \imp \pos A_1 \wedge \pos A_2)                                         & \wedge \\
            \quad(\neg B_3 \limp \neg B_4 \wedge \pos B_5)                                        & \wedge \\
            \quad(\pos B_4 \imp \pos \neglab{B_6} \wedge \neg A_7)                                & \wedge \\
            \quad(\pos B_5 \imp \pos A_7 \wedge \pos \poslab{B_6})                                & \wedge \\
            \quad(\pos \poslab{B_6} \imp \pos \neglab{B_7} \wedge \pos \neglab{B_8})              & \wedge \\
            \quad(\neg \neglab{B_6} \limp \neg \poslab{B_7} \wedge \neg \poslab{B_8})             & \wedge \\
            \quad(\pos \poslab{B_7} \imp \neg A_5 \wedge \neg A_6)                                & \wedge \\
            \quad(\neg \neglab{B_7} \limp \neg A_5 \wedge \neg A_6)                               & \wedge \\
            \quad(\pos \poslab{B_8} \imp \neg A_3 \wedge \neg A_4)                                & \wedge \\
            \quad(\neg \neglab{B_8} \limp \neg A_3 \wedge \neg A_4)                               &        \\
        \end{array}
    \end{math}\break
    %---------COL 2
    \begin{math}
        \begin{array}{lr}
            \PlaistedCNF(\NNF{\vi}) \defas                                                        &        \\
            \quad                                                                      (\pos B_1) & \wedge \\
            \quad(\pos B_1 \imp \pos B_2 \vee \pos B_3)                                           & \wedge \\
            \quad(\pos B_2 \imp \pos A_1 \wedge \pos A_2)                                         & \wedge \\
            \quad(\pos B_3 \imp \pos B_4 \vee \pos B_5)                                           & \wedge \\
            \quad(\pos B_4 \imp \pos \neglab{B_6} \wedge \neg A_7)                                & \wedge \\
            \quad(\pos B_5 \imp \pos A_7 \wedge \pos \poslab{B_6})                                & \wedge \\
            \quad(\pos \poslab{B_6} \imp \pos \neglab{B_7} \wedge \pos \neglab{B_8})              & \wedge \\
            \quad(\pos \neglab{B_6} \imp \pos \poslab{B_7} \vee \pos \poslab{B_8})                & \wedge \\
            \quad(\pos \poslab{B_7} \imp \neg A_5 \wedge \neg A_6)                                & \wedge \\
            \quad(\pos \neglab{B_7} \imp \pos A_5 \vee \pos A_6)                                  & \wedge \\
            \quad(\pos \poslab{B_8} \imp \neg A_3 \wedge \neg A_4)                                & \wedge \\
            \quad(\pos \neglab{B_8} \imp \pos A_3 \vee \pos A_4)                                  &        \\
        \end{array}
    \end{math}
\end{multicols}
Hence, the two encodings result in the same CNF formula.

\end{document}

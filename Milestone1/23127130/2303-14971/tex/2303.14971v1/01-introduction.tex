
State-of-the-art SAT and SMT solvers deal very efficiently with formulas expressed in Conjunctive Normal Form (CNF). In real-world scenarios, however, it is common for problems to be expressed as non-CNF formulas. Hence, these problems must be converted into CNF before being processed by the solver. This conversion is generally done by using variants of the Tseitin~\cite{tseitin68} or the Plaisted\&Greenbaum~\cite{plaisted1986structure} transformations, which generate a linear-size equisatisfiable CNF formula by labelling sub-formulas with fresh Boolean atoms. This transformation can be employed also for SAT and SMT enumeration (AllSAT and AllSMT), by projecting the models on the original atoms only.

When passing from solving to enumeration, however, the capability of enumerating partial satisfying assignments that are as small as possible is crucial, because each prevents from enumerating a number of total assignments that is exponential w.r.t.\ the number of unassigned atoms. This raises the question of whether CNF encodings conceived for solving are also effective for enumeration. 
%A study on the impact of the CNF encoding on feature model analysis has been done by Kuiter et al.~\cite{kuiter_tseitin_2022}. 
To the best of our knowledge, however, no research has yet been published to analyse how the different CNF encodings may affect the effectiveness of the solvers for AllSAT and AllSMT.

In this paper, we investigate, both theoretically and empirically, the effectiveness of CNF conversion for enumeration. We focus on AllSAT, restricting to disjoint enumeration. We expect analogous results for AllSMT.\@ The contribution of this paper is twofold.
First, on the negative side, we show that the commonly employed CNF transformations for SAT are not suitable for AllSAT.\@ In particular, we notice that the Tseitin encoding introduces top-level label definitions for sub-formulas with double implications, which need to be satisfied as well and thus prevent the solver from producing short partial assignments. 
We also notice that the Plaisted\&Greenbaum transformation solves this problem only in part by labelling sub-formulas only with single implications if they occur with single polarity, but it has similar issues to the Tseitin transformation when sub-formulas occur with both polarities.
Second, on the positive side, we show that converting the formula into Negation Normal Form (NNF) before applying the Plaisted\&Greenbaum transformation can fix the problem and drastically improve the effectiveness of the enumeration process by up to orders of magnitude. 

This analysis is confirmed by an experimental evaluation of non-CNF problems originating from both synthetic and real-world-inspired applications. 
%We preprocess each formula using  different CNF transformations, and measure the number of partial assignments and the execution times for each transformation. 
The results confirm the theoretical analysis, showing that the combination of NNF with the Plaisted\&Greenbaum CNF allows for a significant reduction in both the number of partial assignments and the execution time.

The paper is organized as follows. In~\sref{sec:background} we introduce the theoretical background necessary to understand the rest of the paper. In~\sref{sec:problem} we analyse the problem of the classical CNF-izations when used for AllSAT.\@ In~\sref{sec:solution} we propose one possible solution, whose effectiveness is evaluated on both synthetic and real-world inspired benchmarks in~\sref{sec:experiments}. We conclude the paper in~\sref{sec:conclusions}, drawing some final remarks and indicating possible future work.

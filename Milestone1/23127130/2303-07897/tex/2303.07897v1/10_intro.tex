\section{Introduction}
% About the problem in general
% Object localization problem~\cite{probrob} is the problem of the object state determination from measurements.
Object localization problem is the problem of estimating an objectâ€™s state in an environment from sensor data and a map of the environment.
The object state may contain coordinates, velocities, internal states, and other quantities describing the internal object features.
% Since object states are noisy, additional measurements are needed to correct them. 
% To perform this in an environment with sensors errors requires measurements of the system state, and quantifying the relationship between objects.
% 
% The problem appears in many domains, e.g. navigation problems~\cite{Kalman, Lynch, Chot}, image processing~\cite{pf_img_proc}, in-door robots localization~\cite{Karkus}, self-driving cars ~\cite{Levinson,pf_self_driv}, finance~\cite{Racicot}, fatigue predictions~\cite{fatigue}. 
The problem appears in many domains, firstly in navigation~\cite{Kalman, Lynch, Chot}, but also in image processing~\cite{pf_img_proc}, finance~\cite{Racicot} and fatigue predictions~\cite{fatigue}.

In particular, mobile cleaning robots have to solve in-door or open space localization problem~\cite{Xiao, Thrun, Huang} to perform their basic functions such as vacuum cleaning. 
Even the simple vacuum cleaning robot Roomba~\cite{Roomba} uses multiple types of sensors to localize itself in the working space.
% optical, piezoelectric, and infrared sensors, a cliff detector, and other sensors to localize the robot. 
The same localization problem appears in the development of self-driving cars~\cite{Levinson}, which use cameras, radars, LIDARs~\cite{hecht2018lidar,faizullin2022open}, 2D laser scanners, a global positioning system (GPS), and an inertial measurement system~\cite{Samyeul}. 

% to drive without human interference~\cite{NVidia}.

Despite significant differences between applications listed above, they often can be treated within a similar framework, which contains prediction and update stages.
At the prediction stage, the object state model predicts the state in the next time moment or is being initialized. 
Then, the measurements are performed with sensors. 
Based on the measurement results, the predicted object state is recomputed in the update step.

% Add about environments

% Add problem description
% There are multiple implementations of the localization algorithms.
One of the classical approaches to solving the localization problem is the Kalman filter~\cite{Kalman}.
Kalman filter is a very fast and memory-efficient approach, though it has many limitations. 
For example, this method assumes  linearity of motion and measurement equations, Gaussian distribution of motion and measurement noise, and approximate knowledge of the initial object state. 
In the real-world scenario, these assumptions might not hold. 
Therefore, some modifications of the Kalman filter are used in practice, e.g. extended~\cite{julier1997new}, unscented~\cite{Julier}, and invariant extended~\cite{ieKF} Kalman filters.
They address linearity constraints by linearizing the equations around the current state estimate.
The effects from the non-Gaussian noise are treated with the entropy optimization technique in~\cite{Zhang}. 
Also, the ensembled Kalman filter~\cite{enKF} is suggested for problems with high-dimensional state vectors.
% It does not use a state covariance matrix but uses the ensemble of states instead of explicit treating of a probability distribution.
However, unlike the regular approach, the variations of the Kalman filter, generally, are not optimal estimators and even may diverge~\cite{EKF_divergence}. 
% Then, more complex modifications of the Kalman filter, such as the adaptive extended Kalman filter~\cite{AdaKalman}, and others are used. 
% They have low computational complexity $O(d^{2.376})$, where~$d$ is the state dimension. 
% However, the predicted states are very sensitive to the initial conditions.

An alternative to the Kalman filter is the particle filter~\cite{PF1996, del1997nonlinear, Kunsch}, which successfully treats non-linear motion and measurement equations and non-Gaussian motion and measurement noise. 
It also works well with significant uncertainties of the initial conditions. 
However, the single iteration of the particle filter is more costly compared to the one iteration of the Kalman filter. 
% has computational complexity $O(Nd)$, where $N \gg d$ denotes the number of particles.
% Note that this complexity is higher compared to the Kalman filter.
Moreover, the number of particles has to be exponentially increased with the dimension of state~\cite{kf_overview}, and thus particle filter is not appropriate for solving high-dimensional problems.
In addition, the method is purely stochastic and may require too many particles for convergence, especially in symmetric environments.

The main features of the considered environments are the positions of beacons and obstacles in the space.  
The localization problem in such symmetric environments becomes especially challenging if the initial states of an object are not known. 
We show that multiple symmetrically located beacons lead to poor performance of the particle filter method. 
The symmetry in the obstacles and beacons' positions leads to the instability of the prediction results for both Kalman and particle filters.
This phenomenon is observed if the noise in measurement results leads to the ambiguity of the location among symmetrical subparts.
% This may happen when the system noise exceeds the difference between the expected measurements results in different points.
% Also, aforementioned modifications of Kalman filter also require knowledge of the initial state and its covariance. 
% In addition, symmetry in the obstacles and beacons positions also leads to the prediction results instability both for Kalman and particle filters when the system noise exceeds the difference between the expected measurements results in different points.
Such symmetric environments model real-world settings, e.g. in-door navigation in standardized buildings and in symmetrically arranged city blocks.

% The other drawback is the degeneracy problem, which appears when most particles have too low weights, which results in the system state description  by a few particles only. This increases variance and finally may cause incorrect convergence~\cite{Frederick}.
% To address this problem resampling is being applied. The idea of resampling is to reduce the particles with low weights and duplicate those with higher weights so that the new weights of particles are more uniform. 
% In this case, the near-optimal states have a higher frequency to appear in the distribution. 
% That may be achieved in many ways and is discussed in ~\cite{resamp1}. 
% The simplest way is to perform the sampling with repetitions of indices proportional to the particle weights. However, this may cause other problems -- impoverishment or loss of particles diversity. In this case, the majority of particles are concentrated within a very small area of states.
% This may result in an incorrect representation of posterior distribution and finally incorrect state estimation. The situation will not be fixed regardless of the number of further time steps and measurements performed. 
% The problem of degeneracy and impoverishment is very broad and is a topic for separate research (see, for example~\cite{degeneracy}). 

% Add intuition of the proposed method
To address the excessive number of particles in symmetric environments, we suggest a natural combination of the particle and Kalman filters.
This combination is further referred to as the Multiparticle Kalman filter (MKF) and is based on the following ideas.
Each particle is processed with the Kalman filter equations and then, particle weights are updated based on the particle filter approach.
On the one hand, such a combination has a higher per-iteration complexity compared to the particle filter.
On the other hand, using Kalman equations in the prediction of every particle state can lead to faster convergence and higher robustness, which is shown in Section~\ref{sec::experiments}.

The contributions of this study are the following.
\begin{itemize}
    \item We have illustrated the performance degradation of the particle filter in symmetric environments.
    \item We have developed an accurate and robust localization algorithm based on the combination of the Kalman and particle filters.
    \item We have shown that our algorithm outperforms the particle filter in terms of both localization error and runtime.
\end{itemize}
% Add details about the symmetric environments and why they broke existing methods


% \subsection{Methods constraints}
% Despite both Kalman and particle filters proved their efficiency in many applications, they may show poor performance in challenging environments. Below will be considered tests with the following features:
% \begin{itemize}
    % \item Unknown initial coordinate and heading 
    % \item Worlds with many similar or identical subparts
    % \item Multiple symmetrically located beacons 
% \end{itemize}
 
% Discuss complexity, robustness and limitations of the existing methods (almost done) and the proposed one

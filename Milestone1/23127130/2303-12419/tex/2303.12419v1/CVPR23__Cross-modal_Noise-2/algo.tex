\begin{algorithm*}[th!]
\KwIn{A noisily-labeled dataset $\tilde{\mathcal{D}}$}
{
\textbf{Required}: the clean probability threshold $\delta$, two individual matching models $A$ and $B$ with different initializations and data batch sequences}

Warm up the model $(A,B)$ using $L_{hard}$ Eq.~\ref{eq:triplet_loss}.

\For{$i=1:num\_epochs$}
{
\textcolor{blue}{//Section.~\ref{sec:anchor_point}: modeling per-sample loss distribution using Eq.~\ref{eq:clean_posterior}}

$\mathcal{P}^A = \{p_i^A \mid p_i^A = p\left(k=0 \mid \ell_i\right)\}_{i=1}^N \leftarrow BetaMixtureModel(\tilde{\mathcal{D}},B)$

$\mathcal{P}^B = \{p_i^B \mid p_i^B = p\left(k=0 \mid \ell_i\right)\}_{i=1}^N \leftarrow BetaMixtureModel(\tilde{\mathcal{D}},A)$

\For{$k \in \{A,B\}$}
{
$\Tilde{\mathcal{D}}^k_c = \{(I_i,T_i,y_i=1) \mid p_i^k > \delta, \forall (I_i,T_i) \in \Tilde{\mathcal{D}}\}$ \hfill \textcolor{blue}{//Section.~\ref{sec:anchor_point}: anchor points selection using Eq.~\ref{eq:anchor_select}}

$\Tilde{\mathcal{D}}^k_n = \{(I_i,T_i) \mid p_i^k \leq \delta, \forall (I_i,T_i) \in \Tilde{\mathcal{D}}\}$\hfill \textcolor{blue}{//Section.~\ref{sec:anchor_point}: noisy data selection using Eq.~\ref{eq:noisy_select}}


\For{$j=1:num\_steps$}
{
Sample a mini-batch $\{\mathcal{B}_j^c = (I_c,T_c,y_c=1), \mathcal{B}_j^n= (I_n,T_n)\}$ from $\{\Tilde{\mathcal{D}}^k_c,\Tilde{\mathcal{D}}^k_n\}$

\textcolor{blue}{//Section.~\ref{sec:label_est}: soft label estimation by bidirectional cross-modal similarity consistency}

Keep the labels in $\mathcal{B}_j^c$, estimate soft correspondence labels $y^*$ for the noisy data $\mathcal{B}_j^n$ using Eq.~\ref{eq:soft_label}

\textcolor{blue}{//Section.~\ref{sec:soft_loss}: optimize the soft matching loss on the estimated soft correspondence label }

Train the network $k$ on $\{\mathcal{B}_j^c = (I_c,T_c,y_c=1), \mathcal{B}_j^n= (I_n,T_n,y_n=y^*)\}$ by minimizing Eq.~\ref{eq:soft_loss}
}
}
}

\KwOut{Matching models $(A,B)$}
\caption{The training pipeline of our robust cross-model matching framework.}
% \end{algorithmic}
\label{algo}
\end{algorithm*}


\documentclass[10pt,a4paper]{article}
\usepackage{amssymb, amsmath, amsthm}
\usepackage{color}
%\usepackage[backend=biber,doi=false,url=false]{biblatex}
\usepackage[backend=bibtex,doi=false,url=false]{biblatex}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage{graphicx}
\usepackage{subcaption}


\bibliography{IMEX_DG.bib}

\textheight 23.5cm 
\textwidth 15cm
\topmargin -1cm
\evensidemargin 0cm
\oddsidemargin 0cm
\parindent 0cm

\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Ltwoj}[2]{\left(#1,#2\right)_j}
\newcommand{\Ltwo}[2]{\left(#1,#2\right)_\matrixM}
\newcommand{\Hadvj}[2]{{\cal H}_j\left(#1,#2\right)}
\newcommand{\Ldiffj}[2]{{\cal L}_j\left(#1,#2\right)}
\newcommand{\Hadv}[2]{{\cal H}\left(#1,#2\right)}
\newcommand{\Ldiff}[2]{{\cal L}\left(#1,#2\right)}
\newcommand{\armeanm}[1]{\{#1\}_{j-\frac{1}{2}}}
\newcommand{\armeanp}[1]{\{#1\}_{j+\frac{1}{2}}}
\newcommand{\armean}[1]{\{#1\}}
\newcommand{\jumpm}[1]{[#1]_{j-\frac{1}{2}}}
\newcommand{\jumpp}[1]{[#1]_{j+\frac{1}{2}}}
\newcommand{\jump}[1]{[[#1]]}
\newcommand{\matrixM}{\mathbf M}
%\newcommand{\matrixS}{\underline{\underline{S}}}
\newcommand{\matrixS}{\mathbf S}
%\newcommand{\matrixQ}{\underline{\underline{Q}}}
\newcommand{\matrixQ}{\mathbf Q}
\newcommand{\matrixD}{\mathbf D}
%\newcommand{\matrixB}{\underline{\underline{B}}}
\newcommand{\matrixB}{\mathbf B}
\newcommand{\matrixK}{\mathbf K}
\newcommand{\matrixG}{\mathbf G}
%\newcommand{\matrixI}{\underline{\underline{I}}}
\newcommand{\matrixI}{\mathbf I}
%\newcommand{\matrixW}{\underline{\underline{W}}}
\newcommand{\matrixW}{\mathbf W}
\newcommand{\matrixL}{\mathbf L}
\newcommand{\matrixV}{\underline{\underline{V}}}
%\newcommand{\matrixA}{\underline{\underline{A}}}
\newcommand{\matrixA}{\mathbf A}
%\newcommand{\matrixC}{\underline{\underline{C}}}
\newcommand{\matrixC}{\mathbf C}
%\newcommand{\matrixP}{\underline{\underline{P}}}
\newcommand{\matrixP}{\mathbf P}
\newcommand{\diagrho}{\underline{\underline{\boldsymbol \rho}}}
\newcommand{\diagE}{\underline{\underline{\mathbf E}}}
\newcommand{\diagh}{\underline{\underline{\mathbf h}}}
\newcommand{\diagb}{\underline{\underline{\mathbf b}}}
\newcommand{\diagv}{\underline{\underline{\mathbf v}}}
\newcommand{\diagw}{\underline{\underline{\mathbf w}}}
%\newcommand{\diagu}{\underline{\underline{ u}}}
\newcommand{\diagu}{\underline{\underline{\mathbf u}}}
%\newcommand{\diagalpha}{\underline{\underline{\alpha}}}
\newcommand{\diagalpha}{\underline{\underline{\boldsymbol \alpha}}}
%\newcommand{\diagbeta}{\underline{\underline{\beta}}}
\newcommand{\diagbeta}{\underline{\underline{\boldsymbol \beta}}}
\newcommand{\diag}{\mbox{diag}}
%\newcommand{\vecu}{\underline{u}}
\newcommand{\vecu}{\mathbf u}
\newcommand{\vecz}{\mathbf z}
%\newcommand{\vecB}{\underline{B}}
\newcommand{\vecB}{\mathbf b}
%\newcommand{\vecx}{\underline{x}}
\newcommand{\vecx}{\mathbf x}
%\newcommand{\vecxi}{\underline{\xi}}
\newcommand{\vecxi}{\boldsymbol \xi}
\newcommand{\vecy}{\mathbf y}
%\newcommand{\vecf}{\underline{f}}
\newcommand{\vecf}{\mathbf f}
%\newcommand{\vecL}{\underline{L}}
\newcommand{\vecL}{\mathbf L}
\newcommand{\vecN}{\mathbf N}
\newcommand{\opL}[2]{\underline{\cal L}\left(#1,#2\right)}
\newcommand{\vecphi}{\boldsymbol{\Phi}}
%\newcommand{\vecv}{\underline{v}}
\newcommand{\vecv}{\mathbf v}
\newcommand{\vech}{\mathbf h}
\newcommand{\vecb}{\mathbf b}
%\newcommand{\vecp}{\underline{p}}
\newcommand{\vecp}{\mathbf p}
\newcommand{\vecn}{\mathbf n}
\newcommand{\vecq}{\mathbf q}
\newcommand{\vecc}{\mathbf c}
%\newcommand{\vece}{\underline{e}}
\newcommand{\vece}{\mathbf e}
\newcommand{\vecd}{\mathbf d}
\newcommand{\vecE}{\mathbf E}
\newcommand{\vecrho}{\boldsymbol{\rho}}
\newcommand{\vecw}{\mathbf w}
%\newcommand{\vecg}{\underline{g}}
\newcommand{\vecg}{\mathbf g}
\newcommand{\veck}{\mathbf k}
%\newcommand{\vect}{\underline{t}}
\newcommand{\vect}{\mathbf t}
\newcommand{\vecr}{\mathbf r}
\newcommand{\vecT}{\underline{T}}
%\newcommand{\vecalpha}{\underline{\alpha}}
\newcommand{\vecalpha}{\boldsymbol \alpha}
%\newcommand{\vecbeta}{\underline{\beta}}
\newcommand{\vecbeta}{\boldsymbol \beta}
\newcommand{\vecs}{\mathbf s}
%\newcommand{\1}{\underline{1}}
\newcommand{\1}{\mathbf 1}
%\newcommand{\0}{\underline{0}}
\newcommand{\0}{\mathbf 0}
%\newcommand{\nullMat}{\underline{\underline{0}}}
\newcommand{\nullMat}{\mathbf 0}
\newcommand{\meanv}{\bar{v}}
\newcommand{\meanrho}{\bar{\rho}}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{definition}{Definition}

\begin{document}

\begin{center}{\large On the Stability of IMEX Upwind gSBP Schemes for Linear Advection-Diffusion Equations} \\[.5cm]


{\small Sigrun~Ortleb}

{\footnotesize Department of Mathematics and Natural Sciences, University of Kassel, Germany,  ortleb@mathematik.uni-kassel.de}
\end{center}

{\sl Abstract: }
%150-250 words
%
A fully discrete energy stability analysis is carried out for linear advection-diffusion problems discretized by generalized upwind summation-by-parts~(upwind gSBP) schemes in space and implicit-explicit Runge-Kutta~(IMEX-RK) schemes in time. Hereby, advection terms are discretized explicitly while diffusion terms are solved implicitly. In this context, specific combinations of space and time discretizations enjoy enhanced stability properties. In fact, if the first and second-derivative upwind gSBP operators fulfill a compatibility condition, the allowable time step size is independent of grid refinement, although the advective terms are discretized explicitly. 
In one space dimension it is shown that upwind gSBP schemes represent a general framework including standard discontinuous Galerkin~(DG) schemes on a global level.
While previous work for DG schemes has demonstrated that the combination of upwind advection fluxes and the central-type first Bassi-Rebay~(BR1) scheme for diffusion does not allow for grid-independent stable time steps, the current work shows that central advection fluxes are compatible with BR1 regarding enhanced stability of IMEX time stepping. Furthermore, unlike previous discrete energy stability investigations for DG schemes, the present analysis is based on the discrete energy provided by the corresponding SBP norm matrix and yields time step restrictions independent of the discretization order in space since no finite-element-type inverse constants are involved. Numerical experiments are provided confirming these theoretical findings.

\section{Introduction}

Advection-diffusion problems describe a wide range of phenomena arising due to the combination of two different physical processes, i.e. advective transport of a quantity due to a given velocity field and movement of particles from areas of higher to lower concentration. For instance, advection-diffusion equations arise as a model for the time evolution of chemical or biological species in a flowing medium. If the resulting partial differential equations are discretized on refined spatial grids, the presence of diffusion fluxes usually generates increasingly stiff problems. Particularly, explicit time discretization of semi-discrete advection-diffusion problems often results in an increasingly severe grid-dependent time step restriction since the time step~$\Delta t$ scales with the grid length scale~$\Delta x$ as $\Delta t = {\cal O}(\Delta x^2)$. However, purely implicit time discretization requires the solution of large nonlinear systems of equations. Therefore, hybrid time integration schemes such as implicit-explicit (IMEX) methods have frequently been considered. Hereby, a common approach is to discretize the advective terms explicitly while the diffusion terms are treated implicitly, see e.g. \cite{AscherRuuthWetton:95,Verwer_etal:96,AscherRuuthSpiteri:97,Calvo:01}. The additional complexity of a partially implicit treatment is justified by the observation that even though many applications contain nonlinear advection terms, the diffusion terms are often linear, only demanding the iterative solution of linear algebraic systems which are positive definite, symmetric and sparse. In addition, the nonlinear systems resulting from potentially nonlinear diffusion terms are generally more efficient to solve than those arising from nonlinear advection terms.

While this approach alleviates the extremely restrictive time step scaling for the diffusion terms, it does not a priori dispose of the classical CFL-type time step restriction of the form $\Delta t = {\cal O}(\Delta x)$ due to the explicit time discretization of the advection terms. 
However, for specific combinations of space and time discretizations, enhanced stability properties may be achieved.
For instance, Calvo et al.~\cite{Calvo:01} designed specific IMEX-RK methods which guarantee grid-independent time step restrictions of the form $\Delta t = {\cal O}(c/a^2)$ for Fourier spatial discretizations, where $a$ and $c$ denote the advection and diffusion coefficients, respectively. Wang et al.~\cite{Wang_etal:15} prove a similar unconditional $L^2$-stability result in the context of spatial discretization by the discontinuous Galerkin~(DG)~\cite{coshu:01}  method applied to linear advection-diffusion equations, with an extension to nonlinear problems in~\cite{Wang_etal:16} and to the multi-dimensional case in~\cite{Wang_etal_mD:16}. Hereby, diffusion terms are discretized by the local discontinuous Galerkin~(LDG) scheme~\cite{CockburnShu_LDG:98}. In~\cite{ortleb:20}, an extension is provided for DG methods in one space dimension incorporating a larger class of diffusion schemes, namely the $(\sigma,\mu)$ family~\cite{vanLeer_Nomura:05, vanLeer_etal:2010} of diffusion discretizations which also includes the Bassi-Rebay schemes~\cite{BassiRebay:97,BassiRebay:2000b}. Furthermore, Fu and Shu~\cite{FuShu:17} prove grid-independent $L^2$-stability for the discretization of the diffusion terms by the embedded discontinuous Galerkin method and in~\cite{WangZhang:22}, the direct discontinuous Galerkin method is considered.
A related approach which provides unconditional stability even if part of the problem is discretized explicitly is taken in \cite{Rosales_etal:2017, Seibold_etal:2019} designing unconditionally stable IMEX linear multistep schemes where both the IMEX splitting and the employed multistep schemes fulfill specific properties.

In this work, upwind generalized summation-by-parts~(upwind gSBP) space discretizations for advection-diffusion problems will be considered with respect to the combination with IMEX time integration and regarding stable time step choices. These upwind gSBP schemes do not necessarily provide a replacement for the DG space discretization, but rather a broader framework. 

This general framework of summation-by-parts~(SBP) schemes provides structure-preserving spatial discretizations also including DG type methods. SBP operators fulfill a mimetic property, in particular mimicking the analytical concept of integration-by-parts. Originally, discrete derivative operators with an SBP property have been introduced for finite difference schemes for various types of PDEs including advection-diffusion equations and the linearized compressible Navier-Stokes equations, see \cite{Kreiss_Scherer:74,Strand:94,Carpenter_etal:94,Nordstroem_etal:09,Svaerd_Nordstroem:2014,DelReyFern_etal_REVIEW}. Extensions of the SBP methodology have been provided for tensor-product grids on curvilinear elements \cite{doi:10.1007/s10915-019-01011-3} as well as for the general multidimensional case \cite{doi:10.1137/15M1038360} including simplex elements. Via $L^2$ energy estimates, the spatial SBP operators automatically yield stable semi-discrete schemes for periodic solutions of a broad class of linear equations. In addition, they have substantially profited from a combination with weakly enforced boundary conditions, most prominently by using simultaneous approximation terms (SATs) which were first developed in \cite{Carpenter_etal:94}.
%
More recent investigations also focus on SBP operators within various popular classes of numerical schemes, e.g. finite volume schemes on unstructured dual grids~\cite{Nordstroem_FV:2003}, discontinuous Galerkin(DG) schemes with Legendre-Gauss-Lobatto nodes~\cite{Gassner:13}, DG schemes on Legendre-Gauss nodes both in one space dimension and on tensor-product grids~\cite{Ortleb:17}, and flux-reconstruction schemes~\cite{Ranocha_etal:2016}. In fact, the definition in~\cite{DelReyFern_etal:14} allows to derive generalized SBP~(gSBP) properties for nodal DG schemes in one space dimension on arbitrary nodal sets, as long as their corresponding quadrature rule is sufficiently exact in order to mimic integration-by-parts at the discrete level.
%
An extension of the SBP framework departing from their central character was originally proposed by Mattsson in~\cite{Mattsson:2017:upwindSBP}, where upwind SBP schemes of finite difference type were constructed. These schemes consist of dual-pair SBP operators with non-central difference stencils. The incorporated upwind differencing leads to a built-in artificial dissipation in the semi-discrete energy analysis of periodic problems and has been used to construct upwind SBP schemes based on flux splitting for the shallow water equations in~\cite{LUNDGREN2020109784} and for general scalar hyperbolic conservation laws in~\cite{Stiernstroem:2021}.

Connections between nodal DG schemes and SBP methods have mainly fostered the discretization of conservation laws in skew-symmetric form to preserve secondary quantities and to move towards semi-discrete energy or entropy stability results. 
In this context, the SBP properties of \emph{cell-wise} DG discretizations at the local level of one element represent the key aspect. In this work, emphasis is put on the \emph{global} formulation of DG schemes in one space dimension which may be regarded as upwind gSBP schemes for a family of numerical flux functions ranging from upwind to central ones. In addition, we will take advantage of the connection to upwind gSBP schemes in order to improve the fully discrete stability estimates pertaining to DG and upwind gSBP schemes combined with IMEX time integration.

While discretizing advection terms with a DG scheme is straightforward, various approaches to discretize diffusion terms have been introduced in the literature since the discretization of higher order spatial derivatives is less natural. Either specially designed penalty terms are introduced as in \cite{Arnold:82,BaumannOden:99} or the advection-diffusion equation is rewritten into a system of first order equations using auxillary variables for the solution derivatives as in \cite{BassiRebay:97,CockburnShu_LDG:98,BassiRebay:2000b,Arnold_etal:02}.
The first method by Bassi and Rebay \cite{BassiRebay:97}, termed the BR1 scheme, has actually been the first extension of the DG scheme to the compressible Navier-Stokes equations. It is based on rewriting the viscous terms into a larger, extended first-order degenerate system of PDEs with the gradient as a new unknown. After this reformulation, the standard DG approach is applied to the extended system which necessitates to prescribe two types of numerical fluxes. Hereby, the BR1 scheme is the simplest approach, using arithmetic means for both types of fluxes. Cockburn and Shu \cite{CockburnShu_LDG:98} analyzed various methods based on the reformulation into a first-order PDE and derived conditions on the numerical fluxes to guarantee stability, convergence and a suboptimal error estimate of order $N$ when using an approximation space of polynomial degree $N$. The analysis shows sub-optimal convergence of the BR1 scheme for odd $N$ while the choice of alternating numerical fluxes usually associated with the LDG scheme by Cockburn and Shu \cite{CockburnShu_LDG:98} lead to optimal convergence of order $N+1$.
Being simple to code, parameter-free, and generic for nonlinear viscous fluxes and arbitrary grids, the BR1 scheme is still very popular and satisfies certain structural properties. In fact, in \cite{Gassner2018}, the neutral behaviour of BR1 with respect to artificial dissipation over element interfaces and the resulting stability for the compressible Navier-Stokes equations has been proven.

The energy stability analysis in \cite{ortleb:20} for linear advection-diffusion problems discretized by the DG scheme in space using a $(\sigma, \mu)$ diffusion discretization has shown that the simple BR1 approach coupled with upwind fluxes for advection does not inherit the enhanced stability properties in the case of IMEX time integration. In this regard, this current work provides a remedy since the DG scheme based on BR1 fluxes may be regarded as a specific second-derivative upwind gSBP scheme compatible with central fluxes for advection.
Furthermore, unlike previous discrete energy stability investigations for DG schemes, the present analysis is based on the discrete energy provided by the corresponding SBP norm matrix and yields time step restrictions independent of the discretization order in space since no FE type inverse constants are involved. 

This paper is organized as follows. Sect.~\ref{sec:DG} introduces the properties of first- and second-derivative upwind gSBP operators and reviews their connection to DG schemes on the global level. Furthermore, some properties and estimates required for the fully discrete stability analysis are provided.
In Sect.~\ref{sec:IMEX}, an energy stability analysis based on the discrete energy defined by the associated upwind gSBP norm matrix is carried out for first and second order IMEX-RK time integrators combined with upwind gSBP schemes of arbitrary order in space.
Numerical results verifying the conducted theoretical analysis are presented in Sect.~\ref{sec:numresults}. Finally, Sect.~\ref{sec:conclusion} contains a conclusion and an outlook on future work.

\section{Discontinuous space discretization of the linear advection-diffusion equation} \label{sec:DG}

Throughout this work, we consider the linear advection-diffusion equation
\begin{align}\label{eq:advdiff}
  u_t + au_x = cu_{xx},\qquad (x,t) \in (x_a,x_b)\times (0,T),
\end{align}
with advective velocity $a>0$ and diffusion coefficient $c>0$, supplemented by the periodic initial condition $u(x,0) = u_0(x)$ in $L^2(\Omega)$ and periodic boundary conditions.

For space discretization, the spatial domain $\Omega=(x_a,x_b)$ is partitioned into cells $I_i = (x_i,x_{i+1})$, $i=1,\ldots,K$ with $x_1=x_a,\ x_{K+1}=x_b$. We consider quasi-uniform grids with cell lengths $\Delta x_i = x_{i+1}-x_i$ satisfying $\frac{\Delta x_i}{\Delta x} \ge \rho\in\R^+$ for $\Delta x = \max_i\Delta x_i$ under grid refinement $\Delta x\rightarrow 0$. 
On the reference interval $[-1,1]$, a nodal set of solution points is specified and transferred to each grid cell, not necessarily including the cell boundaries in the nodal set. Furthermore, the discontinuities space discretization allows for a discontinuous representation of the semi-discrete solution at cell interfaces. %In particular, if Legendre-Gauss-Lobatto nodes are chosen on the reference interval, two solution points coincide on each interface carrying two different interface values.


\subsection{Discontinuous Galerkin~(DG) formulation}

DG schemes allow for piece-wise smooth approximate solutions with potential discontinuities across element interfaces.  Due to its flexibility and generality, the DG scheme is a popular numerical method in a variety of applications. The main advantages are its local conservation property, an arbitrarily high order of accuracy and superconvergence capabilities. Dispensing with global continuity of the approximate solution, the DG approach results in relatively compact stencils which greatly facilitates both hp-adaptivity of the method and its implementation in parallel hardware environment.
The DG scheme is built upon a variational formulation of the advection-diffusion equation. The basis functions and test functions used to define the DG scheme in one space dimension are taken from the finite element space
  $V_h = \{v\in L^2(\Omega)\ |\ v|_{I_i}\in {\cal P}_N(I_i)\, \forall i=1,\ldots,K\}$,
for the spatial domain $\Omega = (x_a,x_b)=\bigcup_{i=1}^KI_i$, where ${\cal P}_N(I_i)$ denotes the space of polynomial functions on $I_i$ of degree at most $N$. As usual in DG schemes, the functions in $V_h$ may be discontinuous across element boundaries. 

For the discretization of diffusion terms, the PDE~\eqref{eq:advdiff} will be reformulated as a first order system of equations. Thus, the structure of the corresponding DG scheme is similar to the case of purely hyperbolic problems.   
 The DG formulation for the linear diffusion equation will then be given in Sect.~\ref{sec:rewritingLDG_BR1}. 
In order to formulate the DG scheme in matrix-vector notation similar to SBP schemes, it is sufficient to consider a scalar hyperbolic conservation law in one space dimension given by
\begin{eqnarray}\label{eq:cons_law_1d}
  \frac{\partial}{\partial t}u(x, t) + \frac{\partial}{\partial x}f( u(x, t)) = 0, \quad (x,t) \in (x_a, x_b)\times (0,T).
  \end{eqnarray}

  
The DG scheme constructs an
approximation $u_h$ of $u$ which is piece-wise continuous of the form
\begin{eqnarray}\label{eq:uh_expand}
  u_h(x,t)|_{I_i} = u_h^i(x,t) = \displaystyle{\sum_{j=1}^{N+1}u_j^i(t)L_j^i(x)}
  \end{eqnarray}
using polynomial basis functions $L_j^i\in {\cal P}^N\left([x_i, x_{i+1}]\right)$. Here, nodal DG schemes are considered, where the basis functions are the Lagrange polynomials corresponding to a set of solution points $\xi_\nu\in[-1,1],\ \nu=1,\ldots, N+1$ which are the nodes $\xi_k$ of a suitable quadrature rule on the reference cell $[-1,1]$. We assume that the quadrature rule is symmetric and exact for polynomials of degree $2N-1$ and denote the corresponding weights by $\omega_\nu$, $\nu=1,\ldots, N+1$. More precisely, we consider the Lagrange polynomials defined by
 $L_j^i(\Lambda_i(\xi_\nu))=\delta_{\nu j}$, where $\delta_{\nu j}$ denotes the Kronecker delta and $\Lambda_i$ transforms the reference cell $[-1,1]$ to the specific sub-interval $I_i$, i.e.
$\Lambda_i(\xi) = \xi\frac{x_{i+1}-x_i}{2}+\frac{x_i+x_{i+1}}{2}$.

The DG scheme in weak form, obtained by multiplying  \eqref{eq:cons_law_1d} by a test function $L_k^i$, integrating in space over a cell $I_i$ and applying partial integration, is given by
\begin{eqnarray}\label{eq:DGweak_quadrature}
  \frac{d}{d t}\int_{I_i} u_h L_k^i dx +  f_{i}^\ast L_k^i(x_{i}) - f_{i+1}^\ast L_k^i(x_{i+1}) - \int_{I_i}f_h\frac{d L_k^i}{d x} dx = 0,
\end{eqnarray}
with $f_{i}^\ast = f^\ast\left(u_h^{i-1}(x_i,t),u_h^i(x_i,t)\right)$ denoting the values of a consistent numerical flux function $f^\ast$ evaluated at the left and right-hand side limits of $u_h$ at the cell boundaries $x_i$ and the flux polynomial $f_h(x,t)|_{I_i}=\sum_{j=1}^{N+1}f(u_j^i)L_j^i(x)$, based on the point-wise values $u_j^i = u_h\left(\Lambda_i(\xi_j),t\right)$.

The integrals in \eqref{eq:DGweak_quadrature}, are then solved numerically by the chosen quadrature rule which exactly evaluates the last integral due to the degree of exactness.

The DG scheme in strong from is obtained by a second partial integration of~\eqref{eq:DGweak_quadrature} resulting in the variational formulation
\begin{eqnarray}\label{eq:DGstrong}
 \frac{d}{d t} \int_{I_i}  u_h L_k^i dx + \int_{I_i}\frac{\partial f_h}{\partial x} L_k^i dx
    = & [f_{i}^\ast-f_h^i(x_{i})]L_k^i(x_{i}) - [f_{i+1}^\ast-f_h^i(x_{i+1})]L_k^i(x_{i+1}).
  \end{eqnarray}
Using matrix-vector notation as shown e.g. in~\cite{allaneau_jameson_esfr:11,Ortleb:17}, equation~\eqref{eq:DGstrong} rewrites in a simpler form when transformed to the reference cell $[-1,1]$. For this purpose, we define the matrices $\widehat{\matrixM}$ and $\widehat{\matrixS}$ by 
\begin{align*}
  \widehat{M}_{jk} &= \sum_l\omega_l L_j(\xi_l)L_k(\xi_l)=\omega_j\delta_{jk} = \widehat{M}_{kj} \approx \int_{-1}^1L_jL_kd\xi,\\
  \widehat{S}_{jk} &= \sum_l\omega_l L_j(\xi_l)L'_k(\xi_l) = \int_{-1}^1L_jL_k'd\xi,
\end{align*}
where $L_k:[-1,1]\rightarrow\R$ are the Lagrange polynomials corresponding to the quadrature nodes $\xi_k$. Using the solution vector $\vecu^i$ and the vector of flux values $\vecf^i$, 
\begin{eqnarray*}
\vecu^i & = & (u_1^i,\ldots, u_{N+1}^i)^T \ \mbox{with}\ u_j^i = u_h\left(\Lambda_i(\xi_j),t\right), \\
\vecf^i & = &  (f_1^i,\ldots, f_{N+1}^i)^T\ \mbox{with}\  f_j^i = f(u_j^i),
\end{eqnarray*}
as well as the transformation of $f_h(x,t)|_{I_i}$ to the reference cell by $f_h^i(\xi,t)=\sum_{j=1}^{N+1}f(u_j^i)L_j(\xi)$, the abbreviations $f^{\ast,i}(1) = f_{i+1}^\ast$ and $f^{\ast,i}(-1) = f_{i}^\ast$ and the collection of the basis functions in the vector valued function
  $\vecL(\xi) = (L_1(\xi),\ldots, L_{N+1}(\xi))^T$,
equation~\eqref{eq:DGstrong} is equivalent to the matrix-vector formulation
\[\frac{\Delta x_i}{2}\,\widehat{\matrixM}\frac{d\vecu^i}{dt} + \widehat{\matrixS}\,\vecf^i = [(f_h^i-f^{\ast,i})\vecL]_{-1}^{1},\]
see~\cite{allaneau_jameson_esfr:11,Ortleb:17}.
By definition, the matrix $\widehat{\matrixM}$ is invertible. Multiplying by the inverse of $\widehat{\matrixM}$, we obtain the final matrix-vector formulation of the DG scheme
\begin{eqnarray}\label{eq:DGwithi}
  \frac{\Delta x_i}{2}\,\frac{d\vecu^i}{dt} + \widehat{\matrixD}\,\vecf^i = \widehat{\matrixM}^{-1}[(f_h^i-f^{\ast,i})\vecL]_{-1}^{1}.
  \end{eqnarray}
where the entries of $\widehat{\matrixD}=\widehat{\matrixM}^{-1}\widehat{\matrixS}$ are given by $\widehat{D}_{jk} = L_k'(\xi_j)$.

\begin{remark} It is worth to note that the matrix $\widehat{\matrixD}$ provides a local first-derivative gSBP operator on a specific DG cell, see e.g.~\cite{Ortleb:17}, but outsources the interface fluxes to be dealt with similarly to the weak boundary treatment of SATs. In contrast, the next section investigates the upwind gSBP structure of the global DG scheme including the presence of numerical fluxes on cell interfaces.
\end{remark}


\subsection{Upwind gSBP space discretization}

Upwind SBP schemes, first derived in~\cite{Mattsson:2017:upwindSBP}, are a class of finite difference methods which combine the structure-preserving properties of summation-by-parts~(SBP) derivative operators with artificial dissipation by choosing upwind directions. These schemes consist of dual-pair SBP operators with non-central difference stencils which lead to a built-in artificial dissipation when combined with flux splitting. While traditionally, SBP schemes were set up on equidistant grid points, we will consider
generalized versions in this work on non-uniform nodal sets not necessarily containing boundary points which have been termed generalized summation-by-parts~(gSBP) schemes. These schemes may be further modified by including upwind stencils, resulting in upwind gSBP schemes which will be considered in this work.
The common goal of schemes within the SBP framework is to transfer continuous energy estimates to the semi-discrete level.
For instance, considering solutions $u(x,t)$ of the linear advection equation
\begin{align}\label{eq:advection}
 u_t+a u_x = 0,\ a>0, \quad (x,t) \in (\alpha, \beta)\times (0,T)
\end{align}
subject to the homogeneous boundary conditon $u(x_a,t)=0$, the continuous energy estimate
\begin{align}\label{eq:adv_energy_continuous}
\frac{d}{d t}\|u(x,t)\|_{L^2(\alpha,\beta)}^2 + a u^2(\beta,t) = 0
\end{align}
can be proven. By the SBP property, this estimate may be transferred to the spatial discretization. The corresponding operators approximate the first derivative $\frac{\partial}{\partial x}$ in~\eqref{eq:advection} and are based on a set of grid points $\{x_i\}_{1\le i\le M}\subset[\alpha,\beta]$ called nodal set. On this nodal set, approximate solutions of \eqref{eq:advection} are given by time-dependent solution vectors 
$$\vecu(t) = (u_1(t),\ldots,u_M(t))^T\approx (u(x_1,t),\ldots,u(x_M,t))^T\,,$$
and $u_x$ in~\eqref{eq:advection} is replaced by the term $\matrixD^-\vecu$, utilizing an upwind gSBP operator $\matrixD^-$ as defined below.

\begin{definition}\label{def:upwindSBP}
A pair of difference operators denoted by $\matrixD^+$ and $\matrixD^-$, both approximating the first derivative $\frac{\partial}{\partial x}$ on an interval $(\alpha,\beta)$, are called \emph{upwind gSBP operators of degree $q$} if
\begin{enumerate}
\item The matrices $\matrixD^+$ and $\matrixD^-$ provide accurate approximations to $\frac{\partial}{\partial x}$ of degree $q$, i.e.
$$\matrixD^\pm \vecx^k = k\vecx^{k-1},\quad 0\le k\le q\,,$$
where $\vecx^k = (x^k_1,\ldots,x^k_M)^T$ is the representation of the monomials $x^k$ on the grid points.
\item A positive definite symmetric \emph{norm matrix} $\matrixM$ exists, such that
\begin{align}\label{eq:SBPdef_upwind}
\matrixD^-=\matrixM^{-1}\left(\matrixQ^- + \frac{1}{2}\,\matrixB\right) \ \mbox{and}\ \matrixD^+=\matrixM^{-1}\left(\matrixQ^+ + \frac{1}{2}\,\matrixB\right) \,,
\end{align}
where $\matrixB$ is a boundary operator of the form
$\matrixB = \vect_{\beta}\,\vect_{\beta}^T-\vect_\alpha\,\vect_\alpha^T$,
 with boundary interpolation provided by $\vect_\alpha^T\,\vecx^l = \alpha^l$ and $\vect_\beta^T\,\vecx^l = \beta^l$ for $0\le l\le r$ with $r\ge q$.
\item Integration by parts is mimicked by the property
\begin{align}\label{eq:SBPprop_upwind_1}
\matrixQ^+ + \left(\matrixQ^-\right)^T = \nullMat\,.
\end{align}
\item As an additional stability constraint, the symmetric matrix
\begin{align}\label{eq:SBPprop_upwind_2}
\matrixC:=\frac{1}{2} \left(\matrixQ^+ - \matrixQ^-\right) = \frac{1}{2} \left(\matrixQ^+ + \left(\matrixQ^+\right)^T\right) = -\frac{1}{2} \left(\matrixQ^- + \left(\matrixQ^-\right)^T\right)
\end{align}
is negative semi-definite.
\end{enumerate}
\end{definition}

\begin{remark}
Some remarks on the modifications with respect to classical SBP operators and on naming conventions are in order. 
\begin{enumerate}
\item Due to the generalization provided by gSBP schemes beyond the traditional case of equidistant grid points including the boundary points $\alpha$ and $\beta$, the boundary operators of gSBP schemes extend the traditional boundary operator $\matrixB = {\mathrm{diag}}(-1,0,\ldots,0,1)$ to the given nodal set.
\item In the case 
$\matrixC=\nullMat$, we have $\matrixD^-=\matrixD^+$ which is denoted a classical gSBP operator since it does not feature any upwind directions.
\item Upwind gSBP operators based on diagonal norm matrices $\matrixM$ are denoted diagonal-norm upwind SBP operators. %In this work, only diagonal norm upwind gSBP operators are considered.
\end{enumerate}
\end{remark}

The motivation for using upwind gSBP operators is the additional artificial damping introduced by enforcing negative semi-definiteness of the matrix $\matrixC$ in~\eqref{eq:SBPprop_upwind_2}. We will illustrate this property of an upwind gSBP scheme in comparison to classical gSBP schemes in the following example.

Considering the spatial discretization of the linear advection equation~\eqref{eq:advection}
via an upwind gSBP scheme, we use the operator $\matrixD^-$, whereas for $a<0$, the operator $\matrixD^+$ would be applied. We obtain
\begin{align}\label{eq:upwindSBP}
\frac{d\vecu}{dt} + a\matrixD^-\,\vecu = \sigma\matrixM^{-1}\vect_\alpha\vect_\alpha^T\vecu\,,
\end{align}
where the right-hand side of the above equation contains the required simultaneaous-approximation-term~(SAT), dealing with the boundary condition at the left boundary. 

Multiplying~\eqref{eq:upwindSBP} from the left by $\vecu^T\matrixM$ and adding the transpose now yields
\begin{align}\label{eq:SBPlinadv_upwind}
2\vecu^T\matrixM\frac{d\vecu}{dt} + a\vecu^T\left(\matrixM\,\matrixD^- + \left(\matrixD^-\right)^T\matrixM\right)\vecu = 2\sigma u_\alpha^2,\qquad u_\alpha=\vect_\alpha^T\vecu\,.
\end{align}

Using the upwind gSBP properties~\eqref{eq:SBPprop_upwind_1} and~\eqref{eq:SBPprop_upwind_2}, we have
$$ \matrixM\,\matrixD^- + \left(\matrixD^-\right)^T\matrixM =  \matrixQ^-+\left(\matrixQ^-\right)^T + \matrixB = -2\matrixC + \matrixB,,$$
 and therefore, setting $u_\beta = \vect_\beta^T\vecu$,
$$\frac{d}{dt}\|\vecu\|_{\matrixM}^2 + a(u_\beta^2-u_\alpha^2) = 2\sigma u_\alpha^2 + 2\vecu^T\matrixC\,\vecu\,.$$
For $\sigma\le -\frac{a}{2}$, the time evolution of the discrete energy may now be estimated by
\begin{align}\label{eq:adv_energy_discrete_upwindSBP}
\frac{d}{dt}\|\vecu\|_{\matrixM}^2 + a u_\beta^2 \le 2\vecu^T\matrixC\,\vecu\le 0\,,
\end{align}
where the term containing the negative semi-definite matrix $\matrixC$ introduces additional artificial dissipation compared to the continuous estimate~\eqref{eq:adv_energy_continuous}, and this additional dissipation vanishes for classical gSBP operators without upwind character since $\matrixC=\nullMat$ in this case.

The upwind gSBP framework also enables the construction of second-derivative operators of the form
\begin{align}
\begin{split}\label{eq:upwindSBP_second}
\matrixD_2^- &= \matrixD^+\matrixD^- = \matrixM^{-1}(-\left(\matrixD^-\right)^T\matrixM\matrixD^- + \matrixB\matrixD^-)\,,\\
\matrixD_2^+ &= \matrixD^-\matrixD^+ = \matrixM^{-1}(-\left(\matrixD^+\right)^T\matrixM\matrixD^+ + \matrixB\matrixD^+)\,,
\end{split}
\end{align}
which approximate the second derivative $\frac{\partial^2}{\partial x^2}$.


\subsubsection{Global DG discretization of advective terms in upwind SBP framework}\label{sec:DG_upwindSBP}

While the element-wise DG discretization of the linear advection equation results in a classical gSBP scheme on each grid cell, the corresponding global DG formulation over all grid cells results in its upwind variant. The classical SBP properties of element-wise 1D-DG schemes on general nodal sets are by now well-known, see e.g.~\cite{Gassner:13,DelReyFern_etal_REVIEW,Ranocha_etal:2016,Ortleb:17}. In fact, the cell-wise formulation~\eqref{eq:DGwithi} represents a gSBP scheme with first-derivative gSBP operator $\widehat{\matrixD}=\widehat{\matrixM}^{-1}\matrixS$ which approximates the continuous derivative $\frac{\partial}{\partial \xi}$ to degree $q=N$ and the degree of $\matrixB$ is $r=q=N$, see~\cite[Lemma 1]{Ortleb:17}.
  
The boundary operator $\matrixB$ is given by $\matrixB = [\vecL\,\vecL^T]^1_{-1}$, hence, for a single cell $[x_i,x_{i+1}]$, we set $\alpha=x_i,\beta=x_{i+1}$ and obtain $\vect_\alpha = \vecL(-1)$ and $\vect_\beta = \vecL(1)$.

Next, we consider the global DG formulation over all grid cells.
According to equation~\eqref{eq:DGwithi},  on interior cells $I_i,\ i=2,\ldots, K-1$, the cell-wise DG scheme in matrix-vector formulation applied to the linear advection equation~\eqref{eq:advection}, with positive advection velocity $a>0$, is given by 
\begin{eqnarray}\label{eq:DG_advection_withi}
  \frac{\Delta x_i}{2}\,\frac{d\vecu^i}{dt} + a\widehat{\matrixD}\,\vecu^i = \widehat{\matrixM}^{-1}[\left(au_h^i-(au)^{\ast,i}\right)\vecL]_{-1}^{1}\,, \quad i=2,\ldots, K-1
  \end{eqnarray}
 Hereby, a suitable numerical flux function $(au)^{\ast,i}$ is employed, where $(au)^{\ast,i}(-1) =  (au)^{\ast}_{i}$ and  $(au)^{\ast,i}(1) = (au)^{\ast}_{i+1}$ with
\begin{eqnarray}\label{eq:adv_numflux}
(au)^{\ast}_{i} = a\left(\frac{1}{2}+\theta\right)u_h^{i-1}(1) +  a\left(\frac{1}{2}-\theta\right)u_h^{i}(-1)\,,\quad \theta\in\left[0,\frac{1}{2}\right]\,. 
  \end{eqnarray}
Therefore, the choice of numerical flux functions ranges between the central flux for $\theta = 0$ and the upwind flux for $\theta = \frac{1}{2}$.
Using SAT boundary treatment with SAT parameter $\sigma$, the scheme on the left boundary cell is given by
\begin{eqnarray}\label{eq:DG_advection_lb}
\frac{\Delta x_1}{2}\,\frac{d\vecu^1}{dt} + a\widehat{\matrixD}\,\vecu^1 = \widehat{\matrixM}^{-1}\left(au_h^1(1)-(au)^{\ast}_{2}\right)\vecL(1) + \sigma\widehat{\matrixM}^{-1}\vecL(-1)\vecL(-1)^T\vecu^1\,.
\end{eqnarray}
while on the rightmost DG cell with outgoing information through the right boundary, we have
\begin{eqnarray}\label{eq:DG_advection_rb}
\frac{\Delta x_K}{2}\,\frac{d\vecu^K}{dt} + a\widehat{\matrixD}\,\vecu^K = -\widehat{\matrixM}^{-1}\left(au_h^K(-1)-(au)^{\ast}_{K}\right)\vecL(-1)\,.
\end{eqnarray}

We now rewrite the global DG discretization on the computational domain $\Omega$ as an upwind gSBP scheme which includes the interactions of degrees of freedom on adjacent cells. Under this assumption, we may rewrite Eq.~\eqref{eq:DG_advection_withi} as
\begin{eqnarray}\label{eq:DG_advection_global}
  \frac{d\vecu}{dt} + a\matrixD^-\,\vecu = \underline{\mbox{SAT}}\,,
  \end{eqnarray}
with the global nodal DG solution vector given by $\vecu = (\vecu^1,\ldots, \vecu^K)^T$ and the extended SATs $\underline{\mbox{SAT}} = \left(\underline{\mbox{SAT}}_1^T, 0, \ldots, 0\right)^T$, where $\underline{\mbox{SAT}}_1 = \frac{2\sigma}{\Delta x_1}\widehat{\matrixM}^{-1}\vecL(-1)\vecL(-1)^T\vecu^1$.

Now, the global DG derivative operator $\matrixD^-$ is a block tridiagonal matrix with blocks corresponding to each DG element and its left and right adjacent cells.
More precisely, we have
\begin{prop}\label{lem:D_glob}
The global DG derivative operator $\matrixD^-=\matrixD^-(\theta)$ in~\eqref{eq:DG_advection_global} is of the block tridiagonal form
$$
\matrixD\,^{-}(\theta)
=\left(\begin{array}{cccc}\frac{2}{\Delta x_1} &&&\\& \frac{2}{\Delta x_2}&&\\&&\ddots&\\&&& \frac{2}{\Delta x_K}\end{array}\right)
\left(\begin{array}{ccccc}
  \matrixA\,_{lb}(\theta) & \matrixA\,_{12}(\theta) & &&\\[.0cm]
  \matrixA\,_{21}(\theta) & \matrixA\,_{11}(\theta) & \matrixA\,_{12}(\theta) &&  \\[.0cm]
&  \ddots & \ddots & \ddots&\\[.0cm]
&& \matrixA\,_{21}(\theta) & \matrixA\,_{11}(\theta) & \matrixA\,_{12}(\theta)\\[.0cm]
  &&& \matrixA\,_{21}(\theta) & \matrixA\,_{rb}(\theta)\end{array}\right)\,,$$
 where the repeating blocks corresponding to interior cells and the left and right boundary block are given by
\begin{eqnarray*}
\matrixA\,_{11}(\theta) & = & \widehat{\matrixD} - \left(\frac{1}{2}-\theta\right)\widehat{\matrixM}^{-1}\vecL(1)\vecL(1)^T + \left(\frac{1}{2}+\theta\right)\widehat{\matrixM}^{-1}\vecL(-1)\vecL(-1)^T\,,\\
\matrixA\,_{12}(\theta) & = & \left(\frac{1}{2}-\theta\right)\widehat{\matrixM}^{-1}\vecL(1)\vecL(-1)^T\,, \\
\matrixA\,_{21}(\theta) & = & -\left(\frac{1}{2}+\theta\right)\widehat{\matrixM}^{-1}\vecL(-1)\vecL(1)^T\,,\\
\matrixA\,_{lb}(\theta) & = & \widehat{\matrixD} - \left(\frac{1}{2}-\theta\right)\widehat{\matrixM}^{-1}\vecL(1)\vecL(1)^T\,,\\
\matrixA\,_{rb}(\theta) & = & \widehat{\matrixD} + \left(\frac{1}{2}+\theta\right)\widehat{\matrixM}^{-1}\vecL(-1)\vecL(-1)^T\,,\\
\end{eqnarray*}
where $\widehat{\matrixD}$ denotes the cell-wise first-derivative gSBP operator of the DG scheme~\eqref{eq:DGwithi}.
\end{prop}
\begin{proof}
The evaluation of the numerical flux function at an interface given in~\eqref{eq:adv_numflux} may be rewritten as
\begin{align*}
(au)^{\ast}_{i} &= a\left(\frac{1}{2}+\theta\right)\vecL(1)^T\vecu^{i-1} +  a\left(\frac{1}{2}-\theta\right)\vecL(-1)^T\vecu^{i}
  \end{align*}
and the evaluation of the flux function $au_h^i$ at cell boundaries is obtained as
\begin{align*}
au_h^i(\pm1) &= a\vecL(\pm1)\vecL(\pm1)^T\vecu^i\,.
\end{align*}
The desired block structure is obtained by inserting these contributions into equation~\eqref{eq:DG_advection_withi} for interior DG cells and into \eqref{eq:DG_advection_lb} and \eqref{eq:DG_advection_rb} for boundary DG cells. Hereby, we account for the dependencies of the degrees of freedom on cell $i$ only on $\vecu^i,\ \vecu^{i-1}$ and $\vecu^{i+1}$ and set up the blocks accordingly.
\end{proof}

The specific form of $\matrixD^{-}$ allows us to show that the dual pair $\left\{\matrixD^-,\matrixD^+\right\}$ with $\matrixD^- = \matrixD^{-}(\theta)$ and a suitably constructed dual operator $\matrixD^+$ satisfies the upwind gSBP properties specified in Definition~\ref{def:upwindSBP} with $\alpha = x_a$ and $\beta=x_b$.

\begin{theorem}\label{theo:DG_upwindSBP}
The dual pair of discrete derivative operators
\begin{align}
\matrixD^-  = \matrixD\,^{-}(\theta)\,,\qquad \matrixD^+  = \matrixD\,^{-}(-\theta)\,,\label{eq:DG_upwind_defD-+}
\end{align}
is a dual pair of diagonal-norm upwind gSBP operators with respect to the global diagonal norm matrix
$$\matrixM = {\mathrm{diag}}\left(\frac{\Delta x_1}{2}\widehat{\matrixM}\,,\ldots ,\frac{\Delta x_K}{2}\widehat{\matrixM}\right)\,,$$
and the generalized boundary operator
$$\matrixB_{glob} = {\mathrm{diag}}\left(\matrixB\,_l,\, 0,\ldots,0,\, \matrixB\,_r\right)\,,$$
with $\matrixB\,_l = -\vecL(-1)\vecL(-1)^T$ and $\matrixB\,_r = \vecL(1)\vecL(1)^T$.
\end{theorem}
\begin{proof}
We define the matrices $\matrixQ^-$ and $\matrixQ^+$ in~\eqref{eq:SBPdef_upwind} by
\begin{align*}
\matrixQ^- &= \matrixM\,\matrixD^{-}(\theta) - \frac{1}{2}\,\matrixB_{glob}\,,\\
\matrixQ^+ &=  \matrixM\,\matrixD^{+}(\theta) - \frac{1}{2}\,\matrixB_{glob},\quad \matrixD^{+}(\theta)=\matrixD^{-}(-\theta) \,.
\end{align*}
Next, we show that $\matrixQ^-$ and $\matrixQ^+$ satisfy the SBP property~\eqref{eq:SBPprop_upwind_1}, i.e. that the dual operator $\matrixD^+$ is chosen properly.
We have
\begin{align*}
\matrixQ^++\left(\matrixQ^-\right)^T &= \matrixM\,\matrixD^{-}(-\theta) + \left(\matrixD^{-}(\theta)\right)^T\matrixM - \matrixB_{glob}\\[.0cm]
&= \left(\begin{array}{ccccc}
  \matrixQ\,_{lb} & \matrixQ\,_{12} & &&\\[.0cm]
  \matrixQ\,_{21} & \matrixQ\,_{11} & \matrixQ\,_{12} &&  \\[.0cm]
&  \ddots & \ddots & \ddots&\\[.0cm]
&& \matrixQ\,_{21} & \matrixQ\,_{11} & \matrixQ\,_{12}\\[.0cm]
  &&& \matrixQ\,_{21} & \matrixQ\,_{rb}\end{array}\right)\,,
  \end{align*}
where $\matrixQ^++\left(\matrixQ^-\right)^T=\nullMat$, since the block representation given in Proposition~\ref{lem:D_glob} yields
\begin{align*}
\matrixQ\,_{11} &= \widehat{\matrixM}\,\matrixA_{11}(-\theta) + \matrixA_{11}^T(\theta)\widehat{\matrixM} = \widehat{\matrixM}\,\widehat{\matrixD} + \widehat{\matrixD}^T\widehat{\matrixM} - \vecL(1)\vecL(1)^T + \vecL(-1)\vecL(-1)^T\, \\
&= \widehat{\matrixM}\,\widehat{\matrixD} + \widehat{\matrixD}^T\widehat{\matrixM} -\matrixB =  \nullMat\,,\\[.0cm]
\matrixQ\,_{lb} &= \widehat{\matrixM}\,\matrixA_{lb}(-\theta) + \matrixA_{lb}^T(\theta)\widehat{\matrixM} - \matrixB\,_l = \widehat{\matrixM}\,\widehat{\matrixD} + \widehat{\matrixD}^T\widehat{\matrixM} - \vecL(1)\vecL(1)^T + \vecL(-1)\vecL(-1)^T=  \nullMat\,,\\[.0cm]
\matrixQ\,_{rb} &= \widehat{\matrixM}\,\matrixA_{rb}(-\theta) + \matrixA_{rb}^T(\theta)\widehat{\matrixM} - \matrixB\,_r =  \widehat{\matrixM}\,\widehat{\matrixD} + \widehat{\matrixD}^T\widehat{\matrixM} + \vecL(-1)\vecL(-1)^T - \vecL(1)\vecL(1)^T=  \nullMat\,,\\[.0cm]
\matrixQ\,_{12} &= \widehat{\matrixM}\,\matrixA_{12}(-\theta) + \matrixA_{21}^T(\theta)\widehat{\matrixM}  = \left(\frac{1}{2}+\theta\right)\vecL(1)\vecL(-1)^T - \left(\frac{1}{2}+\theta\right)\vecL(1)\vecL(-1)^T =  \nullMat\,, \\[.0cm]
\matrixQ\,_{21} &= \widehat{\matrixM}\,\matrixA_{21}(-\theta) + \matrixA_{12}^T(\theta)\widehat{\matrixM}  = -\left(\frac{1}{2}-\theta\right)\vecL(-1)\vecL(1)^T + \left(\frac{1}{2}-\theta\right)\vecL(-1)\vecL(1)^T =  \nullMat\,.
\end{align*}
It remains to show the stability constraint~\eqref{eq:SBPprop_upwind_2}, i.e. to show that
\begin{align}\label{eq:DG_SBPupwind_stabconst}
\matrixC = \frac{1}{2} \left(\matrixQ^+ - \matrixQ^-\right) = \frac{1}{2}\,\matrixM\left(\matrixD^{-}(-\theta)-\matrixD^-(\theta)\right)
\end{align}
is negative semi-definite.
We have
\begin{align*}
\matrixC = \left(\begin{array}{ccccc}
  \matrixC\,_{lb} & \matrixC\,_{12} & &&\\[.0cm]
  \matrixC\,_{21} & \matrixC\,_{11} & \matrixC\,_{12} &&  \\[.0cm]
&  \ddots & \ddots & \ddots&\\[.0cm]
&& \matrixC\,_{21} & \matrixC\,_{11} & \matrixC\,_{12}\\[.0cm]
  &&& \matrixC\,_{21} & \matrixC\,_{rb}\end{array}\right)\,,
  \end{align*}
  with
  \begin{align*}
\matrixC\,_{11} &= \frac{1}{2}\left(\widehat{\matrixM}\,\matrixA_{11}(-\theta) - \widehat{\matrixM}\,\matrixA_{11}(\theta)\right) = -\theta\left(\vecL(1)\vecL(1)^T + \vecL(-1)\vecL(-1)^T\right)\,,\\[.0cm]
\matrixC\,_{lb} &= \frac{1}{2}\left(\widehat{\matrixM}\,\matrixA_{lb}(-\theta) - \widehat{\matrixM}\,\matrixA_{lb}(\theta)\right) = -\theta\vecL(1)\vecL(1)^T \,,\\[.0cm]
\matrixC\,_{rb} &= \frac{1}{2}\left(\widehat{\matrixM}\,\matrixA_{rb}(-\theta) - \widehat{\matrixM}\,\matrixA_{rb}(\theta)\right) = -\theta\vecL(-1)\vecL(-1)^T \,,\\[.0cm]
\matrixC\,_{12} &= \frac{1}{2}\left(\widehat{\matrixM}\,\matrixA_{12}(-\theta) - \widehat{\matrixM}\,\matrixA_{12}(\theta)\right) = \theta\vecL(1)\vecL(-1)^T\,, \\[.0cm]
\matrixC\,_{21} &= \frac{1}{2}\left(\widehat{\matrixM}\,\matrixA_{21}(-\theta) - \widehat{\matrixM}\,\matrixA_{21}(\theta)\right) = \theta\vecL(-1)\vecL(1)^T = \matrixC\,_{12}^T \,.
\end{align*}
Hence, we obtain
\begin{align*}
\vecu^T\matrixC\,\vecu &= (\vecu^1)^T\matrixC\,_{lb}\,\vecu^1 + \sum_{i=2}^{K-1}(\vecu^i)^T\matrixC\,_{11}\,\vecu^i + (\vecu^K)^T\matrixC\,_{rb}\,\vecu^K + 2\sum_{i=1}^{K-1}(\vecu^i)^T\matrixC\,_{12}\,\vecu^{i+1}\\
&= -\theta\left( (u_h^1(1))^2 + \sum_{i=2}^{K-1}\left( (u_h^i(-1))^2 + (u_h^i(1))^ 2\right) + (u_h^K(-1))^2 - 2 \sum_{i=1}^{K-1}u_h^i(1)u_h^{i+1}(-1) \right)\\
&= -\theta\sum_{i=1}^{K-1}\left(u_h^{i+1}(-1)-u_h^{i}(1)\right)^2\le 0\,,
\end{align*}
i.e. $\matrixC$ is negative semi-definite.
\end{proof}

The following remark provides additional insight into  the upwind gSBP character of the global DG formulation with numerical fluxes ranging from upwind to central fluxes.

\begin{remark}\label{rem:upwind_2ndSBP}
Since $\matrixD^+(\theta) = \matrixD^-(-\theta)$, we note that
\begin{enumerate}
\item the dual operator $\matrixD^+$ arises naturally from the DG scheme applied to the linear advection equation with negative advection velocity $a<0$, and
\item for $\theta = 0$, the global DG operator $\matrixD=\matrixD^-(0)=\matrixD^+(0)$ is a classical diagonal-norm gSBP operator with global central character.
\end{enumerate}
\end{remark}

\paragraph{Periodic first-derivative upwind gSBP operators}

Since the energy stability analysis in Sect.~\ref{sec:IMEX} regarding fully discrete IMEX upwind gSBP schemes is carried out for periodic advection-diffusion problems, the corresponding semi-discretization of~\eqref{eq:advdiff} by upwind gSBP operators is devoid of SATs and periodic upwind gSBP operators are required which are of a slightly modified form, given by
\begin{align}
\matrixD^{-}(\theta)
&=\left(\begin{array}{cccc}\frac{2}{\Delta x_1} &&&\\& \frac{2}{\Delta x_2}&&\\&&\ddots&\\&&& \frac{2}{\Delta x_K}\end{array}\right)
\left(\begin{array}{cccc}
  \matrixA\,_{11}(\theta) & \matrixA\,_{12}(\theta) & & \matrixA\,_{21}(\theta) \label{eq:Dm_per} \\[.2cm]
  \matrixA\,_{21}(\theta) & \ddots & \ddots  &  \\[.2cm]
&  \ddots & \ddots  & \matrixA\,_{12}(\theta)\\[.2cm]
\matrixA\,_{12}(\theta)   & &\matrixA\,_{21}(\theta) & \matrixA\,_{11}(\theta)\end{array}\right)\,,\\
\matrixD^{+}(\theta)
&= \matrixD^{-}(-\theta)\,, \label{eq:Dp_per}\\
\matrixD_2(\theta) &= \matrixD^{-}(\theta)\matrixD\,^{+}(\theta)\,. \label{eq:D2_per}
\end{align}
The construction of these periodic global discrete derivative operators is only based on the interior cell discretization~\eqref{eq:DG_advection_withi}. Therefore, they use the same building blocks given in Proposition~\ref{lem:D_glob} except for the absence of the boundary blocks $\matrixA_{lb}(\theta),\matrixA_{rb}(\theta)$.

\subsubsection{Rewriting LDG and BR1 schemes as second-derivative upwind SBP operators}\label{sec:rewritingLDG_BR1}

The upwind gSBP operators resulting from the DG discretization of the linear advection equation in one space dimension can be used to construct specific second-derivative operators. In particular, the construction~\eqref{eq:upwindSBP_second} of second-derivative upwind gSBP operators by combining $\matrixD^-(\theta)$ and $\matrixD^+(\theta)$ is directly related the DG technique of rewriting diffusion equations into a first order system using an auxiliary variable for the solution derivative as in \cite{BassiRebay:97, CockburnShu_LDG:98, BassiRebay:2000b, Arnold_etal:02}. For the linear heat equation
\begin{align}\label{eq:linear_heat}
u_t = c u_{xx},\quad (x,t) \in (x_\alpha,x_\beta)\times (0,T)
\end{align}
this procedure provides the system
\begin{align} \label{eq:firstorder_linheat}
  u_t  = c q_x, \quad  q & = u_x,
  \end{align}
using an auxiliary variable $q$. For periodic boundary conditions, only the interior cell discretization~\eqref{eq:DGwithi} is relevant and the element-wise strong form DG semi-discretization yields
\begin{align*}
\frac{\Delta x_i}{2}\,\frac{d\vecu^i}{dt} &= c\, \widehat{\matrixD}\,\vecq^i - c\, \widehat{\matrixM}^{-1}[(q_h^i-q^{\ast,i})\vecL]_{-1}^{1}\,,\\
\frac{\Delta x_i}{2}\,\vecq^i &=  \widehat{\matrixD}\,\vecu^i -  \widehat{\matrixM}^{-1}[(u_h^i-u^{\ast,i})\vecL]_{-1}^{1}\,.
\end{align*}
Regarding the specification of the numerical fluxes, at each element boundary, the left-hand side and right-hand side values of a piecewise continuous function $v$ are denoted by $v^-$ and $v^+$, respectively. The corresponding jump at element interfaces is denoted by $[v]=v^+-v^-$ and the arithmetic mean is given by $\{v\}=\frac{1}{2}(v^++v^-)$. The simplest choice for $q^\ast$ and $u^\ast$ is the BR1 scheme \cite{BassiRebay:97} given by the arithmetic means
\begin{align} \label{eq:BR1}
q^{\ast,BR1}=\{q\},\quad u^{\ast,BR1} = \{u\}\,.
\end{align}

Furthermore, the original local discontinuous Galerkin (LDG) \cite{CockburnShu_LDG:98} yields a parameter-dependent family of diffusion fluxes
\begin{align}\label{eq:defLDGflux}
q^{\ast, LDG}=\{q\} - c_{12}[q] +c_{11}[u]\,, \quad u^{\ast, LDG} = \{u\}+c_{12}[u]\,,
 \end{align}
which, in one space dimension, contains the BR1 approach as a specific case with $c_{11}=c_{12}=0$. Commonly, LDG fluxes refer to the choice of alternating fluxes with $c_{12}=\pm 1,\ c_{11}=0$, which offers two different variants. One implementation is thus given by
\begin{align} \label{eq:LDGa}
q^{\ast, LDG_a}=q^-,\quad u^{\ast, LDG_a} = u^+\,,
\end{align}
the second variant is specified by
\begin{align} \label{eq:LDGb}
q^{\ast, LDG_b}=q^+,\quad u^{\ast, LDG_b} = u^-\,.
\end{align}

For the LDG$_a$, the LDG$_b$ and the BR1 scheme, the numerical fluxes $q^\ast$ and $u^\ast$ can now be written as
\begin{align*}
q^{\ast} &= \left(\frac{1}{2}+\theta_q\right)q^- + \left(\frac{1}{2}-\theta_q\right)q^+\,,\\
 u^{\ast} &= \left(\frac{1}{2}+\theta_u\right)u^- + \left(\frac{1}{2}-\theta_u\right)u^+\,,
  \end{align*} 
with $\theta_q = \frac12, \theta_u =-\frac12$ for LDG$_a$,\ $\theta_q = -\frac12, \theta_u =\frac12$ 
for LDG$_b$ and $\theta_q = \theta_u =0$
for BR1. 

Due to the assumed periodic boundary conditions, we now use the periodic global upwind gSBP operators~\eqref{eq:Dm_per},~\eqref{eq:Dp_per} and~\eqref{eq:D2_per} developed in Section~\ref{sec:DG_upwindSBP}. 

Thus, the LDG$_a$ scheme can be rewritten as
\[\frac{d\vecu}{dt}  = c\,\matrixD^-\,\vecq\,, \quad \vecq  = \matrixD^+\,\vecu\,,\]
where $\vecu = (\vecu^1,\ldots, \vecu^K)^T,\ \vecq = (\vecq^1,\ldots, \vecq^K)^T$ denote the global nodal solution vectors and the periodic upwind gSBP operator $\matrixD^- = \matrixD^-\left(\theta = \frac{1}{2}\right)$ is taken from~\eqref{eq:Dm_per}. Hence, for the LDG$_a$ scheme, we have
$$\mbox{LDG}_a:\quad \frac{d\vecu}{dt}  = c\, \matrixD_2^+\,\vecu = c\,\matrixD^-\matrixD^+\,\vecu\,.$$
Analogously, for the LDG$_b$ variant we obtain
$$\mbox{LDG}_b:\quad \frac{d\vecu}{dt}  = c\, \matrixD_2^-\,\vecu = c\,\matrixD^+\matrixD^-\,\vecu\,.$$
Both of these formulations correspond to true upwind gSBP operators approximating the second derivative as defined in \eqref{eq:upwindSBP_second}.
In contrast, for the BR1 scheme, we have
$$\mbox{BR1}:\quad \frac{d\vecu}{dt}  = c\, \matrixD_2\,\vecu = c\,\matrixD\,\matrixD\,\vecu\,,$$
where $\matrixD = \matrixD^-(\theta = 0) = \matrixD^+(\theta = 0)$ is a classical first-derivative gSBP operator, as already mentioned in Remark~\ref{rem:upwind_2ndSBP}. Thus, the BR1 scheme represents a second-derivative gSBP operator which is obtained by applying the first-derivative gSBP operator twice.

\subsubsection{Preliminary estimates for first- and second derivative upwind gSBP operators}

The fully discrete stability analysis for IMEX upwind gSBP schemes in Sect.~\ref{sec:IMEX1} and Sect.~\ref{sec:IMEX2} will be restricted to perodic problems and is based on the discrete energy norm induced by the diagonal positive definite norm matrix $\matrixM$. Defining the inner product
$$\Ltwo{\vecu}{\vecv} = \vecu^T\matrixM\vecv\,,$$
a discrete energy norm is given by
$$\|\vecu\|_\matrixM = \sqrt{\Ltwo{\vecu}{\vecu}} = \sqrt{\vecu^T\matrixM\vecu}\,.$$
Furthermore, the Cauchy-Schwarz inequality
$$\Ltwo{\vecu}{\vecv} \le \|\vecu\|_\matrixM  \|\vecv\|_\matrixM $$
will be useful.
As already mentioned, we assume periodic boundary conditions and the semi-discretization of the linear advection-diffusion equation~\eqref{eq:advdiff} results in 

\begin{align*}%\label{eq:upwind_semi}
  \frac{d\vecu}{dt} + a\,\matrixD^-\vecu = c\,\matrixD_2\vecu\,,
  \end{align*}
based on the periodic upwind gSBP operators given in~\eqref{eq:Dm_per} and \eqref{eq:D2_per}.

Using this notation, we have the following estimates and relations between the operators $\matrixD^\pm$ and $\matrixD_2$, which will be required for the subsequent discrete energy stability analysis.
  
\begin{prop}\label{lem:estimates}
For the periodic upwind gSBP operators defined in~\eqref{eq:Dm_per},~\eqref{eq:Dp_per} and~\eqref{eq:D2_per}, and arbitrary nodal values $\vecu,\vecv$ we have
\begin{enumerate}
 \item Dissipativity of $-\matrixD^-$, i.e.
 \begin{align}\label{eq:Dm_estimate}
 \Ltwo{\matrixD^-\vecu}{\vecu} \ge 0
\end{align}
\item Dissipativity of $\matrixD_2$, more precisely
\begin{align}
 \Ltwo{\matrixD_2\vecu}{\vecv} &= -\Ltwo{\matrixD^+\vecu}{\matrixD^+\vecv} \label{eq:D2uv}\\
 \Ltwo{\matrixD_2\vecu}{\vecu} &= -\|\matrixD^+\vecu\|^2_\matrixM \le 0\,. \label{eq:D2uu}
\end{align}
\item A Cauchy-Schwarz-type inequality
\begin{align}\label{eq:Dmuv}
 |\Ltwo{\matrixD^-\vecu}{\vecv}| \le \|\vecu\|_\matrixM \|\matrixD^+\vecv\|_\matrixM
\end{align}
\end{enumerate}
\end{prop}
\begin{proof}
First, making use of periodicity, the upwind gSBP property~\eqref{eq:SBPprop_upwind_1} reduces to the equation
\begin{align*}
\matrixM\matrixD^+ +(\matrixD^-)^T\matrixM = \matrixQ^+ +(\matrixQ^-)^T = \nullMat\,,
\end{align*}
leading to $(\matrixD^-)^T\matrixM = -\matrixM\matrixD^+$ which we will frequently use in the following derivations.

Due to symmetry of the inner product, we have
$$\Ltwo{\matrixD^-\vecu}{\vecu} = \frac12\left(\Ltwo{\matrixD^-\vecu}{\vecu} + \Ltwo{\vecu}{\matrixD^-\vecu} \right)\,,$$
and the first assertion is thus proven by
$$\Ltwo{\matrixD^-\vecu}{\vecu}= \frac12\left(\vecu^T(\matrixQ^-)^T\vecu + \vecu^T\matrixQ^-\vecu\right) = -\frac12\vecu^T\left(\matrixQ^+-\matrixQ^-\right)\vecu = -\vecu^T\matrixC\vecu\ge 0\,.$$

Regarding the second assertion, we obtain~\eqref{eq:D2uv} by
\begin{align*}
\Ltwo{\matrixD_2\vecu}{\vecv} &=  \Ltwo{\matrixD^-\matrixD^+\vecu}{\vecv} = \vecu^T(\matrixD^+)^T(\matrixD^-)^T\matrixM\vecv = -(\matrixD^+\vecu)^T\matrixM\matrixD^+\vecv = -\Ltwo{\matrixD^+\vecu}{\matrixD^+\vecv}\,,
 \end{align*}
 and~\eqref{eq:D2uu} directly follows.
For~\eqref{eq:Dmuv}, we may rewrite
 $$ |\Ltwo{\matrixD^-\vecu}{\vecv}| = |\vecu^T(\matrixD^-)^T\matrixM\vecv| = |\vecu^T\matrixM\matrixD^+\vecv|  = \Ltwo{\vecu}{\matrixD^+\vecv}$$
 and the third assertion follows from the Cauchy-Schwarz inequality for the inner product $\Ltwo{\cdot}{\cdot}$.
\end{proof}

We will furthermore use Young's inequality in the form
\begin{align}\label{eq:young}
 |ab| \le \frac{a^2}{4C} + Cb^2,
\end{align}
for any constant $C>0$ and any $a,b\in\R$.

\section{IMEX schemes for advection-diffusion problems} \label{sec:IMEX}

Implicit-explicit one-step time integration methods for advection-diffusion equations are generally based on partitioned Runge-Kutta schemes applied to a partitioned system of ordinary differential equations of the form
\begin{align}\label{eq:ODE}
  \frac{d\vecu}{dt} = F_1(t,\vecu) + F_2(t,\vecu)\,.
\end{align}
Hereby, different RK schemes, i.e. an explicit and an implicit one, are applied to the components $F_1$ and $F_2$ of the split right-hand side.

As in \cite{AscherRuuthSpiteri:97,Calvo:01} we consider $(s+1)$-stage explicit Runge-Kutta methods coupled with implicit $s$-stage DIRK schemes where the absissae $\mathbf c^1,\mathbf c^2$ of the explicit and implicit scheme, respectively, fulfill $\mathbf c^1 = \left(\begin{array}{c}0\\\mathbf c^2\end{array}\right)$. The DIRK scheme is then recast into an $(s+1)$-stage scheme as well by padding the first row and first column with zeros. We thus obtain the Butcher table
\begin{align*}
  \begin{tabular}{c|ccccc|ccccc}
    0 & 0 &  &  &  &  & 0  &  & & &  \\
    $c_2$ & $a^1_{21}$ & 0 &  & &  & 0 & $a^2_{22}$ &  && \\
    $c_3$ & $a^1_{31}$ & $a^1_{32}$ & 0 & &  & 0 & $a^2_{32}$ & $a^2_{33}$\\
    $\vdots$ & $\vdots$ & $\vdots$ & $\ddots$ & $\ddots$ &  & $\vdots$ & $\vdots$ & $\ddots$ & $\ddots$ & \\
    $c_{s+1}$ & $a^1_{s+1,1}$ & $a^1_{s+1,2}$ & $\cdots$ & $a^1_{s+1,s}$ & 0 & 0 & $a^2_{s+1,2}$ & $\cdots$ & $a^2_{s+1,s}$ & $a^2_{s+1,s+1}$ \\
    \hline & $b^1_1$ & $b^1_2$ & $b^1_2$ & $\cdots$ & $b^1_{s+1}$ & 0 & $b^2_2$ & $b^2_3$ & $\cdots$ & $b^2_{s+1}$ \\
    \end{tabular}\quad .
\end{align*}

Applied to the system of ODEs \eqref{eq:ODE}, the IMEX-RK scheme then has the form
\begin{align}
  \begin{split}
    \vecu^{(1)} &= \vecu^{n}\\
    \vecu^{(i)} &= \vecu^{n} + \Delta t\sum_{j=1}^{s+1}a^1_{ij}F_1(t^{n,j},\vecu^{(j)}) + \Delta t\sum_{j=1}^{s+1}a^2_{ij}F_1(t^{n,j},\vecu^{(j)})\,,\ i=2,\ldots,s+1,\\
    \vecu^{n+1} &= \vecu^{n} + \Delta t\sum_{j=1}^{s+1}b^1_{j}F_1(t^{n,j},\vecu^{(j)}) + \Delta t\sum_{j=1}^{s+1}b^2_{j}F_1(t^{n,j},\vecu^{(j)})\,,
    \end{split}
\end{align}
where $\vecu^n,\vecu^{n+1}$ denote the approximations at times $t^n$ and $t^{n+1}=t^n+\Delta t$ and $\vecu^{(i)}$ the intermediate stage values corresponding to the intermediate times $t^{n,i}$ given by $t^{n,i}=t^n+c_i\Delta t$ with $c_i = \sum_{j=1}^sa^1_{ij}=\sum_{j=1}^sa^2_{ij}$.

In \cite{Calvo:01}, Calvo et al. derived necessary conditions on the coefficients of IMEX schemes of the above form to obtain a time step restriction of $\Delta t = {\cal O}(c/a^2)$ for advection-diffusion equations discretized by the Fourier method. These conditions are similar to L-stability and include $a^2_{s+1,j}=b^2_j,\ j=2,\ldots,s+1$ as a requirement for the implicit scheme.

In this work, for the $L^2$-stability analysis of IMEX-DG schemes, we consider the following first and second order IMEX schemes also used in \cite{Wang_etal:15}.

\underline{First order:}
\begin{align}\label{eq:IMEX1}
  \begin{tabular}{c|cc|cc}
    0 & 0 & 0 & 0 & 0 \\ 1 & 1 & 0 & 0 & 1 \\\hline & 1 & 0 & 0 & 1 \\
    \end{tabular}
\end{align}

\underline{Second order:}
\begin{align}\label{eq:IMEX2}
  \begin{array}{c|ccc|ccc}
    0     & 0 & 0 & 0             & 0 & 0 & 0             \\
    \gamma& \gamma & 0 & 0        & 0 & \gamma & 0   \\
    1     & \delta & 1-\delta & 0 & 0 & 1-\gamma & \gamma \\\hline
          & \delta & 1-\delta & 0 & 0 & 1-\gamma & \gamma \\
    \end{array}
\end{align}
with $\gamma = 1-\frac{\sqrt{2}}{2}$ and $\delta = 1-\frac{1}{2\gamma}$, fulfilling the identity
$$\gamma-\delta=1\,.$$

In addition, some of the numerical experiments carried out in Sect.~\ref{sec:numresults} utilize the third order IMEX scheme taken from \cite{Calvo:01} which is given by
\begin{align}\label{eq:IMEX3}
  \begin{array}{c|cccc|cccc}
    0     & 0 & 0 & 0 & 0            & 0 & 0 & 0 & 0            \\
    \gamma& \gamma & 0 & 0 & 0       & 0 & \gamma & 0 & 0  \\
    \frac{1+\gamma}{2} & \frac{1+\gamma}{2}-a_1 & a_1 & 0 & 0 & 0 & \frac{1-\gamma}{2} & \gamma & 0 \\
    1 & 0 & 1-a_2 & a_2 & 0 & 0 & b_1 & b_2 & \gamma\\\hline
          & 0 & b_1 & b_2 & \gamma & 0 & b_1 & b_2 & \gamma \\
    \end{array}
\end{align}
with

\begin{tabular}{cl}
  $\gamma$ & $\approx 0.435866521508459$ \ the middle root of \ $6x^3-18x^2+9x-1$,\\
  $b_1$ & $ = -1.5\gamma^2+4\gamma-0.25$,\\
  $b_2$ & $ = 1.5\gamma^2-5\gamma+1.25$, \\
  $a_1$ & $ = -0.35$,\\
  $a_2$ & $ = \frac{1/3-2\gamma^2-2b_2a_1\gamma}{\gamma(1-\gamma)}$.\\[.5cm]
\end{tabular}


\subsection{Stability analysis for the first order IMEX scheme}\label{sec:IMEX1}

In principle, the energy stability analysis for IMEX upwind gSBP schemes is similar to the $L^2$-stability analysis carried out for LDG schemes in~\cite{Wang_etal:15} and for the $(\sigma,\mu)$-family in~\cite{ortleb:20}. The most significant difference of the current approach is the direct use of the discrete energy generated by the upwind gSBP norm matrix $\matrixM$ instead of the usual $L^2$-norm of the approximate solution. This leads to a very transparent energy estimate which is devoid of finite-element-type inverse constants and holds for upwind gSBP schemes of arbitrary order in space. In particular, the provided time step restriction does not depend on the polynomial degree in space. For the applicability of the following stability analysis, compatibility of the first-derivative and second-derivative upwind gSBP operators in the sense that $\matrixD_2 = \matrixD^-\matrixD^+$ is crucial.

Discretizing the linear advection-diffusion equation \eqref{eq:advdiff} with advective velocity $a>0$ by first- and second derivative upwind gSBP operators $\matrixD^-$ and $\matrixD_2$ in space and the first order IMEX scheme~\eqref{eq:IMEX1} as time integrator yields the fully discrete IMEX upwind gSBP scheme
\begin{align}\label{eq:fuldis1}
  \vecu^{n+1} = \vecu^{n} - a\Delta t\, \matrixD^-{\vecu^n} +  c\Delta t\, \matrixD_2 \vecu^{n+1}.
\end{align}

Applying $\Ltwo{\cdot}{\cdot}$ on both sides of \eqref{eq:fuldis1} with $\vecu^{n+1}$ as second argument, we get
\begin{align}\label{eq:fuldis1_inner}
  \Ltwo{\vecu^{n+1}}{\vecu^{n+1}} 
  = &\Ltwo{\vecu^n}{\vecu^{n+1}} - a\Delta t \Ltwo{\matrixD^- \vecu^n}{\vecu^{n+1}} + c \Delta t\Ltwo{\matrixD_2 \vecu^{n+1}}{\vecu^{n+1}}
\end{align}
Denoting $\vecu^\delta  = \vecu^{n+1}-\vecu^n$ and using identities analogously to the derivation in \cite{Wang_etal:15} combined with the estimate~\eqref{eq:Dm_estimate}, we obtain
\begin{align*}
 \Ltwo{\vecu^{n+1}-\vecu^n}{\vecu^{n+1}} &= \frac{1}{2}\Ltwo{\vecu^{n+1}}{\vecu^{n+1}}+ \frac{1}{2}\Ltwo{\vecu^\delta}{\vecu^\delta} - \frac{1}{2}\Ltwo{\vecu^n}{\vecu^n}\,,\\
 -\Ltwo{\matrixD^- \vecu^n}{\vecu^{n+1}} &= \Ltwo{\matrixD^- \vecu^{\delta}}{\vecu^{n+1}}  - \Ltwo{\matrixD^- \vecu^{n+1}}{\vecu^{n+1}} \le \Ltwo{\matrixD^- \vecu^{\delta}}{\vecu^{n+1}} \,.
\end{align*}
Inserting this into~\eqref{eq:fuldis1_inner}
and employing~\eqref{eq:D2uu},~\eqref{eq:Dmuv} and finally Young's inequality~\eqref{eq:young}, we have 
\begin{align*}%\label{eq:IMEX1estimate1}
  \frac{1}{2}\left(\|\vecu^{n+1}\|_\matrixM^2 - \|\vecu^{n}\|_\matrixM^2\right) &\le
-\frac{1}{2} \|\vecu^\delta\|_\matrixM^2 + a\Delta t \left(\matrixD^- \vecu^\delta,\vecu^{n+1}\right)_\matrixM +c \Delta t \Ltwo{\matrixD_2\vecu^{n+1}}{\vecu^{n+1}} \\
&\le -\frac{1}{2} \|\vecu^\delta\|_\matrixM^2 + a\Delta t\|\vecu^\delta\|_\matrixM\|\matrixD^+\vecu^{n+1}\|_\matrixM -c \Delta t \|\matrixD^+ \vecu^{n+1}\|^2_\matrixM \\
&\le -\frac{1}{2} \|\vecu^\delta\|_\matrixM^2 + \frac{a^2\Delta t}{4c}\|\vecu^\delta\|_\matrixM^2 + c\Delta t\|\matrixD^+\vecu^{n+1}\|_\matrixM^2 -c \Delta t \|\matrixD^+ \vecu^{n+1}\|^2_\matrixM \\
&= \left(\frac{a^2\Delta t }{4c}-\frac12\right)\|\vecu^\delta\|_\matrixM^2\,.
\end{align*}

Summarizing the above findings we have the following

\begin{theorem}\label{thm:IMEX1}
If $\{\matrixD^-,\matrixD^+\}$ is any dual pair of first-derivative upwind SBP operators with norm matrix $\matrixM$ and the second-derivative upwind SBP operator is chosen as $\matrixD_2=\matrixD^-\matrixD^+$, then the fully discrete solution of the IMEX-upwind SBP scheme \eqref{eq:fuldis1} satisfies discrete energy stability of the form
$\|\vecu^{n+1}\|_\matrixM\le \|\vecu^{n}\|_\matrixM$ if the time step is bounded by
$$\Delta t \le \frac{2c}{a^2}\,.$$
\end{theorem}

It is worth to note that the assertion of Theorem~\ref{thm:IMEX1} is quite general since it also holds for the LDG diffusion scheme coupled with upwind fluxes for advection, i.e. the scheme analyzed in~\cite{Wang_etal:15}. In addition, the constant in the above time step restriction is specifically determined and is independent of the polynomial degree of the space discretization since no detour through finite-element spaces for $u$ and $u_x$ is required. 


\subsection{Stability analysis for the second order IMEX scheme}\label{sec:IMEX2}

Discretizing the linear advection-diffusion equation \eqref{eq:advdiff} by upwind gSBP operators in space as in Sect.~\ref{sec:IMEX1} and using the second order IMEX time integrator \eqref{eq:IMEX2} yields the fully discrete IMEX upwind gSBP scheme
\begin{align}
  \vecu^{(n,1)} &= \vecu^{n} + \Delta t\gamma\left(-a \,\matrixD^-{\vecu^n} + c\, \matrixD_2 \vecu^{(n,1)}\right)\,, \label{eq:fuldis2a}\\
  \vecu^{n+1} &= \vecu^{n} - \Delta t\left(\delta a\, \matrixD^-{\vecu^n} + (1-\delta) a\, \matrixD^-{\vecu^{(n,1)}}\right) + \Delta t\left( (1-\gamma) c\, \matrixD_2 \vecu^{(n,1)} + \gamma c\, \matrixD_2 \vecu^{n+1}\right)\,. \label{eq:fuldis2b}
\end{align}
Employing the discrete inner product $\Ltwo{\cdot}{\cdot}$ on both sides of~\eqref{eq:fuldis2a} with $\vecu^{(n,1)}$ as second argument and on both sides of~\eqref{eq:fuldis2b} with $\vecu^{n+1}$ as second argument, we have
\begin{align}
  (\vecu^{(n,1)}-\vecu^n,\vecu^{(n,1)})_\matrixM &=  -a\gamma \Delta t \left(\matrixD^-{\vecu^n},{\vecu^{(n,1)}}\right)_\matrixM + c\gamma \Delta t\Ltwo{\matrixD_2\vecu^{(n,1)}}{\vecu^{(n,1)}}\,, \label{eq:fuldis2c}\\
  (\vecu^{n+1}-\vecu^{(n,1)},\vecu^{n+1})_\matrixM &= a\Delta t\left(\left(\matrixD^-{\vecu^n},\vecu^{n+1}\right)_\matrixM - (1-\delta) \left(\matrixD^-{\vecu^{(n,1)}},{\vecu^{n+1}}\right)_\matrixM\right)\nonumber\\
  & + c\Delta t\left( (1-2\gamma) \left(\matrixD_2 \vecu^{(n,1)},\vecu^{n+1}\right)_\matrixM + \gamma  \Ltwo{\matrixD_2\vecu^{n+1}}{\vecu^{n+1}}\right) \label{eq:fuldis2d}\,,
\end{align}
where we have used $\gamma-\delta=1$. 
 Setting $\vecu^{\delta,1}=\vecu^{(n,1)}-\vecu^n$ and $\vecu^{\delta,2} = \vecu^{n+1}-\vecu^{(n,1)}$ and adding equations \eqref{eq:fuldis2c} and \eqref{eq:fuldis2d}, we obtain 
\begin{align}
    \frac{1}{2}\left(\|\vecu^{n+1}\|^2 - \|\vecu^{n}\|^2 + \|\vecu^{\delta,1}\|^2 + \|\vecu^{\delta,2}\|^2\right) = \Delta t(R_1 + R_2)\,,  \label{eq:lhs}
\end{align}
with
\begin{align*}
  R_1 = &-a\gamma \left(\matrixD^-{\vecu^n},{\vecu^{(n,1)}}\right)_\matrixM + a\left(\matrixD^-{\vecu^n},{\vecu^{n+1}}\right)_\matrixM - a(1-\delta) \left(\matrixD^-{\vecu^{(n,1)}},{\vecu^{n+1}}\right)_\matrixM\\
   = &-a\gamma \left(\left(\matrixD^-{\vecu^{(n,1)}},{\vecu^{(n,1)}}\right)_\matrixM - \left(\matrixD^- {\vecu^{\delta,1}},{\vecu^{(n,1)}}\right)_\matrixM \right) - a(1-\gamma)\left(\matrixD^-{\vecu^{n+1}},{\vecu^{n+1}}\right)_\matrixM \\
  &- a\left(\matrixD^- \vecu^{\delta,1},{\vecu^{n+1}}\right)_\matrixM + a(1-\gamma) \left(\matrixD^-\vecu^{\delta,2},{\vecu^{n+1}}\right)_\matrixM\,
\end{align*}
  and via~\eqref{eq:D2uu},
\begin{align*}  
  R_2 &= -c\left(\gamma \|\matrixD^+ \vecu^{(n,1)}\|^2_\matrixM + (1-2\gamma) \left(\matrixD^+ \vecu^{(n,1)}, \matrixD^+ \vecu^{n+1}\right)_\matrixM + \gamma \|\matrixD^+ \vecu^{n+1}\|^2_\matrixM\right)\,.
\end{align*}
Furthermore, $R_2$ fulfills  
\begin{align*}
R_2 &= S -\frac14 c\gamma\left(\|\matrixD^+ \vecu^{(n,1)}\|^2_\matrixM + \|\matrixD^+ \vecu^{n+1}\|^2_\matrixM\right)\,,
\end{align*}
with 
\begin{align*}
S=-c\left(\frac34\gamma \|\matrixD^+ \vecu^{(n,1)}\|^2_\matrixM + (1-2\gamma) \left(\matrixD^+ \vecu^{(n,1)}, \matrixD^+ \vecu^{n+1}\right)_\matrixM + \frac34\gamma \|\matrixD^+ \vecu^{n+1}\|^2_\matrixM\right) \le 0
\end{align*}
since $\mathbf S = \begin{pmatrix} \frac34\gamma & \frac12-\gamma\\ \frac12-\gamma & \frac34\gamma \end{pmatrix}$ can be proven positive definite for $\gamma=1-\frac{\sqrt{2}}{2}$ and we have 
$$S= -c\,\vecw^T \left(\mathbf S\otimes\matrixM\right) \vecw\quad\mbox{with}\ \vecw = \left(\begin{array}{c}\matrixD^+ \vecu^{(n,1)}\\\matrixD^+ \vecu^{n+1}\end{array}\right)\,.$$
Using~\eqref{eq:Dm_estimate}, \eqref{eq:Dmuv}, we can furthermore bound $R_1$ by
\begin{align*}
  R_1 &\le a\left(\|\vecu^{\delta,1}\|_\matrixM \left(\gamma \|\matrixD^ + \vecu^{(n,1)}\|_\matrixM +  \|\matrixD^+ \vecu^{n+1}\|_\matrixM \right) + (1-\gamma)\|\vecu^{\delta,2}\|_\matrixM \|\matrixD^+ \vecu^{n+1}\|_\matrixM\right)\\
  &\le \frac{a^2}{c}\left(\left(\gamma+\frac{3}{2\gamma}\right)\|\vecu^{\delta,1}\|^2_\matrixM + \frac{11}{2}\|\vecu^{\delta,2}\|_\matrixM^2\right) + c\frac{\gamma}{4}\|\matrixD^+ \vecu^{(n,1)}\|^2_\matrixM + c\left(\frac{\gamma}{6}+\frac{(1-\gamma)^2}{22}\right)\|\matrixD^ + \vecu^{n+1}\|^2_\matrixM \\
  &\le \frac{11}{2}\,\frac{a^2}{c} \left(\|\vecu^{\delta,1}\|^2_\matrixM + \|\vecu^{\delta,2}\|_\matrixM^2\right) + \frac14\gamma c \left(\|\matrixD^+ \vecu^{(n,1)}\|^2_\matrixM + \|\matrixD^+ \vecu^{n+1}\|^2_\matrixM \right),
\end{align*}
  since for the parameter $\gamma = 1-\frac{\sqrt{2}}{2}$, the inequalities $\gamma+\frac{3}{2\gamma}\le\frac{11}{2}$ and $\frac{\gamma}{6}+\frac{(1-\gamma)^2}{22}\le\frac14$ hold.

Inserting the estimates for $R_1$ and $R_2$ into~\eqref{eq:lhs}, we obtain the following
\begin{theorem}\label{thm:IMEX2}
If $\{\matrixD^-,\matrixD^+\}$ is any dual pair of first-derivative upwind SBP operators with norm matrix $M$ and the second-derivative upwind SBP operator is chosen as $\matrixD_2=\matrixD^-\matrixD^+$, then the fully discrete solution of the IMEX-upwind SBP scheme \eqref{eq:fuldis2a}, \eqref{eq:fuldis2b} satisfies discrete energy stability of the form
$\|\vecu^{n+1}\|_\matrixM\le \|\vecu^{n}\|_\matrixM$ if the time step is bounded by
$$\Delta t \le \frac{c}{11a^2}\,.$$ 
\end{theorem}

\section{Numerical results} \label{sec:numresults}

In this section, stability and accuracy of IMEX upwind gSBP schemes is compared with respect to different combinations of the first-derivative and second-derivative upwind gSBP operators.

\paragraph{Numerical study on time step restrictions} %\label{sec:numexp_stability}

We consider the exact solution
\begin{align}\label{eq:exact_decreasing}
u(x,t) = e^{-ct}\sin(x-at) 
\end{align}
of the linear advection-diffusion equation \eqref{eq:advdiff} in the interval $(x_a,x_b) = (-\pi,\pi)$. The advection-diffusion problem is discretized in space by different upwind gSBP operators on a uniform grid using a number of $N+1$ Legendre-Gauss-Lobatto nodes on each grid cell. The implemented upwind gSBP operators are specified by the parameters $\theta_{\tt adv}$ and $\theta_{\tt diff}$, respectively, where we choose $\matrixD^- = \matrixD^-(\theta=\theta_{\tt adv})$ and $\matrixD_2 = \matrixD^-(\theta_{\tt diff})\matrixD^+(\theta_{\tt diff})$. Thus, for $\theta_{\tt adv} = \theta_{\tt diff}$, the first-derivative and second-derivative operators are compatible in the sense of Theorem~\ref{thm:IMEX1} and Theorem~\ref{thm:IMEX2}. 
For instance, the choice $\left(\theta_{\tt adv},\theta_{\tt diff}\right) = \left(\frac12,\frac12\right)$ represents upwind advection fluxes paired with LDG diffusion fluxes while $\left(\theta_{\tt adv},\theta_{\tt diff}\right) = \left(0,0\right)$ denotes the pairing of central advection fluxes with the BR1 diffusion scheme.
The first order IMEX scheme~\eqref{eq:IMEX1} and the second order IMEX scheme~\eqref{eq:IMEX2} are then used to discretize advection terms explicitly and diffusion terms implicitly in time. From the theoretical analysis, we expect the schemes to be stable for time steps $\Delta t\le \tau\frac{c}{a^2}$, where $\tau$ is some constant independent of grid refinement.

Table \ref{tab:stability_IMEX} shows the analysis of the maximum stable time step for $N\le 3$ and different advection and diffusion parameters $a$ and $c$, where we successively double the number of cells $K$ and compute the numerical solution until the final time $T = 1000$ is reached. The maximum stable time step $\Delta t_{max}$ is determined as the maximum time step for which the discrete energy norm $(\vecu,\vecu)_\matrixM$ of the numerical solution is non-increasing and the corresponding values of $\tau=\frac{a^2}{c}\Delta t_{max}$ are listed. An entry of $+$ indicates that arbitrarily large time steps may be chosen without increasing the discrete energy in time.

As predicted by the theoretical analysis, for all schemes using compatible first-derivative and second-derivative upwind gSBP operators with $\theta_{\tt adv}=\theta_{\tt diff}$, the maximum admissible time step is bounded from below under grid refinement. The precise bound varies for different advection-diffusion parameters $a,c$ but fulfills the theoretically predicted time step restriction as long as the compatibility condition is fulfilled. Moreover, the different schemes possess nearly the same time step bounds under the same set-up with respect to the parameters $a,c$ and the chosen IMEX scheme. Regarding the enhanced IMEX stability property, the time step bound is lower for second order IMEX time integration as predicted by the theoretical analysis. 

On the other hand, as already noted in~\cite{ortleb:20}, the choice of $\left(\theta_{\tt adv},\theta_{\tt diff}\right) = \left(\frac12,0\right)$ representing the BR1 diffusion scheme paired upwind advection fluxes does not admit grid-independent time step sizes, in accordance with the theoretical analysis with only covers the case $\theta_{\tt adv}=\theta_{\tt diff}$ as already stated. Instead, we observe admissible time steps of $\tau={\cal O}(\Delta x)$, analogous to the time step restrictions for explicitly discretized advection equations. Replacing the upwind advection fluxes by central fluxes is compatible with the BR1 scheme and yields enhanced IMEX stability which can also be observed in the results of Table~\ref{tab:stability_IMEX}.

\begin{table}
 \centering
  \begin{tabular}{|c|c||cccc||cccc|}\hline
   \multirow{3}{.4cm}{$N$} & \multirow{3}{.4cm}{$K$} & \multicolumn{4}{|c|}{$a=c=0.1$} & \multicolumn{4}{|c||}{$a=0.2,\ c=0.01$} \\\cline{3-10}
  & & \multicolumn{8}{|c|}{Upwind gSBP discretization $\left(\theta_{\tt adv},\theta_{\tt diff}\right)$}\\[.1cm]
  & & $\left(\frac12,\frac12\right)$ & $\left(\frac12,0\right)$ & $\left(\frac14,\frac14\right)$ & \multicolumn{1}{c}{$\left(0,0\right)$} &  \multicolumn{1}{c}{$\left(\frac12,\frac12\right)$} & $\left(\frac12,0\right)$ & $\left(\frac14,\frac14\right)$ & $\left(0,0\right)$\\[.1cm]\hline\hline
  \multicolumn{10}{|l|}{First order IMEX time integration}\\\hline
  \multirow{6}{.4cm}{$1$}
& 20 &  + & 3.3e-01 & + & + & 2.1 & 2.0     & 2.1 & 2.0 \\
& 40 &  + & 1.6e-01 & + & + & 2.0 & 2.0     & 2.0 & 2.0 \\
& 80 &  + & 7.9e-02 & + & + & 2.0 & 1.6     & 2.0 & 2.0 \\
& 160 & + & 3.9e-02 & + & + & 2.0 & 7.9e-01 & 2.0 & 2.0 \\
& 320 & + & 2.0e-02 & + & + & 2.0 & 3.9e-01 & 2.0 & 2.0 \\\hline\hline
 \multirow{6}{.4cm}{$2$}
& 20 &  + & 1.5e-01 & + & + & 2.0 & 2.0     & 2.0 & 2.0 \\
& 40 &  + & 7.8e-02 & + & + & 2.0 & 1.3     & 2.0 & 2.0 \\
& 80 &  + & 3.9e-02 & + & + & 2.0 & 6.7e-01 & 2.0 & 2.0 \\
& 160 & + & 1.9e-02 & + & + & 2.0 & 3.5e-01 & 2.0 & 2.0 \\
& 320 & + & 9.8e-03 & + & + & 2.0 & 1.8e-01 & 2.0 & 2.0 \\\hline\hline
 \multirow{6}{.4cm}{$3$}
& 20 &  + & 1.0e-01 & + & + & 2.0 & 1.5     & 2.0 & 2.0 \\
& 40 &  + & 5.2e-02 & + & + & 2.0 & 8.3e-01 & 2.0 & 2.0 \\
& 80 &  + & 2.6e-02 & + & + & 2.0 & 4.6e-01 & 2.0 & 2.0 \\
& 160 & + & 1.3e-02 & + & + & 2.0 & 2.4e-01 & 2.0 & 2.0 \\
& 320 & + & 6.5e-03 & + & + & 2.0 & 1.2e-01 & 2.0 & 2.0 \\\hline
  \multicolumn{10}{|l|}{Second order IMEX time integration}\\\hline
  \multirow{6}{.4cm}{$1$}
& 20 &  2.4 & 3.2e-01 & 1.5 & 2.4 & 6.6 & 6.3     & 6.5 & 5.1 \\
& 40 &  2.4 & 1.6e-01 & 2.4 & 2.4 & 3.5 & 3.1     & 3.7 & 3.3 \\
& 80 &  2.4 & 7.9e-02 & 2.4 & 2.4 & 2.0 & 1.6     & 2.1 & 2.1 \\
& 160 & 2.4 & 3.9e-02 & 2.4 & 2.4 & 1.4 & 7.8e-01 & 1.5 & 1.4 \\
& 320 & 2.4 & 2.0e-02 & 2.4 & 2.4 & 1.5 & 3.9e-01 & 1.4 & 1.4 \\\hline\hline
 \multirow{6}{.4cm}{$2$}
& 20 &  2.4 & 1.3e-01 & 2.4 & 2.4 & 2.9 & 2.3     & 3.1 & 2.8 \\
& 40 &  2.4 & 7.1e-02 & 2.4 & 2.4 & 1.9 & 1.2     & 1.9 & 1.8 \\
& 80 &  2.4 & 3.7e-02 & 2.4 & 2.4 & 1.7 & 6.0e-01 & 1.5 & 1.4 \\
& 160 & 2.4 & 1.9e-02 & 2.4 & 2.4 & 1.4 & 3.1e-01 & 1.5 & 1.4 \\
& 320 & 2.4 & 9.6e-03 & 2.4 & 2.4 & 1.4 & 1.6e-01 & 1.4 & 1.4 \\\hline\hline
 \multirow{6}{.4cm}{$3$}
& 20 &  2.4 & 9.1e-02 & 2.4 & 2.4 & 2.2 & 1.3     & 2.1 & 1.9 \\
& 40 &  2.4 & 4.8e-02 & 2.4 & 2.4 & 1.8 & 6.8e-01 & 1.6 & 1.4 \\
& 80 &  2.4 & 2.5e-02 & 2.4 & 2.4 & 1.4 & 3.6e-01 & 1.4 & 1.4 \\
& 160 & 2.4 & 1.3e-02 & 2.4 & 2.4 & 1.4 & 2.0e-01 & 1.4 & 1.4 \\
& 320 & 2.4 & 6.5e-02 & 2.4 & 2.4 & 1.4 & 1.1e-01 & 1.4 & 1.4 \\\hline
  \end{tabular}
    \caption{Stability of IMEX upwind gSBP schemes~\eqref{eq:fuldis1} depending on $\left(\theta_{\tt adv},\theta_{\tt diff}\right)$. Values of $\tau=\frac{a^2}{c}\Delta t_{max}$, where $\Delta t_{max}$ is the maximum time step ensuring a non-increasing discrete energy.}
      \label{tab:stability_IMEX}
\end{table}


\paragraph{Numerical study on accuracy of IMEX upwind gSBP schemes} %\label{sec:numexp_accuracy}

In this section, we determine the experimental order of convergence (EOC) of specific IMEX upwind gSBP schemes, particularly for coarse time grids.
Regarding the designed spatial and temporal order of the schemes, we study the cases $N\le 3$ and utilize the IMEX schemes of second order~\eqref{eq:IMEX2} and third order~\eqref{eq:IMEX3}.

First, we reconsider the decreasing exact solution~\eqref{eq:exact_decreasing} of the linear advection-diffusion equation~\eqref{eq:advdiff}.
Table \ref{tab:accuracy1} lists the $L^2$-errors and the derived experimental order of convergence for the various schemes applied to this problem. Here, we compute the numerial solution for two different parameter sets of $a=c=0.1$ and $a=1,c=0.1$ until final time $T = 10$ and use time steps $\Delta t = \mu\Delta x$ for different constants $\mu$ as indicated in the table. 
In most cases, the predicted convergence rate is experimentally confirmed as  the minimum of the expected orders in space and time. One exception is the poor performance in the case of $\left(\theta_{\tt adv},\theta_{\tt diff}\right) = \left(\frac12,0\right)$, i.e. upwind advection fluxes paired with the BR1 diffusion scheme as this choice suffers from the predicted loss of enhanced IMEX stability for larger time steps, particularly in the third order case. A second exception is the case of $\left(\theta_{\tt adv},\theta_{\tt diff}\right) = \left(0,0\right)$, which yields a stable scheme but is subject to order reduction regarding the formally second order scheme.
As a matter of fact, this type of order reduction is a known phenomenon which is prominent in DG schemes employing numerical fluxes of central type in the case of odd polynomial degrees, also observed for the central-type kinetic energy preserving numerical fluxes for compressible fluid flow e.g. in~\cite{Gassner:14,Ortleb:17}.

\begin{table}
 \centering
  \begin{tabular}{|c|c|cccccccc|}\hline
\multirow{3}{1.8cm}{$(a,c), \Delta t$} & \multirow{3}{.4cm}{$K$} &\multicolumn{8}{|c|}{Upwind gSBP discretization $\left(\theta_{\tt adv},\theta_{\tt diff}\right)$}\\[.1cm]
&&  \multicolumn{2}{c}{$\left(\frac12,\frac12\right)$} & \multicolumn{2}{c}{$\left(\frac12,0\right)$} & \multicolumn{2}{c}{$\left(\frac14,\frac14\right)$} & \multicolumn{2}{c|}{$\left(0,0\right)$} \\[.1cm]
&& $L^2$-error & EOC & $L^2$-error & EOC & $L^2$-error & EOC & $L^2$-error & EOC\\\hline
\multicolumn{10}{|l|}{Second order IMEX upwind gSBP schemes}\\\hline
\multirow{5}{1.8cm}{$a=0.1$ $c=0.1$ $\Delta t = 25\Delta x$}
& 20 &  1.01e-01 &  -    & 1.73e-01 & - & 1.01e-01 &-  & 1.46e-01 & - \\  %%% - bedeutet: werte werden groeer mit wachsendem K, erstes - wo wert grer 1 ist.
& 40 &  2.31e-02 & 2.13 & -        &  -   & 2.37e-02 & 2.09 & 5.07e-02 & 1.53\\
& 80 &  6.42e-03 & 1.85 & -        &  -   & 6.60e-03 & 1.84 & 2.27e-02 & 1.16\\
& 160 & 1.55e-03 & 2.05 & -        &  -   & 1.60e-03 & 2.04 & 1.09e-02 & 1.06\\
& 320 & 3.81e-04 & 2.02 & -        &  -   & 3.96e-04 & 2.01 & 5.40e-03 & 1.01\\\hline \multirow{5}{1.8cm}{$a=0.1$ $c=0.1$ $\Delta t = 5\Delta x$}
& 20 &  2.10e-02 &  -   & 1.68e-02 &  -   & 2.27e-02 &  -   & 8.62e-02 & -\\
& 40 &  5.72e-03 & 1.88 & 4.41e-03 & 1.93 & 7.28e-03 & 1.64 & 4.31e-02 & 1.00\\
& 80 &  1.49e-03 & 1.94 & 1.12e-03 & 1.98 & 2.06e-03 & 1.82 & 2.15e-02 & 1.00\\
& 160 & 3.82e-04 & 1.96 & 2.81e-04 & 1.99 & 5.49e-04 & 1.91 & 1.08e-02 & 0.99\\
& 320 & 9.68e-05 & 1.98 & 7.04e-05 & 2.00 & 1.42e-04 & 1.95 & 5.39e-03 & 1.00\\\hline \multirow{5}{1.9cm}{$a=1$ $c=0.1$ $\Delta t = 0.5\Delta x$}
& 20 &  7.93e-02 &  -   & 7.66e-02 &  -   & 7.21e-02 &  -   & 5.61e-02 & -\\
& 40 &  2.03e-02 & 1.97 & 2.01e-02 & 1.93 & 1.98e-02 & 1.86 & 2.79e-02 & 1.01\\
& 80 &  5.12e-03 & 1.99 & 5.10e-03 & 1.98 & 5.06e-03 & 1.97 & 1.39e-02 & 1.01\\
& 160 & 1.29e-03 & 1.99 & 1.28e-03 & 1.99 & 1.29e-03 & 1.97 & 6.97e-03 & 1.00\\
& 320 & 3.25e-04 & 1.99 & 3.20e-04 & 2.00 & 3.31e-04 & 1.96 & 3.48e-03 & 1.00\\\hline \multicolumn{10}{|l|}{Third order IMEX upwind gSBP schemes}\\\hline \multirow{5}{1.8cm}{$a=0.1$ $c=0.1$ $\Delta t = 5\Delta x$}
& 20 &  4.40e-04 &  -   & 3.70e-04 &   -  & 3.93e-04 &  -   & 3.80e-04 & -\\
& 40 &  6.12e-05 & 2.85 & 5.06e-05 & 2.87 & 5.36e-05 & 2.87 & 5.04e-05 & 2.91\\
& 80 &  7.90e-06 & 2.95 & 6.54e-06 & 2.95 & 6.92e-06 & 2.95 & 6.56e-06 & 2.94\\
& 160 & 1.02e-06 & 2.95 & 1.17e-05 &   -  & 8.90e-07 & 2.96 & 8.40e-07 & 2.97\\
& 320 & 1.28e-07 & 2.99 & -        &   -  & 1.12e-07 & 2.99 & 1.06e-07 & 2.99\\\hline \multirow{5}{1.9cm}{$a=1$ $c=0.1$ $\Delta t = 0.5\Delta x$}
& 20 &  6.13e-04 &  -   & -        &   -  & 6.33e-04 &  -   & 6.74e-04 & - \\
& 40 &  7.94e-05 & 2.95 & -        &   -  & 8.08e-05 & 2.97 & 8.34e-05 & 3.01\\
& 80 &  1.05e-05 & 2.92 & -        &   -  & 1.04e-05 & 2.96 & 1.05e-05 & 2.99\\
& 160 & 1.37e-06 & 2.94 & -        &   -  & 1.33e-06 & 2.97 & 1.32e-06 & 2.99\\
& 320 & 1.76e-07 & 2.96 & -        &   -  & 1.68e-07 & 2.98 & 1.65e-07 & 3.00\\\hline
\end{tabular}
  \caption{Accuracy comparison of IMEX upwind gSBP schemes for the exponentially decreasing solution~\eqref{eq:exact_decreasing}. Computations carried out until final time $T=10$.}
  \label{tab:accuracy1}
\end{table}

Furthermore, as in \cite{Wang_etal:15}, we now supplement the linear advection-diffusion equation \eqref{eq:advdiff} by a source term, i.e. we consider the modified advection-diffusion problem
  \begin{align}\label{eq:advdiffsource}
    \begin{split}
    u_t + u_x &= cu_{xx} + g(x,t),\qquad (x,t) \in  (-\pi,\pi)\times (0,T)\,,\\
    u(x,0) &=\sin x\,, x\in (-\pi,\pi)\,.
    \end{split}
\end{align}
The source term is set to $g(x,t)=e^{ct}\left(2c\sin x + \cos x\right)$ in order to provide the exact solution $u(x,t) = e^{ct}\sin x$, which  
is exponentially growing in time.
  
Computations are carried out for a diffusion parameter of $c=0.1$ until final time $T = 10$ with time steps $\Delta t = \mu\Delta x$ with $\mu$ as indicated in Table~\ref{tab:accuracy2}. Again, the anticipated order of converence is reached in all set-ups with two exceptions. Analogously to the exponentially decreasing solution, order reduction occurs for the central scheme $\left(\theta_{\tt adv},\theta_{\tt diff}\right) = \left(0,0\right)$ for $N=1$. Furthermore, the pairing of upwind advection with BR1 diffusion replicates the loss of enhanced IMEX stability for all but the first time step choice in Table~\ref{tab:accuracy2}.

\begin{table}
 \centering
  \begin{tabular}{|c|c|cccccccc|}\hline
\multirow{3}{1.8cm}{$N, \Delta t$} & \multirow{3}{.4cm}{$K$} &\multicolumn{8}{|c|}{Upwind gSBP discretization $\left(\theta_{\tt adv},\theta_{\tt diff}\right)$}\\[.1cm]
&&  \multicolumn{2}{c}{$\left(\frac12,\frac12\right)$} & \multicolumn{2}{c}{$\left(\frac12,0\right)$} & \multicolumn{2}{c}{$\left(\frac14,\frac14\right)$} & \multicolumn{2}{c|}{$\left(0,0\right)$} \\[.1cm]
&& $L^2$-error & EOC & $L^2$-error & EOC & $L^2$-error & EOC & $L^2$-error & EOC\\\hline
\multicolumn{10}{|l|}{Second order IMEX time integration}\\\hline
\multirow{5}{1.8cm}{$N=1$ $\Delta t = \Delta x$}
& 20 &  9.24e-02 & -    & 1.62e-01 & - & 1.44e-01 & - & 8.25e-01 & -\\
& 40 &  2.24e-02 & 2.04 & 4.01e-02 & 2.01 & 2.54e-02 & 2.50 & 4.14e-01 & 0.99\\
& 80 &  6.42e-03 & 1.80 & 1.01e-02 & 1.99 & 5.79e-03 & 2.13 & 2.07e-01 & 1.00\\
& 160 & 1.87e-03 & 1.78 & 2.53e-03 & 2.00 & 2.13e-03 & 1.44 & 1.04e-01 & 0.99\\
& 320 & 5.17e-04 & 1.85 & 6.37e-04 & 1.99 & 7.14e-04 & 1.58 & 5.18e-02 & 1.01\\\hline \multirow{5}{1.9cm}{$N=2$ $\Delta t = 0.5\Delta x$}
& 20 &  6.72e-04 & -    & -        & -    & 1.10e-03 & -    & 1.87e-03 & -\\
& 40 &  1.61e-04 & 2.06 & -        & -    & 1.90e-04 & 2.53 & 2.39e-04 & 2.97\\
& 80 &  3.42e-05 & 2.23 & -        & -    & 3.24e-05 & 2.55 & 3.35e-05 & 2.83\\
& 160 & 6.37e-06 & 2.42 & -        & -    & 5.83e-06 & 2.47 & 5.70e-06 & 2.56\\
& 320 & 1.28e-06 & 2.32 & -        & -    & 1.22e-06 & 2.26 & 1.20e-06 & 2.25\\\hline \multirow{5}{1.9cm}{$N=3$ $\Delta t = 0.3\Delta x$}
& 20 &  1.04e-04 & -    & -        & -    & 1.03e-04 & -    & 2.54e-04 & -\\
& 40 &  2.57e-05 & 2.02 & -        & -    & 2.57e-05 & 2.00 & 3.87e-05 & 2.71\\
& 80 &  6.43e-06 & 2.00 & -        & -    & 6.43e-06 & 2.00 & 7.37e-06 & 2.39\\
& 160 & 1.61e-06 & 2.00 & -        & -    & 1.61e-06 & 2.00 & 1.67e-06 & 2.14\\
& 320 & 4.02e-07 & 2.00 & -        & -    & 4.02e-07 & 2.00 & 4.06e-07 & 2.04\\\hline \multicolumn{10}{|l|}{Third order IMEX time integration}\\\hline \multirow{5}{1.9cm}{$N=2$ $\Delta t = 0.5\Delta x$}
& 20 &  5.55e-04 & -    & -        & -    & 1.04e-03 & -    & 1.83e-03 & -\\
& 40 &  1.41e-04 & 1.98 & -        & -    & 1.74e-04 & 2.58 & 2.26e-04 & 3.02\\
& 80 &  2.90e-05 & 2.28 & -        & -    & 2.68e-05 & 2.70 & 2.81e-05 & 3.01\\
& 160 & 4.52e-06 & 2.68 & -        & -    & 3.72e-06 & 2.85 & 3.51e-06 & 3.00\\
& 320 & 6.27e-07 & 2.85 & -        & -    & 4.89e-07 & 2.93 & 4.39e-07 & 3.00\\\hline \multirow{5}{1.9cm}{$N=3$ $\Delta t = 0.3\Delta x$}
& 20 &  1.74e-05 & -    & -        & -    & 1.46e-05 & -    & 2.32e-04 & -\\
& 40 &  1.82e-06 & 3.26 & -        & -    & 1.63e-06 & 3.16 & 2.90e-05 & 3.00\\
& 80 &  1.65e-07 & 3.46 & -        & -    & 2.00e-07 & 3.03 & 3.62e-06 & 3.00\\
& 160 & 1.47e-08 & 3.49 & -        & -    & 1.84e-08 & 3.44 & 4.53e-07 & 3.00\\
& 320 & 1.49e-09 & 3.30 & -        & -    & 1.71e-09 & 3.43 & 5.66e-08 & 3.00\\\hline
\end{tabular}
  \caption{Accuracy comparison of IMEX upwind gSBP schemes for the exponentially growing solution \eqref{eq:advdiffsource} with $c=0.1$. Computations carried out until final time $T=10$.}
  \label{tab:accuracy2}
\end{table}


\paragraph{Numerical results for the viscous Burgers' equation}

Finally, we study the behavior of IMEX upwind gSBP schemes with respect to the viscous \mbox{Burgers'} equation
$$u_t(x,t) + \left(\frac{1}{2}u^2(x,t)\right)_x = c u_{xx}(x,t)\,,\ c = 0.1,$$
as a prototype containing nonlinear convective terms, supplemented by the initial condition
$$u(x,0) = u_0(x) = \sin x,\quad x\in[-\pi,\pi]$$
and periodic boundary conditions.
Figure~\ref{fig:IMEXDGvisBurg_BR1} shows the initial solution as well as the numerical solution for $c=0.1$ at a given output time $T$. Two different upwind gSBP schemes with $N=2$ are employed within the following semi-discrete formulation of the viscous Burgers' equation,
\begin{align}\label{eq:upwindSBP_nonlin}
\frac{d\vecu}{d t} + \left(\frac{\matrixD^++\matrixD^-}{2}\right)\vecf - \|\vecu\|_\infty\matrixM^{-1}\matrixC\vecu = c\matrixD_2\vecu\,,
\end{align}
with the vector of flux values $\vecf = \frac12\vecu^2$ and the matrix $\matrixC$ as in~\eqref{eq:SBPprop_upwind_2}. This semi-discrete form is similar to the one used in~\cite{Stiernstroem:2021} for the inviscid Burgers' equation but is based on the equation in conservative form instead of the skew-symmetric formulation employed in~\cite{Stiernstroem:2021}. If $\matrixD^-$ is constructed from a DG scheme using upwind advection fluxes, the semi-discretization~\eqref{eq:upwindSBP_nonlin} is equivalent to the use of global Lax-Friedrichs~(LF) fluxes for the nonlinear convective term and will be labeled accordingly. If $\matrixD^-$ is constructed from central fluxes, we have $\matrixC=\nullMat$ and thus obtain a central discretization of the inviscid fluxes.
For time integration, the second order IMEX scheme~\eqref{eq:IMEX2} is applied with a time step size of $\Delta t = 0.1$. This same time step is used on two different grids with $K = 50$ and $K=100$ elements, respectively. First, we compute approximate solutions with the upwind gSBP scheme consisting of BR1 diffusion paired with global LF fluxes, i.e. the first of the above mentioned variants for $\matrixD^-$. Since for linear advection, global LF fluxes reduce
to upwind fluxes, the global LF fluxes can be viewed as a generalization of upwind fluxes to the nonlinear case. For this set-up, the simulations needs to be stopped at $T=1.8$ and $T=1$ due to the expected lack of stability, as shown in the top row of Figure~\ref{fig:IMEXDGvisBurg_BR1}. These results indicate that also for nonlinear problems, a pairing of the BR1 scheme with upwind-type fluxes might be less favorable in terms of stability in the context of IMEX advection-diffusion splitting. A remedy is provided in the bottom row of Figure~\ref{fig:IMEXDGvisBurg_BR1} by using central fluxes together with BR1. The corresponding stable numerical solution is shown at output time $T=2$. This solution is visually indistinguishable from a reference solution computed on a fine grid of $K=1000$ elements using the upwind gSBP scheme defined by $\left(\theta_{\tt adv},\theta_{\tt diff}\right) = \left(\frac12,\frac12\right)$ and $N=3$ combined with third order IMEX time integration using a small time step of $\Delta t = 0.01$. In addition, refining the grid does not necessitate choosing smaller time steps for this combination of central first-derivative and second-derivative gSBP operators.

\begin{figure}
   \centering
  \begin{subfigure}[b]{0.45\textwidth}
    \centering
    \includegraphics[width=.9\textwidth]{BR1_LF_K50T1.80.eps}
    \caption{Global LF fluxes, $K=50,\ T=1.8$.} %\theta_{\tt adv} = \frac12,\
  \end{subfigure}
  \begin{subfigure}[b]{0.45\textwidth}
    \centering
    \includegraphics[width=.9\textwidth]{BR1_LF_K100T1.00.eps}
    \caption{Global LF fluxes, $K=100,\ T= 1$.}
  \end{subfigure}

  \begin{subfigure}[b]{0.45\textwidth}
    \centering
    \includegraphics[width=.9\textwidth]{BR1_central_K50T2.00.eps}
    \caption{Central fluxes, $K=50, \ T = 2$.} %\theta_{\tt adv} = 0,\ 
  \end{subfigure}
  \begin{subfigure}[b]{0.45\textwidth}
    \centering
    \includegraphics[width=.9\textwidth]{BR1_central_K100T2.00.eps}
    \caption{Central fluxes, $K=100, \ T = 2$.}
  \end{subfigure}
  \caption{Third order IMEX upwind gSBP approximation of the viscous Burgers' equation until final time $T=2$ using BR1 diffusion fluxes ($\theta_{\tt diff} =0$) and upwind fluxes for advection ($\theta_{\tt adv} =\frac12$, top row) compared to central fluxes ($\theta_{\tt adv} =0$, bottom row).}\label{fig:IMEXDGvisBurg_BR1}
\end{figure}


\section{Conclusion and Outlook} \label{sec:conclusion}

The current fully discrete energy stability analysis for linear advection-diffusion problems discretized by upwind gSBP schemes in space and IMEX-RK schemes in time based on advection-diffusion IMEX splitting demonstrates that if the employed  upwind gSBP operators are chosen to fulfill $\matrixD_2=\matrixD^-\matrixD^+$, the allowable time step size is independent of grid refinement, although the advective terms are discretized explicitly.
In one space dimension, upwind gSBP schemes represent a general framework including standard DG schemes, thus the present results also hold for the LDG scheme combined with upwind advection fluxes. Furthermore, the analysis in this work is based on the discrete energy provided by the corresponding SBP norm matrix and does not involve inverse constants depending on the discretization order in space, therefore the resulting time step bound is independent of the polynomial degree of the approximate solution.
While previous work for DG schemes has demonstrated that the combination of upwind advection fluxes with the BR1 diffusion scheme does not provide unconditional stability in the sense of grid-independent time step restrictions, the current work shows that central advection fluxes are compatible with BR1. However, for this kind of overall central scheme, additional artificial dissipation might be necessary for discontinuous initial conditions and in the nonlinear convection-dominated case. These additional artificial
dissipation terms could again be discretized either implicitly or explicitly within an IMEX approach.
Finally, the numerical results for the nonlinear viscous Burgers' equation in this work indicate that a compatible pairing of first-derivative and second-derivative upwind gSBP operators is also required for nonlinear conservation laws with dissipative terms, if enhanced IMEX stability is desired. This should be investigated more closely with respect to a discrete energy analysis which might require skew-symmetric formulations as in~\cite{Fisher_etal:2013,Stiernstroem:2021} instead of the divergence form of the given conservation law.

\printbibliography

\end{document}

   
   
   
   
   
   
   
   
   

   
   
   
   
   
   
   
   
   

\section{Experiment}
In this section, we demonstrate the characterization capabilities of labeled subgraph entropy kernel with several real-world datasets and perform four experiments to illustrate its multifaceted functions. On the one hand, we qualitatively analyze whether the subgraph entropy is effective in abnormal event detection of time-varying financial networks. On the other hand, we need a quantitative analysis to evaluate the effect of the proposed kernel approach. Firstly, we use subgraph entropy to evaluate the vital events within a financial time series. Secondly, we conduct Principal Component Analysis (PCA) on subgraph entropy-based graph representations and intuitively demonstrate the separation effect of our kernel. Thirdly, we perform graph classification task with subgraph entropy kernel and compare the results with several state-of-the-art methods. Finally, we design an ablation experiment to investigate the function of different physical parameters and study the effect of different topologies. The contents are as follows.

\subsection{Dataset}
\input{data_intro_table}
\subsubsection{Financial Networks}
We first validate the effectiveness of our approach on time-varying financial networks extracted from the New York Stock Exchange (NYSE) dataset\cite{silva2015modular} \cite{ye2015thermodynamic}, which contains 347 stocks with their daily closing prices over 6004 trading days from January 1986 to February 2011. In order to characterize the financial time series as a dynamic network, we use a fixed-size time window and slide it from the 29th trading day to the 6004th trading day. Each window encapsulates a set of 347 co-evolving daily stock price time series over 28 days. We compare stocks as network nodes and compute the correlation coefficients between each pair of stocks as their edge weight. Specifically, if the maximum absolute value of the weight is among the highest 5\%, we create connections between these pairs of nodes. Based on this method, we generate a family of time-varying financial networks with a fixed number of 347 vertices and varying edge structures over 5976 trading days. 
\subsubsection{Biochemistry Datasets}
The performance of the subgraph kernel has also been demonstrated on four real-world biochemistry datasets. 
Specifically, MUTAG \cite{debnath1991structure} is a collection of heteroaromatic nitro and mutagenic aromatic compounds, and the goal is to predict their mutagenicity on Salmonella typhimurium. It includes 188 samples of chemical compounds, which are labeled according to whether there is a mutagenic effect on a special bacteriaâ€”the nodes and links representing atoms and the chemical bonds, respectively.
PROTEINS is a dataset of proteins that are classified as enzymes or non-enzymes. Nodes represent the amino acids, and two nodes are connected by an edge if they are neighbors in the amino-acid sequence or in 3D space. It has three discrete labels, which represent helix, sheet, or turn.
D\&D is a dataset of 1178 protein structures obtained from \cite{dobson2003distinguishing}, classified into enzymes and non-enzymes. Each protein is represented as a graph whose nodes correspond to amino acids, and two nodes are linked by an edge if they are less than 6 Angstroms apart.
The Predictive Toxicology Challenge (PTC) dataset consists of 344 organic molecules 19 node features. Graphs are marked according to their carcinogenicity on male and female mice and rats. 
More detailed contents about the datasets are displayed in Table \ref{tab:datasets}


\subsection{Evaluation of The Entropy Time Series}
\begin{figure*}
    \label{fig:subgraph_vs_von}
    \includegraphics[width=1\textwidth]{fig/subgraph_vs_von.pdf}
    \caption{This figure shows the subgraph entropy of three types graphlet. The fluctuations of the first two curves are pronounced between political or economic events, while the third curve is smooth during the same period. When financial crisis happened frequently, the subgraph entropy of graphlet type 2 could be well separated, while the first two values are confusing.
}
\end{figure*}
In this experimental stage, our target is to evaluate the expressiveness of subgraph entropy on the time evolution network sequence. To analyze the time-varying financial market crisis or risk, change point detection has played an important role in identifying abrupt changes in the time series properties. For the mentioned 5976 trading days, we calculate the subgraph entropy (based on graphlet of type-2) and the Von Neumann entropy for each sample graph. According to Passerini and Severini \cite{2012The}, for a graph $G$ with adjacency matrix $A$, the von Neumann entropy of the network can be expressed as
$$S_v(G)=-Tr[\frac{\tilde{L}}{\lvert V\rvert}\ln\frac{\tilde{L}}{\lvert V\rvert} ]$$
as $\tilde{L}=D^{-1/2}(D-A)D^{-1/2}$ is the normalised Laplacian matrix, where $V$ represents the number of vertices, and $D$ is the degree matrix of $G$.

At the graph-theoretic level, this quantity may be interpreted as a measure of regularity; it tends to be larger in relation to the number of connected components, long paths, and nontrivial symmetries. Next, we use a 2-D scatter plot to show the trend of these two entropy values for the stock network, where the x-axis corresponds to the date time, and the y-axis corresponds to the subgraph entropy values and the Von Neumann entropy values. Figure \ref{fig:subgraph_vs_von} shows that both the indexes are sensitive to the financial crisis since both curves are disturbed significantly in the circles. The financial crisis includes but is not limited to Black Monday (1987.10-1988.1), Asian Financial Crisis (1997.7-1997.10), Dot-com Bubble (2000.3), Madrod Bombings (2004.3). Subgraph entropy values usually lead to a rapid increase even several days before the significant financial event. Compared to von Neumann entropy, the curve of our subgraph entropy appears smoother during normal trading days. It meant that subgraph entropy resulted in a higher recognition degree between outliers and normal trading days.

Based on the financial risk theory stated by Haubrich \cite{haubrich2013quantifying}, the financial crisis is usually caused by a set of most correlated stocks with fewer uncertainties. In other words, the financial networks are constructed by computing the correlation between pairwise stock time series, so the graphs contain a wealth of information about partial correlation (i.e., subgraph). When a financial crisis occurs, the network structure experiences dramatic changes. Therefore, our subgraph entropy values are able to promptly capture the structural changes and even provide early warning before the crisis occurs.



\subsection{Subgraph Kernel Embeddings from KPCA}
Although Fig \ref{fig:subgraph_vs_von} indicates that our subgraph entropy is effective for identifying the extreme events in the evolution of the time-varying financial networks, the indicator we adopt can only represent the network characteristics in a one-dimensional pattern space, which ignores most of within high dimensional information in Hilbert space. To better explore the performance of the proposed kernel, we perform kernel Principle Component Analysis (KPCA) \cite{witten2002data} on the kernel matrix of the financial networks and biochemistry graphs. After embedding each graph into a high-dimension vector with algorithm 1, we scatter the visualized results through the first three principal components. 

First, we scatter the trading days around a financial crisis to find more detail. The green spots respectively represent ninety trading days before and after Black Monday (October 1987). Specifically, we use a black triangle and a red inverted triangle to mark Black Monday and the day before, respectively. As Figure \ref{fig:black_monday} shows, the Black Monday and even the day before are marked as outliers, which can be detected by the first three principal components of subgraph entropy. As for the biochemistry dataset, we carry out a similar experiment. The positive and negative samples of MUTAG are marked as blue and red triangles, respectively. From Figure \ref{fig:mutag} we can see that most of the graphs are separated according to their labels, and only a few samples are mixed in the three-dimensional space. Both the results show that subgraph entropy is an effective statistical method for anomaly detection of financial and biochemistry networks.   

\begin{figure*}
\label{fig3}
\centering
\subfigure[Black monday]{
\label{fig:black_monday}
\includegraphics[width=0.4\textwidth]{fig/pca_black_monday.pdf}
}
\quad
\subfigure[MUTAG]{
\label{fig:mutag}
\includegraphics[width=0.4\textwidth]{fig/mutag_pca.pdf}
}
\caption{\ref{fig:black_monday} demonstrates the dispersion of 90 financial networks around Black Monday. \ref{fig:mutag} shows the dispersion of all graphs within MUTAG.}
\end{figure*}

\subsection{C-SVM on Graph Classification}
\subsubsection{Baseline Methods}
We compare our proposed kernel LSEK with four alternative state-of-the-art methods in graph classification tasks. The methods used for comparisons include (1) Weisfeiler-Lehman subtree kernel (WL) \cite{shervashidze2011weisfeiler} with setting the depth of subtree to 2 as it could increase the feature space exponentially, (2) the attributed graph kernel from the Jensen-Tsallis $q-$differences connected with $q=2$ (JTQK) \cite{bai2014attributed}, (3) the shortest-path kernel (SPGK) \cite{borgwardt2005shortest}, (4) the graphlet count kernel (GK) \cite{shervashidze2009efficient} with setting the size of graphlets to 7 since it could exhibit the sparsity problem, (5) the shortest path kernel based on core variants (CORE SP) \cite{nikolentzos2018degeneracy}, (6) the random walk graph kernel (RWGK) \cite{kashima2003marginalized}.

\subsubsection{Classification Accuracies}
In this part, we repeat the graph classification experiment several times for each kernel and then record the average classification accuracies and standard errors. For the alternative methods, we follow the parameter setting from their original papers. For our method, we perform validation on each dataset and select the corresponding optimal hyper-parameters. Specifically, we compute the classification accuracies using the sklearn implementation of C-Support Vector Machines (C-SVM). As shown in Table \ref{tab:graph_classification}, we demonstrate the average and standard error using 10-fold cross-validation. For the sake of fairness, all the mentioned methods are run on the same computing device. 
(a)	On the MUTAG dataset, the accuracy of our LSEK evidently overcomes those of the rest of the kernels, and the CORE SP method is competitive with our method.
(b)	On the PROTEINS dataset, SEK outperforms that of all the rest of the kernels except
(c)	On the D\&D dataset, the accuracy of the LSEK method is the best. However, our method is time-consuming due to the number of vertice and node label in this dataset being rather large (some graphs contains thousands of vertices and 88 kinds of node label).
(d)	On the PTC dataset, the accuracy of LSEK surpasses the alternative kernels and is three percentage points higher than the best of the other kernels selected. Remarkably, our method clearly outperforms GK because the latter contains less local semantic information.

The experimental results show that the subgraph kernel obtains higher performance on precision at the expense of little computation time. The results suggest that our method performs better on graph classification tasks than many similar state-of-the-art kernel methods.

\input{graph_classification_tab}

\subsection{Parameter Setting}
To explore the influence of different parameters in the subgraph kernel, we devise two ablation experiments in this subsection. Firstly, we separately record the characterization effect of different types of subgraph in mentioned time-varying financial network sequence. The view shown in Figure \ref{fig:ablation_financial} allows us to see that the curve of graphlet-type-2 fluctuates more wildly around the financial crisis, and it shows smoothness in non-crises regions. The main cause of the phenomena is that this type of graphlet appeared with relentless frequency in each trading day, while the frequency of other graphlets is much less deterministic in different situations. The result also suggests that closer relationships between the stocks are more sensitive to global political or economic events.
 
\begin{figure*}
    \label{fig:ablation_financial}
    \includegraphics[width=1\textwidth]{fig/ablation_financial.pdf}
    \caption{The characterization effect of Labeled Graphlets with different topologies.}
\end{figure*}

Then, we quantitatively analyze each mentioned subgraph with two biochemistry datasets. To better illustrate the efficiency of each topology, we design the experiment from two perspectives: exclusion and selection. The former one focuses on one specific graphlet, while the latter counts the number of all the other graphlets. As Figure \ref{fig:ablation_mutag} shows, the "exclusion" method could understandably perform to higher accuracy. Notably, the single type of graphlet also shows great characterization capability. The reason behind this phenomenon is that each labeled subgraph represents a specific chemical atomic group, which can effectively identify the graph type.

\begin{figure}
\begin{center}
\label{fig:ablation_mutag}
\includegraphics[width=0.4\textwidth]{fig/ablation.pdf}
\caption{We compare the effect of each subgraph in two datasets, and record their accuracy as these four curves above. Each point represents the corresponding effect of selecting or excluding one specific type of graphlet.}
\end{center}
\end{figure}







  
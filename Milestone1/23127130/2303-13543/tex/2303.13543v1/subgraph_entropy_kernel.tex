\section{Labeled Subgraph Entropy Kernel}
As mentioned above, our work is consists of three parts: subgraph counting algorithm, subgraph based entropy calculating and kernel definition. In this section, we provide a detailed description of our statistical process. We propose a network statistic element called Labeled Graphlet and design the corresponding searching algorithm. Next, we demonstrate the re-derivation process of subgraph-based cluster expansion and calculate the global entropy of the network. Finally, we define the subgaph entropy kernel and prove its corresponding required properties. In order to make our description clearer, we demonstrate the whole process of calculating subgraph entropy embedding in Algorithm \ref{alg:entropy}.


\input{variate_tab}

\input{entropy_algorithm}

\subsection{Labeled Subgraph Counting}
Graphlet is known as a representation of local structure, but existing graphlet-based statistical methods consider only topology information. Not only that, existing enumeration algorithms are limited by graphlet scale because of expensive computation costs. In attempting to solve the problems, we proposed a novel subgraph form called {\it Labeled Graphlet}. Labeled Graphlets are only marked by their starting node to simplify the complexity of the subgraph class set. As \ref{fig:graphlet_vs_motif} shows, Labeled Graphlet would tell the difference between two pairs of substructures in wireframes. Apparently, Labeled Graphlets share the same label-set $L$ with network nodes. Compared to existing graphlet statistics, our method provides additional details with little extra cost.

Generally speaking, subgraphs can be classified into three groups according to their structural characteristics: trees, paths, and circuits. Considering the variation of size, finding all subgraphs is an NP-hard problem. To simplify this procedure, we adopt twelve types of topologies as \ref{fig:graphlet_types} shows. Considering the derivation or mutually exclusive relationship between graphlets, our counting process follows the “grow” principle in a breadth-first manner. For small-scale subgraphs of size $k=3$ or $k=4$, we employ the Parallel Parameterized Graphlet Decomposition (PGD) algorithm. PGD breaks down the global searching problem into several local tasks and then merges the results for all edges. Merging and searching over low-dimensional spaces of edge neighborhoods is clearly more efficient than searching over the global high-dimensional space \cite{ahmed2015icdm}.

\begin{figure*}
\centering
\subfigure[Difference between motif and graphlet]{
\label{fig:graphlet_vs_motif}
\includegraphics[width=0.4\textwidth]{fig/graphlet_motif.pdf}
}
\quad
\subfigure[All twelve types of the structures mentioned in this paper.]{
\label{fig:graphlet_types}
\includegraphics[width=0.4\textwidth]{fig/graphlet_type.pdf}
}
\caption{\ref{fig:graphlet_vs_motif} shows the different between motif and labeled graphlet, as the former couldn't distinguish subtrees with different root. \ref{fig:graphlet_types} demonstrates all the graphlet topology in this paper.}
\end{figure*}

For the subgraphs of size $k\geq 5$, we design a dynamic programming algorithm to improve computing efficiency. The pseudocode of this process is shown in Algorithm \ref{alg:counting}. Starting from saving the first order neighbor sets of each node $a\in V$, we select tree-shaped subgraphs which meet the condition of degree. We have noticed that high-order neighbor sets can be synthesized by existing neighbor sets. For example, a 2-hop path consists of two 1-hop paths, and an 8-hop path consists of two 4-hop paths. Thus, we replace large-scale traversal with exponential steps superposition, which remarkably enhances searching efficiency with little extra space. 
The computational complexity of our algorithm is determined by line 3 of Algorithm \ref{alg:counting}, which is no more than $|V|^3$.

\input{counting_algorithm}

\subsection{Subgraph Cluster Expansion}
As mentioned above, the classical cluster expansion can be used to describe the motif structure. In order to solve this problem, we present the subgraph expansion algorithm, which omits the integral of a single node integral. In this section, we make an analogy between network subgraphs and interacting particles in the thermodynamic gas model. Thus, we can express configuration integral from the perspective of network topology, especially the network subgraph. According to this thought, Zhang et al.\cite{zhang2020graph} map the network motifs to the classical cluster expansion, then calculate the motif configuration integral and the single node integral, respectively. For graph $G$ with node set $L_v$, they re-write partition function $Z$ for the network as a sum over the individual motif contributions $z_v$,
\begin{equation}
\label{f1}
\begin{split}
    Z&=\sum \limits_v\prod \limits_{n_v}^{|L_v|}\frac{1}{n_v!}\{rq_v\}^{n_v}=\sum \limits_{n_v}z_v\\
    &=\sum \limits_{n_v} \frac{1}{n_v!}(rq_v)^{n_v}\frac{1}{N-l_vn_v}(rq_0)^{N-l_vn_v}\\
\end{split}
\end{equation}
where $r$, $n_v$, $l_v$ and $q_v$ is the radial variable, occurred frequency, number of nodes and the configuration integral (the product overall edges connecting nodes) of the $v^{th}$ motif. According to the definition presented above, motifs describe global information of networks by constructing graph representations, while graphlets attach more attention to local graph attributes. One main difference between these two statistic elements is whether the counting algorithms reuse nodes. The former one enumerates independent motifs and abandons individual nodes; The latter one count preset structures from each node while overlapping searching is inevitable. Thus, there are probably no singleton nodes left under the graphlets enumeration process. In other words, the item $N-l_vn_v$ in formula \ref{f1} can be 0 or even negative, and it becomes meaningless in the circumstances. Specifically, the configuration integral of $v^{th}$ graphlet (or the broader concept "subgraph") $q_v$ can be calculated with only connected nodes:

\begin{equation}
    q_v=\frac{1}{l_v!r}\zeta_v=\frac{1}{l_v!r}\epsilon^{d_v}
\end{equation}
$\zeta_v$ is the configuration integral obtained through the product over all edges connecting nodes, and $d_v$ is the edges number of the $v^{th}$ motif. According to the Mayer function, the configuration integral $\epsilon$ for one edge is given by
\begin{equation}
\begin{split}
    \epsilon&=\int^\infty_0(e^{-\beta v(r)}-1)dr\\
    &=\exp\left[\beta\sum\limits^{r_{max}}_{r=r_{min}}e^{-4\epsilon\left[(\frac{\sigma}{r})^{12}-(\frac{\sigma}{r})^{6}\right]}\right]+R
\end{split}
\end{equation}

where $\beta=\frac{1}{T}$ is the inverse temperature, $\sigma$ is scale parameter and $R=-\frac{r_{max}-r_{min}}{\Delta r}$. It is important to note that we confine the interval of integration to $[r_{min},r_{max}]$. The graph entropy of $v^{th}$ pattern consists of two parts: configuration integral $z_v$ and average energy $\langle U_v\rangle$.

\begin{equation}
    \begin{split}
        S_v&=\ln z_v+\beta\langle U_v\rangle\\
        &=n_v\left\{d_v\left[ \log\epsilon-\beta\frac{\epsilon-R}{\epsilon}\right]-l_v\log l_v -\log n_v \right\}\\
        %&=n_v\{ d_v\log\epsilon-l_v\log l_v-\log n_v\}+\beta\frac{n_vd_vpe^\beta}{pe^\beta+R}\\
    \end{split}
\end{equation}
where $\epsilon=pe^\beta+R$.
%the expansion formula of $v^{th}$ subgraph is

\subsection{Labeled Subgraph Entropy Kernel}
In this section, we introduce the concept of Labeled Subgraph Entropy Kernel. We replacing the occurrence frequency of graphlet with corresponding graph entropy. We provide a detailed framework description of our method and prove necessary kernel properties.
Before we define our novel kernel, we here summarize key concepts and notations. Graph $G=(V,E)$, where $V$ is a set of ordered vertices and $E\subseteq (V\times V)$ is a set of edges. If there is a mapping $V \Rightarrow L$ that assigns labels from a set $L$ to vertices, we call $G$ a labeled graph. $G$ is called undirected if $(vi, vj)\in E$ iff $(vj, vi)\in E$ otherwise, it is referred to as directed. Although many of our techniques are applicable to both directed and undirected graphs, for ease of exposition, we will exclusively deal with undirected graphs in this paper.

\textbf{Definition 1}: As for graph $G=(V,E,L)$, the corresponding labeled subgraph entropy representation around $v$ types of graphlet is
\begin{equation}
    S(G)=(S_1^1,S_2^1,...S_v^L)^T
\end{equation}

where $S_v^L$ denotes the thermodynamics entropy value measured by $v^{th}$ graphlet starting from node with label $L$. As algorithm \ref{alg:entropy} shows, $S_v^L=0$ iff the number of corresponding labeled graphlet is 0.

\textbf{Definition 2}: Let $G_1=(V_1,E_1,L)$ and $G_2=(V_2,E_2,L)$ be a pair of sample graphs. The subgraph entropy kernel $k_{SE}^{(v)}$ adopting $v$ types of graphlet is

\begin{equation}
\label{f7}
    k_{SE}^{(v)}(G_1,G_2)=k(S(G_1),S(G_2))
\end{equation}

where $k$ is the kernel function such as the Linear Product, Sigmoid Function, Polynomial Kernel Function or Radial Basis Function.

\textbf{Theorem 1}: The Labeled Subgraph Entropy Kernel $k_{SE}^{(v)}$ is symmetrical and positive definite.

\textbf{Proof}: We firstly embed two graphs into Euclidean space by formula \ref{f7}, and then calculate the kernel value using the above functions. Obviously, this process computes the inner products of two vectors in Hilbert space. Thus our Labeled Subgraph Entropy Kernel is symmetrical and positive definite.

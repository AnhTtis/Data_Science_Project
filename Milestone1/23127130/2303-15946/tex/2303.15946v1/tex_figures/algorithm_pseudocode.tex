\begin{algorithm}
\caption{\label{alg:gccf} IGCCF}
\SetKwInOut{Input}{Input}
\SetKwInOut{Output}{Output}
\
%\Input{Item embeddings $\textbf{X}_{I\times F}$}\
\Input{Propagation matrix $\textbf{P}_{I\times I}$}\
\Input{User interaction matrix $\tilde{\textbf{R}}_{U\times I}$}\
\Input{Convolution depth $k$}\
\Input{User-profile dropout $p$}\
\Output{Item embeddings $\textbf{X}_{I\times F}$}\

$\textbf{X} \leftarrow $ initialize(\textbf{X}) (${I\times F}$ item embeddings)\;
\While{not converged}{
$B \leftarrow \{(u, i^+, i^-)\}$ sample mini-batch of triplets\;

\For{$j = 1,\dots, k$}{
    $\textbf{X} \leftarrow \textbf{P}\textbf{X}$
}
$\tilde{\textbf{R}} \leftarrow$  user-profile dropout ($\tilde{\textbf{R}}$, $p$)\;

$\textbf{U} \leftarrow \tilde{\textbf{R}}\textbf{X}$\;
$\nabla L(\textbf{X} )\leftarrow$ compute gradients $L_{BPR}(\textbf{X}$,$\textbf{U}$,$B$)\;
$\textbf{X} \leftarrow$ apply gradients($\nabla L(\textbf{X})$)
}
\end{algorithm}
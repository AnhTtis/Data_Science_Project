
\definecolor{androidcolor}{HTML}{D6E8D5}
\definecolor{windowscolor}{HTML}{DAE8FC}
\definecolor{webcolor}{HTML}{E1D5E7}
\definecolor{myyellow}{HTML}{FFE6CC}

\begin{figure*}
    \centering

\smallskip

% \footnotesize
% \begin{picture}(0,0)(0,0)
% \hbox{\put(-28pt,0pt){\makebox[][l]{Platform\kern 1.8cm Input data\kern 1.8cm Papers}}}
% \end{picture}
% \bigskip
% \draw[green] (0,0) rectangle (2,2)node[midway]{green};

\tikzset{
    basic/.style  = {draw, text width=3cm, align=center, fill=myyellow, font=\sffamily, rectangle},
    root/.style   = {basic, rounded corners=2pt, thin, align=center, fill=green!30},
    androidnode/.style = {basic, thin, rounded corners=2pt, align=left, fill=androidcolor, text width=8em, align=center},
    windowsnode/.style = {basic, thin, rounded corners=2pt, align=left, fill=windowscolor, text width=8em, align=center},
    webnode/.style = {basic, thin, rounded corners=2pt, align=left, fill=webcolor, text width=8em, align=center},
    xnode/.style = {basic, thin, rounded corners=2pt, align=center, fill=blue!20,text width=2.5cm,},
    edge from parent/.style={draw=black, edge from parent fork right}

}
%
\tiny
\begin{forest} for tree={
    grow=east,
    growth parent anchor=west,
    parent anchor=east,
    child anchor=west,
    edge path={\noexpand\path[\forestoption{edge},->, >={latex}] 
         (!u.parent anchor) |- +(0pt,0pt) |-  (.child anchor) 
         \forestoption{edge label};}
}
% l sep is used for arrow distance
[Malware Detection with \\Graph Representation Learning, basic,  l sep=15mm,
    [Web-based Detection, webnode,  l sep=10mm,
        [Network Flow Graph, webnode,  l sep=10mm,
            [\cite{zhou2020automating, carpenter2021detecting, zhao2020multi, li2022graphddos}, webnode]
         ],
        [Domain Data, webnode,  l sep=10mm,
            [\cite{he2019malicious, sun2020deepdom, zhang2021attributed}, webnode]
         ],
         [HTML/JS Code, webnode,  l sep=10mm,
            [\cite{ouyang2021phishing, secrypt22, liu2022graphxss, fang2022jstrong}, webnode]
         ]
        ]
    [Windows-based Detection , windowsnode,  l sep=10mm,
        [System Entity Graph, windowsnode,  l sep=10mm,
            [\cite{hung2019malware, wang2019heterogeneous, fan2020novel, liu2022fewm}, windowsnode]
         ],
        [FCG, windowsnode,  l sep=10mm,
            [\cite{jiang2018dlgraph, oliveira2019behavioral, zhang2020spectral, li2022intelligent, li2022dmalnet, wang2021hierarchical, ling2022malgraph}, windowsnode]
         ],
        [CFG, windowsnode,  l sep=10mm,
            [\cite{yan2019classifying, xu2021hawkeye, wang2021hierarchical, ling2022malgraph, herath2022cfgexplainer}, windowsnode]
         ],
         ]
    [Android-based Detection , androidnode,  l sep=10mm,
        [Network Flow Graph, androidnode,  l sep=10mm,
            [\cite{busch2021nf, liu2023nt, norouzian2021hybroid, xu2021hybrid}, androidnode]
         ],
         [System Call Graph, androidnode,  l sep=10mm,
            [\cite{john2020graph}, androidnode]
         ],
         [PDG, androidnode,  l sep=10mm,
            [\cite{xu2021android}, androidnode]
         ],
         [FCG, androidnode,  l sep=10mm,
            [\cite{zhu2018android, feng2020android, cai2021learning, xu2021detecting, vinayaka2021android, errica2021robust, catal2021malware, wu2022deepcatra, lo2022graph, gunduz2022malware, lu2022robust, yumlembam2022iot, hou2017hindroid, gao2021gdroid, hei2021hawk, xu2021android, xu2021hybrid, norouzian2021hybroid}, androidnode]
         ],
         [CFG, androidnode,  l sep=10mm,
            [\cite{norouzian2021hybroid,xu2021hybrid,fairbanks2021identifying}, androidnode]
         ]
         ]]
\end{forest}

    \caption{Categorization of current state-of-the-art papers in malware detection with graph representation learning. In this survey, we classify papers by platform and by input data structure. Android-based detection is presented in Section \ref{sec:android}, whereas Windows and Web detection are presented in Sections \ref{sec:windows} and \ref{sec:web}, respectively.}
    \label{fig:lit_surv}
\end{figure*}

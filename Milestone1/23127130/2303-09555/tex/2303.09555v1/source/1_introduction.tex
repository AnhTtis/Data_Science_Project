\section{Introduction}
\label{sec:introduction}

% Skeleton:
% \begin{itemize}
%     \item Inspiration from the nature. Motivate why we need to consider both behavioral and morphological intelligence.
%     \item Introduce the concept of co-design and highlight this is specifically important in soft robotics.
%     \item Explain the importance of virtual platform and how it can be a driving force of research along this direction. Point out the limitation of existing works.
%     \item Introduce our work. (1) Present a platform of soft robot co-design for locomotion in diverse environments. (material, tasks, interface, differentiability) (2) Highlight extensive experimental analysis with many state-of-the-art methods. (3) Brief conclusion of the results and our finding. (4) Final touch on how exciting this work can lead to.
%     \item Listed contributions.
% \end{itemize}

%-Animals demonstrate diversity that is catered to their environments to a degree not rigorously explored in soft robotics.
The natural world demonstrates morphological and behavioral complexity to a degree unexplored in soft robotics.  A jellyfish's gently undulating geometry allows it to efficiently travel across large bodies of water; an ostrich's spring-like feet allow for fast, agile motion over widely varying topography; a chameleon's feet allows for dexterous climbing up trees and across branches.  Beyond their comparative lack of diversity, soft robots' designs are rarely computationally optimized \textit{in silico}  for the environments in which they are to be deployed.  The degree of morphological intelligence observed in the natural world would be similarly advantageous in artificial life.

In this paper, we present \namenospace, a framework for exploring and benchmarking algorithms for co-designing soft robots in behavior and morphology, with emphasis on locomotion tasks.  Unlike pure control or physical design optimization, co-design algorithms co-optimize over a robot's brain and body simultaneously, finding more efficacious solutions that exploit their rich interplay \citep{ma2021diffaqua, spielberg2021advanced, bhatia2021evolution}.  We have seen examples of integrated morphology and behavior in soft manipulation \citep{puhlmann2022rbo}, swimming \citep{katzschmann2018exploration}, flying \citep{ramezani2016bat}, and dynamic locomotion \citep{tang2020leveraging}.  Each of these robots was designed manually; algorithms that design such robots, and tools for designing the algorithms that design such robots have the potential to accelerate the invention of diverse and capable robots.

%Soft hands manipulate  ; plant-like vines grow into the crevices of their substrate geometry.


%-For example (three soft-ish animals)
%-Soft robots are often lacking in diversity, rarely designed optimized in silico or in situ for the types of of environments in which they will be deployed.
%-The same morphological intelligence seen in natural would be similarly advantageous in artificial life.

%Many living creatures manifest unique behaviors in response to characteristics or challenges of their environments. More interestingly, the strategies developed to survive their habitats are often tightly connected to their morphological structures. For example, chameleons are perfectly adapted to their arboreal lifestyle: they spend the majority of time in the trees. Chameleonsâ€™ feet split at nearly 180 degree angle enabling an exceptionally firm grip on the branches. Besides, as opposed to their lizard relatives, they have a truely prehensile tail that functions as an additional climbing appendage for navigating the treetops. Such a fascinatingly intertwined relationship between environment, morphology, and behavior can serve as an inspiring perspective of developing artificial agents with both behavioral and morphological intelligence.

%To this end, an unified consideration of body and brain, namely robot co-design, has been a vigorous research area in soft robotics community. \gc{add citations} Additional to synthesizing a controller to achieve a desired task objective, robot design (including geometry, body stiffness, and muscle placement) is involved in the overall optimization process. Many works have demonstrated, beyond merely policy learning, the potential of leveraging body shape and material properties to achieve a wide variety of tasks. For instance, an innovative soft robot with a spring-powered, bistable spine leverages elastic instabilities for amplified performance. The bistable design principle allows to rapidly store and release energy in milliseconds, making soft robot capable of performing a galloping motion.

\name decomposes computational soft robot co-design into four elements: design representations (of morphology and control), tasks for which robots are to be optimized (mathematically, reward or objective functions), environments (including the physical models needed to simulate them), and co-design algorithms.  Representationally, \name provides an unified and flexible interface of robot geometry, body stiffness, and muscle placement that can take operate on common 3D geometric primitives such as point clouds, voxel grids, and meshes.   For benchmarking, \name includes a variety of dynamic tasks important in robotics, such as fast locomotion, agile turning, and path following.  To study environmentally-driven robot design and motion, \name supports an extensive, naturally-inspired material set that allows it to not only simulate hyperelastic soft robots, but also emulate ground, desert, wetland, clay, ice, and snow terrains, as well as shallow and deep bodies of water.  \name provides a differentiable multiphysics engine built atop the material point method (MPM) for simulating these diverse biomes.  Differentiability provides a crucial ingredient for the development of co-design algorithms, which increasingly commonly exploit model-based gradients for efficient design search.  This focus on differentiable multiphysical environments is in contrast to to previous work \citep{bhatia2021evolution, graule2022somogym} which relied on simplified physical models with limited phenomena and no differentiability; this limited the types of co-design problems and algorithms to which they could be applied.  The combination of differentiable multiphysics simulation with the decomposition of environmentally-driven co-design into its distinct constituent elements (representation, algorithm, environment physics, task) makes \name particularly well suited to systematically understanding the influence of design representations, physical modeling, and task objectives in the development of soft robot co-design algorithms.  In summary, we contribute:

%Furthermore, a differentiable physics engine built on top of Material Point Method (MPM) with Taichi is implemented to provide model-based gradients, which are becoming ever-more prevalent in soft robot control and design techniques. Based on this well-established platform, we conduct extensive experiments and analysis with a variety of state-of-the-art representations and learning methods. Our findings highlight the interplay between environment, morphology, and behavior. We further identify unique challenges of design space representation and the ambiguity in muscle construction and actuation that arise in co-optimization of morphology


%\name provides differentiable multiphysics simulation for powering model-based computational co-design algorithms; further, it provides modular parameterizable representations for physical design and control and a suite of benchmark tasks important for robotics.  


%\namenospace's multiphysical materials provides a wide variety of environments inspired by Earth's diverse biomes.  \namenospace's focus on differentiably simulating diverse materials such as hyperelastics, sand, snow, mud, and water in a physically-based manner is in contrast to previous work \citep{bhatia2021evolution, graule2022somogym} which relied on simplified physical models with limited phenomenological representations and no differentiability, the latter of which limits the space of applicable co-design algorithms.  




%empowers the development of computational co-design algorithms driven by differentiable simulation for different tasks and environments, providing modular representations of morphology and control.
%While thriving development of simulated environments have powered the tremendous success of robot learning in control, much less has been done in the context of soft robot co-design. 
%Previous methods have been based on simplified

  %Previous work has focused on physically inaccurate simulation methods (typically for speed and staiblity), single materials, limited task-sets, and model-free approaches.  First work to support the complement of that.  And, the combination of those elements allows for a very thorough analysis of the impact of different elements of co-design and interesting results in optimized soft cyberphysical systems


%In order to more deeply understand the inherent interdependency between design and control and advance the development of new breeds of soft robots, a comprehensive virtual platform with well-established tasks, diverse environments, and an unified interface is needed. Existing works have typically been tailored for particular environment or representation, limiting the possibility of a more general study in robot learning. Otherwise, a comprehensive benchmark with broad tasks coverage adopts a simplified configuration, excluding challenges stemming from larger-scale learning and computation. \gc{I don't understand the last sentence} % 2D toy -> aim to reduce sim2real

%\todo{need to motivate locomotion (as a starting point)}
%In this work, we introduce \namenospace, a soft robot co-design platform for locomotion in diverse environments. Locomotion plays a critical role for living creatures to survive and prosper in their environments, and is tightly connected to morphological structure and habitat factors. \name includes a variety of tasks such as fast locomotion, agile turning, and path following. To study environmentally-driven robot design and motion, \name supports an extensive, naturally-inspired material set that allows to simulate ground, desert, wetland, clay, ice, snow, shallow water, and ocean. \name provides an unified and flexible interface of robot geometry, body stiffness, and muscle placement that can take in common 3D representations such as point clouds, voxel grids, and meshes. Furthermore, a differentiable physics engine built on top of Material Point Method (MPM) with Taichi is implemented to provide model-based gradients, which are becoming ever-more prevalent in soft robot control and design techniques. Based on this well-established platform, we conduct extensive experiments and analysis with a variety of state-of-the-art representations and learning methods. Our findings highlight the interplay between environment, morphology, and behavior. We further identify unique challenges of design space representation and the ambiguity in muscle construction and actuation that arise in co-optimization of morphology. Finally, we demonstrate the value of differentiable physics. \gc{maybe say the gradients? and what value is?} In summary, we conclude the following contributions:
\vspace{-1mm}
\begin{itemize}[align=right,itemindent=0em,labelsep=2pt,labelwidth=1em,leftmargin=*,itemsep=0em] %,nosep]
  \item A soft robot co-design platform for locomotion in diverse environments with the support of an extensive, naturally-inspired material set, a variety of locomotion tasks, an unified interface for robot design, and a differentiable physics engine.
  \item Algorithmic benchmarks for various representations and learning algorithms, laying a foundation for studying behavioral and morphological intelligence.
  \item Analysis of \textit{1)} the interplay between environment, morphology, and behavior \textit{2)} the importance of design space representations \textit{3)} the ambiguity in muscle formation and controller synthesis  \textit{4)} the value of differentiable physics, with numerical comparisons of gradient-based and gradient-free design algorithms and intelligible examples of where gradient-based co-design fails.  This analysis provides insight into the efficacy of different aspects of state-of-the-art methods and steer future co-design algorithm development.
  %\gc{are any findings here new?} \todo{be more specific here. Concretely mention some finding or conclusion from our experiments --> inspire future exploration}
\end{itemize}

\begin{figure*}[h]
    \vspace{-1.5mm}
    \centering
    \includegraphics[width=0.95\linewidth]{asset/demo_3}
    \vspace{-2mm}
    \caption{An overview of \name with demonstration of various biologically-inspired designs.}
        \vspace{-5mm}

\end{figure*}

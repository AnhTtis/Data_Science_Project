\customparagraph{Computing \( \kappa_i \)}
    Following~\cite{Maaten}, we compute \( \kappa_i \) using a binary search such that
    \begin{align}
        | \log_2(P) - H(P_i) | \le 0.1 \cdot \log_2(P)
    \end{align}
    where \( P \) is a hyperparameter, and \( H(P_i) \) is the Shannon entropy of similarities for representation \( i \)
    \begin{align}
        H(P_i) = \sums{j=1}{n} p_{i|j} \log_2(p_{i|j}).
    \end{align}

\customparagraph{Decomposition of \( KL(P||Q) \)}
    Recall that
    \begin{align}
        p_{ij} = \frac{p_{i|j} + p_{j | i}}{2}, \quad p_{i|j} = \frac{\exp(\kappa_i \vec x_i\T \vec x_j)}{\sums{l, m}{}\exp(\kappa_i \vec x_l\T \vec x_m)}
    \end{align}
    and
    \begin{align}
        q_{ij} = \frac{\exp(\kappa \vec z_i\T \vec z_j)}{\sums{l, m}{} \exp(\kappa \vec z_l\T \vec z_m)}.
    \end{align}

    Since \( p_{ij} \) is constant \wrt \( q_{ij} \), we have
    \begin{align}
        &\ARGMIN KL(P||Q) = \ARGMIN \sums{i, j}{} p_{ij} \log \frac{p_{ij}}{q_{ij}} \\
        &= \ARGMIN \underbrace{\sums{i, j}{} p_{ij} \log p_{ij}}_{\text{constant}} - \sums{i, j}{} p_{ij} \log q_{ij} \\
        &= \ARGMIN \underbrace{- \sums{i, j}{} p_{ij} \log q_{ij}}_{\eqqcolon \LVMFT}
    \end{align}
    Minimizing \( KL(P||Q) \) over \( \TARGETS \) is therefore equivalent to minimizing \( \LVMFT \).

    Decomposing \( \LVMFT \) gives
    \begin{align}
        \LVMFT &= - \sums{i, j}{} p_{ij} \kappa \vec z_i\T \vec z_j +\\
        & \sums{i, j}{} \lrp{p_{ij} \log \sums{l, m}{} \exp(\kappa \vec z_l\T \vec z_m)} \\
        &= - \sums{i, j}{} p_{ij} \kappa \vec z_i\T \vec z_j \\
        & + \lrp{\log \sums{l, m}{} \exp(\kappa \vec z_l\T \vec z_m)} \cdot \underbrace{\lrp{\sums{i, j}{} p_{ij}}}_{= 1} \\
        &= \underbrace{- \sums{i, j}{} p_{ij} \kappa \vec z_i\T \vec z_j}_{\eqqcolon~\Lalign} + \underbrace{\log \sums{l, m}{} \exp(\kappa \vec z_l\T \vec z_m)}_{\eqqcolon~\Lunif}
    \end{align}
    Thus, we have shown that
    \begin{align}
        \ARGMIN KL(P||Q) = \ARGMIN \Lalign + \Lunif.
    \end{align}
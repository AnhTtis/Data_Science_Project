\DontPrintSemicolon %
\KwIn{Features $\in \real^k$, $\{\vec x_1, \dots, \vec x_n\}$;
perplexity, $P$; number of iterations, \( T \) ; learning rate, $\eta$.}
\KwOut{Embeddings $\in \SPHERE_d$, $\{\vec z_1, \dots, \vec z_n\}$}

Compute $p_{ij}$ from Eq~\eqref{eq:pij}\;
Initialize solution $\vec Z^0 = \{\vec z_1, \dots, \vec z_n\}$ with PCA\;
\For{$i \gets 1$ \textbf{to} $T$}{
  Compute $q_{ij}$ from Eq.~\eqref{eq:qij}\;
  Compute gradients $\frac{\dd\Lfinal}{\dd \vec Z}$, using loss from Eq.~\eqref{eq:Lfinal}\;
  Update $\vec Z^t$ using the ADAM optimizer with learning rate $\eta$~\cite{adam}\;
  Re-normalize elements of $\vec Z^t$ using \( L_2 \) normalization\;
}
\Return{$\vec Z^T$}\;
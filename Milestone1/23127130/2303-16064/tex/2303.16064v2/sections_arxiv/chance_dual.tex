\subsection{Dual Second-Order Cone Program}

The Lagrangian dual of \eqref{eq:var_meas_soc} is a program with infinite-dimensional linear constraints and a finite-dimensional SOC constraint. This dual involves a function $v(t, x) \in C^2([0, T] \times X)$ and a constant $y \in \R^3$ as variables.

We will use the following expression of \eqref{eq:var_meas_soc} with an explicitly written \ac{SOC} variable $q$ linked with linear constraints to the measures $(\mu_0, \mu_\tau, \mu)$. 
\begin{lem}
The following program has the same optimal value as \eqref{eq:var_meas_soc}:
\begin{subequations}
\label{eq:var_meas_soc_ext}
\begin{align}
    p^*_{r} = &\sup \quad (r/2) q_2  + \inp{p}{\mu_\tau} \label{eq:soc_cost} \\
    & q_1+\inp{p^2}{\mu_\tau}= 1 \label{eq:soc_begin}\\
    & q_3 - 2 \inp{p}{\mu_\tau} =0 \\
    & q_1 + q_4= 2 \label{eq:soc_end_aff}\\
     & \mu_\tau - \Lie^\dagger \mu = \delta_0 \otimes \mu_0 \label{eq:soc_liou} \\
    & q =([q_1, q_2, q_3], q_4) \in Q^3 \label{eq:soc_end}\\
    & \mu, \ \mu_\tau \in \Mp{[0, T] \times X}  \label{eq:soc_end_meas}.
\end{align}
\end{subequations}
\end{lem}
\begin{proof}
This formulation is obtained from \eqref{eq:var_meas_soc} through the change of variable $q = (u,1+\inp{p^2}{\mu_\tau})$ and the replacement of $z$ with $q_2/2$ using the second coordinate of constraint \eqref{eq:var_meas_con_soc_def}. Equation \eqref{eq:soc_end_aff} is derived by adding the first coordinate of \eqref{eq:var_meas_con_soc_def} and the last coordinate of \eqref{eq:var_meas_con_soc}.




%Constraints \eqref{eq:soc_begin}-\eqref{eq:soc_end} implement the \ac{SOC} relations in \eqref{eq:var_meas_con_soc_def}-\eqref{eq:var_meas_con_soc}. The variable $z$ from \eqref{eq:var_meas_soc} is equal to $q_2/2$. We use the relation $q_1+q_4=2$ in \eqref{eq:soc_end_aff} by addinng together the $q$ terms in \eqref{eq:var_meas_con_soc} with $q_4 = 1+\inp{p^2}{\mu_\tau}$.
\end{proof}

\begin{thm} \label{thm:cdc_strong_dual}
The dual program of \eqref{eq:var_meas_soc} with weak duality $d^*_r \geq p^*_r$ under Assumptions A1-A3 is
\begin{subequations}
\label{eq:var_cont_soc}
\begin{align}
    d^*_{r} =& \inf \quad y_1 + 2 y_3 + \int_{X_0} v(0, x_0) d\mu_0(x_0) \label{eq:lag_cost} \\
    & \Lie v(t,x) \leq 0 & & \forall (t, x) \in [0, T] \times X \label{eq:lag_occ_meas} \\
    & v(t, x) + y_1 \, p^2(x) - 2 \, y_2 \, p(x) \geq p(x) & & \forall (t, x) \in [0, T] \times X \label{eq:lag_stop_meas} \\
    & ([y_1+y_3, -(r/2), y_2], y_3) \in Q^3 \label{eq:lag_soc} \\
    & y \in \R^3, \ v \in C^2([0, T] \times X).
\end{align}
\end{subequations}
Strong duality with $d^*_r = p^*_r$ holds under Assumptions A1-A4.
\end{thm}
\begin{proof}
\textbf{Dual formulation:} this formulation is obtained by applying the standard Lagrangian duality method to \eqref{eq:var_meas_soc_ext}. $v$ is the Lagrange multiplier corresponding to constraint \eqref{eq:soc_liou}, and $y$ is the Lagrange multiplier corresponding to constraints \eqref{eq:soc_begin}-\eqref{eq:soc_end_aff}. Conversely, $\mu$ is the Lagrange multiplier corresponding to constraint \eqref{eq:lag_occ_meas}, $\mu_\tau$ is the Lagrange multiplier corresponding to constraint \eqref{eq:lag_stop_meas}, and $q$ is the Lagrange multiplier corresponding to \eqref{eq:lag_soc}. The cost in \eqref{eq:lag_cost} corresponds to the right-hand sides of constraints \eqref{eq:soc_begin}-\eqref{eq:soc_liou}, while the right-hand side of \eqref{eq:lag_stop_meas} and the second coordinate $-(r/2)$ in \eqref{eq:lag_soc} correspond to the cost in \eqref{eq:soc_cost}.

\textbf{Strong duality:} see Appendix \ref{app:duality_chance}.
\end{proof}

This strong duality property is an important feature of the infinite-dimensional problem at hand: it means that one may equivalently solve moment relaxations of \eqref{eq:var_meas_soc_ext} and sums-of-squares relaxations of \eqref{eq:var_cont_soc}.
 
%  By weak duality it holds that $d^*_{k} \geq p^*_{k}$. We will need to modify proofs of strong duality due the SOC terms.
% for arxiv processing
\pdfoutput=1
% ****** Start of file apssamp.tex ******
%
%   This file is part of the APS files in the REVTeX 4.2 distribution.
%   Version 4.2a of REVTeX, December 2014
%
%   Copyright (c) 2014 The American Physical Society.
%
%   See the REVTeX 4 README file for restrictions and more information.
%
% TeX'ing this file requires that you have AMS-LaTeX 2.0 installed
% as well as the rest of the prerequisites for REVTeX 4.2
%
% See the REVTeX 4 README file
% It also requires running BibTeX. The commands are as follows:
%
%  1)  latex apssamp.tex
%  2)  bibtex apssamp
%  3)  latex apssamp.tex
%  4)  latex apssamp.tex
%
\documentclass[%
 reprint,
superscriptaddress,
%groupedaddress,
%unsortedaddress,
%runinaddress,
%frontmatterverbose, 
%preprint,
%preprintnumbers,
%nofootinbib,
%nobibnotes,
%bibnotes,
 amsmath,amssymb,
 aps,prl
%pra,
%prb,
%rmp,
%prstab,
%prstper,
%floatfix,
]{revtex4-2}

\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math

%================================
%        custom edits         
%================================
% the blue thing doesn't seem to work
\usepackage[colorlinks = true]{hyperref}
%            allcolors = {Blue}]{hyperref}
\usepackage{physics}
%\usepackage{hyperref}% add hypertext capabilities
%\usepackage[mathlines]{lineno}% Enable numbering of text and display math
%\linenumbers\relax % Commence numbering lines

%\usepackage[showframe,%Uncomment any one of the following lines to test 
%%scale=0.7, marginratio={1:1, 2:3}, ignoreall,% default settings
%%text={7in,10in},centering,
%%margin=1.5in,
%%total={6.5in,8.75in}, top=1.2in, left=0.9in, includefoot,
%%height=10in,a5paper,hmargin={3cm,0.8in},
%]{geometry}


%% the following code added from stackexchange, to fix language in bib
\usepackage[english]{babel}

\makeatletter
% A change to a babel macro
\def\bbl@set@language#1{%
  \edef\languagename{%
    \ifnum\escapechar=\expandafter`\string#1\@empty
    \else\string#1\@empty\fi}%
  %%%% ADDITION
  \@ifundefined{babel@language@alias@\languagename}{}{%
    \edef\languagename{\@nameuse{babel@language@alias@\languagename}}%
  }%
  %%%% END ADDITION
  \select@language{\languagename}%
  \expandafter\ifx\csname date\languagename\endcsname\relax\else
    \if@filesw
      \protected@write\@auxout{}{\string\select@language{\languagename}}%
      \bbl@for\bbl@tempa\BabelContentsFiles{%
        \addtocontents{\bbl@tempa}{\xstring\select@language{\languagename}}}%
      \bbl@usehooks{write}{}%
    \fi
  \fi}
% The user interface
\newcommand{\DeclareLanguageAlias}[2]{%
  \global\@namedef{babel@language@alias@#1}{#2}%
}
\makeatother

\DeclareLanguageAlias{en}{english}


\begin{document}

%\preprint{APS/123-QED}

\title{Optimizing performance of quantum operations with non-Markovian decoherence: \\ the tortoise or the hare?}
\author{Eoin P. Butler}
 \affiliation{School of Physics, Trinity College Dublin, College Green, Dublin 2, Ireland}
\author{Gerald Fux}%
\affiliation{SUPA, School of Physics and Astronomy, University of St Andrews, St Andrews KY16 9SS, United Kingdom}%
\affiliation{Abdus Salam International Center for Theoretical Physics (ICTP), Strada Costiera 11, 34151 Trieste, Italy}%
\author{Brendon W. Lovett}
\affiliation{SUPA, School of Physics and Astronomy, University of St Andrews, St Andrews KY16 9SS, United Kingdom}
\author{Jonathan Keeling}
\affiliation{SUPA, School of Physics and Astronomy, University of St Andrews, St Andrews KY16 9SS, United Kingdom}%
\author{Paul R. Eastham}
 \affiliation{School of Physics, Trinity College Dublin, College Green, Dublin 2, Ireland}
\date{28 March 2023}% It is always \today, today,
             %  but any date may be explicitly specified
\begin{abstract}
The interaction between a quantum system and its environment limits our ability to control it and perform quantum operations on it. We present an efficient method to find optimal controls for quantum systems coupled to non-Markovian environments, by using the process tensor to compute the gradient of an objective function. 
We consider state transfer for a driven two-level system coupled to a bosonic environment, and  characterize performance in terms of speed and fidelity. We thus determine the best achievable fidelity as a function of process duration. 
We show there is a trade-off between speed and fidelity, and that slower processes can have higher fidelity by exploiting non-Markovian effects.
\end{abstract}

%\keywords{Suggested keywords}%Use showkeys class option if keyword
                              %display desired
\maketitle

The control of quantum systems using time-dependent Hamiltonians is crucial for quantum technologies~\cite{glaser_training_2015}, enabling the implementation of state transfer and gate operations. An important task is to establish how optimal performance can be achieved for such processes. In an ideal closed quantum system perfect operations are possible given sufficient time~\cite{deffner_quantum_2017}. A speed limit arises because physical Hamiltonians are bounded, so that energy-time uncertainty gives a maximum rate of time-evolution and hence a minimum operation time. Beyond this ideal case, however, other considerations arise. One is a desire for reliable operation when precise control cannot be guaranteed; this can be achieved at the expense of speed by using adiabatic processes~\cite{Torrontegui2013:Review}. Another is the impact of decoherence and dissipation. In the standard Markovian description of such processes, this results in effects which accumulate in time. In most cases this means the highest achievable fidelity is then obtained by operating at the speed limit. In the present Letter,  we show that this is not the case in non-Markovian systems, and that the highest fidelity can be improved by slower operation. 

To provide a concrete demonstration of the tradeoff between speed and fidelity we use numerical optimal control to explore the achievable performance  for a non-Markovian system, consisting of a driven two-level system interacting with a bosonic environment. Optimal control involves determining a set of time-dependent control fields that maximize an objective function such as the fidelity. Here, we show that this can be done effectively in a non-Markovian system, using an extension of our previously introduced process tensor approach~\cite{fux_efficient_2021} to efficiently compute the gradient of the objective function. This allows us to repeatedly optimize over many hundreds of control parameters for different process durations, and so find the achievable fidelity as a function of the process duration. Our results reveal a marked improvement in fidelity for process durations $T$ longer than a value $T_0$, set by the speed-limit in the closed system~\cite{deffner_quantum_2017}. We further compute a widely-used measure of non-Markovianity, based on trace-distance~\cite{laine_measure_2010}, and show that the improved fidelity coincides with an increase in non-Markovianity. Since many types of device exhibit regimes of non-Markovian decoherence our results could enable performance improvements across a range of quantum technologies~\cite{acin_quantum_2018}, including superconducting circuits~\cite{fischer_time-optimal_2019,goerz_charting_2017}, spins~\cite{dolde_high-fidelity_2014}, quantum dots~\cite{fux_efficient_2021,wilson-rae_quantum_2002}, color centers in diamond~\cite{norambuena_quantifying_2020}, and cold atoms~\cite{choi_optimal_2014,bason_high-fidelity_2012,treutlein_microwave_2006}. 

Our approach applies to a generic open quantum system, comprising a Hamiltonian $H_S$, interacting with an environment (bath) with Hamiltonian $H_B$, through a coupling $H_{SB}$. Models of this form are typically treated under the assumptions of weak system-bath coupling (Born) and short bath correlation time (Markov). This implies that information about the system only flows away into the environment, and does not return,  leading to simple time-local evolution equations for the system reduced density matrix $\rho_S$~\cite{breuer_theory_2007}. Such equations have been used to establish performance limits~\cite{caneva_optimal_2009,del_campo_quantum_2013,deffner_quantum_2013} using optimal control~\cite{koch_controlling_2016} in various problems. Studying optimal control beyond the Born-Markov approximation has so far been difficult. One approach is to expand the system to incorporate a few modes of the environment, which are then treated exactly, with the remaining environment modes providing Markovian damping. This approach has been used to study controllability~\cite{reich_exploiting_2015}, optimal control~\cite{rebentrost_optimal_2009,floether_robust_2012} and speed limits~\cite{deffner_quantum_2013}. However, it becomes intractable when one considers more than a few modes of the environment. Another method involves computing the time-local dissipator describing non-Markovian dynamics using lowest-order perturbation theory~\cite{hwang_optimal_2012} or the hierarchical equations-of-motion~\cite{mangaud_non-markovianity_2018}. These techniques have been used within optimal control to demonstrate fidelity increases, and are effective when the environment spectral density can be approximated by a small number of Lorentzians. Some works~\cite{ohtsuki_non-markovian_2003,ying-hua_optimal_2016,cui_optimal_2008} have obtained optimal protocols under the assumption that the dissipation is described by a fixed time-local dissipator, such as that for a pure dephasing channel~\cite{chin_quantum_2012,bylicka_non-markovianity_2014}. An issue, however, is that for optimal control one must consider the effect of the time-dependent control fields on the dissipative processes~\cite{addis_problem_2016}.%In some specific cases, one can use a fixed time-local dissipator, such as that describing a pure dephasing channel~\cite{chin_quantum_2012,bylicka_non-markovianity_2014}. An issue with such approaches~\cite{ohtsuki_non-markovian_2003,ying-hua_optimal_2016,cui_optimal_2008} however is that one must consider the effect of the time-dependent control field on the dissipative process~\cite{addis_problem_2016}. 

\begin{figure}
\includegraphics[width=\linewidth]{tensor_networks_labels.pdf}
\caption{\label{fig:ptdiagrams} (a) Tensor network representation of the propagation of an initial state over four time steps and calculation of the fidelity. Time increases going up the diagram. The evolved density matrix is given by this diagram without the target state node. The fidelity is obtained by joining the legs indicated by arrows. (b) Derivative of the fidelity with respect to the penultimate propagator and computation of the gradient by backpropagation (see text).} 
\end{figure}


To overcome these challenges, in this Letter we extend the process tensor method described in our previous work~\cite{fux_efficient_2021} for solving the dynamics of non-Markovian open systems.
The process tensor (PT)~\cite{pollock_non-markovian_2018,supplement} is a mathematical object that encodes the full influence of an environment onto a system, not assuming any Markovian approximation.
It is a multi linear map from the set of all possible system control operation sequences to the resulting output states. It is constructed by discretizing the time evolution into a series of time steps. Generically the PT is a high rank tensor that grows exponentially with the number of time steps.
In many cases, however, it is possible to systematically discard negligible correlations and express the PT in matrix product operator (MPO) form~\cite{verstraete_matrix_2004,orus_practical_2014}, allowing a numerically efficient representation.
For the case of a Gaussian bosonic environment one can efficiently compute a PT in MPO form (PT-MPO) employing the method introduced in~\cite{makri_tensor_1995,makri_tensor_1995-1, strathearn_efficient_2018, jorgensen_exploiting_2019}.
However, other methods for bosonic, fermionic, and spin environments are available too~\cite{banuls_matrix_2009, jorgensen_exploiting_2019, strathearn_modelling_2020, lerose_influence_2020, fux_efficient_2021, cygorek_simulation_2022, sonner_influence_2021, ye_constructing_2021, white_non-markovian_2021, thoenniss_non-equilibrium_2022, OQuPy2022, thoenniss_efficient_2022, ng_real_2022}.
Once computed, the PT can be contracted to time-evolve $\rho_{S}$ for any $H_{S}$, as shown in Fig.~\ref{fig:ptdiagrams}(a). In this tensor network diagram~\cite{orus_practical_2014} each node represents a tensor, each leg represents an index, and connections between legs correspond to contractions. The diagram is in Liouville space so that operators such as $\rho_S$ are rank-1 objects, and maps between operators, such as the propagators across each time step $U_t=e^{\Delta t \mathcal{L}_S(t)}$ with $\mathcal{L}_S(t)\bullet=-i[H_S(t),\bullet]$,  are rank-2. The PT is the region in the dashed box, which can be contracted with an initial density matrix and the Trotterized propagators~\cite{trotter_product_1959}
to obtain $\rho_S$ at later times. 




For optimal control we must define an objective function. In the following we consider the example of a state transfer process, for which we use the fidelity $\mathcal{F}$~\cite{benenti_principles_2018} between the desired target state and the obtained final state $\rho_f=\rho_S(t_f)$.  We restrict ourselves to pure target states, with density matrix $\sigma=|\sigma\rangle\langle\sigma|$, so that $\mathcal{F}=\langle \sigma|\rho_f|\sigma\rangle$. In Liouville space this is a scalar formed from the vectors representing the final density matrix and the transposed target density matrix. The fidelity then corresponds to the network shown in Fig.~\ref{fig:ptdiagrams}(a) with the two legs marked with arrows joined.

An optimal protocol is found by numerically maximizing $\mathcal{F}$ over $N$ control parameters which determine the system propagators at each discrete time step. Such numerical optimization becomes significantly faster if one can efficiently calculate the gradient of $\mathcal{F}$ with respect to the $N$-dimensional vector of control parameters, $\nabla\mathcal{F}$. A naive calculation of $\nabla\mathcal{F}$ requires of order $N$ evaluations of $\mathcal{F}$, strongly limiting the size of problems that can be treated. Such gradients can however be efficiently obtained using the adjoint method~\cite{plessix_review_2006}, which has been applied to unitary or Markovian dynamics~\cite{mishra_control_2021}. Crucially, one may see that the tensor network representation of $\mathcal{F}$ in Fig.~\ref{fig:ptdiagrams}(a) leads immediately to the form of adjoint method required for non-Markovian dynamics. This diagram represents the fidelity as a multilinear functional of the propagators; thus the derivative with respect to the propagator at a given time step is the same diagram with the node for that propagator removed, as shown in Fig.~\ref{fig:ptdiagrams}(b). Furthermore, all such derivatives can be constructed from two sets of tensors found as follows. The first set come from evaluating the network in the typical way, proceeding from the initial state forwards in time, and then storing the two-legged tensors obtained after each time step. The second set of tensors are found by starting from the target state and propagating backwards in time to a given time step. One can then contract one index in each pair of stored tensors to obtain the derivative of $\mathcal{F}$ with respect to all the propagators---and hence the gradient with respect to any and all choices of controls in $H_S$~\cite{supplement}. The key difference compared to use of the adjoint method in unitary or Markovian dynamics is that we propagate a rank-2 tensor rather than the state $\rho_S$. The  additional index in this tensor encodes information about the past and future dynamics and enables optimization of non-Markovian evolutions.

To illustrate the general principle, 
we consider an example of optimal state transfer in a driven two-level system. Our system Hamiltonian is $H_S=h_x(t)s_x+h_z(t)s_z$, where the fields $h_{x,z}(t)$ are the controls. We treat them as piecewise constant with values $h_{x,z}(t_n)$ at the time steps $t_n=n\Delta t$. We seek to determine the control fields which steer the state $\rho_S(t)$ from a prescribed initial state (the state with $s_x=-1$) to a target state (the state $s_x=+1$). 
The bath is a set of harmonic oscillators, and the coupling is $H_{SB}=s_z\sum_q(g_qb_q+g_q^*b_q^\dagger)$.
This model is known as the spin-boson model, and it describes many different physical systems~\cite{leggett_dynamics_1987,de_vega_dynamics_2017}. For definiteness, we suppose it represents an optical transition on a quantum dot driven by a laser pulse~\cite{ramsay_review_2010}, in which case $h_z$ and $h_x$ are the time-dependent detuning and Rabi frequency respectively.  In the quantum dot the bosonic modes are acoustic phonon modes, for which we use the super-Ohmic spectral density  $J(\omega)=2\alpha\omega^3\omega_c^{-2}\exp\left[-\omega^2/\omega_c^2\right]$ with $\alpha=0.126$ and $\omega_c=3.04\,\text{ps}^{-1}$~\cite{ramsay_phonon-induced_2010,luker_influence_2012}, and use a bath temperature of 5\,K. %The reduced density matrix of the system is obtained by tracing over the bath, $\rho_S=\Tr_B \rho$.

\begin{figure}
\includegraphics{paper_fig_1_legend.pdf}
\caption{\label{fig:fidelity}(a) Infidelity, $1-\mathcal{F}$, for state transfer as a function of process duration with bounded control fields. Results are shown for the optimal protocol of the non-Markovian spin-boson model (control A) and for driving with a constant field (control B). The latter is an optimal protocol in the closed system. Blue/solid: infidelity of control A in the spin-boson model. Orange/dashed: infidelity of control B in the spin-boson model. Green/dot-dashed: infidelity of control B in the closed system. (b) Non-Markovianity measure as a function of process duration in the spin-boson model for controls A (blue/solid) and B (orange/dashed). The vertical dotted lines are the speed limit time $T_0$ of the closed system.}
\end{figure}

We have determined optimal controls $h_x(t_n),h_z(t_n)$ by numerically maximizing $\mathcal{F}$ using the L-BFGS-B algorithm~\cite{virtanen_scipy_2020}, with the gradient and fidelity computed with the PT. We explore the impact of speed on fidelity by performing this optimization for different process durations $T$, with bounds on the fields,
$|h_x|\leq h_x^{\mathrm{max}}=5\,\text{ps}^{-1}$ and $|h_z|\leq h_z^{\mathrm{max}}=1\,\text{ps}^{-1}$,
to consider the realistic case in which the Hamiltonian, and therefore the speed of the unitary evolution, is restricted.  We note that in the unitary case, the speed limit for state transfer has been identified from the rate of convergence of the Krotov algorithm~\cite{caneva_optimal_2009}. Here we consider a fully non-Markovian dissipative system, and use numerically converged optimization to identify the speed limit from the behavior of the fidelity against process duration. 
Figure \ref{fig:fidelity}(a) shows the resulting infidelity, $1-\mathcal{F}$ for this optimized protcol, denoted ``Control A''. 

It is interesting to compare the optimized results with those for the protocols which are optimal for unitary dynamics in the closed system~\cite{hegerfeldt_driving_2013}, denoted ``Control B'', which we used as the starting point for the optimization. These protocols can be understood by noting that for unitary dynamics one can achieve the state transfer with infidelity zero by setting $h_x$=0 and requiring an area $\pi$ for the time integral of the field $h_z(t)$. Such a protocol is  optimal if it satisfies the constraint $|h_z(t)|< h_z^{\mathrm{max}}$ for all times, which is possible when $T$ is greater than the speed limit time $T_0=\pi/ h_z^{\mathrm{max}}$ (which saturates both the Mandelstam-Tamm and Margolus-Levitin bounds~\cite{deffner_quantum_2017}). Among protocols satisfying the above condition, we choose $h_z(t)=\pi/T$. For $T<T_0$ the state transfer is not fully achievable and the optimal protocol is that with $h_z(t)=\pm h_z^{\mathrm{max}}$. Thus, in both regimes, we have an optimal protocol with constant fields. As can be seen in Fig.~\ref{fig:fidelity}(a), the infidelity of this protocol (Control B) for the unitary dynamics smoothly decreases as the duration $T$ increases from zero, before saturating at zero for $T>T_0$. Applying this same protocol in the open system gives a similar overall behavior, with the key difference being that the saturated value of the infidelity at large $T$ is now non-zero. This behavior differs from that with Markovian decoherence, where slower processes would be expected to produce higher infidelity, i.e. growing with $T$. In the ``Control B'' protocol, we have $h_z(t)=h_z$ and $h_x=0$, so that the model is the exactly solvable independent-boson model~\cite{mahan_many-particle_2013,viola_dynamical_1999}, which has non-Markovian decoherence. The constant infidelity for $T>T_0$ comes from the decoherence function of the independent-boson model, which  approaches a non-zero constant for times $T\gg \tau_b\sim 1/\omega_c$.

Figure~\ref{fig:fidelity} shows that the optimization increases the performance for all process durations, as one would expect, but the increase becomes marked when $T>T_0$. This is because the fidelity in this regime is limited not by the distance to the target state and the speed of unitary evolution under $H_S$, but by the decoherence and dissipation produced by the bath. The improved fidelity thus corresponds to suppressing decoherence. 
An approach to suppressing decoherence one might consider is Dynamical Decoupling~\cite{viola_dynamical_1999} (DD). Such a protocol uses control fields to produce dynamics for the system that averages away the effects of the bath, which requires that the timescale of the system is much shorter than that of the bath $\tau_b$. This regime is not accessible in our optimization due to the bounds on the control fields. The standard DD sequence for the process we consider would be a train of $\pi$ pulses separated by a time $\tau\ll\tau_b$ and each with duration $\tau_p\ll\tau$; this would produce rapid spin-flips and so average away $H_{SB}\propto s_z$. Thus standard DD requires a field $|h_{x}|\gg\pi/\tau_b$, which with $\tau_b\sim1/\omega_c\sim 0.3\,\mathrm{ps}$ is greater than $ h_x^{\mathrm{max}}$.

To explore the mechanism that is giving the improvement in fidelity we compute a measure of non-Markovianity. There are many such interrelated measures~\cite{pollock_operational_2018,de_vega_dynamics_2017,li_concepts_2018} including, among others, those based on divisiblity and complete-positivity, and those based on information backflow. We choose that introduced by Breuer, Lane and Piilo~\cite{laine_measure_2010}, formed from the trace distance between pairs of states $D_{12}=\Tr |\rho_1(t)-\rho_2(t)|/2$, where $\rho_{1}(t)$ and $\rho_{2}(t)$ are obtained by time-evolving initial states $\rho_{1}$ and $\rho_{2}$ respectively. The non-Markovianity is \begin{displaymath}\mathcal{N}=\max_{\rho_1,\rho_2} \int \frac{dD_{12}}{dt} dt,\end{displaymath} where the integral extends over regions where  the integrand is positive, and the maximum is over all pairs of orthogonal states on the surface of the Bloch sphere (which is the same as the maximum over all pairs of initial states, see \cite{wismann_optimal_2012}). 
The two curves in Fig.~\ref{fig:fidelity}(b) show the non-Markovianity as a function of process duration for the optimal controls (solid) and the constant field (dashed). For the constant field case, control B, the non-Markovianity increases from zero as the process duration increases from zero, becoming constant for $T\gtrapprox 2\,\mathrm{ps}$. This corresponds to the build-up of correlations due to the system-bath coupling in the independent boson model, and is unaffected by the system dynamics since $[H_S,H_{SB}]=0$ when $h_x=0$. The non-Markovianity with the optimal control A is higher, but initially shows a similar increase and saturation as the duration $T$ increases from zero. However, there is then a marked feature at $T\approx T_0$, beyond which the non-Markovianity increases rapidly with process duration before reaching a new and much higher level. This suggests that the improvement in fidelity for long process durations occurs because the optimization increases the degree of non-Markovianity of the map, restoring some of the information lost to the environment during the earlier parts of the dynamics by the end of the process. %We note that this is not the only way the fidelity of the state-transfer could be improved: in particular, one could choose control fields such that the relaxation is towards a steady-state which matches the desired target state, an effect which would also be possible in Markovian dynamics. To isolate the origin of the improvement we compute a 

\begin{figure}
\includegraphics{paper_fig_3_bloch_unlabled.pdf}
\caption{\label{fig:sampledynamics} (a) Driving fields $h_x(t)$ (green) and $h_z(t)$ (orange) for the optimal state transfer process, control A, of duration 4.0 ps. (b) Dynamics of the components of the Bloch vector (left axis, green/solid: $\expval{\sigma_x}$ , blue/dot-dashed: $\expval{\sigma_y}$, orange/dashed: $\expval{\sigma_z}$), and length of the Bloch vector (right axis, black/solid). The length of the Bloch vector for control B
%the unoptimized control, $h_x=0$ and $h_z=\pi/T$, 
is also shown (right axis, black/dashed).}
\end{figure}

Figure~\ref{fig:sampledynamics} shows the optimized control fields (top panel), and the dynamics of the Bloch vector $\langle\sigma_{x,y,z}\rangle$, for the optimal protocol, control A, at $T=4.0\,\mathrm{ps}$. For this duration, the optimal $h_z$ remains constant, while the optimized $h_x$ has an overall slope and oscillations of varying magnitude, which saturate the bounds at the beginning and end of the process. The resulting dynamics of the Bloch vector moves down below the equator during the control and develops weak oscillations. The clearest effect of the optimization is seen in the length of the Bloch vector, which is shown for both protocols A and B. In the latter case (constant field) the length of the Bloch vector is given by the decoherence function of the independent boson model, which goes from one, for zero time, to a constant non-zero value at late times. The optimal control A clearly avoids this decay and furthermore shows an increase in the Bloch-vector length at the very end of the pulse, consistent with a decoherence suppression mechanism. The control in $h_x$ is very different from that for a standard DD sequence as described above, although it does act to produce some oscillations in the Bloch vector which may have a similar averaging effect. The oscillations in the Bloch vector and control fields become more pronounced (and saturate the bound) as we move to longer process durations. The behavior shown is otherwise representative of that we find for other process durations~\cite{supplement}. The consistency in the form of these solutions suggests that there is a unique global optimum that is found by our optimization process for durations near the speed limit. This is expected to break down for slower processes~\cite{larocca_quantum_2018}. 

In conclusion, we have presented a method for computing optimal controls in general non-Markovian systems. It extends the PT method~\cite{fux_efficient_2021} so as to efficiently compute gradients, so permitting optimization over large numbers of control parameters. The method takes full account of the changes in the dissipator produced by the control fields, allowing it to discover protocols which exploit non-Markovianity for improved performance. We have used it to investigate the performance of a state transfer process in a time-dependent spin-boson model and find that, contrary to the case of a Markovian system, slow processes can perform better than fast ones. The identified controls increase the degree of non-Markovianity during the state transfer, as measured by the growth of trace-distance, and suppress the decoherence, as measured by the decay of the Bloch vector length. These results show that performance improvements are possible across the many qubit implementations subject to non-Markovian decoherence, and could be identified using the methods described here.

We acknowledge discussions with F. Binder.
E.\,P.\,B. acknowledges support from the Irish Research Council (GOIPG/2019/1871).  G.\,E.\,F. acknowledges support from EPSRC (EP/L015110/1). B.\,W.\,L. and J.\,K. acknowledge support from EPSRC (EP/T014032/1). P.\,R.\,E. acknowledges support from Science Foundation Ireland (21/FFP-P/10142). %In order to meet institutional and research funder open access requirements, any accepted manuscript arising shall be open access under a Creative Commons Attribution (CC BY) reuse licence with zero embargo.

%\bibliography{references2}% Produces the bibliography via BibTeX.
\input{ms.bbl} % or include the bbl file

\end{document}




Here, we prove the propagation of chaos type result which is needed in the proof of Theorem \ref{thm_approssimazione}.
The probability spaces and the random variables we use here are defined in Section \ref{sezione_approssimazione:sezione_costruzione_raccomandazioni}.

We work on the product probability space
\begin{equation*}
    \tonde{\Omega,\F,\prob}= \tonde{\overline{\Omega},\overline{\F},\overline{\prob}} \otimes \tonde{\Omega^1, \F^1, \prob^1},
\end{equation*}
with $(\overline{\Omega},\overline{\F},\overline{\prob})$ defined by \eqref{approximation:spazio_raccomandazioni} and \eqref{approximation:legge_spazio_raccomandazioni} and $(\Omega^1, \F^1, \prob^1)$ by \eqref{canonical_setup} or, equivalently, by \eqref{approximation:spazio_rumori}.
Consider the random measure flow $\mu$ defined by \eqref{approximation:approx_misura} and the recommendations $(\Lambda^i)_{i \geq 1}$ defined by \eqref{approximation:approx_raccomandazione}, which we recall are conditionally i.i.d. given $\mu$ under $\overline{\prob}$.
We endow such a probability space with the filtration $\mathbb{F}$ given by the $\prob$-augmentation of the filtration generated by $\overline{\F}$, the initial data $(\xi^i)_{i\geq 1}$ and the Brownian motions $(W^i)_{i\geq 1}$.
We observe that for every $N\geq 2$, each $\beta \in \A_N$ is also $\mathbb{F}$-progressively measurable and, for every $i \geq 1$, each strategy $\lambda^i$ associated to the admissible recommendation $\Lambda^i$ is $\mathbb{F}$-progressively measurable as well.


\medskip
Fix $N\geq 2$, $\beta \in \A_N$ and $1 \leq i \leq N$.
Let $X=X [\Lambda^{N,-i},\beta]=\tonde{X^j[\Lambda^{N,-i},\beta]}_{j = 1}^N$ be the solution of
\begin{equation*}
    \begin{cases}
    dX^j_t=b(t,X^j_t,\mu^N_t,\lambda^{j}_t)dt + dW^j_t, \quad X^j_0=\xi^j, \quad j \neq i, \\
    dX^i_t=b(t,X^i_t,\mu^N_t,\beta_t)dt + dW^i_t, \quad X^i_0=\xi^i.
    \end{cases}
\end{equation*}
The process $X[\Lambda^{N,-i},\beta]$ is the state process of the $N$-players when every player $j \neq i$ follows the recommendation $\Lambda^{i}$ and player $i$ deviates by picking the strategy $\beta$, where $\mu^N_t$ denotes the empirical measure of the $N$-players' states at time $t$ defined in \eqref{misura_empirica}.
Let us introduce also the empirical measure of the processes $X=X[\Lambda^{N,-i},\beta]$:
\begin{equation}
    \mu^N[\Lambda^{N,-i},\beta]=\frac{1}{N}\sum_{j=1}^N\delta_{X^j[\Lambda^{N,-i},\beta]} \in \contpdue.
\end{equation}
Let us denote $X=X[\Lambda]=X[\Lambda^{N,-i},\Lambda^{i}]$ the state process of the $N$ players when every player $i=1,\dots,N$ follows the recommendation $\Lambda^{i}$.
Then, let us consider the following auxiliary processes: let $\tonde{Z^j[\Lambda^{N,-i},\beta]}_{j = 1}^N$ be the solution of
\begin{equation*}
    \begin{cases}
    dZ^j_t=b(t,Z^j_t,\mu_t,\lambda^{j}_t)dt + dW^j_t, \quad Z^j_0=\xi^j, \quad j \neq i, \\
    dZ^i_t=b(t,Z^i_t,\mu_t,\beta_t)dt + dW^i_t, \quad Z^i_0=\xi^i
    \end{cases}
\end{equation*}
and $\nu^N[\Lambda^{-i},\beta]$ be the empirical measure of the processes $Z[\Lambda^{-i},\beta]$:
\begin{equation*}
    \nu^N[\Lambda^{-i},\beta]=\frac{1}{N}\sum_{j=1}^N\delta_{Z^j[\Lambda^{N,-i},\beta]} \in \contpdue.
\end{equation*}

\begin{lemma}\label{lemma_poc}
Let $\beta$ be either an open-loop strategy in $\A_{K}$ for some $K \geq 2$, or be equal to $\lambda^{i}$, the strategy associated to the admissible recommendation $\Lambda^i$ to player $i$.
It holds:
\begin{align}
    & \sup_{t \in [0,T]}\attesa{\pwassmetric{2}{\R^d}{2}\tonde{\mu^N_t[\Lambda^{-i},\beta],\mu_t}} \overset{N \to \infty}{\longrightarrow} 0,  \label{lemma_poc:conv_wasserstein} \\
    & \max_{1 \leq j \leq N} \attesa{ \norm{X^{j,N}[\Lambda^{-i},\beta]-Z^j[\Lambda^{-i},\beta]}^2_{\contrd}} \overset{N \to \infty}{\longrightarrow} 0, \label{lemma_poc:conv_norma} \\
    & \sup_{n \geq 2} \max_{1 \leq j \leq N}\attesa{\norm{X^{j,N}[\Lambda^{-i},\beta]}^2_{\contrd} + \norm{Z^j[\Lambda^{-i},\beta]}^2_{\contrd}} < \infty. \label{lemma_poc:finitezza_momenti}
\end{align}
\end{lemma}
\begin{proof}
Because of the symmetry properties of the systems of SDEs, we can suppose $i=1$.
Throughout the proof, to make notation as simple as possible, we omit the dependence upon $[\Lambda^{-1},\beta]$.
For the same reason, define, for each $j \geq 1$, the following process $\gamma^j$:
\begin{equation*}
    \gamma^j_t=\begin{cases}
    \beta_t \qquad j=1, \\
    \lambda^j_t \qquad j \geq 2.
    \end{cases}
\end{equation*}
Obviously, in the case that $\beta$ is $\lambda^1$, we have $\gamma^j \equiv \lambda^j$ for every $j$.
Moreover, let us introduce the following auxiliary processes: let $(Y^j)_{j \geq 1}$ be the solution of
\begin{equation*}
    dY^j_t=b(t,Y^j_t,\mu_t,\lambda^j_t)dt + dW^j_t, \quad Y^j_0=\xi^j.
\end{equation*}
Let $\eta^N$ be the empirical measure of the processes $Y^j$:
\begin{equation*}
    \eta^N=\frac{1}{N}\sum_{j=1}^N\delta_{Y^j} \in \contpdue.
\end{equation*}
Denote by $X^*$ the state process resulting from the coarse correlated solution of the MFG, i.e.
\begin{equation*}
    dX^*_t=b\tonde{t,X^*_t,\mu^*_t,\lambda^*_t}dt + dW^*_t, \quad X^*_0=\xi^*.
\end{equation*}
Since, for every $j \geq 1$, $(\xi^j,W^j,\mu,\lambda^j)$ are distributed as $(\xi^*,W^*,\mu^*,\lambda^*)$, by Theorem \ref{teorema_di_unicita_legge} the processes $(Y^j)_{j \geq 1}$ are identically distributed copies of $X^*$; moreover, the joint distribution of $(Y^j,\mu)$ under $\prob$ is the same of $(X^*,\mu^*)$ under $\prob^*$, which, by marginalizing at every time $t \in [0,T]$, implies that $Y^j$ satisfies the consistency condition \eqref{def_mean_field_sol:cons} as well.

\medskip
For every fixed $t \in [0,T]$, by the triangular inequality, it holds
\begin{equation}\label{lemma_poc:intermedio1}
\begin{aligned}
    \E\quadre{\pwassmetric{2}{\R^d}{2}(\mu^N_t,\mu_t)} & \leq C \E \quadre{ \pwassmetric{2}{\R^d}{2}\tonde{\mu^N_t,\nu^N_t} + \pwassmetric{2}{\R^d}{2}\tonde{\nu^N_t,\eta^N_t} + \pwassmetric{2}{\R^d}{2}\tonde{\eta^N_t,\mu_t}}.
\end{aligned}
\end{equation}
We start from the third term in \eqref{lemma_poc:intermedio1}: let $\prob^m$ be a version of the regular conditional probability of $\prob$ given $\mu=m$, and denote by $\E^m[\cdot]$ the expectation with respect to the measure $\prob^m$.
By construction, the strategies $(\lambda^j)_{j\geq 1}$ associated to the admissible recommendations $(\Lambda^j)_{j \geq 1}$ are i.i.d. under $\prob^m$, for $\rho$-a.e. $m \in \contpdue$.
Since $\mu$ is independent of $(W^j)_{j \geq 1}$ and $(\xi^j)_{j \geq 1}$ under $\prob$, the processes $(Y^j)_{j \geq 1}$ are independent under $\prob^m$.
Moreover, since $\mu_t(\cdot)=\prob( Y^j_t \in \cdot \; \vert \; \mu )$ $\prob$-a.s. for every $t \in [0,T]$ and $\mu_t=m_t$ $\prob^m$-a.s. for $\rho$-a.e. $m \in \contpdue$, we have
\begin{equation}\label{lemma_poc:consistency_disintegrate}
    m_t=\prob^m \circ (Y^j_t)^{-1}, \quad \rho\text{-a.e.}, \; \forall t \in [0,T],
\end{equation}
for every $j \geq 1$.
We can conclude that the processes $(Y^j_t)_{j \geq 1}$ are independent and identically distributed square integrable random variables with law $m_t$ under $\prob^m$, for every $t$ and for $\rho$-a.e. $m$.
Therefore, as ensured, e.g., by \cite[Volume I, (5.19)]{librone}, it holds
\begin{equation*}
    \lim_{N \to \infty} \E^m\quadre{\pwassmetric{2}{\R^d}{2}\tonde{\eta^N_t,\mu_t}} = 0, \quad \rho\text{-a.e.}, \; \forall t \in [0,T].
\end{equation*}
We observe that there exists a function $g: \contpdue \to \R$ so that $g \in L^1(\rho)$ and $\E^m[\pwassmetric{2}{\R^d}{2}(\mu^N_t,\mu_t) ] \leq g (m)$, $\rho$-a.e., for every $t$: indeed, since, under $\prob^m$, $Y^j_t$ are i.i.d with law $m_t$ and $\mu_t=m_t$ a.s., we have 
\begin{equation*}
\begin{aligned}
    \E^m & \quadre{\pwassmetric{2}{\R^d}{2}\tonde{\eta^N_t,\mu_t}} \leq 2 \E^m\quadre{\pwassmetric{2}{\R^d}{2}\tonde{\eta^N_t,\delta_0} + \pwassmetric{2}{\R^d}{2}\tonde{\delta_0,\mu_t}} \\
    & \leq 2 \tonde{\frac{1}{N}\sum_{k=1}^N\E^m\quadre{\abs{Y^k_t}^2} + \int_{\R^d}\abs{y}^2m_t(dy)}  \leq 2 \tonde{\frac{1}{N}\sum_{k=1}^N\E^m\quadre{\abs{Y^1_t}^2} + \E^m\quadre{\abs{Y^1_t}^2}} \\
    & \leq 4 \E^m\quadre{\abs{Y^1_t}^2} \leq 4 \E^m\quadre{\norm{Y^1}^2_{\contrd}}.
\end{aligned}
\end{equation*}
The function $g(m)=\E^m\quadre{\lVert Y^1 \rVert_{\contrd}}$ belongs to $L^1(\rho)$, since
\begin{equation}\label{lemma_poc:bound_uniforme}
    \int_{\contpdue} g(m)\rho(dm) = \E\quadre{ \E\quadre{\norm{Y^1}^2_{\contrd}\; \vert \; \mu}}= \E\quadre{\norm{Y^1}^2_{\contrd}} < \infty.
\end{equation}
Therefore, by dominated convergence theorem, we have 
\begin{equation}\label{lemma_poc:convergenza_wass_puntuale}
    \lim_{N \to \infty} \E\quadre{\pwassmetric{2}{\R^d}{2}\tonde{\eta^N_t,\mu_t}} = 0
\end{equation}
for every $t \in [0,T]$.
The convergence in \eqref{lemma_poc:convergenza_wass_puntuale} is actually uniform in time.
Indeed, fix $t,s \in [0,T]$: then
\begin{equation*}
\begin{aligned}
    \E & \quadre{\pwassmetric{2}{\R^d}{2}\tonde{\eta^N_t,\mu_t} - \pwassmetric{2}{\R^d}{2}\tonde{\eta^N_s,\mu_s}} \\
    & = \E \quadre{\tonde{\pwassmetric{2}{\R^d}{}\tonde{\eta^N_t,\mu_t} - \pwassmetric{2}{\R^d}{}\tonde{\eta^N_s,\mu_s}}\tonde{\pwassmetric{2}{\R^d}{}\tonde{\eta^N_t,\mu_t} + \pwassmetric{2}{\R^d}{}\tonde{\eta^N_s,\mu_s}}} \\
    & \leq C \E\quadre{\norm{Y^1}^2_{\contrd}}^\frac{1}{2} \E \quadre{\tonde{\pwassmetric{2}{\R^d}{}\tonde{\eta^N_t,\mu_t} - \pwassmetric{2}{\R^d}{}\tonde{\eta^N_s,\mu_s}}^2}^{\frac{1}{2}},
\end{aligned}
\end{equation*}
where we used Cauchy-Schwartz inequality together with the uniform in time bound given by \eqref{lemma_poc:bound_uniforme}.
By triangulating with $\eta^N_s$ and $\mu_s$, we get
\begin{equation*}
\begin{aligned}
    \E & \quadre{\tonde{\pwassmetric{2}{\R^d}{}\tonde{\eta^N_t,\mu_t} - \pwassmetric{2}{\R^d}{}\tonde{\eta^N_s,\mu_s}}^2} \leq C \tonde{\E \quadre{\pwassmetric{2}{\R^d}{2}\tonde{\eta^N_t,\eta^N_s}} + \E\quadre{\pwassmetric{2}{\R^d}{2}\tonde{\mu_t,\mu_s}}} \\
    & \leq C \tonde{\E\quadre{\frac{1}{N}\sum_{k=1}^N \abs{Z^k_t - Z^k_s}^2} + \E \quadre{ \E\quadre{\pwassmetric{2}{\R^d}{2}\tonde{\mu_t,\mu_s}\; \vert \; \mu }} } \\
    & \leq C \tonde{\E\quadre{\frac{1}{N}\sum_{k=1}^N \abs{Z^k_t - Z^k_s}^2} + \E\quadre{\abs{Y^1_t - Y^1_s}^2} },
\end{aligned}
\end{equation*}
where in the last inequality we used \eqref{lemma_poc:consistency_disintegrate} and tower property.
By using Lipschitz continuity of $b$, the triangular inequality and $\E[\lVert Y^1 \rVert_{\contrd}]<\infty$, it is straightforward to see that $\E [ \lVert Z^k \rVert_{\contrd} ] \leq C$ for every $k \geq 1$, for some positive constant $C$ independent of $k$.
By the same arguments, we have 
\begin{equation*}
\begin{aligned}
    \E \quadre{\abs{Z^k_t - Z^k_s}^2 } & \leq C \E\quadre{\int_s^t \abs{ b(u,Z^k_u,\mu_u,\gamma^k_u) }^2 du } \\
    & \leq C \E\quadre{\int_s^t \tonde{ 1 + \abs{Z^k_u}^2 + \int_{\R^d}\abs{y}^2\mu_u(dy) + \abs{\gamma^k_u}^2} du }\\
    & \leq C \E\quadre{\int_s^t \tonde{ 1 + \norm{Z^k}^2_{\contrd} + \norm{Y^1}^2_{\contrd} + \abs{\gamma^k_u}^2} du } \leq C\abs{t-s},
\end{aligned}
\end{equation*}
where the constant $C$ depends upon $T$, $b$, $\E[\lVert Y^1 \rVert ^2 _{\contrd}] < \infty$ and $\text{diam}(A)$, which is a finite quantity since the set $A$ of actions is compact by Assumption \ref{standing_assumptions}.
Analogously holds for $\E[\vert Y^1_t - Y^1_s \vert ]$, which implies that 
\begin{equation}\label{lemma_poc:convergenza_uniforme}
\begin{aligned}
    \abs{\E \quadre{\pwassmetric{2}{\R^d}{2}\tonde{\eta^N_t,\mu_t} - \pwassmetric{2}{\R^d}{2}\tonde{\eta^N_s,\mu_s}}} \leq C \abs{t-s}^\frac{1}{2}.
\end{aligned}
\end{equation}
This is enough to conclude, by Arzel\`a-Ascoli theorem, that the convergence in \eqref{lemma_poc:convergenza_wass_puntuale} is uniform in time.


\medskip
Remind from Section \ref{sezione_notations_assumptions} that $\norm{x}_{t,\contrd}=\sup_{s \in [0,t]}\abs{x_s}$, $t \in [0,T]$.
To handle the second term in \eqref{lemma_poc:intermedio1}, we use the coupling of $\nu^N$ and $\eta^N$ given by $\frac{1}{N}\sum_{k=1}^N\delta_{(Z^k,Y^k)}$, together with the Lipschitz continuity of $b$:
\begin{equation*}
\begin{aligned}
    \E\quadre{\norm{Z^k-Y^k}^2_{t,\contrd}} & =\E\quadre{\sup_{0 \leq s \leq t} \tonde{\int_0^s \tonde{b\tonde{u,Z^k_u,\mu_u,\gamma^k_u} - b\tonde{u,Y^k_u,\mu_u,\lambda^k_u}}du}^2} \\
    & \leq C \left( \int_0^t \E\quadre{ \sup_{0 \leq u \leq s} \abs{Z^k_u - Y^k_u }^2}ds +  \int_0^t \E\quadre{ \abs{\lambda^k_t - \gamma^k_t}^2} ds \right).
\end{aligned}
\end{equation*}
By definition of $(\gamma^k)_{k \geq 1}$, we have
\begin{equation*}
    \int_0^T \E\quadre{\abs{\lambda^k_u-\gamma^k_u}^2}du=\begin{cases}
    & \int_0^T \E\quadre{\abs{\lambda^1_u-\beta_u}^2}du \qquad k = 1,\\
    & 0 \qquad \qquad \qquad \qquad  \qquad \quad k \geq 2.
    \end{cases}
\end{equation*}
Therefore, by Gronwall's lemma, we sum over $k=1,\dots,N$ to obtain the estimate
\begin{equation}\label{stime_poc_controlli}
\begin{aligned}
    \sup_{t \in [0,T]} & \E\quadre{\pwassmetric{2}{\R^d}{2}\tonde{\eta^N_t,\nu^N_t}} \leq \E\quadre{\pwassmetric{2}{\contrd}{2}\tonde{\eta^N,\nu^N}} \leq \frac{C}{N} \sum_{k=1}^N \E\quadre{\norm{Y^k - Z^k}_{\contrd}} \\
    & \leq \frac{C}{N} \sum_{j=1}^N \int_0^T \E\quadre{\abs{\lambda^j_u-\gamma^j_u}^2}du = \frac{C}{N} \int_0^T \E\quadre{\abs{\lambda^1_u-\beta_u}^2}du  \leq \frac{C}{N} \overset{N \to \infty}{\longrightarrow} 0,
\end{aligned}
\end{equation}
where the constant $C$ depends only upon $T$, $b$ and $\text{diam}(A)$.

\medskip
Finally, for the first term of \eqref{lemma_poc:intermedio1}, we use the coupling of $\mu^N_t$ and $\nu^N_t$ given by $\frac{1}{N}\sum_{k=1}^N\delta_{(X^{k,N}_t,Z^k_t)}$, together with the Lipschitz continuity of $b$:
\begin{equation*}
\begin{aligned}
    \E & \quadre{\norm{X^{k,N}-Z^k}^2_{t,\contrd}} \leq C \int_0^t \left( \E\quadre{ \sup_{0 \leq u \leq s} \abs{X^{k,N}_u - Z^k_u}^2} + \E\quadre{ \pwassmetric{2}{\R^d}{2}(\mu^N_s,\mu_s) } \right) ds \\
    & \leq C  \int_0^t \left( \E\quadre{ \sup_{0 \leq u \leq s} \abs{X^{k,N}_u - Z^k_u}^2} + \E\quadre{ \pwassmetric{2}{\R^d}{2}(\mu^N_s,\nu^N_s)} + \E\quadre{ \pwassmetric{2}{\R^d}{2}(\nu^N_s,\mu_s) } \right) ds \\
    & \leq C \int_0^t \left( \E\quadre{ \sup_{0 \leq u \leq s} \abs{X^{k,N}_u - Z^k_u}^2} + \frac{1}{N}\sum_{j=1}^N \E\quadre{ \abs{X^{j,N}_s - Z^j_s}^2 } + \E\quadre{ \pwassmetric{2}{\R^d}{2}(\nu^N_s,\mu_s) }\right) ds \\
    & \leq  C \left( \int_0^t \max_{k=1,\dots,n} \E\quadre{ \sup_{0 \leq u \leq s} \abs{X^{k,N}_u - Z^k_u}^2} ds + \sup_{s \in [0,t]}\E\quadre{ \pwassmetric{2}{\R^d}{2}(\nu^N_s,\mu_s) }\right).
\end{aligned}
\end{equation*}
By taking the maximum over $k=1,\dots,N$ on the left-hand side and applying Gronwall's lemma, we get
\begin{equation*}
    \max_{k=1,\dots,N} \E \quadre{\norm{X^{k,N}-Z^k}^2_{\contrd}} \leq C \sup_{t \in [0,T]}\E\quadre{ \pwassmetric{2}{\R^d}{2}(\nu^N_t,\mu_t) } \to 0,
\end{equation*}
by \eqref{lemma_poc:convergenza_wass_puntuale}, \eqref{lemma_poc:convergenza_uniforme} and \eqref{stime_poc_controlli}, which proves \eqref{lemma_poc:conv_norma}.
Coming back to \eqref{lemma_poc:conv_wasserstein}, we have
\begin{equation*}
\begin{aligned}
    \sup_{t \in [0,T]} \E\quadre{ \pwassmetric{2}{\R^d}{2}\tonde{\mu^N_t,\nu^N_t} } \leq \sup_{ t \in [0,T] } \frac{1}{N} \sum_{k=1}^N \E\quadre{\abs{X^{k,N}_t - Z^k_t }^2} \leq \max_{k=1,\dots,N}\E\quadre{ \norm{X^{k,N} - Z^k}_{\contrd}^2} \to 0.
\end{aligned}
\end{equation*}
This estimate together with estimates \eqref{lemma_poc:convergenza_wass_puntuale}, \eqref{lemma_poc:convergenza_uniforme} and \eqref{stime_poc_controlli} implies \eqref{lemma_poc:intermedio1} and therefore \eqref{lemma_poc:conv_wasserstein}.
Finally, \eqref{lemma_poc:finitezza_momenti} follows from the above calculations.
\end{proof}
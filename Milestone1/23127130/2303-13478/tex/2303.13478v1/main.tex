\documentclass{amsart}
\usepackage{xcolor,fullpage,amsmath,mathtools}
\usepackage{url}
\usepackage[colorlinks=true, urlcolor=blue,citecolor=blue,anchorcolor=blue]{hyperref}
\usepackage[capitalise]{cleveref}
\usepackage{mymacros}
\usepackage{breqn}
\usepackage{caption}
\usepackage{amssymb}


\newcommand{\connor}[1]{{\color{red} Connor: #1}}
\renewcommand{\connor}[1]{}
\newcommand{\mj}[1]{{\color{blue} MJ: #1}}
\renewcommand{\mj}[1]{}
\newcommand{\jb}[1]{{\color{orange} JB: #1}}
\renewcommand{\jb}[1]{}

\usepackage[numbers,sort&compress]{natbib}


\DeclarePairedDelimiter{\eqc}{\llbracket}{\rrbracket}

% bold vectors-----------------
\usepackage{bm}
\let\vec\bm 

%---------------------
%shortcuts for notation-----------------------------------
\newcommand{\Cut}{\Delta}
\newcommand{\cut}{\Cut}%off diagonal matrix block for cut
\newcommand{\Cutbar}{\overline{\Cut}} %off-diagonal matrix block onto Sbar
\newcommand{\projS}{P_S} %projector onto S
\newcommand{\projSbar}{P_{\overline{S}}} %projector onto Sbar
\newcommand{\HH}{H} %full Hamiltonian
\newcommand{\HS}{H_{S}} %the S block
\newcommand{\HSbar}{H_{\overline{S}}}
\newcommand{\HSdot}{\dot{H}_{S}}
\newcommand{\Uad}{V} %adiabatic unitary
\newcommand{\Ubd}{U} %unitary block diagonal with delta perturbed away from GS
\newcommand{\gsproj}{P_\lambda} %projector onto gs of full space
\newcommand{\gse}{\lambda} %eigenvalue of gs of full space
\newcommand{\gsprojS}{P_\mu} %projector onto gs of H_S
\newcommand{\gseS}{\mu} %eigenvalue of gs of H_S
\newcommand{\gsevalSbar}{\overline{\mu}} %eigenvalue of gs of H_Sbar
\newcommand{\h}{h} %cheeger constant
\newcommand{\gap}{\Gamma} %full gap
\newcommand{\gapS}{\Gamma_S} %local gap
\newcommand{\gapSbar}{\Gamma_{\overline{S}}} %local gap Sbar
\newcommand{\gsprojSperp}{P_\mu^\perp}
\newcommand{\gsrS}{\lambda_S} %the eigenvalue of the gs of the full space projected onto S


\makeatletter
\g@addto@macro{\endabstract}{\@setabstract}
\newcommand{\authorfootnotes}{\renewcommand\thefootnote{\@fnsymbol\c@footnote}}%
\makeatother

\begin{document}
\begin{center}
  \LARGE
  On the stability of solutions to Schr\"{o}dinger's equation \\ short of the adiabatic limit \par \bigskip

  \normalsize
  \authorfootnotes
  Jacob Bringewatt\textsuperscript{1,2}, Michael Jarret\textsuperscript{3,4,5}, T. C. Mooney\textsuperscript{1,2}\par \bigskip
  \textsuperscript{1}Joint Center for Quantum Information and Computer Science, NIST/University of Maryland College Park, Maryland 20742, USA\par
  \textsuperscript{2}Joint Quantum Institute, NIST/University of Maryland College Park, Maryland 20742, USA \par 
  \textsuperscript{3}Department of Mathematical Sciences, George Mason University, Fairfax, VA, 22030, USA \par 
  \textsuperscript{4}Department of Computer Science, George Mason University, Fairfax, VA, 22030, USA \par 
  \textsuperscript{5}Quantum Science and Engineering Center, George Mason University, Fairfax, VA, 22030, USA \par \bigskip

  \today
\end{center}

\begin{abstract}
    We prove an adiabatic theorem that applies at timescales short of the adiabatic limit. Our proof analyzes the stability of solutions to Schrodinger's equation under perturbation. We directly characterize cross-subspace effects of perturbation, which are typically significantly less than suggested by the perturbation's operator norm. This stability has numerous consequences: we can (1) find timescales where the solution of Schrodinger's equation converges to the ground state of a block, (2) lower bound the convergence to the global ground state by demonstrating convergence to some other known quantum state, (3) guarantee faster convergence than the standard adiabatic theorem when the ground state of the perturbed Hamiltonian ($H$) is close to that of the unperturbed $H$, and (4) bound tunneling effects in terms of the global spectral gap when $H$ is ``stoquastic'' (a $Z$-matrix). Our results apply to quantum annealing protocols with faster convergence than usually guaranteed by a standard adiabatic theorem. Our upper and lower bounds demonstrate that at timescales short of the adiabatic limit, subspace dynamics can dominate over global dynamics. Thus, we see that convergence to particular target states can be understood as the result of otherwise local dynamics. 
\end{abstract}

\section{Introduction}
 Let $A(t) \in \mathbb{C}^{N \times N}$ with $t \in [0,T]$ be a one-parameter family of bounded, Hermitian operators acting on the Hilbert space $\mathcal{H}=\mathbb{C}^N$ endowed with the following inner product:
\begin{equation}
    \langle u, v\rangle = \sum_{j=0}^{N-1} u^*_jv_j.
\end{equation}
Note that this inner product is anti-linear in the first argument and linear in the second, following the convention of physicists. Let the eigenvalues of $A(t)$ be denoted as $\lambda(t)=\lambda_0(t) < \lambda_1(t) \leq \lambda_2(t) \dots \leq \lambda_{N-1}(t)$ with corresponding eigenvectors $\vec\lambda(t),\vec\lambda_1(t),\dots,\vec\lambda_{N-1}(t)$.
A quantum adiabatic theorem is any theorem that bounds the convergence of solutions to Schr\"odinger's equation with initial condition 
\begin{equation}\label{eqn:Schrodinger}
    \begin{cases}
        i \frac{d \vec\psi}{dt} = A(t) \vec\psi(t) \\
        \vec\psi(0) = \vec\lambda_j(0)
    \end{cases}
\end{equation}
such that $\vec\psi(t) \approx \vec\lambda_j(t)$ for all $t \in [0,T]$. (Most frequently, $j$ is taken to be $0$, however these theorems can apply to any choice of $j \in \mathbb{Z}_{N}$.) The operator $A$ is the Hamiltonian.\footnote{Physicists might object to the fact we are calling this operator $A$ instead of the typical (and natural) choice $H$. However, $H$ will soon be used to refer to a Hamiltonian with a special block-diagonal structure and, consequently, we hold off on using it.} Adiabatic theorems, originally introduced by Einstein \cite{einstein1914verh} and Ehrenfest \cite{Ehrenfest}, were not provided a general, rigorous treatment until Kato in 1950 \cite{Kato}. 
The folk version of the adiabatic theorem says:
\begin{sthm}\label{sthm:folk_adiabatic}
For the initial value problem considered of \cref{eqn:Schrodinger} and initial condition $\vec\psi(0) = \vec\lambda_0(0)$, then 
\[
\norm{\vec\psi(t) - \vec\lambda_0(t)} \leq \max_{t\in[0,T]}\frac{\norm{\frac{dA}{dt}}}{\left(\lambda_1(t)-\lambda_0(t)\right)^2}.
\]
\end{sthm}
In other words, if $A$ varies slowly enough with respect to $t$, then the solution to Schr\"{o}dinger's equation initialized to the lowest eigenvector of $A(0)$ remains instantaneously close to that eigenvector at all times $t \in [0,T]$. Hereafter, we will refer to the difference $\Gamma(t):=\lambda_1(t)-\lambda_0(t)$ as the \textbf{spectral gap} or \textbf{gap} of $A$. Depending upon various assumptions and whether we are considering the case of $T \rightarrow \infty$, rigorous versions of the adiabatic theorem may depend upon higher derivatives of $A$~\cite{jansen2007bounds} and may not depend upon the gap. 

\subsection{Our contributions}
Let $S\subset \mathcal{H}$ be a linear subspace and let $\overline{S}:=S^\perp$ be its complement. Given any subspace $Q$, let $P_Q$ denote the orthogonal projection onto it. Letting $s:=t/T\in[0,1)$, we consider a one-parameter family of Hamiltonions $A(s)=H(s)+\Delta(s)$ where $H(s)$ respects the grading $\mathcal{H}=S\oplus \overline{S}$ and $\mathrm{supp}(\vec\lambda(s))\cap S \neq \emptyset$ for all $s$ and $\Delta(s)$ is a block-antidiagonal perturbation. That is, for all $s$, $[H_0(s),P_S]=[H_0(s),P_{\overline{S}}]=0$, $\Delta(s)P_S=P_{\overline{S}}\Delta(s)$, and $\Delta(s)P_{\overline{S}}=P_{{S}}\Delta(s)$. For future convenience, we also define
 \begin{equation}\label{eq:HSHSbar}
 H_S(s):=P_SH(s)P_S \qquad \text{and} \qquad
 H_{\overline{S}}(s):=P_{\overline{S}}H(s)P_{\overline{S}}.
 \end{equation}

Subject to some minor additional assumptions on $H$ and $S$, we prove that something like the standard adiabatic theorem applies to the state $\vec\psi(t)$ at timescales lower bounded by the local spectral gap (of $H_S$) and upper bounded by a weighted verison of the \textbf{Cheeger ratio}~\cite{chung2000weighted,jarret2018hamiltonian}, which can be understood to quantify the rate of transitions of the state $\vec\psi(t)$ out of $S$ under evolution by the Schr\"odinger equation in \cref{eqn:Schrodinger}. 
\begin{definition}[Cheeger ratio]\label{def:cheeger}
    For $H_0, \Cut$ defined as above the \textbf{Cheeger ratio} is defined as
    \[
    \h(s):=\begin{cases}
        -\frac{\langle \vec\lambda,\Cut \projS \vec\lambda\rangle}{\min\{\langle{\vec\lambda},P_S{\vec\lambda}\rangle, \langle{\vec\lambda},\projSbar{\vec\lambda}\rangle\}}, & \text{if } \min\{\langle{\vec\lambda},P_S{\vec\lambda}\rangle, \langle{\vec\lambda},\projSbar{\vec\lambda}\rangle\} \neq 0 \\
        0, & \text{otherwise}.
    \end{cases} 
    \]
\end{definition}
Note that \cref{def:cheeger} is slightly abusive compared to the standard definition for the Cheeger ratio, where one would let $h_S$ be the quantity defined in \cref{def:cheeger} and let $h:=\min_{S} h_S$ be the Cheeger constant. Here, we do not assume such a minimization until \Cref{corr:stoq} and consequently drop the $S$ subscript for notational convenience.

In particular, we prove the following ``theorem''  (see \cref{s:results} for the fully rigorous statement). 
\begin{sthm}[Main result]\label{qthm:mainresult}
Let $s:=t/T\in[0,1]$ Let $U(s=1)$ be the unitary evolution generated by the Hamiltonian $H(s)+\Delta(s)$, where $H(s)=H_S+H_{\overline{S}}$ is block diagonal and $\Delta(s)$ is a block anti-diagonal perturbation. Let $V_{\mathrm{ad}}(1)$ be the adiabatic unitary evolution generated by $H(s)$. When acting on the initial ground space $P_{\mu(0)}$ of the block $S$
\[
\norm{(U(1)-V_{\mathrm{ad}(1)})P_{\mu(0)}}\leq \mathcal{O}(\max_{s\in[0,1]}\sqrt{hT})+\mathcal{O}(\text{usual adiabatic error for } H_S).
\]
\end{sthm}

This result bounds the error between the ``true'' unitary evolution $U$ generated by the Hamiltonian $H(s)+\Delta(s)$ and adiabatic unitary evolution generated by the block diagonal Hamiltonian $H(s)$. Note that the bound consists of two pieces: the first term scales with the total time $\sim\sqrt{T}$ and can be intuitively understood as the error that arises due to ``tunneling'' between the subspaces $S,\overline{S}$. The rate of this tunneling is determined by the Cheeger ratio $h$. The second term scales like $\sim 1/T$ and can be understood as something like the usual adiabatic error applied to the subspace $S$. Importantly, the standard adiabatic error is governed by the eigenvalue gap between the smallest and next-smallest eigenvalues of the relevant Hamiltonian. Consequently, this error is determined by the ``local'' eigenvalue gap of $H_S$, as opposed to the global eigenvalue gap of $H(s)+\Delta(s)$, as in the standard adiabatic theorem. This local gap is generically larger than the global one.

Given that interplay between an error term that scales like $\sqrt{T}$ and one that scales like $1/T$, we see that we can intuitively view our result as an ``intermediate timescale adiabatic theorem,'' where the timescale of applicability is governed by the Cheeger constant and the local gap. 


Our results have three primary use cases: (1) To prove that, under perturbation, there exist timescales where the solution of Schrodinger's equation converges to the lowest eigenstate of a block, (2) extending this, providing a lower bound on convergence to the ground state, by demonstrating convergence to some other (known) quantum state, and (3) when the ground state of a perturbed Hamiltonian $H + \Delta$ is close to the ground state of an unperturbed, block-diagonal $H$, the theorem can provide faster convergence than that predicted by the standard adiabatic theorem. These are particularly applicable to the analysis of adiabatic quantum computation and quantum annealing, as discussed in detail in \cref{s:discussion}. 

\section{Preliminaries}
In this section, we develop some additional notation and derive the preliminary results that are needed as a building block for proving the rigorous version of ``Theorem'' \ref{qthm:mainresult}.
To begin, recall that we denote the spectrum of $H(s)+\Cut(s)$ as $\set{\lambda_j(s)},$ with $\lambda(s):=\lambda_0(s)<\lambda_1(s)<\lambda_2(s)<\cdots<\lambda_N(s).$ Further, denote the spectrum of $H_S(s)\vert_S$ as $\set{\mu_j(s)}$ with $\mu(s):=\mu_0(s)<\mu_1(s)<\mu_2(s)<\cdots$. Finally, denote the spectrum of $H_{\overline{S}}(s)\vert_{\overline{S}}$ as $\set{\overline{\mu}_j(s)}$ with $\overline{\mu}(s):=\overline{\mu}_0(s)<\overline{\mu}_1(s)<\overline{\mu}_2(s)<\cdots$. Then define the \textbf{eigenvalue gaps} or gaps of $(H(s)+\Cut(s))$, $H_S(s)$, and $H_{\overline{S}}(s)$ as
\begin{align}
    \gamma(s)&:=\lambda_1(s)-\lambda(s), \nonumber\\
    \Gamma_S(s)&:=\mu_1(s)-\mu(s), \nonumber\\
    \Gamma_{\overline{S}}(s)&:=\overline{\mu}_1(s)-\overline{\mu}(s),
\end{align}
respectively. From here on, we drop the explicit $s$ dependence of operators to avoid cluttering the notation, whenever it is not an impediment to clarity. The only quantities not considered to be $s$-dependent will be the subspaces $S$, $\overline{S}$. Given these definitions, we have the following proposition:
\begin{prop}\label{prop:evalfacts} 
 Let
\[
\lambda_S(s) := \frac{\inprod{\vec\gse}{\HS\vec{\gse}}}{\inprod{\vec\gse}{\projS\vec{\gse}}}.
\] 
Then, the following inequalities hold:
\begin{enumerate}
    \item \label{prop:evalfacts1} $\gse \leq \min\set{\gseS , \gsevalSbar}$,
    \item \label{prop:evalfacts2}$\gseS \leq \gsrS$, and 
    \item \label{prop:evalfacts3}$\gsrS \leq \gse + \h$.
\end{enumerate}
\end{prop}

\begin{proof}
    Without loss of generality, suppose that $\gseS = \min\{\gseS,\gsevalSbar\}$. \Cref{prop:evalfacts1} follows immediately from the fact that $\gseS$ is the smallest eigenvalue of $\HS \vert_S$ and Cauchy's interlace theorem \cite[Corollary III.1.5]{Bhatia}. \Cref{prop:evalfacts2} follows from a simple variational argument,
    \begin{align*}
        \gse &= \inf_{\vec\psi \in \mathcal{H}} \frac{\inprod{\vec\psi}{H\vec\psi}}{\inprod{\vec\psi}{\vec\psi}}
        \\&\leq \inf_{\vec\psi \in S} \frac{\inprod{\vec\psi}{H\vec\psi}}{\inprod{\vec\psi}{\vec\psi}} = \gseS
        \\&\leq \frac{\inprod{\projS\vec\gse}{H\projS\vec\gse}}{\inprod{\projS\vec\gse}{\projS\vec\gse}}
        \\&=\lambda_S.
   \end{align*}    
This establishes \Cref{prop:evalfacts2}. (This is also an alternative proof of \Cref{prop:evalfacts1}.) For \Cref{prop:evalfacts3}, the fact that $H \vec\gse = \gse \vec\gse$, implies that $\gse\projS\vec{\gse}=\projS H\vec{\gse}$. Consequently,
\begin{align*}
    \gse \inprod{\vec\gse}{\projS\vec{\gse}} &= \inprod{\vec{\gse}}{\projS\HS\projS\vec{\gse}} + \inprod{\vec\gse}{\projS {H}\projSbar\vec{\gse}}, \nonumber\\
\end{align*}
which implies that
\begin{align*}
    \gse &= \gsrS + \frac{\inprod{\vec\gse}{\projS H \projSbar\vec{\gse}}}{\inprod{\vec\gse}{\projS\vec{\gse}}}
    \\&= \gsrS + \h\min\set*{\frac{\inprod{\vec\gse }{\projSbar \vec\gse}}{\inprod{\vec\gse}{\projS \vec\gse}},1}.
\end{align*}
Therefore, we have that 
\[
    \gse=\gsrS + \h\min\set*{\frac{\inprod{\vec\gse}{\projSbar \vec\gse}}{\inprod{\vec\gse}{\projS\vec\gse}}, 1},
\]
establishing \cref{prop:evalfacts3}. 
\end{proof}
Recall that we assumed that the Hamiltonian $H+\Delta$ is such that $\vec\lambda$ has support on $S$ and, consequently, the quantity $\lambda_S$ defined in \cref{prop:evalfacts} is well-defined. 

It will also be convenient to define a a few additional operators. In particular, we define orthogonal projectors onto the ground spaces of $S, \overline{S}$:
\begin{align}\label{eq:pmu}
    P_\mu(s)&:=P_{\mathrm{span}\set{\vec x|H_S\vec x=\mu \vec x}} \nonumber \\
    P_{\overline{\mu}}(s)&:=P_{\mathrm{span}\set{\vec x|H_{\overline{S}}\vec x=\overline{\mu}\vec x}}.
\end{align}
 Given these, we also define
\begin{align}
    \Delta^\perp(s):=(I-P_\mu-P_{\overline{\mu}})\Delta(I-P_\mu-P_{\overline{\mu}}),
\end{align}
which is the block-antidiagonal pertubation $\Delta$ projected away from the local ground spaces $P_\mu$ and $P_{\overline{\mu}}$.

Finally, we define a collection of time evolution operators generated by the various Hamiltonians we have defined. In particular, let $U(s)$, $U_\perp(s)$, and $V(s)$ be one-parameter families of unitary operators defined by initial value condition $U(0)=U_\perp(0)=V(0)=I$ and
\begin{align}\label{eq:unitaries}
    i\dot{U}(s)&=T(H(s)+\Cut(s))U(s), \nonumber \\
    i\dot{U}_\perp(s)&=T(H(s)+\Cut^\perp(s))U_\perp(s), \nonumber \\
    i\dot{V}(s)&=TH(s)V(s),
\end{align}
respectively. Finally, let the adiabatic unitary corresponding to $V(s)$ be the solution to $V_{\mathrm{ad}}(0)=I$
\begin{align}\label{eq:Vad}
    i\dot{V}_{\mathrm{ad}}(s)=\left(TH(s)+i[\dot{P}_\mu(s), P_\mu(s)]\right)V_{\mathrm{ad}}(s),
\end{align}
where $\dot P_\mu, \dot P_{\overline{\mu}}$ denotes a derivative with respect to $s$.


\section{Spectral Bounds}\label{s:spectral_bounds}
In this section, we present a number of results bounding the spectral norms of many of the quantities defined in the previous section. In addition to being useful for proving our main result in the following section, some of these results may be of independent interest. 

We begin with some assumptions on $H$ and $\Cut$:
\begin{assmpn}\label{assmpn:tbd}
    Let $H,$ $\mu,\overline\mu,$ $\mu_1,$ and $\overline\mu_1$ be defined as above. Then assume $\min\{\mu_1,\overline\mu_1\}> \max\{\mu,\overline\mu\}.$ 
\end{assmpn}
\begin{assmpn}\label{assmpn:tbd2}
    Let $H,$ $\Gamma_S,\Gamma_{\overline S},$ and $\Cut$ be defined as above. Then assume $\Vert\Cut\Vert \leq c \min\{\Gamma_S,\Gamma_{\overline S}\}$ where $c\leq 1-h/\min\{\Gamma_S,\Gamma_{\overline S}\}\leq 1$.
\end{assmpn}
We remark that these two assumptions are necessary not only for our bounds to be proven in the way we do so, but also for them to be useful, and, thus, they are not particularly imposing. 
\begin{lemma}\label{prop:Pmunorms}
    Let $P(s)$ be the spectral projection of a $C^2([0,1])$ one-parameter family of Hamiltonians $H(s)$ onto $S(s)\subseteq \mathbb{C}.$ Further, let $\mathrm{dist}(S(s), \sigma(H(s))\backslash S(s))\geq \delta(s)>0.$
    Then, letting $m(s)$ be the number of eigenvalues (counting multiplicity) contained in $S(s),$
    \[
     \norm{\dot P} \leq \frac{\norm{ \dot{H}}}{\delta}.
    \] Further, 
    \[\norm{(I-P)\ddot P P}\leq \sqrt{m(s)}\frac{\norm{\ddot H}}{\delta} + 4m(s)\frac{\norm{\dot H}^2}{\delta^2}\]
    
\end{lemma}
\begin{proof}
    Recall that 
    \[\dot{P}(s) := \lim_{d\to 0}\frac{P(s+d)-P(s)}{d}.\] By the Davis-Kahan theorem \cite[Thm. VII.3.1]{Bhatia}, we have that 
    \begin{align*}\Vert P(s+d)-P(s)\Vert &= \Vert P^\perp(s+d)P(s)\Vert \\
    &\leq \frac{\Vert P^\perp(s+d)(H(s+d)-H(s))P(s)\Vert}{\mathrm{dist}(S(s+d), \sigma(H(s))\backslash S(s))}\\
    &\leq \frac{\Vert H(s+d)-H(s))\Vert}{\mathrm{dist}(S(s+d), \sigma(H(s))\backslash S(s))}\\
    \end{align*}
    Taking the limit, we have that 
    \begin{align*}
        \Vert \dot{P}(s)\Vert &= \lim_{d\to 0} \frac{\Vert P(s+d)-P(s)\Vert}{d}\\
        &\leq \lim_{d\to 0}\frac{1}{d}\frac{\Vert H(s+d)-H(s)\Vert}{\mathrm{dist}(S(s+d), \sigma(H(s))\backslash S(s))}\\
        &= \left(\lim_{d\to 0}\frac{\Vert H(s+d)-H(s)\Vert} {d}\right)\left(\lim_{d\to 0} \frac{1}{\mathrm{dist}(S(s+d), \sigma(H(s))\backslash S(s))}\right)\\
        &= \frac{1}{\delta(s)}\left\Vert \lim_{d\to 0}\frac{H(s+d)-H(s)}{d}\right\Vert\\
        &= \frac{\Vert\dot H(s)\Vert}{\delta(s)},
    \end{align*}
    where we have that both limits on the third line exist because $H\in C^2([0,1]),$ implying that it is continuously differentiable and its spectrum is continuous. The bound on $(I-P)\ddot P P$ is proven in \cite[Lemma 8]{jansen2007bounds}.
\end{proof}
Note that the bound on $\norm{\dot P(s)}$ is a factor of $\sqrt{m}$ tighter than that considered in \cite[Lemma 8]{jansen2007bounds}. We also believe the bound on $\norm{\ddot{P}}$ can be similarly improved to at least remove the factor of $m$ multiplying $\norm{\dot{H}}$, but we leave this for future analysis.
We will be applying this lemma to $P_\mu$ and $P_{\overline\mu}:$
\begin{cor}
    Let $P_\mu, P_{\overline\mu}$ $H_S,$ $H_{\overline{S}},$ $\Gamma_S,$ and $\Gamma_{\overline{S}}$ be defined as above. Then
    \[\Vert \dot P_\mu\Vert \leq \frac{\Vert \dot H_S\Vert}{\Gamma_S}\]
    and 
    \[\Vert (P_S-P_\mu)\ddot{P}_\mu P_\mu\Vert \leq \frac{\norm{\ddot H_S}}{\Gamma_S^2}+4\frac{\norm{\dot H_S}}{\Gamma_S}.\] The same bounds hold if $\mu$ and $S$ are replaced by $\overline\mu$ and $\overline S$ respectively.
\end{cor}
Using the projectors $P_\mu$ and $P_{\overline{\mu}}$ we are now ready to proceed with \cref{lem:expected_norm}. 

\begin{lemma}\label{lem:expected_norm}
    Let $P_\mu$ and $P_{\overline{\mu}}$ be the projectors onto the eigenvectors of $H_0$ corresponding to eigenvalues $\mu$ and $\overline\mu$ respectively. If $\mathcal{M} = P_\mu + P_{\overline\mu}$, then
    \[
        \norm{\mathcal{M}\Delta \mathcal{M}} \leq  h.
    \]
\end{lemma}
\begin{proof}
    Note that $\mathcal{M}\Cut \mathcal{M}=P_\mu \Cut P_{\overline{\mu}} + P_{\overline\mu} \Cut P_{{\mu}}$ is block-antidiagonal, meaning that $\Vert \mathcal{M}\Cut \mathcal{M}\Vert = \Vert P_\mu \Cut P_{\overline{\mu}}\Vert .$ Thus, we have 
    \begin{align*}
        \Vert \mathcal{M}\Cut\mathcal{M}\Vert &= \Vert P_\mu \Cut P_{\overline{\mu}}\Vert \\
       &= \Vert P_\mu (H+\Delta-\lambda)P_{\overline\mu}\Vert\\
       &\leq  \sqrt{ \Vert P_\mu (H+\Delta-\lambda)P_\mu \Vert \Vert P_{\overline\mu} (H+\Delta-\lambda)P_{\overline\mu} }\Vert\\
       &= \sqrt{(\mu-\lambda)(\overline\mu-\lambda)},
    \end{align*} where to get to the third line from the second we used Cauchy-Schwartz and that $H+\Cut-\lambda$ is positive-semidefinite. By \cref{prop:evalfacts}.\ref{prop:evalfacts2}-\ref{prop:evalfacts3}, we thus establish our result.
\end{proof}

We will also require the following, looser bound. 
\begin{lemma}\label{lemma:deltaonPmu}
Let $H$ and $\Cut$ be as given above with $\lambda$ the smallest eigenvalue of $H+\Cut$ and $\mu$ the smallest local eigenvalue of $H_S$  with $P_\mu$ the corresponding projector. Then it holds that
\[
\Vert \Delta P_\mu\Vert \leq \sqrt{h\kappa}+h,
\]
where $h$ is the Cheeger ratio (\cref{def:cheeger}) and $\kappa:= \norm{H+\Delta-\lambda}=\lambda_{n-1}-\lambda$.
\end{lemma}
\begin{proof}
    First,
    \begin{align}
        \norm{\cut \gsprojS} &= \norm{({H_0}+\Cut-\mu)\gsprojS} \nonumber
        \\&\leq \norm{({H}+\Cut-\gse)\gsprojS} + \norm{(\gse-\gseS)\gsprojS} \nonumber
        \\&\leq \norm{({H}+\Cut-\gse)\gsprojS} + \h. \label{eq:aa}
    \end{align}
    Now, note that by \Cref{prop:evalfacts}.\ref{prop:evalfacts1}, ${H}+\Cut - \gse$ is positive semi-definite. Thus, $\sqrt{H+\Cut - 
 \gse}$ is well-defined. Hence,
    \begin{align}
        \norm*{({H}+\Cut-\gse)\gsprojS}&\leq \norm*{\sqrt{{H}+\Cut-\gse}}\norm*{\sqrt{{H}+\Cut-\gse}\gsprojS} \nonumber
        \\&=\norm*{\sqrt{{H}+\Cut-\gse}}\sqrt{\inprod{\vec\gseS}{(H+\Cut-\gse)\vec\gseS}} \nonumber
        \\&=\norm*{\sqrt{{H}+\Cut-\gse}}\sqrt{\gseS-\gse} \nonumber
        \\&\leq \norm*{\sqrt{{H}+\Cut-\gse}}\sqrt{\h}, \label{eq:ab}
    \end{align}
    where the final inequality follows from \Cref{prop:evalfacts}.\ref{prop:evalfacts3}. Combining \cref{eq:aa} with \cref{eq:ab}, we have that
    \[
        \norm{\cut \gsprojS} \leq \sqrt{\h\kappa} + \h.
    \]
\end{proof}
\begin{cor}\label{cor:deltaonPmubar}
It also holds that:
\[
\Vert \Delta P_{\overline{\mu}}\Vert \leq \sqrt{h\kappa}+h,
\]
\end{cor}
\begin{proof}
    The proof is identical to \cref{lemma:deltaonPmu} under interchange of the subspaces $S$, $\overline{S}$ as the proof is agnostic to which subspace is called $S$ and which is called $\overline{S}$. The same holds for \cref{prop:evalfacts}.
\end{proof}

\begin{cor}\label{corr:deltaonM}
It also holds that: 
\[
    \Vert \Delta \mathcal{M} \Vert \leq \sqrt{h\kappa}+h.
\]
\end{cor}
\begin{proof}
    This follows immediately from \cref{lemma:deltaonPmu,cor:deltaonPmubar} and the fact that
    \[
    \Vert \Delta \mathcal{M}\Vert \leq \max\left\{ \Vert \Delta P_\mu\Vert, \Vert \Delta P_{\overline{\mu}} \Vert\right\}.
    \]
 \end{proof}

%
\begin{lemma}\label{lemma:projection_approximation}
Let $\lambda$ be the lowest eigenvalue of $H + \Cut$, as defined above, and let $P_\lambda$ be the orthogonal projector onto its ground state $\vec\lambda$. Let $(\gseS, \gsprojS)$ be the lowest eigenvalue-orthogonal projector pair of $\HS$, as defined above. Assuming that $P_S\gsprojS \neq 0$, then,
\[
\frac{\norm{\gsproj \gsprojSperp}}{\norm{\gsproj P_S}} \leq \sqrt{\frac{\gsrS-\gseS}{\gapS}},
\]
where $\gsprojSperp := \projS-\gsprojS$.
\end{lemma}

\begin{proof}
Using that $\projS$ is an orthogonal projector and defining $P_{\mu_j}$ as the orthogonal projector onto the eigenspace of $\HS$ with eigenvalue $\mu_j$ it holds that
\begin{align}
    \norm{\gsproj P_S}^2\left(\gsrS-\gseS\right) &= \norm{\gsproj\projS\gsproj}\left(\gsrS-\gseS\right)\nonumber 
    \\&=\norm{\gsproj\projS({H}-\gseS)\projS\gsproj} \nonumber
    \\&=\norm{\sqrt{\HS-\gseS}\projS\gsproj}^2\nonumber
    \\&=\norm{\sqrt{\HS-\gseS}(P_\mu + P_\mu^\perp)\gsproj}^2\nonumber
    \\&\geq\norm{\sqrt{\HS-\gseS}P_\mu^\perp\gsproj}^2\nonumber
    \\&\geq \gapS \norm{\gsprojSperp\gsproj}^2 \nonumber
\end{align}
where the inequality follows from the fact that both terms are positive semidefinite and for positive semidefinite operators $A,B$ it holds that $\norm{A+B}\geq\max\{\norm{A},\norm{B}\}$. Thus,
\begin{equation}
 \frac{\gsrS-\gseS}{\gapS} \geq \frac{\norm{\gsproj\gsprojSperp}^2}{\norm{\gsproj \projS}^2}.
\end{equation}
\end{proof}

\begin{cor}
With all terms defined as in \cref{lemma:projection_approximation}, 
\[
\frac{\norm{\gsproj \gsprojSperp}}{\norm{\gsproj P_S}} \leq \sqrt{\frac{h}{\gapS}}.
\]
\end{cor}
\begin{proof}
This follows immediately by using \cref{prop:evalfacts} to relax the inequality in \cref{lemma:projection_approximation}.
\end{proof}
\begin{cor} Let all terms be defined as in \cref{lemma:projection_approximation}, and let $\mathcal{M}^\perp:=I-P_\mu-P_{\overline\mu}.$ Then
    \[\Vert P_\lambda \mathcal{M}^\perp \Vert \leq \sqrt\frac{2h}{\min\{\Gamma_S,\Gamma_{\overline S}\}}.\]
\end{cor}

\begin{lemma}\label{cor:PionM} Let $\Pi := P_\lambda+P_{\lambda_1}$ and $\mathcal{M}:= P_\mu+P_{\overline\mu},$ and let all other quantities be defined as above. Then, 
    \begin{align*}
        \Vert \Pi^\perp \mathcal{M}\Vert &\leq \sqrt\frac{2h}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}},
    \end{align*}
    where $c:=\Vert \Cut\Vert /\min\{\Gamma_S,\Gamma_{\overline S}\}$ is as defined in \cref{assmpn:tbd2}.
\end{lemma}
\begin{proof}
    Note that
    \begin{align*}
        \Vert \mathcal{M}(H+\Cut-\lambda)\mathcal{M}\Vert &= \sqrt{\Vert\mathcal{M}\Pi (H+\Cut-\lambda)\Pi \mathcal{M}\Vert^2 +\Vert\mathcal{M}\Pi^\perp (H+\Cut-\lambda)\Pi^\perp \mathcal{M}\Vert^2 }\\
        &\geq \Vert \mathcal{M}\Pi^\perp (H+\Cut-\lambda)\Pi^\perp \mathcal{M}\Vert \\
        &\geq (\lambda_2-\lambda)\Vert \mathcal{M}\Pi^\perp\mathcal{M}\Vert\\
        &= (\lambda_2-\lambda)\Vert \mathcal{M}\Pi^\perp\Vert^2.
    \end{align*}
    Next, we note that 
    \begin{align*}\Vert \mathcal{M}(H+\Cut-\lambda)\mathcal{M}\Vert &\leq \Vert \mathcal{M}(H-\lambda)\mathcal{M}\Vert+\Vert \mathcal{M} \Cut\mathcal{M}\Vert\\
    &\leq (\max\set*{\mu,\overline{\mu}}-\lambda)\norm{\mathcal{M}}+\Vert \mathcal{M} \Cut\mathcal{M}\Vert\\
    &\leq 2h,
    \end{align*}
    where the we have applied \cref{lem:expected_norm} and made use of \cref{prop:evalfacts}, as well as the fact that $\mathcal{M}(H-\lambda)\mathcal{M}$ is block-diagonal.
    
    Now, we move to bound $\lambda_2-\lambda.$ By Weyl's inequality and \cref{assmpn:tbd}, we have that $\vert \lambda_2-\min\{\mu+\Gamma_S,\overline\mu+\Gamma_{\overline S}\}\vert \leq \Vert \Cut\Vert.$ Thus, $\lambda_2 \geq \min\{\mu+\Gamma_S,\overline\mu+\Gamma_{\overline S}\}-\Vert \Cut\Vert .$ Now, by \cref{assmpn:tbd2}, we thus have that $\lambda_2-\lambda \geq (1-c)\min\{\Gamma_S,\Gamma_{\overline{S}}\}$. Plugging this in, we arrive at our result.
\end{proof}

\section{Main Result}\label{s:results}
With all necessary definitions in hand, we are ready to present our main result. This result depends on \cref{assmpn:tbd} and \cref{assmpn:tbd2} stated above.

While not overly restrictive, we remark that these assumption may not be strictly necessary and suspect that they may be able to be relaxed, while proving similar results. However, we were unable to find a rigorous way to remove them, so we leave this problem to future work. 
Given these assumptions, our main result is as follows:
\begin{theorem}[Main result]\label{thm:mainresult}
    Let $H(s)$ be a one parameter, twice-differentiable family of Hamiltonians respecting the grading $\mathcal{H}=S\oplus\overline{S}$ and $\Delta(s)$ be a block-antidiagonal perturbation, where $s:=t/T\in[0,1]$. When acting on the ground space $P_\mu$ of $S$, the difference between the unitary evolution $U(1)$ generated by the Hamiltonian $H(s)+\Cut(s)$ acting for time $T$ and the adiabatic unitary evolution $V_{\mathrm{ad}}(1)$ generated by the block-diagonal Hamiltonian $H(s)$ is bounded as
    \[
    \norm{(U(1)-V_{\mathrm{ad}}(1))P_{\mu(0)}}\leq \max_{s\in[0,1]} \left[2\sqrt{hTB(H,\Cut,\Gamma_S,\Gamma_{\overline S},\epsilon_T)}+\frac{1}{\eta T}C(H, \dot{H}, \ddot{H}, \Cut,\dot\Cut, \Gamma_S, \Gamma_{\overline{S}} )\right],
    \]
    where    
\begin{align*}
B &:= 1 + \sqrt\frac{2h}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}} + \sqrt{\frac{2\kappa}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}}} +  \epsilon_T  \left(1+\sqrt{\frac{\kappa}{h}}\right)
\end{align*}
\begin{align*}
    C&:=    2\frac{\Vert\dot{H}_{S}\Vert}{\Gamma_S^2}+\frac{\Vert\ddot{H}_{S}\Vert}{\Gamma_S^2}+10\frac{\Vert\dot{H}_{S}^2\Vert}{\Gamma_S^3}+\frac{1}{\eta}\frac{\Vert{\dot{H}_{S}}\Vert}{\Gamma_S^2}\left(\frac{\Vert{\dot{\Cut}^\perp\Vert}}{\min\{\Gamma_S,\Gamma_{\overline{S}}\}}+4\Vert\Cut^\perp\Vert \max\left\{\frac{\Vert{\dot{H}_{S}}\Vert}{\Gamma_S^2},\frac{{2\Vert\dot{H}_{\overline{S}}\Vert+\Vert \dot{H}_{S}\Vert}}{\Gamma_{\overline{S}}^2}\right\}\right).
\end{align*}
and
    \[\epsilon_T := \max\{\Vert P_\lambda^\perp U(s)\vec\lambda\Vert, \Vert (I-P_\mu-P_{\overline\mu}) U_\perp'(s)\vec\mu\Vert \},\]
\[
    \eta:=1-\frac{\norm{\Delta^\perp}}{\min\{\Gamma_s,\Gamma_{\overline{S}}\}},
\]
\[
\kappa:= \norm{H+\Delta-\lambda}=\lambda_{n-1}-\lambda,
\]
and $c:=\Vert \Cut\Vert /\min\{\Gamma_S,\Gamma_{\overline S}\}$ is as defined in \cref{assmpn:tbd2}.
\end{theorem}
\begin{proof}
    The proof proceeds in two parts. First, we define a unitary $U_\perp'(1)$ by the initial value condition $U_\perp'(0)=I$ and
    \begin{equation}\label{eq:Uperpprime}
    i\dot{U}'_\perp(s)=T(H'(s)+\Cut^\perp(s))U'_\perp(s),
    \end{equation}
    where
    \begin{equation}\label{eq:H'}
        H':=H+(\mu-\overline{\mu})P_{\overline{S}},
    \end{equation}
    is a perturbed Hamiltonian so that $\mu=\overline{\mu}$. 
    We then bound the difference between unitary evolution under $U(1)$ and $U_\perp'(1)$ as
    \[
    \Vert (U(1)-U_{\perp}'(1))P_{\mu}(0)\Vert\leq 2\sqrt{hTB(H,\Cut,\Gamma_S,\Gamma_{\overline S},\epsilon_T)}.
    \]
    This is shown in \cref{lemma:cheegerperturb}, derived in \cref{s:cheegerperturb} below. We then show the following bound
    \[
    \Vert (U_\perp'(1)-V_{\mathrm{ad}}(1))P_{\mu}(0)\Vert\leq \frac{1}{\eta T}C(H, \dot{H}, \ddot{H}, \Cut,\dot\Cut, \Gamma_S, \Gamma_{\overline{S}} ),
    \]
    in \cref{lemma:perturbadiab} in \cref{s:perturbadiabatic}. Applying the triangle inequality, the result follows.
\end{proof}
The use of the perturbed Hamiltonian $H'$ defined in \cref{eq:H'} in the proof of \cref{thm:mainresult} arises for technical reasons related to the bounding of $\Vert (U_\perp'(1)-V_{\mathrm{ad}}(1))P_{\mu}(0)\Vert$ in \cref{lemma:perturbadiab}. Note that the perturbed Hamiltonian $H'$ is still block diagonal. From \cref{prop:evalfacts} (Items~\ref{prop:evalfacts1} and \ref{prop:evalfacts3}) we have
\begin{align}
    \mu-\overline{\mu}\leq (\lambda+h)-\lambda = h,
\end{align}
so this perturbation is only of size $\mathcal{O}(h)$. Importantly, this term has no impact on the ``local'' eigenstates $\{\vec\mu_j\}_j$ or $\{\vec{\overline{\mu}}_j\}_j$. In fact, all quantities local to $S$ are invariant under this perturbation (e.g. $P_\mu$ and $H_S$), as well as many quantities local to $\overline{S}$ (e.g. $P_{\overline{\mu}}$). Consequently, when acting on $P_\mu$, the perturbed unitary defined by the initial value condition $V'_{\mathrm{ad}}(0)=I$ and
\begin{align}\label{eq:unitaries_perturbed}
    i\dot{V}_{\mathrm{ad}}'(s)&=\left(TH'(s)+i[\dot{P}_\mu(s), P_\mu(s)]\right)V'_{\mathrm{ad}}(s),
\end{align}
acts identically to its unperturbed counterpart defined in \cref{eq:Vad}. On the other hand, some operators that act on the space $\overline{S}$ are changed by this perturbation and the corresponding changes in their norms will have to be accounted for in the analysis that follows (i.e., $U_\perp'\neq U_\perp$). While making use of this perturbation eases the analysis, we do expect it to be a technical artifact that could potentially be removed.

\subsection{Bounding the difference between $U(1)$ and $U'_\perp(1)$} \label{s:cheegerperturb}
In this section, we prove the first component of our main result (\cref{thm:mainresult}). This contribution to the bound will scale with $\sqrt{T}$ and can intuitively be interpreted as the error introduced due to tunneling of the ground state from $S$ to $\overline{S}$. This is why this error term grows with the evolution time $T$.

In particular, we prove the following lemma.
\begin{lemma}\label{lemma:cheegerperturb} 
Consider all terms as defined above. Then
\[\Vert (U(1)-U_\perp'(1))P_\mu(0)\Vert ^2  \leq \max_{s\in[0,1]} 4hT\left(1 + \sqrt\frac{2h}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}}+ \sqrt{\frac{2\kappa}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}}} +  \epsilon_T  \left(1+\sqrt{\frac{\kappa}{h}}\right)\right)\]
where
\[
    \epsilon_T := \max\set*{\norm*{\Pi^\perp U(s)\Pi}, \norm*{\mathcal{M}^\perp U_\perp'(s)\vec\mu} },
\]  
$\Pi$ being the spectral projection of $H+\Cut$ onto $(-\infty,\lambda+2h],$
\[
\kappa:= \norm{H+\Delta-\lambda}=\lambda_{n-1}-\lambda,
\]
and $c:=\Vert \Cut\Vert /\min\{\Gamma_S,\Gamma_{\overline S}\}$ is as defined in \cref{assmpn:tbd2}.
\end{lemma}

\begin{proof}
We begin by noting that (letting $\vec\mu=\vec\mu(0)$ in what follows for brevity)
\begin{align*}
\Vert (U(1)-U_\perp'(1))P_{\mu}(0)\Vert^2 &= \vec\mu^\dagger (U(1)-U_\perp'(1))^\dagger(U(1)-U_\perp'(1))\vec\mu \\
&= \vec\mu^\dagger (2I-U^\dagger(1)U_\perp'(1)-(U_\perp')^\dagger(1)U(1))\vec\mu\\
&= 2-2\mathrm{Re}(\vec\mu^\dagger U^\dagger(1)U'_\perp(1)\vec\mu)\\
&\leq 2\vert \vec\mu^\dagger U^\dagger(1)U'_\perp(1)\vec\mu-1\vert.
\end{align*}

Next, we write that 
\begin{align*}
    U^\dagger(1)U'_\perp(1)-I &= \int^1_0 ds \frac{d}{ds}\left(U^\dagger(s)U'_\perp(s) \right)
    \\&=i T \int^1_0 ds U^\dagger(s)\left( H+\Delta -H - \Delta^\perp -(\mu-\overline{\mu})P_{\overline S}\right)U'_\perp(s)
    \\&=i T \int^1_0 ds U^\dagger(s)\left(\Delta - \Delta^\perp +(\overline\mu-\mu)P_{\overline S}\right)U'_\perp(s).
\end{align*}
Thus, we have that 
\begin{align*}
    \abs{\vec\mu^\dagger U^\dagger(1)U_\perp(1)\vec\mu-1} &= T \abs{ \int^1_0 ds \vec\mu^\dagger U^\dagger(s){ \left(\Delta - \Delta^\perp +(\overline\mu-\mu)P_{\overline S}\right)U'_\perp(s)\vec\mu }}
    \\&=T \abs{ \int^1_0 ds \vec\mu^\dagger U^\dagger(s){ \left(\mathcal{M}^\perp\Delta \mathcal{M} + \mathcal{M}\Delta\mathcal{M}^\perp + \mathcal{M} \Delta \mathcal{M} +(\overline\mu-\mu)P_{\overline S}\right)U'_\perp(s)\vec\mu}}
    \\&\leq T \abs{ \int^1_0 ds \vec\mu^\dagger U^\dagger(s){ \left(\mathcal{M}^\perp\Delta \mathcal{M} + \mathcal{M}\Delta\mathcal{M}^\perp + \mathcal{M} \Delta \mathcal{M}\right)}}+ hT
    \\&\leq T \abs{ \int^1_0 ds \vec\mu^\dagger U^\dagger(s){ \left(\mathcal{M}^\perp\Delta \mathcal{M} + \mathcal{M}\Delta\mathcal{M}^\perp \right)}U'_\perp(s)\vec\mu} + 2hT,
\end{align*}
where the first inequality comes from recalling that $\vert \overline\mu-\mu\vert < h$ and the final line follows from applying \cref{lem:expected_norm} to the last term in the integrand.

Suppressing dependencies upon $s$ for notational clarity we now proceed with bounding the remaining terms. First,
\begin{align}
    \abs{\vec\mu^\dagger U^\dagger\mathcal{M}\Delta\mathcal{M}^\perp U_\perp'\vec\mu}
    &\leq \norm{\mathcal{M}\Delta}\norm{\mathcal{M}^\perp U'_\perp\vec\mu} \nonumber
    \\&\leq \left(\sqrt{h \kappa}+h\right)\epsilon_T,\label{eqn:second_term_bound}
\end{align}
where, in the final line, we have applied \cref{corr:deltaonM} and the definition of $\epsilon_T$. The remaining term will take a bit more work. To start we have that
\begin{align}
    \abs{\vec\mu^\dagger U^\dagger\mathcal{M}^\perp\Delta \mathcal{M}U'_\perp\vec\mu} &\leq \norm{\mathcal{M}^\perp U\vec\mu}\norm{\Delta\mathcal{M}} \nonumber
    \\&\leq \norm{\mathcal{M}^\perp U\vec\mu}({\sqrt{h\kappa} + h}),
\end{align}
where we have, once again, applied \cref{corr:deltaonM}. We are now left with bounding $\norm{\mathcal{M}^\perp U\vec\mu}$. To this end, observe that
\begin{equation}\label{eq:lem5a}  
    \norm{\Pi^\perp \mathcal{M}}=\norm{\mathcal{M} - \Pi\mathcal{M}} \leq\sqrt\frac{2h}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}},
\end{equation}
by \cref{cor:PionM}. Hence, by the reverse triangle inequality, we have that 
\begin{align}  \label{eq:lem5b}  
    \abs{\norm{\mathcal{M}^\perp U\vec\mu} - \norm{\mathcal{M}^\perp U \Pi \vec\mu}} &\leq \Vert \mathcal{M}^\perp U (\vec\mu-\Pi \vec\mu)\Vert \nonumber \\
    &\leq \Vert \mathcal{M}^\perp U\Vert \Vert \vec\mu - \Pi\vec\mu\Vert \nonumber \\
    &\leq \Vert \mathcal{M}^\perp U\Vert \Vert \mathcal{M}-\Pi \mathcal{M}\Vert \nonumber\\
    &\leq \sqrt\frac{2h}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}}.
\end{align}
As $\norm{\mathcal{M}^\perp U\vec\mu} \geq \norm{\mathcal{M}^\perp U \Pi \vec\mu}$ we have from \cref{eq:lem5b} that
\begin{equation}\label{eq:lem5c}
    \norm{\mathcal{M}^\perp U\vec\mu} \leq \sqrt\frac{2h}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}} + \norm{\mathcal{M}^\perp U \Pi \vec\mu},
\end{equation}
so we must bound $\norm{\mathcal{M}^\perp U P_\lambda \vec\mu}$ to get the bound on $\norm{\mathcal{M}^\perp U\vec\mu}$ that we want. As $\Vert \mathcal{M}^\perp \Pi^\perp U\Pi \vec\mu\Vert \leq \Vert \mathcal{M}^\perp U\Pi \vec\mu\Vert$, we have by a similar appeal to the reverse triangle inequality as \cref{eq:lem5b,eq:lem5c} that
\begin{align*}
    \norm{\mathcal{M}^\perp U \Pi \vec\mu} \leq 2\sqrt\frac{2h}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}}+\norm{\mathcal{M}^\perp \Pi^\perp U \Pi \vec\mu}.
\end{align*}
Finally, 
\begin{align*}
    \norm{\mathcal{M}^\perp \Pi^\perp U \Pi\vec\mu} \leq \norm{\Pi^\perp U \Pi} \leq \epsilon_T
\end{align*}
by applying the definition of $\epsilon_T$. Combining these results we obtain the desired bound:
\[
    \norm{\mathcal{M}^\perp U\vec\mu} \leq \left(2 \sqrt\frac{2h}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}} + \epsilon_T\right).
\]
Thus, combining everything, we obtain the bound
\begin{align*}
    \abs{\vec\mu^\dagger U^\dagger(1)U'_\perp(1)\vec\mu-1} &\leq T \left(2 \sqrt\frac{2h}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}} + \epsilon_T\right) \left(\sqrt{h\kappa} + h\right) + T\epsilon_T\left( \sqrt{h\kappa} + h\right) + 2hT
    \\&= 2hT\left(1 + \sqrt\frac{2h}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}}+\epsilon_T + \sqrt{\frac{2\kappa}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}}}\right) + 2 \epsilon_T T \sqrt{h\kappa} .
\end{align*}
Plugging this in, we arrive at our result.
\end{proof}


\subsection{Perturbed adiabatic theorem} \label{s:perturbadiabatic}
In this section, we prove the second component of our main result (\cref{thm:mainresult}).  This error term scales inversely with $T$ and can be understood as deriving an adiabatic theorem that applies locally to $H_S$. 
In particular, we prove the following lemma.
\begin{lemma}\label{lemma:perturbadiab} 
\[
    \Vert (U_\perp'(1)-V_{\mathrm{ad}}(1))P_\mu(0)\Vert\leq \max_{s\in[0,1]} \frac{1}{\eta T}C(H, \dot{H},  \ddot{H}, \Cut, \dot\Cut, \Gamma_S, \Gamma_{\overline{S}} ),
\]
where
\[
    \eta:=1-\frac{\norm{\Delta^\perp}}{\min\{\Gamma_s,\Gamma_{\overline{S}}\}},
\]
\begin{align*}
    C&:=    2\frac{\Vert\dot{H}_{S}\Vert}{\Gamma_S^2}+\frac{\Vert\ddot{H}_{S}\Vert}{\Gamma_S^2}+10\frac{\Vert\dot{H}_{S}^2\Vert}{\Gamma_S^3}+\frac{1}{\eta}\frac{\Vert{\dot{H}_{S}}\Vert}{\Gamma_S^2}\left(\frac{\Vert{\dot{\Cut}^\perp\Vert}}{\min\{\Gamma_S,\Gamma_{\overline{S}}\}}+4\Vert\Cut^\perp\Vert \max\left\{\frac{\Vert{\dot{H}_{S}}\Vert}{\Gamma_S^2},\frac{{2\Vert\dot{H}_{\overline{S}}\Vert+\Vert \dot{H}_{S}\Vert}}{\Gamma_{\overline{S}}^2}\right\}\right).
\end{align*}
\end{lemma}

Before presenting the proof, we must develop a collection of other results. While the analysis becomes somewhat unwieldy, the techniques are fairly standard---the general approach taken is similar to that taken to deriving the standard adiabatic theorem in Andrew Childs' lecture notes on quantum algorithms~\cite{childs2017lecture}, which, in turn, closely follow the approach of Jansen, Ruskai, and Seiler~\cite{jansen2007bounds}. Also worth noting is Ref.~\cite{ohara2008adiabatic}, which derives an adiabatic theorem in the presence of noise. While the general concept of considering an adiabatic theorem under perturbation is similar, the actual formulation of the problem and the bounds they obtain are quite different than ours given their intended applications (i.e. characterizing noisy adiabatic quantum computation). For them, perturbation worsens the bound, whereas in our case, perturbation allows us to provide a tighter bound on the error by understanding the dynamics in terms of local adiabatic evolution.

Before proceeding with this analysis, however, we must consider a technical detail. Recall in the proof of \cref{thm:mainresult} we introduced a block diagonal Hamiltonian $H'$ in \cref{eq:H'}, which is a perturbation of $H(s)$ within the subspace $\overline{S}$ so that for the perturbed Hamiltonian $\mu=\overline{\mu}$. This perturbation was introduced for the purposes of the analysis that follows. Importantly, as we noted, all quantities local to $S$ are invariant under this perturbation (e.g. $P_\mu$, $H_S$, and $V_{\mathrm{ad}}$), as well as many quantities local to $\overline{S}$ (e.g. $P_{\overline{\mu}}$). Consequently, when acting on $P_\mu$, the perturbed unitary defined by the initial value condition $V'_{\mathrm{ad}}(0)=I$ and
With this in mind, to avoid unnecessary notational clutter in what follows, we will only use primed variables for objects that are not invariant under the perturbation. For instance, we will use $H_S$ instead of $H_S'$ as the quantities are equivalent. When acting on states local to $S$ we will use $V_{\mathrm{ad}}$ instead of $V_{\mathrm{ad}}'$. Note that the final bound is all in terms of the unperturbed quantities.
 
These technical details out of the way, we begin by defining a pair of reduced resolvents.
\begin{definition}[Resolvents]\label{def:resolvent}
    Let $H_S:=P_S H P_S= P_S H' P_S$, $H_{\overline{S}}':=P_{\overline{S}} H' P_{\overline{S}}$, and $\mu=\overline{\mu}$ be the corresponding smallest local eigenvalues with associated projectors onto the local ground spaces $P_\mu$ and $P_{\overline{\mu}}$. Let $P_S$ and $P_{\overline{S}}$ be the projectors onto the subspaces $S$ and $\overline{S}$. 
    Define the (reduced) resolvents
    \begin{align*}
    R:&= (H'-\mu I)\vert_{ \ker (H'-\mu I)^\perp}^{-1}(P_\mu+P_{\overline{\mu}})^\perp
    \end{align*}
    and 
    \begin{align*}
    R_\perp:&=(H'+\Cut^\perp - \mu I)\vert_{\ker (H'+\Cut^\perp - \mu I)^\perp}^{-1}(P_\mu+P_{\overline{\mu}})^\perp.
    \end{align*}
\end{definition}
To understand the origin of these resolvents it is helpful to notice that $(H'-\mu I) $ is a map that takes $\mathbb{C}^N\to \mathrm{ker}(H'-\mu I)^\perp\subset \mathbb{C}^N.$ As this map is necessarily not injective, to be able to invert it, we must restrict to a set on which it is. The natural choice for this is $\mathrm{ker}(H'-\mu I)^\perp.$ Thus, we are left with $(H'-\mu I)\vert_{\mathrm{ker}(H'-\mu I)^\perp}:\mathrm{ker}(H'-\mu I)^\perp\to \mathrm{ker}(H'-\mu I)^\perp \subset \mathbb{C}^N,$ which is surjective onto $\mathrm{ker}(H'-\mu I)^\perp$ but not $\mathbb{C}^N.$ Thus, when we invert the map, and get $(H'-\mu I)\vert_{\mathrm{ker}(H'-\mu I)^\perp}^{-1},$ in order to extend this into a map $\mathbb{C}^N\to \mathrm{ker}(H'-\mu I)^\perp\subset\mathbb{C}^N,$ we must choose how it will behave on $\mathrm{ker}(H'-\mu I),$ which we do by precomposing it with $(I-P_\mu-P_{\overline\mu})=(P_\mu+P_{\overline\mu})^\perp$, which takes $\mathbb{C}^N$ to $\mathrm{ker}(H'-\mu I)^\perp.$ Consequently, it holds that 
\begin{equation}\label{eq:resolvent_fact}
    (H'-\mu I) R = R(H'-\mu I)= (I-P_\mu-P_{\overline\mu}).
\end{equation}
From \cref{eq:resolvent_fact}, we can immediately derive several lemmas related to the resolvents defined in \cref{def:resolvent}. To begin we compute the derivative of $R$.
\begin{lemma}\label{lemma:Rderiv}
    Let $R$ be defined as in \cref{def:resolvent}. Then
    \begin{align*}\dot{R} &= -(\dot{P}_{\mu}+\dot{P}_{\overline{\mu}})R - R(\dot{H}'-\dot{\mu}I)R - R(\dot{P}_{\mu}+\dot{P}_{\overline{\mu}}).
    \end{align*}
\end{lemma}
\begin{proof}
Notice first that 
\begin{equation}\label{eq:RonHmuI}
    R(H'-\mu I) = (I-P_\mu-P_{\overline\mu}),
\end{equation}
and 
\begin{equation}\label{eq:RonPmuPmubar}
R(P_\mu+P_{\overline\mu}) = 0.
\end{equation} 

Differentiating \cref{eq:RonHmuI}, we get that 
\begin{align*}
    \dot{R} (H'-\mu I) +R(\dot H'-\dot\mu I)&= -\dot P_\mu - \dot{P}_{\overline{\mu} }\\
    \implies \dot{R} (H'-\mu I) &= -(\dot P_\mu +\dot P_{\overline\mu})-R(\dot{H}'-\dot{\mu} I).
\end{align*}
Acting from the right by $R$ we obtain
\begin{align}\label{eq:one}
    \dot{R}(I-P_\mu-P_{\overline\mu}) &= -(\dot{P}_\mu + \dot{P}_{\overline{\mu}})R - R(\dot{H}'-\dot{\mu}I)R.
\end{align}
Differentiating \cref{eq:RonPmuPmubar} we get that
\begin{align}\label{eq:two}
    \dot{R} (P_\mu + P_{\overline\mu}) &= - R \left(\dot{P}_\mu + \dot{P}_{\overline\mu}\right).
\end{align}
Adding \cref{eq:one} and \cref{eq:two} we get our result.
\end{proof}


To obtain our final bound it will be essential to have bounds on the norms of a number of different quantities containing the resolvents. These bounds are established in the following lemma. 
\begin{lemma}\label{prop:Rprop}
    Let the reduced resolvent $R$ be defined as in \cref{def:resolvent}. Then, the following hold:
    \begin{enumerate}
    \item $\Vert R\Vert \leq \frac{1}{\min\{\Gamma_S,\Gamma_{\overline{S}}\}}$ \label{propRitem1}
    \item $\Vert \dot{R}\Vert \leq 4\max\left\{\frac{\Vert \dot{H}_S\Vert}{\Gamma_S^2}\frac{\Vert \dot{H}_{\overline{S}}'\Vert}{\Gamma_{\overline{S}}^2}\right\}$, \label{propRitem2}
    \item $\Vert \dot{R}P_S\Vert\leq 4\frac{\Vert \dot{H}_S\Vert}{\Gamma_S^2}$, and \label{propRitem3}
    \item $\Vert \dot{R}P_{\overline{S}}\Vert\leq 4\frac{\Vert \dot{H}_{\overline{S}}'\Vert}{\Gamma_{\overline{S}}^2}.$ \label{propRitem4}
    \end{enumerate}
\end{lemma}
\begin{proof}
    \cref{propRitem1} follows by simply placing a norm on \cref{eq:resolvent_fact} and applying the Cauchy-Schwarz inequality:
    \[
    \norm{R}\leq \frac{\norm{I-P_\mu-P_{\overline{\mu}}}}{\norm{H'-\mu I}} \leq \frac{1}{\min\{\Gamma_S,\Gamma_{\overline{S}}\}}
    \]    
    \cref{propRitem2} comes from placing norms on the result of \cref{lemma:Rderiv}:
    \begin{align*}
        \Vert \dot R\Vert &= \Vert (\dot{P}_{\mu}+\dot{P}_{\overline{\mu}})R + R(\dot{H}'-\dot{\mu}I)R + R(\dot{P}_{\mu}+\dot{P}_{\overline{\mu}})\Vert\\
        &\leq \max\{ \Vert P_S(\dot{P}_\mu R + R(\dot H'-\dot \mu I)R + R\dot P_\mu)P_S\Vert, \Vert P_{\overline S}(\dot{P}_{\overline\mu} R + R(\dot H'-\dot \mu I)R + R\dot P_{\overline{\mu}})P_{\overline S}\Vert\}\\
        &\leq \max\{ 2\Vert \dot{P}_\mu\Vert \Vert R P_S\Vert + \Vert RP_S\Vert^2\Vert(\dot H'-\dot \mu I)P_S \Vert, 2\Vert \dot{P}_{\overline\mu}\Vert \Vert RP_{\overline S}\Vert + \Vert RP_{\overline S}\Vert^2 \Vert (\dot H'-\dot \mu I) P_{\overline S}\Vert  \}.
    \end{align*}
    Using the facts that $\Vert \dot P_\mu\Vert \leq \Vert \dot{H}_S\Vert/\Gamma_S$ (\cref{prop:Pmunorms}), $\norm{RP_S}\leq 1/\Gamma_S$, $\norm{RP_{\overline{S}}}\leq 1/\Gamma_{\overline{S}}$, $\norm{(\dot H'-\dot\mu I) P_S}\leq 2\norm{\dot H_S}$, and $\norm{(\dot H'-\dot\mu I) P_{\overline{S}}}\leq 2\norm{\dot H_{\overline{S}}'}$ completes the proof:
    \begin{align*}
         \Vert \dot R\Vert &\leq \max\left\{2\frac{\Vert\dot H_S\Vert}{\Gamma_S} \frac{1}{\Gamma_S} + \frac{2\Vert\dot{H}_S\Vert}{\Gamma_S^2}, 2\frac{\Vert\dot H_{\overline S}'\Vert}{\Gamma_{\overline S}} \frac{1}{\Gamma_{\overline S}} + \frac{2\Vert\dot{H}_{\overline S}'\Vert}{\Gamma_{\overline S}^2}\right\}\\
        &\leq 4\max\left\{\frac{\Vert \dot{H}_S\Vert}{\Gamma_S^2},\frac{\Vert \dot{H}_{\overline{S}}'\Vert}{\Gamma_{\overline{S}}^2}\right\}
    \end{align*}
    \cref{propRitem3} and \cref{propRitem4} follow by almost identical arguments, except the projectors eliminate one of the terms in the maximization.
\end{proof}


We now note a fact about perturbations of resolvents, which follows from the second resolvent identity (Thm. 4.8.2 \cite{hille1996functional}), which states that $R-R_\perp  = R\Delta^\perp R_\perp = -R_\perp \Delta^\perp R$. Defining
\begin{equation}\label{fact:ResolventIdentity}
    L := (I+R\Cut^\perp),
\end{equation}
and rearranging the second resolvent identity lets us note that 
\begin{equation}
R_\perp = L^{-1}R.
\end{equation}
Furthermore, differentiating this equation yields that
\begin{equation}
    \dot{R}_\perp = L^{-1}\dot{R} - L^{-1}(\dot{R}\Cut^\perp+R\dot{\Cut}^\perp)L^{-1}R. 
\end{equation}

These useful facts established, we now present the following proposition, which bounds the norm of the operator $L$.
\begin{prop}\label{prop:normLinv}
    Let $L$ be defined as above in \cref{fact:ResolventIdentity}. Then 
    \[\Vert L^{-1} \Vert \leq \frac{1}{\eta},\] where $\eta := 1-\Vert \Cut^\perp\Vert/\min\{\Gamma_S,\Gamma_{\overline{S}}\}.$
\end{prop}
\begin{proof}
    Consider a Neumann series 
    \[
    L^{-1}=\sum_{j=0}^\infty (I-L)^j=\sum_{j=0}^\infty  (R\Delta^\perp)^j.
    \]
    Taking the norm of this expression and using \cref{assmpn:tbd2} we have that
    \begin{align*}
    \norm{L^{-1}} &\leq \sum_{j=0}^\infty \norm{R\Delta^\perp}^j\leq \sum_{j=0}^\infty \norm{R}^j\norm{\Delta^\perp}^j \\
    &= \frac{1}{1-\Vert R\Vert \Vert \Cut^\perp \Vert} \leq \frac{1}{1-\frac{\Vert\Cut^\perp\Vert}{\min\{\Gamma_S,\Gamma_{\overline{S}}\}}}.
    \end{align*}

\end{proof}

To proceed further, we now define the operator
\begin{equation}\label{def:F}
   F:=R_\perp \dot{P}_{\mu}P_{\mu}+P_{\mu}\dot{P}_{\mu}R_\perp.
\end{equation}
Several relevant results regarding this operator are developed below.

\begin{prop}
    Let $F$ be defined as above in \cref{def:F}. It holds that 
    \[F = L^{-1}R\dot{P}_\mu P_\mu + P_\mu\dot{P}_\mu L^{-1}R\]
    and 
    \[\dot{F}P_\mu =-L^{-1}\left(\dot\Cut^\perp R+\Cut^\perp\dot{R}\right)L^{-1}R\dot{P}_\mu P_\mu + L^{-1}\dot{R}\dot{P}_\mu P_\mu + L^{-1}{R}\ddot{P}_\mu P_\mu  - P_\mu\dot{P}_\mu L^{-1}{R}\dot{P}_\mu.\]
\end{prop}
\begin{proof}
    The first equality follows directly from the definition of $F$ and \cref{fact:ResolventIdentity}. The second comes immediately from differentiating the first and using the fact that $RP_\mu=0$, eliminating the second term.
\end{proof}


\begin{lemma} Let $H',\Cut^\perp, F$ and $P_{\mu}$ be as defined above. Then,
    \[
    [H'+\Cut^\perp, F] =[{\dot{P}}_{\mu},P_{\mu}].
    \]\label{lem:HFPmuPmubar}
\end{lemma}
\begin{proof}
    Simply plugging in $F$ from its definition in \cref{def:F}, noting that $[\mu I, F] = 0$, and using that $(H'+\Cut^\perp-\mu I )R_\perp = I-P_\mu-P_{\overline{\mu}},$ we can proceed by direct computation:
    \begin{align*}    
    [H'+\Cut^\perp, F] &= [H'+\Cut^\perp, R_{\perp}\dot{P}_{\mu}P_{\mu} + P_{\mu}\dot{P}_{\mu}R_{\perp}]\\
    &= (H'+\Cut^\perp )R_{\perp}\dot{P}_{\mu}P_{\mu} + (H'+\Cut^\perp){P_{\mu}}\dot{P_{\mu}}R_{\perp} - R_{\perp}\dot{P_{\mu}}P_{\mu} (H'+\Cut^\perp) - P_\mu\dot{P}_\mu R_{\perp}(H'+\Cut^\perp)\\
    &= (H'+\Cut^\perp - \mu I)R_\perp \dot{P}_{\mu}P_{\mu}-P_{\mu}\dot{P}_{\mu}R_\perp(H'+\Cut^\perp-\mu I)\\
    &= {P_{\mu}}^\perp \dot{P}_{\mu}P_{\mu} - P_{\mu}\dot{P}_{\mu}P_{\mu}^\perp \\
    &= \dot{P}_{\mu}P_{\mu}-P_{\mu}\dot{P}_\mu= [\dot{P}_{\mu},P_{\mu}].
    \end{align*}
\end{proof}

\begin{lemma} Let $U_\perp',$ ${P}_{\mu},$ and $F$ be as defined above. Then, 
    \[(U_\perp')^{\dagger}[\dot{{P}}_{\mu},{P}_{\mu}]U_\perp' = \frac{1}{iT}\left(\dot{\tilde{F}}-(U_\perp')^{\dagger}\dot{F}U_\perp'\right),\] where $\tilde{F}:=(U_\perp')^{\dagger} FU_\perp'.$
\end{lemma}
\begin{proof}
    Plugging in the result of \cref{lem:HFPmuPmubar} we get that
    \begin{align*}
        (U_\perp')^{\dagger}[\dot{{P}}_{\mu},{P}_{\mu}]U_\perp' &= (U_\perp')^{\dagger}(H'+\Delta^\perp) F U_\perp' -  (U_\perp')^{\dagger} F(H'+\Delta^\perp)U_\perp' \\
        &=\frac{1}{iT}\left((\dot{U}'_\perp)^\dagger F U_\perp' +(U_\perp')^{\dagger} F \dot{U}_\perp'\right)\\
        &=\frac{1}{iT}\left(\dot{\tilde{F}}-(U_\perp')^{\dagger}\dot{F}U_\perp'\right),
    \end{align*}
    where in the second line we used \cref{eq:unitaries} and $\tilde{F}:=(U_\perp')^{\dagger} FU_\perp'$ as in the lemma statement.
\end{proof}

\begin{lemma}\label{lemma:perturbedwonorms} Let $U_\perp', V_{\mathrm{ad}}, F,$ and $ P_\mu$ be defined as above. Then, 
    \[(U_\perp'(1) - V_{\mathrm{ad}}(1))P_\mu(0)=-\frac{1}{iT}U_\perp'(1)\left[[(U_\perp')^{\dagger}{F}{P}_{\mu} V_{\mathrm{ad}}]_0^1-\int_0^1\mathrm{d}s\left((U_\perp')^\dagger{F} \dot{{P}}_{\mu}{P}_{\mu}V_{\mathrm{ad}}+(U_\perp')^\dagger\dot{F}{P}_{\mu} V_{\mathrm{ad}}\right)\right].\]
\end{lemma}
\begin{proof} We rewrite the left hand side as follows:
    \begin{align*}
    (U_\perp'(1)-V_{\mathrm{ad}}(1))P_\mu(0) &= U_\perp'(1)(I-(U_\perp')^{\dagger}(1)V_{\mathrm{ad}}(1))P_\mu(0)\\
    &= -U_\perp'(1)\int_{0}^1 \mathrm{d}s (U_\perp')^{\dagger}(iT(H'+\Cut^\perp - H') + [\dot{P}_\mu,P_\mu] )V_{\mathrm{ad}}P_\mu(0)\\
    &= -U_\perp'(1)\int_{0}^1 \mathrm{d}s (U_\perp')^{\dagger} [\dot{P}_\mu,P_\mu]V_{\mathrm{ad}}P_\mu(0).
\end{align*}
We replace $(U_\perp')^{\dagger} [\dot{P}_\mu, P_\mu]$ with $\frac{1}{iT}\left(\dot{\tilde{F}}-(U_\perp')^\dagger \dot{F} U_\perp'\right)(U_\perp')^\dagger$ and integrate the first term by parts to get 
%
\begin{align*}
    (U_\perp'(1)-V_{\mathrm{ad}}(1))&P_\mu(0) = -\frac{1}{iT}U_\perp'(1)\int_{0}^1 \mathrm{d}s \left(\dot{\tilde{F}} - (U_\perp')^\dagger \dot{F}U_\perp'\right)(U_\perp')^\dagger V_{\mathrm{ad}}P_\mu(0)\\
    &= -\frac{1}{iT} U_\perp'(1) \left(\left[ \tilde{F}(U_\perp')^\dagger V_{\mathrm{ad}}P_\mu(0)\right]_0^1 -\int_0^1\mathrm{d}s (U_\perp')^\dagger \left(F\left(iT\Cut^\perp + [\dot{P}_\mu,P_\mu]\right)+\dot{F}\right)V_{\mathrm{ad}}P_\mu(0)\right)\\
    &= -\frac{1}{iT}U_\perp'(1)\left[[(U_\perp')^\dagger{F}{P}_{\mu} V_{\mathrm{ad}}]_0^1-\int_0^1\mathrm{d}s\left((U_\perp')^\dagger{F} \dot{{P}}_{\mu}{P}_{\mu}V_{\mathrm{ad}}+(U_\perp')^\dagger\dot{F}{P}_{\mu} V_{\mathrm{ad}}\right)\right].
\end{align*}
\end{proof}





\begin{lemma}\label{cor:Fbounds}
Let all quantities be defined as above and let
    \[
    \eta: = 1-\frac{\Vert\Cut^\perp\Vert}{\min\{\Gamma_S,\Gamma_{\overline{S}}\}}.
    \]    
    Then
    \[\max\{\Vert FP_\mu\Vert, \Vert F(P_S-P_\mu)\Vert\}\leq \frac{1}{\eta}\frac{\Vert \dot{H}_S\Vert}{\Gamma_S^2} \]
    and 
    \[\Vert\dot{F}P_\mu \Vert \leq \frac{1}{\eta}\left(\frac{1}{\eta}\frac{\Vert\dot{H}_S\Vert}{\Gamma_S^2}\left(\frac{\Vert\dot{\Cut}^\perp\Vert}{\min\{\Gamma_S,\Gamma_{\overline{S}}\}}+4\Vert \Cut^\perp\Vert \max\left\{\frac{\Vert \dot{H}_S\Vert}{\Gamma_S^2},\frac{2\Vert\dot{H}_{\overline{S}}\Vert+\Vert \dot{H}_{S}\Vert}{\Gamma_{\overline{S}}^2}\right\}\right)+9\frac{\Vert\dot{H}_S\Vert^2}{\Gamma_S^3}+\frac{\Vert\ddot{H}_S\Vert}{\Gamma_S^2}\right).\] 
\end{lemma}
\begin{proof}
    First, note that 
    \[FP_\mu = L^{-1}R\dot P_\mu P_\mu\]
    and 
    \[F(P_S-P_\mu) = P_\mu \dot{P}_\mu L^{-1}RP_S.\]
    Applying norms and using that $\Vert \dot P_\mu\Vert \leq \Vert \dot{H}_S\Vert/\Gamma_S$ \cite[Lemma 8]{jansen2007bounds}, \cref{prop:Rprop,prop:normLinv}, we get our first bound. For the next bound, we recall that 
     \begin{align}\label{eq:dotFP}
     \dot{F}P_\mu &=-L^{-1}\left(\dot\Cut^\perp R+\Cut^\perp\dot{R} \right)L^{-1}R\dot{P}_\mu P_\mu + L^{-1}\dot{R}\dot{P}_\mu P_\mu + L^{-1}{R}\ddot{P}_\mu P_\mu  - P_\mu\dot{P}_\mu L^{-1}{R}\dot{P}_\mu \nonumber\\
     :&= A_0+A_1+A_2+A_3, 
     \end{align} 
     where $A_n$ is the $n^{\mathrm{th}}$ term in the sum. Then using that $\Vert (I-P_\mu)\ddot{P}_\mu P_\mu\Vert \leq \frac{\Vert\ddot{H}_S\Vert}{\Gamma_S}+4\frac{\Vert\dot{H}_S\Vert^2}{\Gamma_S^2}$ \cite[Lemma 8]{jansen2007bounds}, we can bound the norms of the individual $A_n$. In particular, we have that 
    %
     \begin{align*}
         \Vert A_0\Vert &= \Vert L^{-1}(\dot{\Cut}^\perp R + \Cut^\perp \dot R)L^{-1} R\dot{P}_\mu P_\mu\Vert \\
         &=  \Vert L^{-1}(\dot{\Cut}^\perp R + \Cut^\perp \dot R)L^{-1} R(P_S-P_\mu)\dot{P}_\mu P_\mu\Vert\\
         &\leq  \Vert L^{-1}\Vert^2 \Vert (\dot{\Cut}^\perp R + \Cut^\perp \dot R)\Vert  \Vert R(P_S-P_\mu)\Vert \Vert \dot{P}_\mu\Vert  \\
         &\leq \frac{1}{\eta^2}\frac{\Vert \dot H_S\Vert }{\Gamma_S^2} \left(\frac{\Vert\dot{\Cut}^\perp\Vert}{\min\{\Gamma_S,\Gamma_{\overline{S}}\}}+4\Vert \Cut^\perp\Vert \max\left\{\frac{\Vert \dot{H}_S\Vert}{\Gamma_S^2},\frac{\Vert\dot{H}_{\overline{S}}'\Vert}{\Gamma_{\overline{S}}^2}\right\}\right).
    \end{align*}
    Bounding $\norm{A_1}$ is more straightforward, yielding:
    \begin{align*}
         \Vert A_1\Vert &= \Vert L^{-1} \dot{R} \dot{P}_\mu \Vert \\
         &\leq \Vert L^{-1}\Vert \Vert \dot R P_S\Vert \Vert \dot P_\mu\Vert \\
         &\leq 4\frac{1}{\eta}\frac{\Vert \dot H_S\Vert^2}{\Gamma_S^3}.
    \end{align*}
    Next, we have that 
    \begin{align*}        
         \Vert A_2\Vert &= \Vert L^{-1} R\ddot P_\mu P_\mu\Vert \\
         &= \Vert L^{-1} R P_S(I-P_\mu)\ddot P_\mu P_\mu\Vert\\
         &\leq \Vert L^{-1} \Vert\Vert RP_S\Vert \Vert(I-P_\mu)\ddot P_\mu P_\mu\Vert \\
         &\leq \frac{1}{\eta}\left(\frac{\Vert \ddot{H}_S\Vert }{\Gamma_S^2}+4\frac{\Vert \dot H_S\Vert^2}{\Gamma_S^3}\right).
    \end{align*}
    Finally, it holds that
    \begin{align*}
         \Vert A_3\Vert &= \Vert P_\mu \dot{P}_\mu L^{-1} R \dot{P}_\mu\Vert \\
         &\leq \Vert L^{-1}\Vert \Vert \dot{P}_\mu\Vert^2\Vert RP_S\Vert\\
         &\leq \frac{1}{\eta} \frac{\Vert \dot{H}_S\Vert^2}{\Gamma_S^3}.
     \end{align*}
     Using these results and taking the norm of \cref{eq:dotFP} we obtain via the triangle inequality that
     \begin{align*}
         \Vert \dot FP_\mu\Vert &\leq \Vert A_0\Vert +\Vert A_1\Vert +\Vert A_2\Vert +\Vert A_3\Vert\\
         &\leq \left(\frac{1}{\eta^2}\frac{\Vert \dot H_S\Vert }{\Gamma_S^2} \left(\frac{\Vert\dot{\Cut}^\perp\Vert}{\min\{\Gamma_S,\Gamma_{\overline{S}}\}}+4\Vert \Cut^\perp\Vert \max\left\{\frac{\Vert \dot{H}_S\Vert}{\Gamma_S^2},\frac{\Vert\dot{H}_{\overline{S}}'\Vert}{\Gamma_{\overline{S}}^2}\right\}\right)\right)+\left(4\frac{1}{\eta}\frac{\Vert \dot H_S\Vert^2}{\Gamma_S^3}\right)\\
         &\qquad+\left(\frac{1}{\eta}\left(\frac{\Vert \ddot{H}_S\Vert }{\Gamma_S^2}+4\frac{\Vert \dot H_S\Vert^2}{\Gamma_S^3}\right)\right)+\left(\frac{1}{\eta} \frac{\Vert \dot{H}_S\Vert^2}{\Gamma_S^3}\right)\\
         &\leq \frac{1}{\eta}\left(\frac{1}{\eta}\frac{\Vert\dot{H}_S\Vert}{\Gamma_S^2}\left(\frac{\Vert\dot{\Cut}^\perp\Vert}{\min\{\Gamma_S,\Gamma_{\overline{S}}\}}+4\Vert \Cut^\perp\Vert \max\left\{\frac{\Vert \dot{H}_S\Vert}{\Gamma_S^2},\frac{\Vert\dot{H}_{\overline{S}}'\Vert}{\Gamma_{\overline{S}}^2}\right\}\right)+9\frac{\Vert\dot{H}_S\Vert^2}{\Gamma_S^3}+\frac{\Vert\ddot{H}_S\Vert}{\Gamma_S^2}\right).
     \end{align*}
      Finally, we seek to eliminate the only remaining term that depends on the fact that we are considering the perturbed Hamiltonian $H'$---that is $\Vert H_{\overline{S}}'\Vert$. By definition $\dot{H}_{\overline{S}}' = \dot{H}_{\overline{S}}+(\dot{\mu}-\dot{\overline{\mu}})P_{\overline{S}}$. Thus, by the Hellman-Feynman theorem, we find that $\Vert\dot{H}_{\overline{S}}'\Vert = 2\Vert\dot{H}_{\overline{S}}\Vert+\Vert\dot{H}_{S}\Vert$, completing the proof. 
\end{proof}

We have now assembled all of the necessary ingredients to prove our target result (\cref{lemma:perturbadiab}). The proof is presented below.
\begin{proof}[Proof of \cref{lemma:perturbadiab}]
    Using \cref{lemma:perturbedwonorms} we can write $D:=\Vert(U'_\perp(1)-V_{\mathrm{ad}}(1))P_\mu(0)\Vert$ as 
    \[D=\bigg\Vert-\frac{1}{iT}U_\perp'(1)\left[[(U_\perp')^\dagger{F}{P}_{\mu} V_{\mathrm{ad}}]_0^1-\int_0^1\mathrm{d}s\left((U_\perp')^\dagger{F} \dot{{P}}_{\mu}{P}_{\mu}V_{\mathrm{ad}}+(U_\perp')^\dagger\dot{F}{P}_{\mu} V_{\mathrm{ad}}\right)\right]\bigg\Vert.\]
    We obtain
    \begin{align*}
        D&\leq \frac{1}{T}\left(\Vert F(0)P_\mu(0)\Vert+\Vert F(1)P_\mu(1)\Vert+\int_{0}^1\mathrm{d}s\left(\Vert F\dot P_\mu P_\mu\Vert + \Vert \dot F P_\mu\Vert \right)\right) \\
        &\leq \frac{1}{T}\left( 2\max_{s\in [0,1]}\Vert F(s)P_\mu(s)\Vert + \max_{s\in[0,1]}\Vert F(P_S-P_\mu)\Vert \Vert \dot P_\mu\Vert + \max_{s\in[0,1]}\Vert \dot F P_\mu\Vert \right).
    \end{align*}
    Each of these three terms can be directly bounded via \cref{cor:Fbounds}. Summing up these bounds and including the maximization over $s$ yields the result. 
\end{proof}

\section{The Time Independent Case}\label{s:timeindependentcase}
As a simple example which allows us to simply understand the tightness of our bound we consider the static, time-independent case where $\dot H=\dot\Cut=0.$ In this case adiabatic evolution by $H$ on $\vec\mu$ simply gives $e^{-i\mu t}\vec\mu.$
\begin{theorem}\label{thm:timeindep}
    Consider a Hamiltonian $H+\Cut$ with $\dot H =\dot\Cut= 0.$ Then, for $\vec\mu,$ $h$ defined as above, 
    \[\left\Vert (e^{-i(H+\Cut)T}-e^{-i\mu T})P_\mu\right\Vert  \leq  2\sqrt{hT}.\]
\end{theorem}
\begin{proof}
    To start, consider decomposing $\vec\mu$ in the eigenbasis of $H+\Cut$ as $\vec\mu = \sum_i \alpha_i \vec\lambda_i$. It then holds that
    \begin{equation}\label{eq:decomp}
        \sum_i\vert \alpha_i\vert^2 \lambda_i = \mu.
    \end{equation}
    Thus, we have that 
     \begin{align*}
         e^{-i(H+\Cut)t}\vec\mu &= \sum_i \alpha_i e^{-i\lambda_i t}\vec\lambda_i\\
         &= e^{-i\mu t}\sum_i \alpha_i e^{-i(\lambda_i-\mu) t}\vec\lambda_i.
    \end{align*}
    Using \cref{eq:decomp} allows us to write
    \begin{align*}
         \left(e^{-i((H+\Cut)-\mu)t}-I\right)\vec\mu &= \sum_i \alpha_i(e^{-i(\lambda_i-\mu)t}-1)\vec\lambda_i.
    \end{align*}
    Placing a norm on the above expression we obtain the following bound:
    \begin{align*}
         \left\Vert  \left(e^{-i((H+\Cut)-\mu)t}-I\right)\vec\mu\right\Vert^2 &= \sum_i\vert \alpha_i\vert^2 \vert e^{-i(\lambda_i-\mu)t}-1\vert^2 \\
         &= 4\sum_{i}\vert \alpha_i\vert^2 \sin^2 \left(\frac{\lambda_i-\mu}{2}\right)t \\
         &\leq 4\sum_{i}\vert \alpha_i\vert^2 \left\vert\sin \left(\frac{\lambda_i-\mu}{2}\right)t \right\vert\\
         &\leq 2\sum_{i}\vert{\alpha_i}\vert^2 \vert \lambda_i-\mu\vert t\\
         &\leq 4ht,
     \end{align*}
     where to get to the last line we used that $\lambda\leq \mu \leq \lambda+h$ (\cref{prop:evalfacts}) and used \cref{eq:decomp} to obtain that $\sum_{\lambda_i\geq \mu} \vert \alpha_i\vert^2 (\lambda_i-\mu)= -\sum_{\lambda_i<\mu}\vert\alpha_i\vert^2(\lambda_i-\mu)$; consequently, it holds that
     \begin{align*}
     \sum_{i}\vert \alpha_i\vert^2 \vert \lambda_i-\mu\vert &= \sum_{\lambda_i>\mu} \vert \alpha_i\vert^2 (\lambda_i-\mu)-\sum_{\lambda_i<\mu} \vert \alpha_i\vert^2 (\lambda_i-\mu)\\
     &= -2\sum_{\lambda_i<\mu} \vert \alpha_i\vert^2(\lambda_i-\mu)\\
     &\leq 2h\sum_{\lambda_i<\mu} \vert \alpha_i\vert^2\leq 2h. 
     \end{align*}
     The result follows immediately.
\end{proof}
We can compare the time independent bound of \cref{thm:timeindep} to the general bound in \cref{thm:mainresult} when $\dot{H}=\dot{\Cut}=0$. In particular, the bound from \cref{thm:mainresult} reduces to $$2\sqrt{hT\left(1+\sqrt{\frac{2h}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}}}+\sqrt{\frac{2\kappa}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}}}\right)},$$ which, while not tight, is within a multiplicative factor that we expect to be reasonably close to being so. We further suspect it can be made tight in this case by supressing those quantities with $\epsilon_T$ or some similar factor.


\section{Stoquastic Hamiltonians} \label{s:stoquasticH}
So-called stoquastic Hamiltonians are frequently studied in the context of adiabatic quantum computing. Typically defined as Hamiltonians $H$ with all real, non-positive off-diagonal matrix elements, stoquastic Hamiltonians are of interest as they do not exhibit a sign problem when attempting to simulate them. 
In the math literature, such matrices have numerous names, such as (Hermitian) $Z$-matrices, negated Metzler matrices, or essentially nonpositive matrices. It is worth noting, that a broader class of Hamiltonians are still sign-problem free. This broader class, which consists of any \textit{balanced} Hamiltonian, those with frustration index zero, was proposed to be a better definition of stoquastic in Ref.~\cite{jarret2018hamiltonian}. The same concept has been referred to as Hamiltonians of Vanishing Geometric Phase (VGP) form in Ref.~\cite{Hen2021}. 

Putting aside the confusion that arises from an unfortunate proliferation of definitions, it can unambiguously be stated that for balanced Hamiltonians, the Cheeger ratio $h$ that appears in our bounds can, in turn, be both upper- and lower-bounded by the global spectral gap $\gamma$. This allows us to re-express our results in terms of this more directly physical quantity. In particular, the following holds for balanced Hamiltonians ~\cite{jarret2018hamiltonian}:
\begin{equation}\label{eq:stoq_bnd}
    \tilde{\gamma}:= \sqrt{\gamma(2Q+\gamma)} \geq h
\end{equation}
where $\gamma$ is the (global) spectral gap of $H+\Delta$ and
\begin{equation}\label{eq:Q}
Q=\max_i \sum_{j\neq i} |H_{ij}|
\end{equation}
and $h$ is taken as $\min_S h_S$. We implicitly defined the upper bound in \cref{eq:stoq_bnd} as $\tilde{\gamma}$, which we note scales like the global gap $\sqrt{\gamma}$ for sparse Hamiltonians (as naturally arise in physical systems). 
As an immediate consequence of \cref{eq:stoq_bnd} we have the following corollary to our main theorem (\cref{thm:mainresult}) that applies to stoquastic Hamiltonians when $S$ is taken as the minimum cut (i.e.~$h=\min_S h_S$). 
\begin{cor}\label{corr:stoq}
    Let $H+\Delta$ be a balanced, one parameter, twice-differentiable family of Hamiltonians respecting the grading $\mathcal{H}=S\oplus\overline{S}$ and $\Delta(s)$ be a block-antidiagonal perturbation, where $s:=t/T\in[0,1]$ and for all $s$, $S=\argmin_{S'} h_{S'}$. Then, the difference between the unitary evolution $U(1)$ generated by the Hamiltonian $H(s)+\Cut(s)$ acting for time $T$ and the adiabatic unitary evolution $V_{\mathrm{ad}}(1)$ generated by the block-diagonal Hamiltonian $H(s)$ is bounded as 
    \[
    \norm{(U(1)-V_{\mathrm{ad}}(1))P_{\mu(0)}}\leq \max_{s\in[0,1]} \left[2\sqrt{\tilde\gamma TB(H,\Cut,\Gamma_S,\Gamma_{\overline S},\epsilon_T)}+\frac{1}{\eta T}C(H, \dot{H}, \ddot{H}, \Cut,\dot\Cut, \Gamma_S, \Gamma_{\overline{S}} )\right], 
    \]
    where $\tilde\gamma$ is defined as in \cref{eq:stoq_bnd}, 
\begin{align*}
B &:= 1+\sqrt{\frac{2\tilde\gamma}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}}} + \sqrt{\frac{2\kappa}{(1-c)\min\{\Gamma_S,\Gamma_{\overline S}\}}} + \epsilon_T\left(1+ \sqrt{\frac{2\kappa}{\tilde{\gamma}}}\right),
\end{align*}
\begin{align*}
    C&:=    2\frac{\Vert\dot{H}_{S}\Vert}{\Gamma_S^2}+\frac{\Vert\ddot{H}_{S}\Vert}{\Gamma_S^2}+10\frac{\Vert\dot{H}_{S}^2\Vert}{\Gamma_S^3}+\frac{1}{\eta}\frac{\Vert{\dot{H}_{S}}\Vert}{\Gamma_S^2}\left(\frac{\Vert{\dot{\Cut}^\perp\Vert}}{\min\{\Gamma_S,\Gamma_{\overline{S}}\}}+4\Vert\Cut^\perp\Vert \max\left\{\frac{\Vert{\dot{H}_{S}}\Vert}{\Gamma_S^2},\frac{{2\Vert\dot{H}_{\overline{S}}\Vert+\Vert \dot{H}_{S}\Vert}}{\Gamma_{\overline{S}}^2}\right\}\right).
\end{align*}
and
    \[\epsilon_T := \max\{\Vert P_\lambda^\perp U(s)\vec\lambda\Vert, \Vert (I-P_\mu-P_{\overline\mu}) U_\perp'(s)\vec\mu\Vert \},\]
\[
    \eta:=1-\frac{\norm{\Delta^\perp}}{\min\{\Gamma_s,\Gamma_{\overline{S}}\}},
\]
\[
\kappa:= \norm{H+\Delta-\lambda}=\lambda_{n-1}-\lambda,
\]
and $c:=\Vert \Cut\Vert /\min\{\Gamma_S,\Gamma_{\overline S}\}$ is as defined in \cref{assmpn:tbd2}.
\end{cor}
\begin{proof}
    Simply substitute the bound in \cref{eq:stoq_bnd} into \cref{thm:mainresult}.
\end{proof}
We expect that stronger bounds than \cref{corr:stoq} are possible for stoquastic Hamiltonians as nowhere in our derivation of \cref{thm:mainresult} did we make use of the special properties of such Hamiltonians. In particular, stoquastic Hamiltonians have non-negative ground states, which could potentially be leveraged to prove a stronger version of \cref{lemma:cheegerperturb} .

\section{Discussion}\label{s:discussion}
Our results are of particular relevance to the analysis of adiabatic quantum computation and quantum annealing~\cite{annealingPRE1998, farhi2000quantum,Hauke_2020, AlbashRevModPhys2018}. These are variational, analog quantum algorithms where one first initializes the system in the easy-to-prepare ground state of a Hamiltonian $H_0$, and then performs a time-dependent evolution to some other Hamiltonian $H_1$, whose ground state encodes the solution to a computational problem of interest. The goal of such a procedure is to produce a final state with strong support on the ground state of $H_1$. Typically, this ground state is designed to encode the solution to a computational problem of interest, such as a combinatorical optimization problem.

In adiabatic quantum computing, success is guaranteed with high probability, provided the Hamiltonian of the system is changed ``slowly enough,'' where slowly enough is rigorously defined via an adiabatic theorem. However, adiabatic evolution is only a sufficient condition for a successful quantum annealing protocol. Consequently, there has been significant work on designing successful quantum annealing protocols with a faster time-to-solution---this includes ideas such as the quantum approximate optimization algorithm (QAOA)~\cite{farhi2014quantum}, counterdiabatic driving~\cite{demirplak2003adiabatic,berry2009transitionless,odelin2019shortcuts}, and optimal control~\cite{odelin2019shortcuts}. 

Unfortunately, most of this work has been heuristic or numerical in nature. One notable exception is Ref.~\cite{garcia2022lower}, which provides rigorous lower bounds on quantum annealing times via quantum speed limits; however, while these bounds 
were shown to yield an acheivable asymptotic scaling for a handful of toy models with large amounts of symmetry, the generic nature of quantum speed limits means that these bounds are unlikely to help characterize the timescales of practical quantum annealing algorithms. 

Also worth noting is Ref.~\cite{mozgunov2023quantum} which derives a rigorous adiabatic theorem for unbounded Hamiltonians based on applying a cutoff between a low and high energy subspace. These results complement our own. Whereas Ref.~\cite{mozgunov2023quantum} bounds leakage to the high energy subspace, we control interactions between states within the low energy subspace. It seems likely that these results can be unified into an overall framework, but we leave this for future work.

We expect the upper and lower bounds which we derive to usefully quantify the performance of many realistic quantum annealing schemes. We demonstrate that at timescales short of the adiabatic limit, local dynamics can (and likely do) dominate over global dynamics. This does not preclude convergence to particular target states at timescales short of the (global) adiabatic limit, however this convergence can be understood as the result of otherwise local dynamics. In addition to rigorous guarantees on performance in the form of both upper and lower bounds on annealing time, we expect our bounds to provide insight into the actual prospects of many so-called `diabatic' variational procedures~\cite{crosson2021prospects} which, when looked at through the lens of stability, can be understood as locally adiabatic. We will extend our analysis to consider the application of our bounds to such examples in detail in future work.

    
\section*{Acknowledgements}
We thank Michael J. OHara and Andrew Glaudell for useful discussions. This material is based upon work supported
by the Army Research Office under Contract No. [W911NF-20-C-0025]. J.B.~was supported in part by the U.S.~Department of Energy, Office of Science, Office of Advanced Scientific Computing Research, Department of Energy Computational Science Graduate Fellowship (award No.~DE-SC0019323) and in part by the National Science Foundation under Grant No. NSF PHY-1748958, the Heising-Simons Foundation, and the Simons Foundation (216179, LB). J.B. and T.C.M. acknowledge funding by the U.S. Department of Energy (DOE) ASCR Accelerated Research in Quantum Computing program (award No.~DE-SC0020312), DoE QSA, NSF QLCI (award No.~OMA-2120757), DoE ASCR Quantum Testbed Pathfinder program (award No.~DE-SC0019040), NSF PFCQC program, AFOSR, ARO MURI, AFOSR MURI, and DARPA SAVaNT ADVENT.

\input{output.bbl}

\appendix


\end{document}
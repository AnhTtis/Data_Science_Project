%------------------------------------------------------------------------------
% Beginning of journal.tex
%------------------------------------------------------------------------------
%
% AMS-LaTeX version 2 sample file for journals, based on amsart.cls.
%
%        ***     DO NOT USE THIS FILE AS A STARTER.      ***
%        ***  USE THE JOURNAL-SPECIFIC *.TEMPLATE FILE.  ***
%
% Replace amsart by the documentclass for the target journal, e.g., tran-l.
%

% For submission to the proceedings of the American mathematical society
% \documentclass{proc-l}
\documentclass{amsart}


%    Blank box placeholder for figures (to avoid requiring any
%    particular graphics capabilities for printing this document).
\newcommand{\blankbox}[2]{%
  \parbox{\columnwidth}{\centering
%    Set fboxsep to 0 so that the actual size of the box will match the
%    given measurements more closely.
    \setlength{\fboxsep}{0pt}%
    \fbox{\raisebox{0pt}[#2]{\hspace{#1}}}%
  }%
}

\usepackage[colorlinks,citecolor=black]{hyperref}


\input{macro}

\begin{document}

\title{Area formula for spherical polygons via prequantization}

%    Information for first author
% \author{Anonymous author(s)}
\author{Albert Chern}
\author{Sadashige Ishida}

%    Address of record for the research reported here
% \address{Department of Mathematics, Louisiana State University, Baton
% Rouge, Louisiana 70803}
% %    Current address
% \curraddr{Department of Mathematics and Statistics,
% Case Western Reserve University, Cleveland, Ohio 43403}
% \email{xyz@math.university.edu}
% %    \thanks will become a 1st page footnote.
% \thanks{The first author was supported in part by NSF Grant \#000000.}

% %    Information for second author
% \author{Sadashige Ishida}
% \address{Mathematical Research Section, School of Mathematical Sciences,
% Australian National University, Canberra ACT 2601, Australia}
% \email{two@maths.univ.edu.au}
% \thanks{Support information for the second author.}

\subjclass[2020]{Primary 51M25, 53D50; Secondary 26B15}
% General info
% Reference for classification 
% https://mathscinet.ams.org/mathscinet/msc/msc2020.html

% 51M25 
% Geometry
% -> Length, area and volume in real or complex geometry

% 26B15
% Real functions
% -> Integral formulas of real functions of several variables (Stokes, Gauss, Green, etc.)

% 52A38 
% Convex and discrete geometry 
% -> Length, area, volume and convex sets (aspects of convex geometry)

% 28A75  
% Measure and integration
% -> Length, area, volume, other geometric measure theory 

% 53D50
% Differential geometry
% Geometric quantization

% \date{January 1, 2001 and, in revised form, June 22, 2001.}

% \dedicatory{This paper is dedicated to our advisors.}

\keywords{Spherical polygon, prequantum bundle}

\begin{abstract}
    We present a formula for the signed area of a spherical polygon via prequantization.  In contrast to the traditional formula based on the Gauss--Bonnet theorem that requires measuring angles, the new formula mimics  Green's theorem and is applicable to a wider range of degenerate spherical curves and polygons.
\end{abstract}

\maketitle


\section{Introduction}
% \cSI{---------- I rewrote the introduction. This version is very concise and contains no equations, following the style of paper, \href{https://arxiv.org/pdf/1011.2584.pdf}{https://arxiv.org/pdf/1011.2584.pdf}, which is also a PAMS paper and about the volume of a spherical tetrahedron. When brushing up the introduction, please pick up equations you think are needed from the old version, currently located after the new introduction. ----------}
% \cAC{I like the new intro}\cSI{Thanks for the comments. I added some equations accordingly.}\cAC{Nice.}

A spherical polygon is a finite number of ordered points on \(\SS^2\) connected by geodesics. Computing the solid angle of the region enclosed by a spherical polygon is important in many subjects like fluid dynamics \cite{iwc2022implicit_filaments}, electromagnetism \cite{Binysh_2018}, geology \cite{Bevis1987ComputingTA}, and light transport simulation \cite{Ramamoorthi2022}.

For a given polygon \(\Gamma=(p_0, \ldots,p_{n-1})\), this area is often computed using the formula 
% \cAC{If the next eq is the exterior angle, then the area should be \(\Area(\Gamma) = 2\pi - \sum_i\theta_i\).}
% \begin{align}\label{eq:GB_formula}
% \operatorname{Area}(\Gamma)=(2-n)\pi+\sum_i \theta_i, 
% \end{align}
\begin{align}\label{eq:GB_formula}
\operatorname{Area}(\Gamma)=2\pi - \sum_i \vartheta_i, 
\end{align}
% \cSI{I changed the notation from \(\theta\) to \(\vartheta\) as \(\theta\) is reserved for angular difference on fibers.}
derived from the Gauss-Bonnet theorem.
This area formula involves the evaluation 
% \cAC{``evaluation'' sounds better to me here} 
of the exterior angle \(\vartheta_i\) at each vertex 
% \cAC{``vertex'' (exterior angle of a vertex of a polygon should be understandable by everyone)}
\begin{align}\label{eq:exterior_angle1}
    \vartheta_i=\operatorname{sign}\left(\det (p_{i-1},p_i,p_{i+1}) \right)\arccos\left(\frac{p_{i-1}\times p_{i}}{\abs{p_{i-1}\times p_{i}}}\cdot\frac{p_i\times p_{i+1}}{|p_i\times p_{i+1}|}\right),\  
    %(p_{0-1}=p_{n-1}, p_{n}=p_0),
    % \begin{aligned}
    % (&p_{0-1}=p_{n-1},\\ &p_{n}=p_0),
    % \end{aligned}
\end{align}
% \cSI{I removed \(p_{0-1}=p_{n-1}\) stuff as I couldn't find a way to beautifully fit it in the current template, and I think \(p_{0-1}=p_{n-1}\) is obvious to the readers, and we don't have to be super precise in the introduction.}\cAC{Agreed.}
which is a function of three points.
However, this formula requires non-degeneracy assumptions about these points that render it unavailable or numerically unstable in certain situations. 
For example, two consecutive points of the polygon cannot lie on the same location as the exterior angle is undefined. 
We may consider removing such points from the polygon, but judging precisely whether two points are at the same location or just nearby locations is not always possible in numerical computation, especially when the points are obtained after some computational operations. 

On the other hand, an area formula for polygons in \(\RR^2\) does not have such limitations. 
% \cAC{``limitations''?}.
For a polygon \(\Gamma_{\RR^2}=\left((x_0,y_0).\ldots,(x_{n-1},y_{n-1})\right)\), 
% it is given by, \cAC{I'd remove ``it is given by,''}
\begin{equation}\label{eq:planerAreaFormula}
% Sometimes the displaywidth is still the full width of the text
    % without seeing the wrapfigure.  This line fixes it.
 % \displaywidth=\parshapelength\numexpr\prevgraf+2\relax
    %
    \operatorname{Area}(\Gamma_{\RR^2})=\sum_i \frac{1}{2}(x_{i+1}y_i-x_i y_{i+1}).
    % , \, (x_n=x_0, y_n=y_0).
\end{equation}
% \cSI{To be consistent with the above one, I removed \((x_n=x_0, y_n=y_0)\).}
% 
\begin{wrapfigure}[12]{r}{120pt}
\centering
\includegraphics[width=120pt]{images/Planimeter.png}
\caption{A planimeter measures the area of a planar region by tracing and accumulating quantities along its perimeter.}
\label{fig:Planimeter}
\end{wrapfigure}
% 
Unlike the classical formula for spherical polygons \eqref{eq:exterior_angle1},
% \cAC{Pointer to eq number},
this planar area formula involves adding numerically stable edge quantities.
% it involves only a function of two points. \cAC{Surely it involves not only two points, and the number of points involved is not the point here.  The point is that this formula is robust and numerically stable.  Maybe ``The planar area formula involves adding numerically stable edge quantities.''} 
This formula can be derived by converting the area integral over the region into a line integral along the polygon curve using Green's formula. 
This is the same technique that enables 
\emph{planimeters} (\autoref{fig:Planimeter}).
% \cAC{(I hope adding the connection to planimeter is not too silly here.  I think this illustration of planimeter adds more to the potential technological significance of this work.)}\cSI{Good idea!}
% \cAC{``The key that allows Green's formula is that the area form of \(\RR^2\) is \emph{exact}.
% Unfortunately, this strategy does not work directly for spherical polygons as the area form of \(\SS^2\) is not exact.
% ''  Jump to next paragraph...}
The key that allows Green's formula is that the area form of \(\RR^2\) is \emph{exact}.
Unfortunately, this strategy does not work directly for spherical polygons as the area form of \(\SS^2\) is not exact.

% This strategy does not work directly 
% % \cAC{``directly'' might be a better word}
% for spherical polygons since Green's formula is not applicable on \(\SS^2\) as the area form of \(\SS^2\) is not exact. To circumvent this issue, 
% \cAC{(head of paragraph) ``We circumvent this issue in this work.  We lift...''}
We circumvent this issue in this work. 
We lift the area form of the sphere onto a space where the resulting 2-form is exact. More precisely, we utilize 
% exploit \cAC{utilize}
a prequantum bundle, 
which is a principal circle bundle where the lifted 2-form is exact.
 % which is a principal circle bundle over a symplectic manifold such that the pullback of symplectic form by the fibration is translated into the exterior derivative of the connection form of the bundle. \cAC{Try simplifying this explanation of a prequantum bundle. For example ``which is a circle bundle where the lifted 2-form is exact.''}
% \(\pi\colon(Q,\alpha)\to (\Sigma,\beta)\) over a symplectic manifold \((\Sigma,\beta)\) such that its connection 1-form \(\alpha\) satisfies \(d\alpha=\pi^* \beta\). 
% Thanks to this relationship, we can use Green's theorem not on the base manifold, but on the bundle. 
This gives rise to a version of Green's theorem that translates the area integral on the base manifold into a line integral along a lifted perimeter in the bundle.
% \cAC{(line integral ``over'' the bundle doesn't sound right).  ``into a line integral along a lifted perimeter in the bundle.''}.

By choosing a specific prequantum bundle over \(\SS^2\), we can obtain an explicit expression of the line integral. We use  
% \cAC{``use'' instead of ``perform this using''} 
the Hopf fibration \(\pi\colon \SS^3 \to \SS^2\) with a specific connection 1-form and derive a formula for the  area of a spherical polygon. 
% In this formula, we do not have a function that requires three points of the polygon, unlike the classical formula
Unlike the classical formula \eqref{eq:GB_formula}, the new formula does not involve numerically unstable evaluation of angles of three consecutive vertices.  Instead, it only involves a sum of edge-wise measurement resembling \eqref{eq:planerAreaFormula}.  
% \cAC{``Unlike the classical formula (eq ref), the new formula does not involve numerically unstable evaluation of angles of three consecutive vertices.  Instead, it only involves a sum of edge-wise measurement resembling (eqref to the planar area formula)''}. 
% We are also able to recover the classical formula by choosing \(\SO(3)\) as the prequantum bundle. \cSI{As \(\SO(3)\)  and the classical formula are two independent things, we should modify this sentence, but I don't have a good idea.}
% \cAC{We also recover the classical formula \eqref{eq:GB_formula} by choosing \(\SO(3)\) as the prequantum bundle with a specific lift of the polygon.}
We also recover the classical formula \eqref{eq:GB_formula} by choosing \(\SO(3)\) as the prequantum bundle with a specific lift of the polygon.
Finally, we present  numerical examples comparing our formula and the classical formula.  
% \cAC{Those are not called ``illustrations.''  You can call them numerical examples.  ``Finally, we [present \{comparisons\}] or [show \{certain quality\}] with numerical examples.''}
% to illustrate how the choice of the fibration and the lift may affect numerical robustness in some situations.  

\iffalse
\cSI{---------------- Below is the old introduction. ----------------}
\cAC{[Start with a brief motivation] (computing solid angle of a spherical area from its circumference curve is important in surveying in geography, light transport in graphics, EM, fluids.)  The underlying mathematical problem is stated as follows.}

\cAC{[Then we can dive into how this is typically done, i.e.\@ the Gauss Bonnet angle formula \(\to\) We can point out that why this is not ideal \(\to\) In the planar surveying we have the famous Green's formula relying on the fact that \(\sigma\) is exact, and the problem with the spherical case is that it is not.]}

Computing the solid angle of a spherical area from its circumference curve is important in many subjects like fluid dynamics \cite{iwc2022implicit_filaments}, electromagnetism \cite{Binysh_2018}, geology \cite{Bevis1987ComputingTA}, and light transport simulation \cite{Ramamoorthi2022}. The underlying mathematical problem is stated as follows. \cAC{I added the following statement}

\begin{quote}
    \emph{
    Given a spherical polygon \(\Gamma\) described by an ordered list of vertices \(\Gamma = (p_0,\ldots,p_{n-1}\in\SS^2)\), find
    the spherical signed area \(\operatorname{Area}(\Gamma)\) enclosed by \(\Gamma\) (up to an integer multiple of \(4\pi\)).}
\end{quote}

A spherical polygon \(\Gamma\) is  a finite number of ordered points \(\{p_0, \ldots, p_{n-1}\in \SS^2\}\) connected by geodesics. The area of the region enclosed by \(\Gamma\) is informally given by
\begin{align}
    \operatorname{Area}(\Gamma) \colon= \int_\Gamma \sigma
\end{align}
with the standard area form \(\sigma\) of \(\SS^2\).
\cAC{Can we just not define it as ``\(\int_{\Gamma}\sigma\)''?  Whenever needed in the intro just write \({\rm Area}(\Gamma)\).}
\cSI{yes, this sounds good. Maybe we can add \({\rm Area}(\Gamma)\) in the beginning of Equation (1.4), for example.}

Computation of the area of a spherical polygon has been long studied and there are formulae based on the Gauss-Bonnet theorem. Numerical computation is relying on these formulae, 
 but robust computation is still  challenging in certain situations due to the nature of the formulae, which we will explain.
 
 In this paper, we present a new formula for the signed area, which  generalizes the classical formula and is numerically robust. We derive our formula  by lifting the area form of \(S^2\) on a fiber bundle where it becomes exact, allowing for using the Stokes theorem. In particular, by choosing the bundle and the connection, we are able to find an explicit expression for the surface area. \cSI{I still have the impression that this paragraph should come after explaining how the traditional approaches are problematic.}

We first review previous works. The signed area of a spherical polygon is often computed using a well-known formula,
\begin{align}\label{eq:GB_formula}
\operatorname{Area}(\Gamma)=(2-n)\pi+\sum_i \theta_i, 
\end{align}
derived from the Gauss-Bonnet theorem.
Here, \(\theta_i\) is the signed interior angle at  \(p_i\) computed by,
\begin{align}\label{eq:exterior_angle1}
    \theta_i=\operatorname{sign}\left(\det (p_{i-1},p_i,p_{i+1}) \right)\arccos\left(\frac{p_{i-1}\times p_{i}}{|p_{i-1}\times p_{i}|}\cdot\frac{p_i\times p_{i+1}}{|p_i\times p_{i+1}|}\right).
\end{align}
This formula is, however, not available or numerically unstable in certain cases. For example, when \(p_{i-1}, p_i,p_{i+1}\) are on the same great circle, the sign is undefined. In particular, if \(p_{i-1}, p_i\) are exactly or nearly on the same location, \(\frac{p_{i-1}\times p_{i}}{\|p_{i-1}\times p_{i}\|}\) is also undefined or unstable. These situations lead to wrong results.  We may consider removing such points from the polygon, but judging whether two points are on the same location or just nearby locations is practically impossible especially when the points are obtained after some computational operations. Ignoring the contribution of a point \(p_i\) whose geodesic distances between \(p_{i-1}\) and \(p_{i+1}\) are under a given threshold also does not work when the polygon is sampled so densely that the piecewise geodesics are shorter than the  threshold.

To circumvent these issues,  it is worth reviewing the computation of polygonal areas in \(\RR^2\) where  such phenomena do not occur.
% \cCW{Either avoid redundant statements by replacing the 2nd \(\RR^2\) with ``there'', or (better), re-order it by first pointing out that the problem doesn't occur in \(\RR^2\), so we use it as a starting point.}. 
There are two typical approaches on the flat plane:
% \cCW{use ':' instead of ',' when starting a list.} 
area integral and line integral. 
For the former, we can typically compute 
\begin{align}
    \int_\Gamma dx\wedge dy 
    = \sum_i \operatorname{SignedArea}(p_i, p_{i+1}, Z)
    =\sum_i \frac{1}{2}(p_i - Z)\times (p_{i+1}-Z)
\end{align}
by putting a pole point \(Z\) on an arbitrary location in \(\RR^2\) and summing up the signed area of the triangle \((p_i, p_{i+1}, Z)\). 
Another approach is to convert the area integral into a line integral. By the Stokes theorem and a direct computation, we have
\begin{align}
     \int_\Gamma dx\wedge dy 
     &=\int_{\partial \Gamma} x\wedge dy
     =\int_{\SS^1 } \gamma^* (x\wedge dy)
     \\&=\sum_i \int_{s_i}^{s_{i+1}} \gamma_x(s) \frac{d\gamma_y(s)}{ds} ds
    =\sum_i \frac{1}{2}(x_{i+1}y_i-x_i y_{i+1})
\end{align}
where \(\gamma=(\gamma_x, \gamma_y)\colon \SS^1\rightarrow \RR^2\) is a curve parametrizing \(\partial \Gamma\) with \(\gamma(s_i)=p_i:=(x_i,y_i)\) and \(\gamma^*\) denotes the pullback. This actually reduces to the same computation as the area integral with the pole \(Z\) located at the origin.

As for the first approach, we note that we can also locate the pole \(Z\) on \(\SS^2\) and have
\begin{align}
    \operatorname{Area}(\Gamma) 
    =\sum_i \operatorname{sign}\left(\det(p_i,p_{i+1},Z)\right) \operatorname{UnsignedArea}(p_i,p_{i+1},Z)
\end{align}
where the unsigned area of each spherical triangle \((q_0,q_1,q_2)\) is computed as
\begin{align}
    \operatorname{UnsignedArea}(q_0,q_1,q_2)=-\pi + \sum_{i=0}^2 \arccos\left(\frac{q_{i-1}\times q_{i}}{\|q_{i-1}\times q_{i}\|}\cdot\frac{q_i\times q_{i+1}}{\|q_i\times q_{i+1}\|}\right).
\end{align}
However, this formulation also has the same source of instability when \(p_i\) and \(p_{i+1}\) are very close or \((p_i,p_{i+1},Z)\) lie exactly or nearly on the same great circle. Changing the pole location \(Z\) does not help when the polygon is so densely lying over the sphere that we cannot keep all the polygon vertices and far enough from \(Z\).
% \cCW{Not very clear. ``widely spreading the sphere'' is confusing; need to indicate that you don't mean that the polygon has a large area (necessarily), but that you mean the points of the polygon are all over the place. Also, ``the maximum distance between a point on the sphere and the pole is very small'' should be clarified. Depending on the interpretation, it sounds like the max distance between a point on the sphere and pole is always the same (opposite side of the sphere) or if you mean the max distance from a point on the {\em polygon}, then you can probably say this more clearly.}
% \cSI{Good catch. I was originally writing like "when the polygon is densely covering the sphere ...", but \textit{dense} and \textit{cover} are reserved mathematical terms that are not proper here, so I was trying to put it in a different way. I'll explain the intended situation more understandably.}


The latter approach, converting the area integral to a line integral by the Stokes theorem, is not available for spherical polygons as the area form \(\sigma\) of \(\SS^2\) is not exact unlike the case in \(\RR^2\). 
% \cCW{Depending on the intended audience, it might help to unpack this a bit by spelling it more, like ``Stokes Thm requires that you express the area form as the derivative of a potential, but that potential is not guaranteed to exist outside of nice spaces like R2. In other words, it is not exact, so ...'' Saying things a few different ways will help ensure that no readers get lost by accidentally skipping a single word or misunderstanding one particular point that isn't worded perfectly or misread.}
It then is natural to consider lifting \(\sigma\) onto a space where the resulting 2-form becomes exact. \cSI{Maybe insert a line about prequantization.} In particular, if the space is a prequantum bundle, the pulled-back area form is given by the curvature form. Roughly speaking, the relation between a chosen connection of the bundle and the area form gives rise to a formula. For a specific choice of the prequantum bundle, we can derive an explicit expression. 

An example is the Hopf fibration, which states that \(\SS^3\) is a principal-circle bundle over \(\SS^2\).  It is immediate that \(\sigma\) pulled-back to \(\SS^3\) is exact as \(H_{dR}^2 (\SS^3)=0\). Moreover, we can explicitly write \(\eta\in \Omega^1(\SS^3)\) such that \(d\eta=\pi^* \sigma\), which leads to a simple expression of the surface area of the polygon.
\cSI{I think it's good to already state here our main result informally as our main result appears very late in this paper.}
Our main result can be informally stated as follows.
\begin{theorem*}
    Let \(\tilde{\gamma}\) be an arbitrary lift of 
a spherical polygon \(\gamma\colon [0,1]\rightarrow \SS^2\) with respect to the Hopf fibration \(\pi:\SS^3 \rightarrow \SS^2\). The surface area of a spherical polygon \(\Gamma=\{p_i\}_i\) is  of the form
\begin{align}
    \operatorname{Area}(\Gamma)=\sum_i f_{\tilde{\gamma}}(p_i,p_{i+1}),
\end{align}
with a function \(f_{\tilde{\gamma}}\).
% which measures the holonomy of two points on the fiber \(\pi^{-1}p_{i+1}\).
\end{theorem*}
While each term in the summation is dependent on the choice of the lift \(\tilde{\gamma}\), the summation is not. In a later section, we will explicitly give the function \(f_{\tilde{\gamma}}\), but we already note that
in each summand \(f_{\tilde{\gamma}}\) takes only two points \((p_i,p_{i+1})\) without requiring  the {\em angle} at each point \(p_i\) which needs an evaluation of three points \((p_{i-1}, p_i, p_{i+1})\).

We will also explain that such a derivation generalizes the classical formula based on the Gauss-Bonnet theorem. By choosing \(S\SS^2 \approx \SO(3)\) as the principal circle bundle and a specific lift we can recover the classical formula.

Finally, we show examples of numerical computation to illustrate the effect of the choice of the bundle and the lift to computational robustness.

The plan of the paper is as follows. In Section 2, we will introduce necessary definitions and notations. In Section 3, we derive a formula from the Hopf fibration and show that choosing the horizontal lift even simplifies the formula. In Section 4, we review the classical Gauss-Bonnet-based formula as a special case of our formula. \cSI{Maybe mention an extension to \(\CC\PP^d\).} In Section 5, we numerically compare formulae derived from different settings. 
\fi


% \section{Definitions and notations}
\section{Area of a spherical polygon}


  An oriented spherical polygon \(\Gamma\) is a finite cyclic ordered list of spherical points \(\Gamma=(p_0,\ldots,p_{n-1})\), \(p_i \in \SS^2\), \(i\in\ZZ_n=\ZZ/(n\ZZ)\).
 Each edge, \ie\@ each pair of adjacent points 
  \((p_i, p_{i+1})\), \(i\in\ZZ_n\) (including \((p_{n-1},p_0)\) using the modulo arithmetic of \(i\in\ZZ_n\)), is joined by the shortest connecting path on \(\SS^2\).  
  This edge path is a constant point when \(p_i=p_{i+1}\), and is otherwise a part of the great circle containing \(p_i,p_{i+1}\).   
  To ensure uniqueness of the shortest edge path, we assume that \(p_{i+1}\neq -p_i\) for each \(i\in\ZZ_n\), which does not take away generality as one may add intermediate points if the polygon contains any antipodal edge.
  %  is connected with the shortest path over \(\SS^2\), which is a part of the great circle. To ensure the uniqueness of the shortest path, it is natural to assume \(p_{i+1}\neq - p_i\) for each \(i\). 

By concatenating all the edge paths, the spherical polygon \(\Gamma\) is naturally associated with a continuous closed path \(C_\Gamma\colon\SS^1\to\SS^2\).  
Let \(S_\Gamma\colon\DD^2\to\SS^2\) be any continuous extension of \(C_{\Gamma}\colon\SS^1=\partial\DD^2\to\SS^2\) to the unit disk \(\DD^2\).  We call \(S_\Gamma\) the \emph{enclosed region} of the spherical polygon \(\Gamma\), which is unique up to an integer number of full wrappings around the entire sphere.  
Define the \emph{signed area} of \(\Gamma\) as the total signed area of \(S_\Gamma\), which is well-defined modulo \(4\pi\):
\begin{align}
\label{eq:AreaDefinition}
    \operatorname{Area}(\Gamma) 
    \coloneqq 
    \iint_{S_\Gamma} \sigma = \iint_{\DD^2}S_\Gamma^*\sigma\in \RR/(4\pi\ZZ).
\end{align}


Here \(S_\Gamma^*\) denotes the pullback via \(S_\Gamma\), and \(\sigma\in\Omega^2(\SS^2)\) is the standard area form of the unit sphere \(\SS^2\subset\RR^3\) induced by the Euclidean metric. The area form \(\sigma\) can be explicitly written as \(\sigma= \sin \theta d\theta\wedge d\phi\) using a spherical coordinate chart, or as \(\sigma=(x dy \wedge dz + y dz \wedge dx + z dx \wedge dy)/(x^2+y^2+z^2)^{3/2} \ |_{\SS^2}\) using the Cartesian coordinates in \(\RR^3\). 
%The map \(S\) is a continuous map from the unit disc \(D^2\) to \(\SS^2\) such that the restriction \(S|_{\partial D^2=\SS^1}\) gives a parametrization of the curve \(\partial \Gamma\) respecting the order \(p_0, \dots, p_{n-1}\) and \(S^*\) denotes the pullback. 
This definition is valid for self-intersecting polygons (See \autoref{fig:signed_area}) and degenerate polygons which may contain edges of zero lengths or consecutive edges that fold back onto each other. 

\begin{figure}[h]
 % [trim = {left, bottom, right, top}, clip]
 \begin{minipage}[t]{0.45\textwidth}
\includegraphics[width=\textwidth]{images/spherical_area_example.png}
\end{minipage}
 \begin{minipage}[t]{0.45\textwidth}
\includegraphics[width=\textwidth,angle=0]{images/spherical_area_example2.png}
\end{minipage}
\caption{Examples of spherical polygons. Left: the two regions with different colors contribute positively or negatively to the signed area. Right: the darker region contributes to the signed area twice.}
\label{fig:signed_area}
\end{figure}

%In the sequel, we will abuse the notation \(\Gamma\) and the term \textit{spherical polygon} for the points \(\{p_0,\ldots,p_{n-1}\} \) or the enclosed region when there is no confusion.

\subsection{Areas as line integrals}
Our goal is to find a numerically robust formula for \eqref{eq:AreaDefinition} in terms of the vertex positions \(\Gamma = (p_0,\ldots,p_{n-1})\).
More precisely, an ideal area formula we look for is a line integral ``\(\Area(\Gamma)=\oint_{C_{\Gamma}}\alpha\)'' for some smooth differential 1-form \(\alpha\), analogous to Green's Theorem in the plane.
The reason for this desire goes as follows.
Once \eqref{eq:AreaDefinition} becomes a line integral along the polygonal curve, we can derive the formula for \(\Area(\Gamma)\) by summing the explicit integrals of \(\alpha\) along the great circular arc of each edge.
Such a line-integral-based formula would be applicable to degenerate cases: The angles between consecutive edges would never appear in the formula; the line integral of a smooth 1-form along an edge shrinks to zero gracefully if the edge length shrinks to zero.

Such a line integral formula ``\(\Area(\Gamma) = \oint_{C_\Gamma}\alpha\)'' appears to rely on the exactness of \(\sigma\), which is the existence of a smooth 1-form \(\alpha\) so that \(d\alpha = \sigma\). 
If \(\alpha\) exists, then by Stokes' Theorem \(\Area(\Gamma) = \iint_{S_\Gamma}\sigma = \iint_{S_{\Gamma}}d\alpha = \oint_{C_{\Gamma}}\alpha\).
However, the \emph{spherical area form
\(\sigma\) is not exact.}
Fortunately, and perhaps surprisingly, a line integral formula does not require the exactness of \(\sigma\) as described below.

\begin{definition}[Prequantum bundle]
\label{def:PrequantumBundle}
% \cSI{I made changes here and the remark below, according to our discussion.}
Let \(\beta\in\Omega^2(\Sigma)\) be a closed 2-form on a manifold \(\Sigma\).  A \emph{prequantum bundle} over \((\Sigma,\beta)\) is a principal circle bundle \(\pi\colon Q\to\Sigma\) equipped with \(\alpha\in\Omega^1(Q)\) such that \(c\alpha\) with some constant \(c\) is a connection 1-form and \(d\alpha = \pi^*\beta\).
\end{definition}
% \TODO{Mention this is a limiting definition of prequantum bundle. In general, a prequantum bundle needs not to be a priquantum circle bundle. Also a prequantum bundle only required }
\begin{remark}
In a classical definition for a prequantum bundle,  \(d\alpha\) may take the form of 
\( \pi^* \beta =d\alpha+ \omega \) with some 2-form \(\omega\) that vanishes in the horizontal space, but \(\alpha\) must be a connection form.
% \cAC{Why would there be the term \(\alpha\wedge\alpha\) for abelian principal bundle?  Do we mean \(d\alpha =  \pi^*\beta + \omega\) for some 2-form \(\omega\) that vanishes on horizontal subspaces?} \cSI{You are right, we don't have \(\alpha \wedge \alpha\) as we are dealing with only principal circle bundle. Fixed it.}
% \cAC{Ok.}
% \(d\alpha = \pi^*\beta + \alpha\wedge\xi\) for some \(\xi\in\Omega^1(Q)\). 
For our purpose, we require \(d\alpha =  \pi^*\beta\), but allow scaling \(\alpha\) to be a connection form. For the Hopf fibration \(\pi:\SS^3\rightarrow \SS^2\) particularly, the existence of such \(\alpha\) is trivial as \(H_{dR}^2(\SS^3)=0\).
In general, every compact symplectic manifold \((\Sigma,\beta)\) admits a principal circle bundle \((Q,\alpha)\) with \(d\alpha=\pi^* \beta\) by  scaling \(\beta\) so that \(\beta/2\pi\in H_2(\Sigma,\ZZ)\) 
% \cite[Theorem~ 2.5]{blair2010riemannian}.
\cite[Theorem~3]{Boothby_Wang_contact} \cite[Proposition~9]{Kobayashi_Kaeler}.
\end{remark}

% \cSI{I think we should mention here or later in the extension part that such pair \((Q,\alpha)\)  always exists if \(\beta/2\pi\) is an integral class i.e. \(\beta/2\pi\) represents an element of \(H_2(\Sigma,\ZZ)\). It is the case  for every compact symplectic manifold by scaling the symplectic form for instance. }

\begin{proposition}[Lifted Green's theorem]\label{prop:liftedGreenTheorem}
    Let  \(\pi\colon (Q,\alpha)\to(\Sigma,\beta)\) be a prequantum bundle.   
    For each surface \(S\colon\DD^2\to\Sigma\) consider an arbitrary lift \(\widetilde S\colon\DD^2\to Q\), \(\pi\circ\widetilde S = S\).  Then 
    \begin{align*}
        \iint_{ S}\beta = \oint_{\partial \widetilde{ S}}\alpha.
    \end{align*}
\end{proposition}
\begin{proof}
    \(\oint_{\partial \widetilde{ S}}\alpha = \iint_{ \widetilde{ S}}d\alpha =  \iint_{ \widetilde{ S}}\pi^*\beta  =  \iint_{\pi\circ \widetilde S}\beta =  \iint_{ S}\beta\).
    %\cAC{The tilde and the non-tilde \(S\)'s seem flipped.}\cSI{Fixed}
\end{proof}

The lifted Green's theorem enables line integral formula for the area of a spherical curve. Suppose we have a prequantum bundle \(\pi\colon (Q,\alpha)\to(\SS^2,\sigma)\) over the sphere \(\SS^2\).  
For each closed curve \(C_{\Gamma}\) on \(\SS^2\), construct an arbitrary lift \(\widetilde C_{\Gamma}\colon\SS^1\to Q\), \(\pi\circ \widetilde C_{\Gamma} = C_{\Gamma}\).  Then
\begin{align}\label{eq:area_via_prequantum_bundle}
    \Area(\Gamma) = \oint_{\widetilde C_\Gamma}\alpha\mod 4\pi.
\end{align}

\begin{remark}
While all the examples we provide in this article are prequantum bundles, 
% in Definition~\ref{def:PrequantumBundle} 
for \propref{prop:liftedGreenTheorem}
we only need any smooth map \(\pi\colon Q\to\Sigma\) and \(\alpha\in\Omega^1(Q)\) that satisfies \(d\alpha = \pi^*\beta\) and has a general liftability of a topological disk \(S\) to \(\widetilde S\).  In particular, we do not need \(\pi\) to be a circle bundle or \(\alpha\) to be equivariant.
\end{remark}

\iffalse
\paragraph{Prequantum bundle}
\cAC{This subsection can be removed.}
A prequantum circle bundle over a symplectic manifold \((\Sigma, \beta)\) is a principal circle bundle \(\pi:Q\rightarrow \Sigma\) with a connection \(\{H_q\}_{q\in Q}\) (and namely the corresponding connection 1-form \(\alpha\)) such that the curvature form \(D\alpha\in \Omega^2(Q)\) defined as
\begin{align}
    D\alpha(X_1, X_2) := d\alpha(\operatorname{Proj}_{H_q}X_1,\operatorname{Proj}_{H_q}X_2)
\end{align}
satisfies
\begin{align}
    D\alpha = \pi^*\beta.
\end{align}
We can actually take \(\alpha\) completely vertically, meaning that there exists \(\alpha\) such that \((Q,\alpha)\) is a regular contact manifold and \(d\alpha=\pi^*\beta\). Each fiber is then realized as an orbit along the Reeb vector field. This is due to Boothby and Wang [Cite]. \cSI{Reference: Theorem 3.9., Theorem 2.5. in David E. Blair "Riemannian Geometry of Contact and Symplectic Manifolds"}

Our derivation of area formula is a simple application of this structure. By choosing a good principal bundle over \((\SS^2,\sigma)\) and a connection, we may find an explicit formula. In fact, from the Hopf fibration, which is one of the simplest examples of prequantum bundles, we can already derive a simple expression for the surface area.
\fi

\subsection{The Hopf fibration}
\label{sec:HopfFibration}
The Hopf fibration \(\pi\colon\SS^3\to\SS^2\) is a prequntum bundle over \(\SS^2\).
We provide its explicit expressions in the quaternion coordinate \(\HH = \{x\ii +y\jj + z\kk + w\,\vert\, (x,y,z,w)\in\RR^4\}\).
Using the quaternion coordiantes \(q\colon \SS^3\hookrightarrow\HH\cong\RR^4\) and \(p\colon \SS^2\hookrightarrow\Im\HH\cong\RR^3\), 
%By identifying the 3-sphere \(\SS^3\) with the set of unit quarternions \(\SS^3 = \{q\in\HH\,|\,|q| = 1\}\) and the 2-sphere \(\SS^2\) with the set of unit imaginary quaternions \(\SS^2 = \{p\in\HH\,|\, |p| = 1, \Re(p) =0\}\), 
Hopf's bundle projection is given by
\begin{align}
\label{eq:HopfMap}
    \pi\colon \SS^3\to\SS^2,\quad \pi(q)\coloneqq q\ii \conj q.
\end{align}
Note that \(\pi\) is a principal circle bundle with  action \(\lhd\colon\SS^1\times\SS^3\to\SS^3, (\lhd e^{-\ii\theta})q \coloneqq qe^{-\ii\theta}
\)
% \cAC{\((\lhd e^{-\ii\theta})q \coloneqq qe^{-\ii\theta}
% \)}\cAC{It's also normal to see the left group action on principal bundle (which serves as frame or basis) by inverse group element.}.  
% For  \(q,q'\in \pi^{-1}p\) on some \(p\in \SS^2\), we write \(\arg(\bar{q} q')=\theta\) with  \(e^{i\theta}\in \SS^1= \SS^3 \cap \CC \) such that \(q'=q e^{i\theta}\). 
For \(q\) and \(q'\coloneqq q e^{-\ii\theta}\) on a same fiber, we write \(\arg(\conj{q'}q)=\theta\).
% For \(q\) and \(q'\coloneqq q e^{\ii\theta}\) on a same fiber, we write \(\arg(\bar{q}q')=\theta\).
% \cAC{For \(q\) and \(q'\coloneqq q e^{-\ii\theta}\) on a same fiber, we write \(\arg(\conj{q'}q)=\theta\).}
% \cSI{I think this sentence is needed otherwise readers would need sometime understanding "\(\arg\)" that shows up later if we don't explicitly say \(\bar{q} q' \) is indeed in \(\CC\) for \(\bar{q},q'\) on the same fiber. In this case, I think writing too much is better than writing too little.}
% \cAC{ok. Do be aware of that the definition of \(\alpha\) has a factor of 2.  If you want to call \(\alpha\) a connection for a principal \(\SS^1\) bundle, the group action might also have a factor of 2 in the exponent...}\cAC{Nevermind. Factor of 1/2 is remarked elsewhere}

The 1-form \(\alpha\in\Omega^1(\SS^3)\) for the prequantization is expressed as
\begin{align}
\label{eq:Hopf1Form}
% \alpha = -2\Re(\ii \conj q dq)=2\Re(d\conj q q\ii) = -2\Re( dq\ii \conj q) = 2\Re(q\ii d\conj q).
\alpha = 2\Re(\ii \conj q dq)=-2\Re(d\conj q q\ii) = 2\Re( dq\ii \conj q) = -2\Re(q\ii d\conj q).
\end{align}
% \cAC{Revised minus sign should be: 
% \begin{align}
% \label{eq:Hopf1Form}
% \alpha = 2\Re(\ii \conj q dq)=-2\Re(d\conj q q\ii) = 2\Re( dq\ii \conj q) = -2\Re(q\ii d\conj q)
% \end{align}
% }
The 1-form \(\alpha/2\) is a connection form as it is equivariant under \(\SS^1\) actions: \((\lhd e^{\ii\theta})^*\alpha = \alpha\) and \({1\over 2}\alpha({d\over d\theta}\vert_{\theta=0}(\lhd e^{-\ii\theta})q)=1\). 
% \cAC{I added this last sentence to account for \(\alpha\) being a connection.}
% Explicitly, 
% \begin{align}
%     \alpha_q\llbracket \mathring q\rrbracket \coloneqq 2\Re(-\ii \conj{q}\mathring q),\quad q\in\SS^3, \mathring q\in T_q\SS^3.
% \end{align}
\begin{proposition}
\label{prop:HopfPrequantum}
    The 1-form \(\alpha\in\Omega^1(\SS^3)\) defined in \eqref{eq:Hopf1Form} and the map \(\pi\colon\SS^3\to\SS^2\) defined in \eqref{eq:HopfMap} satisfy \(d\alpha = \pi^*\sigma\), where \(\sigma\in\Omega^2(\SS^2)\) is the standard area form on the unit sphere.  That is, \((\SS^3,\alpha)\) is a prequantum bundle over \((\SS^2,\sigma)\). 
    % \cSI{In order that \((\SS^3,\alpha)\) is a prequantum bundle according to Definition 1, we also need \(\alpha\) to be indeed a connection form. Can we just say "It is easy to check \(\alpha\) is a connection form" or  "it is easy to see \(\alpha(X_\xi)=\xi\) for \(\forall \xi \in \operatorname{Lie(\SS^1)}=\RR\)  and \(\operatorname{Ad}_s\left(R_s^* \alpha\right)=\alpha\) for \(s\in\SS^1\)."? Or should we write a proof?}
\end{proposition}
This result is known (\cite{bengtsson_zyczkowski_2006}, \cite[Theorem~ 1]{chernSchroedinger}), but we give a proof in \autoref{appendix:proof_of_prequantum_bundles} for completeness. 
% \cAC{just say ``for completeness''}.
% \cAC{Just put the references in a paranthesis after ``This result is known ([cite]),''}
% \cAC{Schr\"odinger smoke is also not original.  The formula is well-known in Hopf fibration.  In any case, it is good to add a reference.}\cSI{I can't find a reference of \(d\alpha = \pi^*\sigma\) for this specific \(\alpha\) other than  Schroedinger's smoke. Could you refer to one?}\cAC{The book ``Geometry of Quantum States: An Introduction to Quantum Entanglement'' by  Ingemar Bengtsson, Karol Zyczkowski}\cSI{Thanks!}
% \cAC{We can hide the proof in an appendix to keep the flow of the paper.}\cSI{I don't have a strong preference, but keeping the proof here is ok for me as it's not long. Also, I think we should mention that this statement is proven in previous work like Schroedinger's smoke, but we give slightly more explicit proof. }
% 
With this setting, \propref{prop:liftedGreenTheorem} is now written more concretely for a spherical polygon:
% \cSI{I inserted a line before the corollary.}\cAC{Remove ``a little''}
\begin{corollary}
\label{cor:HopfArea}
    The area \(\Area(\Gamma)\) of a spherical polygon \(\Gamma=\{p_i\}_i\) can be evaluated by a line integral
    % \begin{align}
    % \label{eq:AreaByHopf}
    %     \Area(\Gamma) = \oint_{\widetilde C_\Gamma}\alpha\mod 4\pi
    % \end{align}
    \begin{align}
        \label{eq:AreaByHopf}
        \Area(\Gamma) = \sum_i\int_{\widetilde C_\Gamma([t_i,t_{i+1}])}\alpha\mod 4\pi
    \end{align}
    where \(\alpha\) is given by \eqref{eq:Hopf1Form} and \(\widetilde C_\Gamma\) is an arbitrary lift \(\widetilde C_\Gamma\colon\SS^1\to\SS^3\) of the polygon curve \(C_\Gamma = \pi\circ\widetilde C_\Gamma \colon\SS^1\to\SS^2\) with \(C_\Gamma(t_i)=p_i\) for each \(i\).
    % \cSI{I changed the equation in this corollary as the previous one was almost the same as \autoref{eq:area_via_prequantum_bundle} and I think using the current one makes the flow smoother.}\cAC{ok.}
\end{corollary}

\iffalse
we work in the space of quaternions \(\HH\) and regard \(\SS^3, \SS^2, \SS^1\) as specific submanifolds of \(\HH\) for the sake of simple exposition,  but  our arguments are independent of these specific settings and our results remain unchanged for \(\RR^4\) with the  Eucleadian inner product. For each \(q=w+ ix+jy+kz \in \HH\), we denote its conjugacy by \( \bar{q}:=w-ix-jy-kz\) and the magnitude \(|q|^2=\bar{q}q\). We set
\begin{align}
    \SS^3 = \left\{q=w+ \ii x+\jj y+\kk z \in \HH\  \big|\ |q|=1 \right\},
\end{align}
\begin{align}
    \SS^2 = \left\{q=ix+jy+kz \in \HH\  \big|\ |q|=1 \right\},
\end{align}
and
\begin{align}
    \SS^1 = \left\{q=w+ix \in \CC \subset\HH\  \big|\ |q|=1 \right\}.
\end{align}
In this paper, \(e^{(\cdot)}\) is  the exponential map for  \(\xi\in T_1 \SS^3 = \{ix+jy+kz\in \HH\}\) given by \(e^{\xi}=\cos |\xi|+ \frac{\xi}{|\xi|}\sin |\xi|\). For \(s=e^{i\theta}\in \SS^1 = \CC \cap \SS^3\), we say \(\operatorname{arg}(s)=\theta\).

The Hopf fibration is a principal \(\SS^1\)-bundle with the base space \(\SS^2\) and the fiber bundle \(\SS^3\). We work with the specific fibration,
\begin{align}
    \pi\colon  & \SS^3 \rightarrow \SS^2\\
    & q \rightarrow \bar{q} i q.
\end{align}
For \(\pi\), the \(\SS^1\)-action over the fiber \(\pi^{-1}p \approx \SS^1 \) of each \(p\in \SS^2\) is simply the multiplication
\begin{align}
    q\rightarrow s q 
\end{align}
by \(s\in \SS^1\). 

% by \(e^{i \theta}\in \SS^1\). 

% \TODO{Choice of connection}
Of course, the resulting formula varies for a different choice of the fibration \(\pi\).
\fi


\section{The area formula via the Hopf fibration}

% \cAC{Our goal is to derive an explicit formula for each summand of \eqref{eq:AreaByHopf}.}
% In the next section, we expand \eqref{eq:AreaByHopf} into an explicit formula as the sum of the exact line integrals along each great circular arc of the spherical polygon. 
In this section, we obtain an explicit formula by evaluating each piece of the line integral in  \eqref{eq:AreaByHopf} along a great circular arc lifted onto \(\SS^3\). 
We first define {\em dihedral} for a pair of spherical points.
\begin{definition}
    For each \(p,p'\in\SS^2\), \(p\neq -p'\), define
    \begin{align}
        \Dihedral(p,p')\coloneqq \sqrt{1+\langle p,p'\rangle\over 2} + {p\times p'\over \sqrt{2+2\langle p,p'\rangle}} \in\SS^3\subset\HH.
    \end{align}
    which is the unit quaternion that represents the minimal rotation that rotates \(p\) to \(p'\) i.e. \(rp\conj r = p'\), \(r = \Dihedral(p,p')\).
\end{definition}
There is a unique (unnormalized) \emph{rotation axis} \(v\in T_1 \SS^3 (= \operatorname{Im}\HH) \) for the minimal rotation for non-antipodal \(p,p'\in \SS^2\). This axis \(v\) is parallel to \(p\times p'\) and  \( \Dihedral(p,p')=e^{\frac{v}{2}}\) by the exponential map on  \(\SS^3\).
We also note that  any \(q\in\pi^{-1}p\), the point \(\Dihedral(p,p')q\) is on \(\pi^{-1}p'\). 
% \cSI{This paragraph is needed as we use all the information here in the sequel.}
% \cAC{Ok.}

We will see that each summand in \eqref{eq:AreaByHopf} can be explicitly expressed in terms of the dihedral after recognizing how the dihedral represents the horizontal lift over a great circular arc.

% We will see that each summand in \eqref{eq:AreaByHopf} 
% % \cAC{\eqref{eq:AreaByHopf}?} \cSI{Fixed, thanks!}
% is actually given by 
% the holonomy between two points on a same fiber. 
% \cAC{(I think the term ``holonomy'' makes little sense here; holonomy is of a loop.  Here we just mean ``angular difference between two points on a fiber'')}
% One of the points is given by an arbitrarily chosen lift and the other is by a uniquely determined horizontal lift over \((\SS^3,\alpha)\). 
% \cAC{(This sentence is hard to decode. Maybe just leave it as ``We will see that each summand can be explicitly expressed in terms of the above dihedral quaternion after recognizing how dihedral represents horizontal lifts.'')}\cSI{Good idea! I did so.}\cAC{Great.}
% We first give an explicit expression of the horizontal lift.

% and it is easy to check that \(\operatorname{ker}d\pi=\operatorname{Span}(iq)\). We chose the connection \(H_q=\operatorname{Span}(jq,kq)\) at each \(q\in \SS^3\). 


% The connection 1-form corresponding our chosen connection \(H_q\) is \(\eta=2 \langle iq,dq\rangle_{\RR^4}\) where \(\langle \cdot, \cdot \rangle_{\RR^4}\) is the coordinate-wise inner product. It is not difficult to check \(d\eta= \pi^*\sigma\) \TODO{Cite Schr√∂dinger's smoke}.  


\begin{proposition}[Horizontal lift on \((\SS^3,\alpha)\)]\label{prop:horitontal_lift}
Consider the Hopf fibration \(\pi\colon(\SS^3,\alpha)\allowbreak \to (\SS^2,\sigma)\) described in \secref{sec:HopfFibration}.
Let \(p_0, p_1\) be two arbitrary non-antipodal points on \(\SS^2\), let
    \(\gamma\colon [0,1]\to \SS^2\) be the great circular arc joining \( p_0 \) and \(p_1\), and let \(v\in T_1 \SS^3\) be the imaginary quaternion such that \(e^{\frac{v}{2}}= \Dihedral(p_0,p_1)\).
    % 
% Let the fibration \(\pi:\SS^3\rightarrow \SS^2\) and the connection \(\{H_q\}_{q\in\SS^3}\) as defined above. For \(p, p' \in \SS^2\), let \(\{p_t\}_{t\in[0,1]}\) be the  geodesic with \(p_0=p\) and \(p_1=p'\). 
Then for each given point \(q\in \pi^{-1}p_0\), the horizontal lift \(\tilde{\gamma}_H\) of \(\gamma\)  with \(\tilde{\gamma}_H(0)=q\) is given by 
\begin{align*}
    \tilde{\gamma}_H (t)= e^{\frac{vt}{2}} q .
\end{align*}
% \cAC{By the way, the global sign flip of \(\alpha\) doesn't affect this proposition, in case anyone is wondering.}
% the unnormalized rotation axis between \(p\) and \(p'\) i.e. \(p'=e^{\frac{v}{2}} pe^{\frac{-v}{2}}\).
% with the dihedral angle \(|v|=\operatorname{arccos}(p\cdot p')\).
\begin{proof}
% Let us define 
% \(q_t:=\tilde{\ell} (p_t)\) and 
% \(r(t):=e^{\frac{vt}{2}}\).
It follows from  
% \(\gamma(t)=r(t) p_0 \overline{r(t)}\)
\(\gamma(t)= e^{\frac{vt}{2}} p_0 e^{-\frac{vt}{2}}\)
that \(\tilde{\gamma}_H\) is a lift over \(\gamma\) with respect to \(\pi\).
% 
We now show that \(\tilde{\gamma}_H\) is horizontal. 
At each \(q\in \SS^3\), the tangent space and the horizontal subspace
% \cAC{horizontal subspace} \cAC{(I would call \(H_q\SS^3\) ``horizontal subspace'' instead of ``connection'' to be clearer.)}
with respect to 
the connection 1-form \(\alpha/2\) are \(T_q \SS^3=\operatorname{Span}( q\ii, q\jj, q\kk)\) and \(
% \operatorname{ker}(\alpha)
H_q \SS^3=\operatorname{Span}( q\jj, q\kk)\) respectively.
We have for each \(t\) that
\begin{align*}
    \frac{d}{dt}\tilde{\gamma}_H (t)
    % = \frac{d}{dt} q e^{\frac{-vt}{2}}
    = \frac{1}{2} e^{\frac{vt}{2}} v q.
    % = -\frac{1}{2}q v \overline{r(t)}.
\end{align*}
Here we note that the conjugation \( h \mapsto q h \bar{q}\) is an isometry in \(\operatorname{Im}(\HH)\), from which it follows that 
\(v\in q (H_q \SS^3) \bar{q}\)
% \(v=q H(a\jj +b\kk )\bar{q}\) with some \(a,b\in \RR\) 
as
% \(\langle v,p\rangle=0\).
\begin{align*}
    0=\langle v,p\rangle=\langle q (\bar{q} v  q)\bar{q}, q\ii \bar{q}\rangle.
\end{align*}
Therefore, \(e^{vt\over 2}vq\) is horizontal.
% \begin{align*}
%     e^{\frac{vt}{2}} v q
%     \in  H_{\tilde{\gamma}_H (t)} \SS^3.
%     % qv \overline{r(t)}=
%     % \tilde{\gamma}_H (t) (a\jj+b\kk).
%     % \in \operatorname{Span}(\tilde{\gamma} _H(t) \jj , \tilde{\gamma}_H (t)\kk).
% \end{align*}
% \cAC{The last sentence sounds awkward. I think it can just be a real inline sentence like ``Therefore, \(e^{vt\over 2}vq\) is horizontal.''  It sounds better when the end of a proof is a clear conclusion.}
\end{proof}
\end{proposition}

\begin{lemma}
\label{lem:SegmentIntegral}
% Consider the Hopf fibration \(\pi\colon(\SS^3,\alpha)\to(\SS^2,\sigma)\) described in \secref{sec:HopfFibration}.
% Let \(p_0, p_1\in\SS^2, p_0\neq -p_1\), be two arbitrary points on the sphere, and let
%     \(\gamma\colon [0,1]\to \SS^2\) be the great circular arc connecting them \(\gamma(0) = p_0, \gamma(1)=p_1\).  
Assume \(\pi\colon(\SS^3,\alpha)\to(\SS^2,\sigma)\), \(p_0,p_1\in \SS^2\), and \(\gamma\colon [0,1]\to \SS^2\)  as in \propref{prop:horitontal_lift}.
    Then for any lift \(\tilde\gamma\colon[0,1]\to\SS^3\) of \(\gamma\), 
    % \(\pi\circ\tilde\gamma = \gamma\),
    the line integral \(\int_{\tilde\gamma}\alpha\) is explicitly given by
    % \begin{align}
    %     \int_{\tilde\gamma}\alpha = 2\arg\bigl(\conj{q_0}\Dihedral(p_1,p_0)q_1\bigr)\mod 4\pi
    % \end{align}
        \begin{align}
        \int_{\tilde\gamma}\alpha = 2\arg\bigl(\conj{q_1}\Dihedral(p_0,p_1)q_0\bigr), % \mod 4\pi,
    \end{align}
    % \cSI{I dropped \(\mod 4\pi\) here as we are now only thinking about a single edge. I think it's ok as  \(\mod 4\pi\) in the main theorem comes from our definition of \(\operatorname{Area(\Gamma)}\). }\cAC{ok}
    % \cAC{Revised sign flip should be
    % \begin{align}
    %     \int_{\tilde\gamma}\alpha = 2\arg\bigl(\conj{q_1}\Dihedral(p_0,p_1)q_0\bigr)\mod 4\pi
    % \end{align}
    % }
    where \(q_0 \coloneqq \tilde\gamma(0)\), \(q_1  \coloneqq \tilde\gamma(1)\).
    \begin{proof}
  \propref{prop:horitontal_lift} asserts that \(q_0\in \pi^{-1}p_0\) 
  % \cAC{\(q_0\) being in \(\pi^{-1}(p_0)\) is not part of the statement asserted by Prop 3.1.}\cSI{In the last line of the statement of this lemma, we defined \(q_0 = \tilde\gamma(0)\). And \(\tilde{\gamma}\) is a lift of \(\gamma\) which connects \(p_0\) and \(p_1\). So \(q_0 \in \pi^{-1}(p_0)\) is said. But for making it clearer, I changed \(q_0 = \tilde\gamma(0)\) to \(q_0 \coloneqq \tilde\gamma(0)\) in light of your comment.}
  and \(q_H\coloneqq \Dihedral(p_0,p_1) q_0 \in \pi^{-1} p_1\) are connected by the unique horizontal lift \(\tilde{\gamma}_H\).
% \cAC{This sentence looks ok now.}
Let us consider a parametric surface
% \cAC{domain sounds like an top-dimensional open subset.  Maybe ``parametric surface''}
\(\Delta \subset \SS^3\) given by
% \cAC{Use ``\(\coloneqq\)'' not ``\(\colon=\)''}\cSI{Fixed it, thanks!}
% \cAC{Saw you changed it but still not right.  Use \(\coloneqq\) and not \(:=\) or \(\colon=\).}
\begin{align*}
    \Delta \coloneqq \left\{  \tilde{\gamma}_H(t) e^{\ii\theta} \in \SS^3 \big| t\in[0,1], \theta\in[0,\theta_t] \  \right\},
\end{align*}
where \(\theta_t\) for each \(t\) is the angular difference  \(\theta_t\coloneqq \arg\left(\overline{\tilde{\gamma}(t)}\tilde{\gamma}_H(t)) \right)\).  We first obtain that 
\begin{align*}
    \int_{\partial\Delta} \alpha 
    = \int_\Delta d\alpha 
    = \int_{\Delta} \pi^*\sigma =0,
\end{align*}
as \(\pi(\Delta)=\gamma([0,1])\).

Note that the boundary \(\partial \Delta\) is a  closed path consisting of three segments: (I).  the lift lifted path \(\tilde{\gamma}\) from \(q_0\) to \(q_1\); (II). the vertical path \(\{q_1 e^{\ii\theta} \ |\ \theta\in [0,\theta_1] \}\) from  \(q_1\) to \(q_H\);  (III). the horizontal lift \(\tilde{\gamma}_H\) from \(q_H\) to \(q_0\). 
% \cAC{For this type of enumeration, I would use (I), (II), (III) or (i), (ii), (iii).  It looks less weird.  I also added a colon and semicolons.}
Since the integral of \(\alpha\) along the third path makes no contribution, we have
\begin{align*}
    \int_{\tilde{\gamma}} \alpha 
    &= - \int_{\{q_1 e^{\ii\theta} \ | \ \theta\in [0,\theta_1] \}}\alpha 
    = \int_{\{q_1 e^{-\ii\theta} \ | \ \theta\in [-\theta_1,0] \}}\alpha 
    = \int ^0 _{-\theta_1} \alpha 
    % |_{(\lhd e^{-\ii\theta}) q_1}
    \left(\frac{d}{d\theta} (\lhd e^{-\ii\theta}) q_1 \right) d\theta \\
    &= \int ^0 _{-\theta_1}  2 d\theta
    =  2\arg\left(\conj{q_1}q_H\right),
\end{align*}
which concludes the proof. 
% \cAC{I think the last step probably still needs to plug in one of the expressions of \(\alpha\) involving derivative for the sake of calling it the fundamental theorem of calculus. } 
% \cSI{In the end I computed explicitly.}\cAC{ok}
 % \cAC{Also, there is a missing factor of 2.} 
 % \cAC{With the revised sign, it should be \(=2\arg\left(\conj{q_1}q_H\right)\)} \cAC{Add a mod \(4\pi\) for consistency.}
\end{proof}
\end{lemma}

As a direct result of  \corref{cor:HopfArea} and \lemref{lem:SegmentIntegral}, we obtain our main theorem:


\begin{theorem}[Area formula via the Hopf fibration]\label{th:area_formula}
    Let \(\Gamma = (p_0,\ldots,p_{n-1}), p_i\in\SS^2, i\in \ZZ_n\), be a spherical polygon.  For each \(i\in\ZZ_n\), pick an arbitrary lift \(q_i\in\SS^3\)  i.e. \(\pi(q_i) = p_i\).  Then,
    \begin{align}
    \label{eq:FinalAreaFormula}
        % \Area(\Gamma) = 2\sum_{i=0}^{n-1}\arg\bigl( \conj{q_i}\Dihedral(p_{i+1},p_i)q_i\bigr)\mod 4\pi.
        \Area(\Gamma) = 2\sum_{i=0}^{n-1}\arg\bigl( \conj{q_{i+1}}\Dihedral(p_{i},p_{i+1})q_i\bigr)\mod 4\pi.
    \end{align}
    % \cAC{Revised sign (also fixed indices):
    % \begin{align}
    % \label{eq:FinalAreaFormula}
    %     \Area(\Gamma) = 2\sum_{i=0}^{n-1}\arg\bigl( \conj{q_{i+1}}\Dihedral(p_{i},p_{i+1})q_i\bigr)\mod 4\pi.
    % \end{align}
    % }
\end{theorem}

% \cAC{===The proof for the lemma is still missing.  I am thinking it can just be a purely algebraic check, as we do have the explicit formula for \(\alpha\).  One may add a remark to state that the intuition of the formula of the lemma is that \(\Dihedral(p_0,p_1)\) is the parallel transport and \(\Dihedral(p_1,p_0)\) is its inverse; the integral of \(\alpha\) is \(\int_{\tilde\gamma}\alpha=\int_\gamma\nabla\tilde\gamma\) which becomes the boundary evaluation by the covariant fundamental theorem of calculus. }\cSI{Yes, I agree that it's a good idea to say "\(\Dihedral(p_0,p_1)\) is the parallel transport and \(\Dihedral(p_1,p_0)\) is its inverse; the integral of \(\alpha\) is \(\int_{\tilde\gamma}\alpha=\int_\gamma\nabla\tilde\gamma\) which becomes the boundary evaluation by the covariant fundamental theorem of calculus. ", but am struggling to find a right place and write it.}\cAC{This is settled right?}\cSI{I think the first part that the Dihedral is the parallel transport is settled. But the second part \(\int_{\tilde\gamma}\alpha=\int_\gamma\nabla\tilde\gamma\) is not quite reflected in the text and am struggling to put it.}\cAC{I think it is ok to leave it as is.  It's possible that introducing \(\nabla\) makes the exposition harder to parse.  You can go ahead and use these 10 different equivalent ways to explain the formula in talks, future lecture notes, thesis etc. depending on your audience.  To me, we already have a paragraph right before Prop 3.1 that hints about the connection fundamental theorem of calculus.}\cSI{Sounds good.}

%\subsection{Choice of lift}
The formula requires an arbitrary lift \(q_i\in\SS^3\) of the vertex positions \(p_i\in\SS^2\) for \(i\in\ZZ_n\). An example is
\begin{align}
\label{eq:ChoiceOfLift}
    q_i = 
    \begin{cases}
        \Dihedral(\ii,p_i),& \langle p_i,\ii\rangle \geq 0,\\
        \Dihedral(-\ii,p_i)\jj,& \langle p_i,\ii\rangle <0,
    \end{cases}
\end{align}
which is uniquely defined globally.

% \begin{align}
%     & l_{+}(p)=\overline{r_+} \quad \textup{  if } \langle p,i\rangle>0\\
%      & l_{-}(p)=j\overline{r_-} \quad \textup{  else } 
% \end{align}
% where \(r_\pm\) are the rotation quaternions such that \(p=r_\pm (\pm i) \overline{r_\pm}\).

As a special case of \autoref{th:area_formula}, choosing the horizontal lift results in no contribution of \(\alpha\) except for the endpoint of the polygon.
\begin{corollary}[Area formula by 
% for \cAC{``by'' or ``using''} 
the horizontal lift ]\label{cor:horizontal_lift_area_formula}
Let \(q_0\) be a point in the fiber \(\pi^{-1}p_0\) and let us inductively define \(q_{i+1}:=\Dihedral(p_i,p_{i+1}) q_i \) for \(i=0,\ldots,n-1\). Then we have
\begin{align}
    % \operatorname{Area}(\Gamma) =2\arg(\overline{q_{n}} q_0  ).
    \operatorname{Area}(\Gamma) %\mod 4\pi 
    =2\arg(\conj{q_{0}} q_n  ).
\end{align}
% \cAC{
% \begin{align}
%     \operatorname{Area}(\Gamma) =2\arg(\conj{q_{0}} q_n  )\mod 4\pi.
% \end{align}
% }
% \cAC{Don't write ``It holds, [eq].'' Write ``Then we have [eq]'' (Note that there is no comma) or ``Then [eq].''}
\end{corollary}
At the end of the section, we make a remark regarding the numerical stability of the formula \eqref{eq:FinalAreaFormula}.
\begin{remark}
    The branching discontinuities in the ``\(\arg\)'' function in \eqref{eq:FinalAreaFormula} and the ``if'' statement in \eqref{eq:ChoiceOfLift} are smooth in the mod-\(4\pi\) arithmetic of \eqref{eq:FinalAreaFormula}.
The only calculation that can be numerically unstable is the evaluation of the \(\Dihedral\) function when the two arguments are close to antipodal.
This antipodal dihedral evaluation is avoided by the choice \eqref{eq:ChoiceOfLift}.
The entire evaluation of our area formula \eqref{eq:FinalAreaFormula} with \eqref{eq:ChoiceOfLift} is numerically stable as long as we do not have antipodal edges where \(\langle p_i,p_{i+1}\rangle \approx-1\), which is easily preventable by inserting a midpoint to any close-to-antipodal edge.
% \cSI{I moved this remark here as this section itself has nothing to do with numerics or numerical stability. }\cAC{Ok.}
\end{remark}

% \cAC{Below are old texts.  But I think this is the end of this section.  I don't know whether Section 4 is needed anymore, it doesn't add anything.  It's natural to jump to the result section from here.===}\cSI{I think the derivation of the classical formula OR/AND the area formula on \(\CC\PP^n\) is needed. Otherwise "prequantum bundle" is overkill because for the Hopf vibration \(\SS^3 \rightarrow\SS^2\), \propref{prop:liftedGreenTheorem} is not needed as the existence of \(\alpha\) s.t. \(d\alpha=\pi^* \sigma\) is obvious from \(H_{dR}^2(\SS^3)=0\).}
% \cAC{I guess \(\SO(3)\) does give another example of prequantization.  The purpose of Prop 2.1 is not about existence of \(\alpha\) for prequantization.  It is about that if one finds such an \(\alpha\), then we have a Green's theorem-like formula.  It's central to the whole thesis of the paper, and it is indeed ensured by any prequantization (our definition).  A statement about existence of prequantization (having integral class 2-form) is only interesting if we talk about area forms of a general surface; for the sphere and specific bundles, the existence of \(\alpha\) is clear from each example. Note that \(\SO(3)\) is not tied with the classical formula.  
% The classical formula shows up whenever you take the lifted path as the tangent vector of the next edge.  It can even be on \(\SS^3\).  Conversely, when using \(\SO(3)\), we can also take horizontal lift or arbitrary lift and get numerically stable line integral.  So I think \(\SO(3)\) and classical formula are really two independent things.}

% \cAC{Can we just call the lift of \(p_0,\ldots, p_{m-1}\) something like \(q_0,\ldots q_{m-1}\) 
%  (Our \(\ell\) is not a smooth function over the sphere, which doesn't matter but we don't need to explain that if we just lift them discretely)?  And we just need to show the integral formula along a great circle segment (Lemma 3.3) and the rest is obvious from the previous section.  }
% \cSI{Yes, using \(q_0,\ldots q_{m-1}\) sounds good to me. And yes, in light of your writing, what we need is only Lemma 3.3 and Proposition 3.2 as Lemma 3.3 depends on it.}

\iffalse
In this section, we state and prove our main result.

\begin{theorem}[Area formula via the Hopf fibration]\label{th:area_formula}
Let \(\{p_i\}_{i=0}^{n-1}\) be a spherical polygon and \(\ell\colon \SS^2 \rightarrow \SS^3\) be an arbitrary lift with respect to the Hopf fibration \(\pi\). It holds that,
\begin{align}\label{eq:area_formula}
    \operatorname{Area}(\Gamma)
    =2\sum_{i=0} ^{n-1} \operatorname{arg}\left(\ell(p_{i+1})r_i \overline{\ell( p_i)}\right) 
\end{align}
where \(r_i\in \SS^3\) is the rotation quaternion i.e. \(p_{i+1}=  r_i p_i  \overline{r_i}\).
\end{theorem}
Note that \(\ell(p_{i+1})\) and \(\ell(p_{i})\overline{r_i}\) in the Equation \eqref{eq:area_formula} lie on the same fiber, so \(\ell(p_{i+1})= \ell(p_i ) \overline{r_i} s\) for some \(s\in \SS^1\) and \(\operatorname{arg}\left(\ell(p_{i+1})r_i \overline{\ell( p_i)}\right) \) makes sense. 

\paragraph{Idea of the proof}
\TODO{Write}
We pull back \(\sigma\) to \(\SS^3\) so that \(\pi^* \sigma\) is exact. We also make a choice of connection so that the horizontal lift with respect to the connection has a simple expression. We exploit this to obtain the formula in Theorem \ref{th:area_formula}.

\begin{lemma}  \label{lem:explicit_theta}
Let \(p, p' \in\SS^2\), \(r\in \SS^3\) be the rotation quaternion  between \(p\) and \(p'\) i.e. \(p'=rp\bar{r}\), and  \(\ell\colon \SS^2 \rightarrow \SS^3\) be any lift with respect to \(\pi\), and \(\gamma\) be the geodesic on \(\SS^2\) connecting \(p\) and \(p'\). 
It holds that 
\begin{align}
    \int_{\gamma} \ell^* \eta =  \operatorname{arg}\left(\overline{\ell(p)} r \ell(p')\right).
\end{align}
\begin{proof}
Let \(\{p_t\}_{\in[0,1]}\) be the constant speed parametrization of \(\gamma\).  \propref{prop:horitontal_lift} asserts that \(q:=\ell(p)\) and \(q \bar{r}\in \pi^{-1} p'\) are connected by the unique horizontal lift \(\tilde{\ell}\).
Let us consider a domain \(\Delta \subset \SS^3\) given by,
\begin{align}
    \Delta \colon=\left\{ e^{i\theta} \tilde{\ell}(p_t)  \in \SS^3 \big| t\in[0,1], \theta\in[0,\theta_t] \  \right\},
\end{align}
where \(\theta_t\) is the holonomy \(e^{i\theta_t} \tilde{\ell}(p_t) =\ell(p_t)\) for each \(t\). We first obtain that 
\begin{align}
    \int_{\partial\Delta} \eta 
    = \int_\Delta d\eta 
    = \int_{\Delta} \pi^*\sigma =0,
\end{align}
as \(\pi(\Delta)=\gamma\).

Note that the boundary \(\partial \Delta\) is a  closed path consisting of three segments 1. the lifted geodesic \(\ell(\gamma)\) from \(\ell(p)\) to \(\ell(p')\) 2. the vertical path from  \(\ell(p')\) to \(\tilde{\ell}(p')=\ell(p)r\) 3. the horizontal path from \(\tilde{\ell}(p')\) to \(\tilde{\ell}(p)=\ell(p)\). Since the integral of \(\eta\) along the third path makes no contribution, we have
\begin{align}
    \int_{\ell(\gamma)} \eta 
    = \int_{\left\{e^{i\theta} \tilde{\ell}(p')\right\}_{\theta\in[0,\theta_1]}}\eta
    =\operatorname{arg}\left(\overline{\ell(p)} r \ell(p')\right).
\end{align}

\end{proof}
\end{lemma}
Now Theorem \ref{th:area_formula} follows from a direct computation using the Stokes theorem.
\begin{proof}[Proof of Theorem \ref{th:area_formula}]
Let \(\gamma=\{p_i\}_i\) be the spherical polygon and \(\gamma_i\) be the geodesic from \(p_i\) to \(p_{i+1}\) for each \(i\).
It holds that,
\begin{align}
    \operatorname{Area}(\Gamma)
    &= \int_{\pi\circ \ell(\Gamma)} \sigma\\
    % &= \int_{\ell(\Gamma)}\pi^*\sigma\\
    &= \int _{\ell(\Gamma)}\ d\eta \\
    &= \int_{\ell(\gamma)} \eta\\
    &=\sum_i \int_{\ell(\gamma_i)} \eta\\
    &\cSI{Maybe insert a line of computation here}\\
    &=\sum_i \operatorname{arg}\left(\ell(p_{i+1})r_i \overline{\ell( p_i)}\right).
\end{align}
\end{proof}
\fi

\subsection{Derivation of the classical formula by \(\SO(3)\) as a prequantum bundle}\label{sec:derivation_classical_formula}
The Hopf fibration structure can also be seen in the group \(\SO(3)\) of 3D rotations. In fact, the classical formula \eqref{eq:GB_formula} can be interpreted as a special case of the lifted Green's theorem on \(\SO(3)\) using a specific lift not as numerically stable as \eqref{eq:ChoiceOfLift} or the horizontal lift (\autoref{cor:horizontal_lift_area_formula}).
% \cAC{Maybe we need an opening sentence that justify why we are talking about \(\SO(3)\) in Hopf fibration.  Maybe ``The Hopf fibration structure can also be seen in the group \(\SO(3)\) of 3D rotations. In fact, the classical formula \eqref{eq:GB_formula} can be interpreted as a special case of the lifted Green's theorem on \(\SO(3)\) using a specific lift not as numerically stable as \eqref{eq:ChoiceOfLift} or the horizontal lift (\autoref{cor:horizontal_lift_area_formula}).''}
% In this section, we recover the classical formula (\ref{eq:GB_formula}) by choosing \(\SO(3)\)  as the prequantum bundle over \(\SS^2\).
We see that \(\SO(3)\) as the unit tangent bundle 
% \cAC{I would even just say ``\(\SO(3)\) as the unit tangent bundle''} 
over \(\SS^2\) is also a prequantum bundle with a specific connection form. As \(\SS^3\) is a double cover of \(\SO(3)\), the Hopf fibration \(\pi:\SS^3\rightarrow \SS^2\) has a decomposition \(\pi=\pi_2 \circ \pi_1\) given by,
% \cAC{not ``such as.'' Maybe ``given by''}
\begin{align}
\pi_1\colon& \SS^3 \rightarrow \SO(3)\\
    &q \mapsto (q\ii\bar{q}, q\jj\bar{q}, q\kk\bar{q}), \nonumber 
\end{align}
and 
\begin{align}\label{eq:SO3map}
\pi_2\colon& \SO(3) \rightarrow \SS^2 \\
    &(p_1,p_2,p_3) \mapsto p_1,  \nonumber 
\end{align}
where each element of \(\SO(3)\) is represented by three column vectors. % \cAC{past tense is usually strange. Maybe ``where each element of \(\SO(3)\) is represented by three column vectors.''}.

The tangent space \(T_P \SO(3)\) at each \(P\in \SO(3)\) is \(dL_P \mathfrak {so}(3)=\left\{PW | W^T=-W\right\}\). We identify   each 
\(W = 
\begin{psmallmatrix}
0&-\omega_3&\omega_2\\
\omega_3&0&-\omega_1\\
-\omega_2&\omega_1&0
\end{psmallmatrix} \in  \mathfrak {so}(3)\)  with \(\omega=(\omega_1,\omega_2,\omega_3)\in \RR^3\).
% with respect to the standard basis of \(\mathfrak {so}(3)\).
%
We define an 1-form \(\eta\) by  
\begin{align}\label{eq:SO3_1Form}
    % \eta|_P(PW)\coloneqq\omega_1.
        \eta|_P(PW)\coloneqq -\omega_1.
\end{align}
% \cAC{Revised sign
% \begin{align}\label{eq:SO3_1Form}
%     \eta|_P(PW)\coloneqq -\omega_1.
% \end{align}
% }
Then \((\pi_2,\eta)\) is a principal circle bundle with \(\SS^1\) action \(\lhd\colon\SS^1\times \SO(3)\to \SO(3),\) by \(e^{\ii\theta})P = P
\begin{psmallmatrix}
    1&0&0\\
    0&\cos\theta&-\sin\theta\\
    0&\sin\theta&\cos\theta
\end{psmallmatrix}.
\)
% \( (\lhd e^{\ii\theta})(p_1, p_2, p_3) \coloneqq  (p_1, p'_2, p'_3 ) \) where \(p'_2:= e^{ \frac{- p_1 \theta}{2}}p_2 e^{ \frac{p_1 \theta} {2}}\) \cAC{Should the minus sign be on the right? In fact, more simply, \((\lhd e^{\ii\theta})P = P
% \begin{psmallmatrix}
%     1&0&0\\
%     0&\cos\theta&-\sin\theta\\
%     0&\sin\theta&\cos\theta
% \end{psmallmatrix}
% \) and it's clear that it is a right-action and gives a better \(\SO(3)\) vibe.} 
% and \(p'_3:=p_1 \times p'_2\), and \(\eta\) is a connection 1-form as it is equivariant under \(\SS^1\) actions: \((\lhd e^{\ii\theta})^*\eta = \eta\). 

\begin{proposition}\label{prop:SO3Prequantum}
        The 1-form \(\eta\in\Omega^1(\SO(3))\) defined in \eqref{eq:SO3_1Form} and the map \(\pi_2\colon \SO(3)\allowbreak\to\SS^2\) 
        % \cAC{superscript or subscript?} 
        defined in \eqref{eq:SO3map} satisfy \(d\eta = \pi_2^*\sigma\), where \(\sigma\in\Omega^2(\SS^2)\) is the standard area form on the unit sphere.  That is, \((\SO(3),\eta)\) is a prequantum bundle over \((\SS^2,\sigma)\). 
\end{proposition}
We give a proof in \autoref{appendix:proof_of_prequantum_bundles}.
% \cAC{Not a good sentence here (past tense? delayed?).  Maybe just ``The proof for \autoref{prop:SO3Prequantum} is given in \autoref{appendix:proof_of_prequantum_bundles}.''}
% 
% In this section, we recover the classical formula based on the Gauss-Bonnet formula via prequantum fibration. As the principal bundle, we choose \(SO(3)\), which is diffeomorphic to the circle bundle over \(\SS^2\). Note that \(\SS^3\) is a double cover of \(SO(3)\) and the Hopf fibration \(\pi:\SS^3\rightarrow \SS^2\) has decompositions \(\pi=\pi_2 \circ \pi_1\) such as 
% \begin{align}
% \pi_1\colon& \SS^3 \rightarrow SO(3)\\
%     &q \mapsto (q\ii\bar{q}, q\jj\bar{q}, q\kk\bar{q}),
% \end{align}
% and 
% \begin{align}
% \pi_2\colon& SO(3) \rightarrow \SS^2\\
%     &(p_1,p_2,p_3) \mapsto p_1.
% \end{align}
% 
% The tangent space \(T_Q SO(3)\) at each \(Q\) is \(dL_Q \mathfrak {so}(3)=\left\{QW | W^T=-W\right\}\). We identify   each \(W\in \mathfrak {so}(3)\) with the coefficients \(\omega=(\omega_1,\omega_2,\omega_3)\in \RR^3\) with respect to the standard basis, equivalently \(W=\omega \times \cdot\).
% 
% For each \(T_Q SO(3)\), we choose a connection 
% \begin{align}
%     H_Q=Q
%     \left(\begin{array}{ccc}
% 0 & -\omega_3 & \omega_2 \\
% \omega_3 & 0 & 0 \\
% -\omega_2 & 0 & 0
% \end{array}\right).
% \end{align}
% The corresponding connection 1-form \(\eta\) is 
% \begin{align}
%     \eta|_Q(QW)=\omega_1.
% \end{align}
% Intuitively \(\eta\) measures how much the infinitesimal action gives a rotation around the local \(x\)-axis. 
% 
% \cSI{The next paragraph is a direct proof of \(d\eta=\pi_1^* \sigma\). We can also prove from Lemma 4.1.}
% We get by a direct computation,
% \begin{align}
%     d\eta |_Q(QV,QW)=-\eta |_Q([QV,QW])=-\eta |_I ([V,W])=v_3 \omega_2 - \omega_2 v_3,
% \end{align}
% due to the left-invariance of the vector fields \(QV, QW\) under \(SO(3)\) where \([\cdot,\cdot]\) denotes the Lie bracket. 
% 
% Now we compute \(\pi_2 ^* \sigma\). Let us write \(W\in T_I SO(3)\) and \(Q\in SO(3)\) column-wise as \(W=(W_1 W_2 W_3)\) and \(Q=(p_1 p_2 p_3)\). For \(QW\in T_Q SO(3)\), we have
% \begin{align*}
%     \pi_1^* \sigma|_Q(QV,QW)
%     &=\sigma|_{p_1} (d\pi_1 (QV), d\pi_1 (QW))
%     =\sigma|_{p_1} (Q V_1, QW_1 )
%     = \sigma|_{\ii} (V_1, W_1)\\
%     &= dy \wedge dz (V_1, W_1)
%     = v_3 \omega_2 - \omega_2 v_3
% \end{align*}
% where we used the invariance of \(\sigma\) under \(SO(3)\) and the expression of \(\sigma\) using the Cartesian coordinates.
% 
To recover the classical formula via \(\pi_2\colon(\SO(3),\eta)\allowbreak\rightarrow(\SS^2, \sigma)\),
% \cAC{subscript}
we define a lift as follows. We take for each \(p_i\) the forward velocity from \(p_i\) to \(p_{i+1}\) on \(\SS^2\).  It is given at \(p_i\eqqcolon\gamma(t_i)\) by
\begin{align*}
    v(p_i)\coloneqq\lim_{h\to +0}\frac{\gamma(t_i+h)-\gamma(t_i)}{h}\in T_{p_i}\SS^2,
\end{align*}
which is a positive multiple of \(-p_i\times(p_i\times p_{i+1})\).
% \cAC{\(v(p_i)\) probably can be written in terms of the normalized \(p_i\times p_{i+1}\) without the limit.}\cSI{normalizing \(-(p_{i+1}\cdot p_i)p_i +p_{i+1}\) gives \(v(p_i)/|v(p_i)|\), but don't know if it's a better expression.}\cAC{We can add ``which is a positive multiple of \(-p_i\times(p_i\times p_{i+1})\)'' to give a sense of having algebraically concrete formula.  The formula with the limit is still good for intuition. }\cSI{good idea!}
Then
\begin{align*}
   \tilde{\gamma}(t_i)\coloneqq\left(p_i, \frac{v(p_i)}{|v(p_i)|}, p_i \times \frac{v(p_i)}{|v(p_i)|} \right)
\end{align*} 
defines a lift \( \tilde{\gamma} \colon \SS^1 \rightarrow \SO(3)\) of \(\gamma\). For \(\tilde{\gamma} \), we have 
\begin{align}\label{eq:classical_from_SO3}
    \int_{\tilde\gamma}\eta =-\sum_i \vartheta_i
\end{align}
with the exterior angles \(\vartheta_i\) given in \eqref{eq:exterior_angle1}.
% 
One has to be cautious when drawing conclusion from \eqref{eq:classical_from_SO3} about the area formula using \propref{prop:liftedGreenTheorem}.  In fact, \(\Area(\Gamma) = 2\pi + \int_{\tilde\gamma}\eta = 2\pi-\sum_i\vartheta_i\) noting the extra term of \(2\pi\) (\cf\@ \eqref{eq:GB_formula}).
This is because \(\tilde\gamma\) is a non-contractible loop in \(\SO(3)\) which is not the boundary of a disk.
To obtain the classical formula \eqref{eq:GB_formula}, lift \(\tilde\gamma\colon\SS^1\to\SO(3)\) to \(\hat\gamma\colon \SS^1\to\SS^3\) by the universal cover \(\pi_1\colon\SS^3\to\SO(3)\).  Note that \(\alpha = \pi_1^*\eta\), and that \(\hat\gamma(0)=\hat\gamma(2\pi)\) and \(\lim_{t\nearrow 2\pi}\hat\gamma(t)\) has an angle difference of \(\pi\) in the fiber \(\pi^{-1}(\gamma(0))\).  
% Therefore we have
% \begin{align}
%     \Area(\Gamma) = \int_{\hat\gamma}\alpha = 2\pi + \int_{\eta}\eta = 2\pi - \sum_i\theta_i.
% \end{align}
% \cSI{I added the following. How to get the classical formula from the Hopf fibration.}
% Using the lift \(\tilde{\gamma}\), we can obtain the classical formula also with the Hopf fibration \(\pi\colon (\SS^3, \alpha)\to (\SS,\sigma)\). The lift \(\tilde{\gamma}'\colon \SS^1 \to \SS^3 \)  is given, for each \(s_i\in \SS^1\) with \(p_i=\gamma(s_i)\), by choosing the point from \(\pi_1^{-1}\circ \tilde{\gamma}(s_i)\) closer to \(\tilde{\gamma}'(s_{i-1})\).\cAC{Can we call the curve on \(\SS^3\) something like \(\hat\gamma\)?  The primed notation \(\tilde\gamma'\) we be confused with the velocity map.  Also, here don't say ``choose a point closer to ...'' there is no more choices over here.  \(\pi_1\) is a covering space, (a bundle with each fiber being discrete) and \(\tilde\gamma\) is continuous.  So the lift is unique without any freedom of choice.}
% \cAC{Is it \(s_i\) or \(t_i\) for the nodes in the parameter space? Though it doesn't matter.}
% \cAC{Here is my revision for this paragraph:
% ``One has to be cautious when drawing conclusion from \eqref{eq:classical_from_SO3} about the area formula using [ref to our lifted Green formula theorem].  In fact, \(\Area(\Gamma) = 2\pi + \int_{\tilde\gamma}\eta = 2\pi-\sum_i\vartheta_i\) noting the extra term of \(2\pi\) (\cf\@ \eqref{eq:GB_formula}).
% This is because \(\tilde\gamma\) is a non-contractible loop in \(\SO(3)\) which is not the boundary of a disk.
% To obtain the classical formula \eqref{eq:GB_formula}, lift \(\tilde\gamma\colon\SS^1\to\SO(3)\) to \(\hat\gamma\colon \SS^1\to\SS^3\) by the universal cover \(\pi_1\colon\SS^3\to\SO(3)\).  Note that \(\alpha = \pi_1^*\eta\), and that \(\hat\gamma(0)=\hat\gamma(2\pi)\) and \(\lim_{t\nearrow 2\pi}\hat\gamma(t)\) has an angle difference of \(\pi\) in the fiber \(\pi^{-1}(\gamma(0))\).  Therefore we have
% \begin{align}
%     \Area(\Gamma) = \int_{\hat\gamma}\alpha = 2\pi + \int_{\eta}\eta = 2\pi - \sum_i\theta_i.
% \end{align}
% ''
% } Then we have
% \begin{align}\label{eq:classical_from_Hopf}
%      \int_{\tilde\gamma'}\alpha = 2\pi -\sum_i \vartheta_i.
% \end{align}

% \cSI{Now this lift is dependent on \(\tilde{\gamma}:\SS^1 \to \SO(3)\). If we can write \(\tilde{\gamma}'\) independent of  \(\tilde{\gamma}\), we can move this part after the corollary \corref{cor:horizontal_lift_area_formula}, independently of \(\SO(3)\) stuff. And we could move the entire \(\SO(3)\) stuff to the appendix.}
% \cAC{There are some missing \(2\pi\) (which cannot be omitted in our mod-\(4\pi\) arithmetics).  The situation is that \(\tilde\gamma\) using the tangent velocity is not continuously liftable to \(\SS^3\) by \(\pi_1^{-1}\).  That is equivalent to say that the tangent velocity along the loop cannot be extended into a unit vector field in the interior of the polygon without a singularity.  In fact, one could lift it as a discontinuous curve (though no topology textbook would back us up) and then we get a \(2\pi\) jump.  In short, \(\int_{\tilde\gamma} = -\sum_i\theta_i\) is still correct, but \(\int_{\tilde\gamma'}\alpha = 2\pi + \int_{\tilde\gamma}\eta = 2\pi-\sum_i\theta_i\).  \(\Area(\Gamma) = 2\pi - \sum_i\theta_i = 2\pi + \int_{\tilde\gamma}\eta\).  \(d\eta = \pi_2^*\sigma\), but \(\tilde\gamma\) is not the boundary of any disk.}
% \cSI{yes, this makes sense. is that where Poincare index comes in and that we can never have a smooth vector field over \(\SS^2\), in our case particularly, no smooth unit tangent vector field?}\cAC{Yes, this is the Poincare index.  In general, when there is a double cover, the liftability is about some \(\ZZ_2\)-coefficient index stuff, which is the spin theory.}\cAC{I don't know how much we need to dive in to it.  We can just stop at \(\int_{\tilde\gamma}\eta = -\sum_i\theta_i\) and say that agrees with eq 1.1, with a note that what is the additional \(2\pi\) doing there with a few handwavy words; and maybe we can say that to concretely obtain that \(2\pi\) index term, use \(\SS^3\) as the universal cover, and think of the \(2\pi\) jump when uniquely lifted to the covering space.  Maybe it is important to note that ``In fact, \(\pi_1^*\eta = \alpha\)'' somewhere.}\cSI{Great, thanks for the explanation, I'll find a way to write it down.}
% \cSI{I tried summarizing the arguments here.}
% \begin{remark}
%     The gap \(2\pi\) between \eqref{eq:classical_from_SO3} and \eqref{eq:classical_from_Hopf} is explained as follows.
%     There are at least two points where any smooth vector field on \(\SS^2\) vanishes. In particular, we cannot continuously extend the unit tangent velocity from the curve \(\gamma\) to its interior. In other words, \(H_1(\SO(3);\ZZ)=\ZZ_2\), and in particular, \(\tilde{\gamma}\) is not the boundary of a topological disc. By using \(\SS^3\) as a universal covering of \(\SO(3)\), we obtain the \(2\pi\) jump. In fact, \(\pi_1^*\eta=\alpha\).\cAC{I think my revision already covers what needs to be said.  So I think we can remove this remark.  The smooth vector field thing is not well-explained as it is not establish why any lifted path on \(\SO(3)\) is a vector field and why do we want to extend it.}
% \end{remark}

% \cAC{We can just state that \(\int_{\tilde\gamma}\eta = \) the minus exterior angle.}

% With these settings, we have
% \begin{align}\label{eq:GB_exterior_angle}
%     \operatorname{Area}(\Gamma)=\sum_i \psi_i,
% \end{align}
% \cAC{\(2\pi - \sum_i\psi_i\)?}\cAC{The extra \(2\pi\) term is a Poincar\'e index that arises since \(\tilde\gamma\) does not border a surface \(\widetilde S\) in the non-simply-connected \(\SO(3)\).}
% where each \(\psi_i\) is the exterior angle at  \(p_i\) given by 
% \begin{align}\label{eq:exterior_angle}
%     \psi_i= \operatorname{arg}\left( 
%     \frac{p_{i-1}\times p_{i}}{|p_{i-1}\times p_{i}|}\cdot\frac{p_i\times p_{i+1}}{|p_i\times p_{i+1}|}
%     + \ii \det\left( \frac{p_{i-1}\times p_{i}}{|p_{i-1}\times p_{i}|},\frac{p_i\times p_{i+1}}{|p_i\times p_{i+1}|},p_i\right) \right).
% \end{align}
% This formula is equivalent to (\ref{eq:GB_formula},\ref{eq:exterior_angle1}), which uses the interior angles instead.
% \cSI{We don't have proof of this, but is it really ok?}\cAC{I don't know eq 1.2 looks like an exterior angle to me.}

The classical formula has a variant that locates a pole \(Z\in\SS^2\) and sums up the signed area of triangles \((p_i,p_{i+1},Z)\). This formula is given as, 
\begin{align}\label{eq:gauss_bonnet}
    \operatorname{Area}(\Gamma) 
    =\sum_i \operatorname{sign}\left(\det(p_i,p_{i+1},Z)\right) \operatorname{UnsignedArea}(p_i,p_{i+1},Z),
\end{align}
where the unsigned area of each spherical triangle \((x_0,x_1,x_2)\) is computed as,
\begin{align}\label{eq:unsigned_triangle_area}
    \operatorname{UnsignedArea}(x_0,x_1,x_2)=-\pi + \sum_{i\in \ZZ_3} \arccos\left(\frac{x_{i-1}\times x_{i}}{|x_{i-1}\times x_{i}|}\cdot\frac{x_i\times x_{i+1}}{|x_i\times x_{i+1}|}\right).  
    %\  (x_3=x_0, x_{-1}=x_2).
    % \begin{aligned}
    % (& x_{-1}=x_2,\\ &x_3=x_0).
    % \end{aligned}
\end{align}
% \cSI{I removed \((x_{-1}=x_2, x_3=x_0)\) stuff here as it didn't beautifully fit here. Instead I changed \(\sum_{i=0}^2\) to \(\sum_{\ZZ_3}\).}
This formula can also be recovered by the Hopf fibration.
% the same prequantum bundle \(\pi^2\colon (SO(3),\eta)\rightarrow (\SS^2,\sigma)\). 
% 
By setting the lift 
\(q_i:=\Dihedral(Z,p_i)\) for each \(p_i\), we obtain \eqref{eq:gauss_bonnet}. Numerically, this formula is unstable if any of the vertices is close to \(Z\) or \(-Z\), which is explained by the numerical sensitivity of \(\Dihedral(Z,p_i)\) and
\(\frac{p_{i}\times Z}{\|p_{i}\times Z\|}\).

% \cSI{Maybe we can move this remark to the end of this paper as "Concluding remark" or "Perspective".}

% In this article, we showed that we can obtain a formula for the surface area of a spherical polygon using Green's theorem on a prequantum bundle over \(\SS^2\). By choosing \(\SS^3\) as the bundle, we obtain a formula that evaluates the holonomy between two points on each fiber over the polygon. By choosing \(SO(3)\), we recover the classical formula, which evaluates each interior angle of the polygon from three points.


\section{Numerical examples}
% \cAC{Numerical Examples or Numerical Demonstrations}
% \begin{itemize}
%     \item basic sanity checks. circle and eight-figure knot (normalized), both \(2\pi\). 
%     % \item stress test - many points on a curve. Make a plot with number of points and computed surface area.
%     \item Stress test with Cardioid (stereographic).
%     \item Total torsion by Gauss map. trefoil, eight-figure knot and partially straightened circle having multiple points on same locations.
% \end{itemize}

% \cSI{I think this section had more examples than we need.  I commented out some of them and kept only 1. the cardioid and the total torsion of 2. trefoil, 3. eight-figure knot and 4. partially straightened unknot. }
% \cSI{Also I'm now investigating the example of an infinitely spiral curve at the center. Let's use it if we could get something nice.}
% \cAC{I prefer curves where the total torsions are really hard or even impossible to compute. That's why I kept thinking partially straightened unknot, being a planar curve, is not a good example.  In a curve where in a segment the curve converges to a straightline while having its Frenet frame spins infinitely fast, the Frenet torsion might be a non-absolutely-converging series, whereas using parallel frame it stablizes quickly.  I think the trefoil or figure-eight knot are nice as some numbers agree but less important.}

% \cSI{Now I have the impression that "Numerical illustrations" section could go to the appendix because the results here are only supplemental as we don't really prove when and why our formula is better than the classical formula, and the plot of the comparison depends on the implementation of the formulae and  components like \(\operatorname{sign}\) and trigonometric functions. }
% \cAC{Don't be too allergic to numerical examples in a math paper.  I think the divergent plot is the most convincing result that shows why this paper is so significant.  Without any of the plots, then the paper is only about an alternative formula that is mathematically equivalent to Gauss--Bonnet.}
% \cAC{The numerical stability is clear from our argument of the remark.  The original Gauss--Bonnet has many ill-conditioned operator (division by zero).  As long as the plots are generally easy to reproduce, it is a legitimate scientific information.  Also, most of the readers in geographic-survey or rendering will probably skip all the math and just look at the numerical information to admit what they've been using is problematic.  As a math paper, all the theorems are proven; and in addition we have a section about comparison, it is a fair comparison of a specific choice of implementation of previous formula and the result is numerically computed by a computer. Examples show that the new formula produces more reliable numbers.  Besides, the pure math part of the paper is barely new.}

In this section, we present numerical examples of area computation for spherical polygons using our formula \eqref{eq:FinalAreaFormula}. 
Moreover, we demonstrate how this formula can also be utilized to determine the total torsion of a space curve, which differs from \(2\pi\) exactly by the enclosed area of the spherical curve traced out by the tangents of the curve.
By comparing the results obtained using both our formula and the classical formula \eqref{eq:GB_formula}, we show that our formula produces consistent and converging solutions, even for singular curves.
This improved numerical robustness allows for more accurate measurements of spherical areas and total torsion.

We employ the horizontal lift approach (\corref{cor:horizontal_lift_area_formula}) for computation in all of our examples.
For a given closed spherical curve \(\gamma\colon [0,2\pi)\rightarrow \SS^2\), 
we use a uniform division \(\{t_i\coloneqq {2\pi i\over n}\}_{i=0}^{n-1}\) of the interval \([0,2\pi)\) to specify the vertices \(\{\gamma(t_i)\}_{i=0}^{n-1}\) with some positive integer \(n\).  This process turns the spherical curve into a spherical polygon.

%by uniformly dividing \([0,2\pi)\) as \(t_0=0, t_1=2\pi/n,\ldots, t_{n-1} = 2(n-1)\pi/n\) with some positive integer \(n\).

% We first compute, as a sanity check, the signed areas of the unknot
% \begin{align}
%     \gamma(t)= \left(\cos(t),\sin(t),0\right),
% \end{align}
% and the figure-eight knot,
% \begin{align}
%     \gamma(t)= \left((2 + \cos(2t))\cos(3t),(2 + \cos(2t)) \sin(3t), \sin(4t)\right)
% \end{align}
% projected on the sphere by normalization \(\gamma(t)/|\gamma(t)|\), see \autoref{fig:figure-eight}.
% Computation using our formula gives \(2\pi\) for the unknot independent of the number of vertices. Computation for the figure-eight knot gives \(2\pi\) with the order of error \(10^{-7}\) with \(n=1000\).
% \cSI{Maybe we can just remove these sanity check examples.}

\subsection{Spherical cardioid}
\label{sec:SphericalCardioid}
% 
\begin{figure}[t]
 % [trim = {left, bottom, right, top}, clip]
 \begin{minipage}[t]{0.45\textwidth}
\includegraphics[width=\textwidth]{images/cardioid0015.png}
\end{minipage}
 \begin{minipage}[t]{0.45\textwidth}
\includegraphics[width=\textwidth,angle=0]{images/cardioid_stereo_new.png}
\end{minipage}
\caption{ Cardioid (left) stereographically projected on the sphere (right). }
\label{fig:cardioid}
\end{figure}
% 

We compute the area of a spherical curve \(\gamma\) given by the stereographic projection image \(\gamma = P\circ\gamma_{\RR^2}\) of a planar cardioid \(\gamma_{\RR^2}\) (\autoref{fig:cardioid}).  
Explicitly, the planar cardioid is parametrically  given by
\begin{align*}
    \gamma_{\RR^2}(t)=\left( 2(1-\cos(t))\cos(t), 2(1-\cos(t))\sin(t) \right),
\end{align*}
and the stereographic projection from the plane to the sphere is
\begin{align*}
    P\colon (x,y)\mapsto \frac{1}{x^2+y^2+1}(2x,2y,x^2+y^2-1).
\end{align*}
We compute the area with various numbers \(n\) of vertices using our formula and the classical formula (\ref{eq:GB_formula},\ref{eq:exterior_angle1}).
\autoref{fig:plot_cardioid_Frenet_spiral} (left) shows their numerical results.
Note that this spherical cardioid has a cusp, \ie\@ \(\partial_t\gamma\) changes sign, at \(t = 0\).
As the polygon refines (\(n\to\infty\)), the edge lengths adjacent to \(\gamma(t_0)\) decrease to zero superlinearly, and \(\frac{\gamma(t_{n-1})\times \gamma(t_{0})}{|\gamma(t_{n-1})\times \gamma(t_{0})|}\cdot\frac{\gamma(t_{0})\times \gamma(t_{1})}{|\gamma(t_{0})\times \gamma(t_{1})|}\rightarrow -1\).
These conditions make the classical formula numerically unstable as observed in \autoref{fig:plot_cardioid_Frenet_spiral}, left.  
In contrast, our formula is numerically stable despite the presence of the cusp.



% We compute the signed area with different numbers of vertices using our formula and the classical formula (\ref{eq:GB_formula},\ref{eq:exterior_angle1}). See (\autoref{fig:plot_cardioid_Frenet_spiral}, left).
% The cardioid has a cusp \ie the sign of \(\partial_t \gamma\) changes at \(t=0\), and 
% \(\frac{\gamma(t_{n-1})\times \gamma(t_{0})}{|\gamma(t_{n-1})\times \gamma(t_{0})|}\cdot\frac{\gamma(t_{0})\times \gamma(t_{1})}{|\gamma(t_{0})\times \gamma(t_{1})|}\rightarrow -1\) as \(n\rightarrow\infty\), which makes the numerical computation using the classical formula unstable.

\begin{figure}[htbp]
% \includegraphics{images/plot_cardiod_wide.pdf}
% \includegraphics{images/plot_non_Frenet_wide.pdf}
 \begin{minipage}[t]{0.495\textwidth}
\includegraphics
% [width=1.0\textwidth]
 [keepaspectratio, scale=1.0]
{images/plot_cardiod_small.pdf}
\end{minipage}
 \begin{minipage}[t]{0.495\textwidth}
\includegraphics
% [width=1.0\textwidth]
 [keepaspectratio, scale=1.0]
{images/plot_non_Frenet_small.pdf}
\end{minipage}
\caption{
Numerical values of the signed areas of spherical curves discretized into spherical polygons with increasing number of vertices, computed using the classical formula (Gauss--Bonnet) and our formula (Hopf).
Both formulae give consistent values when the number of vertices is small, but the classical formula becomes unstable as the number of vertices increases.
Left: The area enclosed by a spherical cardioid (Section~\ref{sec:SphericalCardioid}).
Right: The total torsion \((2\pi- \operatorname{Area}(\gamma'))\) of a non-Frenet space curve (Section~\ref{sec:NonFrenet}).
% \cSI{I will improve the plots so that they have titles and numbers are more readable.}
% \cSI{When writing, please assume that you have all the necessary data. If something is still needed, assume that you have it, and leave a comment. I'll prepare that data/images.}\cAC{ok.}
}
\label{fig:plot_cardioid_Frenet_spiral}
\end{figure}

\subsection{Total torsions of space curves}
\label{sec:TotalTorsion}
Our next examples are about total torsions of space curves. For a space curve \(\gamma\colon[0,2\pi)\to\RR^3\), the total torsion (equivalently, the total writhe up to a multiple of \(4\pi\)) can be evaluated as \(\operatorname{Torsion}(\gamma) = 2\pi - \Area(\gamma') \), where \(\Area(\gamma')\) is the signed area of the unit velocity map given by \(\gamma'=\partial_t\gamma/|\partial_t\gamma|\).
This notion of total torsion also works for a space polygon \(\{\gamma(t_i)\}_i\).  For a space polygon, the unit velocity \( \gamma'\) is given by the normalized edge vector
\begin{align*}
    \gamma'(t_i)=\frac{\gamma(t_{i+1})-\gamma(t_i)}{|\gamma(t_{i+1})-\gamma(t_i)|},
\end{align*}
which forms a spherical polygon, whose signed area can be evaluated by our formula.  
We compute the total torsions of the figure-eight knot (\autoref{fig:figure-eight})
\begin{align*}
    \gamma(t)= \left((2 + \cos(2t))\cos(3t),(2 + \cos(2t)) \sin(3t), \sin(4t)\right),
\end{align*}
and the trefoil knot (\autoref{fig:trefoil}),
\begin{align*}
\gamma(t)=\left(  \sin(t) + 2 \sin(2t),\cos(t)-2\cos(2t), -\sin(3t)\right).
\end{align*}
With sufficiently many vertices, our results converge to numbers that agree with the results in a previous study \cite{najdanovic2021total}: \(-0.5423\) of the figure-eight knot and \(2.2250\) of the trefoil.
% \cAC{Check whether we have incorporated subtracting \(2\pi\).}\cSI{Checked it and fixed the sign of the figure-knot.}
\begin{figure}
 % [trim = {left, bottom, right, top}, clip]
 \begin{minipage}[t]{0.45\textwidth}
\includegraphics[width=\textwidth]{images/eight0015.png}
\end{minipage}
 \begin{minipage}[t]{0.45\textwidth}
\includegraphics[width=\textwidth,angle=0]{images/eight_Gauss_new.png}
\end{minipage}
\caption{ Figure-eight knot (left) and its unit velocity map (right). }
\label{fig:figure-eight}
\end{figure}

\begin{figure}
 % [trim = {left, bottom, right, top}, clip]
 \begin{minipage}[t]{0.45\textwidth}
\includegraphics[width=\textwidth]{images/trefoil0015.png}
\end{minipage}
 \begin{minipage}[t]{0.45\textwidth}
\includegraphics[width=\textwidth,angle=0]{images/trefoil_Gauss_new.png}
\end{minipage}
\caption{Trefoil (left) and its unit velocity map (right). }
\label{fig:trefoil}
\end{figure}

% We finally compute the total torsion of a partially straightened unknot, set as \(\gamma(t)=(\cos(t), \gamma_y(t),0)\) with
% \begin{align}
% \gamma_y(t) :=
% \begin{cases}
%   -c  & \text{ if } \sin(t) < -c\\
%   \sin(t)  & \text{ if } |\sin(t)| \leq c\\
%   c  & \text{ if } \sin(t) > c,
% \end{cases}
% \end{align}
% with \(c=1/2\), as in \autoref{fig:flat_unknot}. In this examples, all the vertices \(\gamma'(t_i)\) with \(\sin(t_i) < -c-\varepsilon\) are located at \((-1,0,0)\) and the vertices \(\sin(t_i) > c+\varepsilon\)  are located at \((1,0,0)\) with some small \(\varepsilon>0\). In this case, the classical formula is not applicable, but our formula is able to compute the signed area \(2\pi\).
% \begin{figure}[h]
%  % [trim = {left, bottom, right, top}, clip]
%  \begin{minipage}[t]{0.45\textwidth}
% \includegraphics[width=\textwidth]{images/unknot_straightened_flat0015.png}
% \end{minipage}
%  \begin{minipage}[t]{0.45\textwidth}
% \includegraphics[width=\textwidth,angle=0]{images/unknot_normal_new.png}
% \end{minipage}
% \caption{Partially  straightened unknot \(\gamma\) (left), and its velocity map \(\gamma'\) (right). }
% \label{fig:flat_unknot}
% \end{figure}

\subsection{Total torsion of a non-Frenet curve}
\label{sec:NonFrenet}
In this example we compute the total torsion of a smooth space curve with a singular (infinitely oscillatory) Frenet--Serret frame.  Such a regular curve without a regular Frenet--Serret frame is called a non-Frenet curve.  Consider the space curve
\begin{align*}
    \gamma(t')=\frac{1}{e^{-2 t'^2}+t'^2}\left(e^{-t'^2} \cos \left(e^{t'}\right), e^{-t'^2} \sin \left(e^{t'}\right), t'\right), 
\end{align*}
where \(t'\in [-\infty,\infty)\) is a reparametrization of \(t\in [0,2\pi)\) by \(t'=\tan\left( \frac{t-\pi}{2}\right)\).
% where \(t\) is reparametrized as \([0,2\pi)\to [-\infty,\infty)\).  
% \( \left(\frac{\partial_s \gamma}{|\partial_s \gamma|}, \frac{\partial_{ss} \gamma}{|\partial_{ss} \gamma|}, \frac{\partial_s \gamma}{|\partial_s \gamma|} \times \frac{\partial_{ss} \gamma }{|\partial_{ss} \gamma|} \right)  \) 
% where \(s\) is an arc length parameter of \(\gamma\).
The spherical curve \(\gamma'\) traced out by the unit velocity displays an exponential spiral about \(t=\pi\) with an infinite turning number (See \autoref{fig:spiral_frenet}) and an unbounded geodesic curvature (which is the Frenet torsion of the original space curve).
Note that despite the spiral, the signed area enclosed by \(\gamma'\) is bounded, giving rise to a well-defined total torsion.

The classical Gauss--Bonnet formula (\ref{eq:GB_formula},\ref{eq:exterior_angle1}) is unusable for evaluating this spherical area.  Evaluating the classical formula is equivalent to sampling and summing the Frenet torsion (exterior angle of the spherical polygon). The process produces a result that diverges as \(n\to \infty\) (\autoref{fig:plot_cardioid_Frenet_spiral}, right).  In contrast, our formula \eqref{eq:FinalAreaFormula} is able to robustly evaluate the total torsion of this non-Frenet curve.  


% 

\begin{figure}[htbp]
 % [trim = {left, bottom, right, top}, clip]
 \begin{minipage}[t]{0.32\textwidth}
\includegraphics[width=\textwidth]{images/inf_spiral_raw.png}
\end{minipage}
 \begin{minipage}[t]{0.32\textwidth}
\includegraphics[width=\textwidth,angle=0]{images/infinite_spiral_Gauss.png}
\end{minipage}
 \begin{minipage}[t]{0.32\textwidth}
\includegraphics[width=\textwidth,angle=0]{images/inf_spiral_zoom_0002.png}
\end{minipage}
\caption{ A curve with a spiral Frenet-Serre frame (left), its unit velocity map (middle), and the close-up of the spiral (right).}
\label{fig:spiral_frenet}
\end{figure}


% \begin{figure}[htbp]
% \includegraphics[height=0.3\textheight]{images/plot_infinite_spiral.png}
% %  % [trim = {left, bottom, right, top}, clip]
% %  \begin{minipage}[t]{0.45\textwidth}
% % \includegraphics[width=\textwidth]{images/plot_cardioid_small_n.png}
% % \end{minipage}
% %  \begin{minipage}[t]{0.45\textwidth}
% % \includegraphics[width=\textwidth,angle=0]{images/plot_cardioid_large_n.png}
% % \end{minipage}
% \caption{Numerical computation of the total torsion of the spiral curve on the sphere with different numbers of vertices. In the plots, ``Gauss-Bonnet'' denotes the classical formula and ``Hopf'' denotes ours. Both formulae give almost the same values when the number of vertices is small, but the classical formula becomes unstable as vertices increase.
% }
% \label{fig:plot_infinite_spiral}
% \end{figure}


% We finally compute the total torsion of a knot in a spiral shape, given as 
% \begin{align}
% \gamma(t) :=
% \begin{cases}
%   \left(t\cos(6t),t\sin(6t),t\right),  &\quad t\in\left[0,\frac{2}{3}\pi\right],\\
%  \left(\left(\frac{4\pi}{3}-t\right)\cos(6t),\left(\frac{4\pi}{3}-t\right)\sin(6t),t\right),   &\quad t\in\left[\frac{2}{3}\pi,\frac{4}{3}\pi\right],\\
%   \left(0,0, 4\pi-2t \right)  &\quad t\in\left[\frac{4}{3}\pi,2\pi\right],
% \end{cases}
% \end{align}
% see \autoref{fig:spiral}. 

% In this examples, all the vertices \(\bar{\gamma}(t_i)\) with \(t_i\in\left[\frac{4}{3}\pi+\varepsilon,2\pi-\varepsilon\right]\)  with some small \(\varepsilon>0\) are located at \((0,0,-1)\). In this case, the classical formula is not applicable, but our formula is able to compute the signed area \(2.0871\).

% \begin{figure}[h]
%  % [trim = {left, bottom, right, top}, clip]
%  \begin{minipage}[t]{0.45\textwidth}
% \includegraphics[width=\textwidth]{images/spiral_raw.png}
% \end{minipage}
%  \begin{minipage}[t]{0.45\textwidth}
% \includegraphics[width=\textwidth,angle=0]{images/spiral_Gauss.png}
% \end{minipage}
% \caption{A spiral-shaped knot \(\gamma\) (left), and \(\bar{\gamma}\) (right). }
% \label{fig:spiral}
% \end{figure}

% \cSI{I moved this remark as a "Perspective" to the end of the paper.}\cAC{I would call it ``Outlook''}\cSI{nice!}
\section*{Outlook}
In this paper, we derived area formulae using Green's theorem on prequantum bundles \(\SS^3\) and \(\SO(3)\) over \(\SS^2\). 
As this version of Green's theorem is available for any compact symplectic manifold, one may investigate area formulae or integral of symplectic form of polygons in other manifolds. For example, in quantum information, \(\CC\PP^{2^n-1}\)
% \cAC{Do you mean \(2^n-1\)?}\cSI{yes, thanks for the catch. } 
is regarded as the possible states of \(n\)-qubits \cite{bengtsson_zyczkowski_2006} and a closed path is a periodic orbit. We hope that finding an explicit expression of its surface area may lead to practical applications in quantum computation.

\subsection*{Acknowledgement}
The authors acknowledge Chris Wojtan for his continuous support to the present work through discussions and advice. The second author thanks Anna Sisak for a fruitful discussion on prequantum bundles. This project was funded in part by the European Research Council (ERC Consolidator Grant 101045083 \emph{CoDiNA}).

\appendix

\section{Prequantum bundles \(\SS^3\) and \(\SO(3)\) over \(\SS^2\) }\label{appendix:proof_of_prequantum_bundles}


\begin{proof}[Proof of  \propref{prop:HopfPrequantum}]
% Using the \(\RR^3\) inner product \(\langle\cdot,\cdot\rangle_{\RR^3}\) and cross product \(\times\), the spherical area form evaluated with two tangent vectors \(\dot s,\mathring s\in T_p\SS^2\) at \(s\in \SS^2\) is given by \(\sigma_s\llbracket\dot s,\mathring s\rrbracket = \langle s,\dot s\times \mathring s\rangle_{\RR^3}\).  
In terms of the quaternion coordinate, this dot-cross formula becomes
\begin{align*}
    \sigma = -{1\over 2}\Re( p\Im(dp\wedge dp)).
\end{align*}
On the other hand,
    the differential of \(\pi = q\ii\conj q\) is
    \(d\pi = dq\ii\conj q + q\ii d\conj q\).
    %\(d\pi_q\llbracket\mathring q\rrbracket = \mathring q\ii\conj q + q\ii\mathring{\conj q} = 2\Im(\mathring q\ii\conj q)\).
    Hence, the pullback area form
    \begin{align*}
        \pi^*\sigma &= -{1\over 2}\Re(\pi\Im(d\pi\wedge d\pi))
        = -{1\over 2}\Re(q\ii\conj q\Im(d\pi\wedge d\pi)) \\
        &= -{1\over 2}\Re(\ii\conj q\Im(d\pi\wedge d\pi)q) = -{1\over 2}\Re(\ii \Im(\conj qd\pi\wedge d\pi q))
        \\
        &=-{1\over 2}\Re\left(
        \ii\Im((\conj qdq\ii\conj q+\ii d\conj q)\wedge (dq\ii + q\ii d\conj qq))
        \right)\\
        % &=-{1\over 2}\Re(\ii\conj q dq\ii\wedge\conj qdq\ii -\ii dq\wedge d\conj q + \ii d\conj q \wedge dq -d\conj q q\ii\wedge d\conj q q)\\
        & =-{1\over 2}\Re(\ii\conj q dq\ii\wedge\conj qdq\ii +\ii dq\wedge d\conj q - \ii d\conj q \wedge dq -d\conj q q\ii\wedge d\conj q q),
    \end{align*}
    % \cAC{the last line should be \(-{1\over 2}\Re(\ii\conj q dq\ii\wedge\conj q dq\ii - \ii \conj q dq\wedge d\conj q q - d\conj q\wedge dq \ii - d\conj q q\ii\wedge d\conj q q) \)
    % which simplies to 
    % \(
    % {1\over 2}\Re(\conj qdq\ii\wedge\conj q dq + \ii\conj q dq\wedge d\conj q q + \ii d\conj q\wedge dq + d\conj q q\ii\wedge d\conj q q)
    % \).  Then, using \(d\conj qq = -\conj q dq\), etc., we get \({1\over 2}\Re(-dq\ii\wedge d\conj q + \ii d\conj q\wedge d q + \ii d\conj q\wedge dq - dq\wedge\ii d\conj q)\)
    % }\cSI{Thanks a lot for the detailed computation. I think the 2nd and 3rd terms in the last line of the text  \(-\ii dq\wedge d\conj q + \ii d\conj q \wedge dq\) as well as in the last line of your comment have flipped signs. So you end up with  \(-\Re( dq\wedge\ii d\conj q)\), which is not \(d\alpha\).So I fixed it.  For computation, I used \(\Im(\ii d \conj{q}\wedge dq \ii)=dq\wedge d\conj{q}\).
    % Regarding the detailed computation in your comment, it was so helpful for me to follow the computation. But I think we could keep this detailed computation  for our internal use and leave the rest computation as sort of an exercise for readers.
    % }
    which agrees with
    \begin{align*}
        % d\alpha = -2\Re(\ii d\conj q\wedge dq) = 2\Re(\ii dq\wedge d\conj q) = 2\Re(dq\wedge \ii d\conj q).
        d\alpha =
        % 2\Re(\ii d\conj q\wedge dq) = -2\Re(\ii dq\wedge d\conj q) =
        -2\Re(dq\wedge \ii d\conj q).
    \end{align*}
    % \cSI{I commented out two equalities in the computation of \(d\alpha\) as it is direct from the definition of \(\alpha=-2\Re(q \ii d \conj{q})\).}
    % \cAC{\(d\alpha = 2\Re(\ii d\conj q\wedge dq) = -2\Re(\ii dq\wedge d\conj q) = -2\Re(dq\wedge \ii d\conj q)\) using the \(\alpha\) with fixed minus sign.}
    Here, we have applied   \(d\conj q q = d|q|^2-\conj qdq = -\conj qdq\), which holds on \(\SS^3\) where \(|q|^2 = 1\).
    
\end{proof}

 \begin{proof}[Proof of  \propref{prop:SO3Prequantum}]
Let \(V,W \in \mathfrak{so}(3)\), and \(\omega=(\omega_1,\omega_2,\omega_3)\), \(\nu=(\nu_1,\nu_2,\nu_3)\) be their coefficients with respect to the standard basis of \(\mathfrak{so}(3)\) as in \secref{sec:derivation_classical_formula}. For \(PV, PW \in T_P \SO(3)\) on each \(P\in \SO(3)\), we have,
\begin{align*}
    d\eta |_P(PV,PW)=-\eta |_P([PV,PW])=-\eta |_I ([V,W])=\nu_2 \omega_3 - \omega_2 \nu_3,
\end{align*}
% \cAC{New definition of \(\eta\) has an extra minus sign \(\eta(\omega) = -\omega_1\).}
due to the left-invariance of the vector fields \(PV, PW\) under \(\SO(3)\). Here \([\cdot,\cdot]\) denotes the Lie bracket.  Now we compute \(\pi_2 ^* \sigma\). Let us write \(W, V\) and \(Q\) column-wise as \(W=(w_1 w_2 w_3), V=(v_1 v_2 v_3)\), and \(P=(p_1 p_2 p_3)\). We have,
\begin{align*}
    \pi_2^* \sigma|_P(PV,PW)
    &=\sigma|_{p_1} (d\pi_2 (PV), d\pi_2 (PW))
    =\sigma|_{p_1} (P v_1, Pw_1 )\\
    &= \sigma|_{\ii} (v_1, w_1)
    = dy \wedge dz (v_1, w_1)
    = \nu_2\omega_3 -  \omega_2 \nu_3 ,
\end{align*}
where we used the invariance of \(\sigma\) under \(\SO(3)\) and the expression of \(\sigma\) using the Cartesian coordinates. 
% \cAC{In the last step, \(dy\wedge dz(v_1,w_1) = dy\wedge dz\left(\begin{psmallmatrix}
%     0\\ \nu_3\\ -\nu_2 
% \end{psmallmatrix},
% \begin{psmallmatrix}
%     0\\ \omega_3\\ -\omega_2
% \end{psmallmatrix}
% \right) = -\nu_3\omega_2 + \omega_2\nu_3\)}
    \end{proof}
    % \cSI{I have commented out here another proof by Albert. Please use it instead, if you think it makes more sense.}
    

% \cSI{The following is another proof of \(d\eta=\pi_1^*\sigma\).}
% \begin{lemma}
%     Let \(\pi_2\colon \SS^3\to\SO(3)\) be \(\pi_2(q)\llbracket\vec v\rrbracket = (q\vec v\conj{q})\).  Now take variation in \(q\) (by plugging in \(q+\epsilon \mathring q\) and take derivative with respect to \(\epsilon\) at \(\epsilon = 0\)): 
%     \begin{align}
%         {\delta \pi_2(q)\llbracket\vec v\rrbracket\over \delta q}\llbracket \mathring q\rrbracket = \mathring q\vec v\conj{q} + q\vec v\mathring{\conj q}
%     \end{align}
%     That is, \(\pi_2(q)^{-1}(d\pi_2|_q\llbracket \mathring q\rrbracket) \in {\frak s\frak o}(3)\) is given by
%     \begin{align}
%         \pi_2(q)^{-1}(d\pi_2|_q\llbracket \mathring q\rrbracket)\vec v = \conj{q}\mathring q \vec v + \vec v\mathring{\conj{q}} q = 2\Im(\conj{q}\mathring q\vec v) = 2(\conj q\mathring q)\times \vec v,
%     \end{align}
%     that is,
%     \begin{align}
%         \pi_2^{-1}d\pi_2 = 2[\conj q\mathring q \times{}]
%     \end{align}
%     We want to show that 
%     \begin{align}
%         \eta^{\SS^3}_q\llbracket\mathring q\rrbracket = \eta_q^{\SO(3)}\llbracket d\pi_2|_q\llbracket\mathring q\rrbracket \rrbracket
%     \end{align}
%     Write \(\mathring q = q(a \ii + b \jj + c\kk)\).  Then \(\pi_2^{-1}d\pi_2(\mathring q) = 2[(a,b,c)\times{}]\). 
% \end{lemma}

% From Lemma 4.1 it follows that 
% \begin{align*}
%     \pi_2^* d \eta ^{SO(3)}= d\eta^{\SS^3}=\pi_2^*(\pi_1^* \sigma).
% \end{align*}
% Hence, \(d\eta^{\SS^3}=\pi_1^* \sigma \) mod \(\operatorname{ker}\pi_2^*\), which concludes the proof as \(SO(3)\) and \(\SS^3\) have the same Lie algebra.


% \begin{figure}[h]
%  % [trim = {left, bottom, right, top}, clip]
% \includegraphics[width=8cm]{images/eight_Gauss_new.png}
% \caption{Stereographically projection of figure-eight knot on the sphere (right). }
% \label{fig:knot}
% \end{figure}

% \input{example}

% \bibliographystyle{amsplain}
\bibliographystyle{amsalpha}
\bibliography{reference}

% \begin{thebibliography}{10}

% \bibitem {A} T. Aoki, \textit{Calcul exponentiel des op\'erateurs
% microdifferentiels d'ordre infini.} I, Ann. Inst. Fourier (Grenoble)
% \textbf{33} (1983), 227--250.

% \bibitem {B} R. Brown, \textit{On a conjecture of Dirichlet},
% Amer. Math. Soc., Providence, RI, 1993.

% \bibitem {D} R. A. DeVore, \textit{Approximation of functions},
% Proc. Sympos. Appl. Math., vol. 36,
% Amer. Math. Soc., Providence, RI, 1986, pp. 34--56.

% \end{thebibliography}

\end{document}

%------------------------------------------------------------------------------
% End of journal.tex
%------------------------------------------------------------------------------

% SIAM Article Template
% \documentclass[review,onefignum,onetabnum]
\documentclass[onefignum,onetabnum]
{siamonline220329}

\newif \iffinalversion
\finalversiontrue

% Information that is shared between the article and the supplement
% (title and author information, macros, packages, etc.) goesl into
% ex_shared.tex. If there is no supplement, this file can be included
% directly.

\input{ex_shared}

% Optional PDF information
\ifpdf
\hypersetup{
  pdftitle={Area formula for spherical polygons via prequantization},
  pdfauthor={Albert Chern and Sadashige Ishida}
}
\fi

% The next statement enables references to information in the
% supplement. See the xr-hyperref package for details.

% \externaldocument[][nocite]{ex_supplement}

% FundRef data to be entered by SIAM
%<funding-group specific-use="FundRef">
%<award-group>
%<funding-source>
%<named-content content-type="funder-name"> 
%</named-content> 
%<named-content content-type="funder-identifier"> 
%</named-content>
%</funding-source>
%<award-id> </award-id>
%</award-group>
%</funding-group>

\input{macro}

\begin{document}

\maketitle

% REQUIRED
\begin{abstract}
    We present a formula for the signed area of a spherical polygon via prequantization.  In contrast to the traditional formula based on the Gauss--Bonnet theorem that requires measuring angles, the new formula mimics  Green's theorem and is applicable to a wider range of degenerate spherical curves and polygons.
\end{abstract}

% REQUIRED
\begin{keywords}
Spherical polygon, prequantization
\end{keywords}

% REQUIRED
\begin{MSCcodes}
51M25, 53D50, 26B15
\end{MSCcodes}


\section{Introduction}
\label{sec:Introduction}
A spherical polygon is a finite number of ordered points on \(\SS^2\) connected by geodesics. Computing the solid angle of the region enclosed by a spherical polygon is important in many subjects\sttext{  like fluid dynamics\mbox{\cite{iwc2022implicit_filaments}}, electromagnetism \mbox{\cite{Binysh_2018}}, geology \mbox{\cite{Bevis1987ComputingTA}}, and light transport simulation \mbox{\cite{Ramamoorthi2022}}}\rev{, which we briefly summarize at the end of this section}.

For a given polygon \(\Gamma=(p_0, \ldots,p_{n-1})\), its surface area is often computed using the formula 
\begin{align}\label{eq:GB_formula}
\operatorname{Area}(\Gamma)=2\pi - \sum_i \vartheta_i, 
\end{align}
derived from the Gauss--Bonnet theorem.
This area formula involves the evaluation of the exterior angle \(\vartheta_i\) at each vertex 
\begin{align}\label{eq:exterior_angle1}
    \vartheta_i=\operatorname{sign}\left(\det (p_{i-1},p_i,p_{i+1}) \right)\arccos\left(\frac{p_{i-1}\times p_{i}}{\abs{p_{i-1}\times p_{i}}}\cdot\frac{p_i\times p_{i+1}}{|p_i\times p_{i+1}|}\right),\  
\end{align}
which is a function of three points.
However, this formula requires non-degeneracy assumptions about these points that render it unavailable or numerically unstable in certain situations. 
For example, two consecutive points of the polygon cannot lie on the same location as the exterior angle is undefined. 
We may consider removing such points from the polygon, but judging precisely whether two points are at the same location or just nearby locations is not always possible in numerical computation, especially when the points are obtained after some computational operations. 

On the other hand, an area formula for polygons in \(\RR^2\) does not have such limitations. 
% \cAC{``limitations''?}.
For a polygon \(\Gamma_{\RR^2}=\left((x_0,y_0).\ldots,(x_{n-1},y_{n-1})\right)\), the area is 
% it is given by, \cAC{I'd remove ``it is given by,''}
\begin{equation}\label{eq:planerAreaFormula}
% Sometimes the displaywidth is still the full width of the text
    % without seeing the wrapfigure.  This line fixes it.
 % \displaywidth=\parshapelength\numexpr\prevgraf+2\relax
    %
    \operatorname{Area}(\Gamma_{\RR^2})=\sum_i \frac{1}{2}(x_{i+1}y_i-x_i y_{i+1}).
    % , \, (x_n=x_0, y_n=y_0).
\end{equation}
\begin{wrapfigure}[12]{r}{120pt}
\centering
\includegraphics[width=120pt]{images/Planimeter.png}
\caption{A planimeter measures the area of a planar region by tracing and accumulating quantities along its perimeter.}
\label{fig:Planimeter}
\end{wrapfigure}
% 
Unlike the classical formula for spherical polygons (\ref{eq:GB_formula}, \ref{eq:exterior_angle1}),
this planar area formula involves adding numerically stable edge quantities.
This formula can be derived by converting the area integral over the region into a line integral along the polygon curve using Green's formula. 
This is the same technique that enables 
\emph{planimeters} (\autoref{fig:Planimeter}).
The key that allows Green's formula is that the area form of \(\RR^2\) is an exact differential form.
Unfortunately, this strategy does not work directly for spherical polygons as the area form of \(\SS^2\) is not exact.

We circumvent this issue in this work \rev{  via so-called \emph{prequantization}, which is a preliminary setup to transform a classical mechanical system into a quantum mechanical system \mbox{\cite{bates_Weinstein1997lectures}}}. 
We lift the area form of the sphere onto a space where the resulting 2-form is exact. More precisely, we utilize a prequantum bundle, 
which is a principal circle bundle where the lifted 2-form is exact.
This gives rise to a version of Green's theorem that translates the area integral on the base manifold into a line integral along a lifted perimeter in the bundle.

By choosing a specific prequantum bundle over \(\SS^2\), we can obtain an explicit expression of the line integral. We use  the Hopf fibration \(\pi\colon \SS^3 \to \SS^2\) with a specific connection 1-form and derive a formula for the  area of a spherical polygon. 
Unlike the classical formula \eqref{eq:GB_formula}, the new formula does not involve numerically unstable evaluation of angles of three consecutive vertices.  Instead, it only involves a sum of edge-wise measurement resembling \eqref{eq:planerAreaFormula}.  
We also recover the classical formula \eqref{eq:GB_formula} by choosing \(\SO(3)\) as the prequantum bundle with a specific lift of the polygon.
Finally, we present numerical examples comparing our formula and the classical formula. 

% \rev{In summary, we somewhat \emph{quantize} the classical formula. Loosely speaking, prequantization of mechanics is a procedure to attach an additional degree of freedom called \emph{the phase} to each state of a classical system. Each classical state we can observe may be seen as the shadow of states in a higher dimensional space where actual physics is taking place like a real-valued function $f\geq 0$ may be seen as the intensity (the squared magnitude) of a complex-valued function $\sqrt{f} e^{i\theta}$ subject to a given time-evolution e.g. the Schr\"odinger equation. Indeed our resulting formula has a phase ($\SS^1$-degree of freedom) for each point on $\SS^2$.}\cSI{If this paragraph is distracting, we can shorten or move elsewhere. But I think it is important to communicate with the readers the feel of what "prequantization" is like and how it works as it is in the title.}
% \cAC{I find the wording might add more confusion at this stage.  If it's really needed to comment on its relation to quantum mechanics, make a paragraph with title ``Relation to quantum mechanics'' and simply note that ``Our formula for the spherical area is similar to evaluating the \emph{Berry phase} for a quantum mechanical system.  In this analogy, the points on \(\SS^3\) represents the quantum states of a spinor (or 2 qubits), while their projections on \(\SS^2\) are their classical representations on the \emph{Bloch sphere}.''}
% \cSI{Sounds good! I commented out the original text and added your suggested paragraph. If we find a better place in the article, we can migrate this.}
\paragraph{Relation to quantum mechanics}
\rev{Our formula for the spherical area via prequantization is similar to evaluating the \emph{Berry phase} for a quantum mechanical system.  In this analogy, the points on \(\SS^3\) (or any prequantum circle bundle) represent the possible quantum states of a spinor (or 2 qubits), while their projections on \(\SS^2\) are their classical representations on the \emph{Bloch sphere} \mbox{\cite{bengtsson_zyczkowski_2006}}. }

\paragraph{Applications and computations of solid angles}
% \cAC{Simplify the paragraph title to ``Applications and computations of spherical area.''}
% \cSI{Within "rev" command, cite articles with "mbox" command. Otherwise we get a compilation error...}
\rev{
%The solid angles of spherical curves are important in several fields and have practical applications. Here we outline a few examples.
Computing the area, or solid angle, of a spherical region occurs in multiple disciplines.
They are either analytically computed by the angle-based formula (\ref{eq:GB_formula}, \ref{eq:exterior_angle1}) \cite{Bevis1987ComputingTA}, or approximated by 
point counting \cite{feng2006area,Gonzalez2010Fibonacci} and Monte-Carlo methods  \mbox{\cite{Arvo1995stochasticSampling}}.
%A direct application of solid angle is the measurement of the areas in geography and geography \cite{Bevis1987ComputingTA}.
%While the earth is not perfectly the sphere, the solid angle gives a reasonable approximation to the area of a region.
A standard routine in geological survey is to find the area of an irregularly shaped region on the nearly-spherical earth   \cite{Bevis1987ComputingTA,Gonzalez2010Fibonacci}.
In quantum mechanics, the solid angle of a spherical curve generated by a Brownian motion of a particle describes the phase of two-state quantum systems undergoing random evolution \cite{shapere1989geometric,Krishna_2000}. The so-called Majorana representation of polarized light also involves the solid angle of certain spherical quadrilaterals \cite{Hannay1998Majorana}.}

\rev{Solid angles give rise to another geometric concept, \emph{the solid angle field of a space curve}.  Given a space curve in \(\RR^3\), the solid angle field is an $\SS^1$-valued function over $\RR^3$ whose value at each point $\bx\in\RR^3$ is half of the solid angle subtended by the closed curve at \(\bx\).
In contact geometry, a so-called \emph{open-book decomposition} can be constructed by the solid angle field, with the level sets of the \(\SS^1\)-valued solid angle field being the \emph{pages} and the space curve being the \emph{binder} \mbox{\cite{Geiges_2008contact}}.
Each page can also serve as a \emph{Seifert surface}, an oriented surface bordered by a given knot \cite{dangskul2016construction,Binysh_2018}.
Solid angle fields also play important roles in fluid dynamics and electrodynamics, as the gradients of the solid angle fields are the \emph{Biot-Savart fields} of space curves \cite[pp.118]{sommerfeld2013electrodynamics}, which represent the magnetic fields induced by electric currents, and the velocity fields corresponding to given vortex filaments.
In addition, solid angle fields are applied to constructing implicit representations for space curves for simulating vortex dynamics \mbox{\cite{iwc2022implicit_filaments}}, visualization of nematic dislinations in electromagnetism \mbox{\cite{Binysh_2018}}, and radiosity illumination in rendering
\mbox{\cite{Ramamoorthi2022}}.}
%It has implications in several fields. For example, a solid angle field is a concrete realization of the open-book decomposition in contact geometry. This is a decomposition of a space into \emph{the binder}, which is the curves, and \emph{the pages}, the levelsets of an $\SS^1$-valued function such that the boundary of each page is the binder \mbox{\cite{Geiges_2008contact}}. 
%This allows one to study geometry from topological viewpoints. In knot theory, for example, each page can be seen as a Seifert surface, which is an oriented and connected surface bounding a knot.}

%\rev{The solid angle field is known as the Biot-Savart field in fluid dynamics. It is called so since its gradient is the velocity field induced by the vorticity concentrated on the curves called vortex filaments and is described by the Biot-Savart law. The authors of the present article used solid angle fields for constructing implicit representations of space curves and numerically simulating their dynamics including vortex filaments \mbox{\cite{iwc2022implicit_filaments}}.  The solid angle field can also be used to visualize nematic disclinations in electromagnetism \mbox{\cite{Binysh_2018}} and light transport simulation with polygonal light sources \mbox{\cite{Ramamoorthi2022}}}.

%\rev{In this article we present a formula for the solid angle. Aside from such exact computation, numerical approximation has been studied. For example, one can uniformly spread points over the sphere and count the number of points inside and outside the spherical polygon. An efficient way of the point distribution is using the Fibonacci sequence \mbox{\cite{Gonzalez2010Fibonacci}}. 
%A stochastic sampling of points using the Monte-Carlo method is also possible \mbox{\cite{Arvo1995stochasticSampling}}.}

\section{Area of a spherical polygon}
\rev{We begin with the problem of seeking a line integral formula for the areas of spherical polygons.
Next, we introduce the notion of prequantum bundles.  While we only use the essential properties of this notion in a self-contained manner, the readers may find backgrounds in principal bundles \mbox{\cite{nakahara2003geometry,kobayashiNomizu1963foundations}} and geometric quantization \mbox{\cite{bates_Weinstein1997lectures,kostantBertram1970quantization}} useful.
%We first explain preliminaries and our settings. We refer to literature for basics in principal bundles \mbox{\cite{nakahara2003geometry,kobayashiNomizu1963foundations}} and geometric quantization \mbox{\cite{bates_Weinstein1997lectures,kostantBertram1970quantization}}. 
Finally, we derive a line integral formula for spherical areas via prequantization and apply it to spherical polygons.}

  An oriented spherical polygon \(\Gamma\) is a finite cyclic ordered list of spherical points \(\Gamma=(p_0,\ldots,p_{n-1})\), \(p_i \in \SS^2\), \(i\in\ZZ_n=\ZZ/(n\ZZ)\).
 Each edge, \ie\@ each pair of adjacent points 
  \((p_i, p_{i+1})\), \(i\in\ZZ_n\) (including \((p_{n-1},p_0)\) using the modulo arithmetic of \(i\in\ZZ_n\)), is joined by the shortest connecting path on \(\SS^2\).  
  This edge path is a constant point when \(p_i=p_{i+1}\), and is otherwise a part of the great circle containing \(p_i,p_{i+1}\).   
  To ensure uniqueness of the shortest edge path, we assume that \(p_{i+1}\neq -p_i\) for each \(i\in\ZZ_n\), which does not take away generality as one may add intermediate points if the polygon contains any antipodal edge.

By concatenating all the edge paths, the spherical polygon \(\Gamma\) is naturally associated with a continuous closed path \(C_\Gamma\colon\SS^1\to\SS^2\).  
Let \(S_\Gamma\colon\DD^2\to\SS^2\) be any \sttext{continuous}\rev{smooth} extension%
\footnote{\rev{A smooth extension $S_\Gamma\colon\DD^2\to\SS^2$ exists for any smoothly parameterized path $C_{\Gamma}\colon\SS^1\to\SS^2$.  A smooth path $C_{\Gamma}$ can be constructed by concatenating smooth parameterizations of the great circular edges with vanishing derivatives \(0=\partial_tC_\Gamma = \partial_t^2C_\Gamma= \cdots\) at the vertices.
%We can always take a smooth $S_\Gamma$ if $C_\Gamma$ is smooth in $t\in \SS^1$. We may assume so without loss of generality by making the velocity $\partial_t C_\Gamma$ (and higher order derivatives) zero on the vertices $\{p_i\}_i$ by making $|\partial_t C_\Gamma|$ between each spherical edge a smooth bump function supported exactly on the edge. 
}}
of \(C_{\Gamma}\colon\SS^1=\partial\DD^2\to\SS^2\) to the unit disk \(\DD^2\).  We call \(S_\Gamma\) the \emph{enclosed region} of the spherical polygon \(\Gamma\), which is unique up to an integer number of full wrappings around the entire sphere.  
Define the \emph{signed area} of \(\Gamma\) as the total signed area of \(S_\Gamma\), which is well-defined modulo \(4\pi\):
\begin{align}
\label{eq:AreaDefinition}
    \operatorname{Area}(\Gamma) 
    \coloneqq 
    \iint_{S_\Gamma} \sigma = \iint_{\DD^2}S_\Gamma^*\sigma\in \RR/(4\pi\ZZ).
\end{align}


Here \(S_\Gamma^*\) denotes the pullback via \(S_\Gamma\), and \(\sigma\in\Omega^2(\SS^2)\) is the standard area form of the unit sphere \(\SS^2\subset\RR^3\) induced by the Euclidean metric. The area form \(\sigma\) can be explicitly written as \(\sigma= \sin \theta d\theta\wedge d\phi\) using a spherical coordinate chart, or as \(\sigma=(x dy \wedge dz + y dz \wedge dx + z dx \wedge dy)/(x^2+y^2+z^2)^{3/2} \ |_{\SS^2}\) using the Cartesian coordinates in \(\RR^3\). 
This definition is valid for self-intersecting polygons (See \autoref{fig:signed_area}) and degenerate polygons which may contain edges of zero lengths or consecutive edges that fold back onto each other. 
% \rev{
% \begin{remark}
%     Strictly speaking, the map $S_\Gamma$ needs to satisfy a mild regularity condition so that the integral $\eqref{eq:AreaDefinition}$ makes sense. For example, being differentiable almost everywhere on $\DD^2$ and $\|\nabla S_\Gamma\|_{L^\infty (\DD^2)}<\infty $ in the weak sense is sufficient. If $S_\Gamma$ is Lipshitz, this is satisfied (Rademacher's theorem). For any spherical polygon $\Gamma$, we can even construct a smooth $S_\Gamma$, which we outline in Appendix \ref{to be given}. 
% \end{remark}
% }
% \cSI{Can we construct such $S_\Gamma$ this way? Suppose $\gamma$ is a spherical $n$-gon. First, set a small open spherical disc $D$ and a regular open spherical $n$-gon domain $R$ inscribed in $D$. Then there exists a smooth map from $D$ to $R$. Then we parametrize $R$ by harmonic coordinates $\{f_i:\bar R \to [0,1]\}_i$. Then construct a map from $R$ to the target spherical polygon $\{p_1, \ldots, p_n \in \SS^2\}$ by $x\in R \mapsto \sum_i f_i(x) p_i$. The map $S_\Gamma$ is the composition of these maps.}
    % \cAC{Just need to say that the concatenation of edges can be made \(C^\infty\). Without loss of generality \(C_\Gamma\) is smoothly parameterized.  Note that it can still be a non-regular curve as the parameterization speed can become zero at polygon corners, but that doesn't matter for any of our integrals.}

% \cSI{Good idea. I added an explanation in the footnote. I think we also have to be careful about wording as it seems the standard definition of "smooth parametrization of a curve" requires $\partial_s \gamma\neq 0$ everywhere.}
\begin{figure}[h]
\centering
 % [trim = {left, bottom, right, top}, clip]
 \begin{minipage}[t]{0.4\textwidth}
\includegraphics[width=\textwidth]{images/spherical_area_example.png}
\end{minipage}
 \begin{minipage}[t]{0.4\textwidth}
\includegraphics[width=\textwidth,angle=0]{images/spherical_area_example2.png}
\end{minipage}
\caption{Examples of spherical polygons. Left: the two regions with different colors contribute positively or negatively to the signed area. Right: the darker region contributes to the signed area twice.}
\label{fig:signed_area}
\end{figure}

\subsection{Areas as line integrals}
Our goal is to find a numerically robust formula for \eqref{eq:AreaDefinition} in terms of the vertex positions \(\Gamma = (p_0,\ldots,p_{n-1})\).
More precisely, an ideal area formula we look for is a line integral ``\(\Area(\Gamma)=\oint_{C_{\Gamma}}\alpha\)'' for some smooth differential 1-form \(\alpha\), analogous to Green's Theorem in the plane.
The reason for this desire goes as follows.
Once \eqref{eq:AreaDefinition} becomes a line integral along the polygonal curve, we can derive the formula for \(\Area(\Gamma)\) by summing the explicit integrals of \(\alpha\) along the great circular arc of each edge.
Such a line-integral-based formula would be applicable to degenerate cases: The angles between consecutive edges would never appear in the formula; the line integral of a smooth 1-form along an edge shrinks to zero gracefully if the edge length shrinks to zero.

Such a line integral formula ``\(\Area(\Gamma) = \oint_{C_\Gamma}\alpha\)'' appears to rely on the exactness of \(\sigma\), which is the existence of a smooth 1-form \(\alpha\) so that \(d\alpha = \sigma\). 
If \(\alpha\) exists, then by Stokes' Theorem \(\Area(\Gamma) = \iint_{S_\Gamma}\sigma = \iint_{S_{\Gamma}}d\alpha = \oint_{C_{\Gamma}}\alpha\).
However, the \emph{spherical area form
\(\sigma\) is not exact.}
Fortunately, and perhaps surprisingly, a line integral formula does not require the exactness of \(\sigma\) as described below.

\begin{definition}[Prequantum bundle]
\label{def:PrequantumBundle}
Let \(\beta\in\Omega^2(\Sigma)\) be a closed 2-form on a manifold \(\Sigma\).  A \emph{prequantum bundle} over \((\Sigma,\beta)\) is a principal circle bundle \(\pi\colon Q\to\Sigma\) equipped with \rev{an equivariant 1-form} \(\alpha\in\Omega^1(Q)\) \rev{with} \sttext{ such that $c\alpha$ with some constant $c$ is a connection 1-form and} $d\alpha = \pi^*\beta$.
\end{definition}
\rev{Intuitively, a principal circle bundle \(Q\) over the base manifold $\Sigma$ is a \((\dim(\Sigma)+1)\)-dimensional space where a circle is attached to each point of \(\Sigma\). The equivariance of \(\alpha\in\Omega^1(Q)\) means that \(\alpha\) is invariant under a uniform rotation in the circle dimension.}

\begin{remark}\label{rmk:existence_prequantum_bundle}
\rev{In a classical definition for a prequantum bundle, \(\alpha\) is a \emph{connection 1-form}, which has an additional requirement that \(\alpha(V) = 1\) where \(V\) is the generator of the rotation action.}
\sttext{In a classical definition for a prequantum bundle,  $d\alpha$ may take the form of 
$ \pi^* \beta =d\alpha+ \omega $ with some 2-form $\omega$ that vanishes in the horizontal space, but $\alpha$ must be a connection form.
For our purpose, we require $d\alpha =  \pi^*\beta$, but allow scaling $\alpha$ to be a connection form. For the Hopf fibration $\pi:\SS^3\rightarrow \SS^2$ particularly, the existence of such $\alpha$ is trivial as $H_{dR}^2(\SS^3)=0$.}
In general, every compact symplectic manifold \((\Sigma,\beta)\) admits a principal circle bundle \((Q,\alpha)\) with \rev{a connection 1-form $\alpha$ satisfying} \(d\alpha=\pi^* \beta\) \sttext{by} \rev{upon a} \rev{rescaling of} \sttext{scaling} \(\beta\) so that \(\beta/2\pi\in H_2(\Sigma,\ZZ)\) 
% \cite[Theorem~ 2.5]{blair2010riemannian}.
\cite[Theorem~3]{Boothby_Wang_contact} \cite[Proposition~9]{Kobayashi_Kaeler}.
\end{remark}

% \cAC{
% Consider the following definition + comments + remark:\\
% \textbf{definition (prequantum bundle):}
% Let \(\beta\in\Omega^2(\Sigma)\) be a closed 2-form on a manifold \(\Sigma\).  A prequantum bundle over \((\Sigma,\beta)\) is a principal circle bundle \(\pi\colon Q\to \Sigma\) equipped with an equivariant 1-form \(\alpha\in\Omega^1(Q)\) such that \(d\alpha = \pi^*\beta\).\\
% \textbf{comment:} Intuitively, \(Q\) is a resulting \((\dim(\Sigma)+1)\)-dimensional space by attaching a circle to each point on the base manifold \(\Sigma\).  Here, the equivariance of \(\alpha\in\Omega^1(Q)\) means that \(\alpha\) is invariant under a uniform rotation in the circle dimension.\\
% \textbf{Remark:}  In a classical definition for a prequantum bundle, \(\alpha\) is a \emph{connection 1-form}, which has an additional requirement that \(\alpha(V) = 1\) where \(V\) is the generator of the rotation action.   Every symplectic manifold \((\Sigma,\beta)\) admits a prequantum bundle \((Q,\alpha)\) upon a rescaling of \(\beta\) so that \(\beta/(2\pi)\in H_2(\Sigma,\ZZ)\) [references].  (Note that I'm not using symplectic but just closed 2-form... Or should I keep it as symplectic?  It's just a topological thm about total integral of the 2-form is integer 2pi)
% }\cSI{You are absolutely right, the correct expression is a compact oriented manifold with closed 2-form, but I think we could keep it a symplectic manifold. }
% \cAC{Ah right, we should add "oriented" manifold to be safe.  And yup cool. Both are fine with me}\cSI{Ok, let's settle with a symplectic manifold.}
% \cSI{I have the impression that we can remove "In some definition part". Then I think we could just concatenate two remarks in your comment. }
% \cAC{There is some later part of the paper that references that any symplectic manifold has a prequantum bundle.}
% \cSI{Yes, I am aware of this. This definition in this remark about the existence is using the connection 1-form. That's why it talks about "scaling".}
% \cAC{Ok I think it's fine to concatenate }
\begin{proposition}[Lifted Green's theorem]\label{prop:liftedGreenTheorem}
    Let  \(\pi\colon (Q,\alpha)\to(\Sigma,\beta)\) be a prequantum bundle.   
    For each surface \(S\colon\DD^2\to\Sigma\) consider an arbitrary lift \(\widetilde S\colon\DD^2\to Q\), \(\pi\circ\widetilde S = S\).  Then 
    \begin{align*}
        \iint_{ S}\beta = \oint_{\partial \widetilde{ S}}\alpha.
    \end{align*}
\end{proposition}
\begin{proof}
    \(\oint_{\partial \widetilde{ S}}\alpha = \iint_{ \widetilde{ S}}d\alpha =  \iint_{ \widetilde{ S}}\pi^*\beta  =  \iint_{\pi\circ \widetilde S}\beta =  \iint_{ S}\beta\).
    %\cAC{The tilde and the non-tilde \(S\)'s seem flipped.}\cSI{Fixed}
\end{proof}

The lifted Green's theorem enables line integral formula for the area of a spherical curve. Suppose we have a prequantum bundle \(\pi\colon (Q,\alpha)\to(\SS^2,\sigma)\) over the sphere \(\SS^2\).  
For each closed curve \(C_{\Gamma}\) on \(\SS^2\), construct an arbitrary lift \(\widetilde C_{\Gamma}\colon\SS^1\to Q\), \(\pi\circ \widetilde C_{\Gamma} = C_{\Gamma}\).  Then
\begin{align}\label{eq:area_via_prequantum_bundle}
    \Area(\Gamma) = \oint_{\widetilde C_\Gamma}\alpha\mod 4\pi.
\end{align}

\begin{remark}
While all the examples we provide in this article are prequantum bundles,  
for \propref{prop:liftedGreenTheorem}
we only need any smooth map \(\pi\colon Q\to\Sigma\) and \(\alpha\in\Omega^1(Q)\) that satisfies \(d\alpha = \pi^*\beta\) and has a general liftability of a topological disk \(S\) to \(\widetilde S\).  In particular, we do not need \(\pi\) to be a circle bundle or \(\alpha\) to be equivariant.
\end{remark}

\subsection{The Hopf fibration}
\label{sec:HopfFibration}
The Hopf fibration \(\pi\colon\SS^3\to\SS^2\) is a prequntum bundle over \(\SS^2\).
We provide its explicit expressions in the quaternion coordinate \(\HH = \{x\ii +y\jj + z\kk + w\,\vert\, (x,y,z,w)\in\RR^4\}\).
Using the quaternion coordiantes \(q\colon \SS^3\hookrightarrow\HH\cong\RR^4\) and \(p\colon \SS^2\hookrightarrow\Im\HH\cong\RR^3\), 
Hopf's bundle projection is given by
\begin{align}
\label{eq:HopfMap}
    \pi\colon \SS^3\to\SS^2,\quad \pi(q)\coloneqq q\ii \conj q.
\end{align}
Note that \(\pi\) is a principal circle bundle with  action \(\lhd\colon\SS^1\times\SS^3\to\SS^3, (\lhd e^{-\ii\theta})q \coloneqq qe^{-\ii\theta}
\)
For \(q\) and \(q'\coloneqq q e^{-\ii\theta}\) on a same fiber, we write \(\arg(\conj{q'}q)=\theta\).

The 1-form \(\alpha\in\Omega^1(\SS^3)\) for the prequantization is expressed as
\begin{align}
\label{eq:Hopf1Form}
\alpha = 2\Re(\ii \conj q dq)=-2\Re(d\conj q q\ii) = 2\Re( dq\ii \conj q) = -2\Re(q\ii d\conj q).
\end{align}
The 1-form \(\alpha/2\) is a connection form as it is equivariant under \(\SS^1\) actions: \((\lhd e^{\ii\theta})^*\alpha = \alpha\) and \({1\over 2}\alpha({d\over d\theta}\vert_{\theta=0}(\lhd e^{-\ii\theta})q)=1\). 
\begin{proposition}
\label{prop:HopfPrequantum}
    The 1-form \(\alpha\in\Omega^1(\SS^3)\) defined in \eqref{eq:Hopf1Form} and the map \(\pi\colon\SS^3\to\SS^2\) defined in \eqref{eq:HopfMap} satisfy \(d\alpha = \pi^*\sigma\), where \(\sigma\in\Omega^2(\SS^2)\) is the standard area form on the unit sphere.  That is, \((\SS^3,\alpha)\) is a prequantum bundle over \((\SS^2,\sigma)\). 
\end{proposition}
This result is known (\cite{bengtsson_zyczkowski_2006}, \cite[Theorem~ 1]{chernSchroedinger}), but we give a proof in \autoref{appendix:proof_of_prequantum_bundles} for completeness. 
With this setting, \propref{prop:liftedGreenTheorem} is now written more concretely for a spherical polygon:
% \cSI{I inserted a line before the corollary.}\cAC{Remove ``a little''}
\begin{corollary}
\label{cor:HopfArea}
    The area \(\Area(\Gamma)\) of a spherical polygon \(\Gamma=\{p_i\}_i\) can be evaluated by a line integral
    \begin{align}
        \label{eq:AreaByHopf}
        \Area(\Gamma) = \sum_i\int_{\widetilde C_\Gamma([t_i,t_{i+1}])}\alpha\mod 4\pi
    \end{align}
    where \(\alpha\) is given by \eqref{eq:Hopf1Form} and \(\widetilde C_\Gamma\) is an arbitrary lift \(\widetilde C_\Gamma\colon\SS^1\to\SS^3\) of the polygon curve \(C_\Gamma = \pi\circ\widetilde C_\Gamma \colon\SS^1\to\SS^2\) with \(C_\Gamma(t_i)=p_i\) for each \(i\).
\end{corollary}

\section{The area formula via the Hopf fibration}

In this section, we obtain an explicit formula by evaluating each piece of the line integral in  \eqref{eq:AreaByHopf} along a great circular arc lifted onto \(\SS^3\). 
We first define {\em dihedral} for a pair of spherical points.
\begin{definition}
    For each \(p,p'\in\SS^2\), \(p\neq -p'\), define
    \begin{align}
        \Dihedral(p,p')\coloneqq \sqrt{1+\langle p,p'\rangle\over 2} + {p\times p'\over \sqrt{2+2\langle p,p'\rangle}} \in\SS^3\subset\HH.
    \end{align}
    which is the unit quaternion that represents the minimal rotation that rotates \(p\) to \(p'\) i.e. \(rp\conj r = p'\), \(r = \Dihedral(p,p')\).
\end{definition}
There is a unique (unnormalized) \emph{rotation axis} \(v\in T_1 \SS^3 (= \operatorname{Im}\HH) \) for the minimal rotation for non-antipodal \(p,p'\in \SS^2\). This axis \(v\) is parallel to \(p\times p'\) and  \( \Dihedral(p,p')=e^{\frac{v}{2}}\) by the exponential map on  \(\SS^3\).
We also note that  any \(q\in\pi^{-1}p\), the point \(\Dihedral(p,p')q\) is on \(\pi^{-1}p'\). 

We will see that each summand in \eqref{eq:AreaByHopf} can be explicitly expressed in terms of the dihedral after recognizing how the dihedral represents the horizontal lift over a great circular arc.

\begin{proposition}[Horizontal lift on \((\SS^3,\alpha)\)]\label{prop:horitontal_lift}
Consider the Hopf fibration \(\pi\colon(\SS^3,\alpha)\allowbreak \to (\SS^2,\sigma)\) described in \secref{sec:HopfFibration}.
Let \(p_0, p_1\) be two arbitrary non-antipodal points on \(\SS^2\), let
    \(\gamma\colon [0,1]\to \SS^2\) be the great circular arc joining \( p_0 \) and \(p_1\), and let \(v\in T_1 \SS^3\) be the imaginary quaternion such that \(e^{\frac{v}{2}}= \Dihedral(p_0,p_1)\).
Then for each given point \(q\in \pi^{-1}p_0\), the horizontal lift \(\tilde{\gamma}_H\) of \(\gamma\)  with \(\tilde{\gamma}_H(0)=q\) is given by 
\begin{align*}
    \tilde{\gamma}_H (t)= e^{\frac{vt}{2}} q.
\end{align*}
\begin{proof}
It follows from  
\(\gamma(t)= e^{\frac{vt}{2}} p_0 e^{-\frac{vt}{2}}\)
that \(\tilde{\gamma}_H\) is a lift over \(\gamma\) with respect to \(\pi\).
% 
We now show that \(\tilde{\gamma}_H\) is horizontal. 
At each \(q\in \SS^3\), the tangent space and the horizontal subspace with respect to 
the connection 1-form \(\alpha/2\) are \(T_q \SS^3=\operatorname{Span}( q\ii, q\jj, q\kk)\) and \(
% \operatorname{ker}(\alpha)
H_q \SS^3=\operatorname{Span}( q\jj, q\kk)\) respectively.
We have for each \(t\) that
\begin{align*}
    \frac{d}{dt}\tilde{\gamma}_H (t)
    = \frac{1}{2} e^{\frac{vt}{2}} v q.
\end{align*}
Here we note that the conjugation \( h \mapsto q h \bar{q}\) is an isometry in \(\operatorname{Im}(\HH)\), from which it follows that 
\(v\in q (H_q \SS^3) \bar{q}\)
as
\begin{align*}
    0=\langle v,p\rangle=\langle q (\bar{q} v  q)\bar{q}, q\ii \bar{q}\rangle.
\end{align*}
Therefore, \(e^{vt\over 2}vq\) is horizontal.
\end{proof}
\end{proposition}

\begin{lemma}
\label{lem:SegmentIntegral}
Assume \(\pi\colon(\SS^3,\alpha)\to(\SS^2,\sigma)\), \(p_0,p_1\in \SS^2\), and \(\gamma\colon [0,1]\to \SS^2\)  as in \propref{prop:horitontal_lift}.
    Then for any lift \(\tilde\gamma\colon[0,1]\to\SS^3\) of \(\gamma\), 
    the line integral \(\int_{\tilde\gamma}\alpha\) is explicitly given by
        \begin{align}
        \int_{\tilde\gamma}\alpha = 2\arg\bigl(\conj{q_1}\Dihedral(p_0,p_1)q_0\bigr), % \mod 4\pi,
    \end{align}
    where \(q_0 \coloneqq \tilde\gamma(0)\), \(q_1  \coloneqq \tilde\gamma(1)\).
    \begin{proof}
  \propref{prop:horitontal_lift} asserts that \(q_0\in \pi^{-1}p_0\) 
  and \(q_H\coloneqq \Dihedral(p_0,p_1) q_0 \in \pi^{-1} p_1\) are connected by the unique horizontal lift \(\tilde{\gamma}_H\).
Let us consider a parametric surface $\Delta \subset \SS^3$ given by
\begin{align*}
    \Delta \coloneqq \left\{  \tilde{\gamma}_H(t) e^{\ii\theta} \in \SS^3 \big| t\in[0,1], \theta\in[0,\theta_t] \  \right\},
\end{align*}
where \(\theta_t\) for each \(t\) is the angular difference  \(\theta_t\coloneqq \arg\left(\overline{\tilde{\gamma}(t)}\tilde{\gamma}_H(t)) \right)\).  We first obtain that 
\begin{align*}
    \int_{\partial\Delta} \alpha 
    = \int_\Delta d\alpha 
    = \int_{\Delta} \pi^*\sigma =0,
\end{align*}
as \(\pi(\Delta)=\gamma([0,1])\).

Note that the boundary \(\partial \Delta\) is a  closed path consisting of three segments: (I).  the \sttext{lift} lifted path \(\tilde{\gamma}\) from \(q_0\) to \(q_1\); (II). the vertical path \(\{q_1 e^{\ii\theta} \ |\ \theta\in [0,\theta_1] \}\) from  \(q_1\) to \(q_H\);  (III). the horizontal lift \(\tilde{\gamma}_H\) from \(q_H\) to \(q_0\). 
Since the integral of \(\alpha\) along the third path makes no contribution, we have
\begin{align*}
    \int_{\tilde{\gamma}} \alpha 
    &= - \int_{\{q_1 e^{\ii\theta} \ | \ \theta\in [0,\theta_1] \}}\alpha 
    = \int_{\{q_1 e^{-\ii\theta} \ | \ \theta\in [-\theta_1,0] \}}\alpha 
    = \int ^0 _{-\theta_1} \alpha 
    % |_{(\lhd e^{-\ii\theta}) q_1}
    \left(\frac{d}{d\theta} (\lhd e^{-\ii\theta}) q_1 \right) d\theta \\
    &= \int ^0 _{-\theta_1}  2 d\theta
    =  2\arg\left(\conj{q_1}q_H\right),
\end{align*}
which concludes the proof. 
\end{proof}
\end{lemma}

As a direct result of  \corref{cor:HopfArea} and \lemref{lem:SegmentIntegral}, we obtain our main theorem:


\begin{theorem}[Area formula via the Hopf fibration]\label{th:area_formula}
    Let \(\Gamma = (p_0,\ldots,p_{n-1}), p_i\in\SS^2, i\in \ZZ_n\), be a spherical polygon.  For each \(i\in\ZZ_n\), pick an arbitrary lift \(q_i\in\SS^3\)  i.e. \(\pi(q_i) = p_i\).  Then,
    \begin{align}
    \label{eq:FinalAreaFormula}
        \Area(\Gamma) = 2\sum_{i=0}^{n-1}\arg\bigl( \conj{q_{i+1}}\Dihedral(p_{i},p_{i+1})q_i\bigr)\mod 4\pi.
    \end{align}
\end{theorem}

The formula requires an arbitrary lift \(q_i\in\SS^3\) of the vertex positions \(p_i\in\SS^2\) for \(i\in\ZZ_n\). An example is
\begin{align}
\label{eq:ChoiceOfLift}
    q_i = 
    \begin{cases}
        \Dihedral(\ii,p_i),& \langle p_i,\ii\rangle \geq 0,\\
        \Dihedral(-\ii,p_i)\jj,& \langle p_i,\ii\rangle <0,
    \end{cases}
\end{align}
which is uniquely defined globally.

As a special case of \autoref{th:area_formula}, choosing the horizontal lift results in no contribution of \(\alpha\) except for the endpoint of the polygon.
\begin{corollary}[Area formula by  
the horizontal lift ]\label{cor:horizontal_lift_area_formula}
Let \(q_0\) be a point in the fiber \(\pi^{-1}p_0\) and let us inductively define \(q_{i+1}:=\Dihedral(p_i,p_{i+1}) q_i \) for \(i=0,\ldots,n-1\). Then we have
\begin{align}
    \operatorname{Area}(\Gamma) %\mod 4\pi 
    =2\arg(\conj{q_{0}} q_n  ).
\end{align}

\end{corollary}
At the end of the section, we make a remark regarding the numerical stability of the formula \eqref{eq:FinalAreaFormula}.
\begin{remark}
    The branching discontinuities in the ``\(\arg\)'' function in \eqref{eq:FinalAreaFormula} and the ``if'' statement in \eqref{eq:ChoiceOfLift} are smooth in the mod-\(4\pi\) arithmetic of \eqref{eq:FinalAreaFormula}.
The only calculation that can be numerically unstable is the evaluation of the \(\Dihedral\) function when the two arguments are close to antipodal.
This antipodal dihedral evaluation is avoided by the choice \eqref{eq:ChoiceOfLift}.
The entire evaluation of our area formula \eqref{eq:FinalAreaFormula} with \eqref{eq:ChoiceOfLift} is numerically stable as long as we do not have antipodal edges where \(\langle p_i,p_{i+1}\rangle \approx-1\), which is easily preventable by inserting a midpoint to any close-to-antipodal edge.
\end{remark}

\section{Derivation of the classical formula by \(\SO(3)\) as a prequantum bundle}\label{sec:derivation_classical_formula}
The Hopf fibration structure can also be seen in the group \(\SO(3)\) of 3D rotations. In fact, the classical formula \eqref{eq:GB_formula} can be interpreted as a special case of the lifted Green's theorem on \(\SO(3)\) using a specific lift not as numerically stable as \rev{our formula (\thmref{th:area_formula}) using either the lift} \eqref{eq:ChoiceOfLift} or the horizontal lift (\sttext{Theorem}\rev{\corref{cor:horizontal_lift_area_formula}}).
We see that \(\SO(3)\) as the unit tangent bundle over \(\SS^2\) is also a prequantum bundle with a specific connection form. As \(\SS^3\) is a double cover of \(\SO(3)\), the Hopf fibration \(\pi:\SS^3\rightarrow \SS^2\) has a decomposition \(\pi=\pi_2 \circ \pi_1\) given by,
\begin{align}
\pi_1\colon& \SS^3 \rightarrow \SO(3)\\
    &q \mapsto (q\ii\bar{q}, q\jj\bar{q}, q\kk\bar{q}), \nonumber 
\end{align}
and 
\begin{align}\label{eq:SO3map}
\pi_2\colon& \SO(3) \rightarrow \SS^2 \\
    &(p_1,p_2,p_3) \mapsto p_1,  \nonumber 
\end{align}
where each element of \(\SO(3)\) is represented by three column vectors. 

The tangent space \(T_P \SO(3)\) at each \(P\in \SO(3)\) is \(dL_P \mathfrak {so}(3)=\left\{PW | W^T=-W\right\}\). We identify   each 
\(W = 
\begin{psmallmatrix}
0&-\omega_3&\omega_2\\
\omega_3&0&-\omega_1\\
-\omega_2&\omega_1&0
\end{psmallmatrix} \in  \mathfrak {so}(3)\)  with \(\omega=(\omega_1,\omega_2,\omega_3)\in \RR^3\).
We define a\sttext{n} 1-form \(\eta\) by  
\begin{align}\label{eq:SO3_1Form}
        \eta|_P(PW)\coloneqq -\omega_1.
\end{align}
Then \((\pi_2,\eta)\) is a principal circle bundle with \(\SS^1\) action \(\lhd\colon\SS^1\times \SO(3)\to \SO(3),\) by \((\lhd e^{\ii\theta})P = P
\begin{psmallmatrix}
    1&0&0\\
    0&\cos\theta&-\sin\theta\\
    0&\sin\theta&\cos\theta
\end{psmallmatrix}.
\)
\begin{proposition}\label{prop:SO3Prequantum}
        The 1-form \(\eta\in\Omega^1(\SO(3))\) defined in \eqref{eq:SO3_1Form} and the map \(\pi_2\colon \SO(3)\allowbreak\to\SS^2\) 
        % \cAC{superscript or subscript?} 
        defined in \eqref{eq:SO3map} satisfy \(d\eta = \pi_2^*\sigma\), where \(\sigma\in\Omega^2(\SS^2)\) is the standard area form on the unit sphere.  That is, \((\SO(3),\eta)\) is a prequantum bundle over \((\SS^2,\sigma)\). 
\end{proposition}
We give a proof in \autoref{appendix:proof_of_prequantum_bundles}.
To recover the classical formula via \(\pi_2\colon(\SO(3),\eta)\allowbreak\rightarrow(\SS^2, \sigma)\),
we define a lift as follows. We take for each \(p_i\) the forward velocity from \(p_i\) to \(p_{i+1}\) on \(\SS^2\).  It is given at \(p_i\eqqcolon\gamma(t_i)\) by
\begin{align*}
    v(p_i)\coloneqq\lim_{h\to +0}\frac{\gamma(t_i+h)-\gamma(t_i)}{h}\in T_{p_i}\SS^2,
\end{align*}
which is a positive multiple of \(-p_i\times(p_i\times p_{i+1})\).
Then
\begin{align*}
   \tilde{\gamma}(t_i)\coloneqq\left(p_i, \frac{v(p_i)}{|v(p_i)|}, p_i \times \frac{v(p_i)}{|v(p_i)|} \right)
\end{align*} 
defines a lift \( \tilde{\gamma} \colon \SS^1 \rightarrow \SO(3)\) of \(\gamma\). For \(\tilde{\gamma} \), we have 
\begin{align}\label{eq:classical_from_SO3}
    \int_{\tilde\gamma}\eta =-\sum_i \vartheta_i
\end{align}
with the exterior angles \(\vartheta_i\) given in \eqref{eq:exterior_angle1}.
% 
One has to be cautious when drawing conclusion from \eqref{eq:classical_from_SO3} about the area formula using \propref{prop:liftedGreenTheorem}.  In fact, \(\Area(\Gamma) = 2\pi + \int_{\tilde\gamma}\eta = 2\pi-\sum_i\vartheta_i\) noting the extra term of \(2\pi\) (\cf\@ \eqref{eq:GB_formula}).
This is because \(\tilde\gamma\) is a non-contractible loop in \(\SO(3)\) which is not the boundary of a disk.
To obtain the classical formula \eqref{eq:GB_formula}, lift \(\tilde\gamma\colon\SS^1\to\SO(3)\) to \(\hat\gamma\colon \SS^1\to\SS^3\) by the universal cover \(\pi_1\colon\SS^3\to\SO(3)\).  Note that \(\alpha = \pi_1^*\eta\), and that \(\hat\gamma(0)=\hat\gamma(2\pi)\) and \(\lim_{t\nearrow 2\pi}\hat\gamma(t)\) has an angle difference of \(\pi\) in the fiber \(\pi^{-1}(\gamma(0))\).  

The classical formula has a variant that locates a pole \(Z\in\SS^2\) and sums up the signed area of triangles \((p_i,p_{i+1},Z)\). This formula is given as, 
\begin{align}\label{eq:gauss_bonnet}
    \operatorname{Area}(\Gamma) 
    =\sum_i \operatorname{sign}\left(\det(p_i,p_{i+1},Z)\right) \operatorname{UnsignedArea}(p_i,p_{i+1},Z),
\end{align}
where the unsigned area of each spherical triangle \((x_0,x_1,x_2)\) is computed as,
\begin{align}\label{eq:unsigned_triangle_area}
    \operatorname{UnsignedArea}(x_0,x_1,x_2)=-\pi + \sum_{i\in \ZZ_3} \arccos\left(\frac{x_{i-1}\times x_{i}}{|x_{i-1}\times x_{i}|}\cdot\frac{x_i\times x_{i+1}}{|x_i\times x_{i+1}|}\right).  
\end{align}
This formula can also be recovered by the Hopf fibration. 
Setting the lift \(q_i\coloneqq \Dihedral(Z,p_i)\)
for each \(p_i\), we obtain \eqref{eq:gauss_bonnet}. Numerically, this formula is unstable if any of the vertices is close to \(Z\) or \(-Z\), which is explained by the numerical sensitivity of \(\Dihedral(Z,p_i)\) and
\(\frac{p_{i}\times Z}{\|p_{i}\times Z\|}\).

\section{Numerical examples}

In this section, we present numerical examples of area computation for spherical polygons using our formula \eqref{eq:FinalAreaFormula}. 
Moreover, we demonstrate how this formula can also be utilized to determine the total torsion of a space curve, which differs from \(2\pi\) exactly by the enclosed area of the spherical curve traced out by the tangents of the curve.
By comparing the results obtained using both our formula and the classical formula \eqref{eq:GB_formula}, we show that our formula produces consistent and converging solutions, even for singular curves.
This improved numerical robustness allows for more accurate measurements of spherical areas and total torsion.

We employ the horizontal lift approach (\corref{cor:horizontal_lift_area_formula}) for computation in all of our examples.
For a given closed spherical curve \(\gamma\colon [0,2\pi)\rightarrow \SS^2\), 
we use a uniform division \(\{t_i\coloneqq {2\pi i\over n}\}_{i=0}^{n-1}\) of the interval \([0,2\pi)\) to specify the vertices \(\{\gamma(t_i)\}_{i=0}^{n-1}\) with some positive integer \(n\).  This process turns the spherical curve into a spherical polygon.

\subsection{Spherical cardioid}
\label{sec:SphericalCardioid}
We compute the area of a spherical curve \(\gamma\) given by the stereographic projection image \(\gamma = P\circ\gamma_{\RR^2}\) of a planar cardioid \(\gamma_{\RR^2}\) (\autoref{fig:cardioid}).  
Explicitly, the planar cardioid is parametrically  given by
\begin{align*}
    \gamma_{\RR^2}(t)=\left( 2(1-\cos(t))\cos(t), 2(1-\cos(t))\sin(t) \right),
\end{align*}
and the stereographic projection from the plane to the sphere is
\begin{align*}
    P\colon (x,y)\mapsto \frac{1}{x^2+y^2+1}(2x,2y,x^2+y^2-1).
\end{align*}
We compute the area with various numbers \(n\) of vertices using our formula and the classical formula (\ref{eq:GB_formula},\ref{eq:exterior_angle1}).
\autoref{fig:plot_cardioid_Frenet_spiral} (left) shows their numerical results.
Note that this spherical cardioid has a cusp, \ie\@ \(\partial_t\gamma\) changes sign at \(t = 0\).
As the polygon refines (\(n\to\infty\)), the edge lengths adjacent to \(\gamma(t_0)\) decrease to zero superlinearly, and \(\frac{\gamma(t_{n-1})\times \gamma(t_{0})}{|\gamma(t_{n-1})\times \gamma(t_{0})|}\cdot\frac{\gamma(t_{0})\times \gamma(t_{1})}{|\gamma(t_{0})\times \gamma(t_{1})|}\rightarrow -1\).
These conditions make the classical formula numerically unstable as observed in \autoref{fig:plot_cardioid_Frenet_spiral}, left.  
In contrast, our formula is numerically stable despite the presence of the cusp.
% 
\begin{figure}[ht]
\centering
 % [trim = {left, bottom, right, top}, clip]
 \begin{minipage}[t]{0.4\textwidth}
\includegraphics[width=\textwidth]{images/cardioid0015.png}
\end{minipage}
 \begin{minipage}[t]{0.4\textwidth}
\includegraphics[width=\textwidth,angle=0]{images/cardioid_stereo_new.png}
\end{minipage}
\caption{ Cardioid (left) stereographically projected on the sphere (right). }
\label{fig:cardioid}
\end{figure}

\begin{figure}[htbp]
\centering
 \begin{minipage}[t]{0.45\textwidth}
\includegraphics
 [keepaspectratio, scale=1.]
{images/plot_cardiod_small.pdf}
\end{minipage}
 \begin{minipage}[t]{0.45\textwidth}
\includegraphics
 [keepaspectratio, scale=1.]
{images/plot_non_Frenet_small.pdf}
\end{minipage}
\caption{
Numerical values of the signed areas of spherical curves discretized into spherical polygons with increasing number of vertices, computed using the classical formula (Gauss--Bonnet) and our formula (Hopf).
Both formulae give consistent values when the number of vertices is small, but the classical formula becomes unstable as the number of vertices increases.
Left: The area enclosed by a spherical cardioid (Section~\ref{sec:SphericalCardioid}).
Right: The total torsion \((2\pi- \operatorname{Area}(\gamma'))\) of a non-Frenet space curve (Section~\ref{sec:NonFrenet}).
}
\label{fig:plot_cardioid_Frenet_spiral}
\end{figure}

\subsection{Total torsions of space curves}
\label{sec:TotalTorsion}
Our next examples are about total torsions of \rev{closed} space curves. For a space curve \sttext{$\gamma\colon [0,2\pi)\to\RR^3$} \rev{$\gamma\colon \SS^1\to\RR^3$}, 
% \cAC{Maybe change it to \(\gamma\colon\SS^1\to\RR^3\)}
the total torsion \cite[Ch.\@ 1 Sec.\@ 5.1]{PinkallGross2024geometry}
% \cAC{insert ref to Olli\&Ulrich Ch.5} 
(equivalently, the total writhe up to a \rev{minus sign and a} multiple of \sttext{$4\pi$}\rev{$2\pi$}) can be evaluated as \sttext{$\operatorname{Torsion}(\gamma) = 2\pi - \Area(\gamma')$}, 
% \cAC{actually \(2\pi\); it's not clear whether the frame that defines the torsion is in which \(\ZZ_2\) branch}) \cSI{I'll look into it.}
% can be evaluated as \(\operatorname{Torsion}(\gamma) = 2\pi - \Area(\gamma')\), 
\rev{
\begin{align}\label{eq:def_total_torsion}
    \operatorname{Torsion}(\gamma) = 2\pi - \Area(\gamma') \quad \mod 2\pi,
\end{align}
}
% \cAC{it's worth making the equation in mathdisplay mode; and add mod \(2\pi\).} 
where \(\Area(\gamma')\) is the signed area of the unit velocity map given by \(\gamma'=\partial_t\gamma/|\partial_t\gamma|\).
This notion of total torsion also works for a space polygon \(\{\gamma(t_i)\}_i\).  For a space polygon, the unit velocity \( \gamma'\) is given by the normalized edge vector
\begin{align*}
    \gamma'(t_i)=\frac{\gamma(t_{i+1})-\gamma(t_i)}{|\gamma(t_{i+1})-\gamma(t_i)|},
\end{align*}
which forms a spherical polygon, whose signed area can be evaluated by our formula.  
We compute the total torsions of the figure-eight knot (\autoref{fig:figure-eight})
\begin{align*}
    \gamma(t)= \left((2 + \cos(2t))\cos(3t),(2 + \cos(2t)) \sin(3t), \sin(4t)\right),
\end{align*}
and the trefoil knot (\autoref{fig:trefoil}),
\begin{align*}
\gamma(t)=\left(  \sin(t) + 2 \sin(2t),\cos(t)-2\cos(2t), -\sin(3t)\right).
\end{align*}
With sufficiently many vertices, our results converge to numbers that agree with the results in a previous study \cite{najdanovic2021total}: \(-0.5423\) of the figure-eight knot and \(2.2250\) of the trefoil.
\begin{figure}
\centering
 % [trim = {left, bottom, right, top}, clip]
 \begin{minipage}[t]{0.4\textwidth}
\includegraphics[width=\textwidth]{images/eight0015.png}
\end{minipage}
 \begin{minipage}[t]{0.4\textwidth}
\includegraphics[width=\textwidth,angle=0]{images/eight_Gauss_new.png}
\end{minipage}
\caption{ Figure-eight knot (left) and its unit velocity map (right). }
\label{fig:figure-eight}
\end{figure}

\begin{figure}
\centering
 % [trim = {left, bottom, right, top}, clip]
 \begin{minipage}[t]{0.4\textwidth}
\includegraphics[width=\textwidth]{images/trefoil0015.png}
\end{minipage}
 \begin{minipage}[t]{0.4\textwidth}
\includegraphics[width=\textwidth,angle=0]{images/trefoil_Gauss_new.png}
\end{minipage}
\caption{Trefoil (left) and its unit velocity map (right). }
\label{fig:trefoil}
\end{figure}

\subsection{Total torsion of a non-Frenet curve}
\label{sec:NonFrenet}
% \cAC{In this example we compute the total torsion of a regular closed space curve with a singular (infinitely oscillatory) Frenet--Serret frame.  Note that the mod-\(2\pi\) total torsion (and the writhe) as discussed in [the prev section] only requires the curve to be regular, namely \(\partial_t\gamma(t)\neq 0\).  In particular, the curve does not need to possess a regular Frenet torsion.  A smooth regulr curve without a regular Frenet--Serret frame is called a non-Frenet curve.  See [Olli\&Ulrich Sec 5.6] for a detailed discussion.  Consider the following example of a smooth non-Frenet closed space curve...(eq)}

In this example we compute the total torsion of a \sttext{smooth} \rev{regular closed} space curve with a singular (infinitely oscillatory) Frenet--Serret frame. \rev{Note that the mod-\(2\pi\) total torsion \eqref{eq:def_total_torsion} and the writhe only require the curve to be regular \ie, \(\partial_t\gamma(t)\neq 0\).  In particular, the curve does not need to possess a regular Frenet torsion.}
% \cAC{Yes, I like the ``--'' dash between two names.  I think there were some ``Gauss-Bonnet'' that should be using the ``--'' dash.}\cSI{Ok, I'll fix them later.} 
\sttext{Such a} \rev{A smooth} regular curve without a regular Frenet--Serret frame is called a non-Frenet curve \rev{(See \mbox{\cite[Ch.\@ 1 Sec.\@ 5.6]{PinkallGross2024geometry}} for a detailed discussion)}. Consider the \rev{following 
example of a smooth non-Frenet closed} space curve
\begin{align*}
    \gamma(t')=\frac{1}{e^{-2 t'^2}+t'^2}\left(e^{-t'^2} \cos \left(e^{t'}\right), e^{-t'^2} \sin \left(e^{t'}\right), t'\right), 
\end{align*}
where \(t'\in [-\infty,\infty)\) is a reparametrization of \(t\in [0,2\pi)\) by \(t'=\tan\left( \frac{t-\pi}{2}\right)\).
The spherical curve \(\gamma'\) traced out by the unit velocity displays an exponential spiral about \(t=\pi\) with an infinite turning number 
\sttext{(See Figure 7)} and an unbounded geodesic curvature 
\rev{(\autoref{fig:spiral_frenet})}\sttext{(which is the Frenet torsion of the original space curve}.
% \rev{For details, see \mbox{\cite[Ch.\@ 5 and Sec.\@ 5.6]{PinkallGross2024geometry}})}. 
%   \cSI{"Turning number" for a space curve is uncommon. So should we say that instead "with infinite rotations" or give a definition? Also I couldn't find the expression "Frenet torsion" on the internet or in [Gross and Pinkall]. Should we just say "torsion"? }
\sttext{Note that despite the spiral, the signed area enclosed by $\gamma'$ is bounded, giving rise to a well-defined total torsion.}
% \rev{Although the curve $\gamma'$ is spiraling infinitely many times around a point, the area enclosed by the velocity curve $\gamma'$ is bounded, and hence the total torsion of $\gamma$ is finite.}
\rev{Note that the total Frenet torsion of \(\gamma\) is the total turning angle of the spherical curve \(\gamma'\), which is divergent.  Despite the divergence of the total Frenet torsion, the mod-$2\pi$ torsion is well-defined since the area enclosed by \(\gamma'\) is bounded.}
% \cAC{... with an infinite turning number and an unbounded geodesic curvature (\autoref{fig:spiral_frenet}).  Note that the total Frenet torsion of \(\gamma\) is the total turning angle of the spherical curve \(\gamma'\), which is divergent.  Although the total Frenet torsion diverges, the \(2\pi\)-modulo \(\operatorname{Torsion}(\gamma)\) [ref to the previous 2pi-area eq] is well-defined, since the area enclosed by \(\gamma'\) is bounded.}

\begin{figure}[h]
 % [trim = {left, bottom, right, top}, clip]
 \begin{minipage}[h]{0.32\textwidth}
\includegraphics[width=\textwidth]{images/inf_spiral_raw.png}
\end{minipage}
 \begin{minipage}[h]{0.32\textwidth}
\includegraphics[width=\textwidth,angle=0]{images/infinite_spiral_Gauss.png}
\end{minipage}
 \begin{minipage}[h]{0.32\textwidth}
\includegraphics[width=\textwidth,angle=0]{images/inf_spiral_zoom_0002.png}
\end{minipage}
\caption{ A curve with a spiral Frenet-Serre frame (left), its unit velocity map (middle), and the close-up view of the spiral (right).}
\label{fig:spiral_frenet}
\end{figure}

\sttext{The classical Gauss--Bonnet formula (1.1, 1.2) is unusable for evaluating this spherical area.  Evaluating the classical formula is equivalent to sampling and summing the Frenet torsion (exterior angle of the spherical polygon). The process produces a result that diverges as $n\to \infty$ (Figure 4, right). }
\rev{In this example, it is crucial to avoid the classical angle--based formula (\ref{eq:GB_formula} \ref{eq:exterior_angle1}) for evaluating \(\Area(\gamma')\) due to the divergent turning angle in \(\gamma'\).  In fact, evaluating the total torsion using the classical formula is equivalent to sampling and summing the Frenet torsion (exterior angle of the spherical polygon \(\gamma'\)).  The process produces a result that diverges as the number of sample points \(n\to\infty\) (\figref{fig:plot_cardioid_Frenet_spiral}, right).}
In contrast, our formula \eqref{eq:FinalAreaFormula} is able to robustly evaluate the total torsion of this non-Frenet curve. 
% \cAC{In this example, it is crucial to avoid the classical angle-based formula [eq ref] for evaluating \(\Area(\gamma')\) due to the divergent turning angle in \(\gamma'\).  In fact, evaluating the total torsion using the classical formula is equivalent to sampling and summing the Frenet torsion (exterior angle of the spherical polygon \(\gamma'\)).  The process produces a result that diverges as the number of sample points \(n\to\infty\) [figref,right]. In contrast, our formula [eqref] is able to robustly evaluate the total torsion of this non-Frenet curve.}

\subsection{Area of a region on the earth}
\color{black}
\begin{wrapfigure}{hr}{0.3\textwidth}
  \centering
    \includegraphics[width=0.3\textwidth]{images/austria_clip_greyBG.jpg}
  \caption{\rev{Austria plotted on the sphere.}}\label{fig:austria}
\end{wrapfigure}
The next example applies to geography.
We compute an approximate area of Austria using the data from the Database of Global Administrative Areas (GADM) \cite{areas2012gadm}.
The data contains a sequence of latitudes and longitudes (\figref{fig:austria}) forming a spherical polygon. We treat the earth as a round sphere while acknowledging that we neglect its slight ellipsoidal figure and terrains. 

 The solid angle value we computed via our formula was $2.06206\times 10^{-3}$ on the unit sphere. By multiplying the square of the arithmetic mean radius $R\coloneqq (2R_E + R_P)/3\approx 6,371 \operatorname{km}$ \mbox{\cite{Moritz1980geodetic}}, where $R_E, R_P$ are the equatorial and polar radii, we obtain $83,882 \operatorname{km}^2$, which is a descent approximation of the official area $83,871 \operatorname{km}^2$ with  $0.013\%$ relative error. 
\color{black}

% \begin{figure}[htbp]
%  % [trim = {left, bottom, right, top}, clip]
%  \begin{minipage}[t]{0.45\textwidth}
% \includegraphics[width=\textwidth]{images/austria_sphere_greyBG.jpeg}
% \end{minipage}
%  \begin{minipage}[t]{0.45\textwidth}
% \includegraphics[width=0.8\textwidth,angle=0]{images/austria_clip_greyBG.jpg}
% \end{minipage}
% \caption{\cSI{I made another version. Let's keep this or \figref{fig:austria}}}
% \end{figure}
\rev{
\subsection{Solid angle fields and Seifert surfaces}
Our last example demonstrates the construction of the solid angle fields of given space curves (Section~\ref{sec:Introduction}).  
We consider three rectangular loops linked into the topological configuration of Borromean rings (\figref{fig:solidangle}).
Let \(\tilde\gamma\colon\bigsqcup^3\SS^1\to\RR^3\) denote this triplet of space polygons. 
For each point \(\bx\in\RR^3\setminus\tilde\gamma\), we let \(\Omega(\bx)\) be half the solid angle subtended by \(\tilde\gamma\) at \(\bx\).  Explicitly, consider the spherical curves \(\gamma^\bx\colon
{\textstyle\bigsqcup^3\SS^1}\to\SS^2\) given by projecting \(\tilde\gamma\) on the unit sphere centered at \(\bx\): 
\begin{align}
    \gamma^\bx(s) \coloneqq \frac{\tilde \gamma(s)-\bx}{|\tilde \gamma(s)-\bx|},\quad s\in {\textstyle\bigsqcup^3\SS^1}.
\end{align}
The solid angle field \(\Omega\colon\RR^3\setminus\tilde\gamma\to\RR/(2\pi\ZZ)\) is defined by
\begin{align}
    \Omega(\bx)\coloneqq\frac{1}{2}\Area(\gamma^\bx).
\end{align}
Note that the projected spherical curve \(\gamma^\bx\) is degenerate for \(\bx\) on any extended tangent line of \(\tilde\gamma\).  Despite this unavoidable degeneracy, our formula robustly handle the solid angle computation for all \(\bx\) (\figref{fig:solidangle}, left). By extracting a levelset of the solid angle field, we construct a smooth Seifert surface (\figref{fig:solidangle}, right).
%  We composed the Borromean rings $\tilde\gamma=\{\tilde\gamma_i\}_{i=1}^3$ with three rectangular knots. For each spatial point $x\in \RR^3 \setminus \tilde\gamma$, we build spherical polygons $\gamma^x=\{\gamma_i^x\}_{i=1}^3$ by projecting each $\tilde \gamma_i$ onto the unit sphere centered at $x$, that is,
% \begin{align*}
%     \gamma_i^x(s)=\frac{\tilde \gamma_i(s)-x}{|\tilde \gamma_i(s)-x|}.
% \end{align*}
% The definition of solid angle generalizes to the set of enclosed areas $\Gamma^x=\{\Gamma_i^x\}_{i=1}^3$ of each $ \gamma^x$ by
% \begin{align*}
%   \operatorname{Area}(\Gamma^x)=  \sum_i \operatorname{Area}(\Gamma_i^x) \in \RR / (4\pi \ZZ),
% \end{align*}
% and the solid angle field at $x$ is given by $\operatorname{Area}(\Gamma^x)/2\in \RR/(2\pi \ZZ)$. 
% Notice that the spherical curve $\gamma$ at some spatial points is very degenerate. When a point $x\in \RR^3 \setminus \tilde\gamma$ and an edge of the rectangles $\tilde\gamma$ lie on the same line in $\RR^3$, all the points on the edge accumulate at a point on the unit sphere centered at $x$. Our formula can still robustly compute the solid angles (\figref{fig:solidangle}, left). By extracting a levelset of the solid angle field, we can construct a Seifert surface (\figref{fig:solidangle}, right).
}
\begin{figure}
\centering
 \begin{minipage}[htbp]{0.48\textwidth}
\includegraphics[width=\textwidth, trim = {100, 0, 100, 0}, clip] {images/solidangle_field.png}
\end{minipage}
 \begin{minipage}[htbp]{0.48\textwidth}
\includegraphics[width=\textwidth, trim = {100, 0, 100, 0}, clip] {images/seifert.png}
\end{minipage}
\caption{\rev{The solid angle field of the Borromean rings visualized on the $z=0$ plane (left) where each color corresponds to a value in $\SS^1$. A levelset of the solid angle field in $\RR^3$ is a Seifert surface (right).} }
\label{fig:solidangle}
\end{figure}

\section*{Concluding remark and outlook}
In this paper, we derived area formulae using Green's theorem on prequantum bundles \(\SS^3\) and \(\SO(3)\) over \(\SS^2\). 
%\rev{They generalize the classical angle-based formula by giving $\SS^1$-degree of freedom to each point on $\SS^2$.}
\rev{These formulae avoid relying on angle calculation, unlike the classical formula  that fails on degenerate cases.}
As \sttext{this}\rev{the prequantum} version of Green's theorem is available for any compact symplectic manifold \rev{(Remrak \ref{rmk:existence_prequantum_bundle})}, one may investigate area formulae or integral of symplectic form of polygons in other manifolds.
% \rev{In particular, every closed and oriented surface with any area form is prequantizable  (Remrak \ref{rmk:existence_prequantum_bundle}) while finding an explicit expression of the area formula for a given surface is an open question.}

For example, in quantum information; \rev{the complex projective space} \(\CC\PP^{2^n-1}\)
is regarded as the space of possible states of \(n\)-qubits \cite{bengtsson_zyczkowski_2006} and a closed path is a periodic orbit. We hope that finding an explicit expression of its \sttext{surface area}\rev{enclosed area (geometric phase)} may lead to practical applications in quantum computation.

\appendix

\section{Prequantum bundles \(\SS^3\) and \(\SO(3)\) over \(\SS^2\) }\label{appendix:proof_of_prequantum_bundles}


\begin{proof}[Proof of  \propref{prop:HopfPrequantum}]
In terms of the quaternion coordinate, the area form of \(\SS^2\) is written as
\begin{align*}
    \sigma = -{1\over 2}\Re( p\Im(dp\wedge dp)).
\end{align*}
On the other hand,
    the differential of \(\pi = q\ii\conj q\) is
    \(d\pi = dq\ii\conj q + q\ii d\conj q\).
    Hence, the pullback area form is computed as
    \begin{align*}
        \pi^*\sigma &= -{1\over 2}\Re(\pi\Im(d\pi\wedge d\pi))
        = -{1\over 2}\Re(q\ii\conj q\Im(d\pi\wedge d\pi)) \\
        &= -{1\over 2}\Re(\ii\conj q\Im(d\pi\wedge d\pi)q) = -{1\over 2}\Re(\ii \Im(\conj qd\pi\wedge d\pi q))
        \\
        &=-{1\over 2}\Re\left(
        \ii\Im((\conj qdq\ii\conj q+\ii d\conj q)\wedge (dq\ii + q\ii d\conj qq))
        \right)\\
        & =-{1\over 2}\Re(\ii\conj q dq\ii\wedge\conj qdq\ii +\ii dq\wedge d\conj q - \ii d\conj q \wedge dq -d\conj q q\ii\wedge d\conj q q),
    \end{align*}
    which agrees with
    \begin{align*}
        d\alpha =
        -2\Re(dq\wedge \ii d\conj q).
    \end{align*}
    Here, we have applied   \(d\conj q q = d|q|^2-\conj qdq = -\conj qdq\), which holds on \(\SS^3\) where \(|q|^2 = 1\).
    
\end{proof}

 \begin{proof}[Proof of  \propref{prop:SO3Prequantum}]
Let \(V,W \in \mathfrak{so}(3)\), and \(\omega=(\omega_1,\omega_2,\omega_3)\), \(\nu=(\nu_1,\nu_2,\nu_3)\) be their coefficients with respect to the standard basis of \(\mathfrak{so}(3)\) as in \secref{sec:derivation_classical_formula}. For \(PV, PW \in T_P \SO(3)\) on each \(P\in \SO(3)\), we have,
\begin{align*}
    d\eta |_P(PV,PW)=-\eta |_P([PV,PW])=-\eta |_I ([V,W])=\nu_2 \omega_3 - \omega_2 \nu_3,
\end{align*}
due to the left-invariance of the vector fields \(PV, PW\) under \(\SO(3)\). Here \([\cdot,\cdot]\) denotes the Lie bracket.  Now we compute \(\pi_2 ^* \sigma\). Let us write \(W, V\) and \(P\) column-wise as \(W=(w_1 w_2 w_3), V=(v_1 v_2 v_3)\), and \(P=(p_1 p_2 p_3)\). We have,
\begin{align*}
    \pi_2^* \sigma|_P(PV,PW)
    &=\sigma|_{p_1} (d\pi_2 (PV), d\pi_2 (PW))
    =\sigma|_{p_1} (P v_1, Pw_1 )\\
    &= \sigma|_{\ii} (v_1, w_1)
    = dy \wedge dz (v_1, w_1)
    = \nu_2\omega_3 -  \omega_2 \nu_3 ,
\end{align*}
where we used the invariance of \(\sigma\) under \(\SO(3)\) and the expression of \(\sigma\) using the Cartesian coordinates. 
    \end{proof}

\rev{
\section*{Acknowledgments}
The authors acknowledge anonymous referees for their reviews and insightful suggestions, and Chris Wojtan for his continuous support through discussions. The second author thanks Anna Sisak for a fruitful discussion on prequantum bundles. This project was funded in part by the European Research Council (ERC Consolidator Grant 101045083 \emph{CoDiNA}) and the National Science Foundation CAREER Award 2239062.
}
% \cSI{Guidline("https://www.siam.org/Portals/0/Macros/Standard/docsiamart.pdf") says the acknowledgement should come after appendix and before references.}

% \newpage
\bibliographystyle{siamplain}
\bibliography{references}

\end{document}

%!TEX root = main.tex


\subsection*{Proof of \cref{lemma::balancedExpansionStrictlyReducibleExist}}
For the proof we use a structural lemma provided by Casel et al.~\cite{DBLP:conf/esa/Casel0INZ21} for potential vertices of a strictly reducible pair with additional properties for the unincluded vertices.
For a better understanding, it is convenient to think by an assignment function $g \colon \B \times A \to \N_0$ on flows, which sends fractional vertex-parts of components $\B$ to $A$.
For $g$ we define $\overrightarrow{\B}_a :=\left\{C \in \B \mid g\left(C,a\right) > 0 \right\}$ for $a \in A$, $\overrightarrow{\B}_{A'} := \bigcup_{a \in A'} \overrightarrow{\B}_a$ for $A' \subseteq A$ and $\overrightarrow{\B}_U :=\left\{C \in \B \mid \sum_{a \in A} g\left(C,a\right) < |C| \right\}$.

\begin{definition}[fractional balanced expansion]
	\label{definition::fbe}
	Let $G=\left(A \cup B, E\right)$ be a graph, where for each component $C \in \B$ we have $|C| \leq W$. 
	For $q \in \N_0$, a partition $A_1\cup A_2$ of $A$ and $g \colon \B \times A \to \N_0$, the tuple $\left(A_1,A_2,g,q\right)$ is called \emph{fractional balanced expansion} if:
	\begin{enumerate}
		\item for all $C \in \B$ and $a \in A$, if $g(C,a) \ne 0$, then $a \in N(C)$,
		\item $\sum_{C \in \B} g\left(C,a\right)\, \begin{cases}\geq \ q, & a\in A_1\\ 
			\leq \ q, & a\in A_2\end{cases}$  
		\item $\forall C \in \B \colon \sum_{a \in A} g\left(C,a\right) \leq |C|$ %(capacity)
		\item  $N\left(\overrightarrow{\B_U} \cup \overrightarrow{\B}_{A_1}\right) \subseteq A_1$
	\end{enumerate}
\end{definition}

The vertices $A_1$ in a fractional balanced extension correspond to the head vertices, and the question we are interested in is when they are nonempty. 

\begin{lemma}[\cite{DBLP:conf/esa/Casel0INZ21}, Lemma~4]
	\label{lemma::balancedExpansionReducibleExist}
	Let $G=\left(A \cup B, E\right)$ be a graph, where for each $C \in \B$ we have $|C| \leq W$ and no $C \in \B$ is isolated, i.e., $N(C) \neq \varnothing$.
	For every $q \in \N_0$, if $w(B) \geq q|A|$, then there exists a fractional balanced expansion $\left(A_1,A_2,g,q\right)$ with $A_1 \neq \varnothing$. 
\end{lemma}

Equipped with \cref{lemma::balancedExpansionReducibleExist} we can prove \cref{lemma::balancedExpansionStrictlyReducibleExist}, i.e., the existence of a strictly reducible pair with respect to the vertex-size. 

\paragraph{\textbf{\textbf{Proof of \cref{lemma::balancedExpansionStrictlyReducibleExist}:}}}
By the precondition of the lemma we obtain by \cref{lemma::balancedExpansionReducibleExist} the existence of a fractional balanced expansion $\left(A_1,A_2,g,2W-1\right)$ with $A_1 \neq \varnothing$ in $G$.
By the properties of the fractional balanced expansion we have $N\left(\overrightarrow{\B}_U \cup \overrightarrow{\B}_{A_1}\right) \subseteq A_1$
and $\sum_{b \in B} g\left(C,a\right) \geq 2W-1$ for all $a \in A_1$.
That is, $(A'=A_1, B' = \bigcup_{C \in \B_U \cup \overrightarrow{\B}_{A_1} } C)$ is a reducible pair.
Since $\sum_{C \in \B} g\left(C,a\right) \leq 2W-1$ for all $a \in A_2$ and no $C \in \B$ is isolated, we have
\begin{align*}
    |B| - \sum_{a \in A_2} \sum_{C \in \B} g(C,a) &\geq |A|(2W-1) + 1 - |A_2| (2W-1)\\
    &= |A_1|(2W-1)+1.
\end{align*}
Thus, either there is already an $a \in A_1 = A'$ with $\sum_{C \in  \B} g\left(C,a\right) \geq 2W$, or $\overrightarrow{\B_U} \neq \varnothing$ and we can assign one more unit of $\overrightarrow{\B}_U$ to a vertex of $A_1 = A'$ which has a component $C \in \overrightarrow{\B_U}$ in its neighborhood.
This in turn shows that $(A',B')$ is a strictly reducible pair.


\subsection*{Proof of \cref{lemma::firstStepOptLP}}
\begin{proof}
Let $\P$ be a population with $0^n \in \P$.
Let $s \geq 0$ be the largest integer that denotes a sample $X^s$ in $\P$ with $|X^s_1| = s$ and $\lpPrim(G) = \lpPrim(G[u(X^s)]) + |X^s_1|$.
Note that $X^0=0^n$.
By \cref{corollary::paretoOptLP} the tuple $(|X^s_1|,*,\lpPrim(u(X^s)))$ is pareto optima, i.e., $s$ can never decrease.
If there is an optimal fractional $W$-separator $\{y_v \in \R_{\geq 0}\}_{v \in u(X)}$ of $G[u(x)]$, such that $y_v<1$ for every $v \in u(X)$ then we are done.
Otherwise, there is a $v \in u(X)$ with $y_v=1$.
By \cref{lemma::onesInLPSameObjective} we obtain that $\lpPrim(G) = \lpPrim(G[u(X^s) \setminus \{v\}]) + |X^s_1 \cup \{v\}|$.
Thus, mutating $X^s$ by only flipping the according entry $v$ in $X^s$ results in a search point $X^{s+1}$.
By \cref{lemma::singleFlipAndBoundedPop} this event has probability $\Omega(1/n^3)$ in the algorithm \algGlobalSemoAlt, and happens at most $\opt$ times as $\lpPrim(G) \leq \opt$.
That is, $s \leq \opt$ and mutating $X^s$ to a search point $X^{s+1}$ happens after $\O(n^3)$ iterations in expectation.
Moreover, by \cref{lemma::zeroSol} the search point $0^n$ is in the population $\P$ after $\O(n^3 \log n)$ iterations in expectation. 
By using the method of fitness based partitions \cite{DBLP:conf/ppsn/Sudholt10}, the fact that a search point described in the lemma is not in $\P$ is upper bounded by $\O(n^3(\log n + \opt))$ iterations in expectation.
\end{proof}

\subsection*{Proof of \cref{lemma::ingredientParateo1}:}
As $|X_1| + \lpPrim(G[u(X)]) = \lpPrim(G)$ we obtain by \cref{lemma::RedPairLPNoSequence} that $X_1 \cap B_i = \varnothing$ for every $i \in [m]$.
Remains to show that $A_i \subseteq X_1$ for every $i \in [m]$.

Let $(A,B)$ be a strictly reducible pair.
We define $\B_{\Tilde{A}} \subseteq \B$ for $\Tilde{A} \subseteq A$ as the components $\{C \in \B \mid N(C) \cap \Tilde{A} \neq \varnothing\}$. 
Assume $A_j$ is a set with $A_j \subsetneq X_1$ for $j \in [m]$, where $A_i \subseteq X_1$ for $i \in [j-1]$.
Let $g$ be an assignment function like in \cref{def::RedPair} for $(A_j,B_j)$.
Since no vertex of $B_j$ is in $X_1$, the vertices $A_j' = A_j \setminus X_1$ along with $B_j' = \bigcup_{C \in \B_{A_j'}} C$ have to be in $u(X)$ as every $a \in A_j'$ satisfies $\sum_{C \in \B_{A_j'}} g(C,a) \geq 2W-1$.
Note that if $X_1 \cap B_j' = \varnothing$, then $\sum_{C \in \B_{A_j'}} g(C,a) \geq 2W-1$ for every $a \in A_j'$ implies that the every vertex $a$ is in a connected subgraph of size at least $W+1$ in $G-X_1$, which in turn implies that $A_j'$ and $B_{A_j'}$ are in $u(X)$.
Combining the fact $\bigcup_{i=1}^{j-1} A_i \subseteq X_1$ with \cref{lemma::CrownStaysCrown}  we obtain that there is a partition $\hat{A}_1, \dots, \hat{A}_p$ of $A_j'$ with disjoint vertex sets $\hat{B}_1, \dots, \hat{B}_p \subseteq \bigcup_{C \in \B_{A_j'}} C$, such that for each $\ell \in [p]$ the tuple $(\hat{A}_\ell,\hat{B}_\ell)$ is a minimal strictly reducible pair in $G[u(X)]$.
However, by \cref{lemma::onesInLPSameObjective} we have then $y_a=1$ for every $a \in A_j'$ contradicting the precondition of the lemma.

\subsection*{Proof of \cref{lemma::lowerBoundLP}}
\begin{proof}
	The fractional $W$-separator of $G[u(X)]$ with an objective value of $LP(G[u(X)])$ can be extended to a fractional $W$-separator of $G$ by the vertices $X_1$.
	Since this solution would be feasible for the linear program of the $W$-separator problem, we obtain the desired inequality.
\end{proof}


\subsection*{Proof of \cref{lemma::PackingSizeLargeEnough,lemma::decideWhichA,lemma::SizeNeoghborhood}}
To prove \cref{lemma::PackingSizeLargeEnough,lemma::decideWhichA,lemma::SizeNeoghborhood}, we recall some definitions and introduce new ones.
Let $(A,B)$ be a minimal strictly reducible pair with an assignment function $g$ (cf.~\cref{def::RedPair}).
We use $\B$ to denote the connected components of $G[B]$ as vertex sets.
Moreover, we define $\overrightarrow{\B}_a :=\left\{C \in \B \mid g\left(C,a\right) > 0 \right\}$ for $a \in A$, $\overrightarrow{\B}_{A'} := \bigcup_{a \in A'} \overrightarrow{\B}_a$ for $A' \subseteq A$ and $\overrightarrow{\B}_U :=\left\{C \in \B \mid \sum_{a \in A} g\left(C,a\right) < |C| \right\}$.
For a subset $\B' \subseteq \B$ we define $V(\B') := \bigcup_{C \in \B'} C$.
We abuse notation and use $N(\B')$ to denote $N(V(\B'))$.
For $A' \subseteq A$ we define $\B_{A'} := \{C \in \B \mid N(C) \subseteq A'\}$.

For the prove we also make use of directed graphs in the sense of flow networks, where we work with the well-known Ford-Fulkerson framework~\cite{ford1956maximal}.
We denote a network $H$ by $(V,\ora{E},c)$, where $V$ is its set of vertices, $\ora{E}$ is the set of arcs, and $c \colon \ora{E} \to \N$ its capacity function.
The main characteristic of a network is that its vertices contain $s$ and $t$, called the source and sink, respectively.
The source vertex is characterized by having only outgoing arcs, while the sink vertex has only incoming arcs.
We denote a flow by $Z$, i.e., $Z := \left\{z_{\ora{e}} \in \N_{\geq 0} \mid \ora{e} \in \ora{E}\right\}$.
A flow $Z$ is called feasible if $z_{\ora{e}} \leq c(\ora{e})$ for all $\ora{e} \in \ora{E}$ and if $\sum_{\ora{uv} \in  \ora{E}} z_{\ora{uv}} = \sum_{\ora{vw} \in  \ora{E}} z_{\ora{vw}}$ for all $v \in V \setminus \{s,t\}$.
Usually, the challenge is to find a feasible flow that sends as much flow as possible from $s$ to $t$, where the total flow value can be extracted from $\sum_{\ora{ut} \in \ora{E}} z_{\ora{ut}} = \sum_{\ora{sv} \in \ora{E}} z_{\ora{sv}}$.
The residual network $R = (V, \ora{E}')$ is defined with respect to a flow $Z$.
For our purposes, we can simplify its definition in comparison as it is usually known: for $z_{\ora{uv}} \in Z$ we have $\ora{uv} \in \ora{E}'$ if $c(\ora{uv}) - z_{\ora{uv}} > 0$ and $\ora{vu} \in \ora{E}'$ if $z_{\ora{uv}} > 0$.
An $s$-$t$-path in $R$ is called an augmenting path and gives the way how an $s$-$t$-flow with respect to $Z$ can be increased.  
It is a well-known result that if there is no $s$-$t$-path in $R$, then $Z$ is a maximum flow for $s$ and $t$. 

Mainly, we found new properties concerning minimal strictly reducible pairs which are useful for the proof of \cref{lemma::PackingSizeLargeEnough}.
One of them is that the particular vertex in $A$, which is guaranteed to have a larger mapping of fractional vertices from components in $\B$ over $g$, can be chosen arbitrarily.
To prove this, we construct two similar flow networks $H$ and $H_a$ for $a \in A$ with respect to $A, B$ and $g$, which we will call \emph{$g$-embedded flow networks}.
Basically, it describes the assignments from $\B$ to $A$ via $g$ with the advantage that we can make use of the properties provided by a flow network. 
For the proofs it is more convenient to reduce the assignments of each $a \in A$ that are given via $g$ arbitrary from $\oB_{a}$ so that we have $\sum_{C \in \B} g(C,a) = 2W-1$.
Now we describe the procedure getting the $g$-embedded flow network $H = \left(A \cup \B \cup \left\{s,t\right\}, \overrightarrow{E}, c\right)$.
We add the vertices $s,t$, $s$ as source and $t$ as sink, and arcs $\overrightarrow{E}$ with a capacity function $c\colon\overrightarrow{E} \to \mathbb{N}$ defined as follows:
connect every $C \in \B$ through an arc $\overrightarrow{sC}$ with capacity $|C|$ and connect every $a \in A$ through an arc $\overrightarrow{at}$ with capacity $2W-1$. 
Moreover, for every $C \in \B$ and $a \in A$ add an arc $\ora{Ca}$ to $\ora{E}$ if $a \in N(C)$ with capacity $|C|$.
Let $Z = \left\{z_e \in \N_0 \mid \ora{e} \in \ora{E} \right\}$ denote the flow values in $H$.
We embed now $g$ naturally in $H$.
For this, we set $z_{\ora{Ca}} = g(C,a)$ for every $a \in A$ and $C \in \B$.
To ensure now that the flow conversation is ensured for the vertices $V(H) \setminus \{s,t\}$ we set $z_{\ora{sC}} = \sum_{a \in A} g(C,a)$ for each $C \in \B$ and $z_{\ora{at}} = \sum_{C \in \B} g(C,a)$ for each $a \in A$.
It is not difficult to see that no arc capacity is violated and hence we have a feasible flow from $s$ to $t$ in $H$.
We denote by $F = |A|(2W-1)$ the total flow value $\sum_{a \in A} z_{\ora{at}}$.   
Note that we have $z_{\ora{at}} = 2W-1$ for each $a \in A$, which means that these arcs are \emph{saturated} as $c(\ora{at}) = 2W-1$ and therefore $Z$ is a maximum flow in $H$.

For $a \in A$ the flow network $H_a$ is basically the network $H$ with the difference that $c(\ora{at}) = 2W$.
We will accordingly denote the flow in $H_a$ by $Z^a = \left\{z^a_e \in \N_0 \mid \ora{e} \in \ora{E} \right\}$ and its flow value by $F_a$.
Note that this time we do not know, whether we have a maximum flow in hand as $\ora{at}$ is not saturated in $H_a$.

\begin{lemma}
	\label{lemma::flowEverywhere}
	Let $(A,B)$ be a minimal strictly reducible pair in $G$.
	Then, for every $a \in A$ the maximum flow from $s$ to $t$ in $H_a$ is $|A|(2W-1) + 1$.
\end{lemma}

\begin{proof}
	Recall by the definition of a strictly reducible pair that there is a $g$ that satisfy already $\sum_{C \in \B} g(C,a) \geq 2W -1$ for each $a \in A$ and for an $a' \in A$ even $\sum_{C \in \B} g(C,a') \geq 2W$.
	Basically, we want to show that this particular element in $A$ can be chosen arbitrarily if $(A,B)$ is a minimal strictly reducible pair.
	If this is not possible, then we will prove that there is a smaller strictly reducible pair $(A',B')$ with $A' \subset A$ and $B' \subseteq B$ contradicting the minimality of $(A,B)$.
	
	Consider the $g$-embedded flow networks $H$ and $H_a$ for each $a \in A$.
	For each $a \in A$ we search for an augmenting path in the residual graph of $H_a$ with respect to $Z^a$ (in the beginning $Z^a = Z$) from $s$ to $t$, or in other words, we will check, whether a larger maximum $s$-$t$-flow $F=|A|(2W-1)$ as in $H$ is realizable in $H_a$. 
	Observe that an augmenting path in $H_a$ with respect to $Z^a$ has to run through $\ora{at}$. 
	Let $A_1$ and $A_2$ be a partition of $A$, where for $a \in A_1$ the networks $H_a$ allow a greater total flow value from $s$ to $t$ than $H$, i.e., $F_a = F+1 = |A|(2W-1) + 1$.
	Note that if we would have $F_a = F+1$ for all $a \in A$, i.e., $A_1=A$, then the lemma holds and we are done.
	Moreover, note that $A_1 \neq \varnothing$, since %$(A,B)$ is a strictly reducible pair and 
	before reducing the assignments of $g$ for the embedding in $H$ there is a particular vertex $a \in A$ with $\sum_{C \in \B} g(C,a) \geq 2W$.
	
	Assume $A_1 \neq A$.
	We prove in this case that there is a strictly reducible pair $(A_1,B_1)$ with $B_1 \subset B$, which would contradict the minimality of $(A,B)$.
	Let $C' \in \B'$ be the components in $\B$, where for an $a_1 \in A_1$ we have $z^{a_1}_{\ora{Ca}} > 0$ in $Z^{a_1}$.
	If $N(C') \cap A_2 = \varnothing$ for all $C' \in \B'$, then $(A_1, \bigcup_{C' \in \B'} C')$ is a strictly reducible pair and we are done, since $N(\B') \subseteq A_1$ and we can generate a corresponding assignment function $\B' \times A_1 \to \N_0$ through the flows $Z^{a_1}$ for an arbitrary $a_1 \in A_1$.
	Note that $N(B) \subseteq A$ by the definition of a strictly reducible pair, which in turn means that $\bigcup_{C' \in \B'} C'$ has no neighbor outside $A$.
	Thus, we can assume that there is a $C' \in \B'$ with $N(C') \cap A_2 \neq \varnothing$, let us say $a_2 \in A_2$ is connected to $C'$.
	If $\sum_{a \in A} z_{\ora{C'a}} = \sum_{a \in A} g(C',a) = 0$, then $a_2$ cannot be in $A_2$ as $F_{a_2}=F+1$ is easily realizable as there is a augmenting flow path from $s$ to $t$ via $s,C',a_2,t$ in $H_{a_2}$, and $a_2$ would be in $A_1$.
	Let $a_1 \in A_1$ be a vertex with $z_{\ora{C'a_1}}>0$.
	Observe that the initial flow values $z_{\ora{Ca_1}}>0$ for $C \in \B$ in the network $H_{a_1}$, i.e., before augmenting flow in $H_{a_1}$, can only be decreased if we use the corresponding residual arc $\ora{a_1C}$ in a residual $s$-$t$-path $P$.
	But this cannot happen as $\ora{a_1t}$ is an arc in $P$, which means a residual arc $\ora{a_1C}$ cannot be part of the path $P$.
	From this, we obtain that $z^{a_1}_{\ora{C'a_1}} \geq z_{\ora{C'a_1}}>0$.
	For the following step observe that $z^{a_1}_{\ora{a_1t}} = 2W$ and $z^{a_1}_{\ora{at}} = 2W-1$ for all $a \in A \setminus \{a_1\}$.
	With these facts in hand we can easily transform $Z^{a_1}$ to a flow in $H_{a_2}$ with a total flow value of $F+1$ by subtracting one unit flow from $z^{a_1}_{\ora{C'a_1}}$ and $z^{a_1}_{\ora{a_1t}}$ and adding one unit of flow to $z^{a_2}_{\ora{C'a_2}}$ and $z^{a_2}_{\ora{a_2t}}$.
	However, this contradicts that $a_2 \in A_2$.
\end{proof}

From \cref{lemma::flowEverywhere} we can easily derive the correctness of the \textbf{\cref{lemma::decideWhichA,lemma::SizeNeoghborhood}}, which describes the new properties we found for minimal strictly reducible pairs.

To prove \cref{lemma::PackingSizeLargeEnough}, we use the procedure from \cite{DBLP:conf/esa/Casel0INZ21,DBLP:conf/iwpec/KumarL16} on how to find a ($W+1$)-packing of size $|A|$ in $G[A \cup B]$.
We refine this procedure with respect to the missing vertices of $A \cup B$ using \cref{lemma::flowEverywhere} and the augmenting flow properties of network flows.

\paragraph{\textbf{Proof of \cref{lemma::PackingSizeLargeEnough}:}}
%\begin{proof} 
To prove the lemma we will careful pack the vertices in $G[A \cup B] - S$ into connected subgraphs of size $W+1$, such that we obtain a $(W+1)$-packing of size $|A|-|S|+1$.
Let $(A,B)$ be a minimal strictly reducible pair in $G$.
We define for an assignment function $g \colon \B \times A \to \N_0$ an edge-weighted graph $G_g := (A \cup \B, E', w: E' \to \N_0)$, where $E' := \{aC \in A \times \B \mid g(C,a) > 0\}$ and $w_{Ca} = g(C,a)$ for every $Ca \in E'$.
First we demonstrate how a \emph{cycle canceling process} in $G_g$ works without changing the assignments from $\B$ to $A$, i.e., maintaining $\sum_{C \in N\left(a\right)} w_{Ca} = \sum_{C \in \B} g(C,a)$ for all $a \in A$, while ensuring $\sum_{a \in N\left(C\right)} w_{Ca} = \sum_{a \in A} g(C,a) \leq |C|$ for all $C \in \B$.
After that we demonstrate how the \emph{packing process} works to find a $(W+1)$-packing of size $|A|$ in $G[A \cup B]$.
Both processes was demonstrated identically already in~\cite{DBLP:conf/esa/Casel0INZ21,DBLP:conf/iwpec/KumarL16}.
We repeat the explanation of them because they are elementary to understand how we find our desired packing in $G[A \cup B]-S$ of size at least $|A|-|S|+1$.

Let $g$ be the assignment function of the minimal strictly reducible pair $(A,B)$.
Suppose there exists a cycle $Q \subseteq G_g$.
We pick an edge $Ca \in E'(Q)$ with minimum weight $\min_{Ca \in E\left(Q\right)} w_{Ca} = x$.
We remove $Q$ from $G_g$ as follows.
First, we reduce the weight of $w_{Ca}$ by $x$.
Then, traversing the cycle $Q$ from $C$ in direction of its neighbor that is not $a$, we alternate between increasing and decreasing the weight of the visited edge by $x$ until we reach $a$.
In the end we obtain at least one zero weight edge, namely $Ca$, and we remove all edges of weight zero from $G_g$. 
Since $G_g$ is bipartite, the number of edges in the cycle is even.
Thus, we will maintain the weight $\sum_{C \in N\left(a\right)} w_{Ca} = \sum_{C \in \B} g(C,a)$ for all $a \in A$ during this process.
Furthermore, we transfer weight on an edge incident to a $C \in \B$ to another edge, which in turn is also incident to this vertex $C$.
As a result, the condition $\sum_{a \in N\left(C\right)} w_{Ca} = \sum_{a \in A} g(C,a) \leq |C|$ for all $C \in \B$ is still satisfied.
We repeat this process until $G_g$ becomes a forest.
Moreover, if $w_{Ca} > 0$, then $a \in N(C)$ for every $C \in \B$ and $a \in A$, since $g(C,a) > 0$ leads to the same and we add no new edge to $G_g$. 

Next, we give the packing process, i.e., we show how to find the $(W+1)$-packing in $G[A \cup B]$ of size $|A|$ 
We transform accordingly the resulting weights back to a new assignment function $g' \colon \B \times A \to \N_0$ by setting $g'(C,a) = w_{Ca}$.
Note that $g'$ satisfies the condition of \cref{def::RedPair}, and that $G_{g'}$ is a forest.
Let $T$ be a tree in $G_{g'}$ rooted at an $a_r \in A$.
We have $\sum_{C \in \B} g'(C,a) \geq 2W-1$ for every $a \in A_1$ in the tree.
Since $G_{g'}$ is a bipartite graph, every child of $a \in A_1$ is in $C \in \B$ and vice versa.
Let $\B_T$ and $A_T$ be the vertices in $T$ of $\B$ and $A$, respectively.
We construct now the desired packing by mapping the elements of $\B_T$ to $A_T$.
Let $f \colon \B \to A$ be a function that describes for each $C \in \B_T$ to which $a \in A$ it belongs to. 
We set $f(C) = a$ for every $a \in A_T$ if $C \in \B_T$ is a child vertex of $a$.
Note that $a \in N(C)$ if $f(C) = a$.
Thus, for $a_r$ we obtain $\left|\bigcup_{C \in f^{-1}(a_r)} C \right| = \sum_{C \in \B} g'(C,a_r) \geq 2W-1$.
For all other vertices $a' \in A_T$ that are in the tree, we only lose its father vertex $C'$, which in turn has also a father $a'' \in A_T \setminus \{a\}$.
That is, $g'(C',a'') \geq 1$.
It follows that $g'(C',a') \leq |C| - 1 \leq W - 1$ for all those vertices and we obtain $\left|\bigcup_{C \in f^{-1}(a)} C \right| \geq \sum_{C \in \B} g'(C,a) - (W-1) \geq (2W-1)-(W-1) = W$ for all $a \in A_T \setminus \{a_r\}$.
We execute this process with all trees in $G_g$ and get our desired packing $\Q$ by setting each $Q_a = \{a\} \cup f^{-1}(a)$ for $a \in A$ as an element of it.

We know how to find a $(W+1)$-packing $\Q$ of size $|A|$ in $G[A \cup B]$ yet.
As a reminder, the properties for each $Q \in \Q$ are that $|Q| \geq W+1$ and $G[Q]$ is connected (\emph{pack properties}), and that the elements in $\Q$ are pairwise disjoint.
Our goal is now to find a $(W+1)$-packing in $G[A \cup B]-S$ of size at least $|A|-|S|+1$.
Observe by the disjointedness of $\Q$ that after removing $S$ from $\Q$ at most $|S|$ elements in $\Q$ can lose its pack properties and if this is exactly $|S|$, then every $s \in S$ has an exclusive $Q \in \Q$ where it is contained.
Otherwise, either we have ~$|S \cap Q| \geq 2$ for some $Q \in \Q$, or there is an $s \in S$ that has no intersection with an element in $\Q$. Consequently, the elements in $\Q$ containing no vertex from $S$ are at least $|\Q| - |S| + 1 = |A|-|S|+1$ many and form the desired packing satisfying the lemma.

We can assume that every $s \in S$ is contained in exactly one $Q \in \Q$.
Let $S_A = A \cap S$ and $S_B = B \cap S$.
Note by the precondition of the lemma that $S_B \neq \varnothing$ and $S_A \neq A$.
For $s \in S_B$ let $\B(s)$ denote the component in $\B$ where $s$ is contained.
Since every $s \in S$ is contained in a $Q \in \Q$, we can assume for $s \in S_B$ that $\B(s)$ occurs in one of the trees of $G_{g'}$ and therefore $\sum_{a \in A} g'(\B(s),a) > 0$ holds.
To get now the desired ($W+1$)-packing we use the properties of the root node $a_r$ while constructing $\Q$.
Recall that we have $\left|\bigcup_{C \in f^{-1}(a_r)} C \right| = \sum_{C \in \B} g'(C,a_r) \geq 2W-1$ and that we can fix a root node arbitrary from $A$.
Let $a' \in A$ be a vertex with $g'(\B(s'),a) > 0$, which exists as $\sum_{a \in A} g'(\B(s'),a) > 0$.
Let $\Q'$ be the $(W+1)$-packing after the packing process with $f' \colon \B \to A$ as the corresponding assignment where $a'$ is the root in one of the trees of $G_{g'}$.
We can assume that $a' \notin S$ and only $\B(s')$ contains a vertex of $S$ among the child vertices, as  otherwise, we have after the packing process an element $Q \in \Q'$ with $|S \cap Q| \geq 2$ and we are able to find the desired ($W+1$)-packing in $G[A \cup B]-S$. 
If $g'(\B(s'),a) < W$, we obtain $\left|\bigcup_{C \in f'^{-1}(a') \setminus \{\B(s')\} } C  \right|  = \sum_{C \in \B \setminus \{\B(s')\}} g'(C,a_r) \geq 2W-1-(W-1)=W$.
This in turn means that $\left( \{a'\} \cup \bigcup_{C \in f'^{-1}(a')} C \right) \setminus S$ satisfies the pack properties and we are able to construct the desired $(W+1)$-packing, because at most $|S|-1$ elements in $\Q'$ after removing the vertices of $S$ in $\Q'$ can violate the pack properties.

Thus, we can assume that $g'(\B(s'),a') = W$.
If $\sum_{C \in \B} g'(C,a') \geq 2W$, then we are done by the explanations above, since we have $\left|\bigcup_{C \in f'^{-1}(a') \setminus \{\B(s')\} } C  \right|  = \sum_{C \in \B \setminus \{\B(s')\}} g'(C,a_r) \geq 2W-W=W$.
If not, we create a valid assignment function $g''$ like in \cref{def::RedPair} with $\sum_{C \in \B} g''(C,a') \geq 2W$, where $G_{g''}$ is as forest and $\B(s')$ is adjacent to $a'$ in $G_{g''}$. 
For this, we construct a $g'$-embedded flow network $H_{a'}$.
By \cref{lemma::flowEverywhere} we know that there is an augmenting path from $s$ to $t$ and by the construction of $H_{a'}$ that has to cross the residual arc $\ora{a't}$.
This augmenting path $P$ cannot decrease the initial flow values $z^{a'}_{\ora{Ca'}}$ as an augmenting path need to use a residual arc $\ora{a'C}$ to do this, which would contradict that $P$ is a path as it has to use the arc $\ora{a't}$.
In particular, after extracting the resulting assignment function $\hat{g}$ from $Z^{a'}$, i.e., setting $\hat{g}(C,a) = z^{a'}_{\ora{Ca}}$ for all $a \in A$ and $C \in \B$, we have $\hat{g}(\B(s'),a') = W$.
Observe that due to $\sum_{C \in \B} \hat{g}(C,a') \leq |W|$ the vertex $\B(s')$ has degree one in $G_{\hat{g}}$.
That is, if we execute the cycle canceling process in $G_{\hat{g}}$ the vertex $\B(s')$ cannot be in any cycle of $G_{\hat{g}}$ during this process.
As a result, after extracting the resulting assignment function after the cycle canceling process this corresponds to the desired $g''$ where $\B(s')$ is adjacent to $a'$ in $G_{g''}$.


\subsection*{Proof of \cref{lemma::RedPairLPNoSequence}}

To prove \cref{lemma::RedPairLPNoSequence} we use the following property concerning LP's for the $W$-separator problem.

\begin{lemma}
	\label{lemma::partitionLP}
	Let $G=(V,E)$ be a graph and let $V_1,V_2$ be a partition of $V$.
	For every $W \in \N$ of the $W$-separator problem we have $\lpPrim(G) \geq \lpPrim(G[V_1]) + \lpPrim(G[V_2])$.
\end{lemma}    
\begin{proof}
	Let $\{y_v\}_{v \in V}$ be a fractional $W$-separator of $G$.
	For every connected subgraph $G'$ of size $W+1$ in $G[V_1]$ or $G[V_2]$ we have $\sum_{v \in V(G')} y_v \geq 1$. 
	Consequently, $\{y_v\}_{v \in V_1}$ and $\{y_v\}_{v \in V_2}$ are fractional $W$-separators of $G[V_1]$ and $G[V_2]$, which shows that the desired inequality holds.
\end{proof}

First, we give a relation of the LP-objective to a minimal strictly reducible pair $(A,B)$ in case of $B \cap X_1 \neq \varnothing$, which we will use to prove the main statement of this section.

\begin{lemma}
	\label{lemma::RedPairLPNoB}
	Let $(A,B)$ be an minimal strictly reducible pair in $G$ and let $X_1 \in \{0,1\}^n$ be a search point.
	If $X_1 \cap B \neq \varnothing$, then $\lpPrim(G(u[X])) + |X_1| > \lpPrim(G)$.
\end{lemma}
\begin{proof}
	Let $\oAB = V \setminus (\AB)$, $X_1^{\AB} = X_1 \cap (\AB)$ and $X_1^{\oAB} = X_1 \cap \oAB$.
	Note $\AB$ and $\oAB$ are a partition of $V$ as well as $X_1^{\AB}$ and $X_1^{\oAB}$ a partition of $X_1$.
	And recall that for every vertex bipartition $V_1,V_2$ of a graph $G'$ that $\lpPrim(G') \geq \lpPrim(G'[V_1]) + \lpPrim(G'[V_2])$ (cf.~\cref{lemma::RedPairLPNoB}).
	Moreover, observe that $\lpPrim(G[u(X)]) = \lpPrim(G - X_1)$.
	Thus, we have 
	\begin{align*}
		\lpPrim(G[u(X)]) + |X_1|
		&=\lpPrim(G-X_1) + |X_1|\\
		&\geq \lpPrim(G[\oAB] - X_1^{\oAB}) + \lpPrim(G[\AB] - X_1^{\AB}) + |X_1|\\
		&= \lpPrim(G[\oAB] - X_1^{\oAB}) + |X_1^{\oAB}| + \lpPrim(G[\AB] - X_1^{\AB})\\ 
        & \hspace{0.25cm} + |X_1^{\AB}|\\
		&\geq  \lpPrim(G[\oAB]) + \lpPrim(G[\AB] - X_1^{\AB}) + |X_1^{\AB}|,
	\end{align*}
	where the last inequality follows by \cref{lemma::lowerBoundLP}.
	By \cref{lemma::onesInLPReduciblePair} and \cref{lemma::onesInLPSameObjective} we obtain that $\lpPrim(G) = \lpPrim(G-A) + |A|$.
	Note that $\lpPrim(G-A) =  \lpPrim(G[\oAB])$ by the separation properties of $A$ and hence, if we can show that $\lpPrim(G[\AB] - X_1^{\AB}) + |X_1^{\AB}| > |A|$ we are done.
	Clearly, if $|X_1^{\AB}| > |A|$ there is nothing to prove.
	Assume $|X_1^{\AB}| \leq |A|$.
	Let $\{y_v \in \R_{\geq 0}\}_{v \in V}$ be an optimal fractional $W$-separator of $G[\AB] - X_1^{\AB}$.
	Because $B \cap X_1^{\AB} \neq \varnothing$ and $|X_1^{\AB}| \leq |A|$ we know by \cref{lemma::PackingSizeLargeEnough} that $G[\AB] - X_1^{\AB}$ contains a ($W+1$)-packing $\Q$ of size $|A| - |X_1^{\AB}| + 1$.
	This in turn means that $\lpPrim(G[\AB] - X_1^{\AB}) \geq |A| - |X_1^{\AB}| + 1$, since the elements in $\Q$ are pairwise disjoint and for each $Q \in \Q$ we have $\sum_{v \in Q} y_v \geq 1$ for any feasible fractional $W$-separator.
	In summary, we obtain
	\begin{align*}
		\lpPrim (G[u(X)]) + |X_1|  
		&\geq  \lpPrim(G[\oAB]) + \lpPrim(G[\AB] - X_1^{\AB}) + |X_1^{\AB}|\\ 
		&= \lpPrim(G - A) + \lpPrim(G[\AB] - X_1^{\AB}) + |X_1^{\AB}|\\
		&\geq \lpPrim(G - A) + |A| - |X_1^{\AB}| + 1 + |X_1^{\AB}|\\
		&= \lpPrim(G - A) + |A| + 1\\
		&= \lpPrim(G) + 1\\ 
		&> \lpPrim(G).
	\end{align*}
\end{proof}

We are ready to prove \cref{lemma::RedPairLPNoSequence}, which provides a relation of the LP-objective to a sequence of minimal strictly reducible pairs.

\paragraph{\textbf{Proof of \cref{lemma::RedPairLPNoSequence}}}
%\begin{proof}
	Let $A^i := \bigcup_{j=1}^i A_j$.
	By \cref{lemma::onesInLPReduciblePair} and \ref{lemma::onesInLPSameObjective} we have $\lpPrim(G - A^i) = \lpPrim(G - A^{i-1}) + |A_i|$ for every $i \in [m]$.
	Starting with 
	$\lpPrim(G) = \lpPrim(G - A^1) + |A_1|$ and stepwise substituting $\lpPrim(G - A^{i})$ for $i \in [m]$ yields 
	$$\lpPrim(G) = \lpPrim(G - A^m) + |A_1| + \dots + |A_m|.$$
	Thus, if $X_1 = \bigcup_{i=1}^m A_i$, then $\lpPrim(G) = \lpPrim(G[u(X)]) + |X_1|$ proving (\ref{enum::1}).
	
	Suppose $X_1 \cap B_\ell \neq \varnothing$.
	Observe that $|A_i| = \lpPrim(G[A_i \cup B_i])$ by \cref{lemma::onesInLPReduciblePair} and $\lpPrim(G[A_i \cup B_i] - A_i) = 0$.
	Hence, we obtain
	$$\lpPrim(G) = \lpPrim(G - A^m) + \lpPrim(G[A_1 \cup B_1]) + \dots + \lpPrim(G[A_m \cup B_m]).$$
	That is, to guarantee $\lpPrim(G(u[X])) + |X_1| = \lpPrim(G)$ we must have for every $i \in [m]$ that $\lpPrim(G[A_i \cup B_i] - X_1) + |X_1 \cap (A_i \cup B_i)| = \lpPrim(G[A_i \cup B_i])$.
	Note that to compensate $\lpPrim(G[A_i \cup B_i] - X_1) + |X_1 \cap (A_i \cup B_i)| > \lpPrim(G[A_i \cup B_i])$ we need for a $j \in [m] \setminus \{i\}$ that $\lpPrim(G[A_j \cup B_j] - X_1) + |X_1 \cap (A_j \cup B_j)| < \lpPrim(G[A_j \cup B_j])$, however, this is not possible as $\lpPrim(G[A_p \cup B_p] - X_1) + |X_1 \cap (A_p \cup B_p)| \geq \lpPrim(G[A_p \cup B_p])$ for all $p \in [m]$ by \cref{lemma::lowerBoundLP}.
	Finally, we have $\lpPrim(G[A_\ell \cup B_\ell] - X_1) + |X_1 \cap (A_\ell \cup B_\ell)| > \lpPrim(G[A_\ell \cup B_\ell])$ by \cref{lemma::RedPairLPNoB}, which proves (\ref{enum::2}).
%\end{proof}


\subsection*{Proof of \cref{lemma::CrownStaysCrown}}
\begin{proof}
    We define $V(\B_{A'}) \subseteq B$ for $A' \subseteq A$ as the vertices in the components $\{C \in \B \mid N(C) \cap A' \neq \varnothing\}$. 
	After removing $\hat{A}$ from $A$ and $V(\B_{\hat{A}})$ from $B$ we may derive from \cref{lemma::decideWhichA} that $\left(A \setminus \hat{A},B \setminus V(\B_{\hat{A}})\right)$ is a strictly reducible pair in $G-\hat{A}$.
	This in turn means that there exists a nonempty minimal strictly reducible pair with $A_1 \subseteq (A \setminus \hat{A})$ and $B_1 \subseteq B \setminus V(\B_{\hat{A}})$ in $G-\hat{A}$.
	Since $N(B_1) \subseteq A_1$, we can use similar arguments for $\hat{A}' = \hat{A} \cup A_1$ and $V(\B_{\hat{A}'})$ as for $\hat{A}$ and $V(\B_{\hat{A}})$ to obtain that there exists a minimal strictly reducible pair $(A_2,B_2)$ with $A_2 \subseteq A \setminus \hat{A}'$ and $B_2 \subseteq B \setminus V(\B_{\hat{A}'})$.
	Thus, we can continue this process until $\hat{A} \cup A_1 \cup A_2 \dots $ is equal to $A$.
\end{proof}


\subsection*{Proof of \cref{lemma::XReducedInPop}}
\begin{proof}
	Let $\P$ be a population with respect to $f_2$ in the algorithm \algGlobalSemoAlt.
	By \cref{lemma::firstStepOptLP} we have in expectation a solution $X$ in $\P$ such that $\lpPrim(G[u(X)]) + |X_1| = LP(G)$ and there is an optimal fractional $W$-separator $\{y_v \in \R_{\geq 0}\}_{v \in u(X)}$ of $G[u(X)]$ with $y_v<1$ for every $v \in u(X)$ after $\O(n^3(\log n + \opt))$ iterations.
	
	By \cref{lemma::ingredientParateo1} we have $A_i \subseteq X_1$.
	Observe that $|X_1| \leq \opt$ as $\lpPrim(G[u(X)]) + |X_1| = LP(G)$.
	The algorithm \algGlobalSemoAlt calls with $1/3$ probability the mutation that flips every vertex $X_1$ with $1/2$ probability in $X$.
	That is, reaching a state $X'$ from $X$ with $X'_1 = \bigcup_{i=1}^m A_i$ has probability $\Omega(2^{-\opt})$ and selecting $X$ in $\P$ has probability $\Omega(1/n^2)$.
	From this, in expectation it takes $\O\left(2^{\opt} n^2\right)$ iterations reaching $X'$ from $X$.
\end{proof}
%!TEX root = main.tex
 

\subsection*{Proof of \cref{lemma::apxIsSave}}

To prove \cref{lemma::apxIsSave} we make use of an optimal fractional $W$-separator.
Through such a solution it is possible to find at least one vertex that can be added to a potential $W$-separator with the desired objective value $c>\opt$. 
%The following lemma characterizes such a vertex.

\begin{lemma}
	\label{lemma::oneDividedByW}
	Let $X \in \{0,1\}^n$ be a search point.
	If $u(X) \neq \varnothing$, then any fractional $W$-separator of $G[u(X)]$ contains a vertex variable with value at least $1/(W+1)$.
\end{lemma}
\begin{proof}
	Let $Y = \{y_v \in \R_{\geq 0}\}_{v \in u(X)}$ be a fractional $W$-separator of $G[u(X)]$.
	Since $u(X) \neq \varnothing$, there is a connected subgraph $G'$ in $G[u(X)]$ with $W+1$ vertices.
	If every $y_v < 1/(W+1)$ for $v \in V(G')$, then $\sum_{v \in V(G')} y_v < 1$, which contradicts the feasibility of $Y$.
\end{proof}  

With \cref{lemma::oneDividedByW} in hand we characterize 0-bit vertices that can be added to potential $W$-separators without affecting the desired target value $c> \opt$.

\paragraph{\textbf{Proof of  \cref{lemma::apxIsSave}:}}
W.l.o.g.~let $X$ be a search point in $\P$ that minimizes $\lpPrim(G[u(X)])$ such that $|X_1| + (W+1) \cdot \lpPrim(G[u(X)]) \leq c$ (\emph{$c$-inequality}). 
If $u(X) = \varnothing$, then $X$ is a feasible $W$-separator with $\lpPrim(G[u(X)]) = 0$ and hence $|X_1| \leq c$.
Otherwise, by \cref{lemma::oneDividedByW} we have a $v \in u(X)$ with $y_v \geq 1/(W+1)$, where $\{y_v \in \R_{\geq 0} \}_{v \in u(X)}$ is a fractional $W$-separator according to the objective $\lpPrim(G[u(X)])$.
If we mutate $X$ by flipping $x_v$ to a search point $X'$, then we obtain $\lpPrim(G[u(X')]) \leq \lpPrim(G[u(X)]) - 1/(W+1)$ and $|X'_1| = |X_1| + 1$.
This implies that
\begin{align*}
	&|X'_1| + (W+1) \cdot \lpPrim(G[u(X')])\\ 
	&\leq |X_1| + 1 + (W+1) (\lpPrim(G[u(X)]) - 1/(W+1))\\
	&= |X_1| +  (W+1) \cdot \lpPrim(G[u(X)])\\
	&\leq c
\end{align*}  
Observe that by the choice of $X$ that $X'$ is not dominated by any other search point in $\P$ and that it can only be dominated by a search point $X''$ where the $c$-inequality holds with $\lpPrim(G[u(X'')]) \leq \lpPrim(G[u(X')])$.
When $X$ mutates to $X'$, the LP-objective of $f(X')$ is at least $1/(W+1)$ smaller than that of $f(X)$.
Since $\lpPrim(G[u(X)]) \leq \opt$, such an event happens at most $(W+1) \cdot \opt$ times.
For the fitness functions $f_2$ and $f_3$, selecting $X$ and flipping only $v$ in it has probability $\Omega(1/n^2)$ or $\Omega(1/n^3)$ in the algorithm \algGlobalSemo (cf.~\cref{lemma::singleFlipAndBoundedPop,corollary::singleFlipAndBoundedPop}), respectively.
By using the method of fitness based partitions \cite{DBLP:conf/ppsn/Sudholt10}, this results in a total expectation time of $\O(n^2 W \cdot \opt)$ or $\O(n^3 W \cdot \opt)$ having the desired search point in $\P$, respectively.


\subsection*{Proof of \cref{thm::approx}}
\algGlobalSemo have the search point $0^n$ in the population $\P$ after $\O(n^2 \log n)$ expected number of iterations (cf.~\cref{corollary::zeroSol}).
This search point satisfies already the precondition of \cref{lemma::apxIsSave} with $c=(W+1) \cdot \opt$, since $|0^n_1| + (W+1) \cdot \lpPrim(G) = (W+1) \cdot \lpPrim(G) \leq (W+1) \cdot \opt$.
That is, once $0^n \in \P$, the algorithms need in expectation $\O(n^2 W \cdot \opt)$ iterations having a search point in $\P$ that is a $(W+1)$-approximation. 
As a result, for both algorithms we have a desired search point in $\P$ after $\O\left(n^2 (\log n +  W  \cdot \opt)\right)$ iterations in expectation.


\subsection*{Proof of \cref{thm::ptas}}
Let $X \in \{0,1\}^n$ be a search point such that $G[u(X)]$ contains no minimal strictly reducible pair (\emph{irreducible-condition}).
Furthermore, let $S$ be an optimal solution of $G[u(X)]$ and let $U = u(X) \setminus S$.
Note that $|S| \leq \opt$.
Since $G[u(X)]$ contains no minimal strictly reducible pair, we have $|U| = |u(X)| - |S| \leq 2W|S| - |S| = |S|(2W-1)$ by \cref{lemma::existenceReducible}.

Recall that \algGlobalSemoAlt chooses with $1/3$ probability the mutation that flips every bit corresponding to the vertices in $u(X)$ with $1/2$ probability.
From this, the search point $X$ has a probability of $\Omega\left(2^{-(1-\varepsilon) |S| - (1-\varepsilon) |S| \cdot (2W-1) }\right) = \Omega\left(4^{-(1-\varepsilon) |S| \cdot W }\right)$ to flip $(1-\varepsilon) |S|$ fixed vertices of $S$ and to not flip $(1-\varepsilon) |S| \cdot (2W-1)$ fixed vertices of $U$ in one iteration.
Independently from this, half of the remaining vertices of $S$ and $U$ are additionally flipped in this iteration, i.e., $\frac{1}{2} \varepsilon |S|$ of $S$ and  $\frac{1}{2} \varepsilon |U|$ of $U$.
Let $S'$ and $U'$ be the flipped vertices in this iteration and let $X'$ be the according search point.
Note that $\lpPrim(X') \leq |S| - |S'|$ simply because there is a $W$-separator of $G[u(X)] - S'$ of size $|S| - |S'|$.
Hence, we have
\begin{align*}
	&|X'_1| + (W+1) \cdot \lpPrim(G[u(X')])\\
	& = |X_1| + |S'| + |U'| + (W+1) \cdot \lpPrim(G[u(X')])\\
	&\leq |X_1| + |S'| + |U'| +  (W+1) \cdot (|S| - |S'|)\\
	&= |X_1| + |S'| + |U'| + |S|(W+1) - |S'|(W+1)\\
	&= |X_1| + |S|(W+1) - |S'|W + |U'|.
\end{align*}
Next, we upper bound $|S'|$ and $|U'|$ in terms of $|S| \leq \opt$.
%Note that $|S| \leq \opt$.
Using the fact $|U| \leq |S| (2W-1)$, we obtain 
$|U'| = \frac{1}{2} \varepsilon |U| \leq \frac{1}{2} \varepsilon |S|(2W-1) = \varepsilon |S| W - \frac{1}{2} \varepsilon |S|$.
Regarding $S'$ we have
$|S'| = (1-\varepsilon)|S| + \frac{1}{2} \varepsilon |S| = |S| - \varepsilon |S| + \frac{1}{2} \varepsilon |S|$.
As a result, we obtain
\begin{align*}
	& |X'_1| + (W+1) \cdot \lpPrim(G[u(X')])\\
	& \leq |X_1| + |S|(W+1) - |S'|W + |U'|\\
	&\leq |X_1| + |S|(W+1) - (|S| - \varepsilon |S| + \frac{1}{2} \varepsilon |S|)W + \varepsilon |S| W - \frac{1}{2} \varepsilon |S|\\
	&\leq |X_1| + |S|(W+1) - |S|W + \varepsilon |S| W - \frac{1}{2} \varepsilon |S| W + \varepsilon |S| W - \frac{1}{2} \varepsilon |S|\\
	&= |X_1| + |S| + 2 \varepsilon |S| W - \frac{1}{2} \varepsilon |S| W -  \frac{1}{2} \varepsilon |S|\\
	&= |X_1| + |S| + |S|\left(2 \varepsilon W - \frac{1}{2} \varepsilon W  - \frac{1}{2} \varepsilon\right). 
\end{align*}
The next step is to distinguish between (\ref{thm::item1APX}) and (\ref{thm::item2APX}) in the theorem.
The difference is mainly in the selection of $X$ and the upper bounded size of the population $\P$ with respect to the fitness functions $f_2$ and $f_3$.
Note that the chosen $X$ needs to satisfy the irreducible-condition. 
Moreover, observe that once a desired $X$ is guaranteed to be in the population, an event described above occurs in expectation after  $\O\left(n^2 \cdot 4^{(1-\varepsilon) |S| \cdot W }\right)$ and $\O\left(n \cdot 4^{(1-\varepsilon) |S| \cdot W }\right)$ iterations for the fitness functions $f_2$ and $f_3$, respectively, where the probability of choosing $X$ due to population size makes the linear factor difference (cf.~\cref{lemma::singleFlipAndBoundedPop,corollary::singleFlipAndBoundedPop}).
\begin{enumerate}
	\item[(\ref{thm::item1APX})]
	Let $(A_1,B_1),\dots,(A_m,B_m)$ be a sequence of minimal strictly reducible pairs, such that $G-\bigcup_{i=1}^m A_i$ contains no strictly reducible pair. 
	By \cref{lemma::XReducedInPop} we have in expectation a search point $X$ in the population $\P$ with $X_1 = \bigcup_{i=1}^m A_i$ after $\O\left(n^3(\log n + \opt) + 2^{\opt}\right)$ iterations using the fitness function $f_2$.
	Note that $X$ satisfies the irreducible-condition.
	Moreover, $X$ is a pareto optimal solution by \cref{lemma::paretoOptiSol}.
	By \cref{thm::saveReduction} we have $|X_1| = \opt - |S|$.
	Moreover, recall that $|S| \leq \opt$.
	Thus, we obtain
	\begin{align*}
		&|X'_1| + (W+1) \cdot \lpPrim(G[u(X')])\\ 
		&\leq |X_1| + |S| + |S|\left(2 \varepsilon W - \frac{1}{2} \varepsilon W  - \frac{1}{2} \varepsilon\right)\\
		&= \opt - |S| + |S| + |S|\left(2 \varepsilon W - \frac{1}{2} \varepsilon W  - \frac{1}{2} \varepsilon\right)\\
		&\leq \opt + \opt\left(\frac{3}{2} \varepsilon W - \frac{1}{2} \varepsilon\right)\\
		&= \opt\left(1 + \varepsilon\left(\frac{3}{2}W - \frac{1}{2}\right)\right).
	\end{align*}
	As a result, by the choice of $X$ the resulting search point $X'$ satisfies the precondition of \cref{lemma::apxIsSave} with $c= \opt(1 + \varepsilon(\frac{3}{2}W - \frac{1}{2}))$.
	That is, once $X' \in \P$, the algorithm \algGlobalSemoAlt need in expectation $\O(n^3 W \cdot \opt)$ iterations having a search point in $\P$ which is a $(1 + \varepsilon(\frac{3}{2}W - \frac{1}{2}))$-approximation. 
	In summary, the desired search point $X'$ is in $\P$ after $\O\left(n^3(\log n + W \cdot \opt) + 2^\opt + n^2 \cdot 4^{(1-\varepsilon) \opt \cdot W} \right)$ iterations in expectation.
	
	\item[(\ref{thm::item2APX})]
	By \cref{lemma::ingredientParateo1,corollary::firstStepOptLP}, using the fitness function $f_3$, \algGlobalSemoAlt contains after $\O(n^2(\log n + \opt))$ iterations a search point $X \in \P$, such that $|X_1| + \lpPrim(G[u(X)]) = \lpPrim(G)$, and additionally, there is an optimal fractional $W$-separator $\{y_v \in \R_{\geq 0}\}_{v \in u(X)}$ with $y_v < 1$ of $G[u(X)]$ for all $v \in u(X)$.
	Since $y_v<1$ for all $v \in u(X)$, by \cref{lemma::onesInLPReduciblePair} we know that $G[u(X)]$ contains no strictly reducible pair.
	That is, $X$ satisfies the irreducible-condition.
	Furthermore, by  $|X_1| + \lpPrim(G[u(X)]) = \lpPrim(G)$ we have $|X_1| \leq \opt$.
	Thus, using the fact $|S| \leq \opt$ we obtain
	\begin{align*}
		&|X'_1| + (W+1) \cdot \lpPrim(G[u(X')])\\
		&\leq |X_1| + |S| + |S|\left(2 \varepsilon W - \frac{1}{2} \varepsilon W  - \frac{1}{2} \varepsilon\right)\\
		&\leq \opt + \opt + \opt\left(2 \varepsilon W - \frac{1}{2} \varepsilon W  - \frac{1}{2} \varepsilon\right)\\
		&= 2 \cdot \opt + \opt\left(\frac{3}{2} \varepsilon W - \frac{1}{2} \varepsilon\right)\\
		&= \opt\left(2 + \varepsilon\left(\frac{3}{2}W - \frac{1}{2}\right)\right).
	\end{align*}
	As a result, by the choice of $X$ the resulting search point $X'$ satisfies the precondition of \cref{lemma::apxIsSave} with $c= \opt(2 + \varepsilon(\frac{3}{2}W - \frac{1}{2}))$.
	That is, once $X' \in \P$, the algorithm \algGlobalSemoAlt need in expectation $\O(n^2 W \cdot \opt)$ iterations having a search point in $\P$ which is a $(2 + \varepsilon(\frac{3}{2}W - \frac{1}{2}))$-approximation. 
	In summary, the desired search point $X'$ is in $\P$ after $\O\left(n^2(\log n + W \cdot \opt) + n \cdot 4^{(1-\varepsilon) \opt \cdot W}\right)$ iterations in expectation.
\end{enumerate}
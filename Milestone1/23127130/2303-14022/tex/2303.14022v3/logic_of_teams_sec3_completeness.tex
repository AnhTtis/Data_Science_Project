%!TEX root = logic_of_teams.tex


\section{Completeness and adequacy}

Next we will prove the completeness of the proof system, but first we need some 
definitions and a few easy facts.

Observe that if $\Gamma \vdash \bot\of \bot$  then $\Gamma \vdash a\of \phi$
for all labels $a$ and all formulas $\phi$. We say that $\Gamma$ is
\emph{consistent} if $\Gamma \nvdash \bot\of \bot$ or equivalently that there
are $a$ and $\phi$ such that $\Gamma \nvdash a\of \phi$.

\begin{prop}\label{prop:max}
    If $\Gamma$ is consistent then so is either $\Gamma,a\of \phi$ or
    $\Gamma, a\of \lnot \phi$.
\end{prop}
\begin{proof}
    Directly by using the $\ni$ and $\ne$ rules.
\end{proof}

In the next proposition remember that if $a$ and $b$ are labels then $a=b$ denotes the labelled formula $a \leftrightarrow b : \itop$.

\begin{prop}\label{prop:resp}
    If $\Gamma,a\of \phi\ilor \psi$ is consistent and $p$ and $q$ are
    propositional variables not occurring in $\Gamma$, nor in $a$, then
    $\Gamma, a\of \phi\ilor \psi,p\of \phi,q\of \psi,a = p \lor q$ is
    consistent. And similarly for $\iland$.
\end{prop}
\begin{proof}
    Directly by using the $\ioe$ rule and the $\iae$ rule.
\end{proof}

\begin{defin}
    $\Gamma$ is \emph{$\ilor$-saturated} if whenever $a\of \phi\ilor
    \psi \in \Gamma$ then there are labels $b$ and $c$ such that $\set{b\of
    \phi,c\of \psi,a = b \lor c} \subseteq
    \Gamma$. The dual notion of \emph{$\iland$-saturation} is defined
    similarly. We say that $\Gamma$ is \emph{saturated} if it is both
    $\ilor$-saturated and $\iland$-saturated.
\end{defin}

% \begin{prop}
%     If $\Gamma$ is consistent then the set $T=\set{a | a\of  \itop \in \Gamma}$ of labels is
%     consistent in propositional logic as a set of propositional formulas.
% \end{prop}
% \begin{proof}
%         If $T$ is inconsistent then by  $\taut$ we get that $\Gamma \vdash
%         \bot \of  \ibot$ and so $\Gamma \vdash \bot\of \bot$ by $\bi$ and is thus
%         inconsistent.
% \end{proof}

\begin{lemma}
Let $\Gamma$ be a set of labelled formulas and $\Gamma'$ be the result of
renaming the atomic labels $p_i$ by $p_{2i}$. Then 
\begin{enumerate}
    \item $\Gamma$ is consistent iff $\Gamma'$ is, and
    \item $\Gamma$ is satisfiable iff $\Gamma'$ is.
\end{enumerate}
\end{lemma}
\begin{proof}
\begin{enumerate}
    \item 
    If $\Gamma \vdash \bot$ then the same derivation with all atomic labels
    renamed shows that $\Gamma' \vdash \bot$. On the other hand if $\Gamma'
    \vdash \bot$, there is a finite subset $\Gamma^f$ of $\Gamma'$ such that
    $\Gamma^f \vdash \bot$. By renaming the atoms $p_{2i}$ by $p_i$ and
    $p_{2i+1}$ by $p_{i+k}$ where $k$ is large enough, i.e., larger than all
    indices of atoms occurring in $\Gamma^f$, we see
    that $\Gamma \vdash \bot$.
    \item Given a Boolean algebra $B$ and homomorphisms $H$ and $h$
    such that $h(a) \in H(\varphi)$ for all $a:\varphi \in \Gamma$ we can
    define $h'$ by setting $h'(p_{2i}) = h(p_i)$ and $h'(p_{2i+1}) = \bot \in B$. Then
    $B,H,h'$ satisfies $\Gamma'$. Also, if $B,H,h$ satisfies $\Gamma'$ then
    clearly for $h'$ defined by $h'(p_{i})=h(p_{2i})$ we have that  $B,H,h'$ satisfies
    $\Gamma$.
\end{enumerate}
\end{proof}

\begin{thm}[Completeness]
    If $\Gamma \vDash a\of \phi$ then $\Gamma \vdash a\of \phi$.
\end{thm}
\begin{proof}
    Assume that $\Gamma \nvdash a\of \phi$. By Lemma \ref{lem:basicfacts} the
    set $\Gamma_0 =\Gamma,a\of \lnot \phi$ is consistent. We will extend it to
    a maximal consistent saturated set $\Gamma^\ast$. By applying the previous
    lemma we may assume that there are an infinite set of atomic labels that
    are not mentioned in $\Gamma_0$.

    We construct $\Gamma^\ast$ as the union of $\Gamma_n$ where each
    $\Gamma_n$ is a finite extension of $\Gamma_0$. First, we enumerate all
    labelled formulas and when constructing $\Gamma_{n+1}$ we pick the $n$:th
    labelled formula $b \of \psi$ and add either $b\of\psi$ or
    $b\of\lnot\psi$. By Proposition \ref{prop:max} one of these is consistent
    with $\Gamma_n$.

    By Proposition \ref{prop:resp} we can assure that if we add a labelled
    formula $b\of \sigma \ilor \theta$ then we also add $p\of \sigma$, $q\of
    \theta$ and $b= p \lor q$ for some new propositional variables $p$ and
    $q$, and keeping $\Gamma_{n+1}$ consistent. 
    This construction assures that $\Gamma^\ast$ is maximal consistent and
    saturated.

    Now, let $T=\set{a | a\of  \itop \in \Gamma^\ast}$. Let $B$ be the
    Lindenbaum--Tarski Boolean algebra of labels over $T$, i.e., its elements
    are equivalence classes of labels under the relation of $T$-provable
    equivalence: 
    \[
        B = \Lb / \mathord\sim_T = \set{[a]_T | a \in \Lb},
    \]
    where $a  \sim_T b $ iff $T \vdash a \leftrightarrow b$ (in classical
    propositional logic) and $[a]_T=\set{b \in \Lb | a \sim_T b}$. Observe
    that $B$ is the trivial one-element Boolean algebra iff $T$ is the
    inconsistent theory, i.e., iff $\bot \in T$.

    Define the homomorphisms $h: \Lb \to B$  and $H: \Fm \to \P B$ by
    \begin{gather*}
       h(a)=[a]_T \in B \text{ for atoms $a$, and}\\ H(\varphi) = \set{h(a) |
        a\of \varphi \in\Gamma^\ast} \text{ for atoms $\varphi$}.
    \end{gather*}

    {\sc Claim.} $h(a) \in H(\varphi)$ iff $a\of \varphi \in \Gamma^\ast$.

    The claim is proved by induction on formulas. The base case follows
    immediately from the definition of $H$ and the observation that 
    $$H(\ibot) =
    \{[\bot]_T\}. $$  This is seen by taking $h(b) \in H(\ibot)$ and observing
    that $b\of \ibot
    \in \Gamma^\ast$ and so $\lnot b \of \itop
    \in \Gamma^\ast$ and, thus, $\lnot b \in T$ and $b \in [\bot]_T$.
    \begin{itemize}
        \item 
    If $\varphi$ is $\psi \lor \sigma$, $\psi \land \sigma$ or $\lnot \psi$
    the induction step is straight-forward, as for example $a \of  \psi \land
    \sigma \in \Gamma^\ast$ iff $a\of \psi \in \Gamma^\ast$ and $a\of \sigma
    \in \Gamma^\ast$ and, by the induction hypothesis, this is equivalent to
    $h(a) \in H(\psi)$ and $h(a) \in H(\sigma)$, i.e., $h(a) \in H(\psi) \cap
    H(\sigma) = H(\psi
    \land \sigma)$.

\item 
    For the case when $\varphi$ is $\ilnot \psi$ note that $a \of  \ilnot \psi
    \in \Gamma^\ast$ iff $\lnot a \of \psi \in \Gamma^\ast$ iff $h(\lnot a)
    \in H(\psi)$ iff $\lnot h(a) \in H(\psi)$ iff $h(a) \in H(\ilnot \psi)$.

\item 
    When $\varphi$ is $\psi \ilor \sigma$ note that $a \of  \psi \ilor \sigma \in
    \Gamma^\ast$ iff there are labels $b$ and $c$ such that $b \of \psi \in
    \Gamma^\ast$, $c\of \sigma \in \Gamma^\ast$ and $a = b \lor
    c \in \Gamma^\ast$. By the induction hypothesis this is
    equivalent to $h(b) \in H(\psi)$, $h(c) \in H(\sigma)$ and $h(a) = h(b\lor
    c) = h(b) \lor h(c)$. Thus this is equivalent to $h(a) \in H(\psi \ilor
    \sigma)$.
\item 
    The case when $\varphi$ is $\psi \iland \sigma$ is treated similarly, ending the proof of the claim.
\end{itemize}
    It now follows immediately that for these choices
    of $B$, $H$, and $h$ we have $h(a) \in H(\varphi)$ for all $a\of\varphi \in
    \Gamma_0$ and thus $\Gamma \nvDash a\of\phi$.
\end{proof}

\begin{cor}
    The logic LT is compact.
\end{cor}
\begin{proof}
    Follows directly from soundness and completeness.
\end{proof}

\subsection{Canonical algebras}\label{sec:canonical}

The semantics of classical propositional logic can be defined both in terms of
the single two-element Boolean algebra or in terms of all Boolean algebras,
i.e., the two-element Boolean algebra is \emph{canonical} for propositional
logic. In LT the situation is a bit different as we will see.

We write 
\[
  X: \Delta \vDash \phi \quad\text{and}\quad B : \Delta \vDash \phi
\]
for the restricted version of the entailment relation where the quantification
is done over a set $X$ of Boolean algebras or a single Boolean algebra $B$. 
For example, $B: \Delta \vDash \phi$ iff for all homomorphisms $H:\Fm \to \P B$,
\[
    \bigcap_{\psi \in \Delta} H(\psi) \subseteq H(\phi).
\]

\begin{defin}
    A set $X$ of Boolean algebras is \emph{adequate} (for LT) if
    for every $\Delta$ and $\phi$ we have
    \[
    \Delta \vDash \phi \text{ iff } X:\Delta \vDash \phi.
    \] 
   % A single Boolean algebra $B$ is said to be \emph{canonical} if $\set{B}$
   % is adequate.
\end{defin}

We omit an empty theory and write $B : {} \vDash \phi$ instead of $B:
\emptyset \vDash \phi$. Let us make some observations:
\[
B: {} \vDash \ibot \text{ iff } B=1,
\] 
where $1$ is the trivial one-element Boolean algebra.  If $\phi$ has no
propositional variables then 
\[
B:{} \nvDash \varphi \text{ iff } B: {} \vDash \lnot\ibot \lor (\ibot \iland \lnot \phi).
\]
Thus, there is a $\psi$ such that
\[
 B: {} \vDash \psi \text{ iff } B \neq 1.
\]
Therefore, if $X$ is an adequate set of Boolean algebras then $1
\in X$.\footnote{Note that, if we add $\psi$ as an axiom we get a (sound
and) complete derivation system for the semantics restricted to non-trivial Boolean
algebras} We have a similar result for $B=2$: 
\[
B: {} \vDash \ibot \lor \itop  \text{ iff } B = 1,2,
\] 
where $\itop$ is $\ilnot\ibot$. Thus, if $X$ is adequate then $2 \in X$. And
so, if $X$ is adequate then $\{1,2\} \subsetneq X$. But, we can say more. Due
to the similarities of LT and HBML we can follow the procedure in
\cite{Goranko99} to observe that no set of finite Boolean algebras is
adequate. Interpreting the models of LT as Kripke frames, the operation
$\dwn$, defined in LT in section \ref{def.clos}, directly corresponds to the
`diamond' operation of the partial order $\leq$  of the underlying Boolean
algebra. For the equally definable dual box operation
$\Box\scriptscriptstyle{\leq}$, it then follows by an established result for
any extension of the modal logic S4, that \textit{Grzegorczyk's formula}
$$\textbf{Grz:
}\Box_{\scriptscriptstyle{\leq}}(\Box_{\scriptscriptstyle{\leq}}(P\to
\Box_{\scriptscriptstyle{\leq}} P)\to P)\to P $$ is valid on a partially
ordered Kripke frame if and only if it is finite.\footnote{It is fairly
straight-forward to see that \textbf{Grz} is falsifiable in a partially
ordered Kripke frame $F$ if and only if it is possible to choose a valuation
$V$ such that there is a $\leq$-sequence of points ${p_1\leq p_2 \leq \dots }$
such that satisfaction of the member-hood $p_i \in V(P)$ is infinitely
alternating. See \cite{Bull1984} for details.} Since LT can express this
formula, we can conclude that:
\begin{thm}
	The set of finite Boolean algebras is not adequate (for LT).
\end{thm} 
\iffalse 
 \marginpar{Swap this theorem to reference to Goranko}
\begin{thm}
    No finite set of finite Boolean algebras is adequate.
\end{thm}
\begin{proof}
    We prove this by investigating the formulas $\phi_n$ defined by recursion
    on $n$:
    \begin{align*}
        \phi_0 &= P \\
        \phi_{n+1}&= P \ilor \phi_{n}
    \end{align*}
    Now, if $H$ is a homomorphism then $H(\phi_n) \subseteq H(\phi_{n+1})$
    since the elements of $H(\phi_n)$ are all of the form $a_0 \lor a_1 \lor
    \ldots \lor a_n$, where $a_i \in H(P)$, and thus $a_0\lor a_0 \lor a_1
    \lor \ldots \lor a_n \in H(\phi_{n+1})$.

    Assume now that $H$ is a homomorphism into $\P B$ where $B$ is finite with
    $n$ elements. Then, since the sequence $H(\phi_0) \subseteq  H(\phi_1)
    \subseteq  \ldots$ is increasing and the number of elements of $\P B$ is
    $2^n$ we have $H(\phi_{2^n}) = H(\phi_{2^n+1})$.

    Therefore, if $X$ is a finite set of finite Boolean algebras then $X :
    \phi_{n+1}
    \vDash \phi_n$ for some large enough $n$. 

    However in the full logic LT, $\phi_{n+1} \nvDash \phi_n$  since if $B= \P\mathbb N$
    and $H(P) = \set{\{i\} | i \in \mathbb N}$ then $H(\phi_n)$ is the set of
    all (non-empty) sets with at most $n$ elements and thus $H(\phi_{n+1})
    \nsubseteq H(\phi_n)$ for all $n \in \mathbb N$.
\end{proof}
\fi

On the other hand, the completeness theorem gives us a set of Boolean algebras
that is adequate, the set of Lindenbaum--Tarski algebras. These are all
countable Boolean algebras.

\begin{thm}
    The set of finite and countable Boolean algebras is adequate.
\end{thm}
\begin{proof}
    The proof of the completeness theorem constructs a Boolean algebra $B$
    that is a Lindenbaum--Tarski algebra over a countably infinite set of
    propositional variables. Thus, if $\Gamma \nvdash a\of \phi$ there is
    $H:\Fm \to \P B$, where $B$ is a finite or countable Boolean algebra, such
    that $\bigcap_{\psi \in \Gamma} H(\psi) \nsubseteq H(\phi)$.
\end{proof}

% In fact, by analysing the construction in the proof of the completeness
% theorem and using the compactness of LT we may restrict ourselves to finite
% Boolean algebras:

% \begin{thm}\label{thm:finite_bas}
%     The set of finite Boolean algebras is adequate.
% \end{thm}
% Before proving this theorem we need the following lemma.

% \begin{lemma}
%     If $\Gamma$ is a finite consistent set of labelled formulas and $A$ the
%     set of atomic labels that occur in labels in $\Gamma$; then
%     there is a finite consistent set of labelled formulas $\widehat \Gamma
%     \supseteq \Gamma$ such that:
%     \begin{itemize}
%         \item If $a\of \lnot (\phi \ilor \psi) \in \widehat\Gamma$ and $b$ and
%         $c$ are labels with all propositional variables in $A$, then there are $a',b'$
%         and $c'$ such that $\vdash a \leftrightarrow a'$, $\vdash b \leftrightarrow b'$, $\vdash c
%         \leftrightarrow c'$ and either $b' \of  \lnot \phi \in \widehat\Gamma$, $c' \of 
%         \lnot \psi \in \widehat\Gamma$ or $(a' \leftrightarrow b' \lor c') \of 
%         \lnot \itop \in \widehat\Gamma$.
%         \item If $a\of \lnot (\phi \iland \psi) \in \widehat\Gamma$ and $b$ and
%         $c$ are labels with all propositional variables in $A$, then there are $a', b'$
%         and $c'$ such that $\vdash a \leftrightarrow a'$, $\vdash b \leftrightarrow b'$, $\vdash c
%         \leftrightarrow c'$ and either $b' \of  \lnot \phi \in \widehat\Gamma$, $c' \of 
%         \lnot \psi \in \widehat\Gamma$ or $ (a' \leftrightarrow b' \land c') \of 
%         \lnot \itop \in \widehat\Gamma$.
%     \end{itemize}
% \end{lemma}
% \begin{proof}
%     If $a\of \lnot (\phi \ilor \psi) \in \Gamma$ and $b$ and $c$ are labels then
%     at least one of the three theories $\Gamma, b\of \lnot \phi$; $\Gamma, c\of \lnot
%     \psi$; or $\Gamma,a \leftrightarrow b \lor c\of \lnot \itop$ is consistent.
%     If not, then $\Gamma$ would prove $b\of \phi$, $c\of \psi$, and $a
%     \leftrightarrow b \lor c\of \itop$ and by applications of $\ioi$, $\sub$, and
%     $\ne$, would prove $a\of \bot$.

%     A similar statement for $a\of \lnot (\phi \iland \psi)$ holds as well.

%     There are only a finite number of equivalence classes (under provability
%     in classical propositional logic) of labels with atoms in $A$. Thus, we
%     can take a finite maximal list of such non-equivalent labels: $a_0, a_1,
%     \ldots, a_m$. Also, let $\sigma_0,\sigma_1,$ \ldots, $\sigma_n$ be a list
%     of all subformulas and negated subformulas of formulas in $\Gamma$.

%     We construct $\widehat{\Gamma}$ by a finite number of steps, step $k$
%     resulting in a finite extension $\Gamma_k$ of $\Gamma$. In each such step
%     $k$ we focus on one quadruple: $\sigma_i,a_j,a_r,a_s$, and make sure that that
%     if $\sigma_i$ is of the form $\lnot (\phi \ilor \psi)$ (or $\lnot (\phi
%     \iland \psi)$) and $a \of \sigma_i$ is in $\Gamma_{k-1}$, for some $\vdash a
%     \leftrightarrow a_j$, then at least one of $a_r\of \lnot
%     \phi$, $a_s\of \lnot
%     \psi$ or $a_j \leftrightarrow a_r \lor a_s\of \lnot \itop$ (or $a_j
%     \leftrightarrow a_r \land a_s\of \lnot \itop$) is in $\Gamma_k$. 

%     Since there are only a finite number of such quadruples this process will
%     end and we let $\widehat \Gamma$ be the last such $\Gamma_k$. This ensures
%     that for every labelled formula  $a:\neg(\phi\ilor\psi)$ (or $a:\lnot
%     (\phi \iland \psi)$), and labels $b,c$ with all propositional variables in
%     $A$, we can find $a_j,a_r,a_s$ taking the roles of $a',b',c'$ in the
%     statement of the theorem.
% \end{proof}

% \begin{proof}[Proof of Theorem \ref{thm:finite_bas}]
%     We will prove that if $\phi$ is a consistent formula, i.e., $p\of \phi
%     \nvdash \bot\of \bot$, then there is a finite Boolean algebra $B$ and a
%     homomorphism $H$ into $\P B$ such that $H(\phi) \neq \emptyset$. Together
%     with the compactness theorem for LT this proves that the set of finite
%     Boolean algebras is adequate for LT.

%     Let $\Gamma_0= \set{p\of \phi}$ and define $\Gamma_{n+1}$ by picking a new
%     (not picked before) labelled complex formula $a\of \psi$ in $\Gamma_n$ and
%     let $\Gamma_{n+1}$ be $\widehat\Gamma_{n}'$ where $\Gamma_{n}'$ is
%     constructed from $\Gamma_n$ as follows:
%     \begin{enumerate}
%         \item If $\psi$ is $\sigma \land \chi$ add both $a\of  \sigma$ and
%         $a\of \chi$.
%         \item If $\psi$ is $\sigma \lor \chi$ add $a\of  \sigma$ or $a\of
%         \chi$ depending on which is consistent with $\Gamma_n$.
%         \item If $\psi$ is $\sigma \ilor \chi$ take new atomic labels $p$ and
%         $q$ and add $p\of  \sigma$, $q\of \chi$, and $a = p\lor q$.
%         \item If $\psi$ is $\sigma \iland \chi$ take new atomic labels $p$ and
%         $q$ and add $p\of  \sigma$, $q\of \chi$, and $a = p\land q$.
%         \item If $\psi$ is $\ilnot \sigma$ add $\lnot a\of  \sigma$.
%         \item If $\psi$ is $\lnot\lnot \sigma$ add $a\of  \sigma$.
%         \item If $\psi$ is $\lnot (\sigma \land \chi)$ add $a\of  \lnot
%         \sigma$ or $a\of \lnot \chi$ depending on which is consistent with
%         $\Gamma_n$.
%         \item If $\psi$ is $\lnot (\sigma \lor \chi)$ add both $a\of
%         \lnot\sigma$ and $a\of \lnot\chi$.
%         \item If $\psi$ is $\lnot \ilnot \sigma$ add $\lnot a \of \lnot
%         \sigma$.
%         \item If $\psi$ is $\lnot (\sigma \ilor \chi)$ or $\lnot (\sigma
%         \iland \chi)$ add nothing.
%     \end{enumerate}
    
%     Let $\Gamma^\ast$ be the union of the $\Gamma_n$'s. Let $A$ the set of
%     atomic labels mentioned in $\Gamma^\ast$. As the only case where we add
%     atomic labels is when dealing with $\ilor$ and $\iland$, it should be
%     clear that if there are $k$ occurrences of $\iland$ and $\ilor$ in $\phi$
%     then we add at most $2k$ atomic labels, and so $|A| \leq 2k+1$.

%     The rest of the proof follows the proof of the completeness theorem
%     closely with the important difference that the Lindenbaum-Tarski algebra
%     $B$ are the equivalence classes of labels \emph{with atomic labels from
%     $A$} under the relation of $T$-provable equivalence. Thus $B$ is a finite
%     Boolean algebra.

%     As before we define $h(a)=[a]_T \in B$ and $H(P_i) = \set{h(a) | a\of P_i
%     \in \Gamma^\ast}$ and by induction prove that $h(a) \in H(\varphi)$ iff
%     $a\of \varphi \in \Gamma^\ast$.

%     Therefore $h(p) \in H(\phi)$ and so $H(\phi)\neq \emptyset$ and thus 
%     $\phi \nvDash \bot$.
% \end{proof}
 
% As a direct corollary we get that Boolean algebras of the form $\P X$ are
% enough to define the semantics of LT:

% \begin{cor}
%     The set of Boolean algebras of the form $\P X$ is adequate.
% \end{cor}

% Theorem \ref{thm:finite_bas} tells us that if $\nvDash \phi$ then there is a
% finite Boolean algebra $B$ and a homomorphism $H :  \Fm \to \P B$ such that
% $H(\phi) \neq B$. Also, for each finite $B$ and each $\phi$ there are only
% finitely many possible homomorphic images of $\phi$. Thus, the set of
% non-theorems of LT is recursively enumerable. Combining this with the fact
% that the set of theorems of LT is recursively enumerable and that $\phi \vDash
% \psi$ iff $\vDash \lnot \phi \lor \psi$ we can conclude the following:

% \begin{cor}
%     Entailment in LT is decidable.
% \end{cor}

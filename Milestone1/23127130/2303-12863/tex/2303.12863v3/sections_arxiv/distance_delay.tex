\subsection{Distance Estimation}

The distance estimation framework of \cite{miller2022distance_short} may also be applied towards \acp{DDE}. The \ac{DDE} distance estimation program with an unsafe set $X_u \subset X$, a metric $c(x, y)$, and point-unsafe-set distance function $c(x; X_u) = \inf_{y \in X_u} c(x, y)$ is
\begin{subequations}
\label{eq:dist_delay_traj}
    \begin{align}
    P^* = & \inf_{t^* \in [0, T], \; x_h(\cdot)} c(x(t^* \mid x_h); X_u) &\\
    & \dot{x} =  f(t, x(t), x(t-\tau)) & & \forall t \in [0, T]  \\
    & x(t) = x_h(t) & & \forall t \in [-\tau, 0]\\
     & x_h(\cdot) \in \mathcal{H}.
    \end{align}
\end{subequations}

Safety in program \eqref{eq:dist_delay_traj} is measured pointwise: a trajectory is safe if $x(t \mid x_h) \not \in X_u$ for every time $t \in [0, T]$. Safety ensuring that the entire history is never contained within $X_u$ ($\exists s \in [-\tau, 0] \mid x(t-s \mid x_h) \not\in X_u \forall t \in [0, T]$) is a more challenging separate problem and will not be considered here.

The \ac{MV}-solution in \eqref{eq:weak_solution} may be applied to \eqref{eq:dist_delay_traj} to create \iac{DDE} distance estimation program by adding a joint probability measure $\eta \in \Mp{X \times X_u}$ (following the procedure from \cite{miller2022distance_short}):
\begin{subequations}
\label{eq:dist_delay_meas}
    \begin{align}
        c^* = & \ \inf \quad \inp{c}{\eta} \label{eq:dist_delay_obj} \\
        & \pi^x_\# \mu^p = \pi^x_\# \eta \label{eq:dist_delay_marg}\\
    & \inp{1}{\mu_0} = 1 \label{eq:dist_delay_prob}\\    
    & \pi^{t}_\# \mu_h = \lambda_{[-\tau, 0]} \label{eq:dist_delay_hist}\\   
    & \mu_p = \delta_0 \otimes\mu_0 + \pi^{t x_0}_\# \Lie_f^\dagger (\bmu_0 + \bmu_1) \label{eq:dist_delay_flow}\\        
    & \pi^{t x_1}_\# (\bmu_0 + \bmu_1) + \nu = S^\tau_\#(\mu_h + \pi^{t x_0}_\# \bmu_0) \label{eq:dist_delay_cons}\\ 
    & \eta \in \Mp{X \times X_u} \\
    & \textrm{Measure Definitions from  \eqref{eq:weak_solution}.} \label{eq:dist_delay_def}
    \end{align}
\end{subequations}

The distance estimation program only affects the cost \eqref{eq:dist_delay_obj}. This change is orthogonal to the modification in dynamics necessary to create \iac{DDE} \ac{MV}-solution from the \ac{ODE} program.


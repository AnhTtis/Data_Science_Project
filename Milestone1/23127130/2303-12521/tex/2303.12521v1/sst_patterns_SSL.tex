%% bare_jrnl.tex
%% V1.4a
%% 2014/09/17
%% by Michael Shell
%% see http://www.michaelshell.org/
%% for current contact information.
%%
%% This is a skeleton file demonstrating the use of IEEEtran.cls
%% (requires IEEEtran.cls version 1.8a or later) with an IEEE
%% journal paper.
%%
%% Support sites:
%% http://www.michaelshell.org/tex/ieeetran/
%% http://www.ctan.org/tex-archive/macros/latex/contrib/IEEEtran/
%% and
%% http://www.ieee.org/

%%*************************************************************************
%% Legal Notice:
%% This code is offered as-is without any warranty either expressed or
%% implied; without even the implied warranty of MERCHANTABILITY or
%% FITNESS FOR A PARTICULAR PURPOSE! 
%% User assumes all risk.
%% In no event shall IEEE or any contributor to this code be liable for
%% any damages or losses, including, but not limited to, incidental,
%% consequential, or any other damages, resulting from the use or misuse
%% of any information contained here.
%%
%% All comments are the opinions of their respective authors and are not
%% necessarily endorsed by the IEEE.
%%
%% This work is distributed under the LaTeX Project Public License (LPPL)
%% ( http://www.latex-project.org/ ) version 1.3, and may be freely used,
%% distributed and modified. A copy of the LPPL, version 1.3, is included
%% in the base LaTeX documentation of all distributions of LaTeX released
%% 2003/12/01 or later.
%% Retain all contribution notices and credits.
%% ** Modified files should be clearly indicated as such, including  **
%% ** renaming them and changing author support contact information. **
%%
%% File list of work: IEEEtran.cls, IEEEtran_HOWTO.pdf, bare_adv.tex,
%%                    bare_conf.tex, bare_jrnl.tex, bare_conf_compsoc.tex,
%%                    bare_jrnl_compsoc.tex, bare_jrnl_transmag.tex
%%*************************************************************************


% *** Authors should verify (and, if needed, correct) their LaTeX system  ***
% *** with the testflow diagnostic prior to trusting their LaTeX platform ***
% *** with production work. IEEE's font choices and paper sizes can       ***
% *** trigger bugs that do not appear when using other class files.       ***                          ***
% The testflow support page is at:
% http://www.michaelshell.org/tex/testflow/



\documentclass[journal]{IEEEtran}
%
% If IEEEtran.cls has not been installed into the LaTeX system files,
% manually specify the path to it like:
% \documentclass[journal]{../sty/IEEEtran}


%\usepackage[final,deletedmarkup=xout,commentmarkup=footnote]{changes}
\usepackage[deletedmarkup=xout,commentmarkup=footnote]{changes}
\definechangesauthor{pc}
\definechangesauthor{jxp}
\definechangesauthor{dr}
\definechangesauthor{eg}



% Some very useful LaTeX packages include:
% (uncomment the ones you want to load)

\usepackage[printonlyused,smaller]{acronym}

% *** MISC UTILITY PACKAGES ***
%
%\usepackage{ifpdf}
% Heiko Oberdiek's ifpdf.sty is very useful if you need conditional
% compilation based on whether the output is pdf or dvi.
% usage:
% \ifpdf
%   % pdf code
% \else
%   % dvi code
% \fi
% The latest version of ifpdf.sty can be obtained from:
% http://www.ctan.org/tex-archive/macros/latex/contrib/oberdiek/
% Also, note that IEEEtran.cls V1.7 and later provides a builtin
% \ifCLASSINFOpdf conditional that works the same way.
% When switching from latex to pdflatex and vice-versa, the compiler may
% have to be run twice to clear warning/error messages.

%https://tex.stackexchange.com/questions/350907/error-latex-error-somethings-wrong-perhaps-a-missing-item
\makeatletter
\def\endthebibliography{%
  \def\@noitemerr{\@latex@warning{Empty `thebibliography' environment}}%
  \endlist
}
\makeatother



% *** CITATION PACKAGES ***
%
\usepackage{cite}
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% noadjust option (cite.sty V3.8 and later) if you want to turn this off
% such as if a citation ever needs to be enclosed in parenthesis.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 5.0 (2009-03-20) and later if using hyperref.sty.
% The latest version can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/cite/
% The documentation is contained in the cite.sty file itself.






% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  % \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi
% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/tex-archive/macros/latex/required/graphics/
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/tex-archive/info/epslatex/
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex

%import graphic package 
\usepackage{float}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}

% *** MATH PACKAGES ***
%
\usepackage[cmex10]{amsmath}
% A popular package from the American Mathematical Society that provides
% many useful and powerful commands for dealing with mathematics. If using
% it, be sure to load this package with the cmex10 option to ensure that
% only type 1 fonts will utilized at all point sizes. Without this option,
% it is possible that some math symbols, particularly those within
% footnotes, will be rendered in bitmap form which will result in a
% document that can not be IEEE Xplore compliant!
%
% Also, note that the amsmath package sets \interdisplaylinepenalty to 10000
% thus preventing page breaks from occurring within multiline equations. Use:
%\interdisplaylinepenalty=2500
% after loading amsmath to restore such page breaks as IEEEtran.cls normally
% does. amsmath.sty is already installed on most LaTeX systems. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/required/amslatex/math/





% *** SPECIALIZED LIST PACKAGES ***
%
%\usepackage{algorithmic}
% algorithmic.sty was written by Peter Williams and Rogerio Brito.
% This package provides an algorithmic environment fo describing algorithms.
% You can use the algorithmic environment in-text or within a figure
% environment to provide for a floating algorithm. Do NOT use the algorithm
% floating environment provided by algorithm.sty (by the same authors) or
% algorithm2e.sty (by Christophe Fiorio) as IEEE does not use dedicated
% algorithm float types and packages that provide these will not provide
% correct IEEE style captions. The latest version and documentation of
% algorithmic.sty can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/algorithms/
% There is also a support site at:
% http://algorithms.berlios.de/index.html
% Also of interest may be the (relatively newer and more customizable)
% algorithmicx.sty package by Szasz Janos:
% http://www.ctan.org/tex-archive/macros/latex/contrib/algorithmicx/




% *** ALIGNMENT PACKAGES ***
%
%\usepackage{array}
% Frank Mittelbach's and David Carlisle's array.sty patches and improves
% the standard LaTeX2e array and tabular environments to provide better
% appearance and additional user controls. As the default LaTeX2e table
% generation code is lacking to the point of almost being broken with
% respect to the quality of the end results, all users are strongly
% advised to use an enhanced (at the very least that provided by array.sty)
% set of table tools. array.sty is already installed on most systems. The
% latest version and documentation can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/required/tools/


% IEEEtran contains the IEEEeqnarray family of commands that can be used to
% generate multiline equations as well as matrices, tables, etc., of high
% quality.




% *** SUBFIGURE PACKAGES ***
%\ifCLASSOPTIONcompsoc
%  \usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
%\else
%  \usepackage[caption=false,font=footnotesize]{subfig}
%\fi
% subfig.sty, written by Steven Douglas Cochran, is the modern replacement
% for subfigure.sty, the latter of which is no longer maintained and is
% incompatible with some LaTeX packages including fixltx2e. However,
% subfig.sty requires and automatically loads Axel Sommerfeldt's caption.sty
% which will override IEEEtran.cls' handling of captions and this will result
% in non-IEEE style figure/table captions. To prevent this problem, be sure
% and invoke subfig.sty's "caption=false" package option (available since
% subfig.sty version 1.3, 2005/06/28) as this is will preserve IEEEtran.cls
% handling of captions.
% Note that the Computer Society format requires a larger sans serif font
% than the serif footnote size font used in traditional IEEE formatting
% and thus the need to invoke different subfig.sty package options depending
% on whether compsoc mode has been enabled.
%
% The latest version and documentation of subfig.sty can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/subfig/




% *** FLOAT PACKAGES ***
%
%\usepackage{fixltx2e}
% fixltx2e, the successor to the earlier fix2col.sty, was written by
% Frank Mittelbach and David Carlisle. This package corrects a few problems
% in the LaTeX2e kernel, the most notable of which is that in current
% LaTeX2e releases, the ordering of single and double column floats is not
% guaranteed to be preserved. Thus, an unpatched LaTeX2e can allow a
% single column figure to be placed prior to an earlier double column
% figure. The latest version and documentation can be found at:
% http://www.ctan.org/tex-archive/macros/latex/base/


%\usepackage{stfloats}
% stfloats.sty was written by Sigitas Tolusis. This package gives LaTeX2e
% the ability to do double column floats at the bottom of the page as well
% as the top. (e.g., "\begin{figure*}[!b]" is not normally possible in
% LaTeX2e). It also provides a command:
%\fnbelowfloat
% to enable the placement of footnotes below bottom floats (the standard
% LaTeX2e kernel puts them above bottom floats). This is an invasive package
% which rewrites many portions of the LaTeX2e float routines. It may not work
% with other packages that modify the LaTeX2e float routines. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/sttools/
% Do not use the stfloats baselinefloat ability as IEEE does not allow
% \baselineskip to stretch. Authors submitting work to the IEEE should note
% that IEEE rarely uses double column equations and that authors should try
% to avoid such use. Do not be tempted to use the cuted.sty or midfloat.sty
% packages (also by Sigitas Tolusis) as IEEE does not format its papers in
% such ways.
% Do not attempt to use stfloats with fixltx2e as they are incompatible.
% Instead, use Morten Hogholm'a dblfloatfix which combines the features
% of both fixltx2e and stfloats:
%
% \usepackage{dblfloatfix}
% The latest version can be found at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/dblfloatfix/






% *** PDF, URL AND HYPERLINK PACKAGES ***
%
%\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/url/
% Basically, \url{my_url_here}.




% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
% There should be no need to do such things with IEEEtran.cls V1.6 and later.
% (Unless specifically asked to do so by the journal or conference you plan
% to submit to, of course. )


% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}

\usepackage{hyperref}
\usepackage{url}
\usepackage{amsthm}
%\usepackage[dvipsnames]{xcolor}
\usepackage{xcolor}

\usepackage{xpatch}
\xpatchcmd{\sout}
  {\bgroup}
  {\bgroup\def\ULthickness{2pt}}
  {}{}

% User macros
\newcommand{\mname}{{\sc Nenya}} % Name for the new algorithm
\newcommand{\ulmo}{{\sc Ulmo}}
\newcommand{\ssta}{\ac{SSTa}}
\newcommand{\sst}{\ac{SST}}
\newcommand{\ssl}{\ac{SSL}}

\newcommand{\LL}{\ac{LL}}
% Power spectrum
\newcommand{\zslope}{\ensuremath{\alpha_{\rm AS}}} % Slope of the power spectrum along-scan [CONFIRM!!]
\newcommand{\mslope}{\ensuremath{\alpha_{\rm AT}}} % Slope of the power spectrum in the along-track direction
\newcommand{\slope}{\ensuremath{\alpha_{\rm min}}} % Minmium of the two 
\newcommand{\ablat}{\ensuremath{|{\rm latitude}|}}

% 
\newcommand{\DT}{\ensuremath{\Delta T}} % T90-T10
\newcommand{\DTone}{\ensuremath{\Delta T = 1-1.5\,{\rm K}}} % DT = 1-1.5 K
\newcommand{\DThalf}{\ensuremath{\Delta T = 0.5-1\,{\rm K}}} % DT = 0.5-1 K
\newcommand{\DTzero}{\ensuremath{\Delta T = 0-0.5\,{\rm K}}} % DT = 0-0.5 K
\newcommand{\DTtwo}{\ensuremath{\Delta T = 1.5-2.5\,{\rm K}}} % DT = 1.5-2.5 K
\newcommand{\DTfour}{\ensuremath{\Delta T = 2.5-4\,{\rm K}}} % DT = 2.5-4 K
\newcommand{\DTfive}{\ensuremath{\Delta T > 4\,{\rm K}}} % DT > 4 K

% UMAP regions
\newcommand{\weak}{\ensuremath{U_0=[0, 2] \, {\rm and} \, U_1=[-2.5, -0.3]}} % DT1
\newcommand{\strong}{\ensuremath{U_0=[4,7.3] \, {\rm and} \, U_1=[2.4,4]}} % DT1

% Dataset
\newcommand{\ncutouts}{$\approx 8,000,000$} % 96% clear; v4
\newcommand{\cutout}{cutout} 

% Model and Training
%\newcommand{\ssl}{SSL} % how we reference the model
\newcommand{\tyear}{2012}  % Training year
\newcommand{\ndim}{256}  % Number of dimensions
\newcommand{\ntrain}{600,000}  % Number of training cutouts
\newcommand{\nvalid}{150,000}  % Number of validation cutouts
\newcommand{\nbatch}{256}  % Number of images in a batch
\newcommand{\nepoch}{XX}  % Number of training epochs
\newcommand{\mlatentv}{\tilde{ \mathbf{z}}^{(i)}}  % Latent vector
\newcommand{\latentv}{$\mlatentv$}

% Ratios
\newcommand{\relf}{\ensuremath{f_r}} % Relative fraction f_r
\newcommand{\relb}{\ensuremath{f_b}} % Relative frequency f_b
\newcommand{\fracc}{\ensuremath{f_c}} % Relative frequency f_b

% UMAP
\newcommand{\numap}{150,000}  % Number of training images for the UMAP

\begin{document}
%
% paper title
% Titles are generally capitalized except for words such as a, an, and, as,
% at, but, by, for, in, nor, of, on, or, the, to and up, which are usually
% not capitalized unless they are the first or last word of the title.
% Linebreaks \\ can be used within to get better formatting as desired.
% Do not put math or special symbols in the title.
\title{The Fundamental Patterns of Sea Surface Temperature}
%
%
% author names and IEEE memberships
% note positions of commas and nonbreaking spaces ( ~ ) LaTeX will not break
% a structure at a ~ so this keeps an author's name from being broken across
% two lines.
% use \thanks{} to gain access to the first footnote area
% a separate \thanks must be used for each paragraph as LaTeX2e's \thanks
% was not built to handle multiple paragraphs
%

\author{J. Xavier Prochaska,
    Erdong Guo,
    Peter~C.~Cornillon,
    Christian E.~Buckingham%
    %    John~Doe,~\IEEEmembership{Fellow,~OSA,}
    %    and~Jane~Doe,~\IEEEmembership{Life~Fellow,~IEEE}% <-this % stops a space
\thanks{J. Xavier Prochaska is an Affiliate of
the Ocean Sciences Department at the 
University of California, Santa Cruz and 
a Simons Pivot Fellow.}%
\thanks{E.~Guo was a member of the 
Department of Computer Sciences at the University of California, Santa Cruz during the formation of this work
and is an Affiliate 
of the Institute of Theoretical Physics, Chinese Academy of Sciences.}% <-this % stops a space
\thanks{P.~C.~Cornillon is a Professor Emeritus of Oceanography at the Graduate School of Oceanography, University of Rhode Island.}%
\thanks{C.~E.~Buckingham is a Research Assistant Professor in the Department of Estuarine and Ocean Sciences at the University of Massachusetts, Dartmouth.}
\thanks{Manuscript received XXX; revised XXX.}}

% note the % following the last \IEEEmembership and also \thanks - 
% these prevent an unwanted space from occurring between the last author name
% and the end of the author line. i.e., if you had this:
% 
% \author{....lastname \thanks{...} \thanks{...} }
%                     ^------------^------------^----Do not want these spaces!
%
% a space would be appended to the last name and could cause every name on that
% line to be shifted left slightly. This is one of those "LaTeX things". For
% instance, "\textbf{A} \textbf{B}" will typeset as "A B" not "AB". To get
% "AB" then you have to do: "\textbf{A}\textbf{B}"
% \thanks is no different in this regard, so shield the last } of each \thanks
% that ends a line with a % and do not let a space in before the next \thanks.
% Spaces after \IEEEmembership other than the last one are OK (and needed) as
% you are supposed to have spaces between the names. For what it is worth,
% this is a minor point as most people would not even notice if the said evil
% space somehow managed to creep in.



% The paper headers
\markboth{Journal of \LaTeX\ Class Files,~Vol.~13, No.~9, September~2014}%
{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for Journals}
% The only time the second header will appear is for the odd numbered pages
% after the title page when using the twoside option.
% 
% *** Note that you probably will NOT want to include the author's ***
% *** name in the headers of peer review papers.                   ***
% You can use \ifCLASSOPTIONpeerreview for conditional compilation here if
% you desire.




% If you want to put a publisher's ID mark on the page you can do it like
% this:
%\IEEEpubid{0000--0000/00\$00.00~\copyright~2014 IEEE}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark.



% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}




% make the title area
\maketitle

% As a general rule, do not put math, special symbols or citations
% in the abstract or keywords.
\begin{abstract}
For over 40 years, remote sensing observations of the Earthâ€™s oceans have yielded global measurements of \ac{SST}. 
With a resolution of approximately 1\,km, these data trace physical processes like western boundary currents, cool upwelling at eastern boundary currents, and the formation of mesoscale and sub-mesoscale eddies. To discover the fundamental patterns of SST on scales smaller than 10\,km, we developed an unsupervised, deep contrastive learning model named \mname. We trained \mname\ on a subset of 8 million cloud-free cutout images ($\sim 80 \times 80$\,km$^2$) from the \ac{MODIS} sensor, with image augmentations to impose invariance to rotation, reflection, and translation. 
The 256-dimension latent space of \mname\ defines a vocabulary to describe the complexity of SST and associates images with like patterns and features. We used a dimensionality reduction algorithm to explore cutouts with a temperature interval of $\DT = 0.5-1$\,K, identifying a diverse set of patterns with temperature variance on a wide range of scales. We then demonstrated that SST data with large-scale features arise preferentially in the Pacific and Atlantic Equatorial Cold Tongues and exhibit a strong seasonal variation, while data with predominantly sub-mesoscale structure preferentially manifest in western boundary currents, select regions with strong upwelling, and along the Antarctic Circumpolar Current. We provide a web-based user interface to facilitate the geographical and temporal exploration of the full \ac{MODIS} dataset. Future efforts will link specific SST patterns to select dynamics (e.g., frontogenesis) to examine their distribution in time and space on the globe.
\end{abstract}

% Note that keywords are not normally used for peerreview papers.
\begin{IEEEkeywords}
IEEEtran, journal, \LaTeX, paper, template.
\end{IEEEkeywords}






% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle

%\acused{SSTa}
\acresetall
%\acused{SSTa}

\section{Introduction}
% The very first letter is a 2 line initial drop letter followed
% by the rest of the first word in caps.
% 
% form to use if the first word consists of a single letter:
% \IEEEPARstart{A}{demo} file is ....
% 
% form to use if you need the single drop letter followed by
% normal text (unknown if ever used by IEEE):
% \IEEEPARstart{A}{}demo file is ....
% 
% Some journals put the first two words in caps:
% \IEEEPARstart{T}{his demo} file is ....
% 
% Here we have the typical use of a "T" for an initial drop letter
% and "HIS" in caps to complete the first word.
\IEEEPARstart{D}{ecades} of \ac{IR} observations made from satellite-borne sensors 
have been used to generate twice-daily (clouds permitting), global \ac{SST} fields. 
While dependent upon the specific satellite sensor examined, as well as the level of processing applied, \ac{IR}   measurements nominally have spatial resolutions of $1$~km and temperature resolutions of several tenths Kelvin. Moreover, the swath widths of these sensors typically range from $1000$ to $2500$~km, permitting resolution of both mesoscale (horizontal scales of $30$-$200$~km) 
and sub-mesoscale ocean phenomena 
(horizontal scales of $1$-$50$~km)\footnote{Including wave-driven currents in the category of sub-mesoscale phenomena, the corresponding horizontal scales must be modified: $0.1$-$50$~km.}.
One notes the two length-scales overlap, in part because
of the varying radius of deformation with latitude leading
to different ranges for each throughout the literature.
Examples of mesoscale phenomena include strong western boundary current systems such as the Gulf Stream, Kuroshio, and Aghulhas Currents, upwelling systems along eastern boundaries such as the California and Benguela Current Systems, tropical instability waves, 
large-scale eddies and/or 
baroclinic Rossby waves. 
Examples of sub-mesoscale processes include 
finer-scale fronts, filaments, and eddies that often result from stirring and straining by the mesoscale currents, and consequent instabilities that take place at these locations \cite{thomas2008submesoscale,mcwilliams2016review}. 
In summary, \ac{IR} satellite-derived measurements yield powerful datasets for exploring the physical properties and processes of our ocean over a broad range of spatial and temporal scales.
% and scientists have
% leveraged them for a wide range of oceanographic study,
% e.g.,  xxxx, marine heat wave 
% phenomena \cite{oliver}, xx.

Impressively, one notes that 
data from even a single sensor, such as the \ac{MODIS} dataset,
satisfies most characteristics of so-called ``big data.'' 
For example, the \ac{L2} \sst\ archive of the processed Aqua \ac{MODIS} data stream ($2003$-$2021$, inclusive) 
comprises over 
2 million individual 5-minute granules 
totalling over 20~TB. While much of these
data have been probed by human investigations, 
the dataset far exceeds
one's capacity for an analysis by visual inspection alone.
Moreover, the scope of this dataset poses computational 
challenges, both in terms of storage and processing resources. Yet, these hurdles are surmountable with modern approaches
tailored to big data including cloud storage
and modern-day \ac{ML} techniques.
%In short, to perform studies of \ac{SST} across the globe and
%over long time-periods, one must xxx

With this as background and armed with the \ac{MODIS} dataset and \ac{ML} tools, we are motivated to study \sst\ patterns across
the global ocean and over long time-periods to 
address the following questions. 
  What are the fundamental patterns and characteristics of \sst\ imagery?
  When and where do these patterns and characteristics manifest?
  And, ultimately, what do these patterns reflect about the underlying dynamics?

Our approach is to develop and apply
\ac{ML} techniques originally introduced for 
natural images (e.g., cats, dogs). By modifying and extending
their application to \ac{SST} imagery (in itself
a class of natural images), we may perform novel
investigations of the global ocean.

In an earlier study \cite{ulmo}, we constructed and applied a \ac{PAE} \cite{pae} 
nicknamed \ulmo\ to nighttime \ac{MODIS} \ac{L2} 
\sst\ data.
The primary goals of this effort were to construct
a massive dataset for exploration 
($\sim 12,000,000$ thumbnails or ``{\cutout}s'' of
dimension $\approx 125 \times 125$\,km$^2$)
and to identify outliers 
from the full dataset
(i.e., unusual phenomena at the ocean surface).
The \ac{PAE} is an unsupervised \ac{ML} model which
first encodes each \cutout\ into a 
reduced-dimension latent 
space (the autoencoder).  
One then generates probabilistic statements on the cutout distribution, specifically the likelihood of a given cutout occurring within the full distribution reported as a 
\ac{LL} metric.
%One then transforms this complex latent
%space into a Gaussian manifold 
%using a normalized flow.
%Finally, one generates 
%probabilistic statements on the 
%\cutout\ distribution.  
%Specifically, one calculates the likelihood of 
%a given \cutout\ occurring within the 
%full distribution reported
%as a \ac{LL} metric.

After calculating the \ac{LL} metric for $\sim 12,000,000$ cutouts,
\cite{ulmo} showed that the majority of 
outlier patterns  occur within previously known mesoscale
eddying regions of the ocean, such as western boundary currents.  While this result may have been anticipated
by those familiar with physical oceanography, 
it verified the efficacy of unsupervised \ac{ML} techniques
applied to these massive \sst\ datasets.  
On the other hand, the \ulmo\
\ac{LL} metric fails to capture the full complexity of 
\ac{SST} imagery--i.e., data with nearly identical 
\ac{LL} may arise from distinctly different \ac{SST} patterns
associated with distinct physical processes.
%Furthermore, the \ac{PAE} results have limited capacity for
%identifying trends--both  geographic and
%temporal--within the dataset.  
This limitation motivates the introduction of a new
\ac{ML} algorithm in this manuscript. 
%\textcolor{red}{I wonder if we could come up with a reason to name this particular ML algorithm as ELMO instead of ULMO. That would be fun. Maybe Extreme Learning Method for Ocean-identification (ELMO).}
%By the way, I searched for the reason for the acronym ULMO but could not find its meaning. Oh, I just found it--character in Tolkien's novels.

To further address our motivating questions,
we build a new model -- nicknamed
\mname\footnote{The ring of power from the
Lord of the Rings associated
with water and \ulmo.} -- built on the
unsupervised \ac{ML} algorithm termed 
self-supervised (or contrastive) learning 
\cite{hadsell2006dimensionality, bachman2019learning, chen2020simple, chen2020big, chen2020improved, he2020momentum, tian2020makes}.
This deep learning approach was developed to generate associations
amongst imagery with similar characteristics while 
separating them from data with contrasting nature.
In the process, one may explore the diversity of 
patterns/scenes/etc.\ that occur within a massive imagery
dataset (e.g., \cite{hayat2021}).
Regarding the ocean, this algorithm offers the opportunity
to describe the fundamental patterns of \ac{SST} fields
without introducing rigid rules-based or statistical metrics
that may predispose the outcome. 
Furthermore, it is straightforward afterward
to apply any such metric to gain physical insight
into the results.

%\begin{itemize}
% \item Importance of \ac{SST} patterns
% \item Introduce \ulmo\ and \ac{PAE} \cite{pae}
% \item Introduce \ac{LL}, \DT
% \item Introduce \ac{SSL}
%\end{itemize}


% An example of a floating figure using the graphicx package.
% Note that \label must occur AFTER (or within) \caption.
% For figures, \caption should occur after the \includegraphics.
% Note that IEEEtran v1.7 and later has special internal code that
% is designed to preserve the operation of \label within \caption
% even when the captionsoff option is in effect. However, because
% of issues like this, it may be the safest practice to put all your
% \label just after \caption rather than within \caption{}.
%
% Reminder: the "draftcls" or "draftclsnofoot", not "draft", class
% option should be used if it is desired that the figures are to be
% displayed while in draft mode.
%
%\begin{figure}[!t]
%\centering
%\includegraphics[width=2.5in]{myfigure}
% where an .eps filename suffix will be assumed under latex, 
% and a .pdf suffix will be assumed for pdflatex; or what has been declared
% via \DeclareGraphicsExtensions.
%\caption{Simulation results for the network.}
%\label{fig_sim}
%\end{figure}

% Note that IEEE typically puts floats only at the top, even when this
% results in a large percentage of a column being occupied by floats.


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Data and Basic Metrics}
\label{sec:data}

\subsection{The Cutout Sample}
\label{sec:cutouts}

In this manuscript we analyze the 
nighttime \ac{L2} \ac{SST} Aqua  \ac{MODIS}
dataset (https://oceancolor.gsfc.nasa.gov/data/aqua/) 
for the period 2003-2021 inclusive.
%\deleted[id=pc]{[Remove clouds with PC algorithm?]} 
Our approach to data extraction and pre-processing
follow the procedures described in
\cite{ulmo}.  Specifically, we first generate \textit{patches} with a size of approximately ${128 \times 128}$\,pixel$^2$ that are at least
$96\%$ clear, land-free 
and of good quality.
This is a stricter clear criterion
than the $95\%$~clear criterion
adopted in \cite{ulmo} as subsequent work has identified
spurious results from improperly masked clouds
or poor in-painting applied to images
with $> \sim 5$\%\ cloud coverage.
We consider this to be the best trade-off between
sample size and quality for the analysis
presented here.

The patches were drawn randomly from the \ac{MODIS}
granules, restricted to lie within 480~pixels of nadir
(to maintain $\sim 1$-km resolution)
and required to have less than 50\%\ overlap.
By allowing for partial overlap, we generate more
`views' of a given field.

We then pre-process each patch by: 
 (i) in-painting the bad (flagged) pixels;
 (ii) median filtering with a 3-pixel window in the 
 along-track direction;
 (iii) resizing the patch to a ${64 \times 64}$\,pixel$^2$ \textit{cutout} 
 using the local mean of each $2 \times 2$ region; and
 (iv) subtracting the mean temperature to produce an
\sst\ anomaly (i.e.,\ \acs{SSTa}) cutout.
Table~\ref{tab:cutouts} lists a small
set of the \ncutouts\ cutouts
resulting from the parent sample;
the full table is available online.

%We note that the 99\%\ constraint deviates from \cite{ulmo}
%who used a 95\%\ clear criterion.
%Our investigations since that publication revealed that
%when the in-painting algorithm is applied to cutouts
%with $\sim 5\%$ clouds can introduce spurious results.
%These spurious effects are largely mitigated in 99\%\ clear
%data, but there are two knock-on effects:
% (i) the dataset is reduced to $\approx 1/3$ of the parent sample;
% (ii) sharp \ac{SST} gradients can be erroneously flagged as
% clouds and thereby not satisfy our stricter cloud-free criterion.
%[Comment on frequently this may occur]

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\texorpdfstring{\LL}{}~and~\texorpdfstring{\DT}{}} %\label{sec:cutouts}

To build physical intuition for the results that follow, 
we introduce several metrics to describe the 
individual cutouts.  Two of these metrics detailed in
this sub-section are the \ulmo\ \ac{LL} metric briefly
described in the introduction
and the temperature
range \DT\, defined as the difference in $90$th and $10$th percentiles of the \ac{SSTa} distribution:
$\DT \equiv T_{90} - T_{10}$ where $T_{N}$ denotes the
$N^{th}$-percentile. 
%\textcolor{red}{Is the SSTa distribution calculated for a single cutout?} %--i.e.,\ the value of temperature anomaly T_{N} below which $N$ percent of the data can be found.

For each cutout we calculate the \ac{LL} metric 
using the \ulmo\ \ac{PAE} of \cite{ulmo}.  
Conceptually, the \ac{LL} metric describes the relative
occurrence of a given image within the
ensemble distribution.
%This distribution, however, is more complex that
%one generated by a simple statistic
%(e.g., the mean temperature).  
Here, the distribution
is constructed from the set of latent vectors derived from
a deep-learning autoencoder designed to
capture the features and patterns of \sst\ imagery.
To formally calculate \ac{LL}, the latent space of
the autoencoder outputs is transformed to a 512-dimension
Gaussian manifold with a normalizing flow.  The 
\ac{LL} metric is then the sum of the log probability
from the 512 Gaussians and the log of the
determinant of the transformation.
These give the normalization of the
\ac{LL} distribution \cite{Morningstar2021DensityOS}.

%This \ac{LL} metric is constructed to 
%describe the relative probability of observing a 
%given image within the ensemble distribution.
%Unlike simple metrics (e.g., the standard
%deviation of \ssta), the distribution analyzed are
%the image ``patterns'' as encoded by the deep learning
%algorithm.  The \ac{LL} is then simply the evaluation
%of the probability product of a 512-dimension Gaussian
%space that describes the image latent vectors.  [challenging!]

\begin{figure}[ht]
\centering
%\includegraphics[width=0.5\textwidth]{Figures/fig_LLvsDT_CF.png}
\includegraphics[width=0.5\textwidth]{Figures/fig_LLvsDT_96clear.png}
\caption{2D histogram of the distribution of 
the \ac{LL} metric vs.\ temperature range \DT, with the 
color proportional to the log of the counts in each bin.
The two distributions are strongly correlated, with 
the highest \DT\ exhibiting
the lowest \LL\ values. 
The marginal distributions are shown as simple histograms.
While the \ac{LL} distribution is well-described by 
a Gaussian, it does exhibit an asymmetric tail to 
very low values which are the extreme outliers
of the dataset \cite{ulmo}. 
}
\label{fig:LLvsDT}
\end{figure}

During their analysis, \cite{ulmo} discovered that
the \ac{LL} values of the cutouts correlate strongly
with the temperature range.
Put simply, cutouts with high \DT\ are rare and yield
lower \LL\ values on average.
%$\DT \equiv T_{90} - T_{10}$ where $T_{X}$ is the
%X$^{th}$-percentile of the \ssta\ distribution.
We have calculated and tabulated \DT\ for all
of the cutouts (Table~\ref{tab:cutouts}),
recovering a LogNormal distribution after
allowing for a shift and scale, 

\begin{equation}
    p(\Delta T') = \frac{1}{\sigma_{\DT} \Delta T' \sqrt{2\pi}} \, 
     \exp \left ( - \frac{\ln^2 \Delta T'}{2 \sigma_{\DT}^2} \right )
\end{equation}
$\Delta T' = (\DT - l_{\DT})/S_{\DT}$
finding
$\sigma_{\DT} \approx 0.58$, 
$l_{\DT} \approx 0.1$, and
$S_{\DT} \approx 0.83$. 
In comparison, the \ac{LL} distribution is well-described
by a Gaussian with mean
$\bar x_{\rm LL} \approx 270$ and
standard deviation $\sigma_{\rm LL} \approx 227$, 
albeit with a long
tail to very low values that define the outlier
sample of \cite{ulmo}.




Figure~\ref{fig:LLvsDT} shows the \ac{LL} vs.\ \DT\ 
bivariate distribution; this reveals 
the strong correlation; 
e.g., cutouts with
high \DT\ exhibit the lowest \ac{LL}.
Despite the correlation, one should not 
over-interpret Figure~\ref{fig:LLvsDT}
to conclude that the \ac{LL} metric is solely 
tracking \DT\ and therefore could
be replaced by it.
First, the relationship is not 
strict; there
is a wide range of \ac{LL} values at a given \DT.
Furthermore, one expects a correlation with \ac{LL}
for any simple metric that describes 
the features in the imagery.  However, 
no single
metric can fully describe the complexity of 
\sst\ imagery. 
% and thereby replace \LL\ which 
%is itself a single valued metric.
Stated differently, the complexity of \sst\ imagery
belies any single, simple statistic -- including
the \ac{LL} measure of our previous work.
This motivates, in part, the application of 
an alternative, deep learning technique. 
As important, we found that the latent space
of \ulmo\ did not group together cutouts with
similar patterns.
This too motivates the contrastive learning
model adopted here.


% Figure slopes
\begin{figure}[ht]
\centering
\includegraphics[width=0.5\textwidth]{Figures/fig_slopes_96clear_v4.png}
\caption{
Bivariate distribution of the along-scan spectral slope
\zslope\ versus the along-track \mslope, each 
determined from the portion of the spectra for wavelengths between 12 and 50\,km.
Typical uncertainties in the measurements are one
to several tenths (fitting error only).
We find that $>99\%$ of the cutouts
have \zslope\ and \mslope\ within
one $\sigma$ of the estimated error
from the 1-to-1 line,  indicating 
their values are highly correlated.
The good correspondence between the \zslope\ and \mslope\ 
implies isotropic motions within the ocean on 
these physical scales.
}
\label{fig:slopes}
\end{figure}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Slopes of the Power Spectrum}
\label{sec:power_spectrum}

Another metric often used to describe structure in \sst\ fields 
is the slope $\alpha$ of the 1D power spectrum;
i.e., the slope of the energy in wavenumber space. 
When estimated over fine horizontal scales, such as sub-mesoscales ($1-50$\,km),
the slope can be descriptive of underlying turbulent processes. For example, classical quasi-geostrophic (QG) turbulence predicts a spectral slope of $\alpha = -3$, surface quasi-geostrophic (SQG) turbulence predicts $\alpha = -5/3$, and an internal-wave continuum predicts $\alpha=-2$ (i.e.,~for scales less than
10\,km and flatter otherwise) \cite{charney71,gm72,callies13}.

For the cutouts analyzed here, the smallest scales are
expected to be dominated by instrument noise.
Therefore, we focus the analysis on larger scales
($\lambda \approx 12-50$\,km), which corresponds 
to the upper end of
wavelengths associated with sub-mesoscale processes
(depending on latitude). Focusing on this range also mitigates, to some extent, contributions to the spectral power at smaller scales due to the multi-detector nature of \ac{MODIS}. Note, however, that a wavelength of $12$\,km nominally resolves two eddy-like anomalies of opposite sign, each with radii of $3$\,km. Since the mixed layer deformation radius of sub-mesoscale anomalies typically exceeds $3$~km, this resolves most sub-mesoscale phenomena except perhaps those at polar latitudes.

%$\lambda_{ml} \sim (N/f)h_{ml}$, where $N/f \sim 50$~$100$ is a non-dimensional stratification and $h_{ml} \sim 50$-$100$~m is a mixed layer depth, 

For each cutout, we determine ensemble averaged power spectra independently for the along-scan (AS) and 
along-track (AT) directions.
Specifically, for each row (or column)
of the cutout, we detrend the data with a linear fit 
and subtract the mean.  We then calculate the 
fast fourier transform for each row/column and
ensemble average the results by row/column.  This signal is median
filtered with a window of 5 pixels and a power-law
is fit to the resultant power spectrum with related 
uncertainty.
We refer to these slopes as \zslope\ and \mslope\ for
the AS and AT directions, respectively.

% Figure slopes
\begin{figure}[ht]
\centering
%\includegraphics[width=0.5\textwidth]{Figures/fig_slopevsDT.png}
\includegraphics[width=0.5\textwidth]{Figures/fig_slopevsDT_96clear_v4.png}
\caption{
2D histogram of the characterstic slope \slope\ 
of each cutout vs.\ \DT. 
Regions of the ocean with larger temperature range
also tend to exhibit a steeper power spectrum 
on $\sim 10-50$km scales, 
albeit with substantial scatter.
}
\label{fig:slopevsDT}
\end{figure}

We applied this algorithm to all of the cutout images
to calculate \zslope\ and \mslope\ independently
(Table~\ref{tab:cutouts})
and also to estimate their uncertainties. 
Figure~\ref{fig:slopes} plots the two slopes against one 
another.  
The marginal distributions of \zslope\ and \mslope\ 
are well described by Gaussians with
nearly identical mean and standard deviations:
$\bar x_\alpha \approx -1.74$, $\sigma _\alpha \approx 0.5$.
Furthermore, we find the slopes for a given
cutout agree within uncertainty
for the overwhelming majority of cases 
(i.e.,~$99\%$ fall within one $\sigma$ of the mean).
This suggests a high degree of isotropy within 
the dataset.
%, unless there were an aniostropy oriented
%orthogonal to the nadir track which is 20\,degrees
%off the meridian.  One could perform a 2D fourier
%transform to investigate this further.

In the following, we characterize each cutout by a single
spectral slope $\slope \equiv \min(\zslope, \mslope)$.
Figure~\ref{fig:slopevsDT} shows this quantity versus
\DT, revealing a correlation but with large scatter.
Given Figure~\ref{fig:LLvsDT}, one notes the \slope\ is
also correlated with \LL\, with the most 
negative \slope\ (largest in magnitude)
cutouts having preferentially lower {\LL} (as one would expect).
%but we again emphasize
%that neither \DT\ nor \slope\ can capture the 
%complexity of structure in \sst\ imagery.


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methodology}
\label{sec:methods}

%\subsection{Outline of Methodology section}
%\begin{itemize}
%\item big picture of the task

%\item brief introduction to the SSL: SimCLR
%
%\item Details of Analysis: 
%\begin{itemize}
%    \item (pre-processing), 
%    \item augmentations, 
%    \item model structure, 
%    \item training (validation) and evaluation, 
%    \item latents visualization,
%\end{itemize}
%\end{itemize}
%
\subsection{Overview}

Recently, several simple yet powerful {\ssl} 
frameworks have been proposed to learn useful representations 
(latents) from high dimensional data sets. This includes 
so-called contrastive losses which maximize the ``similarity" of the views from the same data samples in the latent space \cite{hadsell2006dimensionality, bachman2019learning, chen2020simple, chen2020big, chen2020improved, he2020momentum, tian2020makes}. 
In our work, we apply the SimCLR framework to analyze the preprocessed cutouts ($64\times64$\,pixel$^2$ arrays) from the MODIS granules by designing task-dependent augmentations based 
on our domain knowledge of \sst\ data. 
The latents obtained by our model are, as designed,
a transformation-invariant representation of the \sst\ data.
We then study structure in the latent space by projecting 
into a two-dimensional vector space 
using a \ac{UMAP} \cite{2018arXivUMAP}. 
The reader is also encouraged to study the methodology
developed by \cite{cheng21} using the scattering transform
\cite{mallat2012}.

\subsection{An Introduction to SimCLR}

SimCLR is an efficient but simple self-supervised learning model in which a base neural encoder is used to transform the augmented input data point to a latent vector \latentv. 
By minimizing the contrastive loss, 
an essential representation can be extracted \cite{chen2020simple}. The contrastive loss function defined for an augmented sample pair $\{ \mlatentv, \tilde{\mathbf{z}}^{(i^{\prime})}\}$ is given by:

\begin{align}
\label{eq: contrastive_loss}
   \text{loss}_{i, j} = -\text{sim}(\tilde{\mathbf{z}}^{(i)}, \tilde{\mathbf{z}}^{(j)})/\tau
   + \log{\sum_{k: k\neq i}^{2m}}\exp{(\text{sim}(\tilde{\mathbf{z}}^{(i)}, \tilde{\mathbf{z}}^{(k)})/\tau)},
\end{align}
where $\text{sim}(\tilde{\mathbf{z}}^{(i)}, \tilde{\mathbf{z}}^{(j)})$ is defined as the dot-product similarity of the latent pair $\{\tilde{\mathbf{z}}^{(i)},\tilde{\mathbf{z}}^{(j)}\}$, 
namely the  output of the neural encoder, and $\tau$ is a 
hyper-parameter used to fine-tune the amplitude of the similarity. In essence, the contrastive loss (\ref{eq: contrastive_loss}) is just the rescaled similarity of the sample pair with a batch normaliziation penalty term. 

For our model, we use ResNet-50 \cite{he2016deep} as the encoder 
because unsupervised learning favors models with larger capacity \cite{chen2020big}. 
We do not employ a projection head, and the latents generated by the encoder are passed directly to the contrastive loss function, without additional nonlinear transformation.
%We do not consider that the projection head and the latents produced by the encoder are fed into the contrastive loss function without further non-linear transformations.
The advantage of discarding the projection head is that a 
reasonable similarity can be defined for the latents obtained by the encoder during the evaluation 
step\footnote{If the project head is used, the similarity in the contrastive loss is defined by the 
dot-product of the transformed latents.}. 
After some experimentation, we have set the dimensionality of
the latent space to \ndim.

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[ht]
\centering
\includegraphics[width=0.5\textwidth]{Figures/fig_augmenting_2022dec27.png}
\caption{The left panel is the `raw' cutout input to
the augmentation module and the other
two images are a pair of augmented samples.
The first (center image) was randomly flipped
about the vertical axis and then rotated by $\approx 320$\,deg
and jittered by 5~pixels vertically.
The second (right image) was not flipped, was
rotated by $\approx 18$\,deg and jittered by 2~pixels
horizontally and vertically.
Each augmented image was
then cropped by the inner $40 \times 40$~pixel$^2$, resized to $64 \times 64$\,pixel$^2$ and demeaned.
}
\label{fig:augmentation}
\end{figure}

\subsection{Augmentations}
\label{sec:augment}

The random augmentation module is crucial for model 
performance and affects the nature of the patterns
captured in the latent space.
After experimenting with standard augmentations intended
for natural images, we refined based 
on the following domain considerations: invariance to 
 (i) rotation, 
 (ii) translation, and
 (iii) reflection.
 The reason for the first consideration is that the MODIS L2 data product is not oriented
 parallel to either the zonal or meridional directions. 
Moreover, while there may be scientific motivations for preserving orientation when analyzing  \ssta\ fields more generally,   the north-south gradient in solar insolation and in beta has little impact on the gradient in SST at the scales of interest here 
($<80$\,km).
%sub-mesoscale process do not ``feel'' the effect of beta (i.e., the meridional gradient of Coriolis) and are therefore more or less ignorant of direction. 
This is supported by Figure~\ref{fig:slopes}. 
The reason for the second consideration is that we desired a description of the
 \sst\ patterns that is insensitive to small spatial shifts. That is,
 viewing the region offset by, for example, $10$\,km typically results in a similar pattern. Finally, the impetus for the third consideration is that we suspect a reflection or ``mirror image'' of 
 the original cutout should capture all of the same information. As an aside, we also considered inverting the \ssta\ field
 (i.e., turning warm to cold), but did not do so in the end since some
 dynamic features have a physical preference
 (e.g., mesoscale currents are generally warmer than
 the surrounding waters).

% HERE IS THE ORIGINAL TEXT:
%
%  The random augmentation module is crucial for model 
% performance and affects the nature of the patterns
% captured in the latent space.
% After experimenting with standard augmentations intended
% for natural images, we refined based 
% on the following domain considerations:
%  (i) invariance to rotation -- while there may be scientific
%  motivations for preserving orientation when analyzing 
%  \ssta\ fields, we choose to ignore 
%  these in the current analysis.
%  In part, this is because the L2 data product is not oriented
%  parallel to either the zonal or meridional directions.  Further,
% sub-mesoscale process are generally ignorant of direction,
%  as supported by Figure~\ref{fig:slopes};
%  (ii) invariance to translation -- we desire a description of the
%  \sst\ patterns that is insensitive to small spatial shifts; 
%  e.g., viewing the region offset by 
%  $\approx 10$\,km typically yields
%  a similar pattern; 
%  and
%  (iii) invariance to reflection -- a ``mirror'' image of 
%  the original should capture all of the original information.
%  We also considered inverting the \ssta\ field
%  (i.e., turning warm to cold), but did not because some
%  dynamic features have a physical preference
%  (e.g., mesoscale currents are generally warmer than
%  the surrounding waters).
 
% \footnote{Banding is also an issue
% in the \ac{MODIS} data product.  We have partially mitigated
% this effect with the median pre-processing step but future work 
% may include an additional augmentation to further address it.}
% -- instrumental noise in \ac{MODIS}
% arises from several sources and has an estimated standard
% deviation of $\approx 0.1$\,K with an apparent temperature
% dependence \cite{cornillon2022}.  
 
With these considerations in mind, we imposed the following
augmentations in this order:

\begin{itemize}
    \item Random Flip: We randomly flip the image in each 
    dimension with a 50\%\ probability (e.g.,\ a 25\%\ 
    probability of no alteration).
    \item Random Rotation: We rotate the cutouts with random 
    angles which are uniformly sampled 
    from $\theta = [0, 2\pi]$.
    The new image maintains $64 \times 64$\,pixel$^2$ with
    data rotated `off' now lost and otherwise empty regions
    imputed with 0 values.
    %a smaller physical size per pixel than the original.
    \item Random Jitter and Crop: 
    We randomly select a new image center uniformly offset from
    the original by up to 5 pixels in each dimension.
    %move the crop center around the center of the input image ($64\times64$) by $[0, 5]$ pixel with equal probability. Then 
    We crop the original image around the translated center 
    to $40 \times 40$\,pixel$^2$ to eliminate the inclusion of the zero-filled portions introduced by the rotation. 
    Last, we resize the cropped image back to the original grid size
    of $64 \times 64$\,pixel$^2$.
    \item Demean:
    The final image is demeaned.
    %\item Gaussian Noise: 
    %We sample noise from a normal distribution with zero mean
    %and standard deviation $\sigma_{\rm noise} = 0.05$ 
    %(using the $\approx 0.1$\,K random noise associated with the original pixels reduced by the four pixel average, neglecting the temperature dependence) and
    %add it to the sample.
\end{itemize}

Figure~\ref{fig:augmentation} shows a representative cutout
and two of its randomly augmented samples.
These were randomly flipped, rotated  and jittered, 
and then cropped to the inner $40 \times 40$\,pixel$^2$, resized to $64 \times 64$\,pixel$^2$ and demeaned.
Our \ssl\ model, which operates solely on  
augmented images, learned to recognize
these as similar and to distinguish their
underlying patterns from those of other cutouts.


\subsection{Training and Evaluation}

For training of the model, we randomly selected \ntrain\ cutouts from the full set.
For validation, we randomly selected another \nvalid\ cutouts.
%We split these data into two parts: a training set and a
%validation set. 
With $4$~GPUs, we train \mname\ with a batch 
size of \nbatch. 
To monitor the contrastive lost on the validation set, we find that after 
$\approx 5$~epochs of training, the model learns good 
representations of the training data set. 
SSL models benefit from bigger batch sizes; our experimentation 
showed good performance for sizes of \nbatch\ or more.

%Figure~\ref{fig:learning} shows
%the loss function of the training, validation and
%test data sets vs.\ epoch number.
%One identifies the characteristic shape of 
%decreasing loss for all of the datasets
%in the first several epochs followed by 
%an eventual increase in loss in the validation
%dataset.  The latter behavior is generally interpreted as
%the result of overfitting.
%For the analysis that follows, we adopt as our
%best model the parameters from epoch XX.

%After training the model, the latents can be obtained by feeding the data points in the test data set into the trained encoder. In our model, it turns out that $256$ dimension of latents contain enough information for the downstream tasks.

%To understand the topological structure in the latent space, we use the UMAP to project the original latent space into a two dimensional space which can be visualized nicely using the scatter plot. For the UMAP fitting step, we just need to use the default hyper-parameters since the latents produced by our SSL model are robust and not sensitive to the hyper-parameters in the UMAP model. Interestingly, the metric of the projected latent space by UMAP is consisted with the metric of the log likelihood space (one dimensional space) obtained by the ULMO \cite{ulmo} model. To be specific, by coloring the UMAP processed latend space with the corresponding log-likelihood (ll) value given by ULMO model, we show that the latent are clustered according the metric induced by the lls  In Fig. \ref{fig:umap_LL}, we show the colored UMAP scatter plot of the latent space in which we can find that all the latents are composed according to the ll flow.   

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



In Fig.~\ref{fig:learning_curve_ssl}, we show the learning 
curves for the \mname\ model in the training 
and validation process. 
%Fig.~\ref{fig: learning_curve_train} shows 
%the learning process of the \ssl\ model on the training set. 
Learning loss decreases rapidly with training batch number suggesting that the model converges well. 
%However, in Fig.~\ref{fig: learning_curve_test} we find that the validation loss 
%of the \ssl\ model oscillates around a decreasing trend. We think the oscillation is due to the non-convexity of the contrastive objective in the \ssl\ model which corresponds 
%to the fruitful patterns in the 
%\ssta\ cutouts. 
%After the first several epochs, our \ssl\ model learns 
%most of the common and dominant patterns in the viewed 
%data so the loss decreases to a local optimum.
%By training more epochs, our \ssl\ model will get 
%to another local optimum which leads to the 
%oscillation of the validation learning curve. 

%The task of our model is to learn a representation of 
%\ssta\ cutouts, so unlike the supervised learning problems (classification, regression, etc) there is not an objective criterion to verify how good the representation is, so background knowledge is necessary to help us compare the models 
%at different local optimas, namely we should analyse the latents of the models with different 
%hyper-parameters according to their performance in our downstream tasks to determine the hyper-parameters (model comparing).  
%With about $6$ epochs, we find that good patterns are learned by the model after about $(6)$ epochs training by analysis of the patterns in the latents.

We then evaluated all 21~years of \ac{MODIS} 
cutouts, generating and recording a unique
\ndim-dimension latent vector for each.
These constitute the learned representations
of the fundamental {\sst} patterns of the
imagery on scales $\leq 80$\,km.

\begin{figure}[ht]
\includegraphics[width=0.5\textwidth]{Figures/fig_learn_curve.png}
\caption{Learning curves (batch losses) for the training set (red)
and validation set (blue) for our {\ssl} model.
The model achieves a low loss after $\approx 5$~epochs 
and has effectively converged after $\sim 20$.
}
\label{fig:learning_curve_ssl}
\end{figure}

%%
\subsection{UMAP Dimensionality Reduction}
\label{sec:umap}

While the latent vectors encode the features 
characterizing the \ac{SST} patterns, it is difficult
as humans
to visualize and explore this \ndim-dimension latent
space.  Therefore, we have implemented the \ac{UMAP}
algorithm to further reduce the latent space to two
dimensions ($U_0, U_1$).  
We adopt the default parameters of the 
\ac{UMAP} package \cite{McInnes2018} throughout.

We emphasize that neither of the parameters
$U_0, U_1$ need to have a direct, physical
meaning or analogue. These are only statistical in nature, although they
are tuned to separate the latent vector 
space and therefore track the fundamental 
patterns of \sst\ imagery. 
%The following section explores the outputs of this procedure and also their scientific implications.
%We first fitted a
%standard two-dimensional \ac{UMAP} model to 
%\numap~random latent vectors from \tyear\
%and then applied this transformation to the entire
%dataset.
Only the 256~dimension latent
vectors are the full model representation of the underlying
patterns--i.e., the two-dimensions of this 
\ac{UMAP} are (by design)
a limited representation of 
the full complexity.  Nevertheless, we find
that by applying the \ac{UMAP} to a series of 
\DT\ sub-samples that we describe a 
majority of the diversity within 
the dataset.
The following section explores the outputs of this 
procedure and also their scientific implications.

\begin{figure}[h!]
\centering
\includegraphics[width=0.5\textwidth]{Figures/fig_umap_DT_96clear_v4_S1.png}
\caption{\ac{UMAP} two-dimensional manifold description of 
the latent-vector space (\ndim-dimensions)
which represents the fundamental \sst\ patterns.  
Each cutout is shown as a dot in the space,
color-coded by $\log_{10} \DT$ of the cutout.
}
\label{fig:umap_full}
\end{figure}

% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
\begin{figure*}[ht]
\centering
\includegraphics[width=0.9\textwidth]{Figures/fig_umap_gallery_DTall_96clear_v4_S1.png}
\caption{
Gallery of cutouts, each one selected at random
from a gridded $U_0, U_1$ space for the full 
dataset.% (Figure~\ref{fig:umap_full}).
The data show increasing structure and complexity as one
transitions from the lower left
($U_0, U_1 \approx [0,-1]$) to the
upper right of the domain.  
Along this same direction the average \DT\ is increasing,
i.e., this embedding is especially sensitive to the cutout \DT.
The gray histogram on the right describes the relative
frequency of cutouts at each location in the \ac{UMAP} domain.
}
\label{fig:umap_gallery_all}
\end{figure*}
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results}
\label{sec:results}

The previous section described the deep learning 
methodology 
introduced to analyze the \ac{MODIS} \ac{L2} dataset.
Specifically, the \mname\ model was trained 
to associate images with similar \sst\ patterns on scales 
of $\approx 80 \times 80$\,km$^2$ and smaller, 
while separating these
from dissimilar images.  The resulting 256-dimension
latent space therefore represents a new method or \textit{vocabulary} for describing
\sst\ imagery on sub-mesoscales.
%The present section describes the principle results
%of applying the \mname\ model to the \ac{MODIS} \sst\ imagery.
This section examines a portion of the vocabulary
describing the rich complexity of \sst\ imagery.
To facilitate the exploration, we map the
256-dimension latent space to a reduced
basis (two dimensions) for the full dataset
and subsets in \DT.

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Full Sample}

We begin by examining the full sample, applying
the \ac{UMAP} algorithm to all of
the \ncutouts~latent vectors.
Figure~\ref{fig:umap_full} shows 
the reduction of \ac{SST} patterns into
two dimensions for the full set of imagery,
color-coded by $\log_{10} \DT$. 
%which highlights a strong correlation between
%that metric and the $U_0$ dimension.  
%More precisely, the cutouts near the peak
%of the \ac{LL} distribution (i.e., most normal)
%lie at intermediate $U_0$ values with the extrema
%(high/low \ac{LL}) occurring at extreme $U_0$ 
%values, and a subset of very low \ac{LL} 
%at the lowest $U_1$. 
The relatively uniform distribution 
indicates the \sst\ imagery exhibits
a smooth continuum of patterns and features
as opposed to ``clusters'' of discrete classes.
Furthermore, by coloring the data by \DT, we emphasize
that this property is a dominant ``axis'' in separating
the \ac{SST} imagery
(here oriented at $\sim 45^\circ$ to the $U_0,U_1$ axes).  
The strong \DT\ dependence is relatively obvious in
hindsight; having removed the first moment in 
\ac{SST} (the mean), the second moment (variance)
remains a principle characteristic of each 
\ac{SSTa} cutout.
And while \DT\ has 
physical significance for the ocean (e.g., high
values preferentially arise in dynamically active regions),
we wish to discriminate the patterns
based on finer features.  These are captured
in the full 256-latent space and we access them
in the following section by sub-dividing the
full sample into \DT\ intervals and then reducing each
sub-sample with its own \ac{UMAP} algorithm.

%As detailed in the previous section, we applied a 
%\ac{UMAP} reduction primarily to provide
%a representation of the latent vector space that
%is tractable to human exploration.
%Figure~\ref{fig:umap_LL} demonstrates that 
%the imagery is well separated according to the
%\ac{LL} metric which tracks the full distribution 
%of patterns spanning the \ac{UMAP} space.

Before proceeding, we further
examine the \ac{UMAP} results for the full dataset
via a gallery of representative images.
We have gridded the $U_0,U_1$ space and 
selected a random cutout from within each grid cell;
these are plotted in Figure~\ref{fig:umap_gallery_all}.
%with a colormap that spans 
%\ssta=[-1,1]\,K. 
As designed, \mname\ has effectively separated the
\sst\ imagery by their patterns.
Qualitatively, the data is highly uniform
%($\DT \approx 0$\,K) 
in the lower left region of the \ac{UMAP} space 
$(U_0, U_1 \approx 0,-1)$ and one observes increasing 
complexity as one moves away from this ``origin''.
Greatest structure is evident 
at high $U_0, U_1$ values, with
patterns %at the upper right region of the 
%space are 
characterized by water masses of 
high positive and negative \ssta\ separated
by a sharp front.  These are likely associated with 
strong 
ocean currents, such as the Gulf Stream, Kuroshio, and Antarctic Circumpolar Current, regions of relatively large changes in shallow bathymetry often encountered near the edge of the continental shelf and in vertically stratified 
regions with strong winds such as off the Isthmus of Tehuantepec.

%Within that cohort, one identifies significantly
%higher temperature contrasts (\DT) at lower $U_1$.  
%Travelling to higher $U_1$ along the right edge,
%the patterns show progressively lower \DT\ but
%maintain regions with elevated temperatures
%throughout surrounded by a larger region with
%%\ssta~$\approx 0$\,K. 
%Nearly the opposite pattern -- regions of cooler
%water and otherwise \ssta~$\approx 0$\,K -- 
%are found along the bottom of the figure
%(i.e.\added[id=pc]{,} lowest $U_1$).
%These are rare (there are only XX\%\ of all
%cutouts in this region) and CLOUDS?.



%Figure~\ref{fig:umap_gallery_all} shows another gallery
%with a different random seed and with the
%color bar stretched to higher contrast
%($\delta T = [-1,1]\,\rm K)$.
%Starting at the origin $(U_0,U_1) = (-4,6)$,
%structure slowly emerges towards higher $U_0$ or $U_1$
%values and the diversity of patterns is striking.  
%On the left side (low $U_0$), the first
%structures are regions with isolated and small
%patches of cooler water.  At $U_0 \approx 0$,
%the patterns exhibit nearly equal portions of cool/warm
%water and these transition to larger patches with higher
%\ssta\ values by $U_0 \approx 2$.

% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
\begin{figure*}[h]
\centering
%\includegraphics[width=0.5\textwidth]{Figures/fig_umap_DT40_DT1_96clear_v4_S1_96clear_v4_S1.png}
\includegraphics[width=\textwidth]{Figures/fig_umap_multi_median_96clear_v4_S1.png}
\caption{
Binned evaluations in the \ac{UMAP}
embedding for properties of the cutout
subset with \DThalf.
Panels (a), (c), (d), and (e) show the median value
of {\DT} (with a linear color scale because of the relatively small temperature range compared with the log$_{10}$ scale used for Figure~\ref{fig:umap_full}), \slope, cloud coverage, and the absolute
latitude of the cutouts respectively.
Panel (b) presents the standard deviation in \DT\ 
and panel (f) records the number of cutouts in each bin.
%\ac{UMAP} embedding of the subset of cutouts with \DThalf,
%colored by \DT\ measured on the inner 
%$40 \times 40$\,pixel$^2$ of each cutout
%(i.e., the region analyzed by \mname).
%In contrast to the embedding of the full sample
%(Figure~\ref{fig:umap_full}), 
%we find the cutouts span the domain
%without a monotonic or
%uniform dependence on \DT.
%This is by design to differentiate the \sst\ patterns
%independently of \DT.
}
%\label{fig:umap_DT1}
\label{fig:umap_multi}
\end{figure*}
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{The Fundamental Patterns of \texorpdfstring{\ac{SST}}{}}

In the previous sub-section, we showed that
reducing the full set of latent vectors to two dimensions
with a \ac{UMAP} embedding primarily separated the \sst\ 
patterns by \DT.  While informative, this does not
express well the great diversity within the dataset.
Therefore, we proceeded
to generate a unique \ac{UMAP} embedding
of the latent space for sub-samples of the
cutouts separated by \DT.
Specifically, we measure \DT\ from the inner 
$40 \times 40$\,pixel$^2$ regions of each cutout
which corresponds to the regions augmented by 
the \mname\ model (see $\S$~\ref{sec:augment}).
We then consider \DT\ bins as follows: %\textcolor{red}{CEB: feel free to eliminate the ordered list (original text in latex document)}
  % (i)~${\DT = 0-0.5}$\,K;
  % (ii)~${\DT = 0.5-1}$\,K;
  % (iii)~${\DT = 1-1.5}$\,K;
  % (iv)~${\DT = 1.5-2.5}$\,K;
  % (v)~${\DT = 2.5-4}$\,K;
  % and
  % (vi)~${\DT > 4}$\,K.
\begin{enumerate}
  \item[(a)]{${\DT = 0-0.5}$\,K; 2635727 cutouts; 
    Figure~\ref{fig:umap_gallery_DT0}}
  \item[(b)]{${\DT = 0.5-1}$\,K; 3288103 cutouts;
    Figure~\ref{fig:umap_gallery_DT1}}
  \item[(c)]{${\DT = 1-1.5}$\,K; 1126838 cutouts; Figure~\ref{fig:umap_gallery_DT15}}
  \item[(d)]{${\DT = 1.5-2.5}$\,K; 535038 cutouts;
    Figure~\ref{fig:umap_gallery_DT2}}
  \item[(e)]{${\DT = 2.5-4}$\,K; 126576 cutouts;
    Figure~\ref{fig:umap_gallery_DT4}}
  \item[(f)]{${\DT > 4}$\,K; 18317 cutouts;
    Figure~\ref{fig:umap_gallery_DT5}}
\end{enumerate}

This otherwise arbitrary
binning was chosen to minimize \DT\ as a 
defining factor in the analysis while maintaining
large samples of cutouts.
%(the first subset contains $\sim 3,000,000$
%cutouts and the last $\sim 20,000$).  
Figure~\ref{fig:umap_multi}a shows the \ac{UMAP}
representation of the  \DThalf\
sub-sample colored by \DT.  While there is structure
in the domain that correlates with \DT, it is no longer
monotonic and cutouts with the full range of \DT\ are
located throughout
(the standard deviation in \DT\ is 
$\sigma(\DT) \approx 0.13$\,K; 
see Figure~\ref{fig:umap_multi}b).

%\textcolor{red}{CEB: I wonder if it would be possible to form a three-dimensional plot of this all. For example, a cloud plot of observations in $(U_o,U_1,\Delta T)$-space where this would be similar to an $(x,y,z)$ plot? I understand that $U_o$ vs $U_1$ are not common amongst all \DT and this might cause a hurdle for this. But something along these lines to eliminate the subjective nature of our chosen \DT bins.}

% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
\begin{figure*}[ht]
\centering
\includegraphics[width=0.95\textwidth]{Figures/fig_umap_gallery_DT1_96clear_v4_S1.png}
\caption{
As in Figure~\ref{fig:umap_gallery_all} but for the \ac{UMAP}
embedding of the \DThalf\ sub-set of cutouts
(3,320,395 in total; a cutout is only
shown in $U_0,U_1$ bins
where there are at least 1,000).
In contrast to the full set where the \ac{UMAP} space was largely
defined
by the \DT\ of each cutout, this embedding separates the patterns
by finer features.
Spanning the domain, one identifies a diversity of
patterns with structure on the full range of scales.
As designed, \mname\ has effectively generated a
vocabulary to describe and distinguish 
between the fundamental patterns of \sst.
%By examining the gray histogram, one observes that several regions in $(U_0, U_1)$-space
%are sparsely populated 
%(e.g., the lower right and upper left regions of the domain).
%The black rectangles (dashed and dotted)
%in the left panel indicate 
%the portions of the \ac{UMAP} domain analyzed in 
%Figures~\ref{fig:global_shallow}
%and \ref{fig:global_turb}.
}
\label{fig:umap_gallery_DT1}
\end{figure*}
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%

Figure~\ref{fig:umap_gallery_DT1} shows
a gallery of randomly selected cutouts 
for the \DThalf\ subset at 
their binned $U_0, U_1$ values 
(restricted to areas
with at least 1000 cutouts per bin).
%By construction, these cutouts
%have features representative of all the other
%cutouts with similar $U_0, U_1$ values. 
Examining the figure, one observes a 
great diversity in the patterns as one
travels throughout the \ac{UMAP} space.
%The separation of the imagery by their patterns
%is visceral, as is the great diversity. 
One identifies
features for which SSTa contours are predominantly linear (e.g., at low $U_0, U_1$), 
curved (e.g., $U_0,U_1 \approx 8,2$) or 
amorphous (e.g., $U_0,U_1 \approx 4,4$), 
patterns with apparent symmetry about an axis 
(e.g., $U_0,U_1 \approx 0,2$)
and
those without any discernible structure 
(e.g., $U_0,U_1 \approx 9,1$).
%One also finds cutouts with temperature
%variance on only the largest scales
%(e.g., $U_0,U_1 \approx 1,-1.5$)
%versus those 
%with significant variance on small-scales
%($< \sim 10$\,km; $U_0,U_1 \approx 6,3.5$).


% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[ht]
\centering
\includegraphics[width=0.5\textwidth]{Figures/fig_umap_sectioning.png}
%\includegraphics[width=0.5\textwidth]{Figures/fig_gallery_DT15_annotated.png}
\caption{
A reproduction of the \ac{UMAP} domain
in Figure~\ref{fig:umap_gallery_DT1}
but now annotated to highlight
regions of interest in the \ac{UMAP} space.
The annotations approximately designate
regions where the patterns show:
 (solid-line annotation) temperature variance
 predominantly at the largest wavelengths;
 (dashed-line ellipse) temperature variance
 reflective of an energetic spectrum, e.g.\ 
 non-linear, or turbulent motions;
 and 
 (dash-dot ellipse) patterns with ``noisy''
 features, predominantly on the smallest scales.
Meanwhile, the black rectangles (solid and dashed)
in the left panel indicate 
the portions of the \ac{UMAP} domain analyzed in 
Figures~\ref{fig:global_shallow}
and \ref{fig:global_turb}.
}
\label{fig:umap_annotated}
\end{figure}
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%

%We also note that the patterns at low $U_0, U_1$
%are ``reflected'' by those at high $U_0, U_1$.
%For example, the patterns of the lowest $U_0,U_1$
%show a weak gradient of low temperatures and
%a small region of higher $T$.  The near opposite
%is seen for data with high $U_0,U_1$.
%[can these be the same phenomenon viewed differently?]

% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
%\begin{figure}[ht]
%\centering
%\includegraphics[width=0.5\textwidth]{Figures/fig_umap_slope_96clear_v4_S1.png}
%\caption{
%\ac{UMAP} embedding of the subset of cutouts with \DThalf,
%colored by the average \slope\ value within each bin.
%The {\cutout}s with the shallowest power-spectrum
%are predominantly in the lower portion of this UMAP domain.
%We also note that there is a large scatter 
%($\sigma \approx 0.4$) in the 
%\slope\ values within each bin. 
%%{\color{red}PCC: I find that this figure is remarkably similar to Fig. 8 suggesting a pretty strong relationship between SST and spectral slope. Fig. 3 shows a relatively weak relationship but there may be two reasons for this: 1) alpha\_min is plotted against the log of DT and 2) Fig. 3 is for the entire dataset while Figs. 8 and 10 are for $0.5<DT<1$. I wonder what alpha\_min vs DT would look like for this $0.5<DT<1$? I'll put a side-by-side figure of the two in slack.}
%}
%\label{fig:DT1_slope}
%\end{figure}
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%

%To build additional intuition for the patterns described in this \ac{UMAP} space,
%we present the data colored by spectral slope \slope\ 
%(Figure~\ref{fig:DT1_slope}).
%The results follow the visual impression from
%the gallery (Figure~\ref{fig:umap_gallery_DT1});
%i.e., fields dominated by large-scale structures
%have the least negative {\slope} (smallest in magnitude). 
%However, cutouts with 
%a wide range of slopes occupy nearly every 
%region of the \ac{UMAP} space (not shown).  This emphasizes
%that the power-spectrum alone does not fully
%describe the patterns inherent to \ac{SST}.

% \textcolor{red}{
% Maybe something like the following (but admittedly too verbose) ... 
To build additional intuition for the patterns resolved by \mname,
we show a series of properties of the cutouts 
in Figure~\ref{fig:umap_multi}, binned 
by $U_0$ and $U_1$.
The characteristic most highly correlated 
with the pattern
distribution in the \ac{UMAP} embedding is the 
absolute latitude \ablat\ (Figure~\ref{fig:umap_multi}e).
Given the \ablat\ dependence for the radius of deformation,
this suggests the patterns have been separated by
the dominant feature scale, especially along
the $U_1$ dimension.
Visual inspection supports this hypothesis to an extent,
e.g.\ the patterns with largest-scale variance have 
lower $U_1$.  On the other hand, cutouts with the smallest
scale features arise at high 
$U_0$ and low $U_1$
corresponding to mid-latitudes.
These also have the highest cloud coverage
fraction (Figure~\ref{fig:umap_multi}d)
and close inspection of individual cutouts
reveals small-scale blemishes 
characteristic of clouds.  
We believe these have been missed
by the standard screening algorithm
and future work may leverage \mname\
to flag corrupt data and/or improve the
screeing process.


Figure~\ref{fig:umap_multi}c shows the median
spectral slope \slope\ which varies across the domain. 
The values are all negative, 
indicative of reduced energy at high wavenumbers and, thus, consistent with all theories of geophysical turbulence \cite{charney71,gm72,callies13} (cf.~section~\ref{sec:power_spectrum}). 
% Moreover, the median \slope\ 
% within each portion of \ac{UMAP} space follows visual impressions gathered from the gallery of cutouts in Figure~\ref{fig:umap_gallery_DT1}--i.e., fields dominated by low-wavenumber energy (temperature variance at large-horizontal scales)
% have the the steepest spectral slopes (blue; largest in magnitude), whereas cutouts dominated by temperature variance at finer horizontal scales are characterized by shallow spectral slopes (green and yellow; smallest in magnitude). 
The pattern dependence on \slope\ is
complex with very differing imagery 
having similar median \slope.
Similarly the standard deviation of
\slope\ is large (not shown)
Together, these indicate \slope\ is 
an incomplete
descriptor of \sst\ patterns and features.

To better guide analysis presented in 
the following section, 
Figure~\ref{fig:umap_annotated}
shows the \ac{UMAP} with several sub-regions annotated
to approximately demarcate several
types of patterns: 
those with temperature variance predominantly
on the largest scales (solid annotation),
cutouts with an ``energetic'' spectrum
showing structure at a range of scales
(dashed ellipse), and noisy patterns with structure
predominantly on the smallest scales
(dash-dot ellipse).


Galleries for the other \DT\ sub-samples are
provided in the Appendix
(Figures~\ref{fig:umap_gallery_DT0}-\ref{fig:umap_gallery_DT5}).  Together with Figure~\ref{fig:umap_gallery_DT1}
these six \ac{UMAP} spaces span the full diversity of 
\ac{SST} patterns, as encoded in the full \ac{SSL}
latent space.
With \mname, we have constructed a vocabulary
that encodes the complex language
of \sst\ imagery on sub-mesoscales.
Any \ac{SST}
cutout drawn from the \ac{MODIS} \ac{L2} dataset
maps directly to one of the 6~galleries and is--by
design--very similar to its neighboring
cutouts in \ac{UMAP} space.  This enables novel exploration of 
the data--e.g., the
ability to define and investigate 
regions of the ocean with special or unique
\ac{SST} signatures.

Before proceeding, however, a cautionary note is warranted. 
Because a unique \ac{UMAP} embedding is generated for the 
latent vectors in each $\Delta T$ bin, 
the meaning of the $U_0$ and $U_1$ axes likely 
differ from one $\Delta T$ bin to the next. Having said this, we note that with the exception of the gallery for \DT\ $=0-0.5$\,K (Fig.~\ref{fig:umap_gallery_DT0}) all of the galleries 
%(Fig.~\ref{fig:umap_gallery_DT1}-\ref{fig:umap_gallery_DT5}) 
show the complexity (e.g., curvature of {\ssta} contours) increasing as $U_1$ increases. That is, setting aside the effect of \DT, this may be the primary distinguishing characteristic of the fields identified by \mname.

% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%
\section{Applications and Discussion}
\label{sec:discuss}

In the previous section, we presented the fundamental patterns
of \sst\ imagery learned by the \mname\ model
on scales smaller than $\approx 80$\,km. 
We now demonstrate several applications enabled by 
constructing this vocabulary to describe the complex 
patterns of these data.
In particular, one may explore the nature and origins
of specific patterns across the ocean 
or the patterns that manifest in select regions,
and explore temporal variability.
In this section, we focus on the \DThalf\ subset 
and emphasize that the primary results are 
largely insensitive to this choice.

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Geographical Exploration}
\label{sec:geo}

A defining characteristic of data collected by remote sensing satellites 
such as Aqua is their global coverage of the ocean.
Using the \mname\ model, we may select specific
patterns of \ac{SST} and reveal 
their global geographic locations.  
We may then assess commonality 
(or otherwise) between the processes 
that generate them.
Alternatively, we may select specific local regions
to highlight the \sst\ patterns that define them.
Here, we consider each of these approaches in turn.

\begin{figure*}[h]
\centering
\includegraphics[width=1.0\textwidth]{Figures/fig_umap_geo_global_DT1_weak_96clear_v4_S1.png}
%\includegraphics[width=1.0\textwidth]{Figures/fig_umap_geo_global_DT15_weak_96clear_v4_S1.png}
\caption{
Relative fraction \relf\ of \sst\ cutouts with 
temperature variance predominantly on large scales 
($\approx 80$\,km)
from the \DThalf\ subset
(specified by the dashed rectangle 
in Figure~\ref{fig:umap_gallery_DT1}).
A low value (blue) implies that the geographic
location, with area of $\approx 100 \times 100$\,km$^2$, 
rarely exhibits such patterns while $\relf \ge 1$ (pink/red)
indicates an excess.
Gray regions indicate land. 
The figure reveals that large-scale patterns 
arise primarily at  lower latitudes (e.g., 
the equatorial Pacific and coastal Africa),
but also along the Patagonia shelf and Northern Sea.
Regions with fewer than 5~cutouts
in the \DT\ interval are indicated in white 
and have not been included in the analysis. 
The dashed black rectangle is the focus area 
for Fig.\,\ref{fig:local_eqpsa}.}
\label{fig:global_shallow}
\end{figure*}

\subsubsection{{\bf Global}}
\label{sec:geo_global}

To perform a global analysis, we have divided the surface
of the ocean using the \ac{HEALPix} procedure 
which tesselates a spherical surface into 
equal-area curvilinear quadrilaterals
\cite{healpix}.
Specifically, we adopted nside=64, which 
divides the globe into
$\approx 50,000$ \ac{HEALPix}
cells each with 
approximately 100$\times$100\,km$^2$ area.
We then perform statistics on the cutouts which occur
within each of these \ac{HEALPix} cells.

As a first example, we consider cutouts with 
patterns that exhibit temperature variance
predominantly on the largest scales of our
augmented images (i.e.,~$80$\,km).
Specifically, we select the portion of 
the \ac{UMAP} domain corresponding to \DThalf\ 
with \weak. This includes 
$\approx 225,000$ cutouts from the lower left 
corner of the domain (Figure~\ref{fig:umap_annotated}; solid
rectangle).

Let us now define a \textit{relative fraction} $f_r$ for each 
\ac{HEALPix} which is the ratio of two fractions:
 (i) $f_{H}$, the fraction of cutouts in the \ac{HEALPix}
 which lie within the \ac{UMAP} rectangle defined above
 and;
 (ii) $f_{T}$, the total fraction of all cutouts for the given \DT\ range that
 lie within the same rectangle.
We then calculate 

\begin{equation}
\relf \equiv \frac{f_H}{f_T}
\end{equation}
for each \ac{HEALPix} cell,
ignoring cells with fewer than 5 cutouts.
Small values of \relf\ indicate the pattern (characterized in \ac{UMAP}-space)
occurs rarely within the \ac{HEALPix} relative
to the average, and vice-versa.

Figure~\ref{fig:global_shallow} presents the geographic
distribution of \relf\ for \weak\ in the \DThalf\ bin (Figure~\ref{fig:umap_annotated}; solid
rectangle).
Focusing on geographical regions with an enhanced incidence of
these patterns ($\relf > 1$), we find the majority
occur in large, coherent regions ($\gg 100$\,km),
i.e., much larger than the cutouts analyzed by the \mname\ model.
In this case, the \sst\ patterns have tagged
processes on scales substantially larger than the sub-mesoscale.
One also notes that these areas are
primarily at low latitudes; this 
follows physical intuition 
that the high radius of deformation near the equator
leads to larger-scale features. 
%
%One identifies several distinct regions of the ocean 
%where these 
%\ac{SST} patterns preferentially manifest:
%  (1) in the central and eastern equatorial Pacific;
%  (2) at tropical and equatorial latitudes off the coasts of Africa,
%  especially within the Atlantic basin;
%  (3) in waters near the western coastline of Central America;
%  (4) on the Patagonia shelf; 
%  (5) off the northern coast of Australia; 
%  and
%  (6) in the North Sea.
We briefly describe processes that may
generate the underlying \sst\ patterns in several of 
these regions.
  
Two of the 
largest regions with high \relf\ 
in Figure~\ref{fig:global_shallow} 
are along the eastern equatorial
Pacific and Atlantic.  These areas are commonly referred
to as the Pacific and Atlantic \ac{ECT}, and are of interest to
climate studies owing to their impact on air-sea interactions
(e.g., \cite{mitchell1992,okumura2004}).
Briefly, \ac{ECT}s are believed to result from upwelling 
associated with
northward wind stresses in the eastern
portion of each basin.
This water is then forced by zonal winds to 
propagate westward \cite{mitchell1992,pedlosky1990,okumura2004}.
Figure~\ref{fig:global_shallow} indicates the \ac{ECT}s exhibit similar \sst\ patterns that span several thousands of kilometers along
the equator, stretching to $\approx 180^\circ$\,W
in the Pacific and nearly 
across the entire Atlantic.
The Pacific \ac{ECT} is confined to 
a meridional extent of approximately $\pm 5^\circ$. 
In the following section, we examine its
seasonal variation. 

To the north (at $\approx 10^\circ$\,N)
and distinct from each \ac{ECT} is
an additional region of high relative frequency,
one off the coast of Central America and another
off the coast of western Africa.
Each region is characterized by (seasonal) coastal upwelling
and poleward currents \cite{hagen2005,kounta2018}.
For example, in the Eastern Tropical Pacific, off the coast of Central America,
seasonally-varying and intense wind ``jets''  
generate westward-propagating Rossby waves and/or mesoscale eddies in this region \cite{willett06}.
The \sst\ patterns accentuated in this region, however,
are not characteristic of such dynamics (see below);
we expect the large-scale temperature variance
arises from different processes hereto not explored
by previous studies.
The Atlantic region, meanwhile, corresponds approximately
to the ``shadow zone'' of the eastern tropical
North Atlantic and the so-called Guinea dome below it
\cite{stramma2005,kounta2018}.
These have weak circulation and our results suggest,
unexpectedly, that
the prevailing \sst\ signatures within them
are large-scale temperature variations.

Distinct from the enhanced regions at lower latitudes
are the waters off the Patagonia shelf.
This region is characterized by a shallow continental shelf
and the nearby confluence of two strong currents:
the equatorward-flowing Malvanis current
which meets the poleward-traveling Brazilian current 
at $\approx 40^\circ$S.
The circulation on the shelf is predicted (and observed)
to be relatively weak \cite{combes2018}.
We hypothesize that bathymetry plays a 
leading role in the generation of the observed
\sst\ patterns, which is supported by the 
orientation of the large-scale temperature variance
in the cutouts. 
We also note that the waters off eastern Africa
at $\approx 5^\circ$N share features common to 
the Patagonia shelf \cite{painter2020}; 
perhaps bathymetry is a driving factor for its
high \relf, as well.




\begin{figure*}[h]
\centering
\includegraphics[width=1.0\textwidth]{Figures/fig_umap_geo_global_DT1_strong_96clear_v4_S1.png}
\caption{
Same as Figure~\ref{fig:global_shallow} but for \sst\ patterns
with structure across a range of scales and
from the \DThalf\ subset (specifically \strong). 
The regions that show a high fraction of these turbulent
patterns are predominantly those influenced by western
boundary currents and areas generally known to show
frequent eddy formation and propagation \cite{chelton2011}.
Strong upwelling
may also generate these patterns in select
regions: coastal California, western Africa, Chile.
We also emphasize the 
the Bay of Bengal whose dynamics are driven by 
qualitatively different processes 
\cite{chatterjee2017dynamics}.
Dashed black rectangles on the Gulf Stream near New England
and the equatorial Indian Ocean
are the focus areas for Fig.\,\ref{fig:local_strong}.
}
\label{fig:global_turb}
\end{figure*}

%\begin{figure*}[h]
%\centering
%\includegraphics[width=1.0\textwidth]{Figures/fig_umap_geo_global_DT1_center_96clear_v4_S1.png}
%\caption{
%Same as Figure~\ref{fig:global_shallow} but for
%intermediate $U_0, U_1$ values.
%[Should we show this figure??
%It is currently not discussed]
%}
%\label{fig:global_inter}
%\end{figure*}

In an effort to contrast the geographical distribution of 
the large-scale \ac{SST} patterns of Figure~\ref{fig:global_shallow} 
with that for cutouts suggesting a significantly shorter range of scales, we now focus on \ac{SST} patterns 
for which \DThalf\ with \strong\
(Figure~\ref{fig:umap_annotated}; dashed rectangle).
Their complex patterns are 
suggestive of regions in which non-linear,
sub-mesoscale dynamics (e.g., eddies and filaments)
and/or ageostrophic turbulence 
are to be found.

Figure~\ref{fig:global_turb} presents the relative
frequency \relf\ of these patterns. 
All of the geographical regions 
in Figure~\ref{fig:global_shallow} 
with high relative fractions
now have low \relf, 
and an entirely distinct set of locations with high \relf\ appear.
These are primarily poleward of $20^\circ$\,deg and may be divided into four main groups. 
  (1) waters associated with strong open-ocean currents (e.g., 
        the Brazil-Malvanis confluence,
        the Gulf Stream,
        the Kuroshio, 
        the Agulhas Retroflection); 
        %and
        %\item large portions of the Antarctic Circumpolar Current.
   (2) enclosed or semi-enclosed seas
   (e.g., 
        parts of the Mediterranean, 
        %\item Baffin Bay, 
        %\item Hudson Bay, 
        the Sea of Japan, 
        the Okhotsk Sea,
        the southern end of the Red Sea,
        the northern half of the Gulf of Mexico,
        the Baltic Sea);
        %\item the Black Sea, and
        %\item the southern half of the Caspian Sea.
   (3) eastern boundaries of most ocean basins in the subtropics 
   (e.g., off 
        California and Mexico,
        Chile,
        Northwest Africa); %, and
        %Portugal.
and (4) anomalous regions equatorward of $22.5^\circ$:
        the Bay of Bengal and 
        the retroflection of a portion of the South Equatorial Current into the Equatorial Countercurrent off of northern Brazil and French Guiana. 
        %the southern end of the Red Sea (also listed above as part of a semi-enclosed sea). 


As noted above the first group is associated with 
strong currents and comprise regions
where eddies frequently form  
(e.g., \cite{chelton2011}).
Several are also noted regions of strong upwelling,
e.g., coastal California \cite{huyer1983coastal}. Neither of these are a surprise. By contrast, a significant fraction of virtually all major enclosed or semi-enclosed seas comprise cutouts for which \sst\ contours show signs of relatively small spatial scales while these regions show little to no signs of long wavelength contours (Fig.~\ref{fig:global_shallow}). Is this because topography is complex in these regions exerting significant control over circulation? Or, maybe land constrains the flow both of currents and winds resulting in smaller scale motion? Regardless, the implications here are intriguing.

We may speculate--given the randomly-selected cutouts presented in \ac{UMAP}-space--that the \ac{SST} patterns with $\relf >> 1$
Figure~\ref{fig:global_turb} trace regions of active
frontogensis, frontoloysis, and frontal instabilities at scales defined as sub-mesoscale
($\lambda < 50 \, \rm km$)
and therefore enhanced ageostrophic turbulence.
It is an active area of interest for the authors
to connect such processes to the
specific \sst\ patterns defined by \mname.
%If true,
%one may track such activity 
%across the globe and in time
%to gauge aspects of the global
%energy budget and frequency of mixing.

Last, a visual inspection of the cutouts with high $U_0$ and low $U_1$
in the dotted ellipse of Figure~\ref{fig:umap_annotated} 
shows signatures of 
clouds, e.g., patterns of speckled, cooler patches.
These are primarily cases that passed through the 
cloud-screening algorithms  \cite{FreundMason1999} of the R2019.0 \ac{MODIS} processing.
In this respect, our \mname\ model has efficiently identified 
corrupt fields.  We have examined the geographic distribution
of these cutouts and found they generally track the overall
distribution of data, although there 
is a preference for mid-latitudes.


\begin{figure}[ht]
\centering
\includegraphics[width=0.5\textwidth]{Figures/fig_geo_umap_DT1_eqpacific_96clear_v4_S1.png}
%\includegraphics[width=0.5\textwidth]{Figures/fig_geo_umap_DT1_southatlantic_96clear_v4_S1.png}
\caption{
Two-dimensional histogram of the
relative frequency of specific \sst\ patterns for 
\DThalf\ in the Pacific \ac{ECT}
%(top\sout{; lon=[140W,90W]; lat=[5S,5N]})
%and
%South Atlantic %Mediterranean Sea.  
%(bottom\sout{; lon=[35W,10E]; lat=[20S,30S]}). 
This region is identified by the dashed black rectangle in Fig.~\ref{fig:global_shallow}
and contains 81,675 cutouts.
The Pacific region is dominated by patterns 
with temperature variance at large scales 
(low $U_1$ and low $U_0$) and patterns 
with blemishes suggestive of unmasked clouds
(low $U_1$ and high $U_0$).
%In contrast, the South Atlantic region exhibits patterns
%dominated by variance on the smallest scales
%and those that most resemble white noise
%in the domain.
Bins with fewer than 200 cutouts have been excluded from the panels. % 200 is correct
}
\label{fig:local_eqpsa}
\end{figure}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{{\bf Local}}
\label{sec:geo_local}

We may effectively invert the above analysis to 
examine the \sst\ patterns that are dominant in
select geographical regions.
As an example,
Figure~\ref{fig:local_eqpsa} shows the relative 
frequency, corresponding to the \DThalf\ subset, of \ac{SST} patterns in the Pacific \ac{ECT}
%and a region of the Southern Atlantic
(black dashed rectangle in 
Figure~\ref{fig:global_shallow}).
For this analysis,
we have divided the \ac{UMAP}
domain into $18 \times 18$ equal-spaced bins that 
span 99.9\%\ of each dimension
($\Delta U_0 \approx 0.65$ and $\Delta U_1 \approx 0.45$).
We then calculate a \textit{relative frequency} of occurrence \relb,
defined as the frequency of cutouts
for the region in each bin $f_R$
divided by the frequency measured 
for the entire ocean $f_O$:

\begin{equation}
\relb \equiv \frac{f_R}{f_O} \;\; .
\end{equation}
High $f_b$ values therefore indicate \sst\ patterns
that are more characteristic of the region 
than that of the global ocean.
These \relb\ maps are the \sst\ ``fingerprints''
of the regions specifying the \sst\ patterns
they preferentially manifest.

Examining Figure~\ref{fig:local_eqpsa},
we find the Pacific \ac{ECT} shows an excess
of \sst\ patterns 
%\sout{within the solid-line annotation
%in Figure~\ref{fig:umap_annotated},
%%$U_0, U_1 \approx 0.5,-1.5$, 
%i.e., 
%those with large-scale temperature variance as anticipated
%from Figure~\ref{fig:global_shallow}.
%In addition, this region shows a propensity 
%for all of the patterns} 
with low $U_1$;  
these are a combination of cutouts
with large-scale structure 
and cutouts
with significant ``blemishes'', which we 
identify as unmasked clouds.
%by the shallow, large-scale gradient patterns
%that span the left and upper edges of the \ac{UMAP}
%domain.  
The patterns with $\relb < 1$ for the Pacific \ac{ECT},
meanwhile, are those with temperature variance across
a range of scales including small scales.
We conclude
it is very rare for such fluctuations
to occur in this region, i.e., 
the westward propagation of the \ac{ECT}
is stable against such instabilities.
Additional exploration reveals that features
likely associated with tropical instability
waves that occur along the meridional periphery of 
the ECT \cite{tanaka2019} 
have larger scale gradients and
higher \DT\ (e.g., at $U_0,U_1 \approx 6,8$
in Figure~\ref{fig:umap_gallery_DT2}).

%The Mediterranean Sea, meanwhile, exhibits the 
%near-opposite set of patterns including
%an enhancement of small-scale structures - also evident in Figs.~\ref{fig:global_shallow} and \ref{fig:global_turb}.
%At least for the $\sim 80$\,km regions with $\DT \sim 1$\,K,
%the Mediterranean expresses 
%dynamics that are dominated by motions 
%on $<\sim 10$\,km scales, i.e., sub-mesoscale.
%One could also examine the incidence of such dynamics
%geographically within the Mediterranean to identify the 
%most dynamic regions on average or even to track
%their spatial evolution and/or temporal persistence.

%The lower panel of Figure~\ref{fig:local_eqpsa}
%shows the results for a portion of the Southern Atlantic
%chosen from Figure~\ref{fig:global_shallow} to 
%contrast with the Pacific \ac{ECT}, i.e., selected
%to have \relf\ $< 1$.
%Indeed, we find the \sst\ patterns throughout the
%\ac{UMAP} domain which characterize
%the Pacific \ac{ECT} are effectively absent 
%in the South Atlantic region with the possible exception of a small region, $U_0>6.5$ and $U_1<-1$, of $U_0,U_1$ space.  
%Instead, the dominant \sst\ patterns for $U_0>8$ tend to be
%cutouts with high variance on small-scales
%and less defined large-scale structure.
%These are also the closest patterns to white noise in the domain.
%We surmise that the eastern portion of this region 
%is characterized by small-scale turbulence
%associated with the Benguela Cuhttps://www.overleaf.com/project/6109505f52ed460dee075744rrent as it separates from the continental margin south of the Angola-Benguela Front.

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[ht]
\centering
%\includegraphics[width=0.5\textwidth]{Figures/fig_geo_umap_DT1_southatlantic_96clear_DT1_S1.png}
%\includegraphics[width=0.5\textwidth]{Figures/fig_geo_umap_DT1_southpacific_96clear_DT1_S1.png}
\includegraphics[width=0.5\textwidth]{Figures/fig_geo_umap_DT1_gulfstream_96clear_v4_S1.png}
\includegraphics[width=0.5\textwidth]{Figures/fig_geo_umap_DT1_eqindian_96clear_v4_S1.png}
\caption{
Similar to Figure~\ref{fig:local_eqpsa} but for \sst\ patterns
of the \DThalf\ subset and for
the Gulf Stream near New England
(top)
%; lon=[$70^{\circ}$W,$40^{\circ}$W]; lat=[$40^{\circ}$N,$50^{\circ}$N]).
%(lat=[10,20]\,deg S)
and the Equatorial Indian Ocean 
(bottom).
The precise regions evaluated are labeled 
on the figures and shown 
in Figure~\ref{fig:global_turb}
and each contains approximately 10,000 cutouts.
%; lon=[60E,90E]; lat=[5S,5N]).
The Gulf Stream shows an excess
of patterns within the energetic
region of the \ac{UMAP} space
(dashed ellipse in Figure~\ref{fig:umap_annotated})
which  have temperature variance at a wide
range of scales.
In contrast, the Equatorial Indian Ocean
primarily exhibits patterns with 
small-scale variations, including 
those most similar to white noise
(described by the dotted ellipse in Figure~\ref{fig:umap_annotated}).
}
\label{fig:local_strong}
\end{figure}

%In Figure~\ref{fig:local_south} we consider two large 
%geographical regions (dashed black rectangles in Fig.\,\ref{fig:global_turb}) not discussed above:
%  portions of 
%  the tropical oceans of the South Atlantic and Pacific
%  (specifically lat=[10, 30]\,deg S and [10, 20]\,deg S, respectively).
%The dominant SST patterns in these regions exhibit 
%very little
%structure indicating quiescent upper ocean circulation
%and dynamics.
%This suggests that these large portions of the
%major basins play a limited role in energy dissipation
%and/or ocean mixing.

Two more local regions are presented
in Figure~\ref{fig:local_strong}. These highlight
two areas from Figure~\ref{fig:global_turb}: 
one with a high relative fraction (the Gulf Stream
near New England)
indicative of a highly dynamic region, and 
one with low \relf\ (the equatorial Indian Ocean).
The dominant \sst\ patterns of the Gulf Stream
are drawn from the high $U_1$ portion of the 
\ac{UMAP} domain (Figure~\ref{fig:local_strong}),
especially the energetic region annotated
in Figure~\ref{fig:umap_annotated} (dashed
ellipse).
%Examining Figure~\ref{fig:umap_gallery_DT1},
These patterns show the highest degree of complexity
with temperature variance at a range of scales,
and features with strong curvature, and strong gradients.
By the same token, the Gulf Stream avoids
the regions of the \ac{UMAP} domain
where cutouts show predominantly 
large-scale or small-scale structures
(solid and dotted annotations 
respectively in 
Figure~\ref{fig:umap_annotated}).
%at least in this \DT\ subset.
Together, the \relb\ distribution in the upper
panel of Figure~\ref{fig:local_strong} identifies
the \sst\ patterns that manifest in highly dynamic
regions (e.g., near and within western boundary currents).

The lower panel of Figure~\ref{fig:local_strong}
describes the \sst\ patterns prevalent in the
equatorial Indian Ocean.  These occur predominantly
within the lower-right portion of 
the \ac{UMAP} domain (dotted annotation
in Figure~\ref{fig:umap_annotated}).
This region contains primarily cutouts
%are a mix of cutouts with large-scale features
with isolated, cooler patches (e.g., unmasked clouds)
and those dominated by small-scale variance.
%Throughout this dataset
%blemishes characteristic
%of unmasked clouds are present.
Likewise,
it is very rare for this portion of the Indian
Ocean to exhibit temperature variations on 
medium to larger scales.



\begin{figure}[h]
\centering
\includegraphics[width=0.5\textwidth]{Figures/fig_yearly_geo_DT1_eqpacific_96clear_v4_S1.png}
%\includegraphics[width=0.5\textwidth]{Figures/fig_yearly_geo_DT15_eqpacific_96clear_v4_S1.png}
%\includegraphics[width=0.5\textwidth]{Figures/fig_yearly_geo_DT15_med_96clear_DT15_S1.png}
\caption{
Time series analysis of the cutout fraction
for the prominent \sst\ 
patterns of the Pacific \ac{ECT}
(limited to \DThalf). These are defined by 
the portion of the \ac{UMAP} domain
where $\relb > 1.5$ in Figure~\ref{fig:local_eqpsa}.
A cutout fraction \fracc=1 indicates all of the
cutouts in that month and year have these
patterns.
%(limited to $\DT = [1,1.5]$\,K).
The upper panel shows the full time-series
of \fracc\ and
the dashed line is a fit to the inter-annual
trend accounting for seasonal variations.
There is a strong seasonal signature (lower panel)
associated with 
the intensification of the \ac{ECT} by 
an increase in northward wind stress
\cite{mitchell1992}.
}
\label{fig:time_series_eq}
\end{figure}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Temporal Change}
\label{sec:temporal}

In addition to the extenstive (global) 
geographic coverage afforded by remote
sensing observations, the \ac{MODIS} dataset
now spans nearly two decades of daily observations.
This permits a time-series analysis of the incidence
of \ac{SST} patterns characteristic of particular
dynamics. 
We consider both long-term (i.e., inter-annual) and 
short-term (seasonal) trends in
select regions. 

Returning to the Pacific \ac{ECT}, 
we perform a time-series analysis for its
prominent \ac{SST} patterns. 
We define these patterns as the portion of the \ac{UMAP}
domain for the \DThalf\ sample that have 
a relative frequency $f_b > 1.5$,
i.e., the red regions in % the upper panel of  
Figure~\ref{fig:local_eqpsa}.
For each month of each year in the dataset, 
we calculate the
fraction of cutouts \fracc\
in that portion of the \ac{UMAP} domain.
If there are fewer than 10~cutouts in a given month
and year, that time-stamp is ignored.


The time-series of \fracc\
and its seasonal and inter-annual analysis 
is plotted in Figure~\ref{fig:time_series_eq}.
The time-series analysis models the data
assuming a linear trend for any inter-annual 
variation and 11 free parameters for the
months January-November 
to assess seasonal variations
(the results are
relative to December). 
A strong seasonal component is apparent 
with the boreal summer months (May-September) 
dominant and with the \ac{ECT} suppressed
from February-March inclusive.
The enhancement has been associated with 
the intensification of the Pacific \ac{ECT} by 
air-sea interactions
\cite{chelton2001,ray2018}.
There is no significant
linear inter-annual trend, but we do
observe that the near-disappearance 
of the \ac{ECT} (low \fracc)
in February/March has
been intensifying over the 
past $\sim 10$\,years.


Turning to a portion of Gulf Stream near New England,
we isolate the cutouts with 
$\relb > 1.25$ in the upper panel of
Figure~\ref{fig:local_strong}
which are those with complex patterns.
Similar to the Pacific \ac{ECT},
the primary \sst\ patterns of the Gulf Stream
exhibit a strong seasonal dependence (Figure~\ref{fig:time_series_gulf}).
Its seasonal trend, however, is (coincidentally)
out-of-phase with the \ac{ECT} showing the
highest $f_c$ in winter months and a great
deficit in mid-summer.
The latter may occur as a significant seasonal thermocline is formed in the area to the north and west of the Gulf Stream effectively obscuring the more turbulent waters beneath.


%Turning to the Mediterranean Sea, we now isolate
%the patterns/features enhanced within the sea 
%(\DTone\ subset) which are those with significant
%small-scale structure.
%Specifically, we isolate to the \ac{UMAP}
%space where the relative frequency exceeds
%1.25 in Figure~\ref{fig:local_eqpm}.
%Figure~\ref{fig:time_series_med} shows
%the time series plot for the fraction of the 
%Mediterranean exhibiting this pattern set.
%We observe a strong seasonal variation 
%with January-May suppressed and the summer/fall
%months accentuated. 
%This behaviour follows the warming of the 
%Mediterranean Sea during spring/summer months
%and the associated shallowing of the mixed layer
%which leads to more turbulent dynamics at the surface.

%We have also performed a time-series analysis of 
%the ``turbulent'' and weak-gradient patterns
%used for the Mediterranean and Equatorial Pacific
%respectively, but applied to the global ocean.
%[Should we show these figures?]  
%At the 99\%\ c.l., the data indicate a declining
%trend in the incidence of ``turbulent'' patterns.
%[speculate on why]
%In contrast, there is  no strong seasonal component.
%[I also restricted by hemisphere but didn't see
%much difference]
%For a similar analysis focused on the patterns
%characteristics of the \ac{ECT}, there is
%no statistically significant inter-annual trend
%and only a weak (but statistically significant)
%seasonal component.

%[Global trends; see Figure~\ref{fig:time_series_global}]

%\begin{figure}[h]
%\centering
%\includegraphics[width=0.5\textwidth]{Figures/fig_yearly_geo_DT15_global_eqpac_96clear_DT15_S1.png}
%\includegraphics[width=0.5\textwidth]{Figures/fig_yearly_geo_DT15_global_med_96clear_DT15_S1.png}
%\caption{
%Time series global
%}
%\label{fig:time_series_global}
%\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=0.5\textwidth]{Figures/fig_yearly_geo_DT1_gulfstream_96clear_v4_S1.png}
\caption{
Same as for Figure~\ref{fig:time_series_eq} but for
the enhanced patterns of the
Gulf Stream near New England,
those with $f_b > 1.25$ in the upper panel
of Figure~\ref{fig:local_strong}.
The incidence of these complex patterns exhibits
a strong seasonal dependence, with a strong suppression
during summer months possibly due to masking 
by the seasonal thermocline.
%The strong seasonal dependence tracks the warming
%of the sea and the associated shallowing of the
%mixed layer.
%In addition, there is evidence for
%an inter-annual trend
%($>90\%$ c.l.) of increasing
%dynamics, perhaps associated with global warming.
}
\label{fig:time_series_gulf}
\end{figure}

%\begin{figure}[ht]
%\centering
%\includegraphics[width=0.5\textwidth]{Figures/fig_yearly_geo_DT15_med_96clear_v4_S1.png}
%\caption{
%Same as for Figure~\ref{fig:time_series_eq} but for
%strong gradients in the Mediterranean Sea.
%The strong seasonal dependence tracks the warming
%of the sea and the associated shallowing of the
%mixed layer.
%In addition, there is evidence for
%an inter-annual trend
%($>90\%$ c.l.) of increasing
%dynamics, perhaps associated with global warming.
%}
%\label{fig:time_series_med}
%\end{figure}




% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Summary and Concluding Remarks}
\label{sec:conclusion}

We have designed a deep, contrastive learning model
to reveal and resolve the fundamental patterns
of \sst\ for the global ocean on scales of
$\approx 80 \times 80 \, \rm km^2$ (i.e., sub-mesoscale).
This \mname\ model is intentionally invariant 
to vertical and horizontal flips, 
rotations, and small translations.
We trained \mname\ on \ntrain\ random cutouts
from the \ac{MODIS} \ac{L2} night-time dataset
in the years 2003-2021 inclusive.
To readily explore the 256-dimension latent
space that defines the complexity
of \sst\ patterns,
we bin the cutouts by \DT--the size
of its 90\%\ \sst\ interval--and generated a \ac{UMAP} transformation 
of the latent vectors to 2-dimensions.

We confirmed that \mname\ has successfully separated
the \sst\ patterns in this 3-dimensional space
(one for \DT, and 2 for each \ac{UMAP}) 
to describe the full complexity of \sst\ imagery.
We identify \sst\ patterns with structures on scales 
ranging from the $\approx 2$\,km sampling of the
data to the full extent of the cutouts.
Furthermore, \mname\ separates patterns
with predominantly linear structures 
from those with significant
curvature.
In essence, \mname\ defines a vocabulary
for the language of \sst\ imagery at the 
sub-mesoscale.

Leveraging this vocabulary, we examined the preferred
geographical distribution of several sets of
\sst\ patterns.  
\mname\ reveals that \sst\ patches with 
temperature variance on scales larger 
than the sub-mesoscale
occur preferentially in several
distinct and large regions at low 
latitudes. These include
the Pacific and Atlantic \ac{ECT}s
where the westward propagation of cool waters
upwelled from eastern areas in the basin
yield large temperature gradients along
the equator.
Additionally, we find that complex \sst\ patterns with
significant temperature variance on scales
ranging from a few to tens of kilometers
arise predominantly in dynamically active
regions (e.g., western boundary currents)
at high latitudes.
These results confirm the direct mapping
from \sst\ patterns to distinct ocean processes.


Another application of \mname\ is to resolve
the principal \sst\ patterns 
in select geographical regions.  
We recover highly distinct distributions of
\sst\ patterns when comparing the 
Pacific \ac{ECT} (temperature variations 
primarly on large scales),
%the Southern Atlantic (patterns with 
%small-scale variance in temperature),
a portion of the Gulf Stream near New England 
(complex \sst\ patterns with temperature
variance at a range of scales),
and the Equatorial Indian Ocean 
(primarily small-scale temperature variations).
The distributions of these \sst\ patterns 
are a fingerprint that
define the regions and the dominant near-surface  processes
in these regions.

Last, we performed a time-series analysis
of the defining patterns of the Pacific \ac{ECT}
and the Gulf Stream near New England to search for
inter-annual and seasonal trends.
We identify seasonal trends for each:
 the strengthening of the \ac{ECT} in mid-summer months
 and the depression of dynamic features
 in/near the Gulf Stream during the summer.

We conclude, at least statistically, 
that a vocabulary that defines \sst\ patterns
provides a novel approach to tracking physical
processes across the global ocean and dissecting
such processes within distinct regions.
Emboldened by this success,
we will regress these patterns,
specifically the full latent space representation
of \mname, against specific dynamic processes
(e.g., frontogenesis) to leverage \sst\ 
as an indirect descriptor of such dynamics.
This will require performing analysis and training 
on ocean model output with known dynamics,
e.g., the LLC4320 ocean general circulation model \cite{Rocha2016a,Rocha2016b,Arbic2018}.
Ultimately, we may
track the roles of sub-mesoscale
processes in mixing and energy dissipation
across the globe over the past two~decades.

With this publication, we provide all of the data,
outputs, and software related to \mname\ and this
manuscript.  We also provide on-line
visualization tools that enable the community
to explore \sst\ patterns from the dataset
and those provided by the user.
See XXX for full details.

\input{Tables/tab_cutouts_sub}

\include{acronyms}


% if have a single appendix:
%\appendix[Proof of the Zonklar Equations]
% or
%\appendix  % for no appendix heading
% do not use \section anymore after \appendix, only \section*
% is possibly needed

% use appendices with more than one appendix
% then use \section to start each appendix
% you must declare a \section before using any
% \subsection or using \label (\appendices by itself
% starts a section numbered zero.)
%


\appendices
\section{Additional Galleries}


% %%%%%%%%%%%%%%%%%%%%%%%
\begin{figure*}[ht]
\centering
\includegraphics[width=0.95\textwidth]{Figures/fig_umap_gallery_DT0_96clear_v4_S1.png}
\caption{
Same as Figure~\ref{fig:umap_gallery_all} but for the \ac{UMAP}
embedding of the \DTzero\ sub-set of cutouts.
}
\label{fig:umap_gallery_DT0}
\end{figure*}

% %%%%%%%%%%%%%%%%%%%%%%%
\begin{figure*}[ht]
\centering
\includegraphics[width=0.95\textwidth]{Figures/fig_umap_gallery_DT15_96clear_v4_S1.png}
\caption{
Same as Figure~\ref{fig:umap_gallery_all} but for the \ac{UMAP}
embedding of the \DTone\ sub-set of cutouts.
}
\label{fig:umap_gallery_DT15}
\end{figure*}


% %%%%%%%%%%%%%%%%%%%%%%%
\begin{figure*}[ht]
\centering
\includegraphics[width=0.95\textwidth]{Figures/fig_umap_gallery_DT2_96clear_v4_S1.png}
\caption{
Same as Figure~\ref{fig:umap_gallery_all} but for the \ac{UMAP}
embedding of the \DTtwo\ sub-set of cutouts.
}
\label{fig:umap_gallery_DT2}
\end{figure*}

% %%%%%%%%%%%%%%%%%%%%%%%
\begin{figure*}[ht]
\centering
\includegraphics[width=0.95\textwidth]{Figures/fig_umap_gallery_DT4_96clear_v4_S1.png}
\caption{
Same as Figure~\ref{fig:umap_gallery_all} but for the \ac{UMAP}
embedding of the \DTfour\ sub-set of cutouts.
}
\label{fig:umap_gallery_DT4}
\end{figure*}

% %%%%%%%%%%%%%%%%%%%%%%%
\begin{figure*}[ht]
\centering
\includegraphics[width=0.95\textwidth]{Figures/fig_umap_gallery_DT5_96clear_v4_S1.png}
\caption{
Same as Figure~\ref{fig:umap_gallery_all} but for the \ac{UMAP}
embedding of the \DTfive\ sub-set of cutouts.
}
\label{fig:umap_gallery_DT5}
\end{figure*}

% you can choose not to have a title for an appendix
% if you want by leaving the argument blank
\section{}
Appendix two text goes here.


% use section* for acknowledgment
\section*{Acknowledgment}

JXP acknowledges future support from the Simons Foundation
and help from Claudie Beaulieu for the time-series analysis. EG acknowledges J. Xavier Prochaska and P. C. Cornillon's invaluable guidance on this project, as well as David Draper's insightful discussions. 

The authors acknowledge use of the Nautilus
cloud computing system which is supported
by the following
US National Science Foundation (NSF) awards:
CNS-1456638, CNS-1730158, CNS-2100237, CNS-2120019, ACI-1540112, ACI-1541349, OAC-1826967, OAC-2112167.

% Can use something like this to put references on a page
% by themselves when using endfloat and the captionsoff option.
\ifCLASSOPTIONcaptionsoff
  \newpage
\fi



% trigger a \newpage just before the given reference
% number - used to balance the columns on the last page
% adjust value as needed - may need to be readjusted if
% the document is modified later
%\IEEEtriggeratref{8}
% The "triggered" command can be changed if desired:
%\IEEEtriggercmd{\enlargethispage{-5in}}

% references section


\bibliographystyle{IEEEtran}
\bibliography{bibtex/bib/our_bibli.bib}

%\begin{thebibliography}{1}
%
%\bibitem{IEEEhowto:kopka}
%H.~Kopka and P.~W. Daly, \emph{A Guide to \LaTeX}, 3rd~ed.\hskip 1em plus
%  0.5em minus 0.4em\relax Harlow, England: Addison-Wesley, 1999.
%
%\end{thebibliography}

% biography section
% 
% If you have an EPS/PDF photo (graphicx package needed) extra braces are
% needed around the contents of the optional argument to biography to prevent
% the LaTeX parser from getting confused when it sees the complicated
% \includegraphics command within an optional argument. (You could create
% your own custom macro containing the \includegraphics command to make things
% simpler here.)
%\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{mshell}}]{Michael Shell}
% or if you just want to reserve a space for a photo:

% You can push biographies down or up by placing
% a \vfill before or after them. The appropriate
% use of \vfill depends on what kind of text is
% on the last page and whether or not the columns
% are being equalized.

%\vfill

% Can be used to pull up biographies so that the bottom of the last one
% is flush with the other column.
%\enlargethispage{-5in}



% that's all folks
\end{document}

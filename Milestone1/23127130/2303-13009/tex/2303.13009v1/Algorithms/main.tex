% \begin{algorithm}[t!]
% \caption{L2F Algorithm with MTN}
% \label{alg:main}
% \textbf{Inputs:} $w$, $\phi$ \\
% \textbf{Parameters:} learning rate $\alpha$, $\beta$ \\
% % \vspace{-10pt}
% \begin{algorithmic}[1]
%     \For{$e = 1$ {\bfseries to} Epochs}
%         \For{$k = 1$ {\bfseries to} $K_1$}
%             \State $\ell_t = f_t(x^k, y^k; w) \:\:\: \forall t \in [0, T]$
%             \State $\aux \leftarrow MTN(\boldsymbol{\ell}; \phi)$
%             \State $w \leftarrow w - \alpha \cdot \nabla_w \aux \Big|_{w, \phi}$
%         \EndFor
%         \For{$k = 1$ {\bfseries to} $K_2$}
%             \State $\ell_t = f_t(x^k, y^k; w) \:\:\: \forall t \in [0, T]$
%             \State $\pri, \: \aux \leftarrow \ell_0, \: MTN(\boldsymbol{\ell}; \phi)$
%              \State $\phi \leftarrow \phi + \beta \cdot \nabla_w \pri \Big|_{w, \phi} \cdot \nabla_\phi\nabla_w \aux \Big|_{w, \phi}$
%         \EndFor
%     \EndFor
% \end{algorithmic}
% \textbf{return} $w$

% \end{algorithm}

\begin{algorithm}[t!]
\caption{MELTR optimization algorithm}\label{alg:opt}
\label{alg:main}
\textbf{Inputs:} $w$, $\phi$ \\
\textbf{Parameters:} learning rate ($\alpha$, $\beta$), regularization coefficient $\gamma$, inner iter $K$ \\
% \vspace{-10pt}
\begin{algorithmic}[1]
    % \For{$e = 1$ {\bfseries to} Epochs}
    \vspace{-3mm}
    \While{not converged}
        \For{$k = 1$ {\bfseries to} $K$}
            % \State $\ell_t = f_t(x^k, y^k_t; w) \:\:\: \forall t \in [0, T]$
            \State $\ell_t = \mathcal{L}_t(\mathcal{F}(x; w), y_t) \:\:\: \forall t \in [0, T]$
            \State $\aux \leftarrow \text{MELTR}(\boldsymbol{\ell}; \phi)$
            \State $w \leftarrow w - \alpha \cdot \nabla_w \aux \Big|_{w, \phi}$
        \EndFor
        \State $\ell_t = \mathcal{L}_t(\mathcal{F}(x; w), y_t) \:\:\: \forall t \in [0, T]$
        \State $\aux \leftarrow \text{MELTR}(\boldsymbol{\ell}; \phi)$
        \State $\pri \leftarrow \ell_0+ \gamma \cdot \left|\text{MELTR}(\boldsymbol{\ell}; \phi) - \sum_t \ell_t\right|$
        \State $\phi \leftarrow \phi + \beta \cdot \nabla_w \pri \Big|_{w, \phi} \cdot \nabla_\phi\nabla_w \aux \Big|_{w, \phi}$
    \EndWhile
    \State \textbf{return} $w$
    \vspace{1mm}
\end{algorithmic}
\end{algorithm}
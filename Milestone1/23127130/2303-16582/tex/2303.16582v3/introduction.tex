

\section{Introduction}
SAT modulo theories (SMT) is the problem of checking whether a given 
first-order formula with both propositional and theory variables is satisfiable in a specific first-order theory. In this paper, we consider the quantifier-free fragment of \smtnta, non-linear real arithmetic  augmented with trigonometric and exponential transcendental functions. 
 This problem is particularly important in the  verification of hybrid systems and in theorem proving.  Unfortunately, \nta is a very challenging theory. 
 Indeed, it is undecidable \cite{richardson68}, and, moreover, there is no known
way of representing satisfying assignments using a finite string of bits (i.e., no finite representation of satisfying assignments)
% finite representation of satisfying assignments
that could serve as a direct certificate of satisfiability. This does not only make it difficult for an SMT-solver to prove satisfiability, but also raises the question of how to verify the result given by an SMT-solver. %(whereas, for linear real arithmetic and non-linear real arithmetic without transcendental functions, a satisfying assignment, having a finite representation, can directly serve as a certificate).
 
 
 In this paper, we


 \begin{itemize}
 \item  introduce the notion of a satisfiability certificate for \nta that allows independent entities to verify the satisfiability of a given input formula without having to re-do a full check of its satisfiability, we 
 \item introduce a method for computing such satisfiability certificates, we
 \item describe computational experiments that analyze the efficiency of several variants of the method, and we
 %\item provide a theoretical characterization of situations when such a certificate can be successfully computed despite the mentioned undecidability restrictions.
 \item provide a theoretical characterization of the class of problems  for which such a certificate can be successfully computed despite the mentioned undecidability restrictions.
 \end{itemize}

Based on the introduced certificate, the check of satisfiability of \smtnta formulas is both easier in terms of computational effort and effort needed to implement the checker and to ensure its correctness. The certificate is based on the notion of topological degree~\cite{Fonseca:95,Aberth:94,Franek:12b}, generalizing the idea that a sign change of a continuous function $f$ implies satisfiability of $f=0$. The basic tool for checking correctness of the certificate is interval arithmetic~\cite{Rump:10,Neumaier:90,Moore:09}.

 The idea to verify satisfiability of \smtnta in such a way, is not new~\cite{ATVApaper}. However, the formulation as the problem of searching for a certificate is. In addition to the possibility of independent verification, such a formulation makes the corresponding search problem explicit. This allows us to introduce new, efficient search heuristics that guide the algorithm toward finding a certificate and prevent the procedure from getting stuck in computation that later turns out to not to lead to success.

% We have implemented our method  and present computational experiments  with different heuristics 

 The experimental results are based on our implementation in the tool~\ugotNL~\cite{ATVApaper}. We compare different heuristic configurations over a wide variety of \nta benchmarks. The benchmarks also demonstrate 
that this new version of \ugotNL outperforms the previous version, making it---to the best of our knowledge---the most effective solver for proving satisfiability of \nta problems.

It is possible to integrate the resulting method into a conflict-driven clause learning (CDCL) type SMT solver~\cite{ATVApaper}. However, in order to keep the focus of the paper on the concern of certificate search, we ignore this possibility, here.




\myparagraph{Content.} The paper is organized as follows: In Section~\ref{sec:preliminaries} we provide the necessary background. In Section~\ref{sec:goal} we give the formal definitions of \emph{certifying SMT solver} and of \emph{satisfiability certificate} in \smtnta. In Section~\ref{sec:method} we outline our method for searching for a certificate, and in Section~\ref{sec:certificate-search} we illustrate   the heuristics that we introduce in detail. In Section~\ref{sec:experiments} we experimentally evaluate our method. In Section~\ref{sec:th_considerations} we provide some theoretical results that characterize
the class of problems that are solvable through the method.
%cases when the computation of the introduced satisfiability certificates may succeed and when not.
In Section~\ref{sec:relatedwork} we discuss related work. Finally, in Section~\ref{sec:conclusions}, we draw some conclusions.

{\myparagraph{Pre-print version. }
	This is a pre-print version of the paper published in the Journal of Automated Reasoning~\cite{LippariniRatschanJAR}, itself an extended version of a paper that appeared in the proceedings of the NASA Formal Methods Symposium 2023~\cite{Lipparini:23}. 
	The content of this work has also been included in the doctoral thesis of one of the authors~\cite{LippariniThesis}.
	%The main novel contribution of this extended version is a theoretical characterization of the class of problems that our method is able to solve, and the proof of termination for a variant of our method (Section \ref{sec:th_considerations}). Moreover, we propose an alternative approach for a relevant part of our method (that instead of instantiating variables, adds equations),  and compare the two approaches experimentally (Section \ref{subsubsec:orth}, last part of Section \ref{sec:experiments}, and Table \ref{fig:experimentsOrth}). Other changes have been made throughout the paper to improve the clarity of the presentation.


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "./main.tex"
%%% End:
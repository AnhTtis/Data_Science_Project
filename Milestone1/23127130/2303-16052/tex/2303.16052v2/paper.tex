\documentclass{amsart}
\usepackage[italian,english]{babel}
\usepackage{amsaddr}

\usepackage[utf8]{inputenc}

\usepackage{enumitem}

\usepackage{biblatex}
\addbibresource{references.bib}
\setlength\bibitemsep{5pt}
\usepackage{csquotes}
\usepackage{lmodern}

\usepackage{amsmath}

\usepackage{amssymb}

\usepackage{bbm}

\usepackage{fancyhdr}

\numberwithin{equation}{section}

\usepackage{xcolor}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% MARGINI
\usepackage{geometry}
\geometry{a4paper,top=3cm,bottom=3cm, left=2.75cm,right=2.75cm,%
heightrounded,bindingoffset=5mm}


\newtheoremstyle{theorem2}
{8pt}
{8pt}
{\itshape}
{}
{\bfseries}
{.}
{.5em}
{}

\newtheoremstyle{definition2}
{8pt}
{8pt}
{\itshape}
{}
{\bfseries}
{.}
{.5em}
{}

\theoremstyle{theorem2}


\newtheorem{lemma}{Lemma}[section]
\newtheorem{teo}[lemma]{Theorem}

\newtheorem{cor}[lemma]{Corollary}
\newtheorem{prop}[lemma]{Proposition}

\theoremstyle{definition2}

\newtheorem{deff}[lemma]{Definition}
\newtheorem{Remark}[lemma]{Remark}
\newtheorem{exa}[lemma]{Example}


\pagestyle{plain}

\cfoot{} 


\rhead[\fancyplain{}{\bfseries\leftmark}]{\fancyplain{}{\bfseries\thepage}} 
\lhead[\fancyplain{}{\bfseries\thepage}]{\fancyplain{}{\bfseries\rightmark}} 



\begin{document}


\title{Transport densities and congested optimal transport problem in the Heisenberg group}

\author{Michele Circelli, Giovanna Citti} 
\address{University of Bologna, Department of Mathematics, 40126 Bologna, Italy}

\keywords{Congested optimal transport, Wardrop equilibrium, Heisenberg group, transport density} 

\begin{abstract}
We adapt the problem of continuous congested optimal transport to the Heisenberg group, equipped with a sub-Riemannian metric. Originally introduced in the Euclidean setting by Carlier, Jimenez, and Santambrogio as a path-dependent variant of the Monge-Kantorovich problem, we significantly restrict the set of admissible curves to horizontal ones. We establish the existence of equilibrium configurations as solutions to a convex minimization problem over a suitable set of measures on horizontal curves. This result is achieved through the notions of horizontal transport density and horizontal traffic intensity.
\end{abstract}

\maketitle

\section{Introduction}
The first formalization of the concept of congested optimal transport in a discrete, Euclidean setting can be traced back to 1952, when Wardrop introduced a notion of equilibrium governing traffic congestion on a network in \cite{Wardrop}. In 1956, Beckmann et al. proposed a variational characterization for such equilibria in \cite{Beckmann1}. For a comprehensive overview, see \cite{Santambrogiolibro} or \cite{Santambrogio2}. In a slightly different context, Bouchitt√© and Buttazzo introduced the notion of transport density in \cite{Buttazzo1} and \cite{Buttazzo2}, which measures the amount of transport occurring along geodesics within a given region for an optimal transport plan. In \cite{Morel}, Bernot et al. introduced a similar but more abstract framework for describing traffic congestion in networks, expressed in terms of traffic plans, which are probability measures over all possible curves between origin-destination pairs. A few years later, Carlier et al. (in \cite{Santambrogio1}) used this optimal transport approach to propose a continuous version of the traffic congestion problem in networks. They proved the existence of Wardrop equilibria through a convex minimization problem over the set of traffic plans, which is the continuous counterpart of the one proposed in \cite{Beckmann1} for the discrete setting. The traffic intensity they introduced can be considered as the reformulation, in the abstract framework introduced in \cite{Morel}, of notion of transport density. It is worth noting that this minimization problem allows for duality and numerical simulations, as discussed in \cite{Peyre2} and \cite{Peyre}. However, this minimization problem over a set of measures over curves presents many technical difficulties. To address this, in \cite{Brasco} Brasco et al. proved  the equivalence with a technically simpler minimization problem over a set of vector fields with prescribed divergence, introduced in \cite{Beckmann2}. They also proved that Wardrop equilibria are supported on the integral curves, in the DiPerna-Lions sense, of optimal vector fields. For a regularity result about optimal vector fields, see \cite{Colombo}. This new formulation is easier to handle and admits a dual formulation as a classical problem in the calculus of variations. Optimality conditions for this formulation can be written as a PDE, which is the $q$-Laplacian in the simplest case but becomes quite degenerate in more realistic congestion models. See also \cite{brasco2013congested} and \cite{Santambrogioregularity}.
\\

In this paper, we address the continuous congested optimal transport problem in the Heisenberg group $\mathbb{H}^n$, the simplest non-commutative Lie group, which naturally arises in the description of the phase space. This setting is characterized by the choice of $2n$ vector fields and a metric on the sub-bundle of the tangent bundle generated by them. Since the number of given vector fields is strictly smaller than the dimension of the space, the metric is non-Riemannian at every point. All intrinsic objects of the space are defined in terms of these vector fields: in particular, displacement occurs only along their integral curves, called horizontal curves, and the presence of this metric naturally leads to the definition of a sub-Riemannian distance. The Heisenberg group was also proposed by Petitot and Tondut in \cite{Petitot} to describe the functional geometry of the visual cortex (see also \cite{cittisarti}, where the problem was expressed using the tools of sub-Riemannian geometry): they describe the propagation of signals along horizontal curves. Additionally, in \cite{Misic}, the authors state that the propagation of visual signals gives rise to congestion phenomena. With this in mind, we adapt to the Heisenberg group results contained in \cite{Santambrogio1}, which were specific to the Euclidean setting. Addressing this problem in the Heisenberg group is very interesting from a mathematical viewpoint due to its close link with optimal transport theory in this setting. In this direction, the first significant work is \cite{Rigot}, where the authors demonstrated the existence of solutions to the Monge problem associated with the square of the sub-Riemannian distance and established a Brenier-McCann representation theorem. This result was further generalized in \cite{FigalliRifford} to more general (non-homogeneous) sub-Riemannian structures. The first existence result for solutions to the Monge problem associated with the sub-Riemannian distance was provided by De Pascale and Rigot in \cite{DePascale2}. For similar results in more general metric spaces, see \cite{Cavalletti3} and \cite{cavalletti2018overview}.

In this context, we introduce the notion of horizontal transport density, adapting to the geometry of the Heisenberg group the notion previously introduced in the Euclidean setting in \cite{Buttazzo1} and \cite{Buttazzo2}. Following the approach in \cite{Santambrogio}, we establish some summability results of the horizontal transport density for a range of $p$ depending on the geodetic homogeneity of the space. It is worthwhile to note that in $\mathbb{H}^n$, the geodesic dimension does not coincide with either the topological or the homogeneous dimension (see \cite{Juillet}). These results will be instrumental in defining the congested optimal transport problem in this setting. To address this problem, the first obstacle to overcome is lack of non-trivial geodesic subsets in the Heisenberg group, as discussed in \cite{Monti2}. Then, we define a horizontal traffic plan as a probability measure over the space of horizontal curves. The associated horizontal traffic intensity, which measures the amount of traffic along horizontal curves, generalizes the concept of horizontal transport density. Subsequently, inspired by \cite{Santambrogio1}, we introduce a convex minimization problem over the set of horizontal traffic plans, whose solutions are Wardrop equilibria in $\mathbb{H}^n$. To prove the existence of such solutions, we use results from \cite{Santambrogio1} that utilize abstract measure theory instruments. As optimality conditions, we find that such solutions are equilibrium configurations. In fact, traffic plans that solve the minimization problem are supported on geodesics with respect to a suitable congested metric (depending on the traffic plan itself through the traffic intensity). Moreover, they induce transport plans that solve a Monge-Kantorovich problem associated with the congested metric. One of the delicate aspects of the paper is defining this metric, due to the difficulty in defining a length induced by $p$-summable weights. 
\\

The paper is organized as follows: in Section 2, we introduce the Heisenberg Group and recall some well-known results on optimal transport theory in this setting. In Section 3, we introduce the notion of transport density and provide conditions that ensure its $L^p$-summability. In Section 4, we demonstrate that an $L^p$ function induces a weighted distance. In Section 5, we adapt the problem of congested optimal transport to the Heisenberg group and prove the existence of Wardrop equilibria in this setting.

\input{Preliminaries}

\input{transportdensity}

\input{congestedOT}

\section*{Acknowledgments}
M. C. and G.C. are supported by the project PRIN 2022 F4F2LH - CUP J53D23003760006, G.C. is funded by MNESYS PE12 (PE0000006).

The authors thank L. Brasco and S. Rigot for the useful discussions, suggestions and remarks.

\printbibliography

\end{document}
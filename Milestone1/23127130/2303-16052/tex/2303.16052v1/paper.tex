\documentclass{amsart}
\usepackage[italian,  english]{babel}
\usepackage{amsaddr}

\usepackage[utf8]{inputenc}

\usepackage{enumitem}

\usepackage{biblatex}
\addbibresource{references.bib}
\setlength\bibitemsep{5pt}

\usepackage{lmodern}

\usepackage{amsmath}

\usepackage{amssymb}

\usepackage{bbm}

\usepackage{fancyhdr}

\numberwithin{equation}{section}

\usepackage{xcolor}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% MARGINI
\usepackage{geometry}
\geometry{a4paper,top=3cm,bottom=3cm, left=2.75cm,right=2.75cm,%
heightrounded,bindingoffset=5mm}


\newtheoremstyle{theorem2}
{8pt}
{8pt}
{\itshape}
{}
{\bfseries}
{.}
{.5em}
{}

\newtheoremstyle{definition2}
{8pt}
{8pt}
{\itshape}
{}
{\bfseries}
{.}
{.5em}
{}

\theoremstyle{theorem2}


\newtheorem{lemma}{Lemma}[section]
\newtheorem{teo}[lemma]{Theorem}

\newtheorem{cor}[lemma]{Corollary}
\newtheorem{prop}[lemma]{Proposition}

\theoremstyle{definition2}

\newtheorem{deff}[lemma]{Definition}
\newtheorem{Remark}[lemma]{Remark}
\newtheorem{exa}[lemma]{Example}


\pagestyle{plain}

\cfoot{} 


\rhead[\fancyplain{}{\bfseries\leftmark}]{\fancyplain{}{\bfseries\thepage}} 
\lhead[\fancyplain{}{\bfseries\thepage}]{\fancyplain{}{\bfseries\rightmark}} 



\begin{document}


\title{Transport Densities and Congested Optimal Transport in the Heisenberg Group}

\author{Michele Circelli, Giovanna Citti} \address{Dipartimento di Matematica, Università di Bologna, Piazza di Porta San Donato, 5, 40126, Bologna, Italy} \email{michele.circelli2@unibo.it, giovanna.citti@unibo.it} 
\keywords{Congested optimal transport, Wardrop equilibrium, Heisenberg group, transport density} %\subjclass[2010]{ 22E30 , \ 35R03 (primary); \ 53C17 , \ 28A78 (secondary). }

\begin{abstract}
	We adapt the problem of continuous congested optimal transport, introduced in \cite{Santambrogio1} in the Euclidean setting, to the Heisenberg group with a sub-riemannian metric: we restrict the set of admissible paths to the absolutely continuous curves which are also horizontal. As in \cite{Santambrogio1}, we get the existence of equilibrium configurations, known as Wardrop Equilibria, through the minimization of a convex functional over a suitable set of measures. To prove existence of such minima, that turn out to be equilibria, we prove, following \cite{Santambrogio} and using some results contained in \cite{DePascale2}, the existence of summable transport densities. Moreover, as in \cite{Santambrogio1}, such equilibria induces transport plans that solve a Monge-Kantorovic problem associated with a cost function, depending on the congestion itself, which we rigorously define.
\end{abstract}

\maketitle

\section{Introduction}
Traffic congestion has always been an interesting topic for researchers because of its effects on people's behaviour in the real life. In \cite{Wardrop} Wardrop formalized two principles that rule the congestion on a network with a finite number of roads: first, all the paths connecting the same two points, actually used by vehicles, must provide the same travelling time, depending on the congestion itself; second, all the other possible paths connecting the same points must provide a larger travelling time. From a mathematical point of view, paths actually used are geodesics for a metric depending increasingly on the congestion itself. This led to the introduction of an equilibrium concept, known as \textit{Wardrop Equilibrium}, that is a particular case of \textit{Nash equilibrium}, in a game where the players are the vehicles and their goal is to minimize the travelling time. 
In \cite{Beckmann1} Beckmann et al. proposed a variational characterization of such equilibria: a traffic configuration is an equilibrium if and only if it solves a convex minimization problem taking into account the total congestion. This approach led to existence such equilibria.
In \cite{Santambrogio1} Carlier et al. proposed a continuous version of the previous model by replacing the network with a domain in $\mathbb{R}^2$ and allowing the vehicles to move along curves. In this new setting the way in which the vehicles choose their paths is modelled through a probability measure on a suitable set of curves. This measure induces a density of traffic congestion, called \textit{traffic intensity}: this is a \textit{path-dependent} version of the notion of \textit{transport density} introduced by Bouchitté and Buttazzo in \cite{Buttazzo1}, \cite{Buttazzo2} and by Evans and Gangbo in \cite{Evans}. In \cite{Buttazzo1}, \cite{Buttazzo2} it was connected to some shape optimization-problems while in \cite{Evans} it was used to get a solution for the Monge's problem associated with the Euclidean distance, see for instance \cite[Section 3.1]{Santambrogiolibro} for more details about this topic. In \cite{Feldman2} and \cite{Santambrogio2} for instance, the authors gave some sufficient conditions to get, respectively, results of uniqueness and summability for the transport density.
 
Regarding the problem of continuous congested optimal transport proposed in \cite{Santambrogio1}, as in the discrete case, Carlier et al. proved the existence of equilibrium configurations, as minima of a convex functional over a suitable set of probability measures on paths. The authors started from the optimization problem and get the equilibrium as an optimality condition: this is because, by optimizing, the traffic intensity, defined only as a measure, is forced to be absolutely continuous and its density appears in the definition of the congested metric (so that geodesics are not well defined in the case of possibly singular measure). However the convex minimization problem may be difficult to solve, since it deals with minimization over measures on sets of curves, hence with two layers of infinite dimension. For this reason in \cite{Peyre} and \cite{Brasco} were proposed two developments with the aim of transforming the problem into simpler ones.
 
Usually the total amount of vehicles commuting from two points is fixed a priori for every pair of points: this corresponds to fix a \textit{transport plan}, i.e. a probability measure on the product space of origin-destination pairs. The first work in this direction is \cite{Morel}: this variant of the problem is known as \textit{short-term  problem}, since for immediate applications one usually knows the portion of vehicles moving every day between two given points. This problem admits a dual formulation and allows for numeric simulations, see \cite{Peyre}. On the other hand, also the transportation plan may be an unknown. This is the problem that Carlier et al. actually treated in \cite{Santambrogio1} and is called \textit{long-term problem}. For instance, one may think of the couriers of a materials factory, which has several locations in a certain area. The couriers have to deliver different quantities of material to customers every morning: hence, there is someone who chooses their destinations, so that the factory spends, on the whole, as little as possible to make its deliveries. In this way one gets that the optimal traffic configuration must induce a transport plan that solves the Monge-Kantorovich problem associated with the metric associated with the traffic intensity itself. In \cite{Santambrogio3} Carlier and Santambrogio first investigated the relation between this problem and a \textit{minimal flow problem à la Beckmann}, introduced in \cite{Beckmann2}. In \cite{Brasco} Brasco et al. proved the equivalence between this two problems, under more general assumptions. Roughly speaking this new formulation consists in minimizing the total integral cost among vector fields with prescribed divergence: paths actually followed by the vehicles are the integral curves of a vector fields obtained from the optimal one. This new model led to write optimality conditions as a PDE that, in the simplest case is the Laplacian or p-Laplacian, but it turns to be quite degenerate in a more realistic congestion model. See \cite{Brasco}, \cite{Vespri} for regularity results of this equation: these results turn out to be necessary in order to properly define the integral curves of the optimal vector field. Finally, we remark that equations involved in this formulation are elliptic PDEs, without any variable describing the time. This is due to the fact that this model is stationary: it only deals with situations in which paths are constantly occupied by the same density of vehicles. One may think that the traffic intensity stands for the average occupation ratio of each road during a period.
\\

This paper contains an attempt to make more realistic the problem introduced in \cite{Santambrogio1} for the continuous setting: the idea is to allow vehicles to move not in all directions but only along certain established ones, as happens in real life. We chose to adapt the problem to the Heisenberg group $\mathbb{H}^n$, considering as admissible paths the horizontal curves; obviously other settings with a lack of homogeneity could also be considered. In particular Petitot and Tondut, in \cite{Petitot}, introduced a model of the primary visual cortex V1 in the 1st -Heisenberg Group, which expressed the propagation along the cortical connectivity as a constraint minimization problem : it was expressed as a subriemannian model in \cite{cittisarti}. The visual signal propagates along the connectivity and gives rise to congestion phenomena (see \cite{Misic} and \cite{Wolfson}). This is why we choose to adapt the problem of congested optimal transport to the Heisenberg group.

To achieve our goal it was necessary to define the notion of transport density in this new setting and adapt summability results contained in \cite{Santambrogio2}. Most of the results contained in \cite{Santambrogio1} have to do with measure theory and therefore can be easily adapted to this new setting: the set of horizontal curves is a subset of those curves considered as admissible by Carlier et al. We will skip the proofs of these results and we will focus only on those in which the geometry of the space plays a fundamental role. We develop the long-term problem, since it is the richest case from a mathematical point of view and all the results can be easily adapted to the short-term problem. Also in this paper we first introduce the optimization problem and then we get  equilibria as optimality condition. The optimal traffic configuration must provide a transport plan that is optimal for the Monge-Kantorovich problem associated with a congested metric we will rigorous define in Subsection 4.1. The pioneer work on the optimal transportation theory in the Heisenberg Group is \cite{Rigot}, where the authors adapt to this new setting the classic Brenier-Knott Smith Theorem \cite[Subsection 1.3.1, Theorem 1.22]{Santambrogiolibro}. In \cite{FigalliRifford} the authors extend the same results to more general non-homogeneous settings. In \cite{JuilFig} Figalli and Juillet prove the absolute continuity of 2-Wasserstein geodesics, given the absolute continuity of one between the two marginal distributions. The first work on the Monge's problem in this setting is \cite{DePascale2} in which the authors proved the existence of solutions, while the same result was proven in more general metric spaces in \cite{Cavalletti3}, \cite{Cavalletti} and \cite{Cavalletti2}.

The paper is organized as follows: in Section 2 we introduce the Heisenberg Group; then we recall some known results on the optimal transport theory in this setting, which will be useful for the rest of the paper. In Section 3 we introduce the notion of  transport densities and provide conditions which ensure their $L^p$- summability. In Section 4 we show that an $L^p$ measure induces a weighted distance and, in Section 5, we introduce the problem of congested optimal transport and we prove the existence of equilibria.
\input{Preliminaries}
\input{transportdensity}
\input{congestedOT}
\section*{Acknowledgments}
The authors thank L. Brasco and A. Clop for the useful discussions, suggestions and corrections during the writing of the paper.
\printbibliography

\end{document}
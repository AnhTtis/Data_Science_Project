
This section contains some results about optimal transportation theory already known in the Heisenberg Group. In particular we collect some results on the Monge's problem, taken from \cite{DePascale2}.

Let $(M_1,d_1)$ and $(M_2,d_2)$ be two polish metric spaces, we denote by  $\mathcal{M}_+(M_1)$, resp. $\mathcal{M}_+(M_2)$, the set of positive and finite Radon measures on $M_1$, resp. $M_2$; furthermore we denote by $\mathcal{P}(M_1)$, resp. $\mathcal{P}(M_2)$, the set of Radon probability measures on $M_1$, resp. $M_2$. Given a Borel map $f:M_1\to M_2$, we denote by $f_{\#}:\mathcal{M}_+(M_1)\rightarrow\mathcal{M}_+(M_2)$ the push-forward operator: given $\mu\in\mathcal{M}_+(M_1)$, $f_{\#}\mu(A):=\mu(f^{-1}(A)), \forall A$ Borel set in $M_2$.


Let $\Omega\subset\mathbb{H}^{n}$ 
 be compact and geodesically convex, $\mu,\nu\in\mathcal{P}(\Omega)$, we denote by
\begin{equation*}
	\Pi(\mu,\nu)=\big{\{}\gamma\in\mathcal{P}(\Omega\times\Omega): (\pi_1)_{\#}\gamma=\mu, (\pi_2)_{\#}\gamma=\nu\big{\}}
\end{equation*}
the set of transport plans between $\mu$ and $\nu$, where $\pi_1$ and $\pi_2$ are the projection on the first and second factor, respectively. We observe that $\Pi(\mu,\nu)$ is compact w.r.t. the weak convergence of measures.

Given a lower semicontinuous cost function $c:\Omega\times \Omega \rightarrow [0,+\infty]$, the Kantorovich transport problem between $\mu$ and $\nu$ associated with the cost $c$
\begin{equation} \label{e:MK} 
	\inf_{\gamma \in \Pi(\mu,\nu)} \int_{\Omega\times\Omega} c(x,y)\,d\gamma(x,y),
\end{equation}
admits solutions. We denote by 
\begin{equation*}
	\Pi_c(\mu,\nu):=\{\gamma\in\Pi(\mu,\nu):\gamma \text{ solves } \eqref{e:MK}\}
\end{equation*}
the set of \textit{optimal transport plan} for the generic cost function $c$: it is a closed subset of the compact set $\Pi(\mu,\nu)$, w.r.t. the weak convergence of measures. Moreover, if $\gamma\in\Pi_c(\mu,\nu)$ and $\int_{\Omega\times\Omega}cd\gamma<+\infty$, then $\gamma$ is concentrated on a $c$-cyclically monotone set $\Gamma\subseteq\Omega\times\Omega$, i.e.
\begin{equation*}\label{c-CM}
	\sum_{i=1}^N c(x_i,y_i) \leq \sum_{i=1}^N c(x_{i+1},y_i)
\end{equation*}
whenever $N\geq 2$ and $(x_1,y_1), \dots, (x_N,y_N)\in\Gamma$. See  \cite[Chapter 1]{Santambrogiolibro}.

We say that a transport plan $\gamma\in \Pi(\mu,\nu)$ is \textit{induced by a transport map} if there exists a Borel map $T:\Omega\rightarrow \Omega$ such that $(I \otimes T)_\sharp\mu = \gamma$ where $(I \otimes T)(x) := (x,T(x))$. We will refer to a Borel map $T:\Omega\rightarrow\Omega$ solving \begin{equation}\label{mongepb}
	\inf_{T_{\#}\mu=\nu}\int_{\Omega}c(x,T(x))d\mu(x),
\end{equation}
as an \textit{optimal transport map} for the cost function $c$. One can observe that, if $\gamma\in\Pi_c(\mu,\nu)$ is induced by a transport map $T$, then $T$ is an optimal transport map for the cost $c$. Moreover, if any $\gamma\in\Pi_c(\mu,\nu)$ is induced by a transport, then there exists a unique optimal transport map. Hence also $\gamma\in\Pi_c(\mu,\nu)$ is unique.

When $c$ is a convex function of $d_{CC}$, it holds the following uniqueness result:
\begin{teo}\label{mainthmtris}
	If $\mu\ll\mathcal{L}^{2n+1}$ and $h:[0+\infty)\rightarrow[0,+\infty)$ is strictly convex and non decreasing, then for any optimal transport plan $\gamma\in\Pi_c(\mu,\nu)$ associated with the cost function $c:=h\circ d_{CC}$ there exists a Borel map $T:\Omega\rightarrow\Omega$ such that $T_{\#}\mu=\nu$. Hence, there exists a unique optimal transport map.
\end{teo}

See \cite[Theorem 5.3 and Corollary 5.4]{Cavalletti} for the proof.

When $c=d_{CC}$, from the arguments above it follows that the Kantorovich problem between $\mu$ and $\nu$ associated with the Carnot-CarathÃ©odory distance
\begin{equation}\label{MKH}
	\inf_{\gamma\in \Pi(\mu,\nu)} \int_{\Omega\times \Omega} d_{CC}(x,y)\,d\gamma(x,y),
\end{equation}
admits at least a solution, concentrated on a $d_{CC}$-cyclically monotone set. From now on we will denote by $\Pi_1(\mu,\nu)$ the set of optimal transport plan for the cost function $d_{CC}$ and by
\begin{equation}\label{lipset}
    \text{Lip}_1(\Omega, d_{CC}):=\left\{u:\Omega\to\mathbb{R}:|u(x)-u(y)|\leq d_{CC}(x,y),\forall x,y\in\Omega\right\}.
\end{equation}
It holds the following important theorem.
\begin{teo} \label{1lip_potential}
There exists a function $u\in \text{Lip}_1(\Omega,d_{CC})$, see \eqref{lipset}, so that
	\begin{equation*}
		 \min_{\gamma\in\Pi(\mu,\nu)}\int_{\Omega\times \Omega} d_{CC}(x,y)\,d\gamma(x,y) 
		= \int_{\Omega} u(x)\,d\mu(x) - \int_{\Omega} u(y)\,d\nu(y),
	\end{equation*}
	and 
	$\gamma\in \Pi(\mu,\nu)$ is optimal if and only if 
	\begin{equation*}
		u(x) - u(y) = d_{CC}(x,y)  \qquad \gamma-\text{a.e. in } \Omega\times\Omega.
	\end{equation*}
\end{teo}
We call such a $u\in\text{Lip}_1(\Omega,d_{CC})$ a \textit{Kantorovich potential}.

Thanks to the explicit representation of minimizing geodesics one can prove that, under the additional hypothesis of absolute continuity of $\mu$ with respect to the Haar measure of the group, any optimal transport plan is concentrated on the set $K\subseteq\Omega\times\Omega$ of pair of points connected by a unique minimizing geodesic, see \eqref{KAPPA} for its definition.
\begin{prop} \label{pi1.1}
	Let $\gamma\in \Pi_1(\mu,\nu)$ and assume that $\mu\ll\mathcal{L}^{2n+1}$. Then for $\gamma$-a.e. $(x,y)$, there exists a unique minimizing geodesic between $x$ and $y$.
\end{prop}
See \cite[Lemma 4.1]{DePascale2} for the proof. 

Let us fix $\gamma\in\Pi_1(\mu,\nu)$ and let us suppose that it is concentrated on $\Gamma\subseteq\Omega\times\Omega$. If $(x,y)\in\Gamma$ and $u$ is a Kantorovich potential, then $u(x)-u(y)=d_{CC}(x,y)$. If $S(x,y)$ is a minimizing geodesic between $x=\sigma(0)$ and $y=\sigma(1)$, then it holds that
\begin{equation*}\label{condition1}
	u(z)=u(x)-d_{CC}\left(x,S_t(x,y)\right),\quad\forall t[0,1].
\end{equation*}
In this way one can define an order relation on $S(x,y)$ in the following way: let $t_1,t_2\in[0,1]$, $x'=S_{t_1}(x,y)$ and $x'':=S_{t_2}(x,y)$, then
\begin{equation*}\label{orderrelation}
	x'\leq x''\Leftrightarrow u(x')\geq u(x'').
\end{equation*}

In order to find some distinguished elements of $\Pi_1(\mu,\nu)$, we denote by 
$\Pi_2(\mu,\nu)$ the set of transport plans solving the secondary variational problem
\begin{equation}\label{secvarpb}
	\inf_{\gamma \in \Pi_1(\mu,\nu)} \int_{\Omega\times\Omega} d_{CC}(x,y)^2\,d\gamma(x,y).
\end{equation}
This problem admits solutions since the functional $\gamma\mapsto\int_{\Omega\times\Omega}d_{CC}(x,y)^2\,d\gamma(x,y)$  is continuous w.r.t. the weak convergence of measures and $\Pi_1(\mu,\nu)$ is compact w.r.t. the same convergence. One can rephrase this problem as a classical Kantorovich transport problem \eqref{e:MK} between $\mu$ and $\nu$ with cost $c(x,y) = \beta(x,y)$, where 
\begin{equation*}
	\beta(x,y) = \begin{cases}
		d_{CC}(x,y)^2 \quad \text{if } u(x)-u(y) = d_{CC}(x,y),\\
		+\infty \qquad \phantom{\text{if}} \text{otherwise},
	\end{cases}
\end{equation*}
where $u\in \text{Lip}_1(\Omega,d_{CC})$ is a Kantorovich potential for the cost $d_{CC}(x,y)$. Since $\beta$ is lower semicontinuous and $\int_{\Omega\times \Omega} \beta(x,y) \,d\gamma(x,y)<+\infty$ for all $\gamma \in \Pi_2(\mu,\nu)$, it follows that any $\gamma \in \Pi_2(\mu,\nu)\subset\Pi_1(\mu,\nu)$ is concentrated on a $\beta$-cyclically monotone set $\Gamma$, i.e.
\begin{equation}\label{var2}
	\beta(x,y) +\beta(x',y') \leq \beta(x,y')+\beta(x',y),\quad \forall (x,y),(x',y')\in \Gamma,
\end{equation}
 such that 
\begin{equation}\label{var1}
	u(x) - u(y) = d_{CC}(x,y), \quad \forall (x,y)\in \Gamma.
\end{equation}

Using the non-branching property of $(\mathbb{H}^n,d_{CC})$ one can prove that minimizing geodesics used by an optimal transport plan cannot bifurcate. Moreover, if an optimal plan solves also \eqref{secvarpb} then, using \eqref{var1} and \eqref{var2}, one can get a one-dimensional monotonicity condition along minimizing geodesics. More precisely, it holds the following result \cite[Lemma 4.2 and Lemma 4.3]{DePascale2}:
\begin{prop}\label{monotone}
	Let $\gamma\in \Pi_1(\mu,\nu)$. Then $\gamma$ is concentrated on a set $\Gamma$ such that for all $(x,y)$, $(x',y')\in \Gamma$ such that $x\not=y$ and $x\not=x'$, if $x'$ lies on a minimizing geodesic between $x$ and $y$ then all points $x$, $x'$, $y$ and $y'$ lie on the same minimizing geodesic.
	
	Moreover if $\gamma\in \Pi_2(\mu,\nu)$, then the condition $x<x'$ implies $y\leq y'$.
\end{prop} 


As far as we know, in the Heisenberg Group has not been proven that any $\gamma\in\Pi_2(\mu,\nu)$ is induced by a transport map, and hence $\gamma\in\Pi_2(\mu,\nu)$ is unique. See \cite[Theorem 3.18]{Santambrogiolibro} for the analogous result in the Euclidean setting. Anyway in \cite{DePascale2} the authors proved that some particular transport plan in $\Pi_2(\mu,\nu)$, more precisely the ones that can be selected through the variational approximation below, are induced by transport maps.

Now in the spirit of \cite[Section 3.1]{Santambrogiolibro} and \cite[Section 5]{DePascale2}, one can introduce a variational approximation procedure, that will allow to select optimal transport plans in $\Pi_2(\mu,\nu)$ induced by transport maps.
\\
More precisely, denoted by
\begin{equation*}
	\Pi:=\{\gamma\in\mathcal{P}(\Omega\times\Omega): (\pi_1)_{\#}\gamma=\mu\},
\end{equation*}
for $\varepsilon\in\mathbb{R}^+$, we can consider the family of minimization problems

\begin{equation}\tag{$P_{\varepsilon}$}\label{varapprox} 
	\min\{C_\varepsilon(\gamma):\gamma\in\Pi\},
\end{equation}
where
\begin{multline*}
	C_{\varepsilon}(\gamma):=\frac{1}{\varepsilon}\, W_1((\pi_2)_\sharp\gamma,\nu) + \int_{\Omega\times\Omega} d_{CC}(x,y)\,d\gamma(x,y) \\ +  \varepsilon \int_{\Omega\times\Omega} d_{CC}(x,y)^2\,d\gamma(x,y) + \varepsilon^{6n+8} \textnormal{card}{(\textnormal{supp}({(\pi_2)_\sharp\gamma}))},
\end{multline*}
where $W_1((\pi_2)_\sharp\gamma,\nu)$ denotes the \textit{1-Wasserstein distance} between the two measures $(\pi_2)_\sharp\gamma$ and $\nu$,
\begin{equation*}
    W_1((\pi_2)_\sharp\gamma,\nu):=\min\left\{\int_{\Omega\times\Omega}d_{CC}(x,y)d\gamma(x,y):\gamma\in\Pi((\pi_2)_\sharp\gamma,\nu)\right\}.
\end{equation*}
One can prove that, for any $\varepsilon>0$ the minimization problem \ref{varapprox} admits at least one finite solution.
Moreover it holds the following result:

\begin{lemma} \label{optpi2}
	Let $(\varepsilon_k)_{k\in\mathbb{N}}\subset\mathbb{R}^+$ be a sequence such that $\varepsilon_k\underset{k\rightarrow\infty}{\longrightarrow}0$ and $\gamma_{\varepsilon_k}$ be a solution to $(P_{\varepsilon_k})$ $\forall k$, such that $\gamma_{\varepsilon_k}\rightharpoonup\gamma\in\mathcal{P}(\Omega\times\Omega)$. Then $\nu_{\varepsilon_k}:=(\pi_2)_\sharp \gamma_{\varepsilon_k}\rightharpoonup\nu$ and $\gamma \in \Pi_2(\mu,\nu)$.
\end{lemma}
 
The following theorem (\cite[Theorem 8.1]{DePascale2}) guarantees that this kind of optimal plans are induced by transport maps and then will give a solution to \eqref{mongepb}.
\begin{teo}\label{mainthmbis} Assume that $\mu\ll\mathcal{L}^{2n+1}$. Let $\varepsilon_k$ be a sequence converging to $0$ and $\gamma_{\varepsilon_k}$ a sequence of solution to $(P_{\varepsilon_k})$, weakly converging to $\gamma\in\mathcal{P}(\Omega\times\Omega)$. Then there exists a transport map $T:\Omega\rightarrow\Omega$ such that $\gamma=(\textnormal{Id}\otimes T)_\#\mu$. 
\end{teo}


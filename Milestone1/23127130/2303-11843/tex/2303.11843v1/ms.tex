\documentclass[11pt]{article} %
\usepackage[margin=1in]{geometry}

\usepackage{bm}
\usepackage{multirow}
\usepackage{comment}
\usepackage{csquotes}
\usepackage{booktabs}
\usepackage{tablefootnote}
\usepackage[colorlinks=true, linkcolor=blue, urlcolor=blue, citecolor=ForestGreen]{hyperref}
\usepackage{float}
\usepackage{framed}
\usepackage[linesnumbered,boxruled,vlined,noend]{algorithm2e}
\usepackage{verbatim}
\usepackage{amssymb,amsfonts,amsmath,amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm} %
\usepackage{thmtools,thm-restate} %

\usepackage{enumerate}
\usepackage{footnote}
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{color}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{tabulary}
\usepackage{diagbox}
\usepackage[dvipsnames]{xcolor}
\usepackage{pgfplots}
\usepackage{comment}
\usepackage{setspace}
\usepackage[capitalise]{cleveref} %
\usepackage{crossreftools}
\usepackage{xparse}
\bibliographystyle{alpha}



\usepackage[inline]{enumitem}
\newlist{inenum}{enumerate*}{1}
\setlist[inenum]{label=(\roman*)}
\newlist{compitem}{itemize}{3}
\setlist[compitem]{label=\textbullet,nosep}

\usepackage[draft,inline,marginclue]{fixme}
\FXRegisterAuthor{hf}{ahf}{\color{Green}Hendrik}

\global\long\def\apx{\mathsf{apx}}
\SetKwProg{Fn}{Function}{}{}
\SetKwRepeat{Do}{do}{while}

\def\defeq{:=}
\NewDocumentCommand{\card}{m}{%
	\lvert #1 \rvert%
}
\NewDocumentCommand{\dmax}{}{%
	\Delta%
}

\newcommand{\costbound}{\ensuremath{\OPT'}}
\NewDocumentCommand{\cost}{o m O{k} o}{%
	\mathrm{cost}\IfNoValueF{#4}{^{#4}}_{#3}(#2\IfNoValueF{#1}{, #1})%
}
\NewDocumentCommand{\opt}{m O{k}}{%
	\mathrm{opt}_{#2}(#1)%
}

\def\adv/{\textsc{Adv}}
\def\alg/{\textsc{Alg}}
\NewDocumentCommand{\auxgraph}{m o o}{%
	#1%
	\IfNoValueF{#2}{_{#2%
			\IfNoValueF{#3}{,#3}%
	}}%
}
\NewDocumentCommand{\auxnum}{m o o}{%
	\lvert {#1}%
	\IfNoValueF{#2}{_{#2%
			\IfNoValueF{#3}{,#3}%
	}} \rvert%
}
\NewDocumentCommand{\kg}{o o}{%
	\auxgraph{G}[#1][#2]%
}
\NewDocumentCommand{\actno}{o o}{%
	\auxgraph{A}[#1][#2]%
}
\NewDocumentCommand{\actnum}{o o}{%
	\auxnum{A}[#1][#2]%
}
\NewDocumentCommand{\pasno}{o o}{%
	\auxgraph{P}[#1][#2]%
}
\NewDocumentCommand{\pasnum}{o o}{%
	\auxnum{P}[#1][#2]%
}
\NewDocumentCommand{\disno}{o o}{%
	\auxgraph{D}[#1][#2]%
}
\NewDocumentCommand{\disnum}{o o}{%
	\auxnum{D}[#1][#2]%
}
\NewDocumentCommand{\akg}{o o}{%
	\auxgraph{H}[#1][#2]%
}
\NewDocumentCommand{\s}{o}{%
	\sigma%
	\IfNoValueF{#1}{_{#1}}%
}
\NewDocumentCommand{\allpoints}{m}{%
	Q%
	\IfNoValueF{#1}{_{#1}}%
}
\NewDocumentCommand{\points}{m}{%
	P%
	\IfNoValueF{#1}{_{#1}}%
}
\NewDocumentCommand{\spr}{m}{%
	\s[\leq #1]%
}
\NewDocumentCommand{\sprs}{m}{%
	\s[< #1]%
}
\NewDocumentCommand{\q}{o o}{%
	q%
	\IfNoValueF{#1}{_{#1%
			\IfNoValueF{#2}{,#2}%
	}}
}
\NewDocumentCommand{\V}{m}{%
	V(#1)%
}
\NewDocumentCommand{\E}{m}{%
	E(#1)%
}
\NewDocumentCommand{\ngh}{o m}{%
	\Gamma%
	\IfNoValueF{#1}{_{#1}}%
	(#2)%
}
\NewDocumentCommand{\dg}{o m}{%
	\operatorname{deg}%
	\IfNoValueF{#1}{_{#1}}%
	(#2)%
}
\NewDocumentCommand{\dsp}{o m m}{%
	d%
	\IfNoValueF{#1}{_{#1}}%
	(#2, #3)%
}
\NewDocumentCommand{\ans}{m}{%
	\textrm{ans}(#1)%
}


\declaretheoremstyle[
bodyfont=\normalfont\itshape,
]{normal_style}
\declaretheoremstyle[
headfont=\normalfont\itshape,
notefont=\normalfont\itshape,
qed=\qedsymbol
]{proof_style}


\declaretheorem[
name=Question,
style=normal_style]{question}
\declaretheorem[
name=Theorem,
style=normal_style]{theorem}
\declaretheorem[
name=Corollary,
numberlike=theorem,
style=normal_style]{corollary}
\declaretheorem[
name=Lemma,
numberlike=theorem,
style=normal_style]{lemma}
\declaretheorem[
name=Claim,
numberlike=theorem,
style=normal_style]{claim}
\declaretheorem[
name=Observation,
numberlike=theorem,
style=normal_style]{observation}
\declaretheorem[
name=Proposition,
numberlike=theorem,
style=normal_style]{proposition}
\declaretheorem[
name=Definition,
numberlike=theorem,
style=normal_style]{definition}
\makeatletter
\let\proof\@undefined
\let\endproof\@undefined
\makeatother
\declaretheorem[
name=Proof,
numbered=no,
style=proof_style]{proof}

\def\xth/{%
	\textsuperscript{th}%
}

\pdfstringdefDisableCommands{%
	\let\Cref\crtCref
	\let\cref\crtcref
}




\newcommand{\leads}{\boldsymbol{\Lambda}}
\newcommand{\merge}{\texttt{Merge}}
\newcommand{\Split}{\texttt{Split}}
\newcommand{\trim}{\texttt{Trim}}
\newcommand{\delete}{\texttt{Delete}}
\newcommand{\level}{\operatorname{{\bf level}}}
\newcommand{\step}{\gamma}
\newcommand{\tree}{\boldsymbol{T}}
\newcommand{\depth}{\operatorname{{\bf depth}}}
\newcommand{\oS}{\bar{S}}
\newcommand{\run}{\textsc{Runtime}(\bcA)}
\newcommand{\bank}{\textsc{bank}}
\newcommand{\pay}{\textsc{Pay}}
\newcommand{\ANN}{\ttx{AllNeighbors}}
\newcommand{\ins}{\ttx{Insert}}


\newcommand{\poly}{\operatorname{poly}}
\newcommand{\polylog}{\operatorname{polylog}}
\newcommand{\median}{\mathrm{median}}
\newcommand{\Proj}{\mathrm{Proj}} 
\newcommand{\LFMIS}{\operatorname{LFMIS}} 
\newcommand{\elim}{\operatorname{elim}} 
\newcommand{\OPT}{\operatorname{OPT}} 
\newcommand{\ALG}{\mathcal{L}_{k+1}} 
\newcommand{\Run}{\operatorname{Time}}

\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}

\newcommand{\std}{\operatorname{{\bf std}}}
\newcommand{\Cov}{\operatorname{{\bf Cov}}}
\newcommand{\Varx}{\mathop{{\bf Var}\/}}
\newcommand{\Ex}{\mathop{{\bf E}\/}}
\newcommand{\Exp}{\mathop{{Exp}\/}}
\newcommand{\ex}[1]{\mathop{{\bf E}\left[ #1 \right]}}
\newcommand{\exx}[2]{\mathop{{\bf E}}_{#1}\left[ #2 \right]}
\newcommand{\bex}[1]{\mathop{{\bf E}\left[ #1 \right]}}
\newcommand{\Var}[1]{\mathop{{\bf Var}\left( #1 \right)}}
\newcommand{\bvar}[1]{\mathop{{\bf Var}\left( #1 \right)}}
\newcommand{\pr}[1]{\operatorname{{\bf Pr}}\left[ #1 \right]}
\newcommand{\prb}[2]{\mathop{{\bf Pr}}_{#1}\left[ #2 \right]}
\newcommand{\bpr}[1]{\operatorname{{\bf Pr}}\left[ #1 \right]}


\newcommand{\rajesh}[1]{{\color{purple}[Rajesh: #1]}}
\newcommand{\mhb}[1]{{\color{blue}[MHB: #1]}}
\newcommand{\aw}[1]{{\color{orange}#1}}
\newcommand{\TODO}[1]{ {\color{red} TODO: #1}}
\def\rem#1{{\marginpar{\raggedright\scriptsize #1}}}
\newcommand{\awr}[1]{\rem{\textcolor{orange}{#1}}}
\newcommand{\hf}[1]{{\color{Green}#1}}

\renewcommand{\awr}[1]{}
\renewcommand{\aw}[1]{#1}

 
\newcommand{\bA}{\mathbf{A}}
\newcommand{\bB}{\mathbf{B}}
\newcommand{\bC}{\mathbf{C}}
\newcommand{\bD}{\mathbf{D}}
\newcommand{\bE}{\mathbf{E}}
\newcommand{\bF}{\mathbf{F}}
\newcommand{\bG}{\mathbf{G}}
\newcommand{\bH}{\mathbf{H}}
\newcommand{\bI}{\mathbf{I}}
\newcommand{\bJ}{\mathbf{J}}
\newcommand{\bK}{\mathbf{K}}
\newcommand{\bL}{\mathbf{L}}
\newcommand{\bM}{\mathbf{M}}
\newcommand{\bN}{\mathbf{N}}
\newcommand{\bO}{\mathbf{O}}
\newcommand{\bP}{\mathbf{P}}
\newcommand{\bQ}{\mathbf{Q}}
\newcommand{\bR}{\mathbf{R}}
\newcommand{\bS}{\mathbf{S}}
\newcommand{\bT}{\mathbf{T}}
\newcommand{\bU}{\mathbf{U}}
\newcommand{\bV}{\mathbf{V}}
\newcommand{\bW}{\mathbf{W}}
\newcommand{\bX}{\mathbf{X}}
\newcommand{\bY}{\mathbf{Y}}
\newcommand{\bZ}{\mathbf{Z}}

\newcommand{\boldf}{\boldsymbol{f}} %
\newcommand{\ba}{\boldsymbol{a}}
\newcommand{\bb}{\boldsymbol{b}}
\newcommand{\bc}{\boldsymbol{c}}
\newcommand{\bd}{\boldsymbol{d}}
\newcommand{\be}{\boldsymbol{e}}
\newcommand{\bg}{\boldsymbol{g}}
\newcommand{\bh}{\boldsymbol{h}}
\newcommand{\bi}{\boldsymbol{i}}
\newcommand{\bj}{\boldsymbol{j}}
\newcommand{\bk}{\boldsymbol{k}}
\newcommand{\boldn}{\boldsymbol{n}}
\newcommand{\bp}{\boldsymbol{p}}
\newcommand{\bq}{\boldsymbol{q}}
\newcommand{\boldr}{\boldsymbol{r}} %
\newcommand{\bs}{\boldsymbol{s}}
\newcommand{\bt}{\boldsymbol{t}}
\newcommand{\bu}{\boldsymbol{u}}
\newcommand{\bv}{\boldsymbol{v}}
\newcommand{\bw}{\boldsymbol{w}}
\newcommand{\bx}{\boldsymbol{x}}
\newcommand{\by}{\boldsymbol{y}}
\newcommand{\bz}{\boldsymbol{z}}


\newcommand{\balpha}{\boldsymbol{\alpha}}
\newcommand{\bbeta}{\boldsymbol{\beta}}
\newcommand{\bsigma}{\boldsymbol{\sigma}}
\newcommand{\bpi}{\boldsymbol{\pi}}
\newcommand{\bell}{\boldsymbol{\ell}}
\newcommand{\bnu}{\boldsymbol{\nu}}
\newcommand{\bmu}{\boldsymbol{\mu}}
\newcommand{\bxi}{\boldsymbol{\xi}}
\newcommand{\btau}{\boldsymbol{\tau}} 
\newcommand{\brho}{{\boldsymbol{\rho}} }
\newcommand{\bgamma}{{\boldsymbol{\gamma}} }
\newcommand{\bphi}{{\boldsymbol{\varphi}} }
\newcommand{\bchi}{\boldsymbol{\chi}}
\newcommand{\beps}{\boldsymbol{\eps}}
\newcommand{\bzeta}{\boldsymbol{\zeta}}
\newcommand{\bdelta}{\boldsymbol{\delta}}

\newcommand{\bSigma}{\boldsymbol{\Sigma}}
\newcommand{\bDelta}{\boldsymbol{\Delta}}
\newcommand{\bPi}{\boldsymbol{\Pi}}
\newcommand{\bGamma}{{\mathbf{\Gamma}} }
\newcommand{\bvsigma}{{\boldsymbol{\varsigma}} }
\newcommand{\bvrho}{{\boldsymbol{\varrho}}}


\newcommand{\cA}{\mathcal{A}}
\newcommand{\cB}{\mathcal{B}}
\newcommand{\cC}{\mathcal{C}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cE}{\mathcal{E}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cG}{\mathcal{G}}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\cI}{\mathcal{I}}
\newcommand{\cJ}{\mathcal{J}}
\newcommand{\cK}{\mathcal{K}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cN}{\mathcal{N}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\cQ}{\mathcal{Q}}
\newcommand{\cR}{\mathcal{R}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\cT}{\mathcal{T}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\cV}{\mathcal{V}}
\newcommand{\cW}{\mathcal{W}}
\newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}}
\newcommand{\cZ}{\mathcal{Z}}

\newcommand{\bcA}{\boldsymbol{\mathcal{A}}}
\newcommand{\bcB}{\boldsymbol{\mathcal{B}}}
\newcommand{\bcC}{\boldsymbol{\mathcal{C}}}
\newcommand{\bcD}{\boldsymbol{\mathcal{D}}}
\newcommand{\bcE}{\boldsymbol{\mathcal{E}}}
\newcommand{\bcF}{\boldsymbol{\mathcal{F}}}
\newcommand{\bcG}{\boldsymbol{\mathcal{G}}}
\newcommand{\bcH}{\boldsymbol{\mathcal{H}}}
\newcommand{\bcI}{\boldsymbol{\mathcal{I}}}
\newcommand{\bcJ}{\boldsymbol{\mathcal{J}}}
\newcommand{\bcK}{\boldsymbol{\mathcal{K}}}
\newcommand{\bcL}{\boldsymbol{\mathcal{L}}}
\newcommand{\bcM}{\boldsymbol{\mathcal{M}}}
\newcommand{\bcN}{\boldsymbol{\mathcal{N}}}
\newcommand{\bcO}{\boldsymbol{\mathcal{O}}}
\newcommand{\bcP}{\boldsymbol{\mathcal{P}}}
\newcommand{\bcQ}{\boldsymbol{\mathcal{Q}}}
\newcommand{\bcR}{\boldsymbol{\mathcal{R}}}
\newcommand{\bcS}{\boldsymbol{\mathcal{S}}}
\newcommand{\bcT}{\boldsymbol{\mathcal{T}}}
\newcommand{\bcU}{\boldsymbol{\mathcal{U}}}
\newcommand{\bcV}{\boldsymbol{\mathcal{V}}}
\newcommand{\bcW}{\boldsymbol{\mathcal{W}}}
\newcommand{\bcX}{\boldsymbol{\mathcal{X}}}
\newcommand{\bcY}{\boldsymbol{\mathcal{Y}}}
\newcommand{\bcZ}{\boldsymbol{\mathcal{Z}}}


\newcommand{\eps}{\epsilon} 
\newcommand{\ttx}[1]{\texttt{#1}}
\newcommand{\ab}{\allowbreak}



\usepackage[framemethod=TikZ]{mdframed}
\newcounter{Frame}
\newenvironment{Frame}[1][h]{%
	\refstepcounter{Frame}
	\begin{mdframed}[%
		frametitle={#1},
		skipabove=\baselineskip plus 2pt minus 1pt,
		skipbelow=\baselineskip plus 2pt minus 1pt,
		linewidth=1.0pt,
		frametitlerule=true,
		]%
	}{%
	\end{mdframed}
}



\title{Optimal Fully Dynamic $k$-Center Clustering for Adaptive and Oblivious Adversaries} %
\author{
	MohammadHossein Bateni\\
	Google Research \\
	\texttt{bateni@google.com}
	\and
Hossein Esfandiari \\
Google Research \\
	\texttt{esfandiari@google.com}
	\and 
	Hendrik Fichtenberger\\
	Google Research	\\
	\texttt{fichtenberger@google.com}
	\and
	Monika Henzinger \\
	University of Vienna \\
	\texttt{monika.henzinger@univie.ac.at}
	\thanks{This project has received funding from the European Research Council (ERC) under the European Union's
		\begin{wrapfigure}{r}{2cm}%
			\includegraphics[width=2cm]{LOGO_ERC-FLAG_EU_crop.jpg}%
		\end{wrapfigure}%
		Horizon 2020 research and innovation programme (Grant agreement No. 101019564 ``The Design of Modern Fully Dynamic Data Structures (MoDynStruct)'' and from the Austrian Science Fund (FWF) project ``Fast Algorithms for a Reactive Network Layer (ReactNet)'', P~33775-N, with additional funding from the \textit{netidee SCIENCE Stiftung}, 2020--2024.}
	\and
	Rajesh Jayaram \\
	Google Research\\
	\texttt{rkjayaram@google.com} 
	\and
	Vahab Mirrokni\\
	Google Research\\
	\texttt{mirrokni@google.com}
	\and 
	Andreas Wiese \\
	Technical University of Munich\\
	\texttt{andreas.wiese@tum.de}
}
\newcommand*\samethanks[1][\value{footnote}]{\footnotemark[#1]}
\date{}

\begin{document}
\maketitle

	\begin{abstract}
	In fully dynamic clustering problems, a clustering of a given data set in a metric space must be maintained while it is modified through insertions and deletions of individual points.
		In this paper, we resolve the complexity of fully dynamic $k$-center clustering against both adaptive and oblivious adversaries. Against oblivious adversaries, we present the first algorithm for fully dynamic $k$-center in an arbitrary metric space that maintains an optimal $(2+\epsilon)$-approximation in $O(k \cdot  \mathrm{polylog}(n,\Delta))$ amortized update time. Here, $n$ is an upper bound on the number of active points at any time, and $\Delta$ is the aspect ratio of the metric space. Previously, the best known amortized update time was $O(k^2\cdot \mathrm{polylog}(n,\Delta))$, and is due to Chan, Gourqin, and Sozio (2018). Moreover, we demonstrate that our runtime is optimal up to $\mathrm{polylog}(n,\Delta)$ factors. In fact, we prove that even offline algorithms for $k$-clustering tasks in arbitrary metric spaces, including $k$-medians, $k$-means,  and $k$-center, must make at least $\Omega(n k)$ distance queries to achieve any non-trivial approximation factor. This implies a lower bound of $\Omega(k)$ which holds even for the insertions-only setting.
		
		For adaptive adversaries, we give the first deterministic algorithm for fully dynamic $k$-center which achieves a $O\left( \min\left\{\frac{\log(n/k)}{\log \log n},k\right\}\right)$ approximation in $O(k \cdot  \mathrm{polylog}(n,\Delta))$ amortized update time. Further, we demonstrate that any algorithm which achieves a $O\left( \min\left\{\frac{\log n}{ k \log f(k,2n)},k\right\}\right)$-approximation against adaptive adversaries requires $f(k,n)$ update time, for any arbitrary function $f$. Thus, in the regime where $k = O(\sqrt{\frac{\log n }{\log \log n}})$, we close the complexity of the problem up to $\mathrm{polylog}(n, \Delta)$ factors in the update time. Our lower bound extends to other $k$-clustering tasks in arbitrary metric spaces, including $k$-medians and $k$-means.
		
	
		
		Finally, despite the aforementioned lower bounds, we demonstrate that an update time sublinear in $k$ is possible against oblivious adversaries for metric spaces which admit locally sensitive hash functions (LSH), resulting in improved algorithms for a large class of metrics including Euclidean space, $\ell_p$-spaces, the Hamming Metric, and the Jaccard Metric. We also give the first fully dynamic $O(1)$-approximation algorithms for the closely related $k$-sum-of-radii and $k$-sum-of-diameter problems, with $O(\mathrm{poly}(k,\log \Delta))$ update time. 
		
	\end{abstract}
	
\thispagestyle{empty}
\newpage
\tableofcontents
\thispagestyle{empty}
\newpage

\pagenumbering{arabic}
\setcounter{page}{1}

\input{intro-new}
\input{Techniques}
\input{Prelims}
\input{kCenters}
\input{NewConstantApprox}
\input{LSHSpaces}
\input{Deterministic2}
\input{SumOfRadii}
\input{LowerBound}
\input{LowerBoundAdversarial}

\bibliography{cluster}
\end{document}

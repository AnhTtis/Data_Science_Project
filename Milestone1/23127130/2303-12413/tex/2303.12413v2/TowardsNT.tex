%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                          %%
%% Tame homeomorphisms of surfaces of infinite type                         %%
%%                                                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%section{Preamble}

  \documentclass[11pt]{amsart}

  \usepackage[margin=3cm]{geometry}
  \usepackage{latexsym}
  \usepackage{comment}
  \usepackage{amsmath,amsthm,amsfonts,amssymb,graphicx,epsfig,latexsym,float}
  \usepackage[dvipsnames]{xcolor}
  \definecolor{PrettyGreen}{RGB}{0, 200, 0}
  \definecolor{FigGreen}{RGB}{0, 180, 0}
  \definecolor{FigLightBlue}{RGB}{0, 170, 255}
  \definecolor{DarkerBlue}{RGB}{0, 130, 255}
  
  \usepackage{epsf,enumerate}
  \usepackage{overpic}  
  \usepackage[normalem]{ulem}

  \usepackage[breaklinks,colorlinks=true,allcolors=BurntOrange]{hyperref}

 % \usepackage[notcite,notref]{showkeys}
  
  \makeatletter
  \def\paragraph{\@startsection{paragraph}{4}%
    \z@\z@{-\fontdimen2\font}%
    {\normalfont\bfseries}}
  \makeatother

  \def\rank{\operatorname{rank}}
  \def\int{\operatorname{int}}
  \newcommand{\diagclosure}[1]{\langle\!\langle #1\rangle\!\rangle}

  \newtheorem{thm}{Theorem}[section]
  \newtheorem{lemma}[thm]{Lemma}
  \newtheorem{claim}[thm]{Claim}
  \newtheorem{cor}[thm]{Corollary}
  \newtheorem{prop}[thm]{Proposition}
  \newtheorem*{main}{Main Theorem}{}
  \newtheorem*{rrt}{Rank Rigidity Theorem}{}

  \newtheorem{thmintro}{Theorem}
  \renewcommand*{\thethmintro}{\Alph{thmintro}}
  \newtheorem{conj}[thmintro]{Conjecture}
  \newtheorem{propintro}[thmintro]{Proposition}
  
  \theoremstyle{remark}
  \newtheorem{example}[thm]{Example}
  \newtheorem{exercise}[thm]{Exercise}
  \newtheorem{definition}[thm]{Definition}
  \newtheorem{remark}[thm]{Remark}
  \newtheorem{examples}[thm]{Examples}
  \newtheorem*{definition*}{Definition}
  \newtheorem*{remark*}{Remark}
  \newtheorem{question}[thm]{Question}
  
  \newcommand{\mb}[1]{\marginpar{\color{blue}\tiny #1 --mb}}

  \newcommand{\ff}[1]{\marginpar{\color{olive}\tiny #1 --ff}}

  \newcommand{\jt}[1]{\marginpar{\color{violet}\tiny #1 --jt}}
  
  \newcommand{\note}[1]{{\color{orange} #1}}
  \newcommand\red[1]{{\color{red}#1}}
  \newcommand{\gray}[1]{{\color{gray} #1}}
  \newcommand\blue[1]{{\color{blue}#1}}

  \bibliographystyle{plain}   %plain

  \def\R{{\mathbb R}}
  \def\Q{{\mathbb Q}}
  \def\Z{{\mathbb Z}}
  \def\N{{\mathbb N}}
  \def\H{{\mathbb H}}  
  \def\G{{\Gamma}}
  \def\S{{\mathcal S}}
  \def\D{{\mathcal D}}
  \def\s{{\sigma}}
  \def\t{{\tau}}
  \def\e{{\varepsilon}}
  \def\F{{\mathcal F}}
  \def\X{{\mathcal X}}
  \def\P{{\mathcal P}}
  \def\pa{pseudo-Anosov\ }
  \def\diam{\operatorname{diam}}
  \def\spec{\operatorname{spec}}
  \def\stab{\operatorname{Stab}}
  \def\diag{\operatorname{diag}}
  \def\SL{\operatorname{SL}}
  \def\GL{\operatorname{GL}}
  \def\Sym{\operatorname{Sym}}
  \def\FF{{\mathbb F}}
  \def\A{{\mathcal A}}
  \def\l{{\lambda}}
  \def\C{{\mathcal C}}
  \def\Cper{{\mathcal C}_{\text{per}}}
  \def\Cinf{{\mathcal C}_\infty}
  \def\PSL{{PS}}
  \def\PSper{\tilde{S}_{\text{per}}}
  \def\Sper{{S}_{\text{per}}}
  \def\PS0{\tilde{S}_0}
  \def\Sinf{{S}_\infty}
  \DeclareMathOperator{\Ends}{Ends}
  \DeclareMathOperator{\interior}{int}
  \DeclareMathOperator{\mcg}{Map}
  \newcommand{\Cis}{\C_{\text{is}}}
  \newcommand{\Cint}{\C_{\text{int}}}
  \newcommand{\Ca}{\C_{\text{a}}}

  \newcommand{\<}{\langle}
  \renewcommand{\>}{\rangle}
  \renewcommand{\L}{\mathcal{L}}
  \newcommand{\st}{\;|\;}
  \newcommand{\ssm}{\smallsetminus}
  \newcommand{\Teich}{Teichm\"uller }
  
  \begin{document}

%section{Title and abstract}

  \title[Towards Nielsen--Thurston classification]{Towards
  Nielsen--Thurston classification\\ for surfaces of infinite type}
  
  \author{Mladen Bestvina}
  \address{Dept of Math, Univ of Utah, Salt Lake City, UT 84112, USA}
  \email{bestvina@math.utah.edu}
  \author{Federica Fanoni}
  \address{CNRS, Univ Paris Est Creteil, Univ Gustave Eiffel, LAMA UMR8050,
  F-94010 Creteil, France}
  \email{federica.fanoni@u-pec.fr} 
  \author{Jing Tao}
  \address{Dept of Math, Univ of Oklahoma, Norman, OK 73019, USA}
  \email{jing@ou.edu}
  
  \date{\today}

  \begin{abstract}
    We introduce and study tame homeomorphisms of surfaces of infinite
    type. These are maps for which curves under iterations do not
    accumulate onto geodesic laminations with non-proper leaves, but rather
    just a union of possibly intersecting curves or proper lines. Assuming
    an additional finiteness condition on the accumulation set, we prove a
    Nielsen--Thurston type classification theorem. We prove that for such
    maps there is a canonical decomposition of the surface into invariant
    subsurfaces on which the first return is either periodic or a
    translation.
  \end{abstract}
   
  \thispagestyle{empty}

  \maketitle

\section{Introduction}

  In this paper, we study the isotopy classes of self-homeomorphisms, or
  mapping classes, of a connected and oriented surface $S$ of
  \emph{infinite} type. The Nielsen--Thurston classification theorem for
  mapping classes of surfaces of finite type states that a mapping class is
  either periodic, reducible, or pseudo-Anosov. By Nielsen realization, a
  periodic class is represented by an isometry of some hyperbolic metric on
  $S$. On the other hand, a pseudo-Anosov map preserve a pair of
  transverse geodesic laminations that are minimal and filling. In the
  reducible case, $S$ can be decomposed along an invariant multicurve such
  that the first return map to a complementary subsurface is either
  periodic or pseudo-Anosov. The long-term goal of this project is to
  extend this understanding to surfaces of infinite type. Here, we
  introduce the notion of \emph{tame} maps and prove a structure theorem
  for the subclass of \emph{extra tame} maps.
	
  To motivate our definitions, let's first consider the various approaches
  to the Nielsen--Thurston classification and how they may generalize to
  surfaces of infinite type. Thurston's original proof
  \cite{thurston_geometry,flp_travaux} finds a fixed point in the
  compactified \Teich space. Bers' proof \cite{bers_extremal} also uses
  \Teich space, but from the point of view of extremal quasiconformal maps.
  Casson's proof \cite{cb_automorphisms} finds an invariant geodesic
  lamination by iterating a curve, and Nielsen's original approach
  \cite{Nielsen_UntersuchungenI, Nielsen_UntersuchungenII,
  Nielsen_UntersuchungenIII}, completed by Miller \cite{miller} and
  Handel--Thurston \cite{ht_new}, analyzes the dynamics of the action on
  the circle at infinity of the lifts to the universal cover. The
  Bestvina--Handel proof \cite{BH} looks for efficient spines of the
  surface leading to invariant train tracks, and relies on the
  Perron--Frobenius theorem. 

  In the infinite-type setting, \Teich space is very complicated: in
  particular, it is infinite-dimensional, and has uncountably many
  connected components and there are maps that do not preserve any
  component. So it is hard to imagine how one could adapt Thurston's or
  Bers' approach to the infinite-type setup. The train track approach would
  require considering infinite matrices without a good analog of the
  Perron--Frobenius theory. Instead, the viewpoints of Casson and
  Nielsen--Handel--Thurston seem more amenable, and in this paper we take
  Casson's approach. 

  Given a map $f$, the first step in Casson's program is to construct a
  geodesic lamination $\lambda$ as the limit of a subsequence
  $f^{n_i}(\alpha)$ of iterates of a curve $\alpha$, pulled tight. In order
  to ensure that $f^n(\lambda)$ has no transverse intersections with
  $\lambda$ (in which case the closure of $\bigcup_n f^n(\lambda)$ is an
  $f$-invariant geodesic lamination), this limiting process should be
  ``robust'', in the sense that more and more strands of $f^{n_i}(\alpha)$
  converge to the leaves of $\lambda$. This robustness is essentially
  automatic in the finite type case and fails only when $\alpha$ intersects
  the subsurface on which $f$ is periodic.

  For infinite-type surfaces, there are several new phenomena, and in
  particular the robustness mentioned above is far from being automatic.
  First, there are infinite-order isometries, such as the translation
  $(x,y) \mapsto (x+1,y)$ on the surface $\mathbb{R}^2 \smallsetminus \Z^2$
  which sends every curve to infinity. This is an incidence of a general
  \emph{translation} --- a map that generates an infinite cyclic group
  acting properly on the surface. For a more complicated example, consider
  the same surface but now restrict the translation on $y \le 1/3$, act
  with its inverse on $y\geq 2/3$, and interpolate between the two maps by
  horizontal translations in the strip $1/3< y< 2/3$. In this case, a curve
  that intersects the strip essentially will converge to a line homotopic
  into the strip, but the convergence will not be robust. Another example
  comes from taking a homeomorphism of the equator in $S^2$ with minimal
  invariant subset a Cantor set $C$, and extending it to a homeomorphism
  $f$ of $S^2 \smallsetminus C$, which we call an \emph{irrational
  rotation}. In this example, a convergent subsequence $f^{n_i}(\alpha)$
  limits onto a line in a non-robust way, and the union of all such limits
  is a non locally-finite collection of lines, some of which intersect ---
  in particular, it's not a geodesic lamination.

  This brings us to the notion of \emph{tame} maps, which are exactly those
  maps where the convergence is never robust for any curve; in other words,
  a tame map does not exhibit pseudo-Anosov behavior anywhere on the
  surface. A quick definition is that $f$ is tame if for any two curves
  $\alpha,\beta$ there is a uniform bound on the intersection numbers
  $i(f^n(\alpha),\beta)$, for $n\in\Z$ (see Section \ref{sec:tame}).  As
  shown in Section \ref{sec:tame},  under a tame map $f$, a curve $\alpha$
  either leaves every compact set, or has limit set $\L(\alpha)$ a
  collection of curves or properly embedded lines (rather than more
  complicated laminations). A tame map is \emph{extra tame} if in addition
  the limit set of every curve is a {\it finite} collection of lines and
  curves.

  On a finite-type surface, being tame is equivalent to being periodic. For
  infinite-type surfaces, prototypes of tame maps are periodic maps,
  translations, and irrational rotations, with the first two being extra
  tame. More complicated examples can be constructed by gluing multiple
  maps together in a controlled way, such as the gluing of two translations
  along a fixed line like our second example above, and one can easily
  adapt this procedure to infinitely many maps.

  Despite their name, the behavior of tame maps can often be quite
  complicated. Nevertheless, we believe that there is a Nielsen--Thurston
  type theory for tame maps and conjecture that our fundamental examples
  are the only building blocks of such maps. Our main result is a proof of
  this conjectural picture for the case of extra tame maps. As we shall
  explain below, the full strength of our theorem cannot be generalized to
  all tame maps.

  \begin{thmintro} \label{thm:mainintro} 
    
    Let $f$ be an extra tame map of a surface $S$ of infinite type. Up to
    modifying $f$ by an isotopy, there are a hyperbolic metric on \(S\) and a canonical decomposition of $S$
    into three $f$--invariant subsurfaces $\Sper$, $\Sinf$ and $S_0$ with totally geodesic boundary, such that for every component $X$ of $\Sper$,
    $\Sinf$ and $S_0$, $f$ returns to $X$ and is isotopic to: 
    \begin{itemize}
      \item a periodic isometry, if $X\subseteq \Sper$ or $X\subseteq S_0$, 
      \item an isometric translation, if $X\subseteq \Sinf$.
    \end{itemize} 
  
    Furthermore, components of $S_0$ contain no essential non-peripheral
    curves and at most one peripheral curve. 

  \end{thmintro}
  
  A component of $S_0$ should be regarded as the transition piece
  interpolating the action of $f$ on its neighboring pieces --- for
  instance, if we have a map given by three translations with disjoint
  supports as in Figure \ref{fig:componentsofS0} (instead of two as in the
  example described above), we would have a component of $S_0$ homeomorphic
  to an ideal triangle.

  For general tame maps, the statement of Theorem \ref{thm:mainintro}
  first needs to be adjusted to include maps with irrational rotation
  behavior.  However, it turns out the full analogue of the statement
  cannot hold, as there is not always a nice decomposition into
  subsurfaces for general tame maps. More precisely, there are tame
  maps for which the natural invariant pieces are no longer
  subsurfaces, meaning that although they have non-empty interior,
  their boundaries accumulate in a complicated way (see the
  \emph{Strategy of proof} section for some more details). Even
  replacing finiteness of limit sets by local finiteness is not enough
  to address this issue (see Section \ref{sec:examples}). Therefore,
  we propose the following conjecture for general tame maps.

  \begin{conj}\label{conjecture}
    Let $f$ be a tame map of a surface $S$ of infinite type. Then, up to
    modifying $f$ by an isotopy, there is a canonical $f$-invariant
    lamination $\lambda$ such that for every topologically nontrivial
    component $X$ of the complement, if a first return map exists, it is
    either periodic or a translation. Moreover, all leaves of $\lambda$ are
    proper.
  \end{conj}

  ``Topologically trivial'' components are those containing no essential
  non-peripheral curves and at most one peripheral curve --- similarly to
  the components of $S_0$ in Theorem \ref{thm:mainintro}.

  It is possible to construct tame maps and a lamination as in the
  conjecture and such that there are complementary components for which
  there is no first return map. We expect that in this case these
  components are wandering.

  Suppose moreover that for a tame map $f$ on a surface $S$ we have a
  decomposition as conjectured and that $X$ is a topologically trivial
  component of the complement of $\lambda$. If there is a first return map,
  there is a well-defined \emph{rotation number}, as defined in
  \cite[Section 7.3]{fht_dehn}. Moreover, any rotation number $\theta\in
  \R/\Z$ can be realized this way starting from some tame map. For
  instance, if we start by an irrational rotation of the sphere minus a
  Cantor set, we can decompose the surface by looking at all lines in the
  equator between points in the Cantor set, and the map on both the
  northern and the southern hemisphere will have irrational rotation
  number. Other examples of tame maps with this type of irrational rotation
  behavior are the \emph{wagon wheel maps} defined in \cite{fht_dehn}. See
  Section \ref{sec:decomposition} for more examples of tame maps which are
  not extra tame.

  If $f$ is not tame, then one could try to construct an $f$--invariant
  geodesic lamination using the Casson technique. This approach has been
  successfully carried out for the class of \emph{irreducible end periodic}
  maps by Handel and Miller \cite{ccf_endperiodic}. In our vision, a
  comprehensive structure theorem for an arbitrary map $f$ should begin by
  decomposing the surface $S$ into $f$--invariant pieces on which the first
  return is either tame or preserves two transverse geodesic laminations.
  Therefore, a structure theorem for tame maps is an essential part of the
  theory, and Theorem \ref{thm:mainintro} is the first step in this
  program. 
	
  \subsection*{Strategy of proof}

  For any map $f$ on $S$, the general strategy toward decomposing $S$ into
  $f$--invariant pieces is to organize curves according to their behavior
  under $f$, and look for the subsurface \emph{spanned} by curves of the
  same type. For instance, consider the collection $\Cper$ of $f$--periodic
  curves. If the subsurface $\Sper$ spanned by $\Cper$ exists, then $\Sper$
  is $f$--invariant and it is not hard to see that the action of $f$ on
  each component of $\Sper$ is periodic (see Section \ref{sec:structure}).
  We can then repeat this process and look for the subsurface $S_\infty$
  spanned by the collection $\C_\infty$ of \emph{wandering} curves (curves
  that leave every compact set under iteration). Here, with some work, one
  can show that if $S_\infty$ exists, then the action of $f$ on each
  component of $S_\infty$ is by a translation. This characterization can be
  thought of as the analogue of Brouwerâ€™s plane translation theorem
  (\cite{brouwer_beweis}).

  \begin{thmintro}

    Suppose $f$ is a homeomorphism of a surface $S$ such that every curve
    of $S$ is wandering. Then there is a hyperbolic metric on $S$ on which
    $f$ is isotopic to an isometric translation.

  \end{thmintro}

  If $f$ is tame, to prove the conjecture it remains to show that $S
  \smallsetminus (\Sper \cup S_\infty)$ can be decomposed into pieces by
  cutting along lines and curves, and that the map has irrational rotation
  behavior on all components with nontrivial topology. When $f$ is extra
  tame, there is no irrational rotation behavior, so we just need to show
  that the components of $S \smallsetminus (\Sper \cup S_\infty)$ have
  trivial topology.

  As the above procedure suggests, one of the technical steps is to
  establish the existence of the subsurface spanned by a collection of
  curves. With a finite set of curves, this subsurface is always
  well-defined. To deal with an infinite collection, we can take the span
  $S_n$ of the first $n$ curves and consider the limiting object. When the
  underlying surface $S$ has finite-type, then the topology of $S_n$'s
  stabilizes by Euler characteristic considerations, and the procedure
  described above leads to the Nielsen--Thurston decomposition of $f$. On
  the other hand, if $S$ has infinite type, then the limiting object may
  not  be a subsurface of $S$. Indeed, there are examples of tame maps
  where the collection of periodic or wandering curves displays this
  behavior (see Section \ref{sec:examples}). This issue turns out to be a
  significant obstacle in proving the conjecture in full generality.
  However, under the extra tameness assumption, the bad behavior
  disappears, allowing for this fundamental step to be completed
  successfully. 

  \begin{propintro}
          
    If $f$ is extra tame, then the collection of $f$--periodic curves
    spans a subsurface, and the collection of $f$--wandering curves
    spans a subsurface. Moreover, the complement of their union
    in $S$ is a subsurface with no essential non-peripheral curves.

  \end{propintro}
	
  \subsection*{Connection to actions on graphs}
	  
  A variation of Nielsen-Thurston classification, perhaps a more tractable
  problem, is to study the action of mapping classes on certain
  Gromov-hyperbolic graphs associated to the surface and classify them
  according to their type as isometries of the graphs. For instance, in the
  finite-type setting, pseudo-Anosov maps act hyperbolically on the curve
  graph of $S$ and all other maps act elliptically.  
		
  In the infinite-type setting, the curve graph always has bounded
  diameter, but for many surfaces there are other interesting
  infinite-diameter, Gromov-hyperbolic graphs. One example is the ray graph
  defined by Bavard \cite{bavard_hyperbolicite} for the plane minus the
  Cantor set $\mathbb{R}^2 \smallsetminus C$, which has been generalized to
  surfaces with one isolated end by Aramayona--Fossas--Parlier in
  \cite{afp_arc} and even further by Bar-Natan--Verberne in
  \cite{bv_grand}, where they define the \emph{grand-arc graph}. In
  \cite{bavard_hyperbolicite}, Bavard produced a map of $\mathbb{R}^2
  \smallsetminus C$ that acts hyperbolically on the ray graph, and her
  construction has been generalized to a large class of surfaces by
  Abbott--Miller--Patel in \cite{amp_infinite}. However, the classification
  of isometries remains open at large, and even the following question is
  unknown.
		
  \begin{question}
          
    Are there maps of $\mathbb{R}^2 \smallsetminus C$ that act as parabolic
    isometries of the ray graph? More generally, are there maps that act as
    parabolic isometries of the grand arc graphs?
          
  \end{question}
  
  By our work above, extra tame map are elliptic isometries on the
  ray graph, and our conjectural picture of tame maps implies
  that they are also elliptic isometries.

  \subsection*{Acknowledgments}
  
  We would like to thank the American Institute of Mathematics for the
  hospitality during the workshop ``Surfaces of infinite type'', during
  which this work started. We are also grateful to Peter Feller, Diana
  Hubbard and Hannah Turner for sharing their preprint \cite{fht_dehn},
  which was useful for refining Conjecture \ref{conjecture}. We thank
  Sanghoon Kwak for many useful comments on the first version of this
  paper. M.B.\ and J.T.\ gratefully acknowledge the support by the National
  Science Foundation under grant numbers DMS-1905720 and DMS-1651963
  respectively. F.F.\ thanks Peter Feller for useful conversations.

\section{Background}

  \subsection*{Standing assumptions} By a surface $S$ we will mean a
  connected orientable 2-manifold, without boundary unless otherwise
  stated.  When we need to consider surfaces with boundary, we will usually
  say \emph{bordered} surface for emphasis.  By a \emph{hyperbolic metric}
  on $S$ we always mean a complete hyperbolic metric without funnels or
  half-planes (i.e.\ the hyperbolic surface coincides with its convex core,
  which is also equivalent to the metric being of the \emph{first kind} --
  see \cite{ar_structure}). Hyperbolic metrics on surfaces with boundary
  will be assumed to contain no funnels or half planes and to have totally
  geodesic boundary.
   
  \bigskip

  A surface $S$ has \emph{finite type} if $\pi_1(S)$ is finitely generated
  and \emph{infinite type} otherwise. By the classification of surfaces,
  $S$ is of finite type if and only if $S$ is homeomorphic to a closed
  genus $g$ surface minus finitely many points.   A \emph{pair of pants} is
  a (possibly bordered) surface homeomorphic to either a three-holed
  sphere, or a two-holed, once-punctured sphere, or a twice-punctured disk.
  
  To a surface we can associate its \emph{ends}, which can be \emph{planar}
  and \emph{nonplanar}. A \emph{puncture} is a planar isolated end. We
  refer to \cite{av_big} for definitions and properties of ends of a
  surface.
    
  The \emph{mapping class group} of $S$ is the group $\mcg(S)$ of isotopy
  classes of orientation-preserving homeomorphisms of $S$.
  
  \emph{Curves} on a surface $S$ are assumed to be simple, closed and
  homotopically nontrivial. A curve is \emph{essential} if it is not
  homotopic to a puncture. If $S$ has boundary, then a curve is called
  \emph{peripheral} if it is homotopic to a boundary component. When $S$ is
  endowed with a hyperbolic metric with geodesic boundary, then every
  essential curve is realized by a unique geodesic $\alpha^*$ representing
  its homotopy class.
    
  A \emph{line} on $S$ is the image of a proper embedding of $\R \to S$. We
  say that a line is \emph{essential} if it doesn't bound a (topological)
  half-plane. We will usually consider lines up to proper isotopy relative
  to its ends. Similarly to curves, essential lines admit geodesic
  representatives:
  
  \begin{lemma}\label{lem:essential-to-geodesic}
    Let \(\ell\) be an essential line on a surface \(S\) endowed with a
    hyperbolic metric (of the first kind). Then \(\ell\) is isotopic to a
    unique geodesic \(\ell^*\).
  \end{lemma}
  \begin{proof}[Sketch of proof]
    Fix a pants decomposition, which yields an exhaustion of the surface by
    finite-type subsurfaces with compact totally geodesic boundary (see
    \cite{ar_structure}). Pick a lift \(\tilde{\ell}\) of \(\ell\) in the
    universal cover; by properness and since the metric is of the first
    kind, we can look at lifts of the curves in the pants decomposition to
    deduce that \(\tilde{\ell}\) has two limit points. Let
    \(\tilde{\ell^*}\) be the unique geodesic joining them the two limit
    points and let $\ell^*$ be the projection of $\tilde{\ell^*}$ to the
    surface. The same kind of arguments as in the proof of Proposition
    \ref{prop:straightening-laminations} show that \(\ell\) is isotopic
    \(\ell^*\). Uniqueness follows from the fact that the limit points of
    the lifts determine the geodesic. \qedhere
  \end{proof}
  
  An \emph{arc} is the image of an embedding of $[0,1]$. Note that in our
  definition arcs are compact. If $S$ has boundary, an arc from the
  boundary to the boundary is called \emph{essential} if, in the double
  surface, the double of the arc is an essential curve.
  
  A \emph{ray} is the image of $[0,\infty)$ under a proper embedding. 
  
  A \emph{geodesic lamination} is a closed subset of $S$ which is the union
  of complete simple and pairwise disjoint geodesics (with respect to some
  hyperbolic metric on $S$), called the \emph{leaves} of the lamination. A
  simple closed geodesic or a geodesic line is an example of a geodesic
  lamination with a single leaf. 
    
  The \emph{geometric intersection number} $i(\alpha,\beta)$ is the minimum
  number of intersections between representatives of $\alpha$ and $\beta$,
  where $\alpha$ and $\beta$ could each be either a line, curve, or a leaf
  of a lamination. Note that $i(\alpha,\beta)$ could be infinite, but we
  have the following characterization of lines.

  \begin{lemma} \label{lem:proper}

    Let $S$ be a surface equipped with a hyperbolic metric. Then a complete
    simple geodesic $\ell \subset S$ is a line or a curve if and only if
    $i(\ell,\alpha) < \infty$ for all curves $\alpha$.

  \end{lemma}

  \begin{proof}

    Clearly, if $i(\ell,\alpha) = \infty$ for some curve $\alpha$, then
    $\ell$ cannot be proper. Now suppose $i(\ell,\alpha) < \infty$ for all
    curves $\alpha$. Let $K \subset S$ be a compact subsurface. Since
    $\sum_{\alpha \subset \partial K} i(\ell, \alpha) < \infty$, $\ell \cap
    K$ has a finite number of components. If a component $\tau \subset \ell
    \cap K$ has infinite length, then $\tau$ must accumulate onto some
    geodesic lamination $\alpha$ in $K$, or a boundary component $\alpha$
    of $K$. But then any curve $\beta$ intersecting $\alpha$ will have
    $i(\ell,\beta) \ge i(\tau,\beta) = \infty$. This shows $\ell \cap K$ is
    always a finite number of arcs, hence $\ell$ is proper. \qedhere 

  \end{proof}
  
  \subsection{Subsurfaces}

  A \emph{subsurface} of $S$ is a closed subset $X \subset S$ which is a
  two-dimensional submanifold such that each boundary component of $X$ is
  either an essential curve or an essential line of $S$. We also require
  that no connected component of $X$ can be homotoped into another. Note
  that by definition, no component of a subsurface can be a closed disk
  with at most one puncture. Moreover, $X$ is a subsurface if and only if
  $Y = \overline{S \setminus X}$ is also a subsurface. We will usually
  consider a subsurface up to isotopy.
  
  A connected subsurface $X$ is called \emph{essential} if its double
  either has negative Euler characteristic or is of infinite type.
  Topologically, this rules out annuli and \emph{strips} (i.e.\ closed
  disks with two points removed from the boundary). 
  
  Two subsurfaces in $S$ are \emph{disjoint} if they have disjoint
  representatives. Similarly, a curve or line or geodesic lamination is
  disjoint from a subsurface if they have disjoint representatives. Note
  that in this definition, the boundary of a subsurface is considered
  disjoint from the subsurface. 

  Fix a hyperbolic metric on $S$. Because we will usually consider a
  subsurface up to isotopy, it is convenient to pick out a canonical
  representative for each isotopy class. To this end, we will introduce the
  notion of an \emph{(almost) geodesic representative} of a subsurface $X$
  of $S$, subject to the hyperbolic metric on $S$, which will be an
  \emph{almost} canonical representative for the isotopy class of $X$.

  We first look at representatives of the interior of subsurfaces. Suppose
  first that $X$ is a connected subsurface. A \emph{geodesic representative
  of the interior of $X$} is an open set $X^\circ$ defined as follows:

  \begin{itemize}
    \item if $X$ is essential, $X^\circ$ is an open set properly homotopic
      to $\int(X)$ whose whose metric completion is a hyperbolic surface
      with totally geodesic boundary homeomorphic to $X$;
    \item if $X$ is a strip or an annulus with core line/curve $\alpha$,
      $X^\circ$ is the interior of any closed regular neighborhood of
      $\alpha^*$ (whose boundary components are proper curves or lines).
  \end{itemize}
  
  If $X$ is any subsurface, not necessarily connected, a \emph{geodesic
  representative of its interior} (also denoted $X^\circ$) is the union,
  over all connected components of $X$, of geodesic representatives of
  their interiors, chosen so that the closures of any two are disjoint.

  Note that $X^\circ$ is by definition an open subset properly homotopic to
  the interior of $X$. 

  To get a representative for $X$, we further do the following. For each
  component $Y$ of $Z$, let $\overline{Y^\circ}$ be the closure of
  $Y^\circ$, and set $\partial Y^\circ := \overline{Y^\circ} \smallsetminus
  Y^\circ$. When $Y$ is essential, then $\partial Y^\circ$ is a disjoint
  union of simple closed geodesics or geodesic lines; otherwise, $\partial
  Y^\circ$ is a pair of almost geodesic curves or lines homotopic to the
  core curve of $Y$. Let $\partial_{sa} X^\circ$ be the collection of
  components of $\partial X^\circ$ such that both boundary components of a
  regular neighborhood are contained in $X^\circ$. We define an
  \emph{almost geodesic representative} of $X$ as
  $$X^*=\overline{X^\circ}\ssm \bigcup_{\alpha\in \partial_{sa} X^\circ}
  N(\alpha)$$ where the $N(\alpha)$ are open regular neighborhoods of the
  components whose closures are pairwise disjoint and contained in
  $\overline{X^\circ}$. Note that almost geodesic representatives are only
  defined up to proper homotopy, unless $\partial_{sa}(X^\circ)=\emptyset$
  (in which case they coincide with the geodesic representative of the
  subsurface). Moreover, $\overline{X^\circ}$ is homeomorphic to $X^*$ if
  and only if $\partial_{sa}X^\circ$ is empty.

  \begin{figure}[h]
    \begin{center}
      \includegraphics[scale=1.2]{almostgeodrep}
      \caption{An example of a subsurface $X$ so that $\overline{X^\circ}$
      is not homeomorphic to $X^*$}
    \end{center}
  \end{figure}

  \begin{lemma}\label{lem:almost-geod-rep}
    For any hyperbolic metric on \(S\), any subsurface is properly
    homotopic to its almost geodesic representative.
  \end{lemma}
  
  \begin{proof}[Sketch of proof]
    If $\partial_{sa}X^\circ=\emptyset$, the almost geodesic representative
    of \(X\) is simply its geodesic representative and the proof follows
    from the fact that we can properly homotope all boundary components of
    \(X\) at once to their geodesic representatives (see Lemma
    \ref{lem:essential-to-geodesic} and \cite[Lemma 2.6]{cb_automorphisms}.
    If $\partial_{sa}X^\circ\neq \emptyset$, we just need a slight
    modification of the arguments above to take care of pairs of parallel
    boundary components.
  \end{proof}
  
  A consequence is that ``inclusion up to proper homotopy'' is an order on
  the set of equivalence classes of subsurface up to proper homotopy:
  
  \begin{cor}
    Let \(S\) be a surface endowed with a hyperbolic structure. If \(X_1\)
    and \(X_2\) are subsurfaces, each one of which can be properly
    homotopic into the other, then \(X_1\) and \(X_2\) are properly
    homotopic.
  \end{cor}
  
  \begin{proof}
  
    We first prove that non-essential components of $X_1$ and $X_2$ are the
    same, up to proper homotopy. Indeed, suppose $Y$ is a non-essential
    component of $X_1$; since $X_1$ is properly homotopic into $X_2$, $Y$
    is properly homotopic into some component $Z$ of $X_2$. Since $X_2$ is
    properly homotopic into $X_1$, $Z$ is properly homotopic into some
    component $Y'$ of $X_1$. In particular, $Y'$ is properly homotopic into
    $Y'$, and by the definition of subsurfaces, this implies that $Y=Y'$.
    So $Z$ is properly homotopic into a strip or an annulus and is hence a
    strip or an annulus itself. By repeating the same argument for the
    non-essential components of $X_2$ we get the claim.

   Since non-essential components are the same up to proper homotopy, we
    can assume $X_1$ and $X_2$ don't contain any non-essential component.
    If we fix a hyperbolic structure on $S$, $X_1^\circ$ and $X_2^\circ$
    are uniquely defined. We claim that they are the same, which implies
    that $X_1$ and $X_2$ have the same almost geodesic representative, and
    therefore by Lemma \ref{lem:almost-geod-rep} that they are properly
    homotopic to each other. By contradiction, suppose $X_1^\circ\neq
    X_2^\circ$. Without loss of generality, we can assume that $Y$ is a
    component of $X_1^\circ\ssm X_2^\circ$. Since $X_1$ can be properly
    homotoped into $X_2$, $Y$ can only be a curve or a line, so $Y\subset
    \partial_{sa}X_1^\circ$. We can then find an essential curve or line
    $\alpha\subset X_1^\circ$ essentially intersecting $Y$. But again
    because $X_1$ can be properly homotoped into $X_2$, $\alpha$ can be
    homotoped into $X_2$ and is therefore disjoint from $Y$, a
    contradiction. \qedhere
  \end{proof}

  We say that a collection $\C$ of curves \emph{cuts} a (sub)surface $X$ if
  every non-peripheral curve in $X$ has positive intersection number with
  some curve in $\C$.
  
  \subsection{Some results on isometries of surfaces}

  The following well known statement follows from the proof of
  \cite[Theorem 2.7]{cb_automorphisms}.

  \begin{lemma}\label{lem:periodic-finite-type}
    Let $F$ be a possibly bordered finite-type surface of negative Euler
    characteristic, whose boundary is either empty or compact. Let $f$ be a
    mapping class of $F$. If $F$ is cut by a finite collection of
    $f$--periodic curves, then $f$ has finite order.
  \end{lemma}

  \begin{remark}
    Note that the order of $f$ in the previous lemma can be arbitrarily
    higher than the periods of the curves. For instance, look at the torus
    $\R^2 /\Z^2$ and at the curves $\alpha$ and $\beta$, obtained as the
    quotients of the lines $y=nx$ and $y=-nx$. Puncture the torus at points
    that are the projections of $\left(\frac{1+2k}{2n},0\right)$, for
    $k=0,\dots, n-1$, and $\left(\frac{k}{n},\frac{1}{2}\right)$, for
    $k=0,\dots, n-1$. Then the map induced by $(x,y)\mapsto
    \left(x+\frac{1}{2n},y+\frac{1}{2}\right)$ has order $2n$, but it fixes
    both $\alpha$ and $\beta$.
  \end{remark}

  We will also need a result about isometries of infinite-type surfaces,
  whose proof is essentially borrowed from Afton--Calegari--Chen--Lyman's
  work (\cite{accl_Nielsen}).

  \begin{prop}\label{prop:Nielsenrealization}
    Let $S$ be an infinite-type surface with boundary and $f$ a
    homeomorphism of $S$ with $f^n$ homotopic to the identity for some $n >
    0$. For each compact boundary $\alpha$ of $S$, choose an $f$-invariant
    positive number $\ell(\alpha)$. Then there exists a hyperbolic metric
    on $S$ such that each compact boundary component $\alpha$ has length
    $\ell(\alpha)$ and $f$ is isotopic to a periodic isometry of $S$.
  \end{prop}

  \begin{proof}
    Suppose first that $S$ has only compact boundary components. By using
    Nielsen's work \cite{nielsen_abbildungsklassen} (which shows that the
    proposition holds if $S$ is of finite type and has compact boundary)
    and Afton--Calegari--Chen--Lyman's argument (see the proof of
    \cite[Theorem 2]{accl_Nielsen}), we can prove the proposition in this
    case.

    If there are noncompact boundary components, then let $D(S)$ be the
    double of $S$ along its noncompact boundary components and extend the
    map $f$ to a map $\hat{f}$ of $D(S)$. Let $i$ be the involution on
    $D(S)$ with quotient $S$, which commutes with $\hat{f}$ by
    construction. By \cite{accl_Nielsen}, there is an $i$--invariant metric
    on $S$ and a periodic isometry $g$ isotopic to $\hat{f}$. Since $i$ is
    an isometry, the boundaries of $S$ are realized as geodesics in $D(S)$.
    Therefore, $g$ also commutes with $i$, and we get a periodic isometry
    of $S$ isotopic to $f$. \qedhere
  \end{proof}

\section{Limit sets}

  Throughout this section, $S$ will be a surface without boundary and
  equipped with a hyperbolic metric, though everything we say will be
  independent of the choice of such metric. Indeed, the following fact
  holds (see \cite[Theorem 3.6]{saric_train} for the result in the
  infinite-type setting).
  
  \begin{thm}\label{thm:geods_correspondence} 
    Let $m$ and $m'$ be two hyperbolic metrics on $S$. Then the identity
    map on $S$ yields a natural identification of the boundary at infinity
    of the universal cover of $(S,m)$ and the boundary at infinity of the
    universal cover of $(S,m')$. This induces a homeomorphism between
    complete geodesics in the universal cover of $(S,m)$ and complete
    geodesics in the universal cover of $(S,m')$, which descends to a
    homeomorphism between complete $m$-geodesics and complete
    $m'$-geodesics on $S$.
  \end{thm}

  Given a complete $m$-geodesic $\ell$, we call the corresponding
  $m'$-geodesic the \emph{$m'$--straightening} of $\ell$. For a collection
  of $m$--geodesics, its \emph{$m'$--straightening} is the union of the
  $m'$--straightenings of its geodesics. A consequence of Theorem
  \ref{thm:geods_correspondence} is the following: 
    
  \begin{lemma}
    Let $m$ and $m'$ be two hyperbolic metrics on $S$. If two complete
    $m$--geodesics $\ell_1$ and $\ell_2$ are simple and disjoint, then the
    $m'$--straightenings $\ell_1$ and $\ell_2$ are also simple and
    disjoint. If $\lambda$ is an $m$--geodesic lamination, its
    $m'$--straightening is an $m'$--geodesic lamination.
  \end{lemma}
  
  The reason why the lemma holds is that (self-)intersections correspond to
  linked pairs of endpoints at infinity of lifts and convergence of
  geodesics corresponds to convergence of pairs of endpoints at infinity of
  lifts. Moreover, we have:
  
  \begin{prop}\label{prop:straightening-laminations}
    Let $m$ and $m'$ be hyperbolic metrics on $S$ and $\lambda$ an
    $m$--geodesic lamination. Then there is an ambient isotopy which maps
    $\lambda$, leaf by leaf, to its $m'$--straightening $\lambda'$.
  \end{prop}

  \begin{proof}
    Pick an $m$--geodesic pants decomposition $\mathcal{P}$ which doesn't
    contain any leaf of $\lambda$ (this can be done by choosing a pants
    decomposition and doing enough elementary moves until none of its
    curves are  in $\lambda$). In particular $\mathcal{P}$ is in minimal
    position with respect to $\lambda$. We can then find an ambient isotopy
    $H_1$ of $S$ sending $\mathcal{P}$ to $\mathcal{P}'$, the
    $m'$--straightening of $\mathcal{P}$. Let $\lambda_1$ be the image
    under the isotopy of $\lambda$. Note that $\mathcal{P}'$ is in minimal
    position with respect to $\lambda_1$ and doesn't contain any leaf of
    $\lambda_1$.

    Next, given a curve $\alpha$ in the pants decomposition $\mathcal{P}'$,
    lift $\alpha$, $\lambda_1$ and $\lambda'$ to the universal cover of
    $(S,m')$. Look at a lift $\beta$ of $\alpha$ and pick an orientation on
    it; every lift $\ell_1$ of a leaf in $\lambda_1$ intersecting $\beta$
    corresponds to a lift $\ell_1'$ of a leaf of $\lambda'$ with the same
    endpoints, thus $\ell_1'$ intersects $\beta$ as well. Moreover, if
    $\ell_2$ is another lift of a leaf in $\lambda_1$ intersecting $\beta$
    and $\ell_2'$ the corresponding $m'$--geodesic, the intersections of
    $\ell_1$ and $\ell_2$ with $\beta$ come in the same order as the
    intersections of $\ell_1'$ and $\ell_2'$ with $\beta$. So we can find
    an order-preserving homeomorphism from
    $\tilde{\lambda_1}\cap\beta$ to $\tilde{\lambda'}\cap\beta$ sending
    $\ell\cap\beta$ to $\ell'\cap \beta$, for every $\ell\subset
    \tilde{\lambda_1}$, where $\ell'$ is the $m'$-- straightening of
    $\ell$. Extend this to an equivariant isotopy of a small neighborhood
    of $\beta$. By doing this equivariantly at each lift and on disjoint
    neighborhoods, we get an isotopy of the universal cover which descends
    to an ambient isotopy $H_2$ of $S$, sending $\lambda_1$ to $\lambda_2$
    such that for every $\alpha$ in $\mathcal{P}'$,
    $\lambda_2\cap\alpha=\lambda'\cap \alpha$.

    \begin{figure}[ht]
    \begin{center}
    \begin{overpic}{lifts}
    \put(-1,18){$\beta$}
    \put(68,-6){$\ell_1$}
    \put(100,30){$\ell_2$}
    \put(22,61){\color{PrettyGreen}$\ell_1'$}
    \put(70,55){\color{PrettyGreen}$\ell_2'$}
    \end{overpic}
    \caption{Lifting a curve in $\mathcal{P}'$}
    \end{center}
    \end{figure}

    Look at a pair of pants $P$ of $\mathcal{P}'$. By the transversality of
    $\lambda_2$ and of $\lambda'$, $\lambda_2\cap P$ (respectively,
    $\lambda'\cap P$) is a union of arcs from $\partial P$ to $\partial P$.
    We claim that we can find an isotopy of $P$, fixing the boundary
    pointwise, sending $\lambda_2\cap P$ to $\lambda'\cap P$. Indeed, we
    can divide the arcs according to their homotopy classes relative to the
    boundary. There are at most three classes, which are the same for the
    arcs in $\lambda_2$ and in $\lambda$, by how $\lambda_2$ was
    constructed. For each class we can find a rectangle $R$ with two sides
    on $\partial P$ and two arcs from $\lambda_2\cap P$ in the given
    homotopy class containing all arcs of $\lambda_2\cap P$ in the homotopy
    class. We can do the same for $\lambda'$ and get a rectangle $R'$, with
    the extra assumption that the four corners of $R'$ are the same as the
    four corners of $R$. We can then choose an ambient isotopy, fixing
    $\partial P$ pointwise, sending $R$ to $R'$ and all arcs of
    $\lambda_2\cap R$ to the corresponding arcs of $\lambda'\cap R'$.

    \begin{figure}[ht]
    \begin{center}
    \begin{overpic}[scale=1.2]{rectanglesinpants}
    \put(20,35){$R$}
    \put(72,35){$R'$}
    \end{overpic}
    \caption{Isotopying rectangles}
    \end{center}
    \end{figure}

    By doing this for all homotopy classes we get the required isotopy of
    $P$. Repeating the procedure in each pair of pants, we get an ambient
    isotopy $H_3$ of $S$, fixing all curves in $P$ pointwise, and sending
    $\lambda_2$ to $\lambda'$.

    The composition of the three ambient isotopies is the required
    isotopy.\qedhere

  \end{proof}

  Let $\lambda \subset S$ be a closed subset. We say that a sequence of
  curves $\{\alpha_n\st n\in \N\}$ \emph{converges} to $\lambda$, and that
  $\lambda$ is the \emph{limit} of $\{\alpha_n\st n\in \N\}$, if for every
  finite-type subsurface $K \subset S$ with compact boundary, $\alpha_n^*
  \cap K$ converges to $\lambda \cap K$ with respect to the Hausdorff
  distance. We will also denote this by $\alpha_n \to \lambda$. We can
  similarly define limits of sequences of geodesic arcs.

  Since we restrict to finite-type surfaces to define convergence, the
  standard proof (see e.g.\ \cite{cb_automorphisms}) applies to show:

  \begin{lemma}\label{lem:limit}
    Let $\lambda$ be a closed subset of $S$. If $\lambda$ is the limit of a
    sequence of curves $\{\alpha_n\st n\in \N\}$, then $\lambda$ is a
    geodesic lamination. If $\lambda$ is the limit of a sequence of
    geodesic arcs, it is a union of pairwise disjoint geodesic arcs,
    geodesic rays and/or complete simple geodesics.
  \end{lemma}

  The \emph{limit set} of a sequence of curves $\{\alpha_n\st n\in \N\}$ is
  the set $\L(\{\alpha_n\st n\in \N\})$ given by all complete geodesics
  contained in the limit of some subsequence of $\{\alpha_n\st n\in \N\}$.
  Similarly we can define the limit set of a sequence of geodesic arcs.

  Changing the metric on $S$ does not change the limit set in the following
  sense. 

  \begin{lemma}
    Let $m$ and $m'$ be two hyperbolic metrics on $S$. For a sequence
    $\{\alpha_n\}$ of curves, let $\L(\{\alpha_n\st n\in \N\},m)$ and
    $\L(\{\alpha_n\st n\in \N\},m')$ be their respective limit sets in the
    two metrics. Then a subsequence $\{\alpha_{n_j}\}_{j\in\N}$ converges
    to $\lambda \subset \L(\{\alpha_n\st n\in\N\},m)$ if and only if
    $\{\alpha_{n_j}\}_{j\in\N}$ converges to $\lambda' \subset
    \L(\{\alpha_n\st n\in \N\},m')$, where $\lambda'$ is the
    $m'$--straightening of $\lambda$.
  \end{lemma}

  \begin{proof}
    As convergence of geodesics corresponds to convergence of pairs of
    endpoints at the boundary at infinity, this follows from Theorem
    \ref{thm:geods_correspondence}.\qedhere
  \end{proof}

  This justifies our notation $\L(\{\alpha_n\st n\in\N\})$, which makes no
  reference to the metric on $S$. 
    
  \subsection{Limit sets under a homeomorphism}

  For a homeomorphism $f$ of $S$ and a curve $\alpha$; we say $\alpha$ is
  $f$--\emph{periodic} if there exists $n \ge 1$ such that $f^n(\alpha)$ is
  isotopic to $\alpha$. The smallest such $n$ is called the
  $f$--\emph{period} of $\alpha$. We say $\alpha$ is $f$--\emph{forward
  wandering} if $\{f^n(\alpha)^*\}_{n \ge 0}$ leaves every compact set of
  $S$, and $f$--\emph{backward wandering} if it is $f^{-1}$--forward
  wandering. The curve $\alpha$ is $f$--\emph{wandering} if it is both
  $f$--forward and $f$--backward wandering. These properties are
  independent of the hyperbolic metric on $S$ as well as perturbing $f$ by
  an isotopy. Thus, we will also adopt the same definition for a mapping
  class of $S$.  We will usually suppress the reference to $f$ when the
  context is clear.
  
  Note that a curve is $f$--wandering if and only if for every compact set,
  $f^n(\alpha)$ can be homotoped to be disjoint from the compact set for
  any $n$ of sufficiently large absolute value. With this in mind, we can
  extend the definition of $f$--wandering to lines or subsurfaces of $S$,
  by which we mean that for every compact set in $S$, the images under
  $f^n$ can be homotoped away from the compact set for any $n$ with
  sufficiently large absolute value.
  
  For $\alpha$ a curve, let $\L^+(\alpha) := \L(\{f^n(\alpha)\st n \ge
  0\})$ be the \emph{forward limit} of $\alpha$ under $f$, and
  $\L^-(\alpha) := \L(\{f^n(\alpha)\st n \le 0\})$ the \emph{backward
  limit}. Set $\L(\alpha):=\L^+(\alpha)\cup\L^-(\alpha)$. When $\alpha$ is
  $f$--periodic, then \[ \L^{\pm}(\alpha) =  \{\alpha^*, f(\alpha)^*, \dots
  , f^{n-1}(\alpha)^*\}, \] where $n \ge 1$ is the $f$--period of $\alpha$.
  Moreover, $\alpha$ is forward wandering if and only if $\L^+(\alpha) =
  \emptyset$, and it is backward wandering if and only if $\L^-(\alpha) =
  \emptyset$. See Corollary \ref{cor:tame-limits}.  
  
  We establish some basic facts.

  \begin{lemma}\label{lem:tame-intersection}
    
    Let $f$ be a homeomorphism and $\alpha$ a curve. Suppose $\lambda$ is
    the limit of a sequence of iterates $\{f^{n_j}(\alpha)\st j\in\N\}$.
    Then for any curve $\beta$, $i(\beta,\lambda) \ne 0$ if and only if
    $i(\beta,f^{n_j}(\alpha)) \ne 0$ for all sufficiently large $j$.
    Moreover, if $i(\beta,\lambda) \ge k$, then $i(\beta,f^{n_j}(\alpha))
    \ge k$ for all sufficiently large $j$. 

  \end{lemma}

  \begin{proof}

    If we look at an annular neighborhood $K$ of $\beta$,
    $f^{n_j}(\alpha)^*\cap K$ converges to $\lambda \cap K$ in the
    Hausdorff metric, so the first statement follows. If $\beta$ intersects
    $\lambda$ at least $k$ times, then we can find $k$ arcs in $K \cap
    \lambda$. Choose sufficiently small neighborhood about each arc so that
    they are pairwise disjoint. Then for all sufficiently large $j$,
    $f^{n_j}(\alpha) \cap K$ will pass through each of these neighborhoods,
    so $i(\beta,f^{n_j}(\alpha)) \ge k$. \qedhere 

  \end{proof}

  \begin{lemma}\label{lem:duality}
    Let \(f\) be a homeomorphism. Then for any two (not necessarily
    distinct) curves \(\alpha\) and \(\beta\) we have:
    \[i(\alpha,\L^+(\beta))\neq 0 \; \Leftrightarrow \;
    i(\L^-(\alpha),\beta)\neq 0.\]
  \end{lemma}

  \begin{proof}
    Suppose \(i \left( \alpha,\L^+(\beta) \right)\neq 0\). Let
    \(n_j\to\infty\) be a sequence so that $f^{n_j}(\beta) \to \lambda
    \subset \L^+(\beta)$ with \(i(\alpha,\lambda)\neq 0\). By Lemma
    \ref{lem:tame-intersection}, for every \(j\) large enough,
    \[i(\alpha,f^{n_j}(\beta))\neq 0\]
    and thus
    \[i(f^{-n_j}(\alpha),\beta)\neq 0.\] In particular, $\alpha$ is not
    backward wandering. By taking a further subsequence so that
    $f^{-n_{j_k}}(\alpha) \to \lambda' \subset \L^-(\alpha)$, we have,
    again by Lemma \ref{lem:tame-intersection}, \(i(\lambda',\beta)\neq
    0\), i.e.\ \(i(\L^-(\alpha),\beta)\neq 0\). By replacing $f$ by
    $f^{-1}$ we get the other implication. \qedhere 

  \end{proof}

  \begin{lemma}\label{lem:not-wandering} 

    Let $f$ be a homeomorphism. Then a curve $\alpha$ is forward wandering
    if and only if \(i(\alpha,\L^-(\beta)) = 0\) for all curves $\beta$.
    Similarly, $\alpha$ is backward wandering if and only if 
    \(i(\alpha,\L^+(\beta)) = 0\) for all $\beta$.

  \end{lemma}

  \begin{proof}
    
    If $\alpha$ is not forward wandering, then we can choose a curve
    $\beta$ with $i(\L^+(\alpha),\beta) \ne 0$. By Lemma
    \ref{lem:duality}, this implies $i(\alpha,\L^-(\beta)) \ne 0$. Conversely, if
    \(i(\alpha,\L^-(\beta))\neq 0\), then again by Lemma \ref{lem:duality},
    \(i(\L^+(\alpha),\beta)\neq 0\). In particular
    \(\L^+(\alpha)\neq\emptyset\), so \(\alpha\) is not forward wandering.
    \qedhere

  \end{proof}
  
  \begin{cor}\label{cor:not-wandering}
    Let $f$ be a homeomorphism. If $\alpha$ is a periodic curve and $\beta$
    is a wandering curve, $i(\alpha,\beta)=0$.
  \end{cor}
  \begin{proof}
    If $i(\alpha,\beta)\neq 0$, $i(\L^+(\alpha),\beta)\neq 0$ (as
    $\alpha\in \L^+(\alpha)$), so $\beta$ is not wandering by Lemma
    \ref{lem:not-wandering}.\qedhere
  \end{proof}

\section{Tame maps}

  \label{sec:tame}

  As usual, assume $S$ is a surface without boundary endowed with a
  hyperbolic metric. We say a homeomorphism $f$ of $S$ is \emph{tame} if
  for every finite-type subsurface $K \subset S$ with compact boundary and
  every curve $\alpha$ there are $N=N(K,\alpha)\in \N$ and finitely many
  isotopy (relative to $\partial K$) classes of arcs from $\partial K$ to
  $\partial K$ and curves in $K$ such that, for every $n\in\N$, the
  intersection $f^n(\alpha)^*\cap K$ has at most $N$ components and each is
  in one of the given isotopy classes. Tameness can be characterized by
  looking at intersections of curves, as the following lemma shows. 

  \begin{lemma} \label{lem:tame-properties}
   
    Let $f$ be a homeomorphism of $S$. The following statements are
    equivalent. 
    
    \begin{enumerate}
      \item $f$ is tame.
      \item $f^{-1}$ is tame.
      \item For curves $\alpha$ and $\beta$, $i(f^n(\alpha),\beta)$ is
        uniformly bounded for all $n \ge 0$.
      \item For curves $\alpha$ and $\beta$, $i(f^n(\alpha),\beta)$ is
        uniformly bounded for all $n \le 0$.
      \item For curves $\alpha$ and $\beta$, $i(f^n(\alpha),\beta)$ is
        uniformly bounded for all $n$.
    \end{enumerate}
    In particular, the notion of tame is independent of the hyperbolic
    metric on $S$.
  \end{lemma}

  \begin{proof}

    The equivalence of (3), (4), and (5) are immediate as the action of $f$
    preserves geometric intersection number. That (1) implies (3) follows
    from taking the compact surface to be an annular neighborhood of the
    curve $\beta$. On the other hand, if $f$ is not tame, then there exists
    a finite-type subsurface $K$ with compact boundary, a curve $\alpha$,
    and a subsequence $\{n_j\} \subset \N$ such that $f^{n_j}(\alpha)^*
    \cap K$ has $N_j$ components with $N_j \to \infty$ and $j \to \infty$,
    or includes components with increasing multiplicity. Then there exists
    a curve $\beta\subset K$ such that $i(f^{n_j}(\alpha),\beta) \to
    \infty$. This shows the equivalence of (1) and (3), as well as (2) and
    (4) by symmetry, whence the equivalence of all statements. Property (5)
    is independent of the hyperbolic metric on $S$, so the same is true of
    being tame. \qedhere 

  \end{proof}

  We say a mapping class $f \in \mcg(S)$ is \emph{tame} if it has a tame
  representative. From the characterization of Lemma
  \ref{lem:tame-properties}, if $f$ has a tame representative, then all of
  its representatives are tame. We call a tame homeomorphism $f$
  \emph{extra tame} if the limit set \(\L(\alpha)\) is finite for every
  curve \(\alpha\). This property is also inherited by the mapping class of
  $f$. 
  
  As an example, for a map of a finite-type surface it is equivalent to be
  tame, extra tame, periodic and isotopic to an isometry for some
  hyperbolic structure. In the infinite-type case, the situation is more
  complicated. Being periodic implies being isotopic to an isometry (with
  respect to some hyperbolic structure), which implies being extra tame,
  and extra tame maps are tame by definition. No implication is an
  equivalence, though. Consider for instance a translation of a surface
  $S$, which --- as mentioned in the introduction --- is a map $f$ that
  generates an infinite cyclic group acting properly on $S$. If $S$ has
  infinite type, then the quotient surface $X=S/\langle f \rangle$ has
  negative Euler characteristic or has infinite type, so we can lift a
  hyperbolic metric from $X$ to $S$ so that $f$ acts by an (infinite-order)
  isometry. In this case, every curve on $S$ is wandering, so $f$ is
  (extra) tame. 
  
  Another example is what we call an \emph{irrational rotation}. Here, we
  start with a homeomorphism of the circle with minimal invariant subset a
  Cantor set $C$ (see the Denjoy construction \cite[Section
  12.2]{kh_introduction}). Think of the circle as the equator of the
  two-sphere $S^2$, and extend the map to a homeomorphism of $S=S^2
  \smallsetminus C$. This map is tame but \emph{not} extra tame: every
  curve has an infinite limit set, given by lines which can intersect. More
  complicated examples of (extra) tame maps can be found in Sections
  \ref{sec:examples} and \ref{sec:structure}.
  
  On the other hand, a Dehn twist is not tame: if $\tau$ is the twist about
  a curve $\alpha$, let $\beta$ be a curve intersecting $\alpha$
  essentially. If $K$ is a finite-type subsurface with compact boundary
  containing $\alpha$ and $\beta$, the curves $\tau^n(\beta)\cap
  K=\tau^n(\beta)$ are all distinct. Another example of a map which is not
  tame is a homeomorphism which restricts to a pseudo-Anosov on some
  finite-type subsurface (with compact boundary).

  The goal of the remainder of this section is to describe properties of
  limit sets of curves and lines under tame homeomorphisms. The first result is that
  if a curve or line is not periodic, its limit set can only contain lines.

  \begin{prop} \label{prop:tame-limits}
    
    Let $f$ be a tame homeomorphism and $\alpha$ a non-periodic curve. If
    $\alpha$ is not forward wandering, then $\L^+(\alpha)$ is a non-empty
    collection of lines. Similarly, if $\alpha$ is not backward wandering,
    then $\L^-(\alpha)$ is a non-empty collection of lines.

  \end{prop}

  \begin{proof}
    
    Assume that $\alpha$ is not forward wandering. For simplicity, let
    $\alpha_n = f^n(\alpha)^*$. If $\L^+(\alpha)$ is empty, then for every
    compact subsurface $K \subset S$, $\bigcup_{n \ge 0} \alpha_n \cap K$
    has no accumulation points. That is, $\bigcup_{n \ge 0} \alpha_n \cap
    K$ is given by finitely many arcs or curves. If two geodesics coincide
    along a non-trivial arc, then they are equal. Since $\alpha$ is not
    $f$--periodic, we must have $\alpha_n \cap K = \emptyset$ for all
    sufficiently large $n$. But this contradicts the assumption that
    $\alpha$ is not forward wandering. So $\L^+(\alpha)$ is a non-empty
    union of complete simple geodesics by Lemma \ref{lem:limit}. If
    $\L^+(\alpha)$ has a non-proper leaf $\ell$, then there exists a curve
    $\beta$ such that $i(\beta,\ell) = \infty$, by Lemma \ref{lem:proper}.
    Let $\lambda \subset \L^+(\alpha)$ be the limit of some subsequence
    $\{\alpha_{n_j}\}$ containing $\ell$. By Lemma
    \ref{lem:tame-intersection}
    $i(f^{n_j}(\alpha),\beta)=i(\alpha_{n_j},\beta) \to \infty$,
    contradicting the characterization of tameness given by Lemma
    \ref{lem:tame-properties}. If $\L^+(\alpha)$ has a compact component
    $\beta$, then since $\L^+(\alpha)$ has no non-proper leaves, $\beta$ is
    the limit of some subsequence $\{\alpha_{n_i}\}$, which has to be
    eventually constant (again by tameness). But this contradicts the
    non-periodicity of $\alpha$. Thus $\L^+(\alpha)$ is a non-empty union
    of lines. By replacing $f$ by $f^{-1}$ we get the second statement.
    \qedhere 

  \end{proof}
  
  As $\L^{\pm}(\alpha)$ is well defined for mapping classes, we have
  the following immediate corollary.
  
  \begin{cor} \label{cor:tame-limits}
    For a tame mapping class $f$ and a curve or line $\alpha$, the following
    statements hold. 
    \begin{enumerate}
      \item $\L^+(\alpha)=\emptyset$ if and only if $\alpha$ is
        forward wandering. 
      \item $\L^-(\alpha)=\emptyset$ if and only if $\alpha$ is
        backward wandering. 
      \item $\L(\alpha)=\emptyset$ if and only if $\alpha$
        is wandering. 
      \item $\L(\alpha)$ contains a curve if and only if
        $\alpha$ is a periodic curve, in which case
        $\L(\alpha)=\L^+(\alpha)=\L^-(\alpha)$ is the orbit of $\alpha$
        under $f$.
    \end{enumerate}
  \end{cor}

  Another consequence of tameness is that limits of iterates of curves can
  only intersect finitely many times.

  \begin{lemma}
  
    Let $f$ be a tame homeomorphism. Then for any two (not necessarily
    distinct) curves $\alpha$ and $\beta$, if $f^{n_j}(\alpha) \to
    \lambda \subset \L(\beta)$ and $f^{m_k}(\beta) \to \lambda' \subset
    \L(\beta)$, for some sequences $n_j$ and $m_k$, then
    $i(\lambda,\lambda') < \infty$.

  \end{lemma}

  \begin{proof}

    If $i(\lambda,\lambda') = \infty$, then for every $N$ there are $j,k$
    such that $i(f^{n_j}(\alpha),f^{m_k}(\beta))\geq N$, by Lemma
    \ref{lem:tame-intersection}. Thus, $i(\alpha, f^{m_k-n_j}(\beta))\geq
    N$, so $f$ is not tame by Lemma \ref{lem:tame-properties}.\qedhere
    
  \end{proof}
  
\section{Subsurfaces and spanning sets of curves}

  \label{sec:subsurfaces}
  Throughout this section, we fix a hyperbolic structure on $S$.  Given a
  collection of curves $\C$, a curve $\alpha$ is a \emph{concatenation} of
  curves in $\C$ if it is homotopic to a finite concatenation of piecewise
  geodesic arcs coming from the geodesic representatives of curves in $\C$.
  The collection $\C$ is \emph{closed under concatenation} if every curve
  obtained as a concatenation of curves in $\C$ belongs to $\C$. 
  
  We say that a subsurface $\Sigma$ is \emph{spanned} by $\C$ if:
  \begin{enumerate}
  \item every curve in $\C$ is contained in $\Sigma$, up to isotopy, and
  \item if $\gamma$ is a curve in $\Sigma$, $\gamma$ is a concatenation of
    the curves in $\C$
  \end{enumerate}
  and it is minimal (with respect to inclusion, up to proper homotopy)
  among all subsurfaces satisfying (1) and (2).

  Note that if $\C$ spans a subsurface $\Sigma$, then necessarily $\C$ cuts
  $\Sigma$.  On the other hand, a (sub)surface $X$ does not necessarily
  coincide with the subsurface spanned by its curves. This is for instance
  not the case for a (sub)surface homeomorphic to a one-holed torus with
  points removed from the boundary). We say that $X$ is \emph{cut by its
  curves} if it does coincide with the subsurface spanned by its curves.

  When $\C$ is a finite collection, then there is always a subsurface $\Sigma$
  (of finite type) spanned by $\C$. Namely, put the elements in $\C$ in
  general position. Then $\Sigma$ is obtained by taking a regular neighborhood
  of the union of the curves and filling in all disks with at
  most one puncture.
  
  In general, one can show that if a surface spanned by a collection of
  curves exists, it is unique (up to proper homotopy). To prove this fact,
  we introduce three subsets of $\C$ that we will also use later:
  \begin{align*}
    &\Cis :=\{\gamma\in\C\st \forall\gamma'\in\C,\; i(\gamma,\gamma')=0\}\\
    &\Cint :=\C\ssm\Cis\\
    &\Ca :=\{\gamma\in\Cis\st \gamma \text{ is not a concatenation of curves in }\Cint\}
  \end{align*}

  If a subsurface spanned by $\C$ exists, the curves in $\Ca$ are those
  which contribute to annular components of the subsurface, while the ones
  in $\Cis\ssm\Ca$ will be boundary components of non-annular components.

  \begin{lemma}\label{lem:spanned-unique}
    Let $\C$ be a collection of curves. If $\Sigma_1$ and $\Sigma_2$ are
    surfaces spanned by $\C$, then they are properly homotopic.
  \end{lemma}
  
  \begin{proof}
    Suppose $\Sigma_1$ and $\Sigma_2$ are subsurfaces spanned by $\C$. Fix
    a hyperbolic structure on $S$, assume that all curves in $\C$ are
    geodesic. Let $\Sigma_i^\circ$ be the geodesic representative of the
    interiors of $\Sigma_i$, chosen so that $\partial\Sigma_1^\circ$ and
    $\partial\Sigma_2^\circ$ are in minimal position. Let $\Sigma$ be an
    almost geodesic representative of $\Sigma_1^\circ\cap\Sigma_2^\circ$.
    Then $\Sigma$ is properly homotopic into both $\Sigma_1$ and
    $\Sigma_2$. We claim that $\Sigma$ contains all curves in $\C$ and that
    all curves in $\Sigma$ are concatenations of curves in $\C$. Then by
    minimality of $\Sigma_1$ and $\Sigma_2$, they both are properly
    homotopic to $\Sigma$ and hence to each other.
  
    So let's prove the claim.
  \begin{enumerate}
    \item Let $\gamma\in\C$. If $\gamma\notin \Cis$, it is non-peripheral
      in a subsurface contained both in $\Sigma_1$ and $\Sigma_2$, so it's
      contained in both $\Sigma_1^\circ$ and $\Sigma_2^\circ$ and therefore
      $\gamma\subset \Sigma$, up to homotopy. If $\gamma\in \Ca$, it must
      correspond to an annular component in both $\Sigma_1$ and $\Sigma_2$,
      so it is contained in $\Sigma_1^\circ$ and $\Sigma_2^\circ$ and
      therefore in $\Sigma$. If $\gamma\in\Cis\ssm \Ca$, there are finitely
      many curves in $\C\ssm\Cis$, say $\beta_1,\dots,\beta_k$, so that
      $\gamma$ is a concatenation of arcs of the $\beta_i$. In particular
      $\gamma$ is contained in the subsurface spanned by the $\beta_i$,
      which is contained, up to homotopy, in both $\Sigma_i$ and
      $\Sigma_i^\circ$. So $\gamma\subset \Sigma$.
    \item If $\gamma\subset \Sigma$, up to homotopy $\gamma\subset
      \Sigma_i$ (for $i=1,2$), and hence it is a concatenation of curves in
      $\C$. \qedhere
  \end{enumerate}
  \end{proof}

  Note that for uniqueness to hold we need the minimality assumption, even
  for finite collections of curves on finite-type surfaces. For example,
  consider a genus-two surface with a single puncture and let $\C$ be the
  collection of two curves $\alpha$ and $\beta$ intersecting once. Then a
  one-holed torus with a point removed from the boundary (as in Figure
  \ref{fig:crowned-torus}) satisfies conditions (1) and (2), but it is not
  minimal. The subsurface spanned by $\C$ is a one-holed torus (with
  compact boundary).
  
  \begin{figure}[h]
  \begin{center}
  \begin{overpic}[scale=.9]{crowned-torus}
  \put(5,15){$\alpha$}
  \put(20,6){$\beta$}
  \put(22,58){$\Sigma$}
  \end{overpic}
  \caption{A (non-minimal) subsurface $\Sigma$ whose curves are
    concatenations of $\alpha$ and $\beta$}\label{fig:crowned-torus}
  \end{center}
  \end{figure}
  
  If $\C$ is an infinite collection of curves, a subsurface spanned by $\C$
  doesn't always exist --- see for instance Figure \ref{fig:notspanning}. A
  simple condition that ensures the existence of a spanned subsurface is
  $\C$ being a \emph{locally finite} collection, by which we mean every
  compact set of $S$ intersects only finitely many curves in $\C$. The main
  goal of this section is to give a condition on $\C$ which ensures that it
  spans a subsurface. We will actually give a necessary and sufficient
  condition for a collection $\C$ to span a subsurface, under the
  assumption that $\C$ is closed under concatenation (Proposition
  \ref{prop:span}). This assumption is satisfied by some natural
  collections of curves, such as curves which are periodic or wandering
  with respect to some mapping class:
  
  \begin{lemma}\label{lem:periodic&wandering}

    Let $f$ be a mapping class on $S$. Every curve obtained as a
    concatenation of $f$--periodic curves is periodic, and every curve
    obtained as a concatenation of wandering curves is
    wandering. 

  \end{lemma}

  \begin{proof}

    We first consider periodic curves. A curve is a concatenation of curves
    $\gamma_1,\dots, \gamma_n$ if and only if it is a curve in the
    subsurface $F$ spanned by $\{\gamma_1,\ldots,\gamma_n\}$. Note that $F$
    is connected and has negative Euler characteristic. Since each
    $\gamma_i$ is $f$--periodic, we can take a suitable power so that $f^k$
    fixes $\gamma_i$ for all $i$. Since $F$ is spanned by $\{\gamma_i\}$,
    $f^k(F)$ is spanned by $\{f^k(\gamma_i)\}=\{\gamma_i\}$, so $f^k(F)$ is
    isotopic to $F$. Since $F$ has negative Euler characteristic, $f^k$
    restricted to $F$ is isotopic to a periodic map of $F$ (see Lemma
    \ref{lem:periodic-finite-type}), so every curve in $F$ is
    $f$--periodic. 
    
    The proof for wandering curves is similar. Let $F$ be the subsurface
    spanned by a finite collection $\{\gamma_1,\ldots,\gamma_n\}$ of
    wandering curves. It is enough to prove that for all compact subsurface
    $K \subset S$, there exists $k_0 \in \N$ such that $f^{\pm k}(F)$ can
    be homotoped to be disjoint from $K$ for all $k \ge k_0$. Since
    $\{\gamma_1,\ldots,\gamma_n\}$ are wandering, we can find such $k_0$ so
    that $f^{\pm k}(\gamma_i)^* \cap K = \emptyset$ for all $k \ge k_0$ and
    all $i$. Then $f^{\pm k}(F)$ is spanned by $\{f^{\pm k}(\gamma_i)\}$,
    so $f^{\pm k}(F)$ can be homotoped away from $K$. \qedhere

  \end{proof}
  
  \begin{figure}[ht]
  \begin{center}
  \includegraphics[scale=.9]{notspanning}
  \caption{The beginning of a collection of curves not spanning a
    subsurface}\label{fig:notspanning}
  \end{center}
  \end{figure}
  
  As mentioned before, if $\C$ is a finite collection of curves there is an
  explicit way to construct the subsurface spanned by $\C$. If $\C$ is any
  collection of curves, to try and construct a candidate for the subsurface
  spanned by $\C$, one could enumerate the curves in $\C$, take the
  geodesic subsurface spanned by the first $n$ curves and then take the
  union of these subsurfaces. However, this union might not be the right
  candidate, if there are annular components or boundaries that are
  homotopic --- think for instance of the subsurface spanned by all curves
  disjoint from a given one. So we need a more complicated procedure, to
  deal with this issue.
    
  Recall the sets $\Cis, \Cint$ and $\Ca$ defined before:
  \begin{align*}
    &\Cis :=\{\gamma\in\C\st \forall\gamma'\in\C,\; i(\gamma,\gamma')=0\}\\
    &\Cint :=\C\ssm\Cis\\
    &\Ca :=\{\gamma\in\Cis\st \gamma \text{ is not a concatenation of curves in }\Cint\}
  \end{align*}
  Enumerate the curves in $\Cint$: \(\Cint=\{\gamma_0,\gamma_1,\dots\}\).
  Up to reordering, we can assume that $i(\gamma_0,\gamma_1) \ne 0$. Then
  for every \(i\geq 1\), let \[\Cint^{i}:=\{\gamma_j\st Â´j\leq i
  \;\mbox{and}\; \exists\;j'\leq i \text{ such that }
  i(\gamma_j,\gamma_{j'})\neq 0\}.\] Note that $\Cint^{1} =
  \{\gamma_0,\gamma_1\}$, $\Cint^{i} \subset \Cint^{i+1}$, and
  \(\Cint=\bigcup_{i\geq 1}\Cint^{i}\). Moreover, if
  $\Cint^i\neq\Cint^{i+1}$, to obtain $\Cint^{i+1}$ we add curves which
  either intersect curves in $\Cint^i$ or intersect each other.  In
  particular, each component of the subsurface spanned by $\Cint^{i}$ has
  negative Euler characteristic. 
    
  We now let \(F^{i}=F(\Cint^i)\) be the geodesic representative of the
  \emph{interior} of the subsurface spanned by \(\Cint^{i}\) and define
    \[F=F(\Cint):=\bigcup_{i\geq 1}F^{i}.\]
    By construction every connected component of \(F^{i}\) is an open subset
    (homotopic to a subsurface), and thus $F$ is an open subset of $S$. We
    will call $F$ the \emph{set spanned} by $\Cint$.
    
    We will say a collection $\C$ of curves is \emph{good} if:
    \begin{enumerate}
      \item[(a)] the curves in \(\Ca\) when made geodesic do not accumulate
        anywhere, and
      \item[(b)] for every \(p\in\partial F\) there is a closed disk \(B\)
        centered at \(p\) such that \(B\cap F\) is either \(B\) minus a
        diameter or a connected component of \(B\) minus a diameter. 
    \end{enumerate}

    \begin{figure}[htp]
    \begin{center}
    \begin{overpic}{notspanning2}
    \put(49,-4){$p$}
    \end{overpic}
    \vspace{.2cm}
    \caption{A collection of curves which is not good}\label{fig:notspanning2}
    \end{center}
    \end{figure}
    
    For instance, the collection of curves depicted in Figure
    \ref{fig:notspanning} is not good, because isolated curves accumulate
    somewhere. Similarly, the collection in Figure \ref{fig:notspanning2}
    is not good either, because condition (b) is not satisfied at the point
    \(p\) in the drawing (onto which the curves accumulate). In both
    examples, the collection of curves do not span a subsurface. Indeed, we
    will show that the condition of being good is equivalent to $\C$
    admitting a spanning subsurface (if $\C$ is closed under
    concatenation).
    
    Let $K \subset S$ be a finite-type subsurface with compact totally
    geodesic boundary. Each $F^{i}$ intersects $K$ in a disjoint union of
    open subsurfaces and disks with at most one puncture. By a
    \emph{rectangle} we mean a connected component $R$, homeomorphic to a
    closed disk, of $K \cap F^{i}$, with boundary split into
    \emph{horizontal sides} lying in $\partial F^{i}$ and \emph{vertical
    sides} lying in $\partial K$. All components of $K \cap F^{i}$ which
    are not rectangles are called \emph{essential}. Let $K^{i}_e$ be the
    union of all the essential components of $K \cap F^{i}$.  
    
    \begin{figure}[h]
      \begin{center}
        \includegraphics[scale=.8]{Ke+rectangles}
        \caption{A compact subsurface $K$, whose boundary is in green, and
        the boundary of a subsurface $F^i$ in light blue. The shaded part
        is the intersection, formed by an essential component and a
        rectangle.}
      \end{center}
    \end{figure}

    \begin{lemma}\label{lem:stable-essential}
      For all $i \ge 2$, $K^{i}_e \subset K^{i+1}_e$, and for
      large $i$ it stabilizes. More precisely, there exists an open
      subsurface $K_e\subset K$ and such that for all sufficiently large $i$,
      $K^{i}_e$ is isotopic to $K_e$.
    \end{lemma}

    \begin{proof}
      This follows from Euler characteristic considerations. \qedhere
    \end{proof}

    So for any finite-type subsurface $K$ with compact totally geodesic
    boundary, there exists $I$ such that for all $i \ge I$, the topology of
    the essential
    components $K^{i}_e$ stabilizes, and further increasing $i$ only adds
    new rectangles or adjoins previous ones.  We define:
      \[ \mathcal{R}(K) =  \{ R \st R \subset K \cap F^{i} \text{
      is a rectangle for some $i \ge I$ and is not contained in any  $K^i_e$} \}.\]
    Two parallel rectangles in $\mathcal R(K)$ are \emph{equivalent} if
    they are contained in the same connected component of $F^i\cap K$ for
    some $i$.
    
    The following result is not hard to prove, and we leave it as an
    exercise.

    \begin{lemma}
      The relation defined above is an equivalence relation on
      $\mathcal{R}(K)$. Moreover, suppose $R_1$, $R_2$, $R_3$ are three
      parallel rectangles with $R_2$ contained in the rectangle between
      $R_1$ and $R_3$. If $R_1$ and $R_3$ are equivalent, then all three
      are equivalent.
    \end{lemma}

    So we can naturally organize parallel rectangles into equivalence
    classes of rectangles. As $i$ further increases the number of
    equivalence classes may increase. We have the following proposition.
    
    \begin{prop}\label{prop:span}
      Suppose \(\C\) is a collection of curves closed under concatenation.
      The following statements are equivalent:
      \begin{enumerate}
      \item there is a subsurface spanned by \(\C\); 
      \item the curves in \(\Ca\) do not accumulate anywhere and for every
        compact subsurface \(K\) with totally geodesic boundary, the number
        of equivalence classes in \(\mathcal{R}(K)\) is finite;
      \item \(\C\) is good.
      \end{enumerate}
    \end{prop}

    \begin{proof}

      [(1) \(\Rightarrow\) (2)] Let $\Sigma$ be a surface spanned by $\C$.
      By contradiction, suppose the curves in $\Ca$ accumulate somewhere.
      Then we can find a sequence of curves $\gamma_j\in\Ca$ and a curve
      $\alpha$ such that $$i(\gamma_j,\alpha)\neq 0.$$ $\Sigma$ is a
      subsurface, so $\Sigma\cap \alpha$ consists of finitely many arcs,
      with at least one, denoted $a$, intersecting at least three curves,
      say $\gamma_{j_1},\gamma_{j_2}$ and $\gamma_{j_3}$. Assume that
      $\gamma_{j_2}\cap a$ is between $\gamma_{j_1}\cap a$ and
      $\gamma_{j_3}\cap a$. Then the pair of pants containing
      $\gamma_{j_1}\cup a\cup \gamma_{j_3}$  is in $\Sigma$ and contains a
      curve $\beta$ intersecting $\gamma_{j_2}$ essentially. As $\beta$ is
      in $\Sigma$, $\beta$ is a concatenation of curves in $\C$, and since
      $\C$ is closed under concatenation, $\beta\in\C$, which contradicts
      the definition of $\Ca$. So the curves in $\Ca$ cannot accumulate
      anywhere.

      If instead there is a finite-type subsurface $K$ with compact totally
      geodesic boundary such that $\mathcal{R}(K)$ has infinitely many
      equivalence classes, we find infinitely many parallel rectangles
      $R_i$ which are not equivalent. Let $\gamma_i$ be a curve in $F$
      passing through $R_i$. As the $\gamma_i$ are, by construction,
      concatenations of pieces of curves in $\C$, they all are in $\Sigma$.
      As $\Sigma$ is a subsurface, $\Sigma\cap K$ is a finite union of
      connected components. In particular there is some component $X$ of
      $\Sigma\cap K$ containing $\gamma_i\cap K$ for infinitely many $i$.
      This implies that we can find distinct curves $\gamma_{i_1}$ and
      $\gamma_{i_2}$ such that the rectangle $R$ between $\gamma_{i_1}\cap
      K$ and $\gamma_{i_2}\cap K$ is included in $\Sigma$. Thus the
      boundary of this rectangle is a concatenation of curves in $\C$,
      which implies that the rectangle between them is contained in
      $F^l\cap K$ for some $l$, so $R_{i_1}$ and $R_{i_2}$ are equivalent,
      a contradiction.

      [(2) \(\Rightarrow\) (3)] We just need to show property (b). By
      construction, $\partial F$ is a union of limits of simple closed
      geodesics. We claim that for every finite-type subsurface $K$ with
      compact totally geodesic boundary, $\partial F\cap K$ has finitely many
      connected components. If not, as $K$ is of finite type, there are
      infinitely many components $l_j$, $j\in \N$, of $\partial F \cap K$
      which are parallel to a given arc from $\partial K$ to $\partial K$.
      Thus there are infinitely many rectangles between the $l_j$ which are
      not in $F$ and therefore infinitely many rectangles that are not
      equivalent, a contradiction.

      So for every $p\in\ell\subset F$ we can find a sufficiently small ball
      $B$ such that $\ell\cap B$ coincided with $\partial F\cap B$ and it is
      a single arc from $\partial B$ to $\partial B$. In particular, $B\ssm
      \partial F=B\ssm \ell$ has two components, each of which is either
      entirely contained in $F$ or in $S\ssm F$. Moreover, since $\ell\subset
      \partial F$, at least one of the components intersects, and hence is
      contained in, $F$. So $B$ is the required disk.
      
      [(3) \(\Rightarrow\) (1)] The condition on the boundary points shows
      that $\partial F$ contains no non-proper component and that its
      components don't accumulate anywhere. If $\gamma\subset \partial F$
      is a compact boundary component, we can find some finite-type
      subsurface $K$ with compact boundary component such that
      $\gamma\subset K$. As $K^i_e$ stabilizes, $\gamma$ is eventually a
      boundary component of some $F_i$, and therefore is an essential
      curve. If $\gamma\subset \partial F$ is a non-compact boundary
      component, since it is the limit of simple closed geodesics, it is
      geodesic, and therefore it is a line. Moreover, since each component
      of $\partial F$ is a simple closed geodesic or the limit of simple
      closed geodesics, for any $\ell\subset \partial F$, either
    \begin{itemize}
      \item for every $p\in\ell$ there is a closed disk $B$ centered at $p$
        such that $B\cap F$ is a connected component of a disk minus a
        diameter, or
      \item for every $p\in\ell$ there is a closed disk $B$ centered at $p$
        such that $B\cap F$ is a disk minus a diameter.
    \end{itemize}
    Let $T_1$ be the collection of lines and curves in $\partial F$ for which
    the first condition holds and $T_2$ the other lines and curves in
    $\partial F$.

    For every $\ell\in T_2 \cup \Ca$ we can find a regular
    neighborhood $N(\ell)$ such that:
    \begin{itemize}
    \item $N(\ell)$ is open if $\ell\in T_2$ and closed if $\ell\in \Ca$,
    \item $N(\ell)$ is disjoint from $\partial F\cup \Ca\ssm\{\ell\}$, and
    \item if $\ell_1\neq \ell_2$, then $N(\ell_1)\cap N(\ell_2)=\emptyset$, and
    \item the neighborhoods don't accumulate anywhere. \end{itemize}
    
    We can find such neighborhoods by the properness of components of
    $\partial F$ and by the non-accumulation assumption for $\Ca$ (we can
    just fix a compact exhaustion of the surface and construct the
    neighborhoods piece by piece).

    Define
    $$\Sigma:=\left(F\cup\bigcup_{\ell\in T_1}\ell \cup
    \bigcup_{\gamma\in\Ca}N(\gamma) \right)\ssm \bigcup_{\ell\in
    T_2}N(\ell).$$ Then $\Sigma$ is a two-dimensional submanifold. Its
    boundary components are either homotopic to boundary components of $F$,
    and therefore are essential curves or lines, or homotopic to curves in
    $\Ca$, so essential curves. Hence $\Sigma$ is a subsurface.

    It is clear that $\Sigma$ contains all curves in $\C$. Moreover, if
    $\gamma$ is a curve in $\Sigma$, either it is contained in an annular
    component, and therefore is in $\C$, or we can show (as for the compact
    boundary components of $F$) that $\gamma$ is homotopic into some $F_i$,
    so it is a concatenation of curves in $\C$. Finally, $\Sigma$ is
    properly homotopic to $F\cup\bigcup_{\gamma\in\Ca}\gamma$; as any
    surface containing all curves in $\C$ needs to contain
    $F\cup\bigcup_{\gamma\in\Ca}\gamma$, up to proper isotopy, $\Sigma$
    satisfies the minimality hypothesis and thus is a subsurface spanned by
    $\C$. \qedhere

  \end{proof}
  
  \begin{cor}\label{cor:spanned-disjoint}
    If $X$ and $Y$ are subsurfaces spanned by two collections of curves
    $\C_X$ and $\C_Y$ and $i(\alpha,\beta)=0$ for every $\alpha\in
    \C_X,\beta\in\C_Y$, then $X$ and $Y$ are disjoint.
  \end{cor}
  
  \begin{proof}
    This follows from the construction of an explicit subsurface spanned by
    a set of curves given in the proof of Proposition \ref{prop:span},
    together with the uniqueness of spanned subsurfaces (Lemma
    \ref{lem:spanned-unique}). \qedhere
  \end{proof}
 
  We record here a consequence of having a non-good collection of curves.
  This will be our main tool to show certain collections of curves are
  good.

  \begin{lemma}\label{lem:not-good}
    Let $\C$ be a collection of curves closed under finite concatenations.
    Suppose $\C$ is not good. Then there is a simple closed geodesic
    $\alpha$ and two infinite sequences of simple closed geodesics
    $\beta_j,\gamma_j$, $j \in \N$, with the following properties:
    \begin{enumerate}
      \item $\alpha, \gamma_j \notin \C$ but $\beta_j\in \C$, for all
        $j$.
      \item every $\beta_j$ intersects $\alpha$ and the
        $\beta_j$'s are
        pairwise disjoint. 
      \item For every $j$, there is a subarc $\tau_j \subset \alpha$ joining
        $\beta_{j}$ to $\beta_{j+1}$ so that the regular neighborhood
        of the union
        $\tau_j\cup\beta_j\cup\beta_{j+1}$ 
        is a pair of pants whose third boundary component is $\gamma_j$.
        Furthermore, $\tau_j$'s are pairwise disjoint and $\tau_j$ is disjoint
        from $\beta_{k}$ for $k<j$.
    \end{enumerate}
  \end{lemma}
 
  \begin{proof}
    By Proposition \ref{prop:span}, either there is a compact subsurface
    $K$ with totally geodesic boundary such that $\mathcal{R}(K)$ contains
    infinitely many equivalence classes, or the curves in \(\Ca\)
    accumulate somewhere. 
    
    In the first case, we can find a sequence $R_i\in \mathcal{R}(K)$ which
    are all parallel and pairwise not equivalent. Let $\alpha$ be a
    boundary curve of $K$ containing a vertical side of each $R_i$. Up to
    passing to a subsequence, we can assume that there is an oriented arc
    $[p,q] \subset \alpha$ and a sequence of points $v_i\in R_i\cap [p,q]$
    converging monotonically to $q$. For every $i$ we can moreover find a
    curve $\delta_i\in \C$ which is a boundary component of some surface
    $F^{l_i}$ and intersecting $K$ in a collection of arcs that includes a
    horizontal arc of $R_i$. This boundary curve is in $\mathcal C$ since
    the collection is closed under concatenation. In this way all
    $\delta_i$'s are pairwise disjoint since the $F^{l_i}$'s are nested.

    After a subsequence, we can assume that the intersections
    $R_i\cap\alpha$ converge to a point $q\in\alpha$ and that the
    $\delta_i$'s don't contain $q$. After a further subsequence there will
    be an oriented arc $[p,q]\subset\alpha$ that contains a vertical side
    of each $R_i$ and the convergence to $q$ is monotonic along $[p,q]$.
    Further, any arc of any $\delta_i\cap K$ that intersects $[p,q]$ is
    contained in some rectangle. Inductively, we can construct a
    subsequence $\delta_{i_j}$ such that
    \begin{enumerate}[(i)]
     \item there is a strand of $\delta_{i_{j+1}}$ below (i.e.\ closer
       to $q$) all strands of $\delta_{i_j}$, and
     \item between the lowest strand of $\delta_{i_j}$ and the highest
       strand of $\delta_{i_{j+1}}$ which is still below $\delta_{i_j}$
        there are at least two other $\delta_k$'s intersecting $[p,q]$.
    \end{enumerate}
    Let $\tau_j$ be the subarc of $[p,q]$ connecting the two strands of
    $\delta_{i_j}$ and $\delta_{i_{j+1}}$ in (ii). Let $\gamma_{j}$ be the
    third boundary component of a small regular neighborhood of
    $\delta_{i_j}\cup\tau_{j}\cup\delta_{i_{j+1}}$. Since $\tau_{j}$
    intersects another $\delta_{k}$, $\gamma_{j}$ is essential. Moreover,
    if $\gamma_{j}\in\mathcal C$, then the rectangles associated with the
    two strands of $\delta_k$'s would be equivalent, which is a
    contradiction. Now rename $\beta_j:=\delta_{i_j}$. 
    
    If the curves in \(\Ca\) accumulate somewhere, we can find a curve
    $\alpha$ intersecting infinitely many $\delta_i\subset \Ca$. As before,
    up to passing to a subsequence, we can find an arc $[p,q] \subset
    \alpha$, with some $v_i \in \delta_i\cap [p,q]$ converging to $q$
    monotonically. We then define $\delta_{i_j}$, $\gamma_j$ and $\tau_j$
    as above. Since each $\gamma_j$ intersects a curve in $\Ca$,
    $\gamma_j\notin\C$.

    Note that in both cases there may be strands of $\beta_k$ that
    intersect $\tau_j$ when $k>j+1$. \qedhere

  \end{proof}
  
  \begin{figure}[H]
  \begin{center}
  \begin{overpic}{not-subsurface}
  \put(29.5,5){$a$}
  \put(84,31){$p$}
  \put(84,-2){$q$}
  \put(101,28){\color{FigGreen}$\beta_{1}$}
  \put(101,14){\color{FigGreen}$\beta_{2}$}
  \put(95,26){\color{FigLightBlue}$\gamma_1$}
  \put(86,24){\color{blue}$\tau_1$}
  \end{overpic}
  \vspace{.2cm}
    \caption{On the left-hand side, the arc $a=[p,q]$ for the non-good
    collection of curves of Figure \ref{fig:notspanning}; on the right-hand
    side, the general situation in the proof of Lemma \ref{lem:not-good}.}
  \end{center}
  \end{figure}

  \begin{remark}\label{rmk:tau^n}
    In the situation of the previous lemma, and given a homeomorphism $f$,
    fix an index \(j\). Look at \(f^n(\alpha), f^n(\beta_{j})\) and
    \(f^n(\beta_{j+1})\) and consider an ambient isotopy which sends them
    to their geodesic representatives. The image through this isotopy of
    \(f^n(\tau_j)\) is a geodesic arc of $f^n(\alpha)^*$ that we denote by
    $\tau_j^n$. In particular, $f^n(\gamma_j)^*$ is homotopic to
    $f^n(\beta_{j})^* \cup \tau_j^n \cup f^n(\beta_{j+1})^*$.
  \end{remark}
  
  \section{Diagonal closure of lines}
  
  In this section we discuss two subsurfaces associated to a finite
  collection of lines: the subsurface spanned by the lines and the diagonal
  closure of the collection of lines.
  
  Given a finite collection of lines $L$, the subsurface \emph{spanned} by
  $\L$, denoted  $\langle L \rangle$, is the subsurface obtained by putting
  the lines in minimal position, taking a regular neighborhood of the union
  of the lines and filling in all disks with at most one puncture.
  
  Given two rays $r_1$ and $r_2$, we say that they \emph{cobound a
  half-strip} if there is a proper embedding $\varphi:\R_{\geq 0}\times
  [0,1]\to S$ such that $\varphi(\R_{\geq 0}\times \{0\})=r_1$ and
  $\varphi(\R_{\geq 0}\times \{1\})=r_2$. We say that two lines $\ell_1$
  and $\ell_2$ are \emph{asymptotic} in some direction if they contain rays
  $r_1\subset \ell_1$ and $r_2\subset \ell_2$ which cobound a half-strip.
  
  \begin{figure}[ht]
  \begin{center}
  \begin{overpic}{asymptotic}
  \put(35,50){$\ell_1$}
  \put(15,10){$\ell_2$}
  \end{overpic}
  \caption{Two asymptotic lines, with the half-strip cobounded by two
    rays.}\label{fig:asymptotic}
  \end{center}
  \end{figure}
  
  Let $L$ be a finite collection of proper lines with any two
  intersecting finitely many times and with no line ending in an
  isolated planar end. We denote by $\diagclosure{L}$ the
  subsurface of $S$ obtained as follows. First put the lines in $L$ in
  minimal position. Then take the subsurface $\langle L \rangle$
  spanned by $L$ (regular
  neighborhood of the union, with punctured disk complementary
  components added). Then for
  every two (not necessarily distinct) lines and a direction in which
  they are asymptotic, we add to $\langle L \rangle$ the half-strip
  between two rays. Then fill in any additional disks with at most one
  puncture. We call $\diagclosure{L}$ the \emph{diagonal closure} of
  $L$, and the following lemma gives a characterization of
  $\diagclosure{L}$. 

   \begin{lemma}\label{lem:lines-outside-surfaces}
     Let $L=\{\ell_1,\dots,\ell_N\}$ be a finite collection of lines that
     do not end in an isolated planar end of $S$ and any two lines
     pairwise intersect finitely many times. Then for any line $\ell$ that
     does not end in an isolated planar end, the following
     statements are equivalent.
    \begin{enumerate}
      \item $\ell$ can be homotoped into $\diagclosure{L}$;
      \item for any curve $\alpha$, if $i(\alpha,\ell)\neq 0$, then
        $i(\alpha,\ell_j)\neq 0$ for some $j$;
      \item for every compact subsurface $K$, $\ell$ can be homotoped to
        $\ell'$ such that $\ell'\cap K\subset \langle L\rangle$.
    \end{enumerate}
    Moreover there is a finite union of curves $\mu$ such that if $\ell$ is
     a line in $\diagclosure{L}$, then $i(\mu,\ell)\neq 0$.
  \end{lemma}
  
  \begin{proof} We first prove the equivalence of the three conditions.
  
    [(1) $\Rightarrow$ (3)] For any compact subsurface $K$, there is a
    homotopy that homotopes all half-strips of $\diagclosure{L}$ away from $K$.
    We can then set $\ell'$ to be the image under this homotopy of $\ell$.

    [(3) $\Rightarrow$(2)] Let $\alpha$ be a curve with $i(\alpha,\ell)\neq
    0$. Let $K$ be an annulus around $\alpha$ and $\ell'$ a line
    homotopic to $\ell$ so that
    $\ell'\cap K\subset \langle L\rangle$. Since $\ell'$ intersects
    $\alpha$, there is an arc of $\langle L\rangle$ crossing $\alpha$, so
    there is some $j$ such that $i(\alpha,\ell_j)\neq 0$.

    [(2) $\Rightarrow$ (1)] We prove that if $\ell$ cannot be homotoped into
    $\diagclosure{L}$, there is some curve $\alpha$ intersecting $\ell$ and
    disjoint from all $\ell_j$. Assume that all lines are geodesic and
    $\ell$ is in minimal position with respect to $\diagclosure{L}$.

    Note that $\diagclosure{L}$ is the union of a compact surface with
    finitely many half-strips. In particular the boundary of $\diagclosure{L}$
    is a finite union of circles and lines. So the same holds for
    $\Sigma:=\overline{S\ssm \diagclosure{L}}$. Note moreover that $\Sigma$
    doesn't contain rays in boundary cobounding a half-strip in \(\Sigma\),
    because such a half-strip would be contained in $\diagclosure{L}$ by
    construction.
    
    Let $a$ be a component of $\ell\cap\Sigma$ and $F$ the component of
    $\Sigma$ containing $a$. If $a$ is nonseparating in $F$, we can find a
    curve contained in $F$ intersecting $a$ once and we are done. If $a$ is
    separating and both components of $F\ssm a$ are not contractible, we
    can find two non-nullhomotopic curves $\alpha_1$ and $\alpha_2$, one in
    each component of $F\ssm a$, and a simple arc $b$ connecting them. The
    regular neighborhood of $\alpha_1\cup b\cup\alpha_2$ is a pair of pants
    whose third boundary component is the required curve. So we can assume
    that $a$ is separating and at least one component $C$ of $F\ssm a$ is
    contractible. But then, by the classification of contractible surfaces
    with boundary, $C\cup a$ is a closed disk with points removed from the
    boundary. Since the boundary of $\Sigma$ contains only finitely many
    components, $C\cup a$ is a closed disk with finitely many points
    removed from its boundary. As $a$ cannot be homotoped into
    $\diagclosure{L}$, one such point is not an end of $a$. But then
    $\Sigma$ contains a half-strip between two rays in its boundary, a
    contradiction.

    For the last statement, write $\diagclosure{L}$ as 
    \[K\sqcup S_1\sqcup\dots\sqcup S_k,\]
    where \(K\) is a compact surface and the $S_i$ are pairwise disjoint
    half-strips. For every $j=1,\dots,k$ there is a line $\ell_{i_j}$ going
    through $S_j$. As no line ends in a puncture, there is a sequence of
    essential separating curves, pairwise not homotopic, converging to the
    end of $\ell_{i_j}$ contained in $S_j$; we can choose one such curve
    $\alpha_j$ sufficiently far out so that $\alpha_j$ intersects
    $\ell_{i_j}\cap S_j$ and is disjoint from $K$. Let
    $$\mu=\bigcup_{j=1}^k\alpha_j.$$

    If $\ell$ is a line in $\diagclosure{L}$, by properness $\ell$ contains
    the ray $\ell_{i_j}\cap S_j$ for some $j$. So it intersects the
    corresponding $\alpha_j$ and thus $\mu$.\qedhere

  \end{proof}
 
  \begin{figure}[ht]

  \begin{center}
  \begin{overpic}{contractible}
  \put(70,56){$F$}
  \put(35,31){$a$}
  \put(50,22){$C$}
  \end{overpic}
  \caption{The situation in the proof of Lemma
    \ref{lem:lines-outside-surfaces}}
  \end{center}
  \end{figure}

  \begin{remark}
    At first, one might think that condition (2) in the previous lemma is
    equivalent to $\ell$ being in $\langle L\rangle$ (up to proper
    homotopy). The example depicted in Figure \ref{fig:diagclosure} shows
    that this is not the case: condition (2) holds, but $\ell$ cannot be
    properly homotoped into $\langle L\rangle$.
  \end{remark}
  
  \begin{figure}[hb]
  \begin{center}
  \begin{overpic}[width=.5\textwidth]{diagclosure}
  \put(20,30){$\ell$}
  \put(75,30){$\ell$}
  \put(18,-5){$\langle L\rangle$}
  \put(72,-5){$\diagclosure{L}$}
  \end{overpic}
  \vspace{.5cm}
  \caption{$L$ is the union of the two green lines and $\ell$ is the blue
    one. Then $\ell$ is not properly homotopic into $\langle L\rangle$, but
    it is in $\diagclosure{L}$.}\label{fig:diagclosure}
  \end{center}
  \end{figure}

  The reason why we are interested in Lemma
  \ref{lem:lines-outside-surfaces} is the following relation between
  $\diagclosure{\cdot}$ and limits of concatenations of curves.

  \begin{lemma}\label{lem:diagclosure&limits}
    Let $f$ be an extra tame homeomorphism of a surface $S$. Let
    $\alpha_1,\dots,\alpha_k$ be non-periodic curves. If $\beta$ is a
    finite concatenation of $\alpha_1,\dots,\alpha_k$, then \[\L^\pm(\beta)
    \subset \Big\langle \Big\langle {\bigcup_{i=1}^n\L^\pm(\alpha_i)}
    \Big\rangle\Big\rangle.\]
  \end{lemma}
  
  \begin{proof}
    
    Let $\ell\in\L^+(\beta)$ and $\gamma$ a curve intersecting $\ell$. Then
    by Lemma \ref{lem:tame-intersection} there are infinitely many $n\geq
    0$, such that $i(\gamma,f^n(\beta))\neq 0$. Since $\beta$ is a finite
    concatenation of the $\alpha_i$, there is some $j\in\{1,\dots,n\}$ and
    infinitely many $n\geq 0$ so that $i(f^n(\alpha_j),\gamma)\neq 0$. But
    then, again by Lemma \ref{lem:tame-intersection}, there is some
    $\ell'\in\L^+(\alpha_j)$ such that $i(\gamma,\ell')\neq 0$. As $\gamma$
    is arbitrary, Lemma \ref{lem:lines-outside-surfaces} shows that
    $\ell\subset \diagclosure{\bigcup_{i=1}^n\L^\pm(\alpha_i)}$.

    The same proof holds for $\L^-(\beta)$. \qedhere
  \end{proof}

  We end this section with a variant of Lemma
  \ref{lem:lines-outside-surfaces}.

  \begin{lemma}\label{obstruction} 
    Let $A$ and $B$ be two finite collections of lines with finite pairwise
    intersections and $A\subset B$. Then there exist finitely many curves
    $\delta_1,\cdots,\delta_s$ disjoint from lines in $A$ such that if a
    line $\ell\subset \diagclosure{B}$ cannot be homotoped into
    $\diagclosure{A}$, then $i(\ell,\delta_i)\neq 0$ for some $i$.
  \end{lemma}
  
  \begin{proof} 

    As in the proof of Lemma \ref{lem:lines-outside-surfaces}, we can write
    $\diagclosure{B}$ as the union of a finite-type subsurface with totally
    geodesic compact boundary $K$ and pairwise disjoint half-strips $S_1,
    \dots, S_k$. Since $A\subset B$, we can homotope $\diagclosure{A}$ to
    be the union of a finite type subsurface with compact boundary $K'$ of
    $K$ union some of the $S_i$ --- up to renumbering, say $S_1,\dots,
    S_l$.
  
    For every $l< j\leq k$, pick a curve $\delta_{j-l}$ corresponding to
    the strip $S_j$ as in the proof of Lemma
    \ref{lem:lines-outside-surfaces}.  Let then $\delta_{k-l},\dots,
    \delta_s$ be the boundary curves of $K\ssm K'$.
  
    Suppose a line $\ell$ in $\diagclosure{B}$ cannot be homotoped into
    $\diagclosure{A}$. If it goes through a half-strip which is not in
    $\diagclosure{A}$, it intersects one of the $\delta_i$ for $i\leq l$.
    Otherwise $\ell\ssm K$ it is contained in $\diagclosure{A}$, so
    $\ell\cap K$ cannot be contained in $K'$ and hence it intersects some
    $\delta_j$, for $j>l$. \qedhere

  \end{proof}

\section{Extra tame maps: canonical decomposition}

  \label{sec:decomposition}

  By a \emph{decomposition} of $S$ we mean a collection $\{X_i\}$ of
  pairwise disjoint subsurfaces of $S$ (each of which may be disconnected),
  such that  we can find representatives $\tilde{X_i}$ so that $S = \bigcup
  \tilde{X_i^*}$ and the only overlap between $\tilde{X_i}$ and
  $\tilde{X_j}$, $i \ne j$, are common boundary components. When $f$ is a
  homeomorphism of $S$, a decomposition $\{X_i\}$ of $S$ is called
  $f$--invariant if $f(X_i)$ is isotopic to $X_i$ for all $i$. For a
  subsurface $X \subset S$, we say that $f$ \emph{returns to} $X$ if there
  is a power $k>0$ such that $f^k(X)$ is isotopic to $X$. We call any such
  $k>0$ a \emph{returning time} of $f$ to $X$. Note that all returning
  times of $f$ to $X$ are multiples of the smallest returning time.   
  
  Our main proposition in this section is the following. 
  
  \begin{prop} \label{prop:decomposition}

    Suppose $f$ is extra tame. Then there is an $f$--invariant
    decomposition of $S$ into three subsurfaces, $\Sper$, $\Sinf$, and
    $S_0$, with the following properties.
    \begin{itemize}
      \item A curve in $S$ is periodic if and only if it can be
        homotoped into $\Sper$. 
      \item A curve in $S$ is wandering if and only if it can be
        homotoped into $\Sinf$. 
      \item $S_0$ contains no essential, non-peripheral curves.  
    \end{itemize}
    We will call $\Sper$, $\Sinf$, and $S_0$ the \emph{canonical
    decomposition} of $f$ on $S$.

  \end{prop}
  
  An explicit example of an extra tame map is the map induced by the matrix
  $\left(
  \begin{array}{cc}
  2 & 1\\
  1 & 1
  \end{array}
  \right)$ on $S=\R^2\ssm\Z^2$. In this case, the decomposition is given by
  four invariant lines, which cobound one component $X=S_0$, homeomorphic
  to a once-punctured disk with four points removed from the boundary. The
  rest of the surface is $\Sinf$, given by four invariant components (see
  Figure \ref{fig:2111}).

  \begin{figure}[h!]
  \begin{center}
  \includegraphics[scale=.4]{2111}
  \caption{The four invariant lines giving the decomposition of Proposition
    \ref{prop:decomposition} for the map $(x,y)\mapsto (2x+y,x+y)$ on
    $S=\R^2\ssm\Z^2$}\label{fig:2111}
  \end{center}
  \end{figure}

  For any surface $S$ and any extra tame map $f$, the decomposition is
  defined as follows. Denote by $\Cper$ the collection of $f$--periodic
  curves, and $\Cinf$ the collection of $f$--wandering curves. Let $\PSper$
  be the subsurface spanned by $\Cper$ (whose existence is proven in Lemma
  \ref{lem:SperSubs}), $\Sinf$ the subsurface spanned by $\Cinf$ (whose
  existence is proven in Lemma \ref{lem:SinftySubs})
 
  Relative to a hyperbolic metric on $S$, we will pick an almost geodesic
  representative for the components of $\PSper$ and $\Sinf$ as follows. For
  each non-annular component $X$, let $X^*$ be the almost geodesic
  representative of $X$. Recall this means that we first take the geodesic
  representative $X^\circ$ of the interior of $X$ and then remove a small
  regular neighborhood of a boundary component of $X^\circ$ which is
  homotopic to another boundary component of $X^\circ$. By an abuse of
  notation, we will continue to use $\PSper$ and $\Sinf$ as the union of
  the representatives of their components. We define
  $$\PS0:=\overline{S\ssm(\PSper\cup\Sinf)},$$ whose isotopy class is
  independent of the choice of the hyperbolic metric on $S$.
 
  Then:
  \begin{itemize}
    \item $\Sper$ is the union of $\PSper$ (the
      subsurface spanned by periodic curves) and the negative Euler
      characteristic components of $\PS0$,
    \item $\Sinf$ is --- as already said --- the subsurface spanned by
      wandering curves,
    \item $S_0$ is the union of all components in $\PS0$ which have
      non-negative Euler characteristic.
  \end{itemize}
  
  As just seen, a fundamental step in the proof of the proposition is to
  show that, for an extra tame map, $\Cper$ and $\Cinf$ span subsurfaces
  $\PSper$ and $\Sinf$. We then need to show that $\PS0$ has no interesting
  topology. All three proofs are done via contradiction. Namely, we will
  show that if the required statement is false, then we can use Lemma
  \ref{lem:not-good} to find an essential curve $\alpha$ with infinite
  limit set $\L(\alpha)$. The proofs in the cases of the $\PSper$ and
  $\Sinf$ are independent of each other. The proof for $\PS0$ is more
  technical, and it relies on the fact that we already know it is a
  subsurface, being the complement of two subsurfaces, and further no curve
  in $\PS0$ can be periodic or wandering, and thus must limit onto a
  non-empty collection of lines.  

  Let us then prove that $\Sinf$ and $\PSper$ are subsurfaces.

  \begin{lemma}\label{lem:SinftySubs}
    If \(f\) is extra tame, then $\Cinf$ spans a subsurface $\Sinf$. Every
    curve in $\Sinf$ is wandering, and if $\alpha$ is any curve with
    $\L(\alpha) \ne \emptyset$, then $\L(\alpha)$ does not intersect
    $S_\infty$ essentially.
  \end{lemma}

  \begin{proof}

    Suppose there is no subsurface spanned by $\Cinf$. Then we can find
    curves $\alpha$, $\beta_j$ and $\gamma_j$ and arcs $\tau_j \subset
    \alpha$ as in Lemma \ref{lem:not-good}. Recall that $\beta_j \in
    \Cinf$, but $\alpha, \gamma_j \notin \Cinf$. In particular,
    \(\L(\gamma_j)\) and $\L(\alpha)$ are nonempty. Since $\gamma_j$ is a
    finite concatenation of $\alpha,\beta_{j}$ and $\beta_{j+1}$ (and
    none of these is periodic, by assumption and Corollary
    \ref{cor:not-wandering}), by Lemma \ref{lem:diagclosure&limits}
    \[\L(\gamma_j) \subset \diagclosure{\L(\alpha)\cup\L(\beta_{j}) \cup
    \L(\beta_{j+1})}=\diagclosure{\L(\alpha)}, \] where the last equality
    follows from the fact that the $\beta_i$ are wandering, so
    $\L(\beta_i)=\emptyset$. Since $\L(\alpha)$ is finite collection of
    lines that pairwise intersect finitely many times, by Lemma
    \ref{lem:lines-outside-surfaces} there is a finite union of curves
    $\mu$ so that every line in $\diagclosure{\L(\alpha)}$ intersects
    $\mu$. This gives a curve $\delta\subset \mu$ that intersects
    infinitely many $\L(\gamma_j)$. Then, by Lemma \ref{lem:duality},
    \(\L(\delta)\) intersects infinitely many \(\gamma_j\). By finiteness
    of $\L(\delta)$, some \(\ell\in\L(\delta)\) intersects infinitely many
    \(\gamma_j\). If \(i(\ell,\beta_{j})\neq 0\), then
    $i(\delta,\L(\beta_{j}))\neq 0$, which is a contradiction (since
    $\beta_{j}$ is wandering), and the same applies to $\beta_{j+1}$. So
    \(\ell\) needs to intersect infinitely many \(\tau_j\), and thus it
    intersects \(\alpha\) infinitely many times, which is not possible
    since $\ell$ is a proper line. This shows that $\C_\infty$ spans a
    subsurface $\Sinf$.

    For the second statement, every curve in $\Sinf$ is a concatenation of
    wandering curves and hence is wandering by Lemma
    \ref{lem:periodic&wandering}. If $\L(\alpha)$ intersects the interior
    of $\Sinf$, since $\Sinf$ is spanned by wandering curves, there would
    be some $\beta\subset\Sinf$ intersecting $\L(\alpha)$, but this
    contradicts Lemma \ref{lem:not-wandering}.\qedhere

  \end{proof}

  We will also need the following generalization.

  \begin{lemma} \label{SL}
    Let $L^+$ and $L^-$ be two finite collections of lines with finite
    pairwise intersections that intersects every $\mathcal
    L^\pm(\alpha)$ in a finite set. Define
    $$\mathcal C_L:=\{\beta\mid \mathcal L^\pm(\beta)\subseteq
    \diagclosure{L^\pm}\}$$
    Then $\mathcal C_L$ spans a subsurface $S_L$ of $S$.
  \end{lemma}

  \begin{proof}
    Note that $\mathcal C_L$ contains all wandering curves and it is
    closed under concatenation by Lemma \ref{lem:diagclosure&limits}. Assuming
    otherwise, we have curves $\alpha,\beta_j,\gamma_j$ and arcs
    $\tau_j$ as in Lemma \ref{lem:not-good}. This time we have
    \[\L^\pm(\gamma_j) \subset \diagclosure{\L^\pm(\alpha)\cup\L^\pm(\beta_{j}) \cup
    \L^\pm(\beta_{j+1})}\subseteq\diagclosure{\L^\pm(\alpha)}\cup L^\pm \]
    Let $\delta_i^+$ and $\delta_j^-$ be the curves from Lemma
    \ref{obstruction} for the collections $L^\pm\subset L^\pm\cup \mathcal
    L^\pm(\alpha)$. After a subsequence and possibly replacing $f$ by
    $f^{-1}$ and switching $+$ and $-$ we may assume that at least one line
    in $\mathcal L^+(\gamma_j)$ is not homotopic into $\diagclosure{L^+}$
    and therefore intersects some $\delta_i^+$. After a further subsequence
    we may assume that this is always the same curve $\delta=\delta^+_i$.
    This curve does not intersect any of $\mathcal L^+(\beta_j)$, so we
    conclude that $\mathcal L^-(\delta)$ intersects $\alpha$ in infinitely
    many points, giving a contradiction as before. \qedhere
  \end{proof}
  
  \begin{lemma}\label{lem:SperSubs}
    If \(f\) is extra tame, then $\Cper$ spans a subsurface $\PSper$, and
    every curve in $\PSper$ is periodic.
  \end{lemma}

  \begin{proof}
    By Lemma \ref{lem:periodic&wandering}, $\Cper$ is closed under
    concatenation.
        
    As in the previous case, we suppose there is no subsurface spanned by
    periodic curves. Then we can find curves $\alpha$, $\beta_j$ and
    $\gamma_j$ and arcs $\tau_j \subset \alpha$ as in Lemma
    \ref{lem:not-good}. Recall that $\beta_i \in \Cper$, but $\alpha,
    \gamma_j \notin \Cper$. Moreover, since $\alpha$ intersects periodic
    curves, it is not wandering either. Thus \(\L(\alpha)\) is non-empty
    and contains only lines. Moreover, each line in \(\L(\alpha)\) is the
    limit of a bounded number of strands of $f^{n_i}(\alpha)^*$. Let $N$ be
    the cardinality of $\L(\alpha)$, counted with multiplicity, and set
    $J=N+1$. We will now consider the finite collection of curves
    $\gamma_1,\ldots,\gamma_J$. By replacing $f$ by a power, we may assume
    that $f(\beta_{j}) = \beta_{j}$ for all $j \le J+1$. 

    Recall that $\gamma_j$ is homotopic to \(\beta_{j}\cup
    \tau_j\cup\beta_{j+1}\). For each $n$, let $\tau_j^n$ be the geodesic
    subarc of $f^n(\alpha)^*$ which together with
    $f^n(\beta_{j})^*=\beta_{j}$ and $f^n(\beta_{j+1})^*=\beta_{j+1}$ is
    homotopic to $f^n(\gamma_j)^*$ (see Remark \ref{rmk:tau^n}). Since
    $\gamma_j$ is not periodic, the arcs $\tau_j^n$ cannot be periodic. As
    there are only finitely many isotopy classes of arcs of bounded length
    between \(\beta_{j}\) and \(\beta_{j+1}\), the length of $\tau_j^n$
    cannot be bounded as $n \to \infty$. Moreover, the angle of
    intersection of \(\tau_j^n\) with $\beta_{j}$ and $\beta_{j+1}$ is
    bounded away from zero, otherwise there is a sequence of iterates of
    \(\alpha\) wrapping around $\beta_{j}$ or $\beta_{j+1}$ more and more
    times, contradicting tameness. Thus any convergent subsequence of
    \(\tau_j^n\) contains a ray starting at \(\beta_{j}\) and one ray
    starting at \(\beta_{j+1}\). By construction, each such ray is a subset
    of one of the lines in \(\L(\alpha)\). Now choose a subsequence
    $f^{n_{i}}$ so that each (oriented) \(\tau_j^{n_i}\) converges; by the
    argument above, the union of all the limit sets contains at least
    $2J=2N+2$ rays. If a collection of $k$ such limiting rays is nested
    within the same line in \(\L(\alpha)\) then the multiplicity of the
    line is at least $k$. Taking into account both orientations of a line,
    we see that there can be at most $2N$ rays, contradiction. This shows
    the existence of $\PSper$. \qedhere

  \end{proof}

  \begin{lemma} \label{lem:S0}
  
    If $f$ is extra tame, then $\PSper$ and $\Sinf$ are disjoint
    subsurfaces. 

  \end{lemma}

  \begin{proof}

    Since they are subsurfaces spanned by curves, if they are not disjoint,
    by Corollary \ref{cor:spanned-disjoint} there are curves $\alpha$ in
    $\PSper$ and $\beta$ in \(S_\infty\) such that \[i(\alpha,\beta) > 0,\]
    which is a contradiction by Corollary \ref{cor:not-wandering}.\qedhere

  \end{proof}
 
  \begin{lemma}\label{prop:no-ess-nonper}

    If \(f\) is extra tame, $\PS0 :=\overline{S\ssm(\PSper\cup\Sinf)}$ has
    no non-peripheral curves. 
 
  \end{lemma}
  \begin{proof}
    We prove this by contradiction. Suppose there is a curve $\delta$ in
    $\PS0$ which is essential and non-peripheral. Then $\delta$ cannot be
    wandering or periodic, so $L:=\L(\delta)$ is a nonempty collection of
    lines. Let $L^\pm:=\L^\pm(\delta)$ and let $S_L$ be the subsurface
    from Lemma \ref{SL} spanned by the curves $\gamma$ with
    $\L^\pm(\gamma)\subset \diagclosure{L^\pm}$. We can put $S_L$ and
    $S_0$ in minimal position and let $S^0_L=S^0\cap S_L$. Note that
    $S_\infty\subseteq S_L$ and $\Sper\cap S_L$ is a compact surface,
    so the boundaries of $S_L$ and $S_0$ will intersect in finitely
    many points.
   
    Up to replacing $f$ by its inverse, we can assume that \(L^+\) is
    nonempty. By Lemma \ref{lem:lines-outside-surfaces}, we can find a
    finite collection of curves $\{\delta_1^+,\ldots,\delta_k^+\}$
    intersecting all lines in \(\diagclosure{L^+}\). 
    Then by Lemma
    \ref{lem:duality}, for every curve \(\gamma\) in \(S_L\), either
    \begin{enumerate}[(a)]
    \item \(\L^+(\gamma)=\emptyset\), or
    \item \(i(\gamma, \L^-(\delta_i))\neq 0\) for some $i$.
    \end{enumerate}

    We now claim that there is a nonperipheral curve in $S^0_L$ that
    satisfies (a). Indeed, otherwise the finite collection of curves
    and lines in $\cup_i \L^-(\delta_i)$ cuts every nonperipheral
    curve in $S^0_L$. Since there are only finitely many intersection
    points between these curves and lines it follows that each
    component of $S^0_L$ has finite type. The component that contains
    $\delta$ is thus periodic or wandering. This implies that $\delta$
    is periodic or wandering (by tameness, the first return map must
    be periodic). This is a contradiction since $\delta$ is
    nonperipheral in $S_L$, so it doesn't belong to $S_{per}$ nor to
    $S_\infty$.

    Now choose a nonperipheral curve $\delta'$ in $S_0$ that is forward
    wandering. Replace $f$ by $f^{-1}$ and run the whole construction on
    $\delta'$, obtaining the surfaces $S_{L'}$ and $S^0_{L'}$. Now, every
    curve in $S_{L'}$ is backward wandering and the above claim produces
    another nonperipheral curve in $S_L^0$ which is forward wandering, in
    addition to being backward wandering, again a contradiction. \qedhere
      
  \end{proof}

  A consequence of the lemma is the following.
  \begin{cor}
    Any negative Euler characteristic component of $\PS0$ is a pair of
    pants.
  \end{cor}

  \begin{proof}
    If the Euler characteristic were smaller than $-1$, there would be
    essential non-peripheral curves. So the Euler characteristic is $-1$ .
    If the component is not a pair of pants, it is a pair of pants with
    some points removed from its boundary, and therefore contains an
    essential non-peripheral curve, a contradiction.
  \end{proof}

  \subsection{Examples} 

  \label{sec:examples}
 
  We end this section with some examples of tame but not extra tame maps
  for which the conclusions of Proposition \ref{prop:decomposition} are
  false.

The first example shows the existence of a tame map $f$ such that $\L(\alpha)$ is locally finite
    for every curve $\alpha$, but the collection of periodic curves does
    not span a subsurface.

  \begin{example} \label{ex:Spernotsurf}
    Consider the cylinder $\Sigma:=S^1\times \R$ and fix a Cantor set
    $K\subset S^1$. Let $S$ be the surface obtained as
    \[S:=\Sigma\ssm\bigcup_{n=-\infty}^\infty K\times\{t_n\},\]
    where $t_{\pm\infty}=\pm 1$, $t_0=0$, $t_n=-1+\frac{1}{2^{-n}}$ for
    $n<0$ and $t_n=1-\frac{1}{2^{n}}$ for $n>0$ (see Figure
    \ref{fig:cylinder}).

    Fix a monotone non-increasing homeomorphism $s:\R\to\R$ such that
    \begin{align*}
    s(t_{\pm\infty})&=t_{\pm\infty}\\
    s(t_k)&=t_{k+1} \hspace{.5cm} \forall k\in\Z.
    \end{align*}
    Then the map $\text{id}\times s:\Sigma\to\Sigma$ induces a tame
    homeomorphism $f$ of $S$, which has no wandering curves. The periodic
    curves are also fixed curves, which are those that can be homotoped to
    be vertical between height $-1$ and height $1$. In particular $\Cper$
    does not span a subsurface.

  \end{example}

  \begin{figure}[ht]
  \begin{center}
  \begin{overpic}[scale=1.2]{cylinder}
  \put(46,88){$1$}
  \put(46,8){$-1$}
  \end{overpic}
  \caption{A sketch of the surface in Esample \ref{ex:Spernotsurf}, with
    a periodic curve (in green) and the Cantor sets in light
    blue}\label{fig:cylinder}
  \end{center}
  \end{figure}


The next example shows that that there exists a tame map $f$ such that $\L(\alpha)$ is locally finite
    for every curve $\alpha$, but $\Cinf$ does not span a subsurface.
   It will also show that we can construct such an example so that a single component
    of $\Sinf$ is not a subsurface.
 
  \begin{example}

    In the plane, for any $k\in\N$, let $\ell_k$ be the boundary of
    \[ [k+1,\infty) \times
    \left[\frac{1}{k+1}+\varepsilon_k,\frac{1}{k}-\varepsilon_k\right], \]
    where $\varepsilon_k=\frac{1}{10k^2}$ (see Figure \ref{fig:lightblue}
    for a schematic picture). Let $S$ be the plane punctured at the points
    $\left(\frac{1}{n},m\right)$, for $n\in\N$ and $m\in\Z$, at the points
    $(0,m)$, for $m\in\Z$, and for every line $\ell_k$, $k\in\N$, at a
    sequence of points on the line not accumulating anywhere.

   \begin{figure}[htp]
   \begin{center}
   \begin{overpic}[width=.6\textwidth]{lightblue}
   \put(0,5){$(0,0)$}
   \put(24,5){$(1,0)$}
   \put(43,5){$(2,0)$}
   \put(61,5){$(3,0)$}
   \put(80,5){$(4,0)$}
   \put(0,27){$(0,1)$}
   \put(-4,18){$(0,1/2)$}
   \put(-4,14){$(0,1/3)$}
   \put(100,26){$\ell_1$}
   \put(100,16){$\ell_2$}
   \put(100,13){$\ell_3$}
   \end{overpic}
   \caption{The lines $\ell_k$ in the construction of Example
     \ref{ex:Sinfnotsurf}}\label{fig:lightblue}
   \end{center}
   \end{figure}
   The homeomorphism $f$ that we consider is given by:
   \begin{itemize}
   \item the map induced by $(x,y)\mapsto (x+1,y)$ on a small regular
     neighborhood of each horizontal line $y=\frac{1}{n}$ ($n\in \N$) and
       $y=0$,
   \item a puncture shift supported on a small regular neighborhood of
     $\ell_k$, for every $k$ tapered to the identity on the rest of the
       surface.
   \end{itemize}

    One can show that $f$ is tame. Moreover, $F(\Cinf)$ is the disjoint
    union of one strip per line $y=\frac{1}{n}$, $n\in\N$, and of the
    strips $(k,\infty) \times \left(
    \frac{1}{k+1}+\frac{\varepsilon_k}{2},\frac{1}{k}-\frac{\varepsilon_k}{2}\right)$.
    The closure of each component is a subsurface, but the horizontal
    strips accumulate onto $y=0$, so $\Cinf$ doesn't span a subsurface.
    Note moreover that there are no periodic curves.

    We can also modify the surface by adding handles connecting consecutive
    horizontal strips in a translation invariant way (see Figure
    \ref{fig:connectedSinf} for a schematic picture). The map induced by
    $f$ on this new surface is also tame and has no periodic curves. Now
    though $F(\Cinf)$ is given by one component per line $\ell_k$ and a
    single nonplanar component. The nonplanar component is not homotopic to
    a subsurface.

  \end{example}

  \begin{figure}[ht]
  \begin{center}
  \includegraphics[width=.5\textwidth]{connectedSinf}
  \caption{The modified surface in Example
    \ref{ex:Sinfnotsurf}}\label{fig:connectedSinf}
  \end{center}
  \end{figure}

\section{Characterization of translations}

  \label{sec:translation}

  In this section, we give a characterization of a translation in terms of
  the dynamics of its action on curves. The main application will be to an
  extra tame map $f$ and its action on the invariant subsurface $\Sinf$ in
  its canonical decomposition. Therefore, in this section, we need to work
  with surfaces with boundary. Everything in this section is independent of
  the previous sections.

  Extending the notation for curves, when $\delta$ is an essential arc
  in a hyperbolic surface with totally geodesic boundary, we denote by
  $\delta^*$ the geodesic arc homotopic to $\delta$ which is
  perpendicular to the boundary at both endpoints.

  \begin{lemma}\label{lem:e_pm}

    Let $X$ be a connected surface, possibly with boundary, which is cut by
    its curves. Let $f$ be a homeomorphism of $X$ such that every curve in
    $X$ is $f$--wandering. Then there are ends $e_\pm$ of $X$, possibly
    $e_+ = e_-$,  such that for every curve $\alpha$ in $X$ $f^{\pm
    n}(\alpha)^*$ converges to $e_\pm$ as $n\to \pm\infty$.

  \end{lemma}

  We will call $e_+$ and $e_-$ respectively the $f$--\emph{attracting} and
  $f$--\emph{repelling} ends of $X$.

  \begin{proof}

    Let $\alpha$ be a non-peripheral curve in $X$. We first show that
    $f^n(\alpha)^*$ converges to an end. Let
    \[\alpha^*=\alpha_0,\alpha_1,\dots\alpha_k=f(\alpha)^*\] be a chain of
    geodesic curves in \(X\) connecting \(\alpha^*\) and \(f(\alpha)^*\).
    Given any compact set $K$ there is $n_0$ so that if $n >n_0$, the
    $f^n(\alpha_i)^*$ are disjoint from $K$. In particular, $f^n(\alpha)^*$
    and $f^{n+1}(\alpha)^*$ are in the same complementary component of $K$,
    for $n>n_0$, so $f^n(\alpha)^*$ goes to a single end $e_+$ as
    $n\to\infty$. The same argument shows that $f^n(\alpha)^*$ converges to
    an end $e_-$ as $n\to -\infty$.

    If $\beta$ is another non-peripheral curve in $X$, by looking at a
    chain of curves in $X$ connecting $\alpha^*$ to $\beta^*$ and repeating
    the same argument as above, we deduce that $f^n(\beta)^\ast\to e_\pm$
    as $n\to\pm\infty$.
    
    Finally, if $\gamma$ is a peripheral curves, it's a concatenation of
    non-peripheral curves, all of which go under forward (respectively
    backward) iteration to $e^+$ (respectively, $e^-$), and hence so does
    $\gamma$.\qedhere

  \end{proof}
 
  \begin{lemma}\label{lem:delta}

    Let $X$ be a connected surface, possibly with boundary, and $e_+,e_-$
    two different ends of $X$. Then there is a either a curve $\delta$ or a
    finite collection $\delta$ of disjoint arcs in $X$ separating $e_+$
    from $e_-$.

  \end{lemma}

  \begin{proof}
    Let $D(X)$ be the double of $X$ along its boundary (and take $D(X)=X$
    if $\partial X=\emptyset$). Let $i : X \hookrightarrow D(X)$ be the
    inclusion map and $i_*$ the induced map from $\Ends(X)$ to
    $\Ends(D(X))$. Note that $i_*$ is injective, because if
    $e_1,e_2\in\Ends(X)$ are distinct ends, there is a compact subset $K$
    separating them, and therefore $i_*(e_1)$ and $i_*(e_2)$ are separated
    by the double of $K$ in $D(X)$.

    Since $D(X)$ has no boundary, there is a curve $\hat{\delta}\subset
    D(X)$ separating $i_*(e_+)$ and $i_*(e_-)$. Assume $\hat{\delta}$ is in
    minimal position with respect to $i(\partial X)$ and let
    $\delta:=i^{-1}(\hat{\delta})$. Finally, note that 
    $\delta$ separates $e_+$ and $e_-$.
    Indeed, if not, we can find a line $\ell$ in $X$ from $e_+$ to $e_-$
    disjoint from $\delta$, and hence a line $i(\ell)$ from $i_*(e_+)$ to
    $i_*(e_-)$ disjoint from $\hat{\delta}$.\qedhere
  \end{proof}

  \begin{prop}\label{prop:wandering-arcs}

    Let $X$ be a connected surface, possibly with boundary, cut by its
    curves. Let $f$ be a homeomorphism of $X$ such that every curve in $X$
    is $f$--wandering and no line in the boundary is $f$--wandering. Then
    every essential arc $\gamma$ in $X$ is $f$--wandering.

    Moreover, if $X$ is equipped with a complete hyperbolic metric with
    totally geodesic boundary and if an essential arc $\gamma$ has both
    endpoints on the same oriented line $\ell$ which is $f$-invariant, then
    both endpoints of $f^n(\gamma)^*$ go to infinity in the same direction
    along $\ell$ as $n\to\infty$.
 
  \end{prop}

  \begin{proof}
   
    Fix a complete hyperbolic structure on $X$ with totally geodesic
    boundary and with positive injectivity radius.  Recall that for any arc
    $\gamma$, we denote by $\gamma^*$ its geodesic representative which is
    orthogonal to the boundary of $X$. Our goal is to show $f^n(\gamma)^*$
    leaves every compact set of $X$.

    As for curves, we denote by $\L^\pm(\gamma)$ the accumulation set of
    $\gamma_n^*$ as $n \to \pm \infty$. Applying the same argument as in
    Lemma \ref{lem:duality} to arcs, we have that \[ \L(\gamma) \cap \beta
    \ne \emptyset \Longleftrightarrow \L(\beta) \cap \gamma \ne
    \emptyset,\] where $\beta$ is any curve or arc in $S$. Since curves in
    $X$ are wandering, $\L(\gamma)$ cannot intersect the interior of $X$
    essentially. It follows that the endpoints of $\gamma_n^*$ go to
    infinity, for otherwise there would be an arc or a ray perpendicular to
    the boundary in $\L(\gamma)$. This also shows that $\L(\gamma)$ is a
    union of boundary components.

    \emph{Case 1.} Both endpoints of $\gamma$ are on the same boundary line
    $\ell$ and $f$ fixes the oriented line $\ell$. In this case we can
    close up along the boundary to obtain a curve $\tilde\gamma$. Assume
    that $\L^+(\gamma)\neq\emptyset$, i.e.\ that $\gamma$ is not forward
    wandering and fix a sequence $n_i\to\infty$ so that $f^{n_i}(\gamma)^*$
    intersects a fixed compact set $K$.

    \emph{Claim.} The distance between the endpoints of $f^{n_i}(\gamma)^*$
    goes to 0 as $i\to\infty$.

    Indeed, otherwise after a further subsequence the geodesic
    $f^{n_i}(\tilde\gamma)^*$ would be in a fixed Hausdorff neighborhood of
    $f^{n_i}(\gamma)^*$ and would intersect a fixed neighborhood of $K$,
    contrary to the assumption that $\tilde\gamma$ is wandering. 

    Now define the (immersed) curve $\tilde\delta$ to be the concatenation
    $\gamma*\alpha*f(\gamma)*\beta$ where $\alpha,\beta$ are arcs in
    $\ell$. The proof of Lemma \ref{lem:periodic&wandering} shows that also
    immersed curves are wandering. Up to homotopy, we can express
    $f^n(\gamma)$ as $\tau_n^* * \tilde\gamma^* * \overline\tau_n^*$ for a
    geodesic arc $\tau_n^*$ perpendicular at the endpoints to $\ell$ and
    $f^n(\tilde\gamma)^*$ respectively. If the injectivity radius is
    positive and the arcs $\tau_n^*$ are long enough, then $f^n(\gamma)^*$
    and $\tau_n^* * \tilde\gamma^* * \overline\tau_n^*$ will be a uniformly
    bounded distance from each other. 

    As $n\to\infty$, $f^n(\tilde\gamma)^*$ and $f^n(\tilde\delta)^*$ go to
    infinity and further and further away from $K$. By our assumption,
    there are infinitely many $n$ so that $\tau_n^*$ comes within a uniform
    distance from $K$ and thus intersects a somewhat larger set $L$, which
    can be taken to be a finite type surface with totally geodesic
    boundary.

    If $\tau_{n+1}^*$ does not follow within a $\tau_n^*$ within a small
    neighborhood for a large fixed distance after its last intersection
    with $L$, then $f^n(\tilde\delta)^*$ will be homotopic to a curve of
    the form
    $f^n(\tilde\gamma)*\alpha*f^{n+1}(\tilde\gamma)*\overline\alpha$ for an
    arc $\alpha$ perpendicular to both $f^n(\tilde\gamma)$ and
    $f^{n+1}(\tilde\gamma)$ and with parts of $\tau_n^*$ and $\tau_{n+1}^*$
    that don't fellow travel contained in a bounded neighborhood of
    $\alpha$. It follows that $f^n(\tilde\delta)^*$ intersects a bounded
    neighborhood of $L$ and this can happen for only finitely many $n$.
    Thus initial portions of $\tau_n^*$ and $\tau_{n+1}^*$ together with a
    small geodesic arc on $\ell$ and on a boundary component of $L$
    determine a geodesic quadrilateral which is nullhomotopic. The same
    argument can now be applied after replacing $n$ with $n+1$, and
    inductively for all large powers. Thus for large $i$ all $\tau_i^*$ are
    all homotopic, keeping the endpoints on $L$ and $\ell$. But then the
    endpoints on $\ell$ cannot go to $\infty$. This contradiction
    establishes that $\gamma$ is forward wandering.

    \emph{Case 2.} Both endpoints of $\gamma$ are on a periodic line $\ell$.
    Then apply Case 1 to the power of $f$ that fixes the oriented line
    $\ell$.
    %
    %    \emph{Case 3.} Both endpoints of $\gamma$ are on a boundary curve
    %    $\alpha$. Fix a hyperbolic structure on $X$ so that all curves in
    %    the orbit of $\alpha$ have the same length $c_1$. This implies (by
    %    the Collar Lemma) that there is some constant $c$ so that for
    %    every $n$, $f^n(\gamma)^*$ has length at least $c_2$. Suppose now
    %    by contradiction that $\gamma$ is not wandering. Then we can find
    %    a geodesic curve $\beta$ intersecting infinitely many
    %    $f^{n_j}(\gamma)^*$. Look at the two curves obtained as the union
    %    of $\gamma$ with one of the two segments of $\alpha$ joining the
    %    endpoints of $\gamma$. There is at least one of them, called
    %    $\eta$, so that (up to passing to a further subsequence)
    %    $f^{n_j}(\eta)$ is homotopic to $f^{n_j}(\gamma)^*$ union a
    %    segment $a_j$ of $f^{n_j}(\alpha)$ between the endpoints of
    %    $f^{n_j}(\gamma)^*$ of length at least $c_1/2$. So
    %    $f^{n_j}(\eta)^*$ is at uniformly bounded distance from
    %    $f^{n_j}(\alpha)^*\cup a_j$. We now get a contradiction, since
    %    $\eta$ is a wandering curve but
    %    \[i(f^{n_j}(\eta),\beta)=i(f^{n_j}(\alpha)^*\cup a_j,\beta)\neq
    %    0.\]

  \emph{General case.} We have seen that the limit set of $\gamma$, if
  non-empty, can only consist of boundary lines. If $\ell$ is a boundary
  line in $\L(\gamma)$, let $\beta$ be an essential arc with both endpoints
  on $\ell$. Then by the previous cases, $\beta$ is wandering, therefore
  $$0=|\L(\beta)\cap \gamma|=|\beta\cap\L(\gamma)|\geq |\beta\cap \ell| >
  0,$$ a contradiction. \qedhere

  \end{proof}
  
  \begin{cor}\label{cor:double-is-wandering}
    Let $X$ be a surface possibly with boundary and cut by its curves. Let
    $f$ be a homeomorphism on $X$ such that every curve in $X$ is
    $f$--wandering and no line in $\partial X$ is wandering. Let \(D(X)\)
    be its double and \(\hat{f}\) the map induced on it. Then every curve in \(D(X)\)
    is $\hat{f}$-wandering.
  \end{cor}

  \begin{proof}
    The double $D(X)$ is cut by the collection of all curves in each copy
    of $X$ and all curves obtained as doubles of essential arcs in $X$. By
    assumption and by the previous proposition, all these curves are
    wandering. Then by Lemma \ref{lem:periodic&wandering} every curve in
    $D(X)$ is wandering. \qedhere
  \end{proof}

  \begin{thm}\label{thm:translation}
    Let $X$ be a (possibly bordered) surface which is cut by its curves.
    Let $f$ be a homeomorphism of $X$ such that every curve in $X$ is
    $f$--wandering and no boundary line is $f$--wandering. Then there is a
    hyperbolic metric on $X$ and an
    isometric translation on $X$ isotopic to $f$.
  \end{thm}

  \begin{proof}

    By Lemma \ref{lem:e_pm} we know that there are ends $e_+$ and $e_-$ of
    $X$ to which all curves converge under forward/backward iteration. In
    particular, $f(e_\pm)=e_\pm$. There are now two cases.

    \emph{Case 1: $e_+\neq e_-$.} Let $\delta$ and $n$ be as in Lemma
    \ref{lem:delta}.  Set $\delta_i = f^{n_i}(\delta)^*$, each of which is
    an arc separating $e_+$ and $e_-$, and $\delta_{i+1} \subset H_i^+$,
    where $H^+_i$ is the component of $X \ssm \delta_i$ containing $e_+$.
    This shows that the dual graph is a line on which $f^n$ acts as a
    translation. We can homotope $f^n$ so it is a translation on $X$, with
    the region between $\delta_0$ and $\delta_1$ a fundamental domain for
    the action of $f^n$.

    We now argue that $f$ acts as an isometric translation of $X$. Let
    $Q=X/ \langle f^n \rangle$ be the quotient hyperbolic surface for the
    action of $f^n$. Since $f$ commutes with $f^n$, $f$ descends to a map
    on $Q$, whose $n$-th power is the identity map on $Q$, so $f$ is a
    periodic map of $Q$. By Proposition \ref{prop:Nielsenrealization},
    there is a hyperbolic metric on $Q$ for which $f$ acts as an isometry
    of $Q$. Lifting this metric to $X$ also makes $f$ an isometry of $X$.
    Since $f^n$ is a translation of $X$, $f$ acts on $X$ as a covering
    transformation, so it is also a translation of $X$. 

    \emph{Case 2: $e_+=e_-$.} Let $D(X)$ be the double of $X$ along its
    boundary, if $\partial X\neq \emptyset$, otherwise $D(X)=X$. By
    Corollary \ref{cor:double-is-wandering}, every curve in $D(X)$ is
    wandering with respect to the map induced by $f$ (which we will also
    denote by $f$, abusing notation). Let $e$ be the end of $D(X)$ which is
    the image of $e^\pm$ under the natural map $\Ends(X)\to\Ends(D(X))$.
    Note that all curves of $D(X)$ converge to $e$ under forward and
    backward iteration of $f$. If $D(X)\neq X$, we will do every operation
    and make every choice below respecting the symmetry given by the
    doubling.

    The goal is to construct an exhaustion of $D(X)$ by $f$-invariant
    subsurfaces, each of which falls in the previous case. To construct
    this exhaustion, fix a curve $\alpha_1$ and choose a sequence of curves
    \[\alpha_1,\alpha_2,\ldots, \alpha_k = f(\alpha_1)\] in $D(X)$ so
    that $i(\alpha_i,\alpha_{i+1}) > 0$. Note that the union of the orbits
    of the $\alpha_i$ is a locally finite collection (since they are
    wandering), so they span a subsurface, which we denote by $T_1$. By
    constuction, $T_1$ is $f$-invariant (up to isotopy) and $\langle
    f\rangle\simeq \Z$ acts properly discontinuously and cocompactly.
    Therefore $T_1$ has two ends $t_\pm$ --- in fact, it is quasi-isometric
    to $\Z$ --- and every curve in $T_1$ converges under forward
    (respectively, backward) iteration to $t_+$ (respectively, $t_-$).
    Modify $f$ by an isotopy so that $f(T_1) = T_1$.

    We now do the same for a larger collection of curves and we get a
    sequence of subsurfaces $T_1 \subset T_2 \subset \cdots$ exhausting
    $D(X)$, each of which is $2$-ended and $f$--invariant.
    
    \begin{figure}[ht]
    \begin{center}
    \begin{overpic}[width=.5\textwidth]{Tis}
    \put(102,33){\color{PrettyGreen}$T_1$}
    \put(-7,29){\color{FigLightBlue}$T_2$}
    \end{overpic}
    \caption{An example of the exhaustion $T_1\subset T_2\subset\dots$,
      where the map is the horizontal shift to the right, $T_1$ is the
      surface spanned by the orbit of the green curve and $T_2$ the surface
      spanned by the orbit of the green and the light blue
      curve}\label{fig:Tis}
    \end{center}
    \end{figure}
    
    As in case 1, we can find exponents $n_i$ so that $Q_i:=T_i/ \langle
    f^{n_i} \rangle$ is a surface and $f$ induces a finite-order map on
    each $Q_i$; we can assume that for every $i$, $n_i$ divides $n_{i+1}$.
    Note moreover that the $Q_i$ are of finite-type, since the $T_i$ are
    spanned by finitely many orbits of curves. By Proposition
    \ref{prop:Nielsenrealization}, we can find a hyperbolic structure $Y_1$
    on $Q_1$ which is $f$--invariant and thus can be lifted to an
    $f$--invariant hyperbolic structure $X_1$ on $T_1$. Lift $Y_1$ to a
    hyperbolic structure $Y_1'$ on $T_1/ \langle f^{n_2} \rangle \subset
    T_2/ \langle f^{n_2} \rangle =Q_2$. By
    \cite{nielsen_abbildungsklassen}, we can find a hyperbolic structure
    $Y_2$ on $Q_2$ which is $f$--invariant and extends $Y_1'$. Lift $Y_2$
    to a hyperbolic structure $X_2$ on $T_2$ which is $f$--invariant and
    note that $X_2$ extends $X_1$. Repeating this procedure we obtain a
    sequence of hyperbolic structures $X_i$ on $T_i$ such that $X_i$
    restricts to $X_{i-1}$ on $T_{i-1}$. So we get a hyperbolic structure
    on $D(X)$ with respect to which $f$ is a translation. By restricting
    the hyperbolic metric to $X$, we get the required structure. \qedhere
    
  \end{proof}
    
  \begin{remark}
    In the previous proof, in the case $e_+=e_-$, if we don't look at
    the double and we follow the same procedure, we are not sure that
    the surfaces $T_i$ exhaust $X$: their union will contain the
    interior of $X$, but not necessarily all of the boundary
    components. If this were the case, we would not get a hyperbolic
    structure on the whole of $X$ (some of its boundary components
    might be at infinity with respect to the metric on the interior of
    $X$).
  \end{remark}
    
  We end this section with an example of a surface and a map showing that
  the lack of wandering boundary lines is a necessary assumption in
  Proposition \ref{prop:wandering-arcs}, Corollary
  \ref{cor:double-is-wandering} and Theorem \ref{thm:translation}. 
    
  \begin{example}\label{ex:not-translation-double}
  Let \(R\) be the Roller compactification (see \cite{roller_poc}) of \(\R^2\) with its standard cube complex structure. Let \(X\) be the surface obtained by removing from \(R\) the closure of all points in \(\R^2\) with integer coordinates. The homeomorphism \(f\) of \(X\) is the continuous extension of the map \((x,y)\mapsto (x+1,y+1)\) of \(\Z^2\). Then every curve of \(X\) and every boundary line is wandering. On the other hand, there are lines from the boundary to the boundary which are not wandering, such as the closure of the line \(y=\frac{1}{2}\subset \R^2\ssm\Z^2\). In particular, the map induced by $f$ on $D(X)$ is not a
    translation.

%
%    For $n\in\Z\cup\{\pm\infty\}$, define:
%    $$p_n=\left\{
%    \begin{array}{ll}
%    0 & n=0\\
%    \pm 1 & n=\pm\infty\\
%    1-\frac{1}{n+1} & 0< n<\infty\\
%    -1+\frac{1}{1-n} & -\infty < n<0\\
%    \end{array}
%    \right.$$
%    Fix a homeomorphism $g:(-1,1)\to \R$ such that $g(p_n)=n$ for every
%    $n\in \Z$.
%
%    Let $X=[-1,1]\times[-1,1]\ssm \{(p_n,p_m)\st
%    n,m\in\Z\cup\{\pm\infty\}\}$. Then $X\ssm\partial X$ is homeomorphic to
%    $\R^2\ssm \Z^2$ via the map $\varphi$ induced by $g\times g$. We define
%    a homeomorphism of $X\ssm \partial X$ by pulling back the shift
%    $T:(x,y)\mapsto (x+1,y+1)$ of $\R^2\ssm \Z^2$ -- explicitly, we
%    consider the map $\varphi^{-1}\circ T\circ \varphi$. The unique
%    continuous extension of this map to $X$ is the homeomorphism $f$ with
%    the required properties. Indeed, any curve in $X$ is wandering
%    (converging in the forward/backward direction to the ends $(1,1)$ and
%    $(-1,1)$, but for every $h\in(-1,1)\ssm\{p_n\st n\in\Z\}$, the
%    horizontal arc of height $h$ is not wandering.

  \end{example}

  \begin{figure}[h]
  \includegraphics[scale=2]{not-translation-double}
  \caption{The surface $X$ from Example
    \ref{ex:not-translation-double}, with a non-wandering horizontal arc}
  \end{figure}

\section{Structure theorem of extra tame maps}

  \label{sec:structure}
  
  Our goal in this section is to prove the main theorem of the
  introduction. We first develop some properties of the canonical
  decomposition for an extra tame map $f$. Namely, we will establish how
  the components of $\Sper$, $\Sinf$, and $S_0$ can neighbor each other. We
  will also show that, for each component $X$ of the decomposition, $f$
  returns to $X$. We then combine the results of Section
  \ref{sec:translation} and the work of Afton--Calegari--Chen-Lyman
  \cite{accl_Nielsen} to prove the main theorem.

  \subsection{Properties of the canonical decomposition}

  For an extra tame map, recall the almost geodesic representatives of
  $\Sper$, $\Sinf$, and $S_0$ defined in Section \ref{sec:decomposition}.
  An essential component of $\Sper$ and $\Sinf$ either has infinite type or
  has negative Euler characteristic; in particular, such a component always
  has an essential curve. 
  
  Two components of the decomposition are \emph{adjacent} if they have
  boundary components which are properly isotopic (or equivalently, they
  have representatives sharing at least one boundary component).

  A component $X$ is \emph{self-adjacent} along $\alpha$ if $\alpha$ is
  properly homotopic to two distinct boundary components of $X$.
  Equivalently, $X$ is self-adjacent if there is a non-essential component
  $Y$ which shares two boundary components with $X$.
  
  One of the goals in this section is to show there are in fact no
  self-adjacent components (Lemma \ref{lem:no-self-adjacent}) and no strips
  (Corollary \ref{cor:no-strips}). We will also show that there is no
  wandering component of the decomposition and prove that the first return
  map to each component is either periodic or a translation, and can be
  realized as an isometry for some hyperbolic structure with totally
  geodesic boundary (Lemmas \ref{lem:per-on-S0}, \ref{lem:per-on-per} and
  \ref{lem:Sinf-not-wandering}). Finally we determine the topological types
  of the components of $S_0$ (Lemma \ref{lem:top-S0}).

  We start by showing that certain boundary components cannot be wandering.

  \begin{lemma} \label{lem:jointly-wandering1}
    
    If two components of $S_\infty$ share a common boundary component $\alpha$, then
    $\alpha$ is not wandering. Similarly, if a component of $\Sinf$ is
    self-adjacent along $\alpha$, then $\alpha$ is not wandering.
  
  \end{lemma}

  \begin{proof}

    First let $X$ and $Y$ be components of $S_\infty$ with a common
    boundary component $\alpha$. By contradiction, assume that $\alpha$ is wandering.
    Neither $X$ nor $Y$ is inessential, so we can find a curve
    $\beta\subset \int(X) \cup \int(Y) \cup \alpha$ that intersects
    $\alpha$ essentially. As $\beta$ is not contained in $\Sinf$, it is not
    wandering, so $\L(\beta)\neq \emptyset$. Let $\gamma$ be a curve
    intersecting $\L(\beta)$. By Lemma \ref{lem:duality}, $\L(\gamma)$
    intersects $\beta$; in particular, $\L(\gamma)$ is nonempty. Let $L \in
    \L(\gamma)$ be such that $L$ intersect $\beta$. By Lemma
    \ref{lem:SinftySubs}, $L$ cannot intersect $X$ and $Y$ essentially, but
    it intersects $\beta$, so $L = \alpha$. By $f$--invariance of limits,
    the orbits of $\alpha$ are contained in $\L(\gamma)$, which contradicts
    the finiteness of $\L(\gamma)$. The proof that $X$ is a component of
    $\Sinf$ with self-adjacency along $\alpha$ is similar. \qedhere
    
  \end{proof}

  \begin{lemma} \label{lem:jointly-wandering2}
     
    Let $X$ be a component of $\PS0$. If $X$ either
    \begin{itemize}
      \item shares at least one boundary component with $S_\infty$ but
        contains a non-contractible curve not homotopic to
        that boundary component;
        or \item shares at least two boundary components with $\Sinf$,
    \end{itemize}
    then $X$ is not wandering.

  \end{lemma}

  \begin{proof}
     
    In the first case, let $\alpha$ be a non-contractible curve in $X$ and
    let $Y$ be a component of $\Sinf$ sharing another boundary component
    $\alpha'$ with $X$, such that $\alpha$ is not homotopic to $\alpha'$.
    $Y$ is essential, so we can find an essential curve $\beta$ in $X \cup
    Y$ crossing $\alpha'$, by joining a curve in $Y$ along an arc to
    $\alpha$ and taking the boundary of their regular neighborhoods. In the
    second case, let $Y$ and $Z$ be components of $\Sinf$ (possibly $Y=Z$)
    sharing boundary components (called $\alpha'$ and $\alpha''$)
    respectively with $X$. We now find a curve $\beta$ in $Y \cup X \cup Z$
    intersecting $\alpha$ and $\alpha''$, by joining a curve in $Y$ and a
    curve in $Z$ by an arc that crosses $\alpha'$ and $\alpha''$. We will
    show that if $X$ is wandering, then $\beta$ is wandering, which is a
    contradiction.
 
    Indeed, suppose $\beta$ is not wandering. Then $\L(\beta)\neq
    \emptyset$ but $\L(\beta)$ cannot intersect $f^n(Y)$ or $f^n(Z)$
    essentially. On the other hand, $f^n(\beta)$ is contained in $f^n(X)
    \cup f^n(Y) \cup f^n(Z)$, so some component $L$ of $\L(\beta)$ must be
    homotopic into $f^n(X)$ for some $n$. Since $\L(\beta)$ is
    $f$--invariant and $X$ is wandering, there must be infinitely many
    iterates of $L$ in $\L(\beta)$, but this contradicts the finiteness of
    $\L(\beta)$. \qedhere

  \end{proof}

  We then show that all boundary components of $\Sinf$ are lines.

  \begin{lemma} \label{lem:no-compact}
    
    No component $X$ of $\Sinf$ has a compact boundary component. 
    
  \end{lemma}

  \begin{proof}

    We argue by contradiction. First suppose $X$ is non-annular and
    $\alpha$ is a compact boundary component of $X$, since $X$ is spanned by curves,
    $\alpha$ is a wandering curve. So the neighboring component $Y$ of $X$
    joined along $\alpha$ cannot belong to $\Sper$ (since boundary curves
    of $\Sper$ are periodic) or $S_\infty$ (by Lemma
    \ref{lem:jointly-wandering1}). 
    
    So suppose $Y$ is in $S_0$. If there is no $n>0$ such that $f^n(Y)$ is
    isotopic to $Y$, then $Y$ is wandering (as $S_0$ is a subsurface). By
    Lemma \ref{lem:jointly-wandering2}, $Y$ cannot have a non-contractible
    curve different from $\alpha$. But $Y$ cannot be a disk or a
    punctured-disk, so it must have at least two boundary components, both
    of which are wandering. Hence the two boundary components belong to
    $\Sinf$, but this contradicts Lemma \ref{lem:jointly-wandering1}.
    
    So for some $n>0$, $f^n(Y)$ is isotopic to $Y$. As $\alpha$ is
    wandering, $Y$ contains infinitely many iterates of $\alpha$, and
    therefore an essential non-peripheral curve, contradicting Proposition
    \ref{prop:no-ess-nonper}. 
    
    If $X$ is annular, then it has a neighbor $Y$ which cannot belong in
    $\Sper$ since $X$ is wandering, and $Y$ cannot belong in $S_0$ since
    it would have to have essential non-peripheral curves. So $Y$ belongs
    to $\Sinf$, but this contradicts the previous case. \qedhere
    
  \end{proof}
  
  Using the previous results, we can deduce that no component of $\PS0$ is
  wandering, and even more, that for each of them the first return map has
  finite order.

  \begin{lemma}\label{lem:per-on-S0} 
    
    For every component $X$ of $\PS0$, $f$ returns to $X$ and there is a
    hyperbolic structure, with compact boundary components of length one,
    such that the first return $f^k$ is isotopic to a periodic isometry of
    $X$. 
  
  \end{lemma}

  \begin{proof}
  
    Recall that $X$ has no essential, non-peripheral curves, and by our
    construction of $\PSper$ and $\Sinf$, $X$ cannot be a closed disk or a
    closed disk with one puncture. If $f$ doesn't return to $X$, then since
    $\PS0$ is a subsurface and $f$--invariant, $X$ is wandering. In
    particular, $X$ cannot border $\PSper$, so it cannot have a compact
    boundary by Lemma \ref{lem:no-compact}. In this case, $X$ is a disk
    with at most one puncture and points removed from the boundary, from
    which we can get a contradiction by Lemma \ref{lem:jointly-wandering2}. 

    So $f$ returns to $X$. Up to replacing $f$ with a power, we can assume
    $f(X)=X$. If $X$ has finitely many boundary components, then $f$ has
    finite order. Otherwise, $X$ is a disk with infinitely many points
    removed from the boundary and possibly a puncture or a disk removed
    from its interior. Look at the action of $f$ on the non-compact
    boundary components. If the $f$--orbit of every component is infinite,
    then $f$ is semi-conjugate to an irrational rotation of the disk, which
    violates extra tameness. If there exists a finite orbit, then all periodic
    components of $\partial X$ have the same period. Let $Y \subset X$ be
    the smallest convex subsurface containing the puncture or the compact
    boundary component of $X$, if it exists, all the periodic boundary
    components of $X$ and all the periodic ends of $X$. Up to replacing $f$
    by a further power if necessary, we can assume $f$ fixes $Y$. We claim
    $X \ssm Y$ belongs to $S_\infty$. Let $Z$ be a component of $X \ssm Y$.
    Topologically, this is disk with points removed from the boundary which
    shares a unique common boundary $L$ with $Y$, which is fixed by $f$,
    and all other boundary components are wandering. Further, there exist
    ends $e_\pm$ (possibly $e_+=e_-$) of $L$, such that for any other $L'
    \subset \partial Z$, $f^i(L')$ converges to $e)\pm$ as $i \to
    \pm\infty$. Fix a wandering boundary component $L'$, and let $L_0$ be
    the line in $Z$ spanned by $e$ and the end of $L'$ such that $f^i(L')$,
    $i \ge 0$, lies on one side of $Z \ssm L_0$. Let $Z_0$ be the
    subsurface corresponding to that side, and let $Z_i = f^i(Z_0)$. Then
    $Z_i$ converges to $e_\pm$ as $i\to\pm\infty$. Each wandering component
    of $\partial Z$ must be a boundary component of $S_\infty$. Thus we can
    find some curve $\alpha$ that intersects $L'$ and $X$ essentially, and
    $\alpha \subset Z_0 \cup S_\infty$. Such curve must have $\L(\alpha)
    \ne \emptyset$, since $\alpha$ does not belong to $S_\infty$, but this
    is impossible since $f^i(\alpha) \subset Z_i$. This shows $X\ssm Y$
    cannot have any wandering boundary components, so $X=Y$.
    
    Let $k$ be the first returning time to $X$. Then we can get a
    hyperbolic metric on $X$ with respect to which $f^k$ is isotopic to a
    finite order isometry by looking at the quotient $X/\langle f^{k}
    \rangle$, choosing a hyperbolic structure with corners on the quotient
    and lifting it to $X$.  \qedhere

  \end{proof}

  We can now establish the properties of the first return map for
  components of $\Sper$.

  \begin{lemma}\label{lem:per-on-per}
          
    Let $X$ be a component of $\Sper$. Then $f$ returns to $X$ and there is
    a hyperbolic metric on $X$ with compact boundary components of length
    one such that the first return $f^k$ is isotopic to a periodic isometry
    of $X$. 
          
  \end{lemma}

  \begin{proof}
          
    Since $X$ is connected and every curve in $X$ is $f$--periodic, $f$
    must return to $X$. Up to replacing $f$ by a power we may assume $f(X)$
    is isotopic to $X$. If $X$ has bounded topology, i.e.\ $X$ is
    finite-type or the double of $X$ has finite type, then $f$ is isotopic
    to a periodic map of $X$. Otherwise, choose a finite collection $\C$ of
    orbits of curves in $X$ and let $F=F(\C)$ be the subsurface spanned by
    $\C$. After possibly enlarging $\C$, we can assume $F$ is connected and
    has negative Euler characteristic. Since $\C$ is $f$--invariant so is
    $F$, and since all the curves in $\C$ are $f$--periodic, $f|_F$ is
    isotopic to a periodic map of $F$ by Lemma
    \ref{lem:periodic-finite-type}. Let $n > 0$ be the period of $f|_F$.
    For any curve $\alpha$ not in $F$, we can find a larger connected
    $f$--invariant finite-type subsurface $F'$ containing both $F$ and
    $\alpha$. By the same reasoning, $f$ is also isotopic to a periodic map
    on $F'$, but since $F' \supset F$, $f|_{F'}$ also has period $n$ (by
    the classical Nielsen--Thurston theory). In particular, $f^n(\alpha)$
    is isotopic to $\alpha$ for all $\alpha$.  By the Alexander method
    (\cite{hmv_Alexander}), this implies that $f|_X$ is isotopic to a
    periodic map of $X$. 
  
    The fact that we can realize the first return $f^k$ to $X$ by a
    periodic isometry is a direct consequence of Proposition
    \ref{prop:Nielsenrealization} (see \cite{accl_Nielsen}). \qedhere
          
  \end{proof}

  As a consequence, we can describe more precisely what changes when
  modifying the decomposition from $\Sinf$, $\PSper$ and $\PS0$ to $\Sinf$,
  $\Sper$ and $S_0$.

  \begin{cor}\label{cor:changing-the-decomposition}
    Each pair of pants component of $\PS0$ yields a pair of pants component
    of $\Sper$, which contains at least one annular component of $\PSper$.
    Furthermore, no component of $\PS0$ is self-adjacent.
  \end{cor}

  \begin{proof}
  
    Since a pair of pants component $X$ of $\PS0$ has only compact boundary
    components, it must border at least one component  $Y$ of $\PSper$. If
    $Y$ is not an annulus, we can construct a curve $\alpha\subset X\cup Y$
    intersecting the boundary of $X$ essentially. As some power of $f$ is
    periodic on both $X$ and $Y$, and by tameness there is no twisting
    allowed along the boundary, $\alpha$ is periodic, a contradiction.
          
    If a component $X$ of $\PS0$ were self-adjacent along a boundary
    component $\alpha$, then $\alpha$ must be a curve --- otherwise there
    is a component $Y$ which is a strip with both boundary components in
    $X$. As $Y$ contains no curves, it is contained in $\PS0$, but then by
    construction $X$ and $Y$ would be part of the same component of $\PS0$.
    But we know by Lemma \ref{lem:per-on-S0} that $\alpha$ is periodic, so
    the annulus $Z$ about $\alpha$ is a component of $\PSper$. Since $X$
    has at least two compact boundary components, it is a pair of pants,
    but then as before we could construct a $\beta$ contained in the
    genus-one surface $X\cup Z$ which intersects $\alpha$ essentially and
    is periodic, a contradiction. \qedhere

  \end{proof}

  Our next step is to exclude (self-)adjacency of components of $\Sper$.

  \begin{lemma} \label{lem:Sper-neighbor}
          
    No two components of $\Sper$ can be adjacent, neither can a component
    of $\Sper$ be self-adjacent. 
          
  \end{lemma}

  \begin{proof}
          
    First suppose $X$ and $Y$ are essential components of $\Sper$ and let
    $\alpha$ be a common boundary component. Choose a regular neighborhood
    $N(\alpha)$ about $\alpha$ contained in $X \cup Y$. There exists $n$
    such that $f^n$ is isotopic to the identity on $X$ and $Y$. Isotope
    $f^n$ so that it takes $N(\alpha)$ to $N(\alpha)$ fixing $\partial
    N(\alpha)$ pointwise, and further isotope $f^n$ so that it's the
    identity on truncated subsurfaces $X \setminus N(\alpha)$ and $Y
    \setminus N(\alpha)$. If $N(\alpha)$ is a strip, then we can further
    isotope $f^n$ (rel boundary) inside of $N(\alpha)$ to the identity map.
    If $\alpha$ is a curve, then since $f$ is (extra) tame, it cannot twist
    about $\alpha$, so $f^n$ is also isotopic (rel boundary) to the
    identity map on $N(\alpha)$. But this implies $f^n$ is isotopic to the
    identity on $X \cup Y$, and in particular, we can find an essential
    curve $\beta$ in $X \cup Y$ crossing $\alpha$ which is $f$--periodic. 
    
    The proof that a component $X$ has self-adjacency along a periodic
    annular component $N(\alpha)$ is similar. In this case, we can isotope
    $f^n$ to be identity on $X \cup N(\alpha)$, which contradicts that $X$
    and $N(\alpha)$ are components of $\Sper$. \qedhere 
          
  \end{proof}

  With all these results at hand, we can prove the wanted properties of the
  first return map of components of $\Sinf$.
    
  \begin{lemma}\label{lem:Sinf-not-wandering}

    No component $X$ of $\Sinf$ has a wandering boundary component. In
    particular, $f$ returns to $X$, and there is a hyperbolic metric on
    $X$, such that, the first return $f^n$ is isotopic to an isometric
    translation on $X$.

  \end{lemma}
  
  \begin{proof} 
    
    Let $\alpha$ be a wandering boundary component of $X$. Since $f$
    returns to each component of $\Sper$ and $S_0$ and the first return
    maps are periodic, the neighbor $Y$ of $X$ along $\alpha$ must belong
    to $\Sinf$, but this contradicts Lemma \ref{lem:jointly-wandering1}.
    Therefore $X$ has no wandering boundary component, so $f$ must return
    to $X$. By Theorem \ref{thm:translation}, the first return $f^n$
    up to isotopy preserves a hyperbolic metric on $X$ on which it acts as
    an isometric translation. \qedhere

  \end{proof}

  Our next goal is to show that there is no self-adjacent component of the
  decomposition. We need a preliminary result.
    
  \begin{lemma} \label{lem:S0-neighbor}
    
    A component $X$ of $S_0$ can share at most one boundary with $\Sper$,
    and if $X$ shares a boundary $\alpha$ with $\Sper$, then every
    non-contractible curve in $X$ is homotopic to $\alpha$. 

  \end{lemma}

  \begin{proof}

    We now know $X$ is $f$--periodic, so the proof is similar to Lemma
    \ref{lem:Sper-neighbor}. The assumptions on $X$ are to rule out the
    existence of a periodic curve $\beta$ crossing the common boundary of
    $X$ with $\Sper$ essentially. \qedhere  

  \end{proof}

  We can now show the no self-adjacency result.

  \begin{lemma}\label{lem:no-self-adjacent}

    No component of the canonical decomposition is self-adjacent.

  \end{lemma}

  \begin{proof}
    Suppose $X$ is a self-adjacent component. By Corollary
    \ref{cor:changing-the-decomposition} and Lemma \ref{lem:Sper-neighbor},
    $X$ is a component of $\Sinf$. Since $\Sinf$ has no compact boundary
    components by Lemma \ref{lem:no-compact}, there is a strip component
    $Y$ of $S_0$, with core line $\ell$, so that $X$ is the only neighbor
    of $Y$. Let $\ell_1$ and $\ell_2$ be the boundary components of $Y$. By
    Lemma \ref{lem:Sinf-not-wandering}, there is some $n\geq 1$ so that
    $f^n$ fixes $\ell_1$ (and therefore $\ell_2$, since they are
    homotopic). Since $Y$ is a strip, an orientation on $\ell$ will induce
    orientations on $\ell_1$ and $\ell_2$. Now pick a curve $\alpha$
    contained in $X\cup Y$ and intersecting both $\ell_1$ and $\ell_2$
    once. Then $\alpha\cap X$ is an arc from $\partial X$ to $\partial X$,
    and by Proposition \ref{prop:wandering-arcs} it is wandering. This
    implies that $f^n$ acts as a positive translation on $\ell_1$ (with
    respect to the chosen orientation) if and only if it acts as a positive
    translation on $\ell_2$. But then we can homotope $f^n$ on the strip,
    leaving it invariant on its boundary, so that it's a translation, and
    therefore $\alpha$ is wandering, a contradiction. \qedhere 
  
  \end{proof}

  An easy consequence of the previous lemma is the fact that there are no
  components of the decomposition which are strips:

  \begin{cor}\label{cor:no-strips}
    No component of $S_0$, $\Sper$ or $\Sinf$ is a strip.
  \end{cor}

  \begin{proof}
    Since by construction every component of $\Sper$ and $\Sinf$ contains
    an essential (possibly peripheral) curve, if there is a strip, it must
    be a component of $S_0$. But by construction, a strip can arise only if
    a component of $\Sper$ or $\Sinf$ is self-adjacent, which is impossible
    by Lemma \ref{lem:no-self-adjacent}.\qedhere
  \end{proof}

  The next result is a description of the possible components of $S_0$.

  \begin{lemma}\label{lem:top-S0}

    The following are the topological possibilities for
    a component $X$ of $S_0$:

    \begin{enumerate}
      \item A closed disk with at least three points removed from the
        boundary. In this case, at most one
        neighbor of $X$ is in $\Sper$.
      \item A once-punctured closed disk with at least one point removed
        from the boundary. In this case, all neighbors of $X$ are in $\Sinf$.
      \item A cylinder with one compact boundary component and at least one point
        removed from the other boundary (a crown) In this case, $X$ has
        exactly one neighbor in $\Sper$ along its compact boundary component. 
    \end{enumerate}

  \end{lemma}

  \begin{figure}[ht]
  \begin{center}
  \includegraphics{S0}
  \caption{The topological possibilities for the components of $S_0$.}
  \end{center}
  \end{figure}  
  
  \begin{proof}
  
    Note first that $X$ is not a sphere, being a subsurface of $S$. It also
    cannot be a disk or a once-punctured disk, by the construction of
    $\Sinf$ and $\Sper$. Moreover by construction $X$ has non-negative
    Euler characteristic, thus $\chi(X)$ is either $1$ or $0$.
    
    If $\chi(X)=1$, then $X$ is a disk with a closed totally
    disconnected set with $n\in [0,\infty]$ points removed from its
    boundary. If $n=0$ or 1, $X$ would be a disk or a half-plane,
    which is impossible.
    Moreover, $n\neq 2$ by Corollary
    \ref{cor:no-strips}, so $n\geq 3$. Since the boundary components of $X$
    are non-compact, $X$ cannot border annular components of $\Sper$, so it
    has at most one neighbor in $\Sper$.

    If $\chi(X)=0$, then the interior of $X$ is an open annulus. We already
    know that $X$ cannot be the once-punctured disk, and it cannot be a
    closed annulus. Thus, $X$ is either a once-punctured disk or a closed
    annulus with at least one point removed from its boundary. If it is an
    annulus with points removed from both boundaries, then it would contain
    an essential non-peripheral curve, contradicting Proposition
    \ref{prop:no-ess-nonper}. If $X$ is a once-punctured disk with points
    removed from its boundary, then $X$ has a non-contractible curve which
    is non-peripheral, so it cannot border $\Sper$. If $X$ is an annulus
    with points removed from one of its boundary, then the core curve of
    $X$ is not homotopic to the non-compact boundaries of $X$, so $X$ has
    at most one neighbor in $\Sper$ joined along its only compact
    boundary component.
    \qedhere 

  \end{proof}

  \begin{figure}[ht]
    \begin{center}
      \begin{overpic}{componentsofS0}
        \put(-2,67){$f_1:$}
        \put(5,49){$\PS0\simeq$}
        \put(35,67){$f_2:$}
        \put(40,49){$\PS0\simeq$}
        \put(69,67){$f_3:$}
        \put(74,49){$\PS0\simeq$}
        \put(-7,28){$f_4:$} 
        \put(-6,5){$\PS0\simeq$}
        \put(37,28){$f_5:$}
        \put(38,5){$\PS0\simeq$}
        \put(67,28){$f_6:$}
        \put(70,5){$\PS0\simeq$}
      \end{overpic}
      \caption{Examples of extra tame mapping
      classes}\label{fig:componentsofS0}
    \end{center}
  \end{figure}
  
  We end this section with some examples showing the optimality of some of
  our results. First, we note that all topological possibilities from Lemma
  \ref{lem:top-S0} occur for components of $S_0$, and that there can be
  pairs of pants components of $\PS0$. Indeed, Figure
  \ref{fig:componentsofS0} exhibits examples of tame mapping classes with
  different topological types for the components of $\PS0$ and $S_0$. In
  each case, the map is a puncture shift in each shaded strip, in the
  direction indicated by the arrow, and it's the identity outside the
  strips.
  
  Finally, since an extra tame map returns to each component of $S_0$,
  $\Sper$ and $\Sinf$, one might wonder if there is a uniform returning
  time for all components. The answer is negative, as shown by the
  following lemma. Moreover, given a component of $\Sinf$, there is not
  always a uniform power of $f$ fixing all of its boundary components at
  once.
  
  \begin{lemma}\label{lem:no-uniform-return}
    There is an extra tame map such that there is no uniform returning time
    for all components of the canonical decomposition. Furthermore, the map
    can be chosen so that there is a component of $\Sinf$ with no uniform
    returning time for its boundary components.
  \end{lemma}
  
  \begin{proof}

    Consider the bordered surface $$P= \left(\R_{\geq 0}\times
    \R\right)\ssm\bigcup_{n\geq 1}B_n,$$ where $B_n$ is the open disk of
    center $(n,0)$ and radius $\frac{1}{4}$. Let $a_n$ be the oriented
    segment of the $x$-axis from $B_n$ to $B_{n+1}$ and $a_0$ the oriented
    segment of the $x$-axis from the $y$-axis to $B_1$.  Define the map
    $\psi:\pi_1(P)\to \Z$ by $$\psi(\alpha)=\sum_{n\geq
    0}2^n\hat{\iota}(\alpha,a_n),$$ where $\hat{\iota}(\cdot,\cdot)$ is
    the algebraic intersection form.
  	
    \begin{figure}[hb]
      \begin{center}
        \begin{overpic}[scale=1.4]{cover}
          \put(2,32){$a_0$}
          \put(21,32){$a_1$}
          \put(40,32){$a_2$}
          \put(59,32){$a_3$}
          \put(78,32){$a_4$}
          \put(11,26){$B_1$}
          \put(30,26){$B_2$}
          \put(49,26){$B_3$}
          \put(68,26){$B_4$}
          \put(87,26){$B_1$}
        \end{overpic}
        \caption{The surface $P$ with the arcs $a_n$ in the proof of Lemma
        \ref{lem:no-uniform-return}.}
      \end{center}
    \end{figure}
    
    Let $p:\Sigma\to P$ be the associated cover of the kernel of $\psi$,
    and $f$ a generator of the deck group. Then $\Sigma$ is a bordered
    subsurface, whose boundary is a union of lines, given by lifts of the
    $y$-axis and of the curves $\partial B_n$. Note that, for any $n$, the
    number of lifts of $\partial B_n$ is $2^n-2^{n-1}$ and they are
    cyclically permuted by $f$. So there is no uniform power of $f$ fixing
    all boundary components of $\Sigma$.
    
    To turn this into an example of an extra tame map on a (borderless)
    surface, we simply glue to each boundary component of $\Sigma$ a copy
    of the thrice-punctured half-plane $H$. We get a surface $S$ and a
    homeomorphism $\bar{f}$ of $S$ so that $\bar{f}|_\Sigma$ is $f$ and for
    every copy of $H$, the first return map is the identity.
    
    The map $\bar{f}$ is extra tame and:
    \begin{itemize}
      \item $\Sinf=\Sigma$ and $\bar{f}|_{\Sinf}=f$, so there is no
        bound on the first returning time of the boundary components of
        $\Sinf$;

      \item $\Sper$ is the union, for every copy of $H$, of a disk with
        three punctures. The first returning time of a component of $X$
        is the same as the first returning time of the boundary
        component of the copy of $H$ in which $X$ is contained, so also
        these are unbounded;

      \item $S_0$ is the union, for every copy of $H$, of an annulus
        with a point removed from the boundary, and again there is no
        uniform bound on the first returning times of components of
        $S_0$. \qedhere
    \end{itemize} 
  	
  \end{proof}

  \subsection{Proof of main theorem}
  
  Our main theorem is now an easy consequence of the results proved so far.

  \begin{thm}\label{thm:mainthm} 
    Let $f$ be an extra tame map of a surface $S$ of infinite type. There
    is a canonical decomposition of $S$ into three $f$--invariant
    subsurfaces $\Sper$, $\Sinf$ and $S_0$ and a hyperbolic metric on $S$
    such that for every component $X$ of $\Sper$, $\Sinf$ and $S_0$, $f$
    returns to $X$ and is isotopic to:
    \begin{itemize}
      \item a periodic isometry, if $X\subset \Sper\cup S_0$, 
      \item an isometric translation, if $X\subset \Sinf$.
    \end{itemize} 
    Furthermore, components of $S_0$ contain no essential non-peripheral
    curves and at most one essential (peripheral) curve.
  \end{thm}

  \begin{proof}
  
    Let $S_0$, $\Sper$ and $\Sinf$ be given by Proposition
    \ref{prop:decomposition}. The hyperbolic structure on $S$ is given by
    gluing the hyperbolic structures provided by Lemmas
    \ref{lem:per-on-per} and \ref{lem:per-on-S0} and Theorem
    \ref{thm:translation}: since there are no strips (Corollary
    \ref{cor:no-strips}), the hyperbolic structure contains no funnels or
    half-planes. Moreover the same results guarantee that for every
    component of the decomposition the first return map of $f$ exists and
    is isotopic to a periodic isometry or an isometric translation as
    required. \qedhere

  \end{proof}

  \subsection{Constructing extra tame maps}

  Theorem \ref{thm:mainthm} shows that every extra tame map is obtained by
  gluing together translations and periodic maps supported on disjoint
  subsurfaces, not accumulating anywhere. If we want to construct extra
  tame maps by following this procedure, we need to be careful when two
  supporting subsurfaces share a compact boundary component: we have to
  make sure that the gluing doesn't create a Dehn twist.

  On the other hand, there is no need for special care when gluing along
  lines. More precisely: 

  \begin{lemma}
    Let $\{\Sigma_i\}_{i\in I}$ be a decomposition of a surface $S$ into
    essential subsurfaces without self-adjacency, not accumulating anywhere
    and without compact boundary components. For every $i$, let $f_i$ be
    either a periodic map or a translation of $\Sigma_i$, and assume that
    for every line $\ell\subset\partial\Sigma_i\cap\partial\Sigma_j$,
    $f_i(\ell)=f_j(\ell)$. Then there is an extra tame mapping class $f$ on
    $S$ such that the restriction of $f$ on each $\Sigma_i$ is properly
    homotopic to $f_i$.
  \end{lemma}

  \begin{proof}
    Define $S'$ to be the surface, homeomorphic to $S$, given by inserting
    strips at each line in the boundary of the decomposition. More
    precisely, we take the disjoint union of the $\Sigma_i$ and of a strip
    $S_\ell=\ell\times[0,1]$ for every $\ell$ in the boundary, and if
    $\ell\subset\partial\Sigma_i\cap\partial\Sigma_j$, we glue
    $\ell\times\{0\}$ with the copy of $\ell$ in $\Sigma_i$ and
    $\ell\times\{1\}$ with the copy of $\ell$ in $\Sigma_j$. Define then
    $f_\ell$ on $S_\ell$ by linearly interpolating $f_i$ and $f_j$:
    $$f_\ell(p,t)=(1-t)f_i(p)+t f_j(p)$$ where we have fixed an
    identification of $\ell$ with $\R$. Then we obtain a homeomorphism $f$
    of $S'$ by gluing the $f_i$ and the $f_\ell$. We claim that $f$ is
    extra tame.

    Indeed, let $\alpha$ and $\beta$ be two curves in $S'$. By the
    properties of the decomposition, and up to modifying the curves by a
    homotopy, we know that there are finitely many indices $j\in I$ and
    lines $\ell$ in the boundary of the decomposition so that
    $\alpha\cap\Sigma_j$, $\beta\cap\Sigma_j$, $\alpha\cap S_\ell$ or
    $\beta\cap S_\ell$ are not empty. By tameness of the $f_j$,
    $$i(f_j^n(\alpha\cap\Sigma_j),\beta\cap\Sigma_j)$$ is uniformly bounded
    and $$i(f_\ell(\alpha\cap S_\ell), \beta\cap S_\ell)$$ is bounded by
    the number of intersection of $\alpha$ and $\beta$ with the boundary of
    the decomposition, so it is also uniformly bounded. Therefore
    $i(f^n(\alpha),\beta)$ is uniformly bounded and hence $f$ is tame. A
    similar argument shows the finiteness of the limit set of $\alpha$.
    \qedhere

  \end{proof}

  Finally, note that if we glue periodic maps and translation and we obtain
  an extra tame map, the canonical decomposition might not coincide with
  the collection of supporting subsurfaces of the maps we are gluing. For
  instance, let $S=\R^2\ssm \Z^2$, and \[ \Sigma_1=S\cap \left\{
    y\geq\frac{3}{4} \right\} \text{ and } \Sigma_2=S\cap \left\{
    y\leq\frac{1}{4} \right\}.\] Let $f_1$ be the map $(x,y)\mapsto
  (x+1,y)$ restricted to $\Sigma_1$, and $f_2$ be the map $(x,y)\to
  (x+2,y)$ restricted to $\Sigma_2$ homotopic. We interpolate the maps
  $f_1$ and $f_2$ in the intermediate strip $\{ 1/4 \le y \le 3/4\}$. Then
  the induced map on $S$ is a translation; in particular, $S=\Sinf$.

%section{References}

  \bibliographystyle{plain}
  \bibliography{bibliography}

\end{document} 

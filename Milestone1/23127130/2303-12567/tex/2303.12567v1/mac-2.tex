\catcode`@=11
\newskip\bibskip \bibskip=5pt plus 2pt minus 1pt
\newdimen\bibindent \global\bibindent=19pt
%\def\aut#1{\textsc{#1}}
\def\aut#1{\textsc{#1},}
\def\btitle#1{\textit{#1\/},}
\def\jtitle#1{{``#1,''}}
\def\anno#1{\textsc{#1},}
\def\book#1{\textrm{#1}}
\def\journal#1 #2 #3{\textit{#1\/}~{#2},~{#3}}
\def\journalnt#1 #2 #3{\textit{#1\/} {#2}, {#3}}
\bibindent=20pt
\newif\ifinibib\inibibtrue
\gdef\bibshape{\par\noindent\hangindent\bibindent\hangafter1\noindent\ignorespaces%\vskip\bibskip
%\llap{[\bibmark]\enspace}
\ignorespaces}


\gdef\bclust#1#2{\expandafter\gdef\csname\noexpand#1\endcsname{#2}\ignorespaces}

\newif\ifbibexpand\bibexpandfalse

\gdef\ifundefined#1{\expandafter\ifx\csname#1\endcsname\relax}

\def\brefitem[#1]#2#3\par{\ifbibexpand\relax\else\bclust{#2}{#1}\ignorespaces\relax\fi\ignorespaces
\ifundefined{#2@*@}\relax\else\ifbibexpand\ignorespaces\hypertarget{#2}{\ignorespaces\bibshape{\ignorespaces#3}\vskip\bibskip}\fi\relax\fi}

\gdef\citeshape#1{#1}


\gdef\citel#1{\ifundefined{#1}\citeshape{#1??}\ignorespaces
\message{Don't know cit. [#1]!}\ignorespaces\else
\hyperlink{#1}{\citeshape{\csname#1\endcsname}}\ignorespaces\bclust{#1@*@}{@@@}\ignorespaces
\relax\fi}


\gdef\nocite#1#2{\ifundefined{#1}\relax\ignorespaces
\message{Don't know cit. [#1]!}\ignorespaces\else\relax\ignorespaces
\hyperlink{#1}{#2}\relax\ignorespaces\bclust{#1@*@}{@@@}\ignorespaces
\relax\fi}

\gdef\nonocite#1{\ifundefined{#1}\relax\ignorespaces
\message{Don't know cit. [#1]!}\ignorespaces\else\relax\ignorespaces
\relax\ignorespaces\bclust{#1@*@}{@@@}\ignorespaces\relax\fi}

\let\WriteRefTot\relax

\catcode`@=12

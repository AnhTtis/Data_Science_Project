\section{Approximate Leximin Optimality}\label{sec:approx-leximin-def}
In this section, we present our definition of leximin approximation in the presence of multiplicative and additive errors, in the context of multi-objective optimization problems.
% Section \ref{} discusses other potential definitions that might be considered intuitive and the reasons we made a different choice.


% \yonatan{I think the following discussion is too detailed for the introduction - where the actual definition is not provided.}
\subsection{Motivation: Unsatisfactory  Definitions}

Which solutions should be considered approximately-optimal in terms of  leximin? 
Several definitions appear intuitive at first glance.
As an example, suppose we are interested in approximations with an allowable multiplicative error of $0.1$.
Denote the utilities in the leximin-optimal solution by $(u_1,\ldots,u_n)$.
A first potential definition is that any solution in which the sorted utility vector is at least $(0.9\cdot u_1,\ldots,0.9\cdot u_n)$ should be considered approximately-optimal.
For example, if the utilities in the optimal solution are $(1,2,3)$, then a solution with utilities $(0.9, 1.8, 2.7)$ is approximately-optimal.
However, allowing the smallest utility to take the value $0.9$ may substantially increase the maximum possible value of the second (and third) smallest utility --- e.g.~a solution that yields utilities $(0.9, 1000,1000)$ might exist. In that case, a solution with utilities  $(0.9, 1.8, 2.7)$ is very far from optimal.
We expect a good approximation notion to consider the fact that an error in one utility might change the optimal value of the others.

The following, second attempt at a definition, captures this requirement.
An approximately-optimal solution is one that yields utilities at least $(0.9\cdot m_1, 0.9 \cdot m_2, \dots, 0.9 \cdot m_n)$, where $m_1$ is the maximum value of the smallest utility, $m_2$ is the maximum value of the second-smallest utility \emph{among all solutions whose smallest utility is at least $0.9 \cdot m_1$};
$m_3$ is the maximum value of the third-smallest utility among all solutions whose smallest utility is at least $0.9 \cdot m_1$ and their second-smallest utility is at least $0.9\cdot m_2$; and so on. 
In the above example, to be considered approximately-optimal, the smallest utility should be at least $0.9$ and the second-smallest should be at least $900$.
Thus, a solution with utilities $(0.9, 1.8, 2.7)$ is not considered approximately-optimal. Unfortunately, according to this definition, even the leximin-optimal solution --- with utilities $(1,2,3)$  --- is not considered approximately-optimal.
We expect a good approximation notion to be a relaxation of leximin-optimality.
% \eden{is this paragraph relevant here? if so, to write about algorithms as well?\\
% \textit{Is there an algorithm that can be used when the single-objective solver can only approximate the optimal value?}}
% \erel{I like the examples. I am not sure where is the best place to mention the algorithms.}



\subsection{Our Definition}

\paragraph{The approximate leximin order} 
The first step in the defining  the following  strict \textit{partial} order on solutions.
%(a partial order allows two solutions with different utilities such that no one is preferred over the other).
Here, a maximal element is one over which no other solution is preferred; note that it is not equivalent to one that is preferred over all others (as in total order).

We focus on maximization problems. Given $\DEFmultApprox\in (0,1]$ and $\DEFadditiveApprox \geq 0$, 
%a value $v_1 \in \mathbb{R}$ is considered a $(\DEFmultApprox,\DEFadditiveApprox)$-approximation of a value $v_2 \in \mathbb{R}$ if $v_1 \geq \DEFmultApprox\cdot v_2 - \DEFadditiveApprox$.
value %Therefore, we say that 
$v_2$ is \emph{$(\DEFmultApprox,\DEFadditiveApprox)$-preferred} over $v_1$ if $v_2 > \frac{1}{\DEFmultApprox}(v_1 + \DEFadditiveApprox)$.

The approximate leximin order can now be described.%
\footnote{A proof that the approximate leximin order is a strict partial order can be found in appendix \ref{sec:approx-order-is-strict-partial}}
% It is determined according to the following preferences relation: we say that
A solution $y$ is \emph{$(\DEFmultApprox,\DEFadditiveApprox)$-leximin-preferred} over a solution $x$ if there exists an integer $k \in [n]$ such that the smallest $(k-1)$ objective values of $y$ are \emph{at least} those of $x$, and the $k$'th smallest objective value of $y$ is $(\DEFmultApprox,\DEFadditiveApprox)$-preferred over the $k$'th smallest objective value of $x$, that is:
\begin{align*}
    \forall j < k \colon \quad &\valBy{j}{y} \geq \valBy{j}{x}\\
    &\valBy{k}{y} > \frac{1}{\DEFmultApprox} \left( \valBy{k}{x} + \DEFadditiveApprox\right)
\end{align*}
This relation is denoted by $y \alphaBetaPreferred x$.
The corresponding relation set is defined as follows:
\begin{align*}
    \relationSetAlphaBeta = \{(y,x) \mid \forall x,y \in S \colon y \alphaBetaPreferred x\}
\end{align*}

Before describing the approximation definition, we present some observations of this new relation that will be useful later.
The proofs are straightforward and are omitted. 

\iffalse
Consider the case were $\DEFmultApprox = 1$ and $\DEFadditiveApprox=0$. 
The relations $\leximinPreferred$ and $\alphaBetaPreferredParams{1}{0}$ may look similar at first glance (as the requirement for $k$ is the same), but they are different.
In the first relation, the requirement for $j<k$ says that the values of $y$ are \emph{equal} to those of $x$, while in the second relation it says that they are \emph{at least} as good. 
In spite of this, Lemma \ref{lemma:approx-relation-prop1} proves that these two relation are equivalent.
\fi

\begin{lemma}\label{lemma:approx-relation-prop1}
    Let $x,y \in S$. Then $y \leximinPreferred x \iff y \alphaBetaPreferredParams{1}{0} x$.
\end{lemma}

\iffalse
\begin{proof}
    % The first direction $y \leximinPreferred x \Rightarrow y \alphaBetaPreferredParams{0}{0} x$ is almost trivial.
For the first direction,
    assume that $y \leximinPreferred x$. 
    By definition there exists an integer $k \in [n]$ such that $\valBy{j}{y} = \valBy{j}{x}$ for any $j < k$, and $\valBy{k}{y} > \valBy{k}{x}$.
    It is easy to verify that the same $k$ also implies that $y \alphaBetaPreferredParams{1}{0} x$. 
    
For the second direction,
    assume that $y \alphaBetaPreferredParams{1}{0} x$. 
    By definition there exists an integer $k \in [n]$ such that $\valBy{j}{y} \geq \valBy{j}{x}$ for any $j < k$, and $\valBy{k}{y} > \frac{1}{1} \left(\valBy{k}{x}+0\right) = \valBy{k}{x}$.
    Let $k'$ be the smallest integer for which $\valBy{k'}{y} > \valBy{k'}{x}$; 
    % (such a $k'$ must exist since it is true in particular for $k$) . 
    Note that $k'\leq k$.
    This means that $\valBy{j'}{y} = \valBy{j'}{x}$  for any $j' < k'$, and $\valBy{k'}{y} > \valBy{k'}{x}$, so $y \leximinPreferred x$.
\end{proof}
\fi

% \eden{is this ok?} 
% \erel{Yes}
Throughout the remainder of this section, we denote the difference between $\DEFmultApprox$ and $1$ by $\DEFmultError = 1-\DEFmultApprox$; in the context of approximations, $\DEFmultError$ can be viewed as the multiplicative \emph{error} factor.

Another important property of this relation arises from the following observation.

\begin{observation}\label{obs:approx-relation-prop2}
     If $0 \leq \DEFmultErrorOf{\DEFmultApprox_1} \leq  \DEFmultErrorOf{\DEFmultApprox_2} < 1$ and $0 \leq \DEFadditiveError_1 \leq \DEFadditiveError_2$. 
     Then:
     \begin{align*}
         y \alphaBetaPreferredParams{\DEFmultApprox_2}{\DEFadditiveApprox_2} x \Rightarrow y \alphaBetaPreferredParams{\DEFmultApprox_1}{\DEFadditiveApprox_1} x
     \end{align*}
\end{observation}
% \begin{proof}
%     Assume that $y \xPreferred{\gamma} x$.
%     By definition this means that there exists an integer $k\in [n]$ such that:
%     \begin{align*}
%         \forall j < k \colon \quad &\valBy{j}{y} \geq \valBy{j}{x}\\
%         &\valBy{k}{y} > \gamma \cdot \valBy{k}{x} 
%     \end{align*}
%     However, since $\gamma \geq \delta$, this $k$ also implies that $y \alphaBetaPreferred x$ as $\valBy{k}{y} > \gamma \cdot \valBy{k}{x} \geq \delta \cdot \valBy{k}{x}$, and for $j<k$ it is the same as for $\gamma$. 
% \end{proof}
One can easily verify that it follows directly from the definition as
% $\DEFmultApprox_1 \geq \DEFmultApprox_2$ and therefore,
$\frac{1}{\DEFmultApprox_2} \geq \frac{1}{\DEFmultApprox_1}$. 
% Lemma \ref{lemma:approx-relation-prop2} connects the different relations generated by different parameters, that is, the relations $\xPreferred{\gamma}$ and $\alphaBetaPreferred$, arising from $\gamma \geq \delta \geq 1$.
Accordingly, by considering the relation sets $\relationSetParams{\DEFmultApprox_1}{\DEFadditiveApprox_1}$ and $\relationSetParams{\DEFmultApprox_2}{\DEFadditiveApprox_2}$, we can conclude that $\relationSetParams{\DEFmultApprox_2}{\DEFadditiveApprox_2} \subseteq \relationSetParams{\DEFmultApprox_1}{\DEFadditiveApprox_1}$.
This means that as the \emph{error} parameters $\DEFmultError$ and $\DEFadditiveApprox$ increase,
the relation becomes \emph{more partial}:
when $\DEFmultError = 0$ and $\DEFadditiveApprox = 0$ it is a total order, any two elements that yield different utilities appear as a pair in $\relationSetParams{1}{0}$; but as they increase, the set $\relationSetAlphaBeta$ potentially becomes smaller, as fewer pairs are comparable.

To illustrate, consider the following example with three solutions $x,y,z$ and sorted utility vectors $u_x=(1,10,15), u_y =(1,40,60), u_z=(2,20,30)$.
It is easy to see that the maximum element according to the leximin order is $z$ and that $\relationSetParams{1}{0} = \{(z,x),(z,y),(y,x)\}$.
However, the relation set either stays the same or becomes smaller as $\DEFmultError$ increases (and the approximation factor $\DEFmultApprox$ decreases), for example $\relationSetParams{0.75}{0} = \{(z,x),(z,y),(y,x)\}$,
$\relationSetParams{0.5}{0} = \{(y,x)\}$, and $\relationSetParams{0.25}{0} = \emptyset$.
The same applies when $\DEFadditiveError$ increases, for example $\relationSetParams{1}{1} = \{(z,x),(z,y),(y,x)\}$, $\relationSetParams{1}{15} = \{(y,x)\}$ and $\relationSetParams{1}{45} = \emptyset$.
Similarly, when both $\DEFmultError$ and $\DEFadditiveError$ increase, for example $\relationSetParams{0.9}{0.5} = \{(z,x),(z,y),(y,x)\}$, $\relationSetParams{0.75}{1} = \{(y,x)\}$ and $\relationSetParams{0.75}{20} = \emptyset$.
% \eden{for us for checking my calculation:
% \begin{align*}
%     &\relationSetParams{0.25}{0} = \{(z,x),(z,y),(y,x)\} \Hquad \frac{1}{1-0.25} \approx 1.33\\
%     & \quad (z,x), (z,y) \text{ since } 2 > \frac{1}{1-0.25}1 \approx 1.33, \Hquad (y,x)  \text{ since } 40 > \frac{1}{1-0.25}10 \approx 13.33\\
%     &\relationSetParams{0.5}{0} = \{(y,x)\}  \Hquad \frac{1}{1-0.5} = 2\\
%     & \quad (y,x) \text{ since } 40 > \frac{1}{1-0.5}10\approx 1.33, \Hquad \text{NOT }(z,x), (z,y)  \text{ since the ratio is} <2\\
%      &\relationSetParams{0.75}{0} = \emptyset,  \Hquad \frac{1}{1-0.75} = 4, \Hquad \text{ the ratio is always} \leq 4\\ 
%      &\relationSetParams{0}{1} = \{(z,x),(z,y),(y,x)\}\\
%      &\relationSetParams{0}{15} = \{(y,x)\}\\
%      &\relationSetParams{0}{45} = \emptyset,\Hquad \text{ the difference is always} \leq 45\\ \\
%      &\relationSetParams{0.1}{0.5} = \{(z,x),(z,y),(y,x)\}\\
%      &\relationSetParams{0.25}{1} = \{(y,x)\}\\
%      &\relationSetParams{0.25}{20} = \emptyset
% \end{align*}
% }


The leximin approximation can now be defined.

\paragraph{Leximin approximation}
% \eden{should we say again that it is a generalization of Henzinger et al?}
We say that a solution $x\in S$ is an \emph{$(\DEFmultApprox,\DEFadditiveError)$-approximately-optimal} if it is a maximum element of the order $\alphaBetaPreferred$ in $S$ for $\DEFmultApprox\in (0,1]$ and $\DEFadditiveError \geq 0$.
That is, there is \emph{no} solution in $S$ that is $(\DEFmultApprox,\DEFadditiveError)$-leximin-preferred over it --- $y \nAlphaBetaPreferred x$ for any $y\in S$.


% \eden{==== stopped here}
This definition has some important properties.
Lemma \ref{lemma:absence-of-errors} proves that in the absence of errors ($\DEFmultError = \DEFadditiveError = 0$) it is equivalent to the exact leximin optimal definition. 
Then, Lemma \ref{lemma:beta1-beta2-approx} shows that a $(\DEFmultApprox_1,\DEFadditiveError_1)$-approximation is also a $(\DEFmultApprox_2,\DEFadditiveError_2)$-approximation when $0 \leq \DEFmultErrorOf{\DEFmultApprox_1} \leq  \DEFmultErrorOf{\DEFmultApprox_2} < 1$ and $0 \leq \DEFadditiveError_1 \leq \DEFadditiveError_2$.
Finally, Lemma \ref{lemma:exact-is-always-optimal} proves that a leximin optimal solution is always approximately-optimal (for any error factors).
% And third, the definition preserves the leximin nature according to which a solution that hurts the poorest is never preferred.

\begin{lemma}\label{lemma:absence-of-errors}
 In the absence of errors, $\DEFmultError = \DEFadditiveError = 0$, a solution is approximately-leximin-optimal if and only if it is leximin-optimal.
\end{lemma}
% \eden{should it be a corollary?}
\begin{proof}
    % We will show that $x^*$ is a leximin optimal solution if and only if it is approximately-optimal for $\DEFmultError = 0$.
    % First, assume that $x^*$ is a leximin optimal solution. 
    % From Lemma \ref{lemma:exact-is-always-optimal} it is also approximately-optimal for any $\DEFmultError \in [0,1)$, in particular for  $\DEFmultError = 0$.
    % Now, assume that $x^*$ is approximately-optimal for $\DEFmultError = 0$.
    % By definition, $x \nxPreferred{1} x^*$ for any solution $x \in S$. 
    % By Observation \ref{obs:approx-relation-prop2} we can conclude that $x \nLeximinPreferred x^*$ and therefore it is 
    %
    % The claim follows almost directly from Lemma \ref{lemma:approx-relation-prop1}, which implies that $y \nLeximinPreferred x \iff y \nAlphaBetaPreferredParams{0}{0} x$.
    By definition, a solution $x^*$ is approximately-optimal for $\DEFmultError = \DEFadditiveError = 0$ if and only if $x \nAlphaBetaPreferredParams{1}{0} x^*$ for any solution $x \in S$.
    This holds if and only if $x \nLeximinPreferred x^*$ for any solution $x \in S$ (by Lemma \ref{lemma:approx-relation-prop1}).
    This means, by definition, that $x^*$ is a leximin-optimal solution.
\end{proof}




\begin{lemma}\label{lemma:beta1-beta2-approx}
    Let $x \in S$, $0 \leq \DEFmultErrorOf{\DEFmultApprox_1} \leq  \DEFmultErrorOf{\DEFmultApprox_2} < 1$, and $0 \leq \DEFadditiveError_1 \leq \DEFadditiveError_2$. If $x$ is $(\DEFmultApprox_1,\DEFadditiveError_1)$-approximately-optimal then it is also $(\DEFmultApprox_2,\DEFadditiveError_2)$-approximately-optimal.
\end{lemma}

\begin{proof}
    Assume that $x$ is $(\DEFmultApprox_1,\DEFadditiveError_1)$-approximately-optimal.
    By definition, $y \nAlphaBetaPreferredParams{\DEFmultApprox_1}{\DEFadditiveError_1} x$ for any solution $y \in S$.
    Observation \ref{obs:approx-relation-prop2} implies
        % \footnote{Observation \ref{obs:approx-relation-prop2} says that $y \alphaBetaPreferredParams{\DEFmultError_2}{\DEFadditiveError_2} x \Rightarrow y \alphaBetaPreferredParams{\DEFmultError_1}{\DEFadditiveError_1} x$, which implies that $y \nAlphaBetaPreferredParams{\DEFmultError_1}{\DEFadditiveError_1} x \Rightarrow y \nAlphaBetaPreferredParams{\DEFmultError_2}{\DEFadditiveError_2} x$.} 
        that
        % $y \nAlphaBetaPreferredParams{\DEFmultError_1}{\DEFadditiveError_1} x \Rightarrow 
        $y \nAlphaBetaPreferredParams{\DEFmultApprox_2}{\DEFadditiveError_2} x$ 
    % Therefore, $y \nAlphaBetaPreferredParams{\DEFmultError_2}{\DEFadditiveError_2} x$ 
    for any solution $y \in S$. This means, by definition, that $x$ is $(\DEFmultApprox_2,\DEFadditiveError_2)$-approximately-optimal.
\end{proof}


\begin{lemma}\label{lemma:exact-is-always-optimal}
    Let $x^* \in S$ be a leximin optimal solution. Then $x^*$ is also $(\DEFmultApprox,\DEFadditiveError)$-approximately-optimal for any $\DEFmultError \in [0,1)$  and $\DEFadditiveError \geq 0$.
\end{lemma}

% \eden{maybe we should say somewhere that for brevity when we say "any other solution" we mean any solution that has different sorted utility vector; where is the right place to write it?}
\begin{proof}
    % Let $\DEFmultError \in [0,1)$.
    By Lemma \ref{lemma:absence-of-errors}, the solution $x^*$ is also approximately-optimal for $\DEFmultError = \DEFadditiveError = 0$.
    But this means, according to Lemma \ref{lemma:beta1-beta2-approx}, that $x^*$ is also $(\DEFmultApprox_2,\DEFadditiveError_2)$-approximately-optimal for any $0 \leq \DEFmultErrorOf{\DEFmultApprox_2} < 1$ and $\DEFadditiveError_2 \geq 0$.
    %
    % definition of a leximin optimal solution,  $x \nLeximinPreferred x^*$ for any solution $x \in S$.
    % However, as $\frac{1}{1-\DEFmultError} \geq 1$, Observation \ref{obs:approx-relation-prop2} implies\footnote{Observation \ref{obs:approx-relation-prop2} says that $y \xPreferred{\gamma} x \Rightarrow y \alphaBetaPreferred x$ for $\gamma \geq \delta \geq 1$, which implies that $y \nDeltaPreferred x \Rightarrow y \nxPreferred{\gamma} x$} that $x \nLeximinPreferred x^* \Rightarrow x \nxPreferred{\frac{1}{1-\DEFmultError}} x^*$.
    % Therefore, there is no solution that is  $\frac{1}{1-\DEFmultError}$-preferred over $x^*$ and so, by definition, $x^*$ is also $(1-\DEFmultError)$ approximately-optimal.
\end{proof}


Using the example given previously, we shall now demonstrate that as the error parameters $\DEFmultError$ and $\DEFadditiveError$ increase, the quality of the \emph{approximation} decreases.
Given solutions $x,y,z$ with sorted utility vectors $u_x=(1,10,15), u_y =(1,40,60), u_z=(2,20,30)$, we saw that $\relationSetParams{1}{0} = \{(z,x),(z,y),(y,x)\}$. 
In this case, the only solution over which no solution is preferred is $z$.
Therefore, when $\DEFmultError = \DEFadditiveError = 0$, the only approximately-optimal solution is $z$ which is also the only leximin optimal one.
We also saw that $\relationSetParams{0.75}{0} = \relationSetParams{1}{1} = \relationSetParams{0.9}{0.5} = \{(z,x),(z,y),(y,x)\}$; here, similarly, the only approximately-optimal solution for these parameters is $z$.
However, $\relationSetParams{0.5}{0} =\relationSetParams{1}{15} = \relationSetParams{0.75}{1} = \{(y,x)\}$. 
According to the relation set $\{(y,x)\}$, both $z$ and $y$ are solutions over which no solution is preferred, and therefore, they are both approximately optimal for these parameters.
Lastly, as $\relationSetParams{0.25}{0} =\relationSetParams{1}{45} = \relationSetParams{0.75}{20} = \emptyset$, \emph{all} three solutions are approximately-optimal for these parameters.



% let $\gamma \geq \delta \geq 1$ if $x \succ_{\gamma} y$ then also $x \succ_{\delta} y$.
% \eden{it is easy to see that $x \succ_{\delta} y \Rightarrow x \succ_{\delta'} y$ for $\delta \geq \delta'$}
% \eden{therefore, we can also notice the following relation: $x \succ_{\delta} y \Rightarrow x \succ y$, which also implies $x \nsucc y \Rightarrow x \nsucc_{\delta} y$}
% To illustrate, l
% In particular, this implies that for any $\delta > 1$ 



% \paragraph{Characteristics}
% \eden{need to rewrite}
% \begin{itemize}
%     \item In the absence of errors ($\DEFmultError = 1$) the approximate definition is identical to the exact definition.

%     \item For any $\DEFmultError$ the Leximin optimal solution is approximately optimal as well.

%     \item Preserves the Leximin nature/semantics.
    
% \end{itemize}
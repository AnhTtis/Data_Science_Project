\documentclass[a4paper]{article}

\usepackage[english]{babel}
%\usepackage[colorinlistoftodos]{todonotes}
\usepackage{booktabs}
%\usepackage[dvipsnames]{xcolor}

\input{structure.tex} % Include the structure.tex file which specified the document structure and layout

\usepackage{setspace} % Used for consistent line spacing
\usepackage{changepage} % Used for adjustwidth
\usepackage[export]{adjustbox}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{float}
\usepackage{amsmath}
\usepackage{comment}

\usepackage{titlesec}

\title{Supplementary Materials for Dynamical Modularity in Automata Models of  Biochemical Networks}

\begin{document}

\maketitle

\section{\textit{Drosophila} Model}

The update rules of the single-cell 
segment polarity network
(SPN) are listed here.

\vspace{0.25cm}
\setlength{\parindent}{1cm}
%\hrulefill

\textit{Inputs:}

%\hrulefill

%\textbf{SLP}$_{t+1}$=SLP$_{t}$
{SLP}$_{t+1}$=SLP$_{t}$

%\textbf{nWG}$_{t+1}$=nWG$_{t}$
{nWG}$_{t+1}$=nWG$_{t}$

%\textbf{nHH}$_{t+1}$=nHH$_{t}$
{nHH}$_{t+1}$=nHH$_{t}$

%\hrulefill

\medskip

\textit{Internal nodes:}

%\hrulefill

\textit{wg}$_{t+1}$=(CIA$_{t}$ $\wedge$ SLP$_{t}$ $\wedge$ $\lnot$CIR$_{t}$) $\lor$ (\textit{wg}$_{t}$ $\wedge$ (CIA$_{t}$ $\lor$ SLP$_{t}$) $\wedge$ $\lnot$CIR$_{t}$)

WG$_{t+1}$=\textit{wg}$_{t}$

\textit{en}$_{t+1}$=nWG$_{t}$ $\wedge$ $\lnot$SLP$_{t}$

EN$_{t+1}$=\textit{en}$_{t}$

\textit{hh}$_{t+1}$=EN$_{t}$ $\wedge$ $\lnot$CIR$_{t}$

HH$_{t+1}$=\textit{hh}$_{t}$

\textit{ptc}$_{t+1}$=CIA$_{t}$ $\wedge$ $\lnot$EN$_{t}$ $\wedge$ $\lnot$CIR$_{t}$

PTC$_{t+1}$=\textit{ptc}$_{t}$ $\lor$ (PTC$_{t}$ $\wedge$ $\lnot$nHH$_{t}$)

PH$_{t+1}$=PTC$_{t}$ $\wedge$ nHH$_{t}$

SMO$_{t+1}$=$\lnot$PTC$_{t}$ $\lor$ nHH$_{t}$

\textit{ci}$_{t+1}$=$\lnot$EN$_{t}$

CI$_{t+1}$=\textit{ci}$_{t}$

CIA$_{t+1}$=CI$_{t}$ $\wedge$ ($\lnot$PTC$_{t}$ $\lor$ nHH$_{t}$)

CIR$_{t+1}$=CI$_{t}$ $\wedge$ PTC$_{t}$ $\wedge$ $\lnot$nHH$_{t}$

%\hrulefill
%\setlength{\parindent}{0cm}
\vspace{0.25cm}

\setlength{\parindent}{17.62482pt} %reset indentation

The parasegment SPN (size $n=60$) extends the single-cell model by including all 14 internal nodes in each of four cells, where WG and HH influence both of the cell's neighbors (periodic boundary conditions assumed), and an additional node, SLP, acts as an input to each cell (see \cite{albert2003topology} and \cite{marques2013canalization} for a full description).

%\pagebreak
\section{Algorithms}

Pathway modules can be discovered by a breadth-first search (BFS) on the DCM (\textit{algorithm 1},
see Fig. \ref{fig:algorithm1}), given the caveat of accounting for the temporal dynamics of state updates. 
Input to the algorithm is a DCM, a %given 
seed set $S^0$, and a perturbation type (pinning or pulse).  The algorithm tracks which s-units and t-units fire in each time step.  As with regular BFS units are visited via a first-in first-out (FIFO) queue, 
%but only within %the 
%same 
%a relative time step
%(i.e., a separate queue is created for each time step).
but a separate queue is created for each time step.
%for each time step $t$, there is a separate queue $\mathcal{Q}_t$.  
The time counter is initialized at 0 and increases once all of the units in the associated queue have been visited.
%An initial time counter $t=0$ and two queues $\mathcal{Q}_{t=0}$ and $\mathcal{Q}_{t=1}$ are created.  Then, after each iteration of the algorithm (i.e., after all units in $\mathcal{Q}_{t}$ have been visited), $t$ is increased and a new queue $\mathcal{Q}_{t+1}$ is created.
%The time counter begins at 0, and after all units have been visited in the current time step the time counter increases.  
%A hash table stores each time step along with the corresponding FIFO queue.

T-units are added to the queue %within 
associated with
the current time step $t$ 
%(delay $dt=0$) 
if their threshold is met, while s-units are added to the queue %at 
associated with
time step $t+1$. 
%(delay $dt=1$).
If the perturbation type is pinning, 
%any units that fire are only visited once (and are afterwards assumed to fire every time step).  
any given unit is only visited once (as they are afterwards assumed to fire every time step).
If the perturbation type is pulse, 
by contrast,
%the set of units visited each time step gets reset when the time counter is increased so that units that previously fired can be visited again in a future time step.
units that previously fired are allowed to be visited again in future time steps.

The algorithm halts when no new s-units or t-units 
can be added to a queue
%are added to the queue 
(logically, no more units can fire) or the set of s-units and t-units that fire 
%are visited
at time $t=i$ is equivalent to the set of s-units and t-units 
%visited
that fired
at a previous iteration $t={j<i}$ (a cycle is reached)~\footnote{This only applies to pulse perturbation where the set of units that fire is reset after each time step; for pinning perturbation, this condition is equivalent to the previous one (i.e., no new units are added to the queue) since all units that fire at time $t$ also fire at time $t+1$.}.

The algorithm returns a hash table keyed by time step, where each value is the set of s-units and t-units that fire in the associated time step.  The total set of s-units that fire, $S$, can then be easily derived by finding the superset of s-units from each time step (and ignoring all t-units). 

%The current value of \verb|\parindent| is \the\parindent, \indentation


This algorithm can be extended to the general case where each seed s-unit $x$ is associated with a firing schedule, 
%$f({x},{t})=$1 if $x$ is forced to fire at time $t$, 0 if $x$ is forced not to fire at time $t$

%$F({x}^{t})$ \{1 if $x$ fires at time $t$, 
$f({x},{t})=$ \{1 if $x$ is forced to fire at time $t$,

        \setlength\parindent{2.3cm}
        %0 if $x$ does not fire at time $t$
        0 if $x$ is not forced to fire at time $t$\},
\setlength{\parindent}{0cm}

rather than only allowing pinning or pulse perturbation.
In this case, the external perturbations dictated by the firing schedule take precedence over any units already in the queue.
%Additionally, here all s-units have delay $dt=1$; 
Additionally, the delay associated with units can be generalized; here
%Additionally, all s-units here
all s-units take one time step to fire (i.e., they have delay $dt=1$);
%they are added to the queue at time $t+1$)
however, s-units can be allowed a higher delay $dt>1$
%(i.e., they are added to a queue at time $t+k$)
such that it takes several (relative) time steps for a signal to reach an s-unit (for example, this may represent cellular processes that operate on a longer time scale than transcription or translation and could be useful for non-synchronous updating schemes \cite{chaves2006methods, gershenson2004introduction}).

\setlength{\parindent}{17.62482pt} %reset indentation

The set of pathway modules 
discovered by \textit{algorithm 1}
can then be reduced to a set of complex modules ( \textit{algorithm 2},
see Fig.~\ref{fig:algorithm2}).  Input to the algorithm is a DCM, a maximum seed set size \textit{max\_s}, a set of s-units \textit{seeds},
%to be used as potential seeds, 
and a perturbation type (pinning or pulse). 
Algorithm 2 initially finds all pathway modules with seed set size $s=1$ 
%from the set $seeds$ 
whose seed is in the set \textit{seeds}
using \textit{algorithm 1} and then removes any subsumed modules 
%(to obtain $\Lambda_1$) 
to create an initial set of complex modules $I_1$.  It then iteratively finds the set of complex modules $I_{s>1}$ with increasing seed set size $s=2,3,4...$\textit{max\_s}.  For each 
size $s$, pathway modules are found 
%by adding a single s-unit from the set $seeds$ to each member of the previous set of pathway modules 
%found with seed set size $s-1$.
for all possible seeds sets, %of size $s$,
%of the prescribed size, 
where seeds are obtained from the set \textit{seeds}.
This set of potential modules is then reduced to a set of complex modules by removing all modules that are not maximal or that contain non-synergistic submodules.  The algorithm halts when the maximum seed set size \textit{max\_s} has been reached and returns the set of complex modules
%$I_{max\_s}$.
found thus far.

The set \textit{seeds} can be any set of s-units of interest %; 
(for example, the s-units representing the network inputs).  If \textit{seeds}$= \mathcal{S}$, the set of all s-units in the network, then all pathway modules (and therefore all complex modules) will be found; if, however, \textit{seeds}$= \Lambda_1$, then only complex modules with maximal seeds will be found~\footnote{$\Lambda_1$ can be found by running \textit{algorithm 2 }with \textit{max\_s}$=1$, \textit{seeds}$= \mathcal{S}$.}.  This is the maximal seed heuristic which finds all core complex modules in the network.

All analysis and code for this paper,
including \textit{algorithm 1} and \textit{algorithm 2}, was written in Python 2.7 with the assistance of the CANA package for finding Boolean network DCMs \cite{correia2018cana}.
The code is publicly available at \url{https://github.com/tjparmer/dynamical\_modularity}.

\bigskip

\begin{figure}[h!] %[!htb]
\begin{adjustwidth}{-1cm}{}
%\centering
\hrulefill 

\textbf{Algorithm 1:} Pathway module breadth-first search

\hrulefill 

\textbf{function} thresholded\_BFS (\textit{DCM}, %\textit{seed},
$S^0$,
\textit{perturbation\_type}):
%,\textit{time\_limit}):
	
	\vspace{.25cm}
	\setlength{\parindent}{1cm}
	\indent time \textit{t}=0
	
	\textit{time\_steps}=\{t: 
    queue($S^0$)\}
    %queue(\textit{seed})\} %-->FIFO queue hashed by relative time step
	
	\textit{unfolding}=\{t: \{\}\} %-->array hashed by relative time step
	
	\textit{active\_step}=%\{\textit{seed}\}
 \{$S^0$\}
	
	\textit{visited}=\{\}
	
	%\textit{counter}=0
	
	\vspace{.25cm}
	
	\textbf{while} \textit{t}$\leq$max(\textit{time\_steps}):
	
	\vspace{.25cm}
	
	\setlength{\parindent}{2cm}
	
	\textit{visited} $\leftarrow$ \textit{active\_step}
	
	\textbf{if} 
	%no new s-units were added to \textit{visited} \textbf{or} 
	\textit{active\_step} $=$ \textit{unfolding}[$i<t$]: 
	
	    \setlength{\parindent}{3cm}
	    %\textit{counter} $=$ \textit{counter} $+ 1$
	    
	    %\textbf{if} \textit{counter} $>$ \textit{time\_limit}:
	    
	    %\setlength{\parindent}{4cm}
	    \textbf{return} \textit{unfolding}
	
	\setlength{\parindent}{2cm}
	\indent \textbf{if} \textit{perturbation\_type}=`pulse': 
	
	\setlength{\parindent}{3cm}
	\indent \textit{active\_step}=\{\}
	
	\textbf{reset} t-unit thresholds
	
	\vspace{.25cm}
	
	\setlength{\parindent}{2cm}
	\indent \textbf{while} \textit{time\_steps}[\textit{t}]:
	
	    \setlength{\parindent}{3cm}
	    \indent \textbf{pop} first unit \textit{x} from queue at \textit{time\_steps}[\textit{t}]
	    
		\textit{unfolding}[\textit{t}] $\leftarrow$ \textit{x}
		
		\textbf{for each} 
        \textit{DCM}
        neighbor (s-unit/t-unit) \textit{n} 
		%$\not\subset$
		$\not\in$
		\textit{active\_step}: 
		%\textit{n} that have not been visited, 
		
		    \setlength{\parindent}{4cm}
			
			    \textbf{if} \textit{n} is not a contradiction \textbf{and} the threshold \textit{$\tau$} of \textit{n} is met:
			
			    \setlength{\parindent}{5cm}
				\indent \textit{dt} = the delay of \textit{n}
				
				\textit{time\_steps}[$t+$\textit{dt}] $\leftarrow$ \textit{n}
				
				\textit{active\_step} $\leftarrow$ \textit{n}
	
	\setlength{\parindent}{2cm}			
	\indent \textit{$t = t+1$}

\vspace{.25cm}
\setlength{\parindent}{1cm}	
\indent
\textbf{return} \textit{unfolding}

\setlength{\parindent}{0cm}
\hrulefill 

\caption{\textbf{Pseudo-code for algorithm 1.}
Input to the function is a DCM, a seed set 
%(set of s-units $S^0$), 
of s-units $S^0$,
and a perturbation type (`pinning' or `pulse').  
The algorithm is similar to breadth-first search (BFS) and explores what part of the DCM is reachable from the seed set, factoring in the perturbation type, relative time steps, logical contradiction, and t-unit thresholds.  FIFO queues hashed by relative time step are stored in \textit{time\_steps} while sets of visited units hashed by relative time step are stored in \textit{unfolding}.  Units (s or t) are only added to the queue associated with the respective time step if they meet the requisite conditions.  
S-units are given a default threshold $\tau=1$ and delay $dt=1$, while t-units have delay $dt=0$.  Units that are visited are added to the sets \textit{visited} and \textit{active\_step}.  Each t-unit must track the s-units that contribute towards its threshold; with pulse perturbation, unit thresholds are reset after each time step.  
The algorithm halts when a repeat set of s-units and t-units is found for a given time step or when no new units can be reached based on their logical conditions.
%(in which case the queue \textit{time\_steps}[$t$] does not exist and the algorithm halts).
The function returns the pathway module $\textbf{M}_{S^0}$ initiated by the seed set, i.e., the sets of units visited at each relative time step.  In the above pseudo-code, \{key:value\} represents a hash table and \{\} a set.
}
\label{fig:algorithm1}
\end{adjustwidth}
\end{figure}

\begin{figure}[h!]
\begin{adjustwidth}{-2cm}{}
%\centering
\hrulefill 

\textbf{Algorithm 2:} Complex module discovery

\hrulefill 

\textbf{function} complex\_module\_search (\textit{DCM}, \textit{max\_s}, \textit{seeds}, \textit{perturbation\_type}): 
%\textit{time\_limit}):

    \vspace{.25cm}
    \setlength{\parindent}{1cm}
	iteration \textit{s}=1
	
	%graph covers \textit{C}=\{\}
	
	complex modules \textit{I}=\{\}
	
	%\textit{seeds}=\{all s-units in the \textit{DCM}\}
	
	\vspace{.25cm}
	\textbf{while} $\textit{s} \leq \textit{max\_s}$:
	
	    \setlength{\parindent}{2cm}
	    \textbf{if} \textit{s}=1:
	    
	        \setlength{\parindent}{3cm}
	        \textit{new\_seeds}=\textit{seeds}
	        
	   \setlength{\parindent}{2cm}
	   \textbf{else:}
	   
	        \setlength{\parindent}{3cm}
	        \textit{new\_seeds}=\{$S_i^0 \cup \{\textit{seed}\}$ \textbf{for} $\textit{i} \in \textit{P}$, $\textit{seed} \in \textit{seeds}$\}
	    
	    \vspace{.25cm}
	    \setlength{\parindent}{2cm}
	    %\#find dynamic modules
	    
	    pathway modules \textit{P}=\{\}
	    
	    %maximal modules $\Lambda$=\{\}
	    
	    %\vspace{.25cm}
	    \textbf{for} \textit{seed} in \textit{new\_seeds}:
	    
	        \setlength{\parindent}{3cm}
	        \textit{P} $\leftarrow$ \textbf{thresholded\_BFS}(\textit{DCM}, \textit{seed}, \textit{perturbation\_type})
	        %\textit{time\_limit})
	   
	   \vspace{.25cm}
	   \setlength{\parindent}{2cm}
	   %\#check for synergy of subcomponents
	   
	   %\textbf{remove} redundant modules from \textit{P}
	   \textbf{for} module \textit{p} $\in$ \textit{P}:
	   
	        \setlength{\parindent}{3cm}
	        %\textbf{for} submodule \textit{ps} $\in$ \textit{p}:
	        \textbf{if} $p$ is subsumed by $m$ for any module $m \in P$:
	            
	            \setlength{\parindent}{4cm}
	                \textbf{continue} %\#not maximal
	                
	       \setlength{\parindent}{3cm}
	            %\setlength{\parindent}{4cm}
	       \textbf{else if} $\mu(S_p^0) - \mu(S_{ps}^0) - \mu(S_p^0 - S_{ps}^0) = \emptyset$ for any submodule \textit{ps} of %$\in$ 
	       \textit{p}:
	            
	                \setlength{\parindent}{4cm}
	                \textbf{continue} %\#not synergistic
	                
	       \setlength{\parindent}{3cm}
	       \textbf{else:}
	       
	       \setlength{\parindent}{4cm}
	       \textit{I} $\leftarrow$ \textit{p} %\#synergistic otherwise
		
		\setlength{\parindent}{2cm}	
		$\textit{s} = \textit{s}+1$
	
	\vspace{.25cm}
	\setlength{\parindent}{1cm}
	\textbf{return} \textit{I}%, \textit{C}

\setlength{\parindent}{0cm}		
\hrulefill 

\caption{\textbf{Pseudo-code for algorithm 2.}  
Input to the function is a DCM, the maximum seed set size \textit{max\_s}, a set of s-units
\textit{seeds}, and a perturbation type (`pinning' or `pulse').
%The set of starting seeds may be all s-units in the network, the seed units of maximal pathway modules $\Lambda_1$, s-units of the network inputs, or another subset of s-units of interest.
At each iteration, new seed sets of size $s=k$ are generated by combining seed sets of %existing modules
current pathway modules 
of size $s=k-1$ with the members of \textit{seeds} (size $s=1$).  The pathway modules for these 
new seed sets are found using algorithm 1; this set of modules is then condensed to a set of complex modules by removing those that are subsumed by other modules or that fail a synergy check.  For pinning perturbation, the former condition filters any module $p$ where $S_p \subset S_m$ for any other module $m \in P$, whereas for pulse perturbation the temporal order of when units fire must be checked as well.  
The function returns the set of complex modules $I$.
%$I_{max\_s}$.
In the above pseudo-code, \{\} represents a set.
}
\label{fig:algorithm2}
\end{adjustwidth}
\end{figure}

\begin{figure}[]
%\begin{adjustwidth}{-3cm}{}
\centering
\includegraphics[width=1.2\columnwidth]{Figures/example_interactions_bubbles.pdf}
\caption{\textbf{Example interactions between pathway modules.}  
(a) Module $\textbf{M}_A$ subsumes $\textbf{M}_B$ as the unfolding of $\textbf{M}_B$ is completely contained in $\textbf{M}_A$.  (b) $\textbf{M}_{A, B-0}$ logically obstructs $\textbf{M}_A$ because of the contradiction between B-0 and B-1, which prevents the rest of $\textbf{M}_A$ from unfolding.  (c) $\textbf{M}_A$ and $\textbf{M}_D$ are decoupled
(dynamically independent); even though they share a threshold, $\textbf{M}_{A,D}$ does not fire the t-unit and thus cannot cause any downstream effects.  (d) $\textbf{M}_A$ and $\textbf{M}_F$ are synergistic because $\textbf{M}_{A, F}$ fires a t-unit that neither module can fire by itself, thereby reaching the node H.  (e)  There is both synergy and logical obstruction present between $\textbf{M}_{A}$ and $\textbf{M}_{C-1}$, as a logical contradiction with C-1 blocks the complete unfolding of $\textbf{M}_A$; however, the synergy present also allows $\textbf{M}_{A, C-1}$ to include I and J.  (f)  An example of synergy between non-maximal seeds. $\textbf{M}_C$ is subsumed by $\textbf{M}_A$ and $\textbf{M}_K$ is subsumed by $\textbf{M}_{B-0}$.
%and are therefore not considered valid seeds by \textit{algorithm 2}.  
Because of the contradiction of B-0 and B-1, $|S_{A, B-0}|=3$ (shown in green).  However, if C and K are used as seeds, then a larger module is seen which includes the extra nodes L and M, $|S_{C, K}|=4$ (shown in brown).
This synergy is found in two complex modules, $|S_{C, B-0}|=5$ and $|S_{A, K}|=6$; however, neither of these are core complex modules %as 
because $\textbf{M}_C$ and $\textbf{M}_K$ are not maximal.
%\textit{Algorithm 2} naturally removes all seed combinations that are not synergistic (\textit{a-c}) to find synergistic modules (\textit{d-e}).  However, by removing subsumed modules, we miss potential synergistic modules (as in \textit{f}).
}
\label{fig:interactions}
%\end{adjustwidth}
\end{figure}

\pagebreak

%\section{\textit{Drosophila} Single-Cell SPN modules}
%\section{Complex modules and dynamical unfolding in the \textit{drosophila} SPN}
\section{Complex Modules and Dynamical Unfolding}

\begin{table}[]
\begin{adjustwidth}{-1.5cm}{}
\begin{tabular}{lll} \toprule
$\textbf{M}_i$ %& $S_i^0$               
& dynamical unfolding                      & $|S_i|$ \\ \midrule
\textcolor{ProcessBlue}{$\textbf{M}_{\textbf{en-1}}$  ($\Sigma_\textbf{2}$)}   %& \textit{en-1}     
& EN-1, \textit{ci-0}, \textit{ptc-0}, CI-0, CIR-0, CIA-0, \textit{hh-1}, HH-1                                                               & 9     \\
\textcolor{VioletRed}{$\textbf{M}_{\textbf{nWG-0}}$  ($\Sigma_\textbf{1}$)}   %& nWG-0     %pink 
& \textit{en-0}, EN-0, \textit{ci-1}, \textit{hh-0}, CI-1, HH-0                                                                                                 & 7      \\
\textcolor{VioletRed}{$\textbf{M}_{\textbf{SLP-1}}$  ($\Sigma_\textbf{1}$)}   %& SLP-1      
& \textit{en-0}, EN-0, \textit{ci-1}, \textit{hh-0}, CI-1, HH-0                                                                                                 & 7      \\
\textcolor{Emerald}{$\textbf{M}_{\textbf{CIR-1}}$}     %& CIR-1               
& \textit{hh-0}, \textit{wg-0}, \textit{ptc-0}, HH-0, WG-0                                                                                                      & 6     \\
\textcolor{RedOrange}{$\textbf{M}_{\textbf{PTC-0}}$}     %& PTC-0               
& SMO-1, PH-0, CIR-0                                                                                                      & 4     \\
\textcolor{ForestGreen}{$\textbf{M}_{\textbf{HH-1}}$}  %& nHH-1               
& SMO-1, CIR-0                                                                                                                       & 3      \\
\textcolor{BurntOrange}{$\textbf{M}_{\textbf{HH-0}}$}   %& nHH-0         %Dandelion      
& PH-0                                                                                                                               & 2      \\ \textcolor{RedViolet}{$\textbf{M}_{\textbf{wg-1}}$} %& \textit{wg-1}  
& WG-1   & 2      \\
\textcolor{Maroon}{$\textbf{M}_{\textbf{ptc-1}}$} %& \textit{ptc-1}  
& PTC-1   & 2      \\
\textcolor{gray}{$\textbf{M}_{\textbf{nWG-1}}$} %& nWG-1  
&  --  & 1      \\
\textcolor{gray}{$\textbf{M}_{\textbf{SLP-0}}$} %& SLP-0  
&  -- & 1      \\
\textcolor{gray}{$\textbf{M}_{\textbf{PH-1}}$}  %& PH-1  
&   --  & 1      \\
\textcolor{gray}{$\textbf{M}_{\textbf{SMO-0}}$}  %& SMO-0  
&  --  & 1      \\
\textcolor{gray}{$\textbf{M}_{\textbf{CIA-1}}$}  %& CIA-1   
&  --  & 1      \\ 
\midrule %DarkOrchid

\textcolor{red}{$\textbf{M}_{\textbf{SLP-1,nHH-1}}$  ($\Sigma_\textbf{3}$)}    %& SLP-1 $\wedge$ nHH-1 
& \begin{tabular}[c]{@{}l@{}}SMO-1, CIR-0, \textit{en-0}, EN-0, \textit{ci-1}, \textit{hh-0}, CI-1, HH-0, CIA-1, \\ \textit{wg-1}, \textit{ptc-1}, WG-1, PTC-1, PH-1\end{tabular} & 16     \\
\textcolor{RedOrange}{$\textbf{M}_{\textbf{SLP-1,PTC-0}}$ ($\Sigma_\textbf{5}$)} %& SLP-1 $\wedge$ PTC-0
& \begin{tabular}[c]{@{}l@{}} SMO-1, PH-0, CIR-0, \textit{en-0}, EN-0, \textit{ci-1}, \textit{hh-0}, CI-1, HH-0, \\ CIA-1, \textit{wg-1},  \textit{ptc-1}, WG-1 \end{tabular}                                                   & 15     \\
\textcolor{red}{$\textbf{M}_{\textbf{nWG-0,nHH-1}}$  ($\Sigma_\textbf{3}$)}    %& nWG-0 $\wedge$ nHH-1 
& \begin{tabular}[c]{@{}l@{}}SMO-1, CIR-0, \textit{en-0}, EN-0, \textit{ci-1}, \textit{hh-0}, CI-1, HH-0, CIA-1, \\ \textit{ptc-1}, PTC-1, PH-1\end{tabular} & 14     \\
\textcolor{RedOrange}{$\textbf{M}_{\textbf{nWG-0,PTC-0}}$  ($\Sigma_\textbf{5}$)} %& nWG-0 $\wedge$ PTC-0 
& \begin{tabular}[c]{@{}l@{}}  SMO-1, PH-0, CIR-0, \textit{en-0}, EN-0, \textit{ci-1}, \textit{hh-0}, CI-1, HH-0, \\ CIA-1, \textit{ptc-1}  \end{tabular}                                                & 13     \\
\textcolor{BlueViolet}{$\textbf{M}_{\textbf{nHH-1,en-1}}$  ($\Sigma_\textbf{4}$)} %& \textit{en-1} $\wedge$ nHH-1 
& \begin{tabular}[c]{@{}l@{}} SMO-1, CIR-0, EN-1, \textit{hh-1}, \textit{ci-0}, \textit{ptc-0}, HH-1, CI-0, PTC-0, \\ PH-0,  CIA-0 \end{tabular} & 13     \\
\textcolor{ProcessBlue}{$\textbf{M}_{\textbf{SLP-0,nWG-1}}$  ($\Sigma_\textbf{2}$)}   %& nWG-1 $\wedge$ SLP-0     
& \begin{tabular}[c]{@{}l@{}} \textit{en-1}, EN-1, \textit{ci-0}, \textit{ptc-0}, CI-0, CIR-0, CIA-0, \textit{hh-1}, \textit{wg-0}, \\ HH-1, WG-0  \end{tabular}                                                              & 13     \\
\vspace{5.0pt}
\textcolor{Emerald}{$\textbf{M}_{\textbf{nHH-1,CIR-1}}$}    %& nHH-1 $\wedge$ CIR-1  
& SMO-1, \textit{hh-0}, \textit{wg-0}, \textit{ptc-0}, HH-0, WG-0, PTC-0, PH-0   & 10     \\
\textcolor{RawSienna}{$\textbf{M}_{\textbf{nHH-0,ptc-1}}$}  %& nHH-0 $\wedge$ \textit{ptc-1}  
& PH-0, PTC-1, SMO-0, CIA-0   & 6      \\ \midrule

\textcolor{BlueViolet}{$\textbf{M}_{\textbf{SLP-0,nWG-1,nHH-1}}$  ($\Sigma_\textbf{4}$)} %& nWG-1 $\wedge$ SLP-0 $\wedge$ nHH-1 
& \begin{tabular}[c]{@{}l@{}}SMO-1, CIR-0, \textit{en-1}, EN-1, \textit{hh-1}, \textit{ci-0}, \textit{ptc-0}, HH-1, CI-0, \\ PTC-0, PH-0, CIA-0, \textit{wg-0}, WG-0\end{tabular} & 17     \\
\textcolor{red}{$\textbf{M}_{\textbf{SLP-1,nHH-1,CIR-1}}$}    %& SLP-1 $\wedge$ nHH-1 $\wedge$ CIR-1 
& \begin{tabular}[c]{@{}l@{}}SMO-1, \textit{hh-0}, \textit{wg-0}, \textit{ptc-0}, \textit{en-0}, HH-0, WG-0, PTC-0, EN-0, \\ \textit{ci-1}, PH-0, CI-1, CIA-1 \end{tabular} & 16     \\
\textcolor{red}{$\textbf{M}_{\textbf{nWG-0,nHH-1,CIR-1}}$}    %& nWG-0 $\wedge$ nHH-1 $\wedge$ CIR-1  
& \begin{tabular}[c]{@{}l@{}} SMO-1, \textit{hh-0}, \textit{wg-0}, \textit{ptc-0}, \textit{en-0}, HH-0, WG-0, PTC-0, EN-0, \\ \textit{ci-1}, PH-0, CI-1, CIA-1 \end{tabular} & 16    \\
\textcolor{Bittersweet}{$\textbf{M}_{\textbf{SLP-1,nHH-0,ptc-1}}$}  %& nHH-0 $\wedge$ \textit{ptc-1} $\wedge$ SLP-1     %Tan, Mahogany
& \begin{tabular}[c]{@{}l@{}} PH-0, PTC-1, \textit{en-0}, SMO-0, CIA-0, EN-0, \textit{ci-1}, \textit{hh-0}, CI-1, \\ HH-0, CIR-1, \textit{wg-0}, WG-0  \end{tabular}    & 16      \\
\textcolor{Bittersweet}{$\textbf{M}_{\textbf{nWG-0,nHH-0,ptc-1}}$}  %& nHH-0 $\wedge$ \textit{ptc-1}  $\wedge$ nWG-0   
& \begin{tabular}[c]{@{}l@{}} PH-0, PTC-1, \textit{en-0}, SMO-0, CIA-0, EN-0, \textit{ci-1}, \textit{hh-0}, CI-1, \\ HH-0, CIR-1, \textit{wg-0}, WG-0  \end{tabular}    & 16    \\
\textcolor{gray}{$\textbf{M}_{\textbf{SLP-0,nHH-0,ptc-1}}$} % & nHH-0 $\wedge$ \textit{ptc-1} $\wedge$ SLP-0   
&  PH-0, PTC-1, SMO-0, CIA-0, \textit{wg-0}, WG-0   & 9      \\
\bottomrule
\end{tabular}
\caption{\textbf{List of the core complex modules in the \textit{drosophila} single-cell SPN with pinning perturbation.}  Modules are grouped by seed set size and ordered by 
resulting size
$|S_i|$.  The module labels are colored to correspond to Figure 5 in the main text, as well as supplementary figures \ref{fig:drosophila_modules1}, \ref{fig:drosophila_modules2}, and \ref{fig:drosophila_modules3}; membership in a set of related modules $\Sigma$ is also indicated in parentheses. 
%The modules $M_{6s}$, $M_{SLP_1 \land PTC-0}$, $M_{11}$, $M_{12}$, and $M_{13}$ resolve all internal nodes in the network. 
The s-units are listed in the temporal order that they are visited within the dynamical unfolding process.
}
\label{tab:drosophila_modules}
\end{adjustwidth}
\end{table}

\begin{figure}
\begin{adjustwidth}{-2cm}{}
\centering
\includegraphics[width=1.4\columnwidth]{Figures/drosophila_DCM_s1_examples.pdf}
%\hspace{2.5cm}
%\vspace{0.5cm}
\caption{\textbf{Complex modules in the \textit{drosophila} single-cell SPN, seed set size $s=1$.}  Select complex modules (indicated by color) are shown: module $\textbf{M}_{nWG-0}$ (a), module $\textbf{M}_{CIR-1}$ (b), module $\textbf{M}_{PTC-0}$ (c), and all 14 complex modules with seed set size $s=1$ (d).  
%All 14 synergistic modules ($\Lambda_1$).  These modules cover the DCM s-units (with overlap).  S-units and t-units are colored by the longest module that they are a part of.  Modules that only contain the seed ($|S_i|=1$) are in purple.
These modules dynamically unfold from their seed set of size $s=1$ (highlighted with a double edge) to include the s and t-units that are guaranteed to fire given pinning perturbation.  
In panel d, the 14 modules indicated compose $\Lambda_1$ and cover the DCM.  S-units and t-units are colored by the largest module that they are a part of; modules that only contain the seed ($|S_i|=1$) are in purple.
Note that several t-units have been removed or modified in the figure for clarity of the transition function.
}
\label{fig:drosophila_modules1}
\end{adjustwidth}
\end{figure}

\begin{figure}
\begin{adjustwidth}{-2cm}{}
\centering
\includegraphics[width=1.4\columnwidth]{Figures/drosophila_DCM_s2_examples.pdf}
%\hspace{2.5cm}
%\vspace{0.5cm}
\caption{\textbf{Complex modules in the \textit{drosophila} single-cell SPN, seed set size $s=2$.}  Select complex modules (indicated by color) are shown: module $\textbf{M}_{SLP-1,PTC-0}$ (a), module $\textbf{M}_{nHH-1,en-1}$ (b), module $\textbf{M}_{nHH-1,CIR-1}$ (c), and module $\textbf{M}_{nHH-0,ptc-1}$ (d).  
These modules dynamically unfold from their seed set of size $s=2$ (highlighted with a double edge) to include the s and t-units that are guaranteed to fire given pinning perturbation.
In panel d, note that s-unit \textit{ptc-0} does not fire with pinning perturbation due to contradiction with \textit{ptc-1}.
Note that several t-units have been removed or modified in the figure for clarity of the transition function.
}
\label{fig:drosophila_modules2}
\end{adjustwidth}
\end{figure}

\begin{figure}
\begin{adjustwidth}{-2cm}{}
\centering
\includegraphics[width=1.4\columnwidth]{Figures/drosophila_DCM_s3_examples.pdf}
%\hspace{2.5cm}
%\vspace{0.5cm}
\caption{\textbf{Complex modules in the \textit{drosophila} single-cell SPN, seed set size $s=3$.}  Select complex modules (indicated by color) are shown: module $\textbf{M}_{SLP-0,nWG-1,nHH-1}$ (a), module $\textbf{M}_{nWG-0,nHH-1,CIR-1}$ (b), module $\textbf{M}_{nWG-0,nHH-0,ptc-1}$ (c), and module $\textbf{M}_{SLP-0,nHH-0,ptc-1}$ (d).  
These modules dynamically unfold from their seed set of size $s=3$ (highlighted with a double edge) to include the s and t-units that are guaranteed to fire given pinning perturbation.
In panel a, the indicated module resolves all 17 variable states and results in one of the network's 10 attractors.
In panel b, the indicated module is identical to $\textbf{M}_{SLP-1,nHH-1,CIR-1}$ but differs only in the seed.
In panel c, the indicated module is identical to $\textbf{M}_{SLP-1,nHH-0,ptc-1}$ but differs only in the seed.
Note that several t-units have been removed or modified in the figure for clarity of the transition function.
}
\label{fig:drosophila_modules3}
\end{adjustwidth}
\end{figure}

%dynamic cycle - probably don't need this
\begin{comment}
\begin{figure}
\begin{adjustwidth}{-2cm}{}
\centering
\includegraphics[width=1.4\columnwidth]{Figures/drosophila_DCM_cycle_example.pdf}
\caption{\textbf{Dynamic cycle by perturbation of nHH.}  The input nHH can unfold different modules if its state is changed periodically.  If held ON long enough,
and SLP-1 or nWG-0 is also present,
$\textbf{M}_{SLP-1,nHH-1}$ or $\textbf{M}_{nWG-0,nHH-1}$ can unfold (a), which turns on \textit{ptc}.  If nHH is turned OFF, $\textbf{M}_{nHH-0,ptc-1}$ unfolds and turns off \textit{ptc} (b).  If nHH is turned ON again, it turns off PTC and 
allows
$\textbf{M}_{SLP-1,nHH-1}$ or $\textbf{M}_{nWG-0,nHH-1}$ %unfolds 
to unfold (c), which again turns on \textit{ptc}.  If nHH is turned OFF, $\textbf{M}_{nHH-0,ptc-1}$ unfolds and the cycle %repeats 
continues (d); thus, periodically flipping the state of nHH causes several other nodes states (such as \textit{ptc}, PTC, CIA, and SMO) to also flip.}
\label{fig:nHH_flip}
\end{adjustwidth}
\end{figure}
\end{comment}

%\section{\textit{Drosophila} Parasegment SPN modules}

\begin{figure}
\begin{adjustwidth}{-2cm}{}
\centering
\includegraphics[width=1.4\columnwidth]{Figures/parasegment_unfolding_examples.pdf}
\caption{\textbf{Dynamical unfolding in the \textit{drosophila} parasegment SPN.}  Cell boundaries are separated by a blue line; white indicates that a node is OFF in that time step, black indicates that a node is ON, and grey indicates that the node's state is unknown.  The color of the node label indicates the associated 
complex module.  
(a) The dynamical unfolding of SLP$_1=$ SLP$_3=0$, \textit{wg}$_2=1$. The presence of WG-1 in cell 2 allows $\textbf{M}_{SLP-0,nWG-1}$ (labeled as blue) to unfold in cells 1 and 3 by acting as an additional input to SLP-0.  These modules turn off WG and turn on HH in cells 1 and 3, which initiates $\textbf{M}_{nWG-0,nHH-1}$ in cells 2 and 4 (labeled as red).  Finally $\textbf{M}_{nWG-0,nHH-1}$ 
in cells 2 and 4
turns off HH which initiates the (small) $\textbf{M}_{nHH-0}$ module in cells 1 and 3 (labeled as yellow).  This resolves almost the entire network (52 variables) with only three inputs.  
(b) The dynamical unfolding of SLP$_1=$ SLP$_3=$ PTC$_2=0$, SLP$_2=1$ is almost identical, except instead of \textit{wg}-1, SLP-1 and PTC-0 are pinned in cell 2.  $\textbf{M}_{SLP-1,PTC-0}$ (labeled as orange) similarly turns on WG, initiating the $\textbf{M}_{SLP-0,nWG-1}$ module in cells 1 and 3.  However, the time differences are more pronounced.  The unfolding can be seen in three distinct epochs where first $\textbf{M}_{SLP-1,PTC-0}$ must unfold in cell 2, then the $\textbf{M}_{SLP-0,nWG-1}$ modules are initiated in cells 1 and 3, and then $\textbf{M}_{nWG-0,nHH-1}$ is initiated in cell 4.  This demonstrates how important timing is in the dynamic interplay %across modules.
between cells.}
\label{fig:unfoldings}
\end{adjustwidth}
\end{figure}


\begin{table}
\begin{tabular}{llll} \toprule
$|S_i^0|$ & $S_i^0$    & $|S_i|$ & \begin{tabular}[c]{@{}l@{}}associated \\ modules\end{tabular} \\ \midrule
$s=1$ & \textit{en}-1$_i$                                           & 13          & \textcolor{ProcessBlue}{$\textbf{M}_\textbf{2}$}/\textcolor{ForestGreen}{$\textbf{M}_\textbf{3}$}                                                         \\ \midrule
$s=2$ & \begin{tabular}[c]{@{}l@{}}(\textit{en}-1$_i$, \textit{en}-1$_{i+1}$),\\ (CIR-1$_i$, CIR-1$_{i+2}$)\end{tabular}       & 28          & \begin{tabular}[c]{@{}l@{}}\textcolor{BlueViolet}{$\textbf{M}_\textbf{8}$}/\textcolor{ForestGreen}{$\textbf{M}_\textbf{3}$} ,\\ \textcolor{Emerald}{$\textbf{M}_\textbf{5}$}/\textcolor{VioletRed}{$\textbf{M}_\textbf{1}$}/\textcolor{BurntOrange}{$\textbf{M}_\textbf{4}$} \end{tabular} \\ \midrule
$s=3$ & \{ (SLP-0$_i$, SLP-0$_{i+2}$, \textit{wg}-1$_{i+1}$) \} = X                                          & 52          & \textcolor{ProcessBlue}{$\textbf{M}_\textbf{7}$}/\textcolor{Red}{$\textbf{M}_\textbf{6}$}/\textcolor{BurntOrange}{$\textbf{M}_\textbf{4}$}                                                     \\ \midrule
$s=4$ & \begin{tabular}[c]{@{}l@{}}\{ (X + \textit{en}-1$_{i+1}$), \\ (X + \textit{en}-1$_{i+3}$)  \} = Y\end{tabular}           & 56          & \begin{tabular}[c]{@{}l@{}}\textcolor{BlueViolet}{$\textbf{M}_\textbf{8}$/$\textbf{M}_{\textbf{10}}$}/\textcolor{Red}{$\textbf{M}_\textbf{6}$}, \\ \textcolor{BlueViolet}{$\textbf{M}_\textbf{8}$/$\textbf{M}_{\textbf{10}}$}/\textcolor{Red}{$\textbf{M}_\textbf{6}$} \end{tabular}    \\ \midrule
$s=5$ & \begin{tabular}[c]{@{}l@{}}\{ (SLP-1$_i$, SLP-1$_{i+1}$, SLP-0$_{i+2}$, \textit{wg}-1$_{i+3}$, \textit{en}-1$_{i+3}$),\\ (SLP-1$_i$, SLP-1$_{i+1}$, SLP-0$_{i+3}$, \textit{wg}-1$_{i+2}$, \textit{en}-1$_{i+2}$),\\ (Y + SLP\_1$_{i+3}$),\\ (Y + SLP\_0$_{i+3}$),\\ (SLP-0$_i$, SLP-0$_{i+1}$, SLP-1$_{i+2}$, \textit{wg}-1$_{i+3}$, \textit{en}-1$_{i+3}$),\\ (SLP-0$_i$, SLP-0$_{i+1}$, SLP-1$_{i+3}$, \textit{wg}-1$_{i+2}$, \textit{en}-1$_{i+2}$) \} = Z\end{tabular} & 59          & \begin{tabular}[c]{@{}l@{}}\textcolor{BlueViolet}{$\textbf{M}_\textbf{8}$/$\textbf{M}_{\textbf{10}}$}/\textcolor{Red}{$\textbf{M}_\textbf{6}$} \\ ... \end{tabular}            \\ \midrule
$s=6$ & \begin{tabular}[c]{@{}l@{}}(Z + SLP-0$_j$),\\ (Z + SLP-1$_j$) \\ (\textit{en}-1$_i$, PTC-0$_{i+2}$, SLP-0$_i$, SLP-0$_{i+1}$, SLP-1$_{i+2}$, SLP-1$_{i+3}$) \\
(\textit{en}-1$_i$, PTC-0$_{i+2}$, SLP-0$_i$, SLP-1$_{i+1}$, SLP-1$_{i+2}$, SLP-0$_{i+3}$) \\
(\textit{en}-1$_i$, PTC-0$_{i+2}$, SLP-0$_i$, SLP-0$_{i+1}$, SLP-1$_{i+2}$, SLP-0$_{i+3}$)    \end{tabular}                   

& 60          & \begin{tabular}[c]{@{}l@{}} \textcolor{BlueViolet}{$\textbf{M}_\textbf{8}$/$\textbf{M}_{\textbf{10}}$}/\textcolor{Red}{$\textbf{M}_\textbf{6}$} \\ ... \\ \textcolor{BlueViolet}{$\textbf{M}_{\textbf{10}}$}/\textcolor{Red}{$\textbf{M}_\textbf{6}$}/\textcolor{RedOrange}{$\textbf{M}_\textbf{9}$} \end{tabular}  \\ \bottomrule                                
\end{tabular}
\caption{\textbf{Maximal modules in the \textit{drosophila} parasegment SPN.}  The seed set $S_i^0$ and size $|S_i|$ of the maximal 
pathway module per seed set size $s=|S_i^0|$ are shown, along with the associated intracellular 
complex modules 
found within the maximal module.  Here, $\textbf{M}_1$ indicates $\textbf{M}_{nWG-0}$; $\textbf{M}_2$ indicates $\textbf{M}_{en-1}$; $\textbf{M}_3$ indicates $\textbf{M}_{nHH-1}$; $\textbf{M}_4$ indicates $\textbf{M}_{nHH-0}$; $\textbf{M}_5$ indicates $\textbf{M}_{CIR-1}$; $\textbf{M}_6$ indicates $\textbf{M}_{SLP-1,nHH-1}$; $\textbf{M}_7$ indicates $\textbf{M}_{SLP-0,nWG-1}$; $\textbf{M}_8$ indicates $\textbf{M}_{nHH-1,en-1}$; $\textbf{M}_9$ indicates $\textbf{M}_{PTC-0}$; finally, $\textbf{M}_{10}$ indicates $\textbf{M}_{SLP-0,nWG-1,nHH-1}$.
For $s=5$, all maximal %seeds 
pathway modules have the same associated 
intracellular modules; for $s=6$, the first two groupings of seed sets have associated modules $\textbf{M}_8$, $\textbf{M}_{10}$, and $\textbf{M}_6$, while the latter three groupings have associated modules $\textbf{M}_{10}$, $\textbf{M}_{6}$, and $\textbf{M}_9$.
The subscript 
on the s-unit labels
denotes the cell of the parasegment where $i$ and $j$ are arbitrary cells chosen such that there is no logical contradiction between variable states and cellular addition uses modular arithmetic.  As maximal modules with larger seed sets tend to build on the same 
set of 
modules with smaller seed sets, particular seed sets are condensed to variables for readability.  Given the periodic boundaries of the parasegment and the similarity of complex modules, a significant degree of 
%permutation redundancy can be seen in the maximal modules.
redundancy in regards to cellular indices can be seen in the maximal module sets.
A seed set of size $s \geq 6$ is needed to resolve every variable in the network.}
\label{tab:parasegment_maximal_modules}
\end{table}


\begin{figure}
\begin{adjustwidth}{-2cm}{}
\centering
\includegraphics[width=1.4\columnwidth]{Figures/parasegment_unfolding_minimal_schemata.pdf}
\caption{\textbf{Minimal schemata 
%for convergence with pinning perturbation.} 
for attractor control in the \textit{drosophila} parasegment SPN.}
(a) One of the minimal schemata found to reach an attractor, representing the minimal seeds sufficient to %resolve that attractor
drive the dynamics to that attractor with pinning control.  
Each row represents a cell in the \textit{drosophila} parasegment and each column the state of the respective node: black represents ON, white represents OFF, and grey represents a wildcard %input (its 
value (i.e., the node
state is redundant for convergence 
to the attractor
under pinning perturbation of the %enputs).
seeds).
The color of the row label represents the main module group active in that cell during unfolding (pink represents $\Sigma_1$, red represents $\Sigma_3$, and violet represents $\Sigma_4$,
see Table \ref{tab:drosophila_modules}). 
(b) Same as panel a, but for the minimal schema sufficient to reach the wildtype attractor.  The minimal configurations found are much smaller than the previous estimates without pinning perturbation found in \cite{marques2013canalization}.}
\label{fig:minimal_schemata}
\end{adjustwidth}
\end{figure}


\begin{figure}
\begin{adjustwidth}{-2cm}{}
\centering
\includegraphics[width=1.4\columnwidth]{Figures/parasegment_unfolding_minimal_attractor.pdf}
\caption{\textbf{Dynamical unfolding of a minimal seed set to reach an attractor
in the \textit{drosophila} parasegment SPN.}  
Cell boundaries are separated by a blue line; white indicates that a node is OFF in that time step, black indicates that a node is ON, and grey indicates that the node's state is unknown.  The color of the node label indicates the associated complex module.  All four SLP inputs are pinned; additionally, \textit{wg} and \textit{en} are ON in the first cell.  $\textbf{M}_{en-1}$ unfolds in cell 1, and \textit{wg}-1 initiates $\textbf{M}_{SLP-0,nWG-1}$ in cell 2 by acting as an input along with SLP-0.  This turns on HH in both cells which extends the unfolding in each cell via additional synergy (modules $\textbf{M}_{en-1,nHH-1}$ and $\textbf{M}_{SLP-0,nWG-1,nHH-1}$, labeled as violet).  It also extends the unfolding of $\textbf{M}_{SLP-1}$ in cells 3 and 4 (module $\textbf{M}_{SLP-1,nHH-1}$, labeled as red).
This final configuration is in the basin of attraction of the broad stripes attractor \cite{albert2003topology}, and the network will reach this attractor once the seeds \textit{wg} and \textit{en} in cell 1 are no longer pinned.
%Similarly, all node states could be resolved by pinning either \textit{wg}-1 or \textit{en}-1 separately in cells 1 and 2, although the attractors are slightly different as the states of \textit{wg} and WG change.
%Note that \textit{wg-1} and WG-1 are associated with the \textit{red} module even though the module is not active in cell 1.}
}
\label{fig:minimal_unfolding}
\end{adjustwidth}
\end{figure}


\begin{figure}
%\begin{adjustwidth}{-4cm}{}
\centering
%[max size={20cm}{8cm}]
\includegraphics[width=1.1\columnwidth]{Figures/parasegment_wildtype_unfolding2.pdf}
%\captionsetup{width=\linewidth}
\caption{\textbf{Dynamical unfolding of the wildtype attractor in the \textit{drosophila} parasegment SPN.} 
%Refer to the caption of Fig.~6 in the main text for more details.
This figure is the same as Fig.~6 in the main text except that the full unfolding of the minimal seed set to the wildtype attractor is shown in terms of intracellular complex modules.
%The minimal pinning perturbation that was found sufficient to fully resolve the wildtype attractor is shown.  Cell boundaries are separated by a blue line; white indicates that a node is OFF in that time step, black indicates that a node is ON, and grey indicates that the node state is unknown.  The color of the node label indicates an associated complex module.  
%Select modules are highlighted in the dynamical unfolding process by colored borders. Arrows indicate the initiation of a new module; arrows pointing to the side or upwards indicate that the respective s-unit is initiating a module in a neighboring cell.
%The full unfolding of the minimal seed set to the wildtype attractor is shown in terms of intracellular modules.
$\textbf{M}_{SLP-0}$ is present in cell 1 based on initial conditions (blue arrow).  The influence of WG-1 in cell 4 (blue arrow) initiates $\textbf{M}_{SLP-0, nWG-1}$ in cell 1 (shown by blue borders). This module turns on \textit{hh} and HH which initiates $\textbf{M}_{nHH-1}$ in cell 2 (shown in green) and then turns off WG in cell 1 which, together with WG-0 in cell 3 (indicated by red arrows), initiates $\textbf{M}_{nWG-0}$ in cell 2; the synergy between $\textbf{M}_{nHH-1}$ and $\textbf{M}_{nWG-0}$ results in $\textbf{M}_{nHH-1, nWG-0}$ in cell 2 
(which subsumes both %individual 
modules and is shown by red borders).
Based on initial conditions, $\textbf{M}_{PTC-0}$ is also present in cell 1, $\textbf{M}_{SLP-0}$ and $\textbf{M}_{wg-0}$ are present in cell 2, $\textbf{M}_{SLP-1}$ 
%(shown by pink borders) 
and $\textbf{M}_{CIR-1}$ 
%(shown by turquoise borders) 
are present in cell 3, and $\textbf{M}_{SLP-1}$ and $\textbf{M}_{wg-1}$ are present in cell 4.  $\textbf{M}_{SLP-1}$ in cell 4 (shown by pink borders) turns off \textit{hh} and HH which, together with \textit{hh}-0 and HH-0 in cell 2 (indicated by brown arrows), initiates $\textbf{M}_{nHH-0}$ in cell 3, which is subsumed by $\textbf{M}_{nHH-0,PTC-1}$ (shown by brown borders).  Finally, the presence of \textit{hh}-1 and HH-1 in cell 1 initiates $\textbf{M}_{nHH-1}$  in cell 4 
%(indicated by red arrows)
, which is subsumed by $\textbf{M}_{SLP-1,nHH-1}$ (shown in red). 
}
\label{fig:wildtype_unfolding_full}
%\end{adjustwidth}
\end{figure}
%see also fig:wildtype_unfolding


\pagebreak

\section{\textit{Drosophila} Observability and Control}

The single-cell SPN is small enough that the attractors of the network can be fully enumerated.  Analysis of the dynamical activity within each of the 10 attractors corresponds well with the analysis of complex modules, as each attractor can be associated with one or more modules (Table \ref{tab:control_sets}).
The $\Sigma_4$ module $\textbf{M}_{SLP-0,nWG-1,nHH-1}$ is seen in only one attractor as it requires an AND condition between all three inputs, resulting in the driver set (SLP=0, nWG=1, nHH=1).
The $\Sigma_3$ modules, $\textbf{M}_{SLP-1,nHH-1}$ and $\textbf{M}_{nWG-0,nHH-1}$, are seen in four attractors: the former module resolves every variable except for the input nWG and therefore leads to two attractors depending on the state of this input with driver sets (SLP=1, nWG=1, nHH=1) and (SLP=1, nWG=0, nHH=1); the latter module resolves every variable except for SLP, \textit{wg}, and WG and can lead to three attractors, with driver sets (SLP=1, nWG=0, nHH=1) (seen above), (SLP=0, nWG=0, nHH=1, \textit{wg}=0), and (SLP=0, nWG=0, nHH=1, \textit{wg}=1).
The modules $\textbf{M}_{SLP-1,nHH-0,PTC-1}$ and $\textbf{M}_{nWG-0,nHH-0,PTC-1}$ are identical except for their seeds and lead to three attractors, as both modules resolve every variable state except for the missing input 
(which my be in either state)
\footnote{These are complex modules but not core complex modules as PTC is not a  maximal seed (because $\textbf{M}_{ptc-1}$ subsumes $\textbf{M}_{PTC-1}$).}.  The driver sets for the three attractors are therefore (SLP=1, nWG=0, nHH=0, PTC=1), (SLP=1, nWG=1, nHH=0, PTC=1), and (SLP=0, nWG=0, nHH=0, PTC=1).
The final two attractors require $\textbf{M}_{SLP-0,nWG-1}$ in combination with other modules; one requires $\textbf{M}_{nHH-0}$ and $\textbf{M}_{PTC-0}$, while the other requires $\textbf{M}_{nHH-0,PTC-1}$ (note that there is synergy between nHH-0 and PTC-1 and that this module is also a submodule of $\textbf{M}_{SLP-1,nHH-0,PTC-1}$ and $\textbf{M}_{nWG-0,nHH-0,PTC-1}$, meaning that it appears in four attractors).
The driver sets for these two attractors are therefore (SLP=0, nWG=1, nHH=0, PTC=0) and (SLP=0, nWG=1, nHH=0, PTC=1).
Interestingly, the superset of the nodes associated with the minimal driver sets found via this methodology are the same driver nodes predicted by feedback vertex set theory (inputs SLP, nWG, nHH and internal nodes PTC and \textit{wg}).

%The $\Sigma_4$ module $\textbf{M}_{SLP-0,nWG-1,nHH-1}$ is seen in only one attractor as it requires an AND condition between all three inputs, resulting in the driver set (SLP$=0$, nWG$=1$, nHH$=1$).
%The $\Sigma_3$ modules, $\textbf{M}_{SLP-1,nHH-1}$ and $\textbf{M}_{nWG-0,nHH-1}$, are seen in four attractors: the former module resolves every variable except for the input nWG and therefore leads to two attractors depending on the state of this input with driver sets (SLP$=1$, nWG$=1$, nHH$=1$) and (SLP$=1$, nWG$=0$, nHH$=1$); the latter module resolves every variable except for SLP, \textit{wg}, and WG and can lead to three attractors, with driver sets (SLP$=1$, nWG$=0$, nHH$=1$) (seen above), (SLP$=0$, nWG$=0$, nHH$=1$, \textit{wg}$=0$), and (SLP$=0$, nWG$=0$, nHH$=1$, \textit{wg}$=1$).
%The modules $\textbf{M}_{SLP-1,nHH-0,PTC-1}$ and $\textbf{M}_{nWG-0,nHH-0,PTC-1}$ are identical except for their seeds and lead to three attractors, as both modules resolve every variable state except for the missing input \footnote{These are complex modules but not core complex modules as PTC is not a  maximal seed (because $\textbf{M}_{ptc-1}$ subsumes $\textbf{M}_{PTC-1}$).}.  The driver sets for the three attractors are therefore (SLP$=1$, nWG$=0$, nHH$=0$, PTC$=1$), (SLP$=1$, nWG$=1$, nHH$=0$, PTC$=1$), and (SLP$=0$, nWG$=0$, nHH$=0$, PTC$=1$).
%The final two attractors require $\textbf{M}_{SLP-0,nWG-1}$ in combination with other modules; one requires $\textbf{M}_{nHH-0}$ and $\textbf{M}_{PTC-0}$, while the other requires $\textbf{M}_{nHH-0,PTC-1}$ (note that there is synergy between nHH-0 and PTC-1 and that this module is also a submodule of $\textbf{M}_{SLP-1,nHH-0,PTC-1}$ and $\textbf{M}_{nWG-0,nHH-0,PTC-1}$, meaning that it appears in four attractors).

The characterization of dynamical modules here highlights the difference between the driver node set with pinning and pulse perturbation control.  If %an input 
a driver node's state must be constant, as with pinning perturbations, PTC and \textit{wg} are needed to fully control the network.  However, if one is allowed to flip the states of the input variables, then no internal nodes need to be pinned.  
For example, to reach the attractor that requires $\textbf{M}_{SLP-0,nWG-1}$, $\textbf{M}_{nHH-0}$, and $\textbf{M}_{PTC-0}$, the module $\textbf{M}_{SLP-0,nWG-1,nHH-1}$ can be used which turns off PTC (and maintains PTC in the OFF state), and nHH can then be switched OFF to reach the attractor.
Furthermore, modules $\textbf{M}_{SLP-1,nHH-1}$ and $\textbf{M}_{nWG-0,nHH-1}$ turn off \textit{ptc}; if the state of nHH is then flipped, the module $\textbf{M}_{nHH-0,PTC-1}$ will unfold, as is seen in four attractors.
In general, perturbing nHH along with the other input
nodes replaces the need to control PTC as nHH is an input to PTC.  Perturbing the internal node \textit{wg}, meanwhile, allows to turn on or off \textit{wg} and WG, when SLP=0, nWG=0, and nHH=1.
However, SLP can also be turned ON 
%with pulse perturbation control 
after $\textbf{M}_{nWG-0,nHH-1}$ unfolds to turn on \textit{wg} and WG and then turned OFF.  Alternatively, SLP can be turned OFF while nWG and nHH are ON to initiate $\textbf{M}_{SLP-0,nWG-1,nHH-1}$, which turns off \textit{wg} and WG; then nWG can be flipped to initiate $\textbf{M}_{nWG-0,nHH-1}$.  Therefore, perturbing SLP and nWG replaces the need to control \textit{wg}.  In a sense, pinning the internal nodes then is just a shortcut to replace the need for input 
node perturbations.  This highlights the usefulness of %dynamical modularity 
complex modules
in developing a qualitative understanding of control in a system.

Perhaps unsurprisingly, the same intracellular modules that lead to attractors in the single-cell SPN lead to attractors in the parasegment SPN, when considering six biologically-relevant attractors from \cite{albert2003topology}.
In particular, $\textbf{M}_{SLP-0,nWG-1}$, $\textbf{M}_{nWG-0,nHH-1}$, $\textbf{M}_{SLP-1,nHH-1}$, and $\textbf{M}_{SLP-1,nHH-0,PTC-1}$ each play a significant role, appearing in at least four of the attractors
(see Table \ref{tab:control_sets_parasegment}).

The logical inferences made during the dynamical unfolding process are also useful in the problem of observability.  If a network has reached a fixed point, then each variable state is unchanging (i.e., pinned); thus, observing a set of sensor nodes with corresponding s-units $S_i^0$ guarantees that the module $\textbf{M}_{S_i^0}$ has fully unfolded and all the variable states contained in $S_i$ are present in the current state of the  network.  Observing only a small subset of such states (2-3 in the case of the \textit{drosophila} single-cell SPN, equivalent to less than $18\%$ of the network size) is sufficient to figure out which attractor the network is in.  The size of this minimal observability set is naturally upper-bounded by the size of the minimal driver set.
For the \textit{drosophila} parasegment SPN, the minimal observability sets require only two s-units ($3\%$ of the network size) when considering only the six biologically-relevant attractors in Table \ref{tab:control_sets_parasegment}.


%single-cell control
\begin{table}[]
\begin{adjustwidth}{-3cm}{}
\centering
\resizebox{1.5\columnwidth}{!}{%
\begin{tabular}{llcc} \toprule
Attractor         & 
%\begin{tabular}[c]{@{}l@{}} Minimal observability \\ sets\end{tabular}         
Minimal observability sets & 
%\begin{tabular}[c]{@{}l@{}} Minimal control\\ set\end{tabular} 
Minimal control set & Associated modules \\ \midrule
11100001111111010 & \begin{tabular}[c]{@{}l@{}}\{ (nHH-1, SLP-1, nWG-0),\\ (SLP-1, \textit{ptc-1}, nWG-0),\\ (\textit{wg-1}, SLP-1, nWG-0),\\ (SLP-1, nWG-0, WG-1),\\ (CIR-0, SLP-1, nWG-0),\\ (SLP-1, nWG-0, CIA-1),\\ (SLP-1, nWG-0, PH-1),\\ (SLP-1, SMO-1, nWG-0) \}\end{tabular}                           & (nHH-1, SLP-1, nWG-0)                                         & \textcolor{Red}{$\textbf{M}_{\textbf{6}}$,$\textbf{M}_{\textbf{11}}$}                \\ \midrule
01100001111111010 & 
%\begin{tabular}[c]{@{}l@{}}\{ (\textit{wg-1}, SLP-0),\\ (SLP-0, WG-1) \}\end{tabular}
\{(\textit{wg}-1, SLP-0), (SLP-0, WG-1)\}
& (nHH-1, nWG-0, \textit{wg-1}, SLP-0)                                   & \textcolor{Red}{$\textbf{M}_{\textbf{11}}$},\textcolor{RedViolet}{$\textbf{M}_{\textbf{wg-1}}$},\textcolor{gray}{$\textbf{M}_{\textbf{SLP-0}}$}                \\ \midrule
11100001111111011 & \begin{tabular}[c]{@{}l@{}}\{ (nWG-1, \textit{wg-1}), (\textit{ptc-1}, nWG-1),\\ (nWG-1, PH-1), (nWG-1, CIA-1),\\ (nWG-1, WG-1) \}\end{tabular}                      & (nHH-1, nWG-1, SLP-1)                                         & \textcolor{Red}{$\textbf{M}_{\textbf{6}}$},\textcolor{gray}{$\textbf{M}_{\textbf{nWG-1}}$}                \\ \midrule
00011110001000011 & \begin{tabular}[c]{@{}l@{}}\{ (nHH-1, PTC-0), (nHH-1, \textit{en-1}),\\ (EN-1, nHH-1), (nHH-1, \textit{ci-0}),\\ (CI-0, nHH-1), (nHH-1, CIA-0),\\ (nHH-1, \textit{ptc-0}), (nHH-1, \textit{hh-1}),\\ (HH-1, nHH-1), (nHH-1, PH-0) \}\end{tabular}                                                   & (nHH-1, nWG-1, SLP-0)                                         & \textcolor{BlueViolet}{$\textbf{M}_{\textbf{10}}$}             \\ \midrule
10000000100110101 & \{(CIR-1, nWG-1)\}                                      & (SLP-1, nHH-0, PTC-1, nWG-1)                                  & \textcolor{Bittersweet}{$\textbf{M}_{\textbf{13}}$},\textcolor{gray}{$\textbf{M}_{\textbf{nWG-1}}$} %Tan
%(\textcolor{pink}{$M_{1s}$}, \textcolor{RawSienna}{$M_9$})       
\\ \midrule
00011110001000001 & 
%\begin{tabular}[c]{@{}l@{}}\{ (nHH-0, PTC-0),\\ (SMO-1, nHH-0) \}\end{tabular}
\{(nHH-0, PTC-0), (SMO-1, nHH-0)\}
& (nWG-1, PTC-0, nHH-0, SLP-0)                                  & \textcolor{ProcessBlue}{$\textbf{M}_\textbf{7}$}, \textcolor{RedOrange}{$\textbf{M}_{\textbf{9}}$}, \textcolor{BurntOrange}{$\textbf{M}_\textbf{4}$}  %Dandelion
\\ \midrule
00000001111111010 & \begin{tabular}[c]{@{}l@{}}\{ (\textit{wg-0}, \textit{ptc-1}), (\textit{ptc-1}, WG-0),\\ (\textit{wg-0}, PH-1), (\textit{wg-0}, CIA-1),\\ (WG-0, PH-1), (WG-0, CIA-1) \}\end{tabular}                                                & (nWG-0, nHH-1, SLP-0, \textit{wg-0})                                   & \textcolor{Red}{$\textbf{M}_{\textbf{11}}$},\textcolor{RedViolet}{$\textbf{M}_{\textbf{wg-0}}$},\textcolor{gray}{$\textbf{M}_{\textbf{SLP-0}}$}                \\ \midrule
00011110100000001 & \begin{tabular}[c]{@{}l@{}}\{ (PTC-1, \textit{en-1}),  (SMO-0, \textit{en-1}),\\ (SMO-0, EN-1), (PTC-1, EN-1),\\ (PTC-1, \textit{ci-0}), (SMO-0, \textit{ci-0}),\\ (CI-0, SMO-0), (PTC-1, CI-0),\\ (PTC-1, \textit{hh-1}), (SMO-0, \textit{hh-1}),\\ (PTC-1, HH-1), (CIR-0, SMO-0),\\ (HH-1, SMO-0) \}\end{tabular} & (nWG-1, PTC-1, SLP-0, nHH-0)                                  & \textcolor{ProcessBlue}{$\textbf{M}_\textbf{7}$}, \textcolor{RawSienna}{$\textbf{M}_{\textbf{12}}$}        \\ \midrule
00000000100110100 & \{(CIR-1, SLP-0)\}                                           & (nWG-0, nHH-0, PTC-1, SLP-0)              &  \textcolor{Bittersweet}{$\textbf{M}_{\textbf{14}}$},\textcolor{gray}{$\textbf{M}_{\textbf{SLP-0}}$}   %Tan
%(\textcolor{pink}{$M_1$}, \textcolor{RawSienna}{$M_9$})        
\\ \midrule
10000000100110100 & \begin{tabular}[c]{@{}l@{}}\{ (nWG-0, SLP-1, \textit{wg-0}),\\ (nWG-0, nHH-0, SLP-1),\\ (CIR-1, SLP-1, nWG-0),\\ (SLP-1, nWG-0, CIA-0),\\ (SLP-1, SMO-0, nWG-0),\\ (SLP-1, nWG-0, WG-0),\\ (SLP-1, nWG-0, PH-0),\\ (SLP-1, \textit{ptc-0}, nWG-0) \}\end{tabular}                           & (SLP-1, nWG-0, nHH-0, PTC-1)      &  \textcolor{Bittersweet}{$\textbf{M}_{\textbf{13}}$,$\textbf{M}_{\textbf{14}}$} %Tan
%(\textcolor{pink}{$M_{1s}$}, \textcolor{RawSienna}{$M_9$})  
\\ \bottomrule     
\end{tabular} }
\caption{\textbf{Minimal observability and control sets for the \textit{drosophila} single-cell SPN.}  
%Observability sets only require two or three sensor nodes to reveal the given attractor.  The superset of the nodes represented by the minimal control sets are the same driver nodes predicted by FVS (inputs SLP, nWG, nHH and internal nodes PTC and \textit{wg}).  PTC is important for initiating $M_9$ and complementing $M_7$; \textit{wg} is important for complementing $M_6$ (when SLP is OFF).
The attractors label the node states in order of SLP, \textit{wg}, WG, \textit{en}, EN, \textit{hh}, HH, \textit{ptc}, PTC, PH, SMO, \textit{ci}, CI, CIA, CIR, nHH, nWG.
The associated complex modules are colored to correspond to Table \ref{tab:drosophila_modules}.
Here, 
%$\textbf{M}_1$ indicates $\textbf{M}_{nWG-0}$; $\textbf{M}_2$ indicates $\textbf{M}_{en-1}$; $\textbf{M}_3$ indicates $\textbf{M}_{nHH-1}$; 
$\textbf{M}_4$ indicates $\textbf{M}_{nHH-0}$; 
%$\textbf{M}_5$ indicates $\textbf{M}_{CIR-1}$; 
$\textbf{M}_6$ indicates $\textbf{M}_{SLP-1,nHH-1}$; $\textbf{M}_7$ indicates $\textbf{M}_{SLP-0,nWG-1}$; 
%$\textbf{M}_8$ indicates $\textbf{M}_{nHH-1,en-1}$; 
$\textbf{M}_9$ indicates $\textbf{M}_{PTC-0}$, $\textbf{M}_{10}$ indicates $\textbf{M}_{SLP-0,nWG-1,nHH-1}$,
$\textbf{M}_{11}$ indicates $\textbf{M}_{nWG-0,nHH-1}$, $\textbf{M}_{12}$ indicates $\textbf{M}_{nHH-0,PTC-1}$, $\textbf{M}_{13}$ indicates $\textbf{M}_{SLP-1,nHH-0,PTC-1}$; finally, $\textbf{M}_{14}$ indicates $\textbf{M}_{nWG-0,nHH-0,PTC-1}$.
}
\label{tab:control_sets}
\end{adjustwidth}
\end{table}


\begin{table}[]
\begin{adjustwidth}{-3cm}{}
\centering
\resizebox{1.5\textwidth}{!}{%
\begin{tabular}{llll} \toprule
Attractor         & Expressed nodes                                                  & Minimal observability sets                                                    & Associated modules                                                                                 \\ \midrule
Wild-type         & %\begin{tabular}[c]{@{}l@{}}(\textit{wg\_4}; WG\_4; \textit{en\_1}; EN\_1; \textit{hh\_1}; \\ HH\_1; \textit{ptc\_2,4};  PTC\_2,3,4; \textit{ci\_2,3,4}; \\ CI\_2,3,4; CIA\_2,4; CIR\_3)\end{tabular} & \begin{tabular}[c]{@{}l@{}}\{ (CIR\_P3-1, PTC\_P1-0),\\ (PTC\_P1-0, \textit{ptc\_P2-1}),\\ (CIA\_P2-1, PTC\_P1-0),\\ (PH\_P2-1, PTC\_P1-0),\\ (PTC\_P1-0, SMO\_P3-0) \}\end{tabular}
\begin{tabular}[c]{@{}l@{}}(\textit{wg}$_4$; WG$_4$; \textit{en}$_1$; EN$_1$; \textit{hh}$_1$; \\ HH$_1$; \textit{ptc}$_{2,4}$;  PTC$_{2,3,4}$; \textit{ci}$_{2,3,4}$; \\ CI$_{2,3,4}$; CIA$_{2,4}$; CIR$_3$)\end{tabular} & \begin{tabular}[c]{@{}l@{}}\{ (CIR$_3$-1, PTC$_1$-0),\\ (PTC$_1$-0, \textit{ptc}$_2$-1),\\ (CIA$_2$-1, PTC$_1$-0),\\ (PH$_2$-1, PTC$_1$-0),\\ (PTC$_1$-0, SMO$_3$-0) \}\end{tabular}      
& \begin{tabular}[c]{@{}l@{}}\textcolor{ProcessBlue}{$\textbf{M}_\textbf{7}$}/\textcolor{RedOrange}{$\textbf{M}_{\textbf{9}}$},\\   \textcolor{Red}{$\textbf{M}_{\textbf{11}}$},\\  \textcolor{Bittersweet}{$\textbf{M}_{\textbf{13}}$} %Tan
%(\textcolor{pink}{$M_{1s}$}/\textcolor{RawSienna}{$M_9$}),
\\   \textcolor{Red}{$\textbf{M}_{\textbf{6}}$}\end{tabular}       \\ \midrule

Broad stripes     & 
%\begin{tabular}[c]{@{}l@{}}(\textit{wg\_3,4}; WG\_3,4; \textit{en\_1,2}; EN\_1,2; \\ \textit{hh\_1,2}; HH\_1,2; \textit{ptc\_3,4}; PTC\_3,4; \\ \textit{ci\_3,4}; CI\_3,4; CIA\_3,4)\end{tabular}    & \begin{tabular}[c]{@{}l@{}}\{ (\textit{en\_P1-1}, \textit{en\_P2-1}),\\ (\textit{en\_P2-1}, \textit{ptc\_P4-1}),\\ (\textit{en\_P1-1}, \textit{ptc\_P3-1}),\\ (\textit{en\_P1-1}, \textit{wg\_P3-1}),\\ (\textit{wg\_P4-1}, \textit{en\_P2-1}) \}\end{tabular}   
\begin{tabular}[c]{@{}l@{}}(\textit{wg}$_{3,4}$; WG$_{3,4}$; \textit{en}$_{1,2}$; EN$_{1,2}$; \\ \textit{hh}$_{1,2}$; HH$_{1,2}$; \textit{ptc}$_{3,4}$; PTC$_{3,4}$; \\ \textit{ci}$_{3,4}$; CI$_{3,4}$; CIA$_{3,4}$)\end{tabular}    & \begin{tabular}[c]{@{}l@{}}\{ (\textit{en}$_1$-1, \textit{en}$_2$-1),\\ (\textit{en}$_2$-1, \textit{ptc}$_4$-1),\\ (\textit{en}$_1$-1, \textit{ptc}$_3$-1),\\ (\textit{en}$_1$-1, \textit{wg}$_3$-1),\\ (\textit{wg}$_4$-1, \textit{en}$_2$-1) \}\end{tabular}

& \begin{tabular}[c]{@{}l@{}}\textcolor{BlueViolet}{$\textbf{M}_{\textbf{10}}$},\\   \textcolor{BlueViolet}{$\textbf{M}_{\textbf{10}}$},\\   \textcolor{Red}{$\textbf{M}_{\textbf{6}}$},\\   \textcolor{Red}{$\textbf{M}_{\textbf{6}}$}\end{tabular}     \\ \midrule

No segmentation   & %\begin{tabular}[c]{@{}l@{}}(\textit{ci\_1,2,3,4}; CI\_1,2,3,4; \\ PTC\_1,2,3,4; CIR\_1,2,3,4)\end{tabular}                                                       & \begin{tabular}[c]{@{}l@{}}\{ (CIR\_P2-1, CIR\_P4-1),\\ (CIR\_P3-1, CIR\_P1-1),\\ (SLP\_P3-1, CIR\_P1-1),\\ (SLP\_P4-1, CIR\_P2-1),\\ (SLP\_P3-1, CIR\_P2-1),\\ (SLP\_P4-1, CIR\_P1-1) \}\end{tabular}
\begin{tabular}[c]{@{}l@{}}(\textit{ci}$_{1,2,3,4}$; CI$_{1,2,3,4}$; \\ PTC$_{1,2,3,4}$; CIR$_{1,2,3,4}$)\end{tabular}                                                       & \begin{tabular}[c]{@{}l@{}}\{ (CIR$_2$-1, CIR$_4$-1),\\ (CIR$_3$-1, CIR$_1$-1),\\ (SLP$_3$-1, CIR$_1$-1),\\ (SLP$_4$-1, CIR$_2$-1),\\ (SLP$_3$-1, CIR$_2$-1),\\ (SLP$_4$-1, CIR$_1$-1) \}\end{tabular}

& \begin{tabular}[c]{@{}l@{}} \textcolor{Bittersweet}{$\textbf{M}_{\textbf{14}}$} %(\textcolor{pink} %Tan {$M_1$}/\textcolor{RawSienna}{$M_9$}),
\\ \textcolor{Bittersweet}{$\textbf{M}_{\textbf{14}}$} 
%(\textcolor{pink}{$M_1$}/\textcolor{RawSienna}{$M_9$}),
\\ \textcolor{Bittersweet}{$\textbf{M}_{\textbf{13}}$}
%(\textcolor{pink}{$M_{1s}$}/\textcolor{RawSienna}{$M_9$}),
\\ \textcolor{Bittersweet}{$\textbf{M}_{\textbf{13}}$}
%(\textcolor{pink}{$M_{1s}$}/\textcolor{RawSienna}{$M_9$}) 
\end{tabular} \\ \midrule 

Wild-type variant & %\begin{tabular}[c]{@{}l@{}}(\textit{wg\_4}; WG\_4; \textit{en\_1}; EN\_1; \textit{hh\_1}; \\ HH\_1; \textit{ptc\_2,4}; PTC\_1,2,3,4; \\ \textit{ci\_2,3,4}; CI\_2,3,4; CIA\_2,4; CIR\_3)\end{tabular}  & \begin{tabular}[c]{@{}l@{}}\{ (\textit{en\_P1-1}, SMO\_P1-0),\\ (SMO\_P1-0, \textit{ptc\_P4-1}),\\ (SMO\_P1-0, \textit{ptc\_P2-1}),\\ (\textit{wg\_P4-1}, SMO\_P1-0) \}\end{tabular}                
\begin{tabular}[c]{@{}l@{}}(\textit{wg}$_4$; WG$_4$; \textit{en}$_1$; EN$_1$; \textit{hh}$_1$; \\ HH$_1$; \textit{ptc}$_{2,4}$; PTC$_{1,2,3,4}$; \\ \textit{ci}$_{2,3,4}$; CI$_{2,3,4}$; CIA$_{2,4}$; CIR$_3$)\end{tabular}  & \begin{tabular}[c]{@{}l@{}}\{ (\textit{en}$_1$-1, SMO$_1$-0),\\ (SMO$_1$-0, \textit{ptc}$_4$-1),\\ (SMO$_1$-0, \textit{ptc}$_2$-1),\\ (\textit{wg}$_4$-1, SMO$_1$-0) \}\end{tabular} 

& \begin{tabular}[c]{@{}l@{}}\textcolor{ProcessBlue}{$\textbf{M}_\textbf{7}$}/\textcolor{RawSienna}{$\textbf{M}_{\textbf{12}}$},\\   \textcolor{Red}{$\textbf{M}_{\textbf{11}}$},\\  \textcolor{Bittersweet}{$\textbf{M}_{\textbf{13}}$} %Tan
%(\textcolor{pink} {$M_{1s}$}/\textcolor{RawSienna}{$M_9$}),
\\   \textcolor{Red}{$\textbf{M}_{\textbf{6}}$}\end{tabular}               \\ \midrule

Ectopic           & 
%\begin{tabular}[c]{@{}l@{}}(\textit{wg\_3}; WG\_3; \textit{en\_2}; EN\_2; \textit{hh\_2}; \\ HH\_2; \textit{ptc\_1,3}; PTC\_1,3,4; \textit{ci\_1,3,4}; \\ CI\_1,3,4; CIA\_1,3; CIR\_4)\end{tabular}    & \begin{tabular}[c]{@{}l@{}}\{ (CIR\_P4-1, PTC\_P2-0),\\ (\textit{ptc\_P1-1}, PTC\_P2-0),\\ (CIA\_P1-1, PTC\_P2-0),\\ (PH\_P1-1, PTC\_P2-0),\\ (SMO\_P4-0, PTC\_P2-0) \}\end{tabular}
\begin{tabular}[c]{@{}l@{}}(\textit{wg}$_3$; WG$_3$; \textit{en}$_2$; EN$_2$; \textit{hh}$_2$; \\ HH$_2$; \textit{ptc}$_{1,3}$; PTC$_{1,3,4}$; \textit{ci}$_{1,3,4}$; \\ CI$_{1,3,4}$; CIA$_{1,3}$; CIR$_{4}$)\end{tabular}    & \begin{tabular}[c]{@{}l@{}}\{ (CIR$_4$-1, PTC$_2$-0),\\ (\textit{ptc}$_1$-1, PTC$_2$-0),\\ (CIA$_1$-1, PTC$_2$-0),\\ (PH$_1$-1, PTC$_2$-0),\\ (SMO$_4$-0, PTC$_2$-0) \}\end{tabular}

& \begin{tabular}[c]{@{}l@{}}\textcolor{Red}{$\textbf{M}_{\textbf{11}}$},\\   \textcolor{ProcessBlue}{$\textbf{M}_\textbf{7}$}/\textcolor{RedOrange}{$\textbf{M}_{\textbf{9}}$},\\   \textcolor{Red}{$\textbf{M}_{\textbf{6}}$},\\  \textcolor{Bittersweet}{$\textbf{M}_{\textbf{13}}$}
%(\textcolor{pink}{$M_{1s}$}/\textcolor{RawSienna}{$M_9$}) 
\end{tabular}                   \\ \midrule


Ectopic variant   & %\begin{tabular}[c]{@{}l@{}}(\textit{wg\_3}; WG\_3; \textit{en\_2}; EN\_2; \textit{hh\_2}; \\ HH\_2; \textit{ptc\_1,3}; PTC\_1,2,3,4; \textit{ci\_1,3,4}; \\ CI\_1,3,4; CIA\_1,3; CIR\_4)\end{tabular}  & \begin{tabular}[c]{@{}l@{}}\{ (SMO\_P2-0, \textit{en\_P2-1}),\\ (SMO\_P2-0, \textit{ptc\_P3-1}),\\ (SMO\_P2-0, \textit{wg\_P3-1}),\\ (SMO\_P2-0, \textit{ptc\_P1-1}) \}\end{tabular} 
\begin{tabular}[c]{@{}l@{}}(\textit{wg}$_3$; WG$_3$; \textit{en}$_2$; EN$_2$; \textit{hh}$_2$; \\ HH$_2$; \textit{ptc}$_{1,3}$; PTC$_{1,2,3,4}$; \textit{ci}$_{1,3,4}$; \\ CI$_{1,3,4}$; CIA$_{1,3}$; CIR$_{4}$)\end{tabular}  & \begin{tabular}[c]{@{}l@{}}\{ (SMO$_2$-0, \textit{en}$_2$-1),\\ (SMO$_2$-0, \textit{ptc}$_3$-1),\\ (SMO$_2$-0, \textit{wg}$_3$-1),\\ (SMO$_2$-0, \textit{ptc}$_1$-1) \}\end{tabular} 

& \begin{tabular}[c]{@{}l@{}}\textcolor{Red}{$\textbf{M}_{\textbf{11}}$},\\   \textcolor{ProcessBlue}{$\textbf{M}_\textbf{7}$}/\textcolor{RawSienna}{$\textbf{M}_{\textbf{12}}$},\\   \textcolor{Red}{$\textbf{M}_{\textbf{6}}$},\\ \textcolor{Bittersweet}{$\textbf{M}_{\textbf{13}}$}
%(\textcolor{pink}{$M_{1s}$}/\textcolor{RawSienna}{$M_9$}) 
\end{tabular}    \\ \bottomrule          
\end{tabular} 
}
\caption{\textbf{Attractors and minimal observability sets for the \textit{drosophila} parasegment SPN.} 
A node
or s-unit's index indicates to which cell in the parasegment it belongs.  In addition to the expressed nodes listed, every attractor has input nodes SLP$_{1,2}=$OFF, SLP$_{3,4}=$ON.  The associated intracellular complex modules are listed for cells 1-4 (top to bottom) in the parasegment.  Only the main complex modules for each cell are listed; they are colored to correspond to Table \ref{tab:drosophila_modules}.  
Here, 
%$\textbf{M}_1$ indicates $\textbf{M}_{nWG-0}$; $\textbf{M}_2$ indicates $\textbf{M}_{en-1}$; $\textbf{M}_3$ indicates $\textbf{M}_{nHH-1}$; 
%$\textbf{M}_4$ indicates $\textbf{M}_{nHH-0}$; 
%$\textbf{M}_5$ indicates $\textbf{M}_{CIR-1}$; 
$\textbf{M}_6$ indicates $\textbf{M}_{SLP-1,nHH-1}$; $\textbf{M}_7$ indicates $\textbf{M}_{SLP-0,nWG-1}$; 
%$\textbf{M}_8$ indicates $\textbf{M}_{nHH-1,en-1}$; 
$\textbf{M}_9$ indicates $\textbf{M}_{PTC-0}$, $\textbf{M}_{10}$ indicates $\textbf{M}_{SLP-0,nWG-1,nHH-1}$,
$\textbf{M}_{11}$ indicates $\textbf{M}_{nWG-0,nHH-1}$, $\textbf{M}_{12}$ indicates $\textbf{M}_{nHH-0,PTC-1}$, $\textbf{M}_{13}$ indicates $\textbf{M}_{SLP-1,nHH-0,PTC-1}$; finally, $\textbf{M}_{14}$ indicates $\textbf{M}_{nWG-0,nHH-0,PTC-1}$.  
Note that observability sets only require two sensors to reveal the given attractor.}
\label{tab:control_sets_parasegment}
\end{adjustwidth}
\end{table}

%\pagebreak
%\subsection{Dynamical Comparison of GRNs}

\begin{table}[]
\begin{adjustwidth}{-2cm}{}
\centering
%\resizebox{1.25\textwidth}{!}{%
\begin{tabular}{lccccccc} \toprule
%                   & \begin{tabular}[c]{@{}l@{}}Network \\ description\end{tabular} &                &               & \begin{tabular}[c]{@{}l@{}} Dynamical \\ modularity \end{tabular}     & \begin{tabular}[c]{@{}l@{}} Dynamical\\  complexity\end{tabular} &           &          \\ \midrule
                     &  %Variables 
                     Nodes     
                     &  S-units & Attractors & %\begin{tabular}[c]{@{}l@{}}est. ind. score \\ of min cover\end{tabular} 
   %$\overline{D}(\Pi_s^*)$ 
   $\overline{D}(\Pi^*)$ &               %$d$ (est.)    & %\begin{tabular}[c]{@{}l@{}}\# modules in \\ cover\end{tabular} 
         $|\Pi^*|$ %(est.)      
         & avg. $|S_i| \in \Pi^*$ & max $|S_i| \in \Pi^*$ \\ \midrule
Example GRN              & 6                                                              & 12             & 5            & 0.83                                                             & 4                                                             & 3.25  & 5  (83\%)      \\ %\midrule
\begin{tabular}[c]{@{}l@{}}\textit{Drosophila} \\ single-cell\end{tabular} & 17                                                             & 34             & 10            & 0.81                                                             & 8                                                              & 5.25      & 16  (94\%)     \\ %\midrule
\textit{Thaliana}                                                         & 15                                                             & 30             & 10            & 0.98                                                             & 11                                                              & 2.82     & 11 (73\%)      \\ %\midrule
Yeast                                                             & 12                                                             & 24             & 11            & 1.0                                                             & 7                                                              & 3.43  & 12 (100\%)      \\ \midrule

\begin{tabular}[c]{@{}l@{}}\textit{Drosophila} \\ parasegment\end{tabular} & 60                                                             & 120            & ?             & 0.87                                                             & 32                                                             & 4.44  & 33 (55\%)      \\ %\midrule
Leukemia                                                          & 60                                                             & 120            & ?             & 0.64                                                             & 41                                                             & 4.95  & 42 (70\%)     \\ \bottomrule
\end{tabular} 
%}
\caption{\textbf{Comparison of dynamical modularity between genetic regulatory networks.}  The optimal cover $\Pi^*$ is estimated for each network by maximizing the mean %modularity score 
dynamical modularity
among covers across seed set sizes, assuming pinning perturbation.  
Six networks are considered: the example GRN from Fig. 2 in the main text, the \textit{drosophila} single-cell and parasegment SPNs \cite{albert2003topology}, the \textit{Thaliana arabadopsis} cell-fate specification network \cite{chaos2006genes}, the yeast cell-cycle network \cite{li2004yeast}, and the T-LGL leukemia network \cite{zhang2008network}.
For the first grouping of networks, $\Pi^*$ was calculated considering all possible covers of $q \leq 6$ core complex modules with seed set size $s \leq 5$, with higher $q$ values used when computationally feasible.
By contrast, $\Pi^*$ for the \textit{drosophila} parasegment and leukemia networks was estimated using the greedy heuristic mentioned in Section 2.3.
For each network the mean dynamical modularity
of the optimal cover,
%$\overline{D}(\Pi_s^*)$,
$\overline{D}(\Pi^*)$, the size of the estimated optimal cover, $|\Pi^*|$, the average module size within the optimal cover, avg. $|S_i| \in \Pi^*$, and the maximum module size within the optimal cover, max $|S_i| \in \Pi^*$, is shown.
Percentages are calculated based on the number of %variables 
nodes %$n$ 
in the network.}
\label{tab:comparison_modularity}
\end{adjustwidth}
\end{table}

%%fix example GRN or remove%%
\begin{table}[]
\begin{adjustwidth}{-2cm}{}
\centering
%\resizebox{1.25\textwidth}{!}{%
\begin{tabular}{lccccc} \toprule
%& \begin{tabular}[c]{@{}l@{}}Network \\ description\end{tabular} &                &               & Controllability                            &                     &                          &                        &               \\ \midrule
 %                   & \# nodes                         & \# s-units & \# attractors 
 &  \begin{tabular}[c]{@{}c@{}}Average driver \\ set size \end{tabular} & \begin{tabular}[c]{@{}c@{}}Min driver \\ set size\end{tabular} & \begin{tabular}[c]{@{}c@{}}Max driver \\ set size\end{tabular} & \begin{tabular}[c]{@{}c@{}}Driver superset \\ size\end{tabular} & \begin{tabular}[c]{@{}c@{}}FVS \\ size\end{tabular} \\ \midrule
Example GRN   
%& 6                                                              & 12             & 5            
%& 2.8                                                                          & 2                                                        & 5                                                        & 5                                                             & 3    
& 2 & 2 & 2 & 2 & 3 
\\
\begin{tabular}[c]{@{}l@{}}\textit{Drosophila} \\ single-cell\end{tabular} 
%& 17                                                             & 34             & 10
& 3.7                                                                        & 3                                                        & 4                                                        & 5                                                             & 5                                                   \\
\textit{Thaliana}                  
%& 15                                                             & 30             & 10
& 6.1                                                                        & 5                                                        & 7                                                        & 9                                                             & 9                                                   \\
Yeast         
%& 12                                                             & 24             & 11
& 6.45                                                                & 5                                                        & 7                                                        & 7                                                             & 8         \\ \bottomrule                                         
\end{tabular} 
%}
\caption{\textbf{Comparison of attractor controllability between genetic regulatory networks.}  Statistics for the driver sets sufficient to fully resolve each 
fixed point
attractor in the network, assuming pinning perturbation, are shown.  
Driver sets are equivalent to the seed sets of the minimal pathway modules whose unfolding %encompasses 
includes all node states found in the respective attractor.
The superset of %control variables 
driver nodes 
needed (based on the set of s-units sufficient to control to each attractor) is compared to that predicted by feedback vertex set theory \cite{fiedler2013dynamics, mochizuki2013dynamics}.
See the caption of Fig.~\ref{tab:comparison_modularity} for a description of the networks used here.
}
\label{tab:comparison_controllability}
\end{adjustwidth}
\end{table}


\begin{table}[]
\begin{adjustwidth}{-2cm}{}
%\centering
\begin{tabular}{llll|ll} \toprule
 & Yeast               & \textit{Thaliana}    & \begin{tabular}[c]{@{}l@{}}\textit{Drosophila}\\ single-cell\end{tabular}   & \begin{tabular}[c]{@{}l@{}}\textit{Drosophila}\\ parasegment\end{tabular}                                             & Leukemia                                                   \\ \midrule
Network size %($N$)            
& 12        & 15            & 17                   & 60                & 60                                                         \\ \midrule
\begin{tabular}[c]{@{}l@{}}Number of\\ attractors\end{tabular}           & 11         & 10          & 10                    & ?    & ?                                                          \\ \midrule

\begin{tabular}[c]{@{}l@{}}$s=1$\\  number of modules,\\  maximum module size\\  (\% of network)\end{tabular} &  \begin{tabular}[c]{@{}l@{}}17,\\ 4 (33\%)\end{tabular}   & \begin{tabular}[c]{@{}l@{}}16,\\ 8 (53\%)\end{tabular}   &
\begin{tabular}[c]{@{}l@{}}14,\\ 9 (53\%)\end{tabular}           & \begin{tabular}[c]{@{}l@{}}40,\\ 13 (22\%)\end{tabular}          & \begin{tabular}[c]{@{}l@{}}48,\\ 24 (40\%)\end{tabular}    \\ \midrule

\begin{tabular}[c]{@{}l@{}}$s=2$\\  number of modules,\\  maximum module size\\  (\% of network)\end{tabular}          & \begin{tabular}[c]{@{}l@{}}12,\\ 10 (83\%)\end{tabular}  & \begin{tabular}[c]{@{}l@{}}7,\\ 12 (80\%)\end{tabular}  &
\begin{tabular}[c]{@{}l@{}}8,\\ 16 (94\%)\end{tabular}          & \begin{tabular}[c]{@{}l@{}}40,\\ 28 (47\%)\end{tabular}  &
\begin{tabular}[c]{@{}l@{}}64,\\ 41 (68\%)\end{tabular}   \\ \midrule

\begin{tabular}[c]{@{}l@{}}$s=3$\\  number of modules,\\  maximum module size\\  (\% of network)\end{tabular}    & \begin{tabular}[c]{@{}l@{}}12,\\ 12 (100\%)\end{tabular} & \begin{tabular}[c]{@{}l@{}}3,\\ 14 (93\%)\end{tabular}  & \begin{tabular}[c]{@{}l@{}}6,\\ 17 (100\%)\end{tabular}         & \begin{tabular}[c]{@{}l@{}}152,\\ 52 (87\%)\end{tabular}      &
\begin{tabular}[c]{@{}l@{}}223,\\ 53 (88\%)\end{tabular}  \\ \midrule

\begin{tabular}[c]{@{}l@{}}$s=4$\\  number of modules,\\  maximum module size\\  (\% of network)\end{tabular} &  \begin{tabular}[c]{@{}l@{}}4,\\ 12 (100\%)\end{tabular} & \begin{tabular}[c]{@{}l@{}}0,\\ \end{tabular} &
\begin{tabular}[c]{@{}l@{}}0,\\ \end{tabular}        & \begin{tabular}[c]{@{}l@{}}472,\\ 56 (93\%)\end{tabular}  & \begin{tabular}[c]{@{}l@{}}646,\\ 54 (90\%)\end{tabular}  \\ \midrule

\begin{tabular}[c]{@{}l@{}}$s=5$\\  number of modules,\\  maximum module size\\  (\% of network)\end{tabular} &  \begin{tabular}[c]{@{}l@{}}2,\\ 12 (100\%)\end{tabular} & \begin{tabular}[c]{@{}l@{}}0,\\ \end{tabular} &
\begin{tabular}[c]{@{}l@{}}0,\\ \end{tabular}        & \begin{tabular}[c]{@{}l@{}}1073,\\ 59 (98\%)\end{tabular}       & \begin{tabular}[c]{@{}l@{}}1446,\\ 56 (93\%)\end{tabular} \\ \midrule

\begin{tabular}[c]{@{}l@{}}$s=6$\\  number of modules,\\  maximum module size\\  (\% of network)\end{tabular} &  \begin{tabular}[c]{@{}l@{}}0,\\ \end{tabular} & \begin{tabular}[c]{@{}l@{}}0,\\ \end{tabular} &
\begin{tabular}[c]{@{}l@{}}0,\\ \end{tabular}        & \begin{tabular}[c]{@{}l@{}}1475,\\ 60 (100\%)\end{tabular}       & \begin{tabular}[c]{@{}l@{}}2353,\\ 57 (95\%)\end{tabular} \\ \midrule

\begin{tabular}[c]{@{}l@{}}Min fixed point seed set size\\ (\% of network)\end{tabular}    & 3 (25\%)     & 4 (27\%)        & 3 (18\%)      & 6 (10\%)        & 8 (13\%)  \\ \bottomrule                
\end{tabular}
\caption{\textbf{Comparison of core complex modules between 
%networks with pinning perturbation.}  
genetic regulatory networks.}
The number of core complex modules, along with the maximum module size, is found per network per seed set size $s$. 
Additionally, the minimal seed set size found to fully resolve every variable state (min fixed point seed set size) is shown; note that this fixed point is not necessarily an attractor of the original network, due to the pinning of the seeds involved.
It is apparent that variable states in 
%the \textit{drosophila}, yeast, and \textit{thaliana} networks 
each network are quickly resolved as $s$ is increased when considering the largest complex module.  
%Most node states in the larger networks are also resolved with small $s$, although the leukemia network contains more core complex modules per seed size $s$ than the \textit{drosophila} parasegment, suggesting less decoupled modularity.  Note that both networks are too large for the attractor landscape to be fully known.  
In comparing the larger networks, the leukemia network has more core complex modules than the \textit{drosophila} parasegment per $s$ value, suggesting more complicated dynamics.
Percentages are calculated based on the number of variables %$n$ 
(nodes) in the network.
See the caption of Fig.~\ref{tab:comparison_modularity} for a description of the networks used here.
}
%\\\hspace{\textwidth}$\ast$ note that \textit{thaliana} should be resolved with 4 nodes; this is a case where our heuristic missed the module that fully resolves the network
\label{tab:comparison}
\end{adjustwidth}
\end{table}

\pagebreak

%\renewcommand{\refname}{\spacedlowsmallcaps{References}} % For modifying the bibliography %heading

\bibliographystyle{unsrt}

\bibliography{dynamics.bib} % The file containing the bibliography

%----------------------------------------------------------------------------------------

%\bibliographystyle{unsrt}

%\bibliography{dynamics.bib}


\end{document}
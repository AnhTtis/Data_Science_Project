\clearpage
\setcounter{page}{1}
\twocolumn[%
%  Title and authors
   \begin{center}
     {\huge Supplemental Materials }\\
     \end{center}\vspace{0.5cm}
]
% \centering
% \textbf{\large Supplemental Materials}
\vspace{1cm}
% \section*{Supplementary Material}
\setcounter{subsection}{0}
\subsection{Sheaf Laplacian Algorithms}\label{ap:algos}
\begin{algorithm}[H]
\footnotesize
   \caption{: Local PCA \cite{singer2012vdm}}    \hspace*{\algorithmicindent} \textbf{Inputs}: \\
    \hspace*{\algorithmicindent} \quad $\mathcal{X} \subset \mathbb{R}^p$: Manifold samples. \vspace{.05cm}\\
    \hspace*{\algorithmicindent} \quad $\epsilon_{\textrm{PCA}} > 0$: Scale parameter \vspace{.05cm}\\
    \hspace*{\algorithmicindent} \quad $K(\cdot) \in C^2(\mathbb{R})$: positive monotonic  supported on $[0, 1]$ \vspace{.05cm}\\
    \hspace*{\algorithmicindent} \textbf{Outputs}: \vspace{.05cm}\\
    \hspace*{\algorithmicindent} \quad $\{\mathbf{O}_i\}_{x_i \in \mathcal{X}}$: Orthogonal transformation
    \begin{algorithmic}[1]
        \Function{LOCAL PCA\,} {\textbf{Inputs}}
                \For{$x_i \in \mathcal{X}$}
                    \State Compute $\mathcal{N}^{\textrm{P}}_i = \{x_j: 0 < \|x_i - x_j\|_{\mathbb{R}^p}\leq \sqrt{\epsilon_{\textrm{PCA}}}\}$\vspace{.05cm}
                    \State Compute $\mathbf{X}_i = [\dots, x_i - x_j, \dots]$, $x_j \in \mathcal{N}^{\textrm{P}}_i$ \vspace{.05cm}
                    \State Compute $\mathbf{C}_i$ with $[\mathbf{C}_i]_{j,j}=\sqrt{K\big(\frac{||x_i -x_j||}{\sqrt{\epsilon_{\textrm{PCA}}}}\big)}$ \vspace{.05cm}
                    \State Compute $\mathbf{B}_i=\mathbf{X}_i\mathbf{C}_i$ and $\mathbf{R}_i=\mathbf{B}_i^T\mathbf{B}_i$  \vspace{.05cm}
                    \State Eigendecompose $\mathbf{R}_i=\mathbf{M}_i\Sigma_i\mathbf{J}_i^T$ \vspace{.05cm}
                \EndFor
        \State \textbf{end}
        \State Compute $\hd$ as in \cite{singer2012vdm} \vspace{.05cm}
        \State Set $\mathbf{O}_i$ to be the first $\hd$ columns of $\mathbf{M}_i$ \vspace{.05cm}\\
        \Return: \\
        \hspace*{\algorithmicindent} \quad $\{\mathbf{O}_i\}_{x_i \in \mathcal{X}}$ 
       \EndFunction
\end{algorithmic}
\end{algorithm}\label{algo:locpca}

\begin{algorithm}[H]
\footnotesize
   \caption{: Sheaf Laplacian \cite{singer2012vdm}}   \hspace*{\algorithmicindent} \textbf{Inputs}: \\
    \hspace*{\algorithmicindent} \quad $\mathcal{X} \subset \mathbb{R}^p$: Manifold samples.  \vspace{.05cm}\\
    \hspace*{\algorithmicindent} \quad $\epsilon_n > 0$: Scale parameter for geometric graph \vspace{.05cm}\\
    \hspace*{\algorithmicindent} \quad $\epsilon_{\textrm{PCA}} > 0$: Scale parameter for local PCA \vspace{.05cm}\\
    \hspace*{\algorithmicindent} \quad $K(\cdot) \in C^2(\mathbb{R})$: positive monotonic  supported on $[0, 1]$\\
    \hspace*{\algorithmicindent} \textbf{Outputs}: \vspace{.05cm}\\
    \hspace*{\algorithmicindent} \quad $\{\mathbf{O}_i\}_{x_i \in \mathcal{X}}$: Orthogonal transformation \vspace{.05cm}\\
    \hspace*{\algorithmicindent} \quad $\Delta_n$: Normalized Sheaf Laplacian
    \begin{algorithmic}[1]
        \Function{SHEAF LAPLACIAN\,} {\textbf{Inputs}}
        \State Compute graph $\mathcal{M}_n$ with edge weights as in \eqref{graph_weights}
                \For{$x_i \in \mathcal{X}$}
                    \State Compute $\{\mathbf{O}_i\}$ with Algorithm 2
                \EndFor
                \State \textbf{end}
                \For{$x_i \in \mathcal{X}$}
                     \For{$x_j \in \mathcal{N}^{\textrm{P}}_i$}
                        \State Compute $\widetilde{\mathbf{O}}_{i,j}=\mathbf{O}_i^T\mathbf{O}_j\svdeq \mathbf{M}_{i,j}\Sigma_i\mathbf{V}_{i,j}^T$ \vspace{.05cm}
                        \State Compute $\mathbf{O}_{i,j}=\mathbf{M}_{i,j}\mathbf{V}_{i,j}^T$ \vspace{.05cm}
                        \State Compute $\textrm{deg}(i)=\sum_j w_{i,j}$ \vspace{.05cm}
                        \State Compute $\textrm{ndeg}(i)=\sum_j \frac{w_{i,j}}{\textrm{deg}(i)\textrm{deg}(j)}$ \vspace{.05cm}
                        \State Compute $\widetilde{\mathbf{D}}_i=\textrm{deg}(i)\mathbf{I}_{\hd}$ and  $\mathbf{D}_i=\textrm{ndeg}(i)\mathbf{I}_{\hd}$ \vspace{.05cm}
                        \State Compute $\mathbf{S}_{i,j}=w_{i,j}\widetilde{\mathbf{D}}^{-1}_i\mathbf{O}_{i,j}\widetilde{\mathbf{D}}^{-1}_i$ \vspace{.05cm}
                    \EndFor
                    \State \textbf{end}
                \EndFor
        \State \textbf{end}
        \State Compute block matrix $\mathbf{S}$ with $\mathbf{S}_{i,j}$s as blocks \vspace{.05cm}
        \State Compute block diagonal matrix $\mathbf{D}$ with $\mathbf{D}_{i,i}$ as blocks 
        \State Compute $\Delta_n = \epsilon_n^{-1}\big(\D^{-1}\S - \mathbf{I}\big)$ \vspace{.05cm}\\
        \Return: \\
        \hspace*{\algorithmicindent} \quad $\{\mathbf{O}_i\}_{x_i \in \mathcal{X}}$, $\Delta_n$
       \EndFunction
\end{algorithmic}
\end{algorithm}\label{algo:sheaflap}
\newpage
\subsection{Proof of Proposition 1} \label{ap:prop1}
\begin{proof}[Proof of Proposition  \ref{prop:parametric-filter}]
By definition of frequency representation in \eqref{freq_resp} we have:
\begin{align}
\label{g_freq}
    &\big[\hat{G}\big]_i = \langle \G, \Phii \rangle = \int_{\M}\langle \G(x), \Phii(x) \rangle_{\tmx} \textrm{d}\mu(x)
\end{align}
Injecting \eqref{param_conv} in \eqref{g_freq}, we get:
\begin{align}
\label{g_freq_f}
    &\big[\hat{G}\big]_i = \langle \int_0^{\infty}\th(t)e^{t\Delta}\F(x)\textrm{d}t, \Phii \rangle 
\end{align}
For the linearity of integrals and inner products, we can write:
\begin{align}
\label{g_freq_int_out}
    &\big[\hat{G}\big]_i = \int_0^{\infty}\th(t)\langle e^{t\Delta}\F(x), \Phii \rangle \textrm{d}t
\end{align}
Finally, exploiting first the self-adjointness of $\Delta$ and then the eigenvector fields definition in \eqref{eigen}, we can write:
\begin{align}
\label{g_freq_final}
    \big[\hat{G}\big]_i &= \int_0^{\infty}\th(t)\langle e^{t\Delta}\F(x), \Phii \rangle \textrm{d}t \nonumber\\
    &=\int_0^{\infty}\th(t)\langle \F(x), e^{t\Delta}\Phii \rangle \textrm{d}t \nonumber \\  
    &=\int_0^{\infty}\th(t)\langle \F(x), e^{-t\lambda_i}\Phii \rangle \textrm{d}t \nonumber \\
    &=\int_0^{\infty}\th(t)e^{-t\lambda_i}\langle \F(x), \Phii \rangle \textrm{d}t,
\end{align}
which concludes the proof.
\end{proof}
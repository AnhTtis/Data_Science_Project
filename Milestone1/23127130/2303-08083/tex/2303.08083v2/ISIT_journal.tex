%% LaTeX Template for ISIT 2021
%%
%% by Stefan M. Moser, October 2017
%% 
%% derived from bare_conf.tex, V1.4a, 2014/09/17, by Michael Shell
%% for use with IEEEtran.cls version 1.8b or later
%%
%% Support sites for IEEEtran.cls:
%%
%% http://www.michaelshell.org/tex/ieeetran/
%% http://moser-isi.ethz.ch/manuals.html#eqlatex
%% http://www.ctan.org/tex-archive/macros/latex/contrib/IEEEtran/
%%

%\documentclass[conference,letterpaper]{IEEEtran}
\documentclass[draftclsnofoot,onecolumn,11pt]{IEEEtran}
\IEEEoverridecommandlockouts

\def\Figs{./figs/} % call figures (eps files) if needed
% \def\styfiles{../} % my local path to the style files
% \def\bibfiles{../} % my local path to the main .bib files

%% depending on your installation, you may wish to adjust the top margin:
\addtolength{\topmargin}{9mm}

%%%%%%
%% Packages:
%% Some useful packages (and compatibility issues with the IEEE format)
%% are pointed out at the very end of this template source file (they are 
%% taken verbatim out of bare_conf.tex by Michael Shell).
%
% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
%
\usepackage[utf8]{inputenc} 
\usepackage[T1]{fontenc}
\usepackage{url}
% ------------------------------------------------------------
\usepackage{ifthen} % manage which version to show in LaTeX
\newboolean{short_version}
% \setboolean{short_version}{true} % true for short version 
\setboolean{short_version}{false} % false for full version -----------------SHORT/FULL VERSION SWITCH
% \usepackage{cite}
\usepackage[cmex10]{amsmath} % Use the [cmex10] option to ensure compliance
                             % with IEEE Xplore (see bare_conf.tex)

%% Please note that the amsthm package must not be loaded with
%% IEEEtran.cls because IEEEtran provides its own versions of
%% theorems. Also, note that IEEEXplore does not accept submissions
%% with hyperlinks, i.e., hyperref cannot be used.

\interdisplaylinepenalty=2500 % As explained in bare_conf.tex


%%%%%%
% correct bad hyphenation here
\hyphenation{}

%%%%% Extra packages/commands %%%%%
\usepackage[url,hyperrefblack,notheorems,IEEEtran]{research17} % customized LaTeX commands
\usepackage{balance} % balancing the two Columns of text on the last Page
\usepackage{amssymb,amsfonts,amsbsy}
\usepackage{enumitem}
\usepackage{mathtools}
\usepackage[lined,boxed,commentsnumbered,linesnumbered,ruled]{algorithm2e}
\usepackage{comment}
\setlist[description]{leftmargin=\parindent,labelindent=\parindent}

% ------------------------------------------------------------
%%% re-define the numbering of theorems, lemmas, examples, etc.
\newtheorem{theorem}{\mytheoremname}
\newtheorem{lemma}[theorem]{\mylemmaname}
\newtheorem{corollary}[theorem]{\mycorollaryname}
\newtheorem{conjecture}[theorem]{\myconjecturename}
\newtheorem{proposition}[theorem]{\mypropositionname}
\newtheorem{claim}[theorem]{\myclaimname}
\newtheorem{definition}[theorem]{\mydefinitionname}
\newtheorem{remark}[theorem]{\myremarkname}
\newtheorem{example}[theorem]{\myexamplename}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% new commands
\newcommand{\Hwt}[1]{\wH\left(#1\right)} % the (Hamming) weight function
\newcommand{\Lwt}[1]{w_{\tn{Lee}}\left(#1\right)} % the Lee weight function
\newcommand{\Ewt}[1]{w_{\tn{E}}\left(#1\right)} % the Euclidean weight function
\newcommand{\vol}[1]{\operatorname{vol}\left(#1\right)} % volume of a lattice
\renewcommand{\ker}[1]{\operatorname{ker}\left(#1\right)} % kernel of a mapping
\newcommand{\ConstrA}[1]{\Lambda_\textnormal{A}(#1)} % the lattice obtained from Construction A over F_2
\newcommand{\ConstrAfour}[1]{\Lambda_{\textnormal{A}_4}(#1)} % the lattice obtained from Construction A4 over Z_4
\newcommand{\ConstrC}[2]{\Lambda_{\textnormal{C}}(#1,#2)} % the lattice obtained from Construction C
\newcommand{\PConstrC}[2]{\Gamma_{\textnormal{C}}(#1,#2)} % the packing obtained from Construction C
% \renewcommand{\Integers}{\mathcal{Z}} % re-define the notation for reals
\renewcommand{\Rationals}{\mathbb{Q}} % re-define the notation for reals
\renewcommand{\Reals}{\mathbb{R}} % re-define the notation for reals
\newcommand{\we}[1]{W_{#1}} % the weight enumerator of one code
\newcommand{\jwe}[2]{\textnormal{jwe}_{#1,#2}} % the joint weight enumerators of two codes
\newcommand{\swe}[1]{\textnormal{swe}_{#1}} % the symmetrized weight enumerators of one code
\newcommand{\na}[2]{n_{#1}(#2)} % the number of a symbol a occurs in a vector
\newcommand*{\Hrule}{\rule[.5ex]{2.5ex}{0.5pt}}
\newcommand*{\Vrule}{\rule[-1ex]{0.5pt}{2.5ex}}

% *** Other Definitions ***
\newcommand*{\Resize}[2][4]{\resizebox{#1}{!}{\ensuremath{#2}}} % Resize based on line or column width
\newcommand*{\Scale}[2][4]{\scalebox{#1}{\ensuremath{#2}}} % Scales an environment simply by a fraction
\def\rot#1{\rotatebox{90}{#1}} % make text be veritical in a table
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% TABLES AND FIGURES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{multirow}
\setcounter{MaxMatrixCols}{20}
% *** TikZ, Frames, and Boxes ***
\usepackage{tikz}
\usetikzlibrary{calc,shapes, patterns,decorations.text, decorations.pathreplacing}
% You must load ctable after tikz package
\usepackage{ctable} % http://ctan.org/pkg/ctable
% \usepackage{caption} % https://ctan.org/pkg/caption
\usepackage{afterpage} % execute command after the next page break
\usepackage{lscape} % for landscape table
\usepackage{pdflscape} %  attribute /Rotate for the landscape table
\usepackage{rotating} % rotate a long table
\usepackage{pbox} % for pbox{}
\usepackage{longtable}
\usepackage{nicematrix} % customize nice matrices, e.g., with vertical lines
%%% Make longtable to have the same caption format as IEEEtran tables:
% https://tex.stackexchange.com/questions/404472/how-can-i-add-a-table-style-caption-to-a-longtable-in-ieeetran
\makeatletter
\def\LT@makecaption#1#2#3{%
  \LT@mcol\LT@cols c{\hbox to\z@{\hss\parbox[t]\LTcapwidth{%
        \footnotesize\bgroup\par\centering\@IEEEtabletopskipstrut{\normalfont\footnotesize #2}\\{\normalfont\footnotesize\scshape #3}\par\addvspace{0.5\baselineskip}\egroup\endgraf%
        \@IEEEtablecaptionsepspace}%
      \hss}}}
\makeatother

%%%%%% Highlights and Comments %%%%%%
\usepackage{todonotes}
\newcommand{\lin}{\color{cyan}} % cyan

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

% \title{On the Secrecy Gain of Formally Unimodular Construction $\textnormal{A}_4$ Lattices \\
\title{Secrecy Gain of Formally Unimodular Lattices\\ from Codes over the Integers Modulo 4
\thanks{This work was supported in part by the Norwegian Research Council through the qsIoT grant, project number 274889.}
}


% %%% Single author, or several authors with same affiliation:
% \author{%
%   \IEEEauthorblockN{Stefan M.~Moser}
%   \IEEEauthorblockA{ETH Zürich\\
%                     ISI (D-ITET)\\
%                     CH-8092 Zürich, Switzerland\\
%                     Email: moser@isi.ee.ethz.ch}
%                   }

\author{%
  \IEEEauthorblockN{Maiara F.~Bollauf, Hsuan-Yin Lin, and {\O}yvind Ytrehus}
 %  \\
 % \IEEEauthorblockA{Simula UiB, N--5006 Bergen, Norway\\             
 %             Emails: \{maiara, lin, oyvindy\}@simula.no}
\thanks{All authors are affiliated to Simula UiB, N--5008 Bergen, Norway. Their respective e-mail addresses are maiara@simula.no, lin@simula.no, and oyvindy@simula.no.}% <-this % stops a space
\thanks{This paper was published partially in the proceedings of the IEEE International Symposium on Information Theory (ISIT'22), Espoo, Finland, 2022~\cite{BollaufLinYtrehus22_2}}}% and submitted in part to International Symposium on Information Theory (ITW'23), Saint-Malo, France.}}%
%%% Several authors with up to three affiliations:

\maketitle

%%%%%%
%% Abstract: 
%% If your paper is eligible for the student paper award, please add
%% the comment "THIS PAPER IS ELIGIBLE FOR THE STUDENT PAPER
%% AWARD." as a first line in the abstract. 
%% For the final version of the accepted paper, please do not forget
%% to remove this comment!
%%
\begin{abstract}% xxx

  Recently, a design criterion depending on a lattice's volume and theta series, called the \emph{secrecy gain}, was proposed to quantify the secrecy-goodness of the applied lattice code for the Gaussian wiretap channel. To address the secrecy gain of Construction $\textnormal{A}_4$ lattices from \emph{formally self-dual} $\Integers_4$-linear codes, i.e., codes for which the \emph{symmetrized weight enumerator (swe)} coincides with the swe of its dual, we present new constructions of $\Integers_4$-linear codes which are formally self-dual with respect to the swe. For even lengths, formally self-dual $\Integers_4$-linear codes are constructed from nested binary codes and double circulant matrices. For odd lengths, a novel construction called \emph{odd extension} from double circulant codes is proposed. Moreover, the concepts of Type I/II formally self-dual codes/unimodular lattices are introduced. Next, we derive the theta series of the \emph{formally unimodular lattices} obtained by Construction $\textnormal{A}_4$ from formally self-dual $\Integers_4$-linear codes and describe a universal approach to determine their secrecy gains. The secrecy gain of Construction $\textnormal{A}_4$ formally unimodular lattices obtained from formally self-dual $\Integers_4$-linear codes is investigated, both for even and odd dimensions. Numerical evidence shows that for some parameters, Construction $\textnormal{A}_4$ lattices can achieve a higher secrecy gain than the best-known formally unimodular lattices from the literature.
  
\end{abstract}

\begin{IEEEkeywords}
  Lattices, Codes over $\Integers_4$, Construction C, Construction $\textnormal{A}_4$, secrecy gain, Gaussian wiretap channel.
\end{IEEEkeywords}
%% The paper must be self-contained. However, if you are referring to
%% a full version for checking certain proofs. Please provide the
%% publically accessible location below.  If the paper is completely
%% self-contained, you can remove the following line from your
%% submission.
% \textit{A full version of this paper is accessible at:}
% \url{https://arxiv.org/pdf/22xx.xxxx.pdf} 

\section{Introduction}
\label{sec:introduction}

\IEEEPARstart{P}{\emph{hysical layer security (PLS)}} has recently received a great deal of attention in 5G and the beyond 5G (B5G) wireless communications~\cite{PoorSchaefer16_1,CostaOggierCampelloBelfioreViterbo17_1,WuKhisti-etal18_1,Bloch-etal21_1,MaengYapiciGuvencBhuyanDai22_1}. In contrast to cryptographic algorithms, PLS approaches utilize the properties of the physical layer of the transmitting parties and provide \emph{information-theoretically unbreakable security} for safeguarding confidential data. PLS originates from Aaron D.~Wyner's landmark paper~\cite{Wyner75_1} in 1975, which showed that based on the \emph{communication channel} characteristics, one can achieve communication that is reliable and at the same time secure against an adversarial eavesdropper. Moreover, PLS has drawn significant attention in connection with industrial standards for the next generation of wireless communications~\cite{Mucchi-etal21_1,Chorti-etal22_1,Ruzomberka-etal23_1sub}.

In the \emph{wiretap channel (WTC)} introduced in~\cite{Wyner75_1}, a single transmitter (Alice) tries to communicate with a receiver (Bob) while keeping the transmitted messages secure from an unauthorized eavesdropper (Eve). The secure and confidential achievable rate between Alice and Bob for WTC is defined as the \emph{secrecy rate}. There is a recent focus on designing practical wiretap codes that achieve a high secrecy rate based on lattices over Gaussian WTCs~\cite{LingLuzziBelfioreStehle14_1,OggierSoleBelfiore16_1,OggierBelfiore18_1}. In~\cite{BelfioreOggier10_1,OggierSoleBelfiore16_1,OggierBelfiore18_1}, the authors introduce the \emph{secrecy function}, which is evaluated in terms of the lattice's volume and \emph{theta series}, and can be interpreted as the security coding gain of a specifically designed lattice for Eve compared to an uncoded lattice. The maximum of the secrecy function, namely the \emph{(strong) secrecy gain}, has been shown to be an essential design criterion for wiretap lattice codes. Please see Section~\ref{sec:secrecy-function_lattice} for an explicit description.

Another design criterion for wiretap lattice codes, called the \emph{flatness factor}, was proposed by Ling \emph{et al.}~\cite{LingLuzziBelfioreStehle14_1}. The flatness factor quantifies how much secret information can leak to Eve in terms of mutual information, while the secrecy gain characterizes the success probability of Eve to correctly guess the transmitted messages. Both the secrecy gain and the flatness factor require the minimization of the theta series of the lattice designed to confuse Eve at a given point to guarantee secrecy-goodness~\cite{LingLuzziBelfioreStehle14_1,LinLingBelfiore14_1}.

Secrecy gains of the so-called \emph{unimodular} lattices have been studied for well over a decade~\cite{BelfioreOggier10_1}. In this pioneering work, Belfiore and Sol{\'{e}} discovered that there exists a symmetry point in the secrecy functions. Further, they conjectured that for unimodular lattices, the secrecy gain is achieved at the symmetry point of its secrecy function. The conjecture has been further investigated and verified for unimodular (or \emph{isodual}) lattices in dimensions less than $80$~\cite{OggierSoleBelfiore16_1,Ernvall-Hytonen12_1,LinOggier13_1,Pinchak13_1}. The study of secrecy gain was recently also extended to the \emph{$\ell$-modular lattices}~\cite{OggierSoleBelfiore16_1,LinOggierSole15_1,OggierBelfiore18_1}, where it is believed that the higher the parameter $\ell$ is, the better secrecy gain we can achieve. Most recently, a new family of lattices, called \emph{formally unimodular lattices}, or lattices with the same theta series as their dual, was introduced~\cite{BollaufLinYtrehus22_1,BollaufLinYtrehus22_3sub}.\footnote{A \emph{formally-self dual} code has the same weight enumerator as its dual.} It was shown that formally unimodular lattices have the same symmetry point as unimodular and isodual lattices, and the Construction A lattices obtained from the formally self-dual codes can achieve a higher secrecy gain than the unimodular lattices. Moreover, for formally unimodular lattices obtained by Construction A from even formally self-dual codes,\footnote{In an \emph{even} code, all codewords have even weights. Otherwise, the code is \emph{odd}.} a sufficient condition to verify Belfiore and Sol{\'{e}}'s conjecture on the secrecy gain was also provided.

% \subsection{Contribution of this paper}
% \label{sec:contribution_this-paper}
This paper especially focuses on the original analysis of the secrecy gain for formally unimodular lattices obtained by Construction $\textnormal{A}_4$ from codes over the ring $\Integers_4\eqdef\{0,1,2,3\}$ (also called  \emph{quaternary codes})~\cite{ConwaySloane93_1,HammonsKumarCalderbankSloaneSole94_1,BonnecazeSoleCalderbank95_1,Wan97_1}. The main contributions are listed as follows.
\begin{enumerate}[nosep,label=\roman*)]
\item For codes over $\Integers_4$, a code is said to be \emph{formally self-dual} if it has the same \emph{symmetrized weight enumerator (swe)} as its dual. We show that if $\code{C}$ is formally self-dual, then its corresponding Construction $\textnormal{A}_4$ lattice is formally unimodular. Moreover, we introduce the concepts of Type I/II formally self-dual codes/unimodular lattices.

\item To study the secrecy gain of Construction $\textnormal{A}_4$ lattices from formally self-dual $\Integers_4$-linear codes, we present new code constructions of formally self-dual $\Integers_4$-linear codes with respect to swe. Little is known about the code construction in the literature~\cite{GulliverHarada01_1,BetsumiyaHarada03_1,YooLeeKim17_1}. For even lengths, formally self-dual $\Integers_4$-linear codes are constructed from nested binary codes and double circulant matrices. A sufficient condition for two nested binary codes to construct a formally self-dual code $\Integers_4$-linear is provided (see Theorem~\ref{thm:FSD-Z4codes_A1plus2A2}).

\item It is important to emphasize that, unlike binary codes, codes over $\Integers_4$ admit self-dual (and formally self-dual) codes of \emph{odd length}. By combining the generator matrix's standard form of a $\Integers_4$-linear code and the double circulant construction, a novel construction called \emph{odd extension} based on double circulant matrices is proposed for odd-length formally self-dual codes (see Section~\ref{sec:double-circulant-its-odd-extension}).
  
\item The theta series of $2$-level Construction C and Construction $\textnormal{A}_4$ lattices are discussed in Section~\ref{sec:theta-series_2-level-ConstrC-ConstructionAfour-lattices}, and the expressions of the corresponding theta series are derived in terms of Jacobi theta functions (see Theorem~\ref{thm:theta-series_2-level-constructionC}).
  
\item Based on the theta series expression derived from Section~\ref{sec:theta-series_2-level-ConstrC-ConstructionAfour-lattices}, we provide a novel and universal approach to determine the secrecy gain for Construction $\textnormal{A}_4$ lattices obtained from formally self-dual codes over $\Integers_4$ (see Theorem~\ref{thm:inv_secrecy-function_SymmetrizedWeightEnumerator}). Moreover, we provide a sufficient condition to verify the Belfiore and Sol{\'{e}} conjecture on the (strong) secrecy gain for Construction $\textnormal{A}_4$ formally unimodular lattices obtained from Type I formally self-dual codes over $\Integers_4$ (see Theorem~\ref{thm:strong-secrecy-gain_TypeI-FSDcodes_Z4}). An upper bound on the secrecy gain of Type I formally unimodular lattices is also re-derived on a comparative basis (see Lemma~\ref{lem:upper-bound_SG_TypeI-FUL}).
  
\item Finally, numerical results on the secrecy gain of Construction $\textnormal{A}_4$ lattices obtained from formally self-dual $\Integers_4$-linear codes are presented. Exhaustive code searches are performed to find the \emph{best} even-length double circulant codes (DCCs) and odd extension codes with respect to secrecy gain. For even dimensions $2\leq n\leq 32$, we note that the Construction $\textnormal{A}_4$ lattices obtained from DCCs generally achieve better secrecy gain than the ones obtained from nested binary codes. For odd dimensions, we also demonstrate the high secrecy gain of the newly presented odd extension codes.
\end{enumerate}% xxx

To the best of our knowledge, most of the efforts to solve Belfiore and Sol{\'{e}}'s conjecture on the secrecy gain of formally unimodular lattices have only been based on lattices obtained by Construction A from binary codes. The investigation of Construction $\textnormal{A}_4$ lattices obtained from formally self-dual codes over $\Integers_4$ has not been addressed in the previous literature. Furthermore, it is worth mentioning that previous contributions were mainly focused on even-dimensional lattices, while in this work, we extensively study \emph{odd-dimensional} formally unimodular lattices obtained from formally self-dual codes over $\Integers_4$.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Definitions and Preliminaries}
\label{sec:definitions-preliminaries}

\subsection{Notation}
\label{sec:notation}

We denote by $\Naturals$, $\Integers$, $\Rationals$, and $\Reals$ the set of naturals, integers, rationals, and reals, respectively. $[i:j]\eqdef\{i,i+1,\ldots,j\}$ for $i,j\in\Integers$, $i\leq j$. Vectors are \emph{row} vectors and are represented by boldfaced, e.g., $\vect{x}$. The all-zero vector is denoted by $\vect{0}$. Matrices and sets are represented by capital sans serif letters and calligraphic uppercase letters, respectively, e.g., $\mat{X}$ and $\set{X}$. $\mat{X}_{k\times n}$ represents a matrix of size $k\times n$, and a square matrix of size $n$ is denoted by $\mat{X}_n$. We omit the subscript of a matrix if it is clearly understood from the context. An identity matrix and an all-zero matrix are denoted by $\mat{I}$ and $\mat{O}$, respectively. We denote by, respectively, $\Hwt{\vect{x}}$, $\Lwt{\vect{x}}$, and $\Ewt{\vect{x}}$ the \emph{Hamming} weight, the \emph{Lee} weight, and the \emph{Euclidean} weight of a vector $\vect{x}\in\Integers_m^n$ or $\Integers^n$, where $\Integers_m=\{0,\dots,m-1\}$ is the ring of integers modulo $m$. In this work, $m$ can be $2$ or $4$. We use the code parameters $[n,M]$, $[n,M,d_{\textnormal{Lee}}]$, or $[n,M,d_{\textnormal{Lee}},d_\textnormal{E}]$ to denote a linear code $\code{C}$ of length $n$, $M$ codewords, minimum \emph{Lee distance} $d_{\textnormal{Lee}}\eqdef\min_{\vect{x},\vect{y}\in\code{C}}\Lwt{\vect{x}-\vect{y}}$, and minimum squared Euclidean distance $d_{\textnormal{E}}\eqdef\min_{\vect{x},\vect{y}\in\code{C}}\Ewt{\vect{x}-\vect{y}}$.\footnote{For general readers, see~\cite[Ch.~2.1]{NebeRainsSloane06_1} for the detailed definitions of weights.} A generator matrix of a code $\code{C}$ is represented by $\mat{G}^{\code{C}}$, while $\code{C}^{\mat{G}}$ represents the corresponding linear code generated by $\mat{G}$. $\phi_m\colon\Integers^n_m \rightarrow \Integers^n$ is defined as the natural embedding, i.e., the elements of $\Integers_m$ are mapped to the respective integer by $\phi_m$ element-wisely. $\trans{(\cdot)}$ represents the transpose of its argument and $\inner{\vect{x}}{\vect{y}}$ denotes the inner product and the $\vect{x}\circ\vect{y}$ represents the element-wise (Hadamard/Schur) product between two vectors over $\Integers_m$, respectively.

\subsection{Basics on Codes and Lattices}
\label{sec:basics_codes-lattices}

We recall some definitions of codes over $\Integers_m$, $m\in\{2,4\}$, and lattices.

Let $\code{A}$ be an $[n,M]$ binary code. Its \emph{weight enumerator} is 
\begin{IEEEeqnarray*}{c}
  W_{\code{A}}(x,y)=\sum_{\vect{a}\in\code{A}} x^{n-\Hwt{\vect{a}}}y^{\Hwt{\vect{a}}}.
\end{IEEEeqnarray*}

Let $\code{A}_1,\code{A}_2$ be two binary linear codes. For $\vect{a}_1=(a_{1,1},\ldots,a_{1,n}) \in \code{A}_1, \vect{a}_2=(a_{2,1},\ldots,a_{2,n}) \in \code{A}_2$, we define 
\begin{IEEEeqnarray}{rCl}
  \IEEEyesnumber
  \IEEEyessubnumber*
  d_{0,0}(\vect{a}_1,\vect{a}_2)& \eqdef & \card{\{j\in [1:n]\colon (a_{1,j},a_{2,j}) = (0,0)\}},  \label{eq:def_d00}
  \\ [1mm]
  d_{0,1}(\vect{a}_1,\vect{a}_2) & \eqdef & \card{\{j\in [1:n]\colon (a_{1,j}, a_{2,j})=(0,1)\}},  \label{eq:def_d01}
  \\[1mm]
  d_{1,0}(\vect{a}_1,\vect{a}_2) & \eqdef & \card{\{j\in [1:n]\colon (a_{1,j},a_{2,j}) = (1,0)\}},  \label{eq:def_d10}
  \\[1mm]
  d_{1,1}(\vect{a}_1,\vect{a}_2) & \eqdef &\card{\{j\in [1:n]\colon (a_{1,j}, a_{2,j})=(1,1)\}} \label{eq:def_d11}.
\end{IEEEeqnarray}
Observe that $d_{0,0}(\vect{a}_1,\vect{a}_2) + d_{0,1}(\vect{a}_1,\vect{a}_2) + d_{1,0}(\vect{a}_1,\vect{a}_2)+ d_{1,1}(\vect{a}_1,\vect{a}_2) = n$. %, $d_{1,0}(\vect{c}_1,\vect{c}_2) + d_{1,1}(\vect{c}_1,\vect{c}_2) = \omega(\vect{c}_1)$, and  $d_{0,1}(\vect{c}_1,\vect{c}_2) + d_{1,1}(\vect{c}_1,\vect{c}_2) = \omega(\vect{c}_2)$. 
The \emph{joint weight enumerator} of $\code{A}_1$ and $\code{A}_2$ is given by
\begin{IEEEeqnarray}{c}
  \jwe{\code{A}_1}{\code{A}_2}(a,b,c,d)\eqdef\sum_{\vect{a}_1 \in \code{A}_1} \sum_{\vect{a}_2 \in \code{A}_2} a^{d_{0,0}} b^{d_{0,1}} c^{d_{1,0}} d^{d_{1,1}},
  \label{eq:def_jwe}
\end{IEEEeqnarray}
where we use the shorthand $d_{i,j}$ for $d_{i,j}(\vect{a}_1,\vect{a}_2)$ defined in~\eqref{eq:def_d00}-\eqref{eq:def_d11}. Detailed properties and MacWilliams identities of the joint weight enumerator can be found in~\cite[Ch.~5, pp.~147--149]{MacWilliamsSloane77_1}.

A \emph{${\Integers_4}$-linear code} $\code{C}$ of length $n$ is an additive subgroup of $\Integers_4^n$. If $\code{C}$ is a $\Integers_4$-linear code of length $n$, then $\code{C}^\perp\eqdef\{\vect{x}\in\Integers_4^n\colon\inner{\vect{x}}{\vect{y}} = 0,\,\forall\,\vect{y}\in\code{C}\}$ is the \emph{dual code} of $\code{C}$. 
    
From~\cite[Prop.~1.1]{Wan97_1}, it is well-known that any $\Integers_4$-linear code is \emph{permutation equivalent} to a code $\code{C}$ with a generator matrix $\mat{G}^{\code{C}}$ in \emph{standard form}
\begin{IEEEeqnarray}{C}
\label{eq:generator_cs}
  \mat{G}^{\code{C}}=\begin{pNiceMatrix}
    \mat{I}_{k_1} & \mat{A} & \mat{B} \\
    \mat{O}_{k_2 \times k_1} & 2\mat{I}_{k_2} & 2\mat{C}
    \label{eq:Generator_Matrix}
  \end{pNiceMatrix},
\end{IEEEeqnarray}
where $\mat{A}$ and $\mat{C}$ are binary matrices, and $\mat{B}$ is defined over $\Integers_4$. Such a code $\code{C}$ is said to be a code of \emph{type $4^{k_1}2^{k_2}$} and $\code{C}$ contains $2^{2k_1+k_2}$ codewords. Also, the dual code $\code{C}^\perp$ of $\code{C}$ has generator matrix
\begin{IEEEeqnarray}{C}
  \mat{G}^{\code{C}^\perp}=
  \begin{pNiceMatrix}
    -\trans{\mat{B}} - \trans{\mat{C}}\trans{\mat{A}} & \trans{\mat{C}} & \mat{I}_{n-k_1-k_2} \\
    2\trans{\mat{A}} & 2\mat{I}_{k_2} & \mat{O}_{k_2 \times (n-k_1-k_2)}
    \label{eq:Generator_Matrix_Dual}
  \end{pNiceMatrix},
\end{IEEEeqnarray}
and type $4^{n-k_1-k_2}2^{k_2}$ and $\code{C}^\perp$ contains $2^{2n-2k_1-k_2}$.

The \emph{symmetrized weight enumerator (swe)} of a $\Integers_4$-linear code $\code{C}$ is defined as
\begin{IEEEeqnarray*}{c}
  \swe{\code{C}}(a,b,c)=\sum_{\vect{c}\in\code{C}} a^{n_0(\vect{c})}b^{n_1(\vect{c})+n_3(\vect{c})}c^{n_2(\vect{c})},
\end{IEEEeqnarray*}
where $n_i(\vect{c})\eqdef\card{\{j\in [1:n]\colon c_j=i\}}$, $i\in\Integers_4$.\footnote{The exponent of $b$ combines weights $1$ and $3$ according to the Lee distance definition.} The corresponding MacWilliams identity for $\Integers_4$-linear codes is given by~\cite[Th.~2.3]{Wan97_1}
% \begin{IEEEeqnarray}{rCl}
%   \IEEEeqnarraymulticol{3}{l}{%
%     \swe{\code{C}}(a,b,c)}\nonumber\\*\quad%
%   & = &\frac{1}{\card{\dual{\code{C}}}}\swe{\dual{\code{C}}}(a+2b+c,a-c,a-2b+c). 
%   \label{eq:swe-MacWilliams-identity_Z4}
% \end{IEEEeqnarray}
\begin{IEEEeqnarray}{c}
    \swe{\code{C}}(a,b,c)
   = \frac{1}{\card{\dual{\code{C}}}}\swe{\dual{\code{C}}}(a+2b+c,a-c,a-2b+c). 
  \label{eq:swe-MacWilliams-identity_Z4}
\end{IEEEeqnarray}

Following the notion of swe, we have the following families of codes over $\Integers_4$.
\begin{definition}[Self-dual, isodual, formally self-dual codes]
  \begin{itemize}
  \item If $\code{C}=\dual{\code{C}}$, $\code{C}$ is a \emph{self-dual} code.
  \item If there is a permutation of coordinates and a (possible) change of signs carried out by a mapping $\pi$, such that $\code{C}=\pi(\dual{\code{C}})$, $\code{C}$ is called \emph{isodual}.
  \item If $\code{C}$ and $\dual{\code{C}}$ have the same symmetrized weight enumerator, i.e., $\swe{\code{C}}(a,b,c)=\swe{\dual{\code{C}}}(a,b,c)$, $\code{C}$ is a \emph{formally self-dual} code.
  \end{itemize}
\end{definition}
From~\eqref{eq:swe-MacWilliams-identity_Z4}, we can conclude that a code in any of these classes has its swe satisfying
\begin{IEEEeqnarray}{c}
  % \IEEEeqnarraymulticol{3}{l}{%
  \swe{\code{C}}(a,b,c)% }\nonumber\\*\quad%
  % & = &
  =\frac{1}{\card{{\code{C}}}}\swe{\code{C}}(a+2b+c,a-c,a-2b+c).
  \IEEEeqnarraynumspace\label{eq:swe-MacWilliams-identity_FSD-codes_Z4}
\end{IEEEeqnarray}

A (full rank) \emph{lattice} $\Lambda\subset\Reals^n$ is a discrete additive subgroup of $\Reals^{n}$, and it can be seen as
% \begin{IEEEeqnarray*}{c}
$\Lambda=\{\vect{\lambda}=\vect{u}\mat{L}_{n\times n}\colon\vect{u}\in\Integers^n\}$,
% \end{IEEEeqnarray*}
where the $n$ rows of $\mat{L}$ form a lattice basis in $\Reals^n$. %linearly independent set of vectors in $\Reals^n$. %Equivalently, a lattice $\Lambda \subset \Reals^n$ is a discrete additive subgroup of $\Reals^n$. 
The \emph{volume} of $\Lambda$ is $\vol{\Lambda} = \ecard{\det(\mat{L})}$. If a lattice $\Lambda$ has generator matrix $\mat{L}$, then the lattice $\Lambda^\star\subset\Reals^n$ generated by $\trans{\bigl(\inv{\mat{L}}\bigr)}$ is called the \emph{dual lattice} of $\Lambda$. For lattices, the analogue of the weight enumerator of a code is the \emph{theta series}.
\begin{definition}[Theta series]
  \label{def:theta-series}
  Let $\Lambda$ be a lattice, its \emph{theta series} is given by
  \begin{IEEEeqnarray*}{c}
    \Theta_\Lambda(z) = \sum_{{\bm \lambda} \in \Lambda} q^{\norm{\vect{\lambda}}^2},
  \end{IEEEeqnarray*}
  where $q\eqdef\ope^{i\pi z}$ and $\Im{z} > 0$. % The theta function of an integer lattice is absolutely and uniformly convergent \cite[p.~71]{Gunning:62}
\end{definition}

Analogously, the spirit of the MacWilliams identity can be captured by the \emph{Jacobi's formula}~\cite[eq.~(19), Ch.~4]{ConwaySloane99_1}
\begin{IEEEeqnarray}{c}
  \Theta_{\Lambda}(z)=\vol{\Lambda^\star}\Bigl(\frac{i}{z}\Bigr)^{\frac{n}{2}}\Theta_{\Lambda^\star}\Bigl(-\frac{1}{z}\Bigr).
  \label{eq:Jacobi-formula}
\end{IEEEeqnarray}

In some particular cases, the theta series of a lattice can be expressed in terms of the \emph{Jacobi theta functions} defined as follows.
% \begin{definition}[Jacobi theta functions]
%   \label{def:jacobi-theta-functions}
%   The Jacobi theta functions are defined as
\begin{IEEEeqnarray*}{rCl}
  \vartheta_2(z)& \eqdef &\sum_{m\in\Integers} q^{\bigl(m+\frac{1}{2}\bigr)^2}=\Theta_{\mathbb{Z} + \frac{1}{2}}(z),
  \nonumber\\
  % & = & 2q^{1/4}(1+q^2+q^6+q^{12}+ q^{20}+\dots)
  % \nonumber\\
  \vartheta_3(z)& \eqdef &\sum_{m \in \mathbb{Z}} q^{m^2}=\Theta_{\mathbb{Z}}(z)
  = 1 + 2q + 2q^{4} +  2q^{9} + 2q^{16} + 2q^{25} + \cdots
  \IEEEyesnumber\label{eq:Jacobi-theta3-function}\\
  \vartheta_4(z)& \eqdef &\sum_{m\in \mathbb{Z}} (-q)^{m^2}.
  % \nonumber\\
  % & =  &1 - 2q + 2q^4 -  2q^9 + 2q^{16} - 2q^{25} + \dots
\end{IEEEeqnarray*}

A lattice is said to be \emph{integral} if the inner product of any two lattice vectors is an integer. An integral lattice such that $\Lambda = \Lambda^\star$ is called a \emph{unimodular} lattice. A lattice $\Lambda$ is called \emph{isodual} if it can be obtained from its dual $\Lambda^\star$ by (possibly) a rotation or reflection. In~\cite{BollaufLinYtrehus22_1}, a new and broader family was presented, namely, the \emph{formally unimodular lattices}, that consists of lattices having the same theta series as their duals, i.e., $\Theta_{\Lambda}(z)=\Theta_{\Lambda^\star}(z)$.

Lattices can be constructed from binary linear codes through the so-called Constructions A and C~\cite{ConwaySloane99_1}.
\begin{definition}[Construction A]
  \label{def:def_ConstrA}
  Let $\code{A}$ be a binary $[n,M]$ code, then $\ConstrA{\code{A}}\eqdef\frac{1}{\sqrt{2}}(\phi_2(\code{A}) + 2\Integers^n)$ is a lattice.
\end{definition}

\begin{definition}[$2$-level Construction C]
  \label{def:def_ConstrC}
  Let $\code{A}_1,\code{A}_2$ be two binary linear codes and $\code{A}_1 \subseteq \code{A}_2$. If the chain $\code{A}_1 \subseteq \code{A}_2$ is closed under the element-wise product,\footnote{The chain $\code{A}_1 \subseteq \code{A}_2$ is called \emph{closed under the element-wise product} if for all $\vect{a}_1,\vect{a}'_1\in \code{A}_1$, we have $\vect{a}_1\circ \vect{a}'_1 = (a_{1,1}a_{1,1}', \dots, a_{1,n}a_{1,n}')\in\code{A}_{2}$.} then 
  \begin{IEEEeqnarray}{c}
    \label{eq:construction_c}
    \ConstrC{\code{A}_1}{\code{A}_2}\eqdef\phi_2(\code{A}_1) + 2\phi_2(\code{A}_2) + 4\Integers^n
    \label{eq:ConstrC}
  \end{IEEEeqnarray}
  generates a lattice~\cite{KositwattanarerkOggier14_1}.
\end{definition}

For general choices of $\code{A}_1$ and  $\code{A}_2$, \eqref{eq:ConstrC} is a nonlattice packing, and we will denote by $\PConstrC{\code{A}_1}{\code{A}_2}$. If $\code{A}_1$ is the zero code, and $\code{A}_2$ is linear, then $\ConstrC{\code{A}_1}{\code{A}_2}=2\sqrt{2}\ConstrA{\code{A}_2}$. If $\code{A}_2$ is the universe code $\mathbb{F}_2^n$ and $\code{A}_1$ is linear, then $\ConstrC{\code{A}_1}{\code{A}_2}=\sqrt{2}\ConstrA{\code{A}_1}$. % Definition~\ref{def_ConstrC} can be extended to more than two codes, and it is called Construction C (or construction by code-formula~\cite{Forney88_1}).
    
A packing $\Gamma\subset\Reals^n$ is \emph{geometrically uniform} if for any two elements $\vect{x},\vect{x}'\in\Gamma$, there exists an isometry $T_{\vect{x},\vect{x}'}$ such that $\vect{x}'=T_{\vect{x},\vect{x}'}(\vect{x})$ and $T_{\vect{x},\vect{x}'}(\Gamma)\eqdef\{T_{\vect{x},\vect{x}'}(\vect{x})\colon\vect{x}\in\Gamma\}=\Gamma$. It was demonstrated that $\PConstrC{\code{A}_1}{\code{A}_2}$ is geometrically uniform~\cite{Forney91_1,BollaufZamir16_1}, for linear codes $\code{A}_1$ and $\code{A}_2$.

\begin{comment} %% comment out
  
\begin{definition}[$2$-level Construction D]
  \label{def:Constr_D}
  Let $\code{A}_1 \subseteq \code{A}_2 \subseteq \Field_2^n$ be two nested linear codes. Let $k_1 = \textnormal{dim}(\code{A}_1)$ and $k_2 = \textnormal{dim}(\code{A}_2)$. Also, consider $\vect{b}_1,\vect{b}_2, \dots, \vect{b}_n$ as a basis of $\Field_2^n$, such that $\vect{b}_1, \dots, \vect{b}_{k_i}$ span $\code{C}_i$. The lattice $\Lambda_{\textnormal{D}}(\code{A}_1,\code{A}_2)$ consists of all vectors of the form
\begin{IEEEeqnarray}{c}
  \sum_{j=1}^{k_1}\alpha_j^{(1)} \phi_2(\vect{b}_j) + 2\sum_{j=1}^{k_2}\alpha_j^{(2)} \phi_2(\vect{b}_j) + 4\vect{z},
\end{IEEEeqnarray}
where $\alpha_j^{(i)} \in \{0,1\}$, $\vect{z} \in \Integers^n$.
\end{definition}
If the chain $\code{A}_1 \subseteq \code{A}_2$ is closed under element-wise product, then Constructions C and D coincide, i.e., $\ConstrC{\code{A}_1}{\code{A}_2} = \Lambda_{\textnormal{D}}(\code{A}_1,\code{A}_2)$~\cite[Th.~1]{KositwattanarerkOggier14_1}.

\end{comment}

There is an analogue of Construction A for codes over $\Integers_4$, which is called \emph{Construction $\textnormal{A}_4$}~\cite[Ch.~12.5.3]{HuffmanPless03_1}.
\begin{definition}[Construction $\textnormal{A}_4$]
  \label{def:def_ConstrAfour}
  If $\code{C}$ is a $\Integers_4$-linear code, then $\ConstrAfour{\code{C}}=\frac{1}{2}(\phi_4(\code{C})+4\mathbb{Z}^n)$ is a lattice.
\end{definition}
It is known that $\ConstrAfour{\code{C}}$ is a unimodular lattice if and only if the $\Integers_4$-linear code $\code{C}$ is self-dual~\cite[Prop.~12.2]{Wan97_1}. For notational convenience, from now on, the mapping $\phi_m$ is omitted. 

The following example illustrates Construction $\textnormal{A}_4$ of the octacode.
\begin{example}
  \label{ex:E8_octacode}
  The self-dual $\Integers_4$-linear code, known as the octacode $\code{O}_8$, is generated by $\mat{G} =(\mat{I}_{4}\,\,\,\mat{B}_{4})$, where 
  \begin{IEEEeqnarray*}{c}
    \mat{B}_{4} =
    \begin{pmatrix}
      3 & 1 & 2 & 1 \\
      1 & 2 & 3 & 1 \\
      3 & 3 & 3 & 2 \\
      2 & 3 & 1 & 1
    \end{pmatrix}.  
  \end{IEEEeqnarray*}
  It is of type $4^4$ and its swe~\cite[Ex.~12.5.13]{HuffmanPless03_1} is given by
  \begin{IEEEeqnarray}{c}
  \label{eq:swe_octacode}
    \swe{{\code{O}_8}}(a,b,c)
    = a^8+ 16b^8+ c^8+ 14a^4c^4+ 112a^3 b^4c + 112a b^4 c^3.
    \label{eq:swe_octacode}
  \end{IEEEeqnarray}
  A unimodular lattice can be constructed by performing $\widebar{\lattice{E}}_8=\Lambda_{\textnormal{A}_4}(\code{O}_8) = \frac{1}{2}\left(\code{O}_8+4\mathbb{Z}^8\right)$. It is equivalent to the well-known Gosset lattice $\lattice{E}_8$~\cite[Ex.~12.5.13]{HuffmanPless03_1}. Note that the theta series of the $\lattice{E}_8$ lattice in terms of the Jacobi theta functions is
  \begin{IEEEeqnarray}{rCl}
    \Theta_{\lattice{E}_8}(z)& = &\frac{1}{2}\bigl[\vartheta^8_2(z) + \vartheta^8_3(z)+\vartheta^8_4(z) \bigr]=\frac{1}{2}\bigl[(\vartheta^4_2(z))^2 + \vartheta^8_3(z)+\vartheta^8_4(z)\bigr] \nonumber \label{eq:theta-series-1_GossetE8}
    \\
    & \stackrel{\eqref{eq:useful-identities-2}}{=} &\frac{1}{2}\bigl[(\vartheta^4_3(z)-\vartheta^4_4(z))^2+\vartheta^8_3(z)+\vartheta^8_4(z)\bigr]=\vartheta_3(z)^8-\vartheta^4_3(z)\vartheta^4_4(z)+\vartheta^8_4(z)\IEEEeqnarraynumspace \nonumber \label{eq:theta-series-2_GossetE8}
    \\
    & = &1+240q^2+2160q^4+6720q^6+\cdots.
    \label{eq:theta-series-expension_GossetE8}
  \end{IEEEeqnarray}
  
  The $\lattice{E}_8$ lattice can also be constructed via the binary Construction A, using the $[8,4,4]$ extended Hamming code.\hfill\exampleend
\end{example}

\subsection{Type I Codes and Lattices}
\label{sec:TypeI-lattices}

In the coding theory and lattice literature, one can define a \emph{Type I} self-dual code and a Type I unimodular lattice. We briefly summarize the concepts below.
\begin{remark}[{\cite[Remark 2.3.1]{NebeRainsSloane06_1}}]
  \begin{itemize}
  \item Let $m\in\{2,4\}$. If a code over $\Integers_{m}$ is self-dual, all the Euclidean weights of codewords are divisible by $m$~\cite[Ths.~1.4.5 and 12.1.5]{HuffmanPless03_1}. A self-dual code is Type II if the Euclidean weight of every codeword is a multiple of $2m$. Otherwise, it is called a Type I self-dual code.
  \item A unimodular lattice must be integral. Hence, the inner product of any two lattice vectors is either even or odd. A unimodular lattice is Type II if the inner product of any two lattice points is even. Otherwise, it is called a Type I unimodular lattice~\cite[Sec.~2.4, Ch.~2]{ConwaySloane99_1}.
  \end{itemize}
\end{remark}

In this paper, since we work on the generalization of formally self-dual codes/unimodular lattices, we also adapt the Type I concepts for formally self-dual codes/unimodular lattices.

\begin{definition}
  \label{def:TypeI-FSD-codes}
  Let $\code{C}$ be a code over $\Integers_{m}$, where $m\in\{2,4\}$. A formally self-dual code is said to be of Type I if all its codewords have Euclidean weight divisible by $m$ and of Type II if all its codewords have Euclidean weights divisible by $2m$. Analogously, a formally unimodular lattice is of Type I if it is integral and is of Type II if the inner product of any two lattice vectors is a multiple of $2$.
\end{definition}


\section{Constructions of Formally Self-Dual $\Integers_4$-Linear Codes}
\label{sec:construction_FSD-Z4-codes}

In this section, we present constructions of formally self-dual $\Integers_4$-linear codes from binary codes and also from double circulant matrices, as well as an original construction of odd-length codes, denoted by the \emph{odd extension}.

\begin{comment} %% comment out this part as it does not really relate to the entire paper
  
\subsection{$2$-Level Construction D}
\label{sec:2-level-ConstructionD}

This section is based on~\cite[Th.~3]{ConwaySloane93_1} and \cite[pp.~496--497]{HuffmanPless03_1}. Let $\mu\colon\Integers_4 \to \Field_2$, such that $\mu(0)=\mu(2)=0$ and $\mu(1)=\mu(3)=1$. Also $\ker{\mu}=\{0,2\}$ and we define $\zeta\colon\{0,2\} \to \Field_2$, such that $\zeta(0)=0$ and $\zeta(2)=1$. Two binary codes are canonically associated with any code $\code{C} \subseteq \Integers_4^n$, namely
\begin{IEEEeqnarray*}{c}
\code{C}^{(1)} = \{\mu(\vect{w}): \vect{w} \in \code{C}\} \subseteq \Field_2^n \\
\code{C}^{(2)} = \{\zeta(\vect{w}): \vect{w} \in \code{C}, \mu(\vect{w})=0\} \subseteq \mathbb{F}_2^n.
\end{IEEEeqnarray*}
These codes are referred to as \emph{residue} and \emph{torsion} codes, respectively, in~\cite[p.~496]{HuffmanPless03_1}.
Given a linear code $\code{C} \subseteq \Integers_4^n$ with generator matrix as in~\eqref{eq:Generator_Matrix},
% \begin{IEEEeqnarray*}{c}
% \mat{G} = \begin{pmatrix}
% \mat{I}_{k_1} & \mat{A} & \mat{B} \\
% \mat{O}_{k_1 \times k_2 } & 2\mat{I}_{k_2} & 2\mat{C}
% \end{pmatrix},
% \end{IEEEeqnarray*}
%where $\mat{A},\mat{B}$ are matrices over $\Integers_4$ and $\mat{C}$ is a matrix over $\Integers_2$. T
then, $\code{C}^{(1)}$ is an $[n,k_1]$ binary code and  $\code{C}^{(2)}$ is an $[n,k_1+k_2]$ binary code with generator matrices, respectively, 
\begin{IEEEeqnarray*}{c}
  \mat{G}^{\code{C}^{(1)}} = \begin{pmatrix}
    I_{k_1} & \mu(\mat{A}) &  \mu(\mat{B}) 
  \end{pmatrix},\quad
  \mat{G}^{\code{C}^{(2)}} =
  \begin{pmatrix}
    \mat{I}_{k_1} & \mu(\mat{A}) &  \mu(\mat{B}) \\
    \mat{O}_{k_2 \times k_1} & \mat{I}_{k_2} & \mat{C} 
  \end{pmatrix}.
\end{IEEEeqnarray*}
Observe that $\code{C}^{(1)} \subseteq \code{C}^{(2)}$, by construction.

\begin{theorem}[{\cite[Th.~3]{ConwaySloane93_1}}]
  \label{def:Constr_CS}
  Let $\code{A}, \code{B}$ be two binary codes with $\code{A}\subseteq \code{B}$, then there is a code $\code{C} \subseteq \Integers_4^n$, with $\code{C}^{(1)}= \code{A}$ and $\code{C}^{(2)}= \code{B}$. If $\code{B}=\code{A}^{\perp}$, then $\code{C}$ is self-dual.
\end{theorem}

Moreover, given that $\code{A}$ and $\code{B}$ are generated respectively by
\begin{IEEEeqnarray*}{c}
\begin{pmatrix}
\mat{I}_{k_1} & \mat{X} &  \mat{Y} 
\end{pmatrix}, ~ \begin{pmatrix}
\mat{I}_{k_1} & \mat{X} &  \mat{Y} \\
\mat{O}_{k_2 \times k_1} & \mat{I}_{k_2} & \mat{Z} 
\end{pmatrix},
\end{IEEEeqnarray*}
where $\mat{X}, \mat{Y}$ are matrices over $\Field_2$, then $\code{C} \subseteq \Integers_4^n$ is generated by
\begin{IEEEeqnarray}{c}
  \mat{G}^{\code{C}}= \begin{pmatrix}
    \mat{I}_{k_1} & \mat{X} & \mat{Y} \\
    \mat{O}_{k_2 \times k_1} & 2\mat{I}_{k_2} & 2\mat{Z} 
  \end{pmatrix}.
\end{IEEEeqnarray}

Let $\code{C} \subseteq \Integers_4^n$ be a code generated as in Theorem~\ref{def:Constr_CS}, then the following equivalence holds.
\begin{proposition}
  Consider an $[n,k_1]$ linear code $\code{A}_1$ and an $[n,k_1+k_2]$ linear code $\code{A}_2$, such that $\code{A}_1 \subseteq \code{A}_2 \subseteq \Field_2^n$. Then $\ConstrAfour{\code{C}} = \Lambda_D(\code{A}_1, \code{A}_2)$.
\end{proposition}
\begin{IEEEproof}
  If we perform the modulo $4$ operation to both constructions $\ConstrAfour{\code{C}}$ and $\Lambda_D(\code{A}_1, \code{A}_2)$, we get two linear codes over $\Integers_4$, i.e., $\code{C}=\ConstrAfour{\code{C}} \bmod 4 \subseteq \Integers_4^n$ and
  \begin{IEEEeqnarray*}{c}
    \code{C}_{\textnormal{D}} = \sum_{j=1}^{k_1}\alpha_j^{(1)} \phi_2(\vect{b}_j) + 2\sum_{j=1}^{k_1+k_2}\alpha_j^{(2)} \phi_2(\vect{b}_j)= \Lambda_D(\code{A}_1,\code{A}_2) \bmod 4 \subseteq \Integers_4^n.
  \end{IEEEeqnarray*}
  
  One can see the generator matrix of $\code{C}_{\textnormal{D}}$ over $\Integers_4$ as
  \begin{IEEEeqnarray}{c}
    \label{eq:gen_D}
    G^{\code{C}_\textnormal{D}} = 
    \trans{
      \begin{pmatrix}
        \Vrule & \Vrule &\Vrule & \Vrule & \Vrule & \Vrule \\
        \vect{b}_1 & \vdots & \vect{b}_{k_1} & 2\vect{b}_{k_1+1} & \vdots & 2\vect{b}_{k_2} \\
        \Vrule & \Vrule & \Vrule & \Vrule & \Vrule & \Vrule
      \end{pmatrix}}.
  \end{IEEEeqnarray}
  
  By performing elementary operations in the rows of $G^{\code{C}_\textnormal{D}}$ we get the following equivalent matrix
  \begin{IEEEeqnarray*}{c}
    \mat{G}^{\code{C}_\textnormal{D}} =
    \begin{pmatrix}
      \mat{I}_{k_1} & \mat{X} & \mat{Y} \\
      \mat{O}_{k_1 \times k_2} & 2\mat{I}_{k_2} & 2\mat{Z} 
    \end{pmatrix}
    =\mat{G}^{\code{C}},
  \end{IEEEeqnarray*}
  where $\mat{X},\mat{Y}$ and $\mat{Z}$ are matrices with binary entries. Since $\mat{G}^{\code{C}_\textnormal{D}} = \mat{G}^{\code{C}}$, both constructions generate the same code in $\Integers_4$, and consequently, the same lattice when terms of the form $4\Integers^n$ are added.
\end{IEEEproof}

\end{comment}  


\subsection{Formally Self-Dual $\Integers_4$-Linear Codes from Nested Binary Codes}
\label{sec:FSD-Z4-codes_nested-binary-codes}

In this subsection, we present a novel construction of formally self-dual codes over $\Integers_4$ via two nested binary linear codes $\code{A}_1\subseteq\code{A}_2$.

\begin{proposition}[{\cite[Lemma 2.1]{BonnecazeSoleCalderbank95_1}}]
  \label{prop:Z4-linear_ConsC}
  Consider two binary linear codes $\code{A}_1\subseteq\code{A}_2$, and let $\code{C}=\code{A}_1+2\code{A}_2\eqdef\{\vect{a}_1+2\vect{a}_2\colon\vect{a}_1\in\code{A}_1,\vect{a}_2\in\code{A}_2\}$. Then, the code $\code{C}$ over $\Integers_4$ is linear if and only if $\code{A}_1 \subseteq \code{A}_2$ is closed under the element-wise product.
\end{proposition}
On one hand, the condition that the chain $\code{A}_1 \subseteq \code{A}_2$ is closed under element-wise product guarantees that  $\ConstrC{\code{A}_1}{\code{A}_2}$ as in~\eqref{eq:construction_c} is a lattice. % and $\ConstrC{\code{A}_1}{\code{A}_2} = \Lambda_{\textnormal{D}}(\code{A}_1, \code{A}_2)$.
On the other hand, $\code{C}$ being $\Integers_4$-linear assures that $\ConstrAfour{\code{C}}$ is a lattice. Therefore, Proposition~\ref{prop:Z4-linear_ConsC} standardizes the $2$-level Construction C and Construction $\textnormal{A}_4$, together with their respective conditions to be a lattice.

The dual of a $\Integers_4$-linear code $\code{C}=\code{A}_1+2\code{A}_2$ can be described as follows.
\begin{lemma}
  \label{lem:dual_C1-2C2}
  Let $\code{C} = \code{A}_1 + 2\code{A}_2$ be a $\Integers_4$-linear code. Then, $\code{C}^\perp = \code{A}_2^\perp + 2\code{A}_1^\perp$.
\end{lemma}
\begin{IEEEproof}
  First, notice that $\code{A}_2^\perp \subseteq \code{A}_1^\perp$. Since $\code{C} = \code{A}_1 + 2\code{A}_2$ is linear over $\Integers_4$, $\code{A}_1 \subseteq \code{A}_2$ is closed under element-wise product. We next show that $\code{A}_2^\perp + 2\code{A}_1^\perp \subseteq \code{C}^\perp$. Consider an element $\vect{a}'_2 + 2\vect{a}'_1 \in \code{A}_2^\perp + 2\code{A}_1^\perp$ and $\vect{a}_1 + 2\vect{a}_2 \in \code{C}$. Then, 
  \begin{IEEEeqnarray}{c}
    \inner{\vect{a}'_2 + 2\vect{a}'_1}{\vect{a}_1 + 2\vect{a}_2}=\inner{\vect{a}'_2}{\vect{a}_1}+2\inner{\vect{a}'_2}{\vect{a}_2}+ 2\inner{\vect{a}'_1}{\vect{a}_1}+ 4\inner{\vect{a}'_1}{\vect{a}_2}\equiv 0 \pmod 4.
  \end{IEEEeqnarray}
  Therefore, $\vect{a}'_2 + 2\vect{a}'_1 \in \code{C}^\perp$. Now, based on the arguments presented in \cite[pp.~33--34]{ConwaySloane93_1}, we observe that $|\code{C}| |\code{C}^\perp| = |\code{A}_1||\code{A}_2||\code{A}_1^\perp||\code{A}_2^\perp| = 2^{k_1}2^{k_2}2^{n-k_1}2^{n-k_2} = 2^{2n} = 4^n$, which is the dimension of $\Integers_4^n$ and here, $k_1$ is the dimension of $\code{A}_1$ and $k_2$ is the dimension of $\code{A}_2$. The proof is then complete.
\end{IEEEproof}

Lemma~\ref{lem:dual_C1-2C2} implies that if $\code{A}_2 = \code{A}_1^\perp$, then $\code{C}=\code{C}^\perp$ and $\code{C}$ is self-dual.

The result below gives a condition to construct formally self-dual $\Integers_4$-linear codes.    
\begin{theorem}
  \label{thm:FSD-Z4codes_A1plus2A2}
  Let $\code{C} = \code{A}_1 + 2\code{A}_2$ be a $\Integers_4$-linear code. If $W_{\code{A}_1}(x,y) = W_{\code{A}_2^\perp}(x,y)$ and $W_{\code{A}_2}(x,y) = W_{\code{A}_1^\perp}(x,y)$, then $\code{C}$ is formally self-dual. 
\end{theorem}
\begin{IEEEproof}
  We start the proof by using the following useful identities~\cite[Ch.~5, pp.~148]{MacWilliamsSloane77_1}:
  \begin{IEEEeqnarray}{rCl}
    \we{\code{A}_1}(x,y)\we{\code{A}_2}(z,t)& = &\jwe{\code{A}_1}{\code{A}_2}(xz,xt,yz,yt),
    \label{eq:wes-jwe_C1-C2}
    \\
    \jwe{\code{A}_1}{\code{A}_2}(a,b,c,d)& = &\jwe{\code{A}_2}{\code{A}_1}(a,c,b,d).
    \label{eq:swap_jwe_C1-C2}
  \end{IEEEeqnarray}
  Observe that
  \begin{IEEEeqnarray*}{rCl}
    \IEEEeqnarraymulticol{3}{l}{%
      \jwe{\code{A}_1}{\code{A}_2}(xz,xt,yz,yt)}\nonumber\\*\quad%
    & = &\we{\code{A}_1}(x,y)\we{\code{A}_2}(z,t)
    \nonumber\\
    & \stackrel{(i)}{=} &\frac{1}{\card{\dual{\code{A}}_1}}\we{\dual{\code{A}}_1}(x+y,x-y)\frac{1}{\card{\dual{\code{A}}_2}}\we{\dual{\code{A}}_2}(z+t,z-t)
    \nonumber\\
    & \stackrel{(ii)}{=} &\frac{1}{\card{\dual{\code{A}}_1}}\we{\code{A}_2}(x+y,x-y)\frac{1}{\card{\dual{\code{A}}_2}}\we{\code{A}_1}(z+t,z-t)
    \nonumber\\
    & \stackrel{\eqref{eq:wes-jwe_C1-C2}}{=} &\frac{1}{\card{\dual{\code{A}}_2}\card{\dual{\code{A}}_1}}\jwe{\code{A}_2}{\code{A}_1}\bigl(xz+xt+yz+yt, xz-xt+yz-yt,
    \nonumber\\
    % && \hspace*{3.00cm}\> xz-xt+yz-yt, \nonumber\\
    && \hspace*{3.00cm}\> xz+xt-yz-yt, xz-xt-yz+yt \bigr) \nonumber
    % && \hspace*{3.00cm}\> xz-xt-yz+yt \bigr)\IEEEeqnarraynumspace
    \nonumber\\
    & \stackrel{\eqref{eq:swap_jwe_C1-C2}}{=} &\frac{1}{\card{\dual{\code{A}}_1}\card{\dual{\code{A}}_2}}\jwe{\code{A}_1}{\code{A}_2}\bigl(xz+xt+yz+xt,xz+xt-yz-yt,
    \nonumber\\
    % && \hspace*{3.00cm}\> xz+xt-yz-yt,\nonumber\\
    && \hspace*{3.00cm}\> xz-xt+yz-yt, xz-xt-yz+yt \bigr) \nonumber
    % && \hspace*{3.00cm}\> xz-xt-yz+yt \bigr),\nonumber\IEEEeqnarraynumspace
  \end{IEEEeqnarray*}
  where $(i)$ follows by the MacWilliams identity and $(ii)$ holds because $W_{\code{A}_2}(x,y) = W_{\dual{\code{A}}_1}(x,y)$ and $W_{\code{A}_1}(z,t) = W_{\dual{\code{A}}_2}(z,t)$. Thus, we have% the MacWilliams identity for jwe of $\code{A}_1$ and $\code{A}_2$ is satisfied~\cite[eq.~(51), Ch.~5]{MacWilliamsSloane77_1}, i.e.,
  \begin{IEEEeqnarray}{rCl}
    \IEEEeqnarraymulticol{3}{l}{%
      \jwe{\code{A}_1}{\code{A}_2}(a,b,c,d)}\nonumber\\*\,%
    & = &\frac{1}{\card{\dual{\code{A}}_1}\card{\dual{\code{A}}_2}}\jwe{\code{A}_1}{\code{A}_2}(a+b+c+d,a+b-c-d,\nonumber\\
    && \hspace*{3.00cm}\> a-b+c-d,a-b-c+d).
    \label{eq:identity_jwe-relation}\IEEEeqnarraynumspace
  \end{IEEEeqnarray}
  Now, from Proposition~\ref{prop:Z4-linear_ConsC}, Lemma~\ref{lem:dual_C1-2C2}, and the fact that $\swe{\code{C}}(a,b,c)=\swe{\code{A}_1+2\code{A}_2}(a,b,c)=\jwe{\code{A}_1}{\code{A}_2}(a,c,b,b)$, we  further get
  \begin{IEEEeqnarray}{rCl}
    \IEEEeqnarraymulticol{3}{l}{%\
      \frac{1}{\card{\dual{\code{A}}_1}\card{\dual{\code{A}}_2}}\swe{\dual{\code{C}}}(a+c+2b,a-c,a+c-2b)}\nonumber\\*\quad%
    & \stackrel{\eqref{eq:swe-MacWilliams-identity_Z4}}{=} &  \swe{\code{C}}(a,b,c)=\swe{\code{A}_1+2\code{A}_2}(a,b,c)
    \label{eq:use_swe-MacWilliams-identity_Z4}\\
    & = &\jwe{\code{A}_1}{\code{A}_2}(a,c,b,b)
    \nonumber\\
    & \stackrel{\eqref{eq:identity_jwe-relation}}{=} &\frac{1}{\card{\dual{\code{A}}_2}\card{\dual{\code{A}}_1}}\jwe{\code{A}_1}{\code{A}_2}(a+c+2b,a+c-2b, a-c,a-c) \nonumber
    % && \hspace*{3.00cm}\> a-c,a-c)
    \nonumber\\
    & = &\frac{1}{\card{\dual{\code{A}}_1}\card{\dual{\code{A}}_2}}\swe{\code{C}}(a+c+2b,a-c,a+c-2b).
    \label{eq:relation_swe-jwe}\IEEEeqnarraynumspace
  \end{IEEEeqnarray}
  Therefore, by comparing~\eqref{eq:use_swe-MacWilliams-identity_Z4} with~\eqref{eq:relation_swe-jwe}, we obtain $\swe{\code{C}}=\swe{\dual{\code{C}}}$. This completes the proof.
\end{IEEEproof}

We remark that the result of Theorem~\ref{thm:FSD-Z4codes_A1plus2A2} holds only if $\code{A}_1$ and $\code{A}_2$ have even length, due to the restriction on their weight enumerators.

\begin{example}
  \label{ex:codes_dim12}
  Consider $\code{A}_1$ as the $[12,2,8]$ binary code and $\code{A}_2$ as the $[12,10,2]$ binary code, generated respectively by
  \begin{IEEEeqnarray*}{c}
    \mat{G}^{\code{A}_1}=
    \left(\begin{smallmatrix}
      1 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 1
      \\
      0 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 1
    \end{smallmatrix}\right),\,
    % \\
    \mat{G}^{\code{A}_2}=
    \left(\begin{smallmatrix}
      1 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 1
      \\
      0 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 1
      \\
      0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 1
      \\
      0 & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 0
      \\
      0 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 1
      \\
      0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 1
      \\
      0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 1 & 1 & 1
      \\
      0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 0
      \\
      0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 0
      \\
      0 & 0 & 1 & 0 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 1
    \end{smallmatrix}\right).\IEEEeqnarraynumspace
  \end{IEEEeqnarray*}
  
  Observe that the first two rows of $\mat{G}^{\code{A}_2}$ correspond to the generators of $\code{A}_1$ and the third is the element-wise product between them. Therefore, we have a guarantee that $\code{A}_1 \subseteq \code{A}_2$ and this chain is closed under the element-wise product. Hence, $\code{C}=\code{A}_1+2\code{A}_2$ is a $\Integers_4$-linear code.
  
  The two codes $\code{A}_1$ and $\code{A}_2$ satisfy the conditions of Theorem~\ref{thm:FSD-Z4codes_A1plus2A2}, i.e.,  $W_{\code{A}_1}(x,y) = W_{\code{A}_2^\perp}(x,y)$ and $W_{\code{A}_2}(x,y) = W_{\code{A}_1^\perp}(x,y)$, but $\code{A}_2 \neq \code{A}_1^\perp$. The swe of $\code{C}$ is 
  \begin{IEEEeqnarray*}{rCl}
    \swe{\code{C}}(a,b,c)& = & a^{12}+1152 a^2 b^8 c^2+768 a^3 b^8 c +192 a^4 b^8 +18 a^{10} c^2+64 a^9 c^3 
    \nonumber\\
    && +\>111 a^8 b^4+192 a^7 c^5 +252 a^6 c^6 + 192 a^5 c^7 +111 a^4 c^8+64 a^3 c^9 
    \nonumber\\
    && +\>18 a^2 c^{10}+768 a b^8 c^3+192 b^8 c^4+c^{12},
  \end{IEEEeqnarray*}
  which satisfy the MacWilliams identity~\eqref{eq:swe-MacWilliams-identity_FSD-codes_Z4}, hence it is formally self-dual in $\Integers_4$. Moreover, $d_{\textnormal{Lee}}(\code{C})=4$, which is not optimal for this length, but coincides with the best Lee distance of self-dual codes~\cite[Table IV]{YooLeeKim17_1}.\hfill\exampleend
\end{example}
This construction will be of particular interest when $\code{A}_1$ and $\code{A}_2$ are chosen to be Reed-Muller codes and consequently generate Barnes-Wall lattices (see Section~\ref{sec:secrecy-gain_FSD-Z4-codes_A1plus2A2}).

\subsection{Double Circulant Construction and its Odd Extension}
\label{sec:double-circulant-its-odd-extension}

\subsubsection{Double Circulant Code (DCC)}
\label{sec:double-circulant-code}

The \emph{double circulant code (DCC)} is an important class of \emph{even-length} isodual codes (see, e.g.,~\cite[Ch.~9.8]{HuffmanPless03_1} or~\cite{BachocGulliverHarada00_1}), which consists of two subclasses of codes, namely the \emph{pure double circulant code (PDCC)} and the \emph{bordered double circulant code (BDCC)}. A PDCC and a BDCC have the generator matrices of the form
\begin{IEEEeqnarray}{c}
  \mat{G}^{\code{C}_\textnormal{pdc}}=
  \begin{pmatrix}
    \mat{I}_{\eta} & \mat{B}_{\eta}^{\textnormal{pc}}
  \end{pmatrix}\eqdef
  \begin{pmatrix}
    \mat{I}_{\eta} & \mat{R}_\eta
  \end{pmatrix}\quad\textnormal{and}\quad
  \mat{G}^{\code{C}_\textnormal{bdc}}=
  \begin{pmatrix}
    \mat{I}_{\eta} & \mat{B}_{\eta}^{\textnormal{bc}}
  \end{pmatrix}
  \eqdef
  \begin{pNiceMatrix}
    \Block[c]{4-4}<\Large>{\mat{I}_{\eta}} & & & & \alpha & \beta & \Cdots & \beta
    \\
    & & & & \gamma & \Block[c]{3-3}<\Large>{\mat{R}_{\eta-1}}  & & 
    \\
    & & & & \Vdots &  &  &  
    \\
    & & & & \gamma &  &  &  
  \end{pNiceMatrix},
  \label{eq:double-circulant-matrices}
\end{IEEEeqnarray}
respectively, where $\alpha, \beta, \gamma\in\Integers_4$, and
\begin{IEEEeqnarray}{c}
  \mat{R}_{\eta}\eqdef
  \begin{pNiceMatrix}
    r_1    & r_2 & r_3 & \cdots & r_\eta
    \\
    r_\eta & r_1 & r_2 & \cdots & r_{\eta-1}
    \\
    \vdots &  \vdots & \vdots  & \ddots &  \vdots
    \\
    r_2 & r_3 & r_4 & \cdots & r_{1}      
  \end{pNiceMatrix}
  \label{eq:def_circulant-matrix}
  % \quad\textnormal{and}\quad
  % \mat{B}_{\eta}^{\textnormal{bc}} =
  % \begin{pNiceMatrix}
  %   \alpha & \beta & \beta  & \hdots & \beta
  %   \\
  %   \gamma & b_1 & b_2 & \dots & b_{\eta-1}
  %   \\
  %   \gamma & b_{\eta-1} & b_1 & \dots & b_{\eta-2}
  %   \\
  %   \vdots & \vdots &  \vdots  & \vdots &  \vdots
  %   \\
  %   \gamma & b_2 & b_3 & \dots & b_{1}
  % \end{pNiceMatrix},
\end{IEEEeqnarray}
represents a \emph{circulant square matrix} of size $\eta\in\Naturals$, $r_i\in\Integers_4$, $i\in [1:\eta]$.

\subsubsection{Odd Extension of DCC}
\label{sec:odd-extension_DCC}

It is known that there exist self-dual codes of odd lengths over $\Integers_4$~\cite[Ch.~12.5]{HuffmanPless03_1}. In this work, we propose the odd-length code $\code{C}_\textnormal{oext}$ with a generator matrix of the form
\begin{IEEEeqnarray}{c}
  \mat{G}^{\code{C}_{\textnormal{oext}}}\eqdef
  \begin{pNiceMatrix}
    \Block[c]{3-3}<\Large>{\mat{I}_{\eta}} & & & a_1    & \Block{3-4}<\Large>{\mat{B}_{\eta}} & & & 
    \\
    &               &                          & \Vdots & & & & 
    \\
    &               &                          & a_\eta & & & & 
    \\
    0 & \Cdots & 0                             & 2      & 2c_1 & 2c_{2} & \Cdots & 2c_\eta
  \end{pNiceMatrix},
  \label{eq:def_odd-extension-G}
\end{IEEEeqnarray}
where $\mat{B}_{\eta}=\mat{B}_{\eta}^{\textnormal{pc}}$ or $\mat{B}_{\eta}^{\textnormal{bc}}$. We call such code an \textit{odd extension} code from a DCC. This code construction is inspired by~\eqref{eq:generator_cs} with $k_1=\eta$ and $k_2=1$, where $\mat{A}$ and $\mat{C}$ are chosen to be $\mat{A}=\trans{\vect{a}}=\trans{(a_1,\cdots, a_\eta)}$ and $\mat{C}=\vect{c}=(c_1, c_2, \cdots, c_\eta)$, respectively, $a_i,c_i\in\Integers_2$, $i\in[\eta]$. % This construction can be defined for a general choice of $\mat{B}_{\eta}$, however, we will mostly consider the case where $\mat{B}_{\eta} = \mat{B}_{\eta}$ is a pure or bordered circulant matrix as in~\eqref{eq:double-circulant-matrices}.
    
As observed in \cite[p.~378]{HuffmanPless03_1}, pure double circulant codes are always isodual, and bordered double circulant codes are isodual if $\beta=\gamma=0$ or both $\beta$ and $\gamma$ are nonzero. An extensive list of optimal codes over $\Integers_4$ with respect to the minimum Lee weight is double circulant, see~\cite{BachocGulliverHarada00_1, GulliverHarada01_1}. The following result concerns the non-existence of pure double circulant self-dual codes.

\begin{proposition}[{\cite[Th.~5.1]{DoughertyGulliverHarada99_1}}]
  \label{prop:non-self-dual_PDCC_Z4}
  There exists no pure double circulant self-dual code over $\Integers_4$.
\end{proposition}

One can also obtain formally self-dual codes, particularly isodual codes, from the double circulant construction (see Section~\ref{sec:double-circulant-its-odd-extension}). For bordered double circulant codes, the following result holds.
\begin{theorem}
  \label{thm:self-duality_BDCC} 
  If a BDCC $\code{C}_{\textnormal{bdc}}$ is self-dual, then the conditions i)--iv) all hold.
  \begin{enumerate}[nosep,label=\roman*)]
  \item $\alpha^2 + (\eta-1) \beta^2 \equiv 3 \pmod 4$,
  \item $\alpha\gamma+\beta \sum_{i=1}^{\eta-1} r_{i}  \equiv 0 \pmod 4$,
  \item $\gamma^2 + \sum_{i=1}^{\eta-1} r_i^2 \equiv 3 \pmod 4$,
  \item $(\eta -2)\gamma^2 + 2\sum_{i=1}^{\eta-1} \sum_{j=i+1}^{\eta-1} r_i r_j \equiv 0 \pmod 4$,
  \end{enumerate}
  where $\vect{r}=(r_1,\ldots,r_{\eta-1})$ is the first row of $\mat{R}_{\eta-1}$ defined in~\eqref{eq:def_circulant-matrix}.
\end{theorem}
\begin{IEEEproof} 
  If a BDCC $\code{C}_{\textnormal{bdc}}$ is self-dual, then $\mat{G}^{\code{C}_{\textnormal{bdc}}}\trans{(\mat{G}^{\code{C}_{\textnormal{bdc}}})} = \bigl(\mat{I}_{\eta}\,\,\,\mat{B}^{\textnormal{bc}}_\eta\bigr)\begin{psmallmatrix}\mat{I}_{\eta}\\ \trans{(\mat{B}^{\textnormal{bc}}_\eta)} \end{psmallmatrix}=\mat{O}_{\eta}$, and we have $\mat{B}^{\textnormal{bc}}\trans{\bigl(\mat{B}^{\textnormal{bc}}\bigr)} = -\mat{I}_{\eta}$. From~\eqref{eq:double-circulant-matrices}, this gives
  \begin{IEEEeqnarray*}{c}
    \begin{pNiceMatrix}
      \alpha & \beta & \Cdots & \beta
      \\
      \gamma & \Block[c]{3-3}<\Large>{\mat{R}_{\eta-1}}  & & 
      \\
      \Vdots &  &  &  
      \\
      \gamma &  &  &  
    \end{pNiceMatrix}
    \begin{pNiceMatrix}
      \alpha & \gamma & \Cdots & \gamma
      \\
      \beta & \Block[c]{3-3}<\Large>{\trans{\mat{R}_{\eta-1}}}  & & 
      \\
      \Vdots &  &  &  
      \\
      \beta &  &  &  
    \end{pNiceMatrix}
    =-\mat{I}_\eta.
  \end{IEEEeqnarray*}
  By comparing the matrix entries of the above equality, one can conclude that
  \begin{IEEEeqnarray}{c}\label{eq:conditions_selfdual}
    \begin{cases}
      \alpha^2+(\eta - 1)\beta^2 = -1
      \\
      \alpha\gamma + \beta \sum_{i=1}^{\eta -1} r_{i} = 0
      \\
      \gamma^2 + \sum_{i=1}^{\eta -1} r_i^2 = -1
      \\
      (\eta -2)\gamma^2 + 2\sum_{i=1}^{\eta-1} \sum_{j=i+1}^{\eta-1} r_i r_j = 0.
    \end{cases}
  \end{IEEEeqnarray}
  Hence, from the above conditions i)--iv) arise.
\end{IEEEproof}
  
\begin{remark}
  From conditions iii) and iv), we particularly observe that
  \begin{IEEEeqnarray}{rCl}
     (r_1 + \cdots + r_{\eta -1})^2& = &\sum_{i=1}^{\eta-1} r_i^2 + 2 \sum_{i=1}^{\eta-1} \sum_{j=i+1}^{\eta-1} r_i r_j
    \nonumber \\
    & = & -1 - \gamma^2 - (\eta-2)\gamma^2 = -1 + (1-\eta)\gamma^2.
    \label{eq:squares_r-sum}
  \end{IEEEeqnarray}
  Since $x^2 \equiv 0 \textnormal{ or }1 \pmod 4,\,\forall\,x\in\Integers_4$, \eqref{eq:squares_r-sum} implies that $-1 + (1-\eta)\gamma^2$ can only be $0 \pmod 4$ or $1 \pmod 4$. Hence, we can conclude that the condition iv) of Theorem~\ref{thm:self-duality_BDCC} also leads to
  \begin{IEEEeqnarray*}{c}
    \begin{cases}
      \gamma^2 \equiv 1 \pmod 4 \textnormal{ and }\eta\equiv 0 \pmod 4 & \textnormal{if } (\sum_{i=1}^{\eta-1}r_i)^2 \equiv 0 \pmod 4,
      \\
      \gamma^2 \equiv 1 \pmod 4 \textnormal{ and }\eta \equiv 3 \pmod 4 & \textnormal{if } (\sum_{i=1}^{\eta-1}r_i)^2 \equiv 1 \pmod 4.
    \end{cases}    
  \end{IEEEeqnarray*}
  % $\gamma^2 \equiv 1 \pmod 4$ and $\eta \equiv 0 \pmod 4$, if $(r_1+\cdots+r_{\eta-1})^2 \equiv 0 \pmod 4$, or $\eta \equiv 3 \pmod 4$, if $s^2 \equiv 1 \pmod 4$. 
\end{remark}

% \begin{example}
%   Consider a BDCC $\code{C}_{\textnormal{bdc}}$ of length $8$ with generator matrix
%   \begin{IEEEeqnarray}{c}
%     \mat{G}^{\code{C}_\textnormal{bdc}} =
%     \begin{pNiceMatrix}
%       1 & 0 & 0 & 0 & 2 & 1 & 1 & 1\\
%       0 & 1 & 0 & 0 & 1 & 1 & 2 & 3 \\
%       0 & 0 & 1 & 0 & 1 & 3 & 1 & 2 \\
%       0 & 0 & 0 & 1 & 1 & 2 & 3 & 1
%     \end{pNiceMatrix}.
%   \end{IEEEeqnarray}
%   Here, $\alpha^2 + (\eta - 1)\beta^2 = 4 + 3 \equiv 3 \pmod 4$, $\alpha\gamma + \beta \sum_{i=1}^\eta r_{i}  = 2 + 6 \equiv 0 \pmod 4$, $\eta = 4 \equiv 0 \pmod 4$, $\gamma^2 = 1 \equiv 1 \pmod 4$, and $(\eta -2)\gamma^2 + 2\sum_{i < j} r_i r_j = 24  \equiv 0 \pmod 4$. Hence, all the conditions of Theorem~\ref{thm:self-duality_BDCC} are satisfied, which implies that $\code{C}$ is self-dual.\hfill\exampleend
% \end{example}

\begin{example}
  \label{ex:double_circulant_fsd}
  Consider a BDCC $\code{C}_{\textnormal{bdc}}$ of length $4$ with $\alpha=0, \gamma=2$ and $\beta=2$, and its dual code $\code{C}_{\textnormal{bdc}}^\perp$, generated respectively by
  \begin{IEEEeqnarray*}{c}
    \mat{G}^{\code{C}_{\textnormal{bdc}}}=
    \begin{pNiceMatrix}
      1 & 0 & 0 & 2
      \\
      0 & 1 & 2 & 1
    \end{pNiceMatrix},\quad
    \mat{G}^{\code{C}_{\textnormal{bdc}}^\perp}=
    \begin{pNiceMatrix}
      0 & 2 & 1 & 0
      \\
      2 & 3 & 0 & 1
     \end{pNiceMatrix}.
  \end{IEEEeqnarray*}
  
  Observe that $\mat{G}^{\code{C}_{\textnormal{bdc}}}\trans{(\mat{G}^{\code{C}_{\textnormal{bdc}}})} \neq \mat{O_{2}}$, and indeed, $\mat{G}^{\code{C}_{\textnormal{bdc}}}$ does not meet the conditions in Theorem~\ref{thm:self-duality_BDCC}. Therefore the code is not self-dual. However, its weight enumerator $\swe{\code{C}_{{\textnormal{bdc}}}}(a,b,c) =a^4+a^3 c+4 a^2 b c+a^2 c^2+2 a b^2 c+a c^3+4 b^3 c+2 b^2 c^2$ satisfies the MacWilliams identity~\eqref{eq:swe-MacWilliams-identity_Z4}, meaning that the code is formally self-dual in $\Integers_4$. 
  Moreover, one can notice that the code $\code{C}_{\textnormal{bdc}}$ is indeed isodual, since $\beta$ and $\gamma$ are nonzero, and in addition to that $\mat{G}^{\code{C}_{\textnormal{bdc}}} = \mat{G}^{\code{C}_{\textnormal{bdc}}^\perp}\mat{Q}$, where
  \begin{IEEEeqnarray*}{c}
    \mat{Q}=
    \begin{pNiceMatrix}
      0 & 0 & 1 & 0 \\
      0 & 0 & 0 & -1 \\
      1 & 0 & 0 & 0 \\
      0 & 1 & 0 & 0 \\
    \end{pNiceMatrix}.
  \end{IEEEeqnarray*}
  % We also would like to remark that we can have formally self-dual codes that are not self-dual nor isodual. If we consider the following code $\code{C}'$ and its dual $\code{C}'^\perp$, generated respectively by
%      \begin{IEEEeqnarray*}{c}
%        \mat{G}_{\code{C}'}=\left(\begin{smallmatrix}
%       1 & 0 & 0 & 1 \\
%       0 & 1 & 1 & 1
%      \end{smallmatrix}\right),~ \mat{G}_{\code{C}'^\perp}=\left(\begin{smallmatrix}
%       0 & 3 & 1 & 0 \\
%       3 & 3 & 0 & 1
%      \end{smallmatrix}\right),
%   \end{IEEEeqnarray*} 
%   we can observe that the first condition of Theorem~\ref{thm:bordered-self-dual} is not satisfied for the choices of $\alpha$ and $\beta$, which implies that $\code{C}$ is not self-dual. Also, 
  \hfill\exampleend
\end{example}

\begin{example}
\label{ex:FSD-not-SD-codes_n12-14-16}
  The BDCCs of length $12$, $14$, and $16$, presented in Table~\ref{tab:long-table_FSD-Z4-codes-swes-SGs} of Appendix~\ref{sec:all-FSD-Z4-codes-swes-SGs}, fail conditions $\textnormal{i)}, \textnormal{iii)}$ and $\textnormal{ii)}$ of Theorem~\ref{thm:self-duality_BDCC}, respectively. Hence, they are all formally-self dual but not self-dual.
  \hfill\exampleend
\end{example}

\begin{comment} %% comment out as we need to fix the conditions and proof
    
The following result states a sufficient condition for an odd extension code to be formally self-dual.
\begin{proposition}
  \label{prop:fsd_odd_extension}
  Consider an odd extension code $\code{C}_\textnormal{oext}$ with a generator matrix $\mat{G}^{\code{C}_{\textnormal{oext}}}$ as in~\eqref{eq:def_odd-extension-G}. Let $\mat{B}'\eqdef-\trans{\mat{B}}-\trans{\vect{c}}\vect{a}$, $r=\textnormal{rank}(\mat{B})=\textnormal{rank}(\mat{B}')$, and $\code{C}^{\mat{X}}$ the code generated by the $r$ linearly independent rows of a matrix $\mat{X}$. If $n_1(\vect{c})=n_1({\vect{a}})$, $2\vect{c} \in \code{C}^{\mat{B}}$, $2\vect{a} \in \code{C}^{\mat{B}'}$, and $\swe{\code{C}^{\mat{B}}}(a,b,c)=\swe{\code{C}^{\mat{B}'}}(a,b,c)$, then $\code{C}_{\textnormal{oext}}$ is formally self-dual. 
\end{proposition}% xxx
\begin{IEEEproof}
  From~\eqref{eq:Generator_Matrix} and \eqref{eq:Generator_Matrix_Dual}, the generator matrices of $\code{C}_{\textnormal{oext}}$ and its dual are given by
  \begin{IEEEeqnarray*}{c}
    \mat{G}^{\code{C}_{\textnormal{oext}}}=    
    \begin{pNiceMatrix}
      \Block[c]{3-3}<\large>{\mat{I}_{\eta}} & & & a_1    & \Block{3-4}<\large>{\mat{B}_{\eta}} & & & 
      \\
      &               &                          & \Vdots & & & & 
      \\
      &               &                          & a_\eta & & & & 
      \\
      0 & \Cdots & 0                             & 2      & 2c_1 & 2c_{2} & \Cdots & 2c_\eta
    \end{pNiceMatrix},\,\mat{G}^{\code{C}^\perp_{\textnormal{oext}}}=
    \begin{pNiceMatrix}
      \Block[c]{3-3}<\large>{-\trans{\mat{B}}_\eta-\trans{\vect{c}}\vect{a}} & & & c_1    & \Block{3-4}<\large>{\mat{I}_{\eta}} & & & 
      \\
      &               &                          & \Vdots & & & & 
      \\
      &               &                          & c_\eta & & & & 
      \\
      2a_1 & \Cdots & 2a_\eta                    & 2      & 0 & 0 & \Cdots & 0
    \end{pNiceMatrix}.\IEEEeqnarraynumspace
  \end{IEEEeqnarray*}

  Consider a vector $\vect{u}=(u_1, \dots, u_\eta, u_{\eta+1}) \in \Integers_4^{\eta}\times\Integers_2$. An element $\vect{v} = \vect{u} \mat{G}^{\code{C}_{\textnormal{oext}}}\in\code{C}_{\textnormal{oext}}$ is of the form
  \begin{IEEEeqnarray}{c}
  \label{eq:v_in_coext}
    \vect{v} = \biggl(\underbrace{u_1,\ldots,u_\eta}_{\vect{v}_1 \in \Integers_4^{\eta}},\underbrace{\sum_{i=1}^\eta u_i a_i + 2u_{\eta+1}}_{\vect{v}_2 \in \langle \vect{a} \rangle ~\text{or}~ \langle\vect{a} \rangle +2},\underbrace{\sum_{i=1}^{\eta} b_{i,1}u_i + 2c_1u_{\eta+1},\ldots,\sum_{i=1}^{\eta} b_{i,\eta}u_i + 2c_\eta u_{\eta+1}}_{\vect{v}_3 \in \code{C}^{\mat{B}}} \biggr),
  \end{IEEEeqnarray}
  where $\langle \vect{x} \rangle$ denotes the $\textit{Span}(\vect{x})$. Likewise, an element $\vect{v}' = \vect{u}\mat{G}^{\code{C}_{\textnormal{oext}}^\perp}$ can be written as
  \begin{IEEEeqnarray}{c}
  \label{eq:vp_in_coextt}
    \vect{v}' = \biggl(\underbrace{\sum_{i=1}^{\eta} b'_{i,1}u_i + 2a_1u_{\eta+1},\ldots,\sum_{i=1}^{\eta} b'_{i,\eta}u_i + 2a_\eta u_{\eta+1}}_{\vect{v}_3' \in \code{C}^{\mat{B}'}}, \underbrace{\sum_{i=1}^\eta u_i c_i + 2u_{\eta+1}}_{\vect{v}_2' \in \langle \vect{c} \rangle ~\text{or}~\langle \vect{c} \rangle +2}, \underbrace{u_1, \ldots, u_\eta}_{\vect{v}_1' \in \Integers_4^{\eta}} \biggr).
  \end{IEEEeqnarray}
  Observe that, in \eqref{eq:v_in_coext} and \eqref{eq:vp_in_coextt}, we can claim that $\vect{v}_3 \in \code{C}^{\mat{B}}$ and $\vect{v}_3 \in \code{C}^{\mat{B}'}$, respectively, because by hypothesis $2\vect{c} \in \code{C}^{\mat{B}}$ and $2\vect{a} \in \code{C}^{\mat{B}'}$. 
  
  We want to demonstrate that $\swe{\code{C}_{\textnormal{oext}}}(a,b,c)=\swe{\code{C}_{\textnormal{oext}}^\perp}(a,b,c)$.   Since $n_0(\vect{v}) = n_0(\vect{v}_1)+n_0(\vect{v}_2)+n_0(\vect{v}_3) = N_0(\vect{v}_1,\vect{v}_2,\vect{v}_3)$, $n_1(\vect{v})+n_3(\vect{v}) = (n_1(\vect{v}_1)+n_3(\vect{v}_1))+(n_1(\vect{v}_2)+n_3(\vect{v}_2))+(n_1(\vect{v}_3)+n_3(\vect{v}_3))=N_1(\vect{v}_1,\vect{v}_2,\vect{v}_3) + N_3(\vect{v}_1,\vect{v}_2,\vect{v}_3)$ and $n_2(\vect{v}) = n_2(\vect{v}_1)+n_2(\vect{v}_2)+n_2(\vect{v}_3)=N_2(\vect{v}_1,\vect{v}_2,\vect{v}_3)$, we have that
  \begin{IEEEeqnarray}{rCl}
  \label{eq:swe_coext}
  \swe{\code{C}_{\textnormal{oext}}}(a,b,c) & = & \sum_{\vect{v}\in\code{C}_{\textnormal{oext}}} a^{n_0(\vect{v})}b^{n_1(\vect{v})+n_3(\vect{v})}c^{n_2(\vect{v})} \nonumber \\
  & = & \sum_{\vect{v}_1 \in \Integers_4^{\eta}} \sum_{\substack {\vect{v}_2 \in \langle \vect{a} \rangle \text{or} \\ \vect{v}_2 \in \langle \vect{a}\rangle +2}} \sum_{\vect{v}_3 \in \code{C}^{\mat{B}}} a^{N_0(\vect{v}_1,\vect{v}_2,\vect{v}_3)}b^{N_1(\vect{v}_1,\vect{v}_2,\vect{v}_3) + N_3(\vect{v}_1,\vect{v}_2,\vect{v}_3)}c^{N_2(\vect{v}_1,\vect{v}_2,\vect{v}_3)}.
  \end{IEEEeqnarray}

    By hypothesis, $\swe{\code{C}^{\mat{B}}}(a,b,c)=\swe{\code{C}^{\mat{B}'}}(a,b,c)$. Therefore, it holds
    \begin{IEEEeqnarray}{c}
    \label{eq:equality_v3}
    \sum_{\vect{v}_3 \in\code{C}_{\code{C}^{\mat{B}}
    }} a^{n_0(\vect{v}_3)}b^{n_1(\vect{v}_3)+n_3(\vect{v}_3)}c^{n_2(\vect{v}_3)} = \sum_{\vect{v}_3' \in\code{C}_{\code{C}^{\mat{B}'}
    }} a^{n_0(\vect{v}_3')}b^{n_1(\vect{v}_3')+n_3(\vect{v}_3')}c^{n_2(\vect{v}_3')}.     
    \end{IEEEeqnarray}

    Also, since $\vect{a}, \vect{c} \in \Integers_2^{\eta}$ and $n_1(\vect{a}) = n_1(\vect{c})$, it follows that 
    \begin{IEEEeqnarray}{c}
    \label{eq: equality_v2}
    \sum_{\substack {\vect{v}_2 \in \langle \vect{a} \rangle \text{or} \\ \vect{v}_2 \in \langle \vect{a}\rangle +2}} a^{n_0(\vect{v}_2)}b^{n_1(\vect{v}_2)+n_2(\vect{v}_3)}c^{n_2(\vect{v}_2)} = \sum_{\substack {\vect{v}_2 \in \langle \vect{c} \rangle \text{or} \\ \vect{v}_2 \in \langle \vect{c}\rangle +2}} a^{n_0(\vect{v}_2')}b^{n_1(\vect{v}_2')+n_3(\vect{v}_2')}c^{n_2(\vect{v}_2')}.
    \end{IEEEeqnarray}

    Considering \eqref{eq: equality_v2} and \eqref{eq:equality_v3} in \eqref{eq:swe_coext}, we get
    \begin{IEEEeqnarray*}{rCl}
    \swe{\code{C}_{\textnormal{oext}}}(a,b,c) & = & \sum_{\vect{v}_1 \in \Integers_4^{\eta}} \sum_{\substack {\vect{v}_2 \in \langle \vect{a} \rangle \text{or} \\ \vect{v}_2 \in \langle \vect{a}\rangle +2}} \sum_{\vect{v}_3 \in \code{C}^{\mat{B}}} a^{N_0(\vect{v}_1,\vect{v}_2,\vect{v}_3)}b^{N_1(\vect{v}_1,\vect{v}_2,\vect{v}_3) + N_3(\vect{v}_1,\vect{v}_2,\vect{v}_3)}c^{N_2(\vect{v}_1,\vect{v}_2,\vect{v}_3)} \\
    & = & \sum_{\vect{v}_1' \in \Integers_4^{\eta}} \sum_{\substack {\vect{v}_2' \in \langle \vect{a} \rangle \text{or} \\ \vect{v}_2' \in \langle \vect{a}\rangle +2}} \sum_{\vect{v}_3' \in \code{C}^{\mat{B}}} a^{N_0(\vect{v}_1',\vect{v}_2',\vect{v}_3')}b^{N_1(\vect{v}_1',\vect{v}_2',\vect{v}_3') + N_3(\vect{v}_1',\vect{v}_2',\vect{v}_3')}c^{N_2(\vect{v}_1',\vect{v}_2',\vect{v}_3')} \\
    & = & \sum_{\vect{v'}\in\code{C}_{\textnormal{oext}}^{\perp}} a^{n_0(\vect{v}')}b^{n_1(\vect{v}')+n_3(\vect{v}')}c^{n_2(\vect{v}')} = \swe{\code{C}_{\textnormal{oext}}^{\perp}}(a,b,c),
    \end{IEEEeqnarray*}
    as we wanted to demonstrate.
\end{IEEEproof}

\begin{example}
  \label{ex:fsd-odd-extension}
  Consider a $[13,2^{13}]$ code $\code{C}_{\textnormal{oext}}$ over $\Integers_4$ generated as in~\eqref{eq:def_odd-extension-G}, where 
  \begin{IEEEeqnarray*}{c}
    \mat{B}=
    \begin{pNiceMatrix}
      0 & 2 & 1 & 2 & 2 & 2 \\
      2 & 0 & 2 & 1 & 2 & 2 \\
      2 & 2 & 0 & 2 & 1 & 2 \\
      2 & 2 & 2 & 0 & 2 & 1 \\
      1 & 2 & 2 & 2 & 0 & 2 \\
      2 & 1 & 2 & 2 & 2 & 0
    \end{pNiceMatrix}
  \end{IEEEeqnarray*}
  is a pure double circulant matrix, $\vect{c}=(0,0,0,0,1,1)$ and $\vect{a}=\trans{(0,0,1,1,0,0)}$. Observe that $n_1(\vect{c})=n_1({\vect{a}})$. Also, we have that in the generator matrix of the code $\code{C}_{\textnormal{oext}}^{\perp}$,
  \begin{IEEEeqnarray*}{c}
    \mat{B}'=-\trans{\mat{B}}-\trans{\vect{c}}\vect{a}
    = \begin{pNiceMatrix}
      0 & 2 & 2 & 2 & 3 & 2 \\
      2 & 0 & 2 & 2 & 2 & 3 \\
      3 & 2 & 0 & 2 & 2 & 2 \\
      2 & 3 & 2 & 0 & 2 & 2 \\
      2 & 2 & 2 & 1 & 2 & 0 \\
      2 & 2 & 1 & 2 & 0 & 2 
    \end{pNiceMatrix}.
  \end{IEEEeqnarray*}
  Observe that $\swe{\code{C}^{\mat{B}}}(a,b,c) = \swe{\code{C}^{\mat{B}'}}(a,b,c) =a^6+12 a^5 b+6 a^5 c+60 a^4 b^2+60 a^4 b c+15 a^4 c^2+160 a^3 b^3+240 a^3 b^2 c+120 a^3 b c^2+20 a^3 c^3+240 a^2 b^4+480 a^2 b^3 c+360 a^2 b^2 c^2+120 a^2 b c^3+15 a^2 c^4+192 a b^5+480 a b^4 c+480 a b^3 c^2+240 a b^2 c^3+60 a b c^4+6 a c^5+64 b^6+192 b^5 c+240 b^4 c^2+160 b^3 c^3+60 b^2 c^4+12 b c^5+c^6$. Since the swe contains the factor $15a^4c^2$, all permutations of $(2,2,0,0,0,0)$ belong to $\code{C}^{\mat{B}}$ and also to $\code{C}^{\mat{B}'}$, which implies that $2\vect{a} \in \code{C}^{\mat{B}'}$ and $2\vect{c} \in \code{C}^{\mat{B}}$.
  Therefore, all hypotheses of Proposition~\ref{prop:fsd_odd_extension} are satisfied and it follows that $\code{C}_{\textnormal{oext}}$ is formally self-dual.\hfill\exampleend
\end{example}

\end{comment}

We also give conditions for an odd extension code to be self-dual.
\begin{proposition}
  \label{prop:odd-extension-sel-dual} 
  Consider an odd extension code $\code{C}_{\textnormal{oext}}$ generated by $\mat{G}^{\code{C}_{\textnormal{oext}}}$ as in~\eqref{eq:def_odd-extension-G}. Then, $\code{C}_{\textnormal{oext}}$ is self-dual if and only if the following conditions hold
  \begin{enumerate}[nosep,label=\roman*)]
  \item $\trans{\vect{a}}\vect{a}+\mat{B}\trans{\mat{B}}\equiv 3\mat{I}_{\eta} \pmod 4$,
  \item $2\vect{a} + 2\vect{c}\trans{\mat{B}}\equiv \vect{0} \pmod 4$.
  \end{enumerate}
\end{proposition}
\begin{IEEEproof}
  Since $\code{C}_\textnormal{oext}$ is self-dual if and only if $\mat{G}^{\code{C}_\textnormal{oext}}\trans{\bigl(\mat{G}^\code{C}_{\textnormal{oext}}\bigr)}=\mat{O}_{\eta+1}$, we have
  \begin{IEEEeqnarray*}{c}
    \begin{pNiceMatrix}
      \mat{I}_{\eta} &\trans{\vect{a}} & \mat{B}_{\eta}
      \\
      \vect{0}       & 2               & 2\vect{c}
    \end{pNiceMatrix}
    \begin{pNiceMatrix}
      \mat{I}_{\eta} &\trans{\vect{0}} 
      \\
      \vect{a}       & 2               
      \\
      \trans{\mat{B}_{\eta}} & \trans{\vect{c}}
    \end{pNiceMatrix}
    =\mat{O}_{\eta+1}
  \end{IEEEeqnarray*}
  by using $\mat{G}^{\code{C}_\textnormal{oext}}$ as in~\eqref{eq:def_odd-extension-G}. Thus, this gives that $\mat{I}+\trans{\vect{a}}\vect{a}+\mat{B}\trans{\mat{B}}=\mat{O}_{\eta}$ and $2\vect{a} + 2\vect{c}\trans{\mat{B}}\equiv\vect{0} \pmod 4$, which leads to conditions i) and ii) stated in the proposition.
\end{IEEEproof}

\begin{example}
  \label{ex:n13k6_oextCode}
  Consider a $[13,2^{13}]$ formally self-dual code $\code{C}_{\textnormal{oext}}$ over $\Integers_4$ generated as in~\eqref{eq:def_odd-extension-G}, where 
  \begin{IEEEeqnarray*}{c}
    \mat{B}^{\textnormal{pc}}=
    \begin{pNiceMatrix}
      0 & 2 & 1 & 2 & 2 & 2 \\
      2 & 0 & 2 & 1 & 2 & 2 \\
      2 & 2 & 0 & 2 & 1 & 2 \\
      2 & 2 & 2 & 0 & 2 & 1 \\
      1 & 2 & 2 & 2 & 0 & 2 \\
      2 & 1 & 2 & 2 & 2 & 0
    \end{pNiceMatrix}
  \end{IEEEeqnarray*}
  is a pure double circulant matrix, $\vect{c}=(0,0,0,0,1,1)$ and $\vect{a}=\trans{(0,0,1,1,0,0)}$. Since
  \begin{IEEEeqnarray*}{c}
    \trans{\vect{a}}\vect{a}+\mat{B}\trans{\mat{B}}= 
    \begin{pNiceMatrix}
      1 & 0 & 2 & 0 & 2 & 0
      \\
      0 & 1 & 0 & 2 & 0 & 2
      \\
      2 & 0 & 2 & 1 & 2 & 0
      \\
      0 & 2 & 1 & 2 & 0 & 2
      \\
      2 & 0 & 2 & 0 & 1 & 0
      \\
      0 & 2 & 0 & 2 & 0 & 1 
    \end{pNiceMatrix} \neq -\mat{I}_{6},
  \end{IEEEeqnarray*}
  this implies that $\code{C}_{\textnormal{oext}}$ is not self-dual. \hfill\exampleend
\end{example}

\begin{example}
  \label{ex:n9k14k21_Coext}
  One can verify that the code $\code{C}_\textnormal{oext}$ with generator matrix 
  \begin{IEEEeqnarray*}{c}
    \mat{G}^{\code{C}_{\textnormal{oext}}} =
    \begin{pNiceMatrix}
      1 & 0 & 0 & 0 & 0 & 2 & 1 & 1 & 1
      \\
      0 & 1 & 0 & 0 & 0 & 1 & 1 & 2 & 3
      \\
      0 & 0 & 1 & 0 & 0 & 1 & 3 & 1 & 2
      \\
      0 & 0 & 0 & 1 & 0 & 1 & 2 & 3 & 1
      \\
      0 & 0 & 0 & 0 & 2 & 0 & 0 & 0 & 0
    \end{pNiceMatrix}
  \end{IEEEeqnarray*}
  satisfies the conditions of Proposition~\ref{prop:odd-extension-sel-dual}, and therefore it is self-dual.\hfill\exampleend
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Theta Series of $2$-Level Construction C and Construction $\textnormal{A}_4$ Lattices}
\label{sec:theta-series_2-level-ConstrC-ConstructionAfour-lattices}

\subsection{$2$-Level Construction C Lattices}
\label{sec:2-level-ConstructionC-lattices}

From the fact that a $2$-level Construction C is geometrically uniform for any choice of binary linear codes $\code{A}_1$ and $\code{A}_2$, we can state the following result.
\begin{theorem}
  \label{thm:theta-series_2-level-constructionC}
  Consider a $2$-level Construction C packing given by $\PConstrC{\code{A}_1}{\code{A}_2} = \frac{1}{2}(\code{A}_1 + 2\code{A}_2 + 4\mathbb{Z}^n),$ where $\code{A}_1, \code{A}_2$ are binary linear codes. The theta series of $\PConstrC{\code{A}_1}{\code{A}_2}$ is
  % \begin{IEEEeqnarray*}{rCl}
  %   \IEEEeqnarraymulticol{3}{l}{%
  %   \Theta_{\PConstrC{\code{A}_1}{\code{A}_2}}(z)}\nonumber\\*\quad%
  %   & = &\sum_{\vect{c}_1 \in \code{A}_1} \sum_{\vect{c}_2 \in \code{A}_2} \vartheta_3^{d_{0,0}}(4z) \left(\frac{\vartheta_{2}(z)}{2}\right)^{{d_{1,0}} + {d_{1,1}}}  \vartheta_2^{{d_{0,1}}}(4z).
  % \end{IEEEeqnarray*}  
  \begin{IEEEeqnarray*}{c}
    \Theta_{\PConstrC{\code{A}_1}{{\code{A}_2}}(z)}
    = \sum_{\vect{a}_1 \in \code{A}_1} \sum_{\vect{a}_2 \in \code{A}_2} \vartheta_3^{d_{0,0}}(4z) \left(\frac{\vartheta_{2}(z)}{2}\right)^{{d_{1,0}} + {d_{1,1}}}  \vartheta_2^{{d_{0,1}}}(4z).
  \end{IEEEeqnarray*}
\end{theorem}

For the proof of this theorem, we will use Proposition~\ref{prop:thm_thetanonl}, which considers the expression of the theta series of a periodic packing~\cite{OdlyzkoSloane80_1}.
\begin{proposition}[\cite{OdlyzkoSloane80_1}]
  \label{prop:thm_thetanonl} 
  Given a periodic packing $\Gamma = \bigcup_{k=1}^{M} (\Lambda + \vect{u}_k)$, where $\Lambda \subset \Reals^n$  is a lattice and ${\bm u}_1, \dots, {\bm u}_M \in \Reals^n$ are the  $M$ coset representatives. Then
  \begin{IEEEeqnarray}{c}
    \Theta_\Gamma(z) = \Theta_\Lambda(z) + \dfrac{2}{M} \displaystyle\sum_{k< \ell}\displaystyle\sum_{{\bm \lambda} \in \Lambda} q^{\|{\bm \lambda}+{\bm u}_k-{\bm u}_\ell \|^2}.
  \end{IEEEeqnarray}
  % \begin{align}
  %   \Theta_\Gamma(z) & = \dfrac{1}{M} \displaystyle\sum_{k=1}^{M}  \displaystyle\sum_{\ell=1}^{M}  \displaystyle\sum_{{\bm \lambda} \in \Lambda} q^{\|{\bm \lambda}+{\bm u}_k-{\bm u}_\ell \|^2} \nonumber \\
  %   & = \Theta_\Lambda(z) + \dfrac{2}{M} \displaystyle\sum_{k< \ell}\displaystyle\sum_{{\bm \lambda} \in \Lambda} q^{\|{\bm \lambda}+{\bm u}_k-{\bm u}_\ell \|^2}.
  % \end{align}
  For a geometrically uniform packing $\Gamma$, where the set of distances is preserved for every point, then it reduces to
  \begin{IEEEeqnarray}{c}
    \label{eq:theta_equidistance}
    \Theta_\Gamma(z) = \displaystyle\sum_{k=1}^{M}\displaystyle\sum_{{\bm \lambda} \in \Lambda} q^{\|{\bm \lambda}+{\bm u}_k-{\bm u}_1 \|^2}.
  \end{IEEEeqnarray}
\end{proposition}
\begin{IEEEproof}[Proof of Theorem~\ref{thm:theta-series_2-level-constructionC}]
  Packings obtained from Construction C are periodic and in particular, a $2$-level Construction C is geometrically uniform, so we can apply Proposition~\ref{prop:thm_thetanonl}, more specifically, \eqref{eq:theta_equidistance}.
  
  In~\eqref{eq:theta_equidistance}, we identify $\vect{\lambda}\in 4\Integers^n$, $M=\ecard{\code{A}_1}\ecard{\code{A}_2}$, and $\vect{u}_1=(0,\dots,0)$, since $\code{A}_1, \code{A}_2$ are linear codes and thus contain the zero codeword. Notice that in our context, ${\bm u}_k \in \code{A}_1+ 2\code{A}_2$ and initially, let us fix $k$ and set ${\bm u} ={\bm u}_k$ to simplify.
  
  As ${\bm u} \in \code{A}_1+2\code{A}_2$, there exist $\vect{a}_{1} \in \code{A}_1$ and $\vect{a}_{2} \in \code{A}_2$ such that ${\bm u} = \vect{a}_{1} + 2\vect{a}_{2}$.
  The coordinates of ${\bm u}$ can be $0,1, 2,$ or $3$ and their recurrences are given respectively by $d_{0,0}(\vect{a}_{1}, \vect{a}_{2}),$ $d_{1,0}(\vect{a}_{1}, \vect{a}_{2}), d_{0,1}(\vect{a}_{1}, \vect{a}_{2})$, and $d_{1,1}(\vect{a}_{1}, \vect{a}_{2})$, as in~\eqref{eq:def_d00}-\eqref{eq:def_d11}.
  
  By fixing the $i$-th coordinate of ${\bm u},$ we have as possible exponents of $q$ in~\eqref{eq:theta_equidistance}  
  \begin{IEEEeqnarray}{c}
    4z_i + {\bm u}_{{i}} =
    \begin{cases}
      4z_i,                   & \textnormal{if } \vect{u}_{i}=0,
      \\
      4(z_i + \frac{1}{4}),  & \textnormal{if } \vect{u}_{i}=1,
      \\
      4(z_i + \frac{1}{2}),  & \textnormal{if } \vect{u}_{i}=2,
      \\
      4(z_i + \frac{3}{4}),  & \textnormal{if } \vect{u}_{i}=3.
    \end{cases}\label{eq:couting_4z}
  \end{IEEEeqnarray}
  
  The corresponding theta series associated to each one of the previous cases are
  \begin{IEEEeqnarray*}{rCl}
    \Theta_{4\mathbb{Z}}(z) = \vartheta_{3}(16z),\, \Theta_{4\big(\mathbb{Z}+ \frac{1}{2}\big)}(z) = \vartheta_{2}(16z),
    \nonumber \\
    \Theta_{4\big(\mathbb{Z}+\tfrac{1}{4}\big)}(z) = \Theta_{4\big(\mathbb{Z}+ \frac{3}{4}\big)}(z) = \frac{\vartheta_{2}(4z)}{2}, 
  \end{IEEEeqnarray*}
  
  By incorporating these  results into the fixed $n$-dimensional vector ${\bm u},$ we have that
  \begin{IEEEeqnarray*}{c}
    \sum_{{\bm z} \in \mathbb{Z}^n} q^{\|4{\bm z}+{\bm u} \|^2} = \vartheta_3^{d_{0,0}}(16z)  \left(\frac{\vartheta_{2}(4z)}{2}\right)^{{d_{1,0}}+ {d_{1,1}}} \vartheta_2^{d_{0,1}}(16z).
  \end{IEEEeqnarray*}
  
  Finally, running through all $k$ vectors ${\bm u}_k$ and considering the scaled version $\PConstrC{\code{A}_1}{\code{A}_2} = \frac{1}{2}(\code{A}_1 + 2\code{A}_2 + 4\mathbb{Z}^n),$ we get
  \begin{IEEEeqnarray}{rCl}
    \Theta_{\Gamma_\textnormal{C}}(z) &  = &   \displaystyle\sum_{k=1}^{M}\displaystyle\sum_{{\bm z} \in \mathbb{Z}^n} q^{\enorm{\frac{1}{2}(4{\bm z}+{\bm u}_k)}^2} \nonumber \\
    & = & \sum_{\vect{a}_{1_k} \in \code{A}_1} \sum_{\vect{a}_{2_k} \in \code{A}_2} \vartheta_3^{d_{0,0}}(4z) \left(\frac{\vartheta_{2}(z)}{2}\right)^{{d_{1,0}} + {d_{1,1}}}  \vartheta_2^{{d_{0,1}}}(4z),
    \label{eq:theta-series_GammaC}\IEEEeqnarraynumspace
  \end{IEEEeqnarray}
  where ${\bm u}_k = \vect{a}_{1_k} + 2\vect{a}_{2_k},$ for $\vect{a}_{1_k} \in \code{A}_1$ and $\vect{a}_{2_k} \in \code{A}_2$.
\end{IEEEproof}

% Denote by $\code{A}_1$ an $[n,{k_1}]$ code and $\code{A}_2$ an $[n,{k_1+k_2}]$ code. Once a $\Integers_4$-linear code $\code{C}$ can be expressed as $\code{A}_1+2\code{A}_2$, and the codes $\code{A}_1$ and $\code{A}_2$ are generated, respectively, by
% \begin{IEEEeqnarray*}{c}
%   \mat{G}_1 =
%   \begin{pmatrix}
%     \mat{I}_{k_1} & \mat{X} & \mat{Y}
%   \end{pmatrix},\quad
%   \mat{G}_2 =
%   \begin{pmatrix}
%     \mat{I}_{k_1} &\mat{X} & \mat{Y} \\
%     \mat{O}_{k_1 \times k_2} & \mat{I}_{k_2} & \mat{Z}
%   \end{pmatrix}.
% \end{IEEEeqnarray*}
% Then, the generator matrix $\mat{G}$ of $\code{C}$ as in~\eqref{eq:Generator_Matrix} becomes~\cite[Thm.~3]{ConwaySloane93_1}
% \begin{IEEEeqnarray}{c}
%   \mat{G}=\begin{pmatrix}
%     \mat{I}_{k_1} & \mat{X} & \mat{Y} \\
%     \mat{O}_{k_1 \times k_2} & 2\mat{I}_{k_2} & 2\mat{Z}
%     \label{eq:Generator_Matrix_C1C2}
%   \end{pmatrix}.
% \end{IEEEeqnarray}
% Up to now, we revised some results on the construction of $\Integers_4$-linear codes from two binary linear codes $\code{A}_1$ and $\code{A}_2$, and we notice that the lattice derived from them via Construction $\textnormal{A}_4$ (or analogously $2$-level Construction C) can have some properties, such as being unimodular or isodual.

Theorem~\ref{thm:theta-series_2-level-constructionC} is general and can also be applied to nonlattice packings. Next, we relate the theta series of $\PConstrC{\code{A}_1}{\code{A}_2}$ to the joint weight enumerator.
\begin{corollary}
  \label{coro:theta-series_2-level-ConstructionC}
  The theta series of a $2$-level Construction C packing, in terms of the jwe of two codes, is
  \begin{IEEEeqnarray*}{c}
    \Theta_{\PConstrC{\code{A}_1}{\code{A}_2}}(z)=\textnormal{jwe}_{\code{A}_1,\code{A}_2}\bigl(\vartheta_3(4z),\vartheta_2(4z), \nicefrac{\vartheta_2(z)}{2},\nicefrac{\vartheta_2(z)}{2} \bigr).\label{eq:Theta-ft_2-level-ConstructionC}%\IEEEeqnarraynumspace
  \end{IEEEeqnarray*}
\end{corollary}
Remark that Corollary~\ref{coro:theta-series_2-level-ConstructionC} also holds for the lattice case $\ConstrC{\code{A}_1}{\code{A}_2}$.

\subsection{Construction $\textnormal{A}_4$ Lattices}
\label{sec:ConstrAfour-lattices}

We now define a few extra notions of weight enumerators and derive an expression of the theta series of the lattice generated via Construction $\textnormal{A}_4$, given the swe of the $\Integers_4$-linear code $\code{C}$. 

If we consider the $\Integers_4$-linear code $\code{C}$, the theta series of a Construction $\textnormal{A}_4$ lattice can be expressed as follows.
\begin{corollary}
    \label{coro:theta-series_ConstrAfour}
  Let $\code{C}$ be a $\Integers_4$-linear code with $\swe{\code{C}}(a,b,c)$, then the theta series of $\ConstrAfour{\code{C}}$ is 
  \begin{IEEEeqnarray*}{c}
    \Theta_{\ConstrAfour{\code{C}}}(z) = \swe{\code{C}}(\vartheta_3(4z), \nicefrac{\vartheta_2(z)}{2}, \vartheta_2(4z)).
  \end{IEEEeqnarray*}
\end{corollary}
\begin{IEEEproof}
  If the $\Integers_4$-linear code $\code{C}$ is such that $\code{C}=\code{A}_1+2\code{A}_2$, the result comes immediately from Corollary~\ref{coro:theta-series_2-level-ConstructionC}, since $\swe{\code{C}}(a,b,c)=\textnormal{jwe}_{\code{A}_1,\code{A}_2}(a,c,b,b)$. For a general $\Integers_4$-linear code $\code{C}$, the same proof of Theorem~\ref{thm:theta-series_2-level-constructionC} can be applied, since $\ConstrAfour{\code{C}} = \frac{1}{2}\bigl(\code{C}+4\Integers^n\bigl)$ is also a periodic packing and the coordinates of an element in $\ConstrAfour{\code{C}}$ are also described as in \eqref{eq:couting_4z}. The only difference is that the exponents in \eqref{eq:theta-series_GammaC} are replaced by $n_0(\vect{w}), n_1(\vect{w})+n_3(\vect{w})$, and $n_2(\vect{w})$ respectively, where $\vect{w}\in\code{C}$, and one can see that the result follows.
\end{IEEEproof}
% We can conclude that the packing obtained from Construction $\textnormal{A}_4$ through $\code{A}_1+2\code{A}_2$ over $\Integers_4$ has exactly the same theta series as the packing constructed by the $2$-level Construction C via $\code{A}_1$ and $\code{A}_2$. Despite this equivalence, both results have their own importance, as Corollary~\ref{coro:theta-series_2-level-ConstructionC} can be applied to any choices of $\code{A}_1,\code{A}_2$ and Corollary~\ref{coro:theta-series_ConstrAfour} is restricted to lattices.

We also highlight the following results.
\begin{corollary}
  \label{cor:FSD_Z4-FUM-lattices}
  If $\code{C}$ is a formally self-dual $\Integers_4$-linear code, then $\ConstrAfour{\code{C}}$ is formally unimodular. Moreover, if a $\Integers_4$-linear code $\code{C}$ is of Type I, then $\ConstrAfour{\code{C}}$ is of Type I.
\end{corollary}
\begin{IEEEproof}
  The first statement is a direct consequence of Corollary~\ref{coro:theta-series_ConstrAfour}. Then, we only need to prove the Type I property for the formally unimodular lattice $\ConstrAfour{\code{C}}$. Since $\code{C}$ is of Type I, we know that the $\Ewt{\vect{c}}\in 4\Integers$ for any $\vect{c}\in\code{C}$. Since by definition, any two vectors $\vect{x}$, $\vect{x}'\in\ConstrAfour{\code{C}}$ can be represented by
  \begin{IEEEeqnarray*}{c}
    \vect{x}=\frac{1}{2}(\vect{c}+4\vect{z}),\quad\vect{x}'=\frac{1}{2}(\vect{c}'+4\vect{z}').
  \end{IEEEeqnarray*}
  
  Hence, we have
  \begin{IEEEeqnarray}{c}
    \inner{\vect{x}}{\vect{x}'}=\frac{1}{4}\inner{\vect{c}}{\vect{c}'}+\inner{\vect{c}}{\vect{z}'}+\inner{\vect{c}'}{\vect{z}}+
    4\inner{\vect{z}}{\vect{z}'}\label{eq:inner-product_two-lattice-vectors}.
  \end{IEEEeqnarray}

  Observe that
  \begin{IEEEeqnarray*}{c}
    \inner{2}{2}\equiv 0 \pmod 4,\quad\inner{1}{1}=\inner{1}{3}=\inner{3}{3}\equiv 1 \pmod 4,\quad\inner{1}{2}=\inner{2}{3} \equiv 2 \pmod 4,
  \end{IEEEeqnarray*}
  we can claim that $\inner{\vect{c}}{\vect{c}'}\in4\Integers$ if $\Ewt{\vect{c}},\Ewt{\vect{c}'}\in4\Integers$. Therefore, from~\eqref{eq:inner-product_two-lattice-vectors}, it implies that $\inner{\vect{x}}{\vect{x}'}\in\Integers$, which completes the proof.  
\end{IEEEproof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Secrecy Gain of Formally Unimodular Lattices}
\label{sec:secrecy-gain_FU-lattices}

\subsection{The Secrecy Function of a Lattice}
\label{sec:secrecy-function_lattice}
    
Lattices are primarily used in Gaussian wiretap channels with an analogous \textit{coset encoding}~\cite{Wyner75_1} idea, where two lattices are considered: $\Lambda_b$ to ensure reliability and $\Lambda_e\subset\Lambda_b$ to guarantee security. Minimizing the success probability of correctly guessing the transmitted message received by the eavesdropper is equivalent to minimizing the theta function of $\Lambda_\textnormal{e}$. This study leads to the definitions of secrecy function and secrecy gain for a lattice~\cite{OggierSoleBelfiore16_1}.

\begin{definition}[Secrecy function and secrecy gain~{\cite[Defs.~1 and~2]{OggierSoleBelfiore16_1}}]
  \label{def:secrecy_function}
  Let $\Lambda$ be a lattice with volume $\vol{\Lambda}=\nu^n$. The secrecy function of $\Lambda$ is defined by
  \begin{IEEEeqnarray*}{c}
    \Xi_{\Lambda}(\tau)\eqdef\frac{\Theta_{\nu\Integers^n}(i\tau)}{\Theta_{\Lambda}(i\tau)},
    \label{eq:def_secrecy-function}
  \end{IEEEeqnarray*} 
  for $\tau\eqdef -i z>0$. The \emph{(strong) secrecy gain} of a lattice is given by $\xi_{\Lambda}\eqdef\sup_{\tau>0}\Xi_{\Lambda}(\tau)$.
\end{definition}

It was shown in~\cite{OggierSoleBelfiore16_1} that the higher the secrecy gain of a lattice, the more security is provided by the lattice wiretap code. Hence, the objective here is to design a  lattice $\Lambda$ that achieves a high secrecy gain.

Under the design criterion of the secrecy function, we summarize the following three important observations for the formally unimodular lattices~\cite{BollaufLinYtrehus22_1}.
\begin{enumerate}
\item The secrecy function of a formally unimodular lattice $\Lambda$ has exactly the same \emph{symmetry point} at $\tau=1$ as a unimodular or an isodual lattice, i.e., $\Xi_\Lambda(\tau) = \Xi_\Lambda\bigl(\frac{1}{\tau}\bigr)$.
\item Similar to Belfiore and Sol{\'{e}}'s conjecture from~\cite{BelfioreSole10_1}, it is also conjectured that the secrecy function of a formally unimodular lattice $\Lambda$ achieves its maximum at $\tau=1$, i.e., $\xi_{\Lambda}=\Xi_{\Lambda}(1)$.
\item It was demonstrated that formally unimodular lattices can outperform the secrecy gain of unimodular lattices. % Below we present Construction $\textnormal{A}_4$ lattices that achieve a better secrecy gain than the ones known in the literature, where we refer to~\cite{OggierSoleBelfiore16_1,LinOggier13_1}.
In particular, the unimodular and formally unimodular lattices constructed via Construction A are compared, and it indicates that formally unimodular lattices obtained from formally self-dual codes via Construction A always achieve better secrecy gains than the Construction A unimodular lattices obtained from self-dual codes (see~\cite[Tab.~I]{BollaufLinYtrehus22_1} for details).
\end{enumerate}

Using these observations, we next explore the secrecy gain of formally unimodular lattices obtained by Construction $\textnormal{A}_4$ from formally self-dual codes over $\Integers_4$.

% One motivation to our study comes from the performance of the $\mathcal{I}\textnormal{BW}_{16}$ lattice in terms of secrecy gain.

% \begin{example}
% \label{ex:bw16}
% The symmetric weight enumerator of the $\Integers_4$-linear code $\code{C}_{16}$~\eqref{eq:c16} is
% \begin{IEEEeqnarray*}{rCl}
%   \swe{\code{C}_{16}}(a,b,c)  & = &  w^{16}+120 w^{14} y^2+ 1820 w^{12} y^4  \\
%  & & + 8008 w^{10} y^6+ 3840 w^8 x^8+12870 w^8 y^8\\
%  & & + 30720 w^7 x^8 y +107520 w^6 x^8 y^2  \\
%  & & + 8008 w^6 y^{10}+ 215040 w^5 x^8 y^3 \\
%  & & + 268800 w^4 x^8 y^4 +1820 w^4 y^{12}\\
%  & & + 215040 w^3 x^8 y^5 +107520 w^2 x^8 y^6 \\
%  & & + 120 w^2 y^{14} +30720 w x^8 y^7+3840 x^8 y^8\\
%  & & + 32768 x^{16}+y^{16}.
% \end{IEEEeqnarray*}   

% Applying the result of Corollary~\ref{coro:theta-series_ConstrAfour} to the isodual version $\mathcal{I}\textnormal{BW}_{16}$ lattice, we have that its theta function is given by 
% \begin{IEEEeqnarray*}{rCl}
% \Theta_{\mathcal{I}\textnormal{BW}_{16}}(z) = \swe{\code{C}_{16}}(\vartheta_3(4\sqrt{2}z), \nicefrac{\vartheta_2(\sqrt{2}z)}{2}, \vartheta_2(4\sqrt{2}z)).
% \end{IEEEeqnarray*}

% The secrecy gain of isodual lattices is achieved at $\tau=1$~\cite[Conjecture~1]{OggierSoleBelfiore16_1} and $\Xi_{\mathcal{I}\textnormal{BW}_{16}}(1) \approx 2.206$, which is higher than the values presented in~\cite{LinOggier13_1,BollaufLinYtrehus22_1} for unimodular lattices and formally unimodular lattices constructed via Construction A, respectively.
% Observe that we cannot apply Theorem~\ref{thm:inv_secrecy-function_SymmetrizedWeightEnumerator} here, because $\code{C}_{16}$ is not a formally self-dual code over $\Integers_4$. Therefore, $\code{C}$ being formally self-dual is not a necessary condition to have a formally unimodular Construction $\textnormal{A}_4$ lattice.
% \end{example}


\subsection{Secrecy Gain of Construction $\textnormal{A}_4$ Lattices obtained from Formally Self-Dual Codes over $\Integers_4$} 
\label{sec:secrecy-gain_ConstrAfour-lattices_fsd-codes_Z4}
    
In this subsection, we derive a closed-form expression of the theta series of a Construction $\textnormal{A}_4$ lattice obtained from a formally self-dual code $\code{C}$ over $\Integers_4$ and provide a new universal approach to derive the strong secrecy gain of the corresponding lattice. The result is stated in the following main theorem.
\begin{theorem}% xxx
  \label{thm:inv_secrecy-function_SymmetrizedWeightEnumerator}
  Let $\code{C}$ be a formally self-dual code over $\Integers_4$. Then
  \begin{IEEEeqnarray*}{c}
    \inv{\Bigl[\Xi_{\ConstrAfour{\code{C}}}(\tau)\Bigr]}=\frac{\swe{\code{C}}\bigl(1+t, \sqrt[4]{1-t^4}, 1-t\bigr)}{2^{n}},\label{eq:Xi-ft_ConstructionA_FSDcodes}\IEEEeqnarraynumspace
  \end{IEEEeqnarray*}
  where $0<t(\tau)\eqdef\nicefrac{\vartheta_4(i\tau)}{\vartheta_3(i\tau)} < 1$. Moreover, define $h_{\code{C}}(t)\eqdef\swe{\code{C}}\bigl(1+t, \sqrt[4]{1-t^4}, 1-t\bigr)$ for $0< t < 1$. Then, maximizing the secrecy function $\Xi_{\ConstrAfour{\code{C}}}(\tau)$ is equivalent to determining the minimum of $h_{\code{C}}(t)$ on $t\in(0,1)$.
\end{theorem}
\begin{IEEEproof}
From \eqref{eq:swe-MacWilliams-identity_FSD-codes_Z4} and the following identities from \cite[Eq.~(23), Ch.~4]{ConwaySloane99_1}, and \cite[Eq.~(31), Ch.~4]{ConwaySloane99_1}, respectively,
\begin{IEEEeqnarray}{rCl}
  \vartheta_3(z)+\vartheta_4(z)& = &2\vartheta_3(4z), \vartheta_3(z)-\vartheta_4(z)=2\vartheta_2(4z),\quad\label{eq:useful-identities-1}
  \\[1mm]
  \vartheta^4_2(z)+\vartheta^4_4(z)& = &\vartheta^4_3(z),\quad\label{eq:useful-identities-2}
\end{IEEEeqnarray}
we obtain
\begin{IEEEeqnarray}{rCl}
  \Theta_{\ConstrAfour{\code{C}}}(z)& = &\swe{\code{C}}(\vartheta_3(4z), \nicefrac{\vartheta_2(z)}{2}, \vartheta_2(4z))
  \nonumber\\
  & \stackrel{\eqref{eq:swe-MacWilliams-identity_FSD-codes_Z4}}{=} &\inv{\bigcard{\dual{\code{C}}}}\swe{\code{C}}\Big(\vartheta_3(4z)+2\frac{\vartheta_2(z)}{2}+\vartheta_2(4z), \vartheta_3(4z)-\vartheta_2(4z), \vartheta_3(4z)-2\frac{\vartheta_2(z)}{2}+\vartheta_2(4z) \Big) \nonumber \\
 % & & \vartheta_3(4z)-\vartheta_2(4z), \vartheta_3(4z)-2\frac{\vartheta_2(z)}{2}+\vartheta_2(4z) \Big) \nonumber\\
  & \stackrel{\eqref{eq:useful-identities-1}}{=} &\inv{\bigcard{\dual{\code{C}}}}\swe{\code{C}}\Big(\vartheta_3(z)+\vartheta_2(z), \vartheta_4(z), \vartheta_3(z)-\vartheta_2(z)\Big) \nonumber\\
  %& & \vartheta_3(z)-\vartheta_2(z)\Big)
  %\nonumber\\
  & \stackrel{\eqref{eq:swe-MacWilliams-identity_FSD-codes_Z4}}{=} &\bigcard{\dual{\code{C}}}^{-2}\swe{\code{C}}\Big(2\vartheta_3(z)+2\vartheta_4(z), 2\vartheta_2(z), 2\vartheta_3(z)-2\vartheta_4(z)\Big)  \nonumber\\
%  & & 
%  \nonumber\\
  & \stackrel{\eqref{eq:useful-identities-2}}{=} &\bigcard{\dual{\code{C}}}^{-2}\cdot 2^n\swe{\code{C}}\Bigl(\vartheta_3(z)+\vartheta_4(z), \sqrt[4]{\vartheta^4_3(z)-\vartheta^4_4(z)}, \vartheta_3(z)-\vartheta_4(z)\Bigr). \nonumber\\
  %& & \sqrt[4]{\vartheta^4_3(z)-\vartheta^4_4(z)}, \vartheta_3(z)-\vartheta_4(z)\Bigr).
  %\nonumber\\
  & = &2^{-n}\cdot\swe{\code{C}}\Bigl(\vartheta_3(z)+\vartheta_4(z), \sqrt[4]{\vartheta^4_3(z)-\vartheta^4_4(z)}, \vartheta_3(z)-\vartheta_4(z)\Bigr),\label{eq:theta-series_FSD-codes_Z4}\IEEEeqnarraynumspace  
  %& & \sqrt[4]{\vartheta^4_3(z)-\vartheta^4_4(z)}, %\vartheta_3(z)-\vartheta_4(z)\Bigr),\label{eq:theta-series_FSD-codes_Z4}
\end{IEEEeqnarray}
where \eqref{eq:theta-series_FSD-codes_Z4} holds since if $\code{C}$ is formally self-dual, $\card{\dual{\code{C}}}=4^{\nicefrac{n}{2}}$.

From Definition~\ref{def:secrecy_function}, the secrecy function of $\ConstrAfour{\code{C}}$ with volume $1$ becomes
  \begin{IEEEeqnarray*}{rCl}
    \inv{\Bigl[\Xi_{\ConstrAfour{\code{C}}}(\tau)\Bigr]}& = &\frac{\Theta_{\ConstrAfour{\code{C}}}(z)}{\Theta_{\Integers^n}(z)}
    \stackrel{(b)}{=}\frac{1}{2^{n}}\frac{\swe{\code{C}}\Bigl(\vartheta_3(z)+\vartheta_4(z), \sqrt[4]{\vartheta^4_3(z)-\vartheta^4_4(z)}, \vartheta_3(z)-\vartheta_4(z)\Bigr)}{\vartheta^n_3(z)}
    \\[1mm]
    & = &\frac{1}{2^{n}}\swe{\code{C}}\left(1+\frac{\vartheta_4(z)}{\vartheta_3(z)},\sqrt[4]{1-\frac{\vartheta^4_4(z)}{\vartheta^4_3(z)}}, 1-\frac{\vartheta_4(z)}{\vartheta_3(z)}\right)
    \\[1mm]
    & = &\frac{\swe{\code{C}}\bigl(1+t(\tau),\sqrt[4]{1-t^4(\tau)},1-t(\tau)\bigr)}{2^{n}},
  \end{IEEEeqnarray*}
  where $(b)$ holds because of $\Theta_{\Integers^n}(z)=\vartheta^n_3(z)$ and~\eqref{eq:theta-series_FSD-codes_Z4}. Lastly, using a similar argument as~\cite[Lemma 34 and Remark 35]{BollaufLinYtrehus22_3sub}, the second part of the theorem follows.
\end{IEEEproof}
\begin{example}
  \label{ex:FSDcode_dim8}
  Consider the formally self-dual code $\code{C}_8$ from~\cite[pp.~83--84]{BetsumiyaHarada03_1}, one can obtain
  \begin{IEEEeqnarray*}{rCl}
    \swe{\code{C}_{8}}(a,b,c)& = & c^8 + 64b^8 + 12a b^2 c^5 + 64a b^6 c +16 a^2 c^6\nonumber\\
    &&\, +\> 40a^3 b^2 c^3 + 30a^4 c^4 + 12a^5 b^2 c + 16a^6 c^2 + a^8.
  \end{IEEEeqnarray*} 
  Then, we have that $h_{\code{C}_8}(t) = 64 \bigl(2 t^8+t^6-\left(\sqrt{1-t^4}+2\right) t^4 -\left(\sqrt{1-t^4}-1\right) t^2+2 \left(\sqrt{1-t^4}+1\right)\bigr)$ and $h'_{\code{C}_8}(t)=0$ for $t=\nicefrac{1}{\sqrt[4]{2}}$, which can be numerically verified to be the global minimizer.\hfill\exampleend
\end{example}

\begin{example}
  \label{ex:optimal_codes}
  Gulliver and Harada presented in~\cite{GulliverHarada01_1} optimal formally self-dual codes over $\Integers_4$ in dimensions $6,8,10$ and $14$, together with their swe's. Each $h_{\code{C}_i}(t)$, $i=6,8,10,14$ achieves its minimum at $t=\nicefrac{1}{\sqrt[4]{2}}$. Therefore, we have $\xi_{\ConstrAfour{\code{C}_{6}}} \approx 1.172$, $\xi_{\ConstrAfour{\code{C}_{8}}} \approx 1.333$, $\xi_{\ConstrAfour{\code{C}_{10}}} \approx 1.379$, and $\xi_{\ConstrAfour{\code{C}_{14}}} \approx 1.871$, which coincide or are very close to best secrecy gains from~\cite[Tab.~I]{BollaufLinYtrehus22_1}.\hfill\exampleend
\end{example}

\begin{example}
  \label{ex:n22_FSD-code_Z4}
  In this example, we consider the swe of the isodual code $\code{D}_{4,22}$ presented in~\cite[p.~230, Prop.~4.2]{BachocGulliverHarada00_1}. Using Theorem~\ref{thm:inv_secrecy-function_SymmetrizedWeightEnumerator}, we get $\xi_{\ConstrAfour{\code{D}_{4,22}}}\approx 3.403$. We remark that the best-known secrecy gain for a formally unimodular lattice in this dimension is $3.34$, which is presented in~\cite[Tab.~I]{BollaufLinYtrehus22_1}. Therefore this result outperforms the current secrecy gain of lattices in dimension $22$.\hfill\exampleend
\end{example}

Next, we recall a general expression of $\swe{\code{C}}(a,b,c)$ from \emph{invariant theory} if $\code{C}$ is a Type I formally self-dual code over $\Integers_4$.
\begin{proposition}[{\cite[Eq.~(8.2.6)]{NebeRainsSloane06_1}}]
  \label{prop:swe_TypeI-FSDcodes_Z4}
  If $\code{C}$ is an $[n,2^{n}]$ Type I formally self-dual code over $\Integers_4$, then we have
  \begin{IEEEeqnarray}{c}
    \swe{\code{C}}(a,b,c)=\sum_{\substack{r,s\in\Integers\\0\leq 4r+8s\leq n}}\alpha_{r,s}A^{n-4r-8s}\bigl(B^4+C^4\bigr)^r\bigl(B^4C^4\bigr)^s,
    \label{eq:Gleason-theorem_TypeI-FSDcodes_Z4}
  \end{IEEEeqnarray}
  where $A=a+c, B=2b, C=a-c$, and $\alpha_{r,s}\in\Rationals$.
\end{proposition}

If $\code{C}$ is a Type I formally self-dual code over $\Integers_4$, then $h_{\code{C}}(t)$ can be expressed as follows.
\begin{lemma}
  \label{lem:hC_TypeI-FSDcodes_Z4}
  If $\code{C}$ is an $[n,2^{n}]$ Type I formally self-dual code over $\Integers_4$, then
  \begin{IEEEeqnarray}{c}
    h_{\code{C}}(t)=2^{n}\sum_{s=0}^{\lfloor\frac{n}{8}\rfloor}\beta_{s}(-t^8+t^4)^{s},    
    \label{eq:hC_TypeI-FSDcodes_Z4}
  \end{IEEEeqnarray}
  where $\beta_s\eqdef\sum_{r=0}^{\lfloor\frac{n-8s}{4}\rfloor}\alpha_{r,s}$ for $s\in [0:\lfloor\nicefrac{n}{8}\rfloor]$
\end{lemma}
\begin{IEEEproof}
  Let $a=1+t, b= \sqrt[4]{1-t^4}, c=1-t$. This gives
  \begin{IEEEeqnarray*}{rCl}
    A& = &a+c=1+t+1-t=2,
    \\
    B^4+C^4& = &(2b)^4+(a-c)^4=16(1-t^4)+(2t)^4=2^4,
    \\
    B^4C^4& = &(2b)^4(a-c)^4=16(1-t^4)(2t)^4=2^8t^4(1-t^4).
  \end{IEEEeqnarray*}
  Hence, from Theorem \ref{thm:inv_secrecy-function_SymmetrizedWeightEnumerator} and Proposition~\ref{prop:swe_TypeI-FSDcodes_Z4}, we have
  \begin{IEEEeqnarray*}{c}
    h_{\code{C}}(t)=\sum_{\substack{r,s\in\Integers\\0\leq 4r+8s\leq n}}\alpha_{r,s} 2^{n-4r-8s}\cdot (2^4)^r\cdot (2^8t^4(1-t^4))^s=2^{n}\sum_{s=0}^{\lfloor\frac{n}{8}\rfloor}\beta_{s}(-t^8+t^4)^{s},    
  \end{IEEEeqnarray*}
  where $\beta_s\eqdef\sum_{r=0}^{\lfloor\frac{n-8s}{4}\rfloor}\alpha_{r,s}$ for $s\in [0:\lfloor\nicefrac{n}{8}\rfloor]$.
\end{IEEEproof}

In the following, we provide a sufficient condition for a Construction $\textnormal{A}_4$ lattice obtained from a Type I formally self-dual code over $\Integers_4$ to achieve its (strong) secrecy gain at $\tau=1$, or, equivalently, $t=\nicefrac{1}{\sqrt[4]{2}}$. 
\begin{theorem}
  \label{thm:strong-secrecy-gain_TypeI-FSDcodes_Z4}
  Consider an $[n,2^{n}]$ Type I formally self-dual code $\code{C}$ over $\Integers_4$. If the coefficients $\beta_s$ of $h_{\code{C}}(t)$ expressed in terms of \eqref{eq:hC_TypeI-FSDcodes_Z4} satisfy
  \begin{IEEEeqnarray}{c}
    \sum_{s=1}^{\lfloor\frac{n}{8}\rfloor} s \beta_s\Bigl(\frac{1}{4}\Bigr)^{s-1} < 0,
    \label{eq:condition_beta_TypeI-FSDcodes_Z4}
  \end{IEEEeqnarray}
  then the secrecy gain of $\ConstrAfour{\code{C}}$ is achieved at $\tau=1$, or, equivalently, $t=\nicefrac{1}{\sqrt[4]{2}}$. Moreover,
  \begin{IEEEeqnarray}{c}
    \xi_{\ConstrAfour{\code{C}}}=\frac{1}{\sum_{s=0}^{\lfloor\frac{n}{8}\rfloor}\beta_s(\frac{1}{4})^s}.
    \label{eq:secrecy-gain_beta_TypeI-FSDcodes_Z4}
  \end{IEEEeqnarray}
\end{theorem}
\begin{IEEEproof}
  It is enough to show that the function $h_{\code{C}}(t)$ as in \eqref{eq:hC_TypeI-FSDcodes_Z4} defined for $0 < t < 1$ achieves its minimum at $t=\nicefrac{1}{\sqrt[4]{2}}$. 

  Define $N(t)\eqdef\sum_{s=1}^{\lfloor\frac{n}{8}\rfloor} s \beta_s (-t^8+t^4)^{s-1}$. Because of the hypothesis and the fact that $u(t)\eqdef-t^8+t^4 = -(t^4-\nicefrac{1}{2})^2+\nicefrac{1}{4}\leq\nicefrac{1}{4}$ on $t\in(0,1)$, we have $N(t)=\sum_{s=1}^{\lfloor\frac{n}{8}\rfloor} s \beta_s u^{s-1}(t)\leq\sum_{s=1}^{\lfloor\frac{n}{8}\rfloor}s\beta_s\bigl(\frac{1}{4}\bigr)^{s-1}<0$ on $t\in(0,1)$.
  
  Now, observe that the derivative of $h_{\code{C}}(t)$ is
  \begin{IEEEeqnarray*}{c}
    \frac{\dd h_{\code{C}}(t)}{\dd t} = 2^{n} u'(t) \sum_{s=1}^{\lfloor\frac{n}{8}\rfloor} s \beta_s u(t)^{s-1}= 2^{n} u'(t)N(t). 
  \end{IEEEeqnarray*} 
  Since
  \begin{IEEEeqnarray*}{c}
    u'(t)
    \begin{cases}
      >0 & \textnormal{if }0< t<\frac{1}{\sqrt[4]{2}},
      \\
      =0 & \textnormal{if }t=\frac{1}{\sqrt[4]{2}},
      \\
      <0 & \textnormal{if }\frac{1}{\sqrt[4]{2}}< t < 1,
    \end{cases}
  \end{IEEEeqnarray*}
  it implies that $h_{\code{C}}(t)$ is decreasing in $t\in(0,\nicefrac{1}{\sqrt[4]{2}})$ and increasing in $t\in(\nicefrac{1}{\sqrt[4]{2}},1)$. Finally, the expression of \eqref{eq:secrecy-gain_beta_TypeI-FSDcodes_Z4} follows directly from \eqref{eq:Xi-ft_ConstructionA_FSDcodes} and \eqref{eq:hC_TypeI-FSDcodes_Z4} by plugging $t=\nicefrac{1}{\sqrt[4]{2}}$. This completes the proof.
\end{IEEEproof}

\begin{example}[The Octacode $\code{O}_8$ and the Gosset lattice $\lattice{E}_8$]
  \label{ex:secrecy-gain_E8}
  Recall that in Example~\ref{ex:E8_octacode}, the octacode $\code{O}_8$ has the swe given by~\eqref{eq:swe_octacode}.
%   \begin{IEEEeqnarray*}{c}
%     \swe{\code{O}_8} (a,b,c)= a^8+16b^8+c^8+14a^4c^4+112a^3b^4c+112ab^4c^3.
%   \end{IEEEeqnarray*}  

  Now, by comparing the coefficients of $\swe{\code{O}_8}(a,b,c)$ with \eqref{eq:hC_TypeI-FSDcodes_Z4} in Lemma~\ref{lem:hC_TypeI-FSDcodes_Z4}, we find that $\beta_0=1$ and $\beta_{1}=-1$. Applying Theorem~\ref{thm:strong-secrecy-gain_TypeI-FSDcodes_Z4}, those coefficients satisfy \eqref{eq:condition_beta_TypeI-FSDcodes_Z4} ($\beta_1=-1<0$) and thus the secrecy gain is $\xi_{\ConstrAfour{\code{O}_8}}=\inv{\bigl(\sum_{s=0}^{\lfloor\nicefrac{n}{8}\rfloor}\beta_s(\nicefrac{1}{4})^s\bigr)}=\nicefrac{4}{3}$, which coincides with the best-known secrecy gain up to now for $n=8$. Note that we have $\xi_{\ConstrAfour{\code{O}_8}}=\nicefrac{4}{3}>\xi_{\ConstrAfour{\code{C}_8}}\approx 1.282$, where $\code{C}_8$ is the code presented in Example~\ref{ex:FSDcode_dim8}.\hfill\exampleend
\end{example}

\begin{example}[Dimension $26$ code from~\cite{Harada12_1}]
  \label{ex:secrecy-gain_26}
  Consider the $\Integers_4$-linear code $\code{C}_{26}$ with swe given in Appendix~\ref{sec:all-FSD-Z4-codes-swes-SGs}. We have that
  \begin{IEEEeqnarray*}{rCl}
     h_{\code{C}}(t)  =  \swe{\code{C}_{26}}(1+t, \sqrt[4]{1-t^4},1-t) & = & 40894464 t^{16}-81788928 t^{12}+258998272 t^8 \\
     & & -\>218103808 t^4+67108864.
  \end{IEEEeqnarray*}  
  
  Comparing this expression with \eqref{eq:hC_TypeI-FSDcodes_Z4}, we get that $\beta_0=1, \beta_1=-\nicefrac{13}{4}, \beta_2=\nicefrac{39}{64}$ and $\beta_3=0$. 
  From Theorem~\ref{thm:strong-secrecy-gain_TypeI-FSDcodes_Z4}, those coefficients satisfy \eqref{eq:condition_beta_TypeI-FSDcodes_Z4}, i.e., $\sum_{s=1}^{\lfloor\frac{n}{8}\rfloor} s \beta_s\Bigl(\frac{1}{4}\Bigr)^{s-1} = -\nicefrac{65}{32}<0$ and thus the secrecy gain is $\xi_{\ConstrAfour{\code{C}_{26}}}=\inv{\bigl(\sum_{s=0}^{\lfloor\nicefrac{n}{8}\rfloor}\beta_s(\nicefrac{1}{4})^s\bigr)}=\nicefrac{1024}{231} \approx 4.433$. \hfill\exampleend
\end{example}

% \vspace*{1mm}
% \todo[inline,author=Lin]{Check Theorem~\ref{thm:strong-secrecy-gain_TypeI-FSDcodes_Z4} for more Type I formally self-dual codes from~\cite{Harada12_1}.}

\subsection{An Upper Bound on the Secrecy Gain of Type I Formally Unimodular Lattices}
\label{sec:an-upper-bound_SG_TypeI-FUL}

In this subsection, a secrecy gain upper bound of Type I formally unimodular lattices is presented, either for even or odd dimensions. The derivation follows to~\cite[Section IV]{LinOggier12_1} similarly. However, our approach is based on the technique in our prior work that is sufficient to prove the Belfiore and Sol{\'{e}} conjecture for Construction~A formally unimodular packings obtained from formally self-dual codes~\cite{BollaufLinYtrehus22_3sub}. For the sake of completeness, we provide the corresponding proof.
\begin{lemma}
  \label{lem:upper-bound_SG_TypeI-FUL}
  For any $n$-dimensional Type I formally unimodular lattice $\Lambda$ that satisfies the Belfiore and Sol{\'{e}} conjecture with $2\leq n\leq 40$,\footnote{In fact, our upper bound results can be applied to dimension $n=168$ as \cite[Table~II]{LinOggier12_1}. However, as we only investigate formally unimodular Construction $\textnormal{A}_4$ lattices until dimensions $n=32$ in this work, we do not provide the upper bound for dimensions more than $n=40$.} the secrecy gain is bounded from above by
  \begin{IEEEeqnarray*}{rCl}
    \xi_{\Lambda}& \leq &\frac{1}{\trans{\vect{\omega}}\inv{\mat{S}}\vect{e}_1},
  \end{IEEEeqnarray*}
  where $\trans{\vect{\omega}}=\bigl(1,\nicefrac{3}{4},\ldots,(\nicefrac{3}{4})^\ell)$, $\mat{S}$ is an $(\ell+1) \times (\ell+1)$ matrix whose $(s+1)$-th column contains the first $\ell+1$ coefficients of the power series of $\vartheta_3^{n-8s}(z)\Theta_{\lattice{E}_8}(z)^s$ for $s\in [0:\ell]$, $\vect{e}_{s+1}$ is the vector with a $1$ in the $(s+1)$-th coordinate and zeros elsewhere, and $\ell\eqdef\lfloor\nicefrac{n}{8}\rfloor$.
\end{lemma}
\begin{IEEEproof}
  By definition, a Type I formally unimodular lattice satisfies
  \begin{IEEEeqnarray*}{c}
    \Theta_{\Lambda}(z)=\biggl(\frac{i}{z}\biggr)^{\frac{n}{2}}\Theta_{\Lambda}\Bigl(-\frac{1}{z}\Bigr)
    \textnormal{ and }
    \Theta_{\Lambda}(z+2)=\Theta_{\Lambda}(z).\label{eq:TypeI-FUL_Jacobi-formula}
  \end{IEEEeqnarray*}
  Thus, Hecke's theorem~\cite[Th.~7, Ch.~7]{ConwaySloane99_1} implies that its theta series can be represented by    
  \begin{IEEEeqnarray}{c}
    \Theta_\Lambda(z)=\sum_{r=0}^{\ell}a_r\vartheta_3^{n-8r}(z)\Delta_8^r(z),\label{eq:Hecke-theorem_Delta8}
  \end{IEEEeqnarray}
  where $\Delta_8(z)=\frac{1}{16}\vartheta_2^4(z)\vartheta_4^4(z)$ and $a_r\in\Rationals$.
  
  Since
  \begin{IEEEeqnarray*}{rCl}
    \vartheta^4_2(z)\vartheta^4_4(z)& \stackrel{\eqref{eq:useful-identities-2}}{=} &\bigl[\vartheta_3^4(z)-\vartheta_4^4(z)\bigr]\vartheta_4^4(z)
    =\bigl(\vartheta^2_3(z)\bigr)^4-\bigl[\vartheta^8_3(z)-\vartheta^4_3(z)\vartheta^4_4(z)+\vartheta^8_4(z)\bigr]
    \\
    & = &\bigl(\vartheta^2_3(z)\bigr)^4-\Theta_{\lattice{E}_8}(z),
  \end{IEEEeqnarray*}
  one can show that \eqref{eq:Hecke-theorem_Delta8} can also be expressed by
  \begin{IEEEeqnarray}{c}
    \Theta_\Lambda(z)=\sum_{s=0}^{\ell}n_s\vartheta_3^{n-8s}(z)\Theta_{\lattice{E}_8}^s(z)=\sum_{s=0}^{\ell}n_s\vartheta_3^{n-8s}(z)\bigl[\vartheta^8_3(z)-\vartheta^4_3(z)\vartheta^4_4(z)+\vartheta^8_4(z)\bigr]^s,\label{eq:Hecke-theorem_GossetE8}
  \end{IEEEeqnarray}
  where $n_s\in\Rationals$.
  
  Now, applying the same approach as the proof of~\cite[Th.~36]{BollaufLinYtrehus22_3sub}, we obtain
  \begin{IEEEeqnarray*}{rCl}
    \inv{\bigl[\Xi_{\Lambda}(\tau)\bigr]}& = &\frac{\Theta_{\Lambda}(z)}{\Theta_{\Integers^n}(z)}=\frac{\sum_{s=0}^{\ell}n_s\vartheta_3^{n-8s}(z)\bigl[\vartheta^8_3(z)-\vartheta^4_3(z)\vartheta^4_4(z)+\vartheta^8_4(z)\bigr]^s}{\vartheta^n_3(z)}
    \nonumber\\
    & = &\sum_{s=0}^{\ell}n_s\frac{\vartheta_3^{n-8s}(z)\bigl[\vartheta^8_3(z)-\vartheta^4_3(z)\vartheta^4_4(z)+\vartheta^8_4(z)\bigr]^s}{\vartheta^{n-8s}_3(z)\vartheta^{8s}_3(z)}
    \nonumber\\
    & = &\sum_{s=0}^{\ell}n_s\left[1-\frac{\vartheta^4_4(z)}{\vartheta^4_3(z)}+\frac{\vartheta^8_4(z)}{\vartheta^8_3(z)}\right]^s
    =\sum_{s=0}^{\ell}n_s[1-t^4+t^8]^s.
  \end{IEEEeqnarray*}
  Hence, if the secrecy function $\Xi_{\Lambda}(\tau)$ achieves its maximum at $\tau=1$, i.e., $t=\nicefrac{1}{\sqrt[4]{2}}$, the (strong) secrecy gain is equal to
  \begin{IEEEeqnarray}{c}
    \xi_{\Lambda}=\Xi_{\Lambda}(1)=\frac{1}{\sum_{s=0}^\ell n_s\bigl(\nicefrac{3}{4}\bigr)^s}.\label{eq:secrecy-gain_TypeI-FUL}
  \end{IEEEeqnarray}
  
  Next, to determine the coefficients of $\{n_s\}_{s=0}^\ell$, we re-write $\Theta_{\Lambda}(z)$ as
  \begin{IEEEeqnarray*}{rCl}
    \Theta_{\Lambda}(z)& \eqdef &\sum_{m=0}^\infty N_m q^m=\sum_{s=0}^{\ell}n_s\vartheta_3^{n-8s}(z)\bigl[\vartheta^8_3(z)-\vartheta^4_3(z)\vartheta^4_4(z)+\vartheta^8_4(z)\bigr]^s
    \IEEEyesnumber\label{eq:equaling-coefficients_theta-sereis_TypeI-FUL}\\
    & = &n_0\vartheta^n_3(z)+n_1\vartheta^{n-8}_3(z)\Theta_{\lattice{E}_8}(z)+\ldots+n_\ell\vartheta^{n-8\ell}_3(z)\Theta_{\lattice{E}_8}^\ell(z)
    \\
    & = &n_0(1+S_{2,1}q+S_{3,1}q^2+\ldots+S_{\ell+1,1}\cdot q^\ell)
    \nonumber\\
    && +\>n_1(1+S_{2,2}q+S_{3,2}q^2+\ldots+S_{\ell+1,2}\cdot q^\ell)+\ldots
    \nonumber\\
    && +\>n_\ell(1+S_{2,\ell}q+S_{3,\ell}q^2+\ldots+S_{\ell+1,\ell+1}\cdot q^\ell).
  \end{IEEEeqnarray*}
  Denote by $\vect{n}\eqdef\trans{(n_0,n_1\ldots,n_\ell)}$ and $\vect{N}\eqdef\trans{(N_0,N_1,\ldots,N_\ell)}$, it is no so hard to obtain the following system of linear equations:
  \begin{IEEEeqnarray*}{c}
    \begin{pmatrix}
      1 & 1 & \cdots & 1
      \\
      S_{2,1} & S_{2,2} & \cdots & S_{2,\ell+1}
      \\
      S_{3,1} & S_{3,2} & \cdots & S_{3,\ell+1}
      \\
      \vdots
      \\
      S_{\ell+1,1} & S_{\ell+1,2} & \cdots & S_{\ell+1,\ell+1}
    \end{pmatrix}
    \begin{pmatrix}
      n_0
      \\
      n_1
      \\
      n_2
      \\
      \vdots
      \\
      n_\ell
    \end{pmatrix}
    =
    \begin{pmatrix}
      N_0
      \\
      N_1
      \\
      N_2
      \\
      \vdots
      \\
      N_\ell
    \end{pmatrix}
    \Leftrightarrow \mat{S}\vect{n}=\vect{N}.
  \end{IEEEeqnarray*}

  As the coefficients between the left-hand-side and right-hand-side of~\eqref{eq:equaling-coefficients_theta-sereis_TypeI-FUL} should be matched, $\mat{S}$ should be invertible. Thus, we have
  \begin{IEEEeqnarray}{c}
    \vect{n}=\inv{\mat{S}}\vect{N}=\sum_{s=0}^\ell N_s\inv{\mat{S}}\vect{e}_{s+1}.\label{eq:n_s-solutions}
  \end{IEEEeqnarray}
  Combining~\eqref{eq:secrecy-gain_TypeI-FUL} and~\eqref{eq:n_s-solutions}, this leads to the upper bound we intend to show, with $\trans{\vect{\omega}}=\bigl(1,\nicefrac{3}{4},\ldots,(\nicefrac{3}{4})^\ell)$:
  \begin{IEEEeqnarray*}{rCl}
    \xi_{\Lambda}& = &\frac{1}{\sum_{s=0}^\ell n_s\bigl(\nicefrac{3}{4}\bigr)^s}
    =\frac{1}{\trans{\vect{\omega}}\vect{n}}=\frac{1}{\sum_{s=0}^\ell N_s\trans{\vect{\omega}}\inv{\mat{S}}\vect{e}_{s+1}}
    \\
    & \stackrel{(a)}{\leq} &\frac{1}{N_0\trans{\vect{\omega}}\inv{\mat{S}}\vect{e}_{1}}\leq
    \frac{1}{\trans{\vect{\omega}}\inv{\mat{S}}\vect{e}_{1}},
  \end{IEEEeqnarray*}
  where $(a)$ holds because numerically, those terms of $\{\trans{\vect{\omega}}\inv{\mat{S}}\vect{e}_{s+1}\}_{s=1}^{\ell}$, are all positive for dimensions $2\leq n\leq 40$, and the second inequality holds by simply choosing $\vect{N}=(1,0,\ldots,0)$.
\end{IEEEproof}

Exact values for the upper bound on the secrecy gain of Type I formally unimodular lattices, for dimensions $2\leq n\leq 32$ can be found in Table~\ref{tab:table_secrecy-gains_FU-lattices_z4_summary}.

\begin{comment} %% comment out as upper bounds is integrated in short-table_weight-enumerators_Z4-codes.tex

    \input{table_upper-bounds.tex}
    
\end{comment}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Secrecy Gain Comparisons and Numerical Results}
\label{sec:secrecy-gain-comparisons-numerical-results}

\subsection{Formally Self-Dual $\Integers_4$-Linear Codes $\code{C}=\code{A}_1+2\code{A}_2$}
\label{sec:secrecy-gain_FSD-Z4-codes_A1plus2A2}

The formally self-dual code $\code{C}_{12}$ in Example~\ref{ex:codes_dim12} has secrecy gain $\xi_{\ConstrAfour{\code{C}_{12}}} \approx 1.6$, which coincides with the performance of self-dual codes. However, it is slightly worse than the best record until now, $1.657$. On the other hand, we can notice that optimizing $d_{\textnormal{Lee}}$ of formally self-dual codes does not imply higher secrecy gain: for length-$12$ codes, $\xi_{\ConstrAfour{\code{C}_{12}}}\approx 1.6$ is achieved by $\code{C}_{12}$ with $d_\textnormal{Lee}=4$, while a Lee-optimal code with $d_{\textnormal{Lee}} = 6$~\cite[Tab.~IV]{YooLeeKim17_1} only has secrecy gain $\xi_{\ConstrAfour{\code{C}_{12}}}\approx 1.456 < 1.6$.

Potential candidates for good secrecy gain performance in this class of construction are obtained from Reed-Muller codes, as we describe next.
\begin{definition}[{Reed-Muller codes~\cite[Ch.~13]{MacWilliamsSloane77_1}}]
  \label{def:reed-muller-codes}
  For a given $v\in\Naturals$, the $r$-th order binary Reed-Muller code $\code{R}(r,v)$ is a linear $[n=2^v,k=\sum_{i=0}^r\binom{v}{i}]$ code for $r\in [0:v]$, constructed as the vector space spanned by the set of all $v$-variable Boolean monomials of degree at most $r$.
\end{definition}
Reed-Muller codes have interesting properties, such as being nested. In order to get $\Integers_4$-linear codes from pairs of Reed-Muller binary codes, we still need to guarantee that the chain is closed under the element-wise product, which is true for the chains described next.

% \begin{proposition}[\cite[p.~12]{HuNebe20_1}]
%   \label{prop:rm_even} The chain of even order Reed-Muller codes $\code{R}(0,2m) \subset \code{R}(2,2m) \subset \dots \subset \code{R}(2m-2,2m)$ is closed under element-wise product for $m<4$.   
% \end{proposition}
% \begin{IEEEproof}
%   From Definition~\ref{def:reed-muller-codes}, each element of  $\code{R}(r,m)$ can be seen as polynomial of degree at most $r$, with $m$ variables. A codeword of $\code{R}(r,m)$ comes from a polynomial $f(v_1, \dots, v_m)$ of degree at most $r$. The element-wise product of two codewords from $\code{R}(r,m)$ can be seen as a function $\circ: \mathbb{F}_2^{2^m} \times \mathbb{F}_2^{2^m} \to \mathbb{F}_2^{2^m}$, where $({\bm a},{\bm b}) \mapsto {\bm a} \circ {\bm b} = (a_1b_1, \dots, a_{2^m}b_{2^m})$ and $a_i b_i$ is the multiplication in $\mathbb{F}_2$. 

%   Consider ${\bm x}, {\bm y} \in \code{R}(r,m)$, where ${\bm x}$ comes from a polynomial $x(v_1, \dots, v_m)$ and  ${\bm y}$ comes from a polynomial $y(u_1, \dots, u_m)$, both of them of degree at most $r$. When we perform their multiplication, there will be a term with a degree at most $2r$. Hence, $\code{R}(0,m) \subset \code{R}(2,m) \subset \code{R}(4,m)$ is closed under element-wise product, but for $r > 4,$ we have that $2r=8$ and the product of two codewords in $\code{R}(4,m)$ is not in $\code{R}(6,m)$. 
% \end{IEEEproof}

% An analogous idea can be applied to prove the following result concerning an odd chain.

% \begin{proposition}[{\cite[p.~12]{HuNebe20_1}}]
% \label{prop:rm_odd} The chain of odd order Reed-Muller codes $\code{R}(1,2m)\subset\code{R}(2,2m) \subset\dots\subset \code{R}(2m-1,2m)$ is closed under element-wise product for $m<3$.
% \end{proposition}

A result connecting the construction of $\Integers_4$-linear codes and Reed-Muller chains is the following.
\begin{proposition}[{\cite[Ex.~12.8]{Wan97_1}}]
  \label{prop:reedmuller_unimodular}
  The $\Integers_4$-linear code ${\code{C}}_{2^m} \eqdef \code{R}(1,m)+2\code{R}(m-2,m)$ induces a unimodular lattice $\ConstrAfour{{\code{C}}_{2^m}} = \tfrac{1}{2} \left( {\code{C}}_{2^m} + 4\mathbb{Z}^{2^m} \right)$. 
\end{proposition}

\begin{example}
  \label{ex:BWs_dims16-32}
  Proposition~\ref{prop:reedmuller_unimodular} gives an even unimodular lattice in dimension $16$ obtained via $\Lambda_{\textnormal{A}_4}({\code{C}}_{16})$, where ${\code{C}}_{16} =  \code{R}(1,4)+2\code{R}(2,4)$ is isomorphic to $\lattice{E}_8 \times \lattice{E}_8$, where $\lattice{E}_8$ is the Gosset lattice~\cite[p.~120]{ConwaySloane99_1}. For this lattice, $\xi_{\ConstrAfour{{\code{C}}_{16}}} \approx 1.778 < 2.141$, see the table in Appendix~\ref{sec:all-FSD-Z4-codes-swes-SGs}. If one considers
  \begin{IEEEeqnarray}{c}
    {\code{C}}_{32}  =  \code{R}(1,5)+2\code{R}(3,5),
    \label{eq:c32}
  \end{IEEEeqnarray}
  then $\lattice{BW}_{32}=\sqrt{2}\ConstrAfour{{\code{C}}_{32}}=\tfrac{\sqrt{2}}{2} \left({\code{C}}_{32}+4\mathbb{Z}^{32}\right)$ is a unimodular lattice in dimension $32$.
  
  The code ${\code{C}}_{32}$ as in~\eqref{eq:c32} is self-dual. Hence, Theorem~\ref{thm:inv_secrecy-function_SymmetrizedWeightEnumerator} can be applied and we get $\xi_{\ConstrAfour{{\code{C}}_{32}}} \approx 7.11$, which is the best-known secrecy gain up to now for such dimension~\cite[p.~5698]{OggierSoleBelfiore16_1}.\hfill\exampleend
\end{example}

\begin{remark}
  Note that Theorem~\ref{thm:FSD-Z4codes_A1plus2A2} gives a sufficient but not necessary condition for formal self duality. Relaxing these conditions can, among other consequences, remove restrictions on $\code{A}_1,\code{A}_2$ and may allow improved constructions. 
\end{remark}

\subsection{DCC and Its Odd Extension}
\label{sec:DCC-odd-extension}

The best even-length DCCs and odd extension codes in terms of secrecy gain presented in this work are obtained based on numerical searches. We first present a simple result showing that using particular choices of $\vect{a}$ and $\vect{c}$, the swe of $\code{C}_{\textnormal{oext}}$ can be equal to the one of $\code{C}$, generated by $G^{\code{C}}=(\mat{I}\,\,\,\mat{B})$, and as a consequence, their secrecy gains coincide.
\begin{proposition} 
  \label{prop:swe_odd-extension_equal_swe_a+c}
  Let $\code{C}$ be a $[2\eta,M]$ code over $\Integers_4$ with generator matrix $\mat{G}^{\code{C}} = (\mat{I}\,\,\,\mat{B})$, $\eta\in\Naturals$. Consider a $[2\eta+1, 2M]$ odd extension code $\code{C}_{\textnormal{oext}}$ with the generator matrix
  \begin{IEEEeqnarray}{c}
    \mat{G}^{\code{C}_{\textnormal{oext}}} =
    \begin{pNiceMatrix}
      {\mat{I}_{\eta}} & \trans{\vect{0}} & \mat{B}_{\eta}
      \\
      \vect{0}         & 2                & \vect{0}
    \end{pNiceMatrix}.
  \end{IEEEeqnarray}
  Then, $\swe{\code{C}_{\textnormal{oext}}}(a,b,c)=\swe{\code{C}}(a,b,c)\cdot(a+c)$ and $\Xi_{\ConstrAfour{\code{C}}}(\tau) = \Xi_{\ConstrAfour{\code{C}_{\textnormal{oext}}}}(\tau)$.
\end{proposition}
\begin{IEEEproof}
  Observer that a codeword $\vect{v}_{\textnormal{oext}}\in\code{C}_\textnormal{oext}$ can be expressed as
  \begin{IEEEeqnarray*}{c}
    \vect{v}_{\textnormal{oext}}=(u_1,\ldots,u_{\eta},u_{\eta+1})\mat{G}_{\code{C}_{\textnormal{oext}}}=\biggl(u_1,\ldots,u_{\eta}, 2 u_{\eta+1},\sum_{i=1}^{\eta} b_{i,1}u_i,\cdots,\sum_{i=1}^{\eta} b_{i,\eta}u_i\biggr),
  \end{IEEEeqnarray*}
  where $(u_1,\ldots,u_{\eta},u_{\eta+1})\in\Integers_4^{\eta}\times\Integers_2$ is a message vector.
  
  For convenience, denote by $\vect{v}_\textnormal{oext}\eqdef[\vect{u},2u_{\eta+1},\vect{w}]$ and $\vect{v}\eqdef\vect{u}\mat{G}^{\code{C}}=[\vect{u},\vect{w}]$. Then, we have
  \begin{IEEEeqnarray*}{rCl}
    \IEEEeqnarraymulticol{3}{l}{%
      \swe{\code{C}_\textnormal{oext}}(a,b,c)
    }\nonumber\\*\quad%
    & = &\sum_{[\vect{u},2u_{2\eta+1},\vect{w}]\in\code{C}_\textnormal{oext}}a^{\na{0}{\vect{v}_\textnormal{oext}}}b^{\na{1}{\vect{v}_\textnormal{oext}}+\na{3}{\vect{v}_\textnormal{oext}}}c^{\na{2}{\vect{v}_\textnormal{oext}}}
    \\
    & \stackrel{(a)}{=} &\sum_{[\vect{u},0,\vect{w}]\in\code{C}_\textnormal{oext}}a^{\na{0}{\vect{v}_\textnormal{oext}}}b^{\na{1}{\vect{v}_\textnormal{oext}}+\na{3}{\vect{v}_\textnormal{oext}}}c^{\na{2}{\vect{v}_\textnormal{oext}}}+\sum_{[\vect{u},2,\vect{w}]\in\code{C}_\textnormal{oext}}a^{\na{0}{\vect{v}_\textnormal{oext}}}b^{\na{1}{\vect{v}_\textnormal{oext}}+\na{3}{\vect{v}_\textnormal{oext}}}c^{\na{2}{\vect{v}_\textnormal{oext}}}
    \\
    & = &\sum_{[\vect{u},\vect{w}]\in\code{C}}a^{\na{0}{\vect{v}}+1}b^{\na{1}{\vect{v}}+\na{3}{\vect{v}}}c^{\na{2}{\vect{v}}}+\sum_{[\vect{u},\vect{w}]\in\code{C}}a^{\na{0}{\vect{v}}}b^{\na{1}{\vect{v}}+\na{3}{\vect{v}}}c^{\na{2}{\vect{v}}+1}
    % \\
    % & = &\sum_{\vect{v}\in\code{C}}a^{\na{0}{\vect{v}}}b^{\na{1}{\vect{v}}+\na{3}{\vect{v}}}c^{\na{2}{\vect{v}}}\cdot a
    % +\sum_{\vect{v}+\vect{2}\in\code{C}}a^{\na{0}{\vect{v}}}b^{\na{1}{\vect{v}+\vect{2}}+\na{3}{\vect{v}}}c^{\na{2}{\vect{v}}}\cdot c
    \\
    & = &\swe{\code{C}}(a,b,c)\cdot(a+c),\label{eq:swe_odd-extension_equal_swe_a+c}\IEEEyesnumber
  \end{IEEEeqnarray*}
  where $(a)$ holds since $u_{\eta+1}\in\Integers_2$.

  Next, using Theorem~\ref{thm:inv_secrecy-function_SymmetrizedWeightEnumerator} and~\eqref{eq:swe_odd-extension_equal_swe_a+c}, we have
  \begin{IEEEeqnarray*}{rCl}
    \Xi_{\ConstrAfour{\code{C}_{\textnormal{oext}}}}(\tau)
    & = & \frac{2^{2\eta + 1}}{\swe{\code{C}_{\textnormal{oext}}}\bigl(1+t, \sqrt[4]{1-t^4}, 1-t\bigr)} =  \frac{2^{2\eta+1}}{\swe{\code{C}}\bigl(1+t, \sqrt[4]{1-t^4}, 1-t\bigr) \cdot (1+t+1-t)}
    \\
    & = & \frac{2^{2\eta}}{\swe{\code{C}}\bigl(1+t, \sqrt[4]{1-t^4}, 1-t\bigr)} 
    =  \Xi_{\ConstrAfour{\code{C}}}(\tau).
  \end{IEEEeqnarray*}
\end{IEEEproof}

In Table~\ref{tab:long-table_FSD-Z4-codes-swes-SGs} of Appendix~\ref{sec:all-FSD-Z4-codes-swes-SGs}, the codes with parameters $[5,2^5, 2]$, $[7,2^7,2]$, and $[9,2^9,2]$ are obtained according to Proposition~\ref{prop:swe_odd-extension_equal_swe_a+c} from the respective precendent even length codes $[4, 2^4, 2],$ $[6,2^6,4]$, and $[8,2^8,6]$. The next example points out that the swe's between $\code{C}_\textnormal{oext}$ and $\code{C}$ can be different.
\begin{example}
  \label{ex:distinct_swe_n12to13} 
    Consider a $[12,2^{12}]$ code $\code{C}^{\textnormal{pdc}}$ constructed as in~\eqref{eq:double-circulant-matrices}, with
% \begin{IEEEeqnarray*}{c}
    % \mat{B}_{\eta}^{\textnormal{pc}}=
    % \begin{pNiceMatrix}
    %  0 & 2 & 1 & 2 & 2 & 2 \\
    %  2 & 0 & 2 & 1 & 2 & 2 \\
    %  2 & 2 & 0 & 2 & 1 & 2 \\
    %  2 & 2 & 2 & 0 & 2 & 1 \\
    %  1 & 2 & 2 & 2 & 0 & 2 \\
    %  2 & 1 & 2 & 2 & 2 & 0
    % \end{pNiceMatrix}.
% \end{IEEEeqnarray*}
  the same $\mat{B}^{\textnormal{pc}}$ in Example~\ref{ex:n13k6_oextCode}. Observe that $\xi_{\ConstrAfour{\code{C}^{\textnormal{pdc}}}} \approx 1.657$. If we now consider the same $[13,2^{13}]$ code $\code{C}_{\textnormal{oext}}$ as in Example~\ref{ex:n13k6_oextCode}, % generated as in~\eqref{eq:def_odd-extension-G}, with $\mat{B}_{\eta} = \mat{B}_{\eta}^{\textnormal{pc}}$, $\vect{a}=(0,0,1,1,0,0)$ and $\vect{c}=(0,0,0,0,1,1)$, 
  we would get $\swe{\code{C}_{\textnormal{oext}}}(a,b,c) \neq \swe{\code{C}^{\textnormal{pdc}}}(a,b,c)\cdot (a+c)$ (the respective swes can be found in Table~\ref{tab:long-table_FSD-Z4-codes-swes-SGs}). However, one can see that $\xi_{\ConstrAfour{\code{C}_{\textnormal{oext}}}} \approx 1.704 > \xi_{\ConstrAfour{\code{C}^{\textnormal{pdc}}}}$.  \hfill\exampleend 
\end{example}
 
Proposition~\ref{prop:swe_odd-extension_equal_swe_a+c} points out that every secrecy gain in a certain even dimension $2\eta$ can also be achieved by an odd extension code in dimension $2\eta+1$ with certain choices of $\vect{a}$ and $\vect{c}$, meaning that the secrecy gain of lattices constructed from $\code{C}_{\textnormal{oext}}$ can be at least as good as the ones from lattices constructed from codes $\code{C}$ in the precedent even dimension. On the other hand, Example~\ref{ex:distinct_swe_n12to13} shows that there are cases when the swe's differ, which could lead to improvements. To this end, we perform an exhaustive odd extension code search from DCCs in terms of secrecy gain, which can be briefly summarized by the following algorithm.

\begin{description}
\item[Step 1:] We fix a DCC $\code{C}$ that can be generated according to \eqref{eq:double-circulant-matrices} (the code can be either PDCC or BDCC). We select two initial vectors $\vect{a}=\vect{c}=\vect{0}$ and construct the corresponding odd extension code $\code{C}_{\textnormal{oext}}$ with a generator matrix as in~\eqref{eq:def_odd-extension-G}. We compute the secrecy gain $\xi_{\ConstrAfour{\code{C}_\textnormal{oext}}}$ according to Theorem~\ref{thm:inv_secrecy-function_SymmetrizedWeightEnumerator}.
\item[Step 2:] We select another two nonzero vectors $\vect{a},\vect{c}$ and construct the new odd extension code $\code{C}'_{\textnormal{oext}}$. For this new odd extension code we verify its formally-self duality via the MacWilliams identity~\eqref{eq:swe-MacWilliams-identity_FSD-codes_Z4} and compute the corresponding secrecy gain $\xi_{\ConstrAfour{\code{C}'_\textnormal{oext}}}$ and if $\xi_{\ConstrAfour{\code{C}'_\textnormal{oext}}}>\xi_{\ConstrAfour{\code{C}_\textnormal{oext}}}$, we replace $\code{C}_\textnormal{oext}$ by $\code{C}'_\textnormal{oext}$. Otherwise, we keep the current $\code{C}_\textnormal{oext}$.
\item[Step 3:] We repeat \textbf{Step 2} until all the possible vectors of $\vect{a},\vect{c}\in\Integers_2^\eta$ are selected.
\end{description}

Note that the search of the best even-length DCCs with respect to secrecy gain is done similarly in the above algorithm. For PDCC, we run over all possible choices of vectors $\vect{r}\in\Integers_4^\eta$ for $\mat{B}^{\textnormal{pc}}_{\eta}$ in~\eqref{eq:double-circulant-matrices}, while for BDCCs, an exhaustive search over all possible elements of $\alpha,\beta,\gamma\in\Integers_4$, and vectors $\vect{r}\in\Integers_4^{\eta-1}$ for $\mat{B}^{\textnormal{bc}}_{\eta}$ in~\eqref{eq:double-circulant-matrices}, is performed.

As a result, the Construction $\textnormal{A}_4$ lattices obtained from DCCs and odd extension codes can achieve a better secrecy gain than the ones known in the literature. We summarize and discuss the best-found codes in the next subsection.

\subsection{Summary}
\label{sec:summary}

\input{short-table_weight-enumerators_Z4-codes.tex}% xxx: double-check

Table~\ref{tab:table_secrecy-gains_FU-lattices_z4_summary} summarizes the gains achieved in even and odd dimensions. Note that we are comparing the best-known lattices (not nonlattice packings) constructed from binary codes via Construction A~\cite{BollaufLinYtrehus22_3sub}. Interestingly, we found some even-dimensional formally unimodular lattices outperforming the upper bounds on the secrecy gain of Type I formally unimodular lattices, e.g., $n=14, 22$. We also observe that the Construction $\textnormal{A}_4$ lattices obtained from DCCs generally achieve better secrecy gain than the ones obtained from nested binary codes. We remark that since not every formally unimodular lattice is Type I (and neither Type II), it is possible to obtain a good secrecy gain of a formally unimodular lattice that exceeds the upper bound on the secrecy gain of Type I formally unimodular lattices.

In addition to improvements on the secrecy gain provided by the even-length formally unimodular lattices, the odd extension codes proposed in this paper also outperform the best secrecy gains previously achieved in such odd dimensions by unimodular lattices~\cite[Tab.~II]{LinOggier13_1}. Some particular cases also even exceed the upper bounds on the secrecy gain of Type I formally unimodular lattices, such as $n=7, 13$, and $15$, with secrecy gains given respectively by $\xi_{\ConstrAfour{\code{C}_{7}}} \approx 1.172$, $\xi_{\ConstrAfour{\code{C}_{13}}} \approx 1.704$, and $\xi_{\ConstrAfour{\code{C}_{15}}} \approx 1.972$.

We use the following acronyms for Table~\ref{tab:table_secrecy-gains_FU-lattices_z4_summary}: 
\begin{itemize}
\item pdc: a PDCC with a generator matrix $\mat{G}^{\textnormal{pdc}}$ as in~\eqref{eq:double-circulant-matrices};
\item bdc: a BDCC with a generator matrix $\mat{G}^{\textnormal{bdc}}$ as in~\eqref{eq:double-circulant-matrices};
\item oext: an odd extension code obtained according to Proposition~\ref{prop:swe_odd-extension_equal_swe_a+c}, from the respective precedent even dimension;
\item opdc: an odd extension code where its $\mat{B}$ as in~\eqref{eq:def_odd-extension-G} is $\mat{B}^{\textnormal{pc}}$;
\item obdc: an odd extension code where its $\mat{B}$ as in~\eqref{eq:def_odd-extension-G} is $\mat{B}^{\textnormal{bc}}$.
\end{itemize}

Appendix~\ref{sec:all-FSD-Z4-codes-swes-SGs} contains an extended table with the symmetrized weight enumerators and respective secrecy gains of the best results found in our code searches. Boldfaced values for the secrecy gain correspond to the best one achieved in the respective code length/lattice dimension.

% Observe that the minimum squared Euclidean distance of the best-known lattices obtained from (unscaled) Construction A (yielding the last column results about the secrecy gain) is $4$, except for the first code in dimension $6$, which is then $3$.


%%%%%%
%% An example of a floating figure using the graphics package.
%% Note that \label must occur AFTER (or within) \caption.
%% For figures, \caption should occur after the \includegraphics.
%%
% \begin{figure}[htbp]
%   \centering
%   \includegraphics[width=0.3\textwidth]{myfigure}
%   % where an .eps filename suffix will be assumed under latex,
%   % and a .pdf suffix will be assumed for pdflatex
%   \caption{Simulation results.}
%   \label{fig:sim}
% \end{figure}
%%%%%%

%%%%%%
%% An example of a double-column floating figure using two subfigures.
%% (The subfigure.sty package must be loaded for this to work.)  The
%% subfigure \label commands are set within each subfigure command,
%% the \label for the overall figure must come after \caption.  
%% \hfil must be used as a separator to get equal spacing
%%
% \begin{figure*}[htbp]
%   \centerline{\subfigure[Case I]{\includegraphics[width=2.5in]{subfigcase1}
%       % where an .eps filename suffix will be assumed under latex,
%       % and a .pdf suffix will be assumed for pdflatex
%       \label{fig:first_case}}
%     \hfil
%     \subfigure[Case II]{\includegraphics[width=2.5in]{subfigcase2}
%       % where an .eps filename suffix will be assumed under latex,
%       % and a .pdf suffix will be assumed for pdflatex
%       \label{fig:second_case}}}
%   \caption{Simulation results.}
%   \label{fig:sim}
% \end{figure*}
%%%%%%

%%%%%%
%% An example of a floating table. 
%% Note that, for IEEE style tables, the \caption command should come
%% BEFORE the table. Table text will default to\footnotesize as IEEE
%% normally uses this smaller font for tables.  The \label must come
%% after \caption as always.
%%
% \begin{table}[htbp]
%   % increase table row spacing, adjust to taste
%   \renewcommand{\arraystretch}{1.3}
%   \caption{An Example of a Table}
%   \label{tab:table_example}
%   \centering
%   % Some packages, such as MDW tools, offer better commands for making tables
%   % than the plain LaTeX2e tabular which is used here.
%   \begin{tabular}{|c||c|}
%     \hline
%     One & Two\\
%     \hline
%     Three & Four\\
%     \hline
%   \end{tabular}
% \end{table}
%%%%%%

\section{Conclusion}
\label{sec:conclusion}

This work investigated the secrecy gain of Construction $\textnormal{A}_4$ lattices obtained from formally self-dual $\Integers_4$-linear codes. To this end, several novel code constructions of formally self-dual $\Integers_4$-linear codes of both even and odd lengths are presented. In contrast to binary codes, there are odd-length formally self-dual codes over the integers modulo $4$. Thus, we can universally address odd-dimensional formally unimodular lattices, which have few studies in the past literature. The theta series of Construction $\textnormal{A}_4$ lattices obtained from formally self-dual $\Integers_4$-linear codes and a universal approach to determine their secrecy gains were presented. We found that it is possible to obtain a better secrecy gain from Construction $\textnormal{A}_4$ formally unimodular lattices than that from Construction $\textnormal{A}$ formally unimodular lattices. Extensive code searches were performed to support this observation.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% References
\balance % quick balance the REFs

\bibliographystyle{IEEEtran}
\bibliography{defshort1,biblioHY}

%%%%%%
%% To balance the columns on the last page of the paper use this
%% command:
%%
%\enlargethispage{-1.2cm} 
%%
%% If the balancing should occur in the middle of the references, use
%% the following trigger:
%%
%\IEEEtriggeratref{4}
%%
%% which triggers a \newpage (i.e., new column) just before the given
%% reference number. Note that you need to adapt this if you modify
%% the paper.  The "triggered" command can be changed if desired:
%%
%\IEEEtriggercmd{\enlargethispage{-20cm}}
%%
%%%%%%


%%%%%%
%% References:
%% We recommend the usage of BibTeX:
%%
%\bibliographystyle{IEEEtran}
%\bibliography{definitions,bibliofile}
%%
%% where we here have assume the existence of the files
%% definitions.bib and bibliofile.bib.
%% BibTeX documentation can be obtained at:
%% http://www.ctan.org/tex-archive/biblio/bibtex/contrib/doc/
%%%%%%



%% Or you use manual references (pay attention to consistency and the
%% formatting style!):
% \begin{thebibliography}{9}

% \bibitem{Laport:LaTeX}
% L.~Lamport,
%   \emph{\LaTeX: A Document Preparation System,} 
%   Addison-Wesley, Reading, Massachusetts, USA, 2nd~ed., 1994. 

% \bibitem{GMS:LaTeXComp}
% F.~Mittelbach, M,~Goossens, J.~Braams, D.~Carlisle, and
% C.~Rowley, \emph{The {\LaTeX} Companion,} Addison-Wesley,
% Reading, Massachusetts, USA, 2nd~ed., 2004.

% \bibitem{oetiker_latex}
% T.~Oetiker, H.~Partl, I.~Hyna, and E.~Schlegl, \emph{The Not So Short
%   Introduction to {\LaTeX2e}}, version 5.06, Jun.~20, 2016. [Online].
%   Available: \url{https://tobi.oetiker.ch/lshort/}

% \bibitem{typesetmoser}
% S.~M. Moser, \emph{How to Typeset Equations in {\LaTeX}}, version 4.6,
%   Sep. 29, 2017. [Online]. Available:
%   \url{http://moser-isi.ethz.ch/manuals.html#eqlatex}

% \bibitem{IEEE:pdfsettings}
% IEEE, \emph{Preparing Conference Content for the IEEE Xplore Digital
%   Library.} [Online]. Available:
%   \url{http://www.ieee.org/conferences_events/conferences/organizers/pubs/preparing_content.html}

% \bibitem{IEEE:AuthorToolbox}
% IEEE, \emph{Author Digital Toolbox.} [Online.] Available:
%   \url{http://www.ieee.org/publications_standards/publications/authors/authors_journals.html}

% \end{thebibliography}

\clearpage
%%%%%% 
%% Appendix:
%% If needed a single appendix is created by
%%
%\appendix
%%
%% If several appendices are needed, then the command
%%
% \section*{Acknowledgment}
%\ifthenelse{\boolean{short_version}}{}{{
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\appendices
%%
%% in combination with further \section-commands can be used.
%%%%%%
\ifthenelse{\boolean{short_version}}{
  \makeatletter\afterpage{\if@firstcolumn \else\afterpage{
      \onecolumn
      %\input{weight_enumerators_codes_z4.tex}
      \input{longtable_weight-enumerators_Z4-codes.tex}
      % \twocolumn}
    }
    \fi}\makeatother
}{\input{longtable_weight-enumerators_Z4-codes.tex}}

\end{document}


%%%%%%
%% Some comments about useful packages
%% (extract from bare_conf.tex by Michael Shell)
%%

% *** MISC UTILITY PACKAGES ***
%
%\usepackage{ifpdf}
% Heiko Oberdiek's ifpdf.sty is very useful if you need conditional
% compilation based on whether the output is pdf or dvi.
% usage:
% \ifpdf
%   % pdf code
% \else
%   % dvi code
% \fi
% The latest version of ifpdf.sty can be obtained from:
% http://www.ctan.org/pkg/ifpdf
% Also, note that IEEEtran.cls V1.7 and later provides a builtin
% \ifCLASSINFOpdf conditional that works the same way.
% When switching from latex to pdflatex and vice-versa, the compiler may
% have to be run twice to clear warning/error messages.


% *** CITATION PACKAGES ***
%
%\usepackage{cite}
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of the IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% noadjust option (cite.sty V3.8 and later) if you want to turn this off
% such as if a citation ever needs to be enclosed in parenthesis.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 5.0 (2009-03-20) and later if using hyperref.sty.
% The latest version can be obtained at:
% http://www.ctan.org/pkg/cite
% The documentation is contained in the cite.sty file itself.


% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi
% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/pkg/graphicx
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/pkg/epslatex
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). The IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex


% *** MATH PACKAGES ***
%
%\usepackage{amsmath}
% A popular package from the American Mathematical Society that provides
% many useful and powerful commands for dealing with mathematics.
%
% Note that the amsmath package sets \interdisplaylinepenalty to 10000
% thus preventing page breaks from occurring within multiline equations. Use:
%\interdisplaylinepenalty=2500
% after loading amsmath to restore such page breaks as IEEEtran.cls normally
% does. amsmath.sty is already installed on most LaTeX systems. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/amsmath


% *** SPECIALIZED LIST PACKAGES ***
%
%\usepackage{algorithmic}
% algorithmic.sty was written by Peter Williams and Rogerio Brito.
% This package provides an algorithmic environment fo describing algorithms.
% You can use the algorithmic environment in-text or within a figure
% environment to provide for a floating algorithm. Do NOT use the algorithm
% floating environment provided by algorithm.sty (by the same authors) or
% algorithm2e.sty (by Christophe Fiorio) as the IEEE does not use dedicated
% algorithm float types and packages that provide these will not provide
% correct IEEE style captions. The latest version and documentation of
% algorithmic.sty can be obtained at:
% http://www.ctan.org/pkg/algorithms
% Also of interest may be the (relatively newer and more customizable)
% algorithmicx.sty package by Szasz Janos:
% http://www.ctan.org/pkg/algorithmicx


% *** ALIGNMENT PACKAGES ***
%
\usepackage{array}
% Frank Mittelbach's and David Carlisle's array.sty patches and improves
% the standard LaTeX2e array and tabular environments to provide better
% appearance and additional user controls. As the default LaTeX2e table
% generation code is lacking to the point of almost being broken with
% respect to the quality of the end results, all users are strongly
% advised to use an enhanced (at the very least that provided by array.sty)
% set of table tools. array.sty is already installed on most systems. The
% latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/array

% IEEEtran contains the IEEEeqnarray family of commands that can be used to
% generate multiline equations as well as matrices, tables, etc., of high
% quality.


% *** SUBFIGURE PACKAGES ***
%\ifCLASSOPTIONcompsoc
%  \usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
%\else
%  \usepackage[caption=false,font=footnotesize]{subfig}
%\fi
% subfig.sty, written by Steven Douglas Cochran, is the modern replacement
% for subfigure.sty, the latter of which is no longer maintained and is
% incompatible with some LaTeX packages including fixltx2e. However,
% subfig.sty requires and automatically loads Axel Sommerfeldt's caption.sty
% which will override IEEEtran.cls' handling of captions and this will result
% in non-IEEE style figure/table captions. To prevent this problem, be sure
% and invoke subfig.sty's "caption=false" package option (available since
% subfig.sty version 1.3, 2005/06/28) as this is will preserve IEEEtran.cls
% handling of captions.
% Note that the Computer Society format requires a larger sans serif font
% than the serif footnote size font used in traditional IEEE formatting
% and thus the need to invoke different subfig.sty package options depending
% on whether compsoc mode has been enabled.
%
% The latest version and documentation of subfig.sty can be obtained at:
% http://www.ctan.org/pkg/subfig


% *** FLOAT PACKAGES ***
%
%\usepackage{fixltx2e}
% fixltx2e, the successor to the earlier fix2col.sty, was written by
% Frank Mittelbach and David Carlisle. This package corrects a few problems
% in the LaTeX2e kernel, the most notable of which is that in current
% LaTeX2e releases, the ordering of single and double column floats is not
% guaranteed to be preserved. Thus, an unpatched LaTeX2e can allow a
% single column figure to be placed prior to an earlier double column
% figure.
% Be aware that LaTeX2e kernels dated 2015 and later have fixltx2e.sty's
% corrections already built into the system in which case a warning will
% be issued if an attempt is made to load fixltx2e.sty as it is no longer
% needed.
% The latest version and documentation can be found at:
% http://www.ctan.org/pkg/fixltx2e


%\usepackage{stfloats}
% stfloats.sty was written by Sigitas Tolusis. This package gives LaTeX2e
% the ability to do double column floats at the bottom of the page as well
% as the top. (e.g., "\begin{figure*}[!b]" is not normally possible in
% LaTeX2e). It also provides a command:
%\fnbelowfloat
% to enable the placement of footnotes below bottom floats (the standard
% LaTeX2e kernel puts them above bottom floats). This is an invasive package
% which rewrites many portions of the LaTeX2e float routines. It may not work
% with other packages that modify the LaTeX2e float routines. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/stfloats
% Do not use the stfloats baselinefloat ability as the IEEE does not allow
% \baselineskip to stretch. Authors submitting work to the IEEE should note
% that the IEEE rarely uses double column equations and that authors should try
% to avoid such use. Do not be tempted to use the cuted.sty or midfloat.sty
% packages (also by Sigitas Tolusis) as the IEEE does not format its papers in
% such ways.
% Do not attempt to use stfloats with fixltx2e as they are incompatible.
% Instead, use Morten Hogholm'a dblfloatfix which combines the features
% of both fixltx2e and stfloats:
%
% \usepackage{dblfloatfix}
% The latest version can be found at:
% http://www.ctan.org/pkg/dblfloatfix


% *** PDF and URL PACKAGES ***
%
%\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/url
% Basically, \url{my_url_here}.



% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
%%%%%%


%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:

\section{Computational Aspects}
\label{sec:comp}

In this section, we consider the computational aspect of the problem: given an arbitrary 2-player stage game $G$, how to (algorithmically) decide if there exists some $T$ and some SPE of $G(T)$ where \phenom{} occurs. We focus on the general case where mixed strategies are allowed. A naive approach is to enumerate over $T$ and solve for all subgame-perfect equilibria for each $G(T)$. Such an approach is not only computationally inefficient, but also not guaranteed to terminate due to the unboundedness of $T$. This leaves open the question of whether the above problem is decidable or not.

\Cref{thm:general} proves a necessary and sufficient condition that is solely described on the stage game $G$, independent of $T$. Based on this condition, we present here a more efficient algorithm for deciding the above problem (\Cref{alg:decide}). This algorithm also shows that the above problem is decidable.

\begin{algorithm}
\small
\caption{Given stage game $G$, decide if there exists some $T$ and some SPE of $G(T)$ where \phenom{} occurs}
\label{alg:decide}
\begin{algorithmic}[1]
\Require $G = \{u_1(i,j), u_2(i,j)\}_{i\in [|A_1|], j\in[|A_2|]}$
\Ensure True/False
     \Function{DecideLocalSubOptimality}{$G$}
          \State $\Nash(G) \gets$ \Call{FindAllNash}{$G$} 
          \State {uniqueV1, uniqueV2 $\gets$ \Call{IsValueUnique}{$\Nash(G), G$}}
          \If{uniqueV1}
            \If{uniqueV2}
                \State \textbf{return} False
            \Else
                \State \textbf{return} \Call{ExistOff1Best}{$G$}
            \EndIf
          \Else
            \If{uniqueV2}
                \State \textbf{return} \Call{ExistOff2Best}{$G$}
            \Else
                \State \textbf{return} \Call{ExistOff}{$G$}
            \EndIf
          \EndIf
     \EndFunction
\end{algorithmic}
\end{algorithm}

The input to the algorithm is the stage game $G$, represented as a matrix of payoffs for every action profile $\{u_1(i,j), u_2(i,j)\}_{i\in [|A_1|], j\in[|A_2|]}$. Overall, the algorithm consists of three steps. The first step is to compute the set of all Nash equilibria of $G$. The second step is to determine if the set of payoff values attainable at $\Nash(G)$ is unique for each player, so as to know which case of the condition in \Cref{thm:general} we need to further check. The third step is to check if there exists the respective off-Nash strategy profiles required for each case. We now present the algorithm for each of the three steps. 

\subsection{Compute All Nash Equilibria}
There are many existing algorithms for computing the set of all Nash equilibria of two-player normal form games \cite{dickhaut1993program, audet2001enumeration, von2002computing, Avis2010}. In general, any existing algorithm can be used here as long as it can handle degenerate games where there are an infinite number of Nash equilibria. An example of such algorithm can be found in \cite{Avis2010}. It handles the potentially infinite number of Nash equilibria in degenerate games by computing the finite set of \textit{extreme equilibria}; the set of all Nash equilibria is then completely described by polytopes obtained from subsets of the extreme equilibria. 

\paragraph{Complexity}
In general, the problem of finding all Nash equilibria of a two-player normal form game is NP-hard (as \cite{GILBOA1989} shows that deciding if a game has a unique Nash equilibrium is NP-hard). Therefore, any algorithm for \textsc{FindAllNash} takes exponential time in the worst case (unless P=NP).

\subsection{Determine the Uniqueness of Payoffs at Equilibrium}
\textsc{IsValueUnique} returns two Boolean values; the first (resp. second) return value is \texttt{True} if $|V_1|=1$ (resp. $|V_2|=1$). This function can be achieved by evaluating payoffs at each extreme equilibrium and compare to see if there are more than one values for each player.

\paragraph{Complexity}
In general, a non-degenerate 2-player bimatrix game can have an exponential number of Nash equilibria \cite{von1999new, quint1997theorem}. So \textsc{IsValueUnique} can take exponential time. But in practice, this step can be done in the first step (\textsc{FindAllNash}) with a constant factor overhead, by evaluating the payoff of each extreme equilibrium immediately after the extreme equilibrium is computed in \textsc{FindAllNash} and comparing with the payoffs of the previous equiliria.

\subsection{Check the Existence of Required Off-Nash Strategy Profiles}
Based on the uniqueness of payoffs attainable at equilibrium for each player (\texttt{uniqueV1} and \texttt{uniqueV2}), we need to check the existence of off-Nash strategy profiles with the requirements corresponding to each case. 

If $|V_1| > 1$ and $|V_2| > 1$ (both \texttt{uniqueV1} and \texttt{uniqueV2} are \texttt{False}), we simply need to check the existence of an off-Nash strategy profile without further requirements. By \Cref{lemma:mixed-pure}, it suffices to check the existence of an off-Nash \textit{pure} strategy profile. \Cref{alg:existoff} achieves this functionality. 

\begin{algorithm}
\small
\caption{Check the existence of an off-Nash strategy profile}
\label{alg:existoff}
\begin{algorithmic}[1]
\Require $G = \{u_1(i,j), u_2(i,j)\}_{i\in [|A_1|], j\in[|A_2|]}$
\Ensure True/False
\Function{ExistOff}{$G$}
    \For{$j = 1, \dots, |A_2|$}
        \If{not all $u_1(i,j)$ for $i= 1, \dots, |A_1|$ are the same}
            \State \textbf{return} True
        \EndIf
    \EndFor
    \For{$i = 1, \dots, |A_1|$}
        \If{not all $u_2(i,j)$ for $j= 1, \dots, |A_2|$ are the same}
            \State \textbf{return} True
        \EndIf
    \EndFor
    \State \textbf{return} False
\EndFunction
\end{algorithmic}
\end{algorithm}

If $|V_1| > 1$ and $|V_2| = 1$ (\texttt{uniqueV1} is \texttt{False} and \texttt{uniqueV2} is \texttt{True}), we need to check the existence of an off-Nash strategy profile where player 2 plays a best response. The following lemma proves that it suffices to check the existence of an off-Nash strategy profile where player 2 plays a \textit{pure strategy} best response.

\begin{lemma}
\label{lemma:mixed-pure-2best}
For any two-player game $G$, if there exists $\sigma_1\in\Delta A_1$, $\sigma_2\in\Delta A_2$, $a_1'\in A_1$ where $u_1(\sigma_1, \sigma_2) < u_1(a_1', \sigma_2)$ and $\sigma_2$ is a best response to $\sigma_1$, then there exists $\sigma_1\in\Delta A_1$, $a_2\in A_2$, $a_1'\in A_1$ where $u_1(\sigma_1, a_2) < u_1(a_1', a_2)$ and $a_2$ is a best response to $\sigma_1$.
\end{lemma}

\begin{proof}
Let $S_{\sigma_2}$ be the support of $\sigma_2$. $\sigma_2$ is a best response to $\sigma_1$ implies that any $a\in S_{\sigma_2}$ is a best response to $\sigma_1$. We have $u_1(a_1', \sigma_2) - u_1(\sigma_1, \sigma_2) = \sum_{a\in S_{\sigma_2}} \sigma_2(a)\cdot \Big(u_1(a_1', a) - u_1(\sigma_1, a) \Big)$. Since $u_1(a_1', \sigma_2) - u_1(\sigma_1, \sigma_2) > 0$, there exists some $a_2 \in S_{\sigma_2}$ where $u_1(a_1', a_2) - u_1(\sigma_1, a_2) > 0$. This $\sigma_1\in\Delta A_1$, $a_2\in A_2$, $a_1'\in A_1$ satisfies $u_1(\sigma_1, a_2) < u_1(a_1', a_2)$ and $a_2$ is a best response to $\sigma_1$.
\end{proof}
\Cref{alg:existoff2best} presents a method for checking the existence of an off-Nash strategy profile where player 2 plays a pure strategy best response. The idea is as follows. For each possible pure strategy $j$ of player 2, we construct linear programs with constraints on player 1's mixed strategy (represented by probabilities $\{x_{i'}\}_{i'=1}^{|A_1|}$) such that $j$ is a best response. We aim to find for every action $i$ of player 1 that is not a best response to $j$, if $j$ can be a best response to a mixed strategy of player 1 containing $i$ in its support. The presented linear program achieves this purpose. If we can find such a mixed strategy $\sigma_1$ for player 1, then $(\sigma_1, j)$ is an instance of an off-Nash strategy profile where player 2 plays a best response, as desired. Since we exhaustively enumerate over all possible cases, this method is complete.

\textsc{ExistOff1Best} can be implemented using the same algorithm, exchanging player 1 and 2.

\begin{algorithm}
\small
\caption{Check the existence of an off-Nash strategy profile where player 2 plays a best response}
\label{alg:existoff2best}
\begin{algorithmic}[1]
\Require $G = \{u_1(i,j), u_2(i,j)\}_{i\in [|A_1|], j\in[|A_2|]}$
\Ensure True/False
\Function{ExistOff2Best}{$G$}
    \For{$j=1,\dots,|A_2|$}
        \State $c \gets \max_i u_1(i,j)$
        \For{$i\in [|A_1|]$ where $u_1(i,j)< c$}
            \State max\_xi $\gets$ solve the following linear program
            \begin{align*}
                \textrm{maximize: } & x_i \\
                \textrm{subject to: } & x_{i'} \geq 0, i'=1,\dots,|A_1| \\
                & \sum_{i'=1}^{|A_1|} x_{i'} = 1 \\
                & \sum_{i'=1}^{|A_1|} x_{i'} \cdot u_2(i',j) \geq \sum_{i'=1}^{|A_1|} x_{i'} \cdot u_2(i',j'), j'=1,\dots,|A_2| \\
            \end{align*}
            \If{max\_xi > 0}
                \State \textbf{return} True
            \EndIf
        \EndFor
    \EndFor
    \State \textbf{return} False
\EndFunction
\end{algorithmic}
\end{algorithm}

\paragraph{Complexity}
\textsc{ExistOff} has complexity $\mathcal{O}(|A_1|\cdot |A_2|)$. \textsc{ExistOff2Best} (and similarly \textsc{ExistOff1Best}) involves solving $\mathcal{O}(|A_1|\cdot |A_2|)$ instances of polynomial-sized linear programs. Since a linear program can be solved in polynomial time, $\textsc{ExistOff2Best}$ is a polynomial time algorithm. A vanilla support enumeration algorithm (such as \cite{dickhaut1993program}), which enumerates over all possible supports (subsets of the action sets) for the mixed strategies $\sigma_1$ and $\sigma_2$ in the required strategy profile and solve for each case, requires exponential time since there is an exponential number of possible supports. The algorithm we present here is more efficient.
\newline
\newline
Overall, the computational bottleneck is step 1, since finding all Nash equilibria is NP-hard. Step 2 can be computed within step 1 with a constant factor overhead. Step 3 can be computed in polynomial time.

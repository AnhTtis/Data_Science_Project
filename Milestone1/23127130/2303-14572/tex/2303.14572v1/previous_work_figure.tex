
\begin{figure}[ht]
    \centering
    \begin{tikzpicture}
    
    \node at(0, 0)  [anchor=center] (apspn){\APSP{} in $[n]$};
    \node at(0, 2)  [anchor=center] (intapsp){\IntAPSP{}};
    \node at(0, 4)  [anchor=center] (realapsp){\RealAPSP{}};
    \node at(realapsp.north)  [anchor=south] (){\textcolor{blue}{$n^3$}};
    
    
    \node at(5, 0)  [anchor=center] (uapsp){\uAPSP{}};
    \node at(10, 0)  [anchor=center] (minwitness){\MinWitness{}};
    
    \node at(4, 4)  [anchor=center] (aemonotri){\AEMonoTri{}};
    \node at(7.3, 4)  [anchor=center] (maxmin){\MaxMin{}};
    \node at(11, 4)  [anchor=center] (minwitnesseq){\MinWitnessEq{}};
    \node at(7.5,0 |- maxmin.north)  [anchor=south] (){\textcolor{blue}{$n^{2.5}$}};
	
	\draw[-stealth,line width=1pt] (apspn.north) to[]  node[right] {} (intapsp.south);
	\draw[-stealth,line width=1pt] (intapsp.north) to[]  node[right] {} (realapsp.south);
	\draw[-stealth,line width=1pt] (apspn.north) to[]  node[right] {} (intapsp.south);
	\draw[-stealth,line width=1pt] (minwitness.north) to[]  node[pos=0.15,  left, xshift=-4] {\cite{lincoln2020monochromatic}} (aemonotri.280);
	\draw[-stealth,line width=1pt] (minwitness.north) to[]  node[right] {} (maxmin.south);
	\draw[-stealth,line width=1pt] (minwitness.north) to[]  node[right] {} (minwitnesseq.south);
	\draw[-stealth,line width=1pt] (uapsp.north) to[]  node[left] {\cite{lincoln2020monochromatic}} (aemonotri.south);
	\draw[-stealth,line width=1pt] (uapsp.north) to[]  node[left, pos = 0.9, xshift=3] {\cite{lincoln2020monochromatic}} (maxmin.south);
	\draw[-stealth,line width=1pt] (uapsp.north) to[]  node[left, pos = 0.9] {\cite{CVXicalp21}} (minwitnesseq.260);

	
	\draw[-stealth,line width=1pt] (realapsp.east) to[]  node[above] {\cite{CVXstoc22}} (aemonotri.west);
	\draw[-stealth,line width=1pt] (intapsp.east) to[]  node[right] {\cite{williamsxumono}} (aemonotri.183);
	\draw[-stealth,line width=1pt] (uapsp.west) to[]  node[above] {\cite{CVXicalp21}+Lem.~\ref{lem:down}} (apspn.east);

	\draw[-stealth,line width=1pt, dotted, color = red, bend right] (apspn.350) to[]  node[above, yshift=-3] {open} (uapsp.190);
	\draw[stealth-stealth,line width=1pt, dotted, color = red, bend right] (uapsp.350) to[]  node[above, yshift=-3] {open} (minwitness.190);
	\draw[-stealth,line width=1pt, dotted, color = red, bend right] (apspn.340) to[]  node[above, yshift=-3] {open} (minwitness.200);


    
    \draw[opacity=0.7, dashed, rounded corners=3, color=blue] (realapsp.north east) -- (realapsp.north west) -- (apspn.south west) -- (apspn.south east) -- cycle;
    \draw[opacity=0.7, dashed, rounded corners=3, color=blue] (minwitnesseq.north east) -- (aemonotri.north west) -- (aemonotri.north west |- uapsp.south west) -- (minwitnesseq.north east |- minwitness.south east) -- cycle;


    \end{tikzpicture}
    \vspace*{-2ex}
    \caption{Previous work on intermediate matrix product problems, assuming $\omega=2$. Here,  \APSP{} in $[n]$ denotes %
    APSP with edge weights in $[n]$, \IntAPSP{} denotes APSP with arbitrary $O(\log n)$-bit integer weights, and \RealAPSP{} denotes APSP with real weights.    All unlabelled arrows follow by trivial reductions.}
    \label{fig:previous}
\end{figure}

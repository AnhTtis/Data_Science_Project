\onecolumn
\section{Future Directions:}

Given that $\hat{\nabla}_{\text{FREAK}}(x)$ allows us to locate the indices of top-$k$ most sensitive frequencies, a question that arises is can we reconstruct those magnitude values similar to what was done in Februus \cite{Doan2020FebruusIP}? Our results show that indeed this might be a feasible approach. This approach is summarized in Figure \ref{pipeline2}.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.85\textwidth]{figures/pipeline_final_.pdf}
    \caption{\textbf{FREAK for Image Purification.} We attempt to purify the images by first detecting the $k$ most sensitive frequency components, masking them by zero (occluding them), and then reconstructing the magnitude components using an R2U-Net.}
    \label{pipeline2}
\end{figure}

In simple terms, the idea is to locate the $k$ most sensitive frequency components, set them to zero and attempt to reconstruct them using an R2U-Net \cite{Alom2018RecurrentRC}. The loss used for training this network is a simple MSE on the recovered images and an MSE on the log Fourier recovered magnitude. Mathematically, the loss can be written as $$\mathcal{L} = \mathcal{L}_{\text{MSE}}(\Tilde{\mathcal{I}}, \mathcal{I}) + \mathcal{L}_{\text{MSE}}(\log(g(|\widehat{\mathcal{F}(\mathcal{I}})|)), \log(|{\mathcal{F}(\mathcal{I})}|)) $$


\begin{table*}[h!]

    \begin{subtable}[h]{0.32\textwidth}                \input{figures/Tables/fiba_resnet18_cifar10}
        \caption{FIBA \cite{Feng2021FIBAFB}}
        \label{tab:week2}
     \end{subtable}
    \begin{subtable}[h]{0.32\textwidth}
        \centering
                \input{figures/Tables/ftrojan_resnet18_cifar10}
       \caption{FTrojan \cite{Wang2021BackdoorAT}}
       \label{tab:week1}
    \end{subtable}
    \begin{subtable}[h]{0.32\textwidth}
        \centering
                \input{figures/Tables/cyo_resnet18_cifar10}
       \caption{CYO \cite{Hammoud2021CheckYO}}
       \label{tab:week1}
    \end{subtable}
     \caption{\textbf{Defending Against Frequency Backdoor Attacks (CIFAR10).} The results of applying various defenses against existing frequency backdoor attacks show that using FREAK approach allows for the best balance between CDA and ASR.}
     \label{tab1v}
\end{table*}


We test that approach against a various set of defenses such as filtering approaches, some of which were proposed in  \cite{Hammoud2021CheckYO,Wang2021BackdoorAT}, namely,  Gaussian, Weiner, Highpass, Lowpass, and Bandpass filtering and compression approaches such as: JPEG and Autoencoder compression. As shown in Table \ref{tab1v}, this approach proves to be a solid approach to defend against backdoor attacks. More precisely, using this frequency reconstruction approach during test time allows us to maintain a high clean data accuracy while dropping the attack success rate to a very low level. This is observed for all three studied frequency-backdoor attacks.

However, our experiments on ImageNet show that this approach might not be scalable on large scale images where we observed a large drop in performance in terms of CDA and ASR trade-off. This calls for further research to develop a different loss function and architecture for applying frequency reconstruction.

\section{Additional Results:}

\subsection{Results on ResNet34}

In this subsection we present evaluations of FREAK against the CYO, FTrojan and FIBA using ResNet34 model instead of ResNet18. FREAK still proves to be a useful defense for detecting poisoned samples.

\begin{table}[h!]
\centering
\scalebox{0.9}{
\begin{tabular}{@{}ccc@{}}
\cmidrule(l){2-3}
\textbf{}        & \textbf{TPR (\%)} & \textbf{FPR (\%)} \\ \midrule
\textbf{CYO}     & 99.61             & 1.95              \\
\textbf{FTrojan} & 99.80            & 4.29              \\
\textbf{FIBA}    & 91.20             & 7.31              \\ \bottomrule
\end{tabular}}
\caption{\textbf{FREAK Against Frequency Backdoor Attacks.} FREAK proves to be capable of achieving a high TPR while maintaining a low FPR against frequency backdoor-attacks.}
\end{table}


\subsection{Hyperparameter Sensitivity of FREAK}

Now we study the sensitivity of FREAK to the different hyperparameters. Unless the hyperparameter is being ablated, the value is fixed to that presented in the manuscript \ie $\alpha=1$, $|\mathcal{D}_h|= 32$, $|\mathcal{D}_c| = 128$, $\beta = 12$, and $k=5000$.

\paragraph{Top-$k$ Value.}

As shown in table \ref{topk}, increasing the value of $k$ allows for a lower FPR at the cost of a drop in TPR.

\begin{table}[h!]
\centering
\begin{tabular}{@{}cccc@{}}
\cmidrule(l){2-4}
                                  & \textbf{$k$} & \textbf{TPR (\%)} & \textbf{FPR (\%)} \\ \midrule
\multirow{2}{*}{\textbf{CYO}}     & 2500             & 99.68             & 2.97              \\
                                  & 7500             & 99.02             & 1.95              \\ \midrule
\multirow{2}{*}{\textbf{FTrojan}} & 2500             & 100.00            & 3.90              \\
                                  & 7500             & 100.00            & 2.73              \\ \midrule
\multirow{2}{*}{\textbf{FIBA}}    & 2500             & 87.89             & 5.85              \\
                                  & 7500             & 85.46             & 5.63              \\ \bottomrule
\end{tabular}
\caption{\textbf{Effect of $k$ in top-$k$ Operation of FREAK}}
\label{topk}
\end{table}

\clearpage
\paragraph{Size of Pooling Filter ($\beta$)}

Table \ref{beta}, shows the effect of changing the filter size $\beta$.

% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
% \usepackage{multirow}
\begin{table}[h!]
\centering
\begin{tabular}{@{}cccc@{}}
\cmidrule(l){2-4}
                                  & \textbf{$\beta$} & \textbf{TPR (\%)} & \textbf{FPR (\%)} \\ \midrule
\multirow{2}{*}{\textbf{CYO}}     & 9                & 99.22             & 1.57              \\
                                  & 16               & 99.22             & 1.95              \\ \midrule
\multirow{2}{*}{\textbf{FTrojan}} & 9                & 100.00            & 2.34              \\
                                  & 16               & 100.00            & 4.29              \\ \midrule
\multirow{2}{*}{\textbf{FIBA}}    & 9                & 91.79             & 8.98              \\
                                  & 16               & 88.08             & 4.98              \\ \bottomrule
\end{tabular}
\caption{\textbf{Effect of Pooling Size $\beta$ on FREAK}}
\label{beta}
\end{table}

\paragraph{Size of Held Out Set}

Table \ref{heldout}, shows the effect of increasing the size of the held-out set. Our results show little to no change in the performance of FREAK with increased size of held-out set.

\begin{table}[h!]
\centering
\begin{tabular}{@{}cccc@{}}
\cmidrule(l){2-4}
                                  & \textbf{$\mid \mathcal{D}_h \mid$} & \textbf{TPR (\%)} & \textbf{FPR (\%)} \\ \midrule
\multirow{2}{*}{\textbf{CYO}}     & 64                                 & 99.22             & 1.95              \\
                                  & 256                                & 99.22             & 1.95              \\ \midrule
\multirow{2}{*}{\textbf{FTrojan}} & 64                                 & 100.00            & 2.73              \\
                                  & 256                                & 100.00            & 2.73              \\ \midrule
\multirow{2}{*}{\textbf{FIBA}}    & 64                                 & 89.68             & 5.15              \\
                                  & 256                                & 90.47             & 5.31              \\ \bottomrule
\end{tabular}
\caption{\textbf{Effect of Size of Held-Out Set on  FREAK}}
\label{heldout}
\end{table}


\paragraph{Size of Clean Set}

Table \ref{clean}, shows the effect of changing the size of the clean set. Our results show little to no change in the performance of FREAK with increased size of held-out set. 


% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
% \usepackage{multirow}
\begin{table}[h!]
\centering
\begin{tabular}{@{}cccc@{}}
\cmidrule(l){2-4}
                                  & \textbf{$\mid \mathcal{D}_c \mid$} & \textbf{TPR (\%)} & \textbf{FPR (\%)} \\ \midrule
\multirow{2}{*}{\textbf{CYO}}     & 64                                 & 99.22             & 2.23              \\
                                  & 256                                & 99.22             & 1.56              \\ \midrule
\multirow{2}{*}{\textbf{FTrojan}} & 64                                 & 100.00            & 2.45              \\
                                  & 256                                & 100.00            & 2.73              \\ \midrule
\multirow{2}{*}{\textbf{FIBA}}    & 64                                 & 86.48             & 4.02              \\
                                  & 256                                & 90.53             & 5.47              \\ \bottomrule
\end{tabular}
\caption{\textbf{Effect of Size of Clean Set on  FREAK}}
\label{clean}
\end{table}


\clearpage



\paragraph{Trade-Off Parameter $\alpha$}

Table \ref{alpha}, shows the effect of changing the confidence parameter $\alpha$. As expected, as $\alpha$ increases we are less


% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
% \usepackage{multirow}
\begin{table}[h!]
\centering
\begin{tabular}{@{}cccc@{}}
\cmidrule(l){2-4}
                                  & \textbf{$\alpha$} & \textbf{TPR (\%)} & \textbf{FPR (\%)} \\ \midrule
\multirow{2}{*}{\textbf{CYO}}     & 2                              & 99.02             & 0.78              \\
                                  & 4                              & 96.09             & 0.39              \\ \midrule
\multirow{2}{*}{\textbf{FTrojan}} & 2                              & 100.00            & 1.17              \\
                                  & 4                              & 100.00            & 1.17              \\ \midrule
\multirow{2}{*}{\textbf{FIBA}}    & 2                              & 81.49             & 2.96              \\
                                  & 4                              & 65.00             & 1.25              \\ \bottomrule
\end{tabular}
\caption{\textbf{Effect of Changing $\alpha$ on FREAK}}
\label{alpha}
\end{table}
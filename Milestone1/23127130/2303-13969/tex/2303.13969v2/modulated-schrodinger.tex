\documentclass[12pt,a4paper]{article}

\pdfoutput=1

\input{preamble_ANG.tex}
\input{tikz-clean/tikz_additional_preamble.tex}


% =========================================================================
% ===== Choose between including TikZ externalized figures and
% ===== including the generated pdf figure.
\newif\ifcustomcompileusingtikzexternalize
% --
% \customcompileusingtikzexternalizetrue % uncomment to compile tikz figures with TikZ externalize, 
\customcompileusingtikzexternalizefalse % uncomment to include only the pdf files (generated by TikZ)
% -------
\ifcustomcompileusingtikzexternalize
    \renewcommand{\customTikzInputFolder}{./tikz-messy/input/}
    \renewcommand{\customTikzOutputFolder}{./tikz-messy/output/} 
\else
    \renewcommand{\customTikzInputFolder}{./tikz-clean/input/}
    \renewcommand{\customTikzOutputFolder}{./tikz-clean/output/} % This folder only contains pdf, a ``clean'' directory
\fi

\tikzsetexternalprefix{\customTikzOutputFolder}
% =========================================================================


\author[1]{Erwan Faou\footnote{\url{erwan.faou@inria.fr}}}
\author[1]{Yoann Le H{\'e}naff\footnote{\url{yoann.lehenaff@univ-rennes.fr}}}
\author[2]{Pierre Rapha{\"e}l\footnote{\url{pr463@dpmms.cam.ac.uk}}}

\affil[1]{\small Rennes University, IRMAR UMR 6625\\INRIA centre at Rennes University (MINGuS project-team), Rennes, France}
\affil[2]{\small Department of Pure Mathematics and Mathematical Statistics, University of Cambridge, Cambridge, U.K.}

\date{}

\begin{document}

\title{On a Bubble algorithm for the cubic Nonlinear Schr\"odinger equation}


\maketitle

\begin{abstract}
    Based on very recent and promising ideas, stemming from the use of \emph{bubbles}, we discuss an algorithm for the numerical simulation of the cubic nonlinear Schr\"odinger equation  with harmonic potential (cNLS) in any dimension, that could easily be extended to other polynomial nonlinearities.
    This algorithm consists in discretizing the initial function as a sum of modulated complex gaussian functions (the bubbles), each one having its own set of parameters, and then updating the parameters according to cNLS.
    Numerically, we solve exactly the linear part of the equation and use the Dirac-Frenkel-MacLachlan principle to approximate the nonlinear part. We then obtain a grid-free algorithm in any dimension, and it is compared to a spectral method on numerical examples. 
\end{abstract}
%



\tableofcontents

\input{sections/intro.tex}
\input{sections/harmonic_oscillator.tex}
\input{sections/dfm_principle.tex}
\input{sections/numerical.tex}
\input{sections/conclusions.tex}


\section*{Acknowledgements}
\addcontentsline{toc}{section}{Acknowledgements}
The authors would like to thank J. Bernier for spotting an abnormal behavior in the spectral method and for his help in fixing it.
EF and YLH were sponsored by the Centre Henri Lebesgue, program ANR-11-LABX-0020-0.




\begin{appendices}
    % \input{sections/appendices/HO_symplectic_change_of_variables.tex}
    \input{sections/appendices/populating_the_linear_system.tex}
    \input{sections/appendices/fourier_transforms.tex}
    \input{sections/appendices/some_computations_with_bubbles.tex}
\end{appendices}


\bibliography{PhD}



\end{document}
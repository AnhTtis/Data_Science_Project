\newcommand{\myD}{0.9\textwidth}
In this section, we consider a two-dimensional valve-like geometry composed of a valve plug encased in a flow channel. Its initial configuration for $t=\SI{0}{\second}$ is depicted in \Cref{subfig:valveSpatialDomain}. At the top, fluid can enter the channel through an inlet with width $L_{\text{inlet}}=\SI{0.025}{\meter}$. The outlet is located at the bottom. All remaining boundary portions are impermeable. We consider a time interval such that $t \in [0,1.8]\,\SI{}{\second}$. With the passage of time, the plug starts to move inward for $t \in [0.3,0.7)\,\SI{}{\second}$, opening a second branch for the flow on the left-hand side. After reaching the center of the casing, the plug stays at rest for $t \in [0.7,1.1)\,\SI{}{\second}$ and, still a bit later, the movement is reversed for $t \in [1.1,1.5)\,\SI{}{\second}$ to close the emerged branch for the remainder of the simulation. The resulting three-dimensional space-time domain is shown in \Cref{subfig:valveSpaceTimeDomain}, while the spatial geometry for different time instances can be seen in \Cref{fig:valveFlowField}. The velocity of the plug in $x$-direction is $u_{\text{plug}} = \pm \SI{0.0625}{\meter\per\second}$ for the inward and outward movement, respectively.
\newcommand{\myw}{0.25}

\newcommand{\myY}{4.7}
\newcommand{\xZero}{1.1}
\newcommand{\deltaX}{0.71}
\newcommand{\deltaXGap}{1.35}

\newcommand{\myX}{4.5}
\newcommand{\yZero}{0.54}
\newcommand{\deltaY}{0.71}

\begin{figure}
\captionsetup[sub]{position=bottom}
\centering
\subcaptionbox{Spatial domain for $t=0.0$.\label{subfig:valveSpatialDomain}}{
\begin{tikzpicture}[
    axis/.style={ -latex},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=\myw\textwidth,trim={0cm 0cm 12cm 0cm},clip]{fig/valve-like/geometry/geometry.0000.png}};
       \draw[axis] (0.1,0.2)  -- (0.6,0.2) node[above]{$x$};
       \draw[axis] (0.1,0.2)  -- (0.1,0.7) node[left]{$y$};      
   %    \draw[latex-latex] (\xZero,4.5)  -- node[above]{$L_{\text{inlet}}$} (\xZero+\deltaX,4.5) ;
    %    \draw[latex-latex] (\xZero,4.5+\deltaY)  -- node[above]{$L_{\text{plug}}$} (\xZero+\deltaX+\deltaX,4.5+\deltaY) ;
     %   \draw[latex-latex] (\xZero,4.5+\deltaY+\deltaY)  -- node[above]{$L_{\text{valve}}$} (\xZero+\deltaX+\deltaX,4.5+\deltaY+\deltaY) ;

       % length in vertical direction
       \dimline[line style={line width=0.75pt},label style={below=2.25em,rotate=-90,anchor=center},extension start length=-0.6,extension end length=-0.6]{(\myX,\yZero)}{(\myX,\yZero+\deltaY)}{\footnotesize \SI{0.025}{\meter}};
       \dimline[line style={line width=0.75pt},label style={below=2.5em,rotate=-90,anchor=center},extension start length=-0.3,extension end length=-0.3]{(\myX,\yZero+\deltaY)}{(\myX,\yZero+1.5*\deltaY)}{\footnotesize \SI{0.0125}{\meter}};
       \dimline[line style={line width=0.75pt},label style={below=2.1em,rotate=-90,anchor=center},extension start length=-0.3,extension end length=-0.3]      {(\myX,\yZero+1.5*\deltaY)}{(\myX,\yZero+3.5*\deltaY)}{\footnotesize \SI{0.05}{\meter}};
       \dimline[line style={line width=0.75pt},label style={below=2.5em,rotate=-90,anchor=center},extension start length=-0.3,extension end length=-0.3]{(\myX,\yZero+3.5*\deltaY)}{(\myX,\yZero+4*\deltaY)}{\footnotesize \SI{0.0125}{\meter}};
     \dimline[line style={line width=0.75pt},label style={below=2.25em,rotate=-90,anchor=center},extension start length=-0.6,extension end length=-0.6]{(\myX,\yZero+4*\deltaY)}{(\myX,\yZero+5*\deltaY)}{\footnotesize \SI{0.025}{\meter}};

       % length in horizontal direction
       \dimline[line style={line width=0.75pt}, 
       label style={rotate=45, above = 6 ex, anchor=north},
       extension start length=0.6,
       extension end length=0.6]{(\xZero,\myY)}{(\xZero+\deltaX,\myY)}{\footnotesize \SI{0.025}{\meter}};
       
       \dimline[line style={line width=0.75pt}, label style={rotate=45, above = 6 ex, anchor=north},extension start length=-0,extension end length=0]{(\xZero+\deltaX,\myY)}{(\xZero+2*\deltaX,\myY)}{\footnotesize\SI{0.025}{\meter}};
       
       \dimline[line style={line width=0.75pt},label style={rotate=45, above = 6 ex, anchor=north},extension start length=0.3,extension end length=0.3]      {(\xZero+2*\deltaX,\myY)}{(\xZero+2*\deltaX+\deltaXGap,\myY)}{\footnotesize \SI{0.05}{\meter}};

        % Radius ring corners
       \dimline[line style={line width=0.75pt},label style={above=2ex}, extension start length=-2,extension end length=-2]{(1.14, 1.74)}{(1.3, 1.9)}{\footnotesize $r=\SI{0.01}{\meter}$};
       
    % Indicate plug velocity
       \draw[axis] (\xZero+\deltaX,\yZero+2.5*\deltaY)  -- (\xZero+2.5*\deltaX,\yZero+2.5*\deltaY) node[above]{$u_{\text{plug}}$};
     
\end{tikzpicture}
}
\subcaptionbox{Space-time domain.\label{subfig:valveSpaceTimeDomain}}{
\begin{tikzpicture}[
    axis/.style={ -latex},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=0.45\textwidth,trim={0cm 0cm 0cm 0cm},clip]{fig/valve-like/geometry/domain_space_time.png}};
      \draw[axis] (1.0,0.1)  -- (1.8,0.05) node(xline)[above]{$x$};
      \draw[axis] (1.0,0.1)  -- (1.0,0.8) node(xline)[right]{$y$};
      \draw[axis] (1.0,0.1)  -- (0.7,-0.2) node(xline)[left]{$t$};

\end{tikzpicture}

}

\caption{Computational domain of valve-like test case.}
\label{fig:valveGeometry}
\end{figure}
\par
The fluid is supposed to be plastics melt as present, e.g., in various polymer processing techniques for thermoplastics. We use material properties for an exemplary \gls{pc} offered by Covestro Makrolon\textsuperscript{\textregistered}. 
We use the density $\density = \SI{1200}{\kilo\gram \per\cubic\meter}$ and, following \cite{Schroeder2020}, the parameters for the viscosity model from~\Cref{eq:viscosityModel} as
\begin{align}
%carreauA 270.0 carreauB 1.2e-3 carreauC 0.225
        \visc_0 = \SI{270}{\pascal\second},\,
        \visc_{\infty} = \SI{0}{\pascal\second},\,
        \lambda = \SI{1.2e-3}{\second},\,
        a = \SI{1}{},\,
        n = \SI{0.775}{}.
\end{align}
In the following, the velocity vector $\vel = \lb \velX, \velY \rb^T$ will collect the velocity components $\velX$ and $\velY$ for the $x$- and $y$-direction, respectively. We prescribe a time-dependent inflow profile given as
\begin{align*}
\velX_{\text{in}}(x,t) &= \SI{0}{\meter\per\second},\\
\velY_{\text{in}}(x,t)& = v_{\text{in}}^0(x(x-\SI{0.025}{\meter}))\sqrt{\frac{t}{\SI{1.8}{\second}}}.   
\end{align*}
Choosing $v_{\text{in}}^0 = \SI{640}{\per\meter\second}$, this leads to a Reynolds number of approximately $Re =  \SI{1e-2}{}$ 
%$Re = \frac{\density \cdot 0.1 \cdot L_{\text{inlet}}}{\visc_0} \SI{1e-2}{}$
such that the Stokes equations are appropriate to model this creeping flow. For the walls of the casing, no-slip boundary conditions are assumed. At the outlet, parallel outflow is enforced by setting the velocity in $x$-direction to zero, i.e., $\velX_{\text{out}} = \SI{0}{\meter\per\second}$. The resulting flow field is visualized in \Cref{fig:valveFlowField} for several points in time.
\begin{figure}
\centering
\subcaptionbox{$t=0.0$}{
\begin{tikzpicture}[
    axis/.style={ -latex},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=0.4\textwidth,trim={0cm 0cm 15cm 0cm},clip]{fig/valve-like/geometry/valve_velocity_glyphs.0000.png}};
       \draw[axis] (0.1,0.2)  -- (0.6,0.2) node[above]{$x$};
       \draw[axis] (0.1,0.2)  -- (0.1,0.7) node[left]{$y$};
\end{tikzpicture}

}
\subcaptionbox{$t=0.45$}{
\begin{tikzpicture}[
    axis/.style={ -latex},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=0.4\textwidth,trim={0cm 0cm 15cm 0cm},clip]
{fig/valve-like/geometry/valve_velocity_glyphs.0015.png}};
       \draw[axis] (0.1,0.2)  -- (0.6,0.2) node[above]{$x$};
       \draw[axis] (0.1,0.2)  -- (0.1,0.7) node[left]{$y$};
\end{tikzpicture}

}
\\
\subcaptionbox{$t=0.9$}{
\begin{tikzpicture}[
    axis/.style={ -latex},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=0.4\textwidth,trim={0cm 0cm 15cm 0cm},clip]
{fig/valve-like/geometry/valve_velocity_glyphs.0030.png}};
       \draw[axis] (0.1,0.2)  -- (0.6,0.2) node[above]{$x$};
       \draw[axis] (0.1,0.2)  -- (0.1,0.7) node[left]{$y$};
\end{tikzpicture}

}
\\
\subcaptionbox{$t=1.35$}{
\begin{tikzpicture}[
    axis/.style={ -latex},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=0.4\textwidth,trim={0cm 0cm 15cm 0cm},clip]{fig/valve-like/geometry/valve_velocity_glyphs.0045.png}};
       \draw[axis] (0.1,0.2)  -- (0.6,0.2) node[above]{$x$};
       \draw[axis] (0.1,0.2)  -- (0.1,0.7) node[left]{$y$};
\end{tikzpicture}

}
\subcaptionbox{$t=1.8$}{
\begin{tikzpicture}[
    axis/.style={ -latex},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=0.4\textwidth,trim={0cm 0cm 15cm 0cm},clip]
{fig/valve-like/geometry/valve_velocity_glyphs.0060.png}};
       \draw[axis] (0.1,0.2)  -- (0.6,0.2) node[above]{$x$};
       \draw[axis] (0.1,0.2)  -- (0.1,0.7) node[left]{$y$};
\end{tikzpicture}

}
\caption{Valve-like test case: flow field for different points in time.}
\label{fig:valveFlowField}
\end{figure}
\iffalse
\begin{itemize}
    \item inlet width $L = \SI{25e-3}{\meter}$
    \item velocity valve plug $u_{\text{plug}} = \SI{0.0625}{\meter\per\second}$ 
    \item inflow velocity $v(x,t) = v_{\text{in}}^0(x(x-\SI{0.025}{\meter}))\sqrt{\frac{t}{\SI{1.8}{\second}}}$ for $t \in [0,1.8]\SI{}{\second}$ 
    \begin{itemize}
        \item $v^{\text{min}}_{\text{in}} = \text{min}\{v(x,t)\} = - \frac{v_{\text{in}}^0}{6400}m^2$ at $x = 0.0125 m, t = 1.8s$
        \item $v_{\text{in}}^0 = 640 \frac{1}{ms} \Rightarrow v^{\text{min}}_{\text{in}} = -0.1\frac{m}{s}$
    \end{itemize}
    \item ABS 
    \begin{itemize}
        \item $\density = 1000 \frac{kg}{m^3}$
        \item $A_0 = 6589 Pa\cdot s, B_0=0.138 s, C_0=0.725$
        \item $Re = \frac{\density v L}{\visc} \overset{!}{\ll} 1 \Rightarrow Re = \frac{\density \left|v^{\text{min}}_{\text{in}}\right| L }{A_0} = \frac{1000 \frac{kg}{m^3} 0.1 \frac{m}{s}  0.025 m}{6589 Pa\cdot s} = 3.79 \cdot 10^{-4}$
    \end{itemize}
    \item PC Makrolon 2400 \cite{Schroeder2020} 
    \begin{itemize}
        \item $\density = \SI{1200}{\kilo\gram\per\cubic\meter}$
        \item $A_0 = \SI{270}{\pascal\second}, B_0=\SI{1.2e-3}{\second}, C_0=0.225$
        \item $Re = \frac{\density v L}{\visc} \overset{!}{\ll} 1 \Rightarrow Re = \frac{\density \left|v^{\text{min}}_{\text{in}}\right| L }{A_0} = \frac{1200 \frac{kg}{m^3} 0.1 \frac{m}{s}  0.025 m}{270 Pa\cdot s} \approx 1 \cdot 10^{-2}$
    \end{itemize}
    \item $\paramVec = [ B, C] \in [0.95B_0, 1.05B_0]\times[0.95C_0, 1.05C_0]$

\end{itemize}
\fi
\subsubsection{\gls{rom} for the Flow of Plastics Melt in a Valve-Like Geometry}
\label{subsubsec:valve-likeROM}
In the following, we will consider uncertainties in the model parameters from the viscosity model stated in \Cref{eq:viscosityModel}. Therefore, we collect two of those parameters in the parameter vector, i.e., $\paramVec = \lb \lambda,n\rb$. Assuming that variations of $\pm5\%$ may occur, it follows that $\paramVec \in \lb0.95\bar{\lambda}, 1.05\bar{\lambda}\rb \times \lb0.95\bar{n}, 1.05\bar{n}\rb$, with $\bar{\lambda} = \SI{1.2e-3}{\second}$ and $\bar{n} = \SI{0.775}{}$.
\bigskip
\par
Next, we will construct the \gls{rom}. To create the snapshots, we generate $\nTrain = 256$ training samples that are equidistantly spaced over the parameter domain. These snapshots are used both for the \gls{pod} and the \gls{eim}. Applying the \gls{pod} results in the distribution of eigenvalues $\lambda_i$ shown in \Cref{fig:valve-likeEigenvalues}. Based on a threshold for the so-called retained energy, we choose $\nBasisVelocityHomROM = 1,\dots,10$ and $\nBasisPressureROM = 1,\dots,6$ in the following. Since all Dirichlet boundary conditions are parameter-independent in this case, we use only one lifting function resulting in $\nBasisVelocityROM = 1,\dots,11$. For comparison, the \gls{fom} includes a total number of \glspl{dof} of $\nBasisFOM = 334,762$. As has been mentioned before, the non-linearity in the viscosity $\visc$ and in the stabilization parameter $\tMomPlain$ is tackled by the \gls{eim}. The maximum interpolation error for both quantities in the course of the greedy search is depicted in \Cref{fig:valve-likeEIMErrors}. Setting a tolerance of $\SI{5e-15}{}$ and $\SI{2e-15}{}$, we use $Q_{\visc} = 45$ and $Q_{\tau} = 39$ terms for the approximation.
\begin{figure}
    \captionsetup[sub]{position=bottom}
    \centering
    \Large
    \subcaptionbox{Distribution of the eigenvalues from the \gls{pod}.\label{fig:valve-likeEigenvalues}}{
        \resizebox{0.44\textwidth}{!}{
        \input{fig/valve-like/ROM/eigs_abs_u_p.tex}
        }
    }
    \subcaptionbox{Maximum interpolation error during the \gls{eim}.\label{fig:valve-likeEIMErrors}}{
        \resizebox{0.44\textwidth}{!}{
        \input{fig/valve-like/ROM/xnsMOR_31356356_offline-out.txt_EIM_Errors.tex}
        }
    }
    \caption{Valve-like test case: results from the construction of the \gls{rom}.}
    \label{fig:valve-likeOffline}
\end{figure}
\bigskip
\par
To quantify the quality of the \gls{rom}, we perform an error and performance analysis. To that end, we create $\nTest = 50$ testing samples drawn from a uniform distribution. For each sample, we compare the solutions from the \gls{fom} and the \gls{rom} as well as the respective runtimes.
To evaluate the accuracy of the \gls{rom}, we use the following error definitions:
\begin{align}
    \relErrorVelocity
    =
    \frac
    {|\trialVelocityDiscrete-\trialVelocityReduced|_{\sobolevSpaceVector}}
    {|\trialVelocityDiscrete|_{\sobolevSpaceVector}},
    \,
    \relErrorPressure
    =
    \frac
    {||\trialPressureDiscrete-\trialPressureReduced||_{L^2}}
    {||\trialPressureDiscrete||_{L^2}},
\end{align}
where $|\cdot|_{\sobolevSpaceVector}$ and $||\cdot||_{L^2}$ are discrete measures for the $\sobolevSpaceVector$ semi-norm and the $L^2$ norm, respectively. The maximal error over all testing samples is shown in \Cref{fig:valveRelativeErrorMax}, using different numbers of basis functions for the velocity and the pressure field. Note that we ignore the lifting function in these plots, since it does not represent a solution, but is only intended to ensure the Dirichlet boundary conditions.
For the velocity, the error ranges from values smaller than \SI{1e-2}{} to values smaller than \SI{1e-6}{} when increasing the number of basis functions. Similarly, the maximum error in the pressure is limited by \SI{1e-2}{} and drops below \SI{1e-7}{} for $\nBasisVelocityROM$ and $\nBasisPressureROM$ large enough. These results suggest that the error introduced by the \gls{rom} is in a reasonable range for typical engineering applications and, furthermore, that it can be controlled by choosing the number of basis functions such that a desired accuracy is achieved.
\begin{figure}
    \captionsetup[sub]{position=bottom}
    \centering
    \Large
    \subcaptionbox{Velocity.}{
        \resizebox{0.44\textwidth}{!}{
        \input{fig/valve-like/ROM/analysis/relative_error_u_max}}
    }
    \subcaptionbox{Pressure.}{
        \resizebox{0.44\textwidth}{!}{
        \input{fig/valve-like/ROM/analysis/relative_error_p_max}}
    }
    \caption{Valve-like test case: maximum relative error of the \gls{rom} over all testing samples.}
    \label{fig:valveRelativeErrorMax}
\end{figure}
\par
Finally, we investigate the performance of the \gls{rom} by comparing the CPU time needed for a single evaluation of the \gls{rom} to that for the \gls{fom}. Note that the former has been run on a single core, whereas the latter used 64 cores. Also in this analysis, we skip the lifting function for the same reason as before. \Cref{fig:valvePerformance} presents the speed up, i.e., the ratio between the CPU time of \gls{fom} and \gls{rom} evaluations, for different number of basis functions $\nBasisVelocityROM$ and $\nBasisPressureROM$.  Both, the average and the maximum speed up, are in the order of 1000 and indicate that a significant reduction of the runtime for the \gls{rom} is realized. 
\begin{figure}
    \captionsetup[sub]{position=bottom}
    \centering
    \Large
    \subcaptionbox{Average speed up over all testing samples.}{
        \resizebox{0.44\textwidth}{!}{
        \input{fig/valve-like/ROM/analysis/speedup_avg}}
    }
    \subcaptionbox{Maximum speed up over all testing samples.}{
        \resizebox{0.44\textwidth}{!}{
        \input{fig/valve-like/ROM/analysis/speedup_max}}
    }
    \caption{Valve-like test case: performance results.}
    \label{fig:valvePerformance}
\end{figure}
\par
Taken together, the error and performance analysis confirms the effectiveness of the approach for this two-dimensional deforming domain problem with topology changes. In particular, the accuracy of the \gls{rom} is acceptable as well as controllable while a significant reduction of the  computational demands is achieved, too. This qualifies the \gls{rom} as a surrogate model, e.g., in one of the aforementioned many query scenarios.   
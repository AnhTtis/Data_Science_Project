After presenting results for a spatially deforming two-dimensional geometry, we will now demonstrate the aptitude of the proposed approach also for the three-dimensional case, resulting in a four-dimensional space-time domain. The geometry is inspired by an artery that locally undergoes compression over time. The initial spatial geometry can be seen in \Cref{fig:arteryGeoInitialFront,fig:arteryGeoInitialSide,fig:arteryGeoInitialTop}. It has a length of $L = \SI{60e-3}{\meter}$ and a radius of $r_0 = \SI{5e-3}{\meter}$.
We are interested in the internal flow over a time period of $\SI{1}{\second}$ where fluid enters on the left-hand side, i.e., at $x_{\text{min}}$ .
The local narrowing of the artery happens according to the following expression for the upper and lower parts of the moving boundary:
\begin{align*}
    y(t) = \pm  \left[ 0.2 + 0.2 \cdot\left(\cos{(\pi\, t\,\si{\per\second})}+1\right)\right] \cdot r_0 .%, \, r_0 = \SI{5e-3}{\meter}. 
\end{align*}
The final state of the deformed spatial geometry is depicted in \Cref{fig:arteryGeoFinalSide,fig:arteryGeoFinalTop}.
\iffalse
Since we assume no-slip conditions along the walls, 
$x \in  [-\SI{30}{\milli\meter}, \SI{30}{\milli\meter}], \,  y \in [-\SI{5}{\milli\meter},\SI{5}{\milli\meter}], \, z \in [-\SI{5}{\milli\meter},\SI{5}{\milli\meter}], \, t \in [ \SI{0}{\second} ,\SI{1}{\second}]$. 
\fi
\par
To mimic blood, the density is set to $\density = \SI{1058}{\kilo\gram\per\cubic\meter}$ and the parameters for the viscosity model are chosen as presented in \cite{Cho1991}:
% etaZero 0.16 etaInf 0.0035 relaxTime 8.2 transRegionExponent 0.64 powerIndex 0.2128
\begin{align*}
    \visc_0 = \SI{0.056}{Pa\cdot s}, \,
    \visc_{\infty} = \SI{0.00345}{Pa\cdot s}, \,
    \lambda = \SI{1.902}{s}, \,
    a = \SI{1.25}{}, \,
    n = \SI{0.22}{}.
\end{align*}
\par
For the inflow velocity, we prescribe the following time-dependent profile:
%1.0e-1*(1-((sqrt(y*y+z*z)/0.005)*(sqrt(y*y+z*z)/0.005)))*(sqrt(t/0.2)*heaviside(0.2-t)+heaviside(t-0.2))
\begin{align*}
    \begin{aligned}
        \velX = \velX_{\text{in}}^0 \lp 1 - \frac{(y^2+z^2)}{r_0^2} \rp  \cdot 
        \begin{cases}  
            \sqrt{\frac{t}{\SI{0.2}{\second}}}    &\text{ for } t < \SI{0.2}{\second},
            \\
            1   &\text{ for } t \ge \SI{0.2}{\second},
        \end{cases}
    \end{aligned}
    \quad
    \begin{aligned}
        \velY = \SI{0}{\meter\per\second}, \quad \velZ = \SI{0}{\meter\per\second},       
    \end{aligned}
    \label{eq:artery-likeInflow}
\end{align*}
with the velocity vector $\trialVelocity = \lb \velX, \velY, \velZ \rb^T$ and $\velX_{\text{in}}^0=\SI{0.1}{\meter\per\second}$. At the outlet, a parallel outflow is enforced, i.e., $\velY=\velZ=0$. Along the walls, no-slip conditions are set. To account for the narrowing, we apply the following boundary conditions for the velocity in $y$-direction on the horizontal and rounded parts:
\begin{align}
   \velY = \frac{\partial y(t)}{\partial t} = \mp \pi \sin(\pi t)\times 10^{-3}\,\si{\meter\per\second}.% = \frac{\pi}{1000} \sin(\pi t) \, \si{\meter\per\second}
\end{align}
The sign of this term depends on whether you consider the upper or the lower part. In particular, the negative and the positive sign correspond to a downward movement for $y>0$ and an upward movement for $y<0$, respectively. 
For this geometry, a locally refined boundary-conforming simplex space-time mesh is constructed using a four-dimensional elastic mesh update~\cite{Danwitz2021}.
\Cref{fig:artery-likeVelocityInitial,fig:artery-likeVelocityFinal} show the resulting velocity field along the artery in its center plane for the initial and final state.
\newcommand{\myW}{0.48\textwidth} 
\begin{figure}
\captionsetup[sub]{position=bottom}
\centering
\subcaptionbox{Front view.\label{fig:arteryGeoInitialFront}}{
 %  \tikzsetnextfilename{topology-arteryFront}
   \begin{tikzpicture}[
    axis/.style={thick, ->},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=\myW,trim={0cm 0cm 0cm 0cm},clip]{fig/artery-like/geometry/frontView/artery-like_3DGeometryFrontView.png}};
       \draw[axis] (0.2*\myW,0.05*\myW)  -- (0.3*\myW,0.05*\myW) node(xline)[right]{$z$};
       \draw[axis] (0.2*\myW,0.05*\myW)  -- (0.2*\myW,0.15*\myW) node(xline)[right]{$y$};
\end{tikzpicture}
}
\subcaptionbox{Side view at $t=0.0\,$s.\label{fig:arteryGeoInitialSide}}{
%\tikzsetnextfilename{topology-arterySide}
\begin{tikzpicture}[
    axis/.style={thick, ->},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=\myW,trim={0cm 20cm 0cm 0cm},clip]{fig/artery-like/geometry/sideView/artery-like_3DSideView.0000.png}};
       \draw[axis] (0.1*\myW,0.05*\myW)  -- (0.2*\myW,0.05*\myW) node(xline)[right]{$x$};
       \draw[axis] (0.1*\myW,0.05*\myW)  -- (0.1*\myW,0.15*\myW) node(xline)[right]{$y$};
\end{tikzpicture}
}\subcaptionbox{Top view $t=0.0\,$s.\label{fig:arteryGeoInitialTop}}{
   %\tikzsetnextfilename{topology-arteryTop}
\begin{tikzpicture}[
    axis/.style={thick, ->},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=\myW,trim={0cm 20cm 0cm 0cm},clip]{
       fig/artery-like/geometry/topView/artery-like_3DGeometryTopView.0000.png}};
       \draw[axis] (0.1*\myW,0.15*\myW)  -- (0.2*\myW,0.15*\myW) node(xline)[right]{$x$};
       \draw[axis] (0.1*\myW,0.15*\myW)  -- (0.1*\myW,0.05*\myW) node(xline)[right]{$z$};
\end{tikzpicture}
}\\
\subcaptionbox{Side view at $t=\SI{1}{\second}$.\label{fig:arteryGeoFinalSide}}{
 %   \tikzsetnextfilename{topology-arteryCSide}
\begin{tikzpicture}[
    axis/.style={thick, ->},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=\myW,trim={0cm 20cm 0cm 0cm},clip]{fig/artery-like/geometry/sideView/artery-like_3DSideView.0034.png}};
       \draw[axis] (0.1*\myW,0.05*\myW)  -- (0.2*\myW,0.05*\myW) node(xline)[right]{$x$};
       \draw[axis] (0.1*\myW,0.05*\myW)  -- (0.1*\myW,0.15*\myW) node(xline)[right]{$y$};
\end{tikzpicture}
}\subcaptionbox{Top view at $t=\SI{1}{\second}$.\label{fig:arteryGeoFinalTop}}{
    % \tikzsetnextfilename{topology-arteryCTop}
 \begin{tikzpicture}[
    axis/.style={thick, ->},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=\myW,trim={0cm 20cm 0cm 0cm},clip]{fig/artery-like/geometry/topView/artery-like_3DGeometryTopView.0034.png}};
       \draw[axis] (0.1*\myW,0.15*\myW)  -- (0.2*\myW,0.15*\myW) node(xline)[right]{$x$};
       \draw[axis] (0.1*\myW,0.15*\myW)  -- (0.1*\myW,0.05*\myW) node(xline)[right]{$z$};
\end{tikzpicture}
}
\caption{Artery-like test case: geometry.}
\label{fig:arteryGeo}
\end{figure}




%%%%%%%%%%%%%%%%%%%%%%%%%% BEGIN HIDDEN
\iffalse
\subsubsection{4D mesh generation}

The space-time finite element simulation of considered transient three-dimensional problem requires a four-dimensional mesh. To generate a four-dimensional pentatope mesh, we follow the procedure outlined in~\cite{danwitz2021four}. In this section, we describe the essential test case specific steps and provide reference with more details on the underlying algorithms.

\renewcommand{\myD}{0.9\textwidth}
\begin{figure}
\centering
% \tikzsetnextfilename{topology-arteryMesh}
\begin{tikzpicture}[
    axis/.style={very thick, ->},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=\myD,trim={0cm 0cm 0cm 0cm},clip]{fig/artery-like/xyt}};
       \draw[axis] (0.014*\myD,0.434*\myD)  -- (0.11*\myD,0.45*\myD) node(xline)[above]{$x$};
       \draw[axis] (0.014*\myD,0.434*\myD)  -- (0.0*\myD,0.5*\myD) node(xline)[right]{$y$};
       \draw[axis] (0.014*\myD,0.434*\myD)  -- (0.016*\myD,0.3*\myD) node(xline)[left]{$t$};
\end{tikzpicture}
\caption{Clamped artery. $x$-$y$-$t$-Mesh.}
\label{fig:arteryMesh}
\end{figure}

Starting point of the pentatope mesh generation for the Artery-like geometry is the tetrahedral mesh shown in Figure~\ref{fig:arteryMesh}. The $x$-$y$-$t$-Mesh can be seen as a space-time mesh for the two-dimensional center plan ($z=0$) of the artery. Please, note that  tetrahedral mesh is refined in the clamp region.

\renewcommand{\myD}{0.9\textwidth}
\begin{figure}
\centering
% \tikzsetnextfilename{topology-arteryMesh}
\begin{tikzpicture}[
    axis/.style={very thick, ->},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=\myD,trim={0cm 0cm 0cm 0cm},clip]{fig/artery-like/Nnt}};
       \draw[axis] (0.014*\myD,0.434*\myD)  -- (0.11*\myD,0.45*\myD) node(xline)[above]{$x$};
       \draw[axis] (0.014*\myD,0.434*\myD)  -- (0.0*\myD,0.5*\myD) node(xline)[right]{$y$};
       \draw[axis] (0.014*\myD,0.434*\myD)  -- (0.016*\myD,0.3*\myD) node(xline)[left]{$t$};
\end{tikzpicture}
\caption{Clamped artery. Nodes inserted during mesh extrusion from 3D to 4D.}
\label{fig:arteryNnt}
\end{figure}

Then, following Behr~\cite{behr2008simplex}, the mesh is extruded in the fourth dimension, nodes are inserted, and a pentatope triangulation is generated. We want to point out that the resulting mesh is refined isotropic in time and all three space directions. The locally refined pentatope mesh is obtained by adjusting the number of nodes inserted to the four-dimensional geometry and the expected flow field. In Figure~\ref{fig:arteryNnt}, the x-y-t-mesh is colored according to the number of nodes inserted in the fourth dimension. The resulting mesh consists of \num{14319807} pentatopes that connect \num{815874} nodes. For further details and application cases with locally refined pentatope meshes, we refer to the descriptions in~\cite{behr2008simplex, karyofylli2018simplex, danwitz2019simplex}.

\renewcommand{\myW}{0.48\textwidth} 
\begin{figure}
\captionsetup[sub]{position=bottom}
\centering
\subcaptionbox{Top view $t=0.0\,$s.}{
   %\tikzsetnextfilename{topology-arteryTop}
\begin{tikzpicture}[
    axis/.style={thick, ->},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=\myW,trim={0cm 0cm 0cm 0cm},clip]{
       fig/artery-like/yzSquare}};
       \draw[axis] (0.1*\myW,0.05*\myW)  -- (0.2*\myW,0.05*\myW) node(xline)[right]{$y$};
       \draw[axis] (0.1*\myW,0.05*\myW)  -- (0.1*\myW,0.15*\myW) node(xline)[right]{$z$};
\end{tikzpicture}
}\subcaptionbox{Side view at $t=0.5\,$s.}{
 %   \tikzsetnextfilename{topology-arteryCSide}
\begin{tikzpicture}[
    axis/.style={thick, ->},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=\myW,trim={0cm 0cm 0cm 0cm},clip]{fig/artery-like/yzCircle}};
       \draw[axis] (0.1*\myW,0.05*\myW)  -- (0.2*\myW,0.05*\myW) node(xline)[right]{$y$};
       \draw[axis] (0.1*\myW,0.05*\myW)  -- (0.1*\myW,0.15*\myW) node(xline)[right]{$z$};
\end{tikzpicture}
}
\caption{Clamped artery. Two representative triangular meshes on the geometry at $x=0$, $t=0$ before and after the application of the elastic mesh update}
\label{fig:arteryxZeroMeshes}
\end{figure}

After extrusion, the mesh cross-section at $x=0$, $t=0$ is a square. To obtain the approximately circular cross-section of the artery-like geometry, we apply an four-dimensional elastic mesh update method (4DEMUM)~\cite{danwitz2021four}. Figure~\ref{fig:arteryxZeroMeshes} visualizes the elastic mesh update with two representative triangular meshes on the geometry.

In the 4DEMUM procedure, the space-time coordinates $[x,y,z,t]^T$ are identified with four spatial coordinates $[x_1, x_2, x_3, x_4]^T$. Following~\cite[Section 4.2.2]{danwitz2021four}, we prescribe the displacements on the pentatope mesh boundary, 
\begin{equation}
 	\label{eq:artDisp}
 	   \mathbf{g}^h =  0.9 \left[  \begin{array}{c}
	     0 \\
	     \left( \sqrt{1-\frac{1}{2} x_3^2 } -1\right) x_2\\ 
	     \left( \sqrt{1-\frac{1}{2} x_2^2} -1\right) x_3\\ 
	     0  \end{array} \right].  \quad
\end{equation}
This boundary condition $\mathbf{g}^h$ maps the square cross-section in the $x_2$-$x_3$-plane onto an approximately circular shape (see Figure~\ref{fig:arteryxZeroMeshes} on the right).

In a final step before the transient simulation, the spatial coordinates $[x_1, x_2, x_3, x_4]^T$ are again identified with the space-time coordinates $[x,y,z,t]^T$ and the mesh is scaled such that $x \in  [-\SI{3}{\centi\meter}, \SI{3}{\centi\meter}], \,  y \in [-\SI{0.5}{\centi\meter},\SI{0.5}{\centi\meter}], \, z \in [-\SI{0.5}{\centi\meter},\SI{0.5}{\centi\meter}], \, t \in [ \SI{0}{\second} ,\SI{1}{\second}]$. 
\fi
%%%%%%%%%%%%%%%%%%%%%%%%%% END HIDDEN


\renewcommand{\myW}{0.44\textwidth} 
\begin{figure}
\captionsetup[sub]{position=bottom}
\centering

\subcaptionbox{$t=\SI{0}{\second}$.\label{fig:artery-likeVelocityInitial}}{
\begin{tikzpicture}[
    axis/.style={thick, ->},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=\myW,trim={0cm 8cm 0cm 0cm},clip]{fig/artery-like/FOM/3DVelocityClip/artery-like_FOM_3DVelocityClipGlyphs.0000.png}};
       \draw[axis] (0.1*\myW,0.05*\myW)  -- (0.2*\myW,0.05*\myW) node(xline)[right]{$x$};
       \draw[axis] (0.1*\myW,0.05*\myW)  -- (0.1*\myW,0.15*\myW) node(xline)[right]{$y$};
\end{tikzpicture}
}
\subcaptionbox{$t=\SI{1}{\second}$.\label{fig:artery-likeVelocityFinal}}{
\begin{tikzpicture}[
    axis/.style={thick, ->},
    every node/.style={color=black}
    ]
       \node at (0,0) [inner sep=0pt, anchor=south west] {\includegraphics[width=\myW,trim={0cm 8cm 0cm 0cm},clip]{fig/artery-like/FOM/3DVelocityClip/artery-like_FOM_3DVelocityClipGlyphs.0034.png}};
       \draw[axis] (0.1*\myW,0.05*\myW)  -- (0.2*\myW,0.05*\myW) node(xline)[right]{$x$};
       \draw[axis] (0.1*\myW,0.05*\myW)  -- (0.1*\myW,0.15*\myW) node(xline)[right]{$y$};
\end{tikzpicture}
}
\caption{Artery-like test case: velocity field for the initial and final state.}
\label{fig:artery-likeVelocity}
\end{figure}

\subsubsection{\gls{rom} for the Flow of Blood in an Artery-Like Geometry}
In the following, a \gls{rom} is constructed for a variation of the prescribed inflow velocity, i.e., $\paramVec = [u^0_{\text{in}}]$ with $\paramVec \in [0.95u^0_{\text{in}}, 1.05u^0_{\text{in}}]$. In this case, we have to distinguish between the inlet boundary portion with a parameter-dependent Dirichlet boundary condition and the moving artery walls with prescribed values that are non-zero but parameter-independent. Thus, we make use of two lifting functions here.
\par
First, we compute snapshots with the \gls{fom} for $\nTrain = 41$ training samples that are equidistantly distributed. Here, the \gls{fom} involves $\nBasisFOM = 2,194,390$ \glspl{dof} in total. As a result from the \gls{pod}, the distribution of eigenvalues is depicted in \Cref{fig:artery-likeEigenvalues} and we choose $\nBasisVelocityROM= 1,\dots,7$, including the two velocity lifting functions, and $\nBasisPressureROM = 1,\dots,3$. For the \gls{eim}, we set a tolerance of $\SI{1e-12}{}$ and $\SI{1e-13}{}$ and obtain $Q_{\visc} = 30$ and $Q_{\tau} = 27$, respectively. \Cref{fig:artery-likeEIMErrors} shows the maximum interpolation error for the viscosity $\visc$ and the stabilization parameter $\tMomPlain$ during the \gls{eim}. 
\par
Subsequently, we use $\nTest= 20$ uniformly distributed random samples to carry out the error and performance analysis. The results for the maximal relative errors $\relErrorVelocity$ and $\relErrorPressure$ are presented in \Cref{fig:artery-likeRelativeErrorMax}. The qualitative behavior of the errors is very similar as for the valve-like test case (see \Cref{subsubsec:valve-likeROM}). However, the magnitude of the error is not as small as before. For the velocity, it is smaller than \SI{1e-2}{} and decreases to below \SI{1e-5}{}. In a like manner, the error in the pressure ranges from values smaller than \SI{1e-2}{} to values less than \SI{1e-4}{}.   
\begin{figure}
    \captionsetup[sub]{position=bottom}
    \centering
    \Large
    \subcaptionbox{Distribution of the eigenvalues from the \gls{pod}.\label{fig:artery-likeEigenvalues}}{
        \resizebox{0.44\textwidth}{!}{
        \input{fig/artery-like/ROM/eigs_abs_u_p.tex}
        }
    }
    \subcaptionbox{Maximum interpolation error during the \gls{eim}.\label{fig:artery-likeEIMErrors}}{
        \resizebox{0.44\textwidth}{!}{
        \input{fig/artery-like/ROM/xnsMOR_31350626_offline-out.txt_EIM_Errors.tex}
        }
    }
    \caption{Artery-like test case: results from the construction of the \gls{rom}.}
    \label{fig:artery-likeOffline}
\end{figure}
\par
\begin{figure}
    \captionsetup[sub]{position=bottom}
    \centering
    \Large
    \subcaptionbox{Velocity.}{
        \resizebox{0.44\textwidth}{!}{
        \input{fig/artery-like/ROM/analysis/relative_error_u_max.tex}}
    }
    \subcaptionbox{Pressure.}{
        \resizebox{0.44\textwidth}{!}{
        \input{fig/artery-like/ROM/analysis/relative_error_p_max.tex}}
    }
    \caption{Artery-like test case: maximum relative error of the \gls{rom} over all testing samples.}
    \label{fig:artery-likeRelativeErrorMax}
\end{figure}
\par
Next, we present the results from the performance analysis. The \gls{rom} has been evaluated on a single core, whereas we have used 240 cores to compute the \gls{fom}. The measured speed up --- the average and the maximum over all the testing samples --- is shown in \Cref{fig:artery-likePerformance}. The results are, to some extent, counter-intuitive. First, one can observe that the speed up is mainly governed by $\nBasisVelocityROM$ and roughly constant for  $\nBasisPressureROM$. Second, the speed up does not change monotonically with increasing $\nBasisVelocityROM$ but has a local maximum at $\nBasisVelocityROM=5$. Analyzing the evaluation of the \gls{rom} in more detail has revealed that this pattern originates from the number of iterations needed to solve the non-linear reduced system. In particular, the value for $\nBasisVelocityROM$ influences the number of non-linear iterations and, in some cases, slows down the solution process. Nevertheless, the order of magnitude of the observed speed up, ranging from 25,000 to 60,000, is still compelling and even much more significant than in the previous test case.
\begin{figure}
    \captionsetup[sub]{position=bottom}
    \centering
    \Large
    \subcaptionbox{Average speed up over all testing samples.}{
        \resizebox{0.44\textwidth}{!}{
        \input{fig/artery-like/ROM/analysis/speedup_avg.tex}}
    }
    \subcaptionbox{Maximum speed up over all testing samples.}{
        \resizebox{0.44\textwidth}{!}{
        \input{fig/artery-like/ROM/analysis/speedup_max.tex}}
    }
    \caption{Artery-like test case: performance results.}
    \label{fig:artery-likePerformance}
\end{figure}
\par
So, also the results for this test case underline the advantages of the proposed approach in general and, specifically, its ability to handle problems defined in a four-dimensional space-time domain. 
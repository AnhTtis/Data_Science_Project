In this section, we will derive the \gls{fom} which results from applying the \gls{fem} to the parametric problem introduced beforehand. In particular, this model will be capable of simulating transient problems in deforming domains. To that end, \Cref{subsec:methodologicalBackgroundFOM}  will first contain a brief outline of existing techniques that address deforming domain problems in this context. Subsequently, we present the space-time \gls{fem} used in this work in \Cref{subsec:discreteFormulationFOM}.

\subsection{Methodological Background for Deforming Domains in the Full-Order Model}
\label{subsec:methodologicalBackgroundFOM}
In the following, we will roughly outline existing approaches for deforming domain problems, i.e., problems including moving boundaries or internal interfaces, without claiming completeness. First, one can make a division into interface capturing and interface tracking methods \cite{Elgeti2016}. Well-known examples for interface capturing methods, which employ an implicit description of domain boundaries or interfaces on a background mesh, are the level-set method \cite{Osher1988,Chang1996} or the volume-of-fluid method \cite{Hirt1981}. In contrast, interface tracking methods are based on boundary-conforming meshes. Thus, an update procedure that adapts the computational mesh according to the deforming domain is needed.
\par
There exist a vast number of strategies, ranging from global remeshing to elaborate methods specifically designed for certain applications or types of deformation. As examples for connectivity-preserving methods that update nodal coordinates, one can mention \gls{pde}-based methods like the \gls{emum} \cite{Tezduyar1992}, spring-based methods \cite{Batina1990} or techniques using radial basis functions \cite{DeBoer2007}. Further methods extend these strategies by a subsequent mesh optimization, e.g., through edge swapping or vertex smoothing operations \cite{Alauzet2013,Wang2015a}. Moreover, specialized mesh update methods use algebraic operations to control the mesh evolution for a-priori known boundary deformations~\cite{Helmig2019, Hinz2020}. Furthermore, local remeshing strategies limit the cost of maintaining a high quality boundary-conforming mesh under large deformations~\cite{Behr1999,Behr2001,Behr2003}. Broadening the scope of these methods, parts of the mesh can be activated and deactivated~\cite{Key2018} and topology changes of the computational domain can be handled elegantly~\cite{Gonzalez2023}.
\par
As an alternative, one can also follow weak domain coupling strategies to account for the moving boundary or interface by using composite grids and introducing additional conditions on the solution field. Examples are the Chimera method \cite{Steger1983, Benek1986, Steger1987} or sliding interface approaches \cite{Bazilevs2008, Takizawa2015, Helmig2020}. It is also worthwhile to mention the immersed boundary method \cite{Peskin1972}, where simulations are always performed on a cartesian background grid.
\par
Deforming domain problems are inherently transient and their solution requires a form of time discretization. Common approaches include time-stepping methods which separate spatial and temporal discretization and space-time methods which apply a combined discretization to the space-time domain. Time stepping schemes, e.g., the generalized $\alpha$-method~\cite{Chung1993}, require an arbitrary Lagrangianâ€“Eulerian (ALE) formulation for moving-domain simulations~\cite{Hughes1981, Donea2004}, while the space-time formulation directly accounts for the (spatial) mesh deformation~\cite{Tezduyar1992a, Tezduyar1992b}.
\par
If the movement is known during mesh generation --- typically this means before the simulation start --- the time-continuous space-time approach allows to incorporate complex deformations of the spatial domain in a boundary-conforming space-time mesh. Even topology changes can be included as shown in finite volume and finite element simulations~\cite{Rendall2012, Danwitz2019}. For two-dimensional problems, standard mesh generation tools can be used to construct the three-dimensional space-time mesh. For three-dimensional problems, more sophisticated mesh generation and adaptation techniques are required. The common approach to generate an unstructured four-dimensional mesh is based on the extrusion of a tetrahedral mesh followed by a subdivision of the prismatic elements into pentatopes (4-simplices). The subdivision can either be achieved with an element-wise Delaunay triangulation~\cite{Behr2008} or with a predefined decomposition which requires a consistently numbered tetrahedral mesh~\cite{Karabelas2019}. Further techniques enable refinement and anisotropic adaptation of four-dimensional meshes~\cite{Neumueller2011, Wang2015a, Caplan2020}.  Four-dimensional meshes with complex deformations and topology changes of the three-dimensional spatial domain can be obtained with an elastic mesh update following extrusion based pentatope mesh generation~\cite{Danwitz2021}. Please, note that the additional effort for the space-time mesh generation completely replaces the special treatment of a deforming domain problem during the simulation. Nevertheless, our boundary-conforming space-time mesh approach is limited to 4D geometries that can be obtained by extrusion of a 3D geometry and a subsequent elastic deformation. Generating meshes for general 4D geometries of engineering scale is -- to the best of our knowledge -- an open research problem.
\subsection{Discrete Formulation for the Full-Order Model}
\label{subsec:discreteFormulationFOM}
Next, we will derive the \gls{fom}, which will be based on the \gls{fem}. Thus, we introduce corresponding finite dimensional subspaces for the trial and weighting spaces introduced in \Cref{sec:parametricFormulation}. Let $\trialSpaceVelocityDiscrete(\domainSpaceTime)$ and $\weightingSpaceVelocityDiscrete(\domainSpaceTime)$ be the finite dimensional subspaces of $\trialSpaceVelocity(\domainSpaceTime)$ and $\weightingSpaceVelocity(\domainSpaceTime)$, respectively. Furthermore, $\trialSpacePressureDiscrete(\domainSpaceTime)$ is the finite dimensional subspace of $\trialSpacePressure(\domainSpaceTime)$. We  stick to the \textit{\gls{csst}} approach, i.e., the computational mesh will be composed of simplex elements filling the entire space-time domain $\domainSpaceTime$. Furthermore, we use first-order polynomials as shape functions $\basisFunctionVelocityFOM{i}$ and $\basisFunctionPressureFOM{i}$ for velocity and pressure, respectively.
\par
To handle (parametric) Dirichlet boundary conditions, we introduce a \textit{velocity lifting function} $\liftingVelocityDiscrete(\paramVec)$ such that the \textit{discrete velocity trial function} is given as
\begin{align}
    \trialVelocityDiscrete(\paramVec) = \trialVelocityHomDiscrete(\paramVec) + \liftingVelocityDiscrete(\paramVec),
\end{align}
with the homogeneous portion $\trialVelocityHomDiscrete(\paramVec)$ and $\liftingVelocityDiscrete(\paramVec)\lvert_{\boundarySpaceTimeDirichlet}=\velDirichlet(\paramVec)$.
Note that additional lifting functions may be used to separate parameter-dependent and independent portions of the Dirichlet boundary conditions.
For the sake of notation, however, we only consider the case of a single lifting function here.
%Note that $\liftingVelocityDiscrete$ can be split into parameter-dependent and independent parts . 
Consequently, it holds that $\trialVelocityDiscrete \in \trialSpaceVelocityDiscrete(\domainSpaceTime)$ and $ \trialVelocityHomDiscrete \in \weightingSpaceVelocityDiscrete(\domainSpaceTime)$. Moreover, the \textit{discrete pressure trial function} is denoted as $\trialPressureDiscreteParam \in \trialSpacePressureDiscrete(\domainSpaceTime)$
\iffalse
The ansatz for the velocity and the pressure is given as:
\begin{align}
    \trialVelocityHomDiscrete 
    =
    \sum_{B=1}^{\nBasisVelocityFOM}
    \coeffVelocityFOM{B}
    \basisFunctionVelocityFOM{B}
    ,
    &&\trialPressureDiscrete
    =
    \sum_{B=1}^{\nBasisPressureFOM}
    \coeffPressureFOM{B}
    \basisFunctionPressureFOM{B},
\end{align}
with corresponding basis functions $\basisFunctionVelocityFOM{B}$, $\basisFunctionPressureFOM{B}$ and coefficients $\coeffVelocityFOM{B}$, $\coeffPressureFOM{B}$. The number of basis functions for each field is denoted as $\nBasisVelocityFOM$ or $\nBasisPressureFOM$.
\bigskip\par
Up to now, we have followed the standard Galerkin approach just as before. In doing so, the numerical treatment of these equations reveals two kinds of difficulties, which have to be opposed with appropriate stabilization techniques (see e.g. \cite{Donea2003} and references therein). First, the incompressibility constraint leads to a problem of saddle-point character. As a consequence, the choice of element interpolation functions, e.g., the order of the polynomials, becomes critical. More specifically, the spaces for velocity and pressure have to be chosen in a way in which the famous \gls{lbb} or \textit{inf-sup} condition is satisfied. Inappropriate choices may lead to pressure instabilities. Note that this phenomenon is independent of the presence of convective effects and, therefore, independent of the Reynolds number.
As has been mentioned before, we restrict ourselves to first order polynomial, i.e., linear elements, for both the velocity and pressure. However, for this choice the \gls{lbb} condition is not fulfilled.
The second difficulty arises when the non-linear convective effects are dominant, leading to spurious spatial oscillations.
\par
\fi
\par
We apply the \gls{gls} stabilization technique \cite{Hughes1987,Hughes1989,Mittal1992,Shakib1991}, which adds a least-squares form of the residual within each element to the original variational formulation of the problem. In the \gls{csst} formulation, this will apply to space-time elements denoted by $\domainSpaceTime^e$.
\iffalse
\begin{itemize}
    \item stabilization needed for
    \begin{enumerate}
        \item \gls{lbb} condition
        \item temporal term works like advection term in space-time setting
    \end{enumerate}
\end{itemize}
\fi
\bigskip\par
Following the description, e.g., from \cite{Behr1994,Franca1992}, the resulting space-time Galerkin formulation including the additional stabilization terms reads:
%\todo[inline]{Add contribution of \texttt{dtInGls on}}
\bigskip\par\noindent
\textit{Find }$\lp \trialVelocityHomDiscreteParam, \trialPressureDiscreteParam \rp 
\in 
\weightingSpaceVelocityDiscrete\lp\domainSpaceTime\rp
\times 
\trialSpacePressureDiscrete\lp\domainSpaceTime\rp$\textit{, such that }$\forall \lp \weightVelocityDiscrete, \weightPressureDiscrete \rp 
\in
\weightingSpaceVelocityDiscrete\lp\domainSpaceTime\rp 
\times 
\weightingSpacePressureDiscrete\lp\domainSpaceTime\rp$\textit{:}
\begin{align}
    \lp \weightVelocityDiscrete, \ddt{\trialVelocityHomDiscrete}; \paramVec \rp_{\domainSpaceTime} 
    - \bilinearFormPressureParam
    {\weightVelocityDiscrete}
    {\trialPressureDiscrete}{\paramVec}_{\domainSpaceTime} 
    + \bilinearFormViscousStressParam
    {\weightVelocityDiscrete}
    {\trialVelocityHomDiscrete}{\trialVelocityDiscrete}{\paramVec}_{\domainSpaceTime}
    +\bilinearFormPressureParam
    {\trialVelocityHomDiscrete}
    {\weightPressureDiscrete}{\paramVec}_{\domainSpaceTime}&
    \nonumber
    \\
    +\bilinearFormStabMomStokesTemporalParam
    {\weightPressureDiscrete}
    {\trialVelocityDiscrete}
    {\trialPressureDiscrete}
    {\trialVelocityDiscrete}
    {\paramVec}_{\domainSpaceTime}&
    \nonumber
    \\
    =
    \lp \weightVelocityDiscrete, \bdf \rp_{\domainSpaceTime}  
    +\lp \weightVelocityDiscrete, \tractionNeumann; \paramVec \rp_{\boundarySpaceTimeNeumann}
    -\lp \weightVelocityDiscrete, \ddt{\liftingVelocityDiscrete}; \paramVec \rp_{\domainSpaceTime} 
    -\bilinearFormViscousStressParam
    {\weightVelocityDiscrete}
    {\liftingVelocityDiscrete}{\trialVelocityDiscrete}{\paramVec}_{\domainSpaceTime}
    -\bilinearFormPressureParam
    {\liftingVelocityDiscrete}
    {\weightPressureDiscrete}{\paramVec}_{\domainSpaceTime}&
    ,
    \label{eq:navierStokesGalerkinStabilizedST}
\end{align}
with
\iffalse
\begin{align}
    &\bilinearFormStabMomStokesTemporal
    {\weightPressureDiscrete}
    {\trialVelocityDiscrete}
    {\trialPressureDiscrete}
    _{\domainSpaceTime} 
    =
    \sum_{e} \intElementSpaceTime{\tMom \frac{1}{\rho}
    \lp
        -\gr{\weightPressureDiscrete} 
        \rp
        \cdot 
        \lp
        \rho \ddt{\trialVelocityDiscrete}
        - \gr{\trialPressureDiscrete}
    \rp}.
\end{align}
\fi
\begin{align}
\bilinearFormStabMomStokesTemporalParam
    {\weightPressureDiscrete}
    {\trialVelocityDiscrete}
    {\trialPressureDiscrete}
    {\trialVelocityDiscrete}
    {\paramVec}
    _{\domainSpaceTime} 
    =
    s^{\trialVelocityHom}\lp\weightPressureDiscrete,\trialVelocityHomDiscrete;\trialVelocityDiscrete,\paramVec\rp_{\domainSpaceTime}
    +
    s^{\vek{l}}\lp\weightPressureDiscrete,\liftingVelocityDiscrete;\trialVelocityDiscrete,\paramVec\rp_{\domainSpaceTime}
    +
    s^{\trialPressure}\lp\weightPressureDiscrete,
    \trialPressureDiscrete;\trialVelocityDiscrete,\paramVec\rp_{\domainSpaceTime},
\end{align}
and
\begin{align}
    s^{\trialVelocityHom}
    \lp
    \weightPressureDiscrete,
    \trialVelocityHomDiscrete;
    \trialVelocityDiscrete,
    \paramVec
    \rp_{\domainSpaceTime}
    &=
    \sum_{e} \intElementSpaceTime{\tMom \frac{1}{\rho}
    \lp
    -\gr{\weightPressureDiscrete} 
    \rp
    \cdot 
    \lp
    \rho \ddt{\trialVelocityHomDiscrete}\lp\paramVec\rp
    \rp
    },
    \\
    s^{\vek{l}}
    \lp
    \weightPressureDiscrete,
    \liftingVelocityDiscrete;
    \trialVelocityDiscrete,
    \paramVec
    \rp_{\domainSpaceTime}
    &=
    \sum_{e} \intElementSpaceTime{\tMom \frac{1}{\rho}
    \lp
    -\gr{\weightPressureDiscrete} 
    \rp
    \cdot 
    \lp
    \rho \ddt{\liftingVelocityDiscrete}\lp\paramVec\rp
    \rp
    },
    \\
    s^{\trialPressure}
    \lp
    \weightPressureDiscrete,
    \trialPressureDiscrete;
    \trialVelocityDiscrete,
    \paramVec
    \rp_{\domainSpaceTime}
    &=
    \sum_{e} \intElementSpaceTime{\tMom \frac{1}{\rho}
    \gr{\weightPressureDiscrete} 
    \cdot 
    \gr{\trialPressureDiscreteParam} 
    }.
\end{align}
\par
The stabilization parameter $\tMom$ is chosen as presented in \cite{Pauli2016a}. Although the formulation in detail is not of great importance for this work, note that it depends both on the parametric velocity $\trialVelocityDiscrete(\paramVec)$ and the parametric viscosity $\visc(\trialVelocityDiscrete, \paramVec)$ in a non-linear way. Furthermore, the second-order derivatives of the velocity weighting and trial functions, which appear in the original formulation of the momentum stabilization, are omitted due to the first-order linear basis functions in use.
\bigskip\par
As a foundation for the description of the \gls{rom} in the following section, we present next the \textit{algebraic formulation} of the problem. The vectors of coefficients are denoted as $\velocityDOFVector \in \mathbb{R}^{\nBasisVelocityFOM}$ and $\pressureDOFVector\in \mathbb{R}^{\nBasisPressureFOM}$ for the homogeneous velocity $\trialVelocityHomDiscrete$ and pressure field $\trialPressureDiscrete$, respectively. Here, $\nBasisVelocityFOM$ and $\nBasisPressureFOM$ stand for the number of \glspl{dof} in the \gls{fom}. The solution can then be computed by solving the following non-linear system for $\velocityDOFVectorParam$ and $\pressureDOFVectorParam$:
\begin{align}
    \lb
    \begin{array}{cc}
        \matrixTemporal + \matrixViscousStressParam         &  -\matrixPressureTrans 
        \\
        \matrixPressure + \matrixStabMomStokesTemporalParam & \matrixStabMomStokesParam
    \end{array}
    \rb
    \lb
    \begin{array}{c}
        \velocityDOFVectorParam\\
        \pressureDOFVectorParam
    \end{array}
    \rb
    =
    \lb
    \begin{array}{c}
         \vectorRHSTemporal + \vectorRHSVelocity + \vectorRHSVelocityNonlinearParam\\
         \vectorRHSPressure + \vectorRHSStabMomStokesTemporalParam
    \end{array}
    \rb&
    ,
    \label{eq:algebraicSystemFOM}
\end{align}
where the \gls{lhs} matrices for $i,j = 1, \dots, \nBasisVelocityFOM $ and for $k,l = 1, \dots, \nBasisPressureFOM $ are given as
\begin{align*}
    \begin{aligned}[t]
        \matrixTemporal &= \lb \matrixTemporalSymbol_{i,j} \rb, 
        \text{ with } 
        \matrixTemporalSymbol_{i,j} 
        = 
        \lp \basisFunctionVelocityFOM{i}, \dd{\basisFunctionVelocityFOM{j}}{t} \rp_{\domainSpaceTime},
        \\
        \matrixPressure &= \lb\matrixPressureSymbol_{k,j}\rb,
        \text{ with }
        \matrixPressureSymbol_{k,j} 
        = 
        \bilinearFormPressure
        {\basisFunctionVelocityFOM{j}}
        {\basisFunctionPressureFOM{k}}_{\domainSpaceTime},
        \\
        \matrixStabMomStokes &= \lb \matrixStabMomStokesSymbol_{k,l}\rb,
        \text{ with }
        \matrixStabMomStokesSymbol_{k,l}
        = 
        s^{\trialPressure}
        \lp
        \basisFunctionPressureFOM{k},
        \basisFunctionPressureFOM{l};
        \trialVelocityDiscrete,
        \paramVec
        \rp_{\domainSpaceTime},
    \end{aligned}
    \quad
    \begin{aligned}[t]
        \matrixViscousStress &= \lb A_{i,j}\rb,
        \text{ with } 
        \matrixViscousStressSymbol_{i,j} 
        = 
        \bilinearFormViscousStressParam
        {\basisFunctionVelocityFOM{i}}
        {\basisFunctionVelocityFOM{j}}
        {\trialVelocityDiscrete}
        {\paramVec},    
        \\
        \matrixStabMomStokesTemporal &= \lb \matrixStabMomStokesTemporalSymbol_{k,j}\rb,
        \text{ with }
        \matrixStabMomStokesTemporalSymbol_{k,j}
        = 
        s^{\trialVelocityHom}
        \lp
        \basisFunctionPressureFOM{k},
        \basisFunctionVelocityFOM{j};
        \trialVelocityDiscrete,
        \paramVec
        \rp_{\domainSpaceTime},
    \end{aligned}
\end{align*}
and the \gls{rhs} vectors read
\begin{align*}
    \begin{aligned}[t]
        \vectorRHSTemporal &= \{ \vectorRHSTemporalSymbol_i\}, 
        \text{ with }
        \vectorRHSTemporalSymbol_i 
        =
        - \lp \basisFunctionVelocityFOM{i}, \ddt{\liftingVelocityDiscrete};\paramVec \rp_{\domainSpaceTime}, 
        \\
        \vectorRHSVelocityNonlinear &= \{\vectorRHSVelocityNonlinearSymbol_i\},
        \text{ with }
        \vectorRHSVelocityNonlinearSymbol_i = 
        - \bilinearFormViscousStressParam
        {\basisFunctionVelocityFOM{i}}
        {\liftingVelocityDiscrete}
        {\trialVelocityDiscrete}
        {\paramVec},
        \\
        \vectorRHSStabMomStokesTemporal &= \{ \vectorRHSStabMomStokesTemporalSymbol_{k}\}
        \text{, with }
        \vectorRHSStabMomStokesTemporalSymbol_{k}
        = 
        -s^{\vek{l}}
        \lp
        \basisFunctionPressureFOM{k},
        \liftingVelocityDiscrete;
        \trialVelocityDiscrete,
        \paramVec
        \rp_{\domainSpaceTime}.
    \end{aligned}
    \quad
    \begin{aligned}[t]
        \vectorRHSVelocity &= \{\vectorRHSVelocitySymbol_i\},
        \text{ with }
        \vectorRHSVelocitySymbol_i
        =
        \bilinearFormNeumannSpaceTimeParam
        {\basisFunctionVelocityFOM{i}}
        {\nval}
        {\paramVec},
        \\
        \vectorRHSPressure &= \{G_k\},
        \text{ with }
        G_k
        =
        -\bilinearFormPressureParam
        {\liftingVelocityDiscrete}
        {\basisFunctionPressureFOM{k}}
        {\paramVec}_{\domainSpaceTime},
    \end{aligned} 
\end{align*}
For convenience, the dimensions of the matrices and vectors are summarized in \Cref{tab:dimensionsFOM}.
\begin{table}
    \centering
    \begin{tabular}{lclc}
        \toprule
        \acrshort{lhs} Matrices & Dimensions & \acrshort{rhs} Vectors & Dimensions\\
        \midrule
        $\matrixTemporal$, $\matrixViscousStress$ & $\mathbb{R}^{\nBasisVelocityFOM \times \nBasisVelocityFOM}$ & $\vectorRHSTemporal$, $\vectorRHSVelocity$, $\vectorRHSVelocityNonlinear$ & $\mathbb{R}^{\nBasisVelocityFOM}$  \\
        $\matrixPressure$, $\matrixStabMomStokesTemporal$ & $\mathbb{R}^{\nBasisPressureFOM \times \nBasisVelocityFOM}$ & $\vectorRHSPressure$, $\vectorRHSStabMomStokesTemporal$ & $\mathbb{R}^{\nBasisPressureFOM}$  \\
        $\matrixStabMomStokes$ & $\mathbb{R}^{\nBasisPressureFOM \times \nBasisPressureFOM}$ \\
        \bottomrule
    \end{tabular}
    \caption{Dimensions of \acrshort{lhs} matrices and \acrshort{rhs} vectors for the \acrshort{fom}.}
    \label{tab:dimensionsFOM}
\end{table}

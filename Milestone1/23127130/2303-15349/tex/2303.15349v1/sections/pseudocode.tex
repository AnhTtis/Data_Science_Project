\begin{algorithm}[htb!]
\caption{IMC training procedure}
\begin{algorithmic}[1]
% \Procedure{Roy}{$a,b$}       \Comment{This is a test}
    \STATE \textbf{Require:} Data $\mathcal{D} = \{(\mathbf{x}_n, \mathbf{y}_n)\}_{n=1}^N$
    \STATE \textbf{Require:} Curriculum pacing $\eta$
    \STATE \textbf{Require:} Minimal entropy $\mathcal{H}_{\text{min}}$
    \STATE \textbf{Require:} Max. number of components $N_{o,
    \text{max}}$
    % \State \textbf{Require:} Variances $\sigma^2_l, \sigma^2_y$
    % \State Initialize $\tilde{p}^{(0)}(x_n|o)$, $\vtheta_o$ and $c_o$
    \STATE $N_o \leftarrow 1$
    \WHILE{$N_o \leq N_{o,\text{max}}$}
    \vspace{0.1cm}
    \STATE $q(o|\mathcal{D}_n) \leftarrow \tilde{p}(\mathcal{D}_n|o) / \sum_o \tilde{p}(\mathcal{D}_n|o) \ \forall n$
    \vspace{0.1cm}
    \FOR{$o \leftarrow 1,..,N_{o}$}
    \STATE \small$\tilde{p}_{\xi_o}(\mathcal{D}_n|o) \leftarrow \exp \Big(\frac{R_o(\mathcal{D}_n)}{\xi_o + \eta}\Big) \ \forall n$
    \vspace{0.13cm}
    \STATE \small$\xi_o^* \leftarrow \argmin_{\xi_o > 0} \ g(\xi_o)$
    %
    \vspace{0.13cm}
    % \State Compute $\max_{\vtheta_o} \sum_{(x_n, y_n)} \tilde{p}(x_n|o) \log p(y_n |x_n,o;\vtheta_o)$
    \STATE \small $\vtheta_o^* \leftarrow \argmax_{\vtheta_o} \sum_{n} p^*(\mathcal{D}_n|o) \log p_{\vtheta_o}(\mathbf{y}_n |\mathbf{x}_n,o)$
    %
    % \State Compute $\max_{c_o} \sum_{x_n} p(x_n|o) \log p_{c_o}(x_n|o)$ 
    % \State  $\mathbf{x}i_o^* \leftarrow \argmax_{\mathbf{x}i_o} \sum_{i} p(\mathcal{D}_n|o) \log p_{\mathbf{x}i_o}(\mathcal{D}_n)$  
    \ENDFOR
    \IF{$|\Delta L|\leq \epsilon$}
    \STATE add\_component()
    \STATE $N_o \leftarrow N_o + 1$
    \ENDIF
    \ENDWHILE
    \vspace{0.05cm}
    % \State $\vphi^* \leftarrow \argmin_{\vphi}  \sum_n \sum_o \tilde{p}(\mathcal{D}_n|o) \log g_{\vphi}(o|\mathbf{x}_n)$
\end{algorithmic}
\label{algo:imc_training}
\end{algorithm}
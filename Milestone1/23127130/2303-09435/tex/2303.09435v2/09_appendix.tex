\appendix

\section{Descriptions of $\matattn{}$, $\matff{}$ and $\matln{}$}
\label{sec:app_submodule_skip_description}

Here we detail the definitions of the mappings $\matattnl{}$, $\matffl{}$ and $\matlnl{}$ utilized in \S\ref{sec:submodules}.

\paragraph{Description of $\matattnl{}$.}
%Illustrating this on $\texttt{attn}_\ell$ for definiteness,
For an input $s$, let $v^\ell_{i_s}$ be the vector at position $i_s$ in the output of $\texttt{attn}_\ell (\texttt{ln1}_\ell (H^{\ell - 1}))$. We denote by $A_\ell^{\texttt{attn}} \in \mathbb{R}^{d_h \times d_h}$ the matrix numerically minimizing 
$$ A \mapsto \sum_{s \in \mathcal{T}} || A \cdot \texttt{ln1}_\ell (h^{\ell-1}_{i_s}) - v^\ell_{i_s}||^2,$$
and define an attention sub-module replacement (Eq.~\ref{eq:attn}) by $$
\texttt{b}^{\overline{\texttt{attn}}}_\ell (h) \coloneqq A_{\ell}^{\texttt{attn}} \cdot \texttt{ln1}_\ell (h) + h. $$
We then define a mapping between two layers ${\ell \rightarrow \ell'}$ by:
$$ \matattnl{} (h) \coloneqq $$
$$ \texttt{b}^{\texttt{ffn}}_{\ell'} ( \texttt{b}^{\overline{\texttt{attn}}}_{\ell'} ( \ldots (\texttt{b}^{\texttt{ffn}}_{\ell+1} ( \texttt{b}^{\overline{\texttt{attn}}}_{\ell+1} (h)))\ldots)).$$ 
Namely, when applying each $\ell''$-th block, $\ell < \ell'' \leq \ell'$, we replace its attention sub-module $\texttt{attn}_{\ell''}$ by its linear approximation.
%In an analogous way, we consider the mappings $\matffl{}$ and $\matlnl{}$, where in the latter we perform the linear shortcut both for \texttt{ln1} and for \texttt{ln2} (see~\S\ref{sec:app_submodule_skip_description} for precise descriptions).
Importantly, unlike the original attention module, the approximation $\texttt{b}^{\overline{\texttt{attn}}}_\ell$ operates on each position independently, and therefore applying $\matattnl{}$ disables any contextualization between the layers $\ell$ and $\ell'$. Note that this is not the case for $\matffl{}$ and $\matlnl{}$, which retain the self-attention sub-modules and operate contextually.

\paragraph{Description of $\matffl{}$.}
Let $v^\ell_{i_s}$ be the vector at position $i_s$ in the output of $\texttt{ln2}_{\ell} (\texttt{b}_\ell^{\texttt{attn}} (H^{\ell - 1}))$, for a given input $s$. We denote by $A_\ell^{\texttt{ffn}} \in \mathbb{R}^{d_h \times d_h}$ the matrix numerically minimizing 
$$ A \mapsto \sum_{s \in \mathcal{T}} || A \cdot v^{\ell}_{i_s} - \texttt{ffn}_{\ell} (v^\ell_{i_s})||^2,$$
and define a replacement of the feed-forward sub-module $\texttt{b}_{\ell}^{\texttt{ffn}}$ by $$ \texttt{b}^{\overline{\texttt{ffn}}}_\ell (H) \coloneqq A_{\ell}^{\texttt{ffn}} \cdot \texttt{ln2}_\ell (H) + H.$$
We then define a mapping between two layers ${\ell \rightarrow \ell'}$ by:
$$ \matffl{} (H) \coloneqq $$
$$ \texttt{b}^{\overline{\texttt{ffn}}}_{\ell'} ( \texttt{b}^{\texttt{attn}}_{\ell'} ( \ldots (\texttt{b}^{\overline{\texttt{ffn}}}_{\ell+1} ( \texttt{b}^{\texttt{attn}}_{\ell+1} (H))\ldots)).$$

\paragraph{Description of $\matlnl{}$.}
Let $v^\ell_{i_s}$ be the vector at position $i_s$ in the output of $\texttt{b}^{\texttt{attn}}_{\ell} (H^{\ell - 1})$, for a given input $s$. We denote by $A_\ell^{\texttt{ln1}} \in \mathbb{R}^{d_h \times d_h}$ the matrix numerically minimizing 
$$ A \mapsto \sum_{s \in \mathcal{T}} || A \cdot h^{\ell}_{i_s} - \texttt{ln1}_{\ell} (h^\ell_{i_s})||^2$$ and we denote by $A_\ell^{\texttt{ln2}} \in \mathbb{R}^{d_h \times d_h}$ the matrix numerically minimizing $$ A \mapsto \sum_{s \in \mathcal{T}} || A \cdot v^{\ell}_{i_s} - \texttt{ln2}_{\ell} (v^\ell_{i_s})||^2.$$ We define a replacement of the block $\texttt{b}^{\texttt{attn}}_{\ell}$ by \begin{equation} \texttt{b}^{\overline{\texttt{ln1}}}_\ell (H) \coloneqq \texttt{attn}_{\ell} (A_{\ell}^{\texttt{ln1}} \cdot H) + H\end{equation} and we define a replacement of the block $\texttt{b}^{\texttt{ffn}}_{\ell}$ by \begin{equation} \texttt{b}^{\overline{\texttt{ln2}}}_\ell (H) \coloneqq \texttt{ffn}_{\ell} (A_{\ell}^{\texttt{ln2}} \cdot H) + H.\end{equation}
We then define a mapping between two layers ${\ell \rightarrow \ell'}$ by:
$$ \matlnl{} (H) \coloneqq $$
$$ \texttt{b}^{\overline{\texttt{ln2}}}_{\ell'} ( \texttt{b}^{\overline{\texttt{ln1}}}_{\ell'} ( \ldots (\texttt{b}^{\overline{\texttt{ln2}}}_{\ell+1} ( \texttt{b}^{\overline{\texttt{ln1}}}_{\ell+1} (H))\ldots)).$$

\documentclass[10pt,twocolumn,letterpaper]{article}

\usepackage{iccv}
\usepackage{times}
\usepackage{epsfig}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{enumerate}

\usepackage{caption}
\usepackage{subcaption}
\usepackage{duckuments}
\usepackage{booktabs,tabularx}
\usepackage{tikz}
\usepackage{comment}
\usepackage{adjustbox}
\usepackage{graphbox}
\usepackage{docmute}

% Include other packages here, before hyperref.
\usepackage{multirow}

\usepackage{xcolor}
\usepackage{color, colortbl}

\usepackage[percent]{overpic}

\definecolor{A}{RGB}{255,0,0}
\definecolor{B}{RGB}{0, 0, 255}
\definecolor{star}{RGB}{255, 0, 255}

\definecolor{aabbcc}{rgb}{0.8,0.4,0.8}
\definecolor{aabbdd}{rgb}{0.2,0.2,0}
\definecolor{aabbee}{rgb}{0.2,0.6,0.8}
\definecolor{aabbff}{rgb}{0.2,0.0,0.4}
\definecolor{aabbgg}{rgb}{0.4,0.8,0}
\definecolor{aaccdd}{rgb}{0.4,0.8,1}
\definecolor{aaccee}{rgb}{1,0.6,0.8}
\definecolor{aaccff}{RGB}{255,204,51}
\definecolor{aaccgg}{RGB}{125,125,255}
\definecolor{aaddee}{RGB}{255,127,0}
\definecolor{aaddgg}{RGB}{150,150,150}
\definecolor{aaddff}{RGB}{30,30,30}

\usepackage{tkz-euclide}
\usepackage{tikz}
% \usetkzobj{all}
\usepackage{pgfplots}
\pgfplotsset{compat=1.14}
\usetikzlibrary{positioning,calc,fadings,backgrounds,fit,3d,shapes.misc,shapes.geometric}
\usetikzlibrary{matrix}

\usepackage{algorithm}
\usepackage{algpseudocode}


% If you comment hyperref and then uncomment it, you should delete
% egpaper.aux before re-running latex.  (Or just hit 'q' on the first latex
% run, let it finish, and you should be clear).
\usepackage[pagebackref=true,breaklinks=true,letterpaper=true,colorlinks,bookmarks=false]{hyperref}

% Support for easy cross-referencing
\usepackage[capitalize]{cleveref}
\crefname{section}{Sec.}{Secs.}
\crefname{section}{Section}{Sections}
\crefname{table}{Table}{Tables}
\crefname{table}{Tab.}{Tabs.}



% \newcommand{\etal}{\textit{et al.}}

\begin{document}

\iccvfinalcopy % *** Uncomment this line for the final submission

\def\iccvPaperID{9189} % *** Enter the ICCV Paper ID here
\def\httilde{\mbox{\tt\raisebox{-.5ex}{\symbol{126}}}}

% Pages are numbered in submission mode, and unnumbered in camera-ready
\ificcvfinal\pagestyle{empty}\fi
\appendix
\section{More details}
\subsection{Diffusion Inversion}
% \section{Diffusion Inversion}
We can edit an image using its latent representation. Diffusion inversion tries to revert the generating process, \ie, given an image $\mathbf{x}_0$, to find the initial noise $\mathbf{x}_T$ (and the intermediate noised images $\mathbf{x}_t$) which generates $\mathbf{x}_0$. The first approach works by adding noise to $\mathbf{x}_0$. The noise schedule is exactly the same as the training noise schedule of DDPM. However, this process is stochastic and we cannot guarantee the obtained initial noise $\mathbf{x}_T$ can reconstruct $\mathbf{x}_0$ faithfully. The second approach is DDIM inversion based on the DDIM sampler in Eq.~\eqref{eq:ddim-sampler}. We can calculate the initial noise by applying the formula iteratively, $\mathbf{x}_{t+1}=\sqrt{\alpha_{t+1}}\cdot f_\theta(\mathbf{x}_t, \mathbf{c}, t) + \sqrt{1-\alpha_{t+1}}\cdot\boldsymbol\epsilon_\theta(\mathbf{x}_t, \mathbf{c}, t)$. But when working with classifier-free guidance, the reconstruction quality is not satisfying. The third inversion method is Null-text Inversion. It is based on the DDIM inversion and optimized for high reconstruction quality. In most cases, we will use the Null-text Inversion as our diffusion inversion method.

\subsection{Algorithms}
We show the algorithm MDP-$\boldsymbol\epsilon_t$ in \cref{alg:eps}, MDP-$\mathbf{c}$ in \cref{alg:c}, MDP-$\mathbf{x}_t$ in \cref{alg:x}, and MDP-$\boldsymbol \beta$ in \cref{alg:beta}. For real image editing, we use Null-text inversion to obtain $\mathbf{x}_T$. For synthetic image editing, $\mathbf{x}_T$ is sampled from the standard Gaussian distribution.

%\begin{minipage}{.9\linewidth}
\begin{algorithm}[H]
\caption{MDP-$\boldsymbol\epsilon_t$. }\label{alg:eps}
\begin{algorithmic}
\Require $\{\omega_t\}_{t=[T,\dots, 0]}, \mathbf{x}_{T}$, $\mathbf{c}^{(A)}$, $\mathbf{c}^{(B)}$, $\left\{\left(\mathbf{x}_t^{(A)}, \boldsymbol\epsilon_t^{(A)}\right)\right\}_{t=[T,\dots, 0]}=\mathrm{GenPath}\left(\mathbf{x}_T, \mathbf{c}^{(A)}, t\right)$
\State $\mathbf{x}_T^{(\star)} = \mathbf{x}_T$
\For{$t$ in $\{T, T-1, \dots, 1\}$}
    \State $\boldsymbol\epsilon_t^{(B)}=\boldsymbol\epsilon_\theta\left(\mathbf{x}_t^{(\star)}, \mathbf{c}^{(B)}, t\right)$
    \State $ \boldsymbol\epsilon_t^{(\star)} = (1-\omega_t) \boldsymbol\epsilon_t^{(B)} + \omega_t \boldsymbol\epsilon_t^{(A)} $
    \State $\mathbf{x}_{t-1}^{(\star)} = \mathrm{DDIM}\left( \mathbf{x}_t^{(\star)}, \boldsymbol\epsilon_t^{(\star)}, t\right)$
\EndFor
\end{algorithmic}
\end{algorithm}
%\end{minipage} %
%\begin{minipage}{.3\linewidth}
\begin{algorithm}[H]
\caption{MDP-$\mathbf{c}$. }\label{alg:c}
\begin{algorithmic}
\Require $\{\omega_t\}_{t=[T,\dots, 0]}, \mathbf{x}_{T}$, $\mathbf{c}^{(A)}$, $\mathbf{c}^{(B)}$
\State $\mathbf{x}_T^{(\star)} = \mathbf{x}_T$
\For{$t$ in $\{T, T-1, \dots, 1\}$}
    \State $\mathbf{c}_t^{(\star)} = (1-\omega_t) \mathbf{c}^{(B)} + \omega_t \mathbf{c}^{(A)} $
    \State $\boldsymbol\epsilon_t^{(\star)}=\boldsymbol\epsilon_\theta\left(\mathbf{x}_t^{(\star)}, \mathbf{c}_t^{(\star)}, t\right)$
    \State $\mathbf{x}_{t-1}^{(\star)} = \mathrm{DDIM}\left( \mathbf{x}_t^{(\star)}, \boldsymbol\epsilon_t^{(\star)}, t\right)$
\EndFor
\end{algorithmic}
\end{algorithm}
%\end{minipage}%
%\begin{minipage}{.4\linewidth}
\begin{algorithm}[H]
\caption{MDP-$\mathbf{x}_t$. }\label{alg:x}
\begin{algorithmic}
\Require $\{\omega_t\}_{t=[T,\dots, 0]}, \mathbf{x}_{T}$, $\mathbf{c}^{(A)}$, $\mathbf{c}^{(B)}$, $\left\{\left(\mathbf{x}_t^{(A)}, \boldsymbol\epsilon_t^{(A)}\right)\right\}_{t=[T,\dots, 0]}=\mathrm{GenPath}\left(\mathbf{x}_T, \mathbf{c}^{(A)}, t\right)$
\State $\mathbf{x}_T^{(\star)} = \mathbf{x}_T$
\For{$t$ in $\{T, T-1, \dots, 1\}$}
    % \State $\boldsymbol\epsilon_t^{(A\star)}=\boldsymbol\epsilon_\theta\left(\mathbf{x}_t^{(\star)}, \mathbf{c}_t^{(A)}, t\right)$
    % \State $\mathbf{x}_{t-1}^{(A\star)} = \mathrm{DDIM}\left( \mathbf{x}_t^{(\star)}, \boldsymbol\epsilon_t^{(A\star)}, t\right)$
    \State $\boldsymbol\epsilon_t^{(B\star)}=\boldsymbol\epsilon_\theta\left(\mathbf{x}_t^{(\star)}, \mathbf{c}_t^{(B)}, t\right)$
    \State $\mathbf{x}_{t-1}^{(B\star)} = \mathrm{DDIM}\left( \mathbf{x}_t^{(\star)}, \boldsymbol\epsilon_t^{(B\star)}, t\right)$
    \State $\mathbf{x}_{t-1}^{(\star)} = (1-\omega_t) \mathbf{x}^{(B\star)}_{t-1} + \omega_t \mathbf{x}^{(A)}_{t-1} $
\EndFor
\end{algorithmic}
\end{algorithm}
%\end{minipage}%
%\begin{minipage}{.3\linewidth}
\begin{algorithm}[H]
\caption{MDP-$\boldsymbol \beta$. }\label{alg:beta}
\begin{algorithmic}
\Require $\{\omega_t\}_{t=[T,\dots, 0]}, \mathbf{x}_{T}$, $\mathbf{c}^{(A)}$, $\mathbf{c}^{(B)}$
\State $\mathbf{x}_T^{(\star)} = \mathbf{x}_T$
\For{$t$ in $\{T, T-1, \dots, 1\}$}
    \State $\boldsymbol\epsilon_t^{(A\star)}=\boldsymbol\epsilon_\theta\left(\mathbf{x}_t^{(\star)}, \mathbf{c}^{(A)}, t\right)$
    \State $\boldsymbol\epsilon_t^{(B\star)}=\boldsymbol\epsilon_\theta\left(\mathbf{x}_t^{(\star)}, \mathbf{c}^{(B)}, t\right)$
    \State $\boldsymbol\epsilon_t^{(\star)} = (1-\omega_t) \boldsymbol\epsilon_t^{(B\star)} + \omega_t \boldsymbol\epsilon_t^{(A\star)}$
    \State $\mathbf{x}_{t-1}^{(\star)} = \mathrm{DDIM}\left( \mathbf{x}_t^{(\star)}, \boldsymbol\epsilon_t^{(\star)}, t\right)$
\EndFor
\end{algorithmic}
\end{algorithm}
%\end{minipage}

\section{Taxonomy of Image Editing Applications}
\label{sec:taxonomy}
In this subsection we describe a small taxonomy for text-guided image editing applications that we use to analyze our framework and compare it to previous work. To be noted that this taxonomy only includes some major image editing applications but is not an exhaustive one. Given either a real or synthetic image as input, we edit the image following a condition such as a text prompt or a class label. We divide all common image editing operations into two categories: local editing and global editing. We further identify sub-categories for both local and global editing.
\subsection{Local editing}
Typically, we want to perform edits while keeping the overall image layout, \eg background or the shape of the chosen object in the input image.
\begin{itemize}
    \item Changing object: change an object (or objects) in the image to another one. For example, if there is a basket of \textit{apples}, we may change it to a basket of \textit{oranges}. Also, we may change the image of a \textit{dog} to an image of a \textit{cat}.
    \item Adding object: add an object that does not exist in the original image. For example, given an image of a forest, we add a \textit{car} in that forest. Given a cat face, we can add a pair of \textit{sunglasses} on it.
    \item Removing object: remove an object from the image. For example, we can remove the eggs in a basket so that the basket becomes \textit{empty}. 
    \item Changing attribute: change the attribute such as color and texture of an object. Given a \textit{red} bird, we may change it to a \textit{blue} bird. We may change a human portrait from a \textit{young} person to an \textit{old} person.
    \item Mixing objects: combine an object in the input image with another object. The two objects we may want to mix can have different semantics, \eg we can mix a \textit{corgi} and a \textit{coffee machine}, or a \textit{chocolate bar} and a \textit{purse}.  
\end{itemize}
\subsection{Global editing}
For global editing, the overall texture and style of the image can be changed while the layout and semantics should be the same.
\begin{itemize}
    \item Changing background: change the background while keeping a foreground object untouched. For example, we change a rabbit on \textit{grass} to a rabbit on the \textit{moon}. We can also convert a black-and-white photo to be \textit{colored}. 
    \item Stylization: stylize an object or a scene using an input style image. For example, we give an \textit{futuristic} image as a style input and we want the a generated image to have the same style.
    \item In-domain transfer: edit the input image by performing in-domain changes. For example, we transfer a photo of a valley in \textit{summer} to a photo of a valley in \textit{winter}, or we transfer a city during the \textit{day} to a city at \textit{night}. 
    \item Out-of-domain transfer: edit the input image with out-of-domain changes. For example, we transfer a \textit{photo} of a valley to an \textit{oil painting} of a valley or we change a \textit{portrait} of a human to a \textit{cartoon} character. We can also change a \textit{black-and-white} photo to a \textit{colored} photo. 
\end{itemize}

\section{More Analysis in the Design Space}
We observe that the manipulation schedule has a relatively larger influence on MDP-$\mathbf{x}_t$, MDP-$\mathbf{c}$, and MDP-$\boldsymbol\epsilon_t$. For MDP-$\boldsymbol \beta$ the linear factfor (guidance scale) has a much more important effect towards the controllability of the edited image. For Prompt-to-Prompt (a manipulation for attention maps) the range of time steps to inject the self-attention maps strongly determines what the edited image will look like. Therefore, for MDP-$\mathbf{x}_t$, MDP-$\mathbf{c}$, and MDP-$\boldsymbol\epsilon_t$, we explore four different manipulation schedules: constant, linear, cosine, and exponential (\cref{fig:schedules}). Given an integer timestep $t \in [0, 50]$, we give the equations for the linear factor for constant schedule ($\omega_t^{\text{const}}$), linear schedule ($\omega_t^{\text{linear}}$), cosine schedule ($\omega_t^{\text{cos}}$) and exponential schedule linear schedule ($\omega_t^{\text{exp}}$):
\begin{equation}
\begin{split}
  \omega_t^{\text{const}} &=
    \begin{cases}
      1 & \text{if $t_{\text{min}}\leq t \leq t_{\text{max}}$,}\\
      0 & \text{else.}\\
    \end{cases}  
    \\
    \omega_t^{\text{linear}} &=
    \begin{cases}
      \frac{t - t_{\text{min}}}{50 - t_{\text{min}}} & \text{if $t_{\text{min}}\leq t \leq 50$,}\\
      0 & \text{else.}\\
    \end{cases}  
    \\
    \omega_t^{\text{cosine}} &=
    \begin{cases}
      \cos \left(\frac{\pi}{2} \frac{50 - t}{50 - t_{\text{min}}} \right) & \text{if $t_{\text{min}}\leq t \leq 50$,}\\
      0 & \text{else.}\\
    \end{cases}  
    \\
    \omega_t^{\text{exp}} &=
    \begin{cases}
      \exp{\left(-5 \left( \frac{50 - t}{50 - t_{\text{min}}} \right) \right)} & \text{if $t_{\text{min}}\leq t \leq 50$,}\\
      0 & \text{else.}\\
    \end{cases}  
\end{split}
\end{equation}
The results are shown in \cref{fig:xt_tri,fig:xt_linear,fig:c_tri,fig:c_linear,fig:epsilon_tri,fig:epsilon_linear}. For MDP-$\boldsymbol \beta$, we vary the guidance scale from -0.7 to 0.7 and show the results in \cref{fig:guidance}. For Prompt-to-Prompt, we use the constant schedule to inject the attention maps and show the results in \cref{fig:p2p_global} and \cref{fig:p2p_local}. We only visualize one example for global editing as we show in the paper: given an airplane image input, we change its background from ``sky'' to ``airport runway''. We only show this as an example because this example is challenging so we can identify the ability of different methods. For Prompt-to-Prompt, we show an additional example from local editing for a better understanding of the method. We discuss the results in the following subsections.

For the parameters in the design space for each manipulation, we show a general recommendation in \cref{table:local} and \cref{table:global}, which is summarized based on the examples we have tried. Note that this is only considered a recommendation for general cases. For specific applications (and input image), it improved results can still be attained by fine tuning the parameters.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%Schedule plot
\begin{figure*} [h]
\centering
\begin{subfigure}[t]{0.4\linewidth}
\includegraphics[width=\linewidth]{figures_sup/schedule/plot/tri.png} 
\caption{}
\label{fig:tri}
\end{subfigure}
\begin{subfigure}[t]{0.4\linewidth}
\includegraphics[width=\linewidth]{figures_sup/schedule/plot/linear_cos_exp.png} 
\caption{}
\label{fig:linear}
\end{subfigure}
\caption{Linear schedule is shown in (a), while linear, cosine, and exponential schedule are shown in purple, orange, and green, respectively, in (b). For linear schedule, we fix the linear factor as 1.0 while varying $t_{\text{max}}$ and $t_{\text{min}}$ by varying $T_M$. For the other three schedules, we fix the $t_{\text{max}} = 50$ then vary scale factors and $t_{\text{min}}$.}
\label{fig:schedules}
\end{figure*}

\begin{table*}[h]
\centering
\begin{tabular}{ccccccc}
\toprule
             & \begin{tabular}[c]{@{}c@{}}Suitable\\ or not\end{tabular} & $t_{\text{max}}$ & $T_M$ & \begin{tabular}[c]{@{}c@{}}Manipulation\\ schedule\end{tabular} & Linear factor & Other \\ \midrule
$x_t$        &    Partly                                                               &      [42, 48]     &   [15, 20]    &     Constant or others                                                         &     $< 1.0$          &    --   \\ 
$c$          &    Yes                                                               &      [47, 50]     &   [15, 25]    &        Constant or others                                                         &      Can be 1.0 or smaller         &   --    \\ 
P2P          &     Yes                                                              &     Usually 50      &   40    &         Can be 1.0 or smaller                                                        &   Can be 1.0 or smaller            &      \begin{tabular}[c]{@{}c@{}}The timesteps to inject\\ self-attention maps are critical\end{tabular}     \\ 
$\beta$      &     Partly                                                              &     50      &   50    &          Does not matter                                                       &      [-0.8, -0.5]         &   The guidance scale is very sensitive    \\ 
$\epsilon_t$ &     Yes                                                              &     [44, 50]      &   [15, 25]    &     Constant or others                                                            &     Can be 1.0 or smaller          &    --   \\ \bottomrule
\end{tabular}
\caption{The recommended parameters in the design space for local edits.}
\label{table:local}
\end{table*}

\begin{table*}[h]
\centering
\begin{tabular}{ccccccc}
\toprule
             & \begin{tabular}[c]{@{}c@{}}Suitable\\ or not\end{tabular} & $t_{\text{max}}$ & $T_M$ & \begin{tabular}[c]{@{}c@{}}Manipulation\\ schedule\end{tabular} & Linear factor & Other \\ \midrule
$x_t$        &    Partly                                                               &     [40, 50]      &   [10, 15]    &         Constant or others                                                        &      $<1.0$         &   --    \\ 
$c$          &      Partly                                                             &    50       &   [20, 25]    &     Constant or others                                                            &        Can be 1.0 or smaller       &   --    \\ 
P2P          &     Yes                                                              &   Usually 50        &  40     &          Constant or others                                                       &    Can be 1.0 or smaller           &  \begin{tabular}[c]{@{}c@{}}The timesteps to inject\\ self-attention maps are critical\end{tabular}     \\ 
$\beta$      &    Partly                                                               &    50       &  50     &          Does not matter                                                       &     [-0.8, 0.5]          &   The guidance scale is very sensitive    \\ 
$\epsilon_t$ &     Yes                                                              &     [44, 48]      &   [15, 25]    &        Constant or others                                                         &     Can be 1.0 or smaller          &   --    \\ \bottomrule
\end{tabular}
\caption{The recommended parameters in the design space for global edits.}
\label{table:global}
\end{table*}


\subsection{MDP-$\mathbf{x}_t$, MDP-$\mathbf{c}$ and MDP-$\boldsymbol\epsilon_t$}
While in most of the local editing applications and some of the global editing applications, MDP-$\mathbf{x}_t$ can faithfully do the edits, for the example we show in the figures, all the examples generated by MDP-$\mathbf{x}_t$ under different schedules fail. The edited image preserves the overall layout of the input image, however, the new semantics fail to be injected. We conjecture that keeping the intermediate latent from the path when generating the input image will impose a very strong condition to preserve the information from the input image. For the result in the main paper, we fix the linear factors for MDP-$\mathbf{x}_t$ to be 0.7 under all the edits. However, for a clear comparison with other two similar methods MDP-$\mathbf{c}$ and MDP-$\boldsymbol\epsilon_t$, we fix the linear factors as 1.0, which results in that the new condition has no influence when $t_{\text{min}} \leq t \leq t_{\text{max}}$. That is also the reason why we empirically set the linear factor of MDP-$\mathbf{x}_t$ to be 0.7 for all the results in the main paper, rather than 1.0 as the other two manipulations. 

On the other hand, MDP-$\mathbf{c}$ and MDP-$\boldsymbol\epsilon_t$ can inject the new semantics under the same schedules when linear factors are all set to be 1.0 when $t_{\text{max}}$. For MDP-$\mathbf{c}$, typically when $t_{\text{max}}$ is smaller than 50 or $T_M$ is smaller than 15, the new semantics can be injected into the edited image. However, the layout information from the input image is also lost. For MDP-$\boldsymbol\epsilon_t$, in terms of constant schedule, when $T_M$ is 25 and $t_{\text{max}}$ is smaller than 50, the edited image can both preserve the layout and incorporate the new semantics. 

Empirically, we observe that MDP-$\mathbf{x}_t$ is the strongest one to inject layout information, then is MDP-$\boldsymbol\epsilon_t$, while MDP-$\mathbf{c}$ is the weakest one when using the same manipulation schedule. Theoretically, this observation is aligned with the diffusion generation formula:
\begin{equation}\label{eq:ddim-sampler}
    \begin{aligned}
        \mathbf{x}_{t-1} =& \mathrm{DDIM}(\mathbf{x}_t, \boldsymbol\epsilon_{t}, t) \\
        =& \sqrt{\alpha_{t-1}}\cdot f_\theta(\mathbf{x}_t, \mathbf{c}, t) + \sqrt{1-\alpha_{t-1}}\cdot \boldsymbol\epsilon_\theta(\mathbf{x}_t, \mathbf{c}, t), \\
        % =& \sqrt{\alpha_{t-1}} \cdot \tilde{\mathbf{x}}_{0,t} + \tilde{\mathbf{x}}_t
    \end{aligned}
\end{equation}
where $f_\theta(\mathbf{x}_t, \mathbf{c}, t) = \frac{\mathbf{x}_t - \sqrt{1-\alpha_t}\cdot\boldsymbol\epsilon_\theta(\mathbf{x}_t, \mathbf{c}, t)}{\sqrt{\alpha_t}}$, $\boldsymbol\epsilon_t=\boldsymbol\epsilon_\theta(\mathbf{x}_t, \mathbf{c}, t)$, and $\alpha_t$ is a noise schedule factor as in DDIM. The sampling is to iteratively apply the above equation by giving an initial noise $\mathbf{x}_T\sim\mathcal{N}(\mathbf{0}, \mathbf{I})$. When setting the linear factors as 1.0, MDP-$\mathbf{x}_t$ directly replaces the intermediate latent from the path when generating the input image, while MDP-$\boldsymbol\epsilon_t$ replaces the predicted noise and keeps the previous intermediate latent when applying Eq. \eqref{eq:ddim-sampler}, and MDP-$\mathbf{c}$ only replaces the conditional embedding when predicting the noise.

We also observe that when $t_{\text{max}} = 50$, \ie, the manipulation happens right at the start of the whole denoising process, and the layout information can be injected more than when $t_{\text{max}}$ is smaller. In addition, considering linear, cosine, and exponential schedule, for cosine schedule it can preserve the most layout formation, while the exponential schedule can preserve the least. This is also aligned with the design of the schedule, where the linear factor of the cosine schedule in every timestep is larger than which of the linear schedule and exponential schedule, which means in the cosine schedule larger amount of the layout information is taken into the consideration compared to linear and exponential schedule. These findings can also support that the initial timesteps during the generation process, especially the first denoising timestep $T_M = 50$, have a great influence on the layout of the edited image. Injecting the layout information during the early generation stages is effective. 

Considering the results we have obtained, we have several conclusions:
\begin{itemize}
\item For the same manipulation schedule, MDP-$\mathbf{x}_t$ injects layout information the strongest from the input image, then comes MDP-$\boldsymbol\epsilon_t$, while MDP-$\mathbf{c}$ is the weakest one. 
\item For MDP-$\mathbf{x}_t$, we recommend to set the linear factor smaller than 1.0 when using the constant schedule, or consider using schedule with decreasing linear factors during the generation process, such as linear, cosine, or exponential schedules. For MDP-$\mathbf{c}$, we recommend using it only in local editing applications. For our proposed and highlighted MDP-$\boldsymbol\epsilon_t$, we recommend to set $t_{\text{max}}$ to be around 44 to 50 while $T_M$ to be around 20 to 25.
\item As the early stages during the diffusion generation process has a larger influence on the layout of the generated image, we recommend that for every kind of manipulation, we set the $t_{\text{max}}$ to be larger than 44.
\end{itemize}

\subsection{MDP-$\boldsymbol \beta$}
Recall the formula we use for MDP-$\boldsymbol \beta$:
\begin{equation}\label{eq:guidance}
\begin{aligned}
    \boldsymbol\epsilon_t^{(\star)} = & \boldsymbol\epsilon_\theta\left(\mathbf{x}_t, \mathbf{c}^{(A)}, t\right) + \\
    & \beta\left(\boldsymbol\epsilon_\theta\left(\mathbf{x}_t, \mathbf{c}^{(A)}, t\right) - \boldsymbol\epsilon_\theta\left(\mathbf{x}_t, \mathbf{c}^{(B)}, t\right)\right),
\end{aligned}
\end{equation}
where $\beta \in \mathbf{R}$ is called guidance scale. Intuitively, with Eq.~\eqref{eq:guidance}, we want the output to have more characteristics from $\mathbf{c}^{(A)}$ when generating using the new condition $\mathbf{c}^{(B)}$ to preserve the layout. This is a bit different from the original classifier free guidance, where condition $\mathbf{c}^{(B)}$ is an empty condition and $\beta$ is a positive real number. In our specific image editing task, we find that when using a positive $\beta$ (\eg, the first row in \cref{fig:guidance}), the edited image will be too close to condition $\mathbf{c}^{(A)}$ while losing both the layout from the input image and the new semantics from condition $\mathbf{c}^{(B)}$. Only when the guidance scale $\beta$ is a negative number, can the new semantics be added into the edited image. In this situation, the guidance becomes a linear interpolation operation: 
\begin{equation}\label{eq:guidance-lerp}
\begin{aligned}
    \boldsymbol\epsilon_t^{(\star)} = \omega\cdot\boldsymbol\epsilon_\theta\left(\mathbf{x}_t, \mathbf{c}^{(A)}, t\right) + (1-\omega)\cdot\boldsymbol\epsilon_\theta\left(\mathbf{x}_t, \mathbf{c}^{(B)}, t\right),
\end{aligned}
\end{equation}
where $\omega = 1 - \beta$ is a linear factor from 0 to 1, which means both condition $\mathbf{c}^{(A)}$ and condition $\mathbf{c}^{(B)}$ contribute positively to the generation process. Overall, $\beta$ has a larger influence over the edited image than varying the manipulation timesteps. We empirically find that $\beta \in [-0.6, -0.8]$ can obtain better results. 

\subsection{Prompt-to-Prompt}
We refer to the official implementation\footnote{\href{https://github.com/google/prompt-to-prompt}{https://github.com/google/prompt-to-prompt}}, which also utilizes Null-text Inversion to invert the real image and uses DDIM as the sampler. We observe that instead of replacing cross-attention maps, injecting self-attention maps has a bigger influence on the edited images. As in \cref{fig:p2p_global} the effect of injecting self-attention maps is not obvious enough, we additionally show one local editing example in \cref{fig:p2p_local}, where when fixing the timesteps to inject self-attention maps, the edited image look almost the same under different timesteps to inject cross attention maps; while under different timesteps to inject the self-attention maps, the generated images look more different.

We therefore suggest a tuning of the timesteps to inject the self-attention maps. The more timesteps to do that manipulation, the more the edited image will look like the input image. In general, for global editing, where the changes from the input image to the edited image should be larger, a smaller $T_M$ can be considered compared to which for local editing. A general setting for $T_M$ to replace the cross attention map like 20 or 40 is enough. 




\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%Global_xt_tri
\begin{figure*}
\centering
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccc}
 $t_{\text{max}}$/$T_M$ & 5 & 10 & 15 & 20 & 25 \\
 50 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_0_end_5.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_0_end_10.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_0_end_15.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_0_end_20.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_0_end_25.jpg}  \\
 48 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_2_end_7.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_2_end_12.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_2_end_17.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_2_end_22.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_2_end_27.jpg}  \\
 46 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_4_end_9.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_4_end_14.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_4_end_19.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_4_end_24.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_4_end_29.jpg}  \\
 44 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_6_end_11.jpg}  & 
 \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_6_end_16.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_6_end_21.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_6_end_26.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_6_end_31.jpg}  \\
 42 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_8_end_13.jpg} & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_8_end_18.jpg} & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_8_end_23.jpg} & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_8_end_28.jpg} & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/xt/replace_start_8_end_33.jpg}
\end{tabular}
\caption{Results of \textbf{MDP-$\mathbf{x}_t$} using constant schedule.}
\label{fig:xt_tri}
\end{figure*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%Global_xt_linear_cosine_exp
\begin{figure*}
\centering
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Type/$T_M$ & 20 & 25 & 30 & 35 & 40 & 45 & 50 \\
Linear & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/xt/replace_start_0_end_20.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/xt/replace_start_0_end_25.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/xt/replace_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/xt/replace_start_0_end_35.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/xt/replace_start_0_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/xt/replace_start_0_end_45.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/xt/replace_start_0_end_50.jpg} \\
Cosine & 
\includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/xt/replace_start_0_end_20.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/xt/replace_start_0_end_25.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/xt/replace_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/xt/replace_start_0_end_35.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/xt/replace_start_0_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/xt/replace_start_0_end_45.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/xt/replace_start_0_end_50.jpg} \\
Exponential & 
\includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/xt/replace_start_0_end_20.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/xt/replace_start_0_end_25.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/xt/replace_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/xt/replace_start_0_end_35.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/xt/replace_start_0_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/xt/replace_start_0_end_45.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/xt/replace_start_0_end_50.jpg} \\
\end{tabular}
\caption{Results of \textbf{MDP-$\mathbf{x}_t$} using linear, cosine and exponential schedule.}
\label{fig:xt_linear}
\end{figure*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%Global_c_tri
\begin{figure*}
\centering
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccc}
 $t_{\text{max}}$/$T_M$ & 5 & 10 & 15 & 20 & 25 \\
 50 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_0_end_5.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_0_end_10.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_0_end_15.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_0_end_20.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_0_end_25.jpg}  \\
 48 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_2_end_7.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_2_end_12.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_2_end_17.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_2_end_22.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_2_end_27.jpg}  \\
 46 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_4_end_9.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_4_end_14.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_4_end_19.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_4_end_24.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_4_end_29.jpg}  \\
 44 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_6_end_11.jpg}  & 
 \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_6_end_16.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_6_end_21.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_6_end_26.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_6_end_31.jpg}  \\
 42 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_8_end_13.jpg} & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_8_end_18.jpg} & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_8_end_23.jpg} & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_8_end_28.jpg} & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/c/replace_start_8_end_33.jpg}
\end{tabular}
\caption{Results of \textbf{MDP-$\mathbf{c}$} using constant schedule.}
\label{fig:c_tri}
\end{figure*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%Global_c_linear_cosine_exp
\begin{figure*}
\centering
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Type/$T_M$ & 20 & 25 & 30 & 35 & 40 & 45 & 50 \\
Linear & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/c/replace_start_0_end_20.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/c/replace_start_0_end_25.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/c/replace_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/c/replace_start_0_end_35.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/c/replace_start_0_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/c/replace_start_0_end_45.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/c/replace_start_0_end_50.jpg} \\
Cosine & 
\includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/c/replace_start_0_end_20.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/c/replace_start_0_end_25.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/c/replace_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/c/replace_start_0_end_35.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/c/replace_start_0_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/c/replace_start_0_end_45.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/c/replace_start_0_end_50.jpg} \\
Exponential & 
\includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/c/replace_start_0_end_20.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/c/replace_start_0_end_25.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/c/replace_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/c/replace_start_0_end_35.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/c/replace_start_0_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/c/replace_start_0_end_45.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/c/replace_start_0_end_50.jpg} \\
\end{tabular}
\caption{Results of \textbf{MDP-$\mathbf{c}$} using linear, cosine and exponential schedule.}
\label{fig:c_linear}
\end{figure*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%Global_Epsilon_tri
\begin{figure*}
\centering
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccc}
 $t_{\text{max}}$/$T_M$ & 5 & 10 & 15 & 20 & 25 \\
 50 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_0_end_5.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_0_end_10.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_0_end_15.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_0_end_20.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_0_end_25.jpg}  \\
 48 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_2_end_7.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_2_end_12.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_2_end_17.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_2_end_22.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_2_end_27.jpg}  \\
 46 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_4_end_9.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_4_end_14.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_4_end_19.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_4_end_24.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_4_end_29.jpg}  \\
 44 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_6_end_11.jpg}  & 
 \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_6_end_16.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_6_end_21.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_6_end_26.jpg}  & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_6_end_31.jpg}  \\
 42 & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_8_end_13.jpg} & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_8_end_18.jpg} & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_8_end_23.jpg} & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_8_end_28.jpg} & \includegraphics[align=c,width=0.14\linewidth]{figures_sup/schedule/tri/global/epsilon/replace_start_8_end_33.jpg}
\end{tabular}
\caption{Results of \textbf{MDP-$\boldsymbol\epsilon_t$} using constant schedule.}
\label{fig:epsilon_tri}
\end{figure*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%Global_epsilon_linear_cosine_exp
\begin{figure*}
\centering
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Type/$T_M$ & 20 & 25 & 30 & 35 & 40 & 45 & 50 \\
Linear & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/epsilon/replace_start_0_end_20.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/epsilon/replace_start_0_end_25.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/epsilon/replace_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/epsilon/replace_start_0_end_35.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/epsilon/replace_start_0_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/epsilon/replace_start_0_end_45.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/linear/global/epsilon/replace_start_0_end_50.jpg} \\
Cosine & 
\includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/epsilon/replace_start_0_end_20.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/epsilon/replace_start_0_end_25.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/epsilon/replace_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/epsilon/replace_start_0_end_35.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/epsilon/replace_start_0_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/epsilon/replace_start_0_end_45.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/cosine/global/epsilon/replace_start_0_end_50.jpg} \\
Exponential & 
\includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/epsilon/replace_start_0_end_20.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/epsilon/replace_start_0_end_25.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/epsilon/replace_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/epsilon/replace_start_0_end_35.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/epsilon/replace_start_0_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/epsilon/replace_start_0_end_45.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/exp/global/epsilon/replace_start_0_end_50.jpg} \\
\end{tabular}
\caption{Results of \textbf{MDP-$\boldsymbol\epsilon_t$} using linear, cosine and exponential schedule.}
\label{fig:epsilon_linear}
\end{figure*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%guidance
\begin{figure*}[h]
\centering
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccc}
$\beta$/$t_{\text{max}}$ - $t_{\text{min}}$ & 50 - 40 & 50 - 30 & 50 - 20 & 50 - 10 & 50 - 0 \\
0.7 & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_10_edit_0.7.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_20_edit_0.7.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_30_edit_0.7.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_40_edit_0.7.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_50_edit_0.7.jpeg} \\
0.3 & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_10_edit_0.3.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_20_edit_0.3.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_30_edit_0.3.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_40_edit_0.3.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_50_edit_0.3.jpeg} \\
0 & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_10_edit_0.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_20_edit_0.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_30_edit_0.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_40_edit_0.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_50_edit_0.jpeg} \\
-0.3 & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_10_edit_-0.3.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_20_edit_-0.3.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_30_edit_-0.3.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_40_edit_-0.3.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_50_edit_-0.3.jpeg} \\
-0.7 & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_10_edit_-0.7.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_20_edit_-0.7.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_30_edit_-0.7.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_40_edit_-0.7.jpeg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/guidance/replace_start_0_end_50_edit_-0.7.jpeg} \\
\end{tabular}
\caption{Results of \text{MDP-$\boldsymbol \beta$} using constant schedule when varying guidance scale $\beta$.}
\label{fig:guidance}
\end{figure*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%P2P

\begin{figure*}[h]
\centering
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Self/Cross & 50 - 30 & 50 - 20  & 50 - 10 & 50 - 0 & 40 - 20 & 40 - 10 & 40 - 0 \\
50 - 40 & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.2_start_0_end_20.jpg}  & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.2_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.2_start_0_end_40.jpg} & 
\includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.2_start_0_end_50.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.2_start_10_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.2_start_10_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.2_start_10_end_50.jpg} \\
50 - 30 & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.4_start_0_end_20.jpg}  & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.4_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.4_start_0_end_40.jpg} & 
\includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.4_start_0_end_50.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.4_start_10_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.4_start_10_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.4_start_10_end_50.jpg} \\
50 - 20 & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.6_start_0_end_20.jpg}  & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.6_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.6_start_0_end_40.jpg} & 
\includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.6_start_0_end_50.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.6_start_10_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.6_start_10_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.6_start_10_end_50.jpg} \\
50 - 10 & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.8_start_0_end_20.jpg}  & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.8_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.8_start_0_end_40.jpg} & 
\includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.8_start_0_end_50.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.8_start_10_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.8_start_10_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_0.8_start_10_end_50.jpg} \\
50 - 0 & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_1.0_start_0_end_20.jpg}  & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_1.0_start_0_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_1.0_start_0_end_40.jpg} & 
\includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_1.0_start_0_end_50.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_1.0_start_10_end_30.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_1.0_start_10_end_40.jpg} & \includegraphics[align=c,width=0.13\linewidth]{figures_sup/schedule/tri/global/p2p/self_1.0_start_10_end_50.jpg} \\
\end{tabular}
\caption{Results of Prompt-to-Prompt using constant schedule when varying the timestpes to inject self-attention maps and cross-attention maps. We show the results when we vary $t_{\text{max}}$ and $t_{\text{min}}$ for either injecting self-attention maps or cross attention maps.}
\label{fig:p2p_global}
\end{figure*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%P2P_local
\begin{figure*}[h]
\centering
\scriptsize
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccc}
Self/Cross & 50 - 30 & 50 - 10 & 40 - 0 \\
50-40 & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/p2p/local/self_0.2_start_0_end_20.jpg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/p2p/local/self_0.2_start_0_end_40.jpg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/p2p/local/self_0.2_start_10_end_50.jpg} \\
50-30 & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/p2p/local/self_0.4_start_0_end_20.jpg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/p2p/local/self_0.4_start_0_end_40.jpg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/p2p/local/self_0.4_start_10_end_50.jpg} \\
50-20 & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/p2p/local/self_0.6_start_0_end_20.jpg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/p2p/local/self_0.6_start_0_end_40.jpg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/p2p/local/self_0.6_start_10_end_40.jpg} \\
50-10 & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/p2p/local/self_0.8_start_0_end_20.jpg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/p2p/local/self_0.8_start_0_end_40.jpg} & \includegraphics[align=c,width=0.15\linewidth]{figures_sup/schedule/tri/global/p2p/local/self_0.8_start_10_end_50.jpg} \\
\end{tabular}
\caption{Additional results of Prompt-to-Prompt using constant schedule when varying the timestpes to inject self-attention maps and cross-attention maps. We show the results when we vary $t_{\text{max}}$ and $t_{\text{min}}$ for either injecting self-attention maps or cross attention maps.}
\label{fig:p2p_local}
\end{figure*}

\section{More results}
\subsection{Visual comarisons}
We show more comparisons between Prompt-to-Prompt and MDP-$\boldsymbol\epsilon_t$ for each kind of edits we describe in \cref{sec:taxonomy}. We show the edits for local editing in \cref{fig:local-changing-object,fig:local-adding-object,fig:local-changing-attributes,fig:local-removing-object,fig:local-mixing-objects}, and for global editing in \cref{fig:global-changing-background,fig:global-in-domain-transfer,fig:global-out-domain-transfer,fig:global-stylization}. We also show more intermediate results for mixing objects in \cref{fig:mixing-objects-multiple}. We show that in many cases, MDP-$\boldsymbol\epsilon_t$ can perform as good as or better than Prompt-to-Prompt.

%\subsection{User study}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%Local editing -- Changing objects
\begin{figure*}[h]
\centering
\scriptsize
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} & Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} \\
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/001_input.jpg} & 
\begin{tabular}[c]{@{}c@{}}``Horse''\\to\\``Zebra''\end{tabular}& \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/001_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/001_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/002_input.jpg}  & \begin{tabular}[c]{@{}c@{}}``Horse''\\to\\``Zebra''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/002_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/002_epsilon.jpg} \vspace{1mm} \\ 
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/004_input.jpg} & 
  \begin{tabular}[c]{@{}c@{}}``Pizza''\\to\\``Cake''\end{tabular}& \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/004_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/004_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/010_input.jpg} &   \begin{tabular}[c]{@{}c@{}}``Bread''\\to\\``Cake''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/010_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/010_epsilon.jpg} \vspace{1mm} \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/005_input.jpg} &   \begin{tabular}[c]{@{}c@{}}``Cat''\\to\\``Dog''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/005_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/005_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/007_input.jpg}  & \begin{tabular}[c]{@{}c@{}}``Cat''\\to\\``Dog''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/007_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/007_epsilon.jpg} \vspace{1mm} \\ 
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/008_input.jpg} &   \begin{tabular}[c]{@{}c@{}}``Bus''\\to\\``Truck''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/008_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/008_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/009_input.jpg} &   \begin{tabular}[c]{@{}c@{}}``Bus''\\to\\``Truck''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/009_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_object/009_epsilon.jpg} \vspace{1mm} \\
\end{tabular}
\caption{Results of changing object comparing Prompt-to-Prompt and \textbf{MDP-$\boldsymbol\epsilon_t$}.}
\label{fig:local-changing-object}
\end{figure*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%Local editing -- Adding objects
\begin{figure*}[h]
\centering
\scriptsize
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} & Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} \\
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/001_input.jpg} & 
    \begin{tabular}[c]{@{}c@{}}Add\\``Glasses''\end{tabular}& \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/001_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/001_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/002_input.jpg}  &     \begin{tabular}[c]{@{}c@{}}Add\\``Glasses''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/002_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/002_epsilon.jpg} \vspace{1mm} \\ 
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/003_input.jpg} &     \begin{tabular}[c]{@{}c@{}}Add\\``Giraffe''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/003_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/003_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/004_input.jpg} &     \begin{tabular}[c]{@{}c@{}}Add\\``Birds''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/004_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/004_epsilon.jpg} \vspace{1mm} \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/005_input.jpg} &     \begin{tabular}[c]{@{}c@{}}Add\\``Elephant''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/005_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/005_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/006_input.jpg}  & \begin{tabular}[c]{@{}c@{}}Add\\``Apples''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/006_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/006_epsilon.jpg} \vspace{1mm} \\ 
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/009_input.jpg} & \begin{tabular}[c]{@{}c@{}}Add\\``Balloons''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/009_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/009_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/008_input.jpg} & \begin{tabular}[c]{@{}c@{}}Add\\``Duck''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/008_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/adding_object/008_epsilon.jpg} \vspace{1mm} \\
\end{tabular}
\caption{Results of adding object comparing Prompt-to-Prompt and \textbf{MDP-$\boldsymbol\epsilon_t$}.}
\label{fig:local-adding-object}
\end{figure*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%Local editing -- Changing attributes
\begin{figure*}[h]
\centering
\scriptsize
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} & Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} \\
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/001_input.jpg} & 
  \begin{tabular}[c]{@{}c@{}}``Sad''\\to\\``Happy''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/001_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/001_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/002_input.jpg}  &   \begin{tabular}[c]{@{}c@{}}``Sad''\\to\\``Happy''\end{tabular}   & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/002_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/002_epsilon.jpg} \vspace{1mm} \\ 
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/003_input.jpg} & 
    \begin{tabular}[c]{@{}c@{}}``Old''\\to\\``Young''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/003_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/003_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/004_input.jpg} &     \begin{tabular}[c]{@{}c@{}}``Woman''\\to\\``Kid''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/004_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/004_epsilon.jpg} \vspace{1mm} \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/005_input.jpg} &     \begin{tabular}[c]{@{}c@{}}``Chocolate''\\to\\``Strawberry''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/005_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/005_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/006_input.jpg}  & 
      \begin{tabular}[c]{@{}c@{}}``Strawberry''\\to\\``Candles''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/006_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/006_epsilon.jpg} \vspace{1mm} \\ 
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/007_input.jpg} & 
        \begin{tabular}[c]{@{}c@{}}``Cloth''\\to\\``Plastic''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/007_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/007_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/008_input.jpg} & 
  \begin{tabular}[c]{@{}c@{}}``Fluffy''\\to\\``Smooth''\end{tabular}& \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/008_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/changing_attributes/008_epsilon.jpg} \vspace{1mm}\\
\end{tabular}
\caption{Results of changing attributes comparing Prompt-to-Prompt and \textbf{MDP-$\boldsymbol\epsilon_t$}.}
\label{fig:local-changing-attributes}
\end{figure*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%Local editing -- Removing object
\begin{figure*}[h]
\centering
\scriptsize
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} & Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} \\
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/008_input.jpg} & 
    \begin{tabular}[c]{@{}c@{}}Remove\\``Eggs''\end{tabular}& \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/008_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/008_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/002_input.jpg}  &     \begin{tabular}[c]{@{}c@{}}Remove\\``Fruits''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/002_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/002_epsilon.jpg} \vspace{1mm} \\ 
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/003_input.jpg} &     \begin{tabular}[c]{@{}c@{}}Remove\\``Fruits''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/003_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/003_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/004_input.jpg} &     \begin{tabular}[c]{@{}c@{}}Remove\\``People''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/004_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/004_epsilon.jpg} \vspace{1mm} \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/005_input.jpg} & \begin{tabular}[c]{@{}c@{}}Remove\\``Boats''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/005_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/005_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/006_input.jpg}  & \begin{tabular}[c]{@{}c@{}}Remove\\``Cat''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/006_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/006_epsilon.jpg} \vspace{1mm} \\ 
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/007_input.jpg} & \begin{tabular}[c]{@{}c@{}}Remove\\``Graffiti''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/007_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/007_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/001_input.jpg} & \begin{tabular}[c]{@{}c@{}}Remove\\``Stuffs''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/001_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/removing_object/001_epsilon.jpg} \vspace{1mm}\\
\end{tabular}
\caption{Results of removing object(s) comparing Prompt-to-Prompt and \textbf{MDP-$\boldsymbol\epsilon_t$}.}
\label{fig:local-removing-object}
\end{figure*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%Local editing -- Mixing objects
\begin{figure*}[h]
\centering
\scriptsize
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} & Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} \\
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/002_input.jpg} & 
      \begin{tabular}[c]{@{}c@{}}``Tower''\\Mixes\\``Dress''\end{tabular}& \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/002_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/002_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/003_input.jpg}  & 
      \begin{tabular}[c]{@{}c@{}}``Watermelon''\\Mixes\\``Pillow''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/003_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/003_epsilon.jpg} \vspace{1mm} \\ 
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/004_input.jpg} &       \begin{tabular}[c]{@{}c@{}}``Butterfly''\\Mixes\\``Handbag''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/004_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/004_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/005_input.jpg} &       \begin{tabular}[c]{@{}c@{}}``Chocolate''\\Mixes\\``Purse''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/005_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/005_epsilon.jpg} \vspace{1mm} \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/006_input.jpg} &       \begin{tabular}[c]{@{}c@{}}``Flower''\\Mixes\\``Handbag''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/006_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/006_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/007_input.jpg}  &       \begin{tabular}[c]{@{}c@{}}``Polar Bear''\\Mixes\\``Kettle''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/007_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/007_epsilon.jpg} \vspace{1mm} \\ 
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/008_input.jpg} &       \begin{tabular}[c]{@{}c@{}}``Pumpkin''\\Mixes\\``Clock''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/008_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/008_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/009_input.jpg} &       \begin{tabular}[c]{@{}c@{}}``Strawberry''\\Mixes\\``Diamond''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/009_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/local_editing/mixing_objects/009_epsilon.jpg} \vspace{1mm} \\
\end{tabular}
\caption{Results of mixing objects comparing Prompt-to-Prompt and \textbf{MDP-$\boldsymbol\epsilon_t$}.}
\label{fig:local-mixing-objects}
\end{figure*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%Mixing object more results
\begin{figure*}[h]
\centering
\scriptsize
\setlength{\tabcolsep}{1pt}
\begin{tabular}{ccccccccc}
\multicolumn{2}{c}{\multirow{2}{*}{\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/001_input.jpg}}} \hspace{2mm} & \textbf{MDP-$\boldsymbol\epsilon_t$} &{\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/epsilon/001_5.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/epsilon/001_6.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/epsilon/001_0.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/epsilon/001_2.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/epsilon/001_4.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/epsilon/001_3.jpg}} \\
\multicolumn{2}{c}{}                  & P2P &{\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/p2p/001_1.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/p2p/001_4.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/p2p/001_5.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/p2p/001_0.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/p2p/001_2.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/p2p/001_3.jpg}} \\
\multicolumn{2}{c}{\multirow{2}{*}{{\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/002_input.jpg}}}} \hspace{2mm} & \textbf{MDP-$\boldsymbol\epsilon_t$} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/epsilon/002_4.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/epsilon/002_6.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/epsilon/002_5.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/epsilon/002_3.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/epsilon/002_0.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/epsilon/002_1.jpg}} \\
\multicolumn{2}{c}{}                  & P2P & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/p2p/002_0.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/p2p/002_1.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/p2p/002_4.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/p2p/002_5.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/p2p/002_2.jpg}} & {\includegraphics[align=c,width=0.12\linewidth]{figures_sup/mixing_objects_multiple/p2p/002_3.jpg}}
\end{tabular}
\caption{More intermediate results of mixing objects comparing \textbf{MDP-$\boldsymbol\epsilon_t$} and P2P. In the first two rows we mix the input ``corgi'' with ``coffee machine''. In the second two rows we mix the input ``pumpkin'' with ``clock''.}
\label{fig:mixing-objects-multiple}
\end{figure*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%Global editing -- Changing background
\begin{figure*}[h]
\centering
\scriptsize
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} & Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} \\
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/001_input.jpg} & 
        \begin{tabular}[c]{@{}c@{}}``Grass''\\to\\``Road''\end{tabular}& \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/001_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/001_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/002_input.jpg}  &         \begin{tabular}[c]{@{}c@{}}``Beach''\\to\\``Mountain''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/002_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/002_epsilon.jpg} \vspace{1mm} \\ 
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/005_input.jpg} &         \begin{tabular}[c]{@{}c@{}}``Grass''\\to\\``Roof''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/005_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/005_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/004_input.jpg} &         \begin{tabular}[c]{@{}c@{}}``Ground''\\to\\``Boat''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/004_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/004_epsilon.jpg} \vspace{1mm} \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/003_input.jpg} &         \begin{tabular}[c]{@{}c@{}}``Grass''\\to\\``Lake''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/003_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/003_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/006_input.jpg}  &         \begin{tabular}[c]{@{}c@{}}``City''\\to\\``Mountain''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/006_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/006_epsilon.jpg} \vspace{1mm} \\ 
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/007_input.jpg} &         \begin{tabular}[c]{@{}c@{}}``Mountain''\\to\\``Mars''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/007_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/007_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/008_input.jpg} &         \begin{tabular}[c]{@{}c@{}}``Sea''\\to\\``Mountain''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/008_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/changing_background/008_epsilon.jpg} \vspace{1mm}\\
\end{tabular}
\caption{Results of changing background comparing Prompt-to-Prompt and \textbf{MDP-$\boldsymbol\epsilon_t$}.}
\label{fig:global-changing-background}
\end{figure*}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%Global editing -- In domain transer
\begin{figure*}[h]
\centering
\scriptsize
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} & Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} \\
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/001_input.jpg} & 
          \begin{tabular}[c]{@{}c@{}}``Spring''\\to\\``Winter''\end{tabular}& \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/001_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/001_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/002_input.jpg}  & \begin{tabular}[c]{@{}c@{}}``Spring''\\to\\``Winter''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/002_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/002_epsilon.jpg} \vspace{1mm} \\ 
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/003_input.jpg} & \begin{tabular}[c]{@{}c@{}}``Winter''\\to\\``Spring''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/003_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/003_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/004_input.jpg} & \begin{tabular}[c]{@{}c@{}}``Winter''\\to\\``Spring''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/004_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/004_epsilon.jpg} \vspace{1mm} \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/005_input.jpg} & \begin{tabular}[c]{@{}c@{}}``Sunny''\\to\\``Rainstormy''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/005_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/005_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/006_input.jpg}  & \begin{tabular}[c]{@{}c@{}}``Colored''\\to\\``Black-and-\\white''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/006_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/006_epsilon.jpg} \vspace{1mm} \\ 
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/007_input.jpg} & \begin{tabular}[c]{@{}c@{}}``Evening''\\to\\``Morning''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/007_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/007_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/008_input.jpg} & 
\begin{tabular}[c]{@{}c@{}}``Morning''\\to\\``Evening''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/008_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/in_domain_transfer/008_epsilon.jpg} \vspace{1mm} \\
\end{tabular}
\caption{Results of in-domain transfer comparing Prompt-to-Prompt and \textbf{MDP-$\boldsymbol\epsilon_t$}.}
\label{fig:global-in-domain-transfer}
\end{figure*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%Global editing -- Out domain transer
\begin{figure*}
\centering
\scriptsize
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} & Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} \\
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/001_input.jpg} & 
  \begin{tabular}[c]{@{}c@{}}``Photo''\\to\\``Children's \\ Painting''\end{tabular}& \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/001_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/001_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/002_input.jpg}  &   \begin{tabular}[c]{@{}c@{}}``Photo''\\to\\``Children's \\ Painting''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/002_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/002_epsilon.jpg} \vspace{1mm} \\ 
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/003_input.jpg} &   \begin{tabular}[c]{@{}c@{}}``Photo''\\to\\``Watercolor \\ Painting''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/003_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/003_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/004_input.jpg} &   \begin{tabular}[c]{@{}c@{}}``Watercolor \\ Painting''\\``Photo''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/004_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/004_epsilon.jpg} \vspace{1mm} \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/005_input.jpg} &   \begin{tabular}[c]{@{}c@{}}``Photo''\\to\\``Impressionism \\ Painting''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/005_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/005_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/006_input.jpg}  &   \begin{tabular}[c]{@{}c@{}}``Photo''\\to\\``Sketch''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/006_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/006_epsilon.jpg} \vspace{1mm} \\ 
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/007_input.jpg} &   \begin{tabular}[c]{@{}c@{}}``Photo''\\to\\``Abstract \\ Painting''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/007_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/007_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/008_input.jpg} &   \begin{tabular}[c]{@{}c@{}}``Oil \\ Painting''\\to\\``Photo''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/008_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/out_domain_transfer/008_epsilon.jpg} \vspace{1mm}\\
\end{tabular}
\caption{Results of out-domain transfer comparing Prompt-to-Prompt and \textbf{MDP-$\boldsymbol\epsilon_t$}.}
\label{fig:global-out-domain-transfer}
\end{figure*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%Global editing -- Stylization
\begin{figure*}[h]
\centering
\scriptsize
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} & Input & Edit & P2P & \textbf{MDP-$\boldsymbol\epsilon_t$} \\
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/001_input.jpg} & 
    \begin{tabular}[c]{@{}c@{}}Stylize\\``Bus''\end{tabular}& \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/001_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/001_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/002_input.jpg}  & \begin{tabular}[c]{@{}c@{}}Stylize\\``Flower''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/002_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/002_epsilon.jpg} \vspace{1mm} \\ 
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/003_input.jpg} & \begin{tabular}[c]{@{}c@{}}Stylize\\``Ice-cream''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/003_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/003_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/004_input.jpg} & \begin{tabular}[c]{@{}c@{}}Stylize\\``Book''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/004_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/004_epsilon.jpg} \vspace{1mm} \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/005_input.jpg} & \begin{tabular}[c]{@{}c@{}}Stylize\\``Hammer''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/005_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/005_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/006_input.jpg}  & \begin{tabular}[c]{@{}c@{}}Stylize\\``Cells''\end{tabular}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/006_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/006_epsilon.jpg} \vspace{1mm} \\ 
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/007_input.jpg} & \begin{tabular}[c]{@{}c@{}}Stylize\\``Coral''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/007_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/007_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/008_input.jpg} & \begin{tabular}[c]{@{}c@{}}Stylize\\``Girl''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/008_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/global_editing/stylization/008_epsilon.jpg} \vspace{1mm} \\
\end{tabular}
\caption{Results of stylization comparing Prompt-to-Prompt and \textbf{MDP-$\boldsymbol\epsilon_t$}.}
\label{fig:global-stylization}
\end{figure*}

\section{Failure cases}
We identify several typical failure cases of MDP-$\boldsymbol\epsilon_t$ in \cref{fig:failure-1} with comparisons to Prompt-to-Prompt. For the first case, when we deform the object in the input image such as changing the shape, neither of MDP-$\boldsymbol\epsilon_t$ nor Prompt-to-Prompt can faithfully perform the edits while preserving the layout of the input image. This kind of failure cases of deformation is also reported in the Prompt-to-Prompt paper. That means these two algorithms are better suited for performing edits without large changes to the object; in other words, the constraint to preserve the layout from the input image is relatively big in these two algorithms, which limits their ability to perform edits with larger changes. In another case MDP-$\boldsymbol\epsilon_t$ cannot convert the red car into a yellow one, instead, Prompt-to-Prompt can do the edit. We observe that in some cases MDP-$\boldsymbol\epsilon_t$ struggles to transform the color of the object, especially the color that is very different from the original one. We conjecture that by keeping the predicted noises from the input image path, a lot of information about the color is also preserved.

Another common kind of failure cases is map-based image translation, such as converting a segmentation map to a photo or a sketch to a photo. All the manipulations we analyze in the design space preserve the color and texture of the input image to an extent, which is because of the nature of this kind of manipulation. However, for map-based input images, the colors are usually only used to distinguish different parts of the objects, other than the real colors of the objects have. Therefore, the map-based image editing usually involves an auxiliary network or additional training to extract the useful features in order to guide the editing.
%\cite{voynov2022sketch-diffusion,avrahami2022spatext}.

We also report another common failure case in \cref{fig:failure-2}, which is a result of the imperfections in image inversion. As all the manipulations in MDP for real images rely on image inversion, when the inversion algorithm cannot invert the input image in a plausible way, the resulting edited image will most likely fail. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%Failure case
\begin{figure*}[h]
\centering
\scriptsize
\setlength{\tabcolsep}{1pt}
\begin{tabular}{cccccccc}
Input & Edit & P2P & MDP-$\boldsymbol\epsilon_t$ & Input & Edit & P2P & MDP-$\boldsymbol\epsilon_t$ \\
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/001_input.png} &   \begin{tabular}[c]{@{}c@{}}``Sitting''\\to\\``Jumping''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/001_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/001_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/002_input.png} &   \begin{tabular}[c]{@{}c@{}}``Red''\\to\\``Yellow''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/002_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/002_epsilon.jpg} \vspace{3mm} \\
  \multicolumn{4}{c}{(a)} & \multicolumn{4}{c}{(b)} \vspace{3mm} \\
  Input & Edit & P2P & MDP-$\boldsymbol\epsilon_t$ & Input & Edit & P2P & MDP-$\boldsymbol\epsilon_t$ \\
  \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/003_input.jpg} &   \begin{tabular}[c]{@{}c@{}}``Segmentation \\ map''\\to\\``Photo''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/003_p2p.jpg} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/003_epsilon.jpg} \hspace{3mm} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/004_input.jpg} &   \begin{tabular}[c]{@{}c@{}}``Sketch''\\to\\``Photo''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/004_p2p.jpg}  & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/004_epsilon.jpg} \vspace{3mm} \\
  \multicolumn{4}{c}{(c)} & \multicolumn{4}{c}{(d)} \vspace{3mm}\\
\end{tabular}
\caption{Typical failure cases of MDP-$\boldsymbol\epsilon_t$. In (a) MDP-$\boldsymbol\epsilon_t$ fails to preserve the layout of the input image; In (b) MDP-$\boldsymbol\epsilon_t$ fails to faithfully synthesize the yellow color. In (c) and (d), MDP-$\boldsymbol\epsilon_t$ fails to do the map-based image editing, where the color and texture of the input map has no semantic meaning. }
\label{fig:failure-1}
\end{figure*}


\begin{figure*}[h]
\centering
\begin{tabular}{cccc}
Input & Inverted & Edit & MDP-$\boldsymbol\epsilon_t$ \\
\includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/005_input.png} &   \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/005_inversion.png} & \begin{tabular}[c]{@{}c@{}}``Cat''\\to\\``Dog''\end{tabular} & \includegraphics[align=c,width=0.12\linewidth]{figures_sup/failure/005_epsilon.png} 
\end{tabular}
\caption{MDP-$\boldsymbol\epsilon_t$ fails when the inverted image does not reconstruct the input image in a plausible way.}
\label{fig:failure-2}
\end{figure*}



\end{document}
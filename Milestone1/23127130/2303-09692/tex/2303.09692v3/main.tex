% \documentclass[envcountsect,envcountsame,runningheads,a4paper]{elsarticle} 

\documentclass[
  preprint,
  10pt,
% authoryear,
  3p,
  fleqn,
% times
]{elsarticle}

% \geometry{margin=2.5cm}
% \geometry{top=2cm,bottom=2cm,left=2cm,right=2cm,marginparwidth=1.75cm}

\usepackage{main}

% \allowdisplaybreaks

% Language setting
% Replace `english' with e.g. `spanish' to change the document language

\usepackage[english]{babel}

% Set page size and margins
% Replace `letterpaper' with`a4paper' for UK/EU standard size
% \usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

% Useful packages

%\usepackage[colorlinks=true,allcolors=blue]{hyperref}

\begin{document}

\begin{frontmatter}
  \title{Probabilistic unifying relations for modelling epistemic and aleatoric uncertainty: semantics and automated reasoning with theorem proving\tnoteref{t1,t2}}
  \tnotetext[t1]{This document is the results of the research project RoboTest (\url{https://robostar.cs.york.ac.uk/}) funded by EPSRC.}
  \author[1]{Kangfeng Ye\corref{cor1}}
  \ead{kangfeng.ye@york.ac.uk}
  
  \author[1]{Jim Woodcock}
  \ead{jim.woodcock@york.ac.uk}
  
  \author[1]{Simon Foster}
  \ead{simon.foster@york.ac.uk}
  
  \cortext[cor1]{Corresponding author}
  % \fntext[fn1]{This is the first author footnote.}
  % \fntext[fn2]{Another author footnote, this is a very long 
  % footnote and it should be a really long footnote. But this 
  % footnote is not yet sufficiently long enough to make two 
  % lines of footnote text.}
  % \fntext[fn3]{Yet another author footnote.}
  
  \affiliation[1]{organization={Department of Computer Science, University of York}, 
    addressline={Deramore Lane, Heslington},
    postcode={YO10 5GH},
    city={York},
    country={United Kingdom}}
  
  \begin{abstract}
    Probabilistic programming combines general computer programming, statistical inference, and formal semantics to help systems make decisions when facing uncertainty. Probabilistic programs are ubiquitous, including having a significant impact on machine intelligence. While many probabilistic algorithms have been used in practice in different domains, their automated verification based on formal semantics is still a relatively new research area. In the last two decades, it has attracted much interest. Many challenges, however, remain. The work presented in this paper, probabilistic unifying relations (ProbURel), takes a step towards our vision to tackle these challenges.
    
    Our work is based on Hehner's predicative probabilistic programming, but there are several obstacles to the broader adoption of his work. Our contributions here include (1) the formalisation of its syntax and semantics by introducing an Iverson bracket notation to separate relations from arithmetic; (2) the formalisation of relations using Unifying Theories of Programming (UTP) and probabilities outside the brackets using summation over the topological space of the real numbers; (3) the constructive semantics for probabilistic loops using Kleene's fixed-point theorem; (4) the enrichment of its semantics from distributions to subdistributions and superdistributions to deal with the constructive semantics; (5) the unique fixed-point theorem to simplify the reasoning about probabilistic loops; and (6) the mechanisation of our theory in Isabelle/UTP, an implementation of UTP in Isabelle/HOL, for automated reasoning using theorem proving.
    
    We demonstrate our work with six examples, including problems in robot localisation, classification in machine learning, and the termination of probabilistic loops.
  \end{abstract}
  
  \begin{keyword}
    formal semantics \sep 
    fixed-point theorems \sep 
    predicative programming \sep
    UTP \sep
    probabilistic models \sep 
    probabilistic programs \sep 
    probability distributions \sep 
    formal verification \sep 
    quantitative verification \sep 
    automated reasoning \sep 
    theorem proving \sep 
    Isabelle/HOL \sep 
    robotics \sep 
    machine learning \sep 
    classification
  \end{keyword}
\end{frontmatter}

% \maketitle % not necessary if everything is included inside the frontmatter environment

\input{intro}
\input{relwork}
\input{prelim}
\input{ureal}
\input{prog}
\input{rec}
\input{cases}
\input{concl}

\section*{Acknowledgements}

This work is funded by the EPSRC projects RoboCalc (Grant EP/M025756/1) and RoboTest (Grant EP/R025479/1).

\appendix
\input{appendix}

%\bibliographystyle{elsarticle-num-names} 
\bibliographystyle{elsarticle-num} 
\bibliography{main}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ifdefined \CHANGES \indexprologue{%
  This index lists for each comment the pages where the text has been modified to address the comment. Since the same page may contain multiple changes, the page number contains the index of the change in superscript to identify different changes. Finally, the page number contains a hyperlink that takes the reader to corresponding change.%
}%
\printindex[changes] \fi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}

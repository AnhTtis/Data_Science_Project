\documentclass{standalone}

\input{preamble}

\begin{document}
\begin{tikzpicture}[scale=1.5, text=black, draw=black]
	% matrix

	\def\h{-0.15}
	\def\hx{0.05}
	\def\hy{0.05}
	\draw[fill=black!2, draw=none, thick] (-3, -1.5) rectangle (7, 1.5);

	\foreach \a in {-1.2,-0.4,...,8} {
			\foreach \b in {-0.8, 0,...,2} {
					\draw[fill=teal!50, rotate around={45:(\a, \b+\h)}] (\a, \b+\h) ellipse (0.2 and 0.25);
				}
		}
	\foreach \a in {-1.6,-0.8,...,8} {
			\foreach \b in {-1.2, -0.4,...,2.5} {
					\draw[fill=gray!30, rotate around={20:(\a+\hx, \b+\h+\hy)}] (\a+\hx, \b+\h+\hy) ellipse (0.2 and 0.24);
				}
		}
	\draw[draw=none, fill=white, opacity=1] (-3, 1.5) rectangle (8, 2.4);
	\draw[draw=none, fill=white, opacity=1] (-3, -1.5) rectangle (8, -2.);
	\draw[draw=none, fill=white, opacity=1] (7, -1.6) rectangle (8, 1.6);
	\draw[draw=black, thick] (-3, -1.5) rectangle (7, 1.5);

	% initial crack
	\draw[ultra thick, red] (-3, 0) -- (0, 0);
	\node[anchor=south west, red] at (-3.05, 0) {Initial crack};

	% dimensions
	\dimline[label style={above, fill=none}, extension start length=0.2cm, extension end length=1.8cm] {(-3, 1.8)}{(0, 1.8)}{$3$};
	\dimline[label style={above, fill=none}, extension start length=0.cm, extension end length=0.2cm] {(0, 1.8)}{(7, 1.8)}{$7$};
	\dimline[label style={above, fill=none}, extension start length=0.2cm, extension end length=0.2cm] {(-3.3, -1.5)}{(-3.3, 0)}{$1.5$};
	\dimline[label style={above, fill=none}, extension start length=0.2cm, extension end length=0.2cm] {(-3.3, 0)}{(-3.3, 1.5)}{$1.5$};

	\dimline[label style={below, fill=none}, extension start length=-0.5cm, extension end length=-0.5cm] {(-1.6+\hx, -1.8)}{(-0.8+\hx, -1.8)}{$x_1$};
	\dimline[label style={above, fill=none}, extension start length=0.7cm, extension end length=0.7cm] {(-1.6+\hx-0.8, -1.2+\h+\hy)}{(-1.6+\hx-0.8, -0.4+\h+\hy)}{$x_2$};
	\dimline[label style={above, fill=none}, extension start length=0.cm, extension end length=0.cm] {(-1.6+\hx-0.8, -0.4+\h+\hy)}{(-1.6+\hx-0.8, -0.)}{$w_1$};
	\node at (-1.6+\hx, -0.4+\h+\hy) {\tiny $+$};
	\node at (-1.6+\hx, -1.2+\h+\hy) {\tiny $+$};
	\node at (-0.8+\hx, -1.2+\h+\hy) {\tiny $+$};

	\dimline[label style={below, fill=none}, extension start length=-0.cm, extension end length=-0.9cm] {(-0.8+\hx, -1.8)}{(-0.4, -1.8)}{$x_3$};
	\dimline[label style={above, fill=none}, extension start length=0.cm, extension end length=0.7cm] {(-1.6+\hx-0.4, -1.2+\h+\hy)}{(-1.6+\hx-0.4, -0.8+\h)}{$x_4$};

	\node at (-0.4, -0.8+\h) {\tiny $+$};
	\node at (-1.2, -0.8+\h) {\tiny $+$};


	\begin{scope}[shift={(1, -3)}, rotate=20, scale=3]
		\draw[fill=gray!30] (0, 0) ellipse (0.2 and 0.24);
		\dimline[extension start length=-0.3cm, extension end length=-0.3cm] {(-0.2, -0.34)}{(0.2, -0.34)}{$x_5$};
		\dimline[extension start length=0.3cm, extension end length=0.3cm] {(-0.3, -0.24)}{(-0.3, 0.24)}{$x_6$};

		\draw[dashed, ] (0, 0) -- (0., 0.3) coordinate (mary);
		\draw[dashed, rotate around={-20:(0, 0)}] (0, 0) -- (0.3, 0) coordinate (bob);
		\coordinate (origo) at (0, 0);
		\pic[draw, -latex, "$x_7$", angle eccentricity=0.5] {angle = bob--origo--mary};
		\coordinate (p1) at (0, 0.24);
	\end{scope}

	% \draw[dashed, ultra thin] (p1) -- (1.5, -1.1);

	\begin{scope}[shift={(4, -3)}, rotate around={45:(0, 0)}, scale=3]
		\draw[fill=teal!50] (0, 0) ellipse (0.2 and 0.25);
		\dimline[extension start length=-0.3cm, extension end length=-0.3cm] {(-0.2, -0.35)}{(0.2, -0.35)}{$x_8$};
		\dimline[extension start length=0.3cm, extension end length=0.3cm] {(-0.3, -0.25)}{(-0.3, 0.25)}{$x_9$};

		\draw[dashed] (0, 0) -- (0., 0.3) coordinate (mary);
		\draw[dashed, rotate around={-45:(0, 0)}] (0, 0) -- (0.3, 0) coordinate (bob);
		\coordinate (origo) at (0, 0);
		\pic[draw, -latex, "$x_{10}$", angle eccentricity=0.5] {angle = bob--origo--mary};
	\end{scope}




\end{tikzpicture}

\end{document}

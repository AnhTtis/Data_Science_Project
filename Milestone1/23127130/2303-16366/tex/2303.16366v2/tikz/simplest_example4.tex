\resizebox{!}{4cm}{
\begin{tikzpicture}
\definecolor{darkturquoise}{rgb}{0.0, 0.81, 0.82}

\node[rectangle, rounded corners = 3mm, draw = black, minimum height = 0.6cm, fill =white] (m) at (0,0) {{User}}; 

\node[rectangle,  draw = black!60, fill = bleudefrance, minimum height = 1.2 cm, minimum width = 0.5cm, opacity=.5, text opacity=1 ,above right = -0.2 and 0.5 cm of m] (a) {\small $A$};

\node[rectangle,  draw = black!60, fill = green!50!black, minimum height = 0.5 cm, minimum width = 1.2 cm, opacity=.5, text opacity=1 , right = 0.1 cm of a.north east, anchor = north west] (b) {\small $B$};


\node[rectangle, rounded corners = 1mm, draw = black, minimum height = 0.6 cm, minimum width = 1 cm,  fill = white] (w2) at (-1.3,-3) {Server $2$};

\node[rectangle, rounded corners = 1mm, draw = black, minimum height = 0.6 cm, minimum width = 1 cm, fill = white, left = 1 cm of w2] (w1) {Server $1$};

\node[rectangle, rounded corners = 1mm, draw = black, minimum height = 0.6 cm, minimum width = 1 cm, fill = white, right = 1 cm of w2] (w3) {Server $3$};

\node[rectangle, rounded corners = 1mm, draw = black, minimum height = 0.6 cm, minimum width = 1 cm, fill = white, right = 1 cm of w3] (w4) {Server $4$};

% \node[minimum height = 0.45 cm, minimum width = 2cm, opacity=.5, text opacity=1, below = 0.1cm of w1] (a11) { \centering \small \uncover<4->{$h(1)=f(1)g(1)$} };

% \node[minimum height = 0.45 cm, minimum width = 0.6cm, opacity=.5, text opacity=1, below = 0.1cm of w2] (a22) { \centering \small \uncover<4->{$h(2)=f(2)g(2)$} };

% \node[minimum height = 0.45 cm, minimum width = 0.6cm, opacity=.5, text opacity=1, below = 0.1cm of w3] (a33) { \centering \small \uncover<4->{$h(3)=f(3)g(3)$} };
\uncover<2->{
\node[rectangle,  draw = black!60, fill = bleudefrance, minimum height = 0.3 cm, minimum width = 0.5 cm, opacity=.5, text opacity=1, below right = 0.1 and 0.25 cm of w1.south west, anchor = north west] (a11);

\node[rectangle,  draw = black!60, fill = bleudefrance, minimum height = 0.3 cm, minimum width = 0.5 cm, opacity=.5, text opacity=1, below right = 0.1 and 0.25 cm of w4.south west, anchor = north west] (a14);

%\node[rectangle,  draw = black!60, fill = green!50!black, minimum height = 0.5 cm, minimum width = 0.3 cm, opacity=.5, text opacity=1, right = 0.1 cm of a14.north east, anchor = north west] (b11) node[below = 0 of b11, color = green!50!black] (c11) {\begin{varwidth}{0.6cm} \centering \small $g(1)$ \end{varwidth}} %

\node[rectangle,  draw = black!60, fill = green!50!black, minimum height = 0.5 cm, minimum width = 0.3 cm, opacity=.5, text opacity=1, right = 0.1 cm of a11.north east, anchor = north west] (b11) node[below = 0 of b11, color = green!50!black] (c11) {\begin{varwidth}{0.6cm} \centering \small $g(0)$ \end{varwidth}} %
node[left = -0.2 of c11.west, anchor = east, color = bleudefrance] { \centering \small %\uncover<4->{ {\color{magenta}$h(0)=$}}
{\color{bleudefrance}$f(0)$}};
%node[left = 0.3 of c11.west, anchor = east, color = magenta] { \small ;

\node[rectangle,  draw = black!60, fill = bleudefrance, minimum height = 0.3 cm, minimum width = 0.5 cm, opacity=.5, text opacity=1, below right = 0.1 and 0.25 cm of w2.south west, anchor = north west] (a12);


\node[rectangle,  draw = black!60, fill = green!50!black, minimum height = 0.5 cm, minimum width = 0.3 cm, opacity=.5, text opacity=1, right = 0.1 cm of a12.north east, anchor = north west] (b12) node[below = 0 of b12, color = green!50!black] (c12) {\begin{varwidth}{0.6cm} \centering \small $g(\alpha^5)$ \end{varwidth}} %
node[left = -0.2 of c12.west, anchor = east, color = bleudefrance] { \centering \small %\uncover<4->{ {\color{magenta}$h(\alpha^5)=$}} 
{\color{bleudefrance}$f(\alpha^5)$}};;


\node[rectangle,  draw = black!60, fill = bleudefrance, minimum height = 0.3 cm, minimum width = 0.5 cm, opacity=.5, text opacity=1, below right = 0.1 and 0.25 cm of w3.south west, anchor = north west] (a13);

\node[rectangle,  draw = black!60, fill = green!50!black, minimum height = 0.5 cm, minimum width = 0.3 cm, opacity=.5, text opacity=1, right = 0.1 cm of a13.north east, anchor = north west] (b13) node[below = 0 of b13, color = green!50!black] (c13) {\begin{varwidth}{0.6cm} \centering \small $g(\alpha^{10})$ \end{varwidth}} %
node[left = -0.2 of c13.west, anchor = east, color = bleudefrance] { \centering \small %\uncover<4->{ {\color{magenta}$h(\alpha^{10})=$}} 
{\color{bleudefrance}$f(\alpha^{10})$}};;

\node[rectangle,  draw = black!60, fill = bleudefrance, minimum height = 0.3 cm, minimum width = 0.5 cm, opacity=.5, text opacity=1, below right = 0.1 and 0.25 cm of w4.south west, anchor = north west] (a14);
\node[rectangle,  draw = black!60, fill = green!50!black, minimum height = 0.5 cm, minimum width = 0.3 cm, opacity=.5, text opacity=1, right = 0.1 cm of a14.north east, anchor = north west] (b13) node[below = 0 of b13, color = green!50!black] (c13) {\begin{varwidth}{0.6cm} \centering \small $g(\alpha^{15})$ \end{varwidth}} %
node[left = -0.2 of c13.west, anchor = east, color = bleudefrance] { \centering \small %\uncover<4->{ {\color{magenta}$h(\alpha^{15})=$}} 
{\color{bleudefrance}$f(\alpha^{15})$}};;
}





\path<2-3>[<-]
(w1.north)  edge[bend left] node[above left = 0 cm and -1cm, midway, sloped, font=\small] {$f(0),g(0)$} (m)
[->]
(m) edge[bend right] node[right = -0.2cm, below=-0.05cm, midway, sloped, font=\small] {$f(\alpha^5),g(\alpha^5)$} (w2)
[<-]
(w3.north) edge[bend right] node[above right = 0 cm and -0.8cm, midway, sloped, font=\small] {$f(\alpha^{10}),g(\alpha^{10})$} (m)
[<-]
(w4.north) edge[bend right] node[above right = 0 cm and -0.8cm, midway, sloped, font=\small] {$f(\alpha^{15}),g(\alpha^{15})$} (m)
;
\path<4->[->, color = magenta]
(w1.north)  edge node[above left = 0 cm and -1cm, midway, sloped, font=\small] {$\tr(\alpha^{-1}h(0))$} (m)
[<-]
(m) edge node[right = -0.2cm, above=0.05cm, midway, sloped, font=\small] {$\tr(\alpha^{-2} h(\alpha^5))$} (w2)
[->]
(w3.north) edge node[above right = 0 cm and -0.8cm, midway, sloped, font=\small] {$\tr(\alpha^{-8} h(\alpha^{10}))$} (m)
[->]
(w4.north) edge node[above right = 0 cm and -0.8cm, midway, sloped, font=\small] {$\tr(\alpha^{-4} h(\alpha^{15}))$} (m)
;
\node<1->[left = 3.5 of m] (v) {$f(x)=A+R(x-\alpha)$};
\node<1->[below = 0 cm of v.south west, anchor = north west] (u)  {$g(x)=B+S(x-\alpha)$};
\end{tikzpicture}}
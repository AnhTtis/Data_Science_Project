\documentclass[11pt]{article}

\usepackage{microtype}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{booktabs} %
\usepackage{mathpazo}
\usepackage{pifont}
\usepackage{makecell}
\usepackage{tabularx}
\usepackage{pbox}

\usepackage{xcolor}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\pgfplotsset{compat=1.3}
\usepackage{tikz}
\usetikzlibrary{pgfplots.groupplots}
\usepackage{ragged2e}

\usepackage[toc,page,header]{appendix}
\usepackage{minitoc}
\renewcommand \thepart{}
\renewcommand \partname{}

\usepackage[colorlinks=true,linkcolor=blue,urlcolor=blue,citecolor=blue]{hyperref}
\usepackage{xspace}
\usepackage{bm}
\usepackage{comment}
\usepackage{caption}
\usepackage{makecell}

\captionsetup[table]{position=bottom}
\usepackage[natbib=true,style=alphabetic,minalphanames=3,maxbibnames=99,maxcitenames=2]{biblatex}
\addbibresource{bibliography/fmt_bib.bib}

\newcommand{\trak}{\textsc{trak}\xspace}
\newcommand{\mtfive}{mT5\xspace}
\newcommand{\tracin}{TracIn\xspace}
\newcommand{\tracincp}{TracInCP\xspace}
\newcommand{\clip}{\textsc{CLIP}\xspace}
\newcommand{\bert}{\textsc{BERT}\xspace}
\newcommand{\bertbase}{\textsc{BERT-base}\xspace}
\newcommand{\cifarten}{\textsc{CIFAR-10}\xspace}
\newcommand{\cifartwo}{\textsc{CIFAR-2}\xspace}
\newcommand{\cifar}{\textsc{CIFAR}\xspace}
\newcommand{\qnli}{\textsc{QNLI}\xspace}
\newcommand{\glue}{\textsc{GLUE}\xspace}
\newcommand{\mscoco}{\textsc{MS COCO}\xspace}
\newcommand{\gas}{\textsc{GAS}\xspace}
\newcommand{\modeldiff}{\textsc{ModelDiff}\xspace}
\newcommand{\ftracetrex}{\textsc{Ftrace-TREx}\xspace}
\newcommand{\trex}{\textsc{TREx}\xspace}
\newcommand{\ftracesynth}{\textsc{Ftrace-Synth}\xspace}
\newcommand{\xmark}{\ding{55}}%

\newcommand{\spelledout}{Tracing with the Randomly-projected After Kernel}
\newcommand{\thetastar}{\theta^\star}
\newcommand{\thetahat}{\widehat{\theta}}
\newcommand\TODO{\textcolor{red}{[TODO]}}
\newcommand\supp{\textsc{Support}}
\newcommand{\lr}[1]{\left({#1}\right)}
\newcommand\reinfl[2]{\textsc{Greenies}_p\left[#1 \to #2\right]}

\renewcommand{\hat}[1]{\widehat{#1}}
\newcommand{\ind}[1]{\bm{1}\{{#1}\}}
\newcommand{\modeleval}[2]{f({#1};{#2})}
\newcommand{\modelevalbin}[2]{f_{\text{bin}}({#1};{#2})}
\newcommand{\modelevalbinempty}{f_{\text{bin}}}
\newcommand{\modelevalmc}[2]{f_{\text{mc}}({#1};{#2})}
\newcommand{\modelevalmcempty}{f_{\text{bin}}}
\newcommand{\approxmodeleval}[2]{\hat{f}({#1};{#2})}
\newcommand{\estmodeleval}[2]{\widehat{f}_{\mathcal{A}}({#1};{#2})}
\newcommand{\mask}[1]{\bm{1}_{#1}}
\newcommand{\parmap}[1]{g_{\theta}(#1)}
\newcommand{\grad}{g}
\newcommand{\projgrad}{\phi}
\newcommand{\loss}[1]{L(#1; \theta)}
\newcommand{\lossstar}[1]{L(#1; \thetastar)}
\newcommand{\imagemb}[1]{\phi(#1; \theta)}
\newcommand{\textemb}[1]{\psi(#1; \theta)}

\newlength\myindent
\setlength\myindent{2em}
\newcommand\bindent{%
  \begingroup
  \setlength{\itemindent}{\myindent}
  \addtolength{\algorithmicindent}{\myindent}
}
\newcommand\eindent{\endgroup}

\input{editor}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{thmtools}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage[T1]{fontenc}
\usepackage{color}

\usepackage[capitalize,noabbrev]{cleveref}

\definecolor{mydarkblue}{rgb}{0,0.08,0.85}
\definecolor{mylightblue}{rgb}{0.06,0.56,1.0}
\definecolor{mylightorange}{rgb}{1.0,0.62,0.12}
\definecolor{mylightred}{rgb}{0.99,0.00,0.04}
\hypersetup{colorlinks=true,
linkcolor=mydarkblue,
citecolor=mydarkblue,
filecolor=mydarkblue,
urlcolor=mydarkblue,
bookmarksopen=true,
linktoc=page}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{remark}[theorem]{Remark}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{example}[theorem]{Example}
\theoremstyle{remark}

\usepackage{marginnote}
\newcommand{\todo}[1]{\marginnote{\color{red} #1}}
\newcommand{\oftodo}[2]{\marginnote{\color{red} #2}[#1]}

\title{TRAK: Attributing Model Behavior at Scale}
\author{
\normalsize
Sung Min Park\footnote{Equal contribution.},\ \,Kristian Georgiev\footnotemark[1],\ \,Andrew Ilyas\footnotemark[1],\
\,Guillaume Leclerc, Aleksander M\k{a}dry \\
\normalsize MIT\\
\texttt{\{sp765,krisgrg,ailyas,leclerc,madry\}@mit.edu}}

\date{}

\makeatletter
\let\c@figure\c@table
\makeatother
\begin{document}
\setcounter{tocdepth}{2}
\doparttoc %
\renewcommand\ptctitle{}
\faketableofcontents %

\maketitle
\begin{abstract}
  \input{sections/abstract}
\end{abstract}

\section{Introduction}
\input{sections/new_intro}

\section{Motivation and Setup}
\label{sec:prelim}
\input{sections/prelim}

\section{\trak: Tracing with the Randomly-Projected After Kernel}
\label{sec:method}
\input{sections/method}

\section{Evaluating \trak}
\label{sec:eval}
\input{sections/evaluation}

\section{Applications of \trak}
\input{sections/applications}
\input{sections/clip}
\input{sections/nlp}
\input{sections/modeldiff}

\section{Related work}
\label{sec:related}
\input{sections/related}

\section{Discussion \& Conclusion}
\input{sections/discussion}


\clearpage
\section*{Acknowledgements}
We thank Ekin Akyurek for help 
installing and using the \ftracetrex benchmark.

Work supported in part by the NSF grants CNS-1815221 and DMS-2134108, and Open Philanthropy. This material is based upon work supported by the Defense Advanced Research Projects Agency (DARPA) under Contract No. HR001120C0015.

Research was sponsored by the United States Air Force Research Laboratory and the United States Air Force Artificial Intelligence Accelerator and was accomplished under Cooperative Agreement Number FA8750-19-2-1000. The views and conclusions contained in this document are those of the authors and should not be interpreted as representing the official policies, either expressed or implied, of the United States Air Force or the U.S. Government. The U.S. Government is authorized to reproduce and distribute reprints for Government purposes notwithstanding any copyright notation herein.

\printbibliography

\clearpage
\appendix
\addcontentsline{toc}{section}{Appendix} %
\renewcommand\ptctitle{Appendices}
\part{}
\parttoc
\clearpage

\counterwithin{figure}{section}
\counterwithin{table}{section}
\counterwithin{algorithm}{section}


\section{Experimental Setup}
\label{app:exp_setup}
\input{appendices/setup}

\clearpage
\section{\trak implementation}
\label{app:impl}
\input{appendices/implementation}

\clearpage
\section{Theoretical Justification}
\label{app:theory_extra}
\input{appendices/design}

\clearpage
\section{Additional Results}
\label{app:more_results}
\input{appendices/more_results}


\clearpage
\section{Ablation Studies}
\label{app:more_ablation}
\input{appendices/ablation}


\clearpage
\section{Fact Tracing}
\label{app:lexical}
\input{appendices/nlp_discussion.tex}


\clearpage
\section{Future Work}
\label{app:future_work}
\input{appendices/future_work.tex}




\end{document}

\documentclass{optica-article}
\journal{oe}
\articletype{Research Article}


\input{extra/preamble.tex}
\input{extra/glossaries.tex}

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}

%\usepackage{lineno}
%\linenumbers
%\pagenumbering{roman}
\pagenumbering{arabic}

\begin{document}

\title{The ImSPOC snapshot imaging spectrometer: image formation model and device characterization}
	
	%Physical Modeling of the ImSPOC Concept, a Snapshot Fabry-Perot Interferometry-based Spectro Imaging System}

\author{
	Daniele Picone,\authormark{1,2}\,\orcidlink{0000-0002-0226-8399}
	Silv\`{e}re Gousset,\authormark{1}\,\orcidlink{0000-0003-3106-8262}
	Mauro Dalla Mura,\authormark{2,3,*}\,\orcidlink{0000-0002-9656-9087}
	Yann Ferrec,\authormark{4}\,\orcidlink{0000-0002-8361-5398}
	and
	\'{E}tienne le Coarer\authormark{1}\,\orcidlink{0000-0001-6571-5494}
}

\address{
	\authormark{1} Univ. Grenoble Alpes, CNRS, Grenoble INP, IPAG,
	38000 Grenoble, France\\
	\authormark{2} Univ. Grenoble Alpes, CNRS, Inria, Grenoble INP, GIPSA-lab,
	38000 Grenoble, France\\
	\authormark{3} Institut Universitaire de France (IUF)\\
	\authormark{4} ONERA/DOTA, BP 80100, chemin de la Huni\`{e}re, FR-91123 Palaiseau
}
\email{\authormark{*}mauro.dalla-mura@grenoble-inp.fr}

\begin{abstract}
In recent years, the demand for capturing spectral information with finer detail has increased, requiring hyperspectral imaging devices capable of acquiring the required information with increased temporal, spatial and spectral resolution. In this work, we present the image acquisition model of the \gls{imspoc}, a novel compact snapshot image spectrometer based on the interferometry of Fabry-Perot. Additionally, we propose the \gls{irca}, a robust three-step procedure to characterize the \gls{imspoc} device that estimates the optical parameters of the composing interferometers' transfer function. The proposed algorithm processes the image output from a set of monochromatic light sources, refining the results through nonlinear regression after an ad-hoc initialization. Experimental analysis confirms the performances of the proposed approach for the characterization of 4 different \gls{imspoc} prototypes. The source code associated to this paper is available at \href{https://github.com/danaroth83/irca}{https://github.com/danaroth83/irca}.
\end{abstract}

\glsresetall

\section{Introduction}
\label{sec:intro} 
    
    In recent years, \gls{hs} image spectrometers are gathering increasing interest to capture the spectral information of the scene under target with finer spectral resolutions~\cite{Eism12}. This characteristic can be exploited for various user end applications in many fields, such as astronomy, precision agriculture, molecular biology, biomedical imaging, geosciences, physics, and surveillance~\cite{Till07, BenD09, Adam10, Kim17}. In particular, the need for accurate measurements of gases in the atmosphere is ever increasing for tasks as monitoring climate change and air quality study and regulation issues~\cite{Gous19}.
   	
   	%Following this trend, novel technologies are being explored in scientific and commercial venues for the manufacture of novel \gls{hs} imaging systems in order to overcome the limitations of currently available commercial devices. Such improvements involve increasing the spectral or spatial resolution of the user-end image datacube, the richness of the information for specific application, the user friendliness, or reducing the cost, the acquisition time, the dimensions and weight of the camera.  
   	
   	In this paper, we present and characterize the optical devices based on the so-called \textit{\gls{imspoc}} concept~\cite{Gous17,Gous18,Gous19,Ferr18}. \Gls{imspoc} refers to a family of miniaturized and low-cost snapshot image spectrometers based on the interferometry of \gls{fp}. Its spectral resolution aims to be comparable to more traditional devices, such as those based on temporal scanning through diffraction grating~\cite{Bouy18} or dispersion based hyperspectral cameras ($\sim$ 5--10 \si{nm}). 
   	%
   	In this work, the image formation model of the \gls{imspoc} prototypes is formalized rigorously: we briefly recall the derivation of the spectral response of a Fabry-Perot resonator, defining the parameters of interest in the generic case of an integer amount of emerging waves of decreasing optical intensity.
   	%
   	We furthermore propose a general procedure for the parametric characterization of the instrument, divided into a measurement session, where the device is illuminated with a set of flat field monochromatic sources, and the \gls{irca}, a computational procedure to infer the parameters of the system.
   	
   	The proposed \gls{irca} is originally designed to be applied to \gls{imspoc} devices, as their response can be well modeled as the Airy distribution~\cite{Isma16} and described in terms of the \gls{opd}, reflectivity, gain, and phase shift.
   	
   	However, the \gls{irca} can be also potentially applied to characterize and regularly update the calibration of any device whose response can be modeled as that of a \gls{fp} interferometer. For example, it could be potentially applied to compressive imagers~\cite{Oikn18, Oikn18a}, or hyperspectral imaging systems with dielectric mirrors~\cite{Pisa09, Zucc14}. Additional conditions of robustness apply if complementary information is available (e.g., flat field, spatial/temporal redundancy).
   	
   	The \gls{irca} is defined by a three step procedure: the overall optical gain is firstly addressed discarding any interferometric effect, then a first rough assessment of the remaining parameters is performed by casting the problem as a \gls{ml} estimation of the characteristics of a sinusoidal signal. The estimation is finally refined by casting the problem as a nonlinear regression and solving it with the \gls{lm} algorithm~\cite{More78}. 
   	The nonlinear regression approach was also employed in other works~\cite{Hasa18}, but we focus our attention here on providing a robust solution for optical devices whose sensors are particularly sensitive to noise, as the different parameters are made separable by imposing that their polynomial expression in terms of wavelength has a limited degree.
   	
   	To summarize, the novel contributions of this work are:
   	\begin{enumerate}
   		\item we rigorously formalize the image formation principle of an  \gls{imspoc} system (interferometers, lenslet, etc.), formulating the different regimes of finesse within one single framework;
   		\item we develop the \gls{irca}, a procedure for the estimation of parameters for transfer responses of devices operating as \glsentrylong{fp} interferometers;
   		\item we propose an experimental procedure of \gls{imspoc} characterization, using monochromatic sources. We test the effectiveness of the proposed method on real acquisitions from four \gls{imspoc} prototypes with different characteristics.
   	\end{enumerate}
   
    \input{gfx/concept.tex}
   	
   	The article is organized as follows: in Section~\ref{sec:imspoc} we describe the operating principle of \gls{imspoc} and its image formation model in Section~\ref{sec:formation}. Section~\ref{sec:characterization} describes the proposed spectral characterization setup and estimation algorithm, and in Section~\ref{sec:experiments} we evaluate its performances and discuss its results in comparison with the physics of the devices.
   	
\section{The \texorpdfstring{\glsfirst{imspoc}}{image spectrometer on chip (ImSPOC)} concept}
\label{sec:imspoc}

	\subsection{Operating principle}
   	\label{ssec:imspoc_intro}
   	
   		\input{gfx/imspoc_example.tex}
   		
   		\Gls{imspoc} describes a concept for a novel image spectrometer (see \figurename~\ref{fig:concept}), whose patent was deposited in 2018~\cite{Guer18}. The concept defines a miniaturized snapshot acquisition system for \gls{hs} imagery, whose optical design consists of a matrix of micro-lenses and a staircase-shaped optical plate, superposed to a focal plane.
   		Each step of the staircase pattern is made of a \gls{fp} interferometer and of an associated micro-lens, whose \textit{division of aperture} allows to capture multiple subimages over their own assigned surfaces on the focal plane. \figurename~\ref{fig:concept_imspoc} shows the cross-section view of the optical design for such a system without a front afocal lens. In this design, the interferometers are cavities carved within a glass optical plate and coated with a reflective surface in titanium dioxide \chem{TiO_2}. An external spectral filter can be also installed to limit the input wavenumber range of the device for certain applications (e.g. for \chem{NO_2} gas detection~\cite{Dole21}).
	   	
	   	An example of acquisition is shown in \figurename~\ref{fig:example}, which also showcases the division of aperture principle. We artificially highlighted the separation between different subimages associated to interferometers on the staircase matrix and assigned them indices in increasing order of nominal thickness. The subimages can be interpreted as a modulation of the input spectrum of the scene by the specific spectral responses of each interferometer, capturing replicas of the scene with different characteristics.
	   	
	   	The set of readings across the different subimages (i.e., the orange dots in the acquisition) represents a sampled version of a continuous interferogram (portrayed with a black background), associated to the spectrum of the portion of the scene at a specific solid angle~\footnote{Following the literature of \glsentrylongpl{fts}, in this work the spectra are expressed in terms of wavenumbers $\sigma$, that is as the reciprocal of the wavelengths (e.g., a wavelength of 500 \si{nm} corresponds to $\sigma=2\times 10^4$ \si{cm^{-1}})}.
	   	
	   	\input{gfx/opd_shift}
	    
	    \subsection{Motivation of the work}
	    \label{ssec:imspoc_motivation}
	    
	    The manufacture of an \gls{imspoc} device follows a series of design choices, which aim to satisfy the requirements of the user application. It is however necessary, especially for initial prototypes, to verify that the optical transformations performed by the real device follow, within a certain degree of accuracy, the desired behavior.
	    Furthermore, it is often necessary to calibrate the instrument at regular intervals, to ensure that this behavior is kept even if some of its physical characteristics have deviated in time. 
	    Both case scenarios highly benefits from a standardized procedure, which we aim to detail in this work.
	    
	    
	    %the importance of the characterization is not only limited to mere quality control, but it also has important consequences if viewed as a typical \textit{computational imaging} problem~\cite{Mait18}. As the observation is captured in a domain other than the one requested by the final user, i.e. the \gls{opd}, the acquisition has to be processed with dedicated algorithms to recover the desired product, i.e. the incident light field spectrum and the associated image.
	    The characterization is also often a necessary step for several techniques of spectrum reconstruction. For example, it is often required to accurately know where the interferogram samples are located with respect of the \gls{opd} axis. 
	    The interferometers' thicknesses are typically designed with a constant step size, so that the interferogram may be regularly sampled (\figurename~\ref{fig:opd_shift_regular}). However, due to the limited accuracy in either manufacturing or assembling the various device parts, this is not the case in most practical scenarios. 
	    If this information is not taken into account, the interferogram samples are then placed incorrectly in the \gls{opd} domain (\figurename~\ref{fig:opd_shift_irregular}) and the quality of the reconstructed spectra strongly degrades. 
	    
	    \input{tables/variables.tex}

\section{\Glsentryshort{imspoc} image formation model}
\label{sec:formation}

	In this section, we describe the image formation model of \gls{imspoc}; we first provide an overall analysis of the optical transfer of the components at play in Section~\ref{ssec:formation_optical}, detailing the one for \gls{fp} interferometers in Section~\ref{ssec:formation_fabry_perot}.
	
	For the reader convenience, the variables used in this paper are shown in \tablename~\ref{tab:variables}, separated into variables for the continuous image formation model, for its parameters, for the acquisition vectors and the vector sizes. These variables will be formerly introduced when relevant to the discussion. 
	
	
	\subsection{Optical transfer model}
	\label{ssec:formation_optical}
	
		In order to define the transfer function from incident light to the sensors' readout, we refer to a single couple interferometer/lens, as shown in \figurename~\ref{fig:formation_focusing}.
		
		If the target source is at the far field, the $k$-th \gls{fp} cavity acts as a spectral filter, whose transfer function $\mathcal{T}_k(\sigma, \bm{\omega})$ varies only with the angle of incidence $\bm{\omega}$ and the wavenumbers $\sigma$. At the focal plane, assuming no crosstalk in the formation of each subimage, the spectral flux $\Phi_{jk}(\sigma)$ received by the $j$-th sensor (i.e. a photodetector) is only due to incident light within a given $k$-th interferometer. Its expression is given by:
		\begin{equation}
			\Phi_{jk}(\sigma) = \int \mathcal{T}_k\left(\sigma,\,\mathbf{s}\right)\mathcal{L}\left(\sigma, \mathbf{s}\right)\;d\mathcal{G}\,,
			\label{eq:flux}
		\end{equation}
		where $\mathcal{L}(\sigma, \omega)$ denotes the spectral radiance of the incident light, $d\mathcal{G}$ the geometric etendue subtended by the surface of the $j$-th photodetector and the exit pupil associated to the $k$-th microlens, and $\mathbf{s}$ are the coordinates that span over the surface of the $j$-th photodetector. In the above expression, the dependency of $\mathcal{L}$ and $\mathcal{T}$ by $\omega$ is shown as a dependency by $\mathbf{s}$, as those are equivalent if the microlens behaves as an ideal thin lens. 
		
		If we then assume that this etendue is constant across the given pixel, the expression of the flux becomes:
		\begin{equation}
			\Phi_{jk}(\sigma) = {S_k} \iint\limits_{\Omega_j}\mathcal{T}_k\left(\sigma,\,\bm{\omega}\right) \mathcal{L}\left(\sigma,\,\bm{\omega}\right) n_0\cos\theta^{[i]} \,d\bm{\omega}\,,
			\label{eq:flux_etendue}
		\end{equation}
		where $\Omega_j$ is the solid angle of incident rays that focus over the $j$-th sensor, $S_k$ is the surface of the entrance pupil associated to the $k$-th interferometer, while $\theta^{[i]}$ is the polar component of the incident angle $\bm{\omega}$. The term $\mathcal{T}_k(\sigma,\bm{\omega})$ is the attenuation of the radiant flux within the $k$-th interferometer and can be modeled as a generic Airy distribution as detailed in the next section.

		Finally, we model the intensity level $x_{jk}$ captured by the photodetector as:
		\begin{equation}
			x_{jk}=\Delta t\int\limits_{\sigma_{min}}^{\sigma_{max}}\Phi_{jk}(\sigma)\,\xi(\sigma)\,\eta_j(\sigma)\,d\sigma\,,
			\label{eq:intensity}
		\end{equation} 
		where $[\sigma_{min}, \sigma_{max}]$ is the bandwidth of the instrument, $\eta_j(\sigma)$ denotes the quantum efficiency of the $j$-th sensor, $\xi(\sigma)$ denotes the spectral response of the accessory elements of the optical system (entry filter, leading optics, etc.), and $\Delta t$ denotes the integration time.
	
		\input{gfx/formation.tex}
	        
	\subsection{\texorpdfstring{\Glsentrylong{fp}}{Fabry-Perot} wave models}
	\label{ssec:formation_fabry_perot}
	
        We briefly recall here the expression of the Airy distribution, in order to explicit the term $\mathcal{T}_k(\sigma,\bm{\omega})$ from eq.~\ref{eq:flux_etendue}.
        Let us consider a monochromatic plane wave with complex amplitude $\mathbf{E}^{[i]}(\sigma)$ incident to the \gls{fp} interferometer, forming an angle $\theta^{[i]}$ with the normal to the incident plane.
        The complex amplitude $\mathbf{E}^{[o]}$  of the transmitted light can be seen as a sum of the set of $W\rightarrow\infty$ subsequent emerging waves $\{\mathbf{E}_m\}_{\range{m}{0}{W-1}}$. Each emerging wave introduces a fixed round trip phase difference: 
        \begin{equation}
        	\varphi=2\pi\delta\sigma-\varphi_0^{}\,,
        \end{equation}
    	where $\varphi_0^{}$ defines a constant phase shift and $\delta$ defines the \gls{opd} between two consecutive emerging wave.
        A visual representation of the \gls{opd} is shown in \figurename~\ref{fig:formation_fabry_perot}, where it is identifiable as the difference in the round trip inner reflection (in green) and the direct transmission path. By making use of Snell's law, simple geometry manipulations yield:
        \begin{equation}
        	\delta=
        	n\frac{2d_k}{\cos\theta}-n^{}_0(2d_k\tan\theta\sin\theta^{[o]})=
        	n\left(\frac{2d_k}{\cos\theta}-2d_k\tan\theta\sin\theta\right)=
        	2nd_k\cos\theta\,,
        	\label{eq:opd_fabry_perot}
        \end{equation}
        where $d_k$ denotes the thickness of the $k$-th \gls{fp} cavity, while $n$ and $\theta$ are the refractive index and the reflection angle within the cavity, respectively.
        
       	We then define the transfer function $\mathcal{T}_k(\sigma, \bm{\omega})$ due to the \gls{fp} interferometer as the ratio between the output and input irradiance, obtaining, for $W$ emerging waves:
        
        \begin{equation}
        		\mathcal{T}^{[W]}_k:=\left\lvert\frac{\mathbf{E}^{[o]}(\sigma)}{\mathbf{E}^{[i]}(\sigma)}\right\rvert^2=
        		(1-\mathcal{R})^2\left\lvert\sum_{m=0}^{W-1}\left(\mathcal{R}\;e^{-j\varphi}\right)^m\right\rvert^2 =
        		(1-\mathcal{R})^2\left\lvert\frac{1-\mathcal{R}^{W}e^{-jW\varphi}}{1-\mathcal{R}e^{-j\varphi}}\right\rvert^2\,,
        	\label{eq:airy_definition}
        \end{equation}
        where $\mathcal{R}$ is the surface reflectivity, and the resulting term $(1-\mathcal{R})^2$ is due to the direct transmission through the cavity.
        
       	We specify the above expression for $2$, $W\ge0$ and $\infty$ waves, in order to describe the interferometer under different regimes of finesse:
       	\begin{subequations}
       		\begin{align}
       			\mathcal{T}_k^{[2]}(\sigma, \bm{\omega})&=\left(1+\mathcal{R}^2+2\mathcal{R}\cos\varphi\right)(1-\mathcal{R})^2\,,&\textrm{2 waves}\,,	\label{eq:airy_1}\\
       			\mathcal{T}_k^{[W]}(\sigma, \bm{\omega})&=\frac{1+\mathcal{R}^{2W}-2\mathcal{R}^{W}\cos(W\varphi)}{1+\mathcal{R}^2-2\mathcal{R}\cos\varphi}(1-\mathcal{R})^2\,,&\textrm{W waves}\,,\label{eq:airy_2}\\
       			\mathcal{T}_k^{[\infty]}(\sigma, \bm{\omega})&=\frac{(1-\mathcal{R})^2}{(1-\mathcal{R})^2+4\mathcal{R}\sin^2(\varphi/2)}\,,&\textrm{$\infty$ waves}\,,\label{eq:airy_3}
       		\end{align}
       		\label{eq:airy}
       	\end{subequations}
       	and $\mathcal{T}_k^{[\infty]}(\sigma)=\lim_{W\rightarrow\infty}\mathcal{T}^{[W]}_k(\sigma)$ is known as the \textit{Airy distribution}~\cite{Isma16}. 
       	For our purposes, it is also convenient to scale the expression $\mathcal{T}_k^{[W]}$ of  eq.~\eqref{eq:airy} such that the mean of the scaled expression $\overline{\mathcal{T}}_k^{[W]}$ is equal to one:
       	\begin{equation}
       		\overline{\mathcal{T}}_k^{[W]}(\sigma,\bm{\omega})=\frac{1+\mathcal{R}}{(1-\mathcal{R}^{2W})(1-\mathcal{R})}\mathcal{T}_k^{[W]}(\sigma, \bm{\omega})\;.
       		\label{eq:norm}
       	\end{equation}
       	
       	Its expression from eq.~\eqref{eq:airy_3} varies only slightly with the angle of incidence $\theta^{[i]}$, as the \gls{fov} is designed to be relatively limited (e.g., below $0.2\pi$ \si{rad}).
       	However, it strongly varies with the wavenumber $\sigma$; assuming all the other parameters  are constant, the explicit dependency from $\sigma$ is given through $\phi$ and shown in \figurename~\ref{fig:formation_finesse} with all the remaining ones set as constants.
       	The peaks are more spaced out if the thicknesses $d_k$ of the interferometer are large, which causes the different filtering effect of \figurename~\ref{fig:example}. For low finesse devices (that is with low surface reflectivity), this spectral response resembles a pure sinusoid, allowing for higher throughput and consequently higher \gls{snr} captured by the sensors.
       	Eq.~\eqref{eq:airy_3} also has an implied dependency from $\sigma$ within the reflectivity $\mathcal{R}(\sigma)$ and through the refractive index $n(\sigma)$, to be taken in account for the spectral characterization of the device.
       	
       	\subsection{Proposed formulation of the model}
       	\label{ssec:characterization_problem}
       	
       	In order to characterize the overall spectral response of the instrument at a given pixel, the physical acquisition model employed from eq.~\ref{eq:flux_etendue} may be simplified, assuming the optical transfer function is roughly constant within the targeted solid angle $\Omega_j$ and $\cos(\theta)=1$, resulting in:
       	\begin{equation}
       		x_{jk}=\int\limits_{\sigma_{min}}^{\sigma_{max}}T_{\bm{\beta}}\left(\sigma\right)\left(\iint\limits_{\Omega_{j}} \mathcal{L}(\sigma,\,\bm{\omega})\,d\bm{\omega}\right)\,d\sigma\,.
       		\label{eq:intensity_simple}
       	\end{equation}
       	Here, $T_{\bm{\beta}}(\sigma)$ models the spectral response of the instrument associated to a given pixel on the \gls{fpa}. For convenience, it is useful to describe it in terms of the expression of eq.~\eqref{eq:norm}:
       	\begin{equation}
       		T_{\bm{\beta}}(\sigma) = \mathcal{A}(\sigma)\overline{\mathcal{T}}^{[W]}(\sigma,\bm{\omega}_j)
       		\label{eq:transfer_function}
       	\end{equation}
       	where we defined a gain variable:
       	\begin{equation} 					 	\mathcal{A}(\sigma):=\xi(\sigma)\eta_j(\sigma)S_k\Omega_j\frac{1+\mathcal{R}(\sigma)}{(1-\mathcal{R}^{2W}(\sigma))(1-\mathcal{R}(\sigma))}\;,
       	\end{equation}
       	which incorporates all the multiplicative terms from eq.s~\eqref{eq:flux_etendue} and \eqref{eq:intensity}, while $\bm{\omega}_j$ is the centroid of the solid angle $\Omega_j$. The transfer function is written in its scalar form so that the the mean value with respect to $\sigma$ of $T_\beta(\sigma)$ is equal to that of $\mathcal{A}(\sigma)$.		
       	By substituting the value of $W$, equivalent expressions can be derived from eq.~\eqref{eq:airy} for $2$ and $\infty$ waves.
       	
       	The set of values $[\mathcal{A}(\sigma),\,\mathcal{R}(\sigma), \delta,\,\varphi_0]$ allow for a full description of $T_{\bm{\beta}}$.
       	$\mathcal{A}(\sigma)$ and $\mathcal{R}(\sigma)$ are strongly coupled in the expression~\eqref{eq:transfer_function}; in order for their contribution to be separable, we assume that they are slowly varying with $\sigma$ and limit their models to polynomials of limited degree $N_d$. 
       	In other terms, we consider that $\mathcal{A}(\sigma)$ and $\mathcal{R}(\sigma)$ are in the form:
       	\begin{equation}
       		\mathcal{A}(\sigma)=\sum_{m=0}^{N_d} a_m\sigma^m\,,\;\;\;\;\;\;\;\;\;\;\;\;\mathcal{R}(\sigma)=\sum_{m=0}^{N_d}r_m\sigma^m\,.\label{eq:polynomial}
       	\end{equation}
       	
       	The \gls{opd} value $\delta$ is assumed to be constant with the wavelength $\sigma$ as the rays interfer within the air in the prototypes under test (\figurename~\ref{fig:concept_imspoc}). This assumption is extended to the phase shift $\varphi^{}_0$ in order to simplify the computation. Our goal then summarizes to find an estimation $\hat{\bm{\beta}}$ of the $2N_d+4$ elements of  $\bm{\beta}=\left[a_0\,,...,\,a_{N_d},\,r_0\,,...,\,r_{N_d},\,\delta,\,\varphi_0^{}\right]$ allowing to approximate the transfer function $T_{\bm{\beta}}$ as accurately as possible.
       	
       	In the next section, we describe the calibration setup that was employed in this study to acquire an observation vector $\mathbf{y}$ of  $N_a$ noisy acquisitions $\mathbf{y}=\{y_i\}_{\range{i}{1}{N_a}}$ at given wavenumber values $\bm{\sigma}=\{\sigma_i\}_{\range{i}{1}{N_a}}$, that we use to formalize our problem as a \gls{mse} minimization.
       	
       	% \input{gfx/fabry_perot.tex}

\section{Proposed characterization procedure}
\label{sec:characterization}

	In this section, we present the proposed procedure for the spectral characterization of \gls{fp} interferometers. Specifically, we describe the problem in more formal terms in Section~\ref{ssec:characterization_problem} the calibration setup in Section~\ref{ssec:characterization_setup}. Finally, we provide an overview of the proposed algorithm in Section~\ref{ssec:characterization_overview}, detailing each step in the subsequent sections.

	\subsection{Measurement setup for \glsentryshort{imspoc} characterization}
	\label{ssec:characterization_setup}
	
		\input{gfx/experimental_setup.tex}
		
		 In order to characterize a given device under test, a certain set of observations from reference sources have to be taken under controlled conditions, so that the transfer function can be inferred.
		 Perhaps the most straightforward approach consists in a flat field illumination of the device with a set of monochromatic incident spectra with given central wavenumbers.
		 In fact, according to eq.~\eqref{eq:intensity_simple}, this is equivalent to take $N_a$ acquisitions $\mathbf{y}\in\mathbb{R}^{N_a}$, whose expected values are samples of $T_{\bm{\beta}}(\sigma)$ evaluated for the set of wavenumbers $\bm{\sigma}\in\mathbb{R}^{N_a}$.
		 The measurement setup is shown in \figurename~\ref{fig:experimental_setup}; it is composed by a wideband lamp, acting as light source, whose incident light is filtered by a monochromator (i.e., based on diffraction grating). The sharply impulsive output spectrum, whose bandwidth is lower than the spectral resolution of the filter, is diffused uniformly through an integrating sphere. The monochromator is tunable to select a sequence of central wavenumbers and the device under test captures an image for each of these illuminations. An external spectrometer or a probe is used to measure the incident power of the instrument; its value is used to equalize the energy of all the acquired images across different wavenumbers, after its background level is set to zero.
		 The vector $\mathbf{y}$ is finally extracted by slicing the datacube of acquisition at the spatial position that corresponds to the pixel to characterize. Roughly, the problem is then equivalent to find the estimation $\hat{\bm{\beta}}$ of the vector of parameters minimizing a cost function such as:
		 \begin{equation}
		 	\hat{\bm{\beta}}=\arg\min_{\bm{\beta}}\sum_{i=1}^{N_a} \left(T_{\bm{\beta}}(\sigma_i)-y_i\right)^2\;.
		 	\label{eq:cost}
		 \end{equation}
	
	\subsection{Overview of the \glsreset{irca}\gls{irca}}
	\label{ssec:characterization_overview}
		
		% \textcolor{red}{Refer to Tarantola's book to call it as model identification~\cite{Tara05}}
	
		Solving eq.~\eqref{eq:cost} is a particularly challenging problem, due to the nonlinear dependency of $T_{\bm{\beta}}$ from the parameters $\bm{\beta}$. The available tools for solving nonlinear regression methods are particularly sensitive to converging to non-local maxima~\cite{Rusz06}, so that a proper initialization is critical to produce an accurate parametrization of the optical system.
		
		Therefore, the proposed \glsreset{irca}\gls{irca} consists of three steps, which are depicted in \figurename~\ref{fig:algorithm}. The algorithm exploits different sufficient statistics of the set of $N_a$ acquisitions captured by the measurement setup to improve the overall robustness of the final result:
		\begin{itemize}
			\item The \textbf{gain estimation} step provides an initial approximation of the gain coefficients  $\{\hat{a}_i\}_{\range{i}{0}{N_d}}$ of $\mathcal{A}(\sigma)$. This result is obtained by processing the vector $\mathbf{w}\in{\mathbb{R}^{N_a}}$, which represents a \textit{flat field statistic}. The vector $\mathbf{w}$ is supposed to represent the response of the pixel under test if the matrix of interferometers was stripped away from the device. However, as this operation is not always possible, we assume it to represent a given percentile from the raw acquisition evaluated over the whole focal plane. In fact, the global response of the image naturally dampens the oscillations of the interferometric fringes;
			\item The \textbf{\glsreset{ml}\gls{ml} initialization} returns an approximate estimation $\left[\hat{\delta},\,\hat{r}_0,\,\hat{\varphi}_0\right]$ of the remaining parameters (\gls{opd}, reflectivity and phase shift, respectively); at this stage, those parameters are assumed to be constant with the wavenumbers. This step processes the vector $\mathbf{u}\in\mathbb{R}^{N_a}$, which we define as the \textit{mean over neighbors}. This is simply obtained by taking the spatial average of each acquisition within a window around the target pixel. The intrinsic effect of noise dampening is not strictly necessary, but improves the robustness of the algorithm.
			\item In the \textbf{\glsreset{gn}\gls{gn}} step, the final estimation $\hat{\bm{\beta}}$ of the desired parameters is obtained with the  \gls{lm} algorithm~\cite{More78}. In this stage, we process the raw acquisition vector $\textbf{y}$ in order to solve eq.~\eqref{eq:cost}. The estimation is refined with a sequence of iterations, after it is initialized with the vector $\bm{\beta}^{[0]}$ of the parameters inferred in the previous steps.
		\end{itemize}
	
	    \input{gfx/algorithm.tex}
		
		The following sections describe each of these algorithm in further detail.
	
	\subsection{Step 1: Gain estimation}
	\label{ssec:characterization_gain}
	
		The gain estimation step aims at a preliminary estimation of the vector $\hat{\mathbf{a}}=\{\hat{a}_m\}_{\range{m}{0}{N_d}}$, whose elements describe the coefficients of the polynomial representation $\hat{\mathcal{A}}(\sigma)=\sum_{m=0}^{N_d}\hat{a}_m\sigma^m$ of the gain $\mathcal{A}(\sigma)$. The operation is modeled as a nonlinear regression, where the coefficients are updated iteratively to fit the given vector $\mathbf{w}=\{w_i\}_{\range{i}{1}{N_a}}$ representing the overall flat field intensity of the set of acquisitions.
		In mathematical terms, the problem is formalized as follows:
		\begin{equation}
			\hat{\mathbf{a}}=\arg\min_{\mathbf{a}}\sum_{i=1}^{N_a}(\mathcal{A}(\sigma_i)-w_i)^2\,.
			\label{eq:cost_gain}
		\end{equation}
		We propose to solve the problem above through the \gls{lm} algorithm, following the implementation of~\cite{More78}, which is briefly described in Appendix~\ref{ssec:lm}.
		
		For the gain estimation step, a straightforward but robust initialization $\mathbf{a}^{[0]}$ is to set the bias element $a_0^{[0]}$ to the mean value of $\mathbf{w}$, while the remaining elements are set to zero.
		
	\subsection{Step 2: \texorpdfstring{\Glsentrylong{ml}}{Maximum likelihood} initialization}
	\label{ssec:characterization_ml}
	
		The \glsentryfull{ml} initialization described in this section is an extension of the method that we proposed in~\cite{Dole19} and roughly defines a curve fitting procedure for sinusoidal signals. The algorithm exploits the low finesse nature of the device under test, for which the transfer function $T_{\bm{\beta}}(\sigma)$ behaves like the 2-waves model of eq.~\eqref{eq:airy_1}: 
		\begin{equation}
			T_{\bm{\beta}}(\sigma)=\left(1+\frac{2r_0^{}}{1+r_0^2}\cos(2\pi\delta\sigma-\varphi^{}_0)\right)\mathcal{A}(\sigma)\,.
		\end{equation}
		In the above, we assume for simplicity that the reflectivity $\mathcal{R}$ is uniform and equal to $r_0$ over the whole wavenumber range.
		By normalizing both terms of the minimization problem of eq.~\eqref{eq:cost} and applying it to the mean over neighborhood vector $\mathbf{u}$, the problem can be rewritten as:
		
		\begin{subequations}
			\begin{align}
				\hat{\bm{\beta}}&\approx\arg\min_{\bm{\beta}}\sum_{i=1}^{N_a}\left(\frac{T_{\bm{\beta}}(\sigma_i)}{\mathcal{A}(\sigma_i)}-\frac{u_i}{\hat{\mathcal{A}}(\sigma_i)}\right)^2=\label{eq:cost_ml_1}\\
				&\approx\arg\min_{\bm{\beta}}\sum_{i=1}^{N_a}\left(\alpha\cos\left(2\pi\delta\sigma_i-\varphi_0^{}\right)-v_i\right)^2\,,\label{eq:cost_ml_2}
			\end{align}
			\label{eq:cost_ml}
		\end{subequations} 
		where we defined $\alpha:=2r_0^{}/(1+r_0^2)$ and $v_i:=\left(u_i-\hat{\mathcal{A}}(\sigma_i)\right)/\hat{\mathcal{A}}(\sigma_i)$, assuming $\mathcal{A}(\sigma_i)\approx\hat{\mathcal{A}}(\sigma)$.
		
		Eq.~\ref{eq:cost_ml_2} is in the form of the classical problem of the inference of the parameters in a sinusoid affected by Gaussian noise, whose \gls{mle} is a well known result in the literature (e.g., example 7.16 in~\cite{Kay93}).
		Specifically, if $\delta$ is reasonably far from the extremes of its interval of confidence $[0, 1/(2\Delta\sigma)]$, where $\Delta\sigma=(\sigma_{max}-\sigma_{min})/N_a$ is the average central wavenumber step, then the \gls{mle} $\hat{\delta}$ is equivalent to the \gls{opd} which maximizes the generalized \gls{dft} of $\mathbf{v}$, commonly known as \textit{periodogram}:
		\begin{equation}
			\hat{\delta}=\arg\max_{\delta\in\left[0,\frac{1}{2\Delta\sigma}\right]}\left\lvert\sum_{i=1}^{N_a}v_ie^{-j2\pi\delta\sigma_i}\right\rvert\,.
			\label{eq:delta_zero}
		\end{equation}
		The condition above can be verified heuristically over a sampled version of the interval, but the accuracy of the estimation has a limited resolution $1/(2N_a\Delta\sigma)$.
		If some prior information is known on the \gls{opd}, e.g. if its value is known to be around a certain nominal value with a given accuracy, the sampling region can be reduced further accordingly. 
		Given the above result, the estimation $\hat{r}_0$ of $r_0$ is then obtained in terms of the \gls{mle} $\hat{\alpha}$ of the amplitude $\alpha$ of the sinusoid:
		\begin{equation}
			\hat{r}_0=1-\sqrt{1-\hat{\alpha}^2}\,,\;\;\;\;\;\;\textrm{where }\;\;\;\hat{\alpha}=\frac{2}{N_a}\left\lvert\sum_{i=1}^{N_a}v_i e^{-j2\pi\hat{\delta}\sigma_i}\right\rvert\,,\label{eq:reflectivity_hat}
		\end{equation}		
		 and the \gls{mle} $\hat{\varphi}^{}_0$ of $\varphi^{}_0$ is:
		\begin{equation}
			\hat{\varphi}_0^{}=\arctan\frac{\sum_{i=1}^{N_a}v_i\sin(2\pi\hat{\delta}\sigma_i)}{\sum_{i=1}^{N_a}v_i\cos(2\pi\hat{\delta}\sigma_i)}\,,
			\label{eq:phase_shift_hat}
		\end{equation}
		where $\arctan$ denotes the four-quadrant arctangent version that allows for $\hat{\varphi}_0^{}$ to assume any value in the range $[-\pi,\pi)$. The \gls{ml} method requires very low computational power, but its applicability is limited by the validity of its assumptions. Some other possible initialization strategies, like the \gls{es} developed in~\cite{Pico20a}, are based on a grid search in the sample space of the parameters, have the advantage to work with a wider variety of models, but are vastly slower and may even produce less accurate results, as the estimations for $r_0^{}$ and $\varphi_0^{}$ are limited to the finite amount of values of the discrete sample space. 
	
	\subsection{Step 3: Trust region refinement (TRR)}
	\label{ssec:characterization_gna}
	
		The final refinement $\hat{\bm{\beta}}$ of the parameters is also performed through non linear regression, and formalized to solve the problem of eq.~\eqref{eq:cost}.
		The problem is approached with an analogous procedure of Section~\ref{ssec:characterization_gain}, which makes use once again of the \gls{lm} algorithm, this time solving eq.~\eqref{eq:cost}. The parameter vector $\bm{\beta}$ can be initialized with the vector $\bm{\beta}^{[0]}=[\hat{a}_0,...,\,\hat{a}_{N_d},\, \hat{r}_0^{},\, 0, ...,\,0,\, \hat{\delta},\hat{\varphi}_0^{}]$ which contains the coefficients estimated in the previous steps.


\section{Experimental results}
\label{sec:experiments}

	In this section, we discuss the experimental results of the characterization of \gls{imspoc} prototypes with different characteristics. In Section~\ref{ssec:experiments_setup} we describe the experimental setup, in Section~\ref{ssec:experiments_robustness} we test various configurations for the proposed algorithm and compare with previous works. Finally, in Section~\ref{ssec:experiments_discussion} we discuss the physical interpretation of the parameters analyzing a specific case study. A Python implementation of the proposed algorithms, together with a simulator of the image formation model of \gls{imspoc} is available at the first author's repository~\footnote{Code repository available at: \href{https://github.com/danaroth83/irca}{https://github.com/danaroth83/irca}}.
	
	
	\subsection{Experimental setup}
	\label{ssec:experiments_setup}
	
		\input{tables/proto.tex}
	
		For this work, the characterization datacubes were captured with the setup shown in \figurename~\ref{fig:experimental_setup}, using a tunable monochromatic light source from Zolix Instruments Co., Ltd, with a 500 \si{W} Xenon light source model Gloria-X500A and the monochromator model Omni-300$\lambda$i. The setup also employed a Specralon coated 5.3 inches diameter integrating sphere model 4P-GPS-053-SF from Labsphere, Inc. The incident optical power was measured either with the fiber optic gated spectrometers model USB2000+ from Ocean Optics, Inc. or with the photodiode power sensor model S120VC from Thorlabs~\footnote{Specifications for the products are available at: \href{https://www.idil-fibres-optiques.com/product/tunable-light-source/}{https://www.idil-fibres-optiques.com/product/tunable-light-source/},  \href{https://www.labsphere.com/product/general-purpose-sphere/}{https://www.labsphere.com/product/general-purpose-sphere/}, \href{https://www.oceaninsight.com/products/spectrometers/}{https://www.oceaninsight.com/products/spectrometers/}, and \href{https://www.thorlabs.com/thorproduct.cfm?partnumber=S120VC}{https://www.thorlabs.com/}}.
		
		The devices under test are 4 different \gls{imspoc} prototypes, whose characteristics are described in \tablename~\ref{tab:proto}. Each prototype features an array of interferometers disposed over a bidimensional matrix in a staircase pattern, whose thicknesses linearly increasing with a nominally constant step size $\Delta d$. For each device, the characterization datacube was captured by tuning the central wavenumber of the monochromator such that the wavenumber range is sampled regularly with a step size $\Delta\sigma$; the specifications for these acquisitions are also reported in~\tablename~\ref{tab:proto}.
		
		In each acquisition, the central pixel of each subimage was extracted in order to construct $N_p$ vectors. For any vector $\mathbf{y}$, the characterization methods described in Section~\ref{sec:characterization} are applied to obtain a characterization vector $\hat{\bm{\beta}}$; the associated neighborhood mean $\mathbf{u}$ uses an $11 \times 11$ kernel window, while we employ the 90-percentile flat field statistic for $\mathbf{w}$. This operation was preferred for \gls{snr} dampened acquisition over taking the pixel mean over multiple acquisitions, as that would lead to unfeasibly long sessions of measurement.
		Additionally, we assume that the gain estimation step is applied to all methods we test and with $N_d=5$ as polynomial degree.
		To verify the estimation quality, we use the \gls{rmse} metric, defined as follows:
		\begin{equation}
			RMSE=\sqrt{\frac{1}{N_a}\sum_{i=1}^{N_a}\left(\frac{T_{\hat{\bm{\beta}}}(\sigma_i)-y_i}{\overline{y}}\right)^2}\,.
			\label{eq:rmse}
		\end{equation}
		where $\overline{y}=(\sum_{i=1}^{N_a}y_i)/N_a$ denotes the mean value of $\mathbf{y}$ with $T_{\hat{\bm{\beta}}}(\sigma_i)$ from eq.~\eqref{eq:transfer_function} evaluated with the estimated vector of parameters $\hat{\bm{\beta}}$.
	
	
	\subsection{Algorithm and model comparisons}
	\label{ssec:experiments_robustness}
	
		\input{tables/fitting_new.tex}
		\input{gfx/curves.tex}
	
		The interferometer characterization with the setup discussed before is tested here with different configurations of our algorithm. Specifically, the algorithms can be tested employing different wave models for the optical transfer function $T_{\bm{\beta}}(\sigma)$, according to the definitions of eq.s~\eqref{eq:airy} and~\eqref{eq:transfer_function}, which we specialize to the case of $W=2$, $3$ or $\infty$ emerging light rays.
		
		\input{gfx/gain.tex}
		
		Additionally, the proposed procedure was tested both with and without the trust region refinement, in order to showcase the advantage of the iterative curve fitting procedure. In our computations, we either let the gain coefficients evolve or be fixed after the first step.
		The results are showcased in \figurename~\ref{fig:gain}, where we compare the result for the prototype \glsentryshort{p2}. For the blue curve, the gain can be only adjusted by a multiplicative factor; in the orange curve, the shape of the estimated gain can vary for each interferometer, allowing to dynamically adjust for the local intensity attenuations introduced by the device.
		For the same prototype, we also provide the plot of the reflectivity estimated with the proposed method in \figurename~\ref{fig:reflectivity}, which shows the reduced sensitivity of the instrument for the extreme values of wavenumber range.

		The \gls{rmse} results, given in \tablename~\ref{tab:fitting}, shows that the proposed method is consistently the best performing, regardless of the different characteristics of the prototypes.
		It also highlights how the $\infty$-wave model, which is a better representation of the generalized Airy distribution, provides a more accurate fit for the spectral response. Letting the \gls{lm} algorithm control the gain parameter evolution has also a considerable impact on the refinement of those obtained through a flat field estimation. The proposed options for the initialization both reach comparable results, suggesting that the \gls{ml} method should be preferred, as it is faster by a factor of 10-20 over the \gls{es} methodology. In general terms, the proposed method exploits the advantage of exploring a continuous space of parameters, with respect, i.e. of the \gls{ml} where the \gls{opd} space is explored in discrete steps.
		A visual comparison between their reconstructed spectral responses is shown in \figurename~\ref{fig:curves}; while the \gls{ml} algorithm  infers the \gls{opd} with a remarkable accuracy, introducing a polynomial description of the reflectivity represents more properly the nature of amplitudes of the oscillations, which varies with the wavelength.
		
		\subsection{Physical interpretation of the results}
		\label{ssec:experiments_discussion}
		
		\input{gfx/opd.tex}
		\input{gfx/plate.tex}
		
		For the \glsentryshort{p2} prototype, the session of measurements for the spectral characterization was repeated at three different dates, using progressively refined setups. 
		The proposed method was applied to each of those datasets in order both to analyze the robustness of the algorithm and to detect eventual drifting in the parameters.
		
		For a nadir illumination, such as in the case of the central pixels of the subimages, the \glspl{opd} are roughly expected to be double the thickness of interferometers, as a consequence of substituting $\theta^{[i]}\approx0$ in eq.~\ref{eq:opd_fabry_perot}.
		
		A comparison of the estimated \glspl{opd} is shown in \figurename~\ref{fig:opd_comparison}, with the yellow halo denoting the region that was not explored for the \gls{ml} computation in eq.~\eqref{eq:delta_zero}, as that strays too far from the nominal values known from the design of the instrument. 
		The samples that were processed, two of which for the same interferometer are shown in \figurename~\ref{fig:opd_old} and~\ref{fig:opd_new}, look quite different; that most recent datacube were compensated by the incident optical power of the light source, while the other ones were not. Nevertheless, the estimation of the \glspl{opd} stays vastly consistent, with only very sparse examples where the results does not align.
		
		The plot of the estimated \glspl{opd}, is arranged in increasing order of nominal thickness, shows a pattern of alternating slopes. This effect is strongly correlated to the disposition of interferometers on the matrix.
		
		This effect is particularly evident for the \gls{p1} prototype, which is manufactured with a particular staircase design pattern. The thicknesses increases with constant steps in both the left and right direction starting from a central vertical axis. The heatmap of \figurename~\ref{fig:plate_data} shows the deviation between the estimated \gls{opd} difference across successive interferometers compared to this constant increase. The different behavior of the left and right side of the instrument can be straightforwardly interpreted if we assume a slight tilt on the optical plates that limit the upper surface of the \gls{fp} cavities, as shown in \figurename\ref{fig:plate_tilted}. On the left side, the thickness is inferior with respect to the nominal value, as the tilt compresses the free space within the cavities, and viceversa for the right side. % \textcolor{red}{With a regression analysis this tilt can be measured to be around equal to ...}  
		

	
\section{Conclusion}

	In this paper, we presented the spectral characterization procedure associated to the \gls{imspoc} device, an image spectrometer based on the interferometry of \glsentrylong{fp}. We described the image formation model and we expressed its spectral response in terms of a limited amount of parameters, following the formulation of Airy distribution. The proposed characterization algorithm exploits the two emerging wave model to cast the problem in the Fourier domain, where the \gls{ml} estimator for the \glspl{opd} is equivalent to a maximization of the periodogram and refines the results with nonlinear regression; separating the responsabilities in the algorithm allows for both robustness and precision in the final results. The estimated parameters can highlight manufacturing issues in an easily interpretable format. A proper characterization is extremely important for a proper recovery of the spectrum, which, in the future could be optimized jointly with the spectral response of the devices in architectures where such parameters can be learned dynamically~\cite{Sun16, Yang20}.
	
\section*{Funding}
	% This article is funded by ImSPOC-UV, convention FEDER nÂ° RA0022348
	This work is partly supported by the AuRA region and FEDER under the project ImSPOC-UV (convention FEDER n. RA0022348) and by grant ANR FuMultiSPOC (ANR-20-ASTR-0006).
	
\appendix

\section{Levenberg-Marqardt algorithm}
\label{ssec:lm}

We aim to provide here an approachable explanation of the \gls{lm} algorithm, to build an intuition of what are the operations involved in the process.
The algorithm can be seen as a trust region based approach for nonlinear regression. 
The aim is to find an estimation $\hat{\bm{\beta}}$ of the parameters $\bm{\beta}=\{\beta_m\}_{\range{i}{1}{N_m}}$, in order for the samples $\{t_i(\bm{\beta})\}_{\range{i}{1}{N_a}}$ of an analytical function to fit a set of observation $\{y_i\}_{\range{i}{1}{N_a}}$.

The algorithm addresses the problem by finding a sequence of iteratively more accurate solutions $\{\bm{\beta}^{[q]}\}_{q\ge0}$ from a given initialization $\bm{\beta}^{[0]}$, using the following update rule:
\begin{equation}
	\bm{\beta}^{[q]}=\arg\min_{\bm{\beta}}\sum_{i=1}^{N_a}\left(t_i(\bm{\beta}^{[q-1]})+\sum_{m=1}^{N_m}j_{im}\left(\beta_m-\beta_m^{[q-1]}\right)-w_i\right)^2+\lambda\sum_{m=1}^{N_m}\beta_m^2\,.
	\label{eq:cost_lm}
\end{equation}
where $\lambda\ge0$ denotes an user defined dampening parameter.
In the above function, $t_i(\bm{\beta})\approx t_i(\bm{\beta}^{[q-1]})+\sum_{m=0}^{N_m-1}j^{[q-1]}_{im}\left(\beta_m-\beta_m^{[q-1]}\right)$ represents a truncated Taylor expansion of $t(\bm{\beta})$ around the current estimation $\bm{\beta}^{[q-1]}$. In this representation, the terms $j_{im}$ denote the coefficients of the Jacobian matrix $\mathbf{J}\in\mathbb{R}^{N_p\times N_m}$, which are defined as:
\begin{equation}
	j_{im}= \left.\frac{\partial t_i(\bm{\beta})}{\partial \beta_m}\right\rvert_{\bm{\beta}=\bm{\beta}^{^{[q-1]}}}\,,\;\;\;\;\;\;\forall\range{i}{1}{N_a},\,\forall\range{m}{1}{N_m}\,.
\end{equation}

Eq.~\ref{eq:cost_lm} admits as analytical solution:
\begin{equation}
	\bm{\beta}^{[q]}=\bm{\beta}^{[q-1]}+\left(\mathbf{J}\T\mathbf{J}+\lambda\mathbf{I}\right)^{-1}\mathbf{J}\T\mathbf{e}\,,
\end{equation}
where $\mathbf{I}$ denotes an identity matrix and the vector $\mathbf{e}$, whose $i$-th coefficient is defined as $e_i:=t_i(\bm{\beta}^{[q-1]})-w_i$, denotes the current estimation residual. When a certain convergence condition is verified (e.g. after a given number of iterations), the result of the last update is chosen as the desired estimation $\hat{\bm{\beta}}$. Additional implementation details, e.g. to define a criterion to assign the value of $\lambda$, to simplify the evaluation of $\mathbf{J}$, and to evaluate the stopping conditions on the iterations are given in the related paper~\cite{More78}.

\bibliography{biblio.bib}


\end{document}


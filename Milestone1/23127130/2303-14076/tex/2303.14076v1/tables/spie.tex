\begin{algorithm}[!htbp]
    \SetAlgoLined
    \DontPrintSemicolon
    \SetKwInOut{KwInput}{Input:}
    \SetKwInOut{KwDefinitions}{Characteristics of the tree}
    \SetKwInOut{KwInitialization}{Initialization}
    \KwResult{
        Parametersâ€™ Estimation:
        \begin{itemize}
            \item $\widehat{\bm{\beta}}_{:k}=\left[\widehat{\delta}_k,\widehat{\mathcal{R}}_k;\,\widehat{\varphi}^{[0]}_k;\,\widehat{\mathcal{T}}^2_k\right],\,\forall\range{k}{1}{N_k}$
        \end{itemize}
    %     \begin{itemize}[noitemsep]
    %         \item \gls{opd} Estimation: $\left\{\widehat{\delta}_k\right\}_{\range{k}{1}{N_k}}$
    %         \item Reflectivity Estimation: $\left\{\widehat{\mathcal{R}}_k\right\}_{\range{k}{1}{N_k}}$
    %         \item Phase shift Estimation: $\left\{\widehat{\varphi}^{[0]}_k\right\}_{\range{k}{1}{N_k}}$
    %         \item Squared transmissivity estimation: $\left\{\widehat{\mathcal{T}}^2_k\right\}_{\range{k}{1}{N_k}}$
    %     \end{itemize}
    % 
    }
    
    \textbf{Input:}
        \begin{itemize}
            \item Input spectra's central wavenumbers: $\{\sigma_l\}_{l\in[\![1..N_a]\!]}$\\
            \item Matrix of acquisitions: $\mathbf{Y}\in\mathbb{R}^{N_k\times N_a}$ whose rows are $\{\mathbf{y}_{k:}\}_{\range{k}{1}{N_k}}$\\
            \item \gls{opd} Sample Space: $\{\delta'_s\}_{s=1,...,N_s}\in\left[0,\frac{1}{2\Delta\sigma}\right]$ where $\delta_s=\frac{s-1}{2\Delta\sigma}$ and $\Delta\sigma=\frac{1}{N_b-1}\sum_{l=1}^{N_b-1}(\sigma_{l+1}-\sigma_l)$
            %\mathbb{E}_l[\sigma_{l+1}-\sigma_l]
        \end{itemize}
    \textbf{Procedure:}\\
        \medskip
        %\everypar={\nl}
        Construct $\mathbf{W}\in\mathbf{R}^{N_s \times N_a}$ with elements $w_{lk}=e^{-j2\pi\delta'_k\sigma_l}$\;
        \For{$k=1,...,N_k$}{
             $\nmlz{\mathbf{y}}_{k:}=\left(\mathbf{y}_{k:}-\overline{\mathbf{y}}_{k:}\right)\mathbin{/}\overline{\mathbf{y}}_{k:}$\;
            $\mathbf{r}\gets\left|\mathbf{W}\nmlz{\mathbf{y}}_{k:}\T\right|\in\mathbb{R}^{N_s}$ and denote the $s$-th element with $J_{sk}$\;
            $\widehat{s}=\arg\max\limits_{\range{s}{1}{N_s}} r_s$\;
            $\widehat{\delta}_k=\delta'_{\widehat{s}}$\;
            Calculate $\widehat{\alpha}_k$ and $\widehat{\varphi}^{[0]}_k$ analytically from eq.~\ref{eq:extraparam}\;
            $\widehat{\mathcal{R}}_k=\left(1-\sqrt{1-\widehat{\alpha}^2_k}\right)/\widehat{\alpha}_k$\;
            $\widehat{\mathcal{T}}^2_k=\frac{\overline{\mathbf{y}}_{k:}}{1+\widehat{\alpha}_k\sum_{l=1}^{N_b}\cos(2\pi\delta_k\sigma_l)}$\;
        }
    \caption{\Glsfirst{ml} parameter estimation.}
    \label{alg:SPIE}
\end{algorithm}
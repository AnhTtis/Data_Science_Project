\begin{algorithm}[!htbp]
    \SetAlgoLined
    \DontPrintSemicolon
    %\linesnumbered
    \SetKwInOut{KwInput}{Input:}
    \SetKwInOut{KwDefinitions}{Characteristics of the tree}
    \SetKwInOut{KwInitialization}{Initialization}
    \KwResult{
        \begin{itemize}
            \item Parameters' Estimation: $\widehat{\bm{\beta}}_{k:}=\left[\widehat{\delta}_k;\,\widehat{\mathcal{R}}_k;\,\widehat{\varphi}^{[0]}_k;\,\widehat{\mathcal{T}}^2_k\right],\;\forall \range{k}{1}{N_k}$
        \end{itemize}
    }
    
    \textbf{Input:}
        \begin{itemize}
            \item Matrix of acquisitions: $\mathbf{Y}\in\mathbb{R}^{N_k\times N_a}$ whose rows are $\{\mathbf{y}_{k:}\}_{\range{k}{1}{N_k}}$
            \item Amount of samples for parameters' space tessellation: $[N_{s_1},N_{s_2},N_{s_3}]$
            \item Wave model label (e.g. $2$, $N_m$ or $\infty$ waves)
            \item Input spectra $\mathbf{X}\in\mathbb{R}^{N_b \times N_a}$ and their central wavenumbers $\{\sigma_l\}_{\range{l}{1}{N_a}}$
            %\mathbb{E}_l[\sigma_{l+1}-\sigma_l]
        \end{itemize}
    \textbf{Procedure:}\\
        \medskip
        %\everypar={\nl}
        Define the sample spaces: $\delta'_{s_1}=\frac{s_1-1}{N_{s_1}}\frac{1}{2\Delta\sigma}$, $\mathcal{R}'_{s_2}=\frac{s_2-1}{N_{s_2}}$, ${\varphi_{s_3}^{[0]\prime}}=\frac{s_3-1}{N_{s_3}}{2\pi}$, $\forall \range{s_1}{1}{N_{s_1}},\,\range{s_2}{1}{N_{s_2}},\,\range{s_3}{1}{N_{s_3}}$ with $\Delta\sigma=\frac{1}{N_b-1}\sum_{l=1}^{N_b-1}(\sigma_{l+1}-\sigma_l)$
        
        Construct $\mathbf{W}\in\mathbf{R}^{N_s \times N_a}$ with elements $w_{lk}=e^{-j2\pi\delta'_k\sigma_l}$\;
        \For{$k=1,...,N_k$}{
            Evaluate $\overline{\mathbf{y}}_{k:}=\sum_{l=1}^{N_b}y_{kl}$\;
            $J_{min} \leftarrow \infty$\;
            \For {$s_1=1,...,N_{s_1},\;s_2=1,...,N_{s_2}$}{
                $\bm{\beta}' \gets \left[\delta'_{s_1};\,\mathcal{R}'_{s_2};\,0;\,1\right]$\;
                Evaluate $\mathbf{a}_{k:}^{[\bm{\beta}']}$ with the selected model from \tablename~\ref{tab:transfer_matrix}\;
                Evaluate $\mathbf{y}^{[sim]}=\mathbf{a}_{k:}^{[\bm{\beta}']}\mathbf{X}$ and its mean $\overline{\mathbf{y}}^{[sim]}$\;
                Evaluate $J'=\left\|\frac{\left\lvert\mathbf{W}{\mathbf{y}^{[sim]}}{\T}\right\rvert}{\overline{\mathbf{y}}^{[sim]}}-\frac{\left|\mathbf{W}\mathbf{y}_{k:}\T\right|}{\overline{\mathbf{y}}_{k:}}\right\|_2$\;
                \If{$J'<J_{min}$}{
                    $J_{min} \leftarrow J',\;\widehat{\delta}_k \leftarrow \delta'_{s_1},\;\widehat{\mathcal{R}}_k \leftarrow \mathcal{R}'_{s_2}$\;
                }
            }
            $J_{min} \leftarrow \infty$\;
            \For {$s_3=1,...,N_{s_3}$}{
                $\bm{\beta}' \leftarrow [\widehat{\delta}_k;\,\widehat{\mathcal{R}}_k;\,{\varphi_{s_3}^{[0]\prime}};\,1]$\;
                Evaluate $\mathbf{a}_{k:}^{[\bm{\beta}']}$ with the selected model from \tablename~\ref{tab:transfer_matrix}\;
                Evaluate $\mathbf{y}^{[sim]}=\mathbf{a}_{k:}^{[\bm{\beta}']}\mathbf{X}$ and its mean $\overline{\mathbf{y}}^{[sim]}$\; 
                Evaluate $J'=\left\|\frac{\mathbf{y}^{[sim]}}{\overline{\mathbf{y}}^{[sim]}}-\frac{\mathbf{y}_{k:}}{\overline{\mathbf{y}}_{k:}}\right\|_2$\;
                \If{$J'<J_{min}$}{
                    $J_{min} \leftarrow J',\;\widehat{\varphi}^{[0]}_k \leftarrow {\varphi_{s_3}^{[0]\prime}}$\;
                }
            }
            Evaluate $\mathbf{y}^{[sim]}=\mathbf{a}_{k:}^{[\bm{\beta}']}\mathbf{X}$ and its mean $\overline{\mathbf{y}}^{[sim]}$\;
            $\widehat{\mathcal{T}}^2_k \leftarrow \frac{\overline{\mathbf{y}}_{k:}}{\overline{\mathbf{y}}^{[sim]}}$\;
        }
    \caption{\Glsfirst{es} parameter estimation.}
    \label{alg:ICASSP}
\end{algorithm}
\section{Analysis} \label{section_analysis}
We start by defining the KL divergence / relative entropy, modulated (interaction) energy, and modulated free energy for two probability densities $\rho, \bar \rho$.  Again $\mathcal{X}$ denotes the underlying space which can be the whole space $\mathbb{R}^d$ or the torus $\Pi^d $ which can be identified with $[-L, L]^d$ with the periodic boundary condition and $L>0$. 
Firstly, the KL divergence is defined as 
%\begin{equation}\label{DefKL}
	$\KL(\rho, \bar \rho) = \int_{\mathcal{X}} \rho(x) \log \frac{\rho(x)}{\bar \rho(x) } \ud x $
%\end{equation}
if $\rho$ is absolutely continuous with respect to $\bar \rho$, otherwise we set $\KL(\rho, \bar \rho )= + \infty$. By Jensen's inequality, $\KL(\rho, \bar \rho) \geq 0$ for any $\rho, \bar \rho$. Given the McKean-Vlasov \eqref{eqn_MVE}, if $K$ is bounded, it is sufficiently to choose the Lyapunov functional $L(\rho_t^f, \bar \rho_t)$ as the KL divergence (please see Theorem \ref{theorem_bounded_K} in the appendix). But for more singular kernels, we need also to consider the Coulomb type energy or modulated energy as in \citep{serfaty2020mean}
\begin{equation}
	\label{DefModEnergy}
	F(\rho, \bar \rho) = \frac 1 2 \int_{\mathcal{X}^2} g(x- y) \ud (\rho - \bar \rho)(x) \ud (\rho - \bar \rho )(y), 
\end{equation}
where $g$ is the fundamental solution to the Laplacian equation in $\mathbb{R}^d$, i.e. $- \Delta g = \delta_0$, and the Coulomb interaction reads $K= -\nabla g$ (see its closed form expression in \eqref{eqn_coulomb_interaction}). If we are only interested in the deterministic  dynamics with Coulomb interactions, i.e. $\nu =0$ in \eqref{eqn_MVE}, it suffices to choose $L(\rho_t^f, \bar \rho) $ as  $F(\rho_t^f, \bar \rho_t)$ (please see Theorem \ref{ThmCoul}). But if we consider the system with  Coulomb interactions and  diffusions, i.e. $\nu >0$, we shall combine the KL divergence and the modulated energy to form the modulated free energy as in \cite{bresch2019modulated}, which reads 
\begin{equation}
	\label{DefModFree}
	E(\rho, \bar \rho) = \nu \KL (\rho, \bar \rho) +  F(\rho, \bar \rho). 
\end{equation}
This definition agrees with the physical meaning that ``Free Energy = Temperature $\times $ Entropy + Energy", and we note that the temperature is proportional to the diffusion coefficient $\nu$. We remark also for two probability densities $\rho$ and $\bar \rho$, $F(\rho, \bar \rho) \geq 0$ since by looking in Fourier domain $F(\rho, \bar \rho) = \int \hat g(\xi) |\widehat{\rho - \bar \rho}(\xi)|^2  \ud \xi \geq 0$ as $\hat g(\xi) \geq 0$. Moreover, $F(\rho, \bar \rho)$ can be regarded  as a negative Sobolev norm for $\rho- \bar \rho$, which is a metric.

To obtain our main stability estimate in the flavor of entropy dissipation, we first obtain the time evolution of the KL divergence as follows.  
%%%% Evolution of the KL divergence 
\begin{lemma}[Time Evolution of the KL divergence] \label{TimeEvolKLMV} 
	Given the hypothesis velocity field $f=f(t, x) \in C^1_{t, x}$. Assume that $(\rho_t^f)_{t \in [0, T]}$ and $(\bar \rho_t)_{t \in [0, T]}$ are classical solutions to \eqref{eqn_CE} and \eqref{eqn_MVE_CE} respectively.  It holds that (recall the definition of $\delta_t$ in \eqref{eqn_perturbation}) 
	\[
	\frac{\ud }{\ud t} \int_{\mathcal{X}} \rho^f_t \log \frac{\rho^f_t }{\bar \rho_t} = - \nu \int_{ \X}\rho^f_t |\nabla \log \frac{\rho^f_t}{\bar \rho_t}|^2 +  \int_{\X} \rho^f_t K * (\rho^f_t - \bar \rho_t ) \cdot \nabla  \log  \frac{\rho^f_t }{\bar \rho_t} +  \int_{\X} \rho^f_t \delta_t \cdot \nabla \log \frac{\rho^f_t }{\bar \rho_t }, 
	\]
	where $\X$ denotes either $\mathbb{R}^d$ or the tours $\Pi^d$. 
	
\end{lemma}

We refer the proof of this lemma and all other lemmas and theorems in this section to the appendix \ref{detailed proof}. We remark that to have the existence of classical solution $(\bar \rho_t)_{t \in [0, T]}$, we definitely need the regularity assumptions on $-\nabla V$ and on $K$. But the linear term $- \nabla V $ will not contribute to the evolution of the relative entropy. See \citep{jabin2018quantitative} for detailed discussions. 








%%%% Evolution of the Modulated Energy 
Similarly, we have the time evolution of the modulated energy as follows.
\begin{lemma}[Time evolution of the modulated energy]\label{ModuEnergyEvo} Under the same assumptions as in Lemma \ref{TimeEvolKLMV}, given the diffusion coefficient $\nu \geq 0$, it holds that (recall the definition of $\delta_t$ in \eqref{eqn_perturbation}) 
	\[
	\begin{split}
		\frac{\ud }{\ud t } F(\rho_t^f, \bar \rho_t)&  =  - \int_{\mathcal{X}} \rho_t^f |K *(\rho_t^f - \bar \rho)|^2 - \int_{\mathcal{X}} \rho_t^f \, \delta_t \cdot K * (\rho_t^f - \bar \rho_t ) \\
		&  - \frac{1}{2} \int_{\mathcal{X}^2} K(x-y) \cdot \Big( \mathcal{A}[\bar \rho_t](x) - \mathcal{A}[\bar \rho_t](y) \Big) \ud (\rho_t^f - \bar \rho_t )^{\otimes 2 }(x, y) \\
		&  + \nu \int_{\mathcal{X}} \rho^f_t \, K * (\rho_t^f - \bar \rho_t )\cdot \nabla \log \frac{\rho_t^f}{\bar \rho_t}, 
	\end{split}
	\]
	where we recall that {$\mathcal{A}[\bar \rho_t](x) = - \nabla V (x) + K * \bar \rho_t -  \nu \nabla \log \bar \rho_t$} is defined below \eqref{eqn_MVE_CE}.
\end{lemma}






%%%%%%% The 2D Navier-Stokes case  
By  Lemma \ref{TimeEvolKLMV} and careful analysis, in particular by rewriting the Biot-Savart law in the divergence of a bounded matrix-valued function as in \eqref{eqn_K_as_divergence}, we obtain the following estimate for the 2D Navier-Stokes case.
\begin{theorem}[Stability Estimate of the 2D Navier-Stokes Equation] \label{NSMainEstimate}	
	Consider the 2D Navier-Stokes equation in the vorticity formulation, i.e.  \eqref{eqn_MVE} with $V= 0$. Notice that when $K$ is the Biot-Savart kernel, $\udiv K =0$. Assume that the initial data $\bar \rho_0 \in C^\infty(\Pi^d)$ and there exists $c>1$ such that $\frac 1 c \leq \bar \rho_0 \leq c$.  Assume further the hypothesis velocity field $f(t, x) \in C^1_{t, x}$. Then it holds that 
	\[
	\sup_{t \in [0, T]} \int_{\Pi^d} \rho_t^f \log \frac{\rho_t^f}{\bar \rho_t} \ud x \leq \frac{1}{\nu} \exp(M T ) R(f), 
	\]
	where $M = \sup_{t \in [0, T]}  M(t; \nu, U, \bar \rho)$ and 
	$M(t; \nu, U, \bar \rho_t) = \frac{2}{\nu } \|U\|_{L^\infty}^2 \|\nabla \log \bar \rho_t\|_{L^\infty}^2 + 4  \|U\|_{L^\infty} \Big\| \frac{\nabla^2 \bar \rho_t}{\bar \rho_t} \Big\|_{L^\infty}$. 
	
\end{theorem} 
We give the complete proof and discussions for possible extension to long time estimate and to improve the dependence on $T$ in the appendix \ref{detailed proof}. This theorem tells us that as long as $R(f)$ is small, the KL divergence between $\rho_t^f$ and $\bar \rho_t$ is small and the control is uniform in time $t \in [0, T]$. We state this theorem on torus for simplicity and one may expect similar result on $\mathbb{R}^d$. Also the $C^\infty$ condition can be relaxed for instance to $C^2$. 


%%%%%  Remark on The case with bounded interactions $K \in L^\infty
%%%% Leave in the appendix  


%%%% The deterministic case with Coulomb 
%%%% Lemma of the evolution of the modulated free energy 
To treat the McKean-Vlasov \eqref{eqn_MVE} with Coulomb interactions, we exploit the time evolution of the modulated free energy $E(\rho_t^f, \bar \rho_t)$. Indeed, combining Lemma \ref{TimeEvolKLMV} and Lemma \ref{ModuEnergyEvo}, we arrive at the following estimate.  
\begin{lemma}[Time evolution of the modulated free energy]\label{TimeEvoMFE} 
	Under the same assumptions as in Lemma \ref{TimeEvolKLMV}, one has (recall the definition of $\delta_t$ in \eqref{eqn_perturbation}) 
	\[
	\begin{split}
		\frac{\ud }{\ud t } E(\rho_t^f, \bar \rho_t)  & = -\int_{\mathcal{X}} \rho_t^f  \Big|K * (\rho_t^f - \bar \rho_t) - \nu \nabla \log \frac{\rho_t^f }{\bar \rho_t}\Big|^2 - \int_{\mathcal{X}} \rho_t^f \, \delta_t \cdot \Big( K * (\rho_t^f - \bar \rho_t ) - \nu \nabla \log \frac{\rho_t^f}{\bar \rho_t }\Big) \\
		&  - \frac{1}{2} \int_{\mathcal{X}^2} K(x-y) \cdot \Big( \mathcal{A}[\bar \rho_t](x) - \mathcal{A}[\bar \rho_t](y) \Big) \ud (\rho_t^f - \bar \rho_t )^{\otimes 2 }(x, y), 
	\end{split}
	\]
	where  $\mathcal{A}[\bar \rho_t](x) = - \nabla V (x) + K * \bar \rho_t(x) -  \nu \nabla \log \bar \rho_t(x). $
\end{lemma}



%%%%%%%%%%%%%%Main theorem of the Coulomb case 
Inspired by the mean-field convergence results as in \cite{serfaty2020mean} and \cite{bresch2019modulated}, we finally can control the growth of $E(\rho_t^f, \bar \rho_t)$ in the case when $\nu >0$,  and $F(\rho_t^f, \bar \rho_t)$ in the case when $\nu =0$. Note also that $E(\rho_t^f, \bar \rho_t )$ can also control the KL divergence when $\nu >0$. 
\begin{theorem} [Stability Estimate of McKean-Vlasov Eq. (\ref{eqn_MVE}) with Coulomb interactions] \label{ThmCoul}
	Assume that for $t \in [0, T]$, the self-consistent velocity field $\mathcal{A}[\bar \rho_t](x)$ is Lipschitz  in $x$ and 
	\vspace{-2mm}
	\[
	\sup_{t \in [0, T]} \|\nabla \mathcal{A}[\bar \rho_t](\cdot)\|_{L^\infty} = C_1  < \infty. 
	\]
	Then there exists $C>0$ such that 
	\vspace{-2mm}
	\[
	\sup_{t \in [0, T]} \nu\,  \KL (\rho_t^f, \bar \rho_t) \leq \sup_{t \in [0, T]} E(\rho_t^f, \bar \rho_t) \leq \exp(C C_1 T) R(f).  
	\]
	In the deterministic case when $\nu =0$, under the same assumptions, it holds that 
	\vspace{-2mm}
	\[
	\sup_{t \in [0, T]} F( \rho_t^f, \bar \rho_t) \leq \exp(CC_1T ) R(f). 
	\]
\end{theorem}
\vspace{-4mm}
See the proof and the discussion on the Lipschitz assumptions on $\mathcal{A}[\bar \rho_t](\cdot)$ in the appendix \ref{detailed proof}. 








%%%%



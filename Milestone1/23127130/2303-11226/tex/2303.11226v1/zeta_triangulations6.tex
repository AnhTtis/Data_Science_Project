\documentclass[12pt,a4paper]{amsart}
\usepackage{a4}
%%%%%%%%%%%%%
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts,amssymb,amsthm}
\usepackage[color=green!30]{todonotes}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage[colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}]{hyperref}
\usepackage[nameinlink,capitalise]{cleveref}
\usepackage[xy]{qsymbols}
\usepackage{tikz-cd}
\usetikzlibrary{arrows}
%\newcommand{\midarrow}{\tikz \draw[-triangle 90] (0,0) -- +(.1,0);}
\usepackage{mathtools}
%\usepackage{nicematrix}
\usepackage{array,arydshln}
\usepackage{bigdelim}
 \usetikzlibrary {arrows.meta} 
 \usepackage{mathrsfs}
 \usepackage{graphicx,scalerel}
 \newcommand\wh[1]{\hstretch{3}{\hat{\hstretch{0.33}{#1\kern+0.12em}}}}

\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\PSL}{PSL}
\DeclareMathOperator{\PGL}{PGL}
\DeclareMathOperator{\PSU}{PSU}
\DeclareMathOperator{\SU}{SU}
\DeclareMathOperator{\SO}{SO}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\tor}{tor}
\newcommand{\RR}{\mathbb R}
\newcommand{\CC}{\mathbb C}
\newcommand{\ZZ}{\mathbb Z}
\newcommand{\QQ}{\mathbb Q}
\newcommand{\HH}{\mathbb H}
\DeclareMathOperator{\Id}{Id}
\newcommand{\bma}{\begin{pmatrix}}
\newcommand{\ema}{\end{pmatrix}}
\newcommand{\bsm}{\left(\begin{smallmatrix}}
\newcommand{\esm}{\end{smallmatrix}\right)}
\newcommand{\dd}{\mathrm{d}}
\renewcommand{\Re}{\operatorname{Re}}
\DeclareMathOperator{\Vol}{Vol}
\DeclareMathOperator{\lk}{lk}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\tr}{tr}

\newtheorem{theorem}{Theorem}
\newtheorem{conj}{Conjecture}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{question}[theorem]{Question}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem*{thmintro}{Theorem}
\newtheorem*{claim}{Claim}
\newtheorem*{notation}{Notation}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{terminology}{Terminology}
\newtheorem{example}[theorem]{Example}

\newtheorem{remark}[theorem]{Remark}
\newtheorem{construction}[theorem]{Construction}

%Titre & divers
%\subjclass[2000]{Primary: 57M25, Secondary: 57M27}
\keywords{}

\crefname{collitem}{}{}
\creflabelformat{collitem}{#2\cref{prop:collect}~(#1)#3}

\begin{document}
\title[Triangulations and combinatorial zeta functions]{Combinatorial zeta functions counting triangles}
%\date{\today}
\author{Leo Benard}
\address{Mathematisches Institut, Georg--August Universit\"at G\"ottingen}
\email{leo.benard@mathematik.uni-goettingen.de}
\author{Yann Chaubet}
\address{Department of Pure Mathematics and Mathematical Statistics, University of
Cambridge, Cambridge}
\email{y.chaubet@dpmms.cam.ac.uk}
\author{Nguyen Viet Dang}
\address{Sorbonne Université and Université Paris Cité, CNRS, IMJ-PRG, F-75005 Paris, France.\\
Institut Universitaire de France, Paris, France.}
\email{dang@imj-prg.fr }
\author{Thomas Schick}
\address{Mathematisches Institut, Georg--August Universit\"at  G\"ottingen}
\email{thomas.schick@math.uni-goettingen.de}
\subjclass[2010]{57Q70} 

\maketitle

\begin{abstract}
In this paper, we compute special values of certain combinatorial zeta
functions counting geodesic paths in the $(n-1)$-skeleton of a triangulation
of a $n$-dimensional manifold. We show that they carry a topological
meaning. As such, we recover the first Betti number and $L^2$-Betti number of
compact manifolds, and the linking number of pairs of null-homologous knots in
a 3-manifold.

The tool to relate the two sides (counting geodesics/topological invariants)
are random walks on higher dimensional skeleta of the triangulation.
%{We also relate linking numbers of combinatorial knots from counting paths going from one knot to the other.} 
\end{abstract}

\medbreak
%\section{Introduction}
Given a hyperbolic surface $\Sigma$, Fried \cite{Fried} initiated the study of the behavior at the origin of the so-called Ruelle zeta function \cite{ruelle1976zeta}
$$
\zeta_\Sigma(s) = \prod_{\gamma} \left(1-e^{-s \ell(\gamma)}\right),
$$
where the product runs over all primitive closed geodesics of $\Sigma$. This infinite product is convergent whenever $\Re s > 1$, and admits a meromorphic extension for $s$ lying in the whole complex plane. In \cite{Fried}, Fried showed that $\zeta_\Sigma(s)$ vanishes at order $-\chi(\Sigma)$ at $s=0$, and this result was extended to arbitrary negatively curved surfaces by Dyatlov--Zworski \cite{DZ}. An important consequence is that the topology of a negatively curved surface is fully determined by its length spectrum, the set of lengths of primitive closed geodesics.

%{ Recently, the second author together with G Rivière showed that one could recover the genus of a negatively curved surface from the length of geodesics between any pair of points~\cite{Dang_Riviere}.}
%
%Here and after, a geodesic is said \emph{primitive} if it is not a non-trivial multiple of a shorter other geodesic.

%Consider a closed surface $\Sigma$, and a triangulation $K$ of $\Sigma$. 
%For any integer $k$, we denote by $n_k$ the number of closed paths in the one-skeleton $K^{(1)}$ of the triangulation $K$ such that no pair of consecutive edges of the path belong to the same face. We call such a path a \emph{geodesic}, since it is locally (for each triangle) length-minimizing. Note that each path of length $k$ will be counted $k$ times, since we do not require it to have a base point.  {We call them primitive when they are not non trivial multiples of some shorter closed path}.
% Moreover, we allow non-primitive paths, namely we can run several times around the same geometric path.
The aim of this note is to prove analogous statements in a combinatorial setting. Let $M$ be a compact manifold of dimension $n \geqslant 1$, endowed with a smooth triangulation $\mathscr T$. We will prove our results in the more general setting of a \emph{regular} polyhedral decomposition, but for sake of simplicity we state the result here for triangulations. A \textit{geodesic path} in $\mathscr T$ is a finite sequence $c = (\sigma_1, \dots, \sigma_q)$  of adjacent $(n-1)$-simplices such that $\sigma_q$ is adjacent to $\sigma_1$ and no pair $(\sigma_k, \sigma_{k+1})$ of consecutive simplices nor $(\sigma_q, \sigma_1)$ bound the same $n$-simplex. A \textit{closed geodesic} is an equivalence class of closed geodesic path, 
%such that every cyclic permutation of $c$ is a geodesic path~; we will 
where we identify two closed geodesic paths if one is a cyclic permutation of the other. We denote by  $\mathcal P$ the set of primitive closed geodesic, where a geodesic is called primitive if it is not a power of a shorter loop. The length of a closed geodesic $\gamma = [(\sigma_1, \dots, \sigma_q)]$ is denoted by $|\gamma| = q$ while $\varepsilon_\gamma \in \{-1, 1\}$ denotes its \textit{reversing index}, which is defined in \S\ref{sec:fried}. 
%For a prime geodesic $[\gamma]$, its length $\ell([\gamma]) \in \ZZ_{>0}$ is the number of steps from its start to its end. Its sign is $\varepsilon([\gamma]) = (-1)^{n([\gamma])}$, where $n([\gamma])$ is the number of pairs of consecutive $(n-1)$-simplexes in $[\gamma]$ which intersect in a $(n-2)$-face with non-compatible orientation, see \cref{def:compa}.

We will prove the following result.
\begin{theorem}\label{theo:mainfried}
The combinatorial zeta function 
$$
\zeta_\mathscr T(z) = \prod_{\gamma\in \mathcal{P}}\left(1-\varepsilon_\gamma z^{|\gamma|}\right),
$$
%where the product 
converges for $|z|$ small enough. It is a polynomial function of degree $|\mathscr T^{(n-1)}|$ in $z$ and vanishes at order $b_1(M)$ at $z=(n+2)^{-1}$.
%The Euler characteristic of a closed surface $\Sigma$ is determined by the numbers $n_k$ of {primitive closed geodesics} in any triangulation of $\Sigma$.
\end{theorem}

%We will see that a
In the above statement, $|\mathscr T^{(n-1)}|$ denotes the cardinality of the $(n-1)-$skeleton. A consequence of \cref{theo:mainfried} is the following result.

\begin{corollary}
 The numbers $n_k$ of all closed geodesic paths of lengths $k \le |\mathscr T^{(n-1)}|$ determine the first Betti number of a compact manifold $M$.
 \end{corollary}
 \begin{proof}
By \cref{theo:mainfried}, expanding $\zeta_\mathscr T(z)$ yields a formal series, which equals a polynomial of degree $|\mathscr T^{(n-1)}|$. Hence all the higher coefficients cancel out. Taking just the product up to $|\gamma| = |\mathscr T^{(n-1)}|$, reducing mod $z^{|\mathscr T^{(n-1)}|}$ and evaluating near $z=(n+2)^{-1}$ recovers the first Betti number.
\end{proof}
\noindent Another straightforward corollary is the following:
\begin{corollary}
The Euler characteristic of a connected surface is fully determined by its \emph{combinatorial} length spectrum, given by the set of pairs $(\varepsilon_\gamma, |\gamma|)$ for $\gamma \in \mathcal P$ with $|\gamma| \leqslant |\mathscr T_1|$.

More generally, the combinatorial data of the triangulation (number of {simplices and of} geodesic loops) is sufficient to recover all the Betti numbers of a triangulated compact manifold of dimension up to 4.
\end{corollary}


In fact, \cref{theo:mainfried} generalizes to polyhedral decompositions, and to the non-compact setting, as we explain now.
We take a polyhedral decomposition $\mathscr T$ of an $n$-dimensional compact manifold $M$. We assume that the $(n-1)$-dimensional polyhedrax bound a constant number $N$ of $(n-2)$-faces, and we call this an $N$-regular polyhedral decomposition. Note that a triangulation is $n$-regular.
Given a quotient $\pi$ of the fundamental group $\pi_1(M)$, it acts on the corresponding cover $\wh{M}$ of $M$,  with a polyhedral decomposition $\wh{\mathscr T}$. This defines a complex $C_*^{(2)}(\mathscr T, \pi)$ of free Hilbert $\mathcal N(\pi)$-modules. As vector spaces these are (typically infinite-dimensional) Hilbert spaces, but the action of $\pi$ endows them with the structure of a direct sum of finitely many copies of the $L^2$-completion $\ell^{(2)}(\pi)$ of $\mathbb{C}\pi$, on which the von Neumann algebra $\mathcal N(\pi)$ acts naturally. The von Neumann algebra is the algebra  of $\pi$-equivariant bounded operators from $\ell^{(2)}(\pi)$ to itself. %makes them finitely generated as modules over the $L^2$-completion $\ell^{(2)}(\pi)$ of the group algebra of $\pi$. 

In turn, we can define a combinatorial Laplacian $\Delta_k^{(2)}$ acting as a
bounded operator on $C_k^{(2)}(\mathscr T, \pi)$, and the von Neumann dimension of its kernel is the $k$-th $L^2$-Betti number $b_k^{(2)}(M, \pi)$. Note that when $\pi$ is trivial, then all this recovers the classical Betti numbers. If $\pi =\pi_1(M)$, then one usually drops the group from the notation and refers to $b^{(2)}_k(M)$ as the $k$-th $L^2$-Betti number of $M$.

We fix a fundamental domain $\mathcal F$ in $\wh{\mathscr{T}}$ for the action of the group $\pi$, and we denote by $\wh{\mathcal P}$ the set of primitive closed geodesics in $\wh{\mathscr{T}}$ which start and end in $\mathcal F$. We prove the following theorem:
\begin{theorem}
\label{theo:mainL2}
The combinatorial zeta function 
$$\zeta_{\wh{\mathscr{T}}}(z) := \prod_{\gamma\in \overline{\wh{P}}}\left(1-\varepsilon_\gamma z^{|\gamma|}\right)
$$
%where the product 
converges for $|z|$ small enough, and it extends as a real analytic function on the disk of diameter $(0, \frac{1}{N+2})$. 
Moreover, if $\Delta_{n-1}^{(2)}$ is \emph{of $\mathcal{N}(\pi)$-determinant class} (see \cref{def:detclass}), then when $z$ tends to $\frac{1}{N+2}$, the function $\zeta_{\wh{\mathscr{T}}}$ behaves as 
$$\zeta_{\wh{\mathscr{T}}}(z) \sim_{z \to \frac{1}{N+2}} \left(\frac 1 z - (N+2)\right)^{b_{1}^{(2)}(M, \pi)} \frac{{\det}_{\mathrm{FK}} (\Delta_{n-1}^{(2)})}{N+2},$$
where ${\det}_{\mathrm{FK}}$ is the Fuglede--Kadison determinant, see \cref{def:detclass}.
\end{theorem}

Note that under the determinant class assumption (which implies that the Fuglede--Kadison determinant ${\det}_{\mathrm{FK}} (\Delta_{n-1}^{(2)})$ is a positive number), this theorem says that the
values of the function $\zeta_{\wh{\mathscr{T}}}$ near  $\frac 1 {N+2}$
recover the first $L^2$-Betti number $b_{1}^{(2)}$ just as in the finite case
(stated as \cref{theo:mainfried}). Note also that $L^2$-Betti numbers need not
to be integers. They are non-negative real numbers (a question of Atiyah asked
if they are always rational, which has been disproved by several examples by
now).
%Of course, if the polyhedral complex $\mathscr T$ realizes a polyhedral decomposition of a compact manifold $M$, then the ($L^2$) Betti numbers of $\mathscr T$ are nothing but the Betti numbers of $M$, and this is the setting in which we have stated \cref{theo:mainfried}, but note that out result is more general.

Concerning the determinant class condition, the determinant conjecture
\cite[Conjecture 13.2]{Lueck} would imply that any of the operators
$\Delta^{(2)}_k$ defined above are of determinant class. This conjecture is
known to be true for a large class $\mathcal G$ of groups described in
\cite[Section 13.1.3]{Lueck} and \cite{Schick}. In particular, $\mathcal G$
contains any lattice in a matrix Lie group (and more generally any residually
finite group), any amenable group, and is closed under extensions with amenable
quotients, colimits, inverse limits, passing to a subgroup and quotients by finite kernels.

Avoiding the validity of the determinant class conjecture, we prove in
\cref{prop:nondet} that the data of the $(n-1)$-th $L^2$ Betti number is
contained in the function $\zeta_{\wh{\mathscr T}}$ together with the
knowledge of the number $|\mathscr T^{(n-1)}|$ of $(n-1)$-dimensional
polyhedra even though we do not assume $\Delta_{n-1}^{(2)}$ to be of
determinant class.
%It is a polynomial function in $z$ and vanishes at order $b_1(M)$ at $z=(n+2)^{-1}$.

An obvious but striking interpretation of \cref{theo:mainL2} is the following:
\begin{corollary}
Counting geodesic loops in $\mathscr T^{(n-1)}$ which represent a conjugacy
class in $\ker (\pi_1(M) \to \pi)$ recovers the first $L^2$-Betti number $b_1^{(2)}(M, \pi)$.
\end{corollary}
In particular, and maybe even more striking, counting homotopically trivial
combinatorial geodesic loops on a surface $\Sigma$ recovers
$b_1^{(2)}(\Sigma)$.

As a last remark, let us notice that we only need our polyhedral decomposition
to be $N$-regular and such that each $(n-1)$-dimensional polyhedron lies in
the boundary of exactly two $n$-dimensional polyhedra. This is weaker than
asking $M$ to be a manifold, it is just asking to be non-singular in
codimension one.
\medbreak

The last result of this paper concerns the linking number of knots.
Recently, the third author and Rivi\`ere showed in \cite{Dang_Riviere} that the linking number $\mathrm{lk}(\kappa_1, \kappa_2)$ of two homologically trivial curves $\kappa_1, \kappa_2$ in the unit tangent bundle of a negatively curved surface can be recovered as the regularized value at $s=0$ of the Poincaré series
$$
\eta(s) = \sum_{c} e^{-s \ell(c)},
$$
where the sum runs over all geodesic paths $c$ joining orthogonally the projections of $\kappa_1$ and of $\kappa_2$ on the surface $\Sigma$ (see also \cite{chaubet2022poincare} for similar results on surfaces with boundary).

Our last result is a combinatorial {analog} of this result. We fix any compact
$3$-manifold  $M$, again with a regular polyhedral decomposition $\mathscr T$.

We let $\mathscr T^\vee$ be the dual  {polyhedral} decomposition of $\mathscr
T$ (see \S\ref{sec:lapl} and  \cref{fig:dual}). Let $\kappa_1$ and $\kappa_2$
be two rationally null-homologous, oriented knots in $M$ which are one-chains
in $\mathscr T$ or $\mathscr T^\vee$, respectively. Note that every pair of null-homologous knots is homologous to such a pair $(\kappa_1, \kappa_2)$.
%\footnote{Every pair of null-homologous knots is homologous to such a pair $(\kappa_1, \kappa_2)$.}. 
We denote by $\mathcal G^\perp(\kappa_1, \kappa_2)$ the set of  {\emph{orthogeodesic paths}} from $\kappa_1$ to $\kappa_2$, that are, geodesic paths $c = (\tau_1, \ldots, \tau_q)$ in the $2$-skeleton of $\mathscr T$ such that the first polyhedron $\tau_1$ of $c$ bounds part of $\kappa_1$, and $\kappa_2$ intersects the last polyhedron $\tau_q$ of $c$, as in  \cref{fig:link}.

For $c \in \mathcal G^\perp(\kappa_1, \kappa_2)$, we denote by $\varepsilon_c \in \{-1, 1\}$ its reversing index and by $m_c \in \ZZ$ its \textit{incidence number} on $(\kappa_1, \kappa_2)$; we refer to \S\ref{sec:link} for a proper definition of these quantities --- we nevertheless mention that if the knots $\kappa_j$ are \textit{simple}, in the sense that each $1$-simplex of $\mathscr T$ and $\mathscr T^\vee$ appears at most one time in $\kappa_1$ and $\kappa_2$, then $m_c \in \{-1, 1\}.$

\begin{figure}[h]
\def\svgwidth{0.4\columnwidth}
\includegraphics[scale=0.5]{orthogeodesic.pdf}
\caption{
\label{fig:link} An orthogeodesic $c = (\tau_1, \tau_2, \tau_3, \tau_4)$ linking $\kappa_1$ and $\kappa_2$. The knot $\kappa_1$ is a one-chain in $\mathscr T$ while $\kappa_2$ is a one-chain in $\mathscr T^\vee$.
}
\end{figure}

We prove the following result:
\begin{theorem}
\label{theo:mainlink}
The combinatorial Poincaré series
$$
%\eta(s) = \sum_{c \in \mathcal G^\perp(\kappa_1, \kappa_2)} \frac {\varepsilon_c m_c} {s^{|c|}}
\eta(z) = \sum_{c \in \mathcal G^\perp(\kappa_1, \kappa_2)} \varepsilon_c m_c z^{|c|}
$$ 
converges whenever $|z|$ is large enough. Moreover, it is a rational function, regular at $z=1/(N+2)$, for $N$  the number of hyperfaces of any $2$-dimensional polyhedron in $\mathscr T$, and
$$
\eta\left(\frac 1 {N+2}\right) = \lk(\kappa_1, \kappa_2).
$$
 
\end{theorem}

%Again, the abscissa of convergence of $\eta(s)$ is given explicitely in \cref{theo:link}.

\medbreak

All these results rely on the following simple but fundamental fact (see \cref{prop:Lapl}):
the \emph{combinatorial Laplacian} introduced in \S\ref{sec:lapl} acts on the $(n-1)$-skeleton of any $N$-regular polyhedral complex $\mathscr T$ as
\begin{equation}\label{eq:deltan+2}
\Delta = (N+2) \Id - T
\end{equation}
where $T$ is the transfer matrix of a signed geodesic random walk. {The above fact is
  a topological version of the famous Brydges--Fr\"ohlich--Sokal random walk
  representation widely used in Quantum Field
  Theory~\cite{fernandez2013random, GJ}}.

The random walk we consider is not a random walk on the vertex set of the
triangulation of $\widetilde M$ or $\wh{M}$, but on the set of $n-1$
simplices. The former has been used famously to obtain information about
another topological $L^2$-invariant, namely the lowest Novikov-Shubin
invariant. Here, fundamental work of Varopoulos \cite{Varopoulos} implies that
the lowest Novikov-Shubin invariant is encoded in the sequence $p(n)$, where
$p(n)$ is the probability to return to the starting point after precisely n
steps. Note that this would be related to the number of closed geodesics of
length n in the $1$-skeleton.

In the G\"ottingen doctoral thesis \cite{Hoepfner} of Tim H\"opfner, a
generalization of the result of Varopoulos to Novikov-Shubin invariants of
higher degree $k$ is obtained. H\"opfner shows that they can be obtained from a
suitable signed random walk on the $k$-cells of $\tilde M$. Our article adds
to this 
circle of ideas by expressing the first (by Poincar\'e duality equal to $n-1$)
$L^2$-Betti number via a random walk on the $(n-1)$ skeleton.

\subsection*{Organization of the paper}
%In \S\ref{sec:lapl} we introduce the necessary background needed for this paper. We define the combinatorial Laplacian and prove \eqref{eq:deltan+2}, then we introduce the $L^2$-Betti numbers and related notions in \S\ref{subsec:L2}. 
Preliminary background on combinatorial Laplacians and $L^2$-invariants is gathered in \S\ref{sec:prelim}, where in particular \eqref{eq:deltan+2} is proved.
Then in \S\ref{sec:fried} we prove \cref{theo:mainfried} and \cref{theo:mainL2}, and in \S\ref{sec:link} we prove  \cref{theo:mainlink}.
%The motivation comes from the well-known results of Fried \cite{Fried} (in constant curvature) and Dyatlov--Zworski \cite{DZ} (in variable negative curvature) saying that the Euler characteristic of a closed surface is determined by its length spectrum.
%Our result is a combinatorial analogue of these results. 

%We explain briefly the proof: we introduce a combinatorial Laplacian $\Delta$ acting on the 1-skeleton of the triangulation. As it is a finite matrix, the determinant of the operator $\Delta +z $ is a polynomial in $z$. Moreover, Hodge theory says that it vanishes at order $b_1(\Sigma)=2g(\Sigma)$ at $z=0$. We express this determinant as a series, whose vanishing part at $z=0$ only involves  the $n_k$.
\subsection*{Acknowledgments}
We thank Jean Raimbault for several interesting comments on a preliminary version of our results.
L.B. is partially funded by the Research Training Group 2491 ``Fourier Analysis and Spectral Theory'', University of Göttingen. Y. C. is supported by the Herchel Smith Postdoctoral Fellowship Fund. N.V.D is supported by the Institut Universitaire de France.

\section{Preliminaries}
\label{sec:prelim}
In \S\ref{sec:lapl} we develop the combinatorial setting that will be used throughout the paper, and in \S\ref{subsec:L2} we collect the necessary notions on $L^2$-invariants.
\subsection{Combinatorial Laplacian}
\label{sec:lapl}
%Throughout this note, we will be dealing with a smooth oriented compact manifold $M$ of dimension $n$, together with 
We start with a given smooth triangulation $\mathscr T$ of an $n$-dimensional
manifold $M$, or more generally $\mathscr T$ can be a polyhedral decomposition
of $M$, where we require that the $(n-1)$-dimensional polyhedra have a
constant number $N$ of $(n-2)$-faces in their boundary. We call this an
\emph{$N$-regular polyhedral decomposition}. Observe that in case $\mathscr T$ is
a triangulation, this holds with $N=n$. A reference for polyhedral
complexes and homology is \cite{AS}. Note that, by definition, a polyhedral complex comes together with the choice of an orientation for each cell of the complex.

%Any $k$-simplex of $\mathscr T$ is homeomorphic to the standard $k$-simplex 
%$$\Delta_k  = \biggl\{ \sum_{i=0}^k t_i e_i~:~ \sum_i t_i = 1, ~ 0 \leqslant t_i\leqslant 1 \biggr\} \subset \RR^{k+1},$$ with the orientation induced by the standard basis $(e_0, \ldots, e_k)$ on $\RR^{k+1}$. If $\sigma$ is such a simplex, we will denote its $i$-th face by $\sigma^{(i)}$: it is the subset of $\sigma$ given by $\{t_i = 0\}$ through the previous homeomorphism. 
We fix the convention that the orientation of a polyhedron $\sigma$ provides an orientation for each polyhedron of its boundary, corresponding to the orientation given by the \emph{first vector pointing outward}. 

The boundary of a polyhedron $\sigma$ is given by
$$\partial \sigma = \sum_{\tau \text{ hyperface of } \sigma} \varepsilon(\tau) \tau, $$
where $\varepsilon(\tau) = \pm 1$ according to whether the orientation of $\tau$ coincides or not with the orientation induced by $\sigma$.

We denote by $C_k(\mathscr T)$ the $\ZZ$-module generated by the $k$-dimensional polyhedra of $\mathscr T$. This yields a complex 
$$
0 \overset{\partial}{\longrightarrow} C_n(\mathscr T) \overset{\partial}{\longrightarrow} \cdots \overset{\partial}{\longrightarrow} C_0(\mathscr T) \overset{\partial}{\longrightarrow} 0
$$
whose homology is of course the homology of the manifold $M$.


%In other words, the orientation of $\sigma^{(i)}$ is chosen so that the orientation of $(-1)^i \mathbb R\nu \oplus T\sigma^{(i)}$ coincides with the orientation of $\sigma$, where $\nu$ is any normal outward pointing vector to $\sigma^{(i)}$.
\begin{definition}
\label{def:compa}
A pair of $k$-polyhedra is said to be \textit{admissible} if they share a common $(k-1)$-face, and do not bound  {the} same $(k+1)$-polyhedron. Two $k$-polyhedra forming an admissible pair have a \emph{compatible orientation} if their common $(k-1)$-hyperface  {appears} with opposite  %{orientation} 
sign in their boundaries.
\end{definition}

\iffalse
\begin{figure}[h]
\def\svgwidth{0.8\columnwidth}
\input{orientations.pdf_tex}
\caption{\label{fig1}The standard, positively oriented simplices of dimension 1, 2 and 3, with the induced orientation on the boundary.}
\end{figure}
\fi

A dual complex $\mathscr T^\vee$ of the complex $\mathscr T$ is a polyhedral decomposition of $M$, constructed as follows (see also \cref{fig:dual}). 
%Take the barycentric subdivision of $\mathscr T$,
The 0-cells of $\mathscr T^\vee$ are interior points of the top simplices of $\mathscr T$, 1-cells of $\mathscr T^\vee$ are edges joining two 0-cells when there is a face between the two corresponding top simplices of $\mathscr T$, and intersecting this face transversely once, and so on. This defines a Hodge star map
$$
\star \colon C_i(\mathscr T) \to C_{n-i}(\mathscr T^\vee),
$$
where the orientation of $\star \sigma$ is chosen so that at the intersection of $\sigma$ with $\star \sigma$, 
%$\sigma \wedge \star \sigma$ is positively oriented. 
the orientation of $M$ induced by $\sigma$ followed by $\star \sigma$ is positive.
\begin{figure}[h]
\caption{
\label{fig:dual}
A $2$-dimensional triangulation $\mathscr T$ (in black), together with a dual {polyhedral} decomposition $\mathscr T^\vee$ (in red).
}
\vspace{0.2cm}
\includegraphics[scale=0.45]{dual_decomposition.pdf}
\end{figure}
%In particular, if $n=2$  then for each edge $e$, the edge $\star e$ is simply the rotation of angle $\pi/2$  {counterclockwise} around its midpoint. 
\iffalse
\begin{figure}[h]
\def\svgwidth{0.5\columnwidth}
\input{dual.pdf_tex}
\caption{\label{fig2} A positive 3-simplex and its dual complex (in blue). In particular the dual of the left face is oriented accordingly.}
\end{figure}
\fi
Since $\mathscr T$ is a dual complex of $\mathscr T^\vee$, we have a map $\star : C_\bullet(\mathscr T^\vee) \to C_\bullet(\mathscr T)$, and our choice of orientation yields
\begin{equation}\label{eq:involution}
\star^2 = (-1)^{k(n-k)} \mathrm{Id} \quad \text{on} \quad C_k(\mathscr T)
\end{equation}
for each $k = 0, \dots, n$. 

The family of oriented $k$-dimensional polyhedra of $\mathscr T$ defines a basis $\beta_k$ of the complex $C_k(\mathscr T)$ for all $k$ and we define a scalar product $\langle \cdot, \cdot \rangle$ on $C_k(\mathscr T)$ by declaring that this family is an orthonormal basis.
We let $\partial^\star : C_\bullet(\mathscr T) \to C_{\bullet + 1}(\mathscr T)$ be the adjoint operator of $\partial$ with respect to $\langle \cdot, \cdot \rangle$, which is defined by
$$
\langle \partial \sigma, \tau \rangle = \langle \sigma, \partial^\star \tau \rangle
$$
for every $\sigma \in C_k(\mathscr T)$ and $\tau \in C_{k-1}(\mathscr T)$. Then 
%using the fact that $\sigma \wedge \star \sigma$ is positively oriented for each $\sigma$ 
our orientation convention for $\star$ and the formula \eqref{eq:involution} imply that
\begin{equation}\label{eq:partialstar}
\partial^\star = (-1)^{n(k + 1)} \star \partial \star \quad \text{on} \quad C_k(\mathscr T).
\end{equation}

\begin{definition}
The \emph{combinatorial Laplacian} is the operator
$$\Delta = \partial \partial^\star + \partial^\star \partial \colon C_\bullet(\mathscr T) \to C_\bullet(\mathscr T).$$
\end{definition}

The results we will prove in this paper all rely on the following proposition:
%simple observation:
\begin{proposition}
\label{prop:Lapl}
% In the natural basis $\beta_{n-1}$ of $C_{n-1}(\mathscr T)$, t
The combinatorial Laplacian satisfies
$$\Delta_{n-1} = (N+2) \Id - T$$ 
where $T$ % = (T_{\sigma, \tau})_{\sigma, \tau \in \beta_{n-1}}$
is the
\emph{transfer signed random walk operator} defined in terms of the basis
$\beta_{n-1}$ by
\begin{equation*}
  T(\tau) = \sum_{\substack{\sigma\in\beta_{n-1} \\(\sigma,\tau)\text{ admissible}}}
  \varepsilon_{\tau, \sigma} \sigma,\qquad\tau\in\beta_{n-1},
\end{equation*}
with $\varepsilon_{\tau,\sigma}=1$ if $\sigma$ and $\tau$ have compatible
orientations and $\varepsilon_{\tau,\sigma}=-1$ otherwise.
% symmetric matrix defined as follows:
%  \begin{itemize}
%  \item if $(\sigma, \tau)$ is not admissible (see \cref{def:compa}), then 
%  $
%  T_{\sigma, \tau} = 0;
%  $
%  \vspace{0.2cm}
%  \item if $(\sigma, \tau)$ is admissible, then 
%  $T_{\sigma, \tau} = 1$ if $\sigma$ and $\tau$ have compatible {orientations}, and  $T_{\sigma, \tau} = -1$ otherwise.
%  \end{itemize}
\end{proposition}


%The matrix $T$ is sometimes called the random walk transfer matrix.
\begin{proof}
%An illustration of the proof in dim 2 is drawn in \cref{fig:3}.
\iffalse
\begin{figure}[h]
\caption{\label{fig:3} Computations of $-\partial \partial^\star e = \partial \star \partial \star e$ (up on the left) and of $-\partial^\star \partial e : \star \partial \star \partial e$ (up on the right). We summarize with $-\Delta e$ (below).}
\begin{tikzpicture}
\begin{scope}[very thin,nodes={sloped,allow upside down}]     	\tikzset{
  arrow/.pic={\path[tips,every arrow/.try,->,>=#1] (0,0) -- +(.1pt,0);},
  pics/arrow/.default={triangle 90}}
      \tikzset{enclosed/.style={draw, circle, inner sep=0pt, minimum size=.15cm, fill=black}}

      \node[enclosed] (A) at (0,3.25) {};
      \node[enclosed] (B) at (3,4) {};
      \node[enclosed] (C) at (4.5,2) {};
      \node[enclosed] (D) at (3,0) {};
      \node[enclosed] (E) at (1,1.5) {};
      \node[enclosed] (F) at (2.5,1.5) {};
      \node[enclosed] (G) at (0,0) {};

	\draw (A) -- (E){};
	\draw (E) -- pic[pos=.3, red]{arrow} pic[pos=.7, red]{arrow}(F) node[midway, above]  {$e$};
	\draw (A) -- (B){};
	\draw (A) -- (G){};
	\draw (B) --pic[red]{arrow} (E){};
	\draw (F) --pic[red]{arrow} (B){};
	\draw (G) -- (E){};
	\draw (G) -- (D){};
	\draw (D) --pic[red]{arrow} (E){};
	\draw (F) --pic[red]{arrow} (D){};
	\draw (D) -- (C){};
	\draw (C) -- (F){};
	\draw (B) -- (C){};
\end{scope}
\end{tikzpicture}
\begin{tikzpicture}
\begin{scope}[very thin,nodes={sloped,allow upside down}]     	\tikzset{
  arrow/.pic={\path[tips,every arrow/.try,->,>=#1] (0,0) -- +(.1pt,0);},
  pics/arrow/.default={triangle 90}}
      \tikzset{enclosed/.style={draw, circle, inner sep=0pt, minimum size=.15cm, fill=black}}

      \node[enclosed] (A) at (0,3.25) {};
      \node[enclosed] (B) at (3,4) {};
      \node[enclosed] (C) at (4.5,2) {};
      \node[enclosed] (D) at (3,0) {};
      \node[enclosed] (E) at (1,1.5) {};
      \node[enclosed] (F) at (2.5,1.5) {};
      \node[enclosed] (G) at (0,0) {};

	\draw (E) -- pic[red]{arrow}(A){};
	\draw (E) -- pic[pos=.3, red]{arrow} pic[pos=.7, red]{arrow}(F) node[midway, above]  {$e$};
	\draw (A) -- (B){};
	\draw (A) -- (G){};
	\draw (E) --pic[red]{arrow} (B){};
	\draw (B) --pic[red]{arrow} (F){};
	\draw (E) --pic[red]{arrow} (G){};
	\draw (G) -- (D){};
	\draw (E) --pic[red]{arrow} (D){};
	\draw (D) --pic[red]{arrow} (F){};
	\draw (D) -- (C){};
	\draw (C) --pic[red]{arrow} (F){};
	\draw (B) -- (C){};
\end{scope}
\end{tikzpicture}
\begin{tikzpicture}
\begin{scope}[very thin,nodes={sloped,allow upside down}]     	\tikzset{
  arrow/.pic={\path[tips,every arrow/.try,->,>=#1] (0,0) -- +(.1pt,0);},
  pics/arrow/.default={triangle 90}}
      \tikzset{enclosed/.style={draw, circle, inner sep=0pt, minimum size=.15cm, fill=black}}

      \node[enclosed] (A) at (0,3.25) {};
      \node[enclosed] (B) at (3,4) {};
      \node[enclosed] (C) at (4.5,2) {};
      \node[enclosed] (D) at (3,0) {};
      \node[enclosed] (E) at (1,1.5) {};
      \node[enclosed] (F) at (2.5,1.5) {};
      \node[enclosed] (G) at (0,0) {};

	\draw (E) -- pic[red]{arrow}(A){};
	\draw (E) -- pic[pos=.2, red]{arrow} pic[pos=.4, red]{arrow} pic[pos=.6, red]{arrow} pic[pos=.8, red]{arrow}(F) node[midway, above]  {$e$};
	\draw (A) -- (B){};
	\draw (A) -- (G){};
	\draw (E) --(B){};
	\draw (B) -- (F){};
	\draw (E) --pic[red]{arrow} (G){};
	\draw (G) -- (D){};
	\draw (E) -- (D){};
	\draw (D) -- (F){};
	\draw (D) -- (C){};
	\draw (C) --pic[red]{arrow} (F){};
	\draw (B) -- (C){};
\end{scope}
\end{tikzpicture}
\end{figure}
\fi
Given $\sigma_1, \sigma_2$ two polyhedra in the basis  $\beta_{n-1}$, we compute 
$$\langle \Delta \sigma_1, \sigma_2\rangle = \langle \partial^\star \sigma_1, \partial^\star \sigma_2\rangle + \langle \partial \sigma_1, \partial \sigma_2\rangle.$$
Note that for $j = 1,2$, there are exactly two $n$-dimensional polyhedra $\tau^+_j, \tau^-_j$ such that 
$$
\partial^\star \sigma_j = \tau^+_j + \tau^-_j.
$$
They are oriented such that $\langle \partial \tau^{\pm}_j, \sigma_j \rangle = \pm 1$.
We distinguish four cases:
\begin{enumerate}
\item If $\sigma_1 = \sigma_2$, then $\tau_1^\pm = \tau_2^\pm$ and thus $\langle \partial^\star \sigma_1, \partial^\star \sigma_2\rangle = \langle \tau^+_1 + \tau^-_1, \tau^+_1 + \tau^-_1 \rangle = 2$. On the other hand, $\partial \sigma_1$ consists of $N$ polyhedra of dimension $(n-2)$, hence 
$\langle \partial \sigma_1, \partial \sigma_2\rangle = N$ and we conclude
$$
\langle \Delta \sigma, \sigma \rangle = N+2.
$$
\item
If $\sigma_1$ and $\sigma_2$ lie in the boundary of a common $n$-dimensional
polyhedron~$\tau$, then up to {flipping} the orientation of $\sigma_1$ and/or that of $\sigma_2$, one can assume that $\tau^+_1 = \tau^{+}_2 = \tau$. In particular $\sigma_1$ and $\sigma_2$ both appear positively in $\partial \tau$, so that
$$\langle \partial^\star \sigma_1, \partial^\star\sigma_2\rangle = +1.$$
Of course, in this situation there is exactly one $(n-2)$-dimensional polyhedron $\nu$ appearing in both $\partial \sigma_1$ and $\partial \sigma_2$; then we claim that
$$
\langle \partial \sigma_1, \partial \sigma_2\rangle = -1.
$$
To prove this, consider the chain
$\partial^2 \tau$. The $(n-2)$-dimensional polyhedron $\nu$ appears exactly twice: once in $\partial \sigma_1$ and once in $\partial \sigma_2$. Since $\partial^2 \tau = 0$, it follows that $\nu$ appears once positively and once negatively, which gives the sought result, and thus we get $\langle \Delta \sigma_1, \sigma_2 \rangle = 0.$
\item
If $\sigma_1$ and $\sigma_2$ share a common $(n-2)$-face, but are not in the boundary of a common $n$-dimensional polyhedron, then 
$\langle \partial^\star \sigma_1, \partial^\star \sigma_2 \rangle = 0$, and $\langle \partial \sigma_1, \partial \sigma_2\rangle = \pm 1$. Moreover, if $\sigma_1$ and $\sigma_2$ have compatible orientations, then $\langle \partial \sigma_1, \partial \sigma_2\rangle = -1$ and $\langle \partial \sigma_1, \partial \sigma_2\rangle =+1$ otherwise.
\item 
Finally, if $\sigma_1$ and $\sigma_2$ do not share a common face, then both $\langle \partial^\star \sigma_1, \partial^\star \sigma_2 \rangle$ and $\langle \partial \sigma_1, \partial \sigma_2 \rangle$ vanish.
\end{enumerate}
The proof is complete.
\end{proof}

\iffalse
\begin{definition}
\label{def:geod}
We say that a path along $(n-1)$-dimensional polyhedron of $\mathscr T$ is \emph{geodesic} if it satisfies the rule of the random walk, namely to consecutive simplices must be adjacent,
%with compatible orientation
and shall not bound a common $n$-simplex. A closed geodesic path is a geodesic loop (or just a closed geodesic). 
%It is \emph{prime} if it cannot be written as t
\end{definition}
\fi



\subsection{$L^2$-invariants}
\label{subsec:L2}
In this subsection, we specialize to the case where the polyhedral complex
defined in the previous subsection admits a free co-compact action of a group $\pi$ preserving the polyhedral structure. In this setting, we will denote by $\wh{\mathscr{T}}$ the complex, and by $\mathscr T = \wh{\mathscr{T}} / \pi$ the quotient, which we assume to be a polyhedral decomposition of a compact manifold $M$ of dimension $n$. In other words, $\pi$ is a quotient of $\pi_1(M)$ and $\wh{\mathscr{T}}$ is a polyhedral decomposition of the (in general non-compact) corresponding covering $\wh{M}$ of $M$.

The action of $\pi$ on $\wh{\mathscr{T}}$ gives the spaces $C_k(\wh{\mathscr{T}})$ the structure of free $\ZZ[\pi]$-modules of rank $c_k = \dim C_k(\mathscr T)$. The combinatorial Laplacian $\Delta_k$ described in \cref{sec:lapl} acts on $C_k(\wh{\mathscr{T}})$ as a $\pi$-equivariant operator, in the sense that
$$
\Delta_k (\alpha \cdot \hat \sigma) = \alpha \cdot \Delta_k \hat \sigma, \quad \hat \sigma \in C_k(\wh{\mathscr T}), \quad \alpha \in \pi,
$$
and so does the transfer operator $T$ defined in \cref{prop:Lapl}. 
%Hence they induce matrices $\Delta^{(2)}_k \in  M({c_k},\ZZ[\pi])$ and $T^{(2)} \in M({c_{n-1}},\ZZ[\pi])$.
Note that any choice of lifts $\{\widehat{\sigma}_i^k\}$ of a finite basis $\{\sigma_i^k\}$ of $C_k({\mathscr T})$ yields a finite basis of $C_k(\wh{\mathscr T})$ as a free $\ZZ[\pi]$-module.


Complexifying coefficients, we may see $C_k(\wh{\mathscr T})$ as a $\mathbb C[\pi]$-module, yielding a complex vector space, generated by elements of the form
$$
\alpha \cdot \hat \sigma^i_k, \quad \alpha \in \pi, \quad i = 1, \dots, c_k(\mathscr T).
$$
We endow this space with a scalar product $\langle \cdot, \cdot \rangle_{L^2}$, defined by
\begin{equation}\label{eq:scalprod}
\left\langle \sum_{\alpha \in \pi} \lambda_\alpha \, \alpha\cdot\widehat{\sigma}_i^k, \, \sum_{\beta\in \pi} \mu_{\beta} \, \beta \cdot \hat \sigma_j^k \right\rangle_{L^2} =  \delta_{i,j}\sum_{\alpha \in \pi} \lambda_\alpha \mu_\alpha.
\end{equation}
We will denote by $C_k^{(2)}(\mathscr T, \pi)$ the Hilbert space given by the completion of $C_k(\wh{\mathscr T})$ with respect to $\langle \cdot, \cdot \rangle_{L^2}$.

Given a bounded $\pi$-equivariant operator $P \colon C_k(\wh{\mathscr{T}}) \to C_k(\wh{\mathscr{T}})$, we define its \emph{von Neumann trace} $\tr_{\mathrm{vN}}P$ by %It might be thought as follows: since $P$ is equivariant, it yields an operator on the finite dimensional quotient $C_k(\mathscr T)$, and $\tr_{\mathrm{vN}}(P)$ is just the trace of this matrix.\\
%More formally, it can be written as 
\begin{equation}
\label{eq:L2tracedef}
\tr_{\mathrm{vN}}P = \sum_{i=1}^{c_k} \langle P\widehat{\sigma}_i^k, \widehat{\sigma}_i^k\rangle_{L^2}.
\end{equation}
Given any $\pi$-invariant closed subspace $F \subset C_k^{(2)}(\mathscr T, \pi)$, we define its \emph{von Neumann dimension} by
$$
\dim_{\mathrm{vN}}F  = \tr_{\mathrm{vN}}\Pi_F,
$$
where $\Pi_F$ is the orthogonal projection on $F$.

The operator $\Delta_k$  induces a bounded, self-adjoint operator $\Delta^{(2)}_k$ operator on  $C_k^{(2)}(\mathscr T, \pi)$. It has real, non-negative,  bounded spectrum. We denote by 
$
\left(E_k(\lambda)\right)_{\lambda \in \RR}
$
the spectral family $\Delta^{(2)}_k$ (\cite[Definition 1.68]{Lueck}). Then the $L^2$-spectral density function of $\Delta_k^{(2)}$ is the map
\begin{align*}
D_k \colon \RR &\to \RR_{\geqslant 0}\\
 \lambda &\mapsto \dim_{\mathrm{vN}} \im E_k(\lambda)
 \end{align*}
By definition, the \emph{$k$-th $L^2$-Betti number $b_k^{(2)}(M, \pi)$} is the von Neumann dimension of $\ker \Delta^{(2)}_k$, so that $b_k^{(2)}(M, \pi) = D_k(0)$.

\begin{definition}
\label{def:detclass}
The Laplacian $\Delta_k^{(2)}$ is said \emph{of determinant class} if the Stieltjes integral
$$\int_{0^+}^\infty \log \lambda \, \dd D_k(\lambda) =
\lim_{\substack{\varepsilon \to 0\\ \varepsilon >0 }}
\int_{\varepsilon}^\infty \log \lambda \, \dd D_k(\lambda) \in \mathbb{R}$$
exists as a real number, and in this case the \emph{Fuglede--Kadison determinant} of $\Delta_k^{(2)}$ is given by
$$
{\det}_{\mathrm{FK}}(\Delta_k^{(2)}) = \exp\int_{0^+}^\infty \log \lambda \,
\dd D_k(\lambda) \in (0,\infty).
$$
\end{definition}
From the definition of the Fuglede--Kadison determinant, it is not hard to see that if a self-adjoint operator $P \colon C_{k}^{(2)}(\mathscr T, \pi) \to C_{k}^{(2)}(\mathscr T, \pi)$ is of determinant class, so is $\nu P$ for any $\nu > 0$, and
\begin{equation}\label{eq:dethom}
{\det}_{\mathrm{FK}} (\nu P) = \nu^{c_k}\, {\det}_{\mathrm{FK}} P.
\end{equation}

\section{First Betti number and combinatorial Ruelle zeta function}
\label{sec:fried}
%Let $K$ be a fixed oriented triangulation of $\Sigma$, and let $K^*$ denote the dual complex: it is a CW-complex consisting of one vertex for each triangle in $K$, one edge joining each pair of such vertices provided they correspond to adjacent faces (hence edges of $K^*$ are in 1:1 correspondence with edges of $K$), and one face for each vertex of $K$. The orientations are prescribed as follows: the Hodge star rotates edges in the direct sense (see \cref{fig:K}), and maps a vertex with positive sign onto its dual face positively oriented.
%
%
%Of course, faces of the complex $K^*$ are not triangles in general (except if one started with a regular triangulation of degree 3).
%
%The induced map $\star \colon C_*(K) \to C_*(K^*)$ is the Hodge star. We define the co-boundary operator $\partial^\star = \star \partial \star \colon C_*(K) \to C_{*+1}(K)$, and the combinatorial Laplacian $\Delta = \partial\partial^\star + \partial^\star\partial$.
%
%An explicit local computation (see \cref{fig:2}) shows the following:
%\begin{proposition} \label{prop:Lapl}
%The Laplacian operator writes
%\begin{equation}
%\label{eq:transfer}
%\Delta = 4 \Id - T
%\end{equation}
%
%where $T$ is a symmetric matrix whose entries are 
%\begin{itemize}
%\item $T_{ij}= 0$ if $i=j$ or $i$ and $j$ does not share a vertex, or are adjacent to the same triangle
%\item $T_{ij}= 1$ if $i$ and $j$ share a vertex with compatible orientation, and do not belong to the same triangle
%\item $T_{ij}= -1$ if $i$ and $j$ share a vertex with opposite orientation, and do not belong to the same triangle.
%\end{itemize}
%\end{proposition}

%\begin{figure}[h]
%\caption{\label{fig:2} Computations of $d\delta e$ (up on the left) and of $\delta d e$ (up on the right). We summarize with $\Delta e$ (below).}
%\begin{tikzpicture}
%\begin{scope}[very thin,nodes={sloped,allow upside down}]     	\tikzset{
%  arrow/.pic={\path[tips,every arrow/.try,->,>=#1] (0,0) -- +(.1pt,0);},
%  pics/arrow/.default={triangle 90}}
%      \tikzset{enclosed/.style={draw, circle, inner sep=0pt, minimum size=.15cm, fill=black}}
%
%      \node[enclosed] (A) at (0,3.25) {};
%      \node[enclosed] (B) at (3,4) {};
%      \node[enclosed] (C) at (4.5,2) {};
%      \node[enclosed] (D) at (3,0) {};
%      \node[enclosed] (E) at (1,1.5) {};
%      \node[enclosed] (F) at (2.5,1.5) {};
%      \node[enclosed] (G) at (0,0) {};
%
%	\draw (A) -- (E){};
%	\draw (E) -- pic[pos=.3, red]{arrow} pic[pos=.7, red]{arrow}(F) node[midway, above]  {$e$};
%	\draw (A) -- (B){};
%	\draw (A) -- (G){};
%	\draw (B) --pic[red]{arrow} (E){};
%	\draw (F) --pic[red]{arrow} (B){};
%	\draw (G) -- (E){};
%	\draw (G) -- (D){};
%	\draw (D) --pic[red]{arrow} (E){};
%	\draw (F) --pic[red]{arrow} (D){};
%	\draw (D) -- (C){};
%	\draw (C) -- (F){};
%	\draw (B) -- (C){};
%\end{scope}
%\end{tikzpicture}
%\begin{tikzpicture}
%\begin{scope}[very thin,nodes={sloped,allow upside down}]     	\tikzset{
%  arrow/.pic={\path[tips,every arrow/.try,->,>=#1] (0,0) -- +(.1pt,0);},
%  pics/arrow/.default={triangle 90}}
%      \tikzset{enclosed/.style={draw, circle, inner sep=0pt, minimum size=.15cm, fill=black}}
%
%      \node[enclosed] (A) at (0,3.25) {};
%      \node[enclosed] (B) at (3,4) {};
%      \node[enclosed] (C) at (4.5,2) {};
%      \node[enclosed] (D) at (3,0) {};
%      \node[enclosed] (E) at (1,1.5) {};
%      \node[enclosed] (F) at (2.5,1.5) {};
%      \node[enclosed] (G) at (0,0) {};
%
%	\draw (E) -- pic[red]{arrow}(A){};
%	\draw (E) -- pic[pos=.3, red]{arrow} pic[pos=.7, red]{arrow}(F) node[midway, above]  {$e$};
%	\draw (A) -- (B){};
%	\draw (A) -- (G){};
%	\draw (E) --pic[red]{arrow} (B){};
%	\draw (B) --pic[red]{arrow} (F){};
%	\draw (E) --pic[red]{arrow} (G){};
%	\draw (G) -- (D){};
%	\draw (E) --pic[red]{arrow} (D){};
%	\draw (D) --pic[red]{arrow} (F){};
%	\draw (D) -- (C){};
%	\draw (C) --pic[red]{arrow} (F){};
%	\draw (B) -- (C){};
%\end{scope}
%\end{tikzpicture}
%\begin{tikzpicture}
%\begin{scope}[very thin,nodes={sloped,allow upside down}]     	\tikzset{
%  arrow/.pic={\path[tips,every arrow/.try,->,>=#1] (0,0) -- +(.1pt,0);},
%  pics/arrow/.default={triangle 90}}
%      \tikzset{enclosed/.style={draw, circle, inner sep=0pt, minimum size=.15cm, fill=black}}
%
%      \node[enclosed] (A) at (0,3.25) {};
%      \node[enclosed] (B) at (3,4) {};
%      \node[enclosed] (C) at (4.5,2) {};
%      \node[enclosed] (D) at (3,0) {};
%      \node[enclosed] (E) at (1,1.5) {};
%      \node[enclosed] (F) at (2.5,1.5) {};
%      \node[enclosed] (G) at (0,0) {};
%
%	\draw (E) -- pic[red]{arrow}(A){};
%	\draw (E) -- pic[pos=.2, red]{arrow} pic[pos=.4, red]{arrow} pic[pos=.6, red]{arrow} pic[pos=.8, red]{arrow}(F) node[midway, above]  {$e$};
%	\draw (A) -- (B){};
%	\draw (A) -- (G){};
%	\draw (E) --(B){};
%	\draw (B) -- (F){};
%	\draw (E) --pic[red]{arrow} (G){};
%	\draw (G) -- (D){};
%	\draw (E) -- (D){};
%	\draw (D) -- (F){};
%	\draw (D) -- (C){};
%	\draw (C) --pic[red]{arrow} (F){};
%	\draw (B) -- (C){};
%\end{scope}
%\end{tikzpicture}
%\end{figure}
\subsection{The compact case}
The purpose of this section is to prove \cref{theo:mainfried}.

\medbreak

Let us fix a compact oriented manifold $M$ of dimension $n$ with a polyhedral decomposition~$\mathscr T$. We assume $\mathscr T$ is regular: that any $(n-1)$-dimensional polyhedron in $\mathscr T$ has exactly $N$ hyperfaces in its boundary.

\begin{definition}
For any closed geodesic $\gamma$, we denote by $n_\gamma$ the \textit{reversing number} of $\gamma$, that is, the number of non compatible pairs appearing in $\gamma$, see \cref{fig:sign}; its sign
$$
\varepsilon_\gamma = (-1)^{n_\gamma}
$$
is called the \textit{reversing index} of $\gamma$.
\end{definition}
For any closed geodesic $\gamma$, we denote by $\gamma^\sharp$ the unique primitive closed geodesic so that $\gamma$ is a power of $\gamma^\sharp$. Recall that $|\gamma^\sharp|$ denotes the length of $\gamma^\sharp$.
%\iffalse
\begin{figure}[h]
\caption{\label{fig:sign} Some closed prime unmarked geodesics $\gamma_i, \, i=1 \ldots 4,$ from left to right. The extra edges are browsed twice (back-and-forth). For the first one on the left, $n_{\gamma_1} = 0$, then $n_{\gamma_2}=1$ and $n_{\gamma_3} = n_{\gamma_4} = 2$.}
\begin{tikzpicture} 
%% vertices
\draw[fill=black] (-3,0) circle (1pt);
\draw[fill=black] (-2,0) circle (1pt);
\draw[fill=black] (-2,1) circle (1pt);
\draw[fill=black] (-3,1) circle (1pt);
%%% edges
\draw[-Stealth] (-3,0) -- (-2.5,0);
\draw[-Stealth] (-2,0) -- (-2,0.5);
\draw[-Stealth] (-2,1) -- (-2.5,1);
\draw[-Stealth] (-3,1) -- (-3,0.5);
\draw (-2.5,0) -- (-2,0);
\draw (-2,0.5) -- (-2,1);
\draw (-2.5,1) -- (-3,1);
\draw (-3,0.5) -- (-3,0);

 %% vertices
\draw[fill=black] (0,0) circle (1pt);
\draw[fill=black] (1,0) circle (1pt);
\draw[fill=black] (1,1) circle (1pt);
\draw[fill=black] (0,1) circle (1pt);
\draw[fill=black] (-0.4,-0.4) circle (1pt);
%%% edges
\draw[-Stealth] (0,0) -- (0.5,0);
\draw[-Stealth] (1,0) -- (1,0.5);
\draw[-Stealth] (1,1) -- (0.5,1);
\draw[-Stealth] (0,1) -- (0,0.5);
\draw[-Stealth] (-0.4,-0.4) -- (-0.15, -0.15);
\draw (0.5,0) -- (1,0);
\draw (1,0.5) -- (1,1);
\draw (0.5,1) -- (0,1);
\draw (0,0.5) -- (0,0);
\draw (-0.15, -0.15) -- (0,0);

 %% vertices
\draw[fill=black] (3,0) circle (1pt);
\draw[fill=black] (4,0) circle (1pt);
\draw[fill=black] (4,1) circle (1pt);
\draw[fill=black] (3,1) circle (1pt);
\draw[fill=black] (2.6,-0.4) circle (1pt);
\draw[fill=black] (4.4,1.4) circle (1pt);

%%% edges
\draw[-Stealth] (3,0) -- (3.5,0);
\draw[-Stealth] (4,0) -- (4,0.5);
\draw[-Stealth] (4,1) -- (3.5,1);
\draw[-Stealth] (3,1) -- (3,0.5);
\draw[-Stealth] (2.6,-0.4) -- (2.85, -0.15);
\draw[-Stealth] (4,1) -- (4.25, 1.25);
\draw (3.5,0) -- (4,0);
\draw (4,0.5) -- (4,1);
\draw (3.5,1) -- (3,1);
\draw (3,0.5) -- (3,0);
\draw (2.85, -0.15) -- (3,0);
\draw (4.25, 1.25) -- (4.4,1.4);

 %% vertices
\draw[fill=black] (6,0) circle (1pt);
\draw[fill=black] (7,0) circle (1pt);
\draw[fill=black] (7,1) circle (1pt);
\draw[fill=black] (6,1) circle (1pt);

%%% edges
\draw[-Stealth] (6,0) -- (6.5,0);
\draw[-Stealth] (7,0) -- (7,0.5);
\draw[arrows = {-Stealth[reversed]}] (7,1) -- (6.5,1);
\draw[-Stealth] (6,1) -- (6,0.5);
\draw (6.5,0) -- (7,0);
\draw (7,0.5) -- (7,1);
\draw (6.5,1) -- (6,1);
\draw (6,0.5) -- (6,0);
\end{tikzpicture}

\end{figure}
%\fi
%We also denote by $n_k$ the number of marked geodesic loops (non-necessarily prime) of length. 

\begin{lemma}
\label{prop:trace}
For each $k = 1, 2, \dots$, it holds
\begin{equation}
\label{eq:transfer}
\tr T^k = 
%n_k = 
\sum_{|\gamma| = k} \varepsilon_\gamma |\gamma^\sharp|,
\end{equation}
where the sum runs over all closed geodesic (not necessary primitive).
\end{lemma}
%\begin{remark}
%Here we forbid closed geodesics going through two consecutive edges in a triangle, but we allow backtracks. In particular, we see that $n_2=2|E|$ is twice the number of edges of the triangulation. Note that $n_3=0$.
%\end{remark}
\begin{proof}
For $\sigma \in \beta_{n-1}$, the diagonal coefficient 
$$
(T^k)_{\sigma, \sigma}= \sum_{\sigma_1, \ldots, \sigma_{k-1}} T_{\sigma, \sigma_1}T_{\sigma_1, \sigma_2} \ldots T_{\sigma_{k-1}, \sigma}
$$
computes the signed number of closed paths of length $k$ starting at the simplex $\sigma$, since by definition we have
$$
T_{\sigma, \sigma_1}T_{\sigma_1, \sigma_2} \ldots T_{\sigma_{k-1}, \sigma} = \varepsilon_\gamma
$$
whenever $\gamma$ is represented by the path $(\sigma, \sigma_1, \dots, \sigma_{k-1})$. Moreover, each closed geodesic $\gamma$ will appear exactly $|\gamma^\sharp|$ times in $\tr T^k$, which concludes the proof.
\end{proof}

With this trace formula in hand, let us prove \cref{theo:mainfried}, which we recall here. The transfer matrix $T$ is defined in \cref{prop:Lapl}.
\begin{theorem}\label{theo:fried}
Let $\rho(T)$ be the spectral radius of the transfer matrix $T$. Then for $|z|<\rho(T)^{-1}$ we have
\begin{equation}\label{eq:zetaprod}
\zeta_{\mathscr T}(z) = \prod_{\gamma \in \mathcal{P}}\left(1-\varepsilon_\gamma z^{|\gamma|}\right) = \det\left(\mathrm{Id} - z T\right).
\end{equation}
In particular, $\zeta_{\mathscr T}(z)$ extends as a polynomial function on $\CC$. 
Moreover, it vanishes  at $z=(N+2)^{-1}$ with order $b_1(M)$.
\end{theorem}


\begin{proof}
Using $\log(\det(A))=\tr(\log(A))$ and the power series of $\log$, we have 
$$
\begin{aligned}
\det(\mathrm{Id} - zT) &= \exp \left(- \sum_{k=1}^\infty \frac{z^k}{k} \tr T^k
\right)&= \exp\left( - \sum_{k = 1}^\infty \frac{z^k}{k} \sum_{|\gamma| = k} \varepsilon_\gamma |\gamma^\sharp|\right).
\end{aligned}
$$
Now we have $\displaystyle{\sum_{|\gamma| = k} \varepsilon_\gamma |\gamma^\sharp| = \sum_{\gamma \in \mathcal P} |\gamma|\sum_{p~:~p|\gamma| = k}\varepsilon_\gamma^p}$, hence one gets
$$
\begin{aligned}
\det(\mathrm{Id} - zT) &= \exp \left(- \sum_{\gamma \in \mathcal P} |\gamma| \sum_{p=1}^\infty\frac{z^{p|\gamma|}}{p|\gamma|} \varepsilon_\gamma^p\right) \\
&= \prod_{\gamma \in \mathcal P} \exp \left(- \sum_p \frac{\left(\varepsilon_\gamma z^{|\gamma|}\right)^p}{p}\right),
\end{aligned}
$$
which proves \cref{eq:zetaprod}. Finally, by \cref{prop:Lapl}, we have
$$
\det(\mathrm{Id} - zT) = z^{\dim C_{n-1}(\mathscr T)} \det\left(\frac{1 - z(N+2)}{z} \mathrm{Id} - \Delta_{n-1} \right)
$$
where $\Delta_{n-1}  = \Delta|_{C_{n-1}(\mathscr T)}$. However, finite
dimensional Hodge theory gives
$$\dim \ker \Delta_{n-1} = b_{n-1}(M),$$
hence Poincar\'e duality yields that $\det(\mathrm{Id} - zT)$ vanishes at order $b_1(M)$ at $z = (N+2)^{-1}$. This completes the proof.
%Using \eqref{eq:transfer}, for $\Re(z)$ big enough one writes
%\begin{eqnarray*}
%\det(\Delta_{C^1}+z)&=&\det(4\Id-T+z)\\
%&=&(4+z)^{\vert E\vert}\det(\Id- (4\Id+z)^{-1} T)\\
%&=&(4+z)^{\vert E\vert}\exp\left(\tr\log (\Id- (4\Id+z)^{-1} T)\right)\\
%&=&(4+z)^{\vert E\vert}\exp\left( \sum_{k=1}^\infty (4+z)^{-k} \frac{\tr(  T^k)
%}{k}\right)\\
%&=&(4+z)^{\vert E\vert}\exp\left( \sum_{k=1}^\infty (4+z)^{-k} \frac{n_k
%}{k}\right).
%\end{eqnarray*}
%Now the first term $(4+z)^{\vert E\vert}$ does not vanish at $z=0$, hence the function  $\exp\left( \sum_{k=1}^\infty (4+z)^{-k} \frac{n_k}{k}\right)$ vanishes at $z=0$ at order $b_1(\Sigma)$.
%It proves the theorem.
\end{proof}

\subsection{The non-compact case: $L^2$-Betti numbers}
In this section we consider the setting of \cref{subsec:L2}: the compact
manifold $M$ with polyhedral decomposition $\mathscr T$ comes with a covering $\wh{M}$ corresponding to a quotient $\pi$ of the fundamental group $\pi_1(M)$. The decomposition $\mathscr T$ lifts as $\wh{\mathscr{T}}$, for which we fix a basis $\{\hat{\sigma}^{n-1}_i\}_{i=1, \ldots c_{n-1}}$ for the space $C_{n-1}(\wh{\mathscr{T}})$ as $\ZZ[\pi]$-module.

We denote by $\wh{\mathcal P}$ the set of primitive closed geodesics in $\wh{\mathscr{T}}$ starting from one of the $\hat{\sigma}^{n-1}_i$.
Recall that $T$ is the transfer operator associated to the geodesic random walk on $\wh{\mathscr T}$ described in \cref{prop:Lapl}.

Then \cref{prop:trace} holds true in this setting, namely:
\begin{lemma}
\label{prop:L2trace}
For each $k = 1, 2, \dots$, it holds
\begin{equation}
\label{eq:transferL2}
\tr_{\mathrm{vN}} T^k = 
%n_k = 
\sum_{|\gamma| = k} \varepsilon_\gamma |\gamma^\sharp|,
\end{equation}
where the sum runs over all closed geodesic (not necessary primitive) which start at one of the $\hat{\sigma}^{n-1}_i$.
\end{lemma}
\begin{proof}
Using the definition of the von Neumann trace given in \cref{eq:L2tracedef}, the proof is exactly the same as for \cref{prop:trace}.
\end{proof}

Now we prove \cref{theo:mainL2}, which we recall here:
\begin{theorem}
The function 
\begin{equation}
\label{zeta}
\zeta_{\wh{\mathscr T}}(z) = \prod_{\gamma \in \overline{\mathcal P}} (1- \varepsilon_\gamma z^{|\gamma|})
\end{equation}
converges for $|z| \ll 1$, and has an analytic extension to the disk of diameter $(0, \frac 1 {N+2})$. Moreover, if $\Delta_{n-1}^{(2)}$ is of determinant class, then
$$
\zeta_{\wh{\mathscr T}}(z) \sim_{z \to (N+2)^{-1}} \left(\frac 1 z - (N+2)\right)^{b_{1}^{(2)}(M, \pi)} \frac{ {\det}_{\mathrm{FK}}(\Delta^{(2)}_{n-1})}{(N+2)^{c_{n-1}}}.
$$
%then its value as $z = \frac 1 {n+2}$ is well defined: it vanishes at order $b_{n-1}^{(2)}(M)$, and is equal to $\det_{L^2}(\Delta_{n-1}^{(2)})$ when $b_{n-1}^{(2)}(M)$ vanishes.
\end{theorem}

\begin{proof}
Since the triangulation $\wh{\mathscr T}$ is a lift of a triangulation of a compact manifold, there is a global upper-bound $K$ on the number of neighbors of any $n-1$ simplex, in particular there are less than $K^k$ primitive closed geodesics of length $k$. It follows that the infinite product \eqref{zeta} converges for $|z| < K^{-1}$.

Now using \cref{prop:L2trace} and the fact that 
$${\det}_{\mathrm{FK}}(\Id - zT) = \exp\left(- \sum_{k=1}^\infty \frac{z^k}{k} \tr_{\mathrm{vN}} T^k
\right)$$
on the real interval $\left]\frac 1 K, \frac 1 K\right[$, one deduces just as in the proof of \cref{theo:fried} that
$$\zeta_{\wh{\mathscr T}}(z) = {\det}_{\mathrm{FK}}(\Id - z T).$$
Note that from \cref{prop:Lapl}, one has $\Delta_{n-1}^{(2)} = (N+2)\Id - T$, hence we obtain
\begin{equation}
\label{eq:zetaL2}
\begin{aligned}
\zeta_{\wh{\mathscr T}}(z) &= {\det}_{\mathrm{FK}}\left((1-z(N+2))\Id + z\Delta_{n-1}^{(2)}\right) \\
&=z^{c_{n-1}} {\det}_{\mathrm{FK}}\left( \left(\frac 1 z -(N+2)\right)\Id + \Delta_{n-1}^{(2)}\right)
\end{aligned}
\end{equation}
where we used \eqref{eq:dethom}. For the rest of the proof, we set $s =z^{-1} -(N+2)$.

First note that for $s \in \left]0, +\infty\right[$, the operator $P(s)= s\, \Id + \Delta_{n-1}^{(2)}$ is self-adjoint with positive spectrum.
We are interested in the behavior of
$$ {\det}_{\mathrm{FK}}\left(s\, \Id + \Delta_{n-1}^{(2)}\right)$$
as $s$ varies in $\left]0, +\infty\right[$ and in particular when $s$ goes to $0$.
Mimicking \cite[Lemma 3.15 (5)]{Lueck}, we first observe that 
the density function of the operator $P(s)$ is just 
$$D_{P(s)}(\lambda) = D_{n-1}(\lambda-s)$$
where $D_{n-1}$ stands for $D_{\Delta^{(2)}_{n-1}}$, the spectral density function of the Laplacian $\Delta^{(2)}_{n-1}$.
We deduce
\begin{align*}
{\det}_{\mathrm{FK}} P(s) 
&=\exp \int_{0^+}^\infty \log \lambda \, \dd D_{n-1}(\lambda-s)\\
%&=\exp \left(\int_{0^+}^\infty \log \lambda \, dD_{n-1}(\lambda -s)\right)\\
&=\exp \int_{-s^+}^\infty \log (\lambda +s) \, \dd D_{n-1}(\lambda)\\
&=\exp \left(\int_{-s^+}^0 \log (\lambda +s) \, \dd D_{n-1}(\lambda) +\int_{0^+}^\infty \log (\lambda +s) \, \dd D_{n-1}(\lambda) \right)
\end{align*}
Since $D_{n-1}(\lambda) = 0$ as long as $\lambda <0$, we obtain 
$${\det}_{\mathrm{FK}} P(s) = s^{D_{n-1}(0)}\exp\int_{0^+}^\infty \log (\lambda +s) \, \dd D_{n-1}(\lambda).$$
This formula defines an analytic function of $s$ in the region $\{\Re s > 0\}$, which proves the second claim of the theorem.

Moreover, since $\Delta_{n-1}^{(2)}$ is of determinant class and $D_{n-1}(0) = b_{n-1}^{(2)}(\mathscr T, \pi)$, we obtain
$$
{\det}_{\mathrm{FK}} P(s) \sim_{s \to 0} s^{b_{n-1}^{(2)}(\mathscr T, \pi)} {\det}_{\mathrm{FK}}\Delta_{n-1}^{(2)}.
$$
Inserting this in \eqref{eq:zetaL2}, this concludes the proof.
\end{proof}

Without the determinant class assumption, we cannot make sense of the limit of ${\det}_{\mathrm{FK}}P(s)$ as $s$ goes to zero. Nevertheless, the function $\chi$ defined by
$$
\chi(s) = {\det}_{\mathrm{FK}}(s \, \Id + \Delta_{n-1}^{(2)})
$$
is still real-analytic on $\left]0, +\infty\right[$, and we can prove that its behavior at infinity contains the information of $b_{n-1}^{(2)}(M, \pi)$, albeit rather indirectly. 

Indeed, consider the function $\Psi$ defined by
\begin{align*}
\Psi(s) &= \chi(s^{-1}) - c_{n-1}(\mathscr T) \log (s^{-1}).
\end{align*}
Then a simple computation using $D_{n-1}(\lambda) = c_{n-1}(\mathscr T)$ for $\lambda > \|\Delta^{(2)}_{n-1}\|$ shows that
$$
\Psi(s) = \int_{0}^{\|\Delta^{(2)}_{n-1}\|} \log(1 + s \lambda) \dd D_{n-1}(\lambda),
$$
where we emphasize that the integral is over $\bigl[0, \|\Delta^{(2)}_{n-1}\|\bigr]$ and not $\bigl]0, \|\Delta^{(2)}_{n-1}\|\bigr]$.
Hence $\Psi(s)$ extends as a real-analytic function at $s=0$, and can be expanded for small $s$ as
\begin{align*}
\Psi(s) &= \sum_{k=1}^\infty (-1)^{k-1} \frac {s^k} k \int_0^{\Vert \Delta_{n-1}^{(2)} \Vert} \lambda^k \, \dd D_{n-1}(\lambda) = \sum_{k=1}^\infty (-1)^{k-1} \frac {s^k} k \tr_{\mathrm{vN}}\left((\Delta_{n-1}^{(2)})^k\right).\\
\end{align*}
Consequently, the function $\Psi(s)$ determines and is determined around $s=0$ by the family $\left\{\tr_{\mathrm{vN}}\left((\Delta_{n-1}^{(2)})^k\right)\right\}_k$. Now in its turn, this family determines the function
$$\tr_{\mathrm{vN}} \exp(-t \Delta_{n-1}^{(2)}) = \sum_k \frac{(-t)^k }{k!}\tr_{\mathrm{vN}}\left((\Delta_{n-1}^{(2)})^k\right),$$ 
and the latter tends to $b_{n-1}^{(2)}(M, \pi)$ as $T$ goes to $\infty$.
Summarizing this, we obtain the following result.
\begin{proposition}
\label{prop:nondet}
The function $\zeta_{\wh{\mathscr T}}$ and the data of $c_{n-1}(\mathscr T)$ determine $b_{n-1}^{(2)}(M, \pi)$.
\end{proposition}
\section{Combinatorial linking number}
\label{sec:link}
In this section we prove \cref{theo:mainlink}. We take a compact oriented 3-manifold~$M$ with an $N$-regular polyhedral decomposition $\mathscr T$ and we let $\mathscr T^\vee$ be a dual {polyhedral} decomposition of $\mathscr T$. Take two oriented knots $\kappa_1 \in C_1(\mathscr T)$ and $\kappa_2 \in C_1(\mathscr T^\vee)$, which we assume to be rationally homologically trivial in $M$, in the sense that there are integers $p_1, p_2$ and $2$-dimensional chains $\sigma_1 \in C_2(\mathscr T)$ and $\sigma_2 \in C_2(\mathscr T^\vee)$ such that 
$$
\partial \sigma_j =p_j \kappa_j, \quad j = 1,2.
$$
%and we want to compute the linking number of two disjoint closed curves $\gamma_1$ and $\gamma_2$ in $M$, provided that they both represent trivial classes in homology. 
%To do so, assume that $M$ is given a triangulation $K$, such that after a homotopy relative to $\gamma_2$, the curve $\gamma_1$ can be made a cycle in the one-skeleton $K^{(1)}$ of $K$. Denoting by $K^*$ the dual complex, we also assume that $\gamma_2$ is a cycle in its one-skeleton\footnote{It's probably the same as asking $\gamma_2$ to be transverse to $K^{(2)}$}.
%By assumption, there exists a two-chain $D_1 \in C_2(K)$, such that $\partial D= \gamma_1$, and the linking number is
Recall that the linking number of $\kappa_1$ and $\kappa_2$ is defined as the algebraic intersection number of $\sigma_1$ with $\kappa_2$ divided by $p_1$, which can be written  
\begin{equation}\label{eq:deflk}
\lk(\kappa_1, \kappa_2) =
% \sharp\, (\sigma_1 \cap \kappa_2)
\frac 1 {p_1} \langle \sigma_1, \star \kappa_2 \rangle.
\end{equation}
%where $\sharp\,\sigma_1 \cap \kappa_2$ denotes the algebraic intersection between $\sigma_1$ and $\kappa_2$. 
%\textcolor{red}{In fact, our results extend also to the case where only $\kappa_1$ is trivial in rational homology, it means there is some integer $p\in \mathbb{Z}$ such that $p\kappa_1$ bounds $\sigma_1$, we choose $p$ to be the smallest such integer and $\kappa_2$ is just a cycle. In this case, we define the linking number to be~:
%\begin{equation}\label{eq:deflk2}
%\lk(\kappa_1, \kappa_2) =
%% \sharp\, (\sigma_1 \cap \kappa_2)
%\frac{1}{p}\langle \sigma_1, \star \kappa_2 \rangle.
%\end{equation}
%It is immediate to prove that this number is both rational and a topological invariant when $\kappa_2$ is trivial in rational homology. In case $\kappa_2$ is a non trivial cycle, then only $\lk(\kappa_1, \kappa_2)\text{mod}\left(\frac{\mathbb{Z}}{p}\right)$ is a topological invariant.
%}

Our aim is to compute this quantity with combinatorial means. 
We define $\mathcal G^\perp(\kappa_1, \kappa_2)$ {to be} the set of {\emph{orthogeodesic paths}} from $\kappa_1$ to $\kappa_2$, i.e.~geodesic paths $c = (\tau_1, \ldots, \tau_k)$ (in the sense of the introduction) in the $2$-skeleton of $\mathscr T$ such that 
$$
|\langle \partial \tau_1, \kappa_1\rangle| > 0 \quad \text{ and } \quad 
%|\sharp\, (\tau_k \cap \kappa_2)| > 0.
|\langle \tau_k, \star \kappa_2 \rangle | >0;$$
see also \cref{fig:link}.

%%%%%ALTERNATIVE WAY%%%%%
\iffalse
We write  
$$
\kappa_1 = \sum_{p = 1}^{q_j} \kappa_{j,p}
$$
for some $q_j \geqslant 1$,  for $j=1,2$, where $(\kappa_{1,p})_{1 \leqslant p \leqslant q_1}$ (resp. $(\kappa_{2,p})_{1 \leqslant p \leqslant q_2}$) are some $1$-dimensional simplices in $C_1(\mathscr T)$ (resp. in $C_1(\mathscr T^\vee)$). We define $\mathcal G^\perp(\kappa_1, \kappa_2)$ the set of \emph{ortheodeodesic paths} from $\kappa_1$ to $\kappa_2$, that are geodesic paths $c = (\tau_1, \ldots, \tau_k)$ (in the sense of the introduction) in the $2$-skeleton of $\mathscr T$ such that 
$$
\langle \partial \tau_1, \kappa_{1,p_1} \rangle = \pm 1 \quad \text{ and } \quad \sharp\, (\tau_k \cap \kappa_{2,p_2}) = \pm 1
$$
for some $1 \leqslant p_j \leqslant q_j$ for $j = 1,2$.
\fi
%%%% END OF ALTERNATIVE WAY%%%


Again, we will denote by $|c|$ the length of $c$, and for each orthogeodesic path $c = (\tau_1, \dots, \tau_k) \in \mathcal G^\perp(\kappa_1, \kappa_2)$, we define the \textit{incidence number} of $c$ on $(\kappa_1, \kappa_2)$ as
$$
m_c = \langle \partial \tau_1, \kappa_1\rangle \, 
%\sharp\, (\tau_k \cap \kappa_2).
\langle \tau_k, \star \kappa_2 \rangle.
$$
If each knot $\kappa_j$ is \textit{simple}, in the sense that each $1$-simplex of $\mathscr T$ (resp. $\mathscr T^\vee$) appears at most once in $\kappa_1$ (resp. $\kappa_2$), then $m_c \in \{-1, 1\}$. Note also that one can always find a polyhedral decomposition $\mathscr T$ so that $\kappa_1$ (resp. $\kappa_2$) is homologous to a simple knot in $C_1(\mathscr T)$ (resp. $C_1(\mathscr T^\vee)$).

As in the preceding section, we will denote by $\varepsilon_c = (-1)^{n_c}$ the reversing index of $c$, where $n_c$ is the number of non-compatible pairs appearing in $c$.

We have the following trace formula, analogous to \cref{prop:trace}, which describes how the entries of the transfer matrix $T$ {count} orthogeodesic paths.
\begin{lemma}
\label{prop:link}
For any $k \in \ZZ_{\geqslant 1}$, it holds
$$\langle T^{k-1} \partial^\star \kappa_1, \star \kappa_2 \rangle = \sum_{\substack{c \in \mathcal G^\perp(\kappa_1, \kappa_2) \\ |c| = k}} \varepsilon_c m_c.$$
\end{lemma}
%Here for simplicity, for any $\sigma \in C_\bullet(\mathscr T)$ and $\sigma^\vee \in C_\bullet(\mathscr T^\vee)$, we denoted
%$$
%\langle \sigma, \sigma^\vee \rangle = \sharp\, \sigma \cap \sigma^\vee.
%$$
%The proof of \cref{prop:link} is analogous to \cref{prop:trace} and we shall not write the details here.
\begin{proof}
For $\sigma, \tau \in \beta_2$, one has
$$(T^{k-1})_{\sigma, \tau} = \sum_{\sigma_1, \ldots, \sigma_{k-1}} T_{\sigma, \sigma_1} T_{\sigma_1,\sigma_2}\ldots T_{\sigma_{k-1},\tau}.$$
By definition, if $c = (\sigma, \sigma_1, \ldots, \sigma_{k-1}, \tau)$ is an orthogeodesic from $\sigma \in \partial^\star \kappa_1$ to $\tau \in \star \kappa_2$, then
$$T_{\sigma, \sigma_1} T_{\sigma_1,\sigma_2}\ldots T_{\sigma_{k-1},\tau} = \varepsilon_c.$$
Moreover, the number of occurences of such a path $c$ is exactly $m_c$, and it proves the lemma.
\end{proof}


We are now ready to prove \cref{theo:mainlink}, which we recall:
\begin{theorem}
\label{theo:link}
Let $\rho(T)$ be the spectral radius of the transfer matrix $T$. The series
$$
%\eta(s) = \sum_{c \in \mathcal G^\perp(\kappa_1, \kappa_2)} \frac {\varepsilon_c m_c} {s^{|c|}},
\eta(z) = \sum_{c \in \mathcal G^\perp(\kappa_1, \kappa_2)} \varepsilon_c m_c z^{|c|},$$ 
converges for $|z| <\frac 1 {\rho(T)}$. It defines a rational function of $z$, which is regular at $z=1/(N+2)$ with
$$
\eta\left(\frac 1{N+2}\right) = \lk(\kappa_1, \kappa_2).
$$
\end{theorem}

\begin{proof}
Finite dimensional Hodge theory gives
$$C_1(\mathscr T) = \im \partial \oplus \im \partial^\star \oplus \ker \Delta.$$
Moreover, $\Delta$ preserves this decomposition, hence it maps $\im \partial$ (resp. $\im \partial^\star$) on itself isomorphically. We denote by $K\colon C_1(\mathscr T) \to C_1(\mathscr T)$ the operator which is the inverse of $\Delta$ on $\im \partial \oplus \im \partial^\star$ and which maps $\ker \Delta$ on $\{0\}$. Then since $p_1\kappa_1 \in \im \partial$, one has
$$
\partial \partial^\star K p_1 \kappa_1 = p_1\kappa_1,
$$
and thus by \cref{eq:deflk}, one gets
\begin{equation}\label{eq:formulalink}
\lk(\kappa_1, \kappa_2) =\frac 1 {p_1} \langle \partial^\star K p_1 \kappa_1, \kappa_2\rangle.
%\langle \partial^\star \Delta^{-1} \kappa_1, \kappa_2\rangle.
\end{equation}
Now if $\frac 1 z$ is not in the spectrum of $T$, we have
\begin{equation}
\label{1}
\frac 1 {p_1} \langle \partial^\star (\Delta + (\frac 1 z - (N+2)) \Id)^{-1} p_1 \kappa_1, \kappa_2\rangle = \frac 1 {p_1}\langle \partial^\star \, ( \frac 1 z \Id - T)^{-1} p_1 \kappa_1, \kappa_2\rangle
\end{equation}
by \cref{prop:Lapl}. For $|z| <\frac 1 {\rho(T)}$ we may expand \cref{1} to get
$$
\frac 1 {p_1} \langle \partial^\star (\Delta + (\frac 1 z - (N+2)) \Id)^{-1} p_1 \kappa_1, \kappa_2\rangle = \frac 1 {p_1} \sum_{k=1}^\infty z^{k} \langle T^{k-1}\partial^\star p_1 \kappa_1, \kappa_2 \rangle = \eta(z)
$$
where the last equality comes from  \cref{prop:link}. This shows that $\eta(z)$ is a rational function in $z$. Finally, note that $\Delta + \omega$ is invertible on $(\ker \Delta)^\perp$ for $|\omega|$ small, with
$$
(\Delta + \omega)^{-1} = K - \omega(\Delta + \omega)^{-1}K.
$$
Hence for $\omega = \frac 1 z - (N+2) = 0$ we obtain 
$$\eta\left(\frac 1{N+2}\right) = \langle \partial^\star K \kappa_1, \kappa_2\rangle = \lk(\kappa_1, \kappa_2\rangle,$$ which concludes the proof.
\end{proof}

%To prove this theorem we introduce again the combinatorial Laplacian 
%$\Delta = \partial^\star \partial + \partial \partial^\star$
%where $\partial^\star = \star \partial \star$ and $\star \colon C_*(K) \to C_{3-*}(K^*)$ sends a simplex onto its dual polyhedron.
%
%The same kind of computation as in \cref{prop:Lapl} shows:
%\begin{proposition}
%The Laplacian $\Delta \colon C_2(K) \to C_2(K)$ writes
%$$\Delta = 5 \Id-T$$
%where $T$ is a symmetric matrix with entries $T_{ij}=1$ is the triangles $i$ and $j$ are adjacent BUT do not belong to the same tetrahedron, and $T_{ij} = 0$ otherwise.
%\end{proposition}
%
%\begin{proof}[Proof of \cref{theo:link}]
%With this expression in hand, let us compute the linking number combinatorially.
%
%First, note that since $\gamma_1$ bounds, Hodge theory says that 
%$\partial^\star \Delta^{-1} \gamma_1$ is a primitive of $\gamma_1$. Moreover $\partial^\star$ commutes with $\Delta$ hence one has
%\begin{align}
%\nonumber \lk(\gamma_1, \gamma_2) &= \langle \partial^\star \Delta^{-1} \gamma_1, \gamma_2 \rangle\\
%\nonumber &=\langle (5 \Id -T)^{-1} \partial^\star \gamma_1, \gamma_2 \rangle\\
%&= \sum_{k\geqslant 0} \left\langle \left(\frac T 5\right)^k \partial^\star \gamma_1, \gamma_2 \right\rangle \label{sum}
%\end{align}
%Now let us interpret the summands in \eqref{sum}. The chain $\partial^\star \gamma_1$ consists of all the triangles which share one edge with $\gamma_1$. Hence $T^k \partial^\star \gamma_1$ is the chain consisting of all the triangles which are related with $\gamma_1$ by a path of adjacent triangles of length $k+1$, such that no two adjacent triangles bound the same tetrahedron.
%
%This proves \cref{theo:link}

%\section{The Casson invariant, a combinatorial approach.}

\bibliographystyle{plain} % D'autres styles sont disponibles. Notez que les distributions LaTeX n'incluent g?ï¿œn?ï¿œralement pas de styles de bibliographies francis?ï¿œs ; vous aurez donc des bibliographies en anglais.
\bibliography{biblio} % Remplacer "biblio" par le nom de votre fichier de r?ï¿œf?ï¿œrences bibliographiques.

% \begin{thebibliography}{9}
% \bibitem[Fried]{Fried}
% \textsc{Fried, D.}, \emph{Fuchsian groups and Reidemeister torsion}, in "The Selberg trace formula and related topics" (Brunswick, Maine, 1984), Contemp. Math. 53, 141-163, Amer. Math. Soc., Providence, RI, 1986.
% \bibitem[DZ]{DZ}
% \textsc{Dyatlov, S. and Zworski, M.}, \emph{Ruelle zeta function at zero for surfaces}, 	Inventiones Mathematicae 210 (2017), 211-229
 
%\end{thebibliography}

\end{document}


\section{Threat Model and Advantages of Our Hardware-based Adversarial Detector} \label{sec: motivation}
\ry{In this part, I want to highlight the comparison between hardware and software attacks}
%Normally, software-based adversarial detectors are easier to implement, cheaper to develop and more well-studied than those based on hardware computational signals.
% We would like to stress that our goal for investigating hardware-based adversarial detectors is not to achieve better performance in detection than the conventional white-box software based methods.  
\subsection{Threat Model} \label{sec: threat model}
\ry{This section is threat model: attack is `white-box', detector is `black-box'}
The victim is a DNN classifier, which is pre-trained with a public dataset. The testing dataset may be kept private.
We assume the strongest `white-box' attack model, where the attacker has full knowledge of the victim model and training dataset in order to generate adversarial samples with minimum perturbations. 
On the contrary, the detection system assumes the most limited scenario, under a `black-box' view of the victim, without access to the victim's inputs, parameters, and intermediate outputs or execution details. 
The only information available to the detector to distinguish adversarial samples is the EM side-channel measurement and the victim model's prediction class.
For training the adversarial detector with EM traces, a public benign dataset is used. 

\if false 
\ry{In this part, we discuss more settings of the detector especially the data used in two phases.}
In general, the detecting process can be summed up into two phases, training phase and detecting phase.
To begin with, we train an Out-of-Distribution(OOD) detector on a public benign dataset of the same classification task, which should be distinct from the victim's training dataset.
For each query, the detector will obtain the classification result and an EM trace along with the model execution to fit its EM classifiers and anomaly detectors.  
During the detection phase, the victim model is in operation and under attack when the pre-trained detector decides whether the current input is adversarial or not, only based on the victim model output and its EM trace.
\fi 

\subsection{Advantages}
Compared to software-based adversarial detection methods, our hardware-based detector, EMShepherd, has three distinct advantages: privacy-preserving, portability, and robustness.

\begin{itemize}[leftmargin=*]
    \item \ry{Add a new motivation here. The motivation is that using \name can help the user protect their privacy.} 
    \name protects the DNN model user's data privacy as it is agnostic to the model's inputs, which instead are always required by prior reconstruction-based detection methods~\cite{meng2017magnet, yang2022you}. 
    %Most model users are benign whose inputs may be sensitive and should not be shared with \textit{third-party detectors}. 
    The sensitive inputs should not be shared with \textit{third-party detectors}. 
    Our design only requires the output class labels and the EM signals, which are passively leaked to common acquisition equipment. 
    %    Our design is suitable for such cases as it only requires the EM signals and the inference outputs during the model execution. Generally speaking, EM signals and labels have less private information leakage.
    \item \ry{The second motivation is still related to privacy. This time we consider model privacy when the model structure or parameters should be kept private.}
   \name also protects the model confidentiality.  No model information, including %Using hardware-based detectors can prevent the third-party defender from accessing some confidential model information such as  
   hyper-parameters, parameters, and logits, is needed, in stark contrast to the previous software-based detection methods~\cite{ma2019nic,feinman2017detecting}.
    %Our \name only acquires the EM traces during model inference in a passive and noninvasive manner, 
    The EM data processing and the adversarial detector training process are both victim model-agnostic. 
    Therefore, our method has more general usage, applicable to closed-source DNN applications, which are pervasive in edge devices where the user only queries the models for the final prediction output. 
    \item \ry{The third motivation is portability.}  
    Owing to the model-agnostic feature, EMShepherd can be easily ported for wide-range hardware devices with different DNN implementations for diverse applications. It can be used as a `plug and play' (PnP) device, aside from the target system, to work automatically without user intervention or contact with the victim system. 
    \item \ry{The last motivation is about adaptive attacks, we should propose that EM signal is hard to imitate, so it is hard for adaptive attacks to generate sample fraud both detector and victim.} 
    Adaptive attack~\cite{adaptive} is a threat to most software defense methods where the attacker adjusts the adversarial perturbations to mislead both the victim models and defense systems.
   %  The hardware-based detection method can provide a double protection on top of most software defense methods such as adversarial training.
   %  Although the adptive adversarial example fools the robust model, its computation patterns during the DNN model execution are still well kept in the EM traces and our EMShepherd framework still works well for detecting the new type of adversarial examples.  
   %  Meanwhile, due to the high complexity of EM signals and non-explicit dependency of the EM signals on computations, it is extremely hard to have an adaptive attack on our detection method, i.e., adversarial examples whose EM signals are deliberately controlled to evade the EM-based detector.
   However, due to the high complexity and non-explicit dependency of the EM signals on computations and data, 
   it is extremely hard to have an adaptive attack on our detection method, 
   i.e., adversarial examples whose EM signals are deliberately controlled to evade the EM-based detector. 
\end{itemize}





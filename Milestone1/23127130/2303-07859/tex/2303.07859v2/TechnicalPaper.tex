% !TeX program = pdflatex
%\documentclass[reprint,amsmath,amssymb,aps]{revtex4-2}
\documentclass[aps,pre,twocolumn,unsortedaddress]{revtex4-2}

\usepackage{comment}

\usepackage{graphicx}
\usepackage{dcolumn}
%\usepackage[inner=2cm,outer=2cm,top=2cm,bottom=2cm]{geometry}
%\usepackage[T1]{fontenc}
%\usepackage{lmodern}
\usepackage{amsfonts}
\usepackage{dsfont}
\usepackage{mathrsfs}
%\usepackage{sidecap}
\usepackage{enumitem}
%\usepackage[utf8]{inputenc}
%\usepackage[english]{babel}
%\usepackage{abstract}
\usepackage{footnote}
%\usepackage{authblk}
\usepackage{booktabs}
\usepackage{braket}
\usepackage[overload]{empheq}
%\setlength{\parskip}{0.2\baselineskip}
\usepackage{mathrsfs}
\usepackage{titlesec}
%\usepackage{mhchem}
\usepackage{array}
\usepackage{upgreek}
\usepackage[usenames, dvipsnames]{xcolor}
%\usepackage[sort&compress,numbers]{natbib}
%\bibliographystyle{apsrev4-1}

%\usepackage{units}
\usepackage{siunitx}
\usepackage{tabularx}
\usepackage{cases}
%\usepackage{caption} % for subfigures
%\usepackage{subcaption} %for subfigures
%\usepackage{epstopdf}
\usepackage{framed}
\usepackage{xspace}
\usepackage{pifont}
\usepackage{hhline}
\usepackage{multirow}
\usepackage{paracol}
%\usepackage{float}
\usepackage{mwe}
%\usepackage[notcite]{showkeys}




\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{hyperref}% add hypertext capabilities

%%%%%%%%%%%%%%%%% OVERLEAF xr CODE 
\usepackage{xcite}
\usepackage{xr}
\makeatletter
\newcommand*{\addFileDependency}[1]{% argument=file name and extension
  \typeout{(#1)}% latexmk will find this if $recorder=0 (however, in that case, it will ignore #1 if it is a .aux or .pdf file etc and it exists! if it doesn't exist, it will appear in the list of dependents regardless)
  \@addtofilelist{#1}% if you want it to appear in \listfiles, not really necessary and latexmk doesn't use this
  \IfFileExists{#1}{}{\typeout{No file #1.}}% latexmk will find this message if #1 doesn't exist (yet)
}
\makeatother

\newcommand*{\myexternaldocument}[1]{%
    \externaldocument{#1}%
    \addFileDependency{#1.tex}%
    \addFileDependency{#1.aux}%
}
\myexternaldocument{main}
%%%%%%%%%%%%%%%% END OVERLEAF xr CODE


\newcommand{\pard}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pardd}[2]{\frac{\partial ^2 {#1}}{\partial {#2} ^2}}
\newcommand{\parddd}[2]{\frac{\partial ^3 {#1}}{\partial {#2} ^3}}
\newcommand{\pardddd}[2]{\frac{\partial ^4 {#1}}{\partial {#2} ^4}}
\newcommand*\diff{\mathop{}\!\mathrm{d}}
\newcommand{\eff}{\mathrm{eff}}
\newcommand{\LJeff}{\mathrm{LJ,eff}}
\newcommand{\LJcd}{\mathrm{LJ,cd}}
\newcommand{\LJcc}{\mathrm{LJ,cc}}
\newcommand{\LJdd}{\mathrm{LJ,dd}}
\newcommand{\LJcw}{\mathrm{LJ,cw}}
\newcommand{\LJdw}{\mathrm{LJ,dw}}
\newcommand{\LJ}{\mathrm{LJ}}
\newcommand{\LJwall}{\mathrm{LJ,w}}
\newcommand{\lBz}{l_{\mathrm{B}0}}
\newcommand{\lB}{l_\mathrm{B}}
\newcommand{\kB}{k_\mathrm{B}}
\newcommand{\muwater}{\mu_{\mathrm{water}}}
\newcommand{\muz}{\mu_0}
\newcommand{\densch}{n}
\newcommand{\mueff}{\tilde{\mu}_\eff}  
\newcommand{\zcross}{\tilde{z}_{\mathrm{cross}}}
\newcommand{\PB}{\mathrm{PB}}  
\newcommand{\SC}{\mathrm{SC}}  
\newcommand{\dens}{n}
\newcommand{\permz}{\varepsilon_0}
\newcommand{\permr}{\varepsilon_r}
\newcommand{\rpos}{\textbf{r}}
\newcommand{\inst}{\mathrm{inst}}
\newcommand{\micro}{\mathrm{micro}}
\newcommand{\lD}{\lambda_\mathrm{D}}
\newcommand{\hrho}{\widehat{\rho}}
\newcommand{\hphi}{\widehat{\phi}}
\newcommand{\hV}{\widehat{V}}
\newcommand{\hsigma}{\widehat{\sigma}}
\newcommand{\hQ}{\widehat{Q}}
\newcommand{\hE}{\widehat{E}}
\newcommand{\Laplace}[1]{\mathcal{L}\lbrace{#1}\rbrace}
\newcommand{\Laplaceinv}[1]{\mathcal{L}^{-1} \lbrace{#1}\rbrace}
\newcommand{\Cset}[1]{\mathscr{C}_{#1}}
\newcommand{\hDeltarho}{\widehat{\Delta\rho}}
\newcommand{\hDeltaV}{\widehat{\Delta V}}
\newcommand{\Smatrix}{\boldsymbol{\mathsf{S}}}
\newcommand\Du{\mbox{\textit{Du}}}
\newcommand{\munen}{\mu_{\mathrm{nen}}}
\newcommand{\densf}{n_\mathrm{f}}
\newcommand{\etaf}{\eta_\mathrm{f}}
\newcommand{\nuf}{\nu_\mathrm{f}}
\newcommand{\Epar}{E_\parallel}
\newcommand{\epar}{e_\parallel}
\newcommand{\hEpar}{\widehat{\Epar}}
\newcommand{\hu}{\widehat{u}}
\newcommand{\hDeltaEpar}{\widehat{\Delta \Epar}}
\newcommand{\cyl}{\mathrm{cyl}} 

% derivatives and stuff
\newcommand{\dep}[2]{\ensuremath{\frac{\partial #1}{\partial #2}}}
\newcommand{\depn}[3]{\ensuremath{\frac{\partial^{#3} #1}{\partial #2^{#3}}}}
\newcommand{\dd}{\ensuremath{\mathrm d}}
\newcommand{\dt}[2]{\ensuremath{\frac{\dd #1}{\dd #2}}}
\newcommand{\dtn}[3]{\ensuremath{\frac{\dd^{#3} #1}{\dd #2^{#3}}}}
\def\e{\mathrm{e}}
\def\I{\mathrm{i}}
\def\O{\mathcal{O}}


\DeclareSIUnit[number-unit-product = {\,}] \cal{cal}

\graphicspath{{./Figures-TechnicalPaper/}}


\newcommand{\pbw}[1]{{\color{red} #1}}

\newcommand{\Eqref}[1]{Eq.~\eqref{#1}}
\newcommand{\Eqsref}[1]{Eqs.~\eqref{#1}}

\newcommand{\latin}[1]{{\it{#1}}}
\newcommand{\ie}{\latin{i.e.}}
\newcommand{\eg}{\latin{e.g.}}
\newcommand{\adhoc}{\latin{ad hoc}}
\newcommand{\caveat}{\latin{caveat}}
\newcommand{\interalia}{\latin{inter alia}}
\newcommand{\perse}{\latin{per se}}
\newcommand{\cf}{\latin{cf.}}

\newcommand{\german}[1]{{\it #1}}
\newcommand{\ansatz}{\german{ansatz}}


\newcommand{\chg}[1]{{\color{black}#1}}
\newcommand{\modif}[1]{{\color{black}#1}}

\newcommand{\BR}[1]{{\color{black} #1}}
\newcommand{\MD}[1]{{\color{black} #1}}
\newcommand{\ET}[1]{{\color{black} #1}}
\newcommand{\IP}[1]{{\color{black} #1}}

\usepackage{ulem}





\begin{document}


\title{Poisson-Nernst-Planck charging dynamics of an electric double layer capacitor: symmetric and asymmetric binary electrolytes}

\author{Ivan Palaia}
\affiliation{\BR{Department of Physics, King’s College London, WC2R 2LS, United Kingdom}}
\affiliation{Institute of Science and Technology Austria, 3400 Klosterneuburg, Austria}
\author{Adelchi J. Asta}
\affiliation{\IP{Dessia, 92160 Antony, France}}
\author{\BR{Megh Dutta}}
\affiliation{\IP{Sorbonne Université, CNRS, Physico-chimie des Électrolytes et Nanosystèmes Interfaciaux, PHENIX, 75005 Paris, France}}
\author{Patrick B. Warren}
\affiliation{Hartree Centre, Science and Technology Facilities Council (STFC), Sci-Tech Daresbury, Warrington WA4 4AD, United Kingdom}
\author{Benjamin Rotenberg}
\affiliation{Sorbonne Université, CNRS, Physico-chimie des Électrolytes et Nanosystèmes Interfaciaux, PHENIX, 75005 Paris, France}
\affiliation{Réseau sur le Stockage Electrochimique de l’Energie (RS2E), FR CNRS 3459, 80039 Amiens Cedex, France}
\author{Emmanuel Trizac}
\affiliation{Universit\'e Paris-Saclay, CNRS, LPTMS, 91405 Orsay, France}
\affiliation{ENS de Lyon, 69342 Lyon, France}

\date{\today}


\begin{abstract}
A parallel plate capacitor containing an electrolytic solution is the simplest model of a supercapacitor, or electric double layer capacitor. Using both analytical and numerical techniques, we solve the Poisson-Nernst-Planck equations for such a system, describing the mean-field charging dynamics of the capacitor, when a constant potential difference is abruptly applied to its plates. Working at constant total number of ions, we focus on the physical processes involved in the relaxation and, whenever possible, give its functional shape and exact time constants. We first review and study the case of a symmetric binary electrolyte, where we assume the two ionic species to have the same charges and diffusivities. We then relax these assumptions and present results for a generic strong (\ie~fully dissociated) binary electrolyte. At low electrolyte concentration, the relaxation is simple to understand, as the dynamics of positive and negative ions appear decoupled. At higher electrolyte concentration, we distinguish several regimes. In the linear regime (low voltages), relaxation is multi-exponential, it starts by the build-up of the equilibrium charge profile and continues with neutral mass diffusion, and the relevant time scales feature both the average and the Nernst-Hartley diffusion coefficients. In the purely nonlinear regime (intermediate voltages), the initial relaxation is slowed down exponentially due to increased capacitance, while bulk effects become more and more evident. In the fully nonlinear regime (high voltages), the dynamics of charge and mass are completely entangled and, asymptotically, the relaxation is linear in time. \IP{We finally discuss non-ideal behavior in real capacitors and provide conditions for which mean-field is expected to hold.} 
\end{abstract}






\maketitle

\section{\texorpdfstring{INTRODUCTION}{Introduction}}

In a wealth of physical systems, charged surfaces confine a liquid containing ions. 
If the surfaces are conductive a so-called electric double layer capacitor (EDLC) is formed, owing its name to the two layers of opposite charge that build up at the interface between each surface and the electrolytic solution. Compared to standard capacitors with insulating dielectrics, the ability of EDLCs to store charge and energy is enhanced by the local rearrangement of the confined electrolyte and very large capacities per unit weight can be reached when the conductive electrodes are made of porous or fibrous materials, as this hugely increases the surface area in contact with the electrolyte \cite{Simon2008,Chen2020, simon_perspectives_2020}. EDLCs of this kind can store more energy than common capacitors, can release it more rapidly than common batteries, and last longer than devices based on chemical reactions. These three characteristics, placing them precisely at the border between capacitors and batteries \cite{Winter2004}, explain their widespread usage as well as numerous potential applications: from consumer electronics and wearable devices \cite{Dubal2018}, to energy production \cite{Brogioli2009, Boon2011,Janssen2014} and means of transportation, where large power exchanges are needed to propel and halt electric vehicles, harvest braking energy, or promptly activate emergency devices \cite{Simon2008}.

The need to control the dynamics of charge and discharge of EDLCs has motivated substantial interest in fundamental sciences. Impedance spectroscopy experiments are routinely used to measure the linear response of the system to oscillating fields \cite{vivier_impedance_2022, Barbero2005a}.  Computer simulations have addressed paramount questions concerning \interalia\ the effects of electrode polarisability, ion and pore sizes, or electrostatic correlations \cite{Jeanmairet2022}. In parallel, analytical studies have proved fundamental to inform experiments and simulations, emphasizing the role played by the molecular structure of the double layer, not captured by usual mean-field approaches, in determining the EDLC capacitance \cite{Kornyshev2007, Bazant2011}. Nonetheless, recent works have highlighted the need to better understand the dynamics of simple model systems, such as a planar capacitor in mean-field, to clearly isolate the effect of geometry, hydrodynamics and non-idealities in real devices \cite{Wu2022,Janssen2019b,Asta2019JCP,Lian2020,Ma2022,Yang2022,Varela2021} or to develop strategies to speed up relaxation to equilibrium \cite{Breitsprecher2018,phd,Breitsprecher2020}. Namely, the relaxation dynamics of a planar EDLC subjected to a sudden change in the electric potential between plates has been described by the seminal works  \cite{Bazant2004,Janssen2018} for the simpler case of symmetric electrolytes and with particular attention for the linear (low-voltage) regime, of which \cite{Janssen2018} provided an exact solution.

The charging dynamics of an ideal EDLC, such as the one presented in Fig.~\ref{fig:EDLC}, is an interesting problem \perse\ from a physical perspective. Several length scales are involved: the Bjerrum length $\lB$, 
setting the distance between two ions at which thermal energy becomes comparable with electrostatic repulsion; the Debye screening length $\lD$, setting the range of the electrostatic potential; the point along $z$ at which the electrostatic potential vanishes, coinciding with the geometrical center of the capacitor only for symmetric electrolytes; lastly, the size of the system $L$. In strongly polarised situations, a fifth length can in principle be relevant, the Gouy-Chapman length, a signature of the less efficient screening occurring when only counterions are in proximity of the plates. The relaxation to equilibrium observed when an external voltage is imposed can depend in principle on any these lengths, as well as on the diffusion coefficients of the ionic species, and on the applied voltage. These quantities can be combined in many ways to give plausible relaxation times: understanding which of those are relevant for the dynamics, for different electrolytes and at different times, is a challenge. Moreover, the relaxation is not simply exponential, as in many model physical systems, and can be hard to solve and describe in closed form.


In this paper, and in \cite{mainpaper}, we present a detailed study of the relaxation dynamics of an ideal, planar EDLC in mean-field. In Section \ref{sec:PNPintro} we recapitulate the Poisson-Nernst-Planck (PNP) formalism, within which we operate throughout the whole paper (we introduce the numerical method used to solve the PNP equations in Appendix~\ref{sec:NumericalMethod}). Then, we present results concerning the case where the two ions species have the same valence and diffusion coefficients (fully symmetric case, Section \ref{sec:sym}), the case where the two species have the same diffusion coefficient but different valences (partially asymmetric case, Section \ref{sec:asymsym}) and the case where the two species have different valences and diffusion coefficients (fully asymmetric case, Section \ref{sec:fullyasym}). For each of these cases we vary electrolyte concentration and applied voltage and we study the linear, purely nonlinear, and depleted nonlinear regimes. The relaxation involves in general more than one process, so that each regime features many relaxation timescales, each of which may become relevant at different times. We give a thorough characterisation of this complex phenomenon, focusing with more care on the cases for which a simple analytical interpretation is possible.


\begin{figure}
\centering
\includegraphics[width=0.9\columnwidth]{EDLC_opaco-eps-converted-to}
\caption{Cartoon representing a charged, planar EDLC. Red cations and blue anions are treated at mean-field level, as suggested by the color of the solution, representing charge density. Within the mean-field approximation, for large enough $L$ and sufficiently low applied voltage, the thickness of the electric double layer at equilibrium is $\lD$.
}
\label{fig:EDLC}
\end{figure}





\section{\texorpdfstring{MODEL}{Model}}
\label{sec:PNPintro}

Our ideal EDLC (Fig.~\ref{fig:EDLC}) is treated within the Poisson-Nernst-Planck formalism \cite{Hunter}. We neglect hydrodynamic effects, and suppose purely Coulombic interactions between ions and Coulombic and hard-core interactions between ions and walls. No absorption phenomena are considered, so the compact part of the electric double layer, usually called Stern layer, is neglected. The two plates, distant of $2L$ from each other, are connected to a time-dependent ideal voltage source, imposing a potential difference $2V(t)$ between them.

The salt is a strong binary electrolyte and is therefore completely dissociated in the solvent: densities are denoted $\dens_+$ and $\dens_-$, diffusion coefficients $D_+$ and $D_-$, and integer ionic valences $\bar{q}_+=+q_+$ and $\bar{q}_-=-q_-$ (for instance, for MgCl$_2$, $\bar{q}_+=+2$, $\bar{q}_-=-1$, and $q_+=2$, $q_-=1$). 
Electrodes are modelled as parallel, infinite, charged planes.
Densities $\dens_\pm$ and potential $\phi$ are functions of the sole spatial coordinate $z$ in the direction perpendicular to the planes and of time $t$.
Fig.~\ref{fig:EDLC} shows a sketch of the system, with size $2L$ and $z=0$ at the center of the capacitor. 

We work in the canonical ensemble, \ie~with a fixed number of ion pairs per unit surface $2\dens_0 L$, where $\dens_0$ is the uniform density of salt when the power source is off and the capacitor at equilibrium. The initial density for each species is $n_\pm^0$ and is such that $q_+ n_+^0 = q_- n_-^0 = q_+ q_- n_0$ by electroneutrality (the last equality holding when $q_+$ and $q_-$ are co-prime). 
Choosing to work in the canonical ensemble allows to avoid the question of where exactly ions are injected into the system from the reservoir during the dynamics, which in a real nanocapacitor might depend on the size and the topology of the pores.
In addition, the constant ion number ensemble is a good approximation for open systems where the electrodes have large lateral dimensions and it takes a long time to ensure the chemical equilibrium of the entire pore with the bath. In fact, studying relaxation in the canonical ensemble reveals precisely which time scales should be compared to chemical equilibration time scales to assess whether the system is effectively canonical or grand-canonical. Finally, there are regimes in which densities in the bulk solution (at the center of the capacitor) remain approximately constant, at least to first order, and the canonical ensemble is not quantitatively different from the grand-canonical ensemble. 


The Poisson-Nernst-Planck equation describes the change in time and space of the ionic densities \cite{Hunter}: it consists of a drift-diffusion model for ionic currents, complemented with a continuity equation. The average current density $j_\alpha(z,t)$ for ions of type $\alpha$ ($\in\{-,+\}$), moving along $z$  
under the action of a potential $\phi(z,t)$, is  \begin{equation}
    {j}_\alpha(z,t)=-\beta D_\alpha \,\dens_\alpha(z,t) \, \bar{q}_\alpha e \pard{\phi}{z}(z,t) - D_\alpha\pard{\dens_\alpha}{z}(z,t) \,,
    \label{eq:current}
\end{equation} 
where $\beta=1/(\kB T)$ is the inverse temperature and $e$ the elementary charge.
The first term represents a drift current, obtained as the product of a mobility $\beta D_\alpha$ (in agreement with Einstein's relation), a density and an electric force. \BR{The second term is a diffusion current, described by Fick's law.} We assume a diagonal diffusivity tensor, meaning that the diffusion of a species is not influenced by the presence of other species. In general, the microscopic potential depends on the discrete positions of the ions. Within the Poisson-Nernst-Plank approximation, the potential is assumed to be a coarse-grained average of the microscopic potential, hence the mean-field nature of \Eqref{eq:current}.  In the static case, currents vanish and the Poisson-Boltzmann distribution is retrieved, with average density proportional to the exponential of an average potential \cite{Hunter, Andelman2010}.

For currents $j_\alpha(z,t)$, the following exact continuity equation must hold, ensuring \BR{local} ionic mass and charge conservation:
\begin{equation}
    \dep{\dens_\alpha}{t}(z,t)=-\dep{j_\alpha}{z}(z,t)\,.
\label{eq:continuityeq}
\end{equation}
Substituting \Eqref{eq:current} in \Eqref{eq:continuityeq} yields
\begin{equation}
    \dep{\dens_\alpha}{t}(z,t)=D_\alpha \dep{}{z} \left(\, \dens_\alpha(z,t)\, \beta \bar{q}_\alpha e\dep{\phi}{z}(z,t) + \dep{\dens_\alpha}{z} (z,t)\right).
\label{eq:PNP}
\end{equation}

The potential is related to the density by the Poisson equation, also exact:
\begin{equation}
    - \pardd{\phi}{z}(z,t) = \frac{\rho(z,t)}{\varepsilon_0\varepsilon_r}\,,
    \label{eq:poisson}
\end{equation}
where $\rho=q_+ e n_+ - q_- e n_-$ is the charge density, $\varepsilon_0$ the permittivity of vacuum, and $\varepsilon_r$ the relative permittivity.
\Eqsref{eq:PNP} and~\eqref{eq:poisson} constitute the Poisson-Nernst-Planck theory.

The fact that ions are confined within the two slabs of the capacitor imposes the boundary condition of vanishing currents at $+L$ and $-L$. From the definition in \Eqref{eq:current}:
\begin{align} \label{eq:bcflux}
\begin{split}
- \beta n_\alpha(-L, t) \bar{q}_\alpha e \dep{\phi}{z}(-L, t) - \dep{n_\alpha}{z}(-L, t) =0\,,
\\
- \beta n_\alpha(+L, t)  \bar{q}_\alpha e \dep{\phi}{z}(+L, t) - \dep{n_\alpha}{z}(+L, t) =0 \,.
\end{split}
\end{align}

We will focus on the situation where the EDLC is at equilibrium, with zero applied potential for times $t<0$, and is subject to a potential difference $2V_0$ for times $t>0$. The electric potential must be continuous between slab and solution, so that
\begin{equation} \label{eq:bcpotential}
\phi(\pm L, t)=\pm V(t)\,, \text{\quad with } V(t)=
\begin{dcases}
0 & \text{for } t<0\\
V_0 & \text{for } t\ge0
\end{dcases}.
\end{equation} 
The zero of the potential is arbitrary.

In the following, we solve the Poisson-Nernst-Planck equation analytically, when possible, and numerically, with a flux-conservative method whose details are given in the Appendix. The results of our numerical scheme were successfully compared to those of constant-potential Lattice-Boltzmann electrokinetics \cite{Asta2019JCP}, where Lattice-Boltzmann is coupled with an iterative resolution of the Poisson equation.






 










%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{\texorpdfstring{FULLY SYMMETRIC CASE: $q_+=q_-$, $D_+=D_-$}{Fully symmetric case: q+ = q-, D+ = D-}}
%\label{sec:DynPlan}
\label{sec:sym}



We focus first on the case of a symmetric binary electrolyte, whose species have valences $q_-=q_+=q=1$, and diffusivities $D_+=D_-=D$. The problem of studying relaxation in this case has been previously addressed in \cite{Bazant2004} and \cite{Janssen2018}, with particular focus on the linear regime. For the sake of completeness, we re-obtain here some of the results from Ref.~\cite{Janssen2018} following a simpler approach. 
In the linear regime, the relaxation is multi-exponential. We then seek a clear characterisation of the nonlinear regime, building on Ref.~\cite{Bazant2004}. 



\subsection{Linear regime}
\label{sec:DynPlanSymSymLinear}

Linearizing \Eqsref{eq:PNP} around the initial densities $n_+^0=n_-^0=n_0$ and taking the difference of the two equations for the two species, yields, together with \Eqref{eq:poisson}, the Debye-Falkenhagen equation for the charge density $\rho$:
\begin{equation} 
\label{eq:DebyeFalkenhagen}
\pard{\rho}{t}=D \left( \pardd{\rho}{z} - \lD^{-2} \rho \right)\,.
\end{equation}
Here we defined the Debye length $\lD$ as a constant in terms of the initial density $n_0$ by $\lD^{-2} = 2 n_0 \beta e^2/(\varepsilon_r \varepsilon_0) = 8\pi\lB n_0$, where $\lB=\beta e^2/(4\pi\varepsilon_r \varepsilon_0)$ is the Bjerrum length.



\begin{table}
\begin{center}
{\def\arraystretch{1.9}\tabcolsep=10pt
\begin{tabular}{ l | c | c }
Observable & Symbol & Unit \\ \hline
\rule{-4pt}{5ex}
Time & $t,\, \tau_i$ & \(\displaystyle \frac{L \lD}{ D} \) \\
%\rule{-4pt}{5ex}
Inverse time & $s,\, s_i$ & $\displaystyle \frac{ D}{L \lD}$ \\
Distance & $z$ & $L$ \\
Volumic ion density & $\dens_\pm$ & $n_0$ \\
Volumic charge density & $\rho$ & $2en_0$ \\
Electric potential & $\phi,\, V$ & $\displaystyle \frac{1}{\beta e}$ \\
Electric field & $E$ & $\displaystyle\frac{1}{\beta e L}$\\
Surface density & $\sigma$ & $\displaystyle \frac{\permz\permr}{\beta e^2 L} = \frac{1}{4\pi\lB L}$
\end{tabular}
}
\end{center}
\caption{List of units of the nondimensional quantities used. Note that they do not form a coherent system of units: for instance, the units of distance, volumic density and surface density are not simply related.
}
\label{tab:units}
\end{table}

\begin{comment}
    \begin{table}
    \begin{center}
    {\def\arraystretch{1.9}\tabcolsep=10pt
    \begin{tabular}{ l | l }
    Dimensionless Debye length & $\displaystyle \epsilon=\frac{\lD}{ L}=\frac{1}{L}\sqrt{\frac{\permz\permr}{2n_0 \beta e^2}}$\ \\
    Dimensionless potential step & $v=\beta e V_0$ \\
    \end{tabular}
    }
    \caption{The two dimensionless parameters governing the statics and dynamics of the system.}
    \label{tab:adimparam}
    \end{center}
    \end{table}
\end{comment}

We proceed by making the equations nondimensional, according to the mapping described in Table \ref{tab:units}.
The system is completely described by the two dimensionless parameters $\epsilon=\lD/L$ and $v=\beta e V_0$, that we will keep using \BR{throughout} the rest of the paper. Note that $\epsilon$ can be, but need not be, a small quantity, while, as long as we deal with the linear regime, $v$ has to be much smaller than unity. 

In these units, \Eqref{eq:DebyeFalkenhagen} is readily rewritten as
\begin{equation} \label{eq:DF}
\epsilon \pard{\rho}{t} = \epsilon^2 \pardd{\rho}{z} - \rho
\end{equation}
and the Poisson equation~\eqref{eq:poisson} reads
\begin{equation} \label{eq:P}
-\epsilon^2 \pardd{\phi}{z}=\rho \,.
\end{equation}
The boundary condition in \Eqref{eq:bcflux} can be written in terms of the charge density upon linearization:
\begin{equation} \label{eq:bcFlux}
-\pard{\rho}{z}(\pm 1,t) - \pard{\phi}{z}(\pm 1,t) =0 \,.
\end{equation}
Finally, the boundary condition in \Eqref{eq:bcpotential} reads
\begin{equation} \label{eq:bcPotential}
\phi(\pm 1,t)=\pm V(t) \,.
\end{equation}


\begin{comment}
    \subsubsection{Laplace domain}
    
    \Eqref{eq:DF} can be easily solved by using Laplace transforms, that we denote by hats and define as follows:
    \begin{equation}
    \label{eq:Laplacerho}
    \widehat{\rho}(z,s)=\Laplace{\rho(z,t)} = \int_{0}^{\infty} \rho(z,t) \operatorname{e}^{-st} \diff t \,.
    \end{equation}
    In the Laplace domain, knowing that $\rho(x,0)=0$ since we start from a discharged capacitor, \Eqref{eq:DF} reads
    \begin{equation} \label{eq:DFL}
    \frac{1+\epsilon s}{\epsilon^2}\widehat{\rho} = \pardd{\widehat{\rho}}{z} \,.
    \end{equation}
    Any $z$-antisymmetric solution will be of the type
    \begin{equation}
    \widehat{\rho}(z,s)=A(s)\sinh(kz) \,,
    \label{eq:rhoAsinh}
    \end{equation} 
    where $k(s)$ is in principle any of the two solutions of the equation 
    \begin{equation} \label{eq:k}
    k^2=\frac{1+\epsilon s}{\epsilon^2}\,.
    \end{equation} 
    In the following, we will always assume $k$ to be the solution with positive imaginary part (thus operating a branch cut of the square-root function along the positive real axis) and we will see in a while that the complementary choice gives the same results.
    Using the the Laplace-domain version of \Eqref{eq:P} with \Eqref{eq:rhoAsinh}, one gets the general form of $\widehat{\phi}$. Fixing the null-potential plane at $z=0$, and imposing boundary conditions \Eqsref{eq:bcFlux} and~\eqref{eq:bcPotential}, again, in their Laplace-domain version, the following results can be obtained:
    \begin{equation} \label{eq:phihat}
    \widehat{\phi}(z,s)=\frac{\sinh(kz)+zk(\epsilon^2 k^2-1) \cosh(k)}{\sinh(k)+k(\epsilon^2 k^2-1) \cosh(k)} \,\widehat{V}(s)\,,
    \end{equation} 
    \begin{equation} \label{eq:rhohat}
    \widehat{\rho}(z,s)=-\frac{\epsilon^2 k^2 \sinh(kz)}{\sinh(k)+k(\epsilon^2 k^2-1) \cosh(k)} \,\widehat{V}(s)\,.
    \end{equation} 
    Other interesting (dimensionless) quantities are the surface charge density $\sigma(t)$ on the left plate, that we express in units of $\frac{\permz\permr}{\beta e L}$, the integrated charge density $Q(t)=\int_{-1}^0 \rho(z,t) \diff z$, in units of $2 n_0 e L$, and the electric field $E(0,t)$ at $z=0$, in units of $(\beta e L)^{-1}$ (see Table \ref{tab:units}). Their Laplace transforms read
    \begin{widetext}
    \begin{equation} \label{eq:sigmahat}
    \widehat{\sigma}(s)= -\pard{\widehat{\phi}}{z}(-1,s) = -k \coth(k) \frac{\epsilon^2 k^2}{1+k(\epsilon^2 k^2 -1) \coth(k)}\, \widehat{V}(s)\,,
    \end{equation}
    \begin{equation} \label{eq:Qhat}
    \widehat{Q}(s) = \int_{-1}^0 \hrho(z,s) \diff z = \frac{\tanh(\frac{k}{2})}{k} \frac{\epsilon^2 k^2}{1+k(\epsilon^2 k^2 -1) \coth(k)}\, \widehat{V}(s)\,,
    \end{equation} 
    \begin{equation} \label{eq:E0hat}
    \widehat{E}(0,s)= -\pard{\widehat{\phi}}{z}(0,s) =\left[ \frac{\tanh(\frac{k}{2})}{\epsilon^2 k} - k \coth(k) \right] \frac{\epsilon^2 k^2}{1+k(\epsilon^2 k^2 -1) \coth(k)} \,\widehat{V}(s) \,.
    \end{equation} 
    \end{widetext}
    Note that these three quantities satisfy exactly Gauss' theorem, in the form
    \begin{equation}
    \widehat{\sigma}(s) + \frac{1}{\epsilon^2} \widehat{Q}(s) = \widehat{E}(0,s) \,.
    \end{equation}
    All these expressions for Laplace transforms of real observables are invariant under the transformation $k \rightarrow -k$, meaning that considering the second solution of \Eqref{eq:k} gives the exact same results.
    \\
    
    To study the time relaxation of the system to equilibrium, we recall that, by the Bromwich-Mellin inversion formula, we have
    \begin{equation} \label{eq:Laplaceinvrho}
    \rho(z,t)=\Laplaceinv{\hrho(z,s)}= \frac{1}{2\pi i}\int_{S-i\infty}^{S+i\infty} \hrho(z,s) \operatorname{e}^{st} \diff s \,,
    \end{equation}
    for some real $S$ such that $\hrho(z,s)$ has no pole lying on the right of $S$. We observe that, if the integrand function is such that its integral over the semi-circumference of infinite radius in a left half-plane goes to zero, the integral amounts to the sum of the residues of the integrand. Hence, each non-zero pole of the function $\hrho(z,s)$ will contribute to the inverse Laplace transform with a term $\operatorname{e}^{s_i t} \operatorname{Res}_{\hrho(z,s)}(s_i)$. The non-zero poles of $\hrho$, $\hsigma$, $\hQ$ or $\hE$ are thus the relaxation rates of our system. If a pole at 0 is present, its residue will determine the equilibrium state at $t\to\infty$.
    
    For a step potential $V(t)=v\Theta(t)$, one has $\widehat{V}(s)=v/s$, so that the non-zero poles of functions defined in \Eqsref{eq:phihat}--\eqref{eq:E0hat} all coincide. Indeed, such quantities can all be expressed as products of entire functions (except in 0) times the following transfer function $H(s)$:
    \begin{multline} \label{eq:Hpolefunction}
    H(s)=\frac{\epsilon^2 k^2}{1+k(\epsilon^2 k^2 -1)\, \coth(k)} \\ 
    = \frac{1+\epsilon s}{1+s \sqrt{1+\epsilon s}\, \coth\left(\frac{\sqrt{1+\epsilon s}}{\epsilon}\right)}
    \end{multline}
    The same branch cut introduced before for the square root is used.
    
    We denote the poles of $H(s)$ by $s_i$, with $n \in \{0, 1, 2...\}$, and we order them such that the higher their index $n$, the more distant they are from the origin. They all lie on the negative real axis and are all single poles. To identify them, we analyze first the case $s<-\frac{1}{\epsilon}$, and then $s>-\frac{1}{\epsilon}$; at $s=-\frac{1}{\epsilon}$, $H(s)$ has a removable singularity, which is immaterial. 
    
    In the case $s<-\frac{1}{\epsilon}$, we set $\sqrt{1+\epsilon s} = iY$ with $Y$ real and positive. Finding the poles of \Eqref{eq:Hpolefunction} amounts therefore to finding the roots of the transcendental equation
    \begin{equation} \label{eq:transcendentalpolesy}
    \tan\left(\frac{Y}{\epsilon}\right) = \frac{Y}{\epsilon} \left(Y^2+1\right) \,,
    \end{equation}  
    taken from equating to 0 the denominator of \Eqref{eq:Hpolefunction}. They can be easily found graphically and numerically; they are included in the interval $\epsilon \pi n <Y_i< \epsilon \pi (n+\frac{1}{2})$, with $n\ge 1$ if $\epsilon \le \frac{1}{\sqrt{3}}$, or $n\ge 0$ if $\epsilon > \frac{1}{\sqrt{3}}$. By definition of $Y$, this corresponds to poles $s_i$ such that
    \begin{equation} \label{eq:poles1}
    -\frac{1}{\epsilon}- \epsilon \pi^2 \left(n+\frac{1}{2}\right)^2 < s_i < -\frac{1}{\epsilon}- \epsilon \pi^2 n^2
    \end{equation}
    \begin{equation}
    \text{with}\ 
    \begin{cases}
          n\ge 1, & \text{if}\ \epsilon \le \frac{1}{\sqrt{3}} \\
          n\ge 0, & \text{if}\ \epsilon > \frac{1}{\sqrt{3}}
    \end{cases}
    \end{equation}
    As $n\to\infty$, $s_i$ approaches the left extremum of the interval and scales as $n^2$. 
    
    In the case $s>-\frac{1}{\epsilon}$, we set $\sqrt{1+\epsilon s} = Z$ with $Z$ real and positive. Now, finding the zeroes of the denominator of $H(s)$ amounts to finding the roots of another transcendental equation:
    \begin{equation} \label{eq:transcendentalpolesz}
    \tanh\left(\frac{Z}{\epsilon}\right)=-\frac{Z}{\epsilon}\left(Z^2-1\right)
    \end{equation}
    If $\epsilon \le \frac{1}{\sqrt{3}}$, this equation has only one root $-\frac{1}{\epsilon}<s_0<0$. If $\epsilon > \frac{1}{\sqrt{3}}$, it has no roots. 
    
    Summarizing, the infinitely many poles $s_i$ of observables in \Eqref{eq:phihat}--\eqref{eq:E0hat}, corresponding to their relaxation rates in the time domain, are to be found as follows. For $n\ge 1$, the poles $s_i$ are the roots of \Eqref{eq:transcendentalpolesy} over the intervals \Eqref{eq:poles1}; for $n=0$, the pole $s_0$ corresponds to the root of \Eqref{eq:transcendentalpolesy} over the interval $-\frac{1}{\epsilon}-\frac{\epsilon\pi^2}{4}<s<-\frac{1}{\epsilon}$ if $\epsilon\ge\frac{1}{\sqrt{3}}$, and to the root of \Eqref{eq:transcendentalpolesz} if $\epsilon <\frac{1}{\sqrt{3}}$. Out of all these infinitely many relaxation rates $s_i$, the most interesting is probably $s_0$, because it corresponds to the slowest relaxation time $\tau_0=-s_0^{-1}$. The behavior of $\tau_0$ as a function of $\epsilon$ is illustrated in Fig.~\ref{fig:tau0}, where it is compared with existing estimates from \cite{Bazant2004}; Fig.~\ref{fig:sn} represents instead poles $s_i$ and times $\tau_i$ up to $n=10$, for $\epsilon=0.1$ (Fig.~\ref{fig:sneps01}) and for $\epsilon=10$ (Fig.~\ref{fig:sneps10}).
    \\
    
    \begin{figure}
    \begin{subfigure}[b]{0.46\textwidth}
    \centering
    \includegraphics[width=\textwidth]{tau0vseps.eps}
    \caption{}
    \label{fig:tau0lin}
    \end{subfigure}
    \hspace{0.3cm}
    \begin{subfigure}[b]{0.47\textwidth}
    \centering
    \includegraphics[width=\textwidth]{tau0vsepsLog.eps}
    %\vspace{0.01cm}
    \caption{}
    \label{fig:tau0log}
    \end{subfigure}
    \caption{(a) In blue, the longest relaxation time $\tau_0$ as a function of $\epsilon$, obtained numerically from \Eqref{eq:transcendentalpolesz}; in orange and green, estimates of the relaxation times of $\rho(-1,t)$ and $Q(t)$, respectively, according to \cite{Bazant2004}: the analysis of Ref.~\cite{Bazant2004} is valid only for small $\epsilon$ and the fact that the green and the orange curve differ and that they differ from the blue curve is an artifact of the analytical procedure followed therein. (b) The same plot in logarithmic scale. The gray line indicates $\epsilon=\frac{1}{\sqrt{3}}$, so that the points on its left were obtained from \Eqref{eq:transcendentalpolesz}, while the points on its right from \Eqref{eq:transcendentalpolesy}. At small $\epsilon$, $\tau_0$ is constant ($\sim \frac{L\lD}{D}$ in physical units), while at large $\epsilon$ it decays as $\epsilon^{-1}$ ($\sim\frac{L^2}{D}$ in physical units).}
    \label{fig:tau0}
    \end{figure}
    
    \begin{figure}[t]
    %\centering
    %\begin{tabular}{@{}cc@{}}
    \begin{subfigure}[b]{0.45\textwidth}
    \centering
    \includegraphics[width=\textwidth]{{poles_eps0.1}.eps} %&
    \vspace{0.5cm}
    \\
    \includegraphics[width=\textwidth]{{times_eps0.1}.eps} %&
    \vspace{0.1cm}
    \caption{}
    \label{fig:sneps01}
    \end{subfigure}
    \hspace{0.3cm}
    \begin{subfigure}[b]{0.45\textwidth}
    \centering
    \includegraphics[width=1.06\textwidth]{poles_eps10.eps}
    \vspace{0.5cm}
    \\
    \includegraphics[width=\textwidth]{times_eps10.eps}
    \vspace{0.1cm}
    \caption{}
    \label{fig:sneps10}
    \end{subfigure}
    \caption{(a) In blue, at the top, poles $s_i$ for $\epsilon=0.1$; at the bottom, a number line plot of the corresponding relaxation times $\tau_i$. The first pole is $s_0=-1.057$ and the longest relaxation time is $\tau_0=-s_0^{-1}=0.946$ (see Fig.~\ref{fig:tau0lin}). (b) The same thing for $\epsilon=10$. In this case the first pole is $s_0=-24.693=-10.008\frac{\pi^2}{4}$ and the longest relaxation time is $\tau_0=-s_0^{-1}=0.04050$. In orange, both in (a) and in (b), the lower bound for poles $s_i$ from \Eqref{eq:poles1}.}
    \label{fig:sn}
    \end{figure}
    
    

    
    Studying numerically the value of these relaxation rates, one can identify two limits. When $\epsilon\ll 1$, $s_0 \sim -1$, so the slowest time scale $\tau_0=-s_0^{-1}$ tends to 1 (in dimensioned time $\frac{L \lD}{D}$), as shown in Fig.~\ref{fig:tau0}; all the other $s_i$ lie on the left of $-\frac{1}{\epsilon}$, corresponding to infinitely many shorter relaxation times $\tau_i$, smaller than $\epsilon$ (in dimensioned time $\frac{\lD^2}{D}$) and accumulating around 0 (see Fig.~\ref{fig:sneps01}). When $\epsilon\gg 1$, $s_0 \sim -\epsilon\frac{\pi^2}{4}$, so the slowest time scale $\tau_0$ is close to $\frac{4}{\pi^2 \epsilon}$ (in dimensioned time $\frac{4 L^2}{\pi^2 D}$, see again Fig.~\ref{fig:tau0log}); 0 is still an accumulation point for the other time scales $\tau_i$ (see Fig.~\ref{fig:sneps10}). 
    To sum up, when $\epsilon\gg 1$, $L$ is the shortest length and the relaxation process happens on infinitely many time scales that are all of diffusive nature ($\propto \frac{L^2}{D}$). Conversely, when $\epsilon\ll 1$, $\lD$ is the shortest length and relaxation goes through an infinity of very fast processes, happening on timescales $\propto \frac{L^2}{Dn^2}$ for $n$ large enough, and approaching $\frac{\lD^2}{D}$ as $n$ becomes smaller; these processes eventually give way to a slower process, happening on a time scale $\tau_0\propto \frac{L\lD}{D} $. 
    
    The derivation of the exact time scales $\tau_i$, although with a heavier notation, can be found in Ref.~\cite{Janssen2018}, whose authors arrived independently and at the same time as us to the same results. Compared to Ref.~\cite{Bazant2004} we found discrepancies at non-vanishing $\epsilon$ (see Fig.~\ref{fig:tau0lin}). 
    
    Computing explicitly the residue
    \begin{equation} \label{eq:ResH}
    \operatorname{Res}_{H(s)}(s_i)=\frac{2 s_i (1+\epsilon s_i)}{3-s_i^2}
    \end{equation}
    allows to retrieve immediately expressions such as
    \begin{equation} \label{eq:Resrho}
    \rho(z,t)=-v \frac{\sinh{\frac{z}{\epsilon}}}{\sinh{\frac{1}{\epsilon}}} -v \sum_{n=0}^{\infty}\frac{2 (1+\epsilon s_i)}{3-s_i^2} \frac{\sinh{\frac{z \sqrt{1+\epsilon s_i}}{\epsilon}}}{\sinh{\frac{\sqrt{1+\epsilon s_i}}{\epsilon}}} \operatorname{e}^{s_i t} \,,
    \end{equation}
    that a cumbersome calculation can show to be equivalent to Eq.~(40) in \cite{Janssen2018}.
    \\
    
    What happens from a physical point of view in the EDLC must also be clear after this discussion on time scales. The electrodes, that are discharged until $t=0^-$ (\ie~$\sigma(0^-)=0$), acquire a charge $\sigma(0^+)=-v$ on the left and $+v$ on the right, as soon as the power source is switched on (the electric potential is indeed $\phi(z,0^+)=vz$). Implicit is the assumption that the migration of charges \textit{within} the electrodes, necessary for establishing the desired voltage $\pm v$, takes place on much shorter time scales than those stemming from electrolyte relaxation. At $t=0^+$, ions start to move in order to form the electric double layer, triggering a complicated relaxation phenomenon, that involves ion migration and diffusion at many length and time scales. The slowest of these time scales ($\tau_0$) is the most interesting because it is the limiting one for reaching equilibrium. When equilibrium is finally reached, after an infinite time, the density and potential profiles are the ones prescribed by the Poisson-Boltzmann equations, namely they are both proportional to a $\sinh(z/\epsilon)$ (first term of \Eqref{eq:Resrho}). The equilibrium charge on the electrodes can be deduced from the $s\to 0$ limit of \Eqref{eq:sigmahat} and corresponds to $\sigma(\infty)=-v\coth(\frac{1}{\epsilon})/\epsilon$. As $\coth(\frac{1}{\epsilon})/\epsilon>1$ for all $\epsilon$, the charge on the electrodes always increases in absolute value (greatly for $\epsilon\ll 1$, little for $\epsilon\gg 1$) after the voltage sources has been switched on: this is due to the settling of a positive charge layer close to the negative electrode and a negative charge layer close to the positive electrode, a phenomenon that tends to decrease the potential difference between the two walls and must be compensated by increasing the charge on the electrodes. 
\end{comment}



We make the \ansatz\ that the potential $\phi(z,t)$ and the electric charge density $\rho(z,t)$ relax to equilibrium as 
\begin{equation} \label{eq:ansatzphi}
\phi(z,t)=v\frac{\sinh\left(\frac{z}{\epsilon}\right)}{\sinh\left(\frac{1}{\epsilon}\right)}+v\sum_{i=0}^{\infty} b_i(z)\operatorname{e}^{s_i t} 
\end{equation}
\begin{equation} \label{eq:ansatzrho}
\rho(z,t)=-v\frac{\sinh\left(\frac{z}{\epsilon}\right)}{\sinh\left(\frac{1}{\epsilon}\right)}+v\sum_{i=0}^{\infty} B_i(z)\operatorname{e}^{s_i t} \,,
\end{equation}
for $t>0$. The time-independent terms correspond to the only solutions of the steady-state Debye-Falkenhagen equation allowed by symmetry: indeed, $\phi$ and $\rho$ must be odd with respect to $z$ and $v$. Additionally, by \Eqref{eq:P}, we have $B_i(z)=-\epsilon^2 b_i''(z)$. We suppose $s_i<0$, so that the characteristic relaxation times are $1/|s_i|$.
Substituting \Eqref{eq:ansatzrho} in \Eqref{eq:DF} and enforcing an odd charge density gives
\begin{equation} \label{eq:Bnofx}
B_i(z)=c_i \sinh\left( \frac{\sqrt{1+\epsilon s_i}}{\epsilon} z \right)\,.
\end{equation}
This expression can be integrated to get the corresponding $b_i(z)$. Fixing the gauge $\phi(0)=0$ and imposing boundary conditions \Eqref{eq:bcFlux}, one finds
\begin{equation}
b_i(z)=-c_i \left[ \frac{\sinh\left(\frac{\sqrt{1+\epsilon s_i}}{\epsilon}z\right)}{1+\epsilon s_i} + z \frac{s_i \cosh\left(\frac{\sqrt{1+\epsilon s_i}}{\epsilon}\right)}{\sqrt{1+\epsilon s_i}} \right]\,.
\label{eq:bnofx}
\end{equation}
At this point, \Eqref{eq:bcPotential} gives, for any $i$, either $c_i=0$ or
\begin{equation} \label{eq:poleseq}
1+s_i \sqrt{1+\epsilon s_i} \coth\left(\frac{\sqrt{1+\epsilon s_i}}{\epsilon}\right) = 0\,.
\end{equation}
This equation is exactly equivalent to the one solved in \cite{Janssen2018} to obtain relaxation times. An alternative solution, consistent with our notation, was independently derived in \cite{phd}. \BR{The modes characterizing the linear response can also be considered in the frequency-domain via the impedance of the cell (see \textit{e.g.} \cite{Barbero2005b,Barbero2008} for symmetric electrolytes).}

For $\epsilon = \lD/L \gg 1$, relaxation modes turn out to be of order $-\epsilon \pi^2 (i+1/2)^2$; the dominant (slowest) mode is $s_0\sim -\epsilon \pi^2/4$, corresponding to a dimensional relaxation time $\tau_0\sim 4L^2/(\pi^2 D)$. For $\epsilon = \lD/L \ll 1$, the dominant relaxation rate results exactly from the solution of the equation
\begin{equation} \label{eq:tanhZ}
    \tanh\left(\frac{Z}{\epsilon}\right)=-\frac{Z}{\epsilon}(Z^2-1),
\end{equation}
with $Z=\sqrt{1+\epsilon s_0}$. In physical units, this corresponds to a time 
\begin{equation}
\tau_0\simeq \frac{L\lD}{D} -\frac{\lD^2}{2D}\,.
\label{eq:tauBazant}
\end{equation}
The scaling $L\lD/D$ was pointed out in \cite{Bazant2004} and previously reported in \cite{MaCdonald1970,Kornyshev1977,Kornyshev1981}, while the second term represents the exact finite-double-layer correction as commented in \cite{Janssen2018,phd,Asta2019JCP}. The time scale from \Eqref{eq:tauBazant} is visible in Fig.~\ref{fig:plotfit}a, which shows numerical solutions of the ion density at contact with the electrode $\rho(-1,t)$ and of the electrode surface charge density $\sigma(t)$.



Note that assuming a monoexponential relaxation in \Eqsref{eq:ansatzphi} and~\eqref{eq:ansatzrho}, for $\epsilon\ll 1$, still leads to a surprisingly good approximation for the dominant relaxation rate \cite{phd}. 

The exact relaxation profile can be obtained by an analysis of \Eqsref{eq:DF}--\eqref{eq:bcPotential} in the Laplace domain \cite{Janssen2018,phd}, allowing to identify $c_i$ and write
\begin{equation} \label{eq:Resrho}
    \rho(z,t)=-v \frac{\sinh{\frac{z}{\epsilon}}}{\sinh{\frac{1}{\epsilon}}} -v \sum_{n=0}^{\infty}\frac{2 (1+\epsilon s_i)}{3-s_i^2} \frac{\sinh{\frac{z \sqrt{1+\epsilon s_i}}{\epsilon}}}{\sinh{\frac{\sqrt{1+\epsilon s_i}}{\epsilon}}} \operatorname{e}^{s_i t} \,.
    \end{equation}
A cumbersome computation shows that this equation, that we report for its perhaps more readable shape, is equivalent to Eq.~(40) in \cite{Janssen2018}.

As proposed in \cite{Bazant2004}, when $\epsilon=\lD/L \ll 1$, it is possible to establish an analogy between the EDLC and a simple RC circuit of the first order. We summarize this analogy here because it will prove useful in the following. Each double layer can be identified with a planar capacitor, opposing the charge of the electrode with an equal and opposite charge in the solution, distributed over a distance $\sim\lD$. Its capacitance per unit surface reads
\begin{equation}
C=\frac{\permz\permr}{\lD}\,.
\label{eq:Cplan}
\end{equation} 
Along the same spirit, the bulk, of length $2L-2\lD$, carries an electric resistance according to Drude's model of conduction. For some applied potential difference $\Delta V$, the current density can be expressed as
\begin{equation}
j = 2n_0 e^2 \beta D \frac{\Delta V}{2L-2\lD}\,.
\end{equation} 
The electric resistance of the bulk times unit surface (\ie~the inverse conductance per unit surface) is then
\begin{equation}
R=\frac{\Delta V}{j}= \frac{(L-\lD)}{n_0 e^2 \beta D}\,.
\label{eq:RNL}
\end{equation}
The circuit results as a series of a capacitance $C$, a resistance $R$ and a second capacitance $C$. Being the equivalent capacitance $C/2$, the characteristic time of the circuit turns out to be
\begin{equation}
\tau=R\frac{C}{2}= \frac{L-\lD}{2 n_0 \frac{\beta e^2}{\permz\permr}\lD D} = \frac{L \lD}{D} - \frac{\lD^2}{D}\,.
\label{eq:tauplan} 
\end{equation} 

This simple circuit analogy reproduces the dominant relaxation rate from \Eqref{eq:tauBazant} -- the correction of order $\lD^2/D$ is not exact, but has the right scaling.   







\begin{figure*}
%\centering
\begin{comment}
    On the vertical axes: \quad {\color{green}{$1+\ln\frac{\rho(-1,t)-\rho(-1,\infty)}{\rho(-1,\infty)}$}} \quad and \quad {\color{red}{$\ln \left\vert \frac{\sigma(t)-\sigma(\infty)}{\sigma(\infty)} \right\vert$}}
    \vspace{0.4cm}
    \\
    \begin{tabular}{c c}
    \includegraphics[trim={0 0 0 10}, clip, width=0.35\textwidth]{{graphfit_TwoV0.002_FDL0.01_D1-1_q1-1_K50_dt0.5_tMax1_f2_TDL0.01}.eps} &
    \includegraphics[trim={0 0 0 10}, clip, width=0.35\textwidth]{{graphfit_TwoV0.2_FDL0.01_D1-1_q1-1_K50_dt0.5_tMax1_f2_TDL0.010000125}.eps}
    \\
    \includegraphics[trim={0 0 0 10}, clip, width=0.35\textwidth]{{graphfit_TwoV0.6_FDL0.01_D1-1_q1-1_K50_dt0.5_tMax1_f2_TDL0.010001126}.eps} &
    \includegraphics[trim={0 0 0 10}, clip, width=0.35\textwidth]{{graphfit_TwoV2_FDL0.01_D1-1_q1-1_K50_dt0.5_tMax1_f2_TDL0.010012756}.eps}
    \\
    \includegraphics[trim={0 0 0 10}, clip, width=0.35\textwidth]{{graphfit_TwoV6_FDL0.01_D1-1_q1-1_K50_dt0.5_tMax10_f2_TDL0.010136131}.eps} &
    \includegraphics[trim={0 0 0 10}, clip, width=0.35\textwidth]{{graphfit_TwoV20_FDL0.01_D1-1_q1-1_K50_dt0.5_tMax10_f2_TDL0.017235595}.eps}
    \\
    \includegraphics[trim={0 0 0 10}, clip, width=0.35\textwidth]{{graphfit_TwoV60_FDL0.01_D1-1_q1-1_K100_dt0.5_tMax10_f2_TDL1131.0859}.eps} &
    \includegraphics[trim={0 0 0 10}, clip, width=0.35\textwidth]{{graphfit_TwoV200_FDL0.01_D1-1_q1-1_K10000_dt0.1_tMax0.3_f0_TDL8.8177092e+17W}.eps}
    \end{tabular}
\end{comment}

\includegraphics[width=0.96\textwidth]{TimeEvol_FDL0.01_allv_1.pdf}
\caption{Logarithmic plots of the quantities defined at the top left, where $\rho^{\pm L} = \rho(-L,t) = -\rho(L,t)$ is the charge density in the solution at contact with the electrode, $\sigma(t)$ is the surface charge density of the electrode, and $\rho^{\pm L}_{\mathrm{eq}}$ and $\sigma_{\mathrm{eq}}$ are their respective values at equilibrium. Here, $\epsilon=0.01$ and $v$ increases progressively, as indicated at the top right of each panel.
When the curves shown are linear, their slopes correspond to exponential relaxation rates. 
$s_0$ corresponds to a relaxation time $\lD L/D = 0.01\, L^2/D$ and $s'$ of $L^2/(\pi^2D) \simeq 0.10\, L^2/D$. %($s_0\simeq-1$ and $s'=-\pi^2 \epsilon\simeq -10\epsilon$ in units of $\frac{L\lD}{D}$). 
At $v=0.001$ (a), only the double layer formation process is visible with its rate $s_0$ (unless too close to $t=0$, where other rates $s_i$ can play a role). %At $v=0.1$ and $1$ (b-c), the first slope represents double layer formation, while the second slope represents depletion. 
\BR{At $v=0.1$ and $1$ (b-c), the first slope corresponds to the build-up of the double layer, while the second slope reflects its reorganization as the bulk is depleted from ions.}
The system is in the purely nonlinear regime at $v=1$ and the double layer builds up in a time $\tau_\mathrm{PNL}\propto \cosh{(v/2)}$, as defined in \Eqref{eq:tauNLcosh} in Sec.~\ref{sec:DynPlanSymPurelyNL}. 
At $v=10$ (d) the system is partially depleted at equilibrium, as discussed in Sec.~\ref{sec:DynPlanSymFullyDepleted}(see \BR{Fig.~\ref{fig:DeplDuStat}c}), but continues to relax with a time $\tau_\mathrm{PNL}$.
At $v=40$ and $100$ (e-f), the system is fully depleted (Sec.~\ref{sec:DynPlanSymFullyDepleted}): the early-time curves represent ion migration (the relaxation is not yet linear in time, but not perfectly exponential either); the late-time part represents relaxation of the counterionic double layers, in a time $\sim{\munen^2}/{D}$. Insets show $\vert (\rho^{\pm L}-\rho^{\pm L}_\mathrm{eq})/\rho^{\pm L}_\mathrm{eq} \vert$ and $\vert (\sigma-\sigma_\mathrm{eq})/\sigma_\mathrm{eq}\vert$ in linear scale.}
\label{fig:plotfit}
\end{figure*}





\subsection{Depletion}
\label{sec:DynPlanSymDepletion}

In the nonlinear regime, it is impossible to write a Debye-Falkenhagen equation for the charge density and it is harder to make analytical predictions on the dynamics. The first clearly visible nonlinear effect is depletion.
We define depletion as the decrease in the bulk population from the initial value $n_0$ to some smaller final value. As $v$ increases, more ions are attracted to the oppositely charged electrode than are repelled by the like-charged one. Since the total number of ions (the integral of the ion densities) must be conserved, this calls for a decrease in the bulk density. Indeed, in the symmetric electrolyte case, \Eqref{eq:PNP} 
is not invariant under the transformation ($n_\pm-n_0 \to n_0-n_\pm,\ z\to-z,\ \bar{q}_\pm\to\bar{q}_\mp$) -- only valid for asymptotically small voltages -- meaning that exchanging the two ion species cannot be reduced to a simple flip of their excess densities about their initial values. 
More intuitively, if the applied potential is sufficiently high, all positive ions condense on the negative electrode and all negative ions condense on the positive electrode: in this extreme case the bulk of the capacitor is basically empty  and we have full depletion, as described in Section \ref{sec:DynPlanSymFullyDepleted}. 
In this section, we focus on depletion in the linear regime $v\ll 1$, as a weakly nonlinear effect. The phenomenon has a clear signature on the relaxation dynamics and it introduces a purely diffusive time scale, that, at least in the $\epsilon\ll 1$ range, is slower than the dominant relaxation time $\tau_0$ from \Eqref{eq:tauBazant}, related to the electric double layer formation. 


To quantify depletion, we introduce a quantity, inspired by the Dukhin number \cite{BocquetRev2010, Lyklema1995}, that quantifies the fraction of ions that remains in the bulk after relaxation:
\begin{comment}
    \begin{equation}
    \Du=\frac{|\sigma(t=\infty)|}{2 n_0 L}\,.
    \label{eq:Dudef}
    \end{equation} 
    We also introduce a convenient quantity $\Du_n$, reminiscent of the Dukhin number:
\end{comment}
\begin{equation}
\Du_n=\frac{n_+(0,\infty)}{n_0}=\frac{n_-(0,\infty)}{n_0}\,.
\end{equation} 
This quantity is 1 when there is no depletion and 0 when ions are completely absent at the center of the capacitor. 
We say that the system is weakly depleted when $0.9<\Du_n<1$, depleted when $\Du_n<0.9$ and fully depleted when $\Du_n\simeq0$. 

\begin{figure}
\includegraphics[width=0.9\columnwidth]{Depletion_0_2025.pdf}
\caption{(a) Mass as a function of $z$ (in units of Table \ref{tab:units}), at different times (here in units of ${L^2}/{D}$), for $\epsilon=0.01$ and $v=2$. In these units, the electric double layer formation occurs on a time scale $\sim 0.02$. At much shorter times (dark blue) the system has not moved yet. At later times (lighter blues) the double layer has formed already and the mass diffusion process manifests itself, with a relaxation time scale $\tau'\simeq0.1$: the sinusoid of \Eqref{eq:n2ndorder} is visible. At times much larger than $\tau'$ (gray) the system is at equilibrium at a new value of bulk density, predicted by \Eqref{eq:n2ndorderbulk}. \BR{Dotted lines indicate the analytical predictions for later times as per \Eqref{eq:n2ndorder}, where the parameter $A$ was set to 0.006 for all curves.
(b)~Potential as a function of $z$, at different times (here in units of ${L^2}/{D}$), for $\epsilon=0.01$ and $v=2$. The inset is a zoom close to the left electrode, while the arrow indicates the point of null potential (see Section~\ref{sec:partiallyasym:pnl}), which in the present case is $z_0=0$.
(c)~Points show $\Du_n$ as a function of $v$, for different values of $\epsilon$, as extracted from numerical solutions of the Poisson-Nernst-Planck equation. Smaller $\Du_n$ represent stronger depletion. Solid lines are a guide to the eye. The curves at $\epsilon=100$ and $1000$, not shown here, coincide with the $\epsilon=10$ curve. In dotted lines, the prediction from \Eqref{eq:n2ndorderbulk}.}
}
\label{fig:DeplDuStat}
\end{figure}
 
We perform a weakly nonlinear analysis of the Poisson-Nernst-Planck equations. Indeed, in the linear regime, the magnitude of the corrections to $\rho$ and $\phi$ are orders of magnitude below the dominant process (the formation of the two double layers), but a new depletion-related time scale appears, slower than the previously mentioned ones. We expand ionic densities, charge density and potential -- that we already know up to linear order in $v$ -- and consider small terms of order $v^2$ and $v^3$. Since $\rho$ and $\phi$ must be odd functions of $v$, we write
\begin{align}
n_\pm(z,t)&=n_\pm^{(0)}+ v n_\pm^{(1)}(z,t) + v^2 n_\pm^{(2)}(z,t) + \nonumber \\ & \quad \quad + v^3 n_\pm^{(3)}(z,t)+ O(v^4)
\\ 
\rho(z,t)&= v \rho^{(1)}(z,t) + v^3 \rho^{(3)}(z,t) + O(v^5)
\\
\phi(z,t)&= v \phi^{(1)}(z,t) + v^3 \phi^{(3)}(z,t) + O(v^5)\,,
\end{align} 
where all quantities are dimensionless and $\rho=\frac{n_+ - n_-}{2}$ according to the units in Table \ref{tab:units}. 

\begin{comment}
    The following terms are already known from Sec.~\ref{sec:DynPlanSymSymLinear}, in which we solved the Poisson-Nernst-Plank equation to first order: 
    \begin{align}
    & n_\pm^{(0)} = 1
    \\ & \phi^{(1)}(z,t) =\frac{\sinh\left(\frac{z}{\epsilon}\right)}{\sinh\left(\frac{1}{\epsilon}\right)}+\sum_{n=0}^{\infty} b_i(z)\operatorname{e}^{s_i t} 
    \\ & \rho^{(1)}(z,t) =\pm n_\pm^{(1)}(z,t)=-\frac{\sinh\left(\frac{z}{\epsilon}\right)}{\sinh\left(\frac{1}{\epsilon}\right)}+\sum_{n=0}^{\infty} B_i(z)\operatorname{e}^{s_i t}\,,f
    \end{align}
    where the last two equations are copied from \Eqsref{eq:ansatzphi} and~\eqref{eq:ansatzrho}, the exact form of functions $b_i(z)$ and $B_i(z)$ is not important (yet known through \Eqsref{eq:Bnofx} and~\eqref{eq:bnofx}), and rates $s_i$ are defined by \Eqref{eq:poleseq}.
\end{comment}


\BR{Introducing the above expansions in the Poisson-Nernst-Planck equation~\eqref{eq:PNP} and collecting $\mathcal{O}(v^0)$ terms, we find that at order 0, $n_\pm^{(0)}=n_0$. From $\mathcal{O}(v^1)$ terms, we find that at linear order, $\phi^{(1)}(z,t)$ is given by \Eqref{eq:ansatzphi} and $\rho^{(1)}(z,t) =\pm n_\pm^{(1)}(z,t)$ by \Eqref{eq:ansatzrho}. Then, introducing these results into the equation for $\mathcal{O}(v^2)$ terms, we obtain}
\begin{multline} \label{eq:PNP2ndorder}
\pard{n_\pm^{(2)}}{t}=\epsilon \pardd{n_\pm^{(2)}}{z} - \frac{1}{\epsilon}\frac{\cosh\frac{2z}{\epsilon}}{\sinh^2\frac{1}{\epsilon}} + \\
\sum_{i=0}^\infty \operatorname{e}^{s_i t} f_i(z) + \sum_{i=0}^\infty \sum_{j=0}^\infty \operatorname{e}^{(s_i+s_j) t} g_{ij}(z) \, 
\end{multline}
\BR{where the exact form of the functions $f_i$ and $g_{ij}$, which can be expressed from $B_i$ and $b_i$ given in \Eqref{eq:Bnofx} and \Eqref{eq:bnofx}, are in fact not relevant for the present analysis. Indeed, we}
look for relaxation modes slower than the purely linear one ($s_0$, as determined by \Eqref{eq:poleseq}) for large $t$, so that the last two terms can be neglected. Imposing mass conservation in the form $\int_{-1}^1 n_\pm^{(2)}(z,t)\diff z = 0$ and requiring $n_\pm^{(2)}$ to be even in $z$ to respect symmetry, one gets
\begin{multline} \label{eq:n2ndorder}
n_\pm^{(2)}(z,t)= \\ -\frac{\epsilon}{4}\coth\frac{1}{\epsilon} + \frac{\cosh\frac{2z}{\epsilon}}{4 \sinh^2 \frac{1}{\epsilon}}+ A \cos(\pi z) \operatorname{e}^{s' t} + o(\operatorname{e}^{s' t})\,,
\end{multline} 
with $A$ constant and $s'=-\pi^2\epsilon$. \BR{It can be checked that the first two terms in the r.h.s. correspond to a particular solution of \Eqref{eq:PNP2ndorder}, while the last one is the standard solution for the corresponding homogeneous diffusion equation satisfying the symmetry and boundary conditions.} In physical units, this corresponds to a diffusive time scale 
\begin{equation}
\tau'=\frac{L^2}{\pi^2 D}\,.
\label{eq:taudepl}
\end{equation}
This second order correction to the ionic density represents depletion in the $\epsilon\ll 1$ regime (where $s'$ is indeed slower than $s_0$ and~\eqref{eq:n2ndorder} makes sense). In this case, the equilibrium density in the bulk (\ie~at $|z|\ll 1-\epsilon$), which in our units is nothing but $\Du_n$, reads to second order
\begin{equation}
n_\pm(z,\infty) \simeq n_\pm(0,\infty) = Du_n = 1 - v^2 \frac{\epsilon}{4}\coth\frac{1}{\epsilon}\,.
\label{eq:n2ndorderbulk}
\end{equation}

\BR{As shown in Fig.~\ref{fig:DeplDuStat}a, which compares numerical results with analytical approximation, \Eqref{eq:n2ndorder} well predicts late-time density profiles as a function of $z$ and $t$. In this figure, similar for this symmetric case to Figs.~8a, 9 and 10 (top right) or Ref.~\citenum{Bazant2004},} the time-damped cosine shape is visible outside the double layer (light blue and green curves). The same figure helps understanding the depletion phenomenon, consisting of a (neutral) mass diffusion of both species from the center of the EDLC toward the boundaries of the bulk region: ions to constitute the double layer are initially recruited from the regions close to the electrode, leaving a non-uniform mass distribution in the bulk (light blue curves in Fig.~\ref{fig:DeplDuStat}a). \BR{The corresponding potential across the capacitor is shown as a function of time in Fig.~\ref{fig:DeplDuStat}b.}

The mass imbalance then evens out with a purely diffusive process on a length scale $L$ rather than $2L$ (ions move from the center to the borders and not from one border to another). This explains the absence of the diffusive mode $4L^2/(\pi^2 D)$ for symmetric electrolytes, otherwise legitimate. As shown in \BR{Fig.~\ref{fig:DeplDuStat}c}, \Eqref{eq:n2ndorderbulk} predicts values of $\Du_n$ in the weakly nonlinear regime. 

Finally, the rate $s'$ can be proven to emerge naturally also in $\rho^{(3)}(z,t)$ and $\phi^{(3)}(z,t)$. This is why the relaxation rate $s'$ is visible in late-time profiles of $\rho(-1,t)$ and $\sigma(t)$, plotted in Fig.~\ref{fig:plotfit}b-c, for $\epsilon=0.01$.

To summarize, the linear regime features two processes: double layer formation and, at higher order, depletion. The double layer forms at a dominant rate $s_0$. During this process the bulk stays electroneutral, but becomes inhomogeneous as for mass density: the bulk region closer to the electrodes becomes less populated than the central region. A slower process, at least for $\epsilon<\pi^{-2}\simeq0.1$, then onsets with rate $s'$: this is a mere diffusion of neutral excess mass within the bulk, with positive and negative ions moving together from the center toward the double layer boundaries. The diffusive depletion process is asymptotically absent at $v\to0$, but its relative importance compared to the double layer formation process grows with $v$ (see the upwards shift of late-time  lines in Fig.~\ref{fig:plotfit}b and c). 

A last word of caution concerns the quantity $\lD$ defined after \Eqref{eq:DebyeFalkenhagen}, and its dimensionless equivalent $\epsilon=\lD/L$.  This `reservoir' Debye length is defined in terms of the \emph{initial} concentration $n_0$, but it is important to note that the physically relevant Debye length in the capacitor, defined for instance in terms of the depleted mid-point salt concentration, can be much larger than $\lD$. 




\subsection{Purely nonlinear regime}
\label{sec:DynPlanSymPurelyNL}

Figure \BR{\ref{fig:DeplDuStat}c} shows that for $\epsilon\gg1$ depletion occurs as soon as $v\gtrsim 1$, so it is impossible to tell apart the purely nonlinear effects, the ones that would appear even in a grand-canonical formulation of the problem, 
from the strictly canonical effects of depletion. In this case, we say that no purely nonlinear regime exists: upon increasing $v$, the system goes directly from the linear regime to a depleted nonlinear regime, that we will describe in Sec.~\ref{sec:DynPlanSymFullyDepleted}.
On the contrary, for $\epsilon\ll1$, more ions are available and depletion is only observed at voltages significantly higher than 1: this makes purely nonlinear effects visible at $v\simeq1$. These consist in a clear asymmetry, for a given species, between left and right double layer at equilibrium; however the total number of ions is much larger than the number of ions involved in the double layers, so that the bulk population stays almost unaffected (no depletion). 

In this purely nonlinear regime, the linear analysis of the relaxation times from Sec.~\ref{sec:DynPlanSymSymLinear} is not valid and the double layer formation does not happen anymore at a rate $s_0$. However, it is possible to understand the change in the rate of formation of the electric double layer by using the Grahame equation \cite{Hunter,Andelman2010}. In the units of Table \ref{tab:units}, this equation reads
\begin{equation}
|\sigma(\infty)|=\frac{2}{\epsilon} \sinh\left(\frac{v}{2}\right)\,
\label{eq:Grahame}
\end{equation} 
and is exact in the $\epsilon\to 0$ limit, even for $v>1$. 
The following differential capacitance emerges: 
\begin{equation}
\dep{|\sigma(\infty)|}{v}=\frac{1}{\epsilon}\cosh\left( \frac{v}{2} \right) \,.
\end{equation}
If this capacitance is used in the circuit model, instead of the one of \Eqref{eq:Cplan}, the relaxation time in \Eqref{eq:tauplan} becomes
\begin{equation}
\tau_{\mathrm{PNL}}=\frac{\lD L}{D} \cosh\left( \frac{v}{2} \right)\,,
\label{eq:tauNLcosh}
\end{equation}
where PNL stands for purely nonlinear. 
The same scaling appears already in \cite{Macdonald1954,Bazant2004} and is in quantitative agreement with our numerical calculations (see Fig.~2 of \cite{mainpaper}).

The same Grahame equation~\eqref{eq:Grahame} allows to estimate for what values of $v$ and $\epsilon$ depletion starts to become relevant, determining a boundary between the purely nonlinear and the depleted regimes for small $\epsilon$.
We introduce the Dukhin number 
\begin{equation}
\Du=\frac{|\sigma(t=\infty)|}{2 n_0 L}\,,
\label{eq:Dudef}
\end{equation} 
giving information on the maximum surface charge neutralisable by the ions \cite{BocquetRev2010,Lyklema1995}. We define a system as depleted when $\Du\simeq 0.1$, in a manner conceptually equivalent to the previously employed $Du_n<0.9$.
Using \Eqref{eq:Grahame}, this condition reads
\begin{equation}
\Du=2\epsilon \sinh\left(\frac{v}{2}\right)\simeq 0.1 \,.
\label{eq:DuConditionNL}
\end{equation} 
This condition can be used to identify the limit between purely nonlinear and fully depleted nonlinear regime in a ($v$, $\epsilon$) diagram, as we do in Fig.~3 of \cite{mainpaper}, where we show that it is consistent with numerical results.


\begin{comment}
        
    \begin{figure}
    \centering
    \includegraphics[width=\columnwidth, angle=0]{graphtauNL_2.pdf}
    \caption{Relaxation times $\tau$, in units of $\frac{L^2}{D}$, as a function of $v$, for different $\epsilon$. These are numerical results extracted from curves similar to those in Fig.~\ref{fig:plotfit}. In these units, $\tau_0$ corresponds to 0.001 for $\epsilon=0.001$, to 0.01 for $\epsilon=0.01$, to 0.095 for $\epsilon=0.1$, to 0.38 for $\epsilon=1$, to 0.41 for $\epsilon=10$; depletion happens on a time scale 0.1. When two timescales are visible from numerical data, they are both plotted here (this is why the same $v$ and $\epsilon$ can correspond to two symbols). The red and green dashed lines represent time from \Eqref{eq:tauNLcosh} for $\epsilon=0.001$ and $0.01$. The black dashed line represents time from \Eqref{eq:tauFDNL}. For the fully depleted nonlinear regimes, described in Sec.~\ref{sec:DynPlanSymFullyDepleted}, only the final relaxation times of type $\sim\frac{\munen^2}{D}$ are plotted (what happens before is not an exponential relaxation, neither in the partially screened, nor in the unscreened regime).}
    \label{fig:NLtimescales}
    \end{figure}


    \begin{figure}
    \centering
    \includegraphics[width=\columnwidth]{epsvDiagram.pdf}
    \caption{Schematic plot of the different relaxation regimes and their dominant relaxation times. Lin stands for linear (Sec.~\ref{sec:DynPlanSymSymLinear}), PNLin for purely nonlinear (Sec.~\ref{sec:DynPlanSymPurelyNL}), PS\,FD\,NLin for partially screened fully depleted nonlinear and US\,FD\,NLin for unscreened fully depleted nonlinear (Sec.~\ref{sec:DynPlanSymFullyDepleted}). The solid green line separates linear and nonlinear regime (it is set to $v=0.8$ to be consistent with the blue dots). The blue dots are obtained by applying condition $\Du_n=0.9$ on the data in \BR{Fig.~\ref{fig:DeplDuStat}c}. The blue shaded region illustrates the gradual transition from weak depletion to full depletion, described by \BR{Fig.~\ref{fig:DeplDuStat}c}. The blue curve represents \Eqref{eq:DuConditionNL}.  The orange curve is obtained from \Eqref{eq:veps2}.}
    \label{fig:epsvDiagram}
    \end{figure}

\end{comment}



\subsection{Fully depleted nonlinear regimes}
\label{sec:DynPlanSymFullyDepleted}

Upon increasing $v$ at $\epsilon\ll 1$, depletion becomes more and more important. The Dukhin number $Du_n$ correspondingly decreases (\BR{Fig.~\ref{fig:DeplDuStat}c}) and the late-time line representing depletion in the first plots of Fig.~\ref{fig:plotfit} gradually shifts upwards. At the same time, still for $\epsilon\ll 1$, the time scale related to charging increases as per \Eqref{eq:tauNLcosh}. In terms of Fig.~\ref{fig:plotfit}, the slope of the early-time curve gradually decreases as $v$ increases. Eventually the two processes (double layer charging and depletion) become indistinguishable and the system gradually enters the fully-depleted nonlinear regime. A similar thing happens at $\epsilon\gg 1$, where depletion coincides with nonlinearity, as discussed above. The transition to this new fully depleted regime is not abrupt and defines a band on the $(\epsilon,v)$ diagram where depletion is only partial (say, $0.1<\Du_n<0.9$ or $\Du\sim1$). Such band is relatively narrow: \BR{Fig.~\ref{fig:DeplDuStat}c} shows that the passage from $\Du_n=1$ to $\Du_n=0$ happens in no more than a decade of $v$, for all probed values of $\epsilon$ (see also Fig.~3 of \cite{mainpaper}). 

For parameters at which depletion is fully achieved, the `bulk' ionic concentration at equilibrium $n_\pm(0,\infty)$ can be orders of magnitude lower than the initial one $n_0$. In this case, all positive ions are concentrated in proximity of the negative electrodes, and vice versa. At long times, the double layer contain only counterions, so that the equilibrium distribution is governed by a sort of Gouy-Chapman length for either subsystem made of one electrode and its counterions. Such subsystem is in general not electroneutral (it cannot be so if $Du>1$): the Poisson equation shows that its Gouy-Chapman length reads, in physical units, $\munen=(2\pi q \lB \sigma_{\mathrm{res}})^{-1}$, where $\sigma_{\mathrm{res}} = |\sigma(\infty)| - 2n_0 L$ is the unscreened residual part of the electrodes' surface charge (where `nen' stands for non-electroneutral and `res' for residual). After the counterionic double layers have formed, it is reasonable to think that the last dynamic phenomenon to happen is a rearrangement of each double layer on the smallest length scale available, $\munen$; this would correspond to a relaxation time ${\munen^2}/{D}$. 
In the following we show how to predict $\sigma(\infty)$ and thus $\munen$, and what dynamics leads to the formation of the counterionic double layers.



We take a look at the large voltage asymptotics to simplify the problem. We suppose $v$ to be so high that even when equilibrium is reached, ions have negligible impact on the potential profile between the electrodes: the electric field, at any time, is approximately $V_0/L$ everywhere, except possibly within a very small distance from the electrodes. We will verify later when this assumption is correct. As soon as the power source is switched on, ions, of valence $q=1$, move by electric drag with a constant velocity $\nu =\beta D e V_0/L = vD/L$, directed toward the oppositely charged electrode. Once the ions reach the electrode, we suppose the latter to be so highly charged that a very thin double layer is formed, of negligible size compared to $L$. If the number of ions reaching the double layer is somehow proportional to the density at contact, we expect $\dens_\pm(\mp L,t)$, $\rho(\pm L,t)$ and, more rigorously, the double layer charge $\int_\mathrm{EDL} \rho(z,t)\,\diff z$ to grow linearly with time, approaching their final value in a time $t^*$. Such time is easily computed, in physical units, as the time needed for the furthermost ion to reach the oppositely charged electrode, a distance $2L$ away: 
\begin{equation}
t^*=\frac{2L}{\nu}=\frac{2L^2}{ D v}\,.
\label{eq:tstar}
\end{equation}
Fig.~\ref{fig:NLunscreened} confirms that $\rho(-L,t)$ is linear in time from $t=0$ until $t^*$.

\begin{figure}[b]
\centering
\includegraphics[width=0.8\columnwidth]{ParabolicSigma_FDL0.1_v200_a.pdf}
\caption{Ratios of $|\sigma(t)|$, in black, and $|\rho(\pm L,t)|$, in gray, versus their equilibrium values, as a function of time. Here, $\epsilon=0.1$ and $v=200$. 
The blue dashed lines represent the ideal linear evolution of $\rho$, and the theoretical \BR{prediction} for $\sigma$ from \Eqsref{eq:tstar}--\eqref{eq:parabolicsigma}. 
}
\label{fig:NLunscreened}
\end{figure}

This allows to compute the time evolution of $\sigma$. By definition, integrating the electric field to get the electric potential across a half-capacitor, for $0<t<t^*$, one must get the potential difference $V_0$. In physical units:
\begin{widetext}
\begin{equation}
V_0 = \frac{e|\sigma(t)|}{\permz\permr}L - \frac{e}{\permz\permr}\int_{-L}^0\diff z \int_{-L}^z \diff z' \underbrace{\left( 2 n_0 L \frac{t}{t^*}\delta(z'+L) + n_0 h(z',t) \right)}_{\rho(z',t)}\,
\label{eq:parabolicsigma0}
\end{equation}
\end{widetext}
with
\begin{equation}
h(z',t)= 
\begin{dcases}
I_{(-L,\, -L+\nu t)}(z')\quad &\text{if}\quad 0<t<\frac{t^*}{2} \\
I_{(-L,\, L - \nu t)}(z')\quad &\text{if}\quad \frac{t^*}{2}<t<t^*
\end{dcases}\,,
\label{eq:hoft}
\end{equation}
where $I_{(z_1,\,z_2)}(z')$ is the gate function, equal to 1 if $z'\in (z_1,z_2)$ and to $0$ otherwise. In \Eqref{eq:parabolicsigma0}, the inner integral represents the electric field in $z$ due to the ions between $-L$ and $z$. The first term in parenthesis represents positive ions that have adhered to the wall in $z=-L$ at time $t$; we make the drastic choice of a $\delta$-function distribution, but this is not crucial, as long as ions stay confined within a length $\ll L$. The second term in parenthesis is the charge density at point $z'$ in the rest of the solution, whose functional shape \Eqref{eq:hoft} is determined by the following observation. For $t<t^*/2$, the nonzero charge density is due to negative ions leaving the region $(-L,0)$ at velocity $\nu$ from left to right, while the concentration of positive ions stays constant in this half of the capacitor (though not at $-L$); for $t>t^*/2$ all negative ions have left the region and the last positive ions approach the left wall with velocity $\nu$ from right to left. Developing \Eqref{eq:parabolicsigma0} for $0<t<t^*$ gives, in dimensionless units,
\begin{equation}
|\sigma(t)|=v+ \frac{1}{\epsilon^2}\left( \frac{2t}{t^*} - \frac{t^2}{{t^*}^2} \right)\,.
\label{eq:parabolicsigma}
\end{equation}  
The electrodes' charge when the double layer formation is concluded ($t=t^*$) is then $|\sigma(t^*)|=v+\epsilon^{-2}$. This is of straightforward interpretation, since, in our units of surface charge density, $2n_0 L$ reads $\epsilon^{-2}$: the surface charge developed by the electrodes to maintain a field $v$ across the EDLC is indeed $v+\epsilon^{-2}$, because exactly $\epsilon^{-2}$ of its charge is screened by the counterions stuck at the electrode. Agreement of \Eqref{eq:parabolicsigma} with numerical data is shown in Fig.~\ref{fig:NLunscreened}. \BR{This parabolic time-dependence of the surface charge density is also consistent with the linear current derived in Ref.~\cite{Beunis2008} for the fully symmetric case considered in this section.}

For times $t>t^*$, the fast relaxation mentioned above is expected, on a time scale ${\munen^2}/{D}$. Now, the residual surface charge to be used in $\munen$ is nothing but $\sigma_{\mathrm{res}}\simeq v$.
This corresponds to a relaxation time 
\begin{equation}
\tau=\frac{4L^2}{D v^2}\,,
\label{eq:tauFDNL}
\end{equation}
which is indeed observed at sufficiently high voltages, for all values of $\epsilon$ (see Fig.~2 of \cite{mainpaper}). \BR{This exponential relaxation and corresponding timescale were not reported in Ref.~\cite{Beunis2008}. We note that in the latter reference, the authors argued for a power-law current with exponent $-3/4$, which seem supported by the experimental results of Ref.~\cite{Beunis2007}. Here, we did not attempt to give scaling laws: the system transitions to the unscreened regime in a complex fashion, even more complex for asymmetric electrolytes (see Sections~\ref{sec:asymsym} and~\ref{sec:fullyasym}), and, at least within the range of parameters that we can probe, it is hard to find scalings that work for the whole regime or to neatly separate sub-regimes.}


We made so far the crucial assumption that ions do not affect the linear potential profile through almost all the capacitor. A necessary condition for this to happen is that the electrodes' surface charge be larger than the integrated density of ions, meaning ${|\sigma(t)|}/(2n_0 L)>1$. Imposing this to \Eqref{eq:parabolicsigma}, we obtain
\begin{equation}
v>\frac{1}{\epsilon^2}\,.
\label{eq:veps2}
\end{equation}
This defines the unscreened fully depleted nonlinear regime and was used to delimit such a region in Fig.~3 of \cite{mainpaper}.

The transition region from the purely nonlinear regime to the (unscreened) fully depleted regime we just described is defined as the region comprised approximately between the curve \eqref{eq:DuConditionNL} and the curve $v=1/\epsilon^{2}$; we call this the partially screened fully depleted nonlinear regime. In such region, the relaxation process gradually changes from exponential, with a well defined relaxation time given by \Eqref{eq:tauNLcosh}, to linear in time, as in \Eqref{eq:tstar}, due to depletion. At equilibrium, the electric field generated by the electrodes is reduced (partially screened) to a fraction of $v$ in the fully depleted region of space: double layers are indeed sufficiently populated to screen a non negligible fraction of it. In addition, the electric field, as a function of $z$, changes along time, as more and more ions reach the electrodes. As a consequence, analytical examination is hard and the functional time dependence of relaxation processes had to be retrieved numerically. Numerical results (Fig.~\ref{fig:plotfit}e-f) show anyway the presence of a late-time relaxation on a fast scale $\sim{\munen^2}/{D}$, that, as $v$ increases, converges to the one \eqref{eq:tauFDNL} predicted for the unscreened fully-depleted nonlinear regime (see Fig.~2 of \cite{mainpaper}).



\section{\texorpdfstring{PARTIALLY ASYMMETRIC CASE: $q_+\neq q_-$, $D_+=D_-$}{Partially asymmetric case: q+ != q-, D+ != D-}}
\label{sec:asymsym}

\begin{figure*}
\centering
\includegraphics[width=0.99\textwidth]{tau_q1-2_q1-10_sigma_c.pdf}
\caption{Relaxation times $\tau$ as a function of $v$, for the $1:2$ case (left) and the $1:10$ case (right); different colors correspond to different values of $\lD/L =\epsilon$. When two relaxation times are visible from numerical data, one at short times and one at long times, they are both plotted here (if the same $v$ and $\epsilon$ correspond to two symbols of the same color, the solid one represents early-time and the empty one late-time relaxation). The dense dotted lines represent the purely nonlinear time obtained from \Eqsref{eq:Ctotqq} and~\eqref{eq:RNLqq} and preceding ones; for comparison, we also plot the time given by \Eqref{eq:tauNLcosh}, relevant for the symmetric case and shown with sparser dots for $\epsilon=0.01$. The gray and black lines represent the times given by \Eqsref{eq:tstarqq} and~\eqref{eq:tauFDNLqq}, respectively.
}
\label{fig:NLtimescales_qq}
\end{figure*}



\subsection{Linear regime and depletion}

We now tackle the case of asymmetric valences: $q_+\neq q_-$. This requires a redefinition of our proxy for ion concentration $\lD$, so that in the linear regime this equals the Debye length \cite{Hunter}:
\begin{equation}
    \lD^{-2} = 4\pi\lB(q_+^2 n_+^0 + q_-^2 n_-^0)\,,
\end{equation}
where $n_+^0$ and $n_-^0$ are the initial concentrations of positive and negative ions. 

The linear regime exhibits the same dynamics as the symmetric valence case, as shown by a linearization of the Poisson-Nernst-Plank equation~\eqref{eq:PNP}. For $v>0$, depletion occurs analogously to Section \ref{sec:DynPlanSymDepletion}, with one difference: with asymmetric valences, there is no reason to expect $n_\pm^{(2)}(z,t)$ to be even functions of $z$, nor to have any particular symmetry. This invalidates the reason why depletion-related diffusion took place on a length $L$ rather than $2L$ in a system with equal valences. In an asymmetric-valence system, the relaxation mode corresponding to a time 
\begin{equation}
    \tau'= \frac{(2L)^2}{\pi^2 D} % = \frac{4L^2}{\pi^2 D}
\end{equation} 
is then permitted. This characteristic time for depletion is observed numerically (see Fig.~\ref{fig:NLtimescales_qq}) at long times; for some parameter values (\eg~1:10 case, $\lD/L=0.01, v=0.1$), we observe however that after the end of the double layer relaxation and before the onset of this slower depletion mode, the faster depletion mode ${L^2}/({\pi^2D})$ is still visible.




\subsection{Purely nonlinear regime} 
\label{sec:partiallyasym:pnl}

The nonlinear regime also deviates from the symmetric-valence case: this is shown again in Fig.~\ref{fig:NLtimescales_qq} \BR{(with numerical results shown as symbols)}, that has to be compared to Fig.~2 in \cite{mainpaper}. The exponential increase of the relaxation time with the applied voltage at small $\epsilon$, that in the symmetric-valence case is explained by \Eqref{eq:tauNLcosh}, is not valid anymore in the general $q_+:q_-$ case. This is particularly evident in the 1:10 case (Fig.~\ref{fig:NLtimescales_qq}, right panel), where the relaxation time appears to be non-monotonic with $v$: an initial slight decrease, absent in the 1:1 case, is followed by an increase, steeper than in the 1:1 case. An analytical estimate for this curve can be obtained by a procedure analogous to the one leading to \Eqref{eq:tauNLcosh}, making use  of the simple RC circuit analogy. In the asymmetric valence situation, the Grahame equation~\eqref{eq:Grahame}, used to compute the capacitance, can be rewritten as per Ref.~\cite{Grahame1953}. The equilibrium (infinite time) charge density of the negative electrode, in the limit where the two double layers are completely separated ($\epsilon\to0$) reads:
\begin{equation}
|\sigma(\infty)|=\sqrt{\frac{n_0}{2\pi\lB}}\left( q_- \e^{-q_+\psi_-}+q_+ \e^{q_-\psi_-} - (q_- +q_+)\right)^{1/2}\,,
\label{eq:GrahameMinus}
\end{equation} 
where $\psi_- =\phi(-L)-\phi(0)<0$ is the potential of the negative electrode compared to the neutral bulk, in units of $(\beta e)^{-1}$, and $n_0=n_+^0/q_-=n_-^0/q_+$ is the salt concentration. If the potential on the right electrode is $\psi_+=\psi_- + 2v>0$, the surface charge on the positive electrode reads:
\begin{multline}
\hspace{-0.5cm} |\sigma(\infty)|=\sqrt{\frac{n_0}{2\pi\lB}} \\
\left( q_+ \e^{q_-(\psi_- +2v)} + q_- \e^{-q_+(\psi_- +2v)} - (q_+ +q_-)\, \right)^{1/2}\,.
\label{eq:GrahamePlus}
\end{multline} 
This corresponds to \Eqref{eq:GrahameMinus}, with the changes $q_\pm\to q_\mp$ and 
\BR{$\psi_-\to -\psi_+$}.
The charge densities on the two planes must be equal in absolute value, because of global neutrality. This allows to equate \Eqsref{eq:GrahameMinus} and~\eqref{eq:GrahamePlus}, to obtain $\psi_-$. Assuming until the end of this section that  $q_+\le q_-$ without loss of generality, one can check that the following is a solution:
\begin{equation}
\psi_-=\frac{1}{q_++q_-}\left(-2v q_- + \ln\frac{q_- \sum_{m=0}^{q_+-1} \e^{-2v m}}{q_+ \sum_{m=0}^{q_--1} \e^{-2v m}}   \right).
\label{eq:psiMinus}
\end{equation} 
Note that $\psi_-=-v+\O(v^2)$ as $v\to0$, as it should, and $\psi_-=-\frac{q_-}{q_++q_-}2v+\O(1)$ as $v\to\infty$. %Fig.~\ref{fig:PotFall1q} shows the behavior of $\psi_-$ as a function of the applied voltage. 


The differential capacitance per unit surface of the negative electrode is the derivative of \Eqref{eq:GrahameMinus} with respect to $\psi_-$, computed at the point determined by \Eqref{eq:psiMinus}: 
\begin{equation}
C_-= \frac{\permz\permr}{\lD} \sqrt{\frac{2 q_+ q_-}{q_++q_-}} \frac{\e^{q_-\psi_-}-\e^{-q_+\psi_-}}{\sqrt{ q_- \e^{-q_+\psi_-}+q_+ \e^{q_-\psi_-} - (q_++q_-) }}\,.
\label{eq:Cminusqq}
\end{equation}
Analogously, for the positive electrode we have:
\begin{widetext}
\begin{equation}
C_+= \frac{\permz\permr}{\lD} \sqrt{\frac{2 q_+ q_-}{q_++q_-}} \frac{\e^{q_-(\psi_- +2v)}-\e^{-q_+(\psi_- +2v)}}{\sqrt{ q_- \e^{-q_+(\psi_- +2v)}+q_+ \e^{q_-(\psi_- +2v)} - (q_++q_-) }}\,.
\label{eq:Cplusqq}
\end{equation}
\end{widetext}
Interestingly, for $q_-/q_+\gtrsim 3.18$, $C_-$ exhibits a non-monotonic behavior, reflected in the total capacitance per unit surface
\begin{equation}
C=\Bigl({\frac{1}{C_-}+\frac{1}{C_+}}\Bigr)^{-1}\,,
\label{eq:Ctotqq}
\end{equation}
which is represented in Fig.~\ref{fig:Cqq}. 


\begin{figure}
\centering
\includegraphics[width=1.05\columnwidth]{Capacitance_qq_2025.pdf}
\caption{Total capacitance per unit surface $C$, as a function of the applied voltage $v$, for $q_+=1$ and $q_-=1, 2,3,5, 10$. $C$ is computed from
  \Eqsref{eq:psiMinus}--\eqref{eq:Ctotqq}.
  The vertical scale is logarithmic and the slope of the obliquous asymptotes, for $v\to\infty$, is $q_+q_-/(q_++q_-)$.
  }
\label{fig:Cqq}
\end{figure}


The resistance times unit surface of the equivalent $RC$ circuit for the general $q_+:q_-$ case, in analogy with \Eqref{eq:RNL}, reads
\begin{equation}
R=\frac{2L-2\lD}{\beta e^2 n_0 q_+q_-(q_++q_-)D}\,,
\label{eq:RNLqq}
\end{equation} 
which can be rewritten in terms of $\lD$ using the fact that $q_+n^0_+ = q_-n^0_- = n_0q_+q_- $. Multiplying this resistance by the capacitance from \Eqsref{eq:Ctotqq} and preceding ones, one obtains an equivalent-RC-circuit time scale that is of order $L\lD/D$ at small $v$ and then diverges exponentially with $v$. This time is represented by the densely dotted curves in Fig.~\ref{fig:NLtimescales_qq} and well captures the numerical results, both in the non-monotonic behavior and in the steeper ascent compared to the 1:1 case.

The loss of left/right symmetry in the composition of the electric double layers and in the potential profile comes with a shift in the zero of the potential, \ie~the point $z_0$ on the $z$ axis where the solution is neutral.
This point is at the center of the capacitor ($z_0=0$) when $v\to0$; upon increasing $v$ it moves toward the electrode producing the smaller voltage drop, \ie~the electrode of the same sign as the least charged species. This is shown in Fig.~\ref{fig:ZeroPotqq}. The shift appears linear in $v$ at small applied voltages. At high voltages (where depletion is present, though), it seems to saturate at $(q_- - q_+)/(q_- +q_+ )$,
thus dividing the cell into two parts, whose sizes are in the same ratio $q_-/q_+$ as the potential drops across the two electrodes.  

Finally, to determine the boundary between the purely nonlinear and the fully depleted regime, we extend our definition of Dukhin number in \Eqref{eq:Dudef} to the asymmetric valences case, where to a salt concentration $n_0$ corresponds a maximum charge of $q_+n_+^0 = q_-n_-^0 = q_+ q_- n_0$:
\begin{equation}
    \Du = \frac{|\sigma(\infty)|}{2Lq_+q_-n_0}\,.
\end{equation}
Using \Eqsref{eq:GrahameMinus} or~\eqref{eq:GrahamePlus}, the condition $\Du\simeq 0.1$ reads  
\begin{equation}
    %\Du = 
    \epsilon \sqrt{\frac{q_++q_-}{2q_+q_-}} \left( q_- \e^{-q_+\psi_-}+q_+ \e^{q_-\psi_-} - (q_++q_-)\right)^{1/2} \simeq 0.1,
    \label{eq:DuConditionNLqq}
\end{equation}
to be complemented with \Eqref{eq:psiMinus}. Note that \Eqref{eq:DuConditionNLqq} reduces to \Eqref{eq:DuConditionNL} when $q_+=q_-$, as it should.


\begin{figure}
\centering
\includegraphics[width=0.99\columnwidth]{ZeroPotential_qq_legend.pdf}
\caption{Point of null potential $z_0$, as a function of applied voltage, in log scale. $z_0$ is retrieved numerically as the point where the charge density is zero. For both the 1:2 and the 1:10 case, different values of $\epsilon$ (10, 1, 0.1) are shown.
Circles 
represent results from a numerical solution of the nonlinear Poisson-Boltzmann equation, for a grand-canonical system with Debye length $\epsilon_\mathrm{GC} L=0.1L$; the arrows highlight that depletion, absent in the grand-canonical ensemble, pushes $z_0$ toward the positive electrode.
The dotted gray line is a guide with slope 1. Numerical errors on $z_0/L$ are of order $10^{-3}$. }
\label{fig:ZeroPotqq}
\end{figure}


\subsection{Fully depleted nonlinear regime} 
\label{sec:fullydeplNL_qq}


The unscreened fully depleted nonlinear regime, for asymptotically high applied voltages, is now characterized by the fact that the two ionic species have different velocities: a constant electric field drags the negative species $q_-/q_+$ times faster (or slower) than the positive one. The charge in the two Debye layers grows linearly in time, like in the symmetric case, but arrives at its final value at two different times. Compared to Fig.~\ref{fig:NLunscreened}, this means that the curve ${\rho(-L,t)}/{\rho(-L,\infty)}$ has a different slope than the curve ${\rho(+L,t)}/{\rho(+L,\infty)}$, which in turn translates to an abrupt change in curvature of the $\sigma(t)$ curve.

\begin{figure*}
    \centering
    \includegraphics[width=0.7\textwidth]{ParabolicSigma_q1-2_a.pdf}
    \caption{Ratios of $\sigma(t)$, $\rho^{+L}=\rho(+L,t)$ and $\rho^{-L}=\rho(-L,t)$ versus their equilibrium values, as a function of time. The electrode charge density is piecewise parabolic. The blue dotted lines represent the ideal linear evolution of $\rho(\pm L,t)$, while the blue dashed line represents \Eqref{eq:parabolicsigmaqq}. On the left: $v=200$, $\epsilon=0.1$ and $q_+\colon q_- = 1\colon 2$, so that $t_-^*=0.005$ and $t_+^*=0.01$; the curve for the electrode charge density starts at $v/[v+2\epsilon^{-2}(q_++q_-)^{-1}]=0.75$, as predicted by \Eqref{eq:parabolicsigmaqq}. On the right: $v=50$, $\epsilon=0.1$ and $q_+\colon q_- = 1\colon 10$, so that $t_-^*=0.004$ and $t_+^*=0.04$; the curve for the electrode charge density starts at $0.73$.}
    \label{fig:NLunscreenedqq}
\end{figure*}

In the quantitative analysis of this regime, we proceed as in the symmetric case (Sec.~\ref{sec:DynPlanSymFullyDepleted}). As said, the velocities of the two species are now different: $\nu_\pm= \BR{D}q_\pm \BR{e} \beta V_0/L$, assuming again very large electric field and neglecting the effect of the electrolyte distribution on the velocities. If each species travels at its (constant) velocity, the times at which the furthermost ion of each species has reached the oppositely charged electrode are:
\begin{equation}
    t_\pm^*=\frac{2L}{\nu_\pm}=\frac{2L^2}{ D q_\pm  v}\,.
\label{eq:tstarqq}
\end{equation}
After a time $t_+^*$, the total number of positive charges in the system $2n_0'L$ (we define $n_0'=q_+n_+^0=q_-n_-^0=q_+ q_- n_0$) are adsorbed on the negative electrode, and after a time $t_-^*$, the same number of negative charges are adsorbed on the positive electrode. As in Section \ref{sec:DynPlanSymFullyDepleted}, we assume that the electrolyte density at contact with the electrodes grows linearly in time and is localised in a region much smaller than the system size. 
For simplicity, we take $q_->q_+$, \ie~$t^*_-<t^*_+$. The analogous of \Eqref{eq:parabolicsigma0} for the asymmetric case, for $0<t<t_+^*$, is:
\begin{widetext}
\begin{equation}
\hspace{-4cm} 
\IP{
2 V_0 = \frac{2 e|\sigma(t)|}{\permz\permr}L - \frac{e}{\permz\permr}\int_{-L}^L\diff z \int_{-L}^z \diff z' \underbrace{\left( 2 n_0' L \,\frac{t}{t_+^*}\delta(z'+L) - 2 n_0' L\, \mathrm{min}\left(\frac{t}{t_-^*},1\right)\delta(z'-L) + n_0' h(z',t) \right)}_{\rho(z',t)}\,,
}
\label{eq:parabolicsigma0qq}
\end{equation}
with
\begin{equation}
h(z',t)= 
\begin{dcases}
I_{(-L,\, -L+\nu_- t)}(z')-I_{(L-\nu_+ t,L)}(z')\quad &\text{if}\quad 0<t<t_\mathrm{meet} \\
I_{(-L,\, L - \nu_+ t)}(z')-I_{(-L+\nu_- t,L)}(z')\quad &\text{if}\quad t_\mathrm{meet}<t<t^*_- \\
I_{(-L,\, L - \nu_+ t)}(z') \quad &\text{if}\quad t_-^*<t<t^*_+
\end{dcases}\,.
\label{eq:hoftqq}
\end{equation}
\end{widetext}
Again, $I_{(z_1,\,z_2)}(z')$ is the gate function. In \Eqref{eq:parabolicsigma0qq}, the first term in parenthesis represents positive ions that have adhered to the wall in $z=-L$ at time $t$; the second term in parenthesis represents \BR{negative} ions that have adhered to the wall in $z=L$ at time $t$ (we write it for clarity, but this term does not contribute to the integration, as the presence of adsorbed ions is already encoded in the charge neutrality condition that sets the electrodes' field inside the capacitor); the third term in parenthesis is the charge density at point $z'$ in the rest of the system. 
It helps to think of two trains of ions rigidly moving toward the oppositely charged \BR{electrodes}, where the head of each train continuously brings new ions to each corresponding double layer. Outside the double layer, on the $z<0$ side of the capacitor, the nonzero charge density is initially due to the negative ions leaving altogether toward positive $z$, while the concentration of positive ions stays constant. The same happens on the $z>0$ side, with reversed roles. In other words, as the tails of the two trains of ions travel at speeds $\nu_+$ and $\nu_-$ toward the centre of the electrode, they define three regions of positive charge (no negative ions present), zero charge (both species present) and negative charge (no positive ions present).
The two tails meet at $t=t_\mathrm{meet}$: at this time the neutral region has shrunk to a point. For $t_\mathrm{meet}<t<t_-^*$, the neutral region re-expands, this time because no ions are present in the central region anymore. The two trains continue to move until time $t=t_-^*$, when the fastest species (negative ions) has reached the oppositely charged electrode. After that, the right part of the bulk solution is neutral, whereas the left part is still populated by positive ions that have not reached the electrode yet. They do so at time $t=t_+^*$: after this time, all ions are adsorbed and the whole bulk is neutral.

Solving the integral in \Eqref{eq:parabolicsigma0qq} and nondimensionalising, one gets the following surface charge as a function of time:
\begin{widetext}
\begin{equation}
\hspace{-2cm} |\sigma(t)|=
\begin{dcases}
v+ \frac{2}{(q_++q_-)\epsilon^2}\left[ t \left(\frac{1}{t_-^*}+\frac{1}{t_+^*}\right) - \frac{1}{2}t^2\left(\frac{1}{{t_-^*}^2}+\frac{1}{{t_+^*}^2}\right) \right] \quad & \text{if}\quad 0<t<t_-^* \\
v+ \frac{2}{(q_++q_-)\epsilon^2}\left[\frac{1}{2} + \frac{t}{t_+^*} - \frac{t^2}{2{t_+^*}^2}\right] \quad & \text{if}\quad t_-^*<t<t_+^*
\end{dcases}\,.
\label{eq:parabolicsigmaqq}
\end{equation}  
\end{widetext}
At equilibrium, the electrodes' charge is $|\sigma(t^*_+)|=v+2/[(q_++q_-)\epsilon^{2}]$, as it should be, the second term representing the final amount of charge adsorbed on either electrode ($2n_0'L$ in physical units). The simple $t^2$ dependence observed in the symmetric case is here split into two parts, each relevant before or after the faster species has reached the electrode. The two parabolas in \Eqref{eq:parabolicsigmaqq} have different curvatures and are centered at different times.
\BR{\Eqref{eq:parabolicsigmaqq}} agrees with numerical data, as shown in Fig.~\ref{fig:NLunscreenedqq}. 


As for the symmetric case, for times $t>t^*_\pm$ we expect a fast relaxation over the Gouy-Chapman lengths of the two counterionic double layers. However, the relaxation of $\sigma$ is necessarily dominated by the relaxation of the slower double layer. Since the double layers are coupled through the electrodes' surface charge (equal and opposite on the two electrodes), the relaxation of the fast ions is limited by slow changes in $\sigma$ and therefore happens with the same time scale as the slow double layer. Hence the exponential relaxation for $t>t_+^*$ occurs in a time 
\begin{equation}
\tau=
\frac{4L^2}{D v^2 q_+^2}\,,
\label{eq:tauFDNLqq}
\end{equation}
which is observed at sufficiently high voltages, for all values of $\epsilon$ (see Fig.~\ref{fig:NLtimescales_qq}). 


Again, to get \Eqref{eq:parabolicsigmaqq}, it was crucial to assume that ions do not affect the linear potential profile through almost all the capacitor. 
This happens if the change in electric potential (or field) caused by their motion is small with respect to the applied voltage. The analogue of condition \Eqref{eq:veps2}, determining the phase-space boundary of the regime we just described, is then 
\begin{equation}
v>\frac{2}{(q_++q_-)\epsilon^2}\,.
\label{eq:veps2qq}
\end{equation}

We also assumed that the distance an ion can travel by diffusion in a time $t_+^*$ is much smaller than $2L$, so that we could neglect diffusion currents and only consider drift: this amounts to $v>1/q_-$. In summary, the regime we just discussed, as for the symmetric case, is defined by \Eqref{eq:veps2qq} at small $\epsilon$ and coincides with the nonlinear regime for large $\epsilon$. 


\begin{figure}
    \centering
    \includegraphics[width=\columnwidth]{Depletion_qq_b.pdf}
    \caption{Dukhin number $\Du_n^\pm=n_\pm(0,t=\infty)/n_\pm(0,t=0)$, quantifying depletion, for $q_+:q_-=1:2$ (top row) and $1:10$ (bottom row). At large $\epsilon=\lambda_D/L$ (left column), depletion sets in at lower voltages for the large-valence negative ions (blue) than for the small-valence positive ones (red). In the $1:10$ case, there exists a range of voltages at which one species is fully depleted while the other is almost non-depleted. This does not happen in the symmetric valences case (\BR{Fig.~\ref{fig:DeplDuStat}c}).}
    \label{fig:Depletionqq}
\end{figure}

In the latter large-$\epsilon$ case, it is worth mentioning that the asymmetric-valence phenomenology is richer than for symmetric valences: in the $\epsilon\gtrsim1$ regime, ions of different valence are depleted in different proportions (Fig.~\ref{fig:Depletionqq}). This can give rise to a hybrid behavior in terms of relaxation rates, that however covers a substantial range of voltages $v$ only for large, non realistic valences.  
For small $\epsilon$, between the purely nonlinear regime (non-depleted) and the unscreened nonlinear regime described by \Eqref{eq:parabolicsigmaqq} (fully depleted), we have what we called in Sec.~\ref{sec:DynPlanSymFullyDepleted} a partially screened fully depleted regime. At such intermediate $v$, the initial relaxation is neither exponential nor polynomial in time. Such relaxation can be divided in two parts, though, similarly to what happens in the unscreened regime: a first part before migration and depletion are completed, and a second part concerning relaxation inside the two counterion-only double layers. The latter process cannot but happen on the same time scale as in \Eqref{eq:tauFDNLqq}. This intermediate regime is in the asymmetric valence case even more complex, because at a given applied voltage the two species present two different levels of depletion.

\hfill


\section{\texorpdfstring{FULLY ASYMMETRIC CASE: $q_+\neq q_-$, $D_+\neq D_-$}{Fully asymmetric case: q+ != q-, D+ != D-}}
\label{sec:fullyasym}

\subsection{Linear regime}
\label{sec:fullyasym_linear}

In the linear regime, the Poisson-Nernst-Planck equations can in principle be solved analytically in the Laplace domain, as done for the fully symmetric case \cite{Bazant2004,Janssen2018,phd}. Since \Eqsref{eq:PNP} \BR{and \eqref{eq:poisson}} are coupled PDEs, two successive nontrivial diagonalisations, one in the time domain and one in the Laplace domain are needed, leading to solvable uncoupled equations for linear combinations of the ion densities. The first transformation allows to diagonalize drift currents. After passing to the Laplace domain and diagonalising a second time, the diffusion equation in space can be solved. Once time and space derivatives do not appear anymore, a cumbersome calculation brings one back to the original basis $\{\widehat{n}_+(z,s),\widehat{n}_-(z,s)\}$ (Laplace transforms of the ion densities) and boundary conditions can be imposed (potential at the electrodes, no flux through the electrodes, electroneutrality). 
\BR{As in the symmetric case, the modes characterizing the linear response can also be considered in the frequency-domain via the impedance of the cell (see \textit{e.g.}~\cite{Lelidis2005,Barbero2007,Chassagne2016,Antonova2020} for partially asymmetric electrolytes with opposite valencies but unequal diffusivities).}


The non-zero poles of these functions represent the relaxation rates of the system and can be analyzed numerically. In the following, we take as reference %$K(s)=\hrho(-1,s)/\hV(s)$
$\hrho(-L,s)$, the Laplace transform of the charge density at contact $\rho(-L,t)$. This quantity depends on $\epsilon$, on the valences, and on the additional dimensionless parameter: 
\begin{equation}
\delta=\frac{D_+}{D_-}\,. % \quad\quad \text{and} \quad\quad  \zeta=\frac{q_+}{q_++q_-}\,.
\end{equation}
We assume here that the positive species is the slower one, so that $\delta\leq1$.
A numerical analysis of $\hrho$ reveals, for any $\delta<1$, the presence of new poles that did not exist in the case $\delta=1$. 

For large $\epsilon$, $\hrho$ has twice as many poles (and zeroes).
The number of poles (and zeroes) stays infinite, but each pole from the $\delta=1$ case splits into two poles and a zero as soon as $\delta<1$. The poles can be classified into two independent hierarchies of diffusive time scales: one, $\{\tau_{+,i}\}$, for the positive species and one, $\{\tau_{-,i}\}$, for the negative species. While their exact values can be retrieved numerically, these times are well described by the following equation
\begin{equation}
\tau_{\pm,i}\simeq\frac{4L^2}{(2i+1)^2\pi^2D_\pm}\,\quad\quad i=0,1,2...\,,
\label{eq:taupmn}
\end{equation}   
asymptotically exact for $\epsilon\to\infty$.
Still assuming that positive ions are slow compared to negative ones, the slowest time scale, \ie~the dominant one at large times, is $\tau_{+,0}=4L^2/(\pi^2 D_+)$. Note that the valences of the two species do not enter in the expression for the relaxation times $\tau_{\pm,i}$; they do play a role, though, in determining the importance of each mode (\eg~the weight of positive modes increases with $q_+$).

\begin{comment}
    \begin{figure}[h]
    \centering
    \includegraphics[width=\columnwidth, angle=0]{tau0_vs_delta_paper.pdf}\\
    \caption{Slowest relaxation time $\tau_0$ extracted numerically from $K(s)$ in units of its theoretical value from \Eqref{eq:tauzeroqqDD}, as a function of $\delta$, for small values of $\epsilon$. The horizontal line of intercept 1 represents indeed \Eqref{eq:tauzeroqqDD}. $q_+:q_-=1:1$.
    }
    \label{fig:tauzeroqqDD}
    \end{figure}
    
        
    \begin{figure}
    \centering
    \includegraphics[height=0.25\textwidth, angle=0]{plot_tau0_vs_eps_1.pdf}
    \includegraphics[height=0.25\textwidth, angle=0]{plot_tau0_vs_eps_2.pdf}
    \caption{Slowest relaxation time $\tau_0$ extracted numerically from $K(s)$, in units of its large-$\epsilon$ value $\tau_{+,0}$ from \Eqref{eq:taupmn} (on the left) and in units of its small-$\epsilon$ value from \Eqref{eq:tauzeroqqDD} (on the right). Continuous lines are for a 1:2 electrolyte ($\zeta=1/3$), dashed lines are for a 2:1 electrolyte ($\zeta=2/3$).}
    \label{fig:tauzeroqqDD3}
    \end{figure}
\end{comment}


\begin{figure*}
\centering
\includegraphics[width=0.99\textwidth]{tau0_asym_2025.pdf}
\caption{a) Slowest relaxation time $\tau_0$ extracted numerically from the \BR{analytical} $\hrho(-L,s)$ in units of its theoretical value from \Eqref{eq:tauzeroqqDD}, as a function of $\delta$, for small values of $\epsilon$. The dashed horizontal line represents \Eqref{eq:tauzeroqqDD}. $q_+:q_-=1:1$. b-c) Same quantity, in units of its large-$\epsilon$ value $\tau_{+,0}$ from \Eqref{eq:taupmn} (b), and in units of its small-$\epsilon$ value from \Eqref{eq:tauzeroqqDD} (c). Continuous lines are for a 1:2 electrolyte, dashed lines are for a 2:1 electrolyte.}
\label{fig:tauzeroqqDDcombo}
\end{figure*}

For small $\epsilon$, the picture changes and the slowest time scale approaches
\begin{equation}
\tau_\mathrm{NH} = \frac{4L^2}{\pi^2 D_\mathrm{NH}}, \quad \text{with } D_\mathrm{NH}=\frac{(q_+ + q_-) D_+ D_-}{q_+ D_+ + q_- D_-}\,.
\label{eq:tauzeroqqDD}
\end{equation} 
featuring the so-called Nernst-Hartley diffusion coefficient \cite{Robinson1959}. Its presence reflects the fact that ions diffuse together under the action of an internal electric field that pulls the slowest species, while slowing down the fastest one \cite{Robinson1959}. The scaling of the relaxation time is shown in Fig.~\ref{fig:tauzeroqqDDcombo}a for the equal-valence case. Figs.~\ref{fig:tauzeroqqDDcombo}b-c show instead how the slowest relaxation time $\tau_0$ transitions from $\tau_{+,0}$ 
at large $\epsilon$ (\ref{fig:tauzeroqqDDcombo}b), to $\tau_\mathrm{NH}$ 
at small $\epsilon$ (\ref{fig:tauzeroqqDDcombo}c), for the 1:2 and 2:1 cases, at any $\delta$. 

The pole corresponding to \Eqref{eq:tauzeroqqDD}, the closest one to the origin, is however not the one with the largest residue. This is important because the residue of a pole is proportional to the weight of its corresponding mode in the time domain: a weight larger than the slowest mode's weight allows a fast mode to be visible, at least at short times. A fast, but large-weight mode represents a relaxation phenomenon that is dominant for a certain time and eventually fades out giving way to slower processes. Returning to the RC-circuit analogy, one can estimate what the time with the largest weight $\tau_\mathrm{w}$ might look like, assuming that it represents double layer charging. Recomputing the electric resistance times unit surface of \Eqsref{eq:RNL} and~\eqref{eq:RNLqq} for a bulk with asymmetric diffusivities gives
\begin{equation}
R=\frac{2L-2\lD}{\beta e^2 n_0 q_+q_-(q_+D_+ +q_-D_-)}\,.
\label{eq:RNLqqDD}
\end{equation}
Using a capacitance per unit surface $\permz\permr/\lD$ for each electrode, one finds the characteristic time
\begin{equation}
\hspace{-0.2cm}\tau_\mathrm{RC}=\frac{L\lD - \frac{\lD^2}{2}}{D_\mathrm{ave}}\,, \quad  \mathrm{with}\ D_\mathrm{ave}=\frac{q_+ D_+ + q_- D_-}{q_+ + q_-}\,,
\label{eq:tauRCqqDDlin_corr}
\end{equation}
where the factor 1/2 in front of the $\lD^2$ term was added \adhoc\ so as to match the fully symmetric case (\Eqref{eq:tauBazant}). 

This expression contains an average of the diffusion coefficients weighted by ion valences, $D_\mathrm{ave}$, rather than the Nernst-Hartley diffusivity of \Eqref{eq:tauzeroqqDD}. It explains results both from the numerical analysis of $\hrho$ (Fig.~\ref{fig:tau0_and_tauhw}a) and from solutions of the Poisson-Nernst-Planck equations (Fig.~\ref{fig:NLtimescales_qqDD}, small $v$ and small $\lD/L$).
An analysis of the weights of the mode $\tau_\mathrm{w}\simeq\tau_\mathrm{RC}$ and of the slowest mode $\tau_0\simeq\tau_\mathrm{NH}$ is presented in Fig. \ref{fig:tau0_and_tauhw}b\,; $\tau_\mathrm{w}$ has a larger weight on the whole range of $\delta$. For $\delta\to 1$, the weight of $\tau_0$ goes to 0 – the time $\tau_\mathrm{NH}$ is indeed absent from the linear analysis of the symmetric valence case.

In summary, the relaxation is fully described by \Eqref{eq:taupmn} at large $\epsilon$, where positive and negative ions are decoupled as in the fully symmetric case. At small $\epsilon$, the double layer charging occurs at early times with a time scale $\tau_\mathrm{w}\simeq\tau_\mathrm{RC}$, described by \Eqref{eq:tauRCqqDDlin_corr}. Subsequently, the purely diffusive mode from \Eqref{eq:tauzeroqqDD} sets in, featuring the Nernst-Hartley coefficient and signaling that positive and negative ions diffuse together. An inspection of the curves for $n_\pm(z,t)$ highlights the origin of this two-step relaxation. Initially, the double layer builds up mostly thanks to the faster species: the equilibrium \textit{charge} density is reached through an immediate rearrangement of the fast species around the instantaneous local concentration of the slow species. Mass concentrations are therefore different from the equilibrium ones: there is a neutral excess of mass at the electrode with the same sign as the slow species (as the slow species has not had time to escape), and a defect of mass at the opposite side. This requires a mass relaxation process, which happens precisely with the diffusive time scale of \Eqref{eq:tauzeroqqDD}. Note that even though the diffusive scaling might recall depletion, \cf~\Eqref{eq:taudepl}, the phenomenon we just described is linear in all respects and occurs also for $v\to0$.


\begin{comment}
    \begin{figure}
    \centering
    \includegraphics[width=\columnwidth, angle=0]{tauhw_vs_delta2_notes.pdf}\\
    \caption{Highest-weight relaxation time $\tau_\mathrm{hw}$ extracted numerically from $K(s)$, in units of its theoretical value from \Eqref{eq:tauRCqqDDlin_corr}, as a function of $\delta$, for different values of $\epsilon$. $\zeta=1/2$.}
    \label{fig:tauhw}
    \end{figure}
    
    \begin{figure}
    \centering
    \includegraphics[width=\columnwidth, angle=0]{ResidueRatio_vs_delta_note.pdf}\\
    \caption{Ratio of the residues of $K(s)$ with respect to pole $s_0$ and $s_\mathrm{hw}$, as a function of $\delta$. Here $\zeta=1/2$.}
    \label{fig:ResidueRatio}
    \end{figure}
\end{comment}


\begin{figure*}
\centering
\includegraphics[width=0.97\textwidth, angle=0]{tau0_and_tauw.pdf}\\
\caption{a) Largest-weight relaxation time $\tau_\mathrm{w}$ extracted numerically from $\hrho(-L,s)$, in units of its theoretical value from \Eqref{eq:tauRCqqDDlin_corr}, as a function of $\delta=D_+/D_-$, for different values of $\epsilon=\lD/L$. 1:1 electrolyte. b) Ratio of the residues of $\hrho(-L,s)$ with respect to the pole corresponding to $\tau_0$ and to the pole corresponding to $\tau_\mathrm{w}$, as a function of $\delta$. 1:1 electrolyte.}
\label{fig:tau0_and_tauhw}
\end{figure*}


\subsection{Nonlinear regimes}
\label{sec:fullyasym_NL}


An analysis of the relaxation times observed in the nonlinear regime is presented in Fig.~\ref{fig:NLtimescales_qqDD}, for $\delta=0.909$ and 0.1 and for valences 2:1 and 2:1.
Results obtained for the symmetric diffusivity cases seem to extend naturally to asymmetric diffusivities. In the purely nonlinear regimes, results from \Eqsref{eq:psiMinus}--\eqref{eq:Ctotqq} are still applicable, together with \Eqref{eq:RNLqqDD}. Qualitatively, at least for small valences, they result in a simple vertical shift of the exponential curve representing increased nonlinear capacitance, such that at small $\epsilon$ the curve coincides with the linear regime time from \Eqref{eq:tauRCqqDDlin_corr}. The shape of the curve will mostly depend on the valence ratio through the capacitance, as per Fig.~\ref{fig:Cqq}.

In the unscreened ($v\to\infty$) fully depleted regime, the discussion for the symmetric and asymmetric valence cases still applies, with the \caveat\ that asymmetry in the diffusivities will affect the initial linear drag phase. The times from \Eqref{eq:tstarqq} must then be replaced by
\begin{equation}
    t_\pm^*=\frac{2L}{\nu_\pm}=\frac{2L^2}{ D_\pm q_\pm  v}\,.
\label{eq:tstarqqDD}
\end{equation}
Once each ion train has reached the electrode, each counterionic double layer will start its internal exponential relaxation with relaxation time $4L^2/(D_\pm v^2 q_\pm^2)$. For the same reasons that led us to \Eqref{eq:tauFDNLqq} in the partially asymmetric case, the last relaxation should feature the slower of the two relaxation times of the two counterionic double layers:
\begin{equation}
    \tau = \frac{4L^2}{v^2\min(D_+ q_+^2, D_- q_-^2)}\,.
\end{equation}
This seems compatible with the numerical results presented in Fig.~\ref{fig:NLtimescales_qqDD}, that are however computationally more involved to obtain for significantly distinct values of valences and diffusivities.


\begin{figure*}
\centering
\includegraphics[width=0.99\textwidth]{tau_asym_sigma_b.pdf}
\caption{Relaxation times $\tau$ as a function of $v$, for diffusivity ratios $\delta=D_+/D_-=1/1.1$ or 1/10 and valence ratios $q_+$:$q_-=1:2$ or $2:1$. Times are in units of ${L^2}/{D_+}$ and different colors correspond to different values of $\lD/L=\epsilon$, as in the legend of Fig.~\ref{fig:NLtimescales_qq}. When present, empty symbols distinguish late-time processes from earlier-time processes (full symbols), as in Fig.~\ref{fig:NLtimescales_qq}. Two black arrows point at the values of \BR{$\tau_{0,+}$} and $\tau_\mathrm{NH}$, respectively from \Eqsref{eq:taupmn} and~\eqref{eq:tauRCqqDDlin_corr}. The colored dotted lines represent the purely nonlinear time obtained from \Eqsref{eq:RNLqqDD} and~\eqref{eq:Ctotqq} and preceding ones (see Fig.~\ref{fig:Cqq}): by construction, their small-$v$ value is $\tau_\mathrm{RC}$ from \Eqref{eq:tauRCqqDDlin_corr}. The dashed black line represents the time from \Eqref{eq:tauFDNL} with $D=D_+$. The dashed gray lines are the two times from \Eqref{eq:tstarqqDD} observed at short times, where the relaxation is linear in time.}
\label{fig:NLtimescales_qqDD}
\end{figure*}

\BR{
\section{\texorpdfstring{NON-IDEAL BEHAVIOR}{Non-Ideal Behavior}}\label{sec:nonideal}

In this section, we analyze in brief the applicability range of the Poisson-Nernst-Planck theory. Specifically, we discuss the impact of ionic correlations due to electrostatics and to ion packing by estimating
the electrostatic coupling parameter and the maximum ion density
in the device, across our regime diagram. Before doing so, we emphasize that our model is meant to provide a simple framework to benchmark further simulations, theories or experiments, allowing for a more profound assessment of the effect of non-idealities (\textit{e.g.}~electrostatic correlations, ion size, polarizability, electrode geometry).
\vspace{0.3cm}

\subsection{Deviation from mean-field}

Ionic correlations are an intrinsically discrete phenomenon, whose magnitude depends on local density and whose effect can be anisotropic and counterintuitive. It is possible to introduce  a constant effective correlation length scale in mean-field models. The effects of this effective correlation length on the small-voltage EDLC dynamics have been studied in \cite{Zhao2011,Fertig2025}, which reported small deviations from the mean-field dynamics for reasonable values of correlation length. Nonetheless, the mapping between this effective correlation length and physical parameters is somewhat elusive. We take here a different approach, relying only on the electrostatic coupling parameter. 

When only one kind of ions is present in the double layer, which is often the case in the nonlinear regimes, a useful tool to quantify the importance of ion-ion electrostatic correlations is the electrostatic coupling parameter \cite{Netz2000EPJE,Naji2013,Varenna,Palaia2022a}. It represents the squared ratio between the electrostatic energy between two ions of charge $eq$ at a distance $a$ and the thermal energy $\kB T$: 
\begin{equation}
    \Xi = \left(\frac{q^2 \lB }{a} \right)^2 .
    \label{eq:Xi}
\end{equation}
If ions adhere to a wall of charge density $e\Sigma$ and the system is electroneutral, the typical distance is fixed by the wall charge density ($a = \sqrt{q/\Sigma}$) and the coupling parameter assumes the familiar expression $\Xi = 2 \pi \lB^2 q^3 \Sigma$ \cite{Netz2000EPJE,Naji2013,Varenna,Palaia2022a}. Poisson-Boltzmann is an excellent approximation when $\Xi \lesssim 1$, while for $\Xi \gtrsim 10$ the ion density noticeably deviates from the mean-field one \cite{Moreira2000,Santangelo2006,Samaj2018a}. In addition, since usual ion sizes are smaller than $\lB = \SI{0.7}{nm}$ in water at ambient temperature, one can safely assume that absence of electrostatic correlations implies absence of ion packing effects. $\Xi \lesssim 1$ is therefore a good proxy for the absence of ionic correlations.



\subsection{Fully depleted nonlinear regime}

We analyze here the fully depleted nonlinear regime, described in Secs.~\ref{sec:DynPlanSymFullyDepleted}, \ref{sec:fullydeplNL_qq} and \ref{sec:fullyasym_NL}, and represented in the bottom-right regions of Figs. 3 and 4 in \cite{mainpaper}. In this regime, the vicinity of the electrodes is populated by counter-ions only. In addition, the system (electrode + counterions) is in general not electroneutral as the electrode charge $\Sigma$ can be larger than the amount of ions present in the system $2n_0 L$.
Looking, for simplicity, at the symmetric 1:1 case, at equilibrium all ions are in the vicinity of the electrode and the typical distance between them is $a \simeq 1/ \sqrt{2n_0L}$, so that the coupling parameter \eqref{eq:Xi} takes the form
\begin{equation}
\label{eq:XiFD}
\Xi = \frac{\lB}{4\pi L \epsilon^2} = 2 \lB^2 L n_0
\end{equation}
which is independent of $v$.
For $v>1$ and $\epsilon>1$, we always have $\Xi<1$, as realistically $\lB \ll L$ for any aqueous-electrolyte EDLC ($\lB=\SI{0.7}{nm}$), so that correlations do not matter. 
In the no-screening part of the bottom-right quadrant ($v>1$ and $v^{-1/2}<\epsilon<1$ as per Eq.~\eqref{eq:veps2}), we have $\Xi< v\lB/4\pi L$. For $v \lesssim 50$ for aqueous electrolytes, it is still $\Xi\lesssim 1$ for realistic EDLCs and correlations do not matter. 
Finally, in the partially screened depleted sector ($v>1$ and $1/\sinh({v/2}) < \epsilon < v^{-1/2}$), $\Xi$ may exceed unity for some combinations of voltage, concentration, permittivity, pore size and temperature, and the validity of mean-field should be checked on a case-by-case basis computing $\Xi$ through Eq.~\eqref{eq:XiFD}.

\subsection{Purely nonlinear regime}

We now turn to the nonlinear non-depleted regime, described in Secs.~\ref{sec:DynPlanSymPurelyNL}, \ref{sec:partiallyasym:pnl} and \ref{sec:fullyasym_NL}, represented in the central-bottom regions of Figs. 3 and 4 in \cite{mainpaper}, and identified, in the fully symmetric case, by the conditions $v>1$ and $\epsilon < (20\sinh(v/2))^{-1} $ as per Eq.~\eqref{eq:DuConditionNL}. In this regime, the system (electrode + double-layer) is electroneutral. While a theory of electrostatic coupling for two-species double layers does not exist, for large voltages counterions are expelled from the EDL, so that one can consider $\Xi = 2\pi \lB^2 q^3 \Sigma$. Once equilibrium is reached, Eq.~\eqref{eq:Grahame} for the electrode charge gives 
\begin{equation}
    \Xi = \frac{\lB}{L \epsilon}\sinh(v/2)
\end{equation}
for monovalent ions. By Eq.~\eqref{eq:DuConditionNL} again, in this sector $\Xi \leq \frac{\lB}{20 L \epsilon^2}$, with the equality holding only at the boundary with the depleted region. Replacing for $\epsilon$, this means 
\begin{equation}
    \Xi \leq \frac{4\pi}{10} \lB^2 L n_0 \simeq  \frac{LX}{\SI{5}{nm}}
\end{equation} where $X$ is the molarity of the electrolytic solution and we assumed an aqueous solution at ambient temperature. In practice, for plausible physical values of $L\approx\SI{100}{nm}$ and $X<\SI{50}{mM}$, $\Xi$ stays below 1 in the whole sector. In addition, it decreases exponentially as one moves towards lower $v$, away from the boundary with the depleted regime, so that our results are still relevant at $v\sim1$, even at large concentrations.

\subsection{Early-time ($t\rightarrow 0$)}
Even when mean-field is in principle bound to fail, it should still capture the early response, at least for initial concentrations low enough that correlations can be neglected at small times. This means
\begin{equation}
\Xi_\mathrm{bulk} = (\lB n_0^{1/3})^2 \lesssim 1
\end{equation}
For concentrations below $\SI{0.5}{M}$, this translates to $\epsilon>\SI{2}{nm} /L$, making the analysis valid at least for short times for any micrometric device.

\subsection{Final comments}

Overall, while in many regions of parameter space the mean-field assumption strictly holds, it is in general not possible to determine regions in the $v$, $\epsilon$ diagram where mean-field surely fails, so that the value of the electrostatic coupling parameter $\Xi$ should be checked case by case. This is because electrostatic correlations can introduce new length scales that make it impossible to reduce the $\Xi \lesssim 1$ condition to a simple condition on $v$ and $\epsilon$, with $\Xi$ becoming in general a different function of the system size, ion concentration, voltage, solvent permittivity and temperature.
\BR{We also note that \Eqsref{eq:PNP} for the ion dynamics neglect the coupling with that of the solvent, not only in terms of electrokinetic effects (see \textit{e.g.} \cite{Lobaskin2016, Asta2019JCP}), but also Maxwell-Stefan fluxes which may contribute as the salt concentration increases (see \textit{e.g.} \cite{Balu2018}).}

Finally, in the present work we have assumed that there are no electrochemical reactions (in particular involving the solvent) during the whole charging process. Considering the most used media, the electrochemical window of water ($v\simeq 50$), that of organic solvents ($v\simeq 60$), while that of ionic liquids ($\lesssim\SI{6}{V}$ \cite{Armand2009}) is at most $v\simeq120$. Our numerical results beyond these limits have the purpose of highlighting the dominant process, which is in general more evident far away from the transitions with other regimes.
}


\section{\texorpdfstring{CONCLUSION}{Conclusion}}

Despite its applications in electrochemistry, the relaxation to equilibrium of electric double-layer capacitors (EDLCs) has been somewhat elusive, in particular for the most common case of electrolytes with different valences and/or diffusivities. This work, together with \cite{mainpaper}, tries to fill this gap, by giving a new perspective on existing results for the linear, fully symmetric case, and by subsequently addressing the asymmetric cases and the nonlinear regimes. We are also able to find the variation of physical quantities in the bulk for the linear regime. We characterise the relaxation behavior focusing on the dominant time scales, that are usually the slowest ones. We define different regimes in the parameter space spanned by applied voltage and ion concentration, providing analytical boundaries between regimes whenever possible. For low ion concentrations, the behaviors of positive and negative ions can be mutually decoupled, with a relaxation that is diffusive (exponential in time) in the small-voltage regime and drag-dominated (linear in time) in the large-voltage one. Beyond this low concentration limit, the picture is different. At asymptotically small voltage, the relaxation is faster than diffusion, yet followed by a slower diffusion process of neutral mass in the case of asymmetric diffusivities. As voltage increases, the relaxation time increases exponentially due to nonlinearity, until the potential difference is strong enough to deplete ions from the bulk. Then relaxation gradually goes from exponential to linear in time, in a regime where the electric field across the bulk is highly varying. Lastly, if the electrode charge is much larger than the charge that the confined electrolyte can possibly neutralise, the picture from low salt concentration is recovered, where ions are dragged at constant velocity to the electrodes.

\IP{The results presented here rely on the validity of the mean-field approximation. We discussed in section VI how exceedingly large ion concentrations, caused either by too large initial concentrations or applied voltages, might bring about effects beyond mean-field that can at least partially invalidate our results, in particular in the partially screened fully depleted regime. The significance of electrostatic correlations \cite{Naji2013, Storey2012, Kanduc2010, Bonneau2023}, but also of ion pair formation \cite{Adar2017} and finite-size effects \cite{Borukhov1997,Ben-Yaakov2009, Jiang2014, Hartel2017, Gupta2020, Ma2022, Bultmann2022}, may depend on the specific kind of ions used, the permittivity of the medium \cite{Schlaich2019,Palaia2022a}, the pore size \cite{Hartel2017,Mendez-Morales2018}, the temperature and the nature of the electrode.}



Our analysis contributes to the understanding of electrochemical devices and of confined charged materials, providing a clear mapping between any point in parameter space and mean-field relaxation times. This facilitates comparison among theories that include ion specificity, finite ion sizes, ionic correlations, hydrodynamics or geometric effects \cite{Werkhoven2018,Janssen2019,Lian2020,Gupta2020, Ma2022,Yang2022}. Finally, our work paves the way to the design of optimisation procedures for the charging of EDLCs \cite{Breitsprecher2018, Breitsprecher2020, phd}, with promising applications to energy production and recovery.


\section*{\texorpdfstring{ACKNOWLEDGEMENTS}{Acknowledgements}}
This work has received funding from the European Union's Horizon 2020 research and innovation program under the Marie Sk\l{}odowska-Curie grant agreements Nos. 674979-NANOTRANS and 101034413. This project received funding from the European Research Council under the European Union's Horizon 2020 research and innovation program (Grant Agreement No.~863473). \IP{This work has received funding from the European Union's Horizon Europe research and innovation program under the Marie Sk\l{}odowska-Curie grant agreement No. 101119598-FLUXIONIC.} B.R. acknowledges financial support from the French Agence Nationale de la Recherche (ANR) under Grant No. ANR-21-CE29-0021-02 (DIADEM).




\appendix

\section{\texorpdfstring{APPENDIX: NUMERICAL METHODS}{Appendix: Numerical Methods}}
\label{sec:NumericalMethod}

We solve numerically the Poisson-Nernst-Planck equations, using a flux-conservative finite-difference method. We discretize space into nodes, positioned at $z_{k+\frac{1}{2}}$ for $k=0,..., N-1$, and edges, located at $z_{k}$ for $k=0,..., N$. If the spacing between nodes and between edges is constant, we have $z_{k+\frac{1}{2}}=-L+(k+\frac{1}{2}) \Delta z$ and $z_k=-L+k \Delta z$, with $\Delta z= 2L/N$. The extension to a nonlinear spacing is straightforward and useful. For simplicity, we will describe the algorithm assuming constant spacing.

Ion densities $n_\pm$ and potential $\phi$ are defined on nodes $z_{k+\frac{1}{2}}$, while electric field and ionic currents are defined on edges $z_{k}$; this reduces the error associated with numerical derivation or integration. Densities are initially set to their $t=0$ value, $n_\pm(z,0)=n^0_\pm$, for all nodes. Then the density and potential profiles are evolved in time in steps of $\Delta t$. More precisely, at every step $i$:
\begin{enumerate}[leftmargin=*]
\item The ionic contribution to the electric field is computed via Gauss' theorem, by numerically integrating the following charge density:
$$\rho(z_{k+\frac{1}{2}},i\,\Delta t)=\bar{q}_-\dens_-(z_{k+\frac{1}{2}},i\,\Delta t) + \bar{q}_+\dens_+(z_{k+\frac{1}{2}},i\,\Delta t)\,.$$
\item The ionic contribution to the potential is computed by numerically integrating the ionic contribution of the electric field.
\item The electrodes' (constant) contribution to the electric field is computed by imposing that the overall potential difference across the capacitor (ions' and electrodes' contributions) be $2V(i\,\Delta t)=2V_0$ for $i>0$. This corresponds to computing the surface charge density $\sigma$ of the electrodes at time $i\, \Delta t$, which is proportional to the electrodes' electric field through the dielectric permittivity.
\item The overall electric field (ions' and electrodes' contributions) determines the ionic currents through the discrete analogous of \Eqref{eq:current}.
\item Ion densities at time $(i+1)\Delta t$ are computed through the discrete analogous of \Eqref{eq:continuityeq}, starting from the just determined currents at time $i\,\Delta t$. 
\end{enumerate}  
Iteration stops when the prescribed final time is reached.

The algorithm is flux-conservative \cite{NumericalRecipes} because it conserves the numerical integral of the densities for both ionic species, \ie~the total number of ions, up to machine precision. This is a consequence of the fact that density updates are computed by the finite-difference equivalent of \Eqref{eq:continuityeq}. At any time, the total number of ions is indeed
\begin{eqnarray}
& & \sum_k \dens_\pm(z_{k+\frac{1}{2}}, t+\Delta t)\, \Delta z = \nonumber \\
&= & \sum_k \left( \dens_\pm(z_{k+\frac{1}{2}},t) + \Delta t\, \frac{j_\pm(z_{k},t)-j_\pm(z_{k+1},t)}{\Delta z} \right) \Delta z \nonumber
\\ &=& \sum_k \dens_\pm(z_{k+\frac{1}{2}},t) \Delta z + \Delta t\,\left({j_\pm(z_{0},t)-j_\pm(z_{N},t)}\right) \nonumber
\\ &=& \sum_k \dens_\pm(z_{k+\frac{1}{2}},t) \Delta z\,.
\label{eq:fluxconservative}
\end{eqnarray}

The last equality follows from the zero-current condition on the electrodes, placed at $z_0=-L$ and $z_N=+L$. This property is exact for constant spacing $\Delta z$, as shown, but also for irregular spacings, provided that $\Delta z$ in \Eqref{eq:fluxconservative} is replaced everywhere by $(\Delta z)_{k+\frac{1}{2}}=z_{k+1}-z_k$. The usage of irregular spacings, with nodes and edges more dense close to the walls and less dense in the bulk, is essential to speed up the calculation when $L$ is orders of magnitude larger than the thickness of the double layer and it also favors stability in the nonlinear regime, as mentioned below.

A necessary condition for the stability of the algorithm is that the time step $\Delta t$ verify the Courant-Friedrichs-Lewy condition \cite{NumericalRecipes}, requiring that $\Delta t < \Delta z^2 /\max_\alpha\{D_\alpha\}$. Otherwise said, assuming purely diffusive motion, the typical distance traveled by the faster species in a time $\Delta t$ must be smaller than the lattice spacing. For the numerical calculations reported in the paper, the Courant factor $\Delta t / (\Delta z^2 /\max_\alpha\{D_\alpha\})$ is between 0.05 and 0.9.  

Lastly, it is necessary to have a sufficient number of nodes inside the double layer, for the results to be accurate and stable. This is particularly important when nonlinear effects set in, as densities and potential curves become much steeper in the double layer. For this reason, irregular node spacing is fundamental and was chosen in such a way that the distribution of nodes was linear in the bulk region and became exponentially dense closer to the electrodes. In addition, nonlinear effects favor \BR{electromigration} with respect to diffusion and can elicit a rather violent response to the perturbation. This makes the Courant condition insufficient at strong voltages, calling for a further reduction of the time step. 

\BR{In contrast to canonical simulations, the results for grand-canonical systems (shown in Fig.~\ref{fig:ZeroPotqq}) are obtained by solving numerically the nonlinear Poisson-Boltzmann equation describing the final equilibrium state. In that case the Debye length sets the salt concentration in the reservoir instead of that in the system. In practice, we solve the Poisson-Boltzmann equation by an iterative procedure.}


\newpage

\bibliography{./library}




\end{document}







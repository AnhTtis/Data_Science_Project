\section{Serving Sector Association} \label{sec:CellAssociationandMetrics}

In traditional cellular networks, 
the serving sector of each \ac{UE} is typically determined using metrics related to \ac{RSRP}. 
However, when considering \acp{CCUAV} operating at altitudes above 100\,m, 
most of them are likely to be in \ac{LoS} with many sectors, 
resulting in a high probability of measuring a comparable \ac{RSRP} from all of them~\cite{3GPP36777}. 
%
This leads to two major drawbacks: 
\emph{i)} frequent handovers and ping-pong effects, and
\emph{ii)} poor experienced \acp{SINR}, 
driven by the high inter-cell interference. 
%
Importantly,
it should be noted that when employing \ac{ZF} precoding with closely-located \acp{CCUAV},
the high correlation between the complex channels of nearby \acp{CCUAV} can also lead to a noise-enhancement problem, 
arising from the increased values in the normalization matrix $\textbf{D}_b^{-1/2}$,
which decreases the useful received power $P_u$.
This further affects \acp{CCUAV} performance.

%--- Benefits of highways and AOA 
In addition to the advantage of using aerial highways to manage aerial operations, 
knowing the a priori flight route allows extrapolating useful information on the \acp{AoA} of \acp{CCUAV},
which can help to alleviate some of the above challenges.
In the following, 
we concentrate on a solution for the following drawback.
%
In conventional cellular networks, 
\acp{CCUAV} typically connect to the sector that provides the strongest \ac{RSRP}.
However, the independent design of the aerial trajectory with respect to the existing cellular network may result in scenarios where the strongest sector is unable to resolve the \ac{mMIMO} spatially multiplexed communications to/from \acp{CCUAV} flying on such route and seen at approximately the same \ac{AoA}.
Such channel correlation would result in the mentioned noise-enhancement problem, 
and consequently poor overall \acp{CCUAV} \ac{SINR} performance.
%
An example of such scenario would be that where the aerial route is perpendicular to the \ac{mMIMO} antenna panel of the strongest sector. 
In those cases, 
it may be beneficial to associate to a reasonably weaker sector but with better multiplexing capabilities. 
This is a trade-off exacerbated by the nature of aerial highways,
which has never been investigated in the \acp{CCUAV} literature. 
To address the aforementioned issues,
this study proposes a novel indicator that relies on the exploitation of predefined aerial highways design information to assign a multiplexing capability score to each sector, 
which can be used to drive a smarter cell selection process for \acp{CCUAV}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Eigenscore-based Indicator }\label{subsec:eigenscore}

In this section, 
we introduce a new cell selection indicator for enhancing the cell selection ---and thus the performance--- of \acp{CCUAV} flying on aerial highways.  
For the sake of argument, 
let us consider a route $r$ with its $N_w$ equidistant aerial waypoints, 
as mentioned earlier.

In a planing stage, 
a complex channel vector $\textbf{h}_{w, b}$ between each waypoint $w$ and sector $b$ can be calculated by performing a set of measurements, 
before starting to operate the aerial route, 
and/or using eq.~\eqref{eq:General_RicianChannel} in this case.
%
Then, the complex channel vectors $\textbf{h}_{w, b}$ collected across all waypoints can be used to create the complex channel matrix $\textbf{H}_{r,b} \in \mathbb{C}^{N_w \times M}$ associated with route $r$ and sector $b$.
%
Once the complex channel matrix $\textbf{H}_{r,b}$ is derived for each route $r$ and sector $b$,
the related set of eigenvalues $\boldsymbol{\Lambda}^{\mathrm{eig}}_{r,b}$ can be calculated using,
e.g., \ac{SVD}, 
and scaled in the range $\left[0,1\right]$ to proportionally identify the most relevant ones as follows
\begin{equation}
    \boldsymbol{\bar{\Lambda}}_{r,b}^{\mathrm{eig}} = \frac{\boldsymbol{\Lambda}^{\mathrm{eig}}}
    {\sum_{ \lambda_i \in \boldsymbol{\Lambda}^{\mathrm{eig}}_{r,b}} \left| \lambda_i \right|^2} \,.
\end{equation}
%
With this, 
we can define an eigenscore ${\rm ES}_{r,b}$ for each route $r$ and sector $b$ as the number of eigenvalues greater than a threshold $\lambda_{\mathrm{Th}} \in \left[ 0,1\right]$,
i.e.,
\begin{equation}\label{eq:EigenScore_definition}
    {\rm ES}_{r,b} = \mathrm{Card}\left\{\mathbb{K}_{r,b} \right\},  \mathrm{with} \, \, \mathbb{K}_{r,b} =
    \left\{ k \in   \boldsymbol{\bar{\Lambda}}_{r,b}^{\mathrm{eig}} \,
    | \, k \geq \lambda_{\mathrm{Th}}  \right\} \,.
\end{equation} 

It is worth highlighting that the defined eigenscore ${\rm ES}_{r,b}$ is highly dependent on the geometry of the problem, 
e.g., the angle of the aerial highway with respect to the \ac{mMIMO} antenna panel. 
For instance, 
a route $r$ precisely aligned with the normal direction of the \ac{mMIMO} antenna panel of sector $b$ and located at the same altitude, 
will yield the eigenscore ${\rm ES}_{r,b}=1$.
Conversely, 
a route $r$ parallel to the \ac{mMIMO} antenna panel of sector $b$ is likely to exhibit a higher eigenscore, 
i.e., ${\rm ES}_{r,b}>1$
as the incoming signals are perceived with distinct \acp{AoA}.
%
Plainly speaking, 
this eigenscore allows to assess the degrees of freedom that sector $b$ has on route $r$.
%
To corroborate such statements, 
Figure~\ref{fig:EigenvaluesEigenscore_evolution} illustrates, 
for each sector $b$ in our network, 
the eigenvalues and eigenscores when assessing various routes with different orientations at an altitude of 100\,m.

In this work,
we are interested in considering both the signal strength and spatial diversity features of the complex channel to drive the cell selection process,
with minimal changes to the state-of-the-art process.
In the following, 
we show how this new indicator blends with the traditional \ac{RSRP}-based one.

\begin{figure}[!t]
    \centering
    \subfigure[Eigenvalues south ($\mathrm{MS_\mathrm{SO}}$).]{
    \includegraphics[width=0.2275\textwidth]{Figure/SingleEigenPlot/EigenValues_dist_bs_0.eps}
    \label{subfig:Eigvalues_bs0}
    } 
    \subfigure[Eigenscore south ($\mathrm{MS_\mathrm{SO}}$).]{
    \includegraphics[width=0.2275\textwidth]{Figure/SingleEigenPlot/EigenScore_dist_bs_0.eps}
    \label{subfig:Eigscore_bs0}
    }
    \subfigure[Eigenvalues west ($\mathrm{MS_\mathrm{WE}}$).]{
    \includegraphics[width=0.2275\textwidth]{Figure/SingleEigenPlot/EigenValues_dist_bs_1.eps}
    \label{subfig:Eigvalues_bs1}
    }
    \subfigure[Eigenscore west ($\mathrm{MS_\mathrm{WE}}$).]{
    \includegraphics[width=0.2275\textwidth]{Figure/SingleEigenPlot/EigenScore_dist_bs_1.eps}
    \label{subfig:Eigscore_bs1}
    }
    \subfigure[Eigenvalues north-east ($\mathrm{MS_\mathrm{NE}}$).]{
    \includegraphics[width=0.2275\textwidth]{Figure/SingleEigenPlot/EigenValues_dist_bs_2.eps}
    \label{subfig:Eigvalues_bs2}
    }
    \subfigure[Eigenscore north-east ($\mathrm{MS_\mathrm{NE}}$).]{
    \includegraphics[width=0.2275\textwidth]{Figure/SingleEigenPlot/EigenScore_dist_bs_2.eps}
    \label{subfig:Eigscore_bs2}
    }
\caption{Eigenvalues and Eigenscore computed in each sector for different rotation or aerial highways. With threshold $\lambda_{\mathrm{Th}}=0.10$\,. \label{fig:EigenvaluesEigenscore_evolution}}
% \vspace{-3em}
\vspace{-0.965cm}
\end{figure}
%

% \vspace{-1em}
\subsection{Enhanced Cell Selection Metric}

We now exploit our proposed eigenscore ${\rm ES}_{r,b}$ in eq.~\eqref{eq:EigenScore_definition} to formulate two new metrics to drive the \acp{CCUAV} cell selection process. 
Let us assume that,
in the operational stage, 
each sector $b$ broadcasts for each route $r$ the earlier calculated eigenscore $\mathrm{ES_{r,b}}$ during the planning stage in its broadcast channel. 
In addition, 
let us assume that all \acp{CCUAV} are aware of a maximum $\mathrm{RSRP}_\mathrm{}^\mathrm{max}$ and a minimum $\mathrm{RSRP}_\mathrm{}^\mathrm{min}$ \ac{RSRP} value for normalization purposes. 
The sector $b$ with the resulting larger metric will be selected as server. 

% SUM METRIC
With this in mind,
and dropping the route index $r$ for convenience, 
we first define a metric $\textbf{Z}_{d}^{\mathrm{SUM}}$ based on the weighted sum of the eigenscore of each sector $b$ and the \acp{RSRP} of each \acp{CCUAV} $d$,
as follows
\begin{gather}\label{eq:SUM_Metric}
    \tag{M1}
    \textbf{Z}_{d}^{\mathrm{SUM}} = \alpha \frac{ \mathrm{\textbf{ES}}_\mathrm{} - \mathrm{ES}_\mathrm{}^\mathrm{max}  }{  \mathrm{ES}_\mathrm{}^\mathrm{max} - \mathrm{ES}_\mathrm{}^\mathrm{min} } + \\
    + \left( 1-\alpha \right) \frac{ \mathrm{\textbf{RSRP}}_{d} - \mathrm{RSRP}_\mathrm{}^\mathrm{max}  }{  \mathrm{RSRP}_\mathrm{}^\mathrm{max} - \mathrm{RSRP}_\mathrm{}^\mathrm{min} }, \nonumber
\end{gather}
%with 
%\begin{equation}
%    \mathrm{ES}_\mathrm{}^\mathrm{max} = \max\left( \mathrm{\textbf{ES}}_\mathrm{} \right) ,
%     %\mathrm{RSRP}_\mathrm{ccuav}^\mathrm{max} = \max\left( \mathrm{\textbf{RSRP}}_\mathrm{ccuav} \right) ,
%\end{equation}
%and
%\begin{equation}
%    \mathrm{ES}_\mathrm{}^\mathrm{min} = \min\left( \mathrm{\textbf{ES}}_\mathrm{} \right),\,
%     %\mathrm{RSRP}_\mathrm{ccuav}^\mathrm{min} = \min\left( \mathrm{\textbf{RSRP}}_\mathrm{ccuav} \right),
%\end{equation}
where 
$\alpha$ is a weighting factor,
$\textbf{ES}_\mathrm{} = \left[ \mathrm{ES}_1, \ldots, \mathrm{ES}_{N_\mathrm{MS}}\right]$
is the vector containing the eigenscores broadcasted by each sector $b$, 
$\textbf{RSRP}_d = \left[ \mathrm{RSRP}_1, \ldots, \mathrm{RSRP}_{N_\mathrm{MS}}\right]$
is the vector containing the \acp{RSRP} of \ac{CCUAV} $d$ with respect to each sector $b$,
$\mathrm{ES}_\mathrm{}^\mathrm{max} = \max\left( \mathrm{\textbf{ES}}_\mathrm{} \right)$
and $\mathrm{ES}_\mathrm{}^\mathrm{min} = \min\left( \mathrm{\textbf{ES}}_\mathrm{} \right)$.
%Note that both $\textbf{ES}_\mathrm{ccuav}$ and $\textbf{RSRP}_\mathrm{ccuav}$ are normalised to be within the range $[0,1]$.
%
Intuitively, 
the objective of this metric is to consider the eigenscore as a power offset to the traditional \ac{RSRP}-based metric during the cell selection process.
This would facilitate the computations at the \ac{CCUAV},
as the eigenscore, as mentioned earlier, can be broadcast by each sector in their control channels,
e.g., \ac{PBCH}.

%CAP Metric
The second defined metric $\textbf{Z}_d^{\mathrm{CAP}}$ based on the proposed eigenscore is inspired by the Shannonâ€“Hartley channel capacity theorem, 
and has been formulated as follow
\begin{gather}\label{eq:CAP_Metric}
\small
    \tag{M2}
    \textbf{Z}_{d}^{\mathrm{CAP}} =
    \textbf{ES}_\mathrm{}  \log_2\left( 1 + \mathrm{\textbf{SNR}}_d  \right) \sim \\
    \sim \textbf{ES}_\mathrm{}  \log_2\left( 1 + \mathrm{\textbf{RSRP}}_d  \right). \nonumber
\end{gather} 
This metric attempts to assess the achievable capacity of \ac{CCUAV} $d$ in a noise-limited regime, 
taking into account the multiplexing capabilities of the sector on the route and the signal strength measured by the \ac{CCUAV}.
%
The computation of this metric is more involved than the previous one,
but allows to capture the linear and logarithmic relationship between spatial multiplexing and signal strength in terms of capacity.
No normalisation is needed. 

%Still, this metric does not capture the capacity of the CCUAV in the interference limited regime, and does not consider than the multiplexing capabilities at the route may be already at use in the cell.
\begin{lemma}\label{lemadistanciaLp}
Let $\boldsymbol{z} = (z_1,z_2, \ldots, z_n)$ and $\boldsymbol{r} = (r_1, r_2, \ldots, r_n)$ be vectors of $\Z^n$ such that $0 \leq r_i < q$ for all $i \in \{1,\ldots,n\}$. Then
 $||q\boldsymbol{z}+\boldsymbol{r}||_{\mathrm{P}} \geq ||\boldsymbol{\mu}||_{\mathrm{P}}$, where $\boldsymbol{\mu} := (\mu_1, \ldots, \mu_{n})$ and $\mu_{i} : = \min\left\{q - r_i, r_i\right\}$ for all $i \in \{1,\ldots,n\}$.
\end{lemma}
\begin{proof} 
Since the largest negative integer of the form $qz_i+r_i$ is $-q+r_i$ 
and the smallest positive integer is $r_i$, it follows that $|qz_i+r_i| \geq \min \{|-q+r_i|, |r_i|\} =  \min \{r_i, q-r_i\}$. Then
$$||q\boldsymbol{z}+\boldsymbol{r}||_{\mathrm{P}} = \left(\sum_{i=1}^{n}|qz_i+r_i|^P\right)^{1/P} \geq \left(\sum_{i=1}^{n}\min \{r_i, q-r_i\}^{P} \right)^{1/P} = ||\boldsymbol{\mu}||_{\mathrm{P}}.$$
 \end{proof}

Right now, we are already preparing to present and demonstrate a formula for the $L_{\mathrm{P}}$-distance of Construction $\overline{D}$. When $\mathrm{P} = 1$, the Theorem \ref{TeoDistLpDbarra} was proved in {\cite[Thm $3$]{strey2018bounds}} and when $\mathrm{P} = 2$ for a chain of binary codes, in {\cite[Thm $3$]{sadeghi2006low}}.

\begin{theorem}\label{TeoDistLpDbarra}
Let $\boldsymbol{0} \subsetneq \mathcal{C}_{a} \subseteq \mathcal{C}_{a - 1} \subseteq \cdots \subseteq \mathcal{C}_1 \subseteq \Z_{q}^{n}$ be a family of nested $q$-ary linear codes. Fix the $L_{\mathrm{P}}$-distance, with $1 \leq \mathrm{P} \leq \infty$, and denote the $L_{\mathrm{P}}$-distance of  $\mathcal{C}_\ell$ by $d_{\mathrm{P}}(\mathcal{C}_{\ell})$. Then, the $L_{\mathrm{P}}$-distance of $\Gamma_{\overline{D}}$ in $\R^n$ satisfies 
\begin{equation*}
    d_{\mathrm{P}}(\Gamma_{\overline{D}}) = \min \left\{q^{a}, q^{a - 1}d_{\mathrm{P}}(\mathcal{C}_1), \ldots, d_{\mathrm{P}}(\mathcal{C}_a)\right\}.
\end{equation*}
\end{theorem}
\begin{proof}
We use arguments as the ones in  of \cite[Thm $3.2.10$]{strey2017construccoes}. For each $1 \leq \ell \leq a$, we know by Lemma \ref{lemaexistpontosLp} that there exists $\boldsymbol{x}_{\ell}, \boldsymbol{y}_{\ell} \in \mathcal{C}_{\ell}$ such that $||\sigma(\boldsymbol{x}_{\ell}) - \sigma(\boldsymbol{y}_{\ell})||_{\mathrm{P}} = d_{\mathrm{P}}(\mathcal{C}_{\ell})$. Fix $1 \leq \ell \leq a$. Since $q^{a - \ell} \sigma(\mathcal{C}_{\ell}) \subseteq \Gamma_{\overline{D}}$, then $q^{a - \ell}\sigma(\boldsymbol{x}_{\ell}), q^{a - \ell} \sigma(\boldsymbol{y}_{\ell}) \in \Gamma_{\overline{D}}$. For one hand, we have
\begin{equation*}
    ||q^{a - \ell} \sigma(\boldsymbol{x}_{\ell}) - q^{a - \ell} \sigma(\boldsymbol{y}_{\ell})||_{\mathrm{P}} = q^{a - \ell} ||\sigma(\boldsymbol{x}_{\ell}) -  \sigma(\boldsymbol{y}_{\ell})||_{\mathrm{P}} = q^{a - \ell} d_{\mathrm{P}}(\mathcal{C}_{\ell}).
\end{equation*}
On the other hand, $q^{a}\Z^{n} \subseteq \Gamma_{\overline{D}}$, so that $d_{\mathrm{P}}(\Gamma_{\overline{D}}) \leq q^{a}$. This proves that
\begin{equation*}
    d_{\mathrm{P}}(\Gamma_{\overline{D}}) \leq \min \left\{q^{a}, q^{a - 1} d_{\mathrm{P}}(\mathcal{C}_1), \ldots, d_{\mathrm{P}}(\mathcal{C}_a)\right\}.
\end{equation*}
For the other inequality, let $\boldsymbol{x}, \boldsymbol{y} \in \Gamma_{\overline{D}}$ be distinct elements, with $\boldsymbol{x} = q^{s} \boldsymbol{v}$ and $\boldsymbol{y} = q^{k}\boldsymbol{w}$, where $\boldsymbol{v}, \boldsymbol{w} \in \Z^{n}$ and $\boldsymbol{v}, \boldsymbol{w} \not \equiv \boldsymbol{0} \mod q$. Assume $s \geq k$ without loss of generality. 
\begin{itemize}
    \item[$(i)$] If $k \geq a$, we have $d_{\mathrm{P}}^{\mathrm{P}}(\boldsymbol{x}, \boldsymbol{y}) = d_{\mathrm{P}}^{\mathrm{P}}(q^{s}\boldsymbol{v}, q^{k}\boldsymbol{w}) = q^{k\mathrm{P}} d_{\mathrm{P}}^{\mathrm{P}}(q^{s - k} \boldsymbol{v}, \boldsymbol{w}) \geq q^{a\mathrm{P}}$ since $\boldsymbol{0} \neq q^{s - k}\boldsymbol{v} - \boldsymbol{w} \in \Z^{n}$.
    %Precisa detalhar última parte???
    \item[$(ii)$] If $0 \leq k \leq a - 1$ and $0 \leq s \leq a - 1$, then there exists $\boldsymbol{c}_1 \in \mathcal{C}_{1}, \ldots, \boldsymbol{c}_{a - k} \in \mathcal{C}_{a - k}$ and $\boldsymbol{z} \in \Z^{n}$ such that
    \begin{equation*}
        \boldsymbol{y} = q^{a} \boldsymbol{z} + q^{a - 1} \sigma(\boldsymbol{c}_1) + \cdots + q^{k} \sigma(\boldsymbol{c}_{a -  k}),
    \end{equation*}
    which implies 
    \begin{equation*}
        \boldsymbol{w} = q^{a - k} \boldsymbol{z} + q^{a - 1 - k} \sigma(\boldsymbol{c}_1) + \cdots + q^{0}\sigma(\boldsymbol{c}_{a - k}).
    \end{equation*}
    Note that $\boldsymbol{w} \! \mod q = q^{0} \sigma(\boldsymbol{c}_{a - k}) \in \mathcal{C}_{a - k}$. Denote $\overline{\boldsymbol{w}}:= \rho(\boldsymbol{w})$ and $\overline{\boldsymbol{v}} : = \rho(\boldsymbol{v})$, where $\rho: \Z^{n} \rightarrow \Z_q^{n}$ is the reduction map modulo $q$. Since $\boldsymbol{w} \mod q = q^{0} \sigma(\boldsymbol{c}_{a - k})$, then $\overline{w} = \boldsymbol{c}_{a - k}\in \mathcal{C}_{a - k}$. Analogously, we can show that $\overline{\boldsymbol{v}} \in \mathcal{C}_{a - s}$. It follows that $q^{s - k} \overline{\boldsymbol{v}} - \overline{\boldsymbol{w}} \in \mathcal{C}_{a - k}$ and, due the fact that $\boldsymbol{w} \not \equiv \boldsymbol{0} \mod q$ and $\boldsymbol{w} \neq \boldsymbol{v}$, this is a nonzero vector. Hence,
     \begin{equation*}
         d_{\mathrm{P}}(\boldsymbol{x}, \boldsymbol{y}) = d_{\mathrm{P}}(q^{s}\boldsymbol{v}, q^{k}\boldsymbol{k}\boldsymbol{w}) = q^{k} d_{\mathrm{P}}(q^{s - k}\boldsymbol{v}, \boldsymbol{w}) = q^{k}d_{\mathrm{P}}(q^{s - k}\boldsymbol{v} - \boldsymbol{w}, \boldsymbol{0}) \geq q^{k} d_{\mathrm{P}}(\mathcal{C}_{a - k}),
     \end{equation*}
     where the last inequality follows from 
     \begin{equation*}
         |q^{s - k} v_i - w_i| \geq \min \left\{\sigma(q^{s - k} \overline{v}_i - \overline{w}_i), q - \sigma(q^{s - k} \overline{v}_i - \overline{w}_i)\right\},\ \mbox{for each} \ i \in \{1, \ldots, n\}.
     \end{equation*}     
     \item[$(iii)$] If $0 \leq k \leq a - 1$ and $s \geq a$, we have $\boldsymbol{x} = q^{a}q^{s - a}\boldsymbol{v} =: q^{a}\boldsymbol{z}$, where $\boldsymbol{z} \in \Z^{n}$. Repeating the argument used in item $(ii)$, we get $\boldsymbol{0} \neq \overline{\boldsymbol{w}} \in \mathcal{C}_{a - k}$. So, for $1 \leq \mathrm{P} < \infty $, we obtain
     \begin{eqnarray*}
         d_{\mathrm{P}}(\boldsymbol{x}, \boldsymbol{y}) = q^{k} d_{\mathrm{P}}(q^{a - k}\boldsymbol{z}, \boldsymbol{w}) = q^{k} \left(\displaystyle \sum_{i = 1}^{n}|q^{a - k}z_i - w_i|^{\mathrm{P}}\right)^{1/\mathrm{P}} &\geq& q^{k} \left( \displaystyle \sum_{i = 1}^{n} \min \left\{\sigma(-\overline{w}_i), q - \sigma(-\overline{w}_i)\right\}^{\mathrm{P}}\right)^{1/\mathrm{P}}\\
         &\geq& q^{k} ||-\overline{\boldsymbol{w}}||_{\mathrm{P}} \geq q^{k} d_{\mathrm{P}}(\mathcal{C}_{a - k}),
     \end{eqnarray*}
     where the first inequality follows from Lemma \ref{lemadistanciaLp} by taking $c_i = - w_i$. 
     For $\mathrm{P} = \infty$, we proceed in a similar way
     \begin{eqnarray*}
         d_{\infty}(\boldsymbol{x}, \boldsymbol{y}) &=& q^{k} d_{\infty}(q^{a - k}\boldsymbol{z}, \boldsymbol{w}) = q^{k} \max \left\{|q^{a - k}z_i - w_i|: \ 1 \leq i \leq n\right\}\\
         &\geq& q^{k} \max \left\{\mu_i: 1 \leq i \leq n\right\} \geq  q^{k}||-\overline{\boldsymbol{w}}||_{\infty} \geq q^{k}d_{\infty}(\mathcal{C}_{a - k})
     \end{eqnarray*}
     where $\mu_i$ denote $\min \left\{\sigma(- \overline{w}_i), q - \sigma(- \overline{w}_i)\right\}$ for each $i \in \{1, \ldots, n\}$ and the first inequality follows from Lemma \ref{lemadistanciaLp}. 
\end{itemize}
Finally, we conclude that $d_{\mathrm{P}}(\boldsymbol{x}, \boldsymbol{y}) \geq \min \left\{q^{a}, q^{a - 1}d_{\mathrm{P}}(\mathcal{C}_1), \ldots, d_{\mathrm{P}}(\mathcal{C}_a)\right\}$, completing the proof.
\end{proof}

\begin{corollary}\label{cordistLpConstD}
Under the hypothesis of Theorem \ref{TeoDistLpDbarra}, if  $\Lambda_{\overline{D}}$ is the smallest lattice that contains  $\Gamma_{\overline{D}}$, then
\begin{equation*}
    d_{\mathrm{P}} (\Lambda_{\overline{D}}) \leq \min \left\{q^{a}, q^{a - 1} d_{\mathrm{P}}(\mathcal{C}_1), \ldots, d_{\mathrm{P}}(\mathcal{C}_{a})\right\}.
\end{equation*}
Moreover, if the chain is closed under the zero-one addition, it holds that 
\begin{equation*}
    d_{\mathrm{P}}(\Lambda_{\overline{D}}) = d_{\mathrm{P}} (\Lambda_{D}) = \min \left\{q^{a}, q^{a - 1} d_{\mathrm{P}}(\mathcal{C}_1), \ldots, d_{\mathrm{P}}(\mathcal{C}_{a})\right\}.
\end{equation*}
In particular, if the chain is closed under zero-one addition and the minimal distance of $\mathcal{C}_{\ell}$ satisfies $d_{\mathrm{P}}(\mathcal{C}_{\ell}) \geq q^{\ell}$ for each $1 \leq \ell \leq a$, then $d_{\mathrm{P}}(\Lambda_{D}) = q^{a}$.
\end{corollary}
\begin{proof}
The first inequality follows from $\Gamma_{\overline{D}} \subseteq \Lambda_{\overline{D}}$. For the second, we just use that $\mathcal{C}_{a} \subseteq \cdots \subseteq \mathcal{C}_{1} \subseteq \Z_{q}^{n}$ is closed under the zero-one addition if and only if $\Gamma_{\overline{D}} = \Lambda_{\overline{D}} = \Lambda_{D}$ {\cite[Thm $9$]{strey2017lattices}}. 
\end{proof}

\begin{remark}
From the demonstration above, we can see that the condition of the codes being nested was not used. In fact, if the underlying codes are linear but not necessarily nested, we can consider a particular case of another well-studied construction, named the Construction $C$. In this case, we can deduce the same formula for the $L_\mathrm{P}$-minimum distance of the discrete set $\Gamma_{C}$ proceeding as in the Theorem above. This generalizes a known result for the Euclidean minimum distance of Construction $C$, which is presented in \cite{conway2013sphere} and \cite{bollauf2019multilevel}. 
\end{remark}

\begin{example}
Considering the family of codes given in Example \ref{excomordemdiferentedeplasConstD}, observe that both chains are closed under the zero-one addition, since $\mathcal{C}_1 = \Hat{\mathcal{C}}_1 = \Z_{6}^{2}$. Thus, in this case, by Theorem \ref{TeoDistLpDbarra} the codes $\mathcal{C}_2$ and $\Hat{\mathcal{C}}_2$ determine completely the minimum distance of $\Lambda_{D}$ and $\Hat{\Lambda}_{D}$, respectively. More precisely, for the Euclidean minimum distance, we obtain $d_{2}(\Lambda_{D}) = \min \left\{36, 6, 1\right\} = 1$ and $d_2 (\Hat{\Lambda}_{D}) = \min \left\{36, 6, \sqrt{5}\right\} = \sqrt{5}$. 
\end{example}

\begin{example}
Consider the chain of nested codes $\mathcal{C}_2 \subseteq \mathcal{C}_1 \subseteq \Z_3^{3}$, where $\mathcal{C}_2 =  \langle(1,1,1)\rangle$ and $\mathcal{C}_1 = \langle(1,1,1), (0,0,1)\rangle$. Let $\Lambda_{D}$ be the lattice obtained via Construction $D$ using the parameters above. From Theorem \ref{TeoconstDcomoA}, $\Lambda_D = \Lambda_A(\mathcal{C})$, where $\mathcal{C}$ is the $9$-ary code generated by the rows of the matrix 
\begin{equation*}
    \boldsymbol{G} = \left[\begin{array}{ccc}
         1 & 1 & 1  \\
         0 & 0 & 3 
    \end{array}\right]
\end{equation*}
Thus, by using Hermite Normal Form (\cite{costa2017lattices}), we get a generator matrix for $\Lambda_{D}$ given by
\begin{equation*}
    \boldsymbol{M} = \left[\begin{array}{ccc}
        1 & 0 & 0  \\
        1 & 9 & 0\\
        1 & 0 & 3
    \end{array}\right].
\end{equation*}
It is straightforward to see that the Euclidean, Lee, and maximum minimum distance of $\Lambda_{D}$ are $d_2(\Lambda_{D}) = \sqrt{3}$, $d_{1}(\Lambda_{D}) = 1$ and $d_{\infty}(\Lambda_D) = 1$, respectively. On the other hand, the minimum distances of the codes $\mathcal{C}_1$ and $\mathcal{C}_2$ in these metrics are $d_2(\mathcal{C}_1) = 1$, $d_2(\mathcal{C}_2) = \sqrt{3}$, $d_{1}(\mathcal{C}_1) = 1 = d_{1}(\mathcal{C}_2)$ and $d_{\infty}(\mathcal{C}_1) = 1 = d_{\infty}(\mathcal{C}_2)$. So, for $\mathrm{P} = 1, 2, \infty$, we can verify that $d_{\mathrm{P}}(\Lambda_{D}) = \min \left\{9, 3d_{\mathrm{P}}(\mathcal{C}_1), d_{\mathrm{P}}(\mathcal{C}_2)\right\}$.
Finally, note that the chain is closed under the zero-one addition since $(1,1,1) \ast (1,1,1) = (0,0,0) \in \mathcal{C}_2$ and $(2,2,2) \ast (2,2,2) = (1,1,1) \in \mathcal{C}_2$. Hence, we obtain the provided result by Corollary \ref{cordistLpConstD} for the $L_{\mathrm{P}}$ distances, with $\mathrm{P} = 1, 2, \infty$, as expected.
\end{example}

In order to provide some bounds for the minimum distance of Construction D' for a certain chain of $q$-ary linear codes, we present an auxiliary result. This result constitutes a class of theorems, the so-called Transference's Theorems, which relate some properties of a lattice $\Lambda$ and its dual lattice $\Lambda^{\ast}$. The following version is a consequence of the First and Second Minkowski's Theorems \cite{siegel1989lectures} and can be also viewed as a particular case of the Banaszczyk's Theorem for successive minima {\cite[Thm $2.2$]{banaszczyk1993new}}. %Tem que enfatizar aqui que existem resultados semelhantes para as outras distâncias. Seria legal enunciar? Acho que sim, né?

\begin{theorem}[\cite{banaszczyk1993new}]\label{TeoTransferenciaForte}
Let $\Lambda \subseteq \R^{n}$ be a full rank lattice. Then, the
Euclidean minimum distances of $\Lambda$ and $\Lambda^{\ast}$ satisfy $1 \leq d_2(\Lambda) \cdot d_2(\Lambda^{\ast}) \leq n$. More precisely, we have $1 \leq d_2(\Lambda) \cdot d_2(\Lambda^{\ast}) \leq \gamma_{n}$, where $\gamma_n$ is the Hermite constant in dimension $n$, that is, $\gamma_n = 4\delta_n^{2/n}$, where $\delta_n$ is the maximum center density for lattices in dimension $n$.
\end{theorem}

Some well known inequalities involving the $L_{\mathrm{P}}$-distance in $\R^{n}$ allow to directly derive a consequence from the proposition above.

\begin{corollary}\label{TransfFracaparaLp}
For a full rank lattice $\Lambda \subset \R^{n}$, we have
\begin{eqnarray*}
    d_{\mathrm{P}}(\Lambda) \cdot d_{\mathrm{P}}(\Lambda^{\ast}) &\leq& \gamma_n \leq  n \hspace{0.2cm} \text{ for } 2 < \mathrm{P} \leq \infty;\\
    d_{\mathrm{P}}(\Lambda) \cdot d_{\mathrm{P}}(\Lambda^{\ast}) &\leq& \left(n^{\frac{1}{p} - \frac{1}{2}}\right)^{2} \gamma_n \leq \left(n^{\frac{1}{p} - \frac{1}{2}}\right)^{2} n \hspace{0.2cm} \text{ for } 1 \leq \mathrm{P} < 2.
\end{eqnarray*}
\end{corollary}
\begin{proof}
We recall that for a basic property of $L_{\mathrm{P}}$-norm and the Holder' inequality \cite{kreyszig1991introductory}, if $\mathrm{P} < r < \infty$, we have 
\begin{equation*}
    ||\boldsymbol{x}||_{r} \leq ||\boldsymbol{x}||_{\mathrm{P}} \leq n^{\frac{1}{\mathrm{P}} - \frac{1}{r}}||\boldsymbol{x}||_{r}.
\end{equation*} 

In particular, given $\mathrm{P} < 2$, we have $||\boldsymbol{x}||_{\mathrm{P}} \leq n^{\frac{1}{\mathrm{P}} - \frac{1}{2}}||\boldsymbol{x}||_{2}$. So, denoting by $\boldsymbol{v}$ and $\Tilde{\boldsymbol{v}}$ minimal vectors of $\Lambda$ and $\Lambda^{\ast}$, respectively, in the Euclidean norm, it follows
\begin{equation*}
    d_{\mathrm{P}}(\Lambda) \cdot d_{\mathrm{P}}(\Lambda^{\ast}) \leq ||\boldsymbol{v}||_{\mathrm{P}} ||\Tilde{\boldsymbol{v}}|||_{\mathrm{P}} \leq \left(n^{\frac{1}{\mathrm{P}} - \frac{1}{2}}\right)^{2}||\boldsymbol{v}||_{2} ||\Tilde{\boldsymbol{v}}||_{2} \leq \left(n^{\frac{1}{\mathrm{P}} - \frac{1}{2}}\right)^{2} d_{2}(\Lambda) \cdot d_{2}(\Lambda^{\ast}) \leq \left(n^{\frac{1}{\mathrm{P}} - \frac{1}{2}}\right)^{2} \gamma_{n}.
\end{equation*}
The case $2 < \mathrm{P} \leq \infty$ is proved in a very similar way.
\end{proof}

\begin{remark}
    Though Banaszczyk's Theorem \cite{banaszczyk1993new} states that $d_2(\Lambda) \cdot d_2(\Lambda^{\ast}) \leq n$, it is essential to punctuate that he remarks that a more careful analysis yields a bound which depends of an optimal constant. More precisely, he emphasized that following the same demonstrations, we can improve this upper bound to roughly $n/2\pi$. Under this approach, \cite{miller2019kissing} present an alternative proof that yields the following bound:
    \begin{equation*}
        d_{2}(\Lambda) \cdot d_{2}(\Lambda^{\ast}) \leq \dfrac{n}{2\pi} + \dfrac{3\sqrt{n}}{\pi}.
    \end{equation*}

    We highlight that the upper bound in Banaszczyk's Theorem is tight up to a constant \cite{banaszczyk1993new, cai2003new}. In fact, there is a result shown by {\cite[Thm $9.5$]{milnor1973symmetric}} which asserts the existence of a sequence of dual lattices that satisfy $d_2(\Lambda) = \Theta(\sqrt{n})$, i.e., bounded below and above by a constant multiple of $\sqrt{n}$. For such lattices we have
\begin{equation*}
    d_2(\Lambda) \cdot d_2(\Lambda^{\ast}) = \Omega(n),
\end{equation*}
where $\Omega(n)$ denote a quantity bounded below by a constant multiple of $n$. 

    The Corollary \ref{TransfFracaparaLp} estimates an upper bound for the $L_{\mathrm{P}}$-distance of the lattice $\Lambda_{D'}$ minimum distance. Nevertheless, since they are obtained by simply applying inequalities relating to Euclidean distance, they certainly can be improved. In this sense, the authors in \cite{miller2019kissing} also propose an upper bound for the $L_1$-distance {\cite[Thm $3.9$]{miller2019kissing}}, namely
     \begin{equation*}
        d_1(\Lambda) \cdot d_{1}(\Lambda^{\ast}) \leq 0.154264n^{2} \left(1 + 2\pi \sqrt{\dfrac{3}{n}}\right)^{2}.
    \end{equation*}

On the other hand, when dealing with a special class of lattices that possess $n^{\epsilon}$-shortest vectors and, in particular, whose minimum distance and the second successive minima are strongly related, there exists a tight upper bound as demonstrated in \cite{wei2014new}.
\end{remark}

To establish a similar result for $L_{\mathrm{P}}$-distance of the lattice obtained via Construction D' we use Theorem \ref{TeoCadeiafechada} {\cite[Thm $9$]{strey2017lattices}} applied to the chain of dual codes. 

\begin{theorem}\label{distLpDlinhaigualdade}
Let $\mathcal{C}_a \subseteq \cdots \subseteq \mathcal{C}_1 \subsetneq \Z_{q}^{n}$ be a family of nested linear $q$-ary codes. Consider $\Lambda_{D'}$ a lattice obtained by Construction $D'$ and fix the $L_{\mathrm{P}}$ distance, with $1 \leq \mathrm{P} \leq \infty$. Denote by $d_{\mathrm{P}}(\mathcal{C}_{\ell}^{\perp})$ the minimum distance of $\mathcal{C}_{\ell}^{\perp}$ for each $1 \leq \ell \leq a$. Thus,
\begin{equation*}
    d_{\mathrm{P}}(\Lambda_{\overline{D^{\perp}}}) \leq d_{\mathrm{P}} (\Gamma_{\overline{D^{\perp}}}) = \min \left\{q^{a}, q^{a - 1}d_{\mathrm{P}}(\mathcal{C}_a^{\perp}), \ldots, d_{\mathrm{P}}(\mathcal{C}_1^{\perp})\right\}.
\end{equation*}
Furthermore, if the chain of dual codes $\mathcal{C}_1^{\perp} \subseteq \cdots \subseteq \mathcal{C}_a^{\perp} \subseteq \Z_{q}^{n}$ is closed under the zero-one addition, it holds the equality
\begin{equation*}
    d_{\mathrm{P}}(\Lambda_{D^{\perp}}) = d_{\mathrm{P}}(\Lambda_{\overline{D^{\perp}}}) =  \min \left\{q^{a}, q^{a - 1}d_{\mathrm{P}}(\mathcal{C}_a^{\perp}), \ldots, d_{\mathrm{P}}(\mathcal{C}_1^{\perp})\right\},
\end{equation*}
and therefore,
\begin{equation*}
    d_{\mathrm{P}}(\Lambda_{D'}^{\ast}) = \min \left\{1, q^{-1}d_{\mathrm{P}}(\mathcal{C}_a^{\perp}), \ldots, q^{-a}d_{\mathrm{P}}(\mathcal{C}_1^{\perp})\right\}.
\end{equation*}
%\textcolor{purple}{Melhorar a notação para não confundir com os anteriores. Quando será que vale a igualdade???}
\end{theorem}
\begin{proof}
The first part is a direct consequence of Theorem \ref{TeoDistLpDbarra} applied to the chain of nested dual codes $\mathcal{C}_1^{\perp} \subseteq \cdots \subseteq \mathcal{C}_a^{\perp} \subseteq \Z_q^{n}$. The second part follows from the Corollary \ref{cordistLpConstD} jointly to the dual version of Theorem \ref{TeoCadeiafechada} and the third part follows from the fact 
that $\Lambda_{\overline{D^{\perp}}} = q^{a} \Lambda_{D'}^{\ast}$ as proved in Theorem \ref{T42}. 
\end{proof}

\begin{corollary}\label{CorDistMinLpDlinha}
In particular, when the chain of duals is closed under the zero-one addition, the minimum Euclidean distance of $\Lambda_{D'}$ satisfies
\begin{equation*}
    \dfrac{1}{\min \left\{1, q^{-1}d_{\mathrm{P}}(\mathcal{C}_a^{\perp}), \ldots, q^{-a}d_{\mathrm{P}}(\mathcal{C}_1^{\perp})\right\}} \leq d_{\mathrm{2}} (\Lambda_{D'}) \leq \dfrac{n}{\min \left\{1, q^{-1}d_{\mathrm{P}}(\mathcal{C}_a^{\perp}), \ldots, q^{-a}d_{\mathrm{P}}(\mathcal{C}_1^{\perp})\right\}},
\end{equation*}
or, more precisely,
\begin{equation*}
    \dfrac{1}{\min \left\{1, q^{-1}d_{\mathrm{P}}(\mathcal{C}_a^{\perp}), \ldots, q^{-a}d_{\mathrm{P}}(\mathcal{C}_1^{\perp})\right\}} \leq d_{\mathrm{2}} (\Lambda_{D'}) \leq \dfrac{\gamma_n}{\min \left\{1, q^{-1}d_{\mathrm{P}}(\mathcal{C}_a^{\perp}), \ldots, q^{-a}d_{\mathrm{P}}(\mathcal{C}_1^{\perp})\right\}},
\end{equation*}
where $\gamma_n$ is the Hermite constant in dimension $n$.

Moreover, both upper bounds above also hold for $L_{\mathrm{P}}$-distance, with $2 < \mathrm{P} \leq \infty$. For $1 \leq \mathrm{P} < 2$, we have
\begin{equation*}
    d_{\mathrm{P}} (\Lambda_{D'}) \leq \left(n^{\frac{1}{p} - \frac{1}{2}}\right)^{2} \cdot \dfrac{\gamma_n}{\min \left\{1, q^{-1}d_{\mathrm{P}}(\mathcal{C}_a^{\perp}), \ldots, q^{-a}d_{\mathrm{P}}(\mathcal{C}_1^{\perp})\right\}}.
\end{equation*} 
\end{corollary}
\begin{proof}
These bounds are a simple consequence of Theorem \ref{distLpDlinhaigualdade} and Proposition \ref{TeoTransferenciaForte}, since $\Lambda_{D'} = q^{a}\Lambda_{D^{\perp}}^{\ast}$, as proved in Theorem \ref{T42}. The second part follows directly from Corollary \ref{TransfFracaparaLp}. 
\end{proof}

\begin{corollary}\label{corDistLpDlinhaigualdade}
Under the hypothesis of Theorem \ref{distLpDlinhaigualdade}, if the chain of dual codes is closed under zero-one addition and $d_{\mathrm{P}}(\mathcal{C}_\ell^{\perp}) \geq q^{\ell}$ for each $1 \leq \ell \leq a$, it follows that $d_{\mathrm{2}}(\Lambda_{D'}^{\ast}) = q^{a}$. Therefore,
\begin{equation*}
    q^{a - 1} \leq d_2(\Lambda_{D'}) \leq \gamma_n q^{a - 1} \leq n q^{a - 1}.
\end{equation*}
\end{corollary}
\begin{proof}
It is enough to observe that $\min \left\{q^{a}, q^{a - 1}d_{\mathrm{2}}(\mathcal{C}_a^{\perp}), \ldots, d_{\mathrm{2}}(\mathcal{C}_1^{\perp})\right\} = q$. Thus, $d_{\mathrm{2}}(q^{a}\Lambda_{D'}^{\ast}) = q$, which provides the bounds above. 
\end{proof}

In the next example, we show that the conditions of the chain of nested dual codes in Construction $D'$ is closed under the zero-one addition and can not be omitted in Theorem \ref{distLpDlinhaigualdade}.

\begin{example}
Let $\mathcal{C}_2 \subseteq \mathcal{C}_1 \subseteq \Z_{6}^{2}$ be the family of nested linear codes, where $\mathcal{C}_2^{\perp} = \langle(4,2)\rangle$ and $\mathcal{C}_1^{\perp} = \langle(4,2), (0,1)\rangle$ (as in Example \ref{Exemplodo42e24}). 
We know that $\Lambda_{D'}$ and $18\Lambda_{D'}^{\ast}$ are generated, respectively, by
\begin{equation*}
    \boldsymbol{M}_{1} = \left[\begin{array}{cc}
        9 & -3  \\
        0 & 6 
    \end{array}\right] \hspace{0.2cm} \text{ and } \hspace{0.2cm} \boldsymbol{M}_{2} = \left[\begin{array}{cc}
        2 & 0  \\
        1 & 3 
    \end{array}\right].
\end{equation*}
Let $\mathcal{C} \subseteq \Z_{36}^{2}$ be the linear code such that $18\Lambda_{D'}^{\ast} = \Lambda_A(\mathcal{C})$. Thus, the Euclidean minimum distance of $\Lambda_{D'}^{\ast}$ follows by the Euclidean minimum distance for $\mathcal{C}$, namely $d_2(\Lambda_{D'}^{\ast}) = \min \left\{\sqrt{5}/18, 36\right\} = \sqrt{5}/18$. On the other hand, we have 
\begin{equation*}
    \min \left\{1, 6^{-1}d_2(\mathcal{C}_2^{\perp}), d_{2}(\mathcal{C}_1^{\perp})\right\} = \min \left\{1, 1/6, 2\sqrt{2}\right\} = 1/6 \neq \sqrt{5}/18.
\end{equation*}
Note that the chain $\mathcal{C}_2 \subseteq \mathcal{C}_1 \subseteq \Z_6^{2}$ is not closed under the zero-one addition.
\begin{figure}[!ht]
  \centering
  \subcaptionbox{ Code $\mathcal{C}_2^{\perp} = \langle(4,2)\rangle \subseteq \mathds{Z}_{6}^{2}$}{\includegraphics[width=.3\textwidth]{Imagens/1art.png}} 
  \hspace{1cm}
  \subcaptionbox{Code $\mathcal{C}_1^{\perp} = \langle(4,2), (0,1)\rangle \subseteq \mathds{Z}_{6}^{2}$}{\includegraphics[width=.3\textwidth]{Imagens/2art.png}} 
\caption{\label{figure12} Dual codes used to Construction D'.}
\end{figure}

\end{example}

The next example illustrates that the lower bound in Corollary \ref{corDistLpDlinhaigualdade} can be attained. 

\begin{example}
Let us consider the family of linear codes given by  $\mathcal{C}_2 \subseteq \mathcal{C}_1 \subseteq \Z_2^{2}$, where $\mathcal{C}_2^{\perp} = \langle(0,0,0,1),(1,1,1,1)\rangle$ and $\mathcal{C}_1^{\perp} = \left<(1,1,1,1)\right>$. We use the Theorem \ref{distLpDlinhaigualdade} to estimate the Euclidean minimum distance of $\Lambda_{D'}$.
Initially, note that the chain of dual codes is closed under zero-one addition, since $(1,1,1,1) \ast (1,1,1,1) = (1,1,1,1) \in \mathcal{C}_2^{\perp}$. Moreover, the Euclidean minimum distance of the codes $\mathcal{C}_2$ and $\mathcal{C}_1$ are $d_{2}(\mathcal{C}_2^{\perp}) = 1$ and $d_2(\mathcal{C}_1^{\perp}) = 2$. Thus, it follows that $\min \left\{1, 2^{-1} d_{2}(\mathcal{C}_2^{\perp}), 2^{-2}d_{2}(\mathcal{C}_1^{\perp})\right\} = 1/2$, which implies $2 \leq d_2(\Lambda_{D'}) \leq 8$ by Theorem \ref{distLpDlinhaigualdade}. One can show that, in this case, the lower bound is attaining. Indeed, by Theorem \ref{propD'viaconstrucaoA} we know that $\Lambda_{D'} = \Lambda_{A}(\mathcal{C}^{\perp})$, where $\mathcal{C}^{\perp}$ is a $4$-ary linear code whose parity check matrix is
\begin{equation*}
    \boldsymbol{H} = \left[\begin{array}{cccc}
         1 & 1 & 0 & 0   \\
         1 & 0 & 1 & 0 \\
         2 & 2 & 0 & 0
    \end{array}\right].
\end{equation*}
Thus, from Corollary \ref{cormatrizgeradoraD'}, we get a generator matrix for $\Lambda_{D'}$ given by
    \begin{equation*}
    \boldsymbol{M} = \left[\begin{array}{cccc}
        -4 & 0 & 0 & 0  \\
        -2 & 2 & 0 & 0\\
        -2& 0 & 2 & 0\\
        -2 & 0 & 0 & 2
    \end{array}\right].
\end{equation*}
from where the Euclidean minimum distance of $\Lambda_{D'}$ is $2$.
\end{example}

Unlike the bounds obtained in this section for the $L_{\mathrm{P}}$-norm of Construction D' require dual chain closed under zero-one addition, for binary codes it is possible to obtain some other bounds without restriction. Furthermore, these bounds are related to the minimum distance of the original codes and not to the dual codes. We present some of them, which extend to $L_{\mathrm{P}}$-distance results previously known for Euclidean distance 
{\cite[Thm $3.1$]{sadeghi2006low}}. Also, replacing the Euclidean metric with the Lee-metric and using a chain of linear $q$-ary codes, this is a known result, proved in {\cite[Thm $4$]{strey2018bounds}}.

\begin{theorem}\label{TeodistLpDlinha}
Let $\boldsymbol{0} \subsetneq \mathcal{C}_a \subseteq \cdots \subseteq \mathcal{C}_1 \subsetneq \Z_2^{n}$ be a family of nested binary linear codes, $0 \leq r_1 \leq \cdots \leq r_a$ and $\boldsymbol{h}_1, \ldots, \boldsymbol{h}_{r_a} \in \Z_2^{n}$ such that $\mathcal{C}_\ell^{\perp} = \left<\boldsymbol{h}_1, \ldots, \boldsymbol{h}_{r_a}\right>$ for each $\ell = 1, \ldots, n$. Denote by $\Lambda_{D'}$ the lattice obtained via Construction $D'$ using the parameters above and $d_\mathrm{P}(\mathcal{C})$ the $L_{\mathrm{P}}$-distance of $\mathcal{C}_{\ell}$ for each $\ell = 1, \ldots, a$. Then,
\begin{equation*}
   \min \big\{2^{a}, 2^{a - 1}d_{\mathrm{P}}(\mathcal{C}_1), 2^{a - 2}d_{\mathrm{P}}(\mathcal{C}_2), \ldots, d_{\mathrm{P}}(\mathcal{C}_a)\big\} \leq d_{\mathrm{P}} \left(\Lambda_{D'}\right) \leq 2^{a}.
\end{equation*}
\end{theorem}
\begin{proof}
First, we prove that if $\boldsymbol{x} \in \Z^{n}$ has at least one coordinate which is not an odd number and $\boldsymbol{x} \cdot \sigma(\boldsymbol{h}_{j}) \equiv 0 \mod 2$  for $1 \leq j \leq r_{k}$, then $||\boldsymbol{x}||_{\mathrm{P}} \geq d_{\mathrm{P}}(\mathcal{C}_k)$. To prove this, write $\boldsymbol{x} = \boldsymbol{c} + 2\boldsymbol{z}$, where $\boldsymbol{z} \in \Z^n$ and $\boldsymbol{c} = (c_1, \ldots, c_n)$, with $c_i = 0$ or $1$. According to hypothesis, $\boldsymbol{c} \neq \boldsymbol{0}$ and $\boldsymbol{c} \cdot \sigma(\boldsymbol{h}_j) \equiv 0 \mod 2$ for $1 \leq j \leq r_{k}$. Thus, $\rho({\boldsymbol{c}})\in \mathcal{C}_{k}$ and consequently $||\boldsymbol{c}||_{\mathrm{P}} \geq d_{\mathrm{P}}(\mathcal{C}_{k})$.
Let $\boldsymbol{\mu} = (\mu_1, \ldots, \mu_n)$, where $\mu_i = \min \left\{2 - c_i, c_i\right\}$ for each $i = 1, \ldots, n$ as denoted by Lemma \ref{lemadistanciaLp}. In the next step, we show that $\rho({\boldsymbol{\mu}}) \in \mathcal{C}_k$. Let $S \subseteq \{1, \ldots, n\}$ be the set of index $i$ such that $\mu_i = 2 - c_i$. For each $1 \leq j \leq r_k$, we can write
\begin{eqnarray*}
    \boldsymbol{\mu} \cdot \sigma(\boldsymbol{h}_j) = \displaystyle \sum_{i \in S} (2 - c_i) \cdot \sigma(h_{ji}) + \displaystyle \sum_{i \in S^{C}} c_i \cdot \sigma(h_{ji}) \equiv - \displaystyle \sum_{i \in S} c_i \cdot \sigma(h_{ji}) + \displaystyle \sum_{i \in S^{C}} c_i \cdot \sigma(h_{ji}) \mod 2.
\end{eqnarray*}
Since $q = 2$, we have $c_i \equiv -c_i \mod 2$,  it follows that the above expression can be rewritten as:
\begin{eqnarray*}
    \boldsymbol{\mu} \cdot \sigma(\boldsymbol{h}_j) &\equiv& \displaystyle \sum_{i \in S}c_i \cdot \sigma(h_{ji}) + \displaystyle \sum_{i \in S^{C}} c_i \cdot \sigma(h_{ji}) \mod 2 \equiv \boldsymbol{c} \cdot \sigma(\boldsymbol{h}_j) \mod 2 \equiv \boldsymbol{0} \mod 2.
\end{eqnarray*}
Then, by Lemma \ref{lemadistanciaLp}, it holds that $||\boldsymbol{x}||_{\mathrm{P}} \geq ||\boldsymbol{\mu}||_{\mathrm{P}} \geq d_{\mathrm{P}}(\mathcal{C}_k)$.
Now, let $\boldsymbol{x} \in \Lambda \setminus\{\boldsymbol{0}\}$. We can assume that $\boldsymbol{x}$ admits at least one coordinate that is not even. Our first affirmation guarantees that $||\boldsymbol{x}||_{\mathrm{P}} \geq d_{\mathrm{P}}(\mathcal{C}_k)$ since $\boldsymbol{x} \in \Lambda_{D'}$. Moreover, since $\boldsymbol{x}$ is a non zero vector, we can choose a non negative integer $k \geq 0$ such that $2^{-k}\boldsymbol{x} \in \Z^{n}$, but $2^{-k - 1}\boldsymbol{x} \notin \Z^{n}$.
If $k < a$, then $2^{-k} \boldsymbol{x} \cdot \sigma(\boldsymbol{h}_j) \equiv 0 \mod 2$ for $1 \leq j \leq r_{a - k}$. In fact, we have
\begin{eqnarray*}
    \boldsymbol{x} \in \Z^n &\Leftrightarrow& \boldsymbol{x} \cdot \sigma(\boldsymbol{h}_{j}) \equiv 0 \mod 2^{i + 1}\hspace{0.2cm} \text{ for all } 0 \leq i \leq a - 1 \hspace{0.1cm} \text{  and  } \hspace{0.1cm} r_{a - i - 1} < j \leq r_{a - i}\\
    &\Rightarrow& \boldsymbol{x} \cdot \sigma(\boldsymbol{h}_{j}) \equiv 0 \mod 2^{k + 1} \hspace{0.2cm} \text{ for all } k \leq i \leq a - 1 \hspace{0.1cm} \text{  and  } \hspace{0.1cm} r_{a - i - 1} < j \leq r_{a - i}\\
    &\Leftrightarrow& 2^{-k}\boldsymbol{x} \cdot \sigma(\boldsymbol{h}_j) \equiv 0 \mod 2 \hspace{0.2cm} \text{ for } 1\leq j \leq r_{a - k}.
\end{eqnarray*}
Thus, $\boldsymbol{2^{-k}}\boldsymbol{x}$ satisfies the auxiliary claim, which implies $||\boldsymbol{x}||_{\mathrm{P}} \geq 2^{k} d_{\mathrm{P}}(\mathcal{C}_{a - k})$.
On the other hand, if $k \geq a$, we write $\boldsymbol{x} = 2^{a} (2^{k - a} \boldsymbol{z})$, where $\boldsymbol{z} \in \Z^n$ and, consequently,
\begin{equation*}
    ||\boldsymbol{x}||_{\mathrm{P}} = 2^{a} \left(\sum_{ \substack{ i = 1 \\z_i \neq 0}}^{n} |2^{k - a} z_i|^{\mathrm{P}}\right)^{1/\mathrm{P}} \geq 2^{a} ||\boldsymbol{z}||_{\mathrm{P}} \geq 2^{a}.
\end{equation*}
Applying a similar argument to the case $\mathrm{P} = \infty$, we have $||\boldsymbol{x}||_{\infty} \geq 2^{k} \geq 2^{a}$. Therefore $$\min \big\{2^{a}, 2^{a - 1}d_{\mathrm{P}}(\mathcal{C}_1), 2^{a - 2}d_{\mathrm{P}}(\mathcal{C}_2), \ldots, d_{\mathrm{P}}(\mathcal{C}_1)\big\} \leq d_{\mathrm{P}} \left(\Lambda_{D'}\right).$$ To obtain the upper bound for $d_{\mathrm{P}}(\Lambda_{D'})$, it is sufficient to use that $2^{a}\Z^{n} \subseteq \Lambda_{D'}$.
\end{proof}


%\textcolor{orange}{Eu tinha colocado o peso de Hamming aqui porque estava tentando o caso geral, para qualquer q e achei que seria um argumento bom. Mas como só foi possível para binário, vou ajeitar essa parte, porque bastaria usar a p-Lee mesmo como já fizemos}


\begin{remark}
The main difficulty in extending the previous result to the $L_{\mathrm{P}}$-distance for a chain of $q$-ary linear codes is the auxiliary statement, which cannot be true under these conditions, unless $P = 1$ or $q = 2$. To the best of our knowledge, it appears that there is no similar result for the general case, which should establish a relation between the $L_{\mathrm{P}}$-distance of $\Lambda_{D'}$ and the $\mathrm{P}$-Lee distance of the original codes.
\end{remark}

\subsection{Coding Gain}

As a consequence of the expressions obtained for the minimum Euclidean distance and the volume of the lattices from Construction D and D', we establish a lower bound for the coding gain under special conditions. For the binary case of Construction D' and a choice of tuples linearly independent, this is a known result proposed in {\cite[Cor $3.1$]{sadeghi2006low}} with appropriate notation adjustments. The next result follows immediately from the bounds obtained for volume (Theorem \ref{num_max_pontos} and Theorem \ref{num_max_pontosDlinha}, respectively) and Euclidean minimum distance (Corollary \ref{cordistLpConstD} and Corollary \ref{CorDistMinLpDlinha}, respectively) for $\Lambda_{D}$ and $\Lambda_{D'}$.

\begin{corollary}\label{PropCodinggain}
   Let $\Lambda_{D}$ (respectively, $\Lambda_{D'}$) be the lattice obtained via Construction $D$ (respectively, Construction $D'$) following the usual notation and choice of parameters. Consider the chain  $\boldsymbol{0}\neq \mathcal{C}_a \subseteq \cdots \subseteq \mathcal{C}_1 \subseteq \Z_{q}^{n}$ (respectively, the dual associated chain $\boldsymbol{0} \neq \mathcal{C}_1^{\perp} \subseteq \cdots \subseteq \mathcal{C}_a^{\perp} \subseteq \Z_q^{n}$) closed under the zero-one addition. Then, we have
\begin{equation*}
    \gamma(\Lambda_{D}) \geq \dfrac{\min \left\{q^{2a}, q^{2(a - 1)} d_{2}^{2}(\mathcal{C}_1), \ldots, d_2^{2}(\mathcal{C}_a)\right\}}{\left((q^{2})^{a - \sum\limits_{\ell=1}^{a} \frac{k_{\ell}}{n}} \left(\prod\limits_{i=1}^{k_1}{\dfrac{q}{\mathcal{O}(\boldsymbol{b}_i)}} \right)^{2/n}\right)},
\end{equation*}
with equality if the conditions of the Theorem \ref{T2} are satisfied or if the tuples $\boldsymbol{b}_1, \ldots, \boldsymbol{b}_{k_1}$ are linearly independent over $\Z_q$.
Moreover,
\begin{equation*}
    \gamma(\Lambda_{D'}) \geq \dfrac{ q^{2a} \cdot \left(\prod\limits_{i=1}^{r_a}{\dfrac{q}{\mathcal{O}(\boldsymbol{h}_i)}}\right)^{2/n}}{(q^{2})^{\sum\limits_{\ell=1}^{a} \frac{r_{\ell}}{n}} \min \left\{q^{2a}, q^{2(a - 1)}d_{2}^{2}(\mathcal{C}_a^{\perp}), \ldots, d_{2}^{2}(\mathcal{C}_1^{\perp})\right\}},
\end{equation*}
with equality if the conditions of the Theorem \ref{T2} applied to the dual chain are satisfied or if the tuples $\boldsymbol{h}_1, \ldots, \boldsymbol{h}_{r_a}$ are linearly independent over $\Z_q$. 
\end{corollary}


%\textcolor{orange}{Eu coloquei umas inclusões estritas que não deveria ter... Foi erro de digitação nessa parte. Agora, o código ser diferente de zero foi porque pensei que, tecnicamente, a gente consegue definir a distância mínima dele? Já que não tem pontos distintos... Falar que é zero nos traria problema, porque certamente o outro não seria nulo. Faz sentido isso que falei?}


%Also, under restrictions on the minimum distance of the involved used codes in Constructed $D'$, namely $d_2(\mathcal{C}_{\ell}^{\perp}) \geq q^{\ell}$, we have:
%\begin{equation*}
    %\dfrac{q^{2(a - 1)}}{\left((q^{2})^{an - \sum\limits_{\ell=1}^{a} \hat{k}_{\ell}}\right)^{1/n}} \leq \gamma(\Lambda_{D'}) \leq \dfrac{n^{2}}{q^{2(a - 1)}\left((q^{2})^{an - \sum\limits_{\ell=1}^{a} \hat{k}_{\ell}}\right)^{1/n}}
%\end{equation*}


\begin{remark}
    Recall that the coding gain and the center density of a lattice $\Lambda$ are related as $\delta(\Lambda) = 2^{n} \gamma(\Lambda)^{n/2}$, from where we obtain a similar lower bound for the center density with respect to the Euclidean distance. 
\end{remark}

%\section{Dependence of generators} %??????

\section{Coding and Decoding of Construction \texorpdfstring{$D'$}{D'} for certain \texorpdfstring{$q$}{q}-ary codes}

%Apresentaremos nessa seção um método de decodificação da Construção $D'$, o qual generaliza o método introduzido em \cite{zhou2022construction} para a Construção $D'$ via códigos binários. Nessas condições, generalizamos o resultado para $q$-ários e \textcolor{blue}{comentamos as principais diferenças}. Destacamos porém que as notações utilizadas nesse trabalho e em \cite{zhou2022construction} são diferentes. Ainda, nesse trabalho, o conceito de matriz de checagem de paridade de um reticulado é diferente do conceito de matriz de checagem \footnote{Em \cite{zhou2022construction}, uma matriz de checagem de um reticulado de posto completo em $\R^{n}$ é a inversa de uma matriz geradora para o reticulado.} adotado em \cite{zhou2022construction}. Dessa forma, os resultados apresentados em \cite{zhou2022construction} foram reformulados para manter a coerência com a notação adotada.

%Multistage decoding for binary Construction D' have been attracted a lot of attention recently, especially for lattices based on binary LDPC (low-density parity-check matrix) codes. Inspired by Forney et al \cite{forney1988coset}, several methods for encoding and decoding have been proposed, 

Several methods for encoding and multistage decoding for binary Construction D and D' have been proposed recently, of which it is worth emphasizing the approaches using re-encoding \cite{matsumine2018construction, zhou2022construction, vem2014multilevel, zhou2021encoding}, by computing cosets \cite{silva2020multilevel} and by applying a min-sum algorithm at each level of decoding, as proposed in \cite{sadeghi2006low, sadeghi2010, sadeghi2013performance}. In this paper, we focus on multistage decoding with re-encoding following the approach proposed by \cite{zhou2022construction}. We extend some results to a class of lattices obtained by Construction D' for a family of $q$-ary codes. The original method performs re-encoding via the check matrix in the sense of \cite{zhou2022construction, sommer2009shaping}, that is, as an inverse of a generator matrix for the lattice. Then, we modify some notations in order to perform the decoding using a check matrix as defined in this work.

%\textcolor{red}{Texto aqui citando os artigos todos que nos referenciamos: Danilo, Panario, Zhou e kurkoski (tem uns 3), Peikert...}

\subsection{Encoding Method B}

In \cite{zhou2022construction}, two equivalent encoding methods are given, called Encoding Method A and Encoding Method B. The first requires that the check matrix is in the ALT form and can be efficient when the matrix is sparse \cite{zhou2021encoding}. The Encoding Method A is an approach that we are interested in, especially when $q$ is prime, but we have omitted it for the sake of brevity.

Following the established notation and adopting an approach completely analogous to \cite{zhou2022construction}, let $\Lambda_{D'}$ the lattice obtained via Construction $D'$ from a chain of linear $q$-ary codes $\mathcal{C}_a \subseteq \ldots \subseteq \mathcal{C}_1 \subseteq \Z_{q}^{n} =: \mathcal{C}_0$ similarly to Definition \ref{defiD'eleonesio}, that is,
\begin{equation*}
    \Lambda_{D'} = \left\{\boldsymbol{x} \in \Z^{n}: \boldsymbol{H} \boldsymbol{x} \equiv \boldsymbol{0} \mod q^{a}\right\}.
\end{equation*}

Henceforth, assume that the $n$-tuples $\boldsymbol{h}_1, \ldots, \boldsymbol{h}_{r_a}$, with $r_a \leq n$, are linearly independent over $\Z_q$ and complete, if necessary, this set with canonical tuples in $\Z_{q}^{n}$ such a way  $\boldsymbol{H}_{a}$ is invertible over $\Z_{q}$. Only in this section, for simplicity, we consider that $r_0$ denotes the number of generators for $\mathcal{C}_0$ obtained from the code generators of the underlying codes. Let $\boldsymbol{x} \in \Lambda_{D'}$ be a lattice vector and denote $\boldsymbol{H} \boldsymbol{x} = q^{a}\boldsymbol{b}$, where $\boldsymbol{b} \in \Z^{n}$, and write


\begin{eqnarray}
   \begin{array}{crl}\label{escritacodifdebgeral}
         b_{j} = & z_j &\text{ for } 1 \leq j \leq r_1 ;\\
         b_j =& u_{1j} + qz_j &\text{ for } r_1 < j \leq r_2 ;\\
        b_j =& u_{2j} + qu_{1j} + q^{2}z_j& \text{ for } r_2 < j \leq r_3 ;\\
        \vdots &  \vdots & \vdots \\
         b_{j} =& u_{(a - 2)j} + qu_{(a - 3)j} + \cdots + q^{a - 3}u_{1j} + q^{a - 2}z_j &\text{ for } r_{a - 2} < j \leq r_{a - 1};\\
         b_{j} =& u_{(a - 1)j} + qu_{(a - 2)j} + q^{2}u_{(a - 3)j} + \cdots + q^{a - 2}u_{1j} + q^{a - 1}z_j &\text{ for } r_{a - 1} < j \leq r_{a};\\
         b_{j} =& u_{aj} + qu_{(a - 1)j} + q^{2}u_{(a - 2)j} + q^{3}u_{(a - 3)j} + \cdots + q^{a - 1}u_{1j} + q^{a}z_j &\text{ for } r_{a} < j \leq n,
    \end{array}
\end{eqnarray}

\begin{comment}
\begin{equation}\label{escritacodifdebgeral}
    \begin{aligned}
        b_{j} &= z_j& \hfill &\text{ for } 1 \leq j \leq r_1 ;\\
        b_j &= u_{1j} + qz_j & \hfill &\text{ for } r_1 < j \leq r_2 ;\\
        b_j &= u_{2j} + qu_{1j} + q^{2}z_j& \hfill &\text{ for } r_2 < j \leq r_3 ;\\
        \vdots \\
         b_{j} &= u_{(a - 2)j} + qu_{(a - 3)j} + \cdots + q^{a - 2}u_{1j} + q^{a - 2}z_j& \hfill &\text{ for } r_{a - 2} < j \leq r_{a - 1};\\
         b_{j} &= u_{(a - 1)j} + qu_{(a - 2)j} + q^{2}u_{(a - 3)j} + \cdots + q^{a - 1}u_{1j} + q^{a - 1}z_j& \hfill &\text{ for } r_{a - 1} < j \leq r_{a};\\
         b_{j} &= u_{aj} + qu_{(a - 1)j} + q^{2}u_{(a - 2)j} + q^{3}u_{(a - 3)j} + \cdots + q^{a - 1}u_{1j} + q^{a}z_j& \hfill &\text{ for } r_{a} < j \leq n,
    \end{aligned}
\end{equation}
\end{comment}
where $\boldsymbol{u}_i = (u_{i1}, \ldots, u_{i(n - r_i)})^{T} \in \Z^{(n - r_i)}$, $u_{ij} \in \sigma^{\ast}(\Z_{q})$ for each $i = 0, \ldots, a - 1$ and $j = 1, \ldots, n$, and $\boldsymbol{z} \in \Z^{n}$. Here, $\sigma^{\ast}(\Z_{q})$ denote a choice of centralized representatives class, i.e., 
\begin{eqnarray*}
    \sigma^{\ast}(\Z_{q}) &:=& \left\{-\dfrac{q - 1}{2}, - \dfrac{q - 3}{2}, \ldots, 0, \ldots, \dfrac{q - 3}{2}, \dfrac{q - 1}{2}\right\} \hspace{0.2cm} \text{ if } q \text{ is odd; }\\
    \sigma^{\ast}(\Z_{q}) &:=& \left\{-\dfrac{q}{2}, - \dfrac{q - 2}{2}, \ldots, 0, \ldots, \dfrac{q - 4}{2}, \dfrac{q - 2}{2}\right\} \hspace{0.2cm} \text{ if } q \text{ is even }.
\end{eqnarray*}

%\textcolor{red}{Tentar alinhar os z ali em cima depois}

Similarly tp \cite{zhou2022construction}, we will consider $\Tilde{\boldsymbol{u}}'_{i}$ as obtained by a version of $\boldsymbol{u}_{i} = (u_{i(r_i + 1)}, \ldots, u_{in})^{T}$ with addiction of zero coordinates. To preserve the adopted notation, the null coordinates will be added at the beginning, as follows:
\begin{equation*}
    \Tilde{\boldsymbol{u}}'_{i} := (\underbrace{0, \ldots, 0}_{r_i},u_{i(r_i + 1)}, \ldots, u_{in})^{T} \in \Z_{q}^{n}.
\end{equation*}

%\textcolor{red}{Coloco $u'_{0}$ ou não?}

\begin{lemma}\label{lemaEscritadebGeral}
Let $\boldsymbol{b} = (b_1, \ldots, b_n)^{T} \in \Z^{n}$ as in (\ref{escritacodifdebgeral}). Considering the vectors $\Tilde{\boldsymbol{u}}'_{i}$ as before, we have
\begin{equation*}
    \boldsymbol{b} = \boldsymbol{D} (q^{-a} \Tilde{\boldsymbol{u}}'_{0} + q^{-(a - 1)}\Tilde{\boldsymbol{u}}'_{1} + q^{-(a - 2)} \Tilde{\boldsymbol{u}}'_{2} + \cdots + q^{-1}\Tilde{\boldsymbol{u}}'_{a - 1} + \boldsymbol{z}),
\end{equation*}
where $\boldsymbol{D}$ is the diagonal matrix presented in Definition \ref{lemamatrizanivelq}.
\end{lemma}
\begin{proof}
Denote
\begin{equation*}
    \boldsymbol{c} := \boldsymbol{D} (q^{-a}\Tilde{\boldsymbol{u}}'_{0} + q^{-(a - 1)}\Tilde{\boldsymbol{u}}'_{1} + q^{-(a - 2)} \Tilde{\boldsymbol{u}}'_{2} + \cdots + q^{-1}\Tilde{\boldsymbol{u}}'_{a - 1} + \boldsymbol{z}) =: \boldsymbol{D} \Tilde{\boldsymbol{c}}.
\end{equation*}
For construction, we can write
\begin{equation*}
    \begin{aligned}
    \Tilde{\boldsymbol{c}} = 
    q^{-(a)}(0, \ldots, 0, u_{0(r_0 + 1)}, \ldots, u_{1(n -r_0)})^{T} + \ldots + q^{- 1} (0, \ldots, 0, u_{(a - 1)(r_{a - 1})}, \ldots, u_{(a - 1)n})^{T}  + (z_1, \ldots, z_n)^{T}.
\end{aligned}
\end{equation*}
Now, multiplying each term for the matrix $\boldsymbol{D}$, we get $\boldsymbol{D}\Tilde{\boldsymbol{c}} = \boldsymbol{b}$, as described in (\ref{escritacodifdebgeral}). 
\begin{comment}
    \begin{equation*}
    \boldsymbol{D} = \left[\begin{array}{ccccc}
         [Id]_{r_1 \times r_1} &  &  &  &    \\
          & q[Id]_{(r_2 - r_1)\times (r_2 - r_1)}  &  &  &   \\
          &  & q^{2}[Id]_{(r_3 - r_2) \times (r_3 - r_2)} &  &  \\
          &  & & \ddots &\\
          &  &  &  & q^{a - 1}[Id]_{(r_a - r_{a - 1})\times(r_{a} - r_{a - 1})}
    \end{array}\right]_{n \times n},
\end{equation*}
\end{comment}
\end{proof}

In a natural extension of the binary case, observe that a vector $\boldsymbol{x} \in \Lambda_{D'}$ can be written as 
\begin{equation*}
    \boldsymbol{x} = \boldsymbol{x}_0 + q\boldsymbol{x}_1 + \cdots + q^{a}\boldsymbol{x}_{a} = \displaystyle \sum_{i = 0}^{a} q^{i} \boldsymbol{x}_i,
\end{equation*}
where the components $\boldsymbol{x}_{i} \in \Z^{n}$ depends of $\Tilde{\boldsymbol{u}}'_{i}$ for $i = 0, \ldots, a - 1$.
Thus, if we denote $\boldsymbol{H} \boldsymbol{x} = q^{a}\boldsymbol{b} = : \Tilde{\boldsymbol{b}}$, it holds
\begin{equation*}
    \Tilde{\boldsymbol{b}} = \boldsymbol{D}(\Tilde{\boldsymbol{u}}'_{0} + q \Tilde{\boldsymbol{u}}'_{1} + \cdots + q^{a - 1} \Tilde{\boldsymbol{u}}'_{a - 1} + q^{a}\boldsymbol{z}).
\end{equation*}
Under these conditions, since  $\Tilde{\boldsymbol{b}} \in q^{a}\Z^{n}$ is known, we can calculate the components of $\boldsymbol{x}$ by using the relations below
\begin{eqnarray*} %\label{CodificaD'AchaXGeral}
    \boldsymbol{H}_{a} \boldsymbol{x}_{i} &=& \Tilde{\boldsymbol{u}}'_{i}\hspace{0.2cm} \text{ for each } i = 0, \ldots, a - 1,\\
    \boldsymbol{H}_{a} \boldsymbol{x}_{a} &=& \boldsymbol{z}.
\end{eqnarray*}

%\begin{remark}
%We must emphasize that the condition of the tuples being linearly independent over $\Z_q$ as well the condition $r_a = n$ does not affect the proposed encoding method in a theoretical sense. However, this is an essential condition for the decoding method to work, as we will see in the next subsection. 
%Note that under the conditions $r_a = n$ and $\boldsymbol{h}_1, \ldots, \boldsymbol{h}_{r_a}$ linearly independent over $\Z_q$, we have $q^{a} \boldsymbol{H}^{-1}$ as a generator matrix for $\Lambda_{D'}$ by Theorem \ref{TeoGeneralizaZhou}. Although, it will be sufficient to use that $\boldsymbol{H}$ is just a check matrix for $\Lambda_{D'}$, since the two methods do not use directly a generator matrix for the lattice.
%\end{remark}

%\textcolor{red}{Comentário: podemos remover a hipótese $r_a = n$ se $q$ for primo com o preço de acrescentar vetores LI até formar uma base. - Falar na reunião}

\begin{comment}
We illustrate the encoding method in the next example.

\begin{example}\label{exampleCodif}
Let $\mathcal{C}_2 \subseteq \mathcal{C}_1 \subseteq \mathcal{C}_0 := \Z_6^{2}$ be a chain of nested linear codes, where $\mathcal{C}_1^{\perp} = \langle(4,1)\rangle$ and $\mathcal{C}_2^{\perp} = \langle (4,1), (5,0)\rangle$. Note that $n = 2$, $r_1 = 1$ and $r_2 = 2 = n$ and the matrix $\boldsymbol{H}_a$ and $\boldsymbol{H}$, as in Definition  \ref{lemamatrizanivelq}, are given by
\begin{equation*}
    \boldsymbol{H}_a = \left[\begin{array}{cccc}
         4 & 1  \\
         5 & 0  
    \end{array}\right] \hspace{0.2cm} \text{ and } \hspace{0.2cm} \boldsymbol{H} = \left[\begin{array}{cccc}
         4 & 1  \\
         30 & 0 
    \end{array}\right].
\end{equation*}
Suppose that we have $\Tilde{\boldsymbol{b}} = (-72, -540)^{T}$, i.e., $\boldsymbol{b} = (-2,15)^{T}$. We show how to get $\boldsymbol{x}$ by using the proposed encoding. For this, note that we must obtain $\boldsymbol{z} \in \Z^{n}$ and $\boldsymbol{u}_1 \in \sigma^{\ast}(\Z_{6}^{(4 - r_i)})$ such that
\begin{equation*}
   \begin{cases}
    b_1 = z_1 \\
    b_2 = 6u_{12} + z_{2}
   \end{cases}\;  \hspace{0.2cm} \text{ or, equivalently, } \hspace{0.2cm}
   \boldsymbol{b} = \left[\begin{array}{cccc}
         1 & 0\\
         0 & 6
    \end{array}\right] (6\Tilde{\boldsymbol{u}}'_{1} + 36\boldsymbol{z}),
\end{equation*}
where $\Tilde{\boldsymbol{u}}'_{1} = (0, u_{12})^{T}$ and $\boldsymbol{z} = (z_1, z_2)^{T} \in \Z^{2}$.
Solving the system we get $\Tilde{\boldsymbol{u}}'_{1} = (0,3)^{T}$ and $\boldsymbol{z} = (-2,-3)^{T}$. So, the lattice associated point is $\boldsymbol{x} = (-18,0)$. \textcolor{red}{Ainda está estranha a codificação em si...}

%Uma solução \textcolor{red}{(ou a solução?)} possível consiste em tomar $\boldsymbol{z} = (0,-1,6,16)^{T}$, $\boldsymbol{u}'_{0} = (1,0,0,0)^{T}$ e $\boldsymbol{u}'_{1} = (1,0,1,0)^{T}$. Agora, exibiremos $\boldsymbol{x}$ tal que $\boldsymbol{H} \boldsymbol{x} = \boldsymbol{b}$. Para isso, peimeiramente, lembramos que $\boldsymbol{x} = \boldsymbol{x}_0 + 2\boldsymbol{x}_1 + 4\boldsymbol{x}_{2}$. Além disso, pelas relações (\ref{CodificaD'AchaXGeral}), juntamente ao fato de que $\Tilde{\boldsymbol{H}}^{-1}$ é dada por:
\end{example}
\end{comment}




\subsection{Decoding of Construction D'}

In this paper, we present a natural extension of one of the approaches developed in \cite{zhou2022construction} for Construction D' of a family of $q$-ary linear codes, under the previous conditions. We state a generalization to Proposition $2$ of \cite{zhou2022construction} for $q$-ary linear codes, when $\boldsymbol{H}_{a}$ is invertible over $\Z_q$, whose demonstration is completely analogous to the binary case, with the appropriate notation adjustments. 

\begin{proposition}
For Construction D', the lattice component $\boldsymbol{x}_i$ is congruent modulo $q$ to a codeword $\Tilde{\boldsymbol{x}}_i \in \mathcal{C}_i$, for each $i = 0, \ldots, a - 1$.
\end{proposition}
\begin{proof}
Denote $\Tilde{\boldsymbol{x}}_i : = \boldsymbol{x}_i \mod q$ for each $i = 0, \ldots, a - 1$. By the definition of the lattice components, we know that $\boldsymbol{x}_i$ satisfies $\boldsymbol{H}_a \boldsymbol{x}_i = \Tilde{\boldsymbol{u}}'_i$, where the first $r_i$ components of $\Tilde{\boldsymbol{u}}'_{i}$ are zero. Thus, it results that $\boldsymbol{H}_{a,i} \Tilde{\boldsymbol{x}}_i \equiv 0 \mod q$, where $\rho(\boldsymbol{H}_{a,i})$ is the check matrix of $\mathcal{C}_i$ (i.e., corresponds to the first $r_i$ rows of the matrix $\boldsymbol{H}_a$). Equivalently, we can write $\sigma(\boldsymbol{h}_j) \cdot \boldsymbol{x}_i \equiv 0 \mod q$, i.e., $\boldsymbol{h}_j \cdot \Tilde{\boldsymbol{x}}_i = 0$ in $\Z_{q}^{n}$, for $1 \leq j \leq r_i$. Therefore, by using the definition of $\mathcal{C}_i$ by its check matrix, we conclude $\Tilde{\boldsymbol{x}}_i \in \mathcal{C}_i$.  
\end{proof}

Under these conditions, the decoding algorithm of Construction D' for a chain of $q$-ary linear codes is essentially the algorithm proposed by \cite{zhou2022construction}. Since the Construction D' was defined for $q$-ary codes from an arbitrary set of tuples in $\Z_q^{n}$, one point that we should be careful about is requiring that $\boldsymbol{h}_1, \ldots, \boldsymbol{h}_a$ are linearly independent over $\Z_q$. In what follows, $\overline{\boldsymbol{1}}$ is the vector with all coordinates equal to $1$ and  $\mod_q(\boldsymbol{y}_i + \boldsymbol{1})$ denote the vector obtained by reducing modulo $q$. The decoder $Dec_i$ calculates a codeword $\Hat{\Tilde{\boldsymbol{x}}}_i$ closest to $\boldsymbol{y}'_{i}$ in the $q$-ary linear code $\mathcal{C}_i$, which is an estimate of $\Tilde{\boldsymbol{x}}_i$. 

\vspace{0.2cm}

\begin{algorithm}[H]
	\LinesNumbered
	\SetAlgoLined
	\KwIn{finite ring $\Z_q$, received message with noisy $\boldsymbol{y}$, full rank matrix $\boldsymbol{H}_a$.}
	\KwOut{estimated lattice point $\Hat{\boldsymbol{x}}\in\Lambda_{D'}$.}
	$\boldsymbol{y}_0 =\boldsymbol{y}$;\\
        $\boldsymbol{y}'_{0} = |\mod_q(\boldsymbol{y}_0 + \overline{\boldsymbol{1}}) - \overline{\boldsymbol{1}}|$;\\
        $\Hat{\Tilde{\boldsymbol{x}}}_{0} = Dec_{0}(\boldsymbol{y}'_{0})$;\\
        $\hat{\Tilde{\boldsymbol{u}}}'_{1} = \boldsymbol{H}_a \Hat{\Tilde{\boldsymbol{x}}}_0 \mod q$, then solve $\boldsymbol{H}_a \Hat{\boldsymbol{x}}_0 = \sigma(\hat{\Tilde{\boldsymbol{u}}}'_{1})$;\\
	\For{$1, 2, \ldots, a - 1$}{
		$\boldsymbol{y}_ i = (\boldsymbol{y}_{i - 1} - \Hat{\boldsymbol{x}}_{i - 1})/q$;\\
         $\boldsymbol{y}'_{i} = |\mod_q(\boldsymbol{y}_i + \overline{\boldsymbol{1}}) - \overline{\boldsymbol{1}}|$;\\
         $\Hat{\Tilde{\boldsymbol{x}}}_i = Dec_{i}(\boldsymbol{y}'_{i})$;\\
         $\Hat{\Tilde{\boldsymbol{u}}}'_{i + 1} = \boldsymbol{H}_a \Hat{\Tilde{\boldsymbol{x}}}_i \mod q$, then solve $\boldsymbol{H}_a \Hat{\boldsymbol{x}}_i = \sigma(\hat{\Tilde{\boldsymbol{u}}}'_{i})$
	}
	$\boldsymbol{y}_{a} = (\boldsymbol{y}_{a - 1} - \Hat{\boldsymbol{x}}_{a - 1})/q$;\\
	$\Hat{\boldsymbol{x}}_a = \lfloor{\boldsymbol{y}_a}\rceil$;\\
	$\Hat{x} = \Hat{\boldsymbol{x}}_{0} + q \Hat{\boldsymbol{x}}_{1} + \cdots + q^{a - 1}\Hat{\boldsymbol{x}}_{a - 1} + q^{a}\Hat{\boldsymbol{x}}_a$.
	\label{algo1}
	\caption{Decoding Construction D' Lattices}
\end{algorithm}

\vspace{0.2cm}

\begin{comment}
    

We illustrate the decoding algorithm for clarity in the following example.

\begin{example}
let $\mathcal{C}_2 \subseteq \mathcal{C}_1 \subseteq \Z_6^{2}$ be a family of nested linear codes, where $\mathcal{C}_2^{\perp} = \langle(4,1)\rangle$ e $\mathcal{C}_1^{\perp} = \langle(4,1), (5,0)\rangle$, as in Example \ref{exampleCodif}. A simple calculation shows that $\mathcal{C}_2 = \langle (1,2)\rangle$ and $\mathcal{C}_1 = \Z_{6}^{2}$, once the two generators are linearly independent over $\Z_6$. We recall that the lattice obtained by Construction D' is given by
\begin{equation*}
    \Lambda_{D'} = \big\{\boldsymbol{x} \in \Z^{2}: \boldsymbol{H}\boldsymbol{x} \equiv \boldsymbol{0} \mod 36\big\}.
\end{equation*}

Consider a point $\boldsymbol{x}$ transmitted over a channel and let $\boldsymbol{y}_0 = (-19,0)$ the received sequence. The decoding is done recursively as follows.

\begin{itemize}
    \item[] \textbf{Step $0$:} We calculate $\boldsymbol{y}'_{0}$ and decoding by using the code $\mathcal{C}_2$. We have $\boldsymbol{y}'_{0} = |\mod_{6}(\boldsymbol{y}_0 + (1,1)) - (1,1)| = (0,1)$. By determining the closest point, we obtain 
    \begin{eqnarray*}
        \Tilde{\Tilde{\boldsymbol{x}}}_{0} &=& \text{Dec}_{0}(\boldsymbol{y}'_{0}) = (3,0)\\
        \hat{\boldsymbol{u}}'_{0} &=& \left[\begin{array}{cc}
            4 & 1  \\
            5 & 0 
        \end{array}\right] \left[\begin{array}{cc}
             3  \\
             0 
        \end{array}\right] = (12,15)^{T} \equiv (0,3) \mod 6.
    \end{eqnarray*}
    
    \item[] \textbf{Step $1$:} We calculate $\boldsymbol{y}_1$ and $\boldsymbol{y}'_{1}$.
    \begin{eqnarray*}
        \boldsymbol{y}_1 &=& \left(\dfrac{\boldsymbol{y}_{0} - \boldsymbol{x}_{0}}{6}\right)= \dfrac{(-19,0) - (3,0)}{6} = \left(-\dfrac{11}{3}, 0\right)\\
        \boldsymbol{y}'_{1} &=& \big{|}\mod_{6}\left(-\dfrac{8}{3}, 1\right) - (1,1)\big{|} = \left(\dfrac{5}{3},0\right).
    \end{eqnarray*} 
    
    By decoding $\boldsymbol{y'}_1$ in $\mathcal{C}_1 = \Z_6^{2}$, we have $\Tilde{\boldsymbol{x}}_1 = (2,0)$. Moreover,
    \begin{eqnarray*}
        \Tilde{\Tilde{\boldsymbol{x}}}_{1} &=& \text{Dec}_{1}(\boldsymbol{y}'_{1}) = (2,0)\\
        \hat{\boldsymbol{u}}'_{1} &=& \left[\begin{array}{cc}
            4 & 1  \\
            5 & 0 
        \end{array}\right] \left[\begin{array}{cc}
             2  \\
             0
        \end{array}\right] = (8,10)^{T} \equiv (2,-2) \mod 6.
    \end{eqnarray*}
    
    \item[] \textbf{Step $2$:} We calculate $\boldsymbol{y}_2$ and $\boldsymbol{x}_2$.
    \begin{eqnarray*}
        \boldsymbol{y}_2 &=& \dfrac{\left(-\dfrac{11}{3}, 0\right) - (2,0)}{6} = (-1,0).\\
        \Tilde{\boldsymbol{x}}_2 &=& \lfloor (-1,0)\rceil.
    \end{eqnarray*}
\end{itemize}

Finally, we conclude that $\hat{\boldsymbol{x}} = \Hat{\boldsymbol{x}}_0 + 6 \hat{\boldsymbol{x}}_1 + 36 \Hat{\boldsymbol{x}}_2 = (-18,0)$.
\end{example}

\end{comment}




\section{Conclusion} \label{SecConclusao}

The volume and $L_{\mathrm{P}}$-distance of Construction $D$ and $D'$ are investigated here considering a generator matrix for these constructions. An upper bound for the volume by using a generator and a check matrix, respectively, is presented. We also provide an expression for $L_{\mathrm{P}}$-distance of Construction $\overline{D}$ in terms of the minimum distance of its underlying codes. When the chain of codes used is closed under the zero-one addition, we derive some bounds for the $L_{\mathrm{P}}$-distance of Construction D and D'. In addition, it established a lower bound for the coding gain and demonstrated sufficient conditions for achieving it. A multistage decoding method with re-encoding is applied to Construction D' from $q$-ary linear codes under specific conditions. Further work in the directions presented here is the discussion of efficient decoding for Construction D' for $q$-ary lattice under more general conditions. Possible dependencies of the decoding complexity on certain lattice parameters, such as choice of generators and coding gain may be considered in the search for lattices for good properties.

%\bibliographystyle{apa}
%\bibliography{refs.bib}

%\bibliographystyle{ieeetr}
\bibliography{refs.bib}


\end{document}


_______

   The proof is completely analogous to Lemma $3$ of \cite{strey2018bounds}. Let $\boldsymbol{z} \in \mathcal{C}$ such that $||\boldsymbol{z}||_{\mathrm{P}} = d_{\mathrm{P}} (\mathcal{C})$. Notice that $2\boldsymbol{z} \in C$ and $\sigma(2\boldsymbol{z}) - \sigma(\boldsymbol{z}) = (\alpha_1, \ldots, \alpha_n)$, where 
\begin{equation*}
    \alpha_ i = \begin{cases}
       \sigma(z_i) \hspace{0.2cm} \text{, if } \sigma(z_i) < q/2;\\
       \sigma(z_i) - q \hspace{0.2cm} \text{, if } \sigma(z_i) \geq q/2.
    \end{cases}\;
\end{equation*}
So, for $1 \leq \mathrm{P} < \infty $, we obtain
 \begin{equation*}
    ||\sigma(2\boldsymbol{z}) - \sigma(\boldsymbol{z})||_{\mathrm{P}} = \left(\displaystyle \sum_{i = 1}^{n} |\alpha_i|^{\mathrm{P}}\right)^{1/\mathrm{P}} = \left(\displaystyle \sum_{i = 1}^{n} \min \left\{q - \sigma(z_i), \sigma(z_i)\right\}^{\mathrm{P}}\right)^{1/\mathrm{P}}  =\lVert \boldsymbol{z}\rVert _{\mathrm{P}} = d_{\mathrm{P}}(\mathcal{C}),
\end{equation*}
since $|\alpha_i| = \min\left\{q - \sigma(z_i), \sigma(z_i)\right\}$ for all $i = 1, \ldots, n$.
For $\mathrm{P} = \infty$, the argument is very similar:
\begin{equation*}
    ||\sigma(2\boldsymbol{z}) - \sigma(\boldsymbol{z})||_{\infty} = ||\alpha||_{\infty} = \max_{1 \leq i \leq n} \left\{\min \left\{q - \sigma(z_i), \sigma(z_i)\right\}\right\} = \max \left\{d_{\text{Lee}}(z_i): 1 \leq i \leq n\right\} = ||\boldsymbol{z}||_{\infty}.
\end{equation*}
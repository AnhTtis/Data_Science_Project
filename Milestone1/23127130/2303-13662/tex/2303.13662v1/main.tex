% CVPR 2022 Paper Template
% based on the CVPR template provided by Ming-Ming Cheng (https://github.com/MCG-NKU/CVPR_Template)
% modified and extended by Stefan Roth (stefan.roth@NOSPAMtu-darmstadt.de)

\documentclass[10pt,twocolumn,letterpaper]{article}

%%%%%%%%% PAPER TYPE  - PLEASE UPDATE FOR FINAL VERSION
%\usepackage[review]{cvpr}      % To produce the REVIEW version
%\usepackage{cvpr}              % To produce the CAMERA-READY version
\usepackage[pagenumbers]{cvpr} % To force page numbers, e.g. for an arXiv version

% Include other packages here, before hyperref.
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{cite}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{booktabs}
\usepackage{amsfonts}       
\usepackage{multirow}
\usepackage{tabularx}

\makeatletter
\newcommand{\multiline}[1]{%
    \begin{tabularx}{\dimexpr\linewidth-\ALG@thistlm}[t]{@{}X@{}}
        #1
    \end{tabularx}
}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem*{theorem*}{Theorem}

\usepackage[dvipsnames]{xcolor}
\makeatletter
\@namedef{ver@everyshi.sty}{}
\makeatother
\usepackage{tikz}
\usetikzlibrary{backgrounds}
\usetikzlibrary{arrows,shapes}
\usetikzlibrary{tikzmark}
\usetikzlibrary{calc}

\usepackage{mathtools, nccmath}
\usepackage{wrapfig}
\usepackage{comment}

% To generate dummy text
\usepackage{blindtext}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% COLORFUL LATEX %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% for custom commands
\usepackage{xspace}

% table alignment
\usepackage{array}
\usepackage{ragged2e}
\newcolumntype{P}[1]{>{\RaggedRight\hspace{0pt}}p{#1}}
\newcolumntype{X}[1]{>{\RaggedRight\hspace*{0pt}}p{#1}}

% color box
\usepackage{tcolorbox}
\usepackage{paralist,tabularx}


% for tikz
\usepackage{tikz}
%\usetikzlibrary{trees}
\usetikzlibrary{arrows,shapes,positioning,shadows,trees,mindmap}
% \usepackage{forest}
\usepackage[edges]{forest}
\usetikzlibrary{arrows.meta}
\colorlet{linecol}{black!75}
\usepackage{xkcdcolors} % xkcd colors
% for colorful equation
\usepackage{tikz}
\usetikzlibrary{backgrounds}
\usetikzlibrary{arrows,shapes}
\usetikzlibrary{tikzmark}
\usetikzlibrary{calc}
% Commands for Highlighting text -- non tikz method
\newcommand{\highlight}[2]{\colorbox{#1!17}{$\displaystyle #2$}}
\newcommand{\highlightdark}[2]{\colorbox{#1!47}{$\displaystyle #2$}}
% my custom colors for shading
\colorlet{mhpurple}{Plum!80}
% Commands for Highlighting text -- non tikz method
\renewcommand{\highlight}[2]{\colorbox{#1!17}{#2}}
\renewcommand{\highlightdark}[2]{\colorbox{#1!47}{#2}}

% Some math definitions
\newcommand{\lap}{\mathrm{Lap}}
\newcommand{\pr}{\mathrm{Pr}}
\newcommand{\Tset}{\mathcal{T}}
\newcommand{\Dset}{\mathcal{D}}
\newcommand{\Rbound}{\widetilde{\mathcal{R}}}


\def\*#1{\mathbf{#1}}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\bw}{\mathbf{w}}
\newcommand{\methodname}{SA-FAS }

\newcommand\yiyou[1]{\textcolor{magenta}{[Yiyou: #1]}}

% It is strongly recommended to use hyperref, especially for the review version.
% hyperref with option pagebackref eases the reviewers' job.
% Please disable hyperref *only* if you encounter grave issues, e.g. with the
% file validation for the camera-ready version.
%
% If you comment hyperref and then uncomment it, you should delete
% ReviewTempalte.aux before re-running LaTeX.
% (Or just hit 'q' on the first LaTeX run, let it finish, and you
%  should be clear).
\usepackage[pagebackref,breaklinks,colorlinks,citecolor=blue]{hyperref}


% Support for easy cross-referencing
\usepackage[capitalize]{cleveref}
\crefname{section}{Sec.}{Secs.}
\Crefname{section}{Section}{Sections}
\Crefname{table}{Table}{Tables}
\crefname{table}{Tab.}{Tabs.}


\newcommand{\yaojie}[1]{{\leavevmode\color[rgb]{1,0,1}[Yaojie: #1]}}
\newcommand{\vincent}[1]{{\leavevmode\color[rgb]{1,0,0}Vincent: #1}}

%%%%%%%%% PAPER ID  - PLEASE UPDATE
\def\cvprPaperID{3950} % *** Enter the CVPR Paper ID here
\def\confName{CVPR}
\def\confYear{2023}

\begin{document}

%%%%%%%%% TITLE - PLEASE UPDATE
\title{Rethinking Domain Generalization for Face Anti-spoofing: \\ Separability and Alignment}

\author{\\
Yiyou Sun$^{2}$\thanks{This work was done during Yiyou Sunâ€™s internship at Google.}, Yaojie Liu$^1$, Xiaoming Liu$^{1,3}$, Yixuan Li$^2$, Wen-Sheng Chu$^1$\\
$^1$Google Research, $^2$University of Wisconsin-Madison, $^3$Michigan State University\\
{\tt\small $^1$\{yaojieliu,xiaomingl,wschu\}@google.com, $^2$\{sunyiyou,sharonli\}@cs.wisc.edu, $^3$liuxm@cse.msu.edu}
% For a paper whose authors are all at the same institution,
% omit the following lines up until the closing ``}''.
% Additional authors and addresses can be added with ``\and'',
% just like the second author.
% To save space, use either the email address or home page, not both
}
\maketitle

\def\eqnvspace{{\vspace{-2mm}}}
\def\tabvspace{{\vspace{-1mm}}}
\def\figvspace{{\vspace{-3mm}}}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}

\newcommand{\Paragraph}[1]{\vspace{1mm} \noindent \textbf{#1} \hspace{0mm}}
\newcommand{\Section}[1]{\vspace{-2mm} \section{#1} \vspace{-1mm}}
\newcommand{\SubSection}[1]{\vspace{-1mm} \subsection{#1} \vspace{-1mm}}
\newcommand{\SubSubSection}[1]{\vspace{-1mm} \subsubsection{#1} \vspace{-1mm}}

\newlength\segsep
\setlength{\segsep}{-0.5ex}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}
This work studies the generalization issue of face anti-spoofing (FAS) models on domain gaps, such as image resolution, blurriness and sensor variations. Most prior works regard domain-specific signals as a negative impact, and apply metric learning or adversarial losses to remove them from feature representation. 
Though learning a domain-invariant feature space is viable for the training data, we show that the feature shift still exists in an unseen test domain, which backfires on the generalizability of the classifier. 
In this work, instead of constructing a domain-invariant feature space, we encourage domain separability while aligning the live-to-spoof transition (i.e., the trajectory from live to spoof) to be the same for all domains. 
We formulate this FAS strategy of separability and alignment (SA-FAS) as a problem of invariant risk minimization (IRM), and learn domain-variant feature representation but domain-invariant classifier. We demonstrate the effectiveness of SA-FAS on challenging cross-domain FAS datasets and establish state-of-the-art performance. Code is available at \small{\url{https://github.com/sunyiyou/SAFAS}}.
\end{abstract}

%%%%%%%%% BODY TEXT

\input{sec1-intro}
\input{sec2-prior}
\input{sec3-method}
\input{sec4-exp}
\input{sec5-conclusion}

%%%%%%%%% REFERENCES

{\small
\bibliographystyle{ieee_fullname}
\bibliography{egbib}
}

%%%%%%%%% REFERENCES

\input{appendix}

\end{document}

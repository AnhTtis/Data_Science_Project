\begin{algorithm}[t]
    \caption{The \name Framework}
    \label{alg: MOMAT}
    \begin{algorithmic}
    \State {\bfseries Input:} Initial model parameters $\boldsymbol{\theta}_0$, perturbation size $\boldsymbol{\epsilon}$, number of adversarial attack steps \(K\), number of epochs $N, N_0$, weight function $g(\cdot)$
    % , weighted parameter $\lambda_0$
    \State {\bfseries Output:} $\boldsymbol{\theta}_N'$
    \State Initialize $\boldsymbol{\theta}\leftarrow \boldsymbol{\theta}_0$
    \For{$i=1$ {\bfseries to} $N_0$}
    \For{$minibatch$ $\mathbf{x}\subset\mathbf{X}$}
    \State $loss=\mathcal{L}_{CE}(\mathbf{x},y)$
    \State update $\boldsymbol{\theta}_i$
    \EndFor
    \EndFor
    \State \(\boldsymbol{\theta}_0' \leftarrow \boldsymbol{\theta}_{N_0}\)
    \For{$i=1$ {\bfseries to} $N$}
    \State $\boldsymbol{\theta}_i\leftarrow\boldsymbol{\theta}'_{i-1}$
    \For{$minibatch$ $\mathbf{x}\subset\mathbf{X}$}
    \State $\mathbf{x_{adv}}$ $\leftarrow$ $\mathbf{x}$
    \For{$k=1$ {\bfseries to} $K$}
    \State $\mathbf{x_{adv}}\leftarrow\mathbf{x_{adv}}+\boldsymbol{\epsilon}\cdot sign(\nabla_\mathbf{x}\mathcal{L}_{CE}(\mathbf{x_{adv}},y))$
    \State $\mathbf{x_{adv}}\leftarrow clip(\mathbf{x_{adv}},\mathbf{x}-\boldsymbol{\epsilon},\mathbf{x}+\boldsymbol{\epsilon})$
    \EndFor
    \State $loss=\mathcal{L}(\mathbf{x_{adv}},y)$
    \State update $\boldsymbol{\theta}_i$
    \EndFor
    \State $\lambda \leftarrow g(i)$ 
    \State $\boldsymbol{\theta}_i'\leftarrow\lambda\cdot\boldsymbol{\theta}_{i-1}'+(1-\lambda)\cdot\boldsymbol{\theta}_i$
    \EndFor
    \State \textbf{return} $\boldsymbol{\theta}_N'$
    \end{algorithmic}
\end{algorithm}

\section{Problem formulation and preliminaries}\label{Sec:pf}
We  consider submanifolds of $\bbR^n$ defined by a single function $h\colon \bbR^n \rightarrow \bbR^{n_h}$. A point $x \in \cM$ is a \emph{critical point} of~\eqref{eq:main_opt_prob} if:
\begin{equation}
\label{eq:definition-Grad}
  \Grad f(x) := P_{\cT_x \cM} \nabla f(x) = 0 \, .
\end{equation}
In particular, any local minimum of~\eqref{eq:main_opt_prob} is a critical point. To each $x \in \bbR^n$ we associate a vector space $V(x)= \{ v \in \bbR^n : \nabla h(x)^{\top} v = 0\}$. Note that, for any $x \in \cM$,  $V(x)= \cT_{x} \cM$. If $x$ is such that $\nabla h(x)$ has full rank, then $V(x)$ is the tangent plane of the manifold $\{ y \in \bbR^n : h(y) = h(x)\}$ (perhaps restricted to some neighborhood of $x$). Therefore, $V(x)$ extends the tangent plane outside of $\cM$.
The \emph{orthogonal directions field} is defined as:
\begin{align}\label{eq:orth_field}
\OF (x) = - \nabla h(x) A(x) h(x) - \nabla_V f(x)\, ,
\end{align}
where for all $x \in \bbR^n$, $\nabla_V f(x)$ is the orthogonal projection of $\nabla f(x)$ onto $V(x)$ and $A(x) \in \bbR^{n_h \times n_h}$ is chosen such that $\nabla h(x)^{\top}\nabla h(x) A(x)$ is a symmetric positive definite matrix. As we will see in the next sections, such an assumption enforces  that the directions along $\OF(x)$ tend to decrease $\norm{h}$. Note also that the term in $\nabla h(x)$ is orthogonal to $\nabla_V f(x)$ by construction. Before discussing the possible choices of $x \mapsto A(x)$, we show in the following lemma, that $\OF(x)$ is a meaningful way to measure the closeness of $x$ to a critical point. In particular, it is consistent with the notions of $\varepsilon$-1o point of \cite{xie_wright_PAL19} and $\varepsilon$-KKT point of \cite{birgin2018augmented,haeser2019optimality}. 
\begin{lemma}\label{lm:OF_crit}
For $x\in \bbR^n$ and $\varepsilon >0$, denote $\lambda$ the minimal singular value of $\nabla h(x) A(x)$. If $\norm{\OF(x)} \leq \varepsilon$, then $\norm{\nabla_V f(x)} \leq \varepsilon$ and $\norm{h(x)} \leq \lambda^{-1}\varepsilon $. In particular, if $\OF(x) = 0$, then $x$ is a critical point of Problem~\ref{eq:main_opt_prob}.
\end{lemma}

\begin{example}[Vanilla orthogonal directions field]\label{ex:vanil}
The first natural example is to put $A(x) \equiv \alpha \cI$, where $\cI \in \bbR^{n_h \times n_h}$ is the identity matrix. In this case, denoting $H(x) = 1/2 \norm{h(x)}^2$, it holds that $\OF(x) = - \alpha \nabla H(x) - \nabla_V f(x)$. An adaptive version of the method is obtained by choosing $A(x) =\alpha(x) \cI$, with  $\alpha : \bbR^{n} \rightarrow \bbR_{+}$ a strictly positive function.
\end{example}

\begin{example}[MJ orthogonal directions field]\label{ex:mj_flow}
For $x$ such that $\nabla h(x)$ is of full rank, another natural example is obtained by setting
$A(x)  = \alpha (\nabla h(x)^{\top} \nabla h(x))^{-1}$, where $\alpha >0$.
In this case, it turns out that $\OF$ is an instance of \cite{muehlebach2022constraints}. Denote $V_{\alpha}(x) := \{v \in \bbR^n : \nabla h(x)^{\top} v = - \alpha h(x)\}$. Note that for $x \in \cM$, $V_{\alpha}(x) = V(x) = \cT_{x} \cM$ and that $V_{\alpha}(x)$ is non-empty as soon as $\nabla h(x)$ is of full rank. A direct calculation (see \Cref{lm:aff_proj}) shows that
  \begin{equation}\label{eq:MJ_flow}
    \OF(x) = \argmin_{v \in V_{\alpha}(x)}\frac{1}{2} \norm{v + \nabla f(x)}^2  \, .
  \end{equation}
Since the computational cost of the projection on $V_{\alpha}$ and $V$ is similar, it might be interesting to compute this vector field by directly solving~\eqref{eq:MJ_flow}. However, we will see in~\Cref{sec:stiefel} that for important examples of Stiefel and orthogonal manifolds we can modify the geometry of the ambient space to obtain a computationally tractable projection onto $V$.
\end{example}

\input{figures/outcome_stat}
\section{Data Collection and Preprocessing}
This section introduces how we collect and preprocess the data. After that, we present a preliminary data analysis on neonatal outcomes.

\subsection{Data Collection}
This study is performed using two combined ELGANs cohorts ($N=184$) from the Prematurity and Respiratory Outcomes Program (PROP) and Prematurity, Respiratory outcomes, Immune System and Microbiome (PRISM) studies across two medical centers (University of Rochester and University at Buffalo). PROP and PRISM were studies performed under Institutional Review Board (IRB) approval (ClinicalTrials.gov: NCT01435187 and ClinicalTrials.gov: NCT01789268). Patients who died before 36 weeksâ€™ Corrected Gestational Age (CGA), have incomplete nutrition or respiratory profiles, or are enrolled in a blinded nutrition study are excluded from analyses. Demographic data is collected to summarize maternal exposures, partner exposures, and other important pregnancy outcomes such as the presence of chorioamnionitis (intrauterine infection). Resuscitation data is collected from interventions necessary after the infant is born in the delivery room. Once admitted to the neonatal intensive care unit (NICU), nutrition and respiratory variables are collected every day. For example, total daily caloric intake is extracted from daily logs and further subdivided by macronutrients (fat, protein, and carbohydrates) coming from parenteral or enteral sources and summarized over the first 28 postnatal days. Respiratory variables from daily flowsheets include the mode of ventilation, pressure/flow, and the fraction of inspired oxygen delivered to the infant.  From this, cumulative oxygen exposure~\cite{dylag2020early}, and counts of conventional and high-frequency ventilator days are obtained and summarized over the first 28 postnatal days. In total, the amount of input attributes is 431.

There are three primary outcomes in this study.  The first is severe BPD, defined as the need for respiratory support at 36 weeks' CGA by the National Institutes of Health Workshop Definition~\cite{fenton2013systematic}.  The second outcome is pulmonary hypertension (yes/no) diagnosed by echocardiography before hospital discharge. The third is the discharged weight z-score, calculated using Fenton premature infant growth curves at birth and 36 weeks' CGA~\cite{higgins2018bronchopulmonary}. 

In summary, we collect Electronic Health Records (EHRs) from 184 preterm neonates. Each neonatal record consists of 431 input attributes and three primary outcomes.


\subsection{Data Preprocessing}
Data preprocessing is essential in the machine learning pipeline, especially for medical data. In our study, we preprocess EHRs from 184 preterm infants, which consists of 431 input attributes for each neonate. Specifically, we will outline the steps involved in our data preprocessing below.

{\bf Data cleaning.}  We first remove duplicate items, which refer to EHR containing identical input attributes. Next, we drop the input attributes with a single value (e.g., care provided in the delivery room). We then remove the input attributes that exhibit an excess of 80\% of missing values (e.g., cord gas 2). Finally, the missing values in the rest of the input attributes are filled in using the Multiple Imputation by Chained Equations (MICE)~\cite{van2011mice}. In particular, the MICE method adopts a series of regression models to iteratively estimate missing values based on available records.


{\bf Data transformation.} The two nominal features (i.e., maternal and partner education) are transformed into numeric variables. We merge the 28-day time-series features (e.g., daily calories, daily fat, daily protein, daily carbohydrates, and daily oxygen exposure) into numerical data by adding up the values for each time-series feature. We proceed by converting categorical variables (e.g., race) into one-hot vectors. Finally, we use z-score normalization for all the remaining features.


In the end, the preprocessed data contain 69 input attributes of 121 neonatal samples. The reduction in the number of samples and the number of input features resulted from the data cleaning and transformation steps, e.g., due to incomplete or inconsistent information.  This preprocessed data is then used for further analysis to train and evaluate machine learning methods. Due to the limited available labeled data in this study, it is critical to investigate techniques such as MTL to improve the data efficiency.


\subsection{Preliminary Data Analysis on Neonatal Outcomes}

{\bf Data distribution.} We present the distributions of three neonatal outcomes in Fig.~\ref{fig:hist_total} (i.e., BPD, PH diagnosis, and discharge weight).  In the case of both categorical variables (i.e., BPD and PH diagnosis), there is a class-imbalanced issue as shown in Fig.~\ref{fig:hist_bpd} and Fig.~\ref{fig:hist_phd}. For BPD, the majority class (BPD: None) accounts for 36\%, while the minority class (BPD: Moderate) only represents 16\%. For pulmonary hypertension diagnosis, 19\% are positive, while 81\% are negative. In addition, Fig.~\ref{fig:hist_dw} suggests that the discharge weight z-score roughly follows a Gaussian distribution.


\input{figures/framework}

{\bf Correlation among adverse neonatal outcomes.} Multi-task learning allows the model to learn shared features relevant to all tasks, which could improve the performance of each individual task. Therefore, it is necessary to conduct an empirical evaluation to determine the relevance of the three neonatal outcomes in our dataset. To this end, we investigate the correlation among all three neonatal outcomes as shown in Fig.~\ref{fig:corr}. 

\begin{itemize}
    \item {\bf BPD and discharge weight.} For each category of BPD, we compute the mean and standard deviation of the discharge weights, respectively, and then adopt these values to plot the normal distribution curve. Fig.~\ref{fig:dw_bpd} shows that BPD and discharge weight are negatively correlated, which means that as the severity of BPD increases, the infants' discharge weights are more likely to decrease.

    \item {\bf PH diagnosis and discharge weight.} Similarly, we show the correlation between PH diagnosis and discharge weight in Fig.~\ref{fig:dw_phd}, which indicates that PH diagnosis and discharge weight are negatively correlated. If an infant is diagnosed with PH, its discharge weight tends to be lighter.

    \item {\bf BPD and PH diagnosis.} We present a 2D histogram in Fig.~\ref{fig:phd_bpd} to visualize the correlation between BPD and PH diagnosis. The data suggest that there is a slightly positive correlation between BPD and a diagnosis of PH, which means that infants who do not develop BPD are less likely to be diagnosed with PH. As the severity of BPD rises to ``moderate'', the likelihood of PH also increases.
\end{itemize}






%%%%%%%%%%%%%%%%%%%% author.tex %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% sample root file for your "contribution" to a proceedings volume
%
% Use this file as a template for your own input.
%
%%%%%%%%%%%%%%%% Springer %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\documentclass{svproc}
%
% RECOMMENDED %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%

% to typeset URLs, URIs, and DOIs
\usepackage{url}
\def\UrlFont{\rmfamily}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathrsfs}
%\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{caption} 
\usepackage{wrapfig}
\usepackage{xcolor}
\usepackage{dsfont}
\usepackage{empheq}
\usepackage{thmtools}
\usepackage{thm-restate}
\usepackage[normalem]{ulem}


\usepackage{hyperref}
\hypersetup{
  unicode = true,                           % Non-Latin characters in Acrobat's bookmarks
  pdftoolbar = true,                        % Show Acrobat's toolbar?
  pdfmenubar = true,                        % Show Acrobat's menu?
  pdffitwindow = true,                      % Page fit to window when opened
  pdfauthor = {J. Moatti},              % Authors
  pdftitle = {A skeletal high-order structure-preserving scheme for advection-diffusion equations},         % Title
  pdfnewwindow = true,                      % Links in new window
  colorlinks = true,                        % False: boxed links; true: colored links
  linkcolor = blue,                         % Color of internal links
  citecolor = magenta,                      % Color of links to bibliography
  filecolor = violet,                       % Color of file links
  urlcolor = violet                         % Color of external links
}

\usepackage{authblk}
\renewcommand\Affilfont{\small}

\usepackage{amsmath,amsfonts,amssymb,mathtools}
\usepackage{upgreek}
\usepackage{nicefrac}
\usepackage{cancel}
\usepackage{comment}
\usepackage{enumerate}
\usepackage{graphicx}
\usepackage{tikzscale}
\usepackage{xcolor}
\usepackage{paralist}
\usepackage{pgfplots}
\pgfplotsset{every axis/.append style={
                    label style={font=\Large},
                    tick label style={font=\Large},
                    legend style={font=\Large}
                    }}
\usepackage{subcaption}
\usepackage{etoolbox}
\usepackage[skins]{tcolorbox}
\makeatletter
\patchcmd{\ttlh@hang}{\parindent\z@}{\parindent\z@\leavevmode}{}{}
\patchcmd{\ttlh@hang}{\noindent}{}{}{}
\makeatother
\usepackage{multirow}
\usetikzlibrary{patterns}

\usepackage{tabularx}
\newcolumntype{Y}{>{\centering\arraybackslash}X}
\renewcommand\tabularxcolumn[1]{m{#1}}%

\pgfplotsset{compat=1.15}
\newcommand{\logLogSlopeTriangle}[5]
{
    \pgfplotsextra
    {
        \pgfkeysgetvalue{/pgfplots/xmin}{\xmin}
        \pgfkeysgetvalue{/pgfplots/xmax}{\xmax}
        \pgfkeysgetvalue{/pgfplots/ymin}{\ymin}
        \pgfkeysgetvalue{/pgfplots/ymax}{\ymax}

        % Calculate auxilliary quantities, in relative sense.
        \pgfmathsetmacro{\xArel}{#1}
        \pgfmathsetmacro{\yArel}{#3}
        \pgfmathsetmacro{\xBrel}{#1-#2}
        \pgfmathsetmacro{\yBrel}{\yArel}
        \pgfmathsetmacro{\xCrel}{\xArel}
        %\pgfmathsetmacro{\yCrel}{ln(\yC/exp(\ymin))/ln(exp(\ymax)/exp(\ymin))} 

        \pgfmathsetmacro{\lnxB}{\xmin*(1-(#1-#2))+\xmax*(#1-#2)} % in [xmin,xmax].
        \pgfmathsetmacro{\lnxA}{\xmin*(1-#1)+\xmax*#1} % in [xmin,xmax].
        \pgfmathsetmacro{\lnyA}{\ymin*(1-#3)+\ymax*#3} % in [ymin,ymax].
        \pgfmathsetmacro{\lnyC}{\lnyA+#4*(\lnxA-\lnxB)}
        \pgfmathsetmacro{\yCrel}{\lnyC-\ymin)/(\ymax-\ymin)}

        % Define coordinates for \draw. MIND THE 'rel axis cs' as opposed to the 'axis cs'.
        \coordinate (A) at (rel axis cs:\xArel,\yArel);
        \coordinate (B) at (rel axis cs:\xBrel,\yBrel);
        \coordinate (C) at (rel axis cs:\xCrel,\yCrel);

        % Draw slope triangle.
        \draw[#5]   (A)-- node[pos=0.5,anchor=north] {\scriptsize{1}}
                    (B)-- 
                    (C)-- node[pos=0.,anchor=west] {\scriptsize{#4}} %% node[pos=0.5,anchor=west] {#4}
                    (A);
    }
}



\newtheorem{prop}{Proposition}
\newtheorem{rem}{Remark}


\DeclareMathOperator{\e}{e}
\DeclareMathOperator{\divergence}{div}
\renewcommand{\C}{\mathcal{C}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\A}{\mathbb{A}}
\newcommand{\B}{\mathbb{B}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\E}{\mathcal{E}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\Diss}{\mathbb{D}}
\newcommand{\Entro}{\mathbb{E}}
\newcommand{\F}{\mathcal{F}}

\newcommand{\poly}{\mathbb{P}}

\renewcommand{\G}{\mathcal{G}}
\newcommand{\Gu}{\underline{\G}}
\newcommand{\s}{\sigma}

%\renewcommand{\u}{\uwave{u}}
\renewcommand{\u}{\mbox{\uwave{$u$}}}
\newcommand{\gradd}{\mbox{\uwave{$G$}}}

\newcommand{\V}{\underline{V}}
\renewcommand{\v}{\underline{v}}
\newcommand{\w}{\underline{w}}
\newcommand{\ro}{\underline{\rho}}
\newcommand{\g}{\underline{g}}
\newcommand{\phid}{\underline{\phi}}

\renewcommand{\l}{\underline{l}}

\newcommand{\rac}{\underline{\xi}}
\newcommand{\res}{\underline{r}}
\newcommand{\1}{\mathds{1}}
\newcommand{\one}{\underline{1}}
\newcommand{\zero}{\underline{0}}
\newcommand{\SG} {Scharfetter--Gummel }
\newcommand{\Mat}{\mathbb{M}}
\newcommand{\etal}{et al.~}
\newcommand{\dd}{\mathrm{d}}
\definecolor{MyGreen}{RGB}{54,165,54}
\newcommand{\JM}[1]{\textcolor{MyGreen}{JM: #1}}

\setlength \abovecaptionskip{0.1cm}
\setlength{\intextsep}{6pt plus 1.0pt minus 1.0pt}
\setlength{\textfloatsep}{6pt plus 1.0pt minus 1.0pt}


\begin{document}
\mainmatter              % start of a contribution
%
\title{A skeletal high-order structure preserving scheme for advection-diffusion equations}
%
\titlerunning{High-order structure preserving  scheme for advection-diffusion}  % abbreviated title (for running head)
%                                     also used for the TOC unless
%                                     \toctitle is used
%
\author{Julien Moatti\inst{1}}
%
\authorrunning{Julien Moatti} % abbreviated author list (for running head)
%
%%%% list of authors for the TOC (use if author list has to be modified)
\tocauthor{Julien Moatti}
%
\institute{ Inria, Univ. Lille, CNRS, UMR 8524 - Labratoire Paul Painlev\'e, F-59000 Lille, France \\
\email{julien.moatti@inria.fr}
%\\ WWW home page:
%\\texttt{http://users/\homedir iekeland/web/welcome.html}
}

\maketitle              % typeset the title of the contribution

\begin{abstract}
We introduce a nonlinear structure preserving high-order scheme for anisotropic advection-diffusion equations.
This scheme, based on Hybrid High-Order methods, can handle general meshes. 
It also has an entropy structure, and preserves the positivity of the solution. 
We present some numerical simulations showing that the scheme converges at the expected order, while preserving positivity and long-time behaviour.  
%\dots
% We would like to encourage you to list your keywords within
% the abstract section using the \keywords{...} command.
\keywords{Anisotropic advection-diffusion equations, general meshes, high-order schemes, structure preserving methods.}
\end{abstract}
%
\section{Motivations and context}
%
We are interested in the discretisation of a linear advection-diffusion equation on general meshes with high-order schemes.
Let $\Omega$ be an open, bounded, connected polytopal subset of $\R^d$, $d \in \{2,3\}$.
We consider the following problem with homogeneous Neumann boundary conditions: find $u : \R_+ \times \Omega \to \R$ solution to
\begin{equation} \label{pb:evol}
	\left\{
	\begin{split}
		\partial _ t u - \divergence ( \Lambda  (\nabla u + u \nabla \phi )  ) &= 0 &&\text{ in } \R_+ \times \Omega, \\
		\Lambda (\nabla u + u \nabla \phi ) \cdot n &= {0} &&\text{ on } \R_+ \times \Gamma^N,\\		
	 	u(0,\cdot)&= u^{in} &&\text{ in } \Omega ,
	\end{split}
	\right.
\end{equation}
where $n$ is the unit normal vector to $\partial\Omega$ pointing outward $\Omega$. We assume that the data satisfy:
(i) $\Lambda \in L^\infty(\Omega;\R^{d\times d})$ is a uniformly elliptic diffusion tensor: 
there exist $\lambda_\flat > 0$ such that,
for a.e.~$x$ in $\Omega$, $ \Lambda (x) \xi \cdot \xi \geq \lambda_\flat|\xi|^2$ for all $\xi \in \R^d$; 
%
(ii) $\phi \in C^1(\overline{\Omega})$ is a regular potential;
%
(iii) $u^{in} \in L^1(\Omega)$ is a non-negative initial datum, such that $\int_\Omega u^{in} \log\left(u^{in}\right) < \infty$.
%
The solutions to \eqref{pb:evol} enjoy some specific and well-known properties. 
First the mass is preserved along time, i.e. for almost every $t>0$, $\int_{\Omega}u(t)= \int_\Omega u^{in} = M$ where $M >0$ is the initial mass. 
Second, the solution is positive. 
Last, the solution has a specific long-time behaviour:  
it converges exponentially fast when $t \to \infty$ towards the thermal equilibrium $u^\infty$, solution to the stationary problem associated to \eqref{pb:evol}, defined as $u^\infty= \frac{M }{\int_\Omega \e^{-\phi}}\e^{-\phi} $.

%
% Numerics
%
In order to get a reliable numerical approximation of such problems, one has to preserve these structural properties at the discrete level.
It is well known that TPFA finite volume methods enjoy these structure preserving features (see \cite{CHH:20} for the long-time behaviour),
but these methods can only be used for isotropic tensors on meshes satisfying some orthogonality condition.
On the other hand, some finite volume methods for anisotropic problems on general meshes, using auxiliary unknowns such as DDFV, VAG or HFV, were introduced in the past twenty years, but none of these linear methods preserve the positivity of the solutions (see \cite{Droni:14}).
A possible alternative was proposed in \cite{CaGui:17}, where a nonlinear positivity preserving VAG scheme was introduced and analysed.  
Following these ideas, a nonlinear Hybrid Finite Volume (HFV) scheme was designed in \cite{CHHLM:22}.
\newline
All the schemes discussed above are at most of order two in space. 
The aim of this paper is to introduce a high-order scheme preserving the three structural properties discussed above.
Since the HFV method coincides with the low-order version of the Hybrid High-Order (HHO) scheme introduced in \cite{DiPEL:14}, we propose a HHO adaptation of the scheme introduced in \cite{CHHLM:22}.
Numerical results indicate that this scheme offers a better efficiency in term of computational cost than low order schemes. 
%%%%%
%%%% 
%
%Densities, electrostatic potential and quasi Fermi potential
%
%At the continuous level, we define the logarithm of the density $u$ as $l = \log(u)$, and the quasi fermi potential as $l + \phi$. Since the quasi fermi potential intervenes only through a gradient in the equation  
%(is a potential ... ), one can define it up to an additive constant. In the following, we will define the quasi Fermi potential as 
%\[
%	w = l + \phi - \alpha, \text{ with } \alpha = \log(\rho).
%\]
%Thanks to this definition, one has $u^\infty = \exp( \alpha - \phi)$, and therefore, denoting $l^\infty = \log(u^\infty)$, we get the following fundamental relation:
%\[
%	w = l - l^\infty.
%\]
%This implies that the quasi Fermi potential vanish at equilibrium, ie $w^\infty = 0$.
%
%The scheme described below will relies on the reformulation of \eqref{evol:mixed:ino} in term of potential: at least formally the following equation is satisfied: 
%\begin{equation}
%\left\{
%	\begin{split}
%		\partial_t \e^l - \divergence \left ( \e^{l} \Lambda \nabla w  \right ) &= 0 
%					&&\text{ in } \R_+ \times \Omega, \\
%		\e^{l} \Lambda \nabla w \cdot n &= {0} &&\text{ on } \R_+ \times \partial\Omega,\\								w &= l + \phi - \alpha &&\text{ in } \R_+ \times \Omega,\\		
%	 	l(0,\cdot)&= \log(u^{in}) &&\text{ in } \Omega 
%	\end{split}
%\right.
%\end{equation}	
%
%RMK : and if $u^{in}$ vanishes ?
%
%Note that, from the previous definitions, we get $w = \log \left(\frac{u}{u^\infty} \right)$, and therefore one can define the variable $\xi$ as  
%\[
%	\xi = \sqrt{\frac{u}{u^\infty}} = \exp\left( \frac{w}{2} \right) .
%\]

\section{Discrete setting and scheme}
%
\subsection{Mesh}
%
We define a discretisation of $\Omega$ as a couple $\mathcal{D} = ( \M, \E)$, where:
%\vspace{-0.14cm}
\begin{itemize}
		\item the mesh $\M$ is a partition of $\Omega$ in \emph{cells}, i.e., a finite family of nonempty disjoint open polytopal subsets $K$ of $\Omega$ such that $\overline{\Omega} = \bigcup _ {K \in \M } \overline{K}$, 
		%such that for all $K \in \M$, $|K|>0$ and $. We define the diameter of the cell $K$ as $h_K = \underset{x,y \in \overline{K}}{\sup} |x-y|$.
%
%
		\item the set of faces $\E$ is a partition of the mesh skeleton $\bigcup_{K\in\M}\partial K$ in \emph{faces} $\s$ which are subsets contained in hyperplanes of $\overline{\Omega}$.
We denote by $\E_K$ the set of faces of the cell $K$, and we define  $n_{K,\s} \in \R^d$ as the unit normal vector to $\s$ pointing outward $K$.	
% i.e., a finite family of nonempty disjoint (open, connected) subsets  
%(the mesh faces, or mesh edges if $d = 2$) 
%such that the boundary of any cells(i) for all $\s\in\E$, $|\s|>0$ and there exists $\mathcal{H}_\s$ affine hyperplane of $\R^d$ such that $\s\subset\mathcal{H}_\s$, and (ii) $\bigcup_{K\in\M}\partial K=\bigcup_{\s\in\E}\overline{\s}$. We assume that, for all $K \in \M$, there exists $\E_K \subset \E$ (the set of faces of $K$) such that $\partial K = \bigcup_{\s \in \E_K} \overline{\s}$. For $\s \in \E$, we let $\M_\s = \lbrace K \in  \M \mid \s \in \E_K \rbrace $ be the set of cells whose $\s$ is a face. Then, for all $\s \in \E$, either $\M_\s=\{K\}$ for a cell $K\in\M$, in which case $\s$ is a boundary face ($\s \subset \partial \Omega$) and we note $\s \in \E_{ext}$, or $\M_\s = \lbrace K,L \rbrace$ for two cells $K,L\in\M$, in which case $\s$ is an interface and we note $\s = K|L \in \E_{int} $.
\end{itemize}
%\vspace{-0.25cm}
The diameter of a compact $X \subset \R^d$ is denoted by $h_X = \sup \lbrace|x-y| \mid (x,y) \in X^2  \rbrace$. 
We define the meshsize of $\D$ as $h_\D = \sup \lbrace h_K \mid K \in \M  \rbrace$.
%
We refer to~\cite[Section 1.1]{DiPDr:20} for more detailed  statements about the mesh and its regularity.
%
\subsection{Polynomials, discrete unknowns and discrete operators}
%
In the following, $k$ is a fixed non-negative integer.
First, we introduce polynomial spaces on a subset $X \subset \R^d$: 
$P^k(X)$ and $P^k(X)^d$ denote respectively the spaces of polynomial functions $X \to \R$  and polynomial vector fields $X  \to \R^d$ of degree at most $k$.
%$P^k(X)$ denotes the space of polynomial functions $X \to \R$ of degree at most $k$, and $P^k(X)^d$ is the space of polynomial vector fields $X  \to \R^d$ of degree at most $k$.
Given $Y \subset \overline{X}$, we also define the $L^2$-projector $\Pi_Y^k : C^0(\overline{X}) \to \poly^{k}(Y)$ by the relation
$
	\forall  w \in \poly^k(Y), \, \int_Y \Pi_Y^k(v) w = \int_Y v w.
$
% 
%\[
%	\forall  w \in \poly^k(X), \, \int_X \Pi_\s^k(v) w = \int_X v w.
%\]
%\JM{a way of defining the proj ??}

We now introduce the set of discrete unknowns corresponding to mixed order HHO \cite{CEP:21,DiPDr:20}, with face unknowns of degree $k$ and (enriched) cells unknowns of degree $k+1$: 
\begin{equation*}
	\V _\D^{k,k+1}  = \left \lbrace \v_{\D} =\big( (v_K )_{K \in \M } ,
			(v_\s)_{\s \in \E} \big) 
			\left |
			\begin{array}{ll}
				\forall K\in\M, & v_K \in \poly^{k+1}(K)  \\
				\forall\s\in\E, & v_\s \in \poly^k(\s)   
			\end{array}				 				
			\right. 			
			\right \rbrace.
\end{equation*}
Given a cell $K \in \M$, we let 
$
	\V_K^{k,k+1} = \poly^{k+1}(K) \times \prod_{\s \in \E_K} \poly^k(\s)
$
be the restriction of $\V_\D^{k,k+1}$ to $K$, and for any generic discrete unknown $\v_{\D} \in \V_{\D}^{k,k+1}$ we denote by $\v_K=\big(v_K,(v_{\s})_{\s\in\E_K}\big)\in\V_K^{k,k+1}$  the local restriction of the global unknown to the cell $K$.
%
Given any $\v_{\D} \in \V_{\D}^{k,k+1}$, we associate two polynomial by part functions $v_\M : \Omega \to \R$ and $v_\E : \bigcup_{K \in \M} \partial K  \to \R$ such that 
\[
	{v_\M}_{|K} = v_K \text{ for all } K \in \M \text{ and } {v_\E}_{|\s} = v_\s \text{ for all } \s \in \E. 
\] 
We also introduce $\one_\D \in \V_\D ^{k,k+1}$ the discrete element such that $1_K = 1$ for any cell $K \in \M$ and $1_\s = 1$ for any face $\s \in \E$.

Now, given a cell $K \in \M$, we define a local \emph{consistent discrete gradient operator} $G_K^k : \V_K^{k,k+1} \to \poly^k(K)^d$ such that, for any $\v_K \in \V_K^{k,k+1}$, $G_K^k(\v_K)$ satisfies
\begin{equation} \label{def:grad}
	\int_K G_K^k(\v_K)  \cdot \tau = 
	\int_K \nabla v_K \cdot \tau 
	+ \sum_{\s \in \E_K} \int_\s (v_K - v_\s) \tau \cdot n_{K,\s} \quad \forall \tau \in  \poly^k(K)^d.
\end{equation}
%
For any face $\s \in \E_K$, we also define a \emph{jump operator} $J_{K,\s} : \V_K^{k,k+1} \to \poly^k(\s)$ by 
\begin{equation} \label{def:jumps}
	J_{K,\s} (\v_K) = \Pi_\s^k(v_K) - v_\s .
\end{equation}
%
%
\subsection{Scheme}
Following the ideas of \cite{CaGui:17,CHHLM:22} our scheme relies on a nonlinear reformulation of the problem \eqref{pb:evol}. To do so, we introduce the logarithm potential $l = \log(u)$ and the quasi Fermi potential $w = l + \phi$. At least formally, one has the following relation: 
\begin{equation} \label{eq:nlflux}
  \nabla u + u \nabla \phi = u \nabla \left ( \log(u) + \phi \right )= \e^l  \nabla w.
\end{equation}
The scheme relies on this formulation. We will \emph{discretise the potentials as polynomials}, i.e. approximate $l$ and $w$ as discrete unknowns in $\V_\D^{k,k+1}$. Then, mimicking the relation $u = \e^l,$ we will reconstruct the density and ensure its positivity.
Therefore, a solution $\left (\l_\D^n \right)_{n \geq 1}$ to the scheme \eqref{sch:AD} corresponds to approximation of the logarithms of the solution $u$ (density).

%
More specifically, for a given discretisation $\l_\D \in \V_\D^{k,k+1}$  of the potential $l$, one associates a discrete density ${\u_\D} = (u_\M, u_\E)$ defined as a couple of piecewise smooth functions where $u_\M : \Omega \to \R$ corresponds to the cells unknowns and $u_\E : \bigcup_{K \in \M} \partial K  \to \R$ corresponds to the edges unknowns, defined as  
\begin{equation} \label{def:ud}
	{u_\M} =  \exp(l_\M) 
	\text{ and }
	{u_\E} =  \exp(l_\E).
\end{equation}
%
Note that a discrete density $\u_\D$ is not a collection of polynomials (which is highlighted by the use of the wave underlined letter $\u$), but it enjoys positivity, both on cells and edges, since it is defined as the exponential of real functions.
Following the relation $\nabla u = e^l \nabla l $, we define the discrete gradient $G_\M (\u_\D) : \Omega \to \R^d$
of a discrete density $\u_\D$ as the following piecewise continuous function:
\begin{equation} \label{def:gradd}
	{G_\M (\u_\D) }_{| K } = \exp(l_K) \,  G_K^k(\l_K) \text{ for any } K \in \M.
\end{equation}

%%%%%%%%%%
%Discrete contributions 
%%%%%%%%%%
%As a skeletal method, 
Our scheme is based on local contributions on cells, split into a consistent and a stabilisation terms. 
Given $K \in \M$ and $\eta_l > 0$, the classical discrete counterpart of $(w,v) \mapsto \int_K \Lambda w \cdot v$ is the bilinear form (see \cite[section 3.2.1]{CEP:21}) 
%\begin{multline} \label{sch:stab_lin}
%	a_K : (\w_K, \v_K) \mapsto
%	\int_K \Lambda G_K^k(\w_K) \cdot  G_K^k(\v_K) \\
%		+ \eta_l \sum_{\s \in \E_K}  \frac{\Lambda_{K\s}}{h_\s} 
%			\int_\s J_{K,\s}(\w_K) J_{K,\s}(\v_K), 
%\end{multline}	 
\[
	a_K : (\w_K, \v_K) \mapsto
	\int_K \Lambda G_K^k(\w_K) \cdot  G_K^k(\v_K)
		+ \eta_l \sum_{\s \in \E_K}  \frac{\Lambda_{K\s}}{h_\s} 
			\int_\s J_{K,\s}(\w_K) J_{K,\s}(\v_K), 
\]	
%
where $\Lambda_{K\s} = \sqrt{ \int_\s |\Lambda n_{K\s} \cdot n_{K\s}|^2}$. 
Similarly, given $\eta_{nl} > 0$, we defined a local discretisation of $(l,w,v)\mapsto \int_K \e^l \Lambda \nabla w \cdot \nabla v$ as a sum of nonlinear consistent \eqref{sch:cons} and stabilisation \eqref{sch:stab_nl} contributions:
\begin{subequations}\label{sch:loc}
        \begin{empheq}{align}
        	\mathcal{C}_K(\l_K,\w_K, \v_K) 
        		&= \int_K \e^{l_K} \Lambda G_K^k(\w_K) \cdot G_K^k(\v_K), \label{sch:cons} \\
 		\mathcal{S}_K(\l_K, \w_K, \v_K) 
 			&=  \eta_{nl} \sum_{\s \in \E_K } \frac{\Lambda_{K\s}}{h_\s} 
				\int_\s  \frac{ \e^{\Pi_\s^k(l_K)} + \e^{ l_\s}  }{2}
	 			J_{K,\s}(\w_K) J_{K,\s}(\v_K).  \label{sch:stab_nl} %\\	
        \end{empheq}
\end{subequations}
%
We can now define a local application $\mathcal{T}_K :  \V_K^{k,k+1} \times \V_K^{k,k+1} \times \V_K^{k,k+1} \to \R$  by 
\begin{equation}
	\mathcal{T}_K (\l_K,\w_K, \v_K) 
		= \mathcal{C}_K(\l_K,\w_K, \v_K) + \mathcal{S}_K(\l_K, \w_K, \v_K)
		+  \varepsilon h_K^{k+2} a_K(\w_K, \v_K),
\label{sch:stationnary}
\end{equation}
where $\varepsilon$ is a real non-negative parameter.
At the global level, we define $\mathcal{T}_\D :  \V_\D^{k,k+1} \times \V_\D^{k,k+1} \times \V_\D^{k,k+1} \to \R$  by summing the local contributions: 
\begin{equation}
	\mathcal{T}_\D (\l_\D,\w_\D, \v_\D) 
		= \sum_{K \in \M} \mathcal{T}_K (\l_K,\w_K, \v_K).
\label{sch:stationnary:global}
\end{equation}
%
%%%%%%%%%%
%Scheme 
%%%%%%%%%%
We let $\phid_\D \in \V_\D^{k,k+1}$ be the interpolate of $\phi$ : for any $K \in \M$, $\phi_K = \Pi_K^{k+1}(\phi)$ and for all $\s \in \E$, $\phi_\s = \Pi_\s^{k}(\phi)$. 
Now, using a backward Euler discretisation in time with time step $\Delta t > 0$, we introduce the following scheme for \eqref{pb:evol}: 
\newline
find $\left (\l_\D^n \right)_{n \geq 1} \in \left (\V_\D^{k,k+1} \right ) ^\mathbb{N^*}$ such that 
%
\begin{subequations}\label{sch:AD}
        \begin{empheq}[left = \empheqlbrace]{align}
%        	\w_\D^{n+1}&= \l_\D^{n+1} + \phid_\D  - \alpha \one_\D, \label{sch:w}\\        	
%        %	u_K^{n+1}&= \exp(l_K^{n+1}),  \label{sch:u}\\
        	\int_\Omega \frac{u^{n+1}_\M - u^n_\M}{\Delta t} v_\M 
        		&= -  \mathcal{T}_\D(\l_\D^{n+1}, \l_\D^{n+1} +  \phid_\D, \v_D)
        		&&\forall \v_\D \in \V_\D^{k,k+1}, \label{sch:test}\\
        		u^0_K &= {u^{in}}_{|K}    	&&\forall K\in\M. \label{sch:ini} 
        \end{empheq}
\end{subequations}
Given a solution $\left (\l_\D^n \right)_{n \geq 1}$ to the scheme \eqref{sch:AD},  
%(approximation of the logarithm of the density at times $t^n = n \Delta t$), 
as discussed above, we associate a sequence of positive discrete densities $\left (\u_\D^n \right ) _{n \geq 1}$.
%
\begin{remark}[Parameter $\varepsilon$]
Note that $\mathcal{T}_\D$ is to be understood as a discretisation of $(l,w,v) \mapsto \int_\Omega (e^l + \epsilon) \Lambda w \cdot v $, with $\epsilon = \varepsilon h_K^{k+2}$ a small parameter.
The $\epsilon$ perturbation is used in order to show existence results of Proposition \ref{prop:exist} and can be seen as a kind of stabilisation. The scaling factor $h_K^{k+2}$ in \eqref{sch:stationnary} is used to get the expected order of convergence.
In practice, numerical results for $\varepsilon = 1$ and $\varepsilon = 0$ are almost the same. 
The influence of this term will be investigated in further works.
\end{remark}

% Equilibrium 
%%%%%%%%%%%%%
We define the discrete thermal equilibrium as $\u_\D^\infty = ( \rho \e^{-\phi_\M} ,\rho \e^{-\phi_\E}) $, with $\rho = M / \int_\Omega \e^{-\phi_\M}$. One can show that $\u_\D^\infty$ (and the associated logarithm potential $\l_\D ^\infty \in \V_\D^{k,k+1}$) is the only stationary solution to \eqref{sch:AD} with a mass density $M$.

%
%
%
%
\section{Main features of the scheme}
In this section, we present some results regarding the analysis of the scheme \eqref{sch:AD}. For analysis purposes, given $\l_\D \in \V_\D^{k,k+1}$ a discrete logarithm, we associate a discrete quasi Fermi potential defined as $\w_\D = \l_\D + \phid_\D - \log(\rho) \one_\D$. 
By definition of $\rho$, one has $w_\M = \log \left ( \frac{u_\M}{u_\M^\infty} \right)$.
Note that, for any $(\l_D,\v_\D) \in \V_\D^{k,k+1}$, we have $\mathcal{T}_\D(\l_\D, \l_\D +  \phid_\D, \v_D) = \mathcal{T}_\D(\l_\D, \w_\D, \v_D)$.
%
We now state fundamental a priori results. % which holds for any solution to \eqref{sch:AD}. 
\begin{prop}[Fundamental a priori relations]
Let $\left (l_\D^n \right)_{n \in \mathbb{N}}$ be a solution to the scheme \eqref{sch:AD}, and $\left (\u_\D^n \right ) _{n \geq 1}$ be the associated reconstructed discrete density. 
Then, the following a priori results hold:
\begin{enumerate}
	\item[(i)] the mass is preserved along time: 
$
	\displaystyle \forall n \in \mathbb{N}^*, \, \int_\Omega u^n_\M = \int u^{in} = M
$, 
%
	\item[(ii)] a discrete entropy/dissipation relation holds:
$ \displaystyle	\forall n \in \mathbb{N}, \, \frac{\Entro^{n+1} - \Entro^n }{\Delta t} \leq - \Diss^{n+1}$, 

%\begin{equation} \label{eq:entrorel}
%	\forall n \in \mathbb{N}, \, \frac{\Entro^{n+1} - \Entro^n }{\Delta t} + \Diss^{n+1} \leq 0, 
%\end{equation}
where the discrete entropy and dissipation are defined by 
$\Entro^n = \int_\Omega u^\infty_\M \Phi_1 \left ( \frac{u^n_\M}{u^\infty_\M}\right )$
and 
$\Diss^{n} = \mathcal{T}_\D (\l^n_\D,\w^n_\D, \w^n_\D) > 0$
with $\Phi_1:s \mapsto s \log(s) - s +1$ (and $\Phi_1(0) = 1$).
\end{enumerate}
\end{prop}
\begin{proof}
Using $\one_\D$ as a test function in \eqref{sch:test}, alongside with \eqref{sch:ini}, we get the mass conservation identity (i).
To get (ii), we test \eqref{sch:test} with $\w_\D^{n+1}$,
 and we use the convexity of $\Phi_1$ alongside with the expression of $\w_\M^{n+1}$.
%To get (ii), we using the convexity of $\Phi_1$  we have  
%$	
%	\Entro^{n+1} - \Entro^n 
%		\leq \int_\Omega  u_\M^\infty \Phi_1'\left(  \frac{u^{n+1}_\M}{u^\infty_\M}\right ) 
%			\frac{u^{n+1}_\M - u^{n}_\M }{u^\infty_\M}
%$.
%Then since $\w_\M^{n+1} = \log \left ( \frac{u_\M^{n+1}}{u_\M^\infty} \right)$, one has
%$	
%	\Entro^{n+1} - \Entro^n 
%		\leq  \int_\Omega w_\M^{n+1} \left (u^{n+1}_\M - u^{n}_\M \right )
%$.
%We conclude by testing \eqref{sch:test} with $\w_\D^{n+1}$.
\end{proof}
%
Note that the previous results hold for any $\varepsilon \geq 0$.
Following the ideas of \cite{CaGui:17,CHHLM:22}, the entropy/dissipation relation should allow to analyse the long-time behaviour of the discrete solution and to get convergence results. These aspects will be the topics of further works.
We now state an existence result, which holds only for positive $\varepsilon$. The proof follows the strategy used in \cite{CHHLM:22}.
%
\begin{prop}[Existence of solutions] \label{prop:exist}
%Let $u^{in} \in L^1(\Omega)$ be a non-negative function, such that $\int_\Omega u^{in} \log(u^{in}) < \infty$. 
Assume that the stabilisation parameter $\varepsilon$ in \eqref{sch:stationnary} is positive.
Then, there exists at least one solution $\left (\l_\D^n \right)_{n \geq 1}$ to the scheme \eqref{sch:AD}. The associated densities $\left (\u_\D^n \right ) _{n \geq 1}$ are positive functions.
\end{prop}
%\pagebreak
\section{Numerical results} 
The numerical scheme \eqref{sch:AD} requires to solve a nonlinear system at each time step. To do so, we use a Newton method, with an adaptative time stepping strategy: if the Newton method does not converge, we try to compute the solution for a smaller time step $0.5 \times \Delta t$. 
If the method converge, we use a bigger time step $2 \times \Delta t$. 
The maximal time step allowed is the initial time step.
Each time a linear system as to be solved, we use a static condensation (see \cite[Appendix B.3.2]{DiPDr:20}) in order to eliminate (locally) the cells unknowns. 
Note that the local computations are not implemented in parallel, but only sequentially.
In the sequel, we use the following stabilisation parameters: $\varepsilon = \eta_{nl} = \eta_l = 1$.
\newline
The tests used below are the same as in \cite{CHHLM:22}, to which we refer for more detailed explanations and descriptions.
Given a (face) degree $k$, the scheme \eqref{sch:AD} will be denoted by nlhho\_k, whereas the HFV scheme of \cite{CHHLM:22} will be denoted by nlhfv.
\subsection{Proof of concept: convergence order and efficiency}
Here, we are interested in the convergence of the scheme when $(h_\D, \Delta t) \to (0,0)$.
To do so, we set the advective potential and diffusion tensor as
$ \phi(x,y) = - x $ and 
$ \Lambda = \begin{psmallmatrix}
l_x & 0 \\ 
0 & 1
\end{psmallmatrix} $ for $l_x>0$.
The exact solution is therefore given by 
\[
	u(t,x,y) = C_1\e^{-\alpha t + \frac{x}{2}} \left ( 2\pi \cos( \pi x) + \sin(\pi x) \right )
	+ 2 C_1 \pi \e^{ x - \frac{1}{2}  }, 
\]
where $C_1> 0$ and $ \alpha = l_x \left ( \frac{1}{4} + \pi^2  \right )$. Note that $u^{in}$ vanishes on 
$\{ x = 1 \}$, but for any $t > 0$, $u(t, \cdot) > 0$.
Here, our experiments are performed using $l_x =  1$ and $C_1 = 10^{-1}$.
%
%
%
%%%%%%%%%%
% Er vs h 
%%%%%%%%%%
\begin{figure}[ht]
\begin{minipage}[c]{.51\linewidth}
\begin{tikzpicture}[scale= 0.69]
        \begin{loglogaxis}[
            legend style = { 
              at={(0.5,1.1)},
              anchor = south,
              tick label style={font=\footnotesize},
              legend columns=4
            },ylabel=\small{Relative $L^2(L^2)$-error on the solution},xlabel=\small{Spatial meshsize $h_\D$}
          ]
          \addplot table[x=Meshsize,y=error_sol] {graph_data/time_CV_adpt/errors_hho_0};          
          \addplot table[x=Meshsize,y=error_sol] {graph_data/time_CV_adpt/errors_hho_1}; 
          \addplot table[x=Meshsize,y=error_sol] {graph_data/time_CV_adpt/errors_hho_2};             
          \addplot table[x=Meshsize,y=error_sol] {graph_data/time_CV_adpt/errors_hho_3};    
          %\addplot table[x=Meshsize,y=error_sol] {graph_data/time_CV_adpt/errors_hho_4};         
          %\addplot table[x=Meshsize,y=error_sol] {graph_data/time_CV/errors_hho_4};          
          \logLogSlopeTriangle{0.90}{0.2}{0.1}{2}{black};
          \logLogSlopeTriangle{0.90}{0.2}{0.1}{3}{black};
          \logLogSlopeTriangle{0.90}{0.2}{0.1}{4}{black};
          \logLogSlopeTriangle{0.90}{0.2}{0.1}{5}{black};
          \legend{\tiny nlhho\_0 , \tiny nlhho\_1 , \tiny nlhho\_2 , \tiny nlhho\_3 } 
        \end{loglogaxis}
      \end{tikzpicture}    
\end{minipage}
\begin{minipage}[c]{.51\linewidth}
\begin{tikzpicture}[scale= 0.69]
        \begin{loglogaxis}[
            legend style = { 
              at={(0.5,1.1)},
              anchor = south,
              tick label style={font=\footnotesize},
              legend columns=4
            },ylabel=\small{Relative $L^2(L^2)$-error on the gradient},xlabel=\small{Spatial meshsize $h_\D$}
          ]          
          \addplot table[x=Meshsize,y=error_grad] {graph_data/time_CV_adpt/errors_hho_0};          
          \addplot table[x=Meshsize,y=error_grad] {graph_data/time_CV_adpt/errors_hho_1}; 
          \addplot table[x=Meshsize,y=error_grad] {graph_data/time_CV_adpt/errors_hho_2};            
          \addplot table[x=Meshsize,y=error_grad] {graph_data/time_CV_adpt/errors_hho_3};   
          \logLogSlopeTriangle{0.90}{0.2}{0.1}{1}{black};    
          \logLogSlopeTriangle{0.90}{0.2}{0.1}{2}{black};          
          \logLogSlopeTriangle{0.90}{0.2}{0.1}{3}{black};             
          \logLogSlopeTriangle{0.90}{0.2}{0.1}{4}{black};  
          \legend{\tiny nlhho\_0 , \tiny nlhho\_1 , \tiny nlhho\_2 , \tiny nlhho\_3 }      
        \end{loglogaxis}
      \end{tikzpicture}
\end{minipage}
\caption{\textbf{Accuracy of transient solutions.} Relative error on triangular meshes.}
\label{fig:CV:evol:order}
\end{figure}
%%
%
%%%%%%%%%%%%
% Err vs time 
%%%%%%%%%%%%
\begin{figure}[h]
\begin{minipage}[c]{.51\linewidth}
\begin{tikzpicture}[scale= 0.69]
        \begin{loglogaxis}[
            legend style = { 
              at={(0.5,1.1)},
              anchor = south,
              tick label style={font=\footnotesize},
              legend columns=4
            },ylabel=\small{Relative $L^2(L^2)$-error on the solution},xlabel=\small{Total time of the computation (in $s$)}
          ]
          \addplot table[x=time_cost,y=error_sol] {graph_data/time_CV_adpt/errors_hho_0};          
          \addplot table[x=time_cost,y=error_sol] {graph_data/time_CV_adpt/errors_hho_1};
          \addplot table[x=time_cost,y=error_sol] {graph_data/time_CV_adpt/errors_hho_2};             
          %\addplot table[x=time_cost,y=error_sol] {graph_data/time_CV_adpt/errors_hho_3};  
          \legend{\tiny nlhho\_0 , \tiny nlhho\_1 , \tiny nlhho\_2  }      
        \end{loglogaxis}
      \end{tikzpicture}    
\end{minipage}
\begin{minipage}[c]{.51\linewidth}
\begin{tikzpicture}[scale= 0.69]
        \begin{loglogaxis}[
            legend style = { 
              at={(0.5,1.1)},
              anchor = south,
              tick label style={font=\footnotesize},
              legend columns=4
            },ylabel=\small{Relative $L^2(L^2)$-error on the gradient},xlabel=\small{Total time of the computation (in $s$)}
          ]          
          \addplot table[x=time_cost,y=error_grad] {graph_data/time_CV_adpt/errors_hho_0};          
          \addplot table[x=time_cost,y=error_grad] {graph_data/time_CV_adpt/errors_hho_1};          
          \addplot table[x=time_cost,y=error_grad] {graph_data/time_CV_adpt/errors_hho_2};            
          %\addplot table[x=time_cost,y=error_grad] {graph_data/time_CV_adpt/errors_hho_3};   
          \legend{\tiny nlhho\_0 , \tiny nlhho\_1 , \tiny nlhho\_2 } 
        \end{loglogaxis}
      \end{tikzpicture}
\end{minipage}
\caption{\textbf{Accuracy vs computational cost.} Relative error on triangular meshes.}
\label{fig:CV:evol:cost}
\end{figure}
We compute the solution on the time interval $[0,0.1]$, and we denote by $(\u^n_\D)_{1 \leq n \leq N_f}$ the corresponding discrete density. Then, we compute the relative $L^2_t(L^2_x)$ error on the solution and on the gradient of the solution, defined as 
\[
	 \frac{\sqrt{\sum_{n = 1}^{N_f} \delta t^n  \|u_\M^n - u(t^n, \cdot ) \|^2_{L^2(\Omega)} }}
	 	{ \|u\|_{L^2_t(L^2)}}
	\text{ and }	
	\frac{\sqrt{ \sum_{n = 1}^{N_f}  \delta t^n  \| G_\M(\u^n_\D) - \nabla u(t^n, \cdot ) \|^2_{L^2(\Omega)}}}
	{\|\nabla u\|_{L^2_t(L^2)}} 
\]
where $\delta t^n = t^{n}-t^{n-1}$.
The $L^2$ norms are computed using quadrature formulas of order $2k +5$.
Note that, with the chosen definitions, we do not take into account the time $t=0$. 

%
To plot the error graphs, we do computations on a triangular mesh family $(\D_i)_{1\leq i \leq 5}$, such that $h_{\D_{i}} /h_{\D_{i+1}} = 2$.
Since the time discretisation is merely of order one, on the i-th mesh of the family, we use a time step of $\Delta t_i = \Delta t_k / 2^{(i-1) (k+2)}$, where $\Delta t_k = 0.05 / 2^{k+2}$ is the initial time step used on $\D_1$. 
%
% 

In Figure~\ref{fig:CV:evol:order}, we see that the scheme, for faces unknowns of degree $k$, converges at order $k+1$ in energy norm and $k+2$ on $L^2$ norm on the density.
On Figure~\ref{fig:CV:evol:cost}, we represent the errors as functions of the computing time to get the solution. 
It is remarkable to see that, even with a low order discretisation in time, significant efficiency gains can be reached by using a high value of $k$. The gain should be even bigger by parallelising the local computations.



\subsection{Discrete long-time behaviour}
%
We are now interested in the long-time behaviour of discrete solutions.
We use the same test case as before, but with an anisotropic tensor : we set $l_x =  10^{-2}$.
%The associated steady-state is $u^\infty(x,y) = .
We compute the solution on the time interval $[0,350]$, with $\Delta t = 10^{-1}$, on two Kershaw meshes of sizes $0.02$ and $0.006$. 
%
\begin{figure}[h]
\begin{minipage}[c]{.51\linewidth}
\begin{tikzpicture}[scale= 0.69]
        \begin{semilogyaxis}[
            legend style = { 
              at={(0.5,1.1)},
              anchor = south,
              tick label style={font=\footnotesize},
              legend columns=5
            },
            ylabel=\small{$L^1$ distance to $u^\infty$ on the coarsest mesh},
            xlabel=\small{Time}
            ]
          \addplot table[x=Temps,y=Diff_L1] {graph_data/tps_long/mesh4_1_1/tps_nonlin};
          \addplot table[x=Time,y=Diff_L1] {graph_data/tps_long/mesh4_1_1/time_nlhho_0};                   
          \addplot table[x=Time,y=Diff_L1] {graph_data/tps_long/mesh4_1_1/time_nlhho_1};               
          \addplot table[x=Time,y=Diff_L1] {graph_data/tps_long/mesh4_1_1/time_nlhho_2};       				
          \addplot[green] coordinates {
			(0,1)
			(350,4.1484969e-16)
			};
          \legend{\tiny nlhfv , \tiny nlhho\_0,\tiny nlhho\_1, \tiny nlhho\_2, 
           \tiny $ \e^{- \alpha t} $ }          
	      \end{semilogyaxis}
      \end{tikzpicture}    
\end{minipage}
\begin{minipage}[c]{.51\linewidth}
\begin{tikzpicture}[scale= 0.69]
        \begin{semilogyaxis}[
            legend style = { 
              at={(0.5,1.1)},
              anchor = south,
              tick label style={font=\footnotesize},
              legend columns=5
            },ylabel=\small{$L^1$ distance to $u^\infty$ on the finest mesh},xlabel=\small{Time}
          ]
          \addplot table[x=Temps,y=Diff_L1] {graph_data/tps_long/mesh4_1_4/tps_nonlin};          
          \addplot table[x=Time,y=Diff_L1] {graph_data/tps_long/mesh4_1_4/time_nlhho_0};                   
          \addplot table[x=Time,y=Diff_L1] {graph_data/tps_long/mesh4_1_4/time_nlhho_1};         
          \addplot table[x=Time,y=Diff_L1] {graph_data/tps_long/mesh4_1_4/time_nlhho_2};
          \addplot[green] coordinates {
			(0,1)
			(350,4.1484969e-16)
			};
          \legend{\tiny nlhfv , \tiny nlhho\_0,\tiny nlhho\_1, \tiny nlhho\_2, 
           \tiny $ \e^{- \alpha t} $ }       
        \end{semilogyaxis}
      \end{tikzpicture}
\end{minipage}
\caption{\textbf{Long-time behaviour of discrete solutions.} Comparison of the long-time behaviour on Kershaw meshes for $T_f = 350$ and $\Delta t = 0.1$.}
\label{fig:longtime}
\end{figure}
%%%%
%
In Figure \ref{fig:longtime}, we show the evolution along time of the $L^1$ distance between $\u^n_\D$ and $u^\infty = 2 C_1 \pi \e^{ x - \frac{1}{2} }$ computed as $\int_\Omega |u^n_\M - u^\infty|$.
We observe the exponential convergence towards the steady-state, until some precision is reached. 
The rates of convergence are similar to the exact one ($\alpha$), and does not depend on the size of the mesh.
%
%RMK: different threshold of saturation, must be the effect of different tolerance criterion used in the stopping criterion of the Newton method 


\subsection{Positivity}
This last section is dedicated to the positivity preserving feature of the scheme.
We set the advection field and the tensor as
$
\phi(x,y) = -\left (  (x-0.4)^2 +(y-0.6)^2   \right )
$
and $\Lambda = 
	\begin{psmallmatrix}
		0.8 & 0 \\ 
		0 & 1
	\end{psmallmatrix}
$.
%\[
%	\phi(x,y) = -\left (  (x-0.4)^2 +(y-0.6)^2   \right )\qquad \text{ and }\qquad 
%	\Lambda = 
%	\begin{pmatrix}
%		0.8 & 0 \\ 
%		0 & 1
%	\end{pmatrix} .
%\]
For the initial data, we take
$u^{in} = 10^{-3}  \,\1_{B} +   \1_{\Omega \setminus B}$,
where $B$ is the Euclidean ball
$\left \lbrace (x,y) \in \R^2 \mid (x-0.5)^2 + (y-0.5)^2 \leq 0.2^2 \right \rbrace $.
%These data ensure that the solution $u$ is positive on $\R_{+}\times\Omega$. 
%The experiment is performed on a of size $4.3 \cdot 10 ^{-3}$, made up of 4192 cells and 12512 edges. 
%
%
%Since we deal with a diffusive phenomenon, the smallest values of $u$ are expected for small time, hence 
We perform the simulations on the time interval $[0, 5 . 10^{-4}]$ with $\Delta t = 10^{-5}$ on a refined tilted hexagonal-dominant mesh (4192 cells).
%
%\[
%\text{min cells}: \min \left \{ \frac{1}{|K|}\int_K u_K^n \mid 1 \leq n \leq N_f, \ K \in \M \right \} 
%\text{min pyrs}: \min \left \{ \frac{1}{|P_{K\s}|}\int_{P_{K\s}} u_K^n \mid 1 \leq n \leq N_f, \ K \in \M, \s \in \E_K \right \}
%\]
%\[
%\text{min faces}: \min \left \{ \frac{1}{|\s|}\int_K u_\s^n \mid 1 \leq n \leq N_f, \ \s \in \E \right \} 
%\text{min cellQN}: \min \left \{ u_K^n(x_{QN}) \mid 1 \leq n \leq N_f, \ K \in \M, x_{QN} \in QN_K  \right \}
%\]
%\[
%\text{min faceQN}: \min \left \{ u_\s^n(x_{QN}) \mid 1 \leq n \leq N_f, \ \s \in \E, x_{QN} \in QN_\s  \right \}
%\]
%The number of resolution is the number of linear systems solved during the computation. The time is the time needed for the full computation of the solutions, in seconds (do not takes into account the postprocessing cost). 
%
\begin{table}[h]
{\small
\center
\begin{tabularx}{1.\textwidth}{|Y|Y|c|c|c|c|c|} 
\hline 
  	 				& computing time & \#resol	& mincells  		& minfaces 	& mincellQN 	&  minfaceQN \\ 
\hline 
	nlhfv			& 1.77e+01		& 175		& 9.93e-04		& 7.36e-04	& 9.93e-04	&  7.36e-04	\\ 
\hline 
	HMM 				& 2.20e-01		& 50			& -5e-03 		& -7.74e-02	& -5e-03 	& -7.74e-02	\\ 
\hline 
	nlhho\_0 		& 7.17e+01		& 224 		&  1.00e-03		& 1.01-03 	& 2.41e-06 	&  1.01e-03	\\ 
\hline 	
	nlhho\_1 		& 4.13e+02		& 248		&  6.65e-04		& 2.05e-05 	& 1.78e-04 	&  3.57e-08 	\\ 
\hline 	
	nlhho\_2 		& 1.45e+03		& 251		&  9.50e-04		& 5.99e-04 	& 2.67e-07 	&  1.06e-05	\\ 
\hline 		
	nlhho\_3 		& 3.87e+03		& 254		&  9.85e-04		& 8.58e-04 	& 1.10e-05 	&  1.79e-05	\\ 
\hline 	
\end{tabularx} 
}
\caption{\textbf{Positivity of discrete solutions.} 
%Numerical results for $T_f =5. 10^{-4}$ and $\Delta t= 10^{-5}$ on a tilted hexagonal-dominant mesh. 
%At each time step, there are 4192 cells and 12512 edges.
}\label{table:positivity}
\end{table}
\vspace{-0.4cm}
In Table \ref{table:positivity}, we show the minimal values reached by the schemes. 
The values of ``mincells" are defined as $\min \lbrace \frac{1}{|K|} \int_K u_\M  \mid K \in \M, 1 \leq n \leq N_f \rbrace $, whereas 
``mincellQN" are the minimal values taken by the densities on the cells quadratures nodes.
Analogous definitions hold for the faces.
The values of ``\#resol'' correspond to the number of linear systems solved during the computation.
Note that the size of these systems depends on the value of $k$.
The HMM scheme is a linear one (see \cite{CHHLM:22}), therefore only one LU factorisation was performed to compute the solution, which has 90 (resp. 503) negative cells unknowns (resp. faces).
%\begin{table}[h]
%{\small
%\center
%\begin{tabularx}{1.\textwidth}{|Y|c|Y|c|c|c|c|c|Y|Y|Y|} 
%\hline 
%  & time & \#resol & mincells & minpyrs & minfaces & mincellQN &  minfaceQN  & \# neg cells & \# neg pyrs & \# neg faces 		\\ 
%\hline 
%	nlhfv			& 1.77e+01	& 175	& 9.93e-04	& 9.93e-04	& 7.36e-04	& 9.93e-04	&  7.36e-04	& 0		& 0 		& 0  	\\ 
%\hline 
%	HMM 				& 2.20e-01	& 50  	& -5e-03 	& -5e-03 	& -7.74e-02	& -5e-03 	& -7.74e-02	& 90		& 90 	& 503	\\ 
%\hline 
%	ExpF (lo)		& 2.22e-01	& 50 	& -4.98e-03 	& -4.98e-03 	&-7.72e-02	&-4.98e-03 	& -7.72e-02	& 90		& 90 	& 500	\\ 
%\hline 
%	ExpF (harmonic) 	& 2.22e-01	& 50 	& -4.98e-03 	& -4.98e-03	& -7.74e-02	& -4.98e-03 	& -7.74e-02	& 90		& 90 	& 498 	\\ 
%\hline 	
%	nlhho\_0 		& 7.17e+01	& 224 	&  1.00e-03	& 1.00e-04	& 1.01-03 	& 2.41e-06 	&  1.01e-03	& 0		& 0 		& 0 		\\ 
%\hline 	
%	nlhho\_1 		& 4.13e+02	& 248 	&  6.65e-04	& 5.43e-04	& 2.05e-05 	& 1.78e-04 	&  3.57e-08	& 0		& 0 		& 0 		\\ 
%\hline 	
%	nlhho\_2 		& 1.45e+03	& 251 	&  9.50e-04	& 8.02e-04	& 5.99e-04 	& 2.67e-07 	&  1.06e-05	& 0		& 0 		& 0 		\\ 
%\hline 		
%	nlhho\_3 		& 3.87e+03	& 254 	&  9.85e-04	& 9.13e-04 	& 8.58e-04 	& 1.10e-05 	&  1.79e-05	& 0		& 0 		& 0		\\ 
%\hline 	
%	nlhho\_4 		& 8.65e+03	& 246 	&  9.98e-04	& 9.66e-04	& 9.81e-04 	& 2.79e-05 	&  2.42e-05	& 0		& 0 		& 0 		\\ 
%\hline 	
%\end{tabularx} 
%}
%\caption{\textbf{Positivity of discrete solutions, nonlinear high order.} Numerical results for $T_f =5. 10^{-4}$ and $\Delta t= 10^{-5}$ on a tilted hexagonal-dominant mesh. 
%At each time step, there are 4192 cells and 12512 edges.
%}\label{table:positivity}
%\end{table}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\vspace{0.25cm}
%\section*{Acknowledgements} 
\noindent
\textbf{Acknowledgements} \hspace{0.2cm}
The author thanks  Claire Chainais-Hillairet, Maxime Herda and Simon Lemaire for fruitful discussions about this work. The author acknowledges support by the Labex CEMPI (ANR-11-LABX-0007-01).
\vspace{-0.2cm}
%
%
% ---- Bibliography ----
%
\begin{thebibliography}{6}
\vspace{-0.3cm}
%
\bibitem{CaGui:17}
Canc\`es C., Guichard C.: Numerical analysis of a robust free energy diminishing finite volume scheme for parabolic equations with gradient structure.
Found. Comput. Math. 17, 6, 1525-1584 (2017).
\url{doi:10.1007/s10208-016-9328-6}
%
\bibitem{CHH:20}
Chainais-Hillairet C., Herda M.: Large-time behaviour of a family of finite volume schemes for boundary-driven convection-diffusion equations.
IMA J. Numer. Anal. 40, 4, 2473--2504 (2020).
\url{doi:10.1093/imanum/drz037}
%
\bibitem{CHHLM:22}
Chainais-Hillairet C., Herda M., Lemaire S., Moatti J.: Long-time behaviour of hybrid finite volume schemes for advection-diffusion equations: linear and nonlinear approaches.
Numer. Math. 151, 4, 963--1016 (2022).
\url{doi:10.1007/s00211-022-01289-w}
%
\bibitem{CEP:21}
Cicuttin, M., Ern, A., Pignet, N.: Hybrid high-order methods. A primer with applications to solid mechanics. 
Cham: Springer (2021)
\url{doi:10.1007/978-3-030-81477-9}
%
\bibitem{DiPEL:14}
Di Pietro, D. A., Ern, A., Lemaire, S.: An arbitrary-order and compact-stencil discretization of diffusion on general meshes based on local reconstruction operators.
Comput. Methods Appl. Math. 14, 4, 461-472 (2014).
\url{doi:10.1515/cmam-2014-0018}
%
\bibitem{DiPDr:20}
Di Pietro D. A., Droniou, J.: The hybrid high-order method for polytopal meshes. Design, analysis, and applications.
Cham: Springer (2020).
\url{doi:10.1007/978-3-030-37203-3}
%
\bibitem{Droni:14}
Droniou, J.: Finite volume schemes for diffusion equations: introduction to and review of modern methods.
Models Methods Appl. Sci., 24, 1575--1619 (2014).
\url{doi:10.1142/S0218202514400041}






\end{thebibliography}
\end{document}

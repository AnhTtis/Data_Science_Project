
\begin{theoremEnd}[\keylemmaproofoption,category=upperboundkeylemmameanfield]{lemma}\label{thm:meanfield_u_identity}
  Let the assumptions of~\cref{thm:general_variational_gradient_norm_bound} hold and \(\rvvu \sim \varphi\) satisfy \cref{assumption:symmetric_standard}.
  Then, for the mean-field parameterization,
    {
    \setlength{\belowdisplayskip}{1.5ex} \setlength{\belowdisplayshortskip}{1.5ex}
    \setlength{\abovedisplayskip}{1.5ex} \setlength{\abovedisplayshortskip}{1.5ex}
  \begin{alignat*}{2}
    &\mathbb{E}\norm{\vt_{\vlambda}\left(\rvvu\right) - \vz}_2^2 \left(1 + \norm{\mathbfsfit{U}}_{\mathrm{F}} \right)
    \\
    &\quad\leq
    \left(\sqrt{d \kappa} + \kappa\sqrt{d} + 1\right) \, \norm{ \vm - \vz }_2^2
    +
    \left(2 \kappa \sqrt{d} + 1\right)
    \norm{\mC}_{\mathrm{F}}^2.
  \end{alignat*}
  }
\end{theoremEnd}
\vspace{-1ex}
\begin{proofEnd}
  The key idea is to prove a similar result as \cref{thm:reparam_u_identity}, but with better constants to reflect that the mean-field parameterization has a lower variance. 

  First,
  \begin{align}
    &\mathbb{E}\norm{\vt_{\vlambda}\left(\rvvu\right) - \vz}_2^2 \, \left( 1 + \norm{\mathbfsfit{U}}_{\mathrm{F}} \right) \nonumber \\
    &\;=
    \mathbb{E}\norm{\vt_{\vlambda}\left(\rvvu\right) - \vz}_2^2 
    + \mathbb{E} \norm{\mathbfsfit{U}}_{\mathrm{F}} \, \norm{\vt_{\vlambda}\left(\rvvu\right) - \vz}_2^2, 
    \nonumber
\shortintertext{applying \cref{thm:reparam_quadratic},}
    &\;=
    \norm{ \vm - \vz }_2^2 + \norm{\mC}_{\mathrm{F}}
    +
    \mathbb{E} \norm{\mathbfsfit{U}}_{\mathrm{F}} \, \norm{\vt_{\vlambda}\left(\rvvu\right) - \vz}_2^2.
    \label{thm:meanfield_eq0}
  \end{align}
  
  The last term decomposes as 
  \begin{alignat}{2}
    \mathbb{E} \norm{\mathbfsfit{U}}_{\mathrm{F}} \norm{\vt_{\vlambda}\left(\rvvu\right) - \vz}_2^2
    \nonumber
    &=
    \underbrace{
      \mathbb{E} \norm{\mathbfsfit{U}}_{\mathrm{F}} \, \rvvu^{\top} \mC^{\top} \mC \rvvu 
    }_{\text{Term \ding{182}}}
    \nonumber
    \\
    &\quad+
    2\, 
    \underbrace{
      \mathbb{E} \norm{\mathbfsfit{U}}_{\mathrm{F}} \, \rvvu^{\top} \mC^{\top} \left( \vm - \vz \right)
    }_{\text{Term \ding{183}}}
    \nonumber
    \\
    &\quad+
    \underbrace{\mathbb{E} \norm{\mathbfsfit{U}}_{\mathrm{F}}}_{\text{Term \ding{184}}} \, \norm{ \vm - \vz }_2^2.
    \label{thm:meanfield_eq1}
  \end{alignat}
  We will now focus on the stochastic terms \ding{182}-\ding{184} one by one.
  
  First, for Term \ding{182}, notice that the mean-field parameterization implies that \(\mC = \mathrm{diag}\left( c_1, \ldots, c_d \right)\).
  Thus, 
  \begin{alignat}{2}
    \mathbb{E} \norm{\mathbfsfit{U}}_{\mathrm{F}} \,  \rvvu^{\top} \mC^{\top} \mC \rvvu 
    &=
    \mathbb{E} \left( \sqrt{ \sum_{i=1}^d \rvu_i^4 } \right) \left( \sum_{i=1}^d c_i^2 \, u_i^2 \right)
    \nonumber
    \\
    &=
    \sum_{i=1}^d c_i^2 \, \mathbb{E} \left( \sqrt{ \sum_{j=1}^d \rvu_j^4 } \right) \rvu_i^2,
    \nonumber
\shortintertext{applying Cauchy-Schwarz inequality for expectations,}
    &\leq
    \sum_{i=1}^d c_i^2 \sqrt{ \left( \mathbb{E} \sum_{j=1}^d \rvu_j^4  \right) \left( \mathbb{E}  \rvu_i^4 \right) }
    \nonumber
\shortintertext{and given \cref{assumption:symmetric_standard},}
    &\;=
    \sum_{i=1}^d c_i^2 \, \sqrt{ d \kappa^2 }
    \nonumber
    \\
    &\;=
    \kappa \sqrt{d} \, \norm{ \mC }_{\mathrm{F}}^2.
    \label{thm:meanfield_eq5}
  \end{alignat}
  
  Term \ding{183} can be bounded as 
  \begin{alignat}{2}
    &\mathbb{E} 
      \norm{\mathbfsfit{U}}_{\mathrm{F}} \, \rvvu^{\top} 
    \mC^{\top} \left( \vm - \vz \right) 
    \nonumber
\shortintertext{using the Cauchy-Schwarz inequality for vectors as}
    &\;\leq
    %
    \mathbb{E} \norm{\mathbfsfit{U}}_{\mathrm{F}} \, \norm{\mC \rvvu}_2 \norm{ \vm - \vz }_2,
    \nonumber
\shortintertext{again, applying the inequality for expectations,}
    &\;=
    \sqrt{
    \mathbb{E}
    \norm{\mathbfsfit{U}}_{\mathrm{F}}^2 \,
    \mathbb{E}
    \norm{\mC \rvvu}_2^2 
    } \,
    \norm{ \vm - \vz }_2
    \nonumber
    \\
    &\;=
    \sqrt{
    \mathbb{E}
    \left(
    \sum^d_{i=1} \rvu_i^4  
    \right) \,
    \mathrm{tr}\left(\mC^{\top} \mC \, \mathbb{E} \rvvu \rvvu^{\top} \right)
    } \,
    \norm{ \vm - \vz }_2,
    \nonumber
\shortintertext{from \cref{assumption:symmetric_standard},}
    &\;=
    \sqrt{
    d \kappa \,
    \mathrm{tr}\left(\mC^{\top} \mC \right)
    } \,
    \norm{ \vm - \vz }_2
    \nonumber
    \\
    &\;=
    \sqrt{d \kappa} \,
    \norm{\mC}_{\mathrm{F}} \,
    \norm{ \vm - \vz }_2
     \nonumber
    \\
    &\;=
    \sqrt{d \kappa} \,
    \sqrt{ \norm{\mC}_{\mathrm{F}}^2 \,
           \norm{ \vm - \vz }_2^2 },
    \nonumber
\shortintertext{and by the arithmetic mean-geometric mean inequality,}
    &\;=
    \frac{\sqrt{d \kappa}}{2}
    \left(
      \norm{\mC}_{\mathrm{F}}^2
      +
      \norm{ \vm - \vz }_2^2
    \right).
    \label{thm:meanfield_eq3}
  \end{alignat}

  Finally, Term \ding{184} follows as
  \begin{alignat}{2}
    \mathbb{E} \norm{\mathbfsfit{U}}_{\mathrm{F}}
    &=
    \mathbb{E} \sqrt{ \sum_{i=1}^d \rvu_i^4  },
    \nonumber
\shortintertext{using Jensen's inequality,}
    &\leq
    \sqrt{ \mathbb{E} \sum_{i=1}^d \rvu_i^4 }
    \nonumber
    \\
    &=
    \sqrt{ d \kappa }.
    \label{thm:meanfield_eq2}
  \end{alignat}

  Combining all the results, \cref{thm:meanfield_eq0} becomes
  \begin{alignat*}{2}
    &\mathbb{E}\norm{\vt_{\vlambda}\left(\rvvu\right) - \vz}_2^2 \, \left( 1 + \norm{\mathbfsfit{U}}_{\mathrm{F}} \right)
    \\
    &\;\leq
    \norm{ \vm - \vz }_2^2 + \norm{\mC}_{\mathrm{F}}^2
    \\ 
    &\;\quad+
    \mathbb{E} \norm{\mathbfsfit{U}}_{\mathrm{F}} \, \rvvu^{\top} \mC^{\top} \mC \rvvu
    \\ 
    &\;\quad+
    2\,\mathbb{E} \norm{\mathbfsfit{U}}_{\mathrm{F}} \, \rvvu^{\top} \mC^{\top} \norm{ \vm - \vz }_2^2
    \\ 
    &\;\quad+
    \mathbb{E} \norm{\mathbfsfit{U}}_{\mathrm{F}} \, \norm{ \vm - \vz }_2^2
\shortintertext{and applying \cref{thm:meanfield_eq2,thm:meanfield_eq3,thm:meanfield_eq5},}
    &\;\leq
    \norm{ \vm - \vz }_2^2 + \norm{\mC}_{\mathrm{F}}^2
    \\ 
    &\;\quad+
    \kappa\sqrt{d} \norm{\mC}_{\mathrm{F}}
    \\ 
    &\;\quad+
    \kappa \sqrt{d} \left(
     \norm{\mC}_{\mathrm{F}}^2 + \norm{\vm - \vz}_2^2
    \right)
    \\ 
    &\;\quad+
    \sqrt{d \kappa} \, \norm{ \vm - \vz }_2^2
    \\ 
    &\;=
    \left(\sqrt{d \kappa} + \kappa\sqrt{d} + 1\right) \, \norm{ \vm - \vz }_2^2
    +
    \left(2 \kappa \sqrt{d} + 1\right)
    \norm{\mC}_{\mathrm{F}}^2.
  \end{alignat*}

\end{proofEnd}

%%% Local Variables:
%%% TeX-master: "main"
%%% End:

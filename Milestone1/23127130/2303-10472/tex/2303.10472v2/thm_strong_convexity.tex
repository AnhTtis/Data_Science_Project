
\begin{theoremEnd}[category=convexity]{theorem}[\textbf{Strong Convexity}]
  For the location-scale family (\cref{def:family}) with the full-rank (\cref{def:fullrank}) parameterization with a 1-Lipschitz strictly positive function \(\phi\), if \(f\) is \(\mu\)-strongly convex, then \(F\) is also \(\mu\)-strongly convex.
\end{theoremEnd}
\begin{proofsketch}
  For the matrix square root parameterization \citet{domke_provable_2020} have shown that, if \(f\) is \(\mu\)-strongly convex, \(\vlambda \mapsto \mathbb{E} f \circ \vt_{\vlambda}\left(\rvvu\right)\) is also \(\mu\)-strongly convex.
  We simply extrapolate this result by showing that the diagonal elements \(\vs\) preserve strong convexity.
\end{proofsketch}
\begin{proofEnd}
  Recall that
  \begin{align}
    F\left(\vlambda\right)
    =
    \underbrace{\mathbb{E} f\left(\vt_{\vlambda}\left(\rvvu\right)\right)}_{\text{likelihood term}} + \underbrace{h\left(\vlambda\right)}_{\text{regularization term}}.
  \end{align}
  We first establish the strong convexity of the likelihood term and then the convexity of the regularization term.

  \paragraph{Strong Convexity of likelihood term}
  For the matrix square root parameterization (\cref{def:squareroot}), 
  if \(f\) is \(\mu\)-strongly convex, then the likelihood term is also \(\mu\)-strongly convex \citep{domke_provable_2020}.
  This means that, 
  \begin{align}
      & \mathbb{E} f\left(\vt_{\vlambda}\left(\rvvu\right)\right)  - 
 \mathbb{E} f\left(\vt_{\vlambda^{\prime}}\left(\rvvu\right)\right)
      \nonumber
      \\
      &\;=
      \inner{\nabla_{\vlambda^{\prime}} \mathbb{E} f\left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right) }{
        \vlambda - \vlambda^{\prime}
      }
      +
      \frac{\mu}{2} \mathbb{E}\norm{\vt_{\vlambda}\left(\rvvu\right) - \vt_{\vlambda^{\prime}}\left(\rvvu\right)}_2^2
      \nonumber
      \\
      &=
      \inner{ 
        \mathbb{E} 
        \frac{
          \partial \vt_{\vlambda^{\prime}}\left(\rvvu\right)
        }{
          \partial \vlambda^{\prime}
        }
        \nabla f \left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right)
      }{
        \vlambda - \vlambda^{\prime}
      }
      +
      \frac{\mu}{2} \mathbb{E}\norm{\vt_{\vlambda}\left(\rvvu\right) - \vt_{\vlambda^{\prime}}\left(\rvvu\right)}_2^2.
      \label{eq:thm_convexity_inequality}
  \end{align}
  Focusing on the inner product term,
  \begin{align*}
    &\inner{ 
      \mathbb{E} 
      \frac{
        \partial \vt_{\vlambda^{\prime}}\left(\rvvu\right)
      }{
        \partial \vlambda^{\prime}
      }
      \nabla f \left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right)
    }{
      \vlambda - \vlambda^{\prime}
    }
    \\
    &\;= 
    \inner{ 
      \mathbb{E} 
      \frac{
        \partial \vt_{\vlambda^{\prime}}\left(\rvvu\right)
      }{
        \partial \vm^{\prime}
      }
      \nabla f \left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right)
    }{
      \vm - \vm^{\prime}
    }
    \\
    &\;\quad+
    \sum^d_{j=1} \sum^d_{i=1} 
    \left(
    \mathbb{E} 
    \frac{
      \partial \vt_{\vlambda^{\prime}}\left(\rvvu\right)
    }{
      \partial C_{ij}^{\prime}
    }
    \nabla f \left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right)
    \right)
    \left(C_{ij} - C_{ij}^{\prime}\right)
    \\
    &\;= 
    \inner{ 
      \mathbb{E} 
      \frac{
        \partial \vt_{\vlambda}\left(\rvvu\right)
      }{
        \partial \vm^{\prime}
      }
      \nabla f \left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right)
    }{
      \vm - \vm^{\prime}
    }
    \\
    &\;\quad+
    \underbrace{
    \sum^d_{j=1} \sum^d_{i=1,\,i \neq j} 
    \left(
    \mathbb{E} 
    \frac{
      \partial \vt_{\vlambda^{\prime}}\left(\rvvu\right)
    }{
      \partial C_{ij}^{\prime}
    }
    \nabla f \left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right)
    \right)
    \left(C_{ij} - C_{ij}^{\prime}\right)
    }_{\text{off-diagonal of \(\mC\)}}
    \\
    &\;\quad+
    \underbrace{
    \sum^d_{i=1} 
    \left(
    \mathbb{E}
    \frac{
      \partial \vt_{\vlambda^{\prime}}\left(\rvvu\right)
    }{
      \partial C_{ii}^{\prime}
    }
    \nabla f \left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right)
    \right)
    \left(C_{ii} - C_{ii}^{\prime}\right)
    }_{\text{diagonal of \(\mC\)}}.
  \end{align*}
  Furthermore, the  diagonal terms can be shown to satisfy
  \begin{align}
    &\sum^d_{i=1} 
    \left(
    \mathbb{E}
    \frac{
      \partial \vt_{\vlambda^{\prime}}\left(\rvvu\right)
    }{
      \partial C_{ii}^{\prime}
    }
    \nabla f \left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right)
    \right)
    \left(C_{ii} - C_{ii}^{\prime}\right)
    \nonumber
    \\
    &\;=
    \sum^d_{i=1} 
    \mathbb{E}
    u_i \ve_i^{\top} \nabla f \left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right)
    \left(C_{ii} - C_{ii}^{\prime}\right).\label{eq:thm_convexity_diagonal_squareroot}
  \end{align}
  For the parameterizations in \cref{def:meanfield} and \cref{def:fullrank}, the derivatives only differ for the diagonal of \(\mC\).
  Specifically, since the diagonals are \(C_{\mathrm{FR},ii} = \phi\left(s_i\right)\), the inner product term of the diagonal entries of the full rank parameterization (\cref{def:fullrank}) is now
  \begin{align*}
    &\sum^d_{i=1} 
    \left(
    \mathbb{E}
    \frac{
      \partial \vt_{\vlambda^{\prime}}\left(\rvvu\right)
    }{
      \partial C_{\mathrm{FR},ii}^{\prime}
    }
    \nabla f \left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right)
    \right)
    \left(C_{\mathrm{FR},ii} - C_{\mathrm{FR},ii}^{\prime}\right)
    \\
    &\;=
    \sum^d_{i=1} 
    \mathbb{E}
    \phi^{\prime}\left(s_i^{\prime}\right) u_i \ve_i^{\top} \nabla f \left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right)
    \left(C_{\mathrm{FR},ii} - C_{\mathrm{FR},ii}^{\prime}\right)
    \\
    &\;\leq
    \sum^d_{i=1} 
    \mathbb{E}
    u_i \ve_i^{\top} \nabla f \left( \vt_{\vlambda^{\prime}}\left(\rvvu\right) \right)
    \left(C_{\mathrm{FR},ii} - C_{\mathrm{FR},ii}^{\prime}\right),
  \end{align*}
  which is equal to~\cref{eq:thm_convexity_diagonal_squareroot}.
  Therefore, the bound in \cref{eq:thm_convexity_inequality} is preserved, where the strong convexity term 

  \paragraph{Convexity of regularization term}
  For the full-rank Cholesky parameterization \cref{def:fullrank}, the regularization term is 
  \begin{align*}
    h\left(\vlambda\right) 
    &= - \mathrm{H}\left(q_{\vlambda}\right)
    \\
    &= - \mathrm{H}\left(\varphi\right) - \log \abs{ \mC }
    \\
    &= - \mathrm{H}\left(\varphi\right) - \sum_{i=1}^{d} \log \phi\left(s_i\right).
  \end{align*}
  Showing that \(-\log \phi\) is convex shows that \(h\) is convex since the sum of convex functions is convex.
  Now, since
  \begin{align*}
    -\frac{d^2 \log \phi}{ds^2} 
    =
    \frac{
      {\phi^{\prime}\left(s\right)}^{2} - \phi^{\prime\prime}\left(x\right)
    }{
      {\phi\left(s\right)}^{2}
    }
  \end{align*}
  and \(\phi\left(s\right) > 0\) for all \(s\), any \(\phi\) satisfying results in \(h\) being convex.
\end{proofEnd}

%%% Local Variables:
%%% TeX-master: "main"
%%% End:

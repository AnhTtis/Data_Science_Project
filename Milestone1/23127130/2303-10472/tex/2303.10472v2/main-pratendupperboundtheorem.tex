

\prAtEndRestatevii*

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndvii}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofvii{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndvii}The proof uses the \(L_{\mathrm {H}}\)-smoothness of \(f_{\mathrm {H}}\) such that \begin {align} \mathbb {E} \norm { \nabla f_{\mathrm {H}}\left (\vt _{\vlambda }\left (\rvvu \right )\right ) }_2^2 &= \mathbb {E} {\lVert \nabla f_{\mathrm {H}}\left (\vt _{\vlambda }\left (\rvvu \right )\right ) - \nabla f_{\mathrm {H}}\left (\bar {\vzeta }_{\mathrm {H}}\right ) \rVert }_2^2 \nonumber \\ &\leq L^2_{\mathrm {H}} \mathbb {E} {\lVert \vt _{\vlambda }\left (\rvvu \right ) - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2, \label {eq:thm_upper_bound_smoothness} \end {align} where \(\bar {\vzeta }_{\mathrm {H}}\) is a stationary point of \(f_{\mathrm {H}}\) such that \(\nabla f_{\mathrm {H}}\left (\bar {\vzeta }_{\mathrm {H}}\right ) = \mathbf {0}\). These steps have been previously used by \citet [Theorem 3]{domke_provable_2019} to prove the special case for the matrix square root parameterization. \par For the mean-field parameterization, we start from \cref {thm:general_variational_gradient_norm_bound} and apply~\cref {eq:thm_upper_bound_smoothness} as \begin {align} &\mathbb {E} \norm { \nabla _{\vlambda } f_{\mathrm {H}}\left (\vt _{\vlambda }\left (\rvvu \right )\right ) }_2^2 \nonumber \\ &\;\leq \mathbb {E} \norm { \nabla f_{\mathrm {H}}\left (\vt _{\vlambda }\left (\rvvu \right )\right ) }_2^2 \left (1 + \norm {\mathbfsfit {U}}_{\mathrm {F}}\right ) \nonumber \\ &\;\leq L^2_{\mathrm {H}} \, \mathbb {E} {\lVert \vt _{\vlambda }\left (\rvvu \right ) + \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2 \left (1 + \norm {\mathbfsfit {U}}_{\mathrm {F}}\right ), \nonumber \shortintertext {applying \cref {thm:meanfield_u_identity},} &\;\leq L^2_{\mathrm {H}} \left ( \kappa \sqrt {d} + \sqrt {\kappa d} + 1 \right ) {\lVert \vm - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2 \nonumber \\ &\;\;\quad + L^2_{\mathrm {H}} \left (2 \kappa \sqrt {d} + 1\right ) \norm {\mC }_{\mathrm {F}}^2, \nonumber \shortintertext {and since the kurtosis satisfies \(\kappa \geq 1\) and thus \(\kappa \geq \sqrt {\kappa }\),} &\;\leq L^2_{\mathrm {H}} \left ( 2 \kappa \sqrt {d} + 1 \right ) \left ( {\lVert \vm - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2 + \norm {\mC }_{\mathrm {F}}^2 \right ). \label {eq:thm1_meanfield} \end {align} \par Similarly, for the full-rank parameterizations, we start from \cref {thm:general_variational_gradient_norm_bound} and apply~\cref {eq:thm_upper_bound_smoothness} as \begin {alignat}{2} &\mathbb {E} \norm { \nabla _{\vlambda } f_{\mathrm {H}}\left (\vt _{\vlambda }\left (\rvvu \right )\right ) }_2^2 \\ &\;\leq \mathbb {E}\norm {\nabla f_{\mathrm {H}}\left (\vt _{\vlambda }\left (\rvvu \right )\right )}_2^2 \left (1 + \norm {\rvvu }_2^2 \right ), \nonumber \\ &\;\leq L^2_{\mathrm {H}}\,\mathbb {E}{\lVert \vt _{\vlambda }\left (\rvvu \right ) - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2 \left (1 + \norm {\rvvu }_2^2 \right ), \nonumber \shortintertext {applying \cref {thm:reparam_u_identity},} &\;= L^2_{\mathrm {H}}\left (\left (d + 1\right ) {\lVert \vm - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2 + \left (d + \kappa \right ) \norm {\mC }_{\mathrm {F}}^2 \right ), \nonumber \shortintertext {and since the kurtosis satisfies \(\kappa \geq 1\),} &\;\leq L^2_{\mathrm {H}}\left (d + \kappa \right ) \left ( {\lVert \vm - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2 + \norm {\mC }_{\mathrm {F}}^2 \right ). \label {eq:thm1_fullrank} \end {alignat} \par Both \cref {eq:thm1_meanfield,eq:thm1_fullrank} can now be denoted as \begin {alignat}{2} \mathbb {E}\norm {\nabla _{\vlambda } f_{\mathrm {H}}\left (\vt _{\vlambda }\left (\rvvu \right )\right )}_2^2 &\leq L^2_{\mathrm {H}}\, C\left (d, \kappa \right ) \left ( {\lVert \vm - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2 + \norm {\mC }_{\mathrm {F}}^2 \right ), \nonumber \shortintertext {where by \cref {thm:reparam_quadratic},} &= L^2_{\mathrm {H}}\, C\left (d, \kappa \right ) \mathbb {E} {\Vert \vt _{\vlambda }\left (\rvvu \right ) - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2, \label {eq:thm1_parameter_suboptimality_unified} \end {alignat} and the constants are \(C\left (d, \kappa \right ) = \kappa \sqrt {d} + 1\) for mean-field and \(C\left (d, \kappa \right ) = d + \kappa \) for the full-rank parameterizations. \par As mentioned in the proof sketch, to preserve generality, it is necessary to convert the entropy-regularized form into the KL-regularized form through the following inequality: {\setlength {\belowdisplayskip }{1ex} \setlength {\belowdisplayshortskip }{1ex}\setlength {\abovedisplayskip }{1ex} \setlength {\abovedisplayshortskip }{1ex}\begin {alignat*}{2} \hspace {-0.5em} \mathbb {E} {\Vert \vt _{\vlambda }\left (\rvvu \right ) - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2 &\leq 2\,\mathbb {E} {\lVert \vt _{\vlambda }\left (\rvvu \right ) - \bar {\vzeta }_{\text {KL}} \rVert }_2^2 + 2 \, {\lVert \bar {\vzeta }_{\text {KL}} - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2, \end {alignat*} }where \(\bar {\vzeta }_{\mathrm {KL}}\) is a stationary point of \(f_{\mathrm {KL}}\). Note that the KL-regularized form does not need to be tractable; only its existence suffices. We can now apply the quadratic growth assumption as {\setlength {\belowdisplayskip }{1ex} \setlength {\belowdisplayshortskip }{1ex}\setlength {\abovedisplayskip }{1ex} \setlength {\abovedisplayshortskip }{1ex}\begin {alignat}{2} \hspace {-1em} \mathbb {E} {\lVert \vt _{\vlambda }\left (\rvvu \right ) - \bar {\vzeta }_{\text {KL}} \rVert }_2^2 \nonumber &\leq \frac {2}{\mu _{\mathrm {KL}}} \left ( \mathbb {E} f_{\text {KL}}\left (\vt _{\vlambda }\left (\rvvu \right )\right ) - f^*_{\text {KL}} \right ) \nonumber \\ &= \frac {2}{\mu _{\mathrm {KL}}} \left ( F\left (\vlambda \right ) - h_{\mathrm {KL}}\left (\vlambda \right ) - f^*_{\text {KL}} \right ), \nonumber \shortintertext {and since \(-h_{\mathrm {KL}}\left (\vlambda \right ) = -\DKL {q_{\vlambda }}{p} \leq 0\) by definition,} &\leq \frac {2}{\mu _{\mathrm {KL}}} \left ( F\left (\vlambda \right ) - f^*_{\text {KL}} \right ) \label {eq:thm_upper_bound_kl_upper_bound} \\ &= \frac {2}{\mu _{\mathrm {KL}}} \left ( \left ( F\left (\vlambda \right ) - F^* \right ) + \left ( F^* - f^*_{\text {KL}} \right ) \right ). \label {eq:thm_upper_bound_f_quadratic} \end {alignat} }Combining \cref {eq:thm1_parameter_suboptimality_unified} with \cref {eq:thm_upper_bound_parallel}, {\begin {align*} &\mathbb {E}\norm {\nabla _{\vlambda } f_{\mathrm {H}}\left (\vt _{\vlambda }\left (\rvvu \right )\right )}_2^2 \\ &\;\leq 2 \, L^2_{\mathrm {H}}\, C\left (d, \kappa \right ) \mathbb {E} {\Vert \vt _{\vlambda }\left (\rvvu \right ) - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2 + 2 \, L^2_{\mathrm {H}}\, C\left (d, \kappa \right ) {\lVert \bar {\vzeta }_{\text {KL}} - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2, \shortintertext {and applying \cref {eq:thm_upper_bound_f_quadratic},} &\;\leq \frac {4 \, L^2_{\mathrm {H}}}{\mu _{\mathrm {KL}}} C\left (d, \kappa \right ) \left ( \left ( F\left (\vlambda \right ) - F^* \right ) + \left ( F^* - f^*_{\text {KL}} \right ) \right ) \\ &\;\quad + 2 \, L^2_{\mathrm {H}}\, C\left (d, \kappa \right ) {\lVert \bar {\vzeta }_{\text {KL}} - \bar {\vzeta }_{\mathrm {H}} \rVert }_2^2 \end {align*} }Plugging this into \cref {thm:gradient_variance_general_upper_bound} yields the result.\end{proof}

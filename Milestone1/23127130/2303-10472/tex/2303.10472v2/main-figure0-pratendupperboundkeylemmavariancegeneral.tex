

\prAtEndRestateviii*

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndviii}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofviii{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndviii}From the definition of variance, \begin {alignat}{2} &\mathbb {E} \norm {\vg _M }^2_2 \nonumber \\ &\;= \mathrm {tr}\,\V { \vg _M } + \norm {\mathbb {E} \vg }^2_2, \nonumber \shortintertext {following the definition in \cref {eq:def_gradient_M_est},} &\;= \mathrm {tr}\,\V { \frac {1}{M} \sum _{m=1}^M \vg _m } + \norm { \nabla F\left (\vlambda \right ) }^2_2, \nonumber \shortintertext {and then the definition in \cref {eq:def_gradient_m_est},} &\;= \mathrm {tr}\,\V { \frac {1}{M} \sum _{m=1}^M \nabla _{\vlambda } f\left (\vt _{\vlambda }\left (\rvvu _m\right )\right ) + \nabla h\left (\vlambda \right ) } + \norm { \nabla F\left (\vlambda \right ) }^2_2, \nonumber \shortintertext {by the linearity of variance,} &\;= \frac {1}{M} \mathrm {tr}\,\V { \nabla _{\vlambda } f\left (\vt _{\vlambda }\left (\rvvu \right )\right ) } + \norm { \nabla F\left (\vlambda \right ) }^2_2 \\ &\;= \frac {1}{M} \left ( \mathbb {E}{ \norm {\nabla _{\vlambda } f\left (\vt _{\vlambda }\left (\rvvu \right )\right )}_2^2 } - \norm { \mathbb {E}{ \nabla _{\vlambda } f\left (\vt _{\vlambda }\left (\rvvu \right )\right )} }_2^2 \right ) + \norm { \nabla F\left (\vlambda \right ) }^2_2 \nonumber \\ &\;\leq \frac {1}{M} \mathbb {E}{ \norm { \nabla _{\vlambda } f\left (\vt _{\vlambda }\left (\rvvu \right )\right ) }_2^2 } + \norm { \nabla F\left (\vlambda \right ) }^2_2. \nonumber \end {alignat} The results follow from applying \cref {thm:general_variational_gradient_norm_bound} accordingly. \par \todo [inline]{ I think it might be possible to do something about the \[ -\norm {\mathbb {E}{ \nabla _{\vlambda } f\left (\vt _{\vlambda }\left (\rvvu \right )\right )}}_2^2 \] term instead of just upper bounding it by 0. In fact, it is possible to generalize \cref {thm:general_variational_gradient_norm_identity} such that \begin {align*} &\inner { \nabla _{\vlambda } f\left ( \vt _{\vlambda }\left (\vu \right ) \right ) }{ \nabla _{\vlambda } f\left ( \vt _{\vlambda }\left (\vv \right ) \right ) } \\ &\;= \left (1 + \inner {\vu }{\vv }\right ) \inner {\vg _{f,\vu }}{\vg _{f,\vv }} + \mathrm {tr}\left ( \vg _{f,\vu } \vg _{f,\vv }^{\top }\, \vv \vu ^{\top } \left ( \Phi ^2 - \mI \right ) \right ), \end {align*} where \(\vg _{f,\vu } = \nabla f\left (\vt _{\vlambda }\left (\vu \right )\right )\). }\end{proof}

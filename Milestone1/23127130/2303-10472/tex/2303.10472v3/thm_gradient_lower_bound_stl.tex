
\begin{theorem}
  %%Let \(f\left(\vz\right) = \left(\vz - \vm\right) \mSiga^{-1} \left(\vz - \vm\right) \)
  For some functions \(\mathcal{L}\) defined as \(\mathcal{L} = \mathbb{E} f\left(\vt_{\vw}\left(\rvvu\right)\right) \), where \(\vt\) is the reparameterization estimator, the variance of their \(M\)-sample gradient estimator is bounded below as
  \begin{align}
    \mathbb{E}\norm{\vg}_2^2
    \geq
    2 A \left( \mathcal{L}\left(\vw\right) - \mathcal{L}\left(\vw^*\right) \right)
    + B \norm{ \nabla \mathcal{L} }_2^2
  \end{align}
  for some positive finite constant \(A\) and \(B\).
\end{theorem}
\begin{proof}
  \begin{alignat*}{2}
    \mathcal{L}\left(w\right)
    &= \mathbb{E} f\left(\vt_{\vw}\left(\rvvu\right)\right)
    \\
    &=
    \frac{1}{2} {\left(\vm - \vmu\right)}^{\top} \mSigma^{-1} \left(\vm - \vmu\right) + \frac{1}{2} \mathrm{tr}\left(\mSigma \mC \mC^{\top} \right)
  \end{alignat*}
  Clearly, this function is minimized with \(\vm = \vmu^*\) and \(\mC^* \mC^{* \top} = \mSigma \) such that \(\vw^* = \left(\vm^*, \mSigma^*\right)\) and \(\mathcal{L}\left(\vw^*\right) = 0\).
  Therefore, the suboptimality gap is simply
  \begin{alignat*}{2}
    \mathcal{L}\left(\vw\right) - \mathcal{L}\left(\vw^*\right)
    &=
    \mathcal{L}\left(\vw\right)
    \\
    &=
    \frac{1}{2} {\left(\vm - \vmu\right)}^{\top} \mSigma^{-1} \left(\vm - \vmu\right) + \frac{1}{2} \mathrm{tr}\left(\mSigma^{-1} \mC \mC^{\top} \right).
  \end{alignat*}
  The second moment of the \(M\)-sample gradient can be decomposed as 
  \begin{alignat*}{2}
    \mathbb{E} \norm{\vg}_2^2
    &=
    \frac{1}{M} \mathbb{E} \norm{ \nabla_{\vw} f\left( \vt_{\vw}\left(\rvvu\right) \right)  }_2^2
    + \frac{M-1}{M} \norm{ \nabla \mathcal{L} }_2^2
    \\
    &=
    \frac{1}{M} \mathbb{E} \norm{ \nabla f\left( \vt_{\vw}\left(\rvvu\right) \right)  }_2^2 \left( 1 + \norm{\rvvu}_2^2 \right)
    + \frac{M-1}{M} \norm{ \nabla \mathcal{L} }_2^2.
  \end{alignat*}
  Since the gradient of \(f\) is \(\nabla f = \mSigma^{-1} \left( \vt_{\vw}\left(\rvvu\right) - \vmu \right)\), 
  \begin{alignat*}{2}
    &\mathbb{E}\norm{ \nabla f\left( \vt_{\vw}\left(\rvvu\right) \right) }_2^2 \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\;=
    \mathbb{E}
    \norm{
      \mSigma^{-1} \left( \vt_{\vw}\left(\rvvu\right) - \vmu \right)
    }_2^2 \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\;=
    \mathbb{E}
    {\vt_{\vw}\left(\rvvu\right)}^{\top} \mSigma^{-1} \vt_{\vw}\left(\rvvu\right)
    \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\quad -
    2 
    {\vmu}^{\top} \mSigma^{-1} \mathbb{E} \vt_{\vw}\left(\rvvu\right)
    \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\quad +
    \vmu^{\top} \mSigma^{-1} \vmu \,
    \mathbb{E} \left( 1 + \norm{\rvvu}_2^2 \right)
  \end{alignat*}

  \begin{alignat*}{2}
    &\mathbb{E}{\vt_{\vw}\left(\rvvu\right)}^{\top} \mSigma^{-1} \vt_{\vw}\left(\rvvu\right)
    \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\;=
    \mathbb{E}{\left( \mC + \vm \right)}^{\top} \mSigma^{-1} {\left( \mC + \vm \right)}
    \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\;=
    \mathbb{E}\rvvu^{\top} \mC^{\top} \mSigma^{-1} \mC \rvvu  \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\quad+ \mathbb{E}2 \, \vm^{\top} \mSigma^{-1} \rvvu \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\quad+ \mathbb{E}\vm^{\top} \mSigma^{-1} \vm \left( 1 + \norm{\rvvu}_2^2 \right)
  \end{alignat*}

  \begin{alignat*}{2}
    \mathbb{E} \vt_{\vw}\left(\rvvu\right)
    \left( 1 + \norm{\rvvu}_2^2 \right)
    &=
    \mathbb{E}\left( \mC \rvvu + \vm \right) \left(1 + \norm{\rvvu}^2_2\right)
    \\
    &=
    \left( \mC \mathbb{E} \rvvu \left(1 + \norm{\rvvu}^2_2\right) \right) + \vm \mathbb{E} \left(1 + \norm{\rvvu}^2_2\right) 
    \\
    &=
    \left( \mC \, \mathbf{1} \mathbb{E}\rvu^3 \right) + \left(d + 1\right) \vm  
    \\
    &=
    \left(d + 1\right) \vm  
  \end{alignat*}

  \begin{alignat*}{2}
    &
    \mathbb{E} \mathrm{tr}\left( \rvvu^{\top} \mC^{\top} \mSigma^{-1} \mC \rvvu \left( 1 + \norm{\rvvu}_2^2 \right) \right)  
    \\
    &\;=
    \mathbb{E} \mathrm{tr}\left( \rvvu^{\top} \mC^{\top} \mSigma^{-1} \mC \rvvu \left( 1 + \norm{\rvvu}_2^2 \right) \right)  
    \\
    &\;=
    \mathbb{E} \mathrm{tr}\left( \mC^{\top} \mSigma^{-1} \mC \rvvu \rvvu^{\top}  \right)  
    +  \mathbb{E} \mathrm{tr}\left( \mC^{\top} \mSigma^{-1} \mC \rvvu \rvvu^{\top} \rvvu \rvvu^{\top}  \right)
    \\
    &\;=
    \mathbb{E} \mathrm{tr}\left( \mC^{\top} \mSigma^{-1} \mC \rvvu \rvvu^{\top} \right)  
    +  \mathbb{E} \mathrm{tr}\left( \mC^{\top} \mSigma^{-1} \mC \rvvu \rvvu^{\top} \rvvu \rvvu^{\top}  \right)
    \\
    &\;=
    \mathrm{tr}\left( \mC^{\top} \mSigma^{-1} \mC \mathbb{E} \rvvu \rvvu^{\top} \right)  
    + \mathrm{tr}\left( \mC^{\top} \mSigma^{-1} \mC \, \mathbb{E} \rvvu \rvvu^{\top} \rvvu \rvvu^{\top}  \right)
    \\
    &\;=
    \mathrm{tr}\left( \mC^{\top} \mSigma^{-1} \mC \mI \right)  
    + \mathrm{tr}\left( \mC^{\top} \mSigma^{-1} \mC \left(\left(d-1\right) {\left(\mathbb{E} \rvu^2\right)}^2 + \mathbb{E}\rvu^4 \right)  \right)
    \\
    &\;=
    \mathrm{tr}\left( \mC^{\top} \mSigma^{-1} \mC\right)  
    + \left(\left(d-1\right) {\left(\mathbb{E} \rvu^2\right)}^2 + \mathbb{E}\rvu^4 \right) \mathrm{tr}\left( \mC^{\top} \mSigma^{-1} \mC   \right)
    \\
    &\;=
    \mathrm{tr}\left( \mC^{\top} \mSigma^{-1} \mC\right) 
    + \left(\left(d-1\right) + \kappa \right) \mathrm{tr}\left( \mC^{\top} \mSigma^{-1} \mC   \right)
    \\
    &\;=
    \left(d + \kappa \right) \mathrm{tr}\left( \mSigma^{-1} \mC \mC^{\top} \right)
  \end{alignat*}

  \begin{alignat*}{2}
    \mathbb{E}\vm^{\top} \mSigma^{-1} \rvvu \left( 1 + \norm{\rvvu}_2^2 \right)
    =
    \vm^{\top} \mSigma^{-1} \mathbf{1} \, \mathbb{E} \rvu^3 
    = 0
  \end{alignat*}

  Combining all this,
  \begin{alignat*}{2}
    &\mathbb{E}
    {\vt_{\vw}\left(\rvvu\right)}^{\top} \mSigma^{-1} \vt_{\vw}\left(\rvvu\right)
    \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\;=
    \mathbb{E}\rvvu^{\top} \mC^{\top} \mSigma^{-1} \mC \rvvu  \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\quad+ \mathbb{E}2 \, \vm^{\top} \mSigma^{-1} \rvvu \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\quad+ \mathbb{E}\vm^{\top} \mSigma^{-1} \vm \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\;=
    \left(d + \kappa \right) \mathrm{tr}\left( \mSigma^{-1} \mC \mC^{\top} \right)
    +
    \left( d + 1 \right) \vm^{\top} \mSigma^{-1} \vm.
  \end{alignat*}

  \begin{alignat*}{2}
    \mathbb{E}\vm^{\top} \mSigma^{-1} \vm \left( 1 + \norm{\rvvu}_2^2 \right)
    = \left( d + 1 \right) \vm^{\top} \mSigma^{-1} \vm
  \end{alignat*}

  \begin{alignat*}{2}
    &\mathbb{E}\norm{ \nabla f\left( \vt_{\vw}\left(\rvvu\right) \right) }_2^2 \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\;=
    \mathbb{E}
    {\vt_{\vw}\left(\rvvu\right)}^{\top} \mSigma^{-1} \vt_{\vw}\left(\rvvu\right)
    \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\quad -
    2 
    {\vmu}^{\top} \mSigma^{-1} \mathbb{E} \vt_{\vw}\left(\rvvu\right)
    \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\quad +
    \vmu^{\top} \mSigma^{-1} \vmu \,
    \mathbb{E} \left( 1 + \norm{\rvvu}_2^2 \right)
    \\
    &\;=
    \left(d + \kappa \right) \mathrm{tr}\left( \mSigma^{-1} \mC \mC^{\top} \right)
    +
    \left( d + 1 \right) \vm^{\top} \mSigma^{-1} \vm
    \\
    &\quad -
    \left(d + 1\right) 2 
    {\vmu}^{\top} \mSigma^{-1}  \vm 
    \\
    &\quad +
    \left(d + 1\right) \vmu^{\top} \mSigma^{-1} \vmu \,
    \\
    &\;\geq
    \left(d + 1 \right) \mathrm{tr}\left( \mSigma^{-1} \mC \mC^{\top} \right)
    +
    \left( d + 1 \right) \vm^{\top} \mSigma^{-1} \vm
    \\
    &\quad -
    \left(d + 1\right) 2 
    {\vmu}^{\top} \mSigma^{-1}  \vm 
    \\
    &\quad +
    \left(d + 1\right) \vmu^{\top} \mSigma^{-1} \vmu \,
    \\
    &\;=
    \left(d + 1 \right)
    \left(
    \mathrm{tr}\left( \mSigma^{-1} \mC \mC^{\top} \right)
    +
    \vm^{\top} \mSigma^{-1} \vm
    -
    2 {\vmu}^{\top} \mSigma^{-1}  \vm 
    +
    \vmu^{\top} \mSigma^{-1} \vmu
    \right)
    \\
    &\;=
    \left(d + 1 \right)
    \left(
    \mathrm{tr}\left( \mSigma^{-1} \mC \mC^{\top} \right)
    +
    {\left(\vm - \vmu\right)}^{\top} \mSigma^{-1} \left(\vm - \vmu\right)
    \right)
    \\
    &\;=
    2 \left( d + 1 \right) \left( \mathcal{L}\left(\vw\right) - \mathcal{L}\left(\vw^*\right) \right).
  \end{alignat*}

  \begin{alignat*}{2}
    \mathbb{E}\norm{\vg}_2^2
    &=
    \frac{1}{M} \mathbb{E} \norm{ \nabla f\left( \vt_{\vw}\left(\rvvu\right) \right)  }_2^2 \left( 1 + \norm{\rvvu}_2^2 \right)
    + \frac{M-1}{M} \norm{ \nabla \mathcal{L} }_2^2
    \\
    &\;\geq
    2 \left( d + 1 \right) \left( \mathcal{L}\left(\vw\right) - \mathcal{L}\left(\vw^*\right) \right)
    + \frac{M-1}{M} \norm{ \nabla \mathcal{L} }_2^2,
  \end{alignat*}
  where the statement follows from \(A = d + 1\) and \(B = \left(M-1\right)/M\).

\end{proof}

%%% Local Variables:
%%% TeX-master: "master"
%%% End:


\begin{theoremEnd}[\theoremproofoption,category=upperboundtheoremboundedentropy]{theorem}\label{thm:gradient_upper_bound_bounded_entropy}
  Let \(\rvvg_{M}\) be an \(M\)-sample estimator of the gradient of the ELBO in entropy-regularized form (\cref{def:entropy_form}). 
  Also, assume that
%
  \begin{itemize}[leftmargin=3em]
    \vspace{-1.5ex}
    \setlength\itemsep{0ex}
    \item \(f_{\mathrm{H}}\) is \(L_{\mathrm{H}}\)-smooth,
    \item \(f_{\mathrm{H}}\) is \(\mu_{\mathrm{H}}\)-quadratically growing,
    \item \(h_{\mathrm{H}}\) is bounded as \(h_{\mathrm{H}}\left(\vlambda\right) > h_{\mathrm{H}}^*\) (\cref{assumption:bounded_entropy}),
      \vspace{-1.5ex}
  \end{itemize}
  %
  and~\cref{assumption:q,assumption:phi_lipschitz} hold.
  Then, the gradient variance of \(\vg_{M}\) is bounded above as
  {%
  \setlength{\belowdisplayskip}{1.ex} \setlength{\belowdisplayshortskip}{1.ex}%
  \setlength{\abovedisplayskip}{1.ex} \setlength{\abovedisplayshortskip}{1.ex}%
  \begin{align*}
    \mathbb{E}\norm{\rvvg_{M}}_2^2
    &\leq
    \frac{2 L^2_{\mathrm{H}}}{\mu_{\mathrm{H}} M} C\left(d, \kappa\right) \left( F\left(\vlambda\right) - F^* \right)
    + \norm{ \nabla F\left(\vlambda\right) }_2^2
    \qquad\qquad
    \\
    &\quad+ \frac{2 L^2_{\mathrm{H}}}{\mu_{\mathrm{H}} M} C\left(d, \kappa\right) \left( F^* - f_{\mathrm{H}}^* - h^*_{\mathrm{H}} \right),
  \end{align*}
  }
  where
  {%
  \setlength{\belowdisplayskip}{1.ex} \setlength{\belowdisplayshortskip}{1.ex}%
  \setlength{\abovedisplayskip}{1.ex} \setlength{\abovedisplayshortskip}{1.ex}%
  \begin{alignat*}{2}
    C\left(d, \kappa\right) &= 2 \kappa \sqrt{d} + 1 &&\;\text{for mean-field,} \\
    C\left(d, \kappa\right) &= d + \kappa          &&\;\text{for the Cholesky parameterization,}
  \end{alignat*}
  }
  \(F^* = \inf_{\vlambda \in \mathbb{R}^p} F\left(\vlambda\right)\), and \(f_{\mathrm{H}}^* = \inf_{\vzeta \in \mathbb{R}^d} f\left(\zeta\right)\).
\end{theoremEnd}
\vspace{-2ex}
\begin{proofsketch}
   Instead of using \cref{eq:thm_upper_bound_parallel}, we apply the quadratic assumption directly to \(f_{\text{H}}\).
   The remaining entropic-regularizer term can now be bounded through the bounded entropy assumption.
\end{proofsketch}
\vspace{-2ex}
\begin{proofEnd}
  The proof is similar to that of \cref{thm:gradient_upper_bound}.
  As mentioned in the \textit{proof sketch}, we use the fact that the entropic regularizer is bounded such that
  \[ -h_{\mathrm{H}}\left(\vlambda\right) < -h_{\mathrm{H}}^*. \]
  By applying the quadratic growth assumption directly to \(f_{\mathrm{H}}\), 
  \begin{alignat}{2}
    \mathbb{E} {\lVert \vt_{\vlambda}\left(\rvvu\right) - \bar{\vzeta}_{\text{H}} \rVert}_2^2
    &\leq
    \frac{2}{\mu_{\mathrm{H}}} \left( \mathbb{E} f_{\text{H}}\left(\vt_{\vlambda}\left(\rvvu\right)\right) - f^*_{\text{H}} \right)
    \nonumber
    \\
    &=
    \frac{2}{\mu_{\mathrm{H}}} 
    \left( F\left(\vlambda\right) - h_{\mathrm{H}}\left(\vlambda\right) - f^*_{\text{H}} \right),
    \nonumber
\shortintertext{and by \cref{assumption:bounded_entropy},}
    &\leq
    \frac{2}{\mu_{\mathrm{H}}} 
    \left( F\left(\vlambda\right) - F^* \right) 
    + \frac{2}{\mu_{\mathrm{H}}} \left( F^* - f^*_{\text{H}} - h_{\mathrm{H}}^*\right).
    \label{eq:thm_upper_bound_f_H_quadratic}
  \end{alignat}
  
  The proof resumes from \cref{eq:thm1_parameter_suboptimality_unified} as
  {%
  \setlength{\belowdisplayskip}{1.ex} \setlength{\belowdisplayshortskip}{1.ex}%
  \setlength{\abovedisplayskip}{1.ex} \setlength{\abovedisplayshortskip}{1.ex}%
  \begin{alignat}{2}
    &\mathbb{E}\norm{\nabla_{\vlambda} f_{\mathrm{H}}\left(\vt_{\vlambda}\left(\rvvu\right)\right)}_2^2
    \nonumber
    \\
    &\;\leq
    L^2_{\mathrm{H}} C\left(d, \kappa\right) \mathbb{E} {\Vert \vt_{\vlambda}\left(\rvvu\right) - \bar{\vzeta}_{\mathrm{H}} \rVert}_2^2,
    \nonumber
\shortintertext{and by applying \cref{eq:thm_upper_bound_f_H_quadratic},}
    &\;=
    \frac{2 L^2_{\mathrm{H}} }{\mu_{\mathrm{H}}} C\left(d, \kappa\right) \left( F\left(\vlambda\right) - F^*  \right) 
    + \frac{2 L^2_{\mathrm{H}} }{\mu_{\mathrm{H}}} C\left(d, \kappa\right)
    \left(
      F^* - f^*_{\mathrm{H}} - h_{\mathrm{H}}^*
    \right).
    \nonumber
  \end{alignat}
  }%
  Plugging this to \cref{thm:gradient_variance_general_upper_bound} proves the result.
\end{proofEnd}

%%% Local Variables:
%%% TeX-master: "main"
%%% End:

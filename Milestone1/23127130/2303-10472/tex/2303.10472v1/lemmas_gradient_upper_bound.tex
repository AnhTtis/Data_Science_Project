
\begin{theoremEnd}[\lemmaproofoption, category=upperboundlemma]{lemma}\label{thm:reparam_quadratic}
  Let \(\vt_{\vlambda}: \mathbb{R}^d \rightarrow \mathbb{R}^d\) be a location-scale reparameterizaiton function (\cref{def:reparam}).
  Also, let \(\vz \in \mathbb{R}^d\) be some vector, and let \(\rvvu \sim \varphi\) satisfy~\cref{assumption:symmetric_standard}.
  Then,
  \begin{alignat*}{2}
    \mathbb{E}\norm{\vt_{\vlambda}\left(\rvvu\right) - \vz}_2^2
    &=
    \norm{\vm - \vz}^2_2 + \norm{\mC}_{\mathrm{F}}^2.
  \end{alignat*}
\end{theoremEnd}
\begin{proofEnd}
  \begin{alignat}{2}
    \mathbb{E}\norm{ \vt_{\vlambda}\left(\rvvu\right) - \vz }_2^2
    &=
    \mathbb{E}\norm{ \mC \rvvu + \vm - \vz }_2^2
    \nonumber
    \\
    &=
    \mathbb{E} \rvvu^{\top} \mC^{\top} \mC \rvvu + 2\,\mathbb{E} \rvvu^{\top} \mC^{\top} \vm - 2\,\mathbb{E} \rvvu^{\top} \mC^{\top} \vz
    \nonumber
    \\
    &\;\quad + \vm^{\top} \vm - 2\,\vm^{\top} \vz + \vz^{\top} \vz.
    \label{eq:reparam_quadratic_eq1}
  \end{alignat}
  The first three terms follow as
  \begin{alignat*}{2}
    &\mathbb{E} \rvvu^{\top} \mC^{\top} \mC \rvvu + 2\,\mathbb{E} \rvvu^{\top} \mC^{\top} \vm - 2\,\mathbb{E} \rvvu^{\top} \mC^{\top} \vz
    \\
    &\;=
    \mathbb{E} \mathrm{tr}\left(\rvvu^{\top} \mC^{\top} \mC \rvvu\right) + 2\,\mathbb{E} \rvvu^{\top} \mC^{\top} \vm -  2\,\mathbb{E} \rvvu^{\top} \mC^{\top} \vz
    \\
    &\;=
    \mathrm{tr}\left( \mC^{\top} \mC \mathbb{E} \rvvu \rvvu^{\top}\right) + 2\,\mathbb{E} \rvvu^{\top} \mC^{\top} \vm -  2\,\mathbb{E} \rvvu^{\top} \mC^{\top} \vz,
\shortintertext{applying \cref{thm:u_identities},}
    &\;=
    \mathrm{tr}\left( \mC^{\top} \mC \right)
    \\
    &\;=
    \norm{ \mC }_{\mathrm{F}}^2.
  \end{alignat*}
  Applying this to \cref{eq:reparam_quadratic_eq1},
  \begin{alignat*}{2}
    \mathbb{E}\norm{\vt_{\vlambda}\left(\rvvu\right) - \vz}_2^2
    &=
    \vm^{\top} \vm - 2\,\vm^{\top} \vz + \vz^{\top} \vz + \norm{\mC}_{\mathrm{F}}^2
    \\
    &=
    \norm{\vm - \vz}^2_2 + \norm{\mC}_{\mathrm{F}}^2.
  \end{alignat*}
\end{proofEnd}

% \begin{theoremEnd}[\lemmaproofoption, category=upperboundlemma]{lemma}\label{thm:tspace_distance}
%   Let \(\vt_{\vlambda}: \mathbb{R}^d \rightarrow \mathbb{R}^d\) be defined as in \cref{def:reparam} with parameters \(\vlambda = \left(\vm, \mC\right)\) such that \(\vm \in \mathbb{R}^d\) and \(\mC \in \mathbb{R}^{d \times d}\).
%   Also, let \(\rvvu \sim \varphi\) be some vector-valued random variable, where \(\varphi\) is defined as in \cref{assumption:symmetric_standard}.
%   Then,
%   \begin{alignat*}{2}
%     \mathbb{E}\norm{\vt_{\vlambda}\left(\rvvu\right) - \vt_{\vlambda^{\prime}}\left(\rvvu\right)}_2^2
%     &=
%     \norm{\vm - \vm^{\prime}}^2_2 + \norm{\mC - \mC^{\prime}}_{\mathrm{F}}^2.
%   \end{alignat*}
% \end{theoremEnd}
% \begin{proofEnd}
%   \begin{alignat}{2}
%     \mathbb{E}\norm{ \vt_{\vlambda}\left(\rvvu\right) - \vt_{\vlambda^{\prime}}\left(\rvvu\right) }_2^2
%     &=
%     \mathbb{E}\norm{ \left(\mC\rvvu + \vm\right) - \left( \mC^{\prime}\rvvu + \vm^{\prime} \right)  }_2^2
%     \nonumber
%     \\
%     &=
%     \mathbb{E}\norm{ \left(\mC - \mC^{\prime}\right)\rvvu + \left(\vm - \vm^{\prime}\right) }_2^2
%     \nonumber
%     \\
%     &=
%     \mathbb{E}\rvvu^{\top} {\left(\mC - \mC^{\prime}\right)}^{\top} \left(\mC - \mC^{\prime}\right)\rvvu
%     \nonumber
%     \\
%     &\;\quad+ 2 \mathbb{E} \rvvu^{\top} {\left(\mC - \mC^{\prime}\right)}^{\top} {\left(\vm - \vm^{\prime}\right)}
%     \nonumber
%     \\
%     &\;\quad+ {\left(\vm - \vm\right)}^{\top} \left(\vm - \vm^{\prime}\right),
%     \nonumber
% \shortintertext{invoking the trace trick,}
%     &=
%     \mathbb{E} \mathrm{tr}\left( \rvvu^{\top} {\left(\mC - \mC^{\prime}\right)}^{\top} \left(\mC - \mC^{\prime}\right)\rvvu \right)
%     \nonumber
%     \\
%     &\;\quad+ 2 \mathbb{E} \rvvu^{\top} {\left(\mC - \mC^{\prime}\right)}^{\top} {\left(\vm - \vm^{\prime}\right)}
%     \nonumber
%     \\
%     &\;\quad+ {\left(\vm - \vm^{\prime}\right)}^{\top} \left(\vm - \vm^{\prime}\right),
%     \nonumber
% \shortintertext{using the cyclic property of the trace,}
%     &=
%     \mathrm{tr}\left( {\left(\mC - \mC^{\prime}\right)}^{\top} \left(\mC - \mC^{\prime}\right) \mathbb{E} \rvvu \rvvu^{\top}  \right)
%     \nonumber
%     \\
%     &\;\quad+ 2 \mathbb{E} \rvvu^{\top} {\left(\mC - \mC^{\prime}\right)}^{\top} {\left(\vm - \vm\right)}
%     \nonumber
%     \\
%     &\;\quad+ {\left(\vm - \vm^{\prime}\right)}^{\top} \left(\vm - \vm^{\prime}\right),
%     \nonumber
% \shortintertext{and applying \cref{thm:u_identities},}
%     &=
%     \mathrm{tr}\left( {\left(\mC - \mC^{\prime}\right)}^{\top} \left(\mC - \mC^{\prime}\right) \right)
%     \nonumber
%     \\
%     &\;\quad+ {\left(\vm - \vm^{\prime}\right)}^{\top} \left(\vm - \vm^{\prime}\right)
%     \nonumber
%     \\
%     &=
%     \norm{ \mC - \mC^{\prime} }_{\mathrm{F}}^2
%     + \norm{ \vm - \vm^{\prime} }_2^2.
%     \nonumber
%   \end{alignat}
% \end{proofEnd}

%% \begin{theoremEnd}[\lemmaproofoption, category=upperboundlemma]{lemma}\label{thm:tspace_lambdaspace}
%%   If \(\phi : \mathbb{R} \mapsto \mathbb{R}_+\) is a \(1\)-Lipschitz continuous strictly positive function, 
%%   \begin{align*}
%%     \norm{ \vm - \vm^{\prime} }_{2}^2 + \norm{ \mC - \mC^{\prime} }_{\mathrm{F}}^2
%%     \leq
%%     \norm{ \vlambda - \vlambda^{\prime} }_2^2
%%   \end{align*}
%%   holds for both the mean-field (\cref{def:meanfield}) and Cholesky parameterizations (\cref{def:fullrank}),
%% \end{theoremEnd}
%% \begin{proofEnd}
%%   The first term satisfies \(\norm{ \vm - \vm^{\prime} }_{2}^2 = \norm{\vlambda_{\vm} - \vlambda_{\vm^{\prime}}}_2^2\)  by definition.
%%   Therefore, we only need to prove the inequality for the scale term.

%%   First, for the Cholesky (\cref{def:fullrank}),
%%   \begin{align*}
%%     \norm{ \mC - \mC^{\prime} }_{\mathrm{F}}^2
%%     &=
%%     \underbrace{
%%       \norm{ \phi\left(\vs\right) - \phi\left(\vs^{\prime}\right) }_{\mathrm{F}}^2
%%     }_{\text{diagonal of \(\mC,\mC^{\prime}\)}}
%%     +
%%     \underbrace{
%%       \norm{ \mL - \mL^{\prime} }_{\mathrm{F}}^2
%%     }_{\text{off-diagonal of \(\mC,\mC^{\prime}\)}}
%%     \\
%%     &=
%%     \sum^{d}_{i=1} \abs{ \phi\left(s_i\right) - \phi\left(s_i^{\prime}\right) }^2
%%     +
%%     \norm{ \mL - \mL^{\prime} }_{\mathrm{F}}^2,
%% \shortintertext{and by applying 1-Lipschitzness of \(\phi\),}
%%     &\leq
%%     \sum^{d}_{i=1} \abs{ s_i - s_i^{\prime} }^2
%%     +
%%     \norm{ \mL - \mL^{\prime} }_{\mathrm{F}}^2
%%     \\
%%     &=
%%     \norm{ \vs - \vs^{\prime} }_2^2
%%     +
%%     \norm{ \mL - \mL^{\prime} }_{\mathrm{F}}^2.
%%   \end{align*}
%%   Finally,
%%   \begin{align*}
%%     &\norm{ \vm - \vm^{\prime} }_{2}^2 + \norm{ \mC - \mC^{\prime} }_{\mathrm{F}}^2
%%     \\
%%     &\;\leq
%%     \norm{ \vm - \vm^{\prime} }_{2}^2
%%     +
%%     \norm{ \vs - \vs^{\prime} }_2^2
%%     +
%%     \norm{ \mL - \mL^{\prime} }_{\mathrm{F}}^2.
%%     \\
%%     &\;=
%%     \norm{ \vlambda - \vlambda^{\prime} }_2^2.
%%   \end{align*}
%%   The same proof holds for the mean-field case (\cref{def:meanfield}) by neglecting the off-diagonal (\(\mL\)) terms.
%% \end{proofEnd}

%% \begin{theoremEnd}[\keylemmaproofoption, category=upperboundkeylemma]{lemma}\label{thm:reparam_quadratic}
%%   \begin{alignat*}{2}
%%     \mathbb{E}\norm{\nabla f\left(\vt_{\vlambda}\left(\rvvu\right)\right)}_2^2 \left(1 + \norm{\rvvu}_2^2 \right)
%%     \leq
%%     \frac{2\,L^2 }{\mu} \left(d + \kappa\right) \left(  \mathbb{E}f\left(\vt_{\vlambda}\left(\rvvu\right)\right) - f^* \right)
%%   \end{alignat*}
%% \end{theoremEnd}
%% \begin{proofEnd}
%%   \begin{alignat}{2}
%%     &\mathbb{E}\norm{\nabla f\left(\vt_{\vlambda}\left(\rvvu\right)\right)}_2^2 \left(1 + \norm{\rvvu}_2^2 \right)
%%     \nonumber
%%     \\
%%     &\;=
%%     L^2\left(\left(d + 1\right) \norm{\vm - \bar{\vz}}_2^2 + \left(d + \kappa\right) \norm{\mC}_{\mathrm{F}}^2 \right)
%%     \nonumber
%% \shortintertext{since the kurtosis satisfies \(\kappa \geq 1\),}
%%     &\;\leq
%%     L^2\left(d + \kappa\right) \left( \norm{\vm - \bar{\vz}}_2^2 + \norm{\mC}_{\mathrm{F}}^2 \right),
%%     \nonumber
%% \shortintertext{by \cref{thm:reparam_quadratic},}
%%     &\;=
%%     L^2 \left(d + \kappa\right) \mathbb{E} \norm{\vt_{\vlambda}\left(\rvvu\right) - \bar{\vz} }_2^2,
%%     \nonumber
%% \shortintertext{assuming \(f\) satisfies \cref{assumption:quadratic_growth},}
%%     &\;\leq
%%     \frac{2\,L^2 }{\mu} \left(d + \kappa\right) \left(  \mathbb{E}f\left(\vt_{\vlambda}\left(\rvvu\right)\right) - f^* \right).
%%     \nonumber
%%   \end{alignat}
%% \end{proofEnd}

%%% Local Variables:
%%% TeX-master: "main"
%%% End:

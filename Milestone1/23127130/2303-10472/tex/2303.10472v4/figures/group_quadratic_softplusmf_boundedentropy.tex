
% Tikz examples & demos
% https://holatex.app/examples.html?package=tikz

  \nextgroupplot[
      %% legend style={
      %%   legend image post style={scale=0.5},
      %%   at={(0.5,1.5)},
      %%   anchor=north,
      %%   legend cell align=left,
      %%   line width=0.8pt,
      %%   %draw=none % Unterdr√ºcke Box
      %% },
      %
      tuftelike, 
      axis line style = thick,
      every tick/.style={black,thick},
      %axis lines = left,
      %grids=both,
      ymode  = log,
      xmin   = 1,
      xmax   = 1000,
      xtick  = {1, 200, 400, 600, 800, 1000},
      ytick  = {1e+3, 1e+4, 1e+5, 1e+6, 1e+7, 1e+8},
      %
      xlabel style={yshift=-0.8ex},
      %
      ymin   = 1e+3,
      ymax   = 1e+8,
      %
      xlabel = {Iteration},
      %ylabel = {\(\mathbb{E}\norm{\rvvg}^2_2\)},
      tick label style={font=\small},  
      height = 4cm,
      width  = 4.7cm,
      axis on top,
    ]
    \addplot[name path=gvar, color1, mark=none, thick]
      table [x=t, y=gvar] {data/simulation/quadratic_softplusmf_boundedentropybound.csv}
      %node[above=3pt,pos=0.8] {\scriptsize\(\mu_{\mathrm{KL}}, L_{\mathrm{H}}\) bound}
      coordinate [pos=0.95] (gvarcoord);
    %\addlegendentry{\scriptsize\( \mathbb{E}\norm{ \rvvg }_2^2 \)}

    \addplot[name path=opt, color3, mark=none, thick] %
      table [x=t, y=opt] {data/simulation/quadratic_softplusmf_boundedentropybound.csv} %
      %node[above=3pt,pos=0.8] {\scriptsize\(\DKL{q_{\vlambda}}{p}\)}
      coordinate [pos=0.95] (optcoord);
    %\addlegendentry{\scriptsize\(2 A \left(\mathbb{E}_{q_{\vlambda}} f_{\mathrm{H}} - f^*_{\mathrm{H}}\right)\)}

    \addplot[name path=ABC, color2, mark=none, thick]
      table [x=t, y=ABC] {data/simulation/quadratic_softplusmf_boundedentropybound.csv}
      coordinate [pos=0.05] (ABCcoord1) coordinate [pos=0.95] (ABCcoord2);
    %\addlegendentry{\scriptsize\(2 A \left(F\left(\vlambda\right) - F^*\right) + B \norm{\nabla F}_2^2 + C\)}

    \addplot[name path=axis, domain=0:990, fill=none, no markers, draw=none] {1e+3}
      coordinate [pos=0.05] (axiscoord);

    %\addplot[name path=ABC, color2, mark=none]
    %  table [x=t, y=ABC] {data/simulation/quadratic_softpluschol_boundedentropybound.csv}
    %  ;

    \addplot[name path=C, fill=none, gray, mark=none]
      table [x=t, y=C] {data/simulation/quadratic_softplusmf_boundedentropybound.csv}
      coordinate [pos=0.05] (Ccoord);

    \addplot[thick, color=color3, fill=color3, fill opacity=0.2] fill between[of=ABC and opt];
    \addplot[thick, color=color2, fill=color2, fill opacity=0.2] fill between[of=ABC and   C];

    \addplot[thick, color=color1, fill=color1, fill opacity=0.2] fill between[of=opt and gvar];
    \addplot[thick, color=gray,   fill=gray,   fill opacity=0.2] fill between[of=C   and axis];

    \draw[thick,color=color3,{Latex[scale=0.5]}-{Latex[scale=0.5]}] (ABCcoord2) -- (optcoord)
      node[midway,xshift=-18pt] {\scriptsize\(h\left(\vlambda\right) - h^*\)}
      coordinate [pos=0.5] (dklarrow_coord);

    %\draw[thick,color=color1,{Latex[scale=0.5]}-{Latex[scale=0.5]}] (gvarcoord) -- (optcoord)
      %node[midway,xshift=-25pt] {\scriptsize\(\mu_{\mathrm{KL}}, L_{\mathrm{H}}\) bound}
    %  coordinate [pos=0.5] (muL_coord);

    \draw[thick,color=gray,latex-] (Ccoord) -- (axiscoord)
      node[midway,xshift=5pt] {\scriptsize\(C\) };

    %% \node[%
    %%   pin={%
    %%     [%
    %%       pin distance=1cm,%
    %%       pin edge={color3},%
    %%       text=color3%
    %%     ]100:{\scriptsize\( h\left(\vlambda\right) - h^* \)}%
    %%   },%
    %%   inner sep=0pt,
    %% ] at (dklarrow_coord) {};

    %% \node[%
    %%   pin={%
    %%     [%
    %%       pin distance=1cm,%
    %%       pin edge={color1},%
    %%       text=color1%
    %%     ]130:{\scriptsize\(\mu_{\mathrm{H}}, L_{\mathrm{H}}\) bound}},%
    %%   inner sep=0pt,%
    %% ] at (muL_coord) {};


    %\draw[thick,color=color2,latex-latex] (ABCcoord1) -- (Ccoord)
    %  node[midway,xshift=25pt] {\scriptsize\(2 A \left( F\left(\lambda\right) - F^* \right)\) };

\section{Visualization On Demand} %Visualization Elements
\label{sec:visrisk}
Based on environment data and trajectory evaluation, we now present ways of communicating the situation and risks on a visual display to achieve an ADAS.
In this context, we employ a renderer that visualizes all the information in a joint Cartesian coordinate system (see section \ref{subsec:sim}). 
Once driving risks are detected, design elements are overlayed on the display with section \ref{subsec:active} and section \ref{subsec:warning}. 

\subsection{Simulator Environment}
\label{subsec:sim}
Nodes of the R-LDM have a range of potential attributes, such as the 3D position or geometrical shape of objects. 
% For instance, the road centerline is a polyline with bounderies to the left and right. Crosswalks have a defined width and buildings a polygonal outline description. 
In the renderer, we always visualize static and quasi-static data that lie in the field of view from the ego vehicle. 
For this, a local 3D model is generated by converting geographic points with (lat, lon, alt) into Cartesian coordinates of (x, y, z). 
% and project the positonal relations from a view perspective with a transformation matrix. 
Fig. \ref{fig:3Dsimulator} depicts an exemplary map section having several intersections in bird's-eye view.
% with several intersections, stop lines and crosswalks. 
On the top right, the first person view of a vehicle approaching a crosswalk is shown. 

The dynamic data is then added to this static view. A zoomed-in excerpt from the map is given at the bottom of Fig. \ref{fig:3Dsimulator} that includes a recorded GNSS trace (red).
We project the trace onto the connected lane center, which is pictured in green. 
% Because we project the ego position on the closest lane segment, on the bottom right the measured trace is changed in red and the aligned trace is marked in green.
Consequently, the virtual horizon and its possible paths are retrieved as described in section \ref{subsec:ldm}. 
We can lastly update and move the excerpt with the current position from the GNSS to obtain a live simulation.

\subsection{Proactive Support}
\label{subsec:active}
Communication of spatial as well as spatio-temporal relations is crucial for risk-averse driver support. 
% This has the reason that humans can estimate the time better than positions (especially for risks). 
% Velocity contains implicitly the time as well. 
Further sources of information are cause, likelihood and severity of a potential risks.  
% if a collision happens. 
The next step for RNS is the choice of suitable design elements. 
In this process, we suppose that we know where the ego vehicle is driving (i.e., the ego path) from its navigation route. 
Yet, for surrounding vehicles, all paths are considered.

\subsubsection{Hazard Route Element}
The so-called hazard route in Fig. \ref{fig:charts} is a concept that consists of a scale portraying distances to an upcoming risk element.
Furthermore, the geometrical area or length of risks is considered.
Risk is thus measured with respect to the ego path, ranging from the current position  $\Delta l \hspace{-0.03cm}=\hspace{-0.03cm} \unit[0]{m}$ to the end of the path $\Delta l_{h}$.
Here, the length $\Delta l_{h}$ can be chosen according to own preferences. 

At an upcoming intersection, risk is defined by the section of the path that lies within the junction.
Since risk corresponds to exposition time, we encode the path part from the intersection $I_z$ with a color, ranging from green for short intersections to red for long ones. 
%allgemein risiko entlang des pfades zu intersection zone
%share of junction segment to navigation route + 
%one case with large intersection far and one case with small intersection close
Fig. \ref{fig:charts}~a) gives two examples of the hazard route.
The left bar shows a large intersection (e.g. multi-lane four-way stop) in vicinity and the right bar has a small and consecutive medium junction. 
% In the case of collision risk, the intersection zone $I_z$ can be used.
% Depending on the value of $I_z$ (low, medium and large), the area is marked from green, to yellow until red for conveying the criticality. 
This emphasizes that we may include more than one intersection in our warnings.

\begin{figure}[t]
  \centering
  \includegraphics[width=0.95\linewidth]{./img/simulator.png}
  \caption{Rendered road network from two perspectives with the ego position being projected on the navigation route. \vspace{0.45cm}}
  \label{fig:3Dsimulator}
\end{figure}

\begin{figure}[t]
  \centering
  \resizebox{\linewidth}{!}{
  \import{img/}{velocity_scale_new.pdf_tex}}  
  \caption{Chart elements for proactive support. Hazard route (left) and velocity scale (right).} %\vspace{-0.3cm}}
  \label{fig:charts} 
\end{figure} 

\subsubsection{Velocity Scale Element}
The velocity scale, Fig. \ref{fig:charts}~b), is a second chart element which qualifies the difference between the current velocity of the vehicle $v_0$ and the target velocity $v_{\text{tar}}$ from the trajectory evaluation of section \ref{subsec:trajeval}. 
The scale shows possible velocity values, from standstill $v\hspace{-0.05cm}=\hspace{-0.05cm}\unit[0]{m/s}$ to a maximal velocity $v_{\text{max}}$. Depending on the difference $|v_0 \hspace{0.05cm} - \hspace{0.05cm} v_{\text{tar}}|$, the situation is rated as safe with $v_0 \hspace{-0.042cm} \approx \hspace{-0.042cm} v_{\text{tar}}$ (green, left), as dangerous with e.g. $v_0 \hspace{-0.05cm} < \hspace{-0.05cm} v_{\text{tar}}$ (yellow, middle) to critical with $v_0 \hspace{-0.07cm} \ll \hspace{-0.07cm} v_{\text{tar}}$ (red, right). The same cases hold true for the opposite circumstances, i.e., $v_0 \hspace{-0.032cm} > \hspace{-0.032cm} v_{\text{tar}}$. 
This velocity scale can be employed for curve or regulatory risks. 
Moreover, we may set an enforced speed limit as the target velocity $v_{\text{tar}}$ for proactive behavior, once there is no risk ahead. 
%\noindent -Warning vs behavior support \\
%-Ghost vehicle as in game \\

\subsection{Short-Term Warning Elements}
\label{subsec:warning}
In order to emphasize the criticality of the situation, we propose to add further intuitive warning elements as e.g. pop-up signs and lane colorings. 
The following elements augment the proactive elements.

\subsubsection{Pop-up Signs}
Explicit symbols indicate the risk cause accompanied with the event time for collisions ($s_E$), distances to the risk spot for turns (i.e., right curve with $d_r$ and left curve with $d_l$) or stopping distance for crosswalks ($d_c$). In Fig. \ref{fig:popups}~a), the pop-up signs are pictured. 
% Besides the velocity difference, the risk type is an indication for the severity of the situation.
%Examples for collision risk are car-to-car crash., curve risk can be  as a single-car accident and regulatory risks will be a car-to-object collision. 
We want to stress that this is just a selection and more risk causes can be added. 
The purpose is also to clarify the reason for the warning and give more human-understandable information.

\subsubsection{Colored Events}
Finally, we highlight lane parts or positions according to the corresponding risks.  
% the determined color rating from the hazard route and velocity scale and relate the risks to the simulator environment. 
In the instance of curve and regulatory risk, the lane is colored from the ego position up to the point of maximal risk. 
For collision risk, we mark the point of the closest encounter as a red cube.
An illustration for regulatory risk induced from a stop line is depicted in Fig. \ref{fig:popups}~b). Again, the color is defined by the deviation $|v_0-v_{\text{tar}}|$. It also shows the therein considered navigation route with length $\Delta l_h$ and another unlikely path. 

It should be noted that the visualization of warnings only occurs if the risks are actually present. 
%\textcolor{red}{improve language, repeat intersection zone and navigation route}
%eingrauen unlikely paths and navigation path and describe in text, maybe delete Iz -> put line from unlikely path to green arrow
Altogether, the RNS provides a variety of tools to analyze and circumvent critical situations in intersection scenarios, while not overloading the driver's awareness.

\begin{figure}[t]
  \centering
  \resizebox{\linewidth}{!}{
  \import{img/}{colored_lane_new.pdf_tex}}  
  \vspace{-0.53cm}
  \caption{Short-term warning elements. Selected pop-up warnings (left) and colored lane (right).}
  \label{fig:popups} 
\end{figure} 


%Version 2.1 April 2023
% See section 11 of the User Manual for version history
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%
%% Please do not use \input{...} to include other tex files.       %%
%% Submit your LaTeX manuscript as one .tex document.              %%
%%                                                                 %%
%% All additional figures and files should be attached             %%
%% separately and not embedded in the \TeX\ document itself.       %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%\documentclass[referee,sn-basic]{sn-jnl}% referee option is meant for double line spacing

%%=======================================================%%
%% to print line numbers in the margin use lineno option %%
%%=======================================================%%

%%\documentclass[lineno,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style

%%======================================================%%
%% to compile with pdflatex/xelatex use pdflatex option %%
%%======================================================%%

%%\documentclass[pdflatex,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style


%%Note: the following reference styles support Namedate and Numbered referencing. By default the style follows the most common style. To switch between the options you can add or remove Numbered in the optional parenthesis. 
%%The option is available for: sn-basic.bst, sn-vancouver.bst, sn-chicago.bst, sn-mathphys.bst. %  
 
%%\documentclass[sn-nature]{sn-jnl}% Style for submissions to Nature Portfolio journals
%%\documentclass[sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style
\documentclass[sn-mathphys,Numbered]{sn-jnl}% Math and Physical Sciences Reference Style
%%\documentclass[sn-aps]{sn-jnl}% American Physical Society (APS) Reference Style
%%\documentclass[sn-vancouver,Numbered]{sn-jnl}% Vancouver Reference Style
%%\documentclass[sn-apa]{sn-jnl}% APA Reference Style 
%%\documentclass[sn-chicago]{sn-jnl}% Chicago-based Humanities Reference Style
%%\documentclass[default]{sn-jnl}% Default
%%\documentclass[default,iicol]{sn-jnl}% Default with double column layout

%%%% Standard Packages
%%<additional latex packages if required can be included here>

\usepackage{graphicx}%
\usepackage{multirow}%
\usepackage{amsmath,amssymb,amsfonts}%
\usepackage{amsthm}%
\usepackage{mathrsfs}%
\usepackage[title]{appendix}%
\usepackage{xcolor}%
\usepackage{textcomp}%
\usepackage{manyfoot}%
\usepackage{booktabs}%
\usepackage{algorithm}%
\usepackage{algorithmicx}%
\usepackage{algpseudocode}%
\usepackage{listings}%
\usepackage{physics}
\usepackage{mathtools}
\usepackage{asymptote}

\usepackage{tikz,xcolor,hyperref}

\usepackage{url}
%%%%

\definecolor{lime}{HTML}{A6CE39}
\DeclareRobustCommand{\orcidicon}{%
	\begin{tikzpicture}
	\draw[lime, fill=lime] (0,0) 
	circle [radius=0.16] 
	node[white] {{\fontfamily{qag}\selectfont \tiny ID}};
	\draw[white, fill=white] (-0.0625,0.095) 
	circle [radius=0.007];
	\end{tikzpicture}
	\hspace{-2mm}
}

\foreach \x in {A, ..., Z}{%
	\expandafter\xdef\csname orcid\x\endcsname{\noexpand\href{https://orcid.org/\csname orcidauthor\x\endcsname}{\noexpand\orcidicon}}
}

\newcommand{\orcidauthorA}{0000-0001-9230-7728}
\newcommand{\orcidauthorB}{0000-0003-4521-2130}
\newcommand{\orcidauthorC}{0000-0003-1317-5523}

\newcommand*\xoverline[2][0.75]{%
    \sbox{\myboxA}{$\m@th#2$}%
    \setbox\myboxB\null% Phantom box
    \ht\myboxB=\ht\myboxA%
    \dp\myboxB=\dp\myboxA%
    \wd\myboxB=#1\wd\myboxA% Scale phantom
    \sbox\myboxB{$\m@th\overline{\copy\myboxB}$}%  Overlined phantom
    \setlength\mylenA{\the\wd\myboxA}%   calc width diff
    \addtolength\mylenA{-\the\wd\myboxB}%
    \ifdim\wd\myboxB<\wd\myboxA%
       \rlap{\hskip 0.5\mylenA\usebox\myboxB}{\usebox\myboxA}%
    \else
        \hskip -0.5\mylenA\rlap{\usebox\myboxA}{\hskip 0.5\mylenA\usebox\myboxB}%
    \fi}
\makeatother
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\ab}{\underline{a}}
\newcommand{\ml}{\mu_l}
\newcommand{\smvee}{\raise0.4ex\hbox{$\scriptscriptstyle\vee$}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\overbar}[1]{\mkern 2mu\overline{\mkern-2mu#1\mkern-2mu}\mkern 2mu}
\newcommand{\F}{\mathbb{F}}
\newcommand{\ag}{\mathcal{A}_g}
\newcommand{\mg}{\mathcal{M}_g}
\newcommand{\OO}{\mathcal{O}}
\newcommand{\p}{\mathfrak{p}}
\newcommand{\q}{\mathfrak{q}}
\newcommand{\PP}{\mathcal{P}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\LL}{\mathcal{L}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\ewt}{\text{ewt}}
%\newcommand{\Tr}{\text{Tr}}
\newcommand{\gen}{\text{gen}}
\newcommand{\Spec}{\text{Spec}}
\newcommand{\Ab}{\underline{A}}
\newcommand{\f}{|o|}
\newcommand{\coker}{\text{coker}}
\newcommand{\V}{\vee}
\newcommand{\im}{\text{Im}}
\newcommand{\apk}{\alpha_{\p,K}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\fpb}{\overline{\mathbb{F}}_p}
\newcommand{\sigp}{\sigma_p}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Po}{\mathbb{P}^1}
\newcommand{\Pt}{\mathbb{P}^2}
\newcommand{\mb}{\overline{\M_{\mu_m}}}
%\newcommand{\mg}{\overline{\M}_g}
\newcommand{\mml}{\mathcal{M}_{\mu_l}}
\newcommand{\mmg}{\mathcal{M}_{G}}
\newcommand{\mt}{\tilde{\M_{\mu_m}}}
\newcommand{\zt}{\tilde{Z}(\gamma)}
\newcommand{\zto}{\tilde{Z^o}(\gamma)}
\newcommand{\ztone}{\tilde{Z}(\gamma_1)}
\newcommand{\zttwo}{\tilde{Z}(\gamma_2)}
\newcommand{\zb}{\Bar{Z}(\gamma)}
\newcommand{\zbo}{\overline{Z^o}(\gamma)}
\newcommand{\zboo}{\overline{Z^o}(\gamma_1)}
\newcommand{\zbot}{\overline{Z^o}(\gamma_2)}
\newcommand{\lra}{(l,r,\underline{a})}
\newcommand{\zlr}{\mathcal{M}(l,r,\underline{a})}
\newcommand{\zgr}{\mathcal{M}(G,r,\underline{a})}
\newcommand{\gra}{(G,r,\underline{a})}
\newcommand{\zso}{Z^o(\gamma_1)}
\newcommand{\zst}{Z^o(\gamma_2)}
\newcommand{\zsth}{Z^o(\gamma_3)}
\newcommand{\z}{Z(\gamma)}
\newcommand{\zo}{Z(\gamma_1)}
\newcommand{\ztwo}{Z(\gamma_2)}
\newcommand{\zp}{Z(\gamma')}
\newcommand{\zog}{Z^o(\gamma)}
\newcommand{\zogp}{Z^o(\gamma')}
\newcommand{\zi}{Z(\gamma_i)}
\newcommand{\zti}{\tilde{Z}(\gamma_i)}
\newcommand{\zbone}{\overline{Z}(\gamma_1)}
\newcommand{\zbi}{\overline{Z}(\gamma_i)}
\newcommand{\ztth}{\tilde{Z}(\gamma_3)}
\newcommand{\zbth}{\overline{Z}(\gamma_3)}
\newcommand{\shmf}{\text{Sh}(\ml,\underline{f})}
\newcommand{\shgf}{\text{Sh}(G,\underline{f})}
\newcommand{\zgth}{Z(\gamma_3)}
\newcommand{\ztil}{\tilde{Z}}
\newcommand{\zts}{\tilde{Z^o}}
\newcommand{\zbs}{\overline{Z^o}}
\newcommand{\go}{\gamma_1}
\newcommand{\gt}{\gamma_2}
\newcommand{\gth}{\gamma_3}
\newcommand{\gi}{\gamma_i}
\newcommand{\ts}{\tau^*}
\newcommand{\wt}{w_{\tau}}
\newcommand{\tp}{\tau'}
\newcommand{\wts}{w_{\tau^*}}
\newcommand{\tps}{\tau'^*}
\newcommand{\ti}{\tau_i}
\newcommand{\dr}{H^1_{dR}(A)}
%\newcommand{\cr}{H^1_{crys}(A)}
\newcommand{\eis}{\eta_{i,s}}
\newcommand{\et}{e_{\tau}}
\newcommand{\tis}{\ti^*}
\newcommand{\tet}{\tau_{e_{\tau}}}
\newcommand{\ty}{\tau_1}
\newcommand{\te}{\tau_2}
\newcommand{\psid}{\check{\psi}}
\newcommand{\phid}{\check{\phi}}
\newcommand{\qd}{\check{Q}_{\tau_1}}
\newcommand{\qpd}{\check{Q}_{p\tau_1}}
\newcommand{\mvt}{M_V^{\top}}
\newcommand{\mf}{M_F}
\newcommand{\BB}{\mathcal{B}_1}
\newcommand{\hy}{H^1(C,\OO_C)}
\newcommand{\hyd}{H^0(C,\Omega_C)}
\newcommand{\sy}{x_1+x_2+x_3}
\newcommand{\se}{x_1x_2+x_2x_3+x_1x_3}
\newcommand{\sth}{x_1x_2x_3}
\newcommand{\sfr}{x_1x_2x_3+x_1x_2x_4+x_1x_3x_4+x_2x_3x_4}
\newcommand{\pby}{\floor*{p\langle\frac{ia_1}{l}\rangle}}
\newcommand{\pbr}{\floor*{p\langle\frac{ia_r}{l}\rangle}}
\newcommand{\pbj}{\floor*{p\langle\frac{ia_j}{l}\rangle}}
\newcommand{\pbs}{\floor*{p\langle\frac{p^i\tau a_s}{l}\rangle}}
\newcommand{\pis}{\floor*{p\langle\frac{i a_s}{l}\rangle}}
\newcommand{\pbc}{\floor*{p\langle\frac{ia_c}{l}\rangle}}
\newcommand{\pbcm}{\floor*{p\langle\frac{ia_{c-1}}{l}\rangle}}
\newcommand{\pbct}{\floor*{p\langle\frac{ia_{c-2}}{l}\rangle}}
\newcommand{\pbcp}{\floor*{p\langle\frac{ia_{c+1}}{l}\rangle}}
\newcommand{\pbk}{\floor*{p\langle\frac{ia_k}{l}\rangle}}
\newcommand{\pba}{\floor*{p\langle\frac{ia_a}{l}\rangle}}
\newcommand{\pfy}{\floor*{p\frac{ia_1}{l}}}
\newcommand{\pfk}{\floor*{p\frac{ia_k}{l}}}
\newcommand{\fy}{\floor*{\frac{ia_1}{l}}}
\newcommand{\fr}{\floor*{\frac{ia_r}{l}}}
\newcommand{\fk}{\floor*{\frac{ia_k}{l}}}
\newcommand{\fky}{\floor*{\frac{ka_1}{l}}}
\newcommand{\fkr}{\floor*{\frac{ka_r}{l}}}
\newcommand{\pfr}{\floor*{p\frac{ia_r}{l}}}
\newcommand{\pfj}{\floor*{p\frac{ia_j}{l}}}
\newcommand{\pib}{p^ib}
\newcommand{\pibs}{p^ib^*}
\newcommand{\pfibs}{\floor*{p\langle\frac{p^iba_s}{l}\rangle}}
\newcommand{\pfibc}{\floor*{p\langle\frac{p^iba_c}{l}\rangle}}

\newcommand{\ci}{c_i(s_i-pj)}
\newcommand{\Ci}{C_i(s_i-pj)}
\newcommand{\XI}{X_i(s_i-pj)}
\newcommand{\fq}{r_{i,j,k}q_{r-j',k}}
\newcommand{\fkj}{r_{i,j,k}}
\newcommand{\qkj}{q_{r-j',k}}
\newcommand{\qpit}{Q_{p^i\tau}}
\newcommand{\qpip}{Q_{p^{i+1}\tau}}
\newcommand{\qpitsd}{\check{Q}_{p^i\ts}}
\newcommand{\qpiptsd}{\check{Q}_{p^{i+1}\ts}}
\newcommand{\qpitd}{\check{Q}_{p^i\tau}}
\newcommand{\qpiptd}{\check{Q}_{p^{i+1}\tau}}
\newcommand{\qi}{Q_i}
\newcommand{\qid}{Q_i^{\smvee}}
\newcommand{\qt}{Q_\tau}
\newcommand{\qtd}{Q_\tau^{\smvee}}
\newcommand{\qis}{Q_{\tau_i^*}}
\newcommand{\qisd}{Q_{i^*}^{\smvee}}
\newcommand{\qts}{Q_{\ts}}
\newcommand{\qtsd}{Q_{\ts}^{\smvee}}
\newcommand{\qpi}{Q_{pi}}
\newcommand{\qpid}{Q_{pi}^{\smvee}}
\newcommand{\qpt}{Q_{p\tau}}
\newcommand{\qptd}{Q_{p\tau}^{\smvee}}
\newcommand{\qpis}{Q_{pi^*}}
\newcommand{\qpisd}{Q_{pi^*}^{\smvee}}
\newcommand{\qpts}{Q_{p\ts}}
\newcommand{\qptsd}{Q_{p\ts}^{\smvee}}
\newcommand{\ocu}{\OO_C(U)}
\newcommand{\ocv}{\OO_C(V)}
\newcommand{\ocuv}{\OO_C(U \cap V)}
\newcommand{\zij}{\zeta_{i,j}}
\newcommand{\zpij}{\zeta_{pi,j'}}
\newcommand{\zpisk}{\zeta_{pi^*,k}}
\newcommand{\zpiskd}{\check{\zeta_{pi^*,k}}}
\newcommand{\zijd}{\check{\zeta_{i,j}}}
\newcommand{\zpijd}{\check{\zeta_{pi,j'}}}
\newcommand{\oij}{\omega_{i,j}}
\newcommand{\opij}{\omega_{pi,j}}
\newcommand{\opisjp}{\omega_{pi^*,j'}}
\newcommand{\opisk}{\omega_{pi^*,k}}
\newtheorem{innercustomthm}{Theorem}
\newcommand{\phii}{\phi_{\tau_i}}
\newcommand{\psii}{\psi_{\tau_i}}
\newcommand{\psiip}{\psi_{\tau_i}'}
\newcommand{\vi}{v_i}
\newcommand{\vip}{v_{pi}}
\newcommand{\vis}{v_{i^*}}
\newcommand{\vips}{v_{pi^*}}
\newcommand{\pbf}{(x-x_1)^{\pby} \dots (x-x_r)^{\pbr}}
\newcommand{\pff}{(x-x_1)^{\pfy} \dots (x-x_r)^{\pfr}}
\newcommand{\tot}{\tau_{\OO,2}}
\newcommand{\fpi}{f(p^i\tau)}
\newcommand{\fpim}{f(p^{i-1}\tau)}
\newcommand{\fpits}{f(p^i\ts)}
\newcommand{\fpitsp}{f(p^{i+1}\ts)}
\newcommand{\fpitsm}{f(p^{i-1}\ts)}
\newcommand{\fii}{f(i)}
\newcommand{\fis}{f(\tau_i^*)}
\newcommand{\fou}{f_{\OO,u}}
\newcommand{\foum}{f_{\OO,u-1}}
\newcommand{\ft}{f(\tau)}
\newcommand{\fts}{f(\ts)}
\newcommand{\pit}{p^i\tau}
\newcommand{\pits}{p^i\ts}
\newcommand{\shgfb}{\shgf_{\fpb}}
\newcommand{\pipt}{p^{i+1}\tau}
\newcommand{\pipts}{p^{i+1}\ts}
\newcommand{\aip}{A_{|\OO|-1}\circ \dots \circ A_{0}}
\newcommand{\goppi}{\pi_{\tau}(G_{\tau,|\OO|-1}(\dots G_{\tau,1}(G_{\tau,0}(M_{\tau}))))}
\newcommand{\gop}{G_{\tau,|\OO|-1}(\dots G_{\tau,1}(G_{\tau,0}(M_{\tau})))}
\newcommand{\gopp}{\pi_{\tau'}(G_{\tau',|\OO|-1}(\dots G_{\tau',1}(G_{\tau',0}(M_{\tau'}))))}
\newcommand{\gjp}{G_{\tau,j}(\dots G_{\tau,1}(G_{\tau,0}(M_{\tau})))}
\newcommand{\pjt}{p^j\tau}
\newcommand{\pjts}{p^j\ts}
\newcommand{\Span}{\text{Span}}
\newcommand{\mo}{|\OO|}
\newcommand{\aof}{A_{\mo-1} \circ \dots \circ A_{0}}
\newcommand{\aoi}{A_{\mo-1} \circ \dots \circ A_i}
\newcommand{\aiz}{A_{i-1} \circ \dots \circ A_0}
\newcommand{\hopf}{H_{\tp,\mo-1} \circ \dots \circ H_{\tp,0}}
\newcommand{\hoppf}{H_{\tpp,\mo-1} \circ \dots \circ H_{\tpp,0}}
%\newcommand{\hoppf}{H_{\tau'',\mo-1} \circ \dots \circ H_{\tau'',0}}
\newcommand{\hopi}{H_{\tp,\mo-1} \circ \dots \circ H_{\tp,i}}
\newcommand{\hpiz}{H_{\tp,\mo-i-1} \circ \dots \circ H_{\tp,0}}
\newcommand{\tpp}{\tau''}
\newcommand{\pip}{\pi_{\tp}}
\newcommand{\pipp}{\pi_{\tau''}}
\newcommand{\lof}{L_{\tau,\mo-1} \circ \dots \circ L_{\tau,0}}
\newcommand{\piot}{p^{i_0}\tau}
\newcommand{\ajio}{A_{j} \circ A_{j-1} \circ \dots \circ A_{i_0}}
\newcommand{\ljio}{L_{\tau,j} \circ \dots \circ L_{\tau,i_0}}
\newcommand{\hjmiopp}{H_{\tpp,j-1-\iz} \circ \dots \circ H_{\tpp,0}}
\newcommand{\hjmio}{H_{\tau,j-1} \circ \dots \circ H_{\tau,i_0}}
\newcommand{\mpiot}{M_{\piot}}
\newcommand{\mpjpl}{M_{p^{j+1}\tau}}
\newcommand{\pjpl}{p^{j+1}\tau}
\newcommand{\iz}{i_0}
\newcommand{\pizp}{p^{\iz+1}\tau}
\newcommand{\mpizp}{M_{\pizp}}
\newcommand{\au}{\underline{a}}
\newcommand{\n}{\text{new}}
\newcommand{\ord}{\text{ord}}
\newcommand{\mm}{\textbf{m}}
\newcommand{\aaa}{\textbf{a}}
\newcommand{\gal}{\text{Gal}}
\newcommand{\galq}{\gal(\overline{\Q}/\Q)}
\newcommand{\fb}{\underline{f}}
\newcommand{\tgn}{\mathcal{T}_{G/N}}
\newcommand{\tgh}{\mathcal{T}_{G/H}}
\newcommand{\fgn}{f_{G/N}}
\newcommand{\fgh}{f_{G/H}}
\newcommand{\ogn}{\OO_{G/N}}
\newcommand{\og}{\OO_G}
\newcommand{\ogh}{\OO_{G/H}}
\newcommand{\rhot}{\tilde{\tau}}
\newcommand{\Hom}{\text{Hom}}
\newcommand{\ort}{\OO_{\rhot}}
\newcommand{\orho}{\OO_{\tau}}
\newcommand{\tg}{\mathcal{T}_G}
\newcommand{\qpun}{\Q_p^{nr}}
\newcommand{\qpal}{\overline{\Q_p}}
\newcommand{\tgk}{\mathcal{T}_{G/K}}
\newcommand{\ogk}{\OO_{G/K}}
\newcommand{\kij}{\chi_{i,j}}
\newcommand{\ct}{C_{\underline{x}}}
\newcommand{\mlra}{\mathcal{M}(l,r,\au)}
\newcommand{\mgra}{\mathcal{M}(G,r,\au)}
\newcommand{\mgb}{\overline{\mathcal{M}_G}}
\newcommand{\mG}{\mathcal{M}_G}
\newcommand{\crt}{C_{\rho,\underline{x}}}
\newcommand{\tb}{\underline{x}}
\newcommand{\ub}{\underline{b}}
\newcommand{\otau}{\OO_{\tau}}
\newcommand{\xb}{\underline{x}}
\newcommand{\xbt}{\Tilde{\xb}}
\newcommand{\fpn}{\mathbb{F}_{p^n}}
\newcommand{\vs}{\text{V}}
\newcommand{\vpl}{\text{V}^{+}}
\newcommand{\vm}{\text{V}^{-}}
\newcommand{\mgrab}{\mgra_{\fpb}}
\newcommand{\tguh}{\tg^H}
\newcommand{\tghn}{\tg^{H,\text{new}}}
\newcommand{\tgun}{\tg^{\text{new}}}
\newcommand{\MM}{\mathcal{M}}
\newcommand{\m}{\mathfrak{m}}
\newcommand{\qb}{\Bar{\Q}^*}
\newcommand{\tgdhn}{\tgh^{\text{new}}}
\newcommand{\gb}{\gamma_b}
\newcommand{\mts}{\mathcal{M}(\gamma_{t,s})}
\newcommand{\gts}{\gamma_{t,s}}
\newcommand{\shgts}{\text{Sh}(\ml,\fb_{\gts})}
\newcommand{\qph}{\Hat{\overline{\Q}}_p}
\newenvironment{customthm}[1]
  {\renewcommand\theinnercustomthm{#1}\innercustomthm}
  {\endinnercustomthm}

\newtheorem{innercustomcor}{Corollary}
\usepackage{enumitem,kantlipsum}

\newcommand{\FF}{\mathcal{F}}
\usepackage{amsmath}% http://ctan.org/pkg/amsmath
\usepackage{kbordermatrix}% http://www.hss.caltech.edu/~kcb/TeX/kbordermatrix.sty
%\renewcommand{\kbldelim}{(}% Left delimiter
\renewcommand{\kbrdelim}{)}% Right delimiter


%\DeclareSymbolFont{cyrletters}{OT2}{wncyr}{m}{n}
%\DeclareMathSymbol{\Sha}{\mathalpha}{cyrletters}{"58}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}



%%%%%=============================================================================%%%%
%%%%  Remarks: This template is provided to aid authors with the preparation
%%%%  of original research articles intended for submission to journals published 
%%%%  by Springer Nature. The guidance has been prepared in partnership with 
%%%%  production teams to conform to Springer Nature technical requirements. 
%%%%  Editorial and presentation requirements differ among journal portfolios and 
%%%%  research disciplines. You may find sections in this template are irrelevant 
%%%%  to your work and are empowered to omit any such section if allowed by the 
%%%%  journal you intend to submit to. The submission guidelines and policies 
%%%%  of the journal take precedence. A detailed User Manual is available in the 
%%%%  template package for technical guidance.
%%%%%=============================================================================%%%%

%\jyear{2021}%

%% as per the requirement new theorem styles can be included as shown below
\theoremstyle{plain}%
\newtheorem{theorem}{Theorem}%
\newtheorem{lemma}{Lemma}%
\newtheorem{corollary}{Corollary}%  meant for continuous numbers
%%\newtheorem{theorem}{Theorem}[section]% meant for sectionwise numbers
%% optional argument [theorem] produces theorem numbering sequence instead of independent numbers for Proposition
\newtheorem{proposition}[theorem]{Proposition}% 
%%\newtheorem{proposition}{Proposition}% to get separate numbers for theorem and proposition etc.

\theoremstyle{definition}%
\newtheorem{example}{Example}%
\newtheorem{remark}{Remark}%

\theoremstyle{definition}%
\newtheorem{definition}{Definition}%
\newtheorem{notation}{Notation}

\raggedbottom
%%\unnumbered% uncomment this for unnumbered level heads

\begin{document}

\title[Abelian covers of $\mathbb{P}^1$ of $p$-ordinary Ekedahl-Oort type]{Abelian covers of $\mathbb{P}^1$ of $p$-ordinary Ekedahl-Oort type}

%%=============================================================%%
%% Prefix	-> \pfx{Dr}
%% GivenName	-> \fnm{Joergen W.}
%% Particle	-> \spfx{van der} -> surname prefix
%% FamilyName	-> \sur{Ploeg}
%% Suffix	-> \sfx{IV}
%% NatureName	-> \tanm{Poet Laureate} -> Title after name
%% Degrees	-> \dgr{MSc, PhD}
%% \author*[1,2]{\pfx{Dr} \fnm{Joergen W.} \spfx{van der} \sur{Ploeg} \sfx{IV} \tanm{Poet Laureate} 
%%                 \dgr{MSc, PhD}}\email{iauthor@gmail.com}
%%=============================================================%%

\author*[1]{\fnm{Yuxin} \sur{Lin}\orcidA{}}\email{yuxinlin@caltech.edu}

\author[2]{\fnm{Elena} \sur{Mantovan}\orcidB{}}\email{mantovan@caltech.edu}

\equalcont{These authors contributed equally to this work.}

\author[3]{\fnm{Deepesh} \sur{Singhal}\orcidC{}}\email{singhald@uci.edu}


\equalcont{These authors contributed equally to this work.}



\affil*[1]{\orgdiv{Department of Mathematics}, \orgname{California Institute of Technology}, \orgaddress{\street{1200 E California Blvd}, \city{Pasadena}, \postcode{91106}, \state{CA}, \country{USA}}}

\affil[2]{\orgdiv{Department of Mathematics}, \orgname{California Institute of Technology}, \orgaddress{\street{1200 E California Blvd}, \city{Pasadena}, \postcode{91106}, \state{CA}, \country{USA}}}

\affil[3]{\orgdiv{Department of Mathematics}, \orgname{University of California, Irvine}, \orgaddress{\city{Irvine}, \postcode{92697}, \state{CA}, \country{USA}}}

%%==================================%%
%% sample for unstructured abstract %%
%%==================================%%

\abstract{Given a family of abelian covers of $\Po$ %branched at at least four points 
and a prime $p$ of good reduction, by considering the associated Deligne--Mostow Shimura variety, we obtain lower bounds for the Ekedahl-Oort type, and the Newton polygon, at $p$ of the curves in the family. In this paper, we investigate whether such lower bounds are sharp. In particular, we prove sharpeness when the number of branching points is at most five and $p$ sufficiently large. Our result is a generalization under stricter assumptions of \cite[Theorem 6.1]{Irene} by Bouw, which proves the analogous statement for the $p$-rank, and it relies on the notion of Hasse-Witt triple introduced by Moonen in \cite{Moonenalgorithm}.  }

%%================================%%
%% Sample for structured abstract %%
%%================================%%

% \abstract{\textbf{Purpose:} The abstract serves both as a general introduction to the topic and as a brief, non-technical summary of the main results and their implications. The abstract must not include subheadings (unless expressly permitted in the journal's Instructions to Authors), equations or citations. As a guide the abstract should not exceed 200 words. Most journals do not set a hard limit however authors are advised to check the author instructions for the journal they are submitting to.
% 
% \textbf{Methods:} The abstract serves both as a general introduction to the topic and as a brief, non-technical summary of the main results and their implications. The abstract must not include subheadings (unless expressly permitted in the journal's Instructions to Authors), equations or citations. As a guide the abstract should not exceed 200 words. Most journals do not set a hard limit however authors are advised to check the author instructions for the journal they are submitting to.
% 
% \textbf{Results:} The abstract serves both as a general introduction to the topic and as a brief, non-technical summary of the main results and their implications. The abstract must not include subheadings (unless expressly permitted in the journal's Instructions to Authors), equations or citations. As a guide the abstract should not exceed 200 words. Most journals do not set a hard limit however authors are advised to check the author instructions for the journal they are submitting to.
% 
% \textbf{Conclusion:} The abstract serves both as a general introduction to the topic and as a brief, non-technical summary of the main results and their implications. The abstract must not include subheadings (unless expressly permitted in the journal's Instructions to Authors), equations or citations. As a guide the abstract should not exceed 200 words. Most journals do not set a hard limit however authors are advised to check the author instructions for the journal they are submitting to.}

\keywords{Arithmetic Schottky Problem, Ekedahl-Oort Type, Newton Polygon, Dieudonné module, Hasse-Witt triple, cyclic cover.}

%%\pacs[JEL Classification]{D8, H51}

\pacs[MSC Classification]{14H10, 11G10, 11G18}

\maketitle

\section{Introduction}\label{sec1}

This paper is motivated by the arithmetic Schottky problem in positive characteristics, which investigates which mod $p$ invariants of abelian varieties occur for Jacobians  of smooth curves. We restrict our attention to the case of Jacobians of abelian covers of $\Po$.


Let $G$ be a finite abelian group and $p$ be a prime not dividing $ |G|$. We consider $\mmg$, the moduli space of $G$-covers of $\Po$. On each irreducible component of $\mmg$, the monodromy datum $(G,r,\ab)$ of the covers is constant, and we denote such component by $\mathcal{M}(G,r,\ab)$ (in the notation $(G,r, \ab)$, $r$ denotes the number of branched points and $\ab$ the inertia type).  
By construction, the image of $\mgra$ under the Torelli map $T$ is contained in a special subvariety of the Siegel variety. We denote by $\shgf$  the smallest PEL-type Shimura variety containing $T(\mgra)$; its Shimura datum depends on the monodromy datum $\gra$.  



The inclusion of $T(\zgr)$ inside $\shgf$ gives rise to natural lower bounds for the Ekedahl-Oort types and the Newton polygons occurring for the Jacobians of curves parametrized by $\mathcal{M}(G,r,\ab)$. More precisely, let $p$ be a prime not dividing $|G|$. Then, both $\mgra$ and $\shgf$ have good reduction at $p$, and the $p$-rank, Ekedahl–Oort and Newton stratifications of $\mgra_{\fpb}$ are induced from those on $\shgf_{\fpb}$. In particular, the maximal $p$-rank and the lowest Ekedahl–Oort type and Newton polygon occurring on $\shgf_{\fpb}$  are respectively upper and lower bounds for those occurring on $\mgra_{\fpb}$. For example, by \cite[Theorem 1.6.3]{Wedhorn}, when $p$ is not totally split in the reflex field of $\shgf_{\fpb}$, the ordinary stratum of $\shgf_{\fpb}$ is empty, and hence so is that of $\mgra_{\fpb}$.  It is natural to ask whether these bounds are sharp. More precisely, given a monodromy datum $\gra$ and a prime $p\nmid |G|$, one may ask when the intersection of $T(\zgr)$ with each of the unique open strata of $\shgf_{\fpb}$ is non-empty. When $r\leq 3$, $\dim\zgr=\dim\shgf=0$, and the statement is trivial. On the other hand, by the Coleman--Oort Conjecture, if $r\geq 4$, $\dim\zgr < \dim\shgf$ except in finitely many instances (see \cite{Moonen10} and \cite{MoonenOort}). 

For $p$ large, the sharpness of the $p$-rank bound follows as a special case of \cite[Theorem 6.1]{Irene}. 
In this paper, we investigate the sharpness of the lower bounds for Ekedahl-Oort types and Newton polygons, and positively answer our question when $p$ is large and the number of branched points is at most $5$.
By \cite[Theorem 1.3.7]{MoonenEOtypeformula},  the unique open Ekedahl–Oort and Newton strata of $\shgf_{\fpb}$ agree, hence the two problems are equivalent. 
  On the other hand, the open Newton/Ekedahl-Oort stratum is in general, properly contained in the maximal $p$-rank stratum. Thus our results is a refinement of the special case of \cite[Theorem 6.1]{Irene} for covers of $\Po$ branched at at most 5 points.




More precisely, we prove the following result. For $p\nmid |G|$, we refer to the lowest Ekedahl--Oort type and Newton polygon occurring on $\shgf_{\fpb}$ as $(G,\underline{f})$-ordinary.
\begin{theorem}\label{abelian cover}
Let $(G,r,\underline{a})$ be a monodromy datum for abelian $G$-covers of $\Po$, branched at $r$ points, and $p$ a rational prime.  Assume $r\leq 5 $ and $p>|G|(r-2)$. 
Then the Ekedahl–Oort type and Newton polygon of the generic $G$-cover of $\Po$ over $\fpb$, with monodromy datum $(G,r,\underline{a})$, are $(G,\underline{f})$-ordinary.
\end{theorem}

The condition  $p>|G|(r-2)$ is the same as in \cite[Theorem 6.1]{Irene}. 
The restriction $r\leq 5$ is due to the limitation of our method. By combining Theorem \ref{abelian cover}  with the results in \cite[Section 4]{clutchingargument}, for any $r\geq 6$ we construct infinitely many examples of monodromy data with $r$ branched points that satisfy the statement of Theorem \ref{abelian cover} (see Remark \ref{anyrl}). 

As an application, Theorem \ref{abelian cover} yields new examples
of Newton polygons that occur for Jacobians of smooth curves, and
of unlikely intersections of the Torelli locus with Newton strata in Siegel varieties (see Remarks \ref{newNP} and \ref{unlikely}).



We describe our strategy. 
In \cite{Irene}, Bouw considers ramified abelian prime-to-$p$ covers of curves over $\fpb$, and the natural upper bound for their $p$-rank coming from the Galois action. By expressing the $p$-rank of a cover in terms of its Hasse--Witt invariants (the ranks of certain blocks in the Hasse--Witt matrix of the curve), in \cite[Theorem 6.1]{Irene}, she proves that the generic cover has $p$-rank equal to the upper bound. When specialized to covers of $\Po$, the upper bound for the $p$-rank in \cite{Irene} agrees with the $(G,\underline{f})$-ordinary $p$-rank. Recently, in \cite{Moonenalgorithm}, Moonen introduces the notion of Hasse--Witt triple for a smooth curve over $\fpb$, as a generalization of the Hasse--Witt invariant, and proves that it is equivalent to Ekedahl--Oort type of the Jacobian of the curve. He also gives an algorithm for computing the Hasse--Witt triple of a smooth curve given as a complete intersection.  In this paper, we adapt Moonen's algorithm to compute the Hasse--Witt triple of cyclic covers of $\Po$, and  prove that for the generic curve in the family the Hasse--Witt triple is $(G,\underline{f})$-ordinary, by extending the approach in \cite{Irene}.  







The paper is organized as follows. 
In Section \ref{pre}, we recall the notions of $(G,\underline{f})$-ordinary Ekedahl--Oort type and Newton polygon,  and Moonen's notion of Hasse-Witt triple. In Section \ref{reduction argument}, we reduce the proof of Theorem \ref{abelian cover} to the case when $G$ is a cyclic group (Lemma \ref{equivalence two}). In Section \ref{combi}, we give a criterion for $(G,\underline{f})$-ordinaryness in terms of Hasse--Witt triples, given as (finitely many) rank conditions on iterations of the extended Hasse-Witt matrix  (Theorem \ref{numerical criteria}).   In Section \ref{duality} and \ref{max monomial}, we describe the Hasse-Witt triple of a cyclic cover of $\Po$, and explicitly compute the highest monomials of the entries of the associated extended Hasse--Witt matrix.
%find the maximal monomial in each entry of $\phi,\psi$ under lexicographical order. This will be needed to show the non-vanishing of a certain determinant. 
 %following a strategy similar to that \cite{Irene}, and 
In Sections \ref{Section 0,1 in signature} and \ref{new part mu ordinary}, we prove Theorem \ref{abelian cover}, first under some additional conditions, and then in general.
%an important case where the assumption for Theorem \ref{numerical criteria} is satisfied.
%In Section ,  we deduce Theorem \ref{abelian cover} from the special instances.
%In Section \ref{list}, by combining Theorem \ref{abelian cover} with \cite[Theorem 4.5]{clutchingargument}, we construct (infinitely many) cyclic monodromy data $\gra$ with $r \geq 6$ such that the $(G,\underline{f})$-ordinary locus of $T(\mgra)$ is non empty (Corollary \ref{two t plus n}).





\section{Notations and Preliminaries}\label{pre}



\subsection[]{The Hurwitz space \(\mgra\)}
We briefly recall the definition of the Hurwitz space of abelian covers. We refer to \cite{modulifunctorGcover} for a more complete description of the construction of the moduli functor.


\begin{definition}\label{monodromy datum} 
Let $G$ be a finite group.
A monodromy datum of a $G$-cover of $\Po$ is given as $(G,r,\au)$, where $r\geq 3$ is the number of branched points, and $\au\in G^r$ is the inertia type of the cover.
That is, $\au=(\au_1,\au_2,\dots, \au_r)\in G^r$ satisfies 
\begin{enumerate}
    \item $\au_i \neq 0$ in $G$,
    \item $\au_1, \dots, \au_r$ generate $G$,
    \item $\sum_{i=1}^r \au_i = 0$ in $G$.
\end{enumerate}
%We say that two monodromy data $(G,r,\au)$ and $(G,s,\ub)$ are equivalent if $r=s$ and $\au, \ub \in G^r$ are in the same orbit under ${\rm Aut}(G) \times \text{Sym}_r$. 
\end{definition}

Let $\mg$ be the moduli space of smooth projective genus $g$ curve and $\overline{\mg}$ be its Deligne-Mumford compactification, so it is the moduli space of stable curves of genus $g$. While both are algebraic stacks defined over $\Q$, they have a model defined over some open subset of $\Spec(\Z)$.

Let $p$ be a rational prime, $p \nmid |G|$. We use $e$ to denote the exponent of $G$ and consider schemes over $\Z[\frac{1}{e}, \zeta_e]$, where $\zeta_e$ is a primitive $e^{\text{th}}$ root of unity. Let $\mgb$ be the moduli functor on the category of schemes over $\Z[\frac{1}{e}, \zeta_e]$ that classifies admissible stable $G$-covers of $\Po$, and denote by $\mG$  the smooth locus of $\mgb$. Both $\mG$ and $\mgb$ have good reduction modulo $p$. Within each irreducible component of $\mG$, the monodromy datum of the parameterized curves is constant.  Conversely, given a monodromy datum $(G,r,\au)$, the substack $\mgra$ of $\mG$ parametrizing $G$-covers with monodromy $(G,r,\au)$ is irreducible. 
%That is, $\mgra$ classifies the smooth $G$ covers of $\Po$ branched at $r$ points, with the local monodromy $\au_i$ at the $i^{th}$ branched points. 

\subsection[]{The Shimura variety $\shgf$}\label{Shimura}  We briefly recall the construction of the PEL type moduli space $\shgf$. We refer to \cite[Section 3.2, 3.3]{SecondPaper} for more details.

Let $\mathcal{A}_g$ denote the moduli space of principally polarized abelian varieties of dimension $g$, and $T:\mathcal{M}_g\to \mathcal{A}_g$ the Torelli morphism. 
For $\gra$ a monodromy datum as in Definition \ref{monodromy datum},  we denote by $S\gra$ the largest closed, reduced and irreducible substack of $\mathcal{A}_g$ containing $T(\mgra)$ such that the action of $\Z[G]$ on the Jacobian  of the
universal family of curves over $\mgra$ extends to the universal abelian scheme over $S\gra$. By \cite{delignmostow},  $S\gra$  is an irreducible component of a PEL type moduli space, which we denote by $\shgf$  (see also \cite[Section 3]{SecondPaper}).  The moduli space $\shgf$ has a canonical model over $\Z[\frac{1}{e}, \zeta_e]$, and good reduction at all primes $p\nmid |G|$.

We recall the definition of the PEL datum associated with $\shgf$. 
Let $\Q[G]$ denote the $\Q$-group algebra of $G$,  and $*$ the involution on $\Q[G]$ induced from the group homomoprhism $g\mapsto g^{-1}$.  Fix $\xb \in \mgra(\C)$, and denote by $C=\ct$  the associated curve over $\C$. Let  $V=H^1(C,\Q)$ be the first Betti cohomology group of $C$; the action of $G$ on $C$ induces a structure of $\Q[G]$-vector space on $V$. We denote by $\langle\cdot,\cdot\rangle$ the standard skew Hermitian form on $V$, and by $h$ the Hodge structure on $V$. 
The Shimura datum of $\shgf$ is defined by the PEL-datum $(\Q[G], *, V, \langle\cdot, \cdot\rangle, h)$, and is independent of the choice of $\xb$. 

We denote 
 by $\fb$  the {\em signature} of the multiplication of $\Q[G]$ on $V$, that is, the signature of  $\mathcal{G}=GU(V, \langle\cdot, \cdot\rangle )$ the group of $\Q[G]$-linear similitudes of $V$. 
Concretely, $\fb$ is defined as follows. Denote the Hodge structure $h$ of $V$ by $V\otimes_\Q\C=V^+\oplus V^-$, where $V^+=H^0(C,\Omega^1)$, via the Betti-de Rham comparison isomorphism.
Let $\tg$ be the group of characters of $G$, $\tg=\Hom(G,\C^*)$. We define $$\fb:\tg\to \Z \text{ as }f(\tau)=\dim( {V}^{+}_{\tau}),$$ where for each $\tau\in \tg$ we denote by $V_\tau^+$ the subspace of $V^+$ of weight $\tau$. 
The involution on $\Q[G]$ induces an involution on $\tg$, where for $\tau \in \tg$, $\tau^*(g)=\tau(g^*)$.
By definition, $f(\tau^*)=\dim V^-_\tau$, and for each $\tau\in \tg$, $\tau\neq \tau^*$, the pair $(f(\tau),f(\tau^*))$ is the signature of the unitary group $GU(V, \langle\cdot, \cdot\rangle )$ at the real place underlying $\tau$ and $\tau^*$.
The signature $\fb$ can be computed explicitly from the monodromy datum $\gra$ via the Hurwitz--Chevalley-Weil formula (see \cite[Theorem 2.10]{Chevalley}).
For $G$ a cyclic group of size $l$, after identifying $\tg\simeq\{0, 1, \dots l-1\}$, we have (see \cite[Lemma 2.7, Section 3.2]{specialfamily})\begin{align}\label{signature}
    f(\tau_i)=-1+\sum_{k=1}^r \langle\frac{-ia_k}{l}\rangle \text{ for } 1\leq i\leq l-1, \text{ and } f(\tau_0)=0.
\end{align}

With abuse of notation, in the following we denote by $(G,\fb)$ the Shimura datum of $\shgf$.



%\begin{comment}

%Given a monodromy datum $\gra$, it determines the signature $\fb=(f(\tau))_{\tau}$, which is a datum that encodes the action of $\Q[G] \otimes_\Q \C$ on the cohomology of parameterized curve. It turns out that $\fb$ is constant on $\mgra$, and it can be computed as follows. Let $\tg$ be the %group of characters $\Hom(G,\C^*)$. For $\ct$ parameterized by $\xb \in \mgra(\C)$, denote $\ct$ as $C$ and denote $H^1(\ct,\Q)$ as $V$. The action of $G$ on $C$ makes the first Betti cohomology $H^1(C,\Q)$ into a $\Q[G]$ module, so $\text{V}=H^1(C,\Q) \otimes_{\Q} \C$ is a $\Q[G] \otimes_{\Q} %\C$ module. Since $\Q[G] \otimes_{\Q} \C \cong \prod_{\tau \in \tg}\C_{\tau}$, $\text{V} \cong \bigoplus_{\tau \in \tg}\text{V}_{\tau}$, where $g \in G$ acts on $\text{V}_{\tau}$ via scalar multiplication by $\tau(g)$.
%On the other hand, we have the Hodge decomposition $H^1(C,\Q) \otimes_{\Q} \C \cong H^1(C,\OO) \oplus H^0(C,\Omega)$. We denote  $H^0(C,\Omega)$ by $\text{V}^{+}$ and $H^1(C,\OO)$ by $\text{V}^{-}$. Since both are $\Q[G] \otimes_{\Q} \C$ modules, we have decomposition
%\begin{align*}
%\text{V}^{+} &\cong \bigoplus_{\tau \in \tg}\text{V}^{+}_{\tau}, &\text{V}^{-} &\cong \bigoplus_{\tau \in \tg}\text{V}^{-}_{\tau},&\vs_\tau=&\vpl_\tau \oplus \vm_\tau.  \end{align*}
%We have the duality that ${\text{V}^{+}_{\tau}}^{\smvee}=\text{V}^{-}_{\check{\tau}}$. The signature $f_G: \tg \to \Z$ is given by $f(\tau)=\dim(\text{V}^{+}_{\tau})$. That is, $\fb$ determines the isomorphism class of $H^0(\ct,\Omega)_\tau$. Moreover, given the monodromy datum $\gra$, there is %an explicit formula to compute $f(\tau)$ for $\tau \in \tg$ as given in \cite[Theorem 2.10]{Chevalley}.

%For any $C \to \Po$ represented by a point of $\mgra$, its Jacobian $J(C)$ is equipped with a canonical principle polarization. The action of $G$ on $C$ induced extra endomorphism on $J(C)$ by the action of $\Z[G]$. Thus, the image of $\mgra$ under the Torelli map naturally lies inside a PEL-%type Shimura variety $\text{Sh}(G)$. It turns out that the smallest PEL-type Shimura variety containing $T(\mgra)$ is $\shgf$, which parameterize principal polarized abelian variety with extra endomorphism induced by $\Z[G]$ and signature type $\fb$. For an explicit construction of $\text{Sh}G)$ %and $\shgf$, see \cite[Section 3.2, 3.3]{SecondPaper}.
%\end{comment}


\subsubsection[]{The $(G,\underline{f})$-ordinary stratum at unramified primes}

Let $p$ be a prime not dividing $|G|$. Then $p$ is a prime of good reduction for $\shgf$ and by \cite{viehmann-wedhorn} both the Ekedahl--Oort and Newton stratification of $\shgf_{\fpb}$ are well understood. We briefly recall some of their properties.

The Newton polygon is a discrete invariant that classifies the isogeny class of the $p$-divisible group of a polarized abelian variety over $\fpb$, and is known to induce a stratification on $\mathcal{A}_{g,\fpb}$. By \cite{viehmann-wedhorn}, the Newton polygons corresponding to non-empty strata in $\shgf_{\fpb}$ are in one-to-one correspondent with the elements in the associated Kottwitz set at $p$, its natural partial order agreeing with specialization on $\shgf_{\fpb}$. In \cite{Kottwitz}, this set is denoted by $B(\mathcal{G}_{\Q_p},\mu_h)$, where $\mathcal{G}=GU(V, \langle\cdot, \cdot\rangle )$
%is the algebraic group over $\Q$ associated with $\shgf$ 
and $\mu_h$ is the $p$-adic cocharacter induced by the Hodge structure $h$.
By \cite{Rapoport-RIcharts} and \cite{Wedhorn}, there is a unique maximal element / lowest polygon in $B(\mathcal{G}_{\Q_p},\mu_h)$, corresponding to the unique open (and dense) Newton stratum in  $\shgf_{\fpb}$; this is known as the $\mu$-ordinary polygon at $p$ and in our context can  be computed explicitly from the splitting behaviour of p in the group algebra $\Q[G]$ and the signature $\fb$ (for example, it is ordinary if $p$ is totally split in  $\Q[G]$).  

The Ekedahl-Oort type is a discrete invariant that classifies the isomorphism class of the $p$-kernel of a polarized abelian variety over $\fpb$, and also induces a stratification on  $\mathcal{A}_{g,\fpb}$. By \cite{viehmann-wedhorn}, the Ekedahl--Oort types corresponding to non-empty strata in $\shgf_{\fpb}$ are in one-to-one correspondence with certain elements in the Weyl group of the reductive group $\mathcal{G}$, their dimension equal to the length of the element in the Weyl group.
In particular, there is a unique element of maximal length, corresponding to the unique non-empty open (and dense) Ekedahl--Oort stratum in  $\shgf_{\fpb}$. The Ekedahl--Oort type corresponding to the maximal element is called $p$-ordinary. 

By \cite[Theorem 1.3.7]{MoonenEOtypeformula}, the $p$-ordinary Ekedahl--Oort stratum and
$\mu$-ordinary Newton stratum of $\shgf_{\fpb}$ agree.
As their definition depends on the Shimura datum $(G,\underline{f})$ and the prime $p$, we refer to it as the $(G,\underline{f})$-ordinary stratum at $p$, and denote the associated Newton polygon by $\mu_p(G,\fb)$.  
An explicit formula for the polygon $\mu_p(G,\fb)$ is given   \cite[Proposition 4.3]{SecondPaper}, as a special case of that in \cite[Section 1.2.5]{MoonenEOtypeformula}. 
We briefly recall some aspects of its construction.

 
% Newton polygon is a discrete invariant on $\shgfb$ that classifies the isogeny class of $p$ divisible group of the abelian variety. For an abelian variety $A$ defined over $\fpb$, there exists a model of $A$ defined over $\fpn$, which we denote as $A_0$. Let $\text{W}(\fpn)$ denote the ring of Witt vector of length $n$, which we can think of as the ring generated by Teichmüller lift of root of unity in $\fpn$. Then we can lift $A_0$ to be defined over $\text{W}(\fpn)$ and consider its first crystalline cohomology $H^1(A_0/\text{W}(\fpn))$. Since $H^1(A_0/\text{W}(\fpn))$ only depends on $A$, we denote it as $\text{W}(A)$. $\text{W}(A)$ has the action of Frobenius, and the Newton Polygon of $A$, which we denote as $\text{NP}(A)$, is the Newton polygon of characteristic polynomial of Frobenius on $H^1(A_0/\text{W}(\fpn))$. For more details, see \cite[Section 2.3, 4.1]{SecondPaper}. We use $B(G,\fb)$ to denote the Kottiwitz set of $\shgf$, which is the set of Newton Polygons occurring in $\shgf$. The unique maximum element of $B(G,\fb)$ is called the $\mu$-ordinary Newton polygon, which we denote as $\mu(G,\fb)$. The formula of $\mu_p(G,\fb)$ is given in \cite[Proposition 4.3]{SecondPaper}.

\subsubsection[]{The $(G,\underline{f})$-ordinary polygon}
Given the rational prime $p$, we fix an algebraic closure $\overline{\Q}_p$ of $\Q_p$ and an isomorphism $\iota:\Hat{\overline{\Q}}_p\simeq \C$.
We denote by $\overline{\Q}^{\rm un}_p$ the maximal unramified subfield of $\overline{\Q}_p$, and by $\fpb$ its residue field. 
Since $p\nmid |G|$, $\iota$ induces an isomorphism $\tg\simeq \Hom(G,\overline{\Q}^{\rm un*}_{p})$. 
Let $\sigp$ be the Frobenius element in $\gal(\fpb/\mathbb{F}_p)$, then $\sigp$ lifts to an element of $\gal(\overline{\Q}^{\rm un}_p/\Q_p)$, and we consider the action of $\sigp$ on $\tg$ by composition, that is $\tau^{\sigp}(x)=\sigp(\tau(x))=\tau(x)^p$.
This action partitions $\tg$ into Frobenius orbits, and we denote the set of Frobenius orbits of $\tg$ by $\og$. For $\tau \in \tg$, we use $\orho$ to denote the Frobenius orbit of $\tau$. 
%
The Frobenius orbits in $\og$ are naturally in one-to-one correspondence with the simple factors of $\Q_p[G]$.  From the decomposition into simple factors of $\Q[G]$, $\Q[G] \cong \prod_H K_H $ where $H$ varies among the subgroup of $G$ such that $G/H$ is cyclic, we deduce
\begin{equation}\label{simplefactors}
    \begin{split}
       \Q_p[G] &\cong \prod_{\substack{H \leq G \\ G/H \text{ cyclic }}}K_H \otimes_{\Q}\Q_p \cong  \prod_{\substack{H \leq G \\ G/H \text{ cyclic }}}\prod_{\substack{\orho\\
       \ker(\tau)=H }}K_{\orho},\\
    \end{split}
\end{equation}
where each Frobenius orbit $\OO$ corresponds to a prime $\p$ above $p$ in $K_H$, for $H=\ker(\tau)$,  and $K_{\OO}$ is the completion of $K_H$ at this prime. 



Let $C \to \Po$ be an abelian cover parameterized by a point $\xb \in \mgra(\fpb)$, we denote its Jacobian by $J(C)$. Let ${D}={D}(J(C))$ denote the Diedonn\'e module of the abelian variety $J(C)/\fpb$, and $\text{NP}({D})$ its Newton Polygon at $p$.
Then, the structure of $\Z_p[G]$-module on  $D$ induces a decomposition up to isogeny  $D \sim \bigoplus_{\OO \in \og}D_{\OO}$, and hence an equality of Newton polygon  $\text{NP}(D)=\bigoplus_{\OO \in \og}\text{NP}(D_{\OO})$.

From the formula given in \cite[Proposition 4.3]{SecondPaper}, the Newton polygon $\mu_p(G, \fb)$ also decomposes as $\mu_p (G,\fb)=\bigoplus_{\OO \in \og}\mu(\OO)$, where for each orbit $\OO$ the polygon $\mu(\OO)$ only depends on the values $(f(\tau))_{\tau \in \OO}$. Furthermore, $\text{NP}(D)= \mu_p(G, \fb)$ if and only if $\text{NP}(D_{\OO})=\mu(\OO)$, for each Frobenius orbit $\OO$.




\subsection{Hasse--Witt triples and Ekedahl--Oort types}\label{dieu}
% Moonen in \cite[Theorem 1.3.7]{MoonenEOtypeformula}, shows that the Newton polygon of $A$ at $p$ is $\mu$-ordinary if and only if the Diudonne module has $p$-ordinary Ekedahl–Oort type.
%We want to investigate whether or not the image of Torelli map intersects the $\mu$-ordinary Newton polygon stratum in $\shgf$. This is equivalent to determining whether the image intersects the $p$-ordinary Ekedahl–Oort stratum.
%In this subsection, we give some preliminaries about the Ekedahl–Oort type, which is a discrete invariant of abelian varieties defined over $\fpb$. See \cite{MoonenEOtypeformula, Moonengroupscheme} by Moonen for more details.

%\subsubsection{Hasse-Witt triple}\label{Hasse Witt triple} 
Recall $\sigma$ denotes the Frobenius of $\fpb$.
Let $A$ be a principally polarized abelian variety of dimension $g$, defined over $\fpb$. Its Ekedahl-Oort type encodes the isomorphism class of $A[p]$, or equivalently the isomorphism class of the associated polarized mod $p$ Diedonn\'e module $(M,F,V,b)$, where
\begin{itemize}
    \item $M=H^1_{dR}(A/\fpb)$;
    \item $F: M \to M$ is the $\sigma$-linear map on $M$ induced by the Frobenius of $A$;
    \item $b: M \times M \to \fpb$ is the pairing induced by the polarization of $A$;
    \item $V: M \to M$ is the unique $\sigma^{-1}$-linear operator satisfying $b(F(x),y)=b(x,V(y))^{p}$.
\end{itemize}
%The quadruple $(M,F,V,b)$ is called the polarized mod $p$ Dieudonné module associated to $A$, and the Ekedahl-Oort type is the isomorphism class of this mod $p$ Dieudonné module. 

In \cite{Moonenalgorithm}, Moonen establishes a equivalence of category between the polarized mod $p$ Dieudonné modules and Hasse-Witt triples, where he defines a Hasse-Witt triple $(Q,\phi,\psi)$ as follows:
%According to Moonen (*, cite reference), the isomorphism class of $\mod p$ Dieudonne module is uniquely determined by the associated Hasse-Witt triple $(Q,\phi,\psi)$. By a Hasse-Witt triple, we mean the following:
\begin{itemize}
    \item $Q$ is a finite dimensional vector space over $\fpb$;
    \item $\phi: Q \to Q$ is a $\sigma$-linear map;
    \item $\psi: \ker(\phi) \to \im(\phi)^{\perp}$ is a $\sigma$-linear isomorphism, where $\im(\phi)^{\perp}\subseteq Q^{\smvee} ={\rm Hom}_{\fpb} (Q,\fpb)$ is the subspace $\im(\phi)^{\perp}=\{\lambda \in Q^{\smvee}: \lambda(\phi(q))=0, \forall q \in Q$\}.
\end{itemize}
Under Moonen's equivalence of category,  the polarized mod $p$ Dieudonne module $(F,M,V,b)$ corresponding to a Hasse-Witt triple $(Q,\phi,\psi)$ is given by: 
\begin{itemize}
    \item $M = Q \oplus Q^{\smvee}$;
    \item $F: M \to M$ is defined as follows: set $R_1=\ker(\phi)$, choose $R_0$ a compliment of $R_1$ in $Q$, and write $M=(R_0\oplus R_1)\oplus Q^{\smvee}$, then $F(x+y,z)=(\phi(x),\psi(y))$, for any $x\in R_0,$ $y\in R_1$, $z\in Q^{\smvee}$;
    \item $b:M\times M\to \fpb$ is defined by $b((q,\lambda),(q',\lambda'))= \lambda'(q)-\lambda(q')$, for any $q,q'\in Q$ and $\lambda,\lambda'\in Q^{\smvee}$.
    \item  $V:M\to M$ is uniquely determined by $b(F(x),y)=b(x,V(y))^p$.
\end{itemize}


%\subsubsection{Hasse-Witt triple of cover of $\Po$}\label{Hasse Witt triple} 

%In \cite{Moonenalgorithm}, Moonen given an explicit algorithm for computing the Hasse--Witt triple of (the Jacobian of) a complete intersection curve $C$ defined over $\fpb$. 
%Adapting  \cite[proof of Proposition 3.11 and formula (3.11.3)]{Moonenalgorithm} to the special case of $C$ a $G$-cover of $\Po$, $\pi: C \to \Po$, using the coordinate charts $U_1=\pi^{-1}(\Po-\{\infty\})$ and $U_2=\pi^{-1}(\Po-\{0\})$,  we explicitly compute the Hasse-Witt triple $(Q,\phi,\psi)$ of $C$ as follows:
%\begin{itemize}
 %   \item $Q=\hy$, and $Q^{\smvee}=\hyd$;
  %  \item $\phi:\hy \to \hy$ given by the Hasse-Witt matrix;
   % \item $\psi: \ker(\phi) \to \im(\phi)^\perp$ given by $\psi(\alpha)=(df_{1,{\alpha}},-df_{2,{\alpha}}),$
    %where $(df_{1,{\alpha}},-df_{2,{\alpha}})$ denotes the global $1$-form on $C$ which restricts to $df_{1,{\alpha}}$ on $U_1$ and to $-df_{2,{\alpha}}$ on $U_2$, and $f_{1,{\alpha}} \in \OO_C(U_1)$ and $f_{2,\alpha} \in \OO_C(U_2)$ satisfy $\alpha^p=f_{1,{\alpha}}+f_{2,{\alpha}}$ 
    %(for $\alpha \in \ker(\phi)$, $f_{1,\alpha}$ and $f_{2,\alpha}$ exist, and by construction $df_{1,{\alpha}}$ and $-df_{2,{\alpha}}$ agree on $U_1\cap U_2$).
%\end{itemize}
%Then $(M,F,V,b)$ obtained from the Hasse-Witt triple via the correspondence is isomorphic to the polarized mod $p$ Dieudonne module associated to $J(C)$.

\subsubsection[]{The $(G,\fb)$-ordinary Ekedal--Oort type}
We recall the definition of the $p$-ordinary Ekedahl--Oort type for $\shgf$. Since it depends on the Shimura datum $(G,\fb)$ we also refer to it as the $(G,\fb)$-ordinary Ekedahl--Oort type at $p$.

Recall the identification $\tg=\Hom(G,\C^*) \cong \Hom (G,\overline{\Q}_p^{\rm un*})$; it induces an isomorphism $\tg\cong \Hom(G,\fpb^*)$.  %, and $\fb: \tg \to \Z$ a signature. 
Let $A$ be an abelian variety  over $\fpb$ corresponding to a point of  $\shgf$, and denote its mod $p$ Dieudonné module by $(M, F,V,b)$. The action of $G$ on $A$ induces a structure of $\fpb[G]$-module on $M$. Hence, the Dieudonné module $M$ decomposes as 
%Now, since $p \nmid |G|$, the image of any character of $G$ is a root of unity with order prime to $p$.
%Let $\sigp$ be the Frobenius element in $\gal(\fpb/\mathbb{F}_p)$, then $\sigp$ acts on $\tg$ by $\tau^{\sigp}(x)=\sigp(\tau(x))=\tau(x)^p$.
% since, $\rho(x)$ is a root of unity whose order is not divisible by $p$.
%This action partitions $\tg$ into Frobenius orbits, and we denote the set of Frobenius orbits of $\tg$ by $\og$. For $\tau \in \tg$, we use $\orho$ to denote the Frobenius orbit of $\tau$. 
%We have a decomposition of $M$:
$$M=\bigoplus_{\tau\in\tg} M_\tau=\bigoplus_{\OO\in\og}M_{\OO},\text{ where } M_{\OO}=\bigoplus_{\tau\in \OO}M_{\tau}, $$
and  for each $\tau \in\tg$,  $M_\tau$ is the $\tau$-isotypic component of $M$. That is, $g \in G$ acts on $M_\tau$ via multiplication by $\tau(g)$. For $\tau\in \tg$, let $g(\tau)=\dim_{\fpb} (M_{\tau})$. Since it depends only on the Frobenius orbit of $\tau$, we write  $g(\OO)=g(\tau)$, for any/all $\tau \in \OO$. 

For simplicity, given $\tau\in\tg$, we denote $\tau^{\sigp}$ by $p\tau$ and its orbit $\OO_{\tau}=\{\tau,p\tau,\dots,p^{|\OO_{\tau}|-1}\tau\}$. Since $p(p^{|\OO_\tau|-1}\tau)=\tau$, we also write $p^{|\OO_\tau|-1}\tau$ as $\frac{\tau}{p}$.  
Then, $F$ maps $M_{\tau}$ to $M_{p\tau}$, and $V$ maps $M_{\tau}$ to $M_{\frac{\tau}{p}}$. 

Recall, for $\tau\in\tg$, $\tau^*\in\tg$ is defined as $\tau^*(x)=\tau(x)^{-1}$. Given an orbit $\OO$, we denote its conjugate orbit as ${\OO}^*=\{\tau^*\mid \tau\in \OO\}$. The polarization $b:M \times M \to \fpb$ identifies $M^{\smvee}$ with $M$, $M_\OO^{\smvee}$ with $M_{\OO^*}$, and $M_{\tau}^{\smvee}$ with $M_{\tau^*}$.

\begin{definition}\label{Def_EOMFVb} (\cite[Section 1.2.3]{MoonenEOtypeformula})
The $(G,f)$-ordinary mod $p$ Diedonn\'e module $(M,F,V,b)$ is given as follows. 
%
%Set $M=\oplus_{\tau\in \tg } M_\tau$, where each $\M_\tau$ is a $\fpb$-vector space of dimension $g(\tau)=g(\OO_\tau)$. 
Let $\{e_{\tau,j}\mid 1\leq j\leq {g(\OO_\tau)}\}$ be a $\fpb$-basis of $M_\tau$, and denote the dual basis on $M_\tau^{\smvee}$ by $\{\check{e}_{\tau,j}\mid 1\leq j\leq {g(\OO_\tau)}\}$. 
%For each $1\leq i\leq g(\OO_\tau)$, we denote the $\fpb$ span of $\{e_{\tau,1},\dots,e_{\tau,i}\}$ as $M_{\tau,i}$. 
Then the polarization $b$ on $M$, in terms of the induced isomorphisms $M_\tau^{\smvee}\simeq M_{\tau^*}$  for $\tau\in\tg$, is given by $\check{e}_{\tau,j}\mapsto e_{\tau^*,g(\OO)+1-j}$, for $1\leq j\leq g(\OO_\tau)$.
The action of $F$ and $V$ on $M$, when restricted to $M_\tau$ for $\tau\in\tg$, are given by
%\begin{definition}
    %The Dieudonné module $(F,V,M,b)$ with action of $G$ and signature $\fb$ is said to $p$-ordinary if its associated coset representatives $w_{\tau}$ is of maximal length for every $\tau$. Equivalently, $\ker(F)\cap M_{\tau,f(\tau^*)}=\{0\}$ for every $\tau$. 
%\end{definition}
%\begin{theorem}\cite{??}\label{Thm: mu ordinary p-ordinary}
%Suppose $A$ is parameterized by $\shgf$. Then $A$ is $p$-ordinary if and only if its associated Newton polygon is $\mu$-ordinary.
%\end{theorem}
%When the $(G,\fb)$ are fixed, $\tau\in T_G$, the permutation of maximal length is $\wt$ given by as follows: for $k\leq \fts$, $\wt(k)=f(\tau)+k$ and for $k>\fts$, $\wt(k)=k-\fts$.
    %$$\wt(j) = \begin{cases} j+\ft &\text{ if } j \leq g(\OO)-\ft \\ j+\ft-g(\OO) &\text{ if } j>g(\OO)-\ft \end{cases}$$
%Consequently, $(F,V,M,b)$ is $p$-ordinary if there is a basis $\{e_{\tau,j}: 1 \leq j \leq g(\OO)\}$ of $M_\tau$, such that 
%Then $F$ and $V$ acts as
\begin{align}\label{Eq_MFVb}
F(e_{\tau,j})&=\begin{cases}
    e_{p\tau,j} &\text{ if } j \leq \fts\\
    0 &\text{ if } j \geq \fts+1,
    \end{cases}
&
V(e_{p\tau,j_1})&=\begin{cases}
    0 &\text{ if } j_1 \leq f(\tau^*)\\
    e_{\tau,j_1} &\text{ if } j_1 \geq f(\tau^*)+1.
    \end{cases}
\end{align}

\end{definition}


\begin{remark}\label{Rem_EOHassetrople}
Under Moonen's equivalence, the $(G,\fb)$-ordinary Hasse--Witt triple $(Q, \phi,\psi)$ is defined as follows.
Let $Q=\ker(F)^{\smvee}\subseteq M$ and define $Q_{\tau}=Q\cap M_{\tau}$, for each $\tau\in\tg$. Write $Q_{\tau^*}^{\smvee}=(Q_{\tau^*})^{\smvee}$ (in general $Q_{\tau^*}^{\smvee}$ is not $Q^{\smvee}\cap M_{\tau^*}$).
Then $M_{\tau}=Q_{\tau} \oplus Q_{\tau^*}^{\smvee}$, %and we denote by $\pi_{\tau}$ the projection from $M_{\tau}$ to $Q_{\tau}$, whose kernel is $Q_{\tau^*}^{\smvee}$.
where the set $\{e_{\tau,i_{\tau,1}},\dots, e_{\tau,i_{\tau,f(\ts)}}\}$ is a basis of $Q_{\tau}$ and $\{e_{\tau,j_{\tau,1}},\dots, e_{\tau,j_{\tau,f(\tau)}}\}$ is a basis of $Q_{\tau^*}^{\smvee}$.
%
%When specializing to the abelian varieties coming from the Jacobian of a smooth curve, the associated Dieudonné module can be classified by the notion of Hasse-Witt triple as defined by Moonen in \cite{Moonenalgorithm}. The Hasse-Witt triple can be computed explicitly in terms of the cohomology of the curve. In this subsection, we give some preliminaries for Hasse-Witt triples of the jacobians of curves that arise as cyclic cover of $\Po$. See \cite{Moonenalgorithm} for more details.
%
%Now for a monodromy datum $\gra$ whose signature is $\fb$, we know that $T(\mgrab)$ lies inside $\shgfb$. Then, for each $\ct$ parameterized by $\xb \in \mgra(\fpb)$, it has the associated Hasse-Witt triple $(Q,\phi,\psi)$ and mod $p$ Dieudonne module $(F,M,V,b)$, both of which have decomposition into $\tau$ isotypic parts. If we restrict the action of $F$ to $M_{\tau}$, then $F$ sends $Q_{\ts}^{\smvee}$ to zero. To present $V^{-1}$, we define $V':M\to M$ as $V'(x)=F(\check{x})^{\smvee}$,  where $F(\check{x})^{\smvee}$ means to take the dual of $x$, apply $F$, and take the dual of the resulting vector. 
With respect to this choice of bases for $\qt,\qtsd$, for all $\tau\in\tg$, the matrix of $F$ %(respectively $V'$) 
restricted to $M_\tau$, that is $F: M_\tau=Q_{\tau} \oplus Q_{\tau^*}^{\smvee}\to M_{p\tau}=\qpt \oplus \qptsd$ is %described in Equation \ref{Eqn: Ftau V'tau}.
\begin{align}\label{Eqn: Ftau V'tau}
F_{\tau}= \begin{bmatrix}
   % & \qt & \qtsd \\
    %\qpt & 
    \phi_\tau & 0\\
    %\qptsd & 
    \psi_\tau & 0 \\
\end{bmatrix},%, &
%V'_{\tau} &= \kbordermatrix{   & \qt & \qtsd \\  \qpt & 0 & \psi_{\ts}\\    \qptsd & 0 & \phi_{\ts}  }.
\end{align}
where $\phi_\tau$ (respectively $\psi_\tau$) is the matrix of $\phi$ (respectively $\psi$) restricted to $Q_{\tau}$, that is $\phi_\tau:Q_\tau\to\qpt$ (respectively $\psi_\tau:\qt \to \qptsd$).
%it parameterizes the curve $\ct$, which is the normalization of the curve with affine equation
%$$C':y^l=(x-x_1)^{a(1)}(x-x_2)^{a(2)} \dots (x-x_r)^{a(r)}.$$
%Notice that when $l \neq a(1)+ \dots +a(r)$, $C'$ has singularity at $[0:1:0]$. And if $a(i)>1$, $C'$ also has singularity at $[x_i:0:1]$. We denote $C$ to be its normalization. Then, its Jacobian $J(C)$ is an abelian variety defined over $\fpb$ and thus has the associated mod $p$ Dieudonné module $(F,V,M,b)$ as described in section \ref{dieu}.
\end{remark}






%Let $Q=\ker(F)^{\smvee}$ and $Q_{\tau}=Q\cap M_{\tau}$. Then we have $M_{\tau}=Q_{\tau} \oplus Q_{\tau^*}^{\smvee}$. Note that by $Q_{\tau^*}^{\smvee}$ we mean $(Q_{\tau^*})^{\smvee}$, which is ditinct from $Q^{\smvee}\cap M_{\tau^*}$. Let $\pi_{\tau}$ be the projection from $M_{\tau}$ to $Q_{\tau}$, whose kernel is $Q_{\tau^*}^{\smvee}$.


\subsubsection{Elements in the Weyl group}

\newcommand{\EO}{Ekedahl--Oort }

\newcommand{\Sym}{{{\rm Sym}}}
By \cite{viehmann-wedhorn}, the \EO types associated with non-empty strata of $\shgf_{\fpb}$ are in one-to-one correspondence with certain elements in the Weyl group of the reductive group $\mathcal{G}$. We recall this construction.

Consider the set $${\rm Weyl}(G,f)=\prod_{\tau \in \tg}\Sym_{g(\OO)}/W_{f,\tau},$$
where, for each $\tau\in\tg$, $W_{f,\tau}=\Sym\{1, \dots,f(\tau)\} \times \Sym\{f(\tau)+1, \dots, g(\OO)\}.$
%
Then, the non-empty \EO strata of $\shgf_{\fpb}$ are in one-to-one correspondence with the cosets in ${\rm Weyl}(G,f)$ defined by elements
$w=(\wt\mid \tau\in\tg)\in \prod_{\tau \in \tg} \Sym_{g(\OO_\tau)}$ %/ W_{f,\tau} $ 
satisfying $$w_{\tau^*}(j)=g(\OO)+1-w_{\tau} (g(\OO)+1-j).$$ In particular, the open Ekedahl–Oort stratum corresponds to the unique element $w$ such that the permutations $\wt$ have maximum length, for all $\tau\in\tg$. 
%The modulo $p$ Dieudonn\'e modules in the corresponding isomorphism class are called $p$-ordinary. Since the notion depends on the Shimura datum $(G,f)$, in the following we also refer to it as $(G,f)$-ordinary at $p$.

The \EO type of $A$ is defined in terms of the canonical filtration of $M$, of length $2g=\dim(M)$,  obtained by repeatedly applying $F$ and $V^{-1}$ to $M$. By projecting the filtration to $M_{\tau}$, we obtain a filtration of $M_\tau$, of length $g(\OO_\tau)=\dim(M_{\tau})$,
$0\subsetneq M_{\tau,1} \subsetneq M_{\tau,2} \subsetneq \dots, \subsetneq M_{\tau,g(\OO)}=M_{\tau}.$
%
To each $\tau$, we associate a permutation $w_{\tau}\in \Sym_{g(\OO)}$ as follows. 
For $1\leq j\leq g(\OO)$, denote $\eta_{\tau,j}=\dim(\ker(F)\cap M_{\tau,j})$. Note that $\eta_{\tau,j}\leq \eta_{\tau,j+1}\leq \eta_{\tau,j}+1$. 
 Recall that by definition, the signature $\fb$ satisfies $f(\tau)=\dim(\ker(F)\cap M_{\tau})$ and $f(\tau)+f(\tau^*)=g(\OO)$.
We deduce that $0\leq \eta_{\tau,j}\leq f(\tau)$. We record the $k^{th}$ position at which the sequence of $\eta_{\tau,j}$ jumps by $j_{\tau,k}$. We obtain 
\begin{align}\label{Def_j}
1\leq j_{\tau,1}<j_{\tau,2}<\dots<j_{\tau,f(\tau)}\leq g(\OO)\end{align}
satisfying $\eta_{\tau,j_{\tau,k}}=\eta_{\tau,j_{\tau,k}-1}+1$. We denote by $i_{\tau,1}<\dots<i_{\tau,f(\tau^*)}$ the remaining indices, they satisfy  $\eta_{\tau,i_{\tau,k}}=\eta_{\tau,i_{\tau,k}-1}$. 

\begin{definition}\label{Def_EOword}
The \EO type of $A$ is the coset in ${\rm Weyl}(G,f)$ of the element $w=(w_\tau\mid \tau\in\tg)$ where  $w_{\tau} \in \Sym_{g(\OO_\tau)}$is given by
$$w_{\tau}(j_{\tau,k})=k \text{ and } w_{\tau}(i_{\tau,k})=f(\tau)+k.$$
\end{definition}
By definition, $w_\tau\in \Sym_{g(\OO_\tau)}$ satisfies the property 
\begin{equation}\label{wordproperty}
 \text{ if } j'< j \text{ and } \wt(j') > \wt(j) \text{ then }\wt(j) \leq f(\tau) < \wt(j')
\end{equation}
%Let $W_{f,\tau}=\Sym\{1, \dots,f(\tau)\} \times \Sym\{f(\tau)+1, \dots, g(\OO)\}$, and consider the set $\Sym_{g(\OO)}/W_{f,\tau}$. 
Furthermore, $\wt$ is the unique element in its coset in $S_{g(\OO)}/W_{f,\tau}$ that satisfies (\ref{wordproperty}).


\begin{lemma}\cite[Section 2.3.4]{Moonendimensionformula}\label{length}
The permutation $w_{\tau}\in \Sym_{g(\OO)}$ has length
$$\sum_{k=1}^{f(\tau)}j_{\tau,k}-w_{\tau}(j_{\tau,k})=\sum_{k=1}^{f(\tau^*)} w_{\tau}(i_{\tau,k})-i_{\tau,k}.$$
Moreover, this quantity is maximized if and only if $\ker(F)\cap M_{\tau,f(\tau^*)}=\{0\}$.
\end{lemma}
\begin{remark}\label{rmk}
The condition $\ker(F)\cap M_{\tau,f(\tau^*)}=\{0\}$ is equivalent to the equalities $j_{\tau,k}=\fts+k$ for $1\leq k\leq f(\tau)$,  and  $i_{\tau,k}=k$ for $1\leq k\leq \fts$. We deduce that $w_{\tau}$ has maximal length if and only if $w_{\tau^*}$ has maximal length, if and only if  
\[\wt(k)=\begin{cases} f(\tau)+k \text{ for } k\leq \fts,\\   k-\fts \text{ for } k>\fts.\end{cases} \]
\end{remark}



%%%%%%%%%%%%%%%%%%%

%With $G$ and $\fb$ being fixed, the Dieudonné module has additional structure given by the action of $F$ and $V$, and the structure can be parametrized by the $|G|$ tuple $(\wt)_{\tau \in \tg}$. Given $(\wt)_{\tau \in \tg}$, consider the following standard Dieudonné module $M((\wt)_{\tau})$: for each $\tau$, let $e_{\tau,1},\dots,e_{\tau,g(\OO)}\in M_{\tau}$ be a $\fpb$ basis of $M_\tau$. For each $1\leq i\leq g(\OO)$, we denote the $\fpb$ span of $\{e_{\tau,1},\dots,e_{\tau,i}\}$ as $M_{\tau,i}$. The duality of $M$ is given by $\check{e}_{\tau,j}=e_{\tau^*,g(\OO)+1-j}$. The set $\{e_{\tau,i_{\tau,1}},\dots, e_{\tau,i_{\tau,f(\ts)}}\}$ is a basis of $Q_{\tau}$ and $\{e_{\tau,j_{\tau,1}},\dots, e_{\tau,j_{\tau,f(\tau)}}\}$ is a basis of $Q_{\tau^*}^{\smvee}$.
%The action of $F$ and $V$ on $M_{\tau}$ is determined by the words $(\wt)_{\tau \in \tg}$ as follows:
%\begin{align*}
%F(e_{\tau,j})&=\begin{cases}
%    e_{p\tau,w_{\tau}(j)-f(\tau)} &\text{ if } w_{\tau}(j) \geq f(\tau)+1\\
%    0 &\text{ if } w_{\tau}(j) \leq f(\tau),
%    \end{cases}
%&
%V(e_{p\tau,j_1})&=\begin{cases}
%    0 &\text{ if } j_1 \leq f(\tau^*)\\
%    e_{\tau,w_{\tau}^{-1}(j_1-f(\tau^*))} &\text{ if } j_1 \geq f(\tau^*).
%   \end{cases}
%\end{align*}
%This can alternately be stated as
%\begin{align*}
%&F(e_{\tau,j})=e_{p\tau,\wt(j)-f(\tau)} &\text{and }& V(\check{e}_{p\tau,\wt(j)-f(\tau)})=\check{e}_{\tau,j}, & \text{if }& w_{\tau}(j) \geq f(\tau)+1,  \\
%&F(e_{\tau,j})=0 &\text{and }& V(\check{e}_{p\tau,\wt(j)+g(o)-f(\tau)})=0, &\text{if }& w_{\tau}(j) \leq f(\tau).
%\end{align*}

%It turns out that each mod $p$ Dieudonné module $(F,V,M,b)$ is isomorphic to $M((\wt)_{\tau})$, in which $((\wt)_{\tau})$ is the word obtained from $M$ by the algorithm described earlier in this subsection. Thus, the tuple of permutations $(\wt)_{\tau \in \tg}$ determines the isomorphism class of the Dieudonné module.
%That is, With $G$ and $\fb$ fixed, there is a one to one correspondence 
%\begin{align*}
 %  &\{ \text{ isomorphism classes of Dieudonné module } (F,V,M,b)\} \iff \\
%&\Big\{ (\wt)_{\tau \in \tg} \in \prod_{\tau \in \tg}W_{X,\tau} / S_{g(\OO)}\mid w_{\tau^*}(j)=g(\OO)+1-w_{\tau}(g(\OO)+1-j)\Big\}. 
%\end{align*}



%%%%%%%%%%%%%%%
%By \cite{viehmannwedhorn}, the non-empty \EO strata of $\shgf_{\fpb}$ are in one-to-one correspondence with the elements $w=(\wt)_{\tau \in \tg} \in \prod_{\tau \in \tg} \Sym_{g(\OO_\tau)}/ W_{f,\tau} $ satisfying $w_{\tau^*}(j)=g(\OO)+1-w_{\tau} (g(\OO)+1-j)$. In particular, the open Ekedahl–Oort stratum corresponds to the unique element $w$ such that the permutations $\wt$ have maximum length, for all$\tau\in\tg$. 
%The modulo $p$ Dieudonn\'e modules in the corresponding isomorphism class are called $p$-ordinary. Since the notion depends on the Shimura datum $(G,f)$, in the following we also refer to it as $(G,f)$-ordinary at $p$.

%We explicitly describe the $(G,f)$-ordinary mod $p$ Diedonn\'e module $(M,F,V,b)$. 

%Set $M=\oplus_{\tau\in \tg } M_\tau$, where each $\M_\tau$ is a $\fpb$-vector space of dimension $g(\tau)=g(\OO_\tau)$. 
%Let $\{e_{\tau,1},\dots,e_{\tau,g(\OO_\tau)}\}$ be a $\fpb$-basis of $M_\tau$, and denote the dual basis on $M_\tau^{\smvee}$ by $\{\check{e}_{\tau,j}\}$. 
%For each $1\leq i\leq g(\OO_\tau)$, we denote the $\fpb$ span of $\{e_{\tau,1},\dots,e_{\tau,i}\}$ as $M_{\tau,i}$. 
%Then the polarization $b$ on $M$, in terms of the induced isomorphisms $M_\tau^{\smvee}\simeq M_{\tau^*}$, is given by $\check{e}_{\tau,j}\mapsto e_{\tau^*,g(\OO)+1-j}$, for all $\tau\in\tg$ and $1\leq j\leq g(\OO_\tau)$.
%The action of $F$ and $V$ on $M$, when restricted to $M_\tau$ for $\tau\in\tg$, are given by

%\begin{definition}
    %The Dieudonné module $(F,V,M,b)$ with action of $G$ and signature $\fb$ is said to $p$-ordinary if its associated coset representatives $w_{\tau}$ is of maximal length for every $\tau$. Equivalently, $\ker(F)\cap M_{\tau,f(\tau^*)}=\{0\}$ for every $\tau$. 
%\end{definition}
%\begin{theorem}\cite{??}\label{Thm: mu ordinary p-ordinary}
%Suppose $A$ is parameterized by $\shgf$. Then $A$ is $p$-ordinary if and only if its associated Newton polygon is $\mu$-ordinary.
%\end{theorem}
%When the $(G,\fb)$ are fixed, $\tau\in T_G$, the permutation of maximal length is $\wt$ given by as follows: for $k\leq \fts$, $\wt(k)=f(\tau)+k$ and for $k>\fts$, $\wt(k)=k-\fts$.
    %$$\wt(j) = \begin{cases} j+\ft &\text{ if } j \leq g(\OO)-\ft \\ j+\ft-g(\OO) &\text{ if } j>g(\OO)-\ft \end{cases}$$
%Consequently, $(F,V,M,b)$ is $p$-ordinary if there is a basis $\{e_{\tau,j}: 1 \leq j \leq g(\OO)\}$ of $M_\tau$, such that 
%Then $F$ and $V$ acts as













\section{Reduction from abelian cover to cyclic covers}\label{reduction argument}
%In the previous sections we have been solely considering the family of cyclic covers of $\Po$.

In this section, we reduce the proof of Theorem \ref{abelian cover} to the case when $G$ is a cyclic group. More precisely, we show that an abelian $G$-cover of $\Po$ is $(G,\fb)$-ordinary if its cyclic quotients are. 
%As a result, to prove Theorem \ref{abelian cover} for abelian covers, it will suffice to prove it for certain Frobenius orbits of cyclic covers.

%We fix a finite abelian group $G$ such that $p\nmid |G|$. 
Recall the identification $\tg= \Hom(G,\C^*) =\Hom(G,\overline{\Q}^*)\simeq \Hom(G,\fpb^*)$, and consider the action of $\galq$ on $\tg$ by composition on the left. 
%Therefore, $\galq$ acts on $\tg$ and $\tgh$, such that for $\rho \in \tg$ and $\sigma \in \galq$, we have $\rho^{\sigma}(x)=\sigma(\rho(x))$. The $\galq$ action partitions $\tg$ into Galois orbit. On the other hand, 
For any subgroup $H \leq G$, we denote $$\tg^H= \{ \tau \in \tg | H \subseteq \ker(\tau)\}\text{ and }\tg^{H,\text{new}}=\{\tau \in \tg | H=\ker(\tau)\}.$$ For $H=\{1\}$, we also write $\tgun=\tg^{\{1\},\text{new}}$. %=\{\tau \in \tg| \ker(\tau)=\{1\}\}$. 
Consider the partition 
$$\tg=\bigcup_{\substack{H \leq G,\\ G/H \text{cyclic}}}\tguh=\coprod_{\substack{H \leq G,\\ G/H \text{cyclic}}}\tghn$$
Then the action of $\galq$ on $\tg$ preserve the partition, and for each $H$, with $G/H$ cyclic,  $\galq$ acts transitively on $\tghn$. 

%\begin{lemma}\label{galois orbit subgroup}
%$\galq$ acts transitively on $\tghn$.
%\end{lemma}
%\begin{proof}
% Suppose $\rho_1, \rho \in \tg$ both kernel $H$ and that $|G/H| \cong \Z/m\Z$. Choose $g \in G/H$ that generates $G/H$. Then $\rho(g)$ and $\rho_1(g)$ are $m^{th}$ root of unity, say $\rho(g)=\zeta_m$ and $\rho_1(g)=\zeta_m^a$ where $\gcd(a,m)=1$. Now there is a unique $\sigma_1\in \gal(\Q(\zeta_m)/\Q)$ that sends $\zeta_m$ to $\zeta_m^a$. This can be extended to $\sigma\in\galq$, so we have $\rho_1=\rho^{\sigma}$.
%\end{proof}

%\begin{lemma}\label{galois orbit subfield}
%   The subfields $K$ of the group algebra $\Q[G]$ are in one to one correspondence with $\galq$ orbits of $\tg$.
%\end{lemma}
%\begin{proof}
%Denote $R=\Q[G]$. Given a character $\tau\in \tg$, we obtain a ring homomorphism $\phi_{\tau}:R\to \overline{\Q}$. Denote its kernel as $\m_{\tau}=\ker(\phi_{\tau})$. First, we will show that this only depends on the Galois orbit of $\tau$. Consider $\sigma\in\gal(\overline{\Q}/\Q)$, then $\sum a_g g\in\m_{\tau}$ if and only if $\sum a_g \tau(g)=0$, which happens if and only if $\sum a_g \tau^{\sigma}(g)=0$, that is, $\sum a_g g\in\m_{\tau^{\sigma}}$. Therefore, the maximal ideal $\m_{\tau}$ only depends on the Galois orbit of $\tau$.

%Next, we will show that distinct Galois orbits give distinct maximal ideals. Suppose $\m_{\tau_1}=\m_{\tau_2}$, then $\phi_{\tau_1}(R)\cong R/\m_{\tau_1}\cong \phi_{\tau_2}(R)$. Extend this isomorphism to an automorphism $\sigma$ of $\overline{\Q}$. It follows that $\tau_2=\tau_1^{\sigma}$.

%Finally we show that all maximal ideals of $R$ are obtained as $\m_{\tau}$. Let $\m$ be a maximal ideal of $R$. Let $i$ be an embedding of $R/\m$ into $\C$. Define a character $\tau$ as $\tau(g)=i(g\pmod{\m})$. We see that $\m=\m_{\tau}$.
%\end{proof}

%From Lemma \ref{galois orbit subgroup} and Lemma \ref{galois orbit subfield}, we can index 
Recall the decomposition of $\Q[G]$ into the simple factors (\ref{simplefactors}),
%of $\Q[G]$ by the subgroups $H$ for which $G/H$ is cyclic. That is,
$$\Q[G] \cong \prod_{\substack{H \leq G,\\ G/H \text{ cyclic } }} K_H.$$
%Since $J(C)$ is a $\Z[G]$ module and $\Q[G]$ decomposes into products of fields $K$ corresponding to $\galq$ orbit of characters, $J(C)$ also decomposes, up to isogeny, to a direct sum of $\OO_{K}$ modules. Thus, we can write 
We denote the induced decomposition of $J(C)$ up to isogeny as
$$J(C) \sim \bigoplus_{\substack{H \leq G,\\ G/H \text{ cyclic } }} J(C)_{H}.$$
%In particular, when $G$ itself is cyclic, $H=\{1\}$ is among the subgroup such that $G/H$ cyclic. The component of $J(C)$ corresponding to $H=\{1\}$ is called the new part of the Jacobian.
\begin{definition}\label{definition of new part}
When $G$ a cyclic group, we call $J(C)^{\n}=J(C)_{\{1\}}$ the new part of the Jacobian.
\end{definition}

By construction, for any subgroup $H$ of $G$, with $G/H$ cyclic, after identifying $\mathcal{T}_{G/H}\simeq \tg^H$, we have
$$J(C/H)\simeq \bigoplus_{H\leq H'} J(C)_{H'}.$$
where the signature of the $G/H$-cover $C/H$ is $\fb_{G/H}=\fb_{\vert \tg^H}$ and the signature of the new part $J(C/H)^{\n}$ of $J(C/H)$ is $\fb_{G/H}^{\n}=\fb_{\vert T^{H,\n}_G}$.

From the formula computing  $\mu$-ordinary polygons, and the decomposition $\mu_p(G,\fb)=\oplus_{\OO\in\OO_G} \mu(\OO)$ arising from (\ref{simplefactors}), we deduce 
$$\mu_p(G,\fb)= \bigoplus_{\substack{H \leq G,\\ G/H \text{ cyclic } }} \mu_p(K_H,\fb_{G/H}^{\n}) \text{ where }
\mu_p(K_H,\fb_{G/H}^{\n})= \bigoplus_{\substack{\OO \in \OO_{G}\\ \OO\subseteq \mathcal{T}_{G/H}^{\n}}}\mu(\OO)$$
and 
$$\mu_p(G/H, \fb_{G/H})=\bigoplus_{\substack{\OO \in \OO_{G/H}}} \mu(\OO) \text{ where } \OO_{G/H}\simeq \{\OO\in\OO_G\mid \OO\subseteq \mathcal{T}_G^H\}.$$ 

In the following, we refer to the Newton polygon $\mu_p(K_H,\fb_{G/H}^{\n})$ as the $(K_H,\fb_{G/H}^{\n})$-ordinary polygon at $p$. By definition, it is the $\mu$-ordinary polygon at $p$ of a PEL type Shimura variety parametrizing abelian varieties with an action of the field $K_H$, and signature $\fb_{G/H}^{\n}$.

We deduce the following statement.
%Next, we explain how to compute the signature $\fb$ for the monodromy datum $(G,r,\au)$. Notice that $\fb$ does not depend on the point we choose for $\mgra$, so we might take any $\xb \in \mgra(\C)$ and consider $\ct$, which is now defined over $\C$. 
%The action of $G$ on $\ct$ makes the first Betti cohomology $H^1(\ct,\Q)$ into a $\Q[G]$ module, so $V(\ct)=H^1(\ct,\Q) \otimes_{\Q} \C$ is a $\Q[G] \otimes_{\Q} \C$ module. Since $\Q[G] \otimes_{\Q} \C \cong \prod_{\rho \in \tg}\C_{\rho}$, $V(\ct) \cong \bigoplus_{\rho \in T_G}V(\ct)_{\rho}$, where $g \in G$ acts on $V(\ct)_{\rho}$ via scalar multiplication by $\rho(g)$. 
%On the other hand, we have the Hodge decomposition $H^1(\ct,\Q) \otimes_{\Q} \C \cong H^1(\ct,\OO) \oplus H^0(\ct,\Omega)$. We denote  $H^0(\ct,\Omega)$ by $V^{+}(\ct)$ and $H^1(\ct,\OO)$ by $V^{-}(\ct)$. Since both are $\Q[G] \otimes_{\Q} \C$ modules, we have decomposition $V^{+}(\ct) \cong \bigoplus_{\rho \in \tg}V^{+}(\ct)_{\rho}$ and $V^{-}(\ct) \cong \bigoplus_{\rho \in \tg}V^{-}(\ct)_{\rho}$. We have the duality that $V^{+}(\ct)_{\rho}^{\smvee}=V^{-}(\ct)_{\check{\rho}}$. The signature $f_G: T_G \to \Z$ is given by $f(\rho)=\dim(V^+(\ct)_{\rho})$. 

%\begin{example}
%For $\xb\in \mgra$, let $\xbt$ be the reduction mod $p$. Then $V^+(C)$ is the complex analog of $Q^{\smvee}$, since $V^+(C)=H^0(C_{\xb},\Omega_C)$ and $Q^{\smvee}=H^0(C_{\xbt},\Omega_C)$. Similarly $V^-(C)$ is the complex analog of $Q$. The duality $V^{+}(C)_{\rho}^{\smvee}=V^{-}(C)_{\check{\rho}}$ is the analog of $(Q^{\smvee})_{\tau}=(Q_{\tau^*})^{\smvee}$.
%\end{example}
%\begin{example}
%In the case that $G$ is cyclic of order $l$, the characters are indexed by $i \in \Z/l\Z$, and the notation here corresponds the notations in section \ref{duality} as follows:  $V^{-}(C)_{\tau(i)^{\smvee}}=H^1(C,\OO_C)_{i^*}=Q_{i^*}$ with basis $\zeta_{i^*,j}$, $V^{+}(C)_{\tau(i)}=H^0(C,\Omega_C)_{i^*}=Q_{i^*}^{\smvee}$ with basis $\omega_{i^*,j}$, both with dimension $f(i)$, and the duality is given by residue pairing, as stated in Section \ref{duality}. On the other hand, $V(C)_{\tau(i)}=M_i=Q_i \oplus Q_{i^*}^{\smvee}$ has dimension $f(i^*)+f(i)=g(\OO)$ and is spanned by $\zeta_{i,j}$ and $\omega_{i^*,k}$. 
%\end{example}

%For $H \leq G$, $\tgh = \Hom(G/H,\qb)$. We have the inflation map $i: \tgh \to \tg$ that maps $\tau$ to $\rhot$, such that $\rhot(g)=\tau(gH)$. Then $i$ induces an bijection of $\tgh$ with $\tg^H$, as well as $\tghn$ with $\tgdhn$. Thus we have $\tg \cong \coprod_{\substack{H \leq G,\\ G/H \text{cyclic}}}\tgdhn$.
%We will now show that the signature map is compatible with inflation of characters.

%\begin{lemma}\label{inflation character}
%Let $H \leq G$ be a subgroup. Let $f_G:\tg \to \Z$ be the signature of $C$ and $\fgh: \tgh \to \Z$ be the signature of $C/H$. Then the following diagram commutes.
%\begin{equation*}\label{figure inflation of character}
%\begin{tikzcd}%[row sep=huge]
 %   \tgh \arrow[r,hook,"i"] \arrow{dr}[left]{\fgh} & T_{G} \arrow[d,"f_{G}"]\\ & \Z
%\end{tikzcd}
%\end{equation*}
%\end{lemma}
%\begin{proof}
%For $H \subseteq N \subseteq G$, we have $C/H \to \Po$ a cover with Galois group $G/H$, and $C/N$ a intermediate cover with Galois group $G/N$.
%We have the relation that $\text{V}^+(C/H)=\text{V}^+(C)^{H}$, where $\text{V}^+(C)^{H}$ denotes the subspace of $\text{V}^+(C)$ fixed by $H$. 
%Consequently, for $\tau \in \tgh$, $\text{V}^+(\ct/H)_{\tau}=(\text{V}^+(\ct)^{H})_{\tau}$. Let $\rhot=i(\tau)$ in $T_{G}$, then $ H\subseteq \ker(\rhot)$, so $(\text{V}^+(C)^{H})_{\tau}=\text{V}^+(C/H)_{\rhot}$. Therefore,
%\begin{equation*}
 %   \begin{split}
 %     \fgh(\tau)&=\dim(\text{V}^+(C/H)_\tau)    =\dim((\text{V}^+(C)^{H})_\tau)     =\dim(\text{V}^+(C)_{\rhot})    =f_G(\rhot).\qedhere
 %   \end{split}
%\end{equation*}
%\end{proof}


%Now, since $p \nmid |G|$, $p$ is unramified in any subfield of $\Q[G]$. Consequently, the image of any character of $G$ is a root of unity with order prime to $p$. We can fix an isomorphism $\iota: \C \to \C_p$ where $\C_p=\Hat{\xoverline{\Q_p}}$, which is the completion of an algebraic closure of $\Q_p$. Then $\tg$ can be identified as $\hom(G,\C_p)$, and for any $\rho \in \tg$, the image of $
%\rho$ is in $\Q_p^{nr}$, the maximal unramified extension of $\Q_p$ in $\xoverline{\Q_p}$.
%The Frobenius orbits of $\tg$ are determined by the action of the Frobenius automorphism $\sigma_p$ of $\gal(\Q_p^{un}/\Q_p)$ on $\tg$. Therefore, the partition of $\tg$ into Frobenius orbits is a refinement of the partition of $\tg$ into Galois orbits. That is, each Galois orbit is a finite union of Frobenius orbits. The inflation map $i$ induces the inclusion of Frobenius orbit $i: \ogh \to \og$. If $\OO_\tau$ is a Frobenius orbit of $\tgh$, then $i(\OO_\tau)=\OO_{\rhot}$ is a Frobenius orbit in $\tg$. 

%Since the signature map is compatible with inflation of character, we have the compatibility of $\mu$-ordinary component over each Frobenius orbit: 
%\begin{lemma}\label{mu ordinary polygon coincide}
%Let $\OO_{\tau} \in \ogh$ be a Frobenius orbit in $\tgh$ and $i(\OO_\tau)=\OO_{\rhot} \in \og$ be the image of inflation. Let $\mu(\OO_\tau)$ and $\mu(\OO_{\rhot})$ be the $\mu$-ordinary Newton Polygon at corresponding Frobenius orbits. Then $\mu(\OO_\tau)=\mu(\OO_{\rhot} )$.
%\end{lemma}
%\begin{proof}
%By the formula of $\mu$-ordinary Newton Polygon, the slopes and multiplicities are determined by $(f(\rho))_{\rho \in \orho}$. But $\fgh|_{\orho}=f_G|_{\ort}\circ i$ by Lemma \ref{inflation character}.
%\end{proof}
%If $H \leq G$ such that $G/H$ is cyclic, Then for the $G$ cover $C \to \Po$, $C/H \to \Po$ is an intermediate cyclic cover with Galois group $G/H$. We have the identification of $\text{W}(C/H)$ as the fixed subspace of $\text{W}(C)$ by $H$. That is, $\text{W}(C/H)=\text{W}(C)^{H}$.
%\begin{lemma}\label{mu ordinariness inflate}
%Let $\rho \in \tgh$ and $\rhot$ be its inflation to $\tg$. Then $\text{W}(C/H)_{\orho}$ is $\mu$-ordinary if and only if $\text{W}(C)_{\ort}$ is $\mu$-ordinary.
%\end{lemma}
%\begin{proof}
%By Lemma \ref{mu ordinary polygon coincide}, we have $\mu(\orho)=\mu(\ort)$. On the other hand, $\text{W}(C/H)_{\orho}=\text{W}(C)_{\orho}^{H}=W(C)_{\ort}$. Moreover, the action of Frobenius commutes with the quotienting of curves. Therefore, the characteristic polynomial of Frobenius on $\text{W}(C/H)_{\orho}$ is the same as that of $\text{W}(C)_{\ort}$. Thus, one Newton polygon is the same as $\mu(\orho)$ if and only if the other is. 
%\end{proof}

\begin{lemma}\label{equivalence two}
Let $G$ be an abelian group, and $p$ a prime $p\nmid |G|$. For $C \to \Po$ a $G$-cover of $\Po$ defined over $\fpb$, 
%parameterized by $\xb \in \mgra(\fpb)$. Then 
the following are equivalent:
\begin{enumerate}
    \item $J(C)$ is $(G,\fb)$-ordinary;
    \item $J(C/H)$ is $(G/H,\fb_{G/H})$-ordinary, for all $H \leq G$ with $G/H$ cyclic; 
    \item $J(C/H)^{\n}$ is $(K_H, \fb_{G/H}^{\n})$-ordinary, for all $H \leq G$ with $G/H$ cyclic.
\end{enumerate}
\end{lemma}
%\begin{proof}
%$1. \implies  2.$ Suppose $J(C)$ is $\mu$-ordinary. Then for each Frobenius orbit $\OO \in \og$, $\text{NP}(\text{W}(C)_{\OO})$ coincides with $\mu(\orho)$, so $\text{W}(C)_{\OO}$ is $\mu$-ordinary. Now, fix a subgroup $H \leq G$ such that $G/H$ is cyclic. For $\tau \in \tgdhn$, let $\rhot$ be its inflation to $\tg$. Since $\text{W}(C)_{\OO_{\rhot}}$ is $\mu$-ordinary, by Lemma \ref{mu ordinariness inflate}, we know that $\text{W}(C/H)_{\OO_{\tau}}$ is $\mu$-ordinary. Since this is true for all $\tau \in \tgdhn$, we conclude that $J(C/H)^\n$ is $\mu$-ordinary.

%$2. \implies 1.$ Suppose we have $J(C/H)^\n$ be $\mu$-ordinary for all $H$ for which $G/H$ is cyclic. Then for each $\OO_{\rhot} \in \og$, we pick $H=\ker(\rhot)$. Since $\rhot \in \tghn$, there exists $\tau \in\tgdhn$ such that $i(\tau)=\rhot$. Since $G/H$ is cyclic, $J(C/H)^\n$ is $\mu$-ordinary, so we know that $\text{W}(C/H)_{\orho}$ is $\mu$-ordinary. Therefore, $\text{W}(C)_{\ort}$ is $\mu$-ordinary. Since this is true for all $\rhot \in \tg$, $J(C)$ is $\mu$-ordinary.    
%\end{proof}


%The following Theorem will be proven in Section \ref{new part mu ordinary}.
%\begin{theorem}\label{new part mu ord}
 %   Suppose we are given a monodromy datum $(l,r,\au)$ and a prime $p$ such that $1 \leq a_k \leq l-1$, $\sum_{k=1}^r a_k \equiv 0 \pmod{l}$, $\gcd(a_1, \dots, a_r,l)=1$, $ r \leq 5$ and $p \nmid l, p > l(r-2)$.
  %  Then there exists a non-empty open subset $U \subseteq \mlra$ such that for all $\xb \in U$, $J(\ct)^\n$ is $\mu$-ordinary.
%\end{theorem}

%\begin{proof}[Reduction of Theorem \ref{abelian cover} assuming to Theorem \ref{new part mu ord}]
Since $\mu$-ordinariness is an open condition, Lemma \ref{equivalence two} reduces the proof of Theorem \ref{abelian cover} to the case of $G$ a cyclic group. 
Furthermore, by the remark below, we may assume that $G$ is cyclic of size $l\geq 3$.

\begin{remark}\label{R_assl3}
 Let $C$ is a cyclic cover of $\Po$ of degree $2$, branched at $r$ points. Assume $r\leq 5$.  Since the number of branched points of a cover of degree $2$ is even, we deduce that $r\leq 4$. If $r=2$, the genus of $C$ is $0$.
 If $r=4$, the genus of $C$ is $1$, and $C$ is generically ordinary.
\end{remark}

\begin{example}\label{MoonenOort}
We cite an example from \cite{MoonenOort} to illustrate how to compute the quotient covers and their signatures.
Consider the abelian monodromy datum $(\Z/2\Z \times \Z/6\Z, 4, (1,0),(1,1),(0,2),(0,3))$. Then $\tg$ has size 12; for $0\leq i\leq 1$ and $0\leq j\leq 5$, we denote by
 $\kij\in\tg$ the character given by  $\chi_{i,j}(a_1,a_2)=\zeta_6^{3a_1i+a_2j}$, for
 $\zeta_6=e^{\pi i/3}\in \C$ is a primitive sixth root of unity.
Then $\tg$ is  partitioned into the following $8$ Galois orbits:
\begin{equation*}
(\chi_{0,0}),(\chi_{0,1},\chi_{0,5}),
(\chi_{0,2},\chi_{0,4}),(\chi_{0,3}),
(\chi_{1,0}),(\chi_{1,1},\chi_{1,5}),
(\chi_{1,2},\chi_{1,4}),(\chi_{1,3}), 
\end{equation*}
Denote $C_{\kij}=C/\ker(\kij)$. The $8$ Galois orbits lead to $8$ quotient curves, we illustrate one of them.
%\begin{enumerate}
    %\item 
    Consider the Galois orbit $(\chi_{1,2},\chi_{1,4})$. Let $\rho=\chi_{1,2}$, $H=\ker(\rho)=\{(0,0),(0,3)\}$. The monodromy datum of $C_{\rho}$ is $(6,3,(3,5,4))$. This is because $|\rho(G)|=6$ and $\rho(\au_i)=\zeta_6^{\ub_i}$ where $\ub=(3,5,4,0)$. Thus, $C_\rho$ is the normalization of $y^6=(x-x_1)^3(x-x_2)^5(x-x_3)^4$.
    The characters whose kernel contains $\ker(\rho)$ are $\{\chi_{0,0},\chi_{1,2},\chi_{0,4},\chi_{1,0},\chi_{0,2},\chi_{1,4}\}$, and they arise by inflation from the characters of $G/H$. We can compute their signature via (\ref{signature}), for $1\leq i\leq 5$
    $$f_G(\chi_{i,2i})=f_{G/H}(i^{-1}(\chi_{i,2i}))=f_{G/H}(\rho^i)=\langle\frac{-3i}{6}\rangle+\langle\frac{-5i}{6}\rangle+\langle\frac{-4i}{6}\rangle-1.$$
    Hence, the signature $\fb_G$ on $\{\chi_{0,0},\chi_{1,2},\chi_{0,4},\chi_{1,0},\chi_{0,2},\chi_{1,4}\}$ takes values $\{0, 0,0,0,0,1\}$. We dedue that $J(C_\rho)$ is an elliptic curve, with complex multiplication by $K_6=\Q(\zeta_6)$.
%    \item Consider the Galois orbit $(\chi_{0,1},\chi_{0,5})$. Let $\rho=\chi_{0,1}$, so $H=\ker(\rho)=\{(0,0),(1,0)\}$. Then $C_\rho$ has monodromy datum $(6,3,(1,2,3))$; $C_\rho$ is the normalization of $y^6=(x-x_2)(x-x_3)^2(x-x_4)^3$.
%    \item Consider the Galois orbit $(\chi_{1,1},\chi_{1,5})$. Let $\rho=\chi_{1,1}$, $H=\ker(\rho)=\{(0,0),(1,3)\}$. Then $C_\rho$ has monodromy datum $(6,4,(3,4,2,3))$. So $C_\rho$ is the normalization of $y^6=(x-x_1)^3(x-x_2)^4(x-x_3)^2(x-x_4)^3$.
%\end{enumerate}
%Therefore, assuming $J(C/H)^{\n}$ is generically $\mu$-ordinary for any $H$ with $G/H$ cyclic, by Lemma~\ref{equivalence two} we deduce that $J(C)$ is generically $\mu$-ordinary.
\end{example}


%Then we see from Theorem \ref{new part mu ord} that each $J(C/H)^{\n}$ is generically $\mu$-ordinary. In other words, for each of the eight subgroup $H \subseteq G$ such that $G/H$ is cyclic, there is a dense open subset $U_H \subseteq \mathcal{M}(m_H,N_H,\ub_H)$ such that for $\xb=(x_1,x_2,x_3,x_4) \in U_H$, $J(\ct/H)^{\n}$ is $\mu$-ordinary. Then for $\xb \in \cap_{H \subseteq G, G/H \text{ cyclic }}U_H$, $J(\ct/H)$ is $\mu$-ordinary for all such $H$, so $J(\ct)$ is $\mu$-ordinary by Lemma \ref{equivalence two}.


%\section{Jacobian of abelian cover is $\mu$-ordinary}\label{final part}
%The argument above can be generalised to show that Theorem \ref{new part mu ord} implies Theorem \ref{abelian cover}.
%Let $G$ be a finite abelian group. Consider monodromy datum $(G,r,\underline{a})$ and a prime $p$ satisfying the following condition:
%\begin{enumerate}
 %   \item $r\leq 5$ 
 %   \item $\sum_{k=1}^r \au(k)=0$ in $G$.
  %  \item $(\au(1), \dots, \au(r))$ generate $G$.
  %  \item $p \not\;\mid |G|$, and $p>l(r-1)$, where $l$ is the exponent of $G$.
%\end{enumerate}
%We want to show that there exists a curve $\xb \in \mgra$ such that $J(\ct)$ is  $\mu$-ordinary. By Lemma \ref{equivalence two}, $J(\ct)$ is $\mu$-ordinary iff for every $H \subseteq G$ such that $G/H$ is cyclic, $J(C/H)^\n$ is $\mu$-ordinary.

%\begin{proof}[Proof of Theorem \ref{abelian cover} assuming Theorem \ref{new part mu ord}]
  %  Fix the monodromy $\gra$ and consider $H \leq G$ such that $G/H$ is cyclic. Pick $\tau \in \tghn$. Then $\ct/H \cong C_{\tau,\underline{x}}$, with monodromy datum $(l_H,r_H,\ub_H)$, where $l_H=|\tau(G)|=|G/H|$, $\ub_H=(b_1,\dots,b_r)$ such that $\tau(\au_i)=\zeta_l^{b_i}$, and $r_H$ is the number of non-zero $b_i$. The datum $(l_H,r_H,\ub_H)$ satisfies the condition for Theorem \ref{new part mu ord}, so there exists a non-empty, open $U_H \subseteq \mathcal{M}(l_H,r_H,\ub_H)$ such that for every $\xb \in U_H$, $J(C_{\tau,\xb})^{\n}$ is $\mu$-ordinary.

 %   Now, for each $H \leq G$, there is a surjective map $\pi_H: \mgra \to \mathcal{M}(l_H,r_H,\ub_H)$. Therefore, $\pi_H^{-1}(U_H) \subseteq \mgra$ is non-empty and open. Let $U=\bigcap_{\substack{H \leq G \\ G/H \text{cyclic}}} \pi_H^{-1}(U_H)$. Since $\mgra$ is irreducible, $U$ is non-empty. Then given $\xb \in U$, $\pi_H(\xb) \in U_H$ for every $H \leq G$ for which $G/H$ is cyclic. Therefore, $J(\ct/H)^{\n}$ is $\mu$-ordinary for each $H$ by Theorem \ref{new part mu ord}. Therefore, $J(\ct)$ is $\mu$-ordinary by Lemma \ref{equivalence two}.
%\end{proof}































\section[]{A criterium of $p$-ordinariness for Hasse--Witt triples}\label{combi}

Let $(G,r,\au)$ be an abelian monodromy datum as in Definition \ref{monodromy datum}, and consider the associated Shimura datum $(G,\fb)$ as defined in Section \ref{Shimura}. Assume $p$ is a prime not dividing $|G|$. In this section, we give an explicit numerical criterion (Theorem \ref{numerical criteria}) for  Hasse--Witt triples of covers of $\Po$ with monodromy $(G,r,\au)$ to be $(G,\fb)$-ordinary. We deduce the statement from \cite[Theorem 1.3.7]{MoonenEOtypeformula}, which when specialized to our context states that a mod $p$ Diedonn\'e module is $p$-ordinary if, for each $\tau\in\tg$, the associated word $\wt$ has maximal length. Our criterion is stated as finitely many rank conditions on iterations of  the extended Hasse--Witt matrix.
 
%For the rest of this section, we fix a Frobenius orbit $\OO\in \og$, and consider $\tau\in\OO$.


In the following,  $\OO\subseteq \mathcal{T}_G$ is a Frobenius orbit, and we assume $\tau\in\OO$.

With the notations from Section \ref{dieu}, given an \EO type $w=(w_\tau\mid \tau\in \mathcal{T}_G)$ as in Definition \ref{Def_EOword},  we describe the associated mod $p$ Diedonn\'e module $(M,F,V,b)$ with a $(G,\fb)$-structure (that is, an action of $G$ of signature $\fb$). 
Let ${e_{\tau,1},\dots, e_{\tau,g(\OO)}}$ be a basis of $M_{\tau}$, and $f(\tau)=\dim(\ker(F)\cap M_{\tau})$.
For suitable
increasing sequences $1\leq j_{\tau,1}<j_{\tau,2}<\dots<j_{\tau,f(\tau)}\leq g(\OO)$ and $1\leq i_{\tau,1}<\dots<i_{\tau,f(\tau^*)}\leq g(\OO)$ satisfying 
$\{j_{\tau,1},\dots,j_{\tau,f(\tau)}\}\cup\{,i_{\tau,1},\dots,i_{\tau,f(\tau^*)}\}=\{1,\dots,g(\OO)\}$, the word $w_{\tau}$ associated to $(M,F,V,b)$ is given by $$w_{\tau}(j_{\tau,k})=k \text{ and }w_{\tau}(i_{\tau,k})=f(\tau)+k.$$ 
From Equation (\ref{Eq_MFVb}), the action of $F$ and $V$ on $M_{\tau}$ is determined by  $w=(\wt)_{\tau \in \tg}$ as 
\begin{align}\label{Eq_F}
F(e_{\tau,j})&=\begin{cases}
    e_{p\tau,w_{\tau}(j)-f(\tau)} &\text{ if } w_{\tau}(j) \geq f(\tau)+1\\
    0 &\text{ if } w_{\tau}(j) \leq f(\tau)
    \end{cases},
&
V(e_{p\tau,j_1})&=\begin{cases}
    0 &\text{ if } j_1 \leq f(\tau^*)\\
    e_{\tau,w_{\tau}^{-1}(j_1-f(\tau^*))} &\text{ if } j_1 \geq f(\tau^*)+1.
    \end{cases}
\end{align}
%By Lemma \ref{length}, the word $w_{\tau}$ is maximal if $i_{\tau,t}=t$ and $j_{\tau,t}=f(\tau^*)+t$, for all $1\leq t\leq f(\tau^*)$.

\begin{lemma}\label{Lem: 2 technical lemma w tau}
Given $\tau\in\OO$ and $1\leq k\leq g(\OO)$, there exists $k' \in \mathbb{N}$ such that $1\leq k'\leq g(\OO)$ and
$$\{w_{\tau}(j)-f(\tau)\mid 1\leq j\leq k, w_{\tau}(j)> f(\tau)\} =\{1,2,\dots,k'\}.$$
Further, we have $k'\leq \min(k,f(\tau^*))$.
Moreover, if $w_{\tau}$ is maximal then we have $k'=\min(k,f(\tau^*))$.
\end{lemma}
\begin{proof}

Firstly, note that $\{j\mid w_{\tau}(j)> f(\tau)\}=\{i_{\tau,1},\dots,i_{\tau,f(\tau^*)}\}$.
Let $k'=\max\{a \mid 1\leq a\leq f(\tau^*),  i_{\tau,a}\leq k\}$. Set $k'=0$ if $k<i_{\tau,1}$. We see that $\{j\mid 1\leq j\leq k, w_{\tau}(j)> f(\tau)\}=\{i_{\tau,1},\dots,i_{\tau,k'}\}$.
Therefore,
\[\{w_{\tau}(j)-f(\tau)\mid 1\leq j\leq k, w_{\tau}(j)> f(\tau)\} =\{1,2,\dots,k'\}.\]
It is clear that $k'\leq f(\tau^*)$.
Further, since $a\leq i_{\tau,a}$, we have $k'\leq i_{\tau,k'}\leq k$. This shows that $k'\leq \min(k,f(\tau^*))$.
If $w_{\tau}$ is maximal, then we have $i_{\tau,a}=a$. Therefore,
\begin{itemize}
    \item if $f(\tau^*)\leq k$, then we have $k'=f(\tau^*)$.
    \item On the other hand, if $f(\tau^*)\geq k$, then we have $k'=k$.
\end{itemize}
We see that in both cases we have $k'=\min(k,f(\tau^*))$.
\end{proof}
We deduce the following lemma. Recall, for $1\leq k\leq g(\OO)$,
$M_{\tau,k}$ denotes the subspace of $M_\tau$ spanned by $e_{\tau,1},\dots, e_{\tau,k}$.
\begin{lemma}\label{F}
Given $\tau\in\OO$ and $1\leq k\leq g(\OO)$, let $l=\dim(F(M_{\tau,k}))$. Then $F(M_{\tau,k})=M_{p\tau,l}$ and $l\leq \min(k,f(\tau^*))$. Moreover, if $w_{\tau}$ is maximal, then $l= \min(k,f(\tau^*))$.
\end{lemma}
\begin{proof}
We know that $F(M_{\tau,k})$ is spanned by $\{F(e_{\tau,1}),\dots,F(e_{\tau,k})\}$. Therefore, it is spanned by
$$\{e_{p\tau,w_{\tau}(j)-f(\tau)}\mid 1\leq j\leq k, w_{\tau}(j)\geq f(\tau)+1\}.$$
This set is also linearly independent and hence forms a basis of $F(M_{\tau,k})$. Consider the $k'$ given by Lemma \ref{Lem: 2 technical lemma w tau}, we see that $F(M_{\tau,k})=M_{p\tau,k'}$. Since $l=\dim(F(M_{\tau,k}))$, we see that $l=k'$. Therefore, Lemma \ref{Lem: 2 technical lemma w tau} tells us that $l\leq \min(k,f(\tau^*))$ and if $w_{\tau}$ is maximal then $l=\min(k,f(\tau^*))$.
\end{proof}





 From Remark \ref{Rem_EOHassetrople}, recall $M_{\tau}=Q_{\tau}\oplus Q_{\ts}^{\smvee}$, where $Q_\tau$ is spanned by $\{e_{\tau,i_{\tau,1}},\dots, e_{\tau,i_{\tau,f(\ts)}}\}$ and $Q_{\tau^*}^{\smvee}$ by 
$\{e_{\tau,j_{\tau,1}},\dots, e_{\tau,j_{\tau,f(\tau)}}\}$; $\pi_{\tau}:M_{\tau}\to Q_{\tau}$ denotes the canonical projection, with kernel $Q_{\tau^*}^{\smvee}$.


Define $V': M\to M$ by
\begin{align}\label{Eq_V'}
 V'(e_{\tau,j})= F(\check{e}_{\tau,j})^{\smvee}, 
 \end{align}
for any $\tau\in \OO$, $1\leq j\leq g(\OO)$, and Frobenius orbit $\OO$.



\begin{lemma}\label{FV'}
Let $F:M\to M$ as in (\ref{Eq_F}) and $V': M\to M$ as in (\ref{Eq_V'}).
%\end{align*}
Then   
\begin{enumerate}
    \item $\ker(V')=Q$;
    \item $\rm{Im}(F) \cap \rm{Im}(V')=\{0\}$;
    \item if $W\subseteq M_{\tau}$ is  spanned by a subset of $\{e_{\tau,1}, \dots e_{\tau, g(\OO)}\}$, then $(F+V')(W)=F(W)\oplus V'(W)$.
\end{enumerate}
\end{lemma}
\begin{proof}
1) For $x \in M$, we have $V'(x)=0$ if and only if $F(\check{x})=0$. This is equivalent to $\check{x}\in \check{Q}$, which happens if and only if $x\in Q$. Therefore, $\ker(V')=Q$.

2) By definition, $\im(V')\subseteq \im(F)^{\smvee}$ and $\im(F)\cap \im(F)^{\smvee}=\{0\}$.

3) From (\ref{Eq_F}) and (\ref{Eq_V'}) combined,
\begin{equation*}
    (F+V')(e_{\tau,j})=\begin{cases}
     F(e_{\tau,j})  &\text{if }  \wt(j)>f(\tau)\\
     V'(e_{\tau,j})  &\text{if } \wt(j)\leq f(\tau).
    \end{cases}
\end{equation*}
This implies that $(F+V')(W)=F(W)+V'(W)$. Hence, the statement follows from part 2.
\end{proof}



%For any Frobenius orbit $\OO$, we denote by $f_{\OO,1}<f_{\OO,2}<\dots< f_{\OO,s(\OO)}$ the distinct values in $\{\fts\mid \tau\in \OO\}$, $s(\OO)=\#\{\fts\mid \tau\in \OO\}$. For each $1\leq u\leq s(\OO)$, we choose $\tau_{\OO,u}\in\OO$ satisfying $f(\tau_{\OO,u}^*)=f_{\OO,u}$.

For $\tau\in\OO$ and $1\leq j_2\leq j_3\leq g(\OO)$, we denote $M_{\tau,j_2,j_3}=\Span\{e_{\tau,j_2}, \dots, e_{\tau,j_3}\}$. 

\iffalse
\begin{lemma}
 Also, given any $x\in \check{Q}$, we have $V(V'(x))=x$. Finally, given a subspace $W\subseteq M_{\tau}$ which is spanned by some vectors of the standard basis $\{e_{\tau,j}\}$, we have $V^{-1}(W)\cap M_{p\tau}=F(M_{\tau})\oplus V'(W)$.
\end{lemma}
\begin{proof}
Now consider $x \in \Check{Q}$, we want to show that $V(V'(x))=x$. Notice that $\check{Q}$ is spanned by $\check{e}_{\tau,j}$ such that $w_{\tau}(j) \geq f(\tau)+1$. Moreover, for such $\check{e}_{\tau,j}$, we have
\begin{equation*}
    \begin{split}
    V(V'(\check{e}_{\tau,j})) &=V(F(e_{\tau,j})^{\smvee})
    =V(\check{e}_{p\tau,w_{\tau}(j)-f(\tau)})
    =\check{e}_{\tau,j}.
    \end{split}
\end{equation*}
This shows that for any $x\in \check{Q}$, we have $V(V'(x))=x$.

Next, consider $W \subseteq M_\tau$. Firstly, since $W$ has a basis consisting of $e_{\tau,j}$ we see that $W=(W\cap Q_{\tau})\oplus(W\cap Q_{\tau^*}^{\smvee})$. Let $W_1=W\cap Q_{\tau}$ and $W_2=W\cap Q_{\tau^*}^{\smvee}$. We see that
$$V(F(M_{\tau})+V'(W))=V(V'(W))=V(V'(W_2))=W_2\subseteq W.$$
This means that $F(M_{\tau})+V'(W)\subseteq V^{-1}(W)\cap M_{p\tau}$. Next consider $y\in V^{-1}(W)\cap M_{p\tau}$. So $V(y)\in W\cap \im(V)=W_2$, and hence $V(V'(V(y)))=V(y)$. This means that $V'(V(y))-y\in \ker(V)=\im(F)$. Therefore, $y= (y-V'(V(y)))+V'(V(y))\in F(M_{\tau})+V'(W)$. We have shown that $V^{-1}(W)\cap M_{p\tau}=F(M_{\tau})+ V'(W)$.
Finally, since $\im(F) \cap \im(F)^{\smvee}= \{0\}$, the sum is a direct sum. 
\end{proof}
\fi





\begin{lemma}\label{V'stream} Let $F:M\to M$ as in (\ref{Eq_F}) and $V':M\to M$ as in (\ref{Eq_V'}). Let $\tau\in \OO$. Assume $\wt$ is maximal. Then,
\begin{enumerate}
    \item 
for $\fts \leq j_1<j_2\leq j_3$: $V'(M_{\tau,j_1})=M_{p\tau,\fts+1,j_1}$, and $V'(M_{\tau,j_2,j_3})=M_{p\tau,j_2,j_3}$. 
\item for  $1\leq j\leq g(\OO)$: $(F+V')(M_{\tau,j})=M_{p\tau,j}$.
\end{enumerate}
\end{lemma}
\begin{proof}
By Lemma \ref{length}, since the word $w_{\tau}$ is maximal, we have $i_{\tau,t}=t$ for $1\leq t\leq \fts$ and $j_{\tau,t}=f(\tau^*)+t$ for $1\leq t\leq f(\tau)$.
Now, for $1\leq t\leq f(\ts)$, we have $F(e_{\tau,t})=e_{p\tau,t}$ and $V'(e_{\tau,t})=0$. Whereas for $\fts<t\leq j$, we have $F(e_{\tau,t})=0$ and $V'(e_{\tau,t})=e_{p\tau,t}$.
The result follows.
\end{proof}

%\begin{lemma}\label{Lem: F,V' in F+V'}
%\end{lemma}








\begin{proposition}\label{criteriasecond}
For  $\tau \in \OO$ and $0\leq i\leq |\OO|-1$, define $H_{\tau,i}: M_{p^i\tau} \to M_{p^{i+1}\tau}$ as
\begin{equation}\label{Eq_H}
    H_{\tau,i}(x)=\begin{cases}
    F(x) &\text{if } f(p^i\tau^*)\geq f(\tau^*)\\
    F(x)+V'(x) &\text{if } f(p^i\tau^*)< f(\tau^*).
    \end{cases}
\end{equation}

Let $\tau\in \OO$. Assume 
\begin{enumerate}
    \item $\dim(\pi_{\tau}\circ H_{\tau,|\OO|-1}\circ\dots H_{\tau,1}\circ H_{\tau,0}(M_{\tau}))=f(\tau^*)$;
    \item if $\tau'\in\OO$ satisfies $f(\tau'^*)<f(\tau^*)$, then $w_{\tau'}$ maximal.
\end{enumerate}
Then, 
\begin{enumerate}
   \item for any $0\leq i\leq |\OO|-1$:  $H_{\tau,i}\circ \dots H_{\tau,1}\circ H_{\tau,0}(M_{\tau})=M_{p^{i+1}\tau,f(\tau^*)}$;
    \item $w_{\tau}$ is maximal;
%\end{enumerate}
%Furthermore, 
\item $w_{\tau'}$ is  maximal for any $\tau'\in\OO$ satisfying $f(\tau'^*)=f(\tau^*)$.
   % \begin{enumerate}
    %\item[(3)] $\dim(\pi_{\tau'} \circ H_{\tau',|\OO|-1} \circ \dots \circ H_{\tau',0}(M_{\tau'}))=f(\tau^*)$.
    %\item[(4)] %if $\tau'\in\OO$ satisfies $f(\tau'^*)=f(\tau^*)$, then 
   
\end{enumerate}
\end{proposition}
\begin{proof}
 We prove part (1)  by induction on $i$. First, consider the base case $i=0$. We have $H_{\tau,0}=F$. Since $\dim(F(M_{\tau}))=\fts$, by Lemma \ref{F}, we have $F(M_{\tau})=M_{p\tau,\fts}$. Next, suppose that for some $i\geq 1$, we have $H_{\tau,i-1}\circ \dots H_{\tau,1}\circ H_{\tau,0}(M_{\tau})=M_{p^{i}\tau,f(\tau^*)}$.
\begin{itemize}
    \item Case 1: $f(p^{i}\ts)\geq \fts$. Then $H_{\tau,i}=F$. Let $l=\dim(F(M_{p^{i}\tau,f(\tau^*)}))$. By Lemma \ref{F}, we have $F(M_{p^{i}\tau,f(\tau^*)})=M_{p^{i+1}\tau,l}$. Clearly we have $l=\dim(F(M_{p^{i}\tau,f(\tau^*)}))\leq \dim(M_{p^{i}\tau,f(\tau^*)})=\fts$. Further,
    \begin{equation*}
        \begin{split}
         \fts&=\dim(\pi_{\tau}\circ H_{\tau,|\OO|-1}\circ\dots H_{\tau,1}\circ H_{\tau,0}(M_{\tau}))\\
         &=\dim(\pi_{\tau}\circ H_{\tau,|\OO|-1}\circ\dots \circ H_{\tau,i+1}(M_{p^{i+1}\tau,l}))
         \leq \dim(M_{p^{i+1}\tau,l})=l.
        \end{split}
    \end{equation*}
    Therefore, $l=\fts$.
    \item Case 2: $f(p^{i}\ts)< \fts$. Then $H_{\tau,i}=F+V'$ and $w_{p^i\tau}$ is maximal. Therefore by Lemma \ref{V'stream}, we have
    $$H_{\tau,i}\circ \dots H_{\tau,1}\circ H_{\tau,0}(M_{\tau})=(F+V')(M_{p^{i}\tau,f(\tau^*)})=M_{p^{i+1}\tau,\fts}.$$
\end{itemize}
This completes the induction step and hence completes the proof of 1).

From part (1), we know that $H_{\tau,|\OO|-1}\circ \dots H_{\tau,1}\circ H_{\tau,0}(M_{\tau})=M_{\tau,f(\tau^*)}$. Thus we know that $\dim(\pi_{\tau}(M_{\tau,\fts}))=\fts$. This means that $M_{\tau,\fts}\cap \ker(\pi_{\tau})=\{0\}$, that is, $M_{\tau,\fts}\cap \ker(F)=\{0\}$. By Lemma \ref{length}, $w_{\tau}$ is  maximal; this concludes part (2).


Suppose $\tau'\in \OO$ satisfies $f(\tau')=\fts$. By part (2), it suffices to 
 prove that $$\dim(\pi_{\tau'} \circ H_{\tau',|\OO|-1} \circ \dots \circ H_{\tau',0}(M_{\tau'}))=f(\tau^*).$$ 
Write $\tau'=p^i\tau$, for some $1\leq i\leq |\OO|-1$.
Then
\begin{itemize}
    \item For $0 \leq j \leq |\OO|-i-1$: $H_{\tp,j}=H_{\tau,j+i}$.
    \item For $|\OO|-i \leq j \leq |\OO|-1: H_{\tp,j}=H_{\tau, j+i-|\OO|}$.
\end{itemize}
Since $H_{\tp,0}=F$, we have $$H_{\tp,0}(M_{\tp})=F(M_{\tp})=M_{p\tp,\fts}=H_{\tau,i}\circ \dots H_{\tau,1}\circ H_{\tau,0}(M_{\tau}).$$
This implies that
$$H_{\tau',|\OO|-i-1}\circ \dots H_{\tau',1}\circ H_{\tau',0}(M_{\tau'}) =H_{\tau,|\OO|-1}\circ \dots H_{\tau,i+1}\circ H_{\tau,i}\circ \dots H_{\tau,1}\circ H_{\tau,0}(M_{\tau})=M_{\tau,\fts}.$$
Since $\wt$ is maximal, from Lemma \ref{F}, we know that $F(M_{\tau,\fts})=M_{p\tau,\fts}=F(M_{\tau})$. This means that $H_{\tau,0}(M_{\tau,\fts})=H_{\tau,0}(M_{\tau})$. Now, we see that
\begin{equation*}
    \begin{split}
    H_{\tau',|\OO|-1}\circ \dots H_{\tau',1}\circ H_{\tau',0}(M_{\tau'}) &=H_{\tau',|\OO|-1}\circ \dots\circ H_{\tau',|\OO|-i}(M_{\tau,\fts})\\ &= H_{\tau,i-1}\circ \dots\circ H_{\tau,0}(M_{\tau,\fts})\\
    &= H_{\tau,i-1}\circ \dots\circ H_{\tau,0}(M_{\tau}).\\
    %&=M_{p^i\tau,\fts}=M_{\tau',\fts}.
    \end{split}
\end{equation*}
Next, note that since $\ker(\pi_{\tau'})=Q_{\tau'^*}^{\smvee}=\ker(F_{\tau'})$, all subspaces $W\subseteq M_{\tau'}$ satisfy $\dim(\pi_{\tau'}(W))=\dim(F(W))$. Therefore, we see that
\begin{equation*}
    \begin{split}
    \dim(\pi_{\tau'} \circ H_{\tau',|\OO|-1} \circ \dots \circ H_{\tau',0}(M_{\tau'}))
    &= \dim(F(H_{\tau,i-1}\circ \dots \circ H_{\tau,0}(M_{\tau})))\\
    &=\dim(H_{\tau,i}\circ H_{\tau,i-1}\circ \dots\circ H_{\tau,0}(M_{\tau}))\\
    &=\dim(M_{p^{i+1}\tau,\fts})=\fts. \qedhere
    \end{split}
\end{equation*}
\end{proof}



%\begin{lemma}\label{nointersection}
%If $W_1,W_2$ are sub-spaces spanned by the standard basis $\{e_{\tau,j}\}$ and if $W_1 \cap W_2 =\{0\}$, then $F(W_1) \cap F(W_2)= \{0\}$ and $V'(W_1) \cap V'(W_2)=\{0\}$
%\end{lemma}
%\begin{proof}
%Notice that $F$ or $V'$ never map $e_{\tau,j_1}$ and $e_{\tau,j_2}$ to the same $e_{p\tau,j_3}$.
%\end{proof}










Let %$s(\OO)$ denote the number of distinct values in $\FF(\OO)={\fts\mid \tau\in \OO\}$; denote by 
$f_{\OO,1}<f_{\OO,2}<\dots< f_{\OO,s(\OO)}$ denote the distinct values in $\FF(\OO)=\{\fts\mid \tau\in \OO\}$. For each $1\leq u\leq s(\OO)$, we choose $\tau_{\OO,u}\in\OO$ satisfying $f(\tau_{\OO,u}^*)=f_{\OO,u}$.


\begin{proposition}\label{criteriathird}
%Notation as in Proposition \ref{criteriasecond}. 
For $\tau\in \OO$ and $0\leq i\leq |\OO|-1$,  denote $H_{\tau,i}: M_{p^i\tau}\to M_{p^{i+1}\tau}$ as in (\ref{Eq_H}) and define $L_{\tau,i}: M_{p^i\tau}\to M_{p^{i+1}\tau}$ as 
\begin{equation}\label{Eq_L}
    L_{\tau,i}(x)=\begin{cases}
    F(x) &\text{if } f(p^i\tau^*)\geq f(\tau^*)\\
    V'(x) &\text{if } f(p^i\tau^*)< f(\tau^*).
    \end{cases}
\end{equation}



Let $2\leq u\leq s(\OO)$; write $\tau=\tau_{\OO,u}$ and $\tau'=\tau_{\OO,u-1}$. Suppose
\begin{enumerate}
    \item $\dim(\pi_{\tau}\circ L_{\tau,|\OO|-1}\circ \dots \circ L_{\tau,0}(M_{\tau}))= f_{\OO,u}-f_{\OO,u-1}.$
    \item $\dim(\pi_{\tau'}\circ H_{\tau',|\OO|-1} \circ \dots \circ H_{\tau',0}(M_{\tau}))=f_{\OO,u-1}.$
    \item if $\tau''\in \OO$ satisfies $f(\tau''^*)<f_{\OO,u}$, then $w_{\tau''}$ is maximal.
\end{enumerate}
Then 
$\dim(\pi_{\tau}\circ H_{\tau,|\OO|-1}\circ \dots \circ H_{\tau,0}(M_{\tau}))=f(\tau^*)=f_{\OO,u}.$
\end{proposition}

\begin{proof}
Recall $\tau=\tau_{\OO,u}$. 
For $0 \leq i \leq |\OO|-1$, we define $B_i: M_{\pit} \to M_{\pipt}$ as
\begin{equation*}
    B_i=\begin{cases}
      F+V' & \text{ if } \fpits<\foum \\
      F & \text{ if } \fpits \geq \foum.
    \end{cases}
\end{equation*}
Note that the definition of $B_i$ is similar to $H_{\tau,i}$ but the cutting point is $f_{\OO,u-1}$ instead of $f_{\OO,u}$.
From Lemma \ref{FV'}, we deduce
$$\pi_\tau\circ B_{|\OO|-1}\circ \dots \circ B_0(M_\tau)+ \pi_{\tau}\circ L_{\tau,|\OO|-1} \circ \dots \circ L_{\tau,0}(M_{\tau}) \subseteq \pi_{\tau}\circ H_{\tau,|\OO|-1}\circ \dots \circ H_{\tau,0}(M_{\tau}).$$
By assumption, $\dim(\pi_{\tau}\circ L_{\tau,|\OO|-1}\circ \dots \circ L_{\tau,0}(M_{\tau}))= \fou-\foum$. Hence, it suffices to prove the following two claims:
\begin{enumerate}
    \item  $\dim(\pi_\tau \circ B_{|\OO|-1}\circ \dots \circ B_0(M_\tau)) \geq \foum$
    \item $\pi_\tau \circ B_{|\OO|-1} \circ \dots \circ B_0(M_\tau)\cap \pi_{\tau}\circ L_{\tau,|\OO|-1} \circ \dots \circ L_{\tau,0}(M_{\tau})=\{0\}$. 
\end{enumerate}
\textbf{Proof of claim (1)}: Recall $\tau'=\tau_{\OO,u-1}$.  Write $\tp=\pit$, for some $1\leq i\leq |\OO|-1$. Then, $\fpits=f(\tps)=\foum$. By comparing the definitions of $B_i$ and $H_{\tp,i}$, we have:
\begin{itemize}
    \item For $0 \leq j \leq i-1$: $B_j=H_{\tp,j+|\OO|-i}$,
    \item For $i \leq j \leq |\OO|-1$: $B_j=H_{\tp,j-i}$.
\end{itemize}
Hence, $B_{i-1}\circ \dots \circ B_0(M_\tau)=H_{\tp,|\OO|-1} \circ \dots \circ H_{\tp, \mo-i}(M_\tau)\supseteq H_{\tp,|\OO|-1} \circ \dots \circ H_{\tp, 0}(M_{\tp})$. By Proposition \ref{criteriasecond},  $H_{\tp,|\OO|-1} \circ \dots \circ H_{\tp, 0}(M_{\tp})=M_{\tau',f(\tau'^*)}$; we deduce that $\pi_\tau \circ B_{|\OO|-1}\circ \dots \circ B_0(M_\tau)$ contains $\pi_\tau \circ B_{|\OO|-1}\circ \dots \circ B_i(M_{\tau',f(\tau'^*)})$. Also, note that
$$\pi_\tau \circ B_{|\OO|-1}\circ \dots \circ B_i(M_{\tau',f(\tau'^*)})= \pi_\tau \circ H_{\tau',|\OO|-i-1}\circ \dots \circ H_{\tau',0}(M_{\tau',f(\tau'^*)}).$$
Since $w_{\tau'}$ is maximal, by Lemma \ref{F} we have $F(M_{\tau',f(\tau'^*)})=M_{p\tau',f(\tp^*)}=F(M_{\tau'})$. From $H_{\tau',0}=F$, we deduce
$$\pi_\tau \circ H_{\tau',|\OO|-i-1}\circ \dots \circ H_{\tau',0}(M_{\tau',f(\tau'^*)}) =\pi_\tau \circ H_{\tau',|\OO|-i-1}\circ \dots \circ H_{\tau',0}(M_{\tau'}).$$
Finally, recall that for any subspace $W\subseteq M_{\tau}$, we have $\dim(\pi_{\tau}(W))=\dim(F(W))$. From Proposition~\ref{criteriasecond}, we deduce
\begin{equation*}
    \begin{split}
    \dim(\pi_\tau \circ H_{\tau',|\OO|-i-1}\circ \dots \circ H_{\tau',0}(M_{\tau'}))
    &=\dim(F \circ H_{\tau',|\OO|-i-1}\circ \dots \circ H_{\tau',0}(M_{\tau'}))\\
    &=\dim(H_{\tau',|\OO|-i} \circ H_{\tau',|\OO|-i-1}\circ \dots \circ H_{\tau',0}(M_{\tau'}))\\
    &=\dim(M_{p^{|\OO|-i+1}\tau',f(\tp^*)})=f(\tps)=f_{\OO,u-1}.
    \end{split}
\end{equation*}
This completes the proof of claim (1).\\
\textbf{Proof of claim (2)}:
%We want to show that $\pi_{\tau}\circ B_{|\OO|-1} \circ \dots \circ B_{0}(M_{\tau})\cap \pi_{\tau}\circ\lof(M_{\tau})=\{0\}$.
Let $i_0=\max\{i' \mid  0 \leq i' \leq \mo-1, f(p^{i'}\ts)=\foum\}$. That is, $p^{i_0}\tau$ is the last embedding in $\OO$ where the signature has value $\foum$. Denote $\tpp=p^{i_0}\tau$. By Proposition \ref{criteriasecond}, 
$\dim(\pipp \circ \hoppf(M_{\tpp}))=\foum$.
Hence to prove the claim, it is enough to show that \begin{align}\label{claim2'}
\pi_{\tau} \circ B_{|\OO|-1} \circ \dots \circ B_{i_0}(M_{\piot})\cap \pi_{\tau} \circ L_{\tau,|\OO|-1} \circ \dots \circ L_{\tau,i_0}(M_{\piot})=\{0\},\end{align} where by Proposition \ref{criteriasecond}, 
$$B_{|\OO|-1} \circ \dots \circ B_{i_0}(M_{\piot})= H_{\tau'',|\OO|-1-i_0}\circ\dots\circ H_{\tau'',0}(M_{\tau''})=M_{\tau,f_{\OO,u-1}}.$$

We reduce the proof to showing \begin{enumerate}
    \item[(3)]
for any $i_0 \leq j \leq \mo-1$, there exist $j_2,j_3$ % depending on $j$ 
such that $j_3\geq j_2>\foum  $ % $\foum <j_2\leq j_3$ 
and $$L_{\tau,j} \circ \dots \circ L_{\tau,i_0}(M_{\piot})=M_{p^{j+1}\tau,j_2,j_3}.$$
\end{enumerate}

Assuming (3), for $j=|\OO|-1$, let $\foum<j_2\leq j_3$ such that $L_{\tau,\mo-1} \circ \dots \circ L_{\tau,i_0}(M_{\piot})=M_{\tau,j_2,j_3}$. Then, after  applying $\pi_{\tau}$,  we deduce (\ref{claim2'}),
from the equalities $B_{\mo-1} \circ \dots \circ B_{i_0}(M_{\piot})=M_{\tau,\foum}$ and $L_{\tau,\mo-1} \circ \dots \circ L_{\tau,i_0}(M_{\piot})=M_{\tau,j_2,j_3}$.


\textbf{Proof of claim (3)}: We proceed by induction on $j$. For $j=\iz$: $L_{\tau,\iz}=V'$ and $w_{\piot}$ is maximal. Hence, by Lemma \ref{V'stream}, $L_{\tau,\iz}(\mpiot)=M_{\pizp, \foum+1,g(\OO)}$. That is, the claim holds with $j_2=\foum+1$ and  $j_3=g(\OO)$.

Let $i_0< j \leq \mo-1$; assume the claim holds for $j-1$ and denote by  $j_3'\geq j_2'>\foum$ the corresponding indices. By the maximality of $\iz$, $f(\pjts) \neq \foum$. %We want to find the $j_2,j_3$ for $j$. 

Suppose $f(\pjts) < \foum$.
    Then $w_{\pjt}$ is maximal and $L_{\tau,j}=V'$. Then, by Lemma \ref{V'stream}, 
    $$\ljio(\mpiot)=V'(M_{p^j\tau,j_2,j_3})=M_{p^{j+1}\tau,j_2,j_3}.$$
    That is, the claim holds with $j_2=j_2'$ and $j_3=j_3'$.

    Suppose $f(\pjts) \geq \fou$.
    Then $L_{\tau,j}=F$, and from the inductive hypothesis, we deduce  %$L_{\tau,j-1} \circ \dots \circ L_{\tau,\iz}(M_{\piot})=M_{p^j\tau,j_2',j_3'}$. So we have, 
    $$\ljio(\mpiot) =F(M_{p^j\tau,j_2',j_3'}),$$
    where $F(M_{p^j\tau,j_2',j_3'})=M_{p^{j+1}\tau,j_2,j_3}$,  for $j_2=1+\dim(F(M_{\pjt,j_2'-1}))$ and $j_3=\dim(F(M_{\pjt,j_3'}))$. By definition, $j_3\geq j_2$. Hence, it suffices to show that $j_2>\foum $. By Proposition \ref{criteriasecond}
    \begin{equation*}
        \begin{split}
        F(M_{\pjt,\foum})
        &=F(H_{\tau'',j-1-i_0}\circ\dots\circ H_{\tau'',i_0}(M_{\tau''}))\\
        &= H_{\tau'',j-i_0}\circ H_{\tau'',j-1-i_0}\circ\dots\circ H_{\tau'',i_0}(M_{\tau''})
        = M_{p^{j+1}\tau,\foum}.
        \end{split}
    \end{equation*}
    From $ j_2'-1\geq \foum $, we deduce $j_2-1=\dim(F(M_{\pjt,j_2'-1})) \geq \dim(F(M_{\pjt,\foum}))=\foum,$ %So $\foum<j_2\leq j_3$ as desired.
which concludes the proof for claim $(3)$. 
\end{proof}



Combining Propositions \ref{criteriasecond} and \ref{criteriathird}, we  deduce the main result of this section.

\begin{theorem}\label{numerical criteria}
  For $\tau\in \OO$ and $0\leq i\leq |\OO|-1$,  denote $L_{\tau,i}: M_{p^i\tau}\to M_{p^{i+1}\tau}$ as in (\ref{Eq_L}). Let $1\leq u\leq s(\OO)$, and assume
\begin{enumerate}
    \item $\dim(\pi_{\tau_{\OO,1}}\circ L_{\tau_{\OO,1},|\OO|-1} \circ \dots \circ L_{\tau_{\OO,1},0}(M_{\tau_{\OO,1}}))=f_{\OO,1}$;
    \item for $2\leq j\leq u$:
   $\dim(\pi_{\tau_{\OO,j}}\circ L_{\tau_{\OO,j},|\OO|-1} \circ \dots \circ L_{\tau_{\OO,j},0}(M_{\tau_{\OO,j}}))=f_{\OO,j}-f_{\OO,j-1}.$
\end{enumerate}
Then  $w_{\tau}$ is maximal for all $\tau\in \OO$ satisfying $f(\tau^*)\leq f_{\OO,u}$. 
\end{theorem}












\section[]{The Hasse--Witt triple of cyclic covers of $\Po$}\label{duality}

The goal of this section is to explicitely compute the Hasse--Witt triple of a cyclic cover of $\Po$.%, adapting to our context the methods in \cite{Moonenalgorithm}.  
%We assume $p > l(r-2)$ and $r\leq 5$. As the statement of the main theorem trivially holds for $r\leq 3$, we are really considering the cases of $4\leq r\leq 5$. The assumption $p>l(r-2)$ is the same as in \cite[Theorem]{Irene}

%\subsubsection{Hasse-Witt triple of cover of $\Po$}\label{Hasse Witt triple} 
In \cite{Moonenalgorithm}, Moonen gives an explicit algorithm for computing the Hasse--Witt triple of a complete intersection curve defined over $\fpb$. 
By adapting \cite[Proposition 3.11 and Formula (3.11.3)]{Moonenalgorithm} 
to the special case of a cover of $\Po$, we obtain the following description of its Hasse-Witt triple.

\begin{proposition}\label{P_Hasse Witt triple} (Special case of \cite[Proposition 3.11]{Moonenalgorithm})
Let $\pi: C \to \Po$ be a smooth projective branched cover of the projective line.  The Hasse-Witt triple  of $C$ is $(Q,\phi,\psi)$ where
\begin{enumerate}
    \item $Q=\hy$, and $Q^{\smvee}=\hyd$;
    \item $\phi:\hy \to \hy$ is given by the Hasse-Witt matrix;
    \item $\psi: \ker(\phi) \to \im(\phi)^\perp$ is defined as $\psi(\alpha)=(df_{1,{\alpha}},-df_{2,{\alpha}}),$
    where $(df_{1,{\alpha}},-df_{2,{\alpha}})$ denotes the global $1$-form on $C$ which restricts to $df_{1,{\alpha}}$ on $U_1$ and to $-df_{2,{\alpha}}$ on $U_2$, for $f_{1,{\alpha}} \in \OO_C(U_1)$ and $f_{2,\alpha} \in \OO_C(U_2)$ satisfying $\alpha^p=f_{1,{\alpha}}+f_{2,{\alpha}}$. 
\end{enumerate}

\end{proposition}

\begin{proof}
   The statement follows by adapting \cite[proof of Proposition 3.11 and Formula (3.11.3)]{Moonenalgorithm} to our context, and using the Cech complex with the coordinate charts $U_1=\pi^{-1}(\Po-\{\infty\})$ and $U_2=\pi^{-1}(\Po-\{0\})$.
   Note that if  $\alpha \in \ker(\phi)$, then there exists $f_{1,\alpha}\in \OO_C(U_1)$ and $f_{2,\alpha}\in \OO_C(U_2)$ satisfying $\alpha^p=f_{1,{\alpha}}+f_{2,{\alpha}}$. By construction, $df_{1,{\alpha}}$ and $-df_{2,{\alpha}}$ agree on $U_1\cap U_2$.
\end{proof}
%Then $(M,F,V,b)$ obtained from the Hasse-Witt triple via the correspondence is isomorphic to the polarized mod $p$ Dieudonne module associated to $J(C)$.

%We have reduced the proof of the Theorem \ref{abelian cover} to proving Theorem \ref{new part mu ord}. Moreover, Moonen in \cite[Proposition 5.1]{SecondPaper} proved the special case of Theorem \ref{new part mu ord} when $r\leq 3$. Suppose we have a monodromy datum $(\mu_l,r,\au)$, where $G=\mu_l$ is the group of the $l^{th}$ roots of unity, $\au_1,\dots,\au_r$ generate $\mu_l$ and $\au_i\neq 1$. Then by choosing a primitive $l^{th}$ root of unity $\zeta_l$, we can identify $\mu_l$ with $\Z/l\Z$. Under this identification we get $1 \leq a_1,\dots,a_r\leq l-1$ such that $\au_i=\zeta_l^{a_i}$. The condition that $\au_i$ generate $\mu_l$ becomes $\gcd(a_1,\dots,a_r,l)=1$. We can also index the elements of $\tg$ by $b\in \Z/l\Z$ as follows: define $\tau_b\in\tg$ as $\tau_b(a)=\zeta_l^{ba}$. Note that $\tau_b^*=\tau_{-b}$ and ${\tau_b}^{\sigp}=\tau_{pb}$. Therefore the monodromy data takes the form $(l,r,a_1,\dots,a_r)$.
%From this point on, we fix a monodromy datum for cyclic cover $(l,r,a_1,\dots,a_r)$ and prime $p$ that satisfies the condition in Theorem \ref{new part mu ord} and has $4\leq r\leq 5$. Note that $\ker(\tau_b)=\{1\}$ if and only if $\gcd(b,l)=1$. Therefore we restrict our attention to Frobenius orbits of $\tau_b$ with $\gcd(b,l)=1$.
%By \cite[Theorem 1.3.7]{MoonenEOtypeformula}, we want to show that for the $\tau \in \tg^{\text{new}}$, we have that $\wt$ are of maximal length. 

In the following, for $C$ a cyclic cover of $\Po$, we compute the extended Hasse--Witt matrix of $C$, that is the matrices of the maps $\phi,\psi$ with respect to an explicit choice of bases of $Q$ and $Q^{\smvee}$, for $(Q,\phi,\psi)$ the Hasse--Witt triple of $C$.

\begin{notation}\label{new part mu ord}
Let $G$ be a cyclic group of size $l$. We fix an identification $G=\Z/l \Z$,
we write a monodromy datum for $G$ as $(l,r,\au)$, where $r\geq 3$ and $\au=(a_1,\dots a_r) \in \Z^r$ satisfy
\begin{enumerate}
\item $1 \leq a_k \leq l-1$, for all $1\leq k\leq r$;
\item $\sum_{k=1}^r a_k \equiv 0 \pmod{l}$; 
\item $\gcd(a_1, \dots, a_r,l)=1$. 
\end{enumerate}
Let $\zeta_l=e^{2\pi i/l}\in\C^*$ is a primitive root of $l$. 
We also identify $\tg=\Z/l\Z=\{b\in \Z\mid 0\leq b\leq l-1\}$ by $\tau_b(a)=\zeta_{l}^{ba}.$ Under this identification,  $b\in \tg^{\n}$ if and only if $\gcd(b,l)=1$.

Let $p$ be a rational prime, $p\nmid l$. 
Given a cyclic monodromy datum $(l, r,\au)$, we consider $C$ the smooth projective curve over $k=\fpb$ which is the normalization of the affine equation $$C':y^l=(x-x_1)^{a(1)} \cdots (x-x_r)^{a(r)},$$ where we assume $x_1, \dots , x_r\in k$ distinct.
%$\xb \in \mlra$. 

In the following, we sometime write the affine equation of $C'$ as $y^l=f(x)$ or $f(x,y)=0$. 
\end{notation}



%Given a cyclic monodromy datum $(l, r,\au)$,  
%let $C$ over $k$ be the normalization of the affine equation $$C':y^l=(x-x_1)^{a(1)} \cdots (x-x_r)^{a(r)},$$ where we assume $x_1, \dots , x_r\in k$ distinct. %$\xb \in \mlra$. 
%In the following, we sometimes write $f(x,y)=0$ for the affine equation of $C'$. 
%Our goal is to  compute the coefficients of $\phi$ and $\psi$ with regard to an explicit choice of bases for $\hy$ and $\hyd$.   Our starting point is the computation of the Hasse--Witt matrix of $C$ in \cite{Irene}. If we denote the Hasse--Witt triple of $C$ by $(Q,\phi,\psi)$, then its Hasse--Witt matrix is the matrix of $\phi$ with respect to a choice of basis of $Q$.
Let $C/k$ as in Notation \ref{new part mu ord}. 
We denote by $\langle\, ,\, \rangle$  the duality between $\hy$ and $\hyd$, that is
$$\langle f,\omega\rangle=\sum_{P \in C} \Res_P f\omega, \text{ for }  f \in \hy, \omega \in \hyd.$$


For $1 \leq i \leq l-1$, set 
$$v_i=\frac{y^i}{(x-x_1)^{\fy} \dots (x-x_r)^{\fr}}.$$
Note that $v_i$ only depends on the congruence class of $i$ mod $l$.

In the following, we compute $\hy$ via C{e}ch cohomology, with the affine charts $U=\pi^{-1}(\Po-\{\infty\})$ and $V=\pi^{-1}(\Po-\{0\})$. That is, we identify $$\hy = \frac{\OO_C(U \cap V)}{\ocu \oplus \ocv}.$$

\begin{lemma}\label{L_bases}
Let $C/k$ as in Notation \ref{new part mu ord}. Denote by $(Q,\phi,\psi)$ the Hasse--Witt triple of $C$. That is, let $Q=\hy$ and identify $Q^{\smvee}=\hyd$. 
For $1\leq i\leq l-1$, denote by $Q_{\tau_i}$ the $\tau_i$-isotypic component of $\Q$. Write $Q^{\smvee}_{\tau_i}=(Q_{\tau_i})^{\smvee}$ (hence, $Q^{\smvee}_{\tau_i}=(Q^{\smvee})_{\tau^*_i}$).

For any $1\leq i\leq l-1$,
\begin{enumerate}
    \item the set $\{ \zij=\frac{v_i}{x^j}\mid 1\leq j\leq f(\tau^*_i) \}$ is a $k$-basis basis of $Q_{\tau_i}$ as a $k$-vector space;

\item the set $\{\omega_{i,j}=\frac{x^{j-1}}{v_i}dx \mid 1 \leq j \leq f({\tau_i}^*)\}$ is a basis of $Q^{\smvee}_{\tau_i}$ as a $k$-vector space.
\end{enumerate}
Furthermore, for any $1\leq i,i'\leq l-1, 1\leq j\leq f(\tau^*_i)$ and $ 1 \leq j' \leq f({\tau_{i'}}^*)$, we have
\begin{equation*}
    \langle\zij,\omega_{i',j'}\rangle = 
    \begin{cases}
    l & \text{if $i=i',j=j'$},  \\
    0 & \text{otherwise}.
    \end{cases}
\end{equation*}

 
\end{lemma}


\begin{proof}
By definition, the rings of regular functions on $U$, $V$ and $U\cap V$ are 
\begin{align*}
\OO_C(U) &\cong \bigoplus_{i=1}^{l-1}k[x]v_i,
&
\OO_C(V) &\cong \bigoplus_{i=1}^{l-1}k\Big[\frac{1}{x}\Big]x^{-f(\tis)-1}v_i,
&
\OO_C(U \cap V)&\cong \bigoplus_{i=1}^{l-1}k\Big[x,\frac{1}{x}\Big]v_i.
\end{align*}
We deduce 
\begin{equation}\label{eq: ho}
    \begin{split}
        \hy &= \frac{\OO_C(U \cap V)}{\ocu \oplus \ocv} 
        = \bigoplus_{i=1}^{l-1} \bigoplus_{j=1}^{f({\tau_i}^*)}k \big\{\zij\big\} \text{ with }\zij=\frac{v_i}{x^j},
    \end{split}
\end{equation}
The basis of $Q^{\smvee}$ with the above property is given in \cite[Section 5]{Dualbasis}.
\end{proof}
%As in Proposition \ref{P_Hasse Witt triple}, let $Q=\hy$ and $Q^{\smvee}=\hyd$. For each $1\leq i\leq l-1$, the $\tau_i$-isotypic component of $Q$ and $Q^{\smvee}$ are   $$Q_{\tau_i}=\bigoplus_{j=1}^{f({\tau_i}^*)}k\big\{\zij \big\} \text{ and } Q^{\smvee}_{\tau_i}=(Q^{\smvee})_{\tau_i}=  (Q_{\tau_i^*})^{\smvee}= \bigoplus_{j=1}^{f(\tau)}k\{\omega_{i,j}\}.$$
%Notice that $Q_{\tau_i}^{\smvee}=(Q_{\tau_i})^{\smvee}=$, that is, it is the isotypic subspace of $\tau_{i}^*$ in $Q^{\smvee}$.

Let $1\leq i\leq l-1$. Recall  $\phi_{\tau_i}$ denotes the restriction of $\phi$ to $Q_{\tau_i}$, $\phi_{\tau_i}:Q_{\tau_i}\to Q_{\tau_{pi}}$. %, $\psi_{\tau_i}: Q_{\tau_i}\to Q_{\tau_{pi}}^{\smvee} $.
%We compute the coefficients of the matrices of $\phi_{\tau_i},\psi_{\tau_i}$ with respect to $\zij$ and $\oij$.
In \cite[Lemma 5.1]{Irene}, Bouw computes the Hasse--Witt matrix of $C$, that is the matrix of $\phi$ with respect to the basis of $Q$ given in Lemma \ref{L_bases}.
The coefficient of $\zpij$ in $\phi_{\tau_i}(\zij)$ is \begin{align}
\label{coefficient of phii}
(-1)^N \sum_{n_1+ \dots + n_r=N}\binom{\pby}{n_1} \dots \binom{\pbr}{n_r} x_1^{n_1} \dots x_r^{n_r},    
\end{align} 
where $N=\sum_{k=1}^r \pbk -(jp-j')=p(f({\tau_i}^*)+1)-(f(p{\tau_i}^*)+1)-jp+j'$.


Recall from Remark \ref{Rem_EOHassetrople}, that given a Hasse--Witt triple, the associated mod $p$ Diedonn\'e module depends on the choice of an extension of $\psi$ to $Q$.
More precisely, it depends on
%In \cite{Moonenalgorithm}, Moonen proved  to reconstruct the mod $p$ Diendonn\'e module of $C$, the map $\psii$ is extended to
%Now, we want to compute the coefficient of $\psi_{\tau_i}$. Notice $\psi_{\tau_i}:\ker(\phi_{\tau_i}) \to Q_{p\tau_i^*}^{\smvee}$ is only defined on $\ker(\phi_{\tau_i})$. It is extended to
the choice of a complement $R_0$ to $R_1=\ker(\phi_{\tau})$ in $Q$, as $\psi$ is extended to  $Q$  by setting $\psi$ to vanish on $R_0$.  (In \cite{Moonenalgorithm}, Moonen  proves
that different choices of $R_0$ give rise to isomorphic mod $p$ Dieudonn\'e modules.)


Let  $\psi_{\tau_i}$ denote the restriction of $\psi$ to $Q_{\tau_i}$, $\psi_{\tau_i}:  Q_{\tau_i} \supseteq \ker(\phi_{\tau_i})\to {\rm Im}(\phi_{\tau_i})^\perp\subseteq Q_{\tau_{pi}}^{\smvee} .$
With abuse of notation, we denote by
$\psii: Q_{\tau_i}\to Q_{\tau_{pi}}^{\smvee}$ any extension of $\psii$ obtained by extension by zero from a choice of complement of $\ker(\phi_{\tau_i})$ in $Q_{\tau_i}$.

In the following,  to compute the matrix of $\psii$, instead of working with a basis of $\ker(\phi_{\tau_i})$ and a choice of a complement, we define and compute the coefficients of an auxiliary linear map $\psi_{\tau_i}': Q_{\tau_i} \to Q_{p\tau_i^*}^{\smvee}$. We show that the restriction of $\psi_{\tau_i}'$ to $\ker(\phi_{\tau_i})$ agrees with $\psi_{\tau_i}$, and  is injective. In Proposition \ref{When is psii' correct}, we show that under suitable conditions, 
%Note that that if ${\psi_{\ti}}_{\vert \ker(\phi_{\tau_i})}=\psi_{\tau_i}$ then  $\psi_{\tau_i}'$ is a suitable extension of $\psi_{\tau_i}$ is equivalent to 
$\qi=\ker(\psi_{\tau_i}')\oplus \ker(\phi_{\tau_i})$.  

\begin{definition}\label{Def_valid}
    For any $\tau\in \tg$, we say that a map $\psi_{\tau}':Q_\tau\to Q_{p\tau^*}^{\smvee}$ is a {valid extension} of $\psi_{\tau}$ if ${\psi_{\tau}'}_{\vert \ker(\phi_{\tau})}=\psi_{\tau}$ and $Q_\tau=\ker(\psi_{\tau}')\oplus \ker(\phi_{\tau})$. 
    \end{definition}
  If $\psi_\tau'$ is a valid extension for all $\tau\in \tg$, then $\psi'$ is the extension by zero of $\psi$ associated with $R_0=\ker(\psi')$.

We define $\psi_{\tau_i}': Q_{\tau_i} \to Q_{p\tau_i^*}^{\smvee}$ as follows. Consider the inclusion of $k$-vector spaces
\begin{align*}
    \iota& : H^1(C,\OO_C) \to \ocuv,\quad  \zij\mapsto \frac{v_i}{x^j},
\end{align*}
which identifies $H^1(C,\OO_C)$ with the subspace of $\ocuv$ given in (\ref{eq: ho}). This yields a decomposition as $k$-vector space
\begin{align*}
   \ocuv &=\ocu\oplus \iota(H^1(C,\OO_C)) \oplus \ocv  .
\end{align*}
We denote by
%\begin{align*}
    $\pi_1 : \ocuv \twoheadrightarrow \ocu  \text{ and }  \pi_2 : \ocuv \twoheadrightarrow \ocv$
%\end{align*}
the corresponding projections of $k$-vector spaces; they satisfy $\ker(\pi_1)=\bigoplus_{i=1}^l k[\frac{1}{x}]x^{-1}v_i$, and $\ker(\pi_2)=\bigoplus_{i=1}^l k[x]x^{-\fis}v_i$.



For any $\alpha \in Q_{\tau_i}$, let $f_1=\pi_1(\iota(\alpha)^p)\in \ocu$, and define %Then we define $\psi_{\tau_i}'$ such that
\begin{equation}\label{Eq psi'}
\begin{split}
    \psi_{\tau_i}'(\alpha) & = \sum_{k=1}^{f(p\tau_i)}\langle df_{1}, \zpisk\rangle\opisk 
    =\sum_{k=1}^{f(p\tau_i)}( \text{coefficient of $\opisk$ in $df_{1}$})\opisk.
\end{split}
\end{equation}


%\begin{remark}
%Given $\alpha\in Q_{\tau_i}$, the definition of $\psiip(\alpha)$ is independent of the choice of lifting of $\alpha$ to $\tilde{\alpha}\in \ocuv$. Indeed, given  $\tilde{\alpha}$, there exist  
%$g_1 \in \ocu$ and $g_2 \in \ocv$
%such that 
%$\tilde{\alpha}=\iota({\alpha})+g_1+g_2$. We deduce $\tilde{\alpha}^p=\iota({\alpha})^p+g_1^p+g_2^p=g_1^p+f_1+\iota(\phi(\alpha))+g_2^p+f_2$. Note that $d(g_1^p+f_1)=d(f_1)$. 
%\end{remark}


%For any $\alpha \in Q_{\tau_i}$, lift $\alpha$ to some $\tilde{\alpha}\in \ocuv$, and write
%$\tilde{\alpha}^p=f_{1}+\iota(\phi(\alpha))+f_{2}$,
%where $f_1=\pi_1(\Tilde{\alpha}^p)$ and $f_2=\pi_2(\Tilde{\alpha}^p)$. We set %Then we define $\psi_{\tau_i}'$ such that
%\begin{equation}\label{Eq psi'}
%\begin{split}
    %\psi_{\tau_i}'(\alpha) & = \sum_{k=1}^{f(p\tau_i)}\langle df_{1}, \zpisk\rangle\opisk 
    %=\sum_{k=1}^{f(p\tau_i)}( \text{coefficient of $\opisk$ in $df_{1}$})\opisk.
%\end{split}
%\end{equation}
%By definition (see \ref{P_Hasse Witt triple}), if $\alpha \in \ker(\phi_{\tau_i})$, then $\psi_{\tau_i}'(\alpha)=\psi_{\tau_i}(\alpha)$. 

%\begin{remark}
%By definition,  $\psiip(\alpha)$ is independent of the choice of lifting $\tilde{\alpha}\in \ocuv$. Indeed, a different representative $\tilde{\beta}$ is of the form $\tilde{\beta}=\tilde{\alpha}+g_1+g_2$, where $g_1 \in \ocu$ and $g_2 \in \ocv$. Then $\tilde{\beta}^p=g_1^p+g_2^p+\tilde{\alpha}^p=g_1^p+f_1+\iota(\phi(\alpha))+g_2^p+f_2$, but $d(g_1^p+f_1)=d(f_1)$. 
%\end{remark}

\begin{proposition}\label{coefficient of psii}
Let $1\leq i\leq l-1$. Assume $\gcd(i,l)=1$. Then, the coefficient of $\opisjp$ in $\psiip(\zij)$ is 
$$-\sum_{k=1}^r \pbk r_{i,j,k}q_{r-j',k},$$
where $q_{r-j',k}$ is the coefficient of $x^{j'-1}$ in $\frac{(x-x_1) \dots (x-x_r)}{(x-x_k)}$,
%(that is,  the symmetric polynomial of degree $r-j'$, missing $x_k$, multiplied by $(-1)^{r-j'}$), 
and $r_{i,j,k}$ is the residue of $\frac{\zij^p}{v_{pi}(x-x_k)}$ at $x=0$, that is 
    $$r_{i,j,k}=(-1)^N\sum_{n_1+ \dots +n_r=N}\binom{\pby}{n_1} \dots \binom{\pbk -1}{n_k} \dots \binom{\pbr}{n_r} x_1^{n_1}\dots x_r^{n_r},$$
where $N=p(f(\tau_i^*)+1)-(f(p\tau_i^*)+1)-pj$.
%and $q_{r-j',k}$ %is the coefficient of $x^{j'-1}$ in $\frac{(x-x_1) \dots (x-x_r)}{(x-x_k)}$. Equivalently, it 

\end{proposition}
\begin{proof}
Let $\iota(\zij)^p=f_{1,j}+\iota(\phi(\zij))+f_{2,j}$, where $f_{1,j} \in \ocu$ and $f_{2,j} \in \ocv$. We have
$$\iota(\zij)^p=\vip \frac{(x-x_1)^{\pby} \dots (x-x_r)^{\pbr}}{x^{pj}}.$$
Let
$$h(x)=\left[\frac{\pbf}{x^{pj}}\right]_{\text{deg $\geq 0$}}.$$
Then $f_{1,j}=h(x)\vip$, and we want to find the coefficient of $\opisjp$ in $d(h(x)\vip)$.
Since we are in characteristic $p$, we see that
\begin{equation*}
    \begin{split}
        d(\vip)&=y^{pi}d\left(\frac{1}{(x-x_1)^{\pfy}\dots (x-x_r)^{\pfr}}\right) \\
        &=\frac{y^{pi}}{(x-x_1)^{\pfy}\dots (x-x_r)^{\pfr}}\bigg(\frac{-\pfy}{(x-x_1)}+ \dots +\frac{-\pfr}{(x-x_r)}\bigg)dx \\
        &=v_{pi}\bigg(\frac{-\pfy}{(x-x_1)}+ \dots +\frac{-\pfr}{(x-x_r)}\bigg)dx \\
        &= v_{pi}\bigg(\frac{-\pby}{(x-x_1)}+ \dots +\frac{-\pbr}{(x-x_r)}\bigg)dx.
    \end{split}
\end{equation*}
The last equality follows from 
$$\pfk-\pbk = \floor*{p\fk}=p\fk \equiv 0 \pmod{p}.$$
We claim the following, which we will prove later:
\begin{equation}\label{eqn: *}
d(h(x))=\sum_{k=1}^r \pbk \frac{h(x)-r_{i,j,k}}{x-x_k} dx. \tag{*}  
\end{equation}
Assuming this for now, we see that
\begin{equation*}
    \begin{split}
    d(f_{1,j}) &= d(\vip)h(x)+\vip d(h(x)) \\
    &=- \vip \sum_{k=1}^r \pbk \frac{h(x)}{x-x_k} dx + \vip \sum_{k=1}^r \pbk \frac{h(x)-r_{i,j,k}}{x-x_k} dx\\
    &=-\vip \sum_{k=1}^r \pbk \frac{r_{i,j,k}}{x-x_k} dx.
    \end{split}
\end{equation*}
Since $\gcd(i,l)=1$, we have $\vip\vips=(x-x_1) \dots (x-x_r)$ and hence $\vip dx = \frac{(x-x_1) \dots (x-x_r)}{\vips} dx$. Thus,
$$d(f_{1,j})=- \sum_{k=1}^r \pbk r_{i,j,k}\frac{(x-x_1) \dots (x-x_r)}{(x-x_k)} \frac{dx}{\vips}.$$
Therefore, the coefficient of $\opisjp$ is the coefficient of $x^{j'-1}$ in $-\sum_{k=1}^r \pbk r_{i,j,k}\frac{(x-x_1) \dots (x-x_r)}{(x-x_k)}$, which completes the proof of the proposition assuming (*).

Next, we prove (*).
We let 
$$h_1(x)=\frac{\iota(\zij)^p}{\vip}=\frac{\pbf}{x^{pj}}.$$
Then, $h(x)=\left[ h_1(x)\right]_{\text{deg $ \geq 0$}}$, and so $d(h(x))=[d(h_1(x))]_{\text{deg $ \geq 0$}}$.
From the expression of $h_1(x)$, we know that $d(h_1(x))=\sum_{k=1}^r \pbk \frac{h_1(x)}{x-x_k} dx$. Thus, 
$$d(h(x))=[d(h_1(x))]_{\text{deg $\geq 0$}}=\sum_{k=1}^r \pbk \left[\frac{h_1(x)}{x-x_k}\right]_{\text{deg $ \geq 0$}} dx.$$
Let $h_{1,k}(x)=\left[\frac{h_1(x)}{x-x_k}\right]_{\text{deg $ \geq 0$}}$.
Then, 
$$\frac{h_1(x)}{x-x_k}=h_{1,k}(x)+\frac{r_{i,j,k}}{x}+g_{1,k}(x),$$
where $g_{1,k}(x)$ consists of terms of degree $\leq -2$, and $r_{i,j,k}$ is the residue at $0$ of $\frac{h_1(x)}{x-x_k}=\frac{\iota(\zij)^p}{\vip (x-x_k)}$. 
We deduce $h_1(x)=(x-x_k)h_{1,k}(x)+r_{i,j,k}-\frac{x_kr_{i,j,k}}{x}+(x-x_k)g_{1,k}(x)$. Hence $h(x)=(x-x_k)h_{1,k}(x)+ r_{i,j,k}$, and consequently,
$h_{1,k}(x)=\frac{h(x)-r_{i,j,k}}{x-x_k}$.
Then, 
\begin{equation*}
    \begin{split}
        d(h(x))
        =\sum_{k=1}^r \pbk h_{1,k}(x) dx 
        = \sum_{k=1}^r \pbk \frac{h(x)-r_{i,j,k}}{x-x_k} dx.
    \end{split}
\end{equation*}
This completes the proof of (*). For the alternate expression of $r_{i,j,k}$, note that $r_{i,j,k}$ is the coefficient of $x^{-1}$ in $\frac{\iota(\zij)^p}{\vip (x-x_k)}$. This means that $r_{i,j,k}$ is the coefficient of $x^{pj-1}$ in $\frac{\pbf}{(x-x_k)}$.
\end{proof}


\begin{lemma}
    For any $1\leq i\leq l-1$, if $\alpha \in \ker(\phi_{\tau_i})$, then $\psi_{\tau_i}'(\alpha)=\psi_{\tau_i}(\alpha)$. 
\end{lemma}
\begin{proof}
By definition,   $\iota(\alpha)^p=f_1+\iota(\phi(\alpha))+f_2$, where $f_i=\pi_i(\iota(\alpha)^p)$, for $1\leq i\leq 2$. Hence, the statement follows by comparing the definition of $\psii'$ in (\ref{Eq psi'}) with that of $\psii$ in Proposition \ref{P_Hasse Witt triple}.
\end{proof}




\begin{lemma}\label{psii' injective}
For any $1\leq i\leq l-1$, $\ker(\phi_{\tau_i})\cap\ker(\psi'_{\tau_i})=\{0\}.$
%the $\psi_{\tau_i}'$ is injective when restricted to $\ker(\phi_{\tau_i})$.
\end{lemma}


\begin{proof}%[Proof of Lemma \ref{psii' injective}]

Let $\alpha \in \ker(\phi_{\tau_i}) \cap \ker(\psi'_{\tau_i})$, and write
$\iota(\alpha)=c_1\frac{v_i}{x}+c_2\frac{v_i}{x^2}+ \dots +c_{f(\tau_i^*)}\frac{v_i}{x^{f(\tau_i^*)}}$.
Then,
\begin{equation*}
    \begin{split}
      \iota(\alpha)^p&=c_1^p\frac{v_i^p}{x^p}+c_2^p\frac{v_i^p}{x^{2p}}+ \dots +c_{f(\tau_i^*)}^p\frac{v_i^p}{x^{pf(\tau_i^*)}} \\
      &=v_{pi}(x-x_1)^{\pby} \dots (x-x_r)^{\pbr}\left(\frac{c_1x^{f(\tau_i^*)-1}+c_2x^{f(\tau_i^*)-2}+ \dots +c_{f(\tau_i^*)}}{x^{f(\tau_i^*)}} \right)^p.
    \end{split}
\end{equation*}
Set 
\begin{align*}
    h(x)&=c_1x^{f(\tau_i^*)-1}+c_2x^{f(\tau_i^*)-2}+ \dots +c_{f(\tau_i^*)}, \\
    g(x)&=\left[\frac{(x-x_1)^{\pby}\dots (x-x_r)^{\pbr}h(x)^p}{x^{pf(\tau_i^*)}}\right]_{\deg \geq 0}, \\
    q(\frac{1}{x})&=\left[\frac{(x-x_1)^{\pby}\dots (x-x_r)^{\pbr}h(x)^p}{x^{pf(\tau_i^*)}}\right]_{\deg \leq -f(p\tau_i^*)-1}.
\end{align*}

Since $\phi(\alpha)=0$,  $\iota(\alpha)^p=g(x)v_{pi}+q(\frac{1}{x})v_{pi}$, and hence $0=d(g(x)v_{pi})+d(q(\frac{1}{x})v_{pi})$.

Since $\psi(\alpha)=0$, we have $d(g(x)v_{pi})=0$ and $d(q(\frac{1}{x})v_{pi})=0$. 

We want to prove that $h(x)=0$, since it would imply $\alpha=0$. Assume by contradiction $h(x) \neq 0$. 

First, we deduce that $g(x)\neq 0$ and $q(\frac{1}{x})\neq 0$. Let $b$ and $c$ denote respectively the smallest and largest integer $n$ for which coefficient of $x^{n}$ in $h(x)$ is non-zero. Hence, $0\leq b\leq c\leq f(\tau_i^*)-1$. By definition,  the lowest and highest powers of $x$ in $h(x)^p$ are respectively$x^{bp}$ and $x^{cp}$. Therefore, in $\frac{(x-x_1)^{\pby}\dots (x-x_r)^{\pbr}h(x)^p}{x^{pf(\tau_i^*)}}$, the highest power of $x$ is $x^{p(f(\tau_i^*)+1)-f(p\tau_i^*)-1+pc-pf(\tau_i^*) }=x^{p(c+1)-1-f(p\tau_i^*)}$, and the power is strictly positive. Therefore, $g(x)$ is non-zero. On the other hand, the lowest power of $x$ is $x^{bp-pf(\tau_i^*)}$. Since $b \leq f(\tau_i^*) -1$, the power is negative. Therefore, $q(\frac{1}{x})$ is non-zero.

Now, say $pi \equiv k \pmod{l}$. Then, we have $v_{pi}=v_k=\frac{y^k}{(x-x_1)^{\fky} \dots (x-x_r)^{\fkr}}$.
Let 
$$g_1(x)=\frac{g(x)}{(x-x_1)^{\fky}\dots (x-x_r)^{\fkr}}=\frac{g(x)v_k}{y^k}.$$
Then, $g(x)v_{k}=y^kg_1(x)$, so $d(y^kg_1(x))=0$.

On the other hand, if we write the affine equation of the curve as $y^l=f(x)$, then we have $ly^{l-1}dy=f'(x)dx$. Consequently,
\begin{equation*}
    \begin{split}
        d(y^kg_1(x)) &=ky^{k-1}g_1(x)dy+y^kg_1'(x)dx =\frac{ky^{k-1}g_1(x)f'(x)}{ly^{l-1}}dx +y^{k}g_1'(x) dx \\
        &=\frac{dx}{y^{l-k}}\left(\frac{k}{l}f'(x)g_1(x)+y^lg_1'(x)\right) =\frac{dx}{y^{l-k}}\left(\frac{k}{l}f'(x)g_1(x)+f(x)g_1'(x)\right).
    \end{split}
\end{equation*}
Since $d(y^kg_1(x))=0$, this implies that  $\frac{k}{l}f'(x)g_1(x)+f(x)g_1'(x)=0$. Multiplying by $lf(x)^{k-1}g_1(x)^{l-1}$, we get that
$kf(x)^{k-1}f'(x)g_1(x)^l+lf(x)^{k}g_1(x)^{l-1}g_1'(x)=0$. Therefore
$\left(f(x)^kg_1(x)^l\right)'=0$.
So $f(x)^kg_1(x)^l=s(x)^p$ for some $s(x)$ rational function. Since, $g_1(x)=\frac{g(x)}{(x-x_1)^{\fky}\dots (x-x_r)^{\fkr}}$, we see that
\begin{equation}\label{eq1}
   (x-x_1)^{l\langle\frac{ka_1}{l}\rangle} \dots (x-x_r)^{l\langle\frac{ka_r}{l}\rangle}g(x)^l=\prod(x-\beta_s)^{\pm p}.
\end{equation}
Where $\beta_s$ are the zeros and poles of $s(x)$. 
Similarly, for $q(\frac{1}{x})$, we get that
\begin{equation}\label{eq2}
(x-x_1)^{l\langle\frac{ka_1}{l}\rangle} \dots (x-x_r)^{l\langle\frac{ka_r}{l}\rangle}q(\frac{1}{x})^l=\prod(x-\gamma_s)^{\pm p}.
\end{equation}
Let $a(x)=x^{pf(\tau_i^*)}q(\frac{1}{x})$, so $a(x)$ is a polynomial with $\deg(a(x)) \leq pf(\tau_i^*)-f(p\tau_i^*)-1$.

Let $t_j$ to be the power of $x-x_j$ in $g(x)$, and $m_j$ be the power of $(x-x_j)$ in $a(x)$. From the above two equations we have
\begin{align*}
l\langle\frac{ka_j}{l}\rangle+t_jl &\equiv 0 \pmod{p},
&
l\langle\frac{ka_j}{l}\rangle+m_jl &\equiv 0 \pmod{p}.
\end{align*}
Thus, $t_j \equiv m_j \pmod{p}$.
From Equations \ref{eq1} and \ref{eq2}, we know that for any $\alpha \not \in \{x_1, \dots, x_r\}$, $v_{(x-\alpha)}(g(x)) \equiv 0 \pmod{p}$ and $v_{(x-\alpha)}(a(x)) \equiv 0 \pmod{p}$. Let $n_j= \min(m_j, t_j)$, we have that $n_j \equiv m_j \equiv t_j \pmod{p}$.

Now, recall that 
$$(x-x_1)^{\pby} \dots (x-x_r)^{\pbr} h(x)^p=x^{pf(\tau_i^*)}g(x)+a(x).$$
We divide both sides of the equation by $(x-x_1)^{n_1} \dots (x-x_r)^{n_r}$.
The right hand-side of the equation becomes a $p^{th}$ power. Therefore, the left hand-side of the equation must also become a $p^{th}$ power. Therefore, $n_j \equiv \pbj \pmod{p}$. Moreover, $n_j \geq 0$ as both $a(x)$ and $g(x)$ are polynomials. So $m_j,t_j \geq \pbj$. Therefore, 
$$p(f(\tau_i^*)+1)-f(p\tau_i^*)-1=\sum_{j=1}^r \pbj \leq \sum_{j=1}^r m_j \leq \deg(a(x)) \leq pf(\tau_i^*)-f(p\tau_i^*)-1.$$
Which is a contradiction. Thus, $h(x) =0$, which means that $\alpha=0$. This shows that $\psi_{\tau_i}'$ is injective on $\ker(\phi_{\tau_i})$ as desired. 
\end{proof}





\begin{proposition}\label{When is psii' correct}
Let $1\leq i\leq l-1$.  Assume either  $f(p\tau_i^*)=0$ or
$f(\tau_i^*)=g(\tau_i)$.
Then, the map $\psi_{\tau_i}'$ is a valid extension of $\psi_{\tau_i}$, that is  
$Q_{\tau_i}=\ker( \psi_{\tau_i})\oplus \ker(\phi_{\tau_i}').$\end{proposition}
\begin{proof} 
%Assume $\psi_{\tau_i}'$ is injective on $\ker(\phi_{\tau_i})$ (which we shall prove Lemma \ref{psii' injective}). %Then, in order to prove the statement,  it suffices to show that the rank of  $\psi_{\tau_i}'$ is at most $\dim_k \ker(\phi_{\tau_i})$.


Assume $f(p\tau_i^*)=0$. Then $Q_{p\tau_i}=\{0\}$ and since $\phi_{\tau_i}:Q_{\tau_i}\to Q_{p\tau_i}$, we deduce that $\ker(\phi_{\tau_i})=Q_{\tau_i}$, and hence $\ker(\psii')=0$, by Lemma \ref{psii' injective},
%In particular, $\psi_{\tau_i}'$ is defined on all of $Q_{\tau_i}$.

Assume $f(\tau_i^*)=g(\tau_i)$. Recall $g(\tau_i)=g(\tau_{pi})$, since $\tau_i,\tau_{pi}$ are in the same orbit under Frobenius.  
By Lemma \ref{psii' injective},
%$\ker(\phi_{\tau_i})\cap\ker(\psi'_{\tau_i})=\{0\}.$ Hence, 
it suffices to 
show that $\dim {\rm Im}(\psi_{\tau_i}') \leq \dim \ker(\phi_{\tau_i})$.
The inclusion $\psi_{\tau_i}'(Q_{\tau_i}) \subseteq Q_{p\tau_i^*}^{\smvee}$ 
implies $\dim {\rm Im} (\psi_{\tau_i}')\leq \dim(Q_{p\tau_i^*}^{\smvee})= f(p\tau_i)$. On the other hand, 
 $$\dim(\ker(\phi_{\tau_i}))=\dim(Q_{\tau_i})-\dim({\rm Im}(\phi_{\tau_i}))\geq f(\tau_i^*)-\dim(Q_{p\tau_i})= g(\tau_i)-  f(p\tau_i^*)=f(p\tau_i).$$
 Hence, $\dim {\rm Im}(\psi_{\tau_i}')\leq f(p\tau_i)\leq \dim \ker(\phi_{\tau_i})$.
%Now implies that 
%In both instances, in order to conclude, it suffices to verify that 
%, then $\ker(\phi_{\tau_i})+\ker(\psi'_{\tau_i})=\ker(\phi_{\tau_i})\oplus\ker(\psi'_{\tau_i})$. Moreover,
%$$\dim(\ker(\phi_{\tau_i})\oplus\ker(\psi'_{\tau_i})) =\dim(\ker(\phi_{\tau_i})) +\dim(Q_{\tau_i})- \dim(\psi'_{\tau_i}(Q_{\tau_i}))\geq \dim(Q_{\tau_i}).$$
%This means that $\ker(\phi_{\tau_i})\oplus\ker(\psi'_{\tau_i})=Q_{\tau_i}$ and hence $\psi_{\tau_i}'$ is a valid extension of $\psi_{\tau_i}$.
\end{proof}





























\section{Maximal monomials in entries of the extended Hasse--Witt matrix}\label{max monomial}

In Proposition \ref{coefficient of psii}, we computed the entries of the extended Hasse--Witt matrix as polynomials in  $x_1, \dots, x_r$. In this section, we compute the maximal monomials of these entries with respect to the lexicographic order. 

Let $(l,r,a_1,\dots,a_r)$ be a cyclic monodromy datum as in Notation \ref{new part mu ord}. Assume that $l \geq 3$. %Now, identify $\tg=\Z/l\Z$.
Without loss of generality, we reorder the entries in $\au=(a_1,\dots ,a_r)$ such that $a_1+a_2 \not \equiv 0 \pmod{l}$, and hence also $a_3+\dots+a_r \not \equiv 0 \pmod{l}$. (We can always find $a_{i_1}, a_{i_2}$ such that $a_{i_1}+a_{i_2} \not \equiv 0 \pmod{l}$. Otherwise, pick any three $a_i,a_j,a_k$. Since each pair sums up to zero mod $ l$, we have that $a_i \equiv -a_i \pmod{l}$, and hence $\frac{l}{2}\mid a_i$ for each $1 \leq i \leq r$. This contradicts  that $\gcd(a_1, \dots, a_r, l)=1$.)

Let $p$ be a rational prime.
For the remaining of the paper, we assume % $4\leq r\leq 5$ and
$p>l(r-2)$. This condition agrees with the assumption in \cite[Theorem 6.1]{Irene}.


\begin{notation}\label{define c C N}
For $1 \leq i \leq l-1$ and $N \in \mathbb{N}$, we define 
 \begin{align*}
     c_i(N)&=\min\{c : \pby + \dots +\pbc >N\}, \\
 C_i(N)&=N-\pby- \dots -\pbcm, \text{where $c=c_i(N)$},\\
  X_i(N)&=x_1^{\pby} \dots x_{c-1}^{\lfloor{p\langle\frac{ia_{c-1}}{l}\rangle\rfloor}}x_c^{C}, \text{where }c=c_i(N), C=C_i(N),\\
 s_i&=\sum_{k=1}^r \pbk. 
 \end{align*}
 Note that $1\leq c_i(N)\leq r$, $0 \leq C_i(N)< \pbc$, and   
%\begin{align*}
$
\Ci\equiv \sum_{k=c}^r\pbk\pmod{p}.
$
%\end{align*}
\end{notation}

\begin{lemma}\label{cineqr}
For any $j \geq 1$, we have $\ci \neq r$.
\end{lemma}
\begin{proof}
Assume for the sake of contradiction that $\ci=r$. Then $\sum_{k=1}^{r-1}\pbk \leq s_i-pj \leq s_i-p$. So $p \leq \pbr$, which is impossible. 
\end{proof}

\begin{lemma}
Let $1\leq i\leq l-1$ with $\gcd(i,l)=1$. Denote by $\OO$ the Frobenius orbit of $\tau_i$. 

Then,  $g(\OO)=r-2$.

Furthermore, if $r \leq 5$, then for any $j\geq 1$ and $j'\leq g(\OO)$ we have $\ci \leq r-j'+2$.
\end{lemma}
\begin{proof}
We have
\[g(\OO)=f(\tau_i^*)+f(\tau_i)=-2+\sum_{k=1}^{r}\langle\frac{ia_k}{l}\rangle +\langle\frac{-ia_k}{l}\rangle =r-2.\]
By Lemma \ref{cineqr}, we know that $\ci \leq r-1 \leq 4$. On the other hand, $j' \leq g(\OO)=r-2$, so $r-j'+2 \geq r-(r-2)+2=4$. Therefore, $\ci \leq r-j'+2$.
\end{proof}

\begin{lemma}\label{sum of pbk not zero}
Let $2\leq t\leq r$. Assume $p>l(r-2). $\begin{enumerate}
    \item if $3\leq t\leq r$, then $\sum_{k=t}^{r}\pbk\not\equiv 0\pmod{p}$; 
    \item if $2 \leq t \leq 3$, then $1+\sum_{k=t}^{r}\pbk\not\equiv 0\pmod{p}$. 
\end{enumerate}
\end{lemma}
\begin{proof}
We use the fact that $\langle a+b\rangle=\langle a\rangle+\langle b\rangle$ or $\langle a\rangle+\langle b\rangle-1$. Therefore, we have
   \begin{equation*}
       \begin{split}
           \sum_{k=t}^r \pbk &\equiv -\sum_{k=t}^r \langle\frac{pia_k}{l}\rangle \pmod{p}
           \equiv -\big\langle\frac{pi(a_{t}+ \dots + a_r)}{l}\big\rangle-s \pmod{p},
       \end{split}
   \end{equation*}
    for some $0 \leq s \leq (r-t+1)-1 = r-t$. Let $a$ be the residue of $pi(a_{t}+ \dots + a_r) \pmod{l}$. First we show that for $3\leq t\leq r$, we have $-\frac{a}{l}-s \not \equiv 0 \pmod{p}$.
   \begin{itemize}
       \item If $a=0$. Then since $\sum_{k=t}^r \langle\frac{pia_k}{l}\rangle= \frac{a}{l}+s$ is non-zero, $s$ is non-zero. Then $1 \leq s \leq r-t\leq r-3$. Since $p>(r-2)l>s$, $\frac{a}{l}+s=s$ can not be congruent to $0$ mod $p$.
       \item If $a \neq 0$.  If $\frac{a}{l}+s \equiv 0 \pmod{p}$, then $a+ls \equiv 0 \pmod{p}$. On the other hand, $1\leq a+ls \leq (s+1)l \leq (r-2)l$. Since $p>(r-2)l$, this can not happen. Thus, this is non-zero mod $p$.
   \end{itemize}
We next show that for $2\leq t\leq 3$, we have $-\big\langle\frac{pi(a_{t}+ \dots + a_r)}{l}\big\rangle-(s-1) \not \equiv 0 \pmod{p}$.
\begin{itemize}
    \item If $a=0$. Then we get that $\sum_{k=t}^r a_k \equiv 0 \pmod{l}$, so $\sum_{k=1}^{t-1}a_k \equiv 0 \pmod{l}$. But $t-1 \leq 2$, and we have $a_1 \not \equiv 0 \pmod{l}$, and $a_1+a_2 \not \equiv 0 \pmod{l}$. This is a contradiction, therefore $a\neq0$.
    \item If $a \neq 0$. Then $1 \leq a \leq l-1$. Suppose $-\frac{a}{l}-(s-1) \equiv 0 \pmod{p}$, then $p\mid(a+(s-1)l)$. But notice that $(s-1)l+a<sl\leq (r-2)l$. Since $p>(r-2)l$, this cannot happen. So, this is nonzero mod $p$. \qedhere
\end{itemize}
\end{proof}


We consider the lexicographical order on the monomials such that $x_1>x_2> \dots > x_r$. Given a monomial $X$, we denote by $v_{x_s}(X)$ the power of $x_s$ in $X$, $1\leq s\leq r$. 
In the following, given a polynomial $h(x_1,\dots,x_r)$, we denote by $m(h(x_1,\dots,x_r))$ its maximal monomial without coefficient, and  by $M(h(x_1,\dots,x_r))$ the maximal monomial including the coefficient.


For $1\leq i\leq l-1$, recall $\phii$ and $\psii$ denote the restrictions of $\phi$ and $\psi$ to $Q_{\tau_i}$, respectively. We identify $\phii$ and $\psii$ with their matrices with respect to the bases in Lemma \ref{L_bases}, and denote respectively by $\phii(j',j)$ and $\psiip(j',j)$ the  $(j',j)$-th entries of $\phii$ and $\psiip$,  $1\leq j'\leq f(\tau^*_{pi})$ and $1\leq j\leq f(\tau^*_i)$. 

In \cite[Lemma 6.5]{Irene}, assuming $p>l(r-2)$, Bouw proved \begin{align}\label{maxmonomialbouw}
m(\phii(j',j))=X_i(s_i-pj+j').\end{align} In the following, we compute  $m(\psii'(j',j))$, the maximal monomial of $\psiip(j',j)$. 

\begin{proposition}\label{maximal monomial}
Assume $p>l(r-2)$ and $r\leq 5$.
Let $1\leq i\leq l-1$ satisfying $\gcd(i,l)=1$,  $1\leq j'\leq f(\tau^*_{pi})$ and $1\leq j\leq f(\tau^*_i)$. Write $c=\ci$. Then, the maximal monomial in $\psii'(j',j)$ is
\begin{equation*}
    m(\psii'(j',j)) = 
       \begin{cases}
      x_1x_2 \dots x_{r-j'}\XI & \text{if $\ci \leq r-j'$}\\
     x_1x_2 \dots x_{r-j'-1}x_c\XI & \text{if $\ci > r-j'$}.\\
    \end{cases}
\end{equation*}
\end{proposition}
\begin{remark}
By Lemma \ref{cineqr},  when $r \leq 5$, we have $\ci \leq r-j'+2$.
\end{remark}
\begin{proof}
Let $j',j$ such that $1\leq j\leq \fis$ and $1\leq j'\leq f(p\tau_i)$.
Recall from Proposition \ref{coefficient of psii} that
$$\psii'(j',j)=-\sum_{k=1}^r \pbk r_{i,j,k}q_{r-j',k},$$
where $q_{r-j',k}$ is the coefficient of $x^{j'-1}$ in $\frac{(x-x_1) \dots (x-x_r)}{(x-x_k)}$,
%(that is,  the symmetric polynomial of degree $r-j'$, missing $x_k$, multiplied by $(-1)^{r-j'}$), 
$$r_{i,j,k}=(-1)^{s_i-pj}\sum_{n_1+ \dots +n_r=s_i-pj}\binom{\pby}{n_1} \dots \binom{\pbk -1}{n_k} \dots \binom{\pbr}{n_r}x_1^{n_1} \dots x_r^{n_r}.$$


By definition,  the maximal monomial in $q_{r-j',k}$ is
\begin{align}\label{mq}
M(q_{r-j',k})=\begin{cases}
(-1)^{r-j'}x_1 \dots x_{r-j'} &\text{ if } k \geq r-j'+1, \\
   (-1)^{r-j'}x_1 \dots x_{r-j'} \frac{x_{r-j'+1}}{x_k} &\text{ if }k \leq r-j'.
\end{cases}
\end{align}

The maximal monomial in $\fkj$  is 
\begin{align}\label{mr}
M(\fkj)=\begin{cases}
  (-1)^{s_i-pj}\binom{\pbc}{C_i(s_i-pj)}\XI &\text{ if }    k > \ci,\\
    (-1)^{s_i-pj}\binom{\pbc -1}{C_i(s_i-pj)}X_i(s_i-pj) &\text{ if }    k = \ci ,\\
  (-1)^{s_i-pj}\binom{\pbc}{C_i(s_i-pj)+1}X_i(s_i-pj)\frac{x_c}{x_k} &\text{ if }    k < \ci.
\end{cases}
\end{align}
From Proposition \ref{coefficient of psii}, depending on the relation of $r-j'$ and $c_i(s_i-pj)$, we deduce different expressions for $m(\psii'(j',j))$.

Assume $\ci \leq r-j'$.
Then, both $q_{r-j',k}$ and $\fkj$ have larger monomials when $k \geq r-j'+1$. We deduce
   $m(\psii'(j',j))=x_1x_2 \dots x_{r-j'}\XI$
   with coefficient
   $$(-1)^{r-j'+s_i-pj}\binom{\pbc}{\Ci} \sum_{k=r-j'+1}^r \pbk,$$
 assuming this coefficient does not vanish (in characteristic $p$). Indeed, the binomial coefficient does not vanish, and by Lemma \ref{sum of pbk not zero}, $\sum_{k=r-j'+1}^r \pbk \not \equiv 0 \pmod{p}$ (note $r-j'+1 \geq 3$ since $j' \leq r-2$).
   
The case  $r-j'< \ci\leq r-j'+2$ is proved combining Lemmas
\ref{coefficient 1}, \ref{coefficient 2} and \ref{coefficient 3}. %In each case, we show that the given monomial has non-zero coefficient, and that any larger monomial has zero coefficient. 
\end{proof}

\begin{lemma}\label{coefficient 1}
Notations as in Proposition \ref{maximal monomial}.      Assume $c=c_i(s_i-pj)>r-j'$.
        
        Then the coefficient of the monomial 
        $x_1\dots x_{r-j'-1}x_c\XI$   in $\psi_{\tau_i}'(j',j)$ is $$\binom{\pbc}{\Ci}\bigg(\sum_{k=c+1}^r \pbk\bigg)\left(\frac{1+\sum_{k=r-j'}^r \pbk}{1+\Ci}\right).$$ 
        In particular, it does not vanish mod $p$.
\end{lemma}
\begin{proof}% We write $c_i(s_i-pj)>r-j'+e$, for $e \geq 1$. 
Write $X= x_1 \dots x_{r-j'-1}x_{c}\XI$. By Notation \ref{define c C N}, for $1\leq s\leq r$, we have
  \begin{equation*}
      v_{x_s}(X) = 
      \begin{cases}
            \pis +1  & \text{ if } s \leq r-j'-1 \\
            \pis & \text{ if }  r-j' \leq s \leq c-1 \\
            \Ci + 1 & \text{ if }  s=c \\
            0 & \text{ if } s \geq c+1.
      \end{cases}
  \end{equation*}
  We compute the coefficient  of $X$ in %in $\psi_{\tau_i}'(j',j)$ by identifying the coefficient of $X$ in each term of the  sum $\sum_{k=1}^r 
  $\pbk \fkj q_{r-j',k}$, for $1\leq k\leq r$.

Consider $k \leq c-1$. By definition,  $v_{x_k}(\fkj)\leq \pbk-1$ and $v_{x_k}(q_{r-j',k})=0$. Hence 
the coefficient of $X$ in $\fkj q_{r-j',k}$ is $0$. %By this we mean that no monomial in $\fkj q_{r-j',k}$ is $X$. 
%This is because the power of $x_k$ in any monomial in $\fkj$ is at most $\pbk-1$, and the power of $x_k$ in any monomials of $q_{r-j',k}$ is zero.



Consider $k\geq c$. %, let $e=c-r+j'\geq 1$. 
If $Y$ is a monomial in $q_{r-j',k}$ that contributes of $X$ in $\pbk \fkj q_{r-j',k}$, then $v_{x_t}(Y)=0$ for all $t>c$  and $v_{x_t}(Y)=1$ for all $1\leq t\leq r-j'-1$. 
We deduce that %$Y$ is one of $e$ monomials in $q_{r-j',k}$: 
$Y=Y_a =x_1 \dots x_{r-j'-1}x_{a}$, for $r-j' \leq a \leq c$. %(There are $e+1=c-r+j'\geq 1$ such monomials). 
%If $\qkj$ contributes $x_1 \dots x_{r-j'-1}x_a$, then we are looking for 
The coefficient of $\frac{X}{Y_a}=\frac{x_c\XI}{x_{a}}$ in $\pbc\fkj$ is
\begin{itemize}
\item  $\binom{\pba}{\pba-1}\binom{\pbc -1}{\Ci +1}\pbc$ if $a\leq c-1$ and $k=c$,
\item   $\binom{\pba}{\pba-1}
      \binom{\pbc}{\Ci +1}\pbk$ if $a\leq c-1$ and $k\geq c+1$, %then the coefficient of $\frac{X}{Y_a}=\frac{x_c\XI}{x_{a}}$ in $\pbc\fkj$ is 
\item  $\binom{\pbc}{\Ci}\pbk$ if $a=c$ (and hence $k\geq c+1$). %and the coefficient of $\frac{X}{Y_c}=\XI$ in $\pbc\fkj$ 
\end{itemize}



\iffalse
Consider the term for $k=c$. %, let $e=c-r+j'\geq 1$. 
If $Y$ is a monomial in $q_{r-j',k}$ that contributes of $X$ in $\pbk \fkj q_{r-j',k}$, then $v_{x_t}(Y)=0$ for all $t>c$  and $v_{x_t}(Y)=1$ for all $1\leq t\leq r-j'-1$. 
We deduce that %$Y$ is one of $e$ monomials in $q_{r-j',k}$: 
$Y=Y_a=x_1 \dots x_{r-j'-1}x_{a}$, for $r-j' \leq a \leq c-1$. (There are $e=c-r+j'\geq 1$ such monomials). 
%If $\qkj$ contributes $x_1 \dots x_{r-j'-1}x_a$, then we are looking for 
Note that the coefficient of $\frac{X}{Y_a}=\frac{x_c\XI}{x_{a}}$ in $\pbc\fkj$ is $\binom{\pba}{\pba-1}\binom{\pbc -1}{\Ci +1}\pbc$.

If $k \geq c+1$, the summands in $q_{r-j',k}$ that contribute must not contain any $x_t$ for $t>c$ and must contain $x_1x_2 \dots x_{r-j'-1}$. So then, there are $e+1$ monomials in $q_{r-j',k}$ can contribute: $x_1 \dots x_{r-j'-1}x_{a}$ for $r-j' \leq a \leq c$.
\begin{itemize}
    \item If $\qkj$ contributes $x_1 \dots x_{r-j'-1}x_a$ for $r-j'\leq a\leq c-1$, then we are looking for the coefficient of $\frac{x_c\XI}{x_{a}}$ in $\pbk\fkj$, which is 
      $\binom{\pba}{\pba-1}
      \binom{\pbc}{\Ci +1}\pbk$.
    \item If $\qkj$ contributes $x_1 \dots x_{r-j'-1}x_c$, then we are looking for the coefficient of $\XI$ in $\pbk\fkj$, which is $\binom{\pbc}{\Ci}\pbk$.
\end{itemize}
\fi


By Proposition  \ref{coefficient of psii}, 
$\psii'(j',j)=-\sum_{k=1}^r \pbk r_{i,j,k}q_{r-j',k}.$ Hence, the coefficient of $X$ in $\psii'(j',j)$ is 
\begin{equation*}
       \begin{split}
           &\pbc \binom{\pbc -1}{\Ci+1} \sum_{a=r-j'}^{c-1} \binom{\pba}{\pba -1}\\
           &+\binom{\pbc}{\Ci+1} \sum_{k=c+1}^r \sum_{a=r-j'}^{c-1} \binom{\pba}{\pba -1}\pbk +\binom{\pbc}{\Ci} \sum_{k=c+1}^r \pbk.
       \end{split}
   \end{equation*}
%  Now, we need to show the above coefficient is non-zero mod $p$. We use 
Recall the identities
 % \begin{align*}
    $\binom{m}{n+1}=\frac{m-n}{n+1}\binom{m}{n}$ and 
    %&
    $\binom{m-1}{n}=\frac{m-n}{m}\binom{m}{n}.$
%  \end{align*}
Then
 \begin{equation*}
     \begin{split}
     &\pbc \binom{\pbc -1}{\Ci+1} \sum_{a=r-j'}^{c-1} \binom{\pba}{\pba -1}\\
    &+\binom{\pbc}{\Ci+1} \sum_{k=c+1}^r \sum_{a=r-j'}^{c-1} \binom{\pba}{\pba -1}\pbk \\
    &=\sum_{a=r-j'}^{c-1} \pba \binom{\pbc}{\Ci+1}\left(\frac{\pbc -1 -\Ci}{\pbc}\pbc + \sum_{k=c+1}^r \pbk\right)\\
    &=- \binom{\pbc}{\Ci+1} \sum_{a=r-j'}^{c-1} \pba.
     \end{split}
 \end{equation*}
Hence, the coefficient of $X$ in $\psii'(j',j)$ is 
  \begin{equation*}
      \begin{split}
        & -\binom{\pbc}{\Ci+1} \sum_{a=r-j'}^{c-1} \pba+ \binom{\pbc}{\Ci}\sum_{k=c+1}^r \pbk \\
        &= \binom{\pbc}{\Ci}\left(-\frac{\pbc-\Ci}{\Ci+1} \sum_{a=r-j'}^{c-1}\pba +\sum_{k=c+1}^r \pbk \right) \\
        &= \binom{\pbc}{\Ci}\bigg(\sum_{k=c+1}^r \pbk\bigg) \left(\frac{\sum_{a=r-j'}^{c-1}\pba}{\Ci +1}+1\right) \\
        &=\binom{\pbc}{\Ci}\bigg(\sum_{k=c+1}^r \pbk\bigg)\left(\frac{1+\sum_{a=r-j'}^r \pba}{1+\Ci}\right).
      \end{split}
  \end{equation*}
  
  We verify that this coefficient does not vanish modulo $p$.
  By assumption, $c>r-j'\geq r-g(\OO)=2$.   
  %$c+1=r-j'+e+1 \geq r-g(\OO)+1+e \geq 4$, 
  Hence, by Lemma \ref{sum of pbk not zero}, we have $\sum_{k=c+1}^r \pbk \not \equiv 0 \pmod{p}$. 
  %At the same time, $r-j' \geq r-g(\OO) \geq 2$. Also, 
  By Lemma \ref{cineqr},  $c\leq r-1$, hence  $2\leq r-j'\leq r-2\leq 3$ (since $r\leq 5$). 
 By Lemma \ref{sum of pbk not zero},  we have $1+\sum_{a=r-j'}^r \pbk \neq 0 \pmod{p}$. 
  \end{proof}

  
  In the remaining two lemmas, we verify that if $c>r-j'$, any monomial in $\psii'(j',j)$ larger than $X=x_1 \dots x_{r-j'-1} x_c\XI$ has coefficient $0$. 
  \begin{lemma}\label{vanishing of larger 1}\label{coefficient 2}
  Notations as in Proposition \ref{maximal monomial}. 
Assume $c=r-j'+1$. Let $X=%x_1 \dots x_{r-j'} \XI \frac{x_c }{x_{c-1}}=
x_1\dots x_{c-2}x_c\XI.$

   Then, for any monomial $Y$ satisfying $X<Y$, %\leq  x_1 \dots x_{c-1}\XI$, 
   the coefficient of $Y$ in $\psii'(j',j)$ is $0$.
  \end{lemma}
  \begin{proof}
  %Note that $X=x_1 \dots x_{r-j'} \XI \frac{x_c }{x_{c-1}}<x_1 \dots x_{r-j'}\XI$.
Recall from (\ref{mq}) and (\ref{mr}) that,  for any $1\leq k\leq r$, $m(q_{r-j',k})\leq x_1\dots x_{r-j'}=x_1\dots x_{c-1}$ and $m(r_{i,j,k})\leq X_i(s_i-pj)$. Hence, by Proposition \ref{coefficient of psii},  $m(\psi'_{\tau_i}(j',j))\leq x_1\dots x_{c-1}X_i(s_i-pj)$. 

  
Let $Y>X$ be a monomial  with non-zero coefficient in $\psii'(j',j)$. Then,  \begin{align}\label{ineqY}
    X<Y\leq m(\psi'_{\tau_i}(j',j))\leq  x_1\dots x_{c-1}X_i(s_i-pj).\end{align}
Furtheremore, since $\psii'(j',j)$ is a homogeneous polynomial in $x_1,\dots,x_r$, we deduce from Proposition \ref{maximal monomial} that $\deg(Y)=\deg(X)=s_i-pj+c-1$. 


From the inequalities in (\ref{ineqY}),  we deduce that $v_{x_s}(X)=v_{x_s}(Y)$ for all $1\leq s\leq c-2$, and that $\pbcm \leq v_{x_{c-1}}(Y)\leq \pbcm+1$. We claim that $v_{x_{c-1}}(Y) = \pbcm +1$. Indeed, suppose by contradiction that $v_{x_{c-1}}(Y)=\pbcm= v_{x_{c-1}}(X)$. In this case, the inequality $X<Y$ implies  $v_{x_c}(X)\leq v_{x_c}(Y)$. We deduce that
$$\deg(X)=\sum_{s=1}^{c}v_{x_s}(X)\leq \sum_{s=1}^{c}v_{x_s}(Y)\leq \deg(Y)=\deg(X).$$
The equality forces $v_{x_c}(X)=v_{x_c}(Y)$ and $v_{x_s}(Y)=0$, for all $s\geq c+1$. This in turn implies $Y=X$. We conclude that $v_{x_{c-1}}(Y) = \pbcm +1$.

For $c\leq s\leq r$, set $m_s=v_{x_{s}}(Y)\geq 0$. %We know that all $m_s\geq 0$. 
Note that
$$0=\deg(Y)-\deg(X)=\sum_{s=1}^{r}v_{x_s}(Y)-v_{x_s}(X)= 1+(m_c-1-C_i(si-pj))+\sum_{s=c+1}^{r}m_s,$$
which implies $\sum_{s=c+1}^r m_s=C_i(s_i-pj)-m_c$. Denote $m=\sum_{s=c+1}^r m_s=C_i(s_i-pj)-m_c$. Then,
$$Y= x_1 \dots x_{c-1}\frac{x_{c+1}^{m_{c+1}}\dots x_{r}^{m_{r}}}{x_c^m} \XI.$$
We deduce that the only monomial in $\qkj$  that can contribute to $Y$ is $x_1 \dots x_{c-1}$, and hence $k\geq c$.

Consider the coefficient of $\frac{Y}{x_1\cdots x_{c-1}}=\XI\frac{x_{c+1}^{m_{c+1}}\dots x_{r}^{m_{r}}}{x_c^m}$ in $\pbk\fkj$. Summing them over all $k \geq c$, we deduce that the coefficient of Y in $\psii(j',j)$ is
\begin{equation*}
  \begin{split}
      &\binom{\pbc -1}{\Ci -m}\binom{\pbcp}{m_{c+1}} \dots \binom{\pbr}{m_{r}}\pbc \\
      &+\sum_{k=c+1}^r \binom{\pbc}{\Ci-m}\binom{\pbcp}{m_{c+1}} \dots \binom{\pbk -1}{m_{k}} \dots \binom{\pbr}{m_{r}}\pbk, \\
        &=\binom{\pbc}{\Ci-m}\prod_{s=c+1}^{r} \binom{\lfloor p\langle\frac{ia_{s}}{l}\rangle\rfloor}{m_s}\\
          &\times\left( \frac{\pbc -\Ci +m}{\pbc}\pbc + \sum_{k=c+1}^r \frac{\pbk-{m_{k}}}{\pbk}\pbk\right) \\
          &=\binom{\pbc}{\Ci-m}\binom{\pbcp}{m_{c+1}}\dots \binom{\pbr}{m_{r}} \left(\sum_{k=c}^r \pbk -\Ci +m- \sum_{k=c+1}^r m_{k}\right) \\
          &\equiv  0\pmod{p}.
      \end{split}
\end{equation*}
  This concludes the proof.
%   Thus for $r-j'+1=\ci$, any larger monomial has coefficient $0$. We have shown that $m(\psii'(j',j))$ is the desired monomial.
  \end{proof}

% Finally, for $r-j'+2=\ci$, we show that any monomial larger than 
 %$\XI x_1 \dots x_{r-j'-1}x_c$ has coefficient zero.
 
 
 \begin{lemma}\label{coefficient 3}
Notations as in Proposition \ref{maximal monomial}. 
Assume $c=r-j'+2 $. Let $X= x_1 \dots x_{c-3}x_c\XI$. 

Then, for any monomial $Y $ satisfying $ X<Y$, %\leq  x_1 \dots x_{c-2}\XI$,  
the coefficient of $Y$ in $\psii'(j',j)$ is $0$.
 \end{lemma}
 \begin{proof}
Let $Y>X$ be a monomial in $\psii'(j',j)$ with non-zero coefficient. 
Similarly to the proof of Lemma \ref{coefficient 2}, we deduce
%Since $\psii'(j',j)$ is a homogeneous polynomial in $x_1,\dots,x_r$, we can assume 
$\deg(Y)=\deg(X)=s_i-pj+c-2$, and $X<Y\leq  x_1 \dots x_{c-2}\XI$. Hence,
 $v_{x_s}(Y)=\pis+1$ if $1 \leq s \leq c-3$, and $\pbct\leq v_{x_{c-2}}(Y)\leq \pbct+1$.

%By Proposition \ref{coefficient of psii},  if $v_{x_{c-1}}(Y)\geq \pbcm+2$, then coefficient of $Y$ is zero. Hence, we may assume $Y \leq  x_1 \dots x_{c-2}\XI$.
 
\textbf{Case 1}: Assume $v_{x_{c-2}}(Y)=\pbct +1$. For $c-1\leq s\leq r$, denote $v_{x_s}(Y)=m_s$. Note that
$$0=\deg(Y)-\deg(X)=\sum_{s=1}^{r}v_{x_s}(Y)-v_{x_s}(X)= 1+(m_{c-1}-\pbcm) +(m_c-1-C_i(si-pj))+\sum_{s=c+1}^{r}m_s.$$
Denote $m_c'=m_c-C_i(s_i-pj)$ and $m=\pbcm- m_{c-1}$. Then $m=\sum_{s=c}^{r}m_s -C_i(s_i-pj)$ and
 $$Y=\XI x_1 \dots x_{c-2}\frac{x_{c}^{m'_c} x_{c+1}^{m_{c+1}}\dots x_{r}^{m_{r}}}{x_{c-1}^m}.$$
  
We deduce that the only monomial in $q_{r-j',k}$ contributing to $Y$ is $x_1 \dots x_{c-2}$, and hence $k\geq c-1$. %So, the contribution of $r_{i,j,k}$ must be $\XI\frac{x_c^{m_1'} \dots x_r^{m_{r-c+1}}}{x_{c-1}^m}$. 
From Proposition \ref{coefficient of psii}, we deduce that the coefficient of $Y$ in $\psii'(j',j)$ is
  \begin{equation*}
  \begin{split}
      &\pbcm \binom{\pbcm-1}{\pbcm-m}\binom{\pbc}{m_c} \dots \binom{\pbr}{m_{r}}\\
      &+\sum_{k=c}^r\pbk \binom{\pbcm}{\pbcm-m}\binom{\pbc}{m_c} \dots\binom{\pbk-1}{m_{k}}\dots \binom{\pbr}{m_{r}},\\
   \end{split}
   \end{equation*}
  which simplifies to 
   \begin{equation*}
   \begin{split}
      &\binom{\pbcm}{\pbcm-m}\prod_{s=c}^{r} \binom{\lfloor p\langle\frac{ia_{s}}{l}\rangle\rfloor}{m_{s}} \times\bigg(\pbcm \frac{m}{\pbcm}+  \sum_{k=c}^r \pbk \frac{\pbk-m_{k}}{\pbk} \bigg).
    \end{split}
  \end{equation*}
Note that the sum  in the last bracket vanishes modulo $p$, since
  $$m-(m_c+\dots+m_{r})+\sum_{k=c}^r\pbk
    =-\Ci+\sum_{k=c}^r\pbk\equiv 0\pmod{p}.$$
 
\textbf{Case 2}: Assume $v_{x_{c-2}}(Y)=\pbct$. Then, since $Y>X$ we have $\pbcm\leq v_{x_{c-1}}(Y)$. By Proposition \ref{coefficient of psii}, if $v_{x_{c-1}}(Y)\geq \pbcm+2$, then coefficient of $Y$ is zero. Therefore,
 $ \pbcm\leq v_{x_{c-1}}(Y) \leq \pbcm+1$.
 
We claim that $v_{x_{c-1}}(Y)=\pbcm+1$. Indeed, suppose for the sake of contradiction that
  $v_{x_{c-1}}(Y)=\pbcm$. Since $X<Y$ we deduce $v_{x_{c}}(X) \leq v_{x_{c}}(Y)$. From the equality $\deg(Y)=\deg(X)$, we deduce $Y=X$. 
  %This is a contradiction, hence $v_{x_{c-1}}(Y)>\pbcm$. Next, since $Y \leq \XI x_1 \dots x_{c-2}$, we have $v_{x_{c-1}}(Y)\leq \pbcm+1$.
  
For $c\leq s\leq r$, let $m_s=v_{x_s}(Y)$. Note that
$$0=\deg(Y)-\deg(X)=\sum_{s=1}^{r}v_{x_s}(Y)-v_{x_s}(X)= 1+(m_c-1-C_i(si-pj))+\sum_{s=c+1}^{r}m_s,$$
which implies $\sum_{s=c}^r m_s=C_i(s_i-pj)$.
Denote $m=C_i(si-pj)-m_c$. Then,
$$Y=\XI x_1 \dots x_{c-3}x_{c-1}\frac{x_{c+1}^{m_{c+1}} \dots x_{r}^{m_{r}}}{x_{c}^m}.$$
We deduce that the only monomial $q_{r-j',k}$ contributing to $Y$ is $x_1 \dots x_{c-3}x_{c-1}$, and hence either $k=c-2$ or $k\geq c$.
Note that if $k=c-2$, then $v_{x_{c-2}}(q_{r-j',k})=0$ and $v_{x_{c-2}}(r_{i,j,k})\leq \pbct-1$. This implies that  the coefficient of $Y$ in $q_{r-j',c-2}r_{i,j,c-2}$ is $0$.
We deduce that the coefficient of $Y$ in $\psi_i'(j',j)$ is
  \begin{equation*}
      \begin{split}
          &\sum_{k=c}^r \binom{\pbc}{m_c} \dots \binom{\pbk-1}{m_{k}} \dots \binom{\pbr}{m_{r}}\pbk  \\
          &= \binom{\pbc}{m_c} \dots \binom{\pbr}{m_{r}} \left(\sum_{k=c}^r\frac{\pbk-m_{k}}{\pbk} \pbk \right) \\
          & =\binom{\pbc}{m_c} \dots \binom{\pbr}{m_{r}}\left(\sum_{k=c}^r\pbk-(m_c+ \dots +m_r)\right) \\
          &\equiv 0\pmod{p}.\qedhere
      \end{split}
  \end{equation*}
%So both cases, the coefficient of monomials larger than $X$ is $0$.
 \end{proof}
%Thus, we have shown that the maximal monomial of $\psii'(j',j)$ is the given monimal in all the cases.
%\end{proof}





\section[]{$p$-ordinariness in special instances}\label{Section 0,1 in signature}


Let $(l,r,a_1,\dots,a_r)$ be a cyclic monodromy datum and $p$ a rational prime, as in Notation \ref{new part mu ord}. %, and  identify $\tg=\Z/l\Z=\{b\mid 0\leq b\leq l-1\}$. 
%Let $p$ be a rational prime. 
Assume   $4\leq r\leq 5$ and $p>l(r-2)$.
%for $0< i < l$,  there is a character $\tau_i\in\tg$.

%Recall %that we have fixed a monodromy datum $(l,r,a_1,\dots,a_r)$ and a prime $p$ satisfying the conditions of 
%Notation \ref{new part mu ord}, with  $4\leq r\leq 5$. 

For $\xb \in \mlra(\fpb)$, let $\ct$ be the normalization of $y^l=(x-x_1)^{a_1} \dots (x-x_r)^{a_r}$, and denote by
%Given a Frobenius orbit $\OO$ in $\og$ and $\tau \in \OO$, let 
$\wt(\ct)$ the Weyl coset representative at the character $\tau$ of the mod $p$ Dieudonne module of $C_{\tb}$.


%smooth curves in the family as follows. $\mathcal{M}(l,r,\au)$ is the open subset of $\fpb^r$ such that $\xb=(x_1, \dots x_r)$ satisfies $x_i \neq x_j$ for $i \neq j$. In other words, $\mathcal{M}(l,r,\au)$ is $\fpb^r$ minus the weak diagonal. Then,  
%For each $\xb \in  \mathcal{M}(l,r,\au)$, we associated $\ct$ which is the normalization of $y^l=(x-x_1)^{a_1} \dots (x-x_r)^{a_r}$, and for each $\tau \in \OO$, we have $\wt(C_t)$ to be the Weyl coset representatives at character $\tau$ of the Dieudonne module associated to $C_{\tb}$. 
\begin{definition}\label{generically maximal}
We say that $\wt$ is generically maximal if there exists a non-empty open subset $U$ of $\mlra(\fpb)$ such that for every $\tb \in U$, $\wt(\ct)$ is maximal.  
\end{definition}

The goal of this section is to prove the following result.

\begin{theorem}\label{signature 1}
Let $\OO$  the Frobenius orbit in $\tg^\n$. %of $\tau_b\in\tg$, for some $0\leq b\leq l-1$ satisfying $\gcd(b,l)=1$.
Assume $\FF(\OO)$ contains $\{0,1\}$. 

If $\tau\in \OO$ satisfies either $f(\ts)=0$ or $f(\ts)=1$,  then  $\wt$ is generically maximal.
\end{theorem}
Note that the above Theorem immediately implies the following corollary.
\begin{corollary}
Let $\OO$  the Frobenius orbit in $\tg^\n$. %of $\tau_b\in\tg$, for some $0\leq b\leq l-1$ satisfying $\gcd(b,l)=1$.
%Let $\OO$  the Frobenius orbit of $\tau_b$, for some $0< b< l$ satisfying $\gcd(b,l)=1$.
%Let $0< b< l$ satisfying  $\gcd(b,l)=1$. Denote by $\OO$  the Frobenius orbit of $\tau_b$.  
Assume $\FF(\OO)$ contains $\{r-2,r-3\}$.

If $\tau \in \OO$ satisfies either $\fts =r-2$ or $\fts=r-3$, then $\wt$ is generically maximal.
\end{corollary}
\begin{proof}
If $\FF(\OO)$ contains $\{r-2,r-3\}$, then $\FF(\overline{\OO})$ contains $\{0,1\}$, and for any $\tau \in \OO$ such that $\fts =r-2$ or $r-3$, $\ft=0$ or $1$. Therefore, $\wts$ is generically maximal. Therefore, $\wt$ is generically maximal. 
\end{proof}



\begin{proof}[Proof of Theorem \ref{signature 1}]
Note that since $|\FF(\OO)| \geq 2$, we know that $l \geq 3$. Thus, the assumption at the start of section \ref{max monomial} on $\lra$ is satisfied.

We have $f_{\OO,1}=0$ and $f_{\OO,2}=1$. We will be done if we show that the hypothesis of Theorem \ref{numerical criteria} is generically satisfied with $u=2$. Pick $\tau_{\OO,1},\tau_{\OO,2}\in\OO$ such that $f(\tau_{\OO,1}^*)=0$ and $f(\tau_{\OO,2}^*)=1$. We will be done if show the following:
\begin{enumerate}
    \item $\dim(\pi_{\tau_{\OO,1}}\circ L_{\tau_{\OO,1},|\OO|-1} \circ \dots \circ L_{\tau_{\OO,1},0}(M_{\tau_{\OO,1}}))=0$;
    \item
   $\dim(\pi_{\tau_{\OO,2}}\circ L_{\tau_{\OO,2},|\OO|-1} \circ \dots \circ L_{\tau_{\OO,2},0}(M_{\tau_{\OO,2}}))=1.$
\end{enumerate}
The first condition is trivially satisfies since $\pi_{\tau_{\OO,1}}:M_{\tau_{\OO,1}}\to Q_{\tau_{\OO,1}}$ and $\dim(Q_{\tau_{\OO,1}})=f(\tau_{\OO,1}^*)=0$. So we only need to show the second condition. Denote $\tau=\tau_{\OO,2}$, we have $f(\ts)=1$. 

We will now translate the second condition in terms of $\phi,\psi$.
Recall the notation for Hasse--Witt triple from Section \ref{duality}. For $0 \leq i \leq |\OO|-1$, 
%recall the following choices of bases from Section \ref{}
%\begin{align*}
%&\{\zeta_{p^i\tau^*,j}:1 \leq j \leq f(p^i\tau) \} \text{ for } Q_{p^i\tau^*},
%&
%&\{\zeta_{p^{i+1}\tau^*,j}: 1 \leq j \leq f(p^{i+1}\tau) \} \text{ for } Q_{p^{i+1}\tau^*},\\
%& \{\omega_{p^i\tau^*,j}: 1 \leq j \leq f(p^i\tau) \} \text{ for } Q_{p^i\tau^*}^{\smvee},
%&
%&\{\omega_{p^{i+1}\tau^*,j}: 1 \leq j \leq f(p^{i+1}\tau) \} \text{ for } Q_{p^{i+1}\tau^*}^{\smvee}.
%\end{align*}
consider the map $\check{\phi}_{p^i\tau^*}: Q_{p^i\tau^*}^{\smvee} \to Q_{p^{i+1}\tau^*}^{\smvee}$, defined as $\check{\phi}_{p^i\tau^*}(x)=\phi_{p^i\tau^*}(\check{x})^{\smvee}$, and the map $\check{\psi}_{p^i\tau^*}: Q_{p^i\tau^*}^{\smvee} \to Q_{p^{i+1}\tau}$, defined as $\check{\psi}_{p^i\tau^*}(x)=\psi_{p^i\tau^*}(\check{x})^{\smvee}$.
Note that, with respect to the choice of bases for $Q_{\tau'}$ and $Q^{\smvee}_{\tau'}$ given in Section \ref{duality}, the matrices representing $\check{\phi}_{p^i\tau^*}$ and $\phi_{p^i\tau^*}$ (respectively,  $\check{\psi}_{p^i\tau^*}, \psi_{p^i\tau^*}$) are the same.
%Now, fix a $\tau\in\OO$ with $\fts=1$.
For $0\leq i\leq |\OO|-1$, we define
\begin{equation}\label{Eq_A_i}
    A_{i}=
    \begin{cases}
    \phi_{p^i\tau}: Q_{p^i\tau}\to Q_{p^{i+1}\tau} &\text{if } f(p^i\tau^*)\geq 1, f(p^{i+1}\tau^*)\geq 1,\\
    \check{\phi}_{p^i\tau^*}: Q_{p^i\tau^*}^{\smvee} \to Q_{p^{i+1}\tau^*}^{\smvee}  &\text{if } f(p^i\tau^*)=0, f(p^{i+1}\tau^*)=0,\\
    \psi_{p^i\tau}: Q_{p^i\tau}\to Q_{p^{i+1}\tau^*}^{\smvee} &\text{if } f(p^i\tau^*)\geq 1, f(p^{i+1}\tau^*)=0,\\
    \check{\psi}_{p^i\tau^*}: Q_{p^i\tau^*}^{\smvee} \to Q_{p^{i+1}\tau} &\text{if } f(p^i\tau^*)=0, f(p^{i+1}\tau^*)\geq 1.
    \end{cases}
\end{equation}
Note that the composition
$A_{|\OO|-1}\circ \dots \circ A_{0} :Q_{\tau}\to Q_{\tau}$
is well defined.
By Proposition \ref{When is psii' correct}, we know that for $0\leq i\leq |\OO|-1$ with either $f(p^{i+1}\ts)=0$ or $f(p^i\ts)=0$, $\psi'$ is a valid extension of $\psi$.

\textbf{Claim 1}: The maps
$A_{|\OO|-1}\circ \dots \circ A_{0} :Q_{\tau}\to Q_{\tau}$ and 
$\pi_{\tau}\circ L_{\tau,|\OO|-1}\circ \dots \circ L_{\tau,0} :Q_{\tau}\to Q_{\tau}$ agree.\\
\textbf{Proof of Claim 1}:
By (\ref{Eq_L}), since $\fts=1$, for $0 \leq i \leq |\OO|-1$ we have 
\begin{equation*}
    L_{\tau,i} = \begin{cases}
           F_{p^i\tau} &\text{if } f(p^i\tau^*)\geq 1\\
           V'_{p^i\tau} &\text{if } f(p^i\tau^*)=0.
    \end{cases}
\end{equation*}
Firstly note that $F_{p^i\tau}=\phi_{p^i\tau}+\psi_{p^i\tau}$ and $V'_{p^i\tau}=\check{\phi}_{p^i\tau^*}+\check{\psi}_{p^i\tau^*}$.
Also notice that for $0\leq i\leq |\OO|-2$:
\begin{itemize}
    \item If $f(p^i\tau^*)\geq 1, f(p^{i+1}\tau^*)\geq 1$, then $L_{\tau,i}=F_{p^i\tau}$ and $L_{\tau,i+1}=F_{p^{i+1}\tau}$. Moreover, $F_{p^{i+1}\tau}\circ F_{p^{i}\tau}= F_{p^{i+1}\tau}\circ \phi_{p^i\tau}$.
    \item If $f(p^i\tau^*)=0, f(p^{i+1}\tau^*)=0$, then $L_{\tau,i}=V'_{p^i\tau}$ and $L_{\tau,i+1}=V'_{p^{i+1}\tau}$. Moreover, $V'_{p^{i+1}\tau}\circ V'_{p^{i}\tau}=  V'_{p^{i+1}\tau}\circ \check{\phi}_{p^i\tau^*}$.
    \item If $f(p^i\tau^*)\geq 1, f(p^{i+1}\tau^*)=0$, then $L_{\tau,i}=F_{p^i\tau}$ and $L_{\tau,i+1}=V'_{p^{i+1}\tau}$. Moreover, $V'_{p^{i+1}\tau}\circ F_{p^{i}\tau}= V'_{p^{i+1}\tau} \circ \psi_{p^i\tau}$.
    \item If $f(p^i\tau^*)=0, f(p^{i+1}\tau^*)\geq 1$, then $L_{\tau,i}=V'_{p^i\tau}$ and $L_{\tau,i+1}=F_{p^{i+1}\tau}$. Moreover, $F_{p^{i+1}\tau}\circ V'_{p^{i}\tau}= F_{p^{i+1}\tau}\circ \check{\psi}_{p^i\tau^*}$.
\end{itemize}
Moreover, for $i=|\OO|-1$, if $f(p^{|\OO|-1}\ts)\geq 1$, then $L_{\tau,|\OO|-1}=F_{p^{|\OO|-1}\tau}$. Therefore $\pi_{\tau}\circ L_{\tau,|\OO|-1}=\phi_{p^{|\OO|-1}\tau}$. On the other hand, if $f(p^{|\OO|-1}\ts)=0$, then $L_{\tau,|\OO|-1}=V'_{p^{|\OO|-1}\tau}$. Therefore $\pi_{\tau}\circ L_{\tau,|\OO|-1}=\check{\psi}_{p^{|\OO|-1}\ts}$. This completes the proof of the claim.

Therefore, it suffices to show that $A_{|\OO|-1}\circ \dots \circ A_{0}:Q_{\tau}\to Q_{\tau}$ has rank at least $1$ for $(x_1,\dots, x_r)$ outside a proper closed subset of $\mlra(\fpb)$. Equivalently, we need to show that the composite matrix is not identically zero as a polynomial in $\fpb[x_1, \dots, x_r]$. 


Consider the set $\mathfrak{J}$ consisting of all functions $J:\{0,1, \dots, |\OO|\} \to \mathbb{N}$
such that $J(0)=J(|\OO|)=1$, and for each $0<i<|\OO|$, $1 \leq J(i) \leq a(i)$, where 
\begin{equation*}
    a(i) = 
    \begin{cases}
    f(\pits) & \text{ if $A_i=\phi_{\pit}$ or $\psi_{\pit}$} \\
    f(\pit) & \text{ if $A_i=\check{\phi}_{\pits}$ or $\check{\psi}_{\pits}$}.\\
    \end{cases} 
\end{equation*}
Note that $A_i$ is a $a(i+1)\times a(i)$ matrix; we denote by $A_i(j',j)$ denote the $(j',j)^{th}$ entry of the matrix $A_i$, and by $m_i(j',j)=m(A_i(j',j))$ the maximal monomial in $A_i(j',j)$.

For $J \in \mathfrak{J}$, set $R_{J,i}=A_i(J(i+1),J(i))$, $T_{J,i}=m_i(J(i+1),J(i))$, 
\begin{equation}
R_{J}=\prod_{i=0}^{|\OO|-1}R_{J,i}^{p^{|\OO|-i-1}} \text{ and } T_J=\prod_{i=0}^{|\OO|-1}T_{J,i}^{p^{|\OO|-i-1}}.
\end{equation}
By definition, $T_{J}$ is the maximal monomial of $R_J$.
Since the maps $A_i$, $0\leq i\leq|\OO|-1$, are $\sigma$-linear, we see that
\begin{equation}
   \aip=\sum_{J \in \mathfrak{J}}R_J\in \fpb[x_1,\dots,x_r]
\end{equation}
If we show that the largest $T_J$ only appears once, then we will be able to conclude that the sum is non-zero and this will complete the proof.

We will show that for any $J_1, J_2 \in \mathfrak{J}$, if $T_{J_1}=T_{J_2}$ then $J_1=J_2$. First, we will show the following claim.\\
\textbf{Claim 2}: If $T_{J_1}=T_{J_2}$ then $v_{x_s}(T_{J_1,i})=v_{x_s}(T_{J_2,i})$, for all $1 \leq s \leq r$ and $0 \leq i \leq |\OO|-1$.\\
\textbf{Proof of Claim 2}:
For $1 \leq s \leq r$ and $0 \leq i \leq |\OO|-1$, denote
$\eis=v_{x_s}(T_{J_1,i})-v_{x_s}(T_{J_2,i})$. Our goal is to show $\eis=0$, for all $i,s$.
Since $T_{J_1}=T_{J_2}$, for each $1 \leq s \leq r$, we have that
$$\sum_{i=0}^{|\OO|-1}p^{|\OO|-i-1}\eis=v_{x_s}(T_{J_1})-v_{x_s}(T_{J_2})=0.$$
If we show that $|\eis|<p$ for all  $0 \leq i \leq |\OO|-1$ and $1 \leq s \leq r$, then it will follow that $\eis=0$ for all  $0 \leq i \leq |\OO|-1$ and $1 \leq s \leq r$. 

By assumption, $\tau=\tau_b$ for $1\leq b\leq l-1$ satisfying $\gcd(b,l)=1$, and hence  $p^i\tau=\tau_{p^ib}$. 
We consider two cases.\\
{\bf Case 1}: Assume $A_i=\phi_{\pit}$ or $A_i=\check{\phi}_{\pit^*}$. For convenience, set
     \begin{align*}
    N(J,i)&=
         \begin{cases}
          s_{\pib}-pJ(i)+J(i+1) &\text{if } A_i=\phi_{\pit}\\
          s_{\pib^*}-pJ(i)+J(i+1) &\text{if } A_i=\check{\phi}_{\pit^*};
         \end{cases}
    &
    c(J,i)&=
         \begin{cases}
         c_{\pib}(N(J,i)) & \text{if }A_i=\phi_{\pit}\\ 
         c_{\pibs}(N(J,i)) & \text{if } A_i=\check{\phi}_{\pit^*};
         \end{cases}\\
    C(J,i)&=
         \begin{cases}
         C_{\pib}(N(J,i)) & \text{if }A_i=\phi_{\pit}\\ 
         C_{\pibs}(N(J,i)) & \text{if } A_i=\check{\phi}_{\pit^*};
         \end{cases}
    &
     X(J,i)&=
         \begin{cases}
         X_{\pib}( N(J,i)) & \text{if }A_i=\phi_{\pit}\\
         X_{\pibs}( N(J,i)) & \text{if } A_i=\check{\phi}_{\pit^*};
         \end{cases}
     \end{align*}
     where $c,C,N,s,X$ are given in Notation \ref{define c C N}. Then, $T_{J,i}=m_i(J(i+1),J(i))=X(J,i)$, and we have the following expression for $\eis=v_{x_s}(T_{J_1,i})-v_{x_s}(T_{J_2,i})$:
         \begin{equation}\label{Eqeis1}
 \eis =
    \begin{cases}
      0 & \text{if $c(J_1,i)>s,c(J_2,i)>s$}\\
      C(J_1,i)-\pfibs & \text{if $c(J_1,i)=s,c(J_2,i)>s$}\\
      \pfibs-C(J_2,i)& \text{if $c(J_1,i)>s,c(J_2,i)=s$} \\
      C(J_1,i)-C(J_2,i) & \text{if $c(J_1,i)=c(J_2,i)=s$}\\
      -\pfibs & \text{if $c(J_1,i)<s,c(J_2,i)>s$}\\
       -C(J_2,i) & \text{if $c(J_1,i)<s,c(J_2,i)=s$}\\
       0 & \text{if $c(J_1,i)<s,c(J_2,i)<s$}\\
       \pfibs & \text{if $c(J_1,i)>s,c(J_2,i)<s$}\\
       C(J_1,i) & \text{if $c(J_1,i)=s,c(J_2,i)<s$}.
    \end{cases}       
\end{equation}
By definition,  $0\leq C(J,i) < \pfibc \leq \floor*{p\frac{l-1}{l}}$. Since $p>(r-2)l$, we deduce $C(J,i)<p-(r-2) \leq p-2<p$, and hence $|\eis|<p$.\\
{\bf Case 2}: Assume $A_i=\psi_{\pit}$ or $\check{\psi}_{\pits}$. Set
\begin{align*}
N(J,i)&=
         \begin{cases}
          s_{\pib}-pJ(i) &\text{if } A_i=\psi_{\pit}\\
          s_{\pibs}-pJ(i) &\text{if } A_i=\check{\psi}_{\pit^*},
         \end{cases}
&
c(J,i)&=
         \begin{cases}
         c_{\pib}(N(J,i)) & \text{if }A_i=\psi_{\pit}\\
         c_{\pibs}(N(J,i)) & \text{if } A_i=\check{\psi}_{\pit^*},
         \end{cases}\\
C(J,i)&=
         \begin{cases}
         C_{\pib}(N(J,i)) & \text{if }A_i=\psi_{\pit}\\
         C_{\pibs}(N(J,i)) & \text{if } A_i=\check{\psi}_{\pit^*},
         \end{cases}
&
X(J,i)&=
         \begin{cases}
         X_{\pib}(N(J,i)) & \text{if }A_i=\psi_{\pit}\\
         X_{\pibs}(N(J,i)) & \text{if } A_i=\check{\psi}_{\pit^*}.
         \end{cases}
\end{align*}

Then %we have the following expression for $m_i(J(i+1),J(i))$:
\begin{equation*}
    T_{J,i}=m_i(J(i+1),J(i))=
    \begin{cases}
    x_1 \dots x_{r-J(i+1)}X(J,i) & \text{if } r-J(i+1) \geq c(J,i) \\
    x_1 \dots x_{r-J(i+1)-1}x_{c(J,i)}X(J,i) & \text{if } c(J,i) \geq r-J(i+1)+1.\\
    \end{cases}
\end{equation*}
For $t\in\{1,2\}$, we define
     \begin{equation}\label{Eq_alphaist}
     \alpha_{i,s,t}= \begin{cases} v_{x_s}(x_1 \dots x_{r-J_t(i+1)}) & \text{ if } c(J_t,i) \leq r-J_t(i+1)\\
     v_{x_s}(x_1 \dots x_{r-J_t(i+1)-1}x_{c(J_t,i)}) & \text{if } c(J_t,i) \geq r-J_t(i+1)+1.\\
     \end{cases}  
     \end{equation}
      Hence, $\eis=a_{i,s}+b_{i,s}$, where $a_{i,s}=\alpha_{i,s,1}-\alpha_{i,s,2}$ and $b_{i,s}=v_{x_s}(X(J_1,i))-v_{x_s}(X(J_2,i))$.
 Note that $|a_{i,s}|\leq 1$.
     \iffalse
         \begin{equation*}
 a_{i,s} =
    \begin{cases}
      -1 & \text{if $J_1(p^i)>5-s, J_2(p^i) \leq 5-s$}\\
      0 & \text{if $J_1(p^i)>5-s, J_2(p^i) > 5-s$}\\
      0 & \text{if $J_1(p^i)<5-s, J_2(p^i) < 5-s$}\\
      1 & \text{if $J_1(p^i)\leq 5-s, J_2(p^i) > 5-s$}\\
    \end{cases}       
\end{equation*}
     \fi
We have the following expression for $b_{i,s}$
         \begin{equation}\label{Eqeis2}
 b_{i,s} =
    \begin{cases}
      0 & \text{if $c(J_1,i)>s,c(J_2,i)>s$}\\
      C(J_1,i)-\pfibs & \text{if $c(J_1,i)=s,c(J_2,i)>s$}\\
      \pfibs-C(J_2,i)& \text{if $c(J_1,i)>s,c(J_2,i)=s$} \\
      C(J_1,i)-C(J_2,i) & \text{if $c(J_1,i)=c(J_2,i)=s$}\\
      -\pfibs & \text{if $c(J_1,i)<s,c(J_2,i)>s$}\\
       -C(J_2,i) & \text{if $c(J_1,i)<s,c(J_2,i)=s$}\\
       0 & \text{if $c(J_1,i)<s,c(J_2,i)<s$}\\
       \pfibs & \text{if $c(J_1,i)>s,c(J_2,i)<s$}\\
       C(J_1,i) & \text{if $c(J_1,i)=s,c(J_2,i)<s$}.
    \end{cases}       
\end{equation}
Similarly to Case 1, from  $p>(r-2)l$, %then $p(1-\frac{1}{l}) \leq p-2$. Then, 
we deduce $C(J,i)<\pfibs \leq p-2$, and consequently, $|b_{i,s}| \leq p-2$. Thus, 
\begin{equation*}
    \begin{split}
        |\eis| & = |a_{i,s}+b_{i,s}|  \leq |a_{i,s}|+|b_{i,s}|   \leq 1+p-2  \leq p-1< p.
    \end{split}
\end{equation*}
%Since $|\eis| < p$ in both cases, we can conclude that $\eis=0$, for all $i,s$. 

This completes the proof of Claim 2.

\textbf{Claim 3}:  If $T_{J_1}=T_{J_2}$ then $J_1=J_2$.\\
\textbf{Proof of Claim 3}: We show that $J_1(i)=J_2(i)$ for all $0 \leq i \leq |\OO|$. We prove the statement by backward induction on $i$. The base case holds, since by definition $J_1(|\OO|)=J_2(|\OO|)=1$. Suppose $J_1(i+1)=J_2(i+1)$, we shall deduce that $J_1(i)=J_2(i)$. We again make two cases.\\
{\bf Case 1}: Assume $A_i=\phi_{\pit}$ or $\phid_{\pits}$. %Then we further break into two sub-cases:
     \begin{itemize}
     \item Suppose $c(J_1,i) \neq c(J_2,i)$. Without loss of generality assume  $c(J_1,i) < c(J_2,i)$ and set $s=c(J_1,i)$. From Equation (\ref{Eqeis1}), we deduce $\eis=C(J_1,i)-\pfibs<0$, which contradicts $\eis=0$. Hence, $c(J_1,i)=c(J_2,i)$.
     \item Suppose $c(J_1,i)=c(J_2,i)$. Set $s=c(J_1,i)=c(J_2,i)$. From Equation (\ref{Eqeis1}), we deduce $\eis=C(J_1,i)-C(J_2,i)$, and hence by Claim 2, $C(J_1,i)=C(J_2,i)$. The latter equality implies $N(J_1,i)=N(J_2,i)$; since $J(i)$ is a linear combination of $N(J,i)$ and $J(i+1)$, we conclude that $J_1(i)=J_2(i)$.
     \end{itemize}
{\bf Case 2}: Assume $A_i=\psi_{\pit}$ or $\psid_{\pits}$. 
     \begin{itemize}
         \item Suppose $c(J_1,i) \neq c(J_2,i)$. 
         Without loss of generality, assume that $c(J_1,i)<c(J_2,i)$, write $c_1=c(J_1,i)$, $c_2=c(J_2,i)$. Set $s=c_1$.
        From Equation (\ref{Eqeis2}), $b_{i,s}=C(J_1,i)-\pbs<0$. Since $\eta_{i,s}= a_{i,s}+b_{i,s}=0 $, we deduce $a_{i,s}>0$, where $a_{i,s}=\alpha_{i,s,1}-\alpha_{i,s,2}$. By Equation (\ref{Eq_alphaist}),
        the inequality $a_{i,s}>0 $ implies $\alpha_{i,s,1}=1$ and $\alpha_{i,s,2}=0$; the latter equality implies that $s >r-J_2(i+1)$. Since $s=c_1<c_2$, we deduce that  $c_2>r-J_1(i+1)=r-J_2(i+1)$.
        By Equation (\ref{Eq_alphaist}), $\alpha_{i,c_2,1}=0$ and $\alpha_{i,c_2,2}=1$; hence, $a_{i,c_2}=-1$. Since $b_{i,c_2}=-C(J_2,i)\leq 0$, we deduce $\eta_{i,c_2}\leq -1$. This contradicts the fact that $\eta_{i,c_2}=0$. Therefore, $c(J_1,i)=c(J_2,i)$.
         \item Suppose $c(J_1,i)=c(J_2,i)$. From Equation \ref{Eq_alphaist}, we deduce that $\alpha_{i,s,1}=\alpha_{i,s,2}$ (by definition, $\alpha_{i,s,t}$ only depends on $J_t(i+1)$ and $c(J_t,i)$, for any given $s$).
         Set $s=c(J_1,i)=c(J_2,i)$. By Claim 2, $\eta_{i,s}=0$ and hence
         $C(J_1,i)=C(J_2,i)$, which in turn implies $N(J_1,i)=N(J_2,i)$. We conclude that $J_1(i)=J_2(i)$.
         %  Hence, $c(J_1,i)=c(J_2,i)$.
        \end{itemize}

In each case, the equality $J_1(i+1)=J_2(i+1)$ implies $J_1(i)=J_2(i)$. By induction, we conclude the proof of Claim 3. This finishes the proof of Theorem \ref{signature 1}.
\end{proof}

%The following statement is an immediate consequence of Proposition \ref{When is psii' correct}.
%\begin{lemma}\label{can use psii}
 %in Proposition\ref{sequence}.
%Theorem \ref{signature 1}. Assume $\tau\in \OO$ satisfying $\fts=1$. 
%If %$f(p^i\tau^*)\geq 1$ and 
%$f(p^{i+1}\tau^*)=0$ (respectively, $f(p^i\tau^*)=0$%and $f(p^{i+1}\tau^*)\geq 1$),  then $\psi'_{\pit}$ (respectively, $\psi'_{\pit^*}$) defines an valid extension of $\psi_{\pit}$ to $\qpit$. (respectively,  of $\psi_{\pit^*}$ to $Q_{\pits}$). 
%In the above definition of $A_{\tau,i}$, $0\leq i\leq |\OO|-1$,  we may use $\psi'$ in place of $\psi$.

%\begin{enumerate}
 %   \item 
%Assume $A_{\tau,i}=\psi_{\pit}$ (that is, $f(p^i\tau^*)\geq 1$ and $f(p^{i+1}\tau^*)=0$). 
%Then $\psi'_{\pit}$ defines an valid extension of $\psi_{\pit}$ to $\qpit$. 


%\item 
%Assume $A_{\tau,i}=\check{\psi}_{\pits}$ (that is, $f(p^i\tau^*)=0$ and $f(p^{i+1}\tau^*)\geq 1$). Then $\psi'_{\pit^*}$ defines an valid extension of $\psi_{\pit^*}$ to $Q_{\pits}$. 
%\end{enumerate}
%\end{lemma}
%\begin{proof}
%By Equation (\ref{Eq_A_i}), it is enough to  verify that if $f(p^i\tau^*)\geq 1$ and $f(p^{i+1}\tau^*)=0$ (respectively, $f(p^i\tau^*)=0$ and $f(p^{i+1}\tau^*)\geq 1$),  the map $\psi'_{\pit}$  (respectively, $\psi'_{\pit^*}$) is a valid extension of $\psi_{\pit}$ (respectively, of $\psi_{\pit^*}$), as in  Definition \ref{Def_valid}. The statement follows from Proposition \ref{When is psii' correct} given $f(p^{i+1}\ts)=0$ (respectively, $f((\pits)^*)=g(\OO)$ which follows from  $f(\pits)=0$).
%
%
%If $A_{\tau,i}=\psi_{\pit}$, then $f(p^{i+1}\ts)=0$.  By Proposition \ref{When is psii' correct}, $\psi_{p^i\tau}'$ defines the valid extension of $\psi_{\pit}$. 
%Similarly, if $A_{\tau,i}=\check{\psi}_{\pits}$, then $f(\pits)=0$ and hence $f((\pits)^*)=g(\OO)$. By Proposition \ref{When is psii' correct}, $\psi_{\pits}'$ defines the valid extension of $\psi_{\pits}$.
%\end{proof}



%\begin{lemma}    
%\label{sequence} 
%Let $\tau\in \OO$ satisfying $\fts=1$.
%For $0\leq i\leq|\OO|-1$, let $A_{\tau,i}$ as in  (\ref{Eq_A_i}). 

%Then the map
%$A_{\tau,|\OO|-1}\circ \dots \circ A_{\tau,0} :Q_{\tau}\to Q_{\tau}$ agrees
%with the map $\pi_{\tau}\circ L_{\tau,|\OO|-1}\circ \dots \circ L_{\tau,0} :Q_{\tau}\to Q_{\tau}$
%from Theorem \ref{numerical criteria}.
%\end{lemma}

 



%Let $\tau\in \OO$ satisfying $\fts=1$. 



%\begin{lemma}\label{LTJ}
%With the above notations, %let $\OO$ be a Frobenius orbit satisfying the assumptions of Theorem \ref{signature 1}, and $\tau\in \OO$ satisfying $\fts=1$. For $0\leq i \leq|\OO|-1$, write $A_i=A_{\tau,i}$.

%\end{lemma}




%\begin{proof}[Proof of Theorem \ref{signature 1}]
%We deduce Theorem \ref{signature 1} from Theorem \ref{numerical criteria} with $u=2$. By assumption, $f_{\OO,1}=0$ and $f_{\OO,2}=1$. In order to apply Theorem \ref{numerical criteria}, we need to verify the following two conditions:
%\begin{enumerate}
    %\item $\dim(\pi_{\tau_{\OO,1}}\circ L_{\tau_{\OO,1},|\OO|-1} \circ \dots \circ L_{\tau_{\OO,1},0}(M_{\tau_{\OO,1}}))=f_{\OO,1}=0;$
    %\item 
    %$\dim(\pi_{\tau_{\OO,2}}\circ L_{\tau_{\OO,2},|\OO|-1} \circ \dots \circ L_{\tau_{\OO,2},0}(M_{\tau_{\OO,2}}))=f_{\OO,2}-f_{\OO,1}=1.$
%\end{enumerate}

%The first condition is trivially satisfied since $\pi_{\tau_{\OO,1}}:M_{\tau_{\OO,1}}\to Q_{\tau_{\OO,1}}$ and $\dim(Q_{\tau_{\OO,1}})=f(\tau_{\OO,1}^*)=0$. 

%We consider the second condition.
%Denote $\tau=\tau_{\OO,2}$, so $f(\ts)=1$. By assumptions,  $\tau=\tau_b$ for some $0<b<l$ satisfying $\gcd(b,l)=1$. Since $\dim(Q_{\tau})=1$, it suffices to show that the composite map
%$$\pi_{\tau} \circ L_{\tau,|\OO|-1} \circ \dots \circ L_{\tau,0}: Q_{\tau} \to Q_{\tau}$$
%has rank at least $1$ for $(x_1,\dots, x_r)$ outside a proper closed subset of $\mlra(\fpb)$. Equivalently, we need to show that the composite matrix is not identically zero as a polynomial in $\fpb[x_1, \dots, x_r]$. 

%Recall that for $0 \leq i \leq |\OO|-1$, we have 
%\begin{equation*}
 %   L_{\tau,i} = \begin{cases}
 %          F_{p^i\tau} &\text{if } f(p^i\tau^*)\geq 1\\
 %          V'_{p^i\tau} &\text{if } f(p^i\tau^*)=0.
 %   \end{cases}
%\end{equation*}

%Our first step is to show that we can compute the products of $L_{\tau,i}$ as  products of $\phi$ and $\psi$.
%For $0\leq i \leq|\OO|-1$, let $A_i=A_{\tau,i}$.
%By Proposition \ref{sequence}
%, it suffices to show that 
%the matrix product $\aip$ is %a $1 \times 1$ matrix, and we want to show that it is 
%not identically zero. %By Lemma \ref{can use psii}, we may assume $\psi_{\tau_i}= \psiip$, for all $0\leq i \leq|\OO|-1$.
%and Lemma \ref{LTJ}, % to prove the non-vanishing the $\aip$, 


%Now we fix $J_1,J_2\in \mathfrak{J}$ such that $T_{J_1}=T_{J_2}$. The proof of Theorem \ref{signature 1} will be complete if we show that $J_1=J_2$.
%For $1 \leq s \leq r$, $0 \leq i \leq |\OO|-1$, we let
%$\eis=v_{x_s}(T_{J_1,i})-v_{x_s}(T_{J_2,i})$.
%Since $T_{J_1}=T_{J_2}$, for each $1 \leq s \leq r$, we have that
%$$\sum_{i=0}^{|\OO|-1}p^{|\OO|-i-1}\eis=v_{x_s}(T_{J_1})-v_{x_s}(T_{J_2})=0.$$



%For $1 \leq s \leq r$ and $0 \leq i \leq |\OO|-1$, let $\eis=v_{x_s}(T_{J_1,i})-v_{x_s}(T_{J_2,i})$; by Lemma \ref{eise0}, $\eis=0$.
%We use the same notations as in the proof of Lemma \ref{eise0}.


     %So, if $A_i=\phi_{\pit}$ or $\phid_{\pits}$ then $J_1(i+1)=J_2(i+1)$ implies $J_1(i)=J_2(i)$.

%Therefore, by backward induction we see 
%that $J_1=J_2$. 
%As noted earlier this completes the proof of Theorem \ref{signature 1}.




\section{Main result}\label{new part mu ordinary}
  The goal of this section is the proof of Theorem~\ref{abelian cover}, and highlight some applications.
In the following, $\gra$ is an abelian monodromy datum, with $r\leq 5$, and $p$ is a rational prime, $p > |G|(r-2)$.
  
%Recall Notation \ref{new part mu ord}: let $\lra$ be a cyclic monodromy datum; we identify $\tg=\Z/l\Z$.
Recall that, given a Frobenius orbit $\OO$ in $\tg$, we denote by 
$f_{\OO,1}<f_{\OO,2}<\dots< f_{\OO,s(\OO)}$  the distinct values in $\FF(\OO)=\{\fts\mid \tau\in \OO\}$. %For each $1\leq u\leq s(\OO)$, we choose $\tau_{\OO,u}\in\OO$ satisfying $f(\tau_{\OO,u}^*)=f_{\OO,u}$.



\begin{lemma}\label{smallest signature}
Given a Frobenius orbit $\OO$, if $\tau\in \OO$ satisfies $f(\tau^*)=f_{\OO,1}$, then $w_{\tau}$ is generically maximal.
\end{lemma}
\begin{proof}
We apply Theorem \ref{numerical criteria} with $u=1$. It suffices to check that $$\dim(\pi_{\tau_{\OO,1}}\circ L_{\tau_{\OO,1},|\OO|-1} \circ \dots \circ L_{\tau_{\OO,1},0}(M_{\tau_{\OO,1}}))=f_{\OO,1}$$ on the complement of a proper closed subset of $\mlra(\fpb)$. Note that $L_{\tau_{\OO,1},i}=F_{p^i\tau_{\OO,1}}$, so the condition is reduced to showing that $\pi_{\tau_{\OO,1}}\circ F^{|\OO|}: Q_{\tau_{\OO,1}}\to Q_{\tau_{\OO,1}}$ is an isomorphism. The main theorem in \cite[Section 6]{Irene} shows that the determinant of this map is a non-zero polynomial in $\fpb[x_1, \dots, x_r]$. Therefore, the condition only fails on the vanishing locus of the determinant, which is a proper closed subset.
\end{proof}

\begin{corollary}\label{Largest signature}
Given a Frobenius orbit $\OO$, if $\tau\in \OO$ satisfies $f(\tau^*)=f_{\OO,s(\OO)}$, then $w_{\tau}$ is generically maximal.
\end{corollary}
\begin{proof}
If $f(\tau^*)=f_{\OO,s(\OO)}$, then $f((\tau^*)^*)=f_{\overline{\OO},1}$. Therefore, by Lemma \ref{smallest signature}, we know that $w_{\tau^*}$ is maximal. Hence $w_{\tau}$ is also generically maximal.
\end{proof}


\begin{proof}[Proof of Theorem \ref{abelian cover}]

    By Lemma \ref{equivalence two}, to prove Theorem~\ref{abelian cover}, it is enough to prove that, given a cyclic monodromy datum $\lra$, with $r\leq 5$,
there exists a non-empty open subset $U \subseteq \mlra$ such that for all $\xb \in U$, $J(\ct)^\n$ is $\mu$-ordinary, or equivalently,
by \cite[Theorem 1.3.7]{MoonenEOtypeformula}, that for each $\tau\in \tg$ with $\ker(\tau)=\{1\}$, $\wt$ is generically maximal.
 

 Let $\OO$ be a Frobenius orbit such that for any/all $\tau \in \OO$ satisfy $\ker(\tau)=\{1\}$. Hence, for all $\tau\in \OO$, $f(\tau)+f(\tau^*)=g(\OO)=r-2$. Recall $s(\OO)$ denotes the number of distinct values in 
 $\FF(\OO)$. Hence, $s(\OO)\leq g(\OO)+1$.

For $r\leq 3$ the statement holds trivially.

{\bf Assume $r=4$:}
then $g(\OO)=2$ and $s(\OO)\leq 3$.
%$\FF(\overline{\OO})=\{2-a\mid a\in \FF(\OO)\}$. 







%\begin{theorem}\label{r=4 main result}
%Assume $r=4$.
%Suppose we are given a Frobenius orbit $\OO$ such that $\ker(\tau)=1$ for every $\tau \in \OO$. Then for every $\tau \in \OO$, $w_{\tau}$ is generically maximal.
%\end{theorem}
%\begin{proof}
%We make cases based on $\FF(\OO)$.
\begin{itemize}
    \item If $s(\OO)=1$: write $\FF(\OO)=\{f_{\OO,1}\}$. Then any $\tau\in\OO$ satisfies $f(\tau^*)=f_{\OO,1}$ and $w_\tau$ is generically maximal by Lemma \ref{smallest signature}. %that $w_{\tau}$ is generically maximal.
    \item If $s(\OO)=2$: write $\FF(\OO)=\{f_{\OO,1},f_{\OO,2}\}$. For $\tau\in\OO$ satisfying $f(\tau^*)=f_{\OO,1}$, $w_\tau$ is generically maximal by Lemma \ref{smallest signature}; % that $w_{\tau}$ is generically maximal. 
    for $\tau\in\OO$ satisfying $f(\tau^*)=f_{\OO,2}$, by Corollary \ref{Largest signature}. %that $w_{\tau}$ is generically maximal.
    \item if  $s(\OO)=3$, then $\FF(\OO)=\{0,1,2\}$.
    For $\tau\in\OO$ satisfying $f(\tau^*)\in\{0,1\}$, $w_\tau$ is generically maximal by Theorem \ref{signature 1}; % that $w_{\tau}$ is generically maximal. 
    for $\tau\in\OO$ satisfying $f(\tau^*)=2$,  by Corollary \ref{Largest signature}.% that $w_{\tau}$ is generically maximal.\qedhere
\end{itemize}
%\end{proof}

{\bf Assume $r=5$:}
then, $g(\OO)=3$ and $s(\OO)\leq 4$.
%$\FF(\overline{\OO})=\{3-a\mid a\in \FF(\OO)\}$.




%\begin{theorem}\label{rfivemax}
%Assume $r=5$. Given a Frobenius orbit $\OO$ such that $\ker(\tau)=\{1\}$ for every $\tau \in \OO$. Then for every $\tau \in \OO$, $w_{\tau}$ is generically maximal.
%\end{theorem}
%\begin{proof}
%We make cases based on $\FF(\OO)$.
\begin{itemize}
    \item If $s(\OO)=1$, the statement follows from Lemma \ref{smallest signature}. 
    \item If $s(\OO)=2$, it follows from Lemma \ref{smallest signature} and Corollary \ref{Largest signature}.
    \item If $s(\OO)=3$,  then there are four possibility for $\FF(\OO)$. If $\FF(\OO)=\{0,1,2\}$ or $\FF(\OO)=\{0,1,3\}$, the statement follows direcltly from Theorem \ref{signature 1} and Corollary \ref{Largest signature}.
    %%\item , it follows from Theorem \ref{signature 1} and Corollary \ref{Largest signature}.
  If $\FF(\OO)=\{0,2,3\}$ or $\FF(\OO)=\{1,2,3\}$, then $\FF(\overline{\OO})=\{0,1,3\}$ or $\FF(\overline{\OO})=\{0,1,2\}$ respectively,
    and the statement follows from the previous instances, since $w_{\tau}$ is maximal if and only if $w_{\tau^*}$ is maximal (see Remark \ref{rmk}).
    %. Therefore, by Case 4, for all $\tau\in \overline{\OO}$, we have $w_{\tau}$ is generically maximal. Now given $\tau\in \OO$, we have $\tau^*\in \overline{\OO}$, so $w_{\tau^*}$ is generically maximal and hence $w_{\tau}$ is also generically maximal.
   % \item If $\FF(\OO)=\{1,2,3\}$. In this case $\FF(\overline{\OO})=\{0,1,2\}$. Therefore, by Case 3, for all $\tau\in \overline{\OO}$, we have $w_{\tau}$ is generically maximal. Now given $\tau\in \OO$, we have $\tau^*\in \overline{\OO}$, so $w_{\tau^*}$ is generically maximal and hence $w_{\tau}$ is also generically maximal.
    \item If $s(\OO)=4$, then $\FF(\OO)=\{0,1,2,3\}$. If  $f(\tau^*)\neq 2$, $w_{\tau}$ is generically maximal by Theorem \ref{signature 1} and Corollary \ref{Largest signature}.
    %Next, notice that $\FF(\overline{\OO})=\{0,1,2,3\}$. 
    If $f(\tau^*)=2$, then $f((\tau^*)^*)=1$ and $w_{\tau^*}$ is generically maximal by Theorem \ref{signature 1}. Hence, $w_{\tau}$ is also generically maximal.\qedhere
\end{itemize}
%\end{proof}

\end{proof}



\begin{remark}  
The restriction $r\leq 5$ does not imply a bound on the genus of the covers. That is, our result applies to families of curves with arbitrarily large genus. For example, given a cyclic monodromy datum $\lra$, 
the genus of the curves parameterized by $\mlra$ is:
$$g=g(l,r,\au)=1 +
\frac{(r-2)l-\sum_{j=1}^r \gcd(a(j),l)}{2}\geq 1+\frac{(r-2)l-r}{2}.$$
In particular,  $g\lra$ can grow linearly with $l$. 

Also, while the restriction $r\leq 5$ implies $\dim(\mlra)=r-3\leq 2$, it does not imply a bound on the dimension of the Deligne--Mostow Shimura variety $\shgf$. That is, our result applies to families of curves in ambient Shimura varieties of arbitrarily large dimension.   For example,
    consider the cylic monodromy datum $(l,4,(1,1,1,l-3))$, where $3 \nmid l$. Then $\dim(\mlra)=1$, while  
    %the dimension of $\shgf$  is 
    %$$    \dim(\shmf) = 
    %\begin{cases}
     %   \sum_{i=1}^{l-1}f(\ti)f(\tis)+\frac{f(\tau_{k})f(\tau_k)+1}{2} & \text{if } l=2k \\
      %  \sum_{i=1}^{l-1}f(\ti)f(\tis) & \text{if }l \text{ is odd} 
    %\end{cases}$$
    %In particular, $\dim(\shmf)$ is at least $\sum_{i=1}^{l-1}f(\ti)f(\tis)$. For $\au=(1,1,1,l-3)$,
    $\dim(\shmf)\geq \floor{\frac{l+1}{3}}$, which grows linearly with $l$. 
    %Thus, for large $l$, $\dim(\mlra) \ll \dim(\shmf)$, and by Theorem \ref{abelian cover} we still have that $T(\mlra)$ intersects the $\mu$-ordinary locus of $\shmf$ non-trivially for any $p>2l$.

\end{remark}


\begin{remark}\label{newNP}
Theorem \ref{abelian cover} provides new examples of Newton polygons occurring for smooth curves (e.g., polygons with slopes with large denominators).
For example, consider the monodromy datum 
$(23,5,(1,1,1,2,18))$ and a prime $p$ that is inert in $\Q(\zeta_{23})/\Q$. Then, the corresponding cyclic covers of $\Po$ have genus $g=33$, and the associated $\mu$-ordinary Newton polygon at $p$ is $u=(\frac{2}{11},\frac{9}{11})^{2} \bigoplus (\frac{1}{2}, \frac{1}{2})^{11}$.
%, and by \cite[Formula 8.1]{clutchingargument},  $\dim(\mg)= 96<\text{codim}(\ag[\nu],\ag)=136$.
By Theorem \ref{abelian cover}, for $p> 69$, there exists a smooth curve over $\fpb$ with Newton polygon $u$.
%, and the Torelli locus has an unlikely intersection with $\ag[\mu]$ at $p$.
%By Theorem \ref{abelian}, for $p$ a prime $p>69$ and inert in $\Q(\zeta_{23})$ instance of an unlikely intersection in $\ag$, of the Torelli locus with the Newton stratum $\ag[\mu]$. In this case, 
\end{remark}


\begin{remark}\label{anyrl} 
For any $r>5$ and any $l>1$, Theorem \ref{abelian cover}, together with \cite[Proposition 4]{clutchingargument}, yields examples of cyclic monodromy data, of degree $l$ and with $r$ branched points, that satisfy the statement  of Theorem \ref{abelian cover}. 
More precisely, in \cite[Proposition 4]{clutchingargument}, the authors show that if $\gamma=\lra$ is a cyclic monodromy datum satisfying the statement of Theorem \ref{abelian cover} then, for any $1\leq c\leq m-1$, the monodromy datum $\gamma_c=(l, r+2, {\au}_c)$, where ${\au}_c=(c,l-c,\au_1, \dots, \au_r)$,  also satisfy the statement. Hence, by Theorem \ref{abelian cover}, starting with a cyclic monodromy datum $\lra$ with $4\leq r\leq 5$, one can construct an infinite inductive system of cyclic monodromy data, of degree $l$ and with $r+2t$ branched points, for $t\geq 1$, that satisfy the statement of Theorem \ref{abelian cover}. 
Similarly, one can combine Theorem \ref{abelian cover} with other results in \cite[Section 4]{clutchingargument}
to obtain different infinite systems of monodromy data, with an arbitrarily large number of branched points, that satisfy the statement of Theorem \ref{abelian cover} (see Remark \ref{unlikely} for another example of such a construction).
\end{remark}

\begin{remark}\label{unlikely}
Theorem \ref{abelian cover} combined with results in \cite{clutchingargument} 
yields new instances of unlikely intersections of the Torelli locus with Newton strata of the Siegel variety.  Following \cite[Definition 8.2]{clutchingargument}, we say that the Torelli locus has an {\em  unlikely intersection at $p$} with the Newton polygon stratum $\ag[\nu]$ in $\ag$  if there exists a smooth curve over $\fpb$ of genus $g$ with Newton polygon $\nu$ and $\dim \mg < \text{codim}(\ag[\nu],\ag)$. 
 For example, given a cyclic monodromy datum $\gamma=(l, r, \au)$ with $4\leq r\leq 5$, by Theorem \ref{abelian cover}, \cite[Corollary 4.14]{clutchingargument} produces an infinite inductive system of cyclic monodromy data $\{ \gamma_n=(l, r_{n}, \au_{n})\mid n\geq 1\}$,  with $r_{n}= n(r+2)$,  that satisfy the statement of Theorem \ref{abelian cover}. Furthermore, for $p>l(r-2)$, if the $\mu$-ordinary Newton polygon at $p$ associated with $\gamma$ is not ordinary, then by \cite[Proposition 8.5]{clutchingargument}, the inductive system yields (infinitely many)  unlikely intersections at $p$ of the Torelli locus with  Newton strata in Siegel varieties. More precisely, if $u$ denotes the $\mu$-ordinary Newton polygon at $p$ associated with $\gamma$, for $p>l(r-2)$, and $u\neq \ord^g$, then  once $n$ is sufficiently large, the Torelli locus has an unlikely intersection at $p$ with the Newton stratum $\ag[u^n+\ord^{n(l-1)}]$.
Continuing the example in Remark \ref{newNP}, for $\gamma=(23, 5, (1,1,1,2,18))$, $p>69$ a prime inert in $\Q(\zeta_{23})/\Q$, $g=33$ and $u=(\frac{2}{11},\frac{9}{11})^{2} \bigoplus (\frac{1}{2}, \frac{1}{2})^{11}$, by \cite[Formula 8.1]{clutchingargument},  $\dim(\mg)= 96<\text{codim}(\ag[u],\ag)=136$ and the Torelli locus has an unlikely intersection at $p$ with the Newton stratum $\ag[u]$. Furthermore, by \cite[Proposition 8.4]{clutchingargument}, for any $n\geq 1$, the Torelli locus has an unlikely intersection at $p$ with the Newton stratum $\mathcal{A}_{g_n}[u^n+\ord^{n(l-1)}]$, where $g_n=n(l+32)$. 
\end{remark}
























\backmatter



\bmhead{Acknowledgments}
We would like to thank Rachel Pries for many helpful discussions that have motivated the pursue of this problem. Mantovan was partially supported by NSF grant DMS-22-00694.







%%===========================================================================================%%
%% If you are submitting to one of the Nature Portfolio journals, using the eJP submission   %%
%% system, please include the references within the manuscript file itself. You may do this  %%
%% by copying the reference list from your .bbl file, paste it into the main manuscript .tex %%
%% file, and delete the associated \verb+\bibliography+ commands.                            %%
%%===========================================================================================%%


\bibliography{sn-bibliography.bib}% common bib file
%% if required, the content of .bbl file can be included here once bbl is generated
%\input sn-article.bbl










\end{document}

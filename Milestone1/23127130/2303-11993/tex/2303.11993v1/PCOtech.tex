
%% bare_conf.tex
%% V1.4b
%% 2015/08/26
%% by Michael Shell
%% See:
%% http://www.michaelshell.org/
%% for current contact information.
%%
%% This is a skeleton file demonstrating the use of IEEEtran.cls
%% (requires IEEEtran.cls version 1.8b or later) with an IEEE
%% conference paper.
%%
%% Support sites:
%% http://www.michaelshell.org/tex/ieeetran/
%% http://www.ctan.org/pkg/ieeetran
%% and
%% http://www.ieee.org/

%%*************************************************************************
%% Legal Notice:
%% This code is offered as-is without any warranty either expressed or
%% implied; without even the implied warranty of MERCHANTABILITY or
%% FITNESS FOR A PARTICULAR PURPOSE! 
%% User assumes all risk.
%% In no event shall the IEEE or any contributor to this code be liable for
%% any damages or losses, including, but not limited to, incidental,
%% consequential, or any other damages, resulting from the use or misuse
%% of any information contained here.
%%
%% All comments are the opinions of their respective authors and are not
%% necessarily endorsed by the IEEE.
%%
%% This work is distributed under the LaTeX Project Public License (LPPL)
%% ( http://www.latex-project.org/ ) version 1.3, and may be freely used,
%% distributed and modified. A copy of the LPPL, version 1.3, is included
%% in the base LaTeX documentation of all distributions of LaTeX released
%% 2003/12/01 or later.
%% Retain all contribution notices and credits.
%% ** Modified files should be clearly indicated as such, including  **
%% ** renaming them and changing author support contact information. **
%%*************************************************************************


% *** Authors should verify (and, if needed, correct) their LaTeX system  ***
% *** with the testflow diagnostic prior to trusting their LaTeX platform ***
% *** with production work. The IEEE's font choices and paper sizes can   ***
% *** trigger bugs that do not appear when using other class files.       ***                          ***
% The testflow support page is at:
% http://www.michaelshell.org/tex/testflow/



\documentclass[journal]{IEEEtran}
% Some Computer Society conferences also require the compsoc mode option,
% but others use the standard conference format.
%
% If IEEEtran.cls has not been installed into the LaTeX system files,
% manually specify the path to it like:
% \documentclass[conference]{../sty/IEEEtran}


\usepackage[switch,mathlines]{lineno}
\usepackage{etoolbox}


% Some very useful LaTeX packages include:
% (uncomment the ones you want to load)


% *** MISC UTILITY PACKAGES ***
%
%\usepackage{ifpdf}
% Heiko Oberdiek's ifpdf.sty is very useful if you need conditional
% compilation based on whether the output is pdf or dvi.
% usage:
% \ifpdf
%   % pdf code
% \else
%   % dvi code
% \fi
% The latest version of ifpdf.sty can be obtained from:
% http://www.ctan.org/pkg/ifpdf
% Also, note that IEEEtran.cls V1.7 and later provides a builtin
% \ifCLASSINFOpdf conditional that works the same way.
% When switching from latex to pdflatex and vice-versa, the compiler may
% have to be run twice to clear warning/error messages.






% *** CITATION PACKAGES ***
%
\usepackage{cite}
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of the IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% noadjust option (cite.sty V3.8 and later) if you want to turn this off
% such as if a citation ever needs to be enclosed in parenthesis.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 5.0 (2009-03-20) and later if using hyperref.sty.
% The latest version can be obtained at:
% http://www.ctan.org/pkg/cite
% The documentation is contained in the cite.sty file itself.




% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  % \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi
% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/pkg/graphicx
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/pkg/epslatex
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). The IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex





% *** MATH PACKAGES ***
%
\usepackage{amsmath}
% A popular package from the American Mathematical Society that provides
% many useful and powerful commands for dealing with mathematics.
%
% Note that the amsmath package sets \interdisplaylinepenalty to 10000
% thus preventing page breaks from occurring within multiline equations. Use:
%\interdisplaylinepenalty=2500
% after loading amsmath to restore such page breaks as IEEEtran.cls normally
% does. amsmath.sty is already installed on most LaTeX systems. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/amsmath





% *** SPECIALIZED LIST PACKAGES ***
%
%\usepackage{algorithmic}
% algorithmic.sty was written by Peter Williams and Rogerio Brito.
% This package provides an algorithmic environment fo describing algorithms.
% You can use the algorithmic environment in-text or within a figure
% environment to provide for a floating algorithm. Do NOT use the algorithm
% floating environment provided by algorithm.sty (by the same authors) or
% algorithm2e.sty (by Christophe Fiorio) as the IEEE does not use dedicated
% algorithm float types and packages that provide these will not provide
% correct IEEE style captions. The latest version and documentation of
% algorithmic.sty can be obtained at:
% http://www.ctan.org/pkg/algorithms
% Also of interest may be the (relatively newer and more customizable)
% algorithmicx.sty package by Szasz Janos:
% http://www.ctan.org/pkg/algorithmicx




% *** ALIGNMENT PACKAGES ***
%
%\usepackage{array}
% Frank Mittelbach's and David Carlisle's array.sty patches and improves
% the standard LaTeX2e array and tabular environments to provide better
% appearance and additional user controls. As the default LaTeX2e table
% generation code is lacking to the point of almost being broken with
% respect to the quality of the end results, all users are strongly
% advised to use an enhanced (at the very least that provided by array.sty)
% set of table tools. array.sty is already installed on most systems. The
% latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/array


% IEEEtran contains the IEEEeqnarray family of commands that can be used to
% generate multiline equations as well as matrices, tables, etc., of high
% quality.




% *** SUBFIGURE PACKAGES ***
%\ifCLASSOPTIONcompsoc
%  \usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
%\else
%  \usepackage[caption=false,font=footnotesize]{subfig}
%\fi
% subfig.sty, written by Steven Douglas Cochran, is the modern replacement
% for subfigure.sty, the latter of which is no longer maintained and is
% incompatible with some LaTeX packages including fixltx2e. However,
% subfig.sty requires and automatically loads Axel Sommerfeldt's caption.sty
% which will override IEEEtran.cls' handling of captions and this will result
% in non-IEEE style figure/table captions. To prevent this problem, be sure
% and invoke subfig.sty's "caption=false" package option (available since
% subfig.sty version 1.3, 2005/06/28) as this is will preserve IEEEtran.cls
% handling of captions.
% Note that the Computer Society format requires a larger sans serif font
% than the serif footnote size font used in traditional IEEE formatting
% and thus the need to invoke different subfig.sty package options depending
% on whether compsoc mode has been enabled.
%
% The latest version and documentation of subfig.sty can be obtained at:
% http://www.ctan.org/pkg/subfig




% *** FLOAT PACKAGES ***
%
%\usepackage{fixltx2e}
% fixltx2e, the successor to the earlier fix2col.sty, was written by
% Frank Mittelbach and David Carlisle. This package corrects a few problems
% in the LaTeX2e kernel, the most notable of which is that in current
% LaTeX2e releases, the ordering of single and double column floats is not
% guaranteed to be preserved. Thus, an unpatched LaTeX2e can allow a
% single column figure to be placed prior to an earlier double column
% figure.
% Be aware that LaTeX2e kernels dated 2015 and later have fixltx2e.sty's
% corrections already built into the system in which case a warning will
% be issued if an attempt is made to load fixltx2e.sty as it is no longer
% needed.
% The latest version and documentation can be found at:
% http://www.ctan.org/pkg/fixltx2e


%\usepackage{stfloats}
% stfloats.sty was written by Sigitas Tolusis. This package gives LaTeX2e
% the ability to do double column floats at the bottom of the page as well
% as the top. (e.g., "\begin{figure*}[!b]" is not normally possible in
% LaTeX2e). It also provides a command:
%\fnbelowfloat
% to enable the placement of footnotes below bottom floats (the standard
% LaTeX2e kernel puts them above bottom floats). This is an invasive package
% which rewrites many portions of the LaTeX2e float routines. It may not work
% with other packages that modify the LaTeX2e float routines. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/stfloats
% Do not use the stfloats baselinefloat ability as the IEEE does not allow
% \baselineskip to stretch. Authors submitting work to the IEEE should note
% that the IEEE rarely uses double column equations and that authors should try
% to avoid such use. Do not be tempted to use the cuted.sty or midfloat.sty
% packages (also by Sigitas Tolusis) as the IEEE does not format its papers in
% such ways.
% Do not attempt to use stfloats with fixltx2e as they are incompatible.
% Instead, use Morten Hogholm'a dblfloatfix which combines the features
% of both fixltx2e and stfloats:
%
% \usepackage{dblfloatfix}
% The latest version can be found at:
% http://www.ctan.org/pkg/dblfloatfix




% *** PDF, URL AND HYPERLINK PACKAGES ***
%
\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/url
% Basically, \url{my_url_here}.




% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
% There should be no need to do such things with IEEEtran.cls V1.6 and later.
% (Unless specifically asked to do so by the journal or conference you plan
% to submit to, of course. )


% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}

%\documentclass[runningheads,envcountsame]{llncs}

\usepackage{amsthm}  % def of "proof"

\usepackage{amsmath}
\usepackage{latexsym}
\usepackage{amssymb}
\usepackage{verbatim}
%\usepackage{setspace}
%\usepackage{qtree}
\usepackage{pbox}
\usepackage{enumerate}
\usepackage{multicol}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{booktabs}
%\usepackage{multline}

%% Patch 'normal' math environments:
\newcommand*\linenomathpatch[1]{%
  \cspreto{#1}{\linenomath}%
  \cspreto{#1*}{\linenomath}%
  \csappto{end#1}{\endlinenomath}%
  \csappto{end#1*}{\endlinenomath}%
}
%% Patch AMS math environments:
\newcommand*\linenomathpatchAMS[1]{%
  \cspreto{#1}{\linenomathAMS}%
  \cspreto{#1*}{\linenomathAMS}%
  \csappto{end#1}{\endlinenomath}%
  \csappto{end#1*}{\endlinenomath}%
}

%% Definition of \linenomathAMS depends on whether the mathlines option is provided
\expandafter\ifx\linenomath\linenomathWithnumbers
  \let\linenomathAMS\linenomathWithnumbers
  %% The following line gets rid of an extra line numbers at the bottom:
  \patchcmd\linenomathAMS{\advance\postdisplaypenalty\linenopenalty}{}{}{}
\else
  \let\linenomathAMS\linenomathNonumbers
\fi

\linenomathpatch{equation}
\linenomathpatchAMS{gather}
\linenomathpatchAMS{multline}
\linenomathpatchAMS{align}
\linenomathpatchAMS{alignat}
\linenomathpatchAMS{flalign}

% Disable line numbering during measurement step of multline
\makeatletter
\patchcmd{\mmeasure@}{\measuring@true}{
  \measuring@true
  \ifnum-\linenopenaltypar>\interdisplaylinepenalty
    \advance\interdisplaylinepenalty-\linenopenalty
  \fi
  }{}{}
\makeatother



%\linenumbers

%\usepackage{txfonts}    % prob independence \Perp

\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{tikzmark}




%\usepackage{tikz}
%\usetikzlibrary{arrows,decorations.pathmorphing,backgrounds,positioning,fit}

{\usepackage{txfonts}  % \boxright
   \DeclareSymbolFont{symbolsC}{U}{txsyc}{m}{n}
   \DeclareMathSymbol{\strictif}{\mathrel}{symbolsC}{74}
   \DeclareMathSymbol{\boxright}{\mathrel}{symbolsC}{128}
}

\newtheorem{theorem}{Theorem}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{example}[theorem]{Example}
\newtheorem{definition}[theorem]{Definition}

\newtheorem{df}{Definition}[section]  
%\newtheorem{teo}[df]{Theorem}
%\newtheorem{cor}[df]{Corollary}
%\newtheorem{lem}[df]{Lemma}
%\newtheorem{lem}[df]{Lemma}
\newtheorem{conv}[df]{Convention}
%\newtheorem{prop}[df]{Proposition}
%\newtheorem{example}[df]{Example}
\newtheorem{ctex}[df]{Counterexample}
%\newtheorem{claim}[df]{Claim}
\newtheorem{notation}[df]{Notation}
\newtheorem{op}[df]{Open Problem}
\newtheorem{cla}[df]{Classification}
\newtheorem{notat}[df]{Notation}
\newtheorem{rema}[df]{Remark}



\newcommand{\eloise}{\exists \text{loise}}
\newcommand{\abelard}{\forall \text{belard}}

\newcommand{\SB}[1]{$[\text{#1}]$}

\newcommand{\dep}[2]{=\hspace{-3pt}({#1};{#2})}
\newcommand{\con}[1]{=\hspace{-3pt}({#1})}
\newcommand{\ncon}[1]{\not=\hspace{-3pt}({#1})}

%\newcommand{\cf}{\hspace{2pt}\Box\hspace{-4pt}\rightarrow}
\newcommand{\cf}{\boxright}
\newcommand{\mcf}{\hspace{2pt}\Diamond\hspace{-4pt}\rightarrow}
\newcommand{\iimp}{\hspace{2pt}|\hspace{-4pt}\rightarrow}


\newcommand{\ICD}{\mathcal{ICD}}
\newcommand{\ICDP}{\mathcal{ICD}_+}
\newcommand{\ARROW}[1]{{#1^{\rightarrow}}}
\newcommand{\ACD}{\ARROW{\mathcal{CD}}}
\newcommand{\AICD}{\ARROW{\mathcal{ICD}}}
\newcommand{\AICDP}{\ARROW{\mathcal{ICD}_+}}
\newcommand{\WCD}{\mathcal{WCD}}
\newcommand{\WCDM}{\mathcal{WCD}_-}
\newcommand{\PCD}{\mathcal{PCO}}
%\newcommand{\PC}{\mathcal{PC}}
\newcommand{\PC}{\PP(\cf)}
%\newcommand{\PO}{\mathcal{PO}}
\newcommand{\PO}{\PP(\supset)}
\newcommand{\PPs}{\PP(\lor)}
\newcommand{\PP}{\mathcal{P}}
\newcommand{\PS}{\mathcal{P}^\textsf{s}}
\newcommand{\C}{\mathcal{C}}
\newcommand{\CO}{\mathcal{CO}}
\newcommand{\COD}{\mathcal{COD}}
\newcommand{\COU}{{\mathcal{CO}_\sqcup}}
\newcommand{\CODU}{{\mathcal{COD}_\sqcup}}
\newcommand{\PCO}{\mathcal{PCO}}
\newcommand{\PCOs}{\PCO(\lor)}

\newcommand{\NE}{\operatorname{NE}}

\newcommand{\A}{\mathbb{A}}
\newcommand{\Al}{\hat \alpha}
\newcommand{\B}{\mathbb{B}}

\newcommand{\F}{\mathcal{F}}
\newcommand{\G}{\mathcal{G}}
\newcommand{\K}{\mathcal{K}}

\newcommand{\La}{\mathcal{L}}

\newcommand{\T}{\mathbb{T}}

\newcommand{\Q}{\mathbb{Q}}


\newcommand{\pvec}{\overline{\mathrm p}}
\newcommand{\qvec}{\overline{\mathrm q}}

\newcommand{\Pvec}{\overline{\mathrm P}}
\newcommand{\Qvec}{\overline{\mathrm Q}}
\newcommand{\Rvec}{\overline{\mathrm R}}

\newcommand{\dfn}{\mathrel{\mathop:}=}
\newcommand{\dom}{\mathrm{Dom}}
\newcommand{\ran}{\mathrm{Ran}}
\newcommand{\PA}{\mathrm{PA}}

\newcommand{\Team}{\mathrm{Team}}

\newcommand{\SET}[1]{\mathbf{#1}}

\newcommand{\pindep}{\rotatebox[origin=c]{90}{$\models$}}

\newcommand{\commf}[1]{\textcolor{blue}{\textbf{+++ FB: #1 +++}}}
\newcommand{\jonni}[1]{\textcolor{orange}{\textbf{+++ JV: #1 +++}}}

\newcommand{\corrf}[1]{\textcolor{blue}{#1}}
\newcommand{\jvc}[1]{\textcolor{orange}{#1}}

\newcommand{\clor}{\sqcup}


\begin{document}
%\IEEEoverridecommandlockouts
% paper title
% Titles are generally capitalized except for words such as a, an, and, as,
% at, but, by, for, in, nor, of, on, or, the, to and up, which are usually
% not capitalized unless they are the first or last word of the title.
% Linebreaks \\ can be used within to get better formatting as desired.
% Do not put math or special symbols in the title.
\title{Expressivity Landscape for Logics with Probabilistic Interventionist Counterfactuals}
% author names and affiliations
% use a multiple column layout for up to three different
% affiliations


%\author{
%\IEEEauthorblockN{Fausto Barbero}\\
%\IEEEauthorblockA{University of Helsinki, Finland\\
%University of Sheffield, UK\\
%Email: f.barbero@helsinki.fi}\\
%\and
%\IEEEauthorblockN{Jonni Virtema}\\
%\IEEEauthorblockA{
%University of Sheffield, UK\\
%University of Helsinki, Finland\\
%Email: j.t.virtema@sheffield.ac.uk}
%}

% conference papers do not typically use \thanks and this command
% is locked out in conference mode. If really needed, such as for
% the acknowledgment of grants, issue a \IEEEoverridecommandlockouts
% after \documentclass

% for over three affiliations, or if they all won't fit within the width
% of the page, use this alternative format:
 
\author{\IEEEauthorblockN{Fausto Barbero\IEEEauthorrefmark{1}\IEEEauthorrefmark{2} and
Jonni Virtema\IEEEauthorrefmark{2}\IEEEauthorrefmark{1}}\\
\IEEEauthorblockA{\IEEEauthorrefmark{1}University of Helsinki, Finland\\}
\IEEEauthorblockA{\IEEEauthorrefmark{2}University of Sheffield, UK\\
Email: f.barbero@helsinki.fi, \, j.t.virtema@sheffield.ac.uk}}




% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}


\maketitle
% As a general rule, do not put math, special symbols or citations
% in the abstract
\begin{abstract}
Causal multiteam semantics is a framework where probabilistic dependencies arising from data and 
causation between variables can be together formalized and studied logically.
We consider several logics in the setting of causal multiteam semantics
that can express probability comparisons concerning formulae and constants, and encompass interventionist counterfactuals and selective implications that describe consequences of actions and consequences of learning from observations, respectively.
We discover complete characterizations of expressivity of the logics in terms of families of linear equations that define the corresponding classes of causal multiteams (together with some closure conditions).
The characterizations yield a strict hierarchy of expressive power.
Finally, we present some undefinability results based on the characterizations.
\end{abstract}

% no keywords




% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
The main approach to the scientific study of empirical data in the twentieth century has been that of statistics, which makes use of probabilistic notions like \emph{correlation} and \emph{conditional (in)dependence} between attributes. We advocate another line of study -- going back at least to Sewall Wright \cite{Wri1921} -- and insist that the analysis should not stop at correlations, but instead should yield (together with appropriate scientific assumptions) information about causation among variables. The methods involved in the analysis of causes and effects have gained in popularity in the last decades, and their mathematics has been vastly developed under the label of \emph{causal inference} (see, e.g., \cite{Pea2000,SpiGlySch1993}). Today the methods of causal inference are heavily utilized, e.g., in epidemiology \cite{HerRob2023}, econometrics \cite{HecVyt2007}, social sciences \cite{MorWin2015} and machine learning \cite{PetJanSch2017,Sch2022}.

One of the next crucial steps in the development of artificial intelligence will be the capability of AI systems to represent and reason on causal knowledge (this idea is strongly supported e.g. by Pearl and Mackenzie in \cite{PeaMac2018}). 
For the development of AI applications of causal inference, clarification of the related formal logical theory is vital. It turns out that many concepts involved in the analysis of causes can be reduced to the study of \emph{interventionist counterfactuals} in \emph{causal models}.
Causal models describe causation between variables by so-called \emph{structural equations}. 
In their simplest form, interventionist counterfactuals are expressions such as
\begin{center}
    If variables $X_1,\dots,X_n$ were fixed to values $x_1,\dots,x_n$, then variable $Y$ would take value $y$.
\end{center}         
Research on logics encompassing interventionist counterfactuals has been active in the past two decades. For example,  \cite{GalPea1998,Hal2000,Bri2012, BarYan2022} provided complete axiomatizations  for languages of increasing generality. The papers \cite{Hal2013,Zha2013} drew precise connections with the earlier Stalnaker-Lewis theory of counterfactuals \cite{Sta1968,Lew1973}. 
In \cite{BarGal2022} logics for causal reasoning were studied via translations to first-order logic. The articles \cite{Hal2000,MosIbeIca2022} focus on the complexity of causal and probabilistic languages. %    (see e.g. \cite{GalPea1998,Hal2000,Bri2012,Hal2013,Zha2013,BarSan2020,BarGal2022})


The classical literature on causal inference does not separate the methods of probability and of causal analysis. 
Many standard concepts in causal inference are expressed by mixing probabilistic and causal statements, e.g., in conditional $do$ expressions
%($Pr(y\mid do(x),z)$)
and Pearl's ``counterfactuals''.
%($Pr(Y_{X = x} \mid X=x')$).
These expressions are defined using a mixture of probabilistic conditioning and the notion of intervention on a system of variables. We advocate a research direction proposed by Barbero and Sandu  \cite{BarSan2018,BarSan2023}. The idea is to study notions of causality logically by building on a minimal set of logical primitives, and to separate probabilistic conditioning from causal interventions. More complex notions (e.g., the causal statements mentioned above) are then built compositionally from the primitives.


In order to % study probabilistic conditioning and causal interventions in a common framework,
make this decomposition possible, one needs to move from causal models to the more general \emph{causal multiteam semantics}, where %probabilistic and causal notions can be formalized together.
all the needed logical operators are available.
Team semantics is the semantical framework of modern logics of dependence and independence. Introduced by Hodges \cite{Hod1997} and adapted to dependence logic by V\"a\"an\"anen \cite{Vaa2007}, team semantics defines truth in reference to collections of assignments, called \emph{teams}. Team semantics is particularly suitable for the formal analysis of dependencies and independencies in data. Recent developments in the area have broadened the scope of team semantics to cover probabilistic and quantitative notions of dependence and independence. Durand et al. \cite{DurHanKonMeiVir2018,DurHanKonMeiVir2016} introduced multiset and probabilistic variants of team semantics as frameworks for studying probabilistic dependency notions such as conditional independence logically. Further analysis has revealed that definability and complexity of logics in these frameworks are intimately connected to definability and complexity of Presburger (\!\!\cite{GradelW2022,Wilke2022}) and real arithmetic (\!\!\cite{HanVir2022,HKBV2020}).

\emph{Causal teams}, proposed by Barbero and Sandu \cite{BarSan2020}, fuse together teams and causal models, and model inferences encompassing both functional dependencies arising from data and causation arising from structural equations.
Logics considered by Barbero and Sandu are closed under Boolean connectives and use atomic expressions of the form $X=x$ and $\dep{X}{Y}$ to state that the variable $X$ takes the value $x$ and that (in the data) the value of the variable $Y$ is functionally determined by the values of the variable $X$, respectively.
\emph{Interventionist counterfactuals} ($X=x\cf \psi$) and \emph{selective implications} ($\varphi \supset \psi$) then describe consequences of actions and consequences of learning from observations. 
For example, the intended reading of the formula
\[
\textrm{Pressure} = 300 \cf \textrm{Volume}= 4
\]
is: \emph{If we raise the pressure to $300$ kPa, the volume of the gas will be $4$ $\mathit{m}^3$.}   
On the other hand, the intended reading of the formula
\[
\textrm{Pressure} = 20 \supset 10<\textrm{Altitude}<30
\]
is: \emph{If we read $20$ kPa from the barometer, the current altitude is between 10 and 30 km}.    

Finally, \emph{causal multiteam semantics} coined by Barbero and Sandu \cite{BarSan2023} fuses together multiteams and causal models. The shift from teams to multiteams makes it now possible to study probabilistic conditioning and causal interventions in a unified framework.

In this paper, we explore the expressivity landscape of logics on causal multiteams that can express different forms of probabilistic conditioning and causal interventions.
The language of \textbf{P}robabilistic \textbf{C}ausal \textbf{O}bservations ($\PCO$) is the %most expressive 
main language we consider in this paper; it contains both interventionist counterfactuals and selective implications, together with probabilistic comparison atoms $\Pr(\alpha) \vartriangleright \Pr(\beta)$  and evaluation atoms $\Pr(\alpha) \vartriangleright \epsilon$ (where  $\vartriangleright \hspace{2pt} \in \{\geq, >\}$, $\epsilon\in [0,1]$ is a rational number, and $\Pr(\alpha)$ denotes the counting probability of the property $\alpha$ in the data). This simple language is sufficient to express, for example, the "Pearl counterfactuals'' mentioned above, e.g. 
\[
(\textrm{Sick}=1 \land \textrm{Treated}=0) \supset (\textrm{Treated}=1 \cf \Pr(\textrm{Sick}=0) \geq \frac{2}{3})
\]
(``the probability that a sick untreated patient would be healed when treated is at least $\frac{2}{3}$'').


We discover complete characterizations of expressivity of $\PCO$ and its natural sublogics $\PP^-$, $\PP$, $\PO$, and $\PC$ (for definitions, see Section \ref{sec: preliminaries}) in terms of types of linear equations that define the corresponding classes of causal multiteams (together with some closure conditions).
The characterizations yield a strict hierarchy of expressivity with respect to the above logics and the extension $\PCO^\omega$ of $\PCO$ with infinitary disjunctions; see Figure \ref{fig:FIRSTCAUSALGRAPH}. Analogous to the folklore result that the logic $L_{\infty\omega}$ can define all classes of finite structures, it was shown in \cite{BarSan2023} that the same holds for $\PCO^\omega$ with respect to all classes of causal multiteams that are closed under \emph{rescaling} and have the \emph{empty multiteam property} (cf. Theorem \ref{theorem: expressivity of PCOinf}).
It remains as an open problem, whether there exists a finitary logic that is in some sense expressively complete in our setting (note that any truly expressively complete logic is uncountable). As an application of the characterization and hierarchy results, we show that, 
while expressions of the form $\Pr(\alpha\mid\gamma)\geq \Pr(\beta\mid\gamma)$ -- where both probabilities are conditioned over the same formula $\gamma$ -- are easily definable in $\PCO$ (as $\gamma \supset \Pr(\alpha)\geq \Pr(\beta)$), the same is not true for formulae in the general form $\Pr(\alpha\mid\gamma)\geq \Pr(\beta\mid\delta)$. %Moreover, we establish that marginal and conditional probabilistic independence atoms are not expressible in $\PCO$. 



 
% The rich variety of causal/probabilistic expressions exemplified above can then be reduced to a simple language ($\PCO$, probabilistic causal-observational language) that features both kinds of conditionals. 



%The detail of this reduction go beyond the scope of the present paper and will appear in the forthcoming \cite{BarSan2023}. The purpose of this note is instead to investigate the semantic properties of the language $\PCO$, in particular the expressive power of the whole language and of some natural fragments and extensions (see Figure \ref{fig:FIRSTCAUSALGRAPH}). We find a number of characterization results, which lead to the separation of all these languages. 

%The separation of the languages, in turn, provides tools for proving undefinability results. We consider in particular the following nontrivial issue.
%
%shows that all such expressions can be decomposed in terms of marginal probability statements and of two logical conditionals, $\supset$ (\emph{selective implication}) and $\cf$ (\emph{interventionist counterfactual}), which correspond, respectively, to the act of observing/learning, and the act of intervening. Said decomposition is performed within a language $\PCO$ (probabilistic-causal-observational language) whose interpretation is given by a variant of \emph{multiteam semantics}\footnote{Team semantics was introduced in \cite{Hod1997} as a compositional semantics for languages with partially ordered quantification (IF logic). It is now extensively used to support logics with dependence and independence atoms (e.g \cite{Vaa2007},\cite{GraVaa2013},\cite{Gal2012}). The multiteam approach to probabilities was introduced in \cite{DurHanKonMeiVir2016}. The causal adaptation of team semantics was proposed in \cite{BarSan2018},\cite{BarSan2020}.}.%, which we briefly present in section \ref{sec: preliminaries}.    
%The main purpose of this note is to obtain a better understanding of the expressive power of the language $\PCO$. Our characterization result %(section \ref{subs: expressivity of PCO})
%(theorem \ref{thm: characterization of PCO}) allows us to settle a nontrivial problem left open in \cite{BarSan2023}.

%While it can be easily shown that expressions of the form $\Pr(\alpha\mid\gamma)\geq \Pr(\beta\mid\gamma)$ -- where both probabilities are conditioned over one and the same formula $\gamma$ -- are definable in $\PCO$ (as $\gamma \supset \Pr(\alpha)\geq \Pr(\beta)$) it is not obvious whether the general form of the comparison atom $\Pr(\alpha\mid\gamma)\geq \Pr(\beta\mid\delta)$ is definable or even expressible in $\PCO$. Our results settle the question in the negative. A related issue, which we also settle in the negative, is the expressibility of marginal and conditional probabilistic independence.

%These negative results show that the language $\PCO$ does not encompass the full range of causal-probabilistic reasoning. %We show %in appendix \ref{Appendix: infinitary PCO}  
%\corrf{For a contrast, the results in \cite{BarSan2023} show }
% that this kind of expressiveness can be achieved by means of an infinitary extension of the language. This raises the question of what kind of constraints are imposed by the expressivity of $\PCO$. We found it suitable to analyze the resources of this language ``from below'', characterizing first the expressivity of some small, purely probabilistic fragments; %(section \ref{subs: Expressivity probabilistic});
% then, describing the effect of adding either $\supset$ or $\cf$ to the probabilistic base; 
 %(\ref{subs: PO and PC});
% and, lastly, combining these findings. We show that all the inclusions among these languages are strict. The constraints that differentiate these languages involve, among other things, the individuation of three distinct classes of systems of linear inequalities.


\begin{comment}
\textbf{Related work.} The notion of semantic relation based on causal multiteams that we consider is the same that is presented in \cite{BarSan2018} and the forthcoming \cite{BarSan2023}, which adds a probabilistic dimension to the causal team semantics more extensively developed in \cite{BarSan2020}, \cite{BarYan2022},\cite{BarGal2022}. Our presentation of the specifics of the models differs in some minor details \commf{Can we simplify it like this? Actually with our semantics there are less models. More precisely, we quotiented out multiple copies of models that are indistinguishable for the languages} (explained in detail in appendix \ref{Appendix: transferring results}); the key difference is that we do not allow the functions that describe causal laws to have dummy arguments. 
%Our presentation of causal (multi)teams here diverges in a number of ways from what was done in previous papers, such as \cite{BarSan2020}. There the causal graph is part of the definition, and its presence allows for the introduction of functions $\F_V$ with (almost) arbitrary sets of arguments $\PA_V$. Such a definition allows the representation of causal laws that only differ for the presence or absence of some dummy arguments. This detail turns out to be a rather tedious technicality (see \cite{BarYan2022} for a detailed analysis) and we choose to avoid in this paper.
\end{comment}

\vspace{5pt}

\textbf{Structure of the paper.}
Section \ref{sec: preliminaries} introduces the syntax and semantics of the languages considered in the paper. Section \ref{sec: expressive power} presents a variety of semantic characterizations and strict inclusions of expressive power; we consider purely probabilistic fragments (\ref{subs: Expressivity probabilistic}), fragments with just one conditional (\ref{subs: PO and PC}) and the whole $\PCO$ language (\ref{subs: expressivity of PCO}). %We analyze an infinitary extension of $\PCO$ in appendix \ref{Appendix: infinitary PCO}.
%\commf{Removed reference to the infinitary result. We still talk of infinitary PCO, and provide an alternative proof that it is strictly more expressive than PCO, but I don't know if it is worth mentioning here.}
%Finally, in the appendixes \ref{Appendix: transferring results} and \ref{Appendix: expressivity of CO} \commf{Why is it not telling part the sections of the appendix?} we offer some tools for transferring results from the non-probabilistic setting of \emph{causal team semantics} to the probabilistic setup, showing in particular how to derive from it semantic characterizations of non-probabilistic languages in multiteam semantics (we mainly focus on the language $\CO$ from \cite{BarSan2020}).
 Section \ref{sec:teamsemantics} briefly explores the definability of probabilistic atoms from the team semantics literature in our setting, and establishes that comparison of conditional probabilities is not in general expressible in $\PCO$.
Section \ref{sec:conclusion} concludes the paper and presents some open problems and further directions of study. The appendix covers some easier technical issues concerning how to transfer results from the framework of causal teams to causal multiteams, and how to characterize the expressive power of non-probabilistic languages.


%We show and give precise characterizations of the expressivity of each of the logics.
%\includegraphics[scale=0.5]{languageseparationgraph}




%For a comparison, previous literature gives a definition analogous to \ref{def: causal multiteam} in which the multiteam component is replaced by a team; the resulting object is called a \textbf{causal team}.


%There at least two different approaches to the formalization of multiteams in the literature (\cite{Vaa2017},\cite{DurHanKonMeiVir2016}).

%\cite{BarSan2023} leaves it as an open problem whether the general comparison atoms are definable or even just expressible in $\PCO$.\footnote{It will be clear from the results in section \ref{subs: expressivity of an infinitary language} that they are expressible in $\PCO^\omega$, but it remains an open problem whether they admit a schematic definition in that language.} The issue seems to be fairly nontrivial, and we answer it in the negative in section \ref{subs: expressivity of PCO}. Furthermore, we will show that even the simple atoms $\Pr(\alpha\mid\gamma)\vartriangleright \Pr(\beta)$ (which abbreviate  $\Pr(\alpha\mid\gamma)\vartriangleright \Pr(\beta\mid\top)$) are not definable in $\PCO$.

%The main motivation for including the operator $\supset$ in the language is that, in many circumstances, it allows to reduce the probabilistic operation of conditioning in terms of marginal probabilities and logic. More generally, it allows to decompose operators that mix probabilistic and causal ideas, such as the so-called $do$-expressions and Pearl's conditionals (\cite{Pea2000}). This is explained in detail \cite{BarSan2023}.

% The semantic framework described in this paper is intended as a general framework for the description of causal-probabilistic statements; it may fit very different interpretations of the concept of probability, e.g. a frequentist versus a subjectivist approach. Likewise, the language $\PCO$ has been devised in a way that does not force one to choose a specific interpretation. In other words, the language $\PCO$ is such that it cannot tell apart multiteams that represent one and the same distribution; it is a purely probabilistic language in the sense that all $\PCO$-definable classes of causal multiteams are closed under rescalings, in the  sense explained below.


%\jonni{Intro or Conclusion}
%It should be clear by the results of the previous section that individual $\PCO$ formulae cannot express all purely probabilistic properties. (We leave it as an open question whether this can be done by a \emph{set} of $\PCO$ formulae.)\commf{Actually, there is not yet an explicit argument -- and our results only consider definability by a single formula.}
%We should then ask what kind of restrictions do the $\PCO$-definable classes have. It will be easier to proceed by analyzing small fragments of $\PCO$, and gradually observing the impact of adding operators.


\begin{figure}
	\centering
		\begin{tikzpicture}

\normalsize
  
		\node(po) at (0,1.4) {$\PO$};

         \node(pm) at (-4.0,0) {$\PP^-$};	
		
		\node(p) at (-2.0,0) {$\PP$};
		 
		\node(pco)  at (2, 0) {$\PCO$};

        \node(pc) at (0,-1.4) {$\PC$};

        \node(inf) at (4,0) {$\PCO^\omega$};
		
		\draw [->]  (pm)--(p) node[above, pos=0.5]{\footnotesize Lemma \ref{lemma: not all signed monic are monic}};		
        

		\draw [->] (p)--(pc) node[above, sloped, pos=0.5]{\footnotesize Corollary \ref{cor: easy comparisons}};		
		
		\draw[->] (p)--(po) node[above, sloped, pos=0.5]{\footnotesize Lemma \ref{lemma: not all linear are signed monic}}; 
		
		\draw[->] (po)--(pco) node[above, sloped, pos=0.5]{\footnotesize Corollary \ref{cor: easy comparisons}};
		
		\draw [->] (pc)--(pco) node[above, sloped, pos=0.5]{\footnotesize Corollary \ref{cor: PC smaller than PCO}}; 
		
		\draw[->] (pco)--(inf) node[above, pos=0.5]{\footnotesize Cor. \ref{cor: PCO smaller than PCOinf}}; 
		
		\end{tikzpicture}
		\caption{The arrows denote strict inclusion of expressive power. The languages $\PC$ and $\PO$ are incomparable (Corollaries \ref{cor: easy comparisons} and \ref{cor: PO not included in PC}).}
  \label{fig:FIRSTCAUSALGRAPH}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Preliminaries}\label{sec: preliminaries}
Capital letters such as $X, Y,\dots$ denote \textbf{variables} (thought to stand
for specific magnitudes such as ``temperature'', ``volume'', etc.) which
take \textbf{values} denoted by small letters (e.g. the values of the variable $X$ will be
denoted by $x, x', \dots$). %As a special case, we may also consider "Boolean" variables
%which take values $1$ or $0$ to describe the occurrence, resp. non-occurrence,
%f a specific event.
Sets (and tuples, depending on the context) of variables and values are denoted by boldface letters such as $\SET X$ and $\SET x$.
%The capital letters $S$ and $T$ are reserved to denote causal teams, to be defined below.
We consider probabilities that arise from the counting measures of finite (multi)sets. For finite sets $S\subseteq T$, we define 
\(
P_T(S):= \frac{|S|}{|T|}.
\)

\subsection{Teams and causal multiteams}


%
A \textbf{signature} is a pair $(\dom,\ran)$, where $\dom$ is a finite set of variables and $\ran$ is a function that associates to each variable $X\in \dom$ a finite set $\ran(X)$ of values (the \textbf{range} of $X$). % We assume that each variable can take values in a set $\ran(X)\subseteq  \ran$; this restriction will be incorporated in the notion of causal team, to be defined below. 
%Once
%a (finite) set $\dom$ of variables is fixed, each
We consider throughout the paper a fixed ordering of $\dom$, and write $\SET W$ for the tuple of all variables of $\dom$ listed in such order. Furthermore, we write $\SET W_X$ for the variables of $\dom\setminus\{X\}$ listed according to the fixed order. %, $\SET W_{XY}$ for the analogous tuple of variables in $\dom\setminus\{X,Y\}$, and so on. %The definition does not differ in any significant detail from the definition of causal team given in the first part of the paper, except for the fact that the first component of a causal multiteam will be a multiteam rather than a team. 
Given a tuple $\SET X = (X_1,\dots, X_n)$ of variables, we denote as $\ran(\SET X)$ the Cartesian product $\ran(X_1)\times\dots\times \ran(X_n)$. 
An \textbf{assignment} of signature $\sigma$ is a mapping $s:\dom\rightarrow\bigcup_{X\in \dom}\ran(X)$ such that $s(X)\in \ran(X)$
for each $X\in \dom$.
The set of all assignments of signature $\sigma$ is denoted by $\B_\sigma$.
Given an assignment $s$ that has the variables of $\SET X$ in its domain, $s(\SET X)$ will denote the tuple $(s(X_1), \dots,s(X_n))$.
For $\SET X\subseteq \dom$, $s_{\upharpoonright \SET X}$ denotes the restriction of $s$ to the variables in $\SET X$.

A \textbf{team} $T$ of signature $\sigma$ is a subset of $\B_\sigma$.
Intuitively, a multiteam is just a multiset analogue of a team.
%
%
%In order to be able to represent the probabilities of formulae in our models, we will rather need \emph{multisets} of assignments (\textbf{multiteams}).  There at least two different approaches to the formalization of multiteams in the literature (\cite{Vaa2017},\cite{DurHanKonMeiVir2016}).
%
We represent \textbf{multiteams} as teams with an extra variable $Key$ (not belonging to the signature) ranging over $\mathbb N$, which takes different values over different assignments of the team, and which is never mentioned in the formal languages. 
%We  assume that the range of values for $Key$ is $\mathbb N$.
%The set of all such extended assignments is denoted by $\mathbb A_\sigma$.
%

Multiteams by themselves do not encode any solid notion of causation; they do not tell us how a system would be affected by an intervention. We therefore need to enrich multiteams with additional structure.

\begin{comment}
A multiteam can be represented as a table:
\begin{center}
$T$: \begin{tabular}{|c|c|c|}
\hline
 \multicolumn{3}{|c|}{\hspace{-4pt} Key \ \ X \   \ Y} \\
\hline
 \phantom{a}0\phantom{a} & 0 & 0 \\
\hline
 1 & 0 & 0 \\
\hline
 2 & 0 & 1 \\ 
\hline
\end{tabular}
\end{center}

EXPLAIN IT
\end{comment}










%\subsection{Causal multiteams}



%\jonni{Edited the last sentence slightly. Renamed the variables $Y$ as $V$.}
\begin{definition}\label{def: causal multiteam}
A \textbf{causal multiteam} of signature $(\dom, \ran)$ 
with \textbf{endogenous variables} $End(T)\subseteq \dom$ is a pair $T = (T^-,\F)$, where
%\begin{enumerate}
%\item 
$T^-$ is a multiteam of domain $\dom$,
%(the \emph{multiteam component} of $T$)
and
%\item $G(T) =(\dom(T),E)$ is a graph over the set of variables (except the variable Key). For any $X\in \dom(T)$, we denote as $\PA_X$ the set of all variables $Y\in \dom(T)$ such that the arrow $(Y,X)$ is in $E$ (the \emph{parents} of $X$).
%\item $\mathcal{R}_T = \{(X,\ran(X)) \ | \ X\in \dom(T)\}$ 
%is a function which assigns a range $\ran(X)\subseteq \ran(T)$ to each variable $X$ (except Key).
%\item
$\F$ is a function $\{(V,\F_V) \ | \ V\in End(T)\}$ that assigns to each endogenous variable $V$ a non-constant $|\SET W_V|$-ary function $\F_V: \ran(\SET W_V)\rightarrow 
\ran(V)$,
%(the \emph{function component} of $T$)
%\end{enumerate}
which satisfies the further \textbf{compatibility constraint}: $\F_V(s(\SET W_V))=s(V)$, for all $s\in T^-$.
%and $Y\in \SET V$.
%
%\begin{itemize}
%%\item $T^-(X) \subseteq \ran(X)$ for each $X\in \dom(T)$.
%%\item If $\PA_Y=\{X_1,\dots, X_n\}$, then $T^-\models \dep{X_1,\dots, X_n}{Y}$
%\item For all $s\in T^-$, and all $Y\in \SET V$, $s(Y)= \F_Y(s(\SET W_Y))$.
%\end{itemize}
We write $(\dom(T),\ran(T))$ to denote the signature of the causal multiteam $T$. 
\end{definition}
%
%\noindent In the following, we will reserve the notation $S,T,\dots$ for causal multiteams, and $S^-, T^-,\dots$ for multiteams simpliciter.
%
%Clause b) is there to ensure that whenever the graph contains an arrow $X_i\rightarrow Y$, and $\{X_1,\dots X_n\}$ is the maximal set of variables from which there is an arrow come to $Y$, then the team satisfies the corresponding dependence atom $\dep{X_1,\dots X_n}{Y}$. 
%
%
The function $\mathcal F$ induces a system of structural equations; an equation
\[
V := \mathcal F_V(\SET W_V)
\]
for each variable $V\in End(T)$. Note that some of the variables in $\SET W_V$ may not  be necessary for evaluating $V$. For example, if $V$ is given by the structural equation $V:= X+1$, all the variables in $\SET W_V\setminus \{X\}$ are irrelevant (we call them \textbf{dummy arguments} of $\F_V$). The set of non-dummy arguments of $\F_V$ is denoted as $\PA_V$ (the set of \textbf{parents} of $V$), and $f_V\colon\ran(\PA_V)\rightarrow \ran(V)$ is the restriction of $\F_V$ to the arguments $\PA_V$.
%i.e., for each value $\SET p\in \PA_Y$, $f_V(\SET p)$ is defined as $\F_v(\SET p\SET d)$ (where $\SET p\SET d$ is a tuple listing, in the correct order, the values in $\SET p$ and an arbitrary tuple $\SET d$ of values for the dummy arguments).

A causal multiteam $(T^-,\F)$ is \textbf{empty} (resp. \textbf{nonempty}) if the multiteam $T^-$ is.
We associate to each causal multiteam $T$ a \textbf{causal graph} $G_T$, whose vertices are the variables in $\dom$ and where an arrow is drawn from each variable in $\PA_V$ to $V$, whenever $V\in End(T)$. 
%The graph associated to this system of structural equations is $G(T)$. 
The variables in $\dom(T)\setminus End(T)$ are called \textbf{exogenous} (written $Exo(T)$).

The following operations on causal multiteams will be useful later:

\begin{definition}
The \textbf{support} of a causal multiteam $T=(T^-,\F)$ is the causal team $\Team(T) = (\Team(T^-),\F)$, where $\Team(T^-):=  \{s_{\upharpoonright Dom} \mid s\in T^-\}$.  
\end{definition}

\begin{definition}
A causal multiteam $S=(S^-,\F_S)$ is a \textbf{causal sub-multiteam} of $T=(T^-,\F_T)$, if they have same signature, $S^-\subseteq T^-$, and $\mathcal{F}_S = \mathcal{F}_T$. We then write $S\leq T$.
%
%Given a causal multiteam $T=(T^-,\F_T)$, a \textbf{causal sub-multiteam} $S=(S^-,\F_S)$ of $T$ is a causal multiteam with the same domain and the same set of endogenous variables, which satisfies the following conditions: 1) $S^-\subseteq T^-$, 2) $\mathcal{F}_S = \mathcal{F}_T$.
\end{definition} 




%\subsection{Operations on causal multiteams}

We consider causal multiteams as dynamic models, that can be affected by various kinds of operations -- specifically, by observations and interventions.
%
Given a causal multiteam $T = (T^-,\F)$ and a formula $\alpha$ of some formal language (evaluated over assignments according to some semantic relation $\models$), ``observing $\alpha$'' produces the causal sub-multiteam $T^\alpha = ((T^\alpha)^-,\F)$ of $T$, where
\[
(T^\alpha)^- \dfn \{s\in T^-  \ | \  (\{s\},\F)\models \alpha\}.
\]



An intervention on $T$ will \emph{not}, in general, produce a sub-multiteam of $T$. It will instead modify the values that appear in some of the columns of $T$. We consider interventions that are described by formulae of the form $X_1=x_1 \land\dots\land X_n=x_n$ (or, shortly, $\SET X = \SET x$). Such a formula is \textbf{inconsistent} if there are two indexes $i,j$ such that $X_i$ and $X_j$ denote the same variable, while $x_i$ and $x_j$ denote distinct values; it is \textbf{consistent} otherwise.

Applying an intervention $do(\SET X = \SET x)$, where $\SET X = \SET x$ is consistent, to a causal multiteam $T = (T^-,\F)$ will produce a causal multiteam $T_{\SET X = \SET x} = (T^-_{\SET X = \SET x},\F_{\SET X = \SET x})$, where the function component is 
\(
\F_{\SET X = \SET x} := \F_{\upharpoonright(\SET V \setminus \SET X)}
\)
(the restriction of $\F$ to the set of variables $\SET V \setminus \SET X$) 
and the multiteam component is 
\(
T_{\SET X=\SET x}^-:=\{s^\F_{\SET X=\SET x}\mid s\in T^-\},
\)
where each $s^\F_{\SET X=\SET x}$ is the unique assignment compatible with $\mathcal F_{{\SET X = \SET x}}$ defined (recursively) as 
\[s^\F_{\SET X=\SET x}(V)=\begin{cases}
x_i&\text{ if }V=X_i\in \SET X\\
s(V)&\text{ if }V\in Exo(T)\setminus \SET X\\
\F_V(s^\F_{\SET X=\SET x}(\PA_V%^{\mathcal F}
))&\text{ if }V\in End(T)\setminus \SET X.
\end{cases}
\]

%\jonni{EXAMPLE for Applying an intervention $do(\SET X = \SET x)$?}


\begin{example}
Consider the following table:
\begin{center}
$T^-$: \begin{tabular}{|c|c|c|c|}
\hline
\multicolumn{4}{|c|}{ } \\
\multicolumn{4}{|c|}{\small{Key} \  $X$\tikzmark{XR} \ \ \tikzmark{YL}$Y$\tikzmark{YR} \ \ \tikzmark{ZL}$Z$} \\
\hline
 0 & 0 & 1 & 1\\
\hline
 1 & 1 & 2 & 3 \\
\hline
 2 & 1 & 2 & 3 \\
\hline
 3 & 2 & 3 & 5\\ 
\hline
 4 & 2 & 3 & 5\\ 
\hline
 5 & 2 & 3 & 5\\ 
\hline
\end{tabular}
\begin{tikzpicture}[overlay, remember picture, yshift=0\baselineskip, shorten >=.5pt, shorten <=.5pt]
  \draw ([yshift=7pt]{pic cs:XR})  edge[line width=0.2mm, out=45,in=135,->] ([yshift=7pt]{pic cs:ZL});
  \draw [->] ([yshift=3pt]{pic cs:YR})  [line width=0.2mm] to ([yshift=3pt]{pic cs:ZL});
  \draw [->] ([yshift=3pt]{pic cs:XR})  [line width=0.2mm] to ([yshift=3pt]{pic cs:YL});
\end{tikzpicture}
\end{center}
where each row represents an assignment (e.g., the third row represents an assignment $s$ with $s(Key)=2$, $s(X)=1$, $s(Y)=2$, $s(Z)=3$). Assume further that the variable $Z$ is generated by the function $\F_Z(X,Y) = X+Y$, $Y$ is generated by $\F_Y(X)=X+1$, while $X$ is exogenous. The rows of the table are compatible with these laws, so this is a causal multiteam (call it $T$). It encodes many probabilities; for example, $P_T(Z=3) = \frac{1}{3}$. Suppose we have a way to enforce the variable $Y$ to take the value $1$. We represent the effect of such an intervention ($do(Y=1)$) by recomputing the $Y$ and then  the $Z$ column:

\begin{center}
 \begin{tabular}{|c|c|c|c|}
\hline
\multicolumn{4}{|c|}{ } \\
\multicolumn{4}{|c|}{ \hspace{-5pt} \small{Key} \  $X$\tikzmark{XR'} \ \ \tikzmark{YL'}$Y$\tikzmark{YR'} \ \ \tikzmark{ZL'}$Z$} \\
\hline
 0 & 0 & \textbf{1} & $\dots$ \\
\hline
 1 & 1 & \textbf{1} &  $\dots$  \\
\hline
 2 & 1 & \textbf{1} &  $\dots$ \\
\hline
 3 & 2 & \textbf{1} &  $\dots$ \\ 
\hline
 4 & 2 & \textbf{1} &  $\dots$ \\ 
\hline
 5 & 2 & \textbf{1} &  $\dots$ \\ 
\hline
\end{tabular}
\hspace{15pt} $\leadsto$ \hspace{5pt}  $T_{Y=1}$: \begin{tabular}{|c|c|c|c|}
\hline
\multicolumn{4}{|c|}{ } \\
\multicolumn{4}{|c|}{\small{Key} \  $X$\tikzmark{XR''} \ \ \tikzmark{YL''}$Y$\tikzmark{YR''} \ \ \tikzmark{ZL''}$Z$} \\
\hline
 0 & 0 & 1 & \textbf{1}\\
\hline
 1 & 1 & 1 & \textbf{2} \\
\hline
 2 & 1 & 1 & \textbf{2} \\
\hline
 3 & 2 & 1 & \textbf{3}\\ 
\hline
 4 & 2 & 1 & \textbf{3}\\ 
\hline
 5 & 2 & 1 & \textbf{3}\\ 
\hline
\end{tabular}
\begin{tikzpicture}[overlay, remember picture, yshift=0\baselineskip, shorten >=.5pt, shorten <=.5pt]
  \draw ([yshift=7pt]{pic cs:XR'})  edge[line width=0.2mm, out=45,in=135,->] ([yshift=7pt]{pic cs:ZL'});
  \draw [->] ([yshift=3pt]{pic cs:YR'})  [line width=0.2mm] to ([yshift=3pt]{pic cs:ZL'});
  %\draw [->] ([yshift=3pt]{pic cs:XR})  [line width=0.2mm] to ([yshift=3pt]{pic cs:YL});
  
  \draw ([yshift=7pt]{pic cs:XR''})  edge[line width=0.2mm, out=45,in=135,->] ([yshift=7pt]{pic cs:ZL''});
  \draw [->] ([yshift=3pt]{pic cs:YR''})  [line width=0.2mm] to ([yshift=3pt]{pic cs:ZL''});
  %\draw [->] ([yshift=3pt]{pic cs:XR})  [line width=0.2mm] to ([yshift=3pt]{pic cs:YL});
\end{tikzpicture}

\end{center}
The probability distribution has changed: now  $P_{T_{Y=1}}(Z=3)$ is $\frac{1}{2}$. Furthermore, the function $\F_Y$ is now omitted from $T_{Y=1}$ (otherwise the assignments would not be compatible anymore with the laws). Correspondingly, the arrow from $X$ to $Y$ has been omitted from the causal graph.   
\end{example}







\subsection{Logics for causation}
We consider logics whose semantics is defined with respect to causal multiteams.
Given two logics $\La,\La'$ of signature $\sigma$ and formulae $\varphi\in \La$ and $\varphi'\in \La'$, we write $\varphi \equiv \varphi'$, if the equivalence $T\models \varphi \Leftrightarrow T\models \varphi'$ holds for all causal multiteams $T$ of signature $\sigma$.
We write $\La\leq\La'$
%($\La$ is at most as expressive as $\La'$)
if for every formula $\varphi$ of $\La$ there is a formula $\varphi'$ of $\La'$ with $\varphi \equiv \varphi'$.
We write $\La<\La'$ 
%($\La$ is strictly less expressive than $\La'$)
if $\La\leq\La'$ but $\La'\not\leq\La$.
Finally, we write $\La \equiv \La'$
%($\La$ is expressively equivalent to $\La'$)
if $\La\leq\La'$ and $\La'\leq\La$. 
$\K^\sigma_\varphi$ is  the set %class
of all causal multiteams of signature $\sigma$ that satisfy $\varphi$.
We omit the index $\sigma$ if it is clear from the context.
Similarly, we write $\mathcal{L}_\sigma$ to emphasise that the signature of $\La$ is $\sigma$.
A class $\K$ of causal multiteams is \textbf{definable} in $\mathcal L_\sigma$ if $\K=\K^\sigma_\varphi$ for some $\varphi\in\La_\sigma$.
%\corrf{Equivalently, we also say that $\K$ is definable in $\mathcal{L}_\sigma$.}
%\jonni{The last sentence above is redundant.}\commf{Why? We use this expression in many theorem statements, but it was undefined. (Notice the role played by the signature).} \jonni{I reformulated it above.}


A class $\K$ is \textbf{flat} if $(T^-,\F)\in\K$ iff $(\{s\},\F)\in \K$ for every $s\in T^-$. A class $\K$ of causal multiteams of signature $\sigma$ has the \textbf{empty multiteam property}, if $\K$ includes all empty causal multiteams of signature $\sigma$. A $\sigma$-formula $\varphi$ has one of the above (or to be defined) properties, if $\K^\sigma_\varphi$ has it. A logic $\La$ has a property, if every $\varphi\in \La$ has it.

%We first introduce a language $\CO$ for the description of facts. A more complex language, $\PCO$, will allow us to talk about the probabilities of the facts that are expressible in $\CO$.

The language $\CO$, introduced in \cite{BarSan2020}, is defined by the following BNF grammar:
\[
\alpha ::= Y=y \mid Y\neq y \mid  \alpha\land\alpha  \mid  \alpha\lor\alpha  \mid  \alpha\supset\alpha  \mid  \SET X = \SET x \cf \alpha,
\]
where $\SET{X}\cup\{Y\}\subseteq \dom$, $y\in \ran(Y)$, and $\SET x\in \ran(\SET X)$.
It is a language for the description of facts. We will later introduce extensions that allow us to talk about the probabilities of the facts that are expressible in $\CO$.
%The notation $\SET X = \SET x$ abbreviates a formula of the form $X_1 = x_1 \land\dots\land X_n = x_n$.
%We will often simply write $\CO$, omitting reference to the specific signature. $\CO$ 
Formulae of the forms $Y = y$ and $Y\neq y$ are \textbf{literals}.
%
Semantics for $\CO$ is given by the following clauses:
\begin{align*}
&T\models Y=y &&\text{iff}&& s(Y)=y \text{ for all } s\in T^-.\\
&T\models Y\neq y  &&\text{iff}&& s(Y)\neq y \text{ for all }s\in T^-.\\
&T\models \alpha\land \beta  &&\text{iff}&& T\models \alpha \text{ and } T\models \beta.\\
&T\models \alpha\lor \beta &&\text{iff}&& \text{there are $T_1,T_2\leq T$ s.t. } T_1^-\cup T_2^- = T^-,\\ & && && T_1^-\cap T_2^- = \emptyset,  T_1\models \alpha \text{ and  }T_2\models \beta.\\
&T\models \alpha \supset \beta &&\text{iff} && T^\alpha \models \beta.\\
&T\models \SET X=\SET x \cf \psi &&\text{iff}&& T_{\SET X=\SET x} \models \psi \text{ or } \SET X=\SET x \text{ is inconsistent}.
\end{align*}

Note that in \cite{BarSan2020} $\lor$ was defined without insisting  that $T_1^-\cap T_2^- = \emptyset$.
This was done since the paper considered set-based semantics.
As our semantics is based on multisets, the appropriate definition of $\lor$ uses a union that is sensitive to multiplicities (i.e. disjoint union).
Theorem \ref{thm: CO flatness} below shows that this distinction is irrelevant for $\CO$, but it will have an impact in forthcoming works that apply $\lor$ to non-downward closed formulae.

%\footnote{The clause $T_1^-\cap T_2^- = \emptyset$ could be omitted without changing the meaning of formulae (and indeed is absent in the description of $\CO$ in previous papers). We include it because this distinction is important for a language $\PP^\textsf{s}$ considered later on.}

Key properties of $\CO$ are \emph{flatness} and the \emph{empty multiteam property}, which characterize it as a classical language.
The proof is similar to that of the analogous result for causal teams \cite[Thm. 2.10]{BarSan2020}.
\begin{theorem}\label{thm: CO flatness}
$\CO_{\sigma}$ is flat and has the empty multiteam property. 
%Let $\alpha$ be a $\CO_{\sigma}$ formula, $T$ a causal multiteam and $T'$ an empty causal multiteam. Then
%\begin{enumerate}
%\item $T\models\alpha$ if and only if, for all $s\in T^-$, $(\{s\},\F)\models\alpha$, (flatness)
%\item $T'\models \alpha$. (empty multiteam property)
%\end{enumerate}
\end{theorem} 
%Alternatively, the techniques described in section \ref{sec: Transferring results} allow to derive results of this kind from the corresponding results in the causal team setting. Flatness tells us that we could have formulated the semantics of $\CO$ in a Tarskian form (truth over assignments), from which we refrained for homogeneity with the rest of the paper.\commf{Or we could....}


%By similar means we can prove a second property. We say that a causal multiteam $T = (T^-,\F)$ is \emph{empty} (resp. \emph{nonempty}) if such is the multiteam $T^-$ (which we have identified with a set of assignments over $\dom\cup{Key}$).

%\begin{theorem}[Empty multiteam property]
%Let $T$ be an empty causal multiteam of signature $\sigma$ and $\alpha$ a $\CO_\sigma$ formula. Then $T\models \alpha$. 
%\end{theorem}


%It was established in \cite{BarSan2020} that
If we pick a variable $X$ in the signature and a value $x\in Ran(X)$, we can abbreviate the formulae $X=x \lor X\neq x$ and $X=x \land X\neq x$ as $\top$, resp. $\bot$.
The so-called \textbf{dual negation} of a formula $\alpha$
\[
T\models \alpha^d \text{ iff } (\{s\},\F)\not\models  \alpha \text{ for all }s\in T^- 
\]
is then definable in $\CO$ as $\alpha\supset \bot$.

%can be inductively define in $\CO$ by a simple extension of the De Morgan's laws by $(X = x)^d \dfn X \neq x$, $(X \neq x)^d \dfn X = x$    $(\alpha\supset\beta)^d \dfn \alpha \land \beta^d$, and $(\SET X = \SET x\cf\beta)^d \dfn \SET X = \SET x\cf\beta^d$.
%Some remarks about negations. First of all, in  $\CO$ we can inductively define a dual negation:
%\begin{itemize}
%\item $(X = x)^d$ is $X \neq x$ 
%\item $(X \neq x)^d$ is $X = x$ 
%\item $(\alpha \land \beta)^d$ is $(\psi^d \lor\beta^d)$
%\item $(\alpha \lor \beta)^d$ is $(\alpha^d \land \beta^d)$
%\item $(\alpha\supset\beta)^d$ is $\alpha \land \beta^d$
%\item $(\SET X = \SET x\cf\beta)^d$ is $\SET X = \SET x\cf\beta^d$
%\end{itemize} 
%The meaning of this negation is explained by the following theorem:

%\begin{theorem}
% Let $T = (T^-, \F)$ be a causal multiteam and $\alpha\in\CO$. Then $T\models \alpha^d$ iff, for all $s\in T^-$, $(\{s\},\F)\not\models  \alpha$. 
 
% In particular, for any assignment $s$, $(\{s\},\F)\models \alpha^d$ iff $(\{s\},\F)\not\models  \alpha$. Thus, \corrf{if $T$ is nonempty}, $P_T(\alpha^d) = 1-P_T(\alpha)$.
%\end{theorem} 





Next we introduce an extension of $\CO$ with \textbf{probabilistic atoms}
\[
\ \Pr(\alpha) \geq \epsilon \ | \ \Pr(\alpha) > \epsilon \ | \ \Pr(\alpha) \geq \Pr(\beta) \ | \ \Pr(\alpha) > \Pr(\beta)
\]
where $\alpha,\beta\in\CO$ and $\epsilon \in [0,1]\cap \mathbb{Q}$. The first two are called \textbf{evaluation atoms}, and the latter two \textbf{comparison atoms}. %A \emph{probabilistic literal} is either a probabilistic atom or a formula $\sim\hspace{-4pt}{\alpha}$, where $\alpha$ is a probabilistic atom.
Probabilistic atoms %without the contradictory negation $\sim$
 together with literals of $\CO$ are called \textbf{atomic formulae}.
The probabilistic language $\PCO$ is then given by the following grammar:
\[
\varphi::= \eta \mid \varphi \land \varphi \mid  \varphi \sqcup \varphi \mid \alpha\supset \varphi \mid \SET X = \SET x\cf \varphi,
\]
where $\SET X\subseteq \dom$, $\SET x \in \ran(\SET X)$, $\eta$ is an atomic formula, %$\CO$  literal (as in definition \ref{def: CO language}) or a probabilistic atom literal, $\psi,\chi$ are $\PCD$ formulae, and 
and $\alpha$ is a $\CO$ formula.
%
Note that the antecedents of $\supset$ and the arguments of probability operators are $\CO$ formulae.
%(and thus they may contain occurrences of $\lor$, but not of $\sqcup$ or $\Pr$). Outside of these contexts, $\sqcup$ is allowed while $\lor$ is not.
%
Semantics for the additional operators are given below:
\begin{align*}
&T\models \psi\sqcup \chi &&\text{iff}&& T\models \psi \text{ or } T\models \chi\\
&T\models \Pr(\alpha)\geq \epsilon  &&\text{iff}&& T^-=\emptyset \text{ or } P_T(\alpha)\geq \epsilon\\
&T\models \Pr(\alpha) > \epsilon  &&\text{iff}&& T^-=\emptyset \text{ or } P_T(\alpha) > \epsilon\\
&T\models \Pr(\alpha)\geq \Pr(\beta) &&\text{iff}&& T^-=\emptyset \text{ or } P_T(\alpha)\geq P_T(\beta)\\
&T\models \Pr(\alpha) > \Pr(\beta)  &&\text{iff}&& T^-=\emptyset \text{ or } P_T(\alpha) >  P_T(\beta),
\end{align*}
where $P_T(\alpha)$ is a shorthand for $P_{T^-}((T^\alpha)^-)$. 

The language $\PCO$ still has the empty team property %\commf{Recheck if we change the clauses for prob. atoms}
but it is not flat.
\footnote{It also lacks weaker properties considered in the team semantics literature, such as \emph{downward closure} and \emph{union closure}.}

The definability of the dual negation in $\CO$ allows us to introduce many useful abbreviations:
%\begin{multicols}{2}
%\noindent
\begin{align*}
\Pr(\alpha) \leq  \epsilon &\dfn\Pr(\alpha^d) \geq 1 - \epsilon \\ 
\Pr(\alpha) < \epsilon &\dfn \Pr(\alpha^d) > 1 - \epsilon\\
\Pr(\alpha) = \epsilon &\dfn \Pr(\alpha) \geq  \epsilon \land\Pr(\alpha) \leq  \epsilon\\
\Pr(\alpha) \neq  \epsilon &\dfn \Pr(\alpha) >  \epsilon \sqcup  \Pr(\alpha) <  \epsilon
\end{align*}
%\begin{align*}
%\bot &\dfn X = x\cf X \neq x\\
%\top &\dfn X = x \cf X = x.
%\end{align*}
%\end{multicols}
Furthermore, the $\supset$ operator %often
enables us to express some statements involving conditional probabilities, defined as follows (below $\vartriangleleft \hspace{3pt} \in \{\geq, >\}$): 
%
\begin{align*}
&T\models \Pr(\alpha\mid\gamma) \vartriangleright \epsilon  &&\hspace{-24pt}\text{iff}&& \hspace{-24pt}(T^\gamma)^- = \emptyset \text{ or } P_{T^\gamma}(\alpha) \vartriangleright \epsilon.\\
&T\models \Pr(\alpha\mid\gamma)\vartriangleright \Pr(\beta\mid\delta) &&\text{iff}&& (T^\gamma)^- = \emptyset \text{ or } (T^\delta)^- = \emptyset \\
& && && \text{ or } P_{T^\gamma}(\alpha) \vartriangleright P_{T^\gamma}(\beta).
\end{align*}
It was observed in \cite{BarSan2023} that $\Pr(\alpha\mid\gamma) \vartriangleright \epsilon$ and $\Pr(\alpha\mid\gamma)\vartriangleright \Pr(\beta\mid\gamma)$ can be defined by $\gamma \supset\Pr(\alpha) \vartriangleright \epsilon$ and $\gamma \supset\Pr(\alpha) \vartriangleright \Pr(\beta)$, respectively.
%\begin{itemize}
%    \item $T\models \Pr(\alpha\mid\gamma) \vartriangleright \epsilon$ iff $T\models \gamma \supset\Pr(\alpha) \vartriangleright \epsilon$
%    \item $T\models \Pr(\alpha\mid\gamma)\vartriangleright \Pr(\beta\mid\gamma)$ iff $T\models \gamma \supset\Pr(\alpha) \vartriangleright \Pr(\beta)$.
%\end{itemize}
Notice that the latter result concerns comparison atoms in which both probabilities are conditioned over the same formula, $\gamma$.
We will later show that this restriction is necessary, and that  $\Pr(\alpha\mid\gamma)\geq \Pr(\beta\mid\delta)$ is not, in general, expressible in $\PCO$.


%\begin{itemize}
%\item $T\models \psi\sqcup \chi$ if $T\models \psi$ or $T\models \chi$
%\item $T\models \Pr(\alpha)\geq \epsilon  \iff T^-=\emptyset \text{ or } P_T(\alpha)\geq \epsilon$
%\item $T\models \Pr(\alpha) > \epsilon  \iff T^-=\emptyset \text{ or } P_T(\alpha) > \epsilon$
%\item $T\models \Pr(\alpha)\geq \Pr(\beta) \iff T^-=\emptyset \text{ or } P_T(\alpha)\geq P_T(\beta)$
%\item $T\models \Pr(\alpha) > \Pr(\beta)  \iff T^-=\emptyset \text{ or } P_T(\alpha) >  P_T(\beta)$.
%\end{itemize}

%\commf{I think HERE we should briefly explain the relationship between $\supset$ and conditional probabilities; and mention that, in the companion paper, it is shown how it can be used in the definition of more complex causal-probabilistic statements.}

 



%\begin{itemize}
%\item $\Pr(\alpha) \leq  \epsilon$ for $\Pr(\alpha^d) \geq 1 - \epsilon$
%\item $\Pr(\alpha) < \epsilon$ for $\Pr(\alpha^d) > 1 - \epsilon$
%\item $\Pr(\alpha) = \epsilon$ for $\Pr(\alpha) \geq  \epsilon \land \Pr(\alpha) \leq  \epsilon$
%\item $\Pr(\alpha) \neq  \epsilon$ for $\Pr(\alpha) >  \epsilon \sqcup  \Pr(\alpha) <  \epsilon$
%\item $\Pr(\alpha)  \epsilon$
%\item $\Pr(\alpha)  \epsilon$
%\item $\bot$ for $X = x\cf X \neq x$
%$X=x \land X\neq x$
%\item $\top$ for $X = x \cf X = x$
%$\Pr(X=x)<1 \sqcup \Pr(X\neq x)<1$
%\end{itemize}
%whose semantics is as expected (and true by default on empty causal multiteams).
%\commf{The baroque definitions of $\bot$ and $\top$ are to ensure that 1) they are the contradictory negation of each other, and 2) they both are $\CO$ formulae, so that they can also occur under the $\Pr$ operator.}

We consider the following syntactic fragments of $\PCO$ (that preserve the syntactic restrictions yielded by its two level syntax). $\PP$ is the fragment without $\supset$ and $\cf$.
%the connectives $\land$, $\lor$, and $\clor$ together with literals, evaluation atoms, and comparison atoms.
$\PP^-$ is the fragment of $\PP$ without comparison atoms. $\PC$ and $\PO$ are fragments of $\PCO$ without $\supset$ and $\cf$, respectively.
%
Finally, $\PCO^\omega$ is the extension of $\PCO$ with countable disjunctions of the form
\(
\bigsqcup_{i\in I} \psi_i,
\)
where $\psi_i$ are $\PCO$ formulae.
%Note that $\PCO^\omega$ has $2^\omega$ formulae.  %\jonni{Rename $\PCO^\infty$ to $\PCO^\omega$.}
%\footnote{Note that adding infinitary conjunctions or allowing the free use of the strict tensor would not affect the expressivity of the language.\jonni{Is this relevant?}\commf{Not really. I think I added this when I tried to give an infinitary complete axiomatization for $\PCO^\infty$ (nasty open problem, by the way).}}

We will characterize the expressive power of each of these languages, and prove several strict inclusions among them, as illustrated in Figure \ref{fig:FIRSTCAUSALGRAPH}. %An arrow from language $\La$ to $\La'$ stands for the strict inclusion of the expressive power of $\La$ into that of $\La'$.

\begin{example}
Let $T = (T^-,\F)$ be a causal multiteam over variables $\mathrm{GroundSpeed}$, $\mathrm{DescentAngle}$, $\mathrm{ForceExcerted}$ and $\mathrm{StructuralIntegrity}$ depicting data related to landing an Airbus A350-900 aircraft. The structural equation $F_\mathrm{FE}(\mathrm{GS},\mathrm{DA})$ outputs the force excerted to the landing gear when a plane makes a landing at a given speed and angle. The multiteam component encodes a distribution of the expected structural integrity of the landing gear. The formula
\[
(\mathrm{GS}=300 \land \mathrm{DA}=4)\cf \Pr(\mathrm{FE} > \mathrm{SI})<0.01
\]
expresses that the probability of a failure of the landing gear is less than $1\%$ on a landing speed of $300km/h$ and descent angle of 4 degrees.
\end{example}

%and $\PPs$ that
%we will consider also the extension $\PCOs$. 

%Finally, we will consider an extension of $\PP$. The language $\PP^s$ extends $\PP$ with the possibility of using the tensor disjunction $\lor$ in an arbitrary context.







%\subsection{More languages}

%We will also consider the following fragments of $\PCO$:
%\begin{itemize}
%\item $\PC$, where the operator $\supset$ is not allowed.
%\item $\PO$, where the operator $\cf$ is not allowed.
%\item $\PP$, where neither $\supset$ nor $\cf$ are allowed.
%\item $\PP^-$, where furthermore comparison atoms are not allowed.
%\end{itemize}

%We will also consider an extension of $\PCO$. The language $\PCO^\infty$ allows for infinitary disjunctions of the form
%\[
%\bigsqcup_{i\in I} \psi_i
%\]
%where the $\psi_i$ are $\PCO^\infty$ formulae. A moment of reflection shows that the set of $\PCO^\infty$ formulae has cardinality $\beth_\omega$.

%Finally, we will consider an extension of $\PP$. The language $\PP^s$ extends $\PP$ with the possibility of using the tensor disjunction $\lor$ in an arbitrary context.





%\includegraphics[scale=0.5]{languageseparationgraph}
%\jonni{Correspoding lemmas etc. can be put above the arrows with tikz.}


%\subsection{Conditional probabilities}




%We can finally address a problem raised in the companion paper \cite{BarSan2023}, whether the ``cross-comparison'' atoms are expressible in $\PCO$ or not.\commf{Maybe we should anticipate the issue in the introduction?} A cross-comparison is an expression of the form  
%\[
%\Pr(\alpha \mid \beta)\vartriangleleft \Pr(\gamma \mid \delta)
%\]
%whose semantics is given by the condition
%\begin{itemize}
%    \item $T\models \Pr(\alpha \mid \beta)\vartriangleleft \Pr(\gamma \mid \delta)$ iff 
%\end{itemize}







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Expressive power}\label{sec: expressive power}

%similarly we define $\K^\sigma_\Gamma$ for a set $\Gamma$ of formulae of signature $\sigma$.\commf{Actually, all definability results after the first two are expressed in terms of definability by a single formula. Maybe omit definability by a set of formulae?}


The following characterization of $\CO$ was proved in \cite[Theorem 4.4]{BarYan2022} %\commf{Or we could quote Theorem 4.4 from the journal version} 
in the context of causal team semantics. Since $\CO$ cannot differentiate causal multiteams with the same causal team support, the analogous result in the multiteam context follows; see the appendix %\ref{Appendix: expressivity of CO}
for details.

\begin{theorem}[Characterization of $\CO$]\label{thm:COchar}
Let $\sigma$ be a finite signature, and $\K$ a class of causal multiteams of signature $\sigma$. Then $\K$ is definable by a $\CO_{\sigma}$ formula (resp. a set of $\CO_{\sigma}$ formulae) if and only if $\K$ is flat.
%\begin{enumerate}
%\item $\K$ is flat.
%\item $\K$ is support-closed. 
%\end{enumerate}
\end{theorem}


%\commf{Commented out some unused notations, e.g. equivalence classs of extended assignments -- they are used in the omitted tensor case of \ref{lemma: closure under rescaling}.}
%We now want to characterize the expressive power of some probabilistic languages.

%We introduce a few notational conventions. \commf{These notations should probably occur at the beginning of the note and be applied systematically} We write $\A_\sigma$ for the set of all assignments of signature $\sigma$\corrf{, i.e. (writing $\sigma=(\dom, \ran)$) assignments $s$ of domain $\dom \cup Key$ with $s(X)\in \ran(X)$ for each $X\in \dom$, and $s(Key\in \mathbb{N})$}. Now remember that a multiteam of signature $\sigma = (\dom,\ran)$ is a set of assignments of domain $\dom \cup \{Key\}$. We will often denote multiteams by $R^-,S^-, T^-$ to emphasize when we are not talking about \emph{causal} multiteams.    Given $s,t\in \A_\sigma$, we write $s\equiv t$ in case $s$ and $t$ disagree only about the value of $Key$, i.e. if $s_{\upharpoonright \dom} = t_{\upharpoonright \dom}$. In such case, $s$ and $t$ are thought of as two \emph{copies} of the same assignment. We will denote the equivalence class of $s$ in a multiteam $T^-$ under $\equiv$ as follows:
%\[
%[s]_{T^-} = \{t\in T^- \mid t \equiv s\} .
%\]
%If $T=(T^-, \F)$ is a causal multiteam, we will also use the notation $[s]_{T}$. 
%For the cardinality of $[s]_{T^-}$ we may also write $\#(s,T^-)$. 
%Finally, given an assignment $s\in \A_\sigma$ and a multiteam $T^-$ of the same signature, we write $\epsilon_s^{T^-}$ for the probability of that assignment in $T^-$, i.e.:
%\[
%\epsilon_s^{T^-}:= \frac{|[s]_{T^-}|}{|T^-|} = \frac{\#(s,T^-)}{|T^-|}.
%\]
%\corrf{We will occasionally also use the notation $\epsilon_s^{T^-}$ when $s = t_{\upharpoonright \dom}$ for some $t\in T^-$.}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Expressivity of an infinitary language}\label{subs: expressivity of an infinitary language}

 $\PCO$ is a purely probabilistic language; it cannot tell apart multiteams representing the same distribution. Given an assignment $t$ and a team $T = (T^-,\F)$, we write $\#(t,T)$ for the number of copies of $t$ in $T^-$.
 %\footnote{That is, the cardinality of the set $\{t\in \A_\sigma \mid t_{\upharpoonright \dom} =s\}$.}
 We can then talk of the probability of $t$ in $T$, $\epsilon_t^T := \frac{\#(t,T)}{|T^-|}$. We say that two causal teams $S =   (S^-,\F)$, $T=(T^-,\G)$ are \textbf{rescalings} of each other ($S\sim T$) if $\F=\G$ and either $S^- = T^- = \emptyset$ or $\epsilon_t^T =\epsilon_t^S$, for each assignment $t$.
A class $\K$ of causal multiteams of signature $\sigma$ is \textbf{closed under rescaling} if, whenever $S\in \K$ and  $S \sim T$, also $T\in \K$.


An ideal language for purely probabilistic reasoning should be characterized just by this condition. It turns out that $\PCO$ is not expressive enough for the task, however its extension with countable global disjunctions $\PCO^\omega$ is.


\begin{theorem}[\!\!\cite{BarSan2023}]\label{theorem: expressivity of PCOinf}
A \emph{nonempty} class $\K$ of multiteams of signature $\sigma$ is definable in %by a (set of)
 $\PCO^{\omega}_{\sigma}$ %formula(s)
% (either by a formula or a set of formulae)
  iff $\K$ has the empty multiteam property and is closed under rescaling.
\end{theorem}

\noindent The key to the proof is the fact that
for any causal multiteam $(T^-, \F)$ one can write $\PCO$-formulae $\Theta_{T^-}$ and $\Phi^\F$ that characterize the properties of having team component $T^-$ (up to rescaling) and function component $\F$, respectively.
A class $\K$ of causal multiteams is then defined by the formula $\bigsqcup_{(T^-,\F)\in \K }(\Theta_{T^-} \land \Phi^\F)$.
%
The proof crucially depends on the use of infinitary disjunctions and gives us no hints on how to obtain a finitary logic with such expressivity. Actually, a counting argument given in \cite{BarSan2023} shows that such a language must be uncountable, and thus that $\PCO < \PCO^\omega$. Our characterization of the expressivity of $\PCO$ will provide an alternative proof for the strict inclusion.  
%We are however able to characterise the expressivity of $\PCO$ and its fragments that we defined in Section \ref{sec: preliminaries}.

%For $\Phi^\F$, we may directly use the formulation 
% of \cite{BarYan2022} written in $\CO_{\sigma}$, since their formula is a $\PCO$-formula as well. The formula
% $\Theta_{T^-}$ can be defined as $\bigwedge_{s\in \B_\sigma} \Pr\Big(\bigwedge_{V\in \dom} V = s(V)\Big)= \epsilon_s^{T^-}$. The fact that every $\PCO^{\omega}_{\sigma}$-definable class is closed under rescaling can be proved by induction on the structure of formulae. For details see Appendix \ref{Appendix: infinitary PCO}.

$\PP^-$, $\PP$, and $\PO$ cannot tell apart different causal structures, since they do not feature $\cf$. Hence we require the following invariance:
\begin{definition}
 A class $\K$ of causal multiteams of signature $\sigma$ is \textbf{closed under change of laws} if, whenever $(T^-,\F)\in \K$ and $\G$ is a system of functions of signature $\sigma$, $(T^-,\G)\in\K$.  
\end{definition}

It is self-evident that the logics without $\cf$ are closed under changes of laws, while the logics with access to $X=x \cf Y=x$ are not.

\begin{lemma}\label{lemma:trivial laws}
$\PP^-$, $\PP$, and $\PO$ are closed under change of laws. $\PCO$, $\PC$, and $\CO$ are not closed under change of laws.
\end{lemma}
\begin{corollary}\label{cor: easy comparisons}
$\PP < \PC$, $\PO < \PCO$, and $\PC\not\leq \PO$.%\commf{$\PO\not\leq \PC$ follows... it should use the fact that $\PC$ only characterizes signed monic probability sets, while $\PO$ allows for signed binary (together with the definability of unction components). Maybe we did not prove it explicitly anywhere. It should build easily, I think, on Lemma \ref{lemma: not all linear are signed monic}.}\commf{Added now as Corollary \ref{cor: PO not included in PC}.}
\end{corollary}

\subsection{Purely probabilistic fragments of $\PCO$}\label{subs: Expressivity probabilistic}

%We prove here the characterizations of the fragments $\PP^-$ and $\PP$, and show that $\PP^-<\PP$. 
 
Next we characterize the expressivity of $\PP$ and $\PP^-$ by investigating the families of subsets of $\Q^n$ that are definable in the logics.
%Let us first consider the following purely probabilistic fragment $\PP^-$
%We will call \textbf{classical formulae} those defined by the following grammar:
% \[
%\eta::=  X =  x  \mid X \neq x \mid \eta \land \eta \mid  \eta \lor \eta. 
% \] 
%The fragment $\PP^-$ is then defined by the clauses:
% \[
%\varphi::=  X = x  \mid X \neq x \mid P(\eta)\geq \epsilon \mid P(\eta) >  \epsilon \mid \varphi \land \varphi \mid  \varphi \sqcup \varphi 
% \]
 %where $\eta$ is a classical formula. We can also consider a slightly more general language $\PP$, obtained by allowing the use of comparison atoms, i.e. atoms of the form $P(\eta)\vartriangleright P(\eta')$ ($\vartriangleright= \geq$ or $>$).
 %One method for describing the limitations of these languages is to look at what kind of probabilities they can define. More precisely,
 For a given signature $\sigma$, we fix an enumeration $s_1,\dots,s_n$ of the assignments of $\B_\sigma$; every \emph{nonempty} causal multiteam $T$ can then be associated with a \textbf{probability vector} $\pvec_{T}=(\epsilon_{s_1}^T, \dots , \epsilon_{s_n}^T)\in \mathbb Q^n$.
 %listing the probabilities of each assignment in $T$.
 Similarly, a class $\K$ of causal multiteams of signature $\sigma$ has an associated \textbf{probability set}  $\Pvec_\K = \{\pvec_T \mid T\in\K, T \text{ nonempty }\}$.
 %A moment of thought shows that, since we are talking of vectors of probabilities, 
 Note that $\pvec_{T}$ and $\Pvec_\K$ are, respectively,  a point and a subset of the \textbf{standard $n-1$-simplex} $\Delta^{n-1}$ (i.e. the set of points of $[0,1]^n\cap \mathbb Q^n$ that satisfy the equation $\epsilon_{s_1} + \dots + \epsilon_{s_n} =1$), respectively. 
 Each formula $\varphi$ can be associated with the probability set $\Pvec_\varphi:= \Pvec_{\K_\varphi}$.
 Note that if $S,T$ are causal multiteams of the same signature and same function component, such that $\pvec_S = \pvec_T$, then  $S$ is a rescaling of $T$.
 %
Similarly, a class $\K$ of causal multiteams of signature $\sigma$ that is closed under change of laws and rescaling is the largest class of causal multiteams of signature $\sigma$ having probability set $\Pvec_\K$.
 %
 We characterize precisely which probability sets are definable in terms of $\PP^-$ and $\PP$. 
 %Such geometrical spaces are defined  by specific kinds of linear inequalities.
 
 A \textbf{linear inequality} is an expression of the form
 \[
a_1\epsilon_1 +\dots+ a_n\epsilon_n \vartriangleleft b,
 \] 
where $\vartriangleleft \hspace{3pt} \in \{\geq,\leq,>,<\}$, $a_1,\dots,a_n,b\in\mathbb Q$, and $\epsilon_1,\dots \epsilon_n$ are variables (in the usual algebraic sense). A linear inequality is \textbf{signed monic} if each of the $a_i$ is in $\{0,1,-1\}$. It is \textbf{monic} if each of the $a_i$ is in $\{0,1\}$. 
A probability sets $\Pvec$ is \textbf{(signed) monic} if it is a finite union of subsets of $\Delta^{n-1}$ defined by finite systems of (signed) monic inequalities.
%We apply the same terminology to classes of causal multiteams of a fixed signature, as follows: 
A class $\K$ of causal multiteams of a fixed signature is \textbf{(signed) monic} if $\Pvec_\K$ is a (signed) monic probability set. 
%\begin{itemize}
%\item $\K$ is \textbf{(signed) monic} if $\Pvec_\K$ is a (signed) monic probability range. %the finite union of set of points in $\Delta^{n-1}$ that are characterized by systems of (signed) monic inequalities. 
%\end{itemize}
%\commf{In have also been using a slightly more complicated terminology using the words polytope/semipolytopes. It was not completely equivalent, I found out; I am rechecking everything, but you might still find inconsistencies.} 

%We will also use the following auxiliary terminology. 
A subset $\Pvec$ of $\Delta^{n-1}$
is a \textbf{$(\sigma-)$polytope} if
it is defined by a finite system of linear inequalities using only $\leq$ and $\geq$.


 
%\noindent Notice in particular that this condition implies the empty multiteam property.\commf{No, this looks wrong}



%We then have two characterization results. \commf{All these results have pretty similar statements, but each of them did require some ingenuity to prove.}



%\begin{theorem}\label{thm: characterization of P}
%A class $\K$ of multiteams of signature $\sigma$ is definable
%%by a formula of 
%in $\PP$ if and only if
%$\K$ is signed monic and closed under change of laws and rescaling.
%\begin{enumerate}
%\item $\K$ is closed under change of laws
%\item $\K$ is closed under rescaling, and
%\item $\K$ is signed monic.
%\end{enumerate} 
%\end{theorem}

We will show that a being monic and closed under change of laws and rescaling characterizes 
expressibility in $\PP^-$, whereas being signed monic and closed under change of laws and rescaling characterizes 
expressibility in $\PP$ instead.
It is not immediate to see whether $\PP^- \leq \PP$ is strict. However, by analyzing the geometry of $\Delta^{n-1}$ we are able show that there are signed monic classes of causal multiteams that are not monic; thus $\PP^-<\PP$. The details are at the end of this section.
 
 
%The previous theorem tells us that, in a sense, the language $\PCO^{\omega}$ allows one to define all finitary probability functions over the set of assignments of a given signature; we need to understand how the definability of such functions is restricted in $\PCO$. We will work towards an understanding of the expressivity of a small fragment $\PP$ of  $\PCO$. %

 %This is essentially the fragment that allows for mere probabilistic reasoning. We will call \textbf{classical formulae} those defined by the following grammar:
 %\[
%\eta::=  X =  x  \mid X \neq x \mid \eta \land \eta \mid  \eta \lor \eta. 
% \] 
%The fragment $\PP^-$ is then defined by the clauses:
% \[
%\varphi::=  X = x  \mid X \neq x \mid P(\eta)\leq \epsilon \mid P(\eta)\geq \epsilon \mid P(\eta) < \epsilon \mid P(\eta) >  \epsilon \mid \varphi \land \varphi \mid  \varphi \sqcup \varphi. 
% \]
% The language $\PP$ is obtained when we extend $\PP^-$ with the possibility of using comparison atoms, i.e. atoms of the form $P(\eta)\vartriangleleft P(\theta)$ (with $\vartriangleleft = \leq,\geq,<,>$ and $\eta,\theta\in\CO$).  Notice that, in both $\PP^-$ and $\PP$, we allow for $\lor$ inside probability statements, and $\sqcup$ outside. 
 
%  closure under equivalence and polarization.\commf{After changing the defs of atoms, I think polarization is to be replaced by the empty team property.}
  
%It is straightforward to prove (cp. \cite{BarYan2022}) the following:

%\begin{lemma}\label{lemma: P closed under change of laws}
%Let $\varphi$ be a formula of $\PP$. Then $\K_\varphi$ is closed under change of laws.
%\end{lemma}




\begin{comment}
\commf{The following quarantined part is redundant and partially inconsistent with the definitions given above. I am keeping it just so that we can check what has changed.}

*********************************************************

 The next restriction we are aiming to define is instead of geometrical nature. In the following, instead of the set $\A_\sigma$ of assignments of domain $\dom\cup\{Key\}$, we focus on the set $\B_\sigma$ of their restrictions to $\dom$.

\begin{definition}
Let $\sigma=(\dom,\ran)$ be a (finite) signature; then we can enumerate the set $\B_\sigma$ of assignments $V\in \dom\mapsto \ran(V)$ of signature $\sigma$ as $\{s_1,\dots,s_n\}$. Given a causal team $T$ of signature $\sigma$, its \textbf{probability vector} $\pvec_{T}$ is the tuple $(\epsilon_{s_1}^T, \dots , \epsilon_{s_n}^T)\in \mathbb Q^n$ listing the probabilities of each assignment in $T$.
\end{definition}

Notice that, in any case, if $\pvec_{T}= (\epsilon_{s_1}^T, \dots , \epsilon_{s_n}^T)$ is the probability vector of a causal multiteam $T$, it will satisfy the equality $\epsilon_{s_1}^T + \dots + \epsilon_{s_n}^T =1$. In other words, it is a point of the \textbf{standard $n-1$-simplex} $\Delta^{n-1}$, the set of points of $[0,1]^n\cap \mathbb Q^n$ that satisfy the equation $\epsilon_{s_1} + \dots + \epsilon_{s_n} =1$.

\begin{definition}
Given a class $\K$ of causal multiteams of signature $\sigma$, the ($\sigma$-)\textbf{probability range} of $\K$, denoted $\Pvec_\K$, is the set $\{\pvec_T \mid T\in\K\} \subseteq \Delta^{n-1}$.     % [0,1]^n\cap \mathbb Q^n$. 
The ($\sigma$-)\textbf{probability range} of a formula $\varphi\in\CO_{\sigma}$, denoted $\Pvec_\varphi$, is the set $\Pvec_{\K_\varphi}$.
\end{definition}

\begin{definition}
A $\sigma$-\textbf{polytope} is a subset of $\Delta^{n-1}$ %$[0,1]^n\cap \mathbb Q^n$
 defined by a finite number of linear inequalities of the form $a_1 \epsilon_1 + \dots a_n \epsilon_n \leq b$ or
 $a_1 \epsilon_1 + \dots a_n \epsilon_n \geq b$ ($a_i,b\in\mathbb Q$) (in the sense that a tuple $\overline \epsilon$ is in the polytope iff replacing $\overline \epsilon$ for $(\epsilon_1,\dots,\epsilon_n)$ makes all the inequalities true). It is \textbf{signed monic} if each of the $a_i$ is either $0,1$ or $-1$. It is \textbf{monic} if each of the $a_i$ is either $0$ or $1$. 
 
More generally, a $\sigma$-\textbf{semipolytope} is a subset $\Pvec$ of $\Delta^{n-1}$  %$[0,1]^n\cap \mathbb Q^n$
 of the form $\Pvec_1 \setminus (\Pvec_2 \cup \dots \cup \Pvec_k)$, where the $\Pvec_i$ are $\sigma$-polytopes. 
%\commf{Do we need to require P1 to be of greater dimension?}
 In case the $\Pvec_i$ are all (signed) monic, we say that $\Pvec$ is (signed) monic.
\end{definition}

\begin{definition}
A class $\K$ of causal multiteams of signature $\sigma$ is \textbf{monic} if $\Pvec_\K$ is a finite union of monic semipolytopes. It is \textbf{signed monic} if $\Pvec_\K$ is a finite union of signed monic semipolytopes.
\end{definition}



\commf{END QUARANTINE}

**************************************************
\end{comment}


%\begin{lemma}\label{lemma: preserve polytopes}
%\begin{enumerate}
%\item If $\Pvec$ is a (signed, monic) polytope, then its complement in $\Delta^{n-1}$ %$\mathbb Q^n\cap [0,1]$
% is a (signed, monic) semipolytope.

%\item If $\Pvec,\Qvec$ are (signed, monic) semipolytopes, then also $\Pvec \cap \Qvec$ is.

%\item If $\Pvec,\Qvec$ are finite unions of (signed, monic) semipolytopes, then also $\Pvec \cap \Qvec$ is.
%\end{enumerate}
%\end{lemma}

\begin{lemma}\label{lemma: preserve polytopes}
%\begin{enumerate}
%\item
1) If $\Pvec$ is a monic (resp. signed monic) %signed (resp. monic)
polytope, then its complement in $\Delta^{n-1}$ %$\mathbb Q^n\cap [0,1]$
 is monic (resp. signed monic).
%\item
2) If $\Pvec,\Qvec$ are monic (resp. signed monic), then also $\Pvec \cup \Qvec$ is.
%\item
3) If $\Pvec,\Qvec$ are monic (resp. signed monic, polytopes), %signed (resp. monic, polytopes),
then also $\Pvec \cap \Qvec$ is.
%\item If $\Pvec,\Qvec$ are finite unions of (signed, monic) semipolytopes, then also $\Pvec \cap \Qvec$ is.
%\end{enumerate}
\end{lemma}


\begin{IEEEproof}
1) %$\Delta^{n-1}$ %$\mathbb Q^n\cap [0,1]$
 %is defined by the empty set of inequalities, and is thus a monic polytope. Thus $\Delta^{n-1} \setminus \Pvec$ is a (signed, monic) semipolytope.
Since $\Pvec$ is a polytope, a point is in $\Pvec$ iff it is a solution to a finite system of monic (resp. signed monic) inequalities $e_1,\dots,e_m$, where each $e_i$ is either of the form $a^i_1 \epsilon_1 + \dots + a^i_{k(i)} \epsilon_{k(i)} \geq b^i$ or $a^i_1 \epsilon_1 + \dots + a^i_{k(i)} \epsilon_{k(i)} \leq b^i$.
We denote by $\overline e^i$ the inequality obtained from $e^i$ by replacing $\geq$ with $<$ and $\leq$ with $>$. Each $\overline e^i$ defines a monic (resp. signed monic) set $\Qvec_i$. Now, a point is \emph{not} in $\Pvec$ iff it satisfies $\overline e^i$ for some $i$, iff it is an element of $\Qvec_1\cup\dots\cup\Qvec_m$.  The latter is monic (resp. signed monic) by construction. 

2) Observe that the union of two finite unions of monic (resp. signed monic) sets is still a finite union of monic (resp. signed monic) sets. 

3) First consider two sets $\Pvec$, $\Qvec$ defined by single finite systems $A$, resp. $B$ of inequalities.  Then their intersection is defined by the single system $A\cup B$. In particular, the intersection of two polytopes is a polytope. 

%Secondly, intersection preserves the property of being a (signed, monic) semipolytope. Indeed take two such sets; say, $\Pvec\setminus(\Pvec_1 \cup\dots\cup\Pvec_m)$ and $\Qvec\setminus(\Qvec_1\cup\dots\cup\Qvec_n)$, where $\Pvec,\Qvec,\Pvec_i,\Qvec_j$ are all (signed, monic) polytopes. Then their intersection is $(\Pvec\cap\Qvec)\setminus(\Pvec_1 \cup\dots \cup\Pvec_m \cup \Qvec_1\cup\dots\cup\Qvec_n)$. Since, by the previous point, $\Pvec\cap\Qvec$ is a (signed, monic) polytope, the whole set is a (monic) semipolytope.

Then, consider two finite unions $\Pvec_1 \cup\dots\cup\Pvec_m$ and $\Qvec_1\cup\dots\cup\Qvec_n$ of probability sets, and assume that each of  the $\Pvec_i$ and $\Qvec_i$ is monic (resp. signed monic). 
 Then their intersection is $\bigcup_{\substack{ i=1\dots m \\ j = 1\dots n }} (\Pvec_i \cap \Qvec_j)$. By the previous point and 2., this is again a monic (resp. signed monic) set.
%\commf{Are all points clear?}
\end{IEEEproof}

\begin{lemma}\label{lemma: P minus is monic}
If $\varphi\in\mathcal P^-_{\sigma}$, then $\K_\varphi^\sigma$ is monic.
\end{lemma}

\begin{IEEEproof}
We proceed by induction on $\varphi$ and restrict attention to nonempty causal multiteams $T$ of signature $\sigma$. %We stipulate that $\dom=\{X_1,\dots,X_m\}$.

The cases for $\land$ and $\sqcup$ follow directly from Lemma \ref{lemma: preserve polytopes} and the induction hypotheses, since $\Pvec_{\psi\land\chi}= \Pvec_\psi \cap \Pvec_\chi$ and $\Pvec_{\psi\sqcup\chi}= \Pvec_\psi \cup \Pvec_\chi$.
%
The case for $\varphi = \Pr(\alpha)\geq \epsilon$ follows from the following chain of equivalences: $T\in \K_\varphi^\sigma$ iff $\frac{|(T^\alpha)^-|}{|T^-|} \geq \epsilon$ iff $\sum_{s\in \Team((T^\alpha)^-)} \epsilon_s^T \geq \epsilon$, since the last inequality defines a monic polytope. 


The cases for $\varphi: X=x$ (resp. $\varphi: X \neq x$) can be seen as a special case of the previous one, since these formulas are equivalent to $\Pr(X=x)\geq 1$ (resp. $\Pr(X \neq x)\geq 1$) and thus they have the same monic probability sets. 


In the case for $\varphi = \Pr(\alpha) > \epsilon$, analogous calculations as above show that the probability set of $\varphi$ is the set of solutions of the monic inequality $\sum_{s\in \Team((T^\alpha)^-)} \epsilon_s^T > \epsilon$.


%For what regards the case when $\varphi$ is $\Pr(\alpha)>\epsilon$, notice that $\K_\varphi^\sigma$ is the complement of $\K_\theta^\sigma$, where $\theta$ is $\Pr(\alpha)\leq\epsilon$. Since $\PP^-$ is closed under change of causal laws, this entails that $\Pvec_\varphi = \Delta^{n-1} \setminus \Pvec_\theta$. But then, since by a reasoning analogous to the above $\Pvec_\theta$ is characterized in $\Delta^{n-1}$ by the inequality $\sum_{s\in (T^\alpha)^-} \epsilon_s^T \geq \epsilon$, we have that $\Pvec_\varphi$ is characterized by $\sum_{s\in (T^\alpha)^-} \epsilon_s^T > \epsilon$.

%Finally, we cover the case where $\varphi$ is $X_i=x$ (the case for $X_i\neq x$ is analogous). Now,  $T\in \K_\varphi^\sigma$ $\iff$ $T^-$ contains no assignments $s$ with $s(X_i)\neq x$ $\iff$  $s(X_i)\neq x$ implies $\epsilon_s^T=0$. Therefore, assignments with $s(X_i) = x$ can occur with arbitrary frequency in the multiteams of $\K^\sigma_\varphi$. Thus, modulo a reordering of the factors,
%\[
%\Pvec_{\K_\varphi} = \Delta^{n-1} \cap (\prod_{\substack{s\in \B_\sigma \\ s(X_i)\neq x}} \{0\}   \times   \prod_{\substack{s\in \B_\sigma \\  s(X_i) = x}} [0,1]).
%\]
%This is a monic polytope, since it is defined by inequalities of the form $\epsilon_s\leq 0$ (for each $s$ such that $s(X_i)\neq x$).

%Case $\varphi$ is $\Pr(\alpha)>\epsilon$. Now $\K_\varphi^\sigma$ is the complement in $\Delta^{n-1}$ %$\mathbb Q^n\cap [0,1]$
% of the monic polytope described in the previous case; it is therefore (by Lemma \ref{lemma: preserve polytopes}, 1.) a monic set.

%Case $\varphi$ is $\psi \land \chi$. By the inductive hypothesis, both $\Pvec_\psi$ and $\Pvec_\chi$ are monic sets. By Lemma \ref{lemma: preserve polytopes}, 3., also $\Pvec_{\psi\land\chi}= \Pvec_\psi \cap \Pvec_\chi$ is a monic set. 

%Case $\varphi$ is $\psi \sqcup \chi$. Then $\Pvec_{\psi\sqcup\chi}= \Pvec_\psi \cup \Pvec_\chi$ is a  monic by the inductive hypothesis and Lemma \ref{lemma: preserve polytopes}, 2.

%\commf{I think that this result cannot be extended to $\lor,\supset,\cf$. Maybe its relaxation to non-monic inequalities works for $\supset,\lor^\textsf{s}$.}

%\commf{But maybe it can be extended to $\lor^\textsf{s}$?}

\end{IEEEproof}

\begin{lemma}\label{lemma: P is signed monic}
If $\varphi\in\mathcal P_{\sigma}$, then $\K_\varphi^\sigma$ is signed monic.
\end{lemma}

\begin{IEEEproof}
The proof, by induction on $\varphi$, proceeds as in the previous lemma. We cover the missing cases. Again, we restrict $T$ for nonempty causal multiteams.
%of signature $\sigma$.

Let $\varphi$ be $\Pr(\alpha)\geq \Pr(\beta)$.  Then $T\in \K_\varphi^\sigma$ iff $\frac{|(T^\alpha)^-|}{|T^-|} \geq \frac{|(T^\beta)^-|}{|T^-|}$ 
%$|(T^\alpha)^-| \geq |(T^\beta)^-|$ 
 iff $\sum_{s\in \Team((T^\alpha)^-)} \epsilon_s^T + \sum_{s\in \Team((T^\beta)^-)} (-1) \cdot \epsilon_s^T \geq 0$. The final inequality defines a signed monic polytope.

Let $\varphi$ be $\Pr(\alpha)> \Pr(\beta)$. By the same calculations as above, a causal multiteam $T$ satisfies this formula iff $\Pvec_T$ is characterized by the signed monic inequality $\sum_{s\in (T^\alpha)^-} \epsilon_s^T + \sum_{s\in (T^\beta)^-} (-1) \cdot \epsilon_s^T > 0$.
%
%Let $\theta$ be formula $\Pr(\beta) \geq \Pr(\alpha)$. 
%By the previous case $\Pvec_\theta^\sigma$ is a signed monic polytope. $\Pvec_\varphi^\sigma$ is the complement in $\Delta^{n-1}$ %$\mathbb Q^n\cap [0,1]$
% of $\Pvec_\theta^\sigma$; it is therefore (by Lemma \ref{lemma: preserve polytopes}, 1.) a signed monic set.
\end{IEEEproof}

%The following (straightforward) lemma shows that probability ranges ``almost characterize''  multiteams.

%\begin{lemma}\label{lemma: equal probability vector}
%Let $S,T$ be causal multiteams of signature $\sigma$, and suppose $\pvec_S = \pvec_T$. Then either $S^-$ is a rescaling of $T^-$, or $S^- = T^- = \emptyset$. 
%\begin{itemize}
%%\item $S\approx T$
%%\item $S$ is a rescaling of $T$
%\item $S^-$ is a rescaling of $T^-$
%\item $S^- = T^- = \emptyset$.
%\end{itemize}
%\end{lemma}

%\begin{lemma}\label{lemma: maximum class}
%Let $\K$ be a class of causal multiteams of signature $\sigma$ that is closed under change of laws and rescaling. Then $\K$ is the largest class of causal multiteams of signature $\sigma$ having probability range $\Pvec_\K$.
%\end{lemma}

%\begin{IEEEproof}
%Let $T=(T^-,\F)$ be a causal multiteam of signature $\sigma$ such that $\pvec_T\in \Pvec_\K$; then there is a causal multiteam $S=(S^-,\G)\in\K$ such that $\pvec_S=\pvec_T$. We will show that $T$ must belong to $\K$.  By Lemma \ref{lemma: equal probability vector}, either  $S^- = T^- = \emptyset$ or $S^-$ is a rescaling of $T^-$. In the former case, since $\K$ is closed under change of laws,  $T\in\K$. In the latter case, since $\K$ is closed under rescaling, we have $(T^-,\G)\in\K$. Thus, by closure under change of laws, $T=(T^-,\F)\in\K$.
%\end{IEEEproof}

%\begin{theorem}\label{thm: characterization of P}
%A class $\K$ of multiteams of signature $\sigma$ is definable by a formula of $\PP^-$ if and only if: 
%\begin{enumerate}
%\item $\K$ is closed under change of laws
%\item $\K$ is closed under rescaling, and
%\item $\K$ is monic.
%\end{enumerate} 
%\end{theorem}

%We introduce a notation that we will often use in the following. 
Recall that $\SET W$ is an ordered list of all the variables in $\dom$ and that we fixed an enumeration $s_1,\dots,s_n$ of the assignments in $\B_\sigma$. For each $i\leq n$, we write $\Al_i$ for the formula $\SET W = s_i(\SET W)$. We can now prove the characterization theorems for $\PP^-$ and $\PP$.

\begin{theorem}\label{thm: characterization of P}
A class $\K$ of multiteams of signature $\sigma$ is definable
%by a formula of
in $\PP^-$ if and only if
$\K$ is monic, has the empty multiteam property, and is closed under change of laws and rescaling.
$\K$ is definable in $\PP$ if and only if
$\K$ is signed monic, has the empty multiteam property, and closed under change of laws and rescaling.
%\begin{enumerate}
%\item $\K$ is closed under change of laws
%\item $\K$ is closed under rescaling, and
%\item $\K$ is monic.
%\end{enumerate} 
\end{theorem}
\begin{IEEEproof}


\emph{Characterizing $\PP^-$.}  Suppose first that $\K$  is definable by a formula $\varphi$ of $\PP^-$.
Since $\varphi\in\PCO$, it follows by Theorem \ref{thm: CO flatness}, Theorem \ref{theorem: expressivity of PCOinf}, and Lemmas \ref{lemma:trivial laws} and \ref{lemma: P minus is monic} that $\K$ has the empty multiteam property, is closed under rescaling and change of laws, and is monic, respectively.
%so, by Theorem \ref{theorem: expressivity of PCOinf}, $\K$ is %polarized and
% closed under %equivalence and
%  rescaling. By Lemma \ref{lemma: P closed under change of laws}, $\K$ is closed under change of laws. By Lemma \ref{lemma: P minus is monic}, $\K$ is monic.

Suppose then that $\K$ has all the four listed properties. Since it is monic, $\Pvec_\K$ is the union of the solution sets of a finite number $m$ of finite systems $A_1,\dots,A_m$ of inequalities. 
For each $A_j$, let us index its inequalities by a finite set $I_j$.
%Write $I_1,\dots,I_m$ for index sets for $S_1,\dots,S_m$ respectively.


For each inequality $e_i \dfn a_1^i\epsilon_1 + \dots + a_n^i\epsilon_n \vartriangleleft b^i$ in $A_j$, if $b^i \in [0,1]$ define
\[
\psi_i \dfn \Pr(\bigvee_{s_k \in \B_\sigma \mid a_k^i = 1} \Al_k) \vartriangleleft b^i. 
\]
%\[
%\psi_i: P(\bigvee_{s_k \in \B_\sigma \mid a_k^i = 1} \bigwedge_{X\in \dom} X = s_k(X) ) \vartriangleleft b^i. 
%\]
If $b<0$ and $\vartriangleleft \hspace{3pt} \in\{<,\leq\}$, or $b>1$ and $\vartriangleleft \hspace{3pt} \in\{>,\geq\}$, let $\psi_i \dfn \bot$. If $b<0$ and $\vartriangleleft \hspace{3pt} \in \{>,\geq\}$, or $b>1$ and $\vartriangleleft \hspace{3pt} \in\{<,\leq\}$, let $\psi_i \dfn\top$. %\jonni{Changed a $\bot$ to $\top$ here.}  
%\commf{Rewrite everywhere $\bigwedge_{X\in \dom} X = s_j(X)$ as $\SET A=s_j(\SET A)$ or as $\alpha_j$}
Finally, let $\varphi \dfn \bigsqcup_{j= 1..m} \bigwedge_{i\in I_j} \psi_{i}$.

Since the formulae $\Al_k$ 
%$\bigwedge_{X\in \dom} X = s(X)$ (as $s$ varies in $\A_\sigma$)
describe disjoint events, the probability of $\bigvee_{s_k \in \B_\sigma \mid a_k^i = 1} \Al_k$
%$\bigvee_{s_j \in \B_\sigma \mid a_j^i = 1} \bigwedge_{X\in \dom} X = s_j(X)$ 
is the sum $a_1^i\epsilon_1^T + \dots + a_n^i\epsilon_n^T$ of the probabilities of the formulae $\Al_k$.
%$\bigwedge_{X\in \dom} X = s_j(X)$,
Thus, a causal multiteam $T$ of signature $\sigma$ satisfies $\psi_i$ iff $a_1^i\epsilon_1^T + \dots + a_n^i\epsilon_n^T \vartriangleleft b^i$; and thus, $T\models\varphi$ iff $\pvec_T\in\Pvec_\K$. Since $\K$ is closed under change of laws and rescaling, and it has the empty multiteam property, 
%, by Lemma \ref{lemma: maximum class}, $\K$
it is the class of all causal multiteams of signature $\sigma$ being empty or having probability vector in $\Pvec_\K$. Thus $\K=\K_\varphi$.
%\end{IEEEproof}



%\begin{theorem}\label{thm: characterization of P}
%A class $\K$ of multiteams of signature $\sigma$ is definable by a formula of $\PP$ if and only if: 
%\begin{enumerate}
%\item $\K$ is closed under change of laws
%\item $\K$ is closed under rescaling, and
%\item $\K$ is signed monic.
%\end{enumerate} 
%\end{theorem}

\vspace{10pt}

%\begin{IEEEproof}[Proof of Theorem \ref{thm: characterization of P}] 

%\jonni{Currently same Thm as above.}

\emph{Characterizing $\PP$.} The proof proceeds like the previous one, using Lemma \ref{lemma: P is signed monic} in the left-to-right direction. For the right-to-left direction, the key step is producing, for each finite system of signed monic inequalities, a formula $\varphi$ that characterizes the subset of $\Delta^{n-1}$ that is defined by such system.
%We need to proceed more carefully.
Notice first that, since all the $a_i$ coefficients are $1,-1$ or $0$, and furthermore $\epsilon_1+\dots+\epsilon_n = 1$ in $\Delta^{n-1}$, we can assume the constant $b$ to be a rational number in $[-1,1]$. 

Secondly, notice that any signed monic inequality with nonzero coefficients (and with constant term %additive coefficient
$b$ in $[-1,1]$) is equivalent, in $\Delta^{n-1}$, to a signed monic inequality with at least one zero coefficient, and with %additive coefficient
constant term $b$ in $[-1,1]$. Indeed, let us see how to eliminate the variable $\epsilon_n$. An inequality $a_1\epsilon_1 + \dots + a_n\epsilon_n \leq b$, with $a_i=1$ or $-1$, can be rewritten either in the form $\sum_{i\in I}\epsilon_i - \sum_{j\in J}\epsilon_j + \epsilon_n \leq b$ or in the form $\sum_{i\in I}\epsilon_i - \sum_{j\in J}\epsilon_j - \epsilon_n\leq b$. Consider the first case. Since $\epsilon_1+\dots+\epsilon_n = 1$ holds in $\Delta^{n-1}$, we can rewrite this inequality as $\sum_{i\in I}\epsilon_i - \sum_{j\in J}\epsilon_j + 1-(\epsilon_1 +\dots+ \epsilon_{n-1}) \leq b$; then, as $-2\sum_{j\in J}\epsilon_j \leq b-1$, and finally as  $-\sum_{j\in J}\epsilon_j \leq \frac{b-1}{2}$, which is of the correct form because, if $b\in [-1,1]$, then $\frac{b-1}{2}\in [-1,0]$. The other case is analogous, with the difference that we obtain the constant term $\frac{b+1}{2}$, which is in $[0,1]$. Analogous considerations apply when the inequality symbol is $\geq,<$ or $>$.

Thirdly, notice that any signed monic inequality with at most $n-1$ nonzero coefficients (say, $e: a_1\epsilon_1 + \dots + a_{n-1}\epsilon_{n-1} \vartriangleleft b$, with $\vartriangleleft\in\{ \leq,\geq,<,>\}$, where we can assume wlog that $b\in [0,1]$\footnote{Indeed, $b\in [-1,1]$ by the remarks above. If $b<0$, we can multiply both sides of the inequality by $-1$ and obtain an inequality in the opposite direction.}) is equivalent to a system of three inequalities of the forms $e_1:a_1\epsilon_1 + \dots +  a_{n-1}\epsilon_{n-1} -  \epsilon_n \vartriangleleft 0$, $e_2:\epsilon_n \leq b$, $e_3: \epsilon_n \geq b$, which are either monic or have constant term $0$. Thus any finite system  of signed monic inequalities is equivalent to a finite system of triplets of inequalities of the forms $e_1,e_2,e_3$. If we show that there are formulae in $\PP$ that characterize these kinds of inequalities, we can then take $\varphi$ to be the conjunction of all such formulae.

Now the monic inequalities (those of form $e_2,e_3$) can be described by $\PP^-$ formulae as done in Theorem \ref{thm: characterization of P}. Inequalities of the form $e_1$ can be rewritten as $\sum_{i\in I}\epsilon_i - \sum_{j\in J}\epsilon_j \vartriangleleft 0$ for disjoint index sets $I,J$. %If we write $\alpha_i$ for the formula $\SET A = s_i(\SET A)$ (where $\A$ enumerates $\dom$ without repetitions), then
It is easy to see that the $\PP$ formula $\Pr(\bigwedge_{i\in I}\Al_i)\vartriangleleft \Pr(\bigwedge_{j\in J}\Al_j)$ characterizes the subset of $\Delta^{n-1}$ defined by the inequality $\sum_{i\in I}\epsilon_i - \sum_{j\in J}\epsilon_j \vartriangleleft 0$.
\end{IEEEproof}


%\noindent
%It is not completely immediate from the two previous theorems that $\PP$ is strictly more expressive than $\PP^-$. We need an 

\vspace{5pt}

The following lemma establishes that not all signed monic probability sets can be captured by monic inequalities. Together with the two previous theorems this implies that $\PP^- < \PP$.


\begin{lemma}\label{lemma: not all signed monic are monic}
Consider a nonempty probability set $\Pvec\subset \Delta^{n-1}$ which is defined by a single  inequality $a_1\epsilon_1 + \dots + a_n\epsilon_n \leq b$, where there are indexes $i,j$ such that $a_i$ is $1$ and $a_j$ is $-1$. Suppose also that $b$ is a rational number in $[0,1]$. Then $\Pvec$ is not a monic probability set.
%finite union of monic (semi)polytopes.
\end{lemma}





%%%%%%%%%%%%%%%
\begin{comment}

\begin{IEEEproof}
%\commf{I am quite sure that this is true, but not too sure how to prove it...}
Consider the $(i,j)$ projection $\Pvec_{ij}$ of $\Pvec$, i.e. the set of all points of the standard orthogonal 2-simplex\footnote{More precisely, in the following we are referring to the subset $\Delta_c^2\{(\epsilon_i,\epsilon_j) \mid \epsilon_i+\epsilon_j \leq 1\}$ of the $i,j$-plane, a triangle; and its face $\Delta^1:= \Delta_c^2\{(\epsilon_i,\epsilon_j) \mid \epsilon_i+\epsilon_j = 1\}$.  } $\Delta_c^2$ of coordinates $(b_i,b_j)$, such that $b_i,b_j$ appear as $i$th and $j$th coordinate of some point of $\Pvec$. This set is characterized, as a subset of $\Delta_c^2$, by the inequality $\epsilon_i-\epsilon_j \leq b$. We have that (*) one side of the frontier of $\Pvec_{ij}$  is orthogonal to the standard $1$-simplex $\Delta^1$, seen as a face of $\Delta_c^2$. Furthermore, note that, being defined by the inequality $\epsilon_i-\epsilon_j \leq b$, (**) $\Pvec_{ij}$ is a closed subset of $\Delta_c^2$. We can show that the $(i,j)$ projection of any finite union $\Rvec$ of monic (semi)polytopes lacks either property (*) or (**), and thus $\Rvec$ cannot be equal to $\Pvec$. 

First, if $\Rvec$ is a monic polytope, none of the sides of its projection $R_{ij}$ is orthogonal to  $\Delta_1$, since each such side is %either parallel to the coordinate axes or
 defined by an equation of the form $\epsilon_1+\epsilon_2 = c$, $\epsilon_1 = c$ or $\epsilon_2 = c$ (for some number $c$). Thus (*) does not hold of $\Rvec$. Now let instead $\Rvec$ be a finite union of polytopes $\bigcup_k \Rvec_k$. If $\Rvec = \Delta^{n-1}$, then $\Rvec\neq \Pvec$. So assume $\Rvec \subset \Delta^{n-1}$. In this case the frontier of $\Rvec_{ij}$ is a polygon whose sides are subsets of the frontiers of each projection $(\Rvec_k)_{ij}$. Thus, none of these sides is orthogonal to $\Delta^1$, and (*) fails.

Now suppose $\Rvec$ is a monic semipolytope, but not a polytope. Then there is a finite set of nonempty polytopes $\Qvec,\Qvec_i$ such that $\Rvec = \Qvec \setminus \bigcup_i\Qvec_i$. We can assume that $\Rvec$ is nonempty (otherwise it is different from $\Pvec$ -- and a polytope). But then, by its definition, $\Rvec$ does not contain some points of its frontier, and so neither $\Rvec_{ij}$ does, i.e. (**) fails. 

Finally, consider a finite union of semipolytopes, say $\Rvec = \bigcup_l (\Rvec_l \setminus \bigcup_{k\in K_l} \Qvec_k^l)$, where the $\Rvec_l$ and $\Qvec_k^l$ are polytopes. As before we can assume that $\Rvec$, and thus $\Rvec_{ij}$, is nonempty. The frontier of $\Rvec_{ij}$ is the union of tow types of sets: 1) subsets of the frontiers of the $\Qvec_k^l$, not included in $\Rvec$, and 2) subsets of sides of the $R_j$, which are not orthogonal to $\Delta^1$. Since $\Rvec_{ij}$ is nonempty it contains either points of type 1) or type 2), and thus either (**) or (*) is violated.

\commf{This proof is probably badly in need of simplification, and would be best checked by someone who really knows convex geometry.}

\end{IEEEproof}

\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





\begin{IEEEproof}
%\commf{I am quite sure that this is true, but not too sure how to prove it...}
Consider the $(i,j)$ projection $\Pvec_{ij}$ of $\Pvec$, i.e. the set of all points of the standard orthogonal 2-simplex\footnote{More precisely, in the following we are referring to the subset $\Delta_c^2 = \{(\epsilon_i,\epsilon_j) \mid \epsilon_i+\epsilon_j \leq 1\}$ of the $i,j$-plane, a triangle; and its face $\Delta^1:= \{(\epsilon_i,\epsilon_j) \mid \epsilon_i+\epsilon_j = 1\}$.  } $\Delta_c^2$ of coordinates $(b_i,b_j)$, such that $b_i,b_j$ appear as $i$th and $j$th coordinate of some point of $\Pvec$. This set is characterized, as a subset of $\Delta_c^2$, by the inequality $\epsilon_i-\epsilon_j \leq b$. We have that (*) one side of the frontier of $\Pvec_{ij}$  is orthogonal to the standard $1$-simplex $\Delta^1$, seen as a face of $\Delta_c^2$. %Furthermore, note that, being defined by the inequality $\epsilon_i-\epsilon_j \leq b$, (**) $\Pvec_{ij}$ is a closed subset of $\Delta_c^2$.
We can show that the $(i,j)$ projection of any %finite union $\Rvec$ of monic sets
monic set $\Rvec$ lacks property (*), %or (**),
and thus $\Rvec$ cannot be equal to $\Pvec$. 

First, if $\Rvec$ is characterized by a finite system of monic inequalities, none of the sides of its projection $\Rvec_{ij}$ is orthogonal to  $\Delta_1$, since each such side is %either parallel to the coordinate axes or
 defined by an equation of the form $\epsilon_i+\epsilon_j = c$, $\epsilon_i = c$ or $\epsilon_j = c$ (for some number $c$). Thus (*) does not hold of $\Rvec$.
 
 Now let instead $\Rvec$ be a finite union $\bigcup_k \Rvec_k$ of sets as considered in the previous paragraph. If $\Rvec = \Delta^{n-1}$, then $\Rvec\neq \Pvec$. So assume $\Rvec \subset \Delta^{n-1}$. In this case the frontier of $\Rvec_{ij}$ is a polygonal line whose sides are subsets of the frontiers of each projection $(\Rvec_k)_{ij}$. Thus, none of these sides is orthogonal to $\Delta^1$, and (*) fails.
%Now suppose $\Rvec$ is characterized by a finite system of monic inequalities, but is not a polytope. Then its projection $\Rvec_{ij}$ is a polygon minus some of the sides. %Then there is a finite set of nonempty polytopes $\Qvec,\Qvec_i$ such that $\Rvec = \Qvec \setminus \bigcup_i\Qvec_i$. We can assume that $\Rvec$ is nonempty (otherwise it is different from $\Pvec$ -- and a polytope). But then, by its definition, $\Rvec$ 
%Thus, it does not contain some points of its frontier, i.e. (**) fails. 
%Finally, consider a finite union of semipolytopes, say $\Rvec = \bigcup_l (\Rvec_l \setminus \bigcup_{k\in K_l} \Qvec_k^l)$, where the $\Rvec_l$ and $\Qvec_k^l$ are polytopes. As before we can assume that $\Rvec$, and thus $\Rvec_{ij}$, is nonempty. The frontier of $\Rvec_{ij}$ is the union of tow types of sets: 1) subsets of the frontiers of the $\Qvec_k^l$, not included in $\Rvec$, and 2) subsets of sides of the $R_j$, which are not orthogonal to $\Delta^1$. Since $\Rvec_{ij}$ is nonempty it contains either points of type 1) or type 2), and thus either (**) or (*) is violated.
%\commf{This proof would be best checked by someone who really knows convex geometry.}
\end{IEEEproof}


%\commf{Omitted here the section that shows that, if the language has strict tensor + nonemptyness atoms, then it is not closed under rescalings.}


%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
    
\subsection{Languages with the strict tensor}

THIS SECTION MUST BE REMOVED

\commf{These arguments make sense only if we have nonemptyness atoms in the language. These are definable if we assume that probability atoms are false by default on the empty causal multiteam. If instead we assume them to be true by default, the nonemptiness atom is NOT definable in our languages.}

In the literature on multiteams, rather than our (lax) tensor, typically the following \emph{strict tensor} has been considered:
\begin{align*}
T\models \psi \lor^\textsf{s} \chi \iff & \text{There are causal submultiteams $S_1,S_2$ of $T$} \\
   &  \text{ such that $S_1^- \cap S_2^-= \emptyset$, $S_1^- \cup S_2^- = T^-$, $S_1\models\psi$ and $S_2\models \chi$.}
\end{align*}

\noindent In the context of our paper, this connective might not be a good choice. Remember that we consider formulae of the form $\alpha\supset P(\psi)\leq\epsilon$, which intuitively state that, after observing $\alpha$, the probability of $\psi$ is bounded by $\epsilon$. Such a statement is perfectly meaningful if we attribute to probabilities a subjective interpretation;  while it would not make much sense in the context of a frequentist interpretation: objective probabilities are not affected by epistemic actions, e.g. observations. Thus, the main languages considered in this paper exclude a frequentist interpretation. This is confirmed by the fact that these languages do not distinguish between rescalings (lemma \ref{lemma: closure under rescaling}): they cannot tell apart multiteams of different size if these encode the same probabilities. In other words, we cannot interpret the multiteams as sets of empirical data; they are just encodings of probabilities. If we introduce the strict tensor, the situation immediately changes (even if we have no other connectives except $\land$); it becomes possible to tell apart a causal multiteam from some of its rescalings.

We illustrate this point by showing that, in languages with the strict tensor, we can characterize with a formula $\theta_k$ the property of a causal multiteam (of a signature $\sigma$) of having at least $k$ assignments (provided $k\geq |\B_\sigma|$). Assuming such a formula exists, take any causal multiteam $S$ (of signature $\sigma$) of cardinality smaller than $k$, and let $T$ be a rescaling of $S$ of cardinality $\geq n$ (i.e., the two causal multiteams have the same function component, and $T^-$ is a rescaling of $S^-$). Then $S\not\models \theta_k$, while $T\models \theta_k$.

In order to define $\theta_k$, consider first the following formulae
\[
\psi_t: P(\bigwedge_{X\in \dom} X=t(X)) = 1
\]
which hold of a causal multiteam iff the multiteam component contains only copies of assignment $t$, and at least one copy of $t$. Then,
\[
\chi_t^j: {\bigvee_{j \ times}}^{\hspace{-5pt}\textsf{s}} \psi_t
\]
states that there are only copies of $t$, and at least $j$ of them. Now let $f$ be an arbitrary function that, to each assignment $t$, associates a number $f(t)\in \mathbb N$. The formula
\[
\varphi_f: {\bigvee_{t\in \B_\sigma}}^{\hspace{-1pt}\textsf{s}} \chi_t^{f(t)}
\]
states that the multiteam contains at least $f(t)$ copies of each $t\in \B_\sigma$. Finally,
\[
\theta_k: {\bigvee_{f \mid f(s_1)+\dots+f(s_n) = k}}^{\hspace{-22pt}\textsf{s}} \varphi_f
\]
holds iff the multiteam contains at least $k$ (copies of) assignments.

\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%





%\commf{++++++++ PLEASE IGNORE THE FOLLOWING. UNDER CONSTRUCTION ++++++++}

%We end this subsection by pointing out an interesting property of the strict tensor. While plausibly it does not preserve the property of being monic when added to a language, it does preserve a more general property (when added to appropriate languages). We say a class $\K$ is \textbf{semialgebraic} if $\Pvec_\K$ is a finite union of semipolytopes (we do not require them to be monic).




%*******************************************************

%Let $c$ be the  least common denominator of $a$ and $b$. %with the sizes of $T_1$ and $T_2$ (call them $k_1,k_2$). 
%Then there are natural numbers $m,n$ such that $a = \frac{m}{c}$ and $b=\frac{n}{c}$. We define a causal multiteam $T=(T^-,\F)$ as follows. First, put in $T^-$ exactly $m\cdot|T_1^-|\cdot |T_2^-| \cdot \#(s,T_1)+n\cdot|T_1^-|\cdot |T_2^-|\cdot\#(s,T_2)$ copies of the assignment $s$. It is then easy to show that $|T^-| = m\cdot|T_1^-|^2\cdot|T_2^-| + m\cdot|T_1^-|\cdot|T_2^-|^2$. Since $\K_\chi$ is closed under change of laws, we have that $(T_2^-,\F)\models \chi$; and then, since $\K_\psi, \K_\chi$ are closed under rescaling, $S_1\models \psi$ and $S_2\models\chi$. Thus $T\in \K_{\psi\lor^\textsf{s}\chi}$. We want to show that $\pvec=\pvec_T$, from which it would immediately follow that $\pvec \in \Pvec_{\psi\lor^\textsf{s}\chi}$.

%*******************************************************

%Let $d$ be the product of  the least common denominator $c$ of $a$ and $b$ with the sizes of $T_1$ and $T_2$ (call them $k_1,k_2$). Then there are natural numbers $m,n$ such that $a = \frac{m}{d}$ and $b=\frac{n}{d}$. We define a causal multiteam $T=(T^-,\F)$ as follows. First, put in $T^-$ exactly $m\#(s,T_1)+n\#(s,T_2)$ copies of the assignment $s$

%*****************************************************

%In particular, for every $s\in \B_\sigma$, we have 
% Take $T=(T^-, \F)$, where $T^-$ is defined as follows. Write $a,b$ with a common denominator: $a=\frac{m}{d}$ and $b= \frac{k}{d}$. We put in $T^-$ exactly $da\#(s,T_1)+db\#(s,T_2)$ copies of the assignment $s$. Then $T^-$ is the disjoint union of two rescalings of $T_1^-$, resp $T_2^-$ (call them $S_1,S_2$). Since $\K_\chi$ is closed under change of laws, we have that $(T_2^-,\F)\models \chi$; and then, since $\K_\psi, \K_\chi$ are closed under rescaling, $S_1\models \psi$ and $S_2\models\chi$. Thus $T\in \K_{\psi\lor^\textsf{s}\chi}$. We want to show that $\pvec=\pvec_T$, from which it would immediately follow that $\pvec \in \Pvec_{\psi\lor^\textsf{s}\chi}$.
 
 
 
%  Since $\K_\chi$ is closed under change of laws, we have that $T\models \psi \lor^\textsf{s} \chi$.
%\end{IEEEproof}


%One factor in favour of this kind of  disjunction is that it preseerves the monicity of a language if added to it (while presumably $\lor$ does not).

%\begin{theorem}
%Suppose $\K_\psi, \K_\chi$ are monic. Then also $\K_{\psi\lor^\textsf{s}\chi}$ is monic.
%\end{theorem}








\subsection{Conditional logics $\PO$ and $\PC$}\label{subs: PO and PC}
We already know that $\PC$ is strictly more expressive than $\PP$. We start this section by establishing that also $\PO$ is strictly more expressive than $\PP$ and then proceed to precise characterizations of both $\PO$ and $\PC$. %For $\PC$ this is a trivial consequence of corollary \ref{lemma: P closed under change of laws}, as clearly $X=x\cf Y=x$ is not closed under change of laws. 
Let us then show that $\PO$ can express properties that are not signed monic.


%Here we consider the language $\PO$ that contains all operators except for $\cf$ (and again, we allow $\lor$ to occur only in probability statements). Adding the operator $\supset$ to $\PP$, we obtain the possibility of expressing constraints on probabilities that are still given by linear inequalities, but not necessarily monic.

\begin{lemma}\label{lemma: not all linear are signed monic}
Let $\Pvec\subset \Delta^{n-1}$ be  a probability set defined by a single inequality $a_1\epsilon_1 + \dots + a_n\epsilon_n \leq b$, where $0\neq a_i,a_j\in \mathbb{Z}$ and $|a_i| \neq |a_j|$, for some indices $i,j$. Then $\Pvec$ is not signed monic.
%finite union of signed monic semipolytopes.
\end{lemma}

\begin{IEEEproof}
%\commf{I am quite sure that this is true, but not too sure how to prove it...}
The proof is analogous to that of Lemma \ref{lemma: not all signed monic are monic}, replacing property (*) with ``$R_{ij}$ contains a segment that is incident, but not orthogonal, to $\Delta^1$''.
\end{IEEEproof}



\begin{proposition}\label{example: PO greater than P}
$\PP < \PO$
\end{proposition}
\begin{IEEEproof}
Let $\sigma=(\dom,\ran)$ be a signature, $s_1,s_2,s_3$
%the three first distinct assignments in the enumeration of $\B_\sigma$,
distinct assignments,
and $\Al_i$ ($i=1,2,3$) be the formulae $\SET W = s_i(\SET W)$, where $\SET W$ lists the variables in $\dom$.
Now, the formula
\[
\varphi \dfn (\Al_1\lor\Al_2\lor\Al_3)\supset \Pr(\Al_1\lor\Al_2) \leq \frac{1}{3}
\]
is satisfied in a causal multiteam $T$ iff
\begin{align*}
     & P_T(\Al_1\lor\Al_2 \mid \Al_1\lor\Al_2\lor\Al_3) \leq \frac{1}{3} \\
\iff & 3\cdot P_T((\Al_1\lor\Al_2) \land (\Al_1\lor\Al_2\lor\Al_3)) \leq P_T(\Al_1\lor\Al_2\lor\Al_3) \\
\iff & 3\cdot P_T(\Al_1\lor\Al_2) \leq P_T(\Al_1\lor\Al_2\lor\Al_3).
\end{align*}
%
%The latter is equivalent with
%\(
%3\cdot P_T((\Al_1\lor\Al_2) \land (\Al_1\lor\Al_2\lor\Al_3)) \leq P_T(\Al_1\lor\Al_2\lor\Al_3)
%\)
%which can be rewritten as
%\(
%3\cdot P_T(\Al_1\lor\Al_2) \leq P_T(\Al_1\lor\Al_2\lor\Al_3).
%\)
Since the formulae $\Al_i$ describe disjoint events, the latter is equivalent with
\begin{align*}
 & 3\cdot P_T(\Al_1) + 3\cdot P_T(\Al_2) \leq P_T(\Al_1) + P_T(\Al_2) + P_T(\Al_3) \\
\iff & 2\cdot P_T(\Al_1) + 2\cdot P_T(\Al_2) - P_T(\Al_3) \leq 0.
\end{align*}
Thus $\Pvec_\varphi$ is the subset of $\Delta^{n-1}$ defined by the inequality $2\epsilon_{1}+ 2\epsilon_{2}-\epsilon_{3} \leq 0$. 
By Lemma \ref{lemma: not all linear are signed monic}, $\Pvec_\varphi$ is not signed monic, and thus by Theorem \ref{thm: characterization of P} $\varphi$ is not expressible in $\PP$.
%\jonni{Delete the rest of the proof.}
%which is not monic. 
%It should also be clear \commf{...right??} that such a set is not definable as a finite union of signed monic semipolytopes (see Lemma \ref{lemma: not all linear are signed monic} below); thus, by theorem \ref{thm: characterization of P-}, $\varphi$ is not equivalent to any $\PP$ formula. In other words,
%\[
%\PP < \PO.
%\]
%Notice also that we managed to obtain an inequality with coefficients of different signs without using comparison atoms.
\end{IEEEproof}


%\begin{definition}
%A class $\K$ of causal multiteams of a fixed signature $\sigma$ is \textbf{linear} if it is a finite union of $\sigma$-semipolytopes. A formula $\varphi$ is linear if $\K_\varphi$ is. 
%\end{definition}

%\begin{definition}\jonni{From linear to signed binary.}
%A class $\K$ of causal multiteams of signature $\sigma$ is \textbf{linear} if $\Pvec_\K$ is a finite union of probability sets defined by linear inequalities.  
%\end{definition}


\begin{lemma}\label{lemma: supset normal form}
Every formula of $\PO_{\sigma}$ is equivalent to a $\PO_{\sigma}$ formula with the following property:
\begin{center}
Each occurrence of the form $\alpha\supset\psi$ is either inside a probabilistic statement, in the antecedent of an $\supset$, or $\psi$ is a probabilistic atom.
%Every subformula occurrence of the form $\alpha\supset\psi$ that is not in a probabilistic statement nor in the antecedent of a $\supset$ operator is such that $\psi$ is a probabilistic atom. 
\end{center}
\end{lemma}

\begin{IEEEproof}
We first prove, by induction on the structure of $\psi$, that each $\PO_{\sigma}$-formula $\alpha\supset\psi$ can be equivalently rewritten as a formula with the required normal form. 

If $\psi$ is a probabilistic atom, we do nothing. If $\psi$ is $X=x$ (resp $X\neq x$), we replace it with $\Pr(X = x)\geq 1$ (resp. $\Pr(X\neq x)\geq 1$).
%
If $\psi$ is $\eta \circ \theta$, where $\circ=\land,\sqcup$, then we replace $\alpha\supset\psi$ with $(\alpha\supset\eta)\circ(\alpha\supset\theta)$. 
%
If $\psi$ is $\beta\supset\theta$, then we replace $\alpha\supset\psi$ with $(\alpha\land\beta)\supset \theta$.

By applying the procedure described above to all subformulae of the form $\alpha\supset\psi$ of a $\PO_{\sigma}$-formula $\varphi$ that do not occur in the antecedent of an $\supset$ nor inside a probabilistic statement, we again obtain an equivalent $\PO_\sigma$ formula of the required form.
%otice that after the replacement we still have a $\PO$ formula, thanks to the assumption that $\alpha\supset\psi$ is not in an antecedent of $\supset$ nor inside a probabilistic statement.
%
%We prove this by replacing subformulae of the kind described in the statement with either formulae that respect the property or with formulae in which all consequents of $\supset$ operators have a simpler form. We proceed by induction on $\psi$:
%\begin{itemize}
%\item Base case. If $\psi$ is a probabilistic atom, we do nothing. If $\psi$ is $X=x$ (resp $X\neq x$), we replace it with $\Pr(X = x)\geq 1$ (resp. $\Pr(X\neq x)\geq 1$); notice that after the replacement we still have a $\PO$ formula, thanks to the assumption that $\alpha\supset\psi$ is not in an antecedent of $\supset$ nor inside a probabilistic statement.
%\item  If $\psi$ is $\eta \circ \theta$, where $\circ=\land,\sqcup$, then we replace $\alpha\supset\psi$ with $(\alpha\supset\eta)\circ(\alpha\supset\theta)$. 
%\item  If $\psi$ is $\beta\supset\theta$, then we replace $\alpha\supset\psi$ with $(\alpha\land\beta)\supset \theta$.
%\end{itemize}
\end{IEEEproof}

\vspace{5pt}

\noindent %However, $\PO$ does not capture linearity. The relevant condition is as follows.  
We say that a subset $\Pvec$ of $\Delta^{n-1}$ is \textbf{signed binary} if it is a finite union of sets defined by finite systems of inequalities of the form
\[
c^- \sum_{i\in I} \epsilon_i + c^+ \sum_{j\in J} \epsilon_j \vartriangleleft b
\]
where $I\cap J = \emptyset$, $c^-,c^+ \in \mathbb Z$, $c^- \leq 0$, $c^+ \geq 0$, $b\in \mathbb Q$. Likewise, a class $\K$ of causal multiteams of signature $\sigma$ is signed binary if such is $\Pvec_\K$.


\begin{lemma}\label{lemma: PO is linear}
Every formula $\varphi\in\PO$ is signed binary.
\end{lemma}

\begin{IEEEproof}
The proof proceeds by induction on $\varphi$. The cases not involving $\supset$ as most external operator are proved exactly as in Lemmas \ref{lemma: P minus is monic} and \ref{lemma: P is signed monic} (since Lemma \ref{lemma: preserve polytopes} can be easily extended to the signed binary case).

Suppose then that $\varphi$ is of the form $\alpha\supset\psi$. By Lemma \ref{lemma: supset normal form}, we can assume $\psi$ to be a probabilistic atom. Hence we have two cases.

 1) Assume $\psi$ is $\Pr(\beta)\vartriangleleft b$ ($\vartriangleleft \in \{ \leq,\geq,<,>\}$). Now $T\in\K_\varphi$ iff either $P_T(\alpha) \leq 0$ or $P_T(\beta\mid\alpha)\vartriangleleft b$. The latter is equivalent to $P_T(\beta\land \alpha)\vartriangleleft b \cdot P_T(\alpha)$, which can be rewritten as
 \[
 \sum_{\substack{s\in\B_\sigma \\ \{s\}\models\beta\land\alpha}}\epsilon^T_s \vartriangleleft b \cdot \sum_{\substack{s\in\B_\sigma \\ \{s\}\models\alpha}}\epsilon^T_s.
 \]
 The above can be rewritten as
  \[
 \sum_{\substack{s\in\B_\sigma \\ \{s\}\models\beta\land\alpha}}\epsilon^T_s \vartriangleleft b \cdot \big( \sum_{\substack{s\in\B_\sigma \\ \{s\}\models\beta \land \alpha}} \epsilon^T_s + \sum_{\substack{s\in\B_\sigma \\ \{s\}\models\neg \beta \land \alpha}} \epsilon^T_s \big)
 \]
%Taking into account that $\{s\mid \{s\}\models\beta\land\alpha\} \subseteq \{s\mid \{s\}\models \alpha\}$, 
which again is equivalent to
\begin{equation}\label{eq:1}
 (1-b)\cdot\sum_{\substack{s\in\B_\sigma \\ \{s\}\models\beta\land\alpha}}\epsilon^T_s + (- b) \cdot \sum_{\substack{s\in\B_\sigma \\ \{s\}\models \neg \beta \land\alpha}}\epsilon^T_s \vartriangleleft  0.
 \end{equation}
 Now, since $b\in [0,1]$, we have $1-b \geq 0$ and $-b\leq 0$. Then, by multiplying both sides of \eqref{eq:1} by a common denominator of $1-b$ and $-b$, we obtain a signed binary inequality.

 % This can be rearranged into an inequality of the form
 %\[
 %\sum_{i\in I}\epsilon_i + (1-b) \cdot \sum_{j\in J}\epsilon_j + (-b) \cdot \sum_{k\in K}\epsilon_k \vartriangleleft 0.
 %\]
 %However, since $\{s\mid \{s\}\models\beta\land\alpha\} \subseteq \{s\mid \{s\}\models \alpha\}$, the term $\sum_{i\in I}\epsilon_i$ can be removed. 
 On the other hand, the inequality $P_T(\alpha)\leq 0$ can be rewitten as $ \sum_{\{s\}\models\alpha}\epsilon_s\leq 0$. %, which defines a polytope. 
Thus $\Pvec_\varphi$ is the union of two sets defined by %defined by a system of two signed 
signed binary inequalities.
%the union of two semipolytopes. 

2) Assume $\psi$ is $P(\beta)\vartriangleleft P(\gamma)$. Now $T\in\K_\varphi$ iff either $P_T(\alpha)\leq 0$ or $P_T(\beta\mid\alpha)\vartriangleleft P_T(\gamma\mid\alpha)$. The proof then proceeds as in the previous case. %(but notice that this time we obtain a union of two \emph{signed monic} semipolytopes).
\end{IEEEproof}

%\noindent %However, $\PO$ does not capture linearity. The relevant condition is as follows.  
%We say that a subset $\Pvec$ of $\Delta^{n-1}$ is \textbf{signed binary} if it is a finite union of sets defined by inequalities of the form
%\[
%c^- \sum_{i\in I} \epsilon_i + c^+ \sum_{j\in J} \epsilon_j \vartriangleleft b
%\]
%where $I\cap J = \emptyset$, $c^-,c^+ \in \mathbb Z$, $c^- \leq 0$, $c^+ \geq 0$, $b\in \mathbb Q$. Likewise, a class $\K$ of causal multiteams of signature $\sigma$ is signed binary if such is $\Pvec_K$.



\begin{theorem}\label{thm: characterization of PO}
A class $\K$ of multiteams of signature $\sigma$ is definable by a formula of $\PO$ if and only if $\K$ is signed binary, has the empty multiteam property and is closed under change of laws and rescaling.
%\begin{enumerate}
%\item $\K$ is closed under change of laws
%\item $\K$ is closed under rescaling, and
%\item $\K$ is signed binary.
%\end{enumerate} 
%
\end{theorem}

\begin{IEEEproof}
$\Rightarrow$) By Theorem \ref{theorem: expressivity of PCOinf} $\K$ is closed under rescaling. Closure under change of laws follows from Lemma \ref{lemma:trivial laws}. % immediately, for $\PO$-formulae have no access to causal equations.
 Lemma \ref{lemma: PO is linear} shows that $\Pvec_\K$ is signed binary. %\jonni{Doesnt this follow already from the formulation of Lemma \ref{lemma: PO is linear}?}
 The empty multiteam property is given by Theorem \ref{thm: CO flatness}.

$\Leftarrow$) The proof is analogous to the proof of Theorem \ref{thm: characterization of P}. We need to show that every constraint of the form 
\[
c^- \sum_{i\in I} \epsilon_i + c^+ \sum_{j\in J} \epsilon_j \vartriangleleft b
\]
where $I\cap J = \emptyset$, $c^-,c^+ \in \mathbb Z$, $c^- \leq 0$, $c^+ \geq 0$, $b\in  \mathbb Q$, can be expressed in $\PO$.

First of all, let us prove it in the special case when $b$ is $0$. Write $d$ for $c^+ -c^-$. Notice that $-d \leq c^- \leq 0 \leq c^+ \leq d$. Then $-\frac{c^-}{d}$ is a rational number in $[0,1]$, and thus the following is a $\PO$ formula (where, as before, $\Al_j$ stands for $\SET W = s_j(\SET W)$):
\[
\Big(\bigvee_{k\in I\cup J} \Al_k\Big) \supset  \Pr(\bigvee_{j\in J}\Al_j)\vartriangleleft -\frac{c^-}{d}.
\]
Now we have
\begin{align*}
 & T\models \Big(\bigvee_{k\in I\cup J} \Al_k\Big) \supset  \Pr(\bigvee_{j\in J}\Al_j) \vartriangleleft -\frac{c^-}{d} \\
 & \iff P_T(\bigvee_{j\in J}\Al_j  \mid  \bigvee_{k\in I\cup J} \Al_k )\vartriangleleft -\frac{c^-}{d} \\
 & \iff d\cdot P_T(\bigvee_{j\in J}\Al_j \land  \bigvee_{k\in I\cup J} \Al_k) \vartriangleleft - c^- \cdot P_T(\bigvee_{k\in I\cup J}\Al_k) \\
  & \iff d\cdot P_T(\bigvee_{j\in J}\Al_j) \vartriangleleft - c^- \cdot P_T(\bigvee_{k\in I\cup J}\Al_k) \\
  & \iff d\sum_{j\in J}\epsilon_j^T \vartriangleleft -c^- \sum_{k\in I\cup J}\epsilon_k^T \\
  & \iff c^- \sum_{i\in I}\epsilon_i^T + (d+c^-)\sum_{j\in J}\epsilon_j^T \vartriangleleft 0 \\
  & \iff c^- \sum_{i\in I}\epsilon_i^T + c^+\sum_{j\in J}\epsilon_j^T \vartriangleleft 0, 
\end{align*}
as required.

Now let us consider the case when $b\neq 0$. Suppose, first, that we have an inequality of the form $c^- \sum_{i\in I} \epsilon_i + c^+ \sum_{j\in J} \epsilon_j \vartriangleleft b$ that satisfies the additional constraint that $I\cup J = \{1,\dots,n\}$, i.e. it contains all variables. We show that then it is equivalent to an inequality of the same form, but with coefficient $0$ for at least one variable. Assuming that $I$ is nonempty, let us pick a variable in $I$ (that we may assume wlog to be $\epsilon_n$). Thus the inequality can be rewritten as: 
\[
c^- \sum_{i\in I\setminus\{n\}} \epsilon_i + c^+ \sum_{j\in J} \epsilon_j + c^- \epsilon_n\vartriangleleft b.
\]
Using the fact that, in $\Delta^{n-1}$, $\epsilon_1+\dots+\epsilon_n = 1$, we can rewrite the inequality as
\[
c^- \sum_{i\in I\setminus\{n\}} \epsilon_i + c^+ \sum_{j\in J} \epsilon_j + c^- -c^- \epsilon_1-\dots- c^-\epsilon_{n-1}\vartriangleleft b
\]
i.e., 
\[
\sum_{j\in J} (c^+ - c^-) \epsilon_j \vartriangleleft b - c^-,
\]
which is of the correct form. In case $I$ is empty, we can perform analogous transformations to eliminate a variable indexed in $J$. 

Thus we can always assume that an inequality $c^- \sum_{i\in I} \epsilon_i + c^+ \sum_{j\in J} \epsilon_j \vartriangleleft b$ (as above) has coefficient $0$ for $\epsilon_n$. Let $k$ be a positive integer such that $kb \in \mathbb Z$.  Then, it is easy to see that our inequality is equivalent to the following system:
\[
\begin{cases}
(kbc^-) \sum_{i\in I} \epsilon_i + (kbc^+) \sum_{j\in J} \epsilon_j + (kbc^-)\epsilon_n  \vartriangleleft  0 \\
\epsilon_n  \leq  -\frac{1}{kc^-} \\
\epsilon_n  \geq  -\frac{1}{kc^-}
\end{cases}
\]

The first of these inequalities is expressible with a $\PO$ formula by the discussion above. Since $-\frac{1}{kc^-}\in [0,1]$, the other two inequalities are expressed by the $\PP^-$ formulae $\Pr(\Al_n)\leq -\frac{1}{kc^-}$, $\Pr(\Al_n)\geq -\frac{1}{kc^-}$, respectively.  
\end{IEEEproof} 

\vspace{5pt}









%\subsection{Expressivity of $\PC$}

Next, we shift to characterizing the expressivity of $\PC$. We begin with the observation that $\cf$ can be restricted to occur only inside probability statements.

%In this section we characterize the expressive power of the fragment $\PC$ in which all operators except $\supset$ are available. We begin with the observation that in this language %(and, more generally, in $\PCO$)
% one may assume that $\cf$ only occurs inside probability statements. %It is worth remarking that the following lemma holds more generally for the fragment $\PCO^\textsf{f}$ obtained by imposing on $\PCO$ the following syntactical restriction:
% \begin{center}
% No occurrences of $\cf$ are allowed inside antecedents of $\supset$.
% \end{center}
%The $'f'$ in the subscript stands for ``factual''; this is the fragment of the language in which we can draw conclusions from factual statements, but not from the outcomes of ``thought experiments'' as expressed by a formula $\SET X = \SET x \cf \beta$. We will also write $\PO^\textsf{f}$ for the analogous restriction of $\PO$. 

\begin{lemma}\label{lemma: no cf outside}
For every $\varphi\in \PC_{\sigma}$, %(resp. $\PCO^\textsf{f}_{\sigma}$),
 there is an equivalent $\varphi'\in \PC_{\sigma}$ %(resp. $\PCO^\textsf{f}_{\sigma}$) %(resp. $\PCO_{\sigma}$)
  such that $\cf$ only occurs inside probability statements.
\end{lemma}


\begin{IEEEproof}
First note that we can assume that the consequents of $\cf$ are atoms, since 1) $\cf$ distributes over $\land$ and $\sqcup$; %2) $\SET X = \SET x\cf(\alpha\supset \chi)$ is equivalent to  $(\SET X = \SET x\cf\alpha)\supset (\SET X = \SET x\cf\chi)$;
2) $\SET X = \SET x\cf (\SET Y = \SET y\cf \chi)$ is equivalent to $(\SET X' = \SET x'\land \SET Y = \SET y)\cf\chi$, where $\SET X' = \SET X \setminus \SET Y$ and $\SET x' = \SET x \setminus \SET y$.\footnote{It is worth remarking that equivalence 2) can fail if cyclic causal laws are allowed; see \cite{BarGal2022} for a detailed discussion.}

We then can push the $\cf$ inside the probability statements by applying the following equivalences:
\[
\SET X = \SET x \cf \Pr(\alpha)\vartriangleleft \epsilon   \equiv    \Pr(\SET X = \SET x \cf \alpha) \vartriangleleft \epsilon 
\]
\[
\SET X = \SET x \cf   \Pr(\alpha)\vartriangleleft Pr(\beta)   \equiv    \Pr(\SET X = \SET x \cf \alpha) \vartriangleleft  \Pr(\SET X = \SET x \cf \beta)
\]
\[
\SET X = \SET x \cf Y=y     \equiv    \Pr(\SET X = \SET x \cf Y=y) \geq 1 
\]
\[
\SET X = \SET x \cf Y\neq y     \equiv    \Pr(\SET X = \SET x \cf Y\neq y) \geq 1. 
\]
Notice that the third and fourth equivalence are always applicable since, in $\PC$, %these languages
$\cf$ never occurs in antecedents of $\supset$.
%\commf{These transformations would not suffice to prove the analogous statement for $\PCO$, since the third and fourth cannot be applied inside an antecedent of $\supset$.}

%\commf{An afterthought: it seems that in the full language we cannot express predictions like ``if, after the intervention, the probability of $Y=y$ is $\epsilon$, then...''}

Let us prove the first of these equivalences; the third and fourth immediately follow from it, and the second one is proved similarly. Let $T = (T^-,\F)$ be a causal multiteam of signature $\sigma$, and observe that
\begin{align*}
 P_{T_{\SET X = \SET x}}(\alpha) & = \sum_{\substack{t \in \Team(T_{\SET X = \SET x}^-) \\ (\{t\},\F_{\SET X = \SET x})\models \alpha}} P_{T_{\SET X = \SET x}}(\SET W = t(\SET W)) \\ 
 & = \sum_{\substack{s \in \Team(T^-) \\ (\{s^\F_{\SET X = \SET x}\},\F_{\SET X = \SET x})\models \alpha}} P_{T}(\SET W = s(\SET W)) \\
  & = \sum_{\substack{s \in \Team(T^-) \\ (\{s\},\F)\models \SET X = \SET x \cf \alpha}} P_{T}(\SET W = s(\SET W)) \\
 & = P_T(\SET X = \SET x \cf \alpha)   
\end{align*}
where the second equality uses the fact that an intervention on a recursive causal team preserves the multiplicities of assignments, in the sense that %$\epsilon_{s^\F_{\SET X = \SET x}}^{T_{\SET X = \SET x}} =
the probability of $t = s^\F_{\SET X = \SET x}$ in $T_{\SET X = \SET x}$ is just given by the sum
\[
\sum_{\substack{u\in \Team(T^-) \\ u^\F_{\SET X = \SET x} = s^\F_{\SET X = \SET x}}} \epsilon_u^{T^-}.
\]
We then have that $T\models\SET X = \SET x \cf \Pr(\alpha)\vartriangleleft \epsilon$ iff $P_{T_{\SET X = \SET x}}(\alpha)\vartriangleleft \epsilon$ iff $P_T(\SET X = \SET x \cf \alpha) \vartriangleleft \epsilon$ iff $T\models \Pr(\SET X = \SET x \cf \alpha) \vartriangleleft \epsilon$, as required.
\end{IEEEproof}

\vspace{5pt}

\noindent The next important observation is that, if we restrict attention to causal multiteams with a fixed function component, %(modulo $\sim$-equivalence),
then the meaning of $\PC$ formulae (or even $\PCO$ formulae) can be described in terms of the $\Al_{i}$ formulae $\SET W = s_i(\SET W)$ (which have no occurrences of $\cf$).

\begin{lemma}\label{lemma: ignoring cf}
Let $\varphi\in \PC_{\sigma}$ (resp. $\PCO_{\sigma}$),
 and $\F$ a function component of signature $\sigma$. Then there is a formula $\varphi^\F\in \PP_{\sigma}$ (resp. $\PO_{\sigma}$)
  such that, for every causal multiteam $T$ of signature $\sigma$ and function component $\F$,
\[
T\models \varphi \iff T \models \varphi^\F.
\]
\end{lemma} 

\begin{IEEEproof}
With a slight change on earlier notation, we write $\alpha_{s}$ for $\SET W = s(\SET W)$, where $\SET W$ is an injective list of all variables of the domain.

If the formula contains occurrences of the symbol $\supset$, we first show that we can remove all occurrences of $\cf$ from the antecedents of $\supset$. Indeed, if there is a subformula of the form $\beta\supset\psi$, we can simply replace $\beta$ with $\bigvee_{(s,\F) \models \beta}\alpha_s$, which does not contain occurrences of $\cf$.


By (the proof of) Lemma \ref{lemma: no cf outside}, we can then assume that, in $\varphi$, $\cf$ only occurs inside probability statements. Thus $\varphi$ is a Boolean combination (using operators $\land,\sqcup,\supset$) of atomic formulae. But then, it suffices to show that the statement holds for the atomic formulae.

For what regards atoms of the form $Y=y$, these are already $\PP$ formulae.

%Now consider a
Atoms of the form $\Pr(\alpha) \vartriangleleft \epsilon$ %. Let $s_1,\dots,s_k$ be an injective enumeration of the assignments $s$ of signature $\sigma$ such that $(s,\F)\models \alpha$, and  Then we 
can be replaced with $\Pr(\bigvee_{(s,\F)\models \alpha} \alpha_s ) \vartriangleleft \epsilon$.  

Similarly, atoms of the form $\Pr(\alpha) \vartriangleleft  \Pr(\beta)$ can be replaced by $\Pr(\bigvee_{(s,\F) \models \alpha} \alpha_s) \vartriangleleft \Pr(\bigvee_{(s,\F) \models \beta} \alpha_s)$.
\end{IEEEproof}

\vspace{5pt}

Fix a signature $\sigma$. %For each $\sim$-equivalence class of function components of signature $\sigma$ we can choose a representative.
We denote as $\mathbb{F}_\sigma$ the set of all function components of signature $\sigma$. 
It was shown in \cite{BarYan2022} that, for each $\F\in\mathbb{F}_\sigma$, there is a formula $\Phi^\F \in \CO_\sigma$ (that is actually also in $\PCO_\sigma$) that characterizes the property of having function component $\F$ in the causal team semantics setting.\footnote{More precisely, in \cite{BarYan2022} this formula characterized the function component only up to a certain relation of equivalence (see the Appendix). In our framework, this equivalence relation collapses to identity.} This characterization still holds in our framework, in the sense that, for every \emph{nonempty} causal multiteam $T = (T^-,\G)$ of signature $\sigma$:
\[
T\models \Phi^\F \iff \G = \F.
\]
%
For details, see the appendix. The formula $\Phi^\F$, slightly adapted to the notations of this paper\footnote{The original formula mentioned the set of constant causal functions, which are not allowed here. Furthermore, it had to refer explicitly to the parent set of causal functions.}, is:
% In it, %$\SET W$ stands for $\dom \setminus(\PA_V^\mathcal F\cup \{V\})$ and 
%$\SET W_V$ stands for $\dom\setminus\{V\}$, and $Con(\F)$ is the set of endogenous variables of $\F$ that are generated by a constant function. Using the notations from the present paper,
\[
\Phi^\F: \bigwedge_{V\in End(\F)} \eta_\sigma(V) \land \bigwedge_{V\notin End(\mathcal F)  
%\in (\dom\setminus End(\mathcal F))\cup Con(\F)
} \xi_\sigma(V)
\]
where
\[
\eta_\sigma(V): \bigwedge_{\SET w\in \ran(\SET W_V)}(\SET W_V = \SET w \cf V = \F_V(\SET w))
\]
and
\[
\xi_\sigma(V): \bigwedge_{\substack{\SET w\in \ran(\SET W_V) \\ v \in \ran(V)}} V=v \supset (\SET W_V=\SET w \cf V=v).
\]

Let $\Psi^F$ denote the $\PC$ formula obtained from $\Phi^\F$ by replacing each of its subformulae of the form $V=v \supset \beta$ with $\Pr(V\neq v \lor \beta) =1$.
Since, in all subformulas $V=v \supset \beta$ of  $\Phi^\F$, $\beta$ is flat, it follows that $\Psi^\F$ is equivalent to $\Phi^\F$. Thus $\Psi^\F$ is a $\PC$-formula that characterizes the property of having function component $\F$.

We can now characterize the expressive power of $\PC$.

\begin{theorem}\label{thm: characterization of PC}
Let $\K$ be a class of causal multiteams of signature $\sigma$. $\K$ is definable by a $\PC_{\sigma}$ formula if and only if 1) $\K$ has the empty multiteam property, 2) $\K$ is closed under rescaling, and 3) $\K = \bigcup_{\F\in\mathbb{F}_\sigma}\K^\F$, where  each $\K^\F$ is a signed monic set of causal multiteams of team component $\F$. 
\end{theorem}

\begin{IEEEproof}
$\Rightarrow$) Suppose $\K = \K_\varphi$, where $\varphi\in\PC_{\sigma}$. Now %let $\Phi^\F$ be the  $\PCO_{\sigma}$ formula characterizing $\F$ (as introduced in Section \ref{subs: expressivity of an infinitary language}). Notice that this formula, as originally defined, contains subformulae of the form $V=v\supset \beta$; however, we can replace these with $V\neq v\lor \beta$, thus obtaining a $\CO_{\sigma}$ formula \emph{without occurrences of $\supset$}. Write $\Psi^\F$ for the formula $\Pr(\Phi^\F)=1$: this is a $\PC_{\sigma}$ formula equivalent to $\Phi^\F$. We can then
define, for each $\F\in \mathbb{F}_\sigma$, $\K^\F := \K_{\varphi \land \Psi^\F}$, where $\Psi^\F$ is as described above. Clearly $\varphi \equiv \bigsqcup_{\F\in \mathbb{F}_\sigma} (\varphi \land \Psi^\F)$, so $\K_\varphi = \bigcup_{\F\in\mathbb{F}_\sigma}\K^\F$.

Now, by Theorem \ref{theorem: expressivity of PCOinf}, $\K_\varphi$ is closed under rescaling,  and by Theorem \ref{thm: CO flatness} it has the empty multiteam property. 
Next, observe that, by Lemma \ref{lemma: ignoring cf}, for every $\F\in\mathbb{F}_\sigma$ there is a formula of $\PP_{\sigma}$, call it $\varphi^\F$, which is satisfied by the same causal multiteams of function component $\F$ as $\varphi \land \Psi^\F$ is. In other words, $\K^\F$ is the restriction of $\K_{\varphi^\F}$ to causal multiteams of function component $\F$. Thus, since $\K_{\varphi^\F}$ is closed under change of laws (lemma \ref{lemma:trivial laws}), we have $\Pvec_{\K^\F} = \Pvec_{\K_{\varphi^\F}}$. Now $\K_{\varphi^\F}$ is signed monic (lemma \ref{lemma: P is signed monic}), and thus by $\Pvec_{\K^\F} = \Pvec_{\K_{\varphi^\F}}$ we conclude that also $\K^\F$ is signed monic.

$\Leftarrow$) Suppose $\K$ is closed under rescaling, has the empty multiteam property and $\K = \bigcup_{\F\in\mathbb{F}_\sigma}\K^\F$ for some sets $\K^\F$ as in the statement. Write $\hat \K^\F$ for the set of all causal multiteams of signature $\sigma$ whose team component appears in $\K^\F$. It is straightforward then that also $\hat \K^\F$ is closed under rescaling, has the empty multiteam property and is signed monic; however, $\hat \K^\F$ is also closed under change of laws. Thus, by Theorem \ref{thm: characterization of P}, there is a $\PP$ formula $\varphi^\F$ such that $\hat \K^\F = \K_{\varphi^\F}$. More precisely, $\K^\F$ is the set of all causal multiteams of $\K_{\varphi^\F}$ that have function component $\F$. Thus $\K^\F = \K_{\varphi^\F \land \Psi^\F}$. Thus $\K$ is defined by the $\PC_{\sigma}$ formula $\bigsqcup_{\F\in\mathbb{F}_\sigma}(\varphi^\F \land \Psi^\F)$.
\end{IEEEproof}

\vspace{5pt}

We remark that the sets $\K^\F$ in the statement of the theorem are themselves closed under rescaling if $\K$ is. This immediately follows from the fact that any two causal multiteams $(T,\F),(S,\G)$ with $\F\neq\G$ are \emph{not} rescalings of each other. 

\begin{corollary}\label{cor: PO not included in PC}
   $\PO\not\leq\PC$.  
\end{corollary}

\begin{IEEEproof}
The proof of Proposition \ref{example: PO greater than P} shows that there is a $\PO$ formula $\varphi$ such that $\Pvec_\varphi$ is described by a single signed binary 
inequality.  By Lemma \ref{lemma: not all linear are signed monic}, then, $\Pvec_\varphi$ is not signed monic. Since $\PO$ is closed under change of causal laws, for any $\F\in\mathbb F$ we have that (using the notation from the previous theorem) $\Pvec_{\K_\varphi^\F} = \Pvec_\varphi$ is not signed monic. Thus, by Theorem \ref{thm: characterization of PC}, $\varphi$ is not equivalent to any $\PC$ formula.
\end{IEEEproof}

\noindent This result, together with Corollary \ref{cor: easy comparisons}, shows that $\PO$ and $\PC$ are incomparable. Furthermore, it immediately entails another strict inclusion.

\begin{corollary}\label{cor: PC smaller than PCO}
   $\PC <\PCO$.  
\end{corollary}

%Now observe that formulae of the form $\Psi^\F$  %fix a signature and take $\F\not\sim\G$. The formula $\Psi^\F \sqcup \Psi^\G$ is 
%are in $\PC$, and yet they are obviously not  closed under change of laws; thus, by Lemma \ref{lemma: P closed under change of laws}, there is no equivalent formula in $\PP$. Thus, unsurprisingly:
%\[
%\PP < \PC.
%\]
%The same argument, since also $\PO$ is closed under change of laws, shows that
%\[
%\PO < \PCO.
%\]












%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Expressivity of $\PCO$}\label{subs: expressivity of PCO}

We are finally ready to characterize the expressive power of $\PCO$.

\begin{theorem}\label{thm: characterization of PCO}
Let $\K$ be a class of causal multiteams of signature $\sigma$. $\K$ is definable by a $\PCO_{\sigma}$ formula if and only if 1) it has the empty multiteam property, 2) it is closed under rescaling, and 3) $\K = \bigcup_{\F\in\mathbb{F}_\sigma}\K^\F$, where  each $\K^\F$ is a signed binary set of causal multiteams of team component $\F$.
\end{theorem}

\begin{IEEEproof}
The argument is very similar as in the proof of Theorem \ref{thm: characterization of PC}.
In the left-to-right direction, we need to use Lemma \ref{lemma: PO is linear} instead of Lemma \ref{lemma: P is signed monic} when proving that $\K^\F$ is signed binary. In the right-to-left direction, we use Theorem \ref{thm: characterization of PO} instead of Theorem \ref{thm: characterization of P}. 
\end{IEEEproof}

\vspace{5pt}

%For establishing $\PC < \PCO$, consider the formula $\varphi \dfn (\alpha_1\lor\alpha_2\lor\alpha_3)\supset \Pr(\alpha_1\lor\alpha_2) \leq \frac{1}{3}$ from Proposition \ref{example: PO greater than P}. It is a $\PCO$ formula with a signed binary probability set not expressible as a finite union of solution sets of systems of signed monic inequalities. Now suppose for the sake of contradiction that $\varphi$ is equivalent to some $\PC$ formula $\theta$. $(\K_\theta)^\F$ (the restriction of $\K_\theta$ to causal multiteams of function component $\F$) is then signed monic (by Theorem \ref{thm: characterization of PC}). However, since $\varphi\in\PO$, it is closed under change of laws; thus
%$\Pvec_{\K_\varphi} =  \bigcup_{\F\in\mathbb{F}_\sigma}\Pvec_{(\K_\theta)^\F}$, i.e. $\Pvec_{\K_\varphi}$ is a finite union of solution sets of systems of signed monic inequalities, a contradiction.


%$\Pvec_{(\K_\theta)^\F} = \Pvec_{\K_\theta} = \Pvec_{\K_\varphi}$. But then $\Pvec_{\K_\varphi}$ is signed monic, a contradiction. Thus $\PC < \PCO$.


By Theorem \ref{theorem: expressivity of PCOinf}, $\PCO^\omega$ formulae may characterize arbitrary probability sets. By Theorem \ref{thm: characterization of PCO}, instead, we know that the probability sets of $\PCO$
 formulae are all definable in terms of linear inequalities. A strict inclusion of languages immediately follows.\footnote{This strict inclusion is also proved in \cite{BarSan2023} via a counting argument.}
 \begin{corollary}\label{cor: PCO smaller than PCOinf}
 $\PCO < \PCO^\omega$.    
 \end{corollary}

\section{Definability of probabilistic atoms}\label{sec:teamsemantics}

Next we briefly explore the relationships of our logics and probabilistic atoms studied in probabilistic and multiteam semantics.
We consider the dependence atom by V\"a\"an\"anen \cite{Vaa2007}, and marginal distribution identity and probabilistic independence atoms by Durand et al. \cite{DurHanKonMeiVir2016}.

The dependence atom $\dep{\SET X}{\SET Y}$ expresses that the values of $\SET X$ functionally determine the values of $\SET Y$.
Dependence atoms can be expressed already in $\PO$:
\[
\dep{\SET X}{\SET Y} \dfn  \bigwedge_{\SET{x}\in \ran(\SET{X})} \bigsqcup_{\SET{y}\in \ran(\SET{Y})} \SET X = \SET x \supset \SET Y= \SET y
\]

The marginal distribution identity atom $\SET{X} \approx \SET{Y}$ states that the marginal distributions induced by $\SET{X}$ and $\SET{Y}$ are identical. This  can be defined in $\PP$ by
\[
\SET{X} \approx \SET{Y} \dfn \bigwedge_{\SET{x}\in \ran(\SET{X})\cup \ran(\SET{Y})} \Pr(\SET X=\SET x)= \Pr(\SET Y=\SET x).
\]

Marginal probabilistic independence and conditional probabilistic independence atoms inherit their semantics from probability theory. The atom $\SET{X} \pindep_{\SET{Z}} \SET{Y}$ states that for any given value for the variables in $\SET{Z}$ the variable sets $\SET{X}$ and $\SET{Y}$ are probabilistically independent.  The atoms can be expressed by using the conditional probabilistic comparison atoms:
\begin{align*}
\SET{X} \pindep \SET{Y} &\dfn \bigwedge_{\substack{\SET{x}\in \ran(\SET{X})\\ \SET{y}\in \ran(\SET{Y})}} \Pr(\SET X=\SET x)= \Pr(\SET X=\SET x \mid \SET Y= \SET y)\\
%
\SET{X} \pindep_{\SET{Z}} \SET{Y} &\dfn \bigwedge_{\substack{\SET{x}\in \ran(\SET{X})\\ \SET{y}\in \ran(\SET{Y})\\\SET{z}\in \ran(\SET{Z})}} \Pr(\SET X=\SET x \mid \SET Z=\SET z)= \Pr(\SET X=\SET x \mid \SET Y \SET Z= \SET y \SET z)
%
\end{align*}
Hence the atoms (and the dependence atom expressed as $\SET{Y} \pindep_{\SET{X}} \SET{Y}$) are expressible in $\PP$ extended with the conditional probability comparison atoms.

The above definitions of atoms imply that our languages, if enriched with conditional probability atoms and arbitrary applications of the disjunction $\lor$, are strong enough to express properties of multiteams that are expressible in quantifier free fragments of the logics $\mathrm{FO}(\pindep)$ and $\mathrm{FO}(\approx)$, over any fixed finite structure. The expressivity and complexity of these logics have been thoroughly studied in the probabilistic and multiteam semantics literature (see \cite{DurHanKonMeiVir2016,DurHanKonMeiVir2018,GradelW2022,Wilke2022, HanHirKonKulVir2019,HanVir2022,HKBV2020}).  
It is an open question whether the probabilistic independence atoms are already expressible in $\PCO$.
%We show that conditional comparison atoms are not expressible in $\PCO$. 
%
%
However, we are able to show that conditional comparison atoms are not. % undefinable in $\PCO$. %\commf{Maybe we should anticipate the issue in the introduction?} %A cross-comparison is an expression of the form  
%\[
%\Pr(\alpha \mid \beta)\vartriangleleft \Pr(\gamma \mid \delta)
%\]
%whose semantics is given by the condition
%\begin{itemize}
%    \item $T\models \Pr(\alpha \mid \beta)\vartriangleleft \Pr(\gamma \mid \delta)$ iff 
%\end{itemize}

\begin{theorem}\label{thm: undefinability of conditional comparison}
The comparison atoms
$
\Pr(\alpha \mid \beta)\vartriangleleft \Pr(\gamma \mid \delta)$ and 
%
$\Pr(\alpha \mid \beta)\vartriangleleft \Pr(\gamma)$,
%
(where $\vartriangleleft \in \{\leq,\geq,<,>,=\}$) are not, in general, expressible in $\PCO$.
%(and thus, a fortiori, they are not definable in $\PCO$).
\end{theorem}

\begin{IEEEproof}
\begin{comment}
\commf{**** UNDER CONSTRUCTION ****}



Let us first consider the first kind of atom.
Fix a signature $\sigma$ and take four distinct assignments $s_i,s_j,s_k,s_l\in \mathbb  B_\sigma$. Let $\Al_i,\Al_j,\Al_k,\Al_l$ be the corresponding formulae as defined earlier on. The atom 
\[
\varphi \dfn \Pr(\Al_k \lor \Al_i \mid \Al_l \lor \Al_i) \vartriangleleft  \Pr(\Al_l \lor \Al_j \mid \Al_k \lor \Al_j)
\]
is satisfied trivially in causal multiteams %with no copies of either  $s_i,s_j,s_k$ or $s_l$, i.e. $\Pvec_\varphi$ contains the polytopes defined by 
\corrf{that satisfy the inequalities $\epsilon_l + \epsilon_i\leq 0$ or $\epsilon_k + \epsilon_j\leq 0$.}  For causal multiteams $T$ that \corrf{satisfy the negations of these inequalities}, we have:
\begin{align*}
 & T\models \Pr(\Al_k \lor \Al_i \mid \Al_l \lor \Al_i) \vartriangleright  \Pr(\Al_l \lor \Al_j \mid \Al_k \lor \Al_j) \\
 \iff & P_T((\Al_k \lor \Al_i)\land(\Al_l \lor \Al_i))\cdot P_T(\Al_k \lor \Al_j)   \\
 & \hspace{30pt} \vartriangleright P_T((\Al_l \lor \Al_j)\land(\Al_k \lor \Al_j)) \cdot P_T(\Al_l \lor \Al_i) \\
 \iff &  P_T(\Al_i)\cdot P_T(\Al_k \lor \Al_j)  \vartriangleright  P_T(\Al_j) \cdot P_T(\Al_l \lor \Al_i) \\
 \iff & P_T(\Al_i)\cdot P_T(\Al_k) + P_T(\Al_i)\cdot P_T(\Al_j)  \\
 &  \hspace{30pt}  \vartriangleright P_T(\Al_j) \cdot P_T(\Al_l) + P_T(\Al_j) \cdot P_T(\Al_i) \\
 \iff & \epsilon_i^T \cdot \epsilon_k^T \vartriangleright \epsilon_j^T \cdot \epsilon_l^T \\
 \iff & \epsilon_i^T \vartriangleright \frac{\epsilon_j^T \cdot \epsilon_l^T}{\epsilon_k^T}.
\end{align*}

Fix a \corrf{$T$ satisfying the inequalities $\epsilon_k^T + \epsilon_j^T > 0$, $\epsilon_l^T = \delta >0$, and $\epsilon_i^T+\epsilon_j^T+\epsilon_l^T + \delta=1$. The probability set of the formula $\varphi \land P(\Al_l)= \delta \land \Pr(\Al_i \lor \Al_j\lor\Al_k) = 1-\delta$ is %the $l$-projection (for $\epsilon_l = \delta$) of $\Pve_\varphi$, i.e.
the subset of $\Delta^3$ defined by the inequations $\epsilon_i \vartriangleright \frac{\epsilon_j \cdot \epsilon_l}{\epsilon_k}$,  $\epsilon_l = \delta$ and $\epsilon_i+\epsilon_j+\epsilon_l + \delta=1$. Consider the intersection of its frontier with the plane $\epsilon_l = \delta$; this can be thought of as a subset of $\Delta^2$ defined by the equation $\epsilon_i = \frac{\epsilon_j \cdot \delta}{\epsilon_k}$. Since furthermore we must have $\epsilon_i+\epsilon_j+\epsilon_l + \delta=1$, we can rewrite the equation as
\begin{align*}
  & \epsilon_i = \frac{(1-\epsilon_i-\epsilon_k-\delta)\cdot \delta}{\epsilon_k}\\
\iff  & \epsilon_i\cdot\epsilon_k = \delta - \delta\epsilon_i-\delta\epsilon_k-\delta^2 \\
 \iff & 2\epsilon_i\cdot\epsilon_k +  2\delta\epsilon_i + 2\delta\epsilon_k + 2(\delta^2 -\delta) = 0.  \\
\end{align*}
}

\vspace{-30pt}

\corrf{
\noindent This is the equation of a conic (in $\Delta^2$). It is degenerate iff its homogeneous discriminant is $0$ (see e.g. \cite{Spa2007}). The homogeneous discriminant is
\begin{equation*}
 \operatorname{det}\left(\begin{array}{ccc}
 0 & 1 & \delta\\
 1 & 0 & \delta\\
 \delta & \delta & 2\delta^2 - 2\delta \\
 \end{array}\right)    = -[( 2\delta^2 - 2\delta) - \delta^2]+\delta\cdot\delta = 2\delta\\
\end{equation*}
which is $0$ if and only if $\epsilon_l^T = \delta$ is $0$. Thus, with our choice of $\delta >0$, the conic is nondegenerate. 
}
\corrf{
Then, the frontier of the probability set of the formula $\varphi \land \Pr(\Al_l)= \delta \land \Pr(\Al_i \lor \Al_j\lor\Al_k) = 1-\delta$ is the union of some hyperplanes together with a set whose projection on $\epsilon_l = \delta$ is a nondegenerate conic. Clearly, such a probability set cannot be expressed by linear (in particular, signed monic)  inequalities, and thus, by Theorem \ref{thm: characterization of PO}, $\varphi \land P(\Al_l)= \delta \land \Pr(\Al_i \lor \Al_j\lor\Al_k) = 1-\delta$ is not expressible $\PO$. 
}
\corrf{
Now, remember that there is only a finite number of $\F\in\mathbb{F_\sigma}$. So, since a nondegenerate conic is an infinite set, there must be at least one $\F$  such that the projection on $\epsilon_l = \delta$ of the frontier of the probability set of $\varphi \land P(\Al_l)= \delta \land \Pr(\Al_i \lor \Al_j\lor\Al_k) = 1-\delta \land\Phi^\F$ contains a continuous piece of the conic. Thus, by Theorem \ref{thm: characterization of PCO}, we also have that $\varphi \land P(\Al_l)= \delta \land \Pr(\Al_i \lor \Al_j\lor\Al_k) = 1-\delta$ is not expressible $\PCO$, and thus $\varphi$ is not expressible in $\PCO$, against our initial assumption. 
}

\commf{**** END CONSTRUCTION SITE****}


Let us first consider the first kind of atom.
Fix a signature $\sigma$ and take four distinct assignments $s_i,s_j,s_k,s_l\in \mathbb  B_\sigma$. Let $\Al_i,\Al_j,\Al_k,\Al_l$ be the corresponding formulae as defined earlier on. The atom 
\[
\varphi \dfn \Pr(\Al_k \lor \Al_i \mid \Al_l \lor \Al_i) \vartriangleleft  \Pr(\Al_l \lor \Al_j \mid \Al_k \lor \Al_j)
\]
is satisfied trivially in causal multiteams with no copies of either  $s_i,s_j,s_k$ or $s_l$, i.e. $\Pvec_\varphi$ contains the polytopes defined by the inequalities $\epsilon_i\leq 0$, resp. $\epsilon_j\leq 0$, $\epsilon_k\leq 0$, $\epsilon_l\leq 0$.  For causal multiteams $T$ that do contain these assignments, we have:
\begin{align*}
 & T\models \Pr(\Al_k \lor \Al_i \mid \Al_l \lor \Al_i) \vartriangleright  \Pr(\Al_l \lor \Al_j \mid \Al_k \lor \Al_j) \\
 \iff & P_T((\Al_k \lor \Al_i)\land(\Al_l \lor \Al_i))\cdot P_T(\Al_k \lor \Al_j)   \\
 & \hspace{30pt} \vartriangleright P_T((\Al_l \lor \Al_j)\land(\Al_k \lor \Al_j)) \cdot P_T(\Al_l \lor \Al_i) \\
 \iff &  P_T(\Al_i)\cdot P_T(\Al_k \lor \Al_j)  \vartriangleright  P_T(\Al_j) \cdot P_T(\Al_l \lor \Al_i) \\
 \iff & P_T(\Al_i)\cdot P_T(\Al_k) + P_T(\Al_i)\cdot P_T(\Al_j)  \\
 &  \hspace{30pt}  \vartriangleright P_T(\Al_j) \cdot P_T(\Al_l) + P_T(\Al_j) \cdot P_T(\Al_i) \\
 \iff & \epsilon_i^T \cdot \epsilon_k^T \vartriangleright \epsilon_j^T \cdot \epsilon_l^T \\
 \iff & \epsilon_i^T \vartriangleright \frac{\epsilon_j^T \cdot \epsilon_l^T}{\epsilon_k^T}.
\end{align*}
Now, fix one such $T$ (so that, in particular, $\epsilon_j^T, \epsilon_l^T \neq 0$) and consider the section of $\Pvec_\varphi$ where $\epsilon_j, \epsilon_l$ attain these values; such section is defined (in $\Delta^{n-1}$) by the (in)equalities $\epsilon_i \vartriangleright \frac{\epsilon_j^T \cdot \epsilon_l^T}{\epsilon_k}$, $\epsilon_j = \epsilon_j^T$ and $\epsilon_l = \epsilon_l^T$. 
Thus, its frontier contains (the projection on $\Delta^{n-1}$ of) a hyperbole.  But then, if $\varphi$ were expressible in $\PCO$, then also $\varphi \land P(\Al_j)=\epsilon_j^T \land P(\Al_l)=\epsilon_l^T$  would be; but the probability set of this latter formula is the union of hyperplanes and of a set one of whose sections is a hyperbole, and so it is not a finite union of signed monic polytopes, contradicting Theorem \ref{thm: characterization of PCO}. \commf{Rethink this first part. we should pick explicit values $\epsilon_{j/l}$ so that the conic intersects the interior of $\Delta^1$.}

The second kind of atom is treated by similar calculations, by defining a set %which
whose frontier contains a (nondegenerate) conic. More precisely, picking $\alpha, \beta, \gamma$ as above, one obtains a conic of equation $\epsilon_i(1-\epsilon_j-\epsilon_k)-\epsilon_l(\epsilon_l+\epsilon_k) = 0$. Its $(i,k)$ projection for $\epsilon_j=\epsilon_l=\frac{1}{2}$ has equation $\epsilon_i(1-\frac{1}{2}-\epsilon_k)-\frac{1}{2}(\frac{1}{2}+\epsilon_k) = 0$ or, equivalently, $\epsilon_k = \frac{2\epsilon_i-1}{4\epsilon_1 +2}$. Since numerator and denominator are both irreducible, this is not a linear expression, hence the conic is nondegenerate. Since furthermore this conic intersects the interior of $\Delta^1$ (since e.g. the point $(\epsilon_i = \frac{3}{4}, \epsilon_k = \frac{1}{10})$ belongs to the curve, and $\frac{3}{4} + \frac{1}{10} = \frac{17}{20} <1$), the same argument as before goes through.
%, some of whose $(j,k)$-sections intersect $\Delta^1$;\footnote{As can be seen by plotting down the graph of the equation, say for $\epsilon_i=\frac{1}{2}$.} thus, as before, a set that is not definable by linear inequalities.   
%\commf{I wish I had a clean argument...}

\commf{*** DETAILED PROOF OF PART 2 ***}

Due to the equivalence $\Pr(\alpha \mid \beta)\vartriangleleft \Pr(\gamma \mid \top) \equiv \Pr(\alpha \mid \beta)\vartriangleleft \Pr(\gamma)$, it suffices to prove the theorem for $\Pr(\alpha \mid \beta)\vartriangleleft \Pr(\gamma)$.

Fix a signature $\sigma$ and take four distinct assignments $s_i,s_j,s_k,s_l\in \mathbb  B_\sigma$. Let $\Al_i,\Al_j,\Al_k,\Al_l$ be the corresponding formulae as defined earlier on. The atom 
\[
\varphi \dfn \Pr(\Al_k \lor \Al_i \mid \Al_l \lor \Al_i) \vartriangleleft  \Pr(\Al_l \lor \Al_j)
\]
is satisfied trivially in causal multiteams %with no copies of either  $s_i,s_j,s_k$ or $s_l$, i.e. $\Pvec_\varphi$ contains the polytopes defined by 
that satisfy the inequality $\epsilon_l + \epsilon_i\leq 0$.  For causal multiteams $T$ that satisfy the negation of this inequality, we have:
\begin{align*}
 & T\models \Pr(\Al_k \lor \Al_i \mid \Al_l \lor \Al_i) \vartriangleright  \Pr(\Al_l \lor \Al_j) \\
 \iff & P_T((\Al_k \lor \Al_i)\land(\Al_l \lor \Al_i))  \vartriangleright P_T(\Al_l \lor \Al_j) \cdot P_T(\Al_l \lor \Al_i) \\
\iff & P_T(\Al_i)  \vartriangleright P_T(\Al_l \lor \Al_j) \cdot P_T(\Al_l \lor \Al_i) \\
\iff & \epsilon_i^T \vartriangleright (\epsilon_l^T + \epsilon_j^T)\cdot (\epsilon_l^T + \epsilon_i^T)\\
 \iff & \epsilon_i^T \vartriangleright (\epsilon_l^T)^2 +  \epsilon_l^T\epsilon_i^T + \epsilon_j^T\epsilon_l^T + \epsilon_j^T\epsilon_i^T.
\end{align*}

Fix a $T$ satisfying $\epsilon_i^T = \delta >0$ and $\epsilon_j^T+\epsilon_k^T+\epsilon_l^T + \delta=1$. Now, the probability set of $\varphi \land P(\Al_l)= \delta \land \Pr(\Al_j \lor \Al_k\lor\Al_l) = 1-\delta$ is  %the $l$-projection (for $\epsilon_l = \delta$) of $\Pve_\varphi$, i.e.
the subset of $\Delta^3$ defined by the equations $\epsilon_i \vartriangleright (\epsilon_l)^2 +  \epsilon_l\epsilon_i + \epsilon_j\epsilon_l + \epsilon_j\epsilon_i$, $\epsilon_i = \delta$ and $\epsilon_j+\epsilon_k+\epsilon_l + \delta=1$. Consider the intersection of its frontier with the plane $\epsilon_l = \delta$; this can be thought of as a subset of $\Delta^2$ defined by the equation $\delta \vartriangleright \epsilon_l^2 +  \delta\epsilon_l + \epsilon_j\epsilon_l + \delta\epsilon_j$. Since furthermore we must have $\epsilon_j+\epsilon_k+\epsilon_l + \delta=1$, we can eliminate $\epsilon_j$ and rewrite the equation as
\jonni{Why does the $\vartriangleright$ disappear below?}\commf{I am looking only at the frontier, so it should be $=$ everywhere.}
\begin{align*}
 & \delta \vartriangleright \epsilon_l^2 +  \delta\epsilon_l + (1-\delta-\epsilon_k-\epsilon_l)(\epsilon_l + \delta) \\
 \iff & \delta = \epsilon_l^2 + \delta\epsilon_l + \epsilon_l -\delta\epsilon_l - \epsilon_k\epsilon_l - \epsilon_l^2 
 + \delta -\delta^2 - \delta\epsilon_k - \delta \epsilon_l \\
 \iff & 2\epsilon_k\epsilon_l + 2\delta\epsilon_k + (2\delta-2)\epsilon_l
 +2\delta^2 = 0.
 \end{align*}
\noindent This is the equation of a conic (in $\Delta^2$). It is degenerate iff its homogeneous discriminant is $0$ (see e.g. \cite{Spa2007}). The homogeneous discriminant is
\begin{equation*}
 \operatorname{det}\left(\begin{array}{ccc}
 0 & 1 & \delta\\
 1 & 0 & \delta-1\\
 \delta & \delta-1 & 2\delta^2 \\
 \end{array}\right)    = -( 2\delta^2 - \delta^2 + \delta) + \delta(\delta-1) = %- \delta^2 -\delta +\delta^2-\delta = 
 -2\delta\\
\end{equation*}
which is $0$ if and only if $\epsilon_l^T = \delta$ is $0$. Thus, with our choice of $\delta >0$, the conic is nondegenerate. 

The frontier of the probability set of $\varphi \land \Pr(\Al_i)= \delta \land \Pr(\Al_j \lor \Al_k\lor\Al_l) = 1-\delta$ is the union of some hyperplanes together with a set whose projection on $\epsilon_i = \delta$ is a nondegenerate conic. Clearly, such a probability set cannot be expressed by linear (in particular, signed monic)  inequalities, and thus, by Theorem \ref{thm: characterization of PO}, $\varphi \land P(\Al_i)= \delta \land \Pr(\Al_j \lor \Al_k\lor\Al_l) = 1-\delta$ is not expressible in $\PO$. 

Recall that there are only a finite number of $\F\in\mathbb{F_\sigma}$. So, since a nondegenerate conic is an infinite set, there must be at least one $\F$  such that the projection on $\epsilon_l = \delta$ of the frontier of the probability set of $\varphi \land P(\Al_l)= \delta \land \Pr(\Al_i \lor \Al_j\lor\Al_k) = 1-\delta \land\Phi^\F$ contains a continuous piece of the conic. Thus, by Theorem \ref{thm: characterization of PCO},  $\varphi \land P(\Al_l)= \delta \land \Pr(\Al_i \lor \Al_j\lor\Al_k) = 1-\delta$ is not expressible $\PCO$, and thus neither is $\varphi$. 
\commf{*** END DETAILED PROOF OF PART 2 ***}
\end{comment}
%\commf{*** DETAILED PART 2 SECOND ATTEMPT ***}
Due to the equivalence $\Pr(\alpha \mid \beta)\vartriangleleft \Pr(\gamma \mid \top) \equiv \Pr(\alpha \mid \beta)\vartriangleleft \Pr(\gamma)$, it suffices to prove the theorem for $\Pr(\alpha \mid \beta)\vartriangleleft \Pr(\gamma)$.

Fix a signature $\sigma$ and take four distinct assignments $s_i,s_j,s_k,s_l\in \mathbb  B_\sigma$. Let $\Al_i,\Al_j,\Al_k,\Al_l$ be the corresponding formulae as defined earlier on. Consider the atom 
\[
\varphi \dfn \Pr(\Al_k \lor \Al_i \mid \Al_l \lor \Al_i) \vartriangleleft  \Pr(\Al_l \lor \Al_j).
\]
Now fix a $\delta\in (0,1)\cap \mathbb Q$ and consider the formula 
\[
\Xi :=    \varphi   \land    \Pr(\Al_i)= \delta   \land    \Pr(\Al_j \lor \Al_k \lor \Al_l) = 1-\delta. 
\]
We will show that $\Xi$ is not equivalent to any $\PCO$ formula; from this it immediately follows that also $\varphi$ is not equivalent to any $\PCO$ formula.  

Let $T$ be a causal multiteam satisfying $T\models \Xi$. Since then $T\models \Pr(\Al_i)= \delta $ and $\delta >0$, we have in particular that $\epsilon_l^T + \epsilon_i^T > 0$. Thus, the following equivalences hold:
%is satisfied trivially in causal multiteams 
%that satisfy the inequality $\epsilon_l + \epsilon_i\leq 0$.  For causal multiteams $T$ that satisfy the negation of this inequality, we have:
\begin{align*}
 & T\models \Pr(\Al_k \lor \Al_i \mid \Al_l \lor \Al_i) \vartriangleright  \Pr(\Al_l \lor \Al_j) \\
 \iff & P_T((\Al_k \lor \Al_i)\land(\Al_l \lor \Al_i))  \vartriangleright P_T(\Al_l \lor \Al_j) \cdot P_T(\Al_l \lor \Al_i) \\
\iff & P_T(\Al_i)  \vartriangleright P_T(\Al_l \lor \Al_j) \cdot P_T(\Al_l \lor \Al_i) \\
\iff & \epsilon_i^T \vartriangleright (\epsilon_l^T + \epsilon_j^T)\cdot (\epsilon_l^T + \epsilon_i^T)\\
 \iff & \epsilon_i^T \vartriangleright (\epsilon_l^T)^2 +  \epsilon_l^T\epsilon_i^T + \epsilon_j^T\epsilon_l^T + \epsilon_j^T\epsilon_i^T.
\end{align*}

In the following we will omit the $T$ superscripts for ease of reading. Since furthermore $T\models \Pr(\Al_i)= \delta$, we have $\delta \vartriangleright \epsilon_l^2 +  \delta\epsilon_l + \epsilon_j\epsilon_l + \delta\epsilon_j$.


Then, since $T\models \Pr(\Al_j \lor \Al_k \lor \Al_l) = 1-\delta$, we must have $\epsilon_j+\epsilon_k+\epsilon_l + \delta=1$, and thus we can eliminate $\epsilon_j$ and rewrite the inequality as
\begin{align*}
 & \delta \vartriangleright \epsilon_l^2 +  \delta\epsilon_l + (1-\delta-\epsilon_k-\epsilon_l)(\epsilon_l + \delta) \\
 \iff & \delta \vartriangleright \epsilon_l^2 + \delta\epsilon_l + \epsilon_l -\delta\epsilon_l - \epsilon_k\epsilon_l - \epsilon_l^2 
 + \delta -\delta^2 - \delta\epsilon_k - \delta \epsilon_l \\
 \iff & 2\epsilon_k\epsilon_l + 2\delta\epsilon_k + (2\delta-2)\epsilon_l
 +2\delta^2 \vartriangleright 0.
 \end{align*}
\noindent The frontier of the set defined by this inequality contains the surface (in $\Delta^3$) of equation $2\epsilon_k\epsilon_l + 2\delta\epsilon_k + (2\delta-2)\epsilon_l
 +2\delta^2 = 0$. The section for $\epsilon_i = \delta$ of this surface is a conic.  It is degenerate iff its homogeneous discriminant is $0$ (see e.g. \cite{Spa2007}). The homogeneous discriminant is
\begin{equation*}
 \operatorname{det}\left(\begin{array}{ccc}
 0 & 1 & \delta\\
 1 & 0 & \delta-1\\
 \delta & \delta-1 & 2\delta^2 \\
 \end{array}\right)    = -( 2\delta^2 - \delta^2 + \delta) + \delta(\delta-1) =  
 -2\delta\\
\end{equation*}
which is $0$ if and only if $\epsilon_l^T = \delta$ is $0$. Thus, with our choice of $\delta >0$, the conic is nondegenerate. 

The frontier of the probability set of $\Xi$ is the union of some hyperplanes together with a set whose section for $\epsilon_i = \delta$ is a nondegenerate conic. Clearly, such a probability set is not a union of hyperplanes, and thus it cannot be expressed by linear (in particular, signed monic)  inequalities. Hence, by Theorem \ref{thm: characterization of PO}, $\Xi$ is not expressible in $\PO$. 

Recall that there are only a finite number of $\F\in\mathbb{F_\sigma}$. So, since a nondegenerate conic is an infinite set, there must be at least one $\F$  such that section for $\epsilon_l = \delta$ of the frontier of the probability set of $\Xi \land\Phi^\F$ contains an (infinite) segment of the conic. Hence, as above, we conclude that the probability set of $\Xi \land\Phi^\F$ is not defined by signed binary inequalities. Thus, by Theorem \ref{thm: characterization of PCO},  $\Xi$ is not expressible $\PCO$, and thus neither is $\varphi$. 
\end{IEEEproof}


%\begin{IEEEproof}
%Let us first consider the first kind of atom.
%Fix a signature $\sigma$ and take four distinct assignments $s_i,s_j,s_k,s_l\in \mathbb  B_\sigma$. Let $\alpha_i,\alpha_j,\alpha_k,\alpha_l$ be the corresponding formulae as defined earlier on. We then have, for any causal multiteam $T$ of signature $\sigma$:
%\begin{align*}
% & T\models \varphi: \Pr(\alpha_j \mid \alpha_i) \vartriangleleft  \Pr(\alpha_l \mid \alpha_k) \\
%\iff & P_T(\alpha_i \land \alpha_j ) \cdot P_T(\alpha_k ) \vartriangleleft  P_T(\alpha_k \land \alpha_l ) \cdot P_T(\alpha_i ) \\
%\iff & P_T(\alpha_i)\cdot P_T(\alpha_k ) +  P_T(\alpha_j ) \cdot P_T(\alpha_k ) \vartriangleleft  P_T(\alpha_k) \cdot P_T(\alpha_i) + P_T(\alpha_l ) \cdot P_T(\alpha_i ) \\
%\iff & \epsilon^T_j \cdot \epsilon^T_k \vartriangleleft \epsilon^T_l \cdot \epsilon^T_i \\
%\iff & \epsilon^T_j \vartriangleleft \frac{\epsilon^T_l \cdot \epsilon^T_i}{\epsilon^T_k}\\
% \end{align*}
%Now, it's easy to build a $T$ where $\varphi$ holds and where $\epsilon^T_l$ and $\epsilon^T_i$ are not $0$. Let us consider the section of $\Pvec_{\varphi}$ where $\epsilon_,\epsilon_i$ attain these values; such section is defined by the (in)equalities $\epsilon_j \vartriangleleft \frac{\epsilon^T_l \cdot \epsilon^T_i}{\epsilon_k}$, $\\epsilon_l = \epsilon^T_l$ and $\epsilon_i = \epsilon^T_i$; so its frontier contains an hyperbole. Thus, if $\Pvec_\varphi$ were definable in $\PCO$, by Theorem \ref{thm: characterization of PCO} we would have a way to define an hyperbole in terms linear inequalities, which is impossible \commf{(Source??)}.
%
%The second kind of atom is treated by similar calculations.
%\end{IEEEproof}

%In conclusion, we have obtained the following strict inclusions among languages:

%\includegraphics[scale=0.5]{languageseparationgraph}

%\commf{Let us make a proper Tikz picture}
%\jonni{Picture can be put to the introduction.}
%\commf{I wonder; perhaps the ideal place is immediately after we have given the formal definitions of the languages.}

%By a similar method we can prove the undefinability of probabilistic conditional independence atoms in $\PCO$. It suffices to show that the \emph{marginal} independence atoms are inexpressible in $\PCO$.

%\begin{theorem}
%There are expressions of the form $\alpha \pindep \beta$, with $\alpha,\beta\in \CO$, that are not equivalent to any $\PCO$ formula.    
%\end{theorem}

%\begin{IEEEproof}
%An expression $\alpha \pindep \beta$ holds in a causal multiteam $T$ if and only if $P_T(\alpha)=0$ or $P_T(\beta\mid\alpha)=P_T(\beta)$. Fix a signature $\sigma$ and let $s_i, s_j,s_k$ be three distinct assignments of signature $\sigma$.  Then the expression $\Al_i \lor \Al_l \pindep \Al_i\lor\Al_k$ holds in $T$ if and only if  $P_T(\Al_i\lor\Al_k)=0$ or $P_T(\Al_i \lor \Al_l\mid\Al_i\lor\Al_k)=P_T(\Al_i \lor \Al_l)$. The former condition in characterized by the linear equality $\epsilon_i + \epsilon_k =0$. The latter can be shown (by similar calculations as in the proof of Theorem \ref{thm: undefinability of conditional comparison}) to be characterized by a quadratic equality, namely $\epsilon_i = \epsilon_l \cdot \epsilon_k + \epsilon_l \cdot \epsilon_i + \epsilon_i\cdot \epsilon_k + \epsilon_i^2$. The $k$-projections of these two figures are a line and a hyperbole, respectively, and it can be seen (say, by plotting the projection for $\epsilon_k=\frac{1}{2}$) that the hyperbole intersects $\Delta^1$. Thus, as in the previous theorem, the union of these two figures is not definable by linear inequalities.
%\end{IEEEproof}

%\commf{We should point out here that these results have as corollary that PCO < PCOomega.}

%\commf{It is perhaps an interesting open problem what is the expressivity of the purely probabilistic language that only has comparison atoms and no evaluation atoms. I have not tried.}



\section{Conclusion}\label{sec:conclusion}

\begin{comment}
\begin{table}
\begin{center}
\begin{tabular}{cccccc}\toprule
Logic & & \multicolumn{3}{c}{Closure properties} & References \\ \cmidrule{3-5}
&type of linear& change of & empty & empty  \\
&equations& laws &  multiteam  & multiteam & \\
& &  & \& rescaling  &  & \\\midrule
$\PP^-$ & monic & X & X  & X & Thm. \ref{thm: characterization of P}\\
$\PP$ & signed monic & X & X  & X & Thm. \ref{thm: characterization of P}\\
$\PO$ & signed binary & X & X   & X & Thm. \ref{thm: characterization of PO}\\
$\PC$ & union of signed monics &  & X  & X  & Thm. \ref{thm: characterization of PC} \\
$\PCO$ & union of signed binary &  &  X  & X  & Thm. \ref{thm: characterization of PCO}\\
$\PCO^\omega$ & (no restrictions)  &  & X  & X  &  \cite{BarSan2023}
\\\bottomrule\\
\end{tabular}
\caption{Characterization of expressive powers of logics on causal multiteams. 
E.g., a class $\mathcal{K}$ of causal multiteams is definable by a single $\PO$-formula if and only if $\mathcal{K}$ is signed binary and closed under change of laws and rescaling. Above we write that $\K$ is a union of signed binary, when $\K = \bigcup_{\F\in\mathbb{F}_\sigma}\K^\F$, where  each $\K^\F$ is a signed binary set of causal multiteams of team component $\F$.}
\label{table:exp}
\end{center}
\end{table}
\end{comment}


\begin{table}
\begin{center}
\begin{tabular}{ccccc}\toprule
Logic &  & \multicolumn{2}{c}{Closure properties} & References \\ \cmidrule{3-4}
& Type of linear & change of & rescaling & \\
& inequalities & laws & \& empty  & \\
&&& multiteam &\\\midrule
$\PP^-$ & monic & X & X & Thm. \ref{thm: characterization of P}\\
$\PP$ & signed monic & X & X & Thm. \ref{thm: characterization of P}\\
$\PO$ & signed binary & X & X  & Thm. \ref{thm: characterization of PO}\\
$\PC$ & union of signed monics &  & X  & Thm. \ref{thm: characterization of PC} \\
$\PCO$ & union of signed binary &  &  X  & Thm. \ref{thm: characterization of PCO}\\
$\PCO^\omega$ & (no restrictions)  &  & X &  \cite{BarSan2023}
\\\bottomrule\\
\end{tabular}
\caption{Characterisation of expressive powers of logics on causal multiteams.
E.g., a class $\mathcal{K}$ of causal multiteams is definable by a single $\PO$-formula if and only if $\mathcal{K}$ is signed binary, closed under change of laws and rescaling, and has the empty multiteam property. Above we write that $\K$ is a union of signed binary, when $\K = \bigcup_{\F\in\mathbb{F}_\sigma}\K^\F$, where  each $\K^\F$ is a signed binary set of causal multiteams of team component $\F$.}
\label{table:exp}
\end{center}
\end{table}

%\commf{Nice table! Was the use of capital letters intentional? Do you think we need to write all this in the caption?} \jonni{The style of caption is what IEEE have decided it to be.}



We embarked for a comprehensive study of the expressive power of logics for expressing probabilistic reasoning and causal inference in the unified setting of causal multiteam semantics.
We focused on the logic $\PCO$ that can express probability comparisons between different properties in a dataset, and encompasses interventionist counterfactuals and selective implications for describing consequences of actions and consequences of learning from observations, respectively. In addition, we considered the syntactic fragments $\PP^-$, $\PP$, $\PO$, and $\PC$ of $\PCO$ and discovered a strict expressivity hierarchy (see Figure \ref{fig:FIRSTCAUSALGRAPH} on page \pageref{fig:FIRSTCAUSALGRAPH}). Moreover, we discovered natural complete characterizations, for each of the aforementioned logics, based on the families of linear equations needed to define the corresponding classes of causal multiteams (satisfying some invariances); see Table \ref{table:exp} for an overview of our characterization results.
Finally, we established that conditional probability statements of the forms $\Pr(\alpha \mid \beta)\leq \Pr(\gamma \mid \delta)$ and $\Pr(\alpha \mid \beta)\leq \Pr(\gamma)$   
% $\Pr(\alpha \mid \beta)\leq \Pr(\gamma)$ nor marginal independence atoms $\alpha \pindep \beta$ 
are not in general expressible in $\PCO$, and separated $\PCO$ from its extension $\PCO^\omega$ with infinitary disjunctions (that is known to be expressively complete for all rescaling closed properties of causal multiteams \cite{BarSan2023}).

We conclude with some open problems and future directions of research:
\begin{itemize}
    \item In \cite{HanVir2022}, Hannula and Virtema established that definability in the so-called \emph{probabilistic inclusion logic} $\mathrm{FO}(\approx)$ can be reformulated in linear programming. It remains as an open problem, what is the precise fragment of linear programming that corresponds to probabilistic inclusion logic (similar to the results in Table \ref{table:exp}).
    \item Can (conditional) probabilistic independence atoms be expressed in $\PCO$? We conjecture the negative in line with \cite[Proposition 26]{HanVir2022}, that establish that it is not expressible in $\mathrm{FO}(\approx)$ (however the proof there relies on the use of quantifiers).
    \item How can our results be extended to cover infinite vocabularies? Here one might need to extend the languages with quantifiers ranging over data values.
%    \item What is the expressive power of $\PCO$ extended with the marginal distribution identity atom from \cite{HanVir2022}?
    \item Is there a finitary logic that is in some sense expressively complete with respect to all classes of causal multiteams?
\end{itemize}
Our characterisation results cover only logics that express linear properties of data. Can we generalize our results if some natural source of multiplication, such as conditional probabilistic independence or the conditional comparison atoms, are added to the logics? It was shown by Hannula et al. \cite{HKBV2020}  that the so-called \emph{probabilistic independence logic} is equiexpressive with a variant of existential second-order logic that has access to addition and multiplication of reals.

Finally, a promising direction for future work would be to study temporal causal inference (see e.g., \cite{Kleinberg11}) via (probabilistic) temporal logics by generalising \emph{temporal team semantics} introduced by Krebs et al. \cite{KrebsMV018} and further developed by Gutsfeld et al. \cite{GutsfeldMOV22}. 

 \section*{Acknowledgements}
Fausto Barbero was partially supported by the DFG grant VI 1045-1/1 and by the Academy of Finland grant 349803.
Jonni Virtema was partially supported by the DFG grant VI 1045-1/1 and by the Academy of Finland grant 338259.


%\commf{Other issues left open (but not sure if worth mentioning): 1) extending the framework and results to infinite signatures (which would require probabilistic teams, or measure teams, I guess); 2) definability by infinite sets of formulas; 3) stricter hierarchy results that take into account definability by infinite sets of formulas, 4) proof theory for PCO, 5) proof theory for PCO omega, 6) expressivity of PCO extended with arbitrary conditional probability atoms, 7) expressivity/proof theory of PCO (or fragments) extended with strict tensor. (Our discarded materials address 4 and (partially) 7; no idea how to approach the rest.)}

%\commf{Should the references have DOI, URL, etc.?}

%\bibliographystyle{apalike}
\bibliographystyle{splncs04}
\bibliography{iilogics}

\input{appendix.tex}

%\input{tensorscraps.tex}

%\input{prooftheory.tex}







\end{document}

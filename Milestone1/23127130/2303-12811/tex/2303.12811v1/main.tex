
\documentclass[10pt,journal,compsoc]{IEEEtran}


% *** CITATION PACKAGES ***
%
\ifCLASSOPTIONcompsoc
  % IEEE Computer Society needs nocompress option
  % requires cite.sty v4.0 or later (November 2003)
  \usepackage[nocompress]{cite}
\else
  % normal IEEE
  \usepackage{cite}
\fi
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of the IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% noadjust option (cite.sty V3.8 and later) if you want to turn this off
% such as if a citation ever needs to be enclosed in parenthesis.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 5.0 (2009-03-20) and later if using hyperref.sty.
% The latest version can be obtained at:
% http://www.ctan.org/pkg/cite
% The documentation is contained in the cite.sty file itself.
%
% Note that some packages require special options to format as the Computer
% Society requires. In particular, Computer Society  papers do not use
% compressed citation ranges as is done in typical IEEE papers
% (e.g., [1]-[4]). Instead, they list every citation separately in order
% (e.g., [1], [2], [3], [4]). To get the latter we need to load the cite
% package with the nocompress option which is supported by cite.sty v4.0
% and later. Note also the use of a CLASSOPTION conditional provided by
% IEEEtran.cls V1.7 and later.

% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  % \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi
% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/pkg/graphicx
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/pkg/epslatex
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). The IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex





%\usepackage[hidelinks]{hyperref} % adds hyper links inside the generated pdf file
\newcommand{\red}[1]{\begin{color}{red}#1\end{color}}
\usepackage{float}
\usepackage{threeparttable}
\usepackage[acronyms,nonumberlist,nopostdot,nomain,nogroupskip]{glossaries}
\usepackage{tablefootnote}
\usepackage{booktabs}
\newcommand{\ra}[1]{\renewcommand{\arraystretch}{#1}}
\usepackage{adjustbox}
\usepackage{pgfplots, pgfplotstable}
% for table
\usepackage{booktabs,makecell,multirow,hhline} 
\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\pgfplotsset{plot coordinates/math parser=false}
\newlength\fheight
\newlength\fwidth
\usetikzlibrary{plotmarks,patterns,decorations.pathreplacing,backgrounds,calc,arrows,arrows.meta,spy,matrix}
\usepgfplotslibrary{patchplots,groupplots,colorbrewer}
\usepackage{tikzscale}
% \usepackage{hyperref}


\usepackage[pdftex]{pict2e}
\usepackage{comment}



\newcolumntype{M}[1]{>{\centering\arraybackslash}m{#1}}
\usepackage{amsfonts}

\newif\ifexttikz
\exttikzfalse

\ifexttikz
	\usetikzlibrary{external}
	\tikzexternalize[prefix=figures/]
\fi

\usepackage{enumitem}
\usepackage{multirow}
%\usepackage{tkz-kiviat}
\newlength{\starsize}
\newlength{\starspread}
\tikzset{starsize/.code={\setlength{\starsize}{#1}},
         starspread/.code={\setlength{\starspread}{#1}}}
\tikzset{starsize=1mm,
         starspread=3mm}
\pgfdeclarepatternformonly[\starspread,\starsize]% variables
  {custom fivepointed stars}% name
  {\pgfpointorigin}% lower left corner
  {\pgfqpoint{\starspread}{\starspread}}% upper right corner
  {\pgfqpoint{\starspread}{\starspread}}% tilesize
  {% shape description
   \pgftransformshift{\pgfqpoint{\starsize}{\starsize}}
   \pgfpathmoveto{\pgfqpointpolar{18}{\starsize}}
   \pgfpathlineto{\pgfqpointpolar{162}{\starsize}}
   \pgfpathlineto{\pgfqpointpolar{306}{\starsize}}
   \pgfpathlineto{\pgfqpointpolar{90}{\starsize}}
   \pgfpathlineto{\pgfqpointpolar{234}{\starsize}}
   \pgfpathclose%
   \pgfusepath{fill}
  }         

\renewcommand{\figurename}{Fig.~}
%\renewcommand{\tablename}{Tab.}
\usepackage[font=footnotesize]{subcaption}
\usepackage[font=footnotesize]{caption}
\usepackage[T1]{fontenc}


\usepackage{mathtools}
\usepackage{array}
\newcolumntype{L}{>{\centering\arraybackslash}}
\input{acronyms.tex}
%\input{myTikz.tex}

\usepackage{hhline} % used for the top-most horizontal line! in order to fix the top left corner cell empty

\definecolor{Mycolor1}{HTML}{4b006e}
\definecolor{Mycolor2}{HTML}{7e1e9c}
\definecolor{Mycolor3}{HTML}{9a0eea}

\def\si{\tikz\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;}
\usepackage{ragged2e}
\usepackage[utf8]{inputenc}
\usepackage{pgfplots}
\usepackage{amsmath}
\usetikzlibrary{patterns}
% \setcopyright{acmcopyright}
\usepackage{soul}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\hyphenation{op-tical net-works semi-conduc-tor} 

% \newcommand\copyrighttext{%
%   \footnotesize \textcopyright 2012 IEEE. Personal use of this material is permitted.
%   Permission from IEEE must be obtained for all other uses, in any current or future
%   media, including reprinting/republishing this material for advertising or promotional
%   purposes, creating new collective works, for resale or redistribution to servers or
%   lists, or reuse of any copyrighted component of this work in other works.
%   DOI: \href{<http://tex.stackexchange.com>}{<DOI No.>}}




\begin{document}




\title{SignCRF: Scalable Channel-agnostic Data-driven Radio Authentication System}
%{%Real-Time Radio Fingerprinting Through Radio Frequency Signature Emulator}

\author{Amani Al-shawabka$^\dagger$,~\IEEEmembership{Student,~IEEE,}
        Philip Pietraski$^\ddagger$,~\IEEEmembership{Sr. Member,~IEEE,} 
        Sudhir B Pattar$^\ddagger$,~\IEEEmembership{Member,~IEEE,}
        Pedram~Johari$^\dagger$,~\IEEEmembership{Member,~IEEE,}
        and~Tommaso Melodia$^\dagger$,~\IEEEmembership{Fellow,~IEEE}% <-this % stops a space

\thanks{$^\dagger$Institute for the Wireless Internet of Things, Northeastern University, Boston, MA, USA, E-mail: \{al-shawabka.a, p.johari, t.melodia\}@northeastern.edu. $^\ddagger$InterDigital Inc., United States. E-mail: \{philip.pietraski, sudhir.pattar\}@interdigital.com.}
\thanks{This article is based upon work partially supported by the U.S. National
Science Foundation under grants CNS-2112471, and CNS1923789, and InterDigital Inc.}}
        

%\maketitle


\IEEEtitleabstractindextext{%

\begin{justify}
\begin{abstract}

Radio Frequency Fingerprinting through Deep Learning
(RFFDL) is a data-driven IoT authentication technique that leverages the unique hardware-level manufacturing imperfections associated with a particular device to recognize (``fingerprint'') the device itself based on variations introduced in the transmitted waveform.
%unmet need/challenge
Key impediments in developing robust and scalable \gls{rffdl} techniques that are practical in dynamic and mobile environments are the non-stationary behavior of the wireless channel and other impairments introduced by the propagation conditions. To date, the existing \gls{rffdl}-based techniques have only been able to demonstrate a desirable performance when the training and testing environment remains the same, which makes the solutions impractical.
%proposed solution
\textit{SignCRF} brings to the RFFDL landscape what it has been missing so far: a scalable, channel-agnostic data-driven radio authentication platform with unmatched precision in fingerprinting wireless devices based on their unique manufacturing impairments that is {\em independent of the dynamic nature of the environment or channel irregularities caused by mobility}. \textit{SignCRF} consists of: (i) a classifier developed in a base-environment with minimum channel dynamics, and finely trained to authenticate devices with high accuracy and at scale; (ii) an environment translator that is carefully designed and trained to remove the dynamic channel impact from RF signals while maintaining the radio's specific ``signature''; and (iii) a Max Rule module that selects the highest precision authentication technique between the baseline classifier and the environment translator per radio. We design, train, and validate the performance of \textit{SignCRF} for multiple technologies in dynamic environments and at scale (100 LoRa and 20 WiFi devices, the largest datasets available in the literature). We demonstrate that \textit{SignCRF} can significantly improve the \gls{rffdl} performance by achieving as high as 100\% correct authentication for WiFi devices and 80\% correctly authenticated LoRa devices, a 5x and 8x improvement when compared to the state-of-the-art respectively. Furthermore, we show that \textit{SignCRF}  is resilient to adversarial actions by reducing the device recognition accuracy from 73\% to 6\%, which translates into zero mis-authentication of adversary radios that try to impersonate legitimate devices, which has not been achieved by any prior \gls{rffdl} techniques.

%results

\end{abstract}
\end{justify}


\begin{IEEEkeywords}
Radio Fingerprinting, Deep Learning, Data-driven Authentication.
\end{IEEEkeywords}}




% make the title area
\maketitle
\IEEEdisplaynontitleabstractindextext
\IEEEpeerreviewmaketitle

\begin{picture}(0,0)(10,-430)
\put(0,0){
\put(0,0){\footnotesize This work has been submitted to the IEEE for possible publication.}
\put(0,-10){
\footnotesize Copyright may be transferred without notice, after which this version may no longer be accessible.}}
\end{picture}




\IEEEraisesectionheading{\section{Introduction and Motivation}\label{sec:intro}}

%\section{Introduction and Motivation}\label{sec:intro}
\glsresetall

%\noindent\textbf{Motivation:}

Achieving full-fledged  privacy and security for \gls{iot} systems is still a challenging problem. Applying traditional security techniques such as private- or public-key cryptography to \gls{iot} applications suffer from key limitations including their energy consumption inefficiency, required computation power, and scalability challenges~\cite{yang2017survey}. An alternative approach that has recently gained traction in the research and industry communities is the concept of \gls{rffdl}. The \gls{rffdl} is as an emerging data-driven authentication approach that has shown promising results in authenticating \gls{iot} radios in a more energy-efficient and scalable fashion~\cite{shawabka2020exposing,restuccia2019deepradioid,DARPA, sankhe2019oracle,merchant2018deep}. It relies on the hardware-level imperfections that are uniquely associated with the \gls{rf} analog circuitry of every single device, referred to as \gls{rf} ``\textit{fingerprint}'' or ``\textit{signature}''. %during the transmission process.
These distinctive features are extracted by training deep learning models that operate at the physical layer of the wireless network protocol stack, largely deployed at the base station side, with minimal impact on the user device's computation and power resources.

\begin{figure*}[t!]
    \centering
    \includegraphics[width=1\linewidth]{Figures/concept.pdf}
    %\vspace{-20pt}
    \caption{(i)\textit{Bit-Similar} radio devices (radios with identical manufacturing processes that transmit the same baseband waveforms) labeled from 1 to n, (ii) transmitting waveforms over two environments. Base environment dataset employed to train a preliminary deep learning classifier, and (iii) \textit{SignCRF} reshapes the waveforms transmitted from the new environment to reform the unique hardware impairments associated with these waveforms to match the primary impairments associated with the base environment.} %\vspace{0.2cm}
    %\vspace{-20pt}
    \label{fig:cgan_intro}
\end{figure*}

In spite of the promising progress in this domain, recent studies have revealed a number of challenges in developing robust and reliable \gls{rffdl} models for practical applications. Key among them are the non-stationary characteristic of the wireless channel and the dynamic nature of the environmental actions in a mobile scenario, which significantly limit fingerprinting accuracy by obscuring the hardware impairments associated with the transmitted waveform~\cite{shawabka2020exposing, restuccia2019deepradioid,al2021deeplora}. In particular, without intervention of sophisticated \gls{dsp} algorithms, the existing \gls{rffdl} models suffer from significant performance degradation when training and testing of their deep learning classifier are done on separate segments of the data that are collected in different days/environments. This problem is introduced as the worst-case scenario in~\cite{restuccia2019deepradioid}, \cite{shawabka2020exposing}, \cite{al2021deeplora}, and \cite{soltanimore}, but to the best of our knowledge has not been resolved yet.

In an effort to address these unique challenges, the authors of~\cite{restuccia2019deepradioid} proposed the \textit{DeepRadioID} system that leverages a carefully optimized digital \gls{fir} filter at the transmitterâ€™s side, which slightly modifies its base-band signal to compensate for current channel conditions; however, the system depends on an overhead \gls{dsp} at the transmitter with feedback required from the receiver. %In particular, DeepRadioID transmitter adaptively reshapes the newly transmitted signals based on a feedback received from the receiver side to compensate for the channel impact. 
Besides the need for additional computational resources, this approach can be challenging to implement as a practical radio fingerprinting approach %for applications such as radio fingerprinting
due to its dependency on the feedback signal and the manipulation of the transmitted signal.
%But RF Signature Emulator doesn't manipulate the transmitted signal to compensate for the channel impact.
In another work, the authors of~\cite{al2021deeplora} developed \textit{DeepLoRa}, a data augmentation mechanism to improve the \gls{rffdl} performance using LoRa technology datasets collected from 100 devices with \textit{bit-similar} radios (\textit{bit-similar} radios are devices with identical manufacturing processes that transmit almost the same packets over different days). However, the \textit{DeepLoRa} solution (i) lacks generalization because the solution is applicable only to LoRa technology; (ii) even though it enhances the classification accuracy of the dataset collected from LoRa radios spanning different days, its improvement is not enough for \gls{rffdl} practical implementations. The authors reported 22\% accuracy as their best fingerprinting result, and \textit{DeepLoRa} was only able to correctly recognize 7 devices out of the 20 devices under test, leaving it an impractical solution.

%\noindent \textbf{Unmet Need.}
Up to this date, the developed \gls{rffdl}-based models lack a generic and robust authentication process for a practical real-time radio fingerprinting system that is (i) independent of real-time feedback from the receiver, (ii) does not rely on overhead \gls{dsp} or artificial impairments, and (iii) preserves its high performance independent of the changes in a  mobile wireless environment. Most importantly, the dynamic behavior of the non-stationary wireless channel along with the environmental changes alter the transmitted signals in ways that makes it challenging even for the finest and most sophisticated classifiers to extract the unique impairments associated to each device. This significantly impacts the fingerprinting accuracy especially when the \gls{rffdl} \gls{nn} is trained on a dataset that is collected in a day or environment that is different from the day or environment that is used for classification inference --the main reason that none of the prior work were successful in achieving good performance in this worst-case scenario \cite{restuccia2019deepradioid,jian2020deep,soltanimore,shawabka2020exposing,al2021deeplora}.\\

Our proposed \gls{signcrf} brings to the radio fingerprinting landscape what it has been missing so far: a scalable, channel-agnostic data-driven radio authentication platform with unmatched precision in fingerprinting wireless devices based on their unique manufacturing impairments, and independent of the environment/channel irregularities. \textit{SignCRF} consists of three main components (Fig.~\ref{fig:cgan_intro}): (i) a baseline classifier that is developed in a base environment with minimum channel dynamics, and finely trained to authenticate devices with high accuracy and at scale; (ii) a domain/environment translator that is carefully designed and trained to remove the channel impairments from RF signals while it maintains and highlights the radio specific ``signature'' by leveraging the \gls{cgan}~\cite{zhu2017unpaired, pix2pix2017, goodfellow2014generative} concept from computer vision; and (iii) a Max Rule module that compares and selects the highest precision authentication technique between the baseline classifier and the environment translator output per radio. We design, train and validate the performance of \gls{signcrf} for multiple technologies in dynamic environments and at scale (100 LoRa and 20 WiFi devices, the largest datasets available in the literature). We demonstrate that \textit{SignCRF} can significantly improve the \gls{rffdl} performance by achieving as high as 100\% correct authentication for WiFi devices and 80\% correctly authenticate LoRa devices, a 5x and 8x improvement when compared to the state-of-the-art respectively. Furthermore, we show that \gls{signcrf} is resilient to adversarial actions by suppressing the device recognition accuracy from 73\% to 6\% which leads to zero mis-authentication of adversary radios who try to impersonate legitimate devices.\\

%Hence, neither of these techniques can practically resolve the issue since these techniques still do not know what characteristics are embedded in the old signal used to train the classifier and are not available in the new dataset.

% \begin{figure}[b!]
%         \centering
%         \vspace{-10pt}
%         \input{./Figures/mix_days_wifi_10radios}
%         \vspace{-5pt}
%         \caption{Classification accuracy of 10 WiFi radios. Training dataset created by mixing dataset collected over several days for three different Neural Networks, the testing dataset related to a day other than the days used to train the Neural Network models.}
%         \label{fig:mixed_days_10radios}
% \end{figure}

%\newpage
\noindent \textbf{Summary of Novel Contributions.} \gls{signcrf} is a novel \gls{rffdl} system that, for the first time in the literature, decouples the hardware impairments from channel and environmental conditions to achieve a channel-agnostic and practical data-driven authentication technique. A summary of our novel contributions are as follows:

{$\bullet$} We propose a framework for the real-time channel- and adversary-resilient approach of \gls{rffdl}. The key innovation behind \gls{signcrf}, as illustrated in Fig.~\ref{fig:cgan_intro}, is to \textbf{reshape the classifier input dataset} collected from a particular device at a time different from the time used to train that classifier, and \textbf{decouple the radio and channel impairments}. \gls{signcrf} leverages the \gls{gan} concept to apply controlled modifications to the IQ samples to decouple the environmental variations caused by data collection in different days while maintaining and highlighting the hardware impairments associated with a specific radio device.  %where both IQ samples transmitted from the same device and transmitting the same data structure.
%The RF Signature Emulator slightly modifies a baseband signal in one day/environment to compensate for the new wireless channel conditions and environmental changes emphasized in another day/environment's signal that is used to train the primary classifier.

{$\bullet$} We extensively evaluate the performance of the \gls{signcrf} system on experimental datasets (i) \textbf{20 WiFi} \textit{bit-similar} devices, i.e., transmitting the same baseband signal through nominally-identical RF interfaces and antennas,  introduced in \cite{shawabka2020exposing}; (ii) \textbf{100 LoRa} \textit{bit-similar} devices introduced in \cite{al2021deeplora}.

{$\bullet$} We demonstrate that \gls{signcrf} improves the classification accuracy of 5 and 20 WiFi \textit{bit-similar} devices (under the worst-case scenario) from 18\% to 83\% and from 9\% to 34\%, respectively, and the number of correctly classified devices from \textbf{20\% to 100\%} and from \textbf{30\% to 90\%} for the same radios dataset, respectively.
%, when compared to \hl{what reference are we benchmarking this against?}\textcolor{blue}{Amani. in \cite{shawabka2020exposing} Average TTOD of these 20 devices over10 training days using 10 different testing days was 5\%. The only problem is that in that paper we defined TTOD as train test one day and we used TDTA Train-One-Day-Test-Another}.
To the best of our knowledge, we are the first ever to achieve as high as 100\% precise authentication in the worst-case scenario of ``in the wild'' WiFi benchmark dataset when testing the pre-trained classifier with data collected on a day other than the day used to train the model.

{$\bullet$} We demonstrate that \gls{signcrf} outperforms the data augmentation technique proposed in \cite{al2021deeplora} for the LoRa technology. %where 22\% was reported as the best accuracy for fingerprinting 20 \textit{bit-similar} LoRa radios using payload dataset after applying DeepLoRa.
\gls{signcrf} improves the number of correctly classified/authenticated devices \textbf{from 20\% to 80\%} and \textbf{from 15\% to 75\%} for 5 and 20 LoRa radios using their payload datasets, respectively. Besides, to the best of our knowledge, we are the first to improve the fingerprinting performance of the LoRa device authentication based on ``preamble'' only datasets, which demonstrates the robustness of \gls{signcrf}.

%The results show improvements of (i) \textbf{from 18\% to 80\%}, \textbf{from 13\% to 73\%} and \textbf{from 6\% to 53\%} for 5, 20 and 100 \textit{bit-similar} LoRa radios using their payload datasets, respectively, and
%the number of correctly classified devices \textbf{from 20\% to 80\%}, \textbf{from 15\% to 75\%} and \textbf{from 9\% to 73\%} for the same radios' datasets respectively;
%(ii) \textbf{from 5\% to 39\%}, \textbf{from 4\% to 38\%} and \textbf{from 2\% to 9\%}, and the number of correctly classified devices from \textbf{5\% to 45\%}, \textbf{from 5\% to 60\%} and \textbf{from 1\% to 29\%} for 5, 20 and 100 \textit{bit-similar} LoRa radios using their preamble datasets, respectively.
%our system; the LoRa Preamble dataset is not the best candidate to use for practical RFFP. Even though our proposed system improved the fingerprinting performance significantly using this dataset. For practical use, we recommend counting on LoRa payload dataset. 

{$\bullet$} Lastly, we demonstrate the \textit{scalability} of the \gls{signcrf}, by showcasing the classification of \textbf{100 LoRa \textit{bit-similar} radios} using LoRa payload dataset. We report an improvement in device recognition at this scale \textbf{from 9\% to 73\%}, a \textbf{8x improvement} compared to the state-of-the-art~\cite{al2021deeplora}.

In addition to the above contributions, the codes used in this paper will be made publicly available for the researchers use.



\section{Related Work}\label{sec:related}

Shawabka \emph{et al.}~\cite{shawabka2020exposing} were the first to propose a systematic investigation of the role of the wireless channel in RFFDL algorithms' overall performance. This extensive evaluation determined a significant impact of the wireless channel actions on the accuracy of \gls{cnn}-based radio fingerprinting algorithms. Sankhe \emph{et al.}~\cite{sankhe2019oracle} introduced the ORACLE system to mitigate the channel impacts. However, it requires injecting pre-defined impairments to the transmitter, which is not a practical solution for existing/pre-deployed radio devices. Some other recent works~\cite{al2021deeplora,soltanimore,piva2021tags} propose data augmentation techniques to combat the wireless channel action in \gls{rffdl} applications. However, finding the perfect channel simulation that can enhance the fingerprinting for different technologies at scale is challenging and impractical. To the best of our knowledge, no existing work in the literature reported a practical radio fingerprinting solution to date that can perform reliably and independent of the environment and wireless channel dynamics.

Restuccia \emph{et al.}~\cite{restuccia2019deepradioid} proposed DeepRadioID, a system to improve the channel resilience of \gls{rffdl} algorithms through the application of carefully optimized \gls{fir} filters. However, our work is different as we propose a framework to enhance the fingerprinting accuracy based on deep learning processes, with no extra digital signaling processes, and without need to make any changes at the transmitter nor to incorporate the receiver feedback.

In another work~\cite{al2021deeplora}, authors have investigated data augmentation, and reported a marginal increase in \gls{rffdl} performance using the LoRa payload dataset. The best results after applying the data augmentation on the worst-case scenarios using 10 and 20 \textit{bit-similar} radios were an increase from 19\% to 36\% and from 13\% to 22\%, respectively. While the increased percentage reported in ~\cite{al2021deeplora} brings some hope in cracking the problem, it is not close to a practical solution that is commercially implementable at scale.

%about CycleGAN in Computer-vision
\gls{signcrf} brings to the radio fingerprinting landscape what it has been missing so far: a scalable, channel-agnostic data-driven radio authentication platform with unmatched precision in fingerprinting wireless devices based on their unique manufacturing impairments, and independent of the environment/channel irregularities. \textit{SignCRF} consists of: (i) a baseline classifier that is developed in a base environment with minimum channel dynamics, and finely trained to authenticate devices with high accuracy and at scale; (ii) a domain/environment translator that is carefully designed and trained to remove the channel impairments from RF signals while it maintains and highlights the radio specific ``signature'' by leveraging the \gls{cgan}~\cite{zhu2017unpaired, pix2pix2017, goodfellow2014generative} concept from computer vision; and (iii) a Max Rule module that compares and selects the highest precision authentication technique between the baseline classifier and the environment translator output per radio. We design, train and validate the performance of \gls{signcrf} for multiple technologies in dynamic environments and at scale (100 LoRa and 20 WiFi devices, the largest datasets available in the literature). Furthermore, we show that \gls{signcrf} is resilient to adversarial actions which cannot be achieved by the prior \gls{rffdl} techniques.

\section{\gls{signcrf}: Channel-Agnostic Radio \mbox{Authentication} Model}\label{sec:cgan}
\vspace{10pt}
\subsection{\gls{signcrf} Framework Design}\label{sec:cgan_framework}

%The discriminator and generator models are trained like standard GAN models. The generators learn to trick the discriminators better, and the discriminators learn to detect fake IQ slices better. Together, the models find equilibrium during the training process.
%Additionally, the generator models are regularized to create new IQ samples in the target domain, which is a  translated version of the input IQ slices from the source domain. This is achieved by using generated IQ slices as input to the corresponding generator model and comparing the output IQ slices to the original slices.

Fig.~\ref{fig:cgan_app} shows a high-level overview of the \gls{signcrf} architecture, which consists of 3 main modules:

$\bullet$ \textit{\underline{First}}. Figures~\ref{fig:cgan_app}(a) and ~\ref{fig:cgan_app}(b) show a baseline \gls{cnn} that is designed and optimized for best performance in a base environment with limited changes in the channel dynamics, i.e., trained and tested with a dataset collected in a short period of time in the same day and at the same environment. This classifier is then used as a baseline to classify any new dataset, including the data collected at different conditions, environments and/or timing (Fig.~\ref{fig:cgan_app}(a)). We employ the \gls{2d} baseline \gls{cnn} model proposed in~\cite{al2021deeplora} and illustrated later in Fig.~\ref{fig:cgan_arc}(d). This model consists of \gls{2d} ConvLayers with rectified linear units (ReLU) activation functions, each followed by a MaxPooling layer. This setup was repeated five times and then fed to three fully connected (FC) layers with ReLU activation. Finally, an FC layer with a Softmax activation function is used to generate the radio classification probabilities; 

$\bullet$ \textit{\underline{Second}}. A domain/environment translator that is carefully designed and trained to remove the channel impairments from RF signals while it maintains and highlights the radio specific ``signature''. We create and customize this RF ``signature'' reveal model per each device/radio by employing the methodology described later in detail (\ref{sec:cgan_aproach}). Fig.~\ref{fig:cgan_app}(c) shows the implementation of the RF ``signature-reveal'' model, which includes two generators and two discriminators employed to convert statistical representation of IQ sequences collected at the time, day, or environment $S$ (source domain $S$) from radio $i$ to IQ slices that represent the same statistical characteristic pertaining to the time, day, or environment $T$ (target domain $T$) collected from the same radio, where $S \neq T$. Our approach assumes that the unique radio impairments did not vanish over time or environment. However, they are altered by the channel and the environment. \gls{signcrf} maintains and highlights these device-specific impairments by removing the channel dynamics that are introduced in the new environment;

$\bullet$ \textit{\underline{Third}}. In the third step, as presented in Fig.~\ref{fig:cgan_app}(d), we compare the classification outputs of the first and second modules by using the ``TTOD'' metric, which represents the Train-and-Test-in-Other-Domain as explained later in Sec.~\ref{sec:cgan_met}. We apply a Max Rule criteria as described in equation~(\ref{eq:max_rule}) to pick the highest classification accuracy that determines whether the RF signature-reveal model is required for a specific radio or not. This step is essential, especially when the source domain dataset is not altered much during the transmission and the baseline classifier can still authenticate the device with high confidence. This step is considered as a precautionary step to avoid adding unnecessary complexity to the system and prevent potential accuracy degradation due to the signal manipulation caused by the signature-reveal module.
\begin{equation}\label{eq:max_rule}
     Max Rule = \arg \max_{i} Pr_{softmax_i} (S_i,  S'_i),
\end{equation}
\noindent where $i$ is the radio label, $Pr_{softmax_i}$ is the classification probability of radio $i$ after applying Softmax layer in the pre-trained classifier shown in Fig.~\ref{fig:cgan_app}, $S_i$ is the testing IQ slices collected in source domain $S$ before applying RF signature-reveal module, and $S'_i$ is the testing IQ slices collected in domain $S$ after applying RF signature-reveal, $F(S)$.   

%In this case, we note that any slight alteration can negatively influence the fingerprinting accuracy if the RF signature-reveal model customization is not precise enough.
%It is worth mentioning that our dataset was collected from \textit{bit-similar} devices transmitting almost the same dataset structure (which is considered the worst-case scenario in radio fingerprinting~\cite{shawabka2020exposing}); therefore, altering the characteristics of these radios (radios with high classification accuracy before RF Signature Emulator) may result in degradation of accuracy.

%The RF Signature Emulator creates deep learning models that can transform any sample related to that specific radio in a real-time manner before being fed to the Baseline classifier without the need to re-train a new RF Signature Emulator. Our approach has proved its capability in reshaping samples collected in a third domain, i.e., not related to $S$ nor $T$, and not seen by the RF Signature Emulator or the Baseline classifier during the training phase. The results show that the fingerprinting accuracy, in this case, is still improved by a factor of 2x when testing the Baseline classifier before and after RF Signature Emulator as explained in detail later in Sec. \ref{sec:wifi_res}.

\begin{figure}[!t]
    \centering
    \includegraphics[width=1\columnwidth]{Figures/framework.pdf}
    \caption{\gls{signcrf} framework: (a) Dataset constructer; (b) Baseline classifier using base (target) domain dataset; (c) Signature reveal module leveraging the \gls{cgan} concept; and (d) Apply Maximum Rule to (b) and (c) outputs.} %\vspace{0.2cm}
    %\vspace{-10pt}
    \label{fig:cgan_app}
\end{figure}

\subsection{RF Signature-Reveal Module}\label{sec:cgan_aproach}

At its core, \gls{signcrf} consists of an RF signature-reveal module (Fig.~\ref{fig:cgan_methodology}) that highlights the RF signature by eliminating the signal impairments caused by environmental changes. This module leverages the \gls{cgan} concept proposed in~\cite{zhu2017unpaired, pix2pix2017} to enhance the deep learning feature detection process in \gls{rffdl}. \gls{signcrf} employs two GANs to ensure that the neural network output will still reside in the same subspace as the designated data within a canonical dataset. As shown in Fig.~\ref{fig:cgan_methodology}, we intend to learn a mapping function $G$ to reform a dataset in one source domain, e.g., $S$, to a dataset in a target domain, e.g., $T$. Yet, to control this adaptation, we still need to learn an inverse mapping function, $F$, to reconstruct the source dataset, $S$, from the constructed target domain, $T$. In our case, the source, $S$, and the target, $T$, domains are IQ samples collected on different days and/or environments. \textbf{First, the source and the target domains should share common characteristics, i.e., the hardware's unique impairments as the received signal is transmitted from the same radio $i$}. The \gls{signcrf} relies on these common characteristics between the source and the target domains to improve the fingerprinting performance. The signature-reveal module employs the first \gls{gan} as indicated in Fig.~\ref{fig:cgan_methodology}(b) to create function $G$, which learns how to adjust the source domain characteristics that are altered during the wireless transmission to fit the target domain's prominent features. Then, the second \gls{gan} performs the same task while also providing an ``inverse function'' $F$ to learn mapping the dataset from target domain $T$ back to source domain $S$. $G(S)$ represents the output of the function that learns to map IQ slices in the source domain $S$ to IQ slices of the target domain $T$ using an adversarial loss. The adversarial loss aims to shape $G(S)$ distribution to be indistinguishable from $T$ slices distribution. As discussed before, an inverse mapping $F(T)$ is coupled with $G(S)$ to constrain the space of the constructed and reconstructed IQ slices using a cycle consistency loss that ensures $F(G(S))\approx S$ and $G(F(T))\approx T$. To achieve this goal, \gls{signcrf} uses two adversarial discriminators $D_T$  and $D_S$ to determine if the IQ slices generated using $G(S)$ and $F(T)$ match the original IQ slices from target domain $T$ and source domain $S$, respectively.

\begin{figure}[!t]
    \centering
    \includegraphics[width=1\columnwidth]{Figures/cgan_2.pdf}
    \caption{RF Signature-Reveal Module of \gls{signcrf} (a) The process of reshaping IQ slices collected in source domain $S$ to IQ slices collected in target domain $T$; (b) Forward cycle consistency; (c) Backward cycle consistency.} %\vspace{0.2cm}
    % \vspace{-20pt}
    \label{fig:cgan_methodology}
\end{figure}

We customize \gls{signcrf} per device $i \in [1,2, ...N]$, where $N$ is the total number of devices we wish to authenticate. To do so, we collect IQ datasets from \textit{bit-similar} radios in different domains (each domain represented by a specific day, time, and environment). \gls{signcrf} reshapes the IQ dataset collected from radio $i$ in the source domain to a target domain space. This operation boosts the unique hardware impairments within the constructed dataset $G(S)$. The reshaped dataset will be then fed to the baseline classifier that is pre-trained using the target domain dataset (also referred to as ``base environment''). %The proposed RF Signature Emulator demonstrates that the fingerprinting accuracy of the worst-case scenario can be significantly improved.   
The mapping function $G$ is trained to reshape IQ slices to be similar to domain $T$ IQ slices. At the same time, the discriminator $D_T$ is trained to determine if the produced samples can successfully fit in the target domain space. The adversarial loss that expresses this $G$ mapping function and the $D_T$ discriminator is shown in equation~(\ref{eq:gan1_loss}). Similarly, adversarial loss in equation~(\ref{eq:gan2_loss}) is defined for the mapping function $F$ and its discriminator $D_S$. Note that instead of the log-likelihood loss proposed in~\cite{zhu2017unpaired}, we use the least-squares loss function presented in~\cite{mao2017least}, which demonstrated better performance and provided more stability during the training phase.

\begin{equation}\label{eq:gan1_loss}
    \begin{aligned}[b]
    & L_{GAN_1}(G, D_T, S, T) = \mathbb{E}_{t \sim P_t} [(D_T(T) -1)^2]\\
    &  \hspace{3cm}   +\mathbb{E}_{s \sim P_{s}} [D_T(G(S))^2],
    % & L_{GAN_1}(G, D_Y, X, Y) = \frac{1}{m} \sum\limits_{j=1}^m (1-D_Y(G(X_j))^2,
    \end{aligned}
\end{equation}
\begin{equation}\label{eq:gan2_loss}
    \begin{aligned}[b]
    % & L_{GAN_2}(F, D_X, Y, X) = \frac{1}{m} \sum\limits_{j=1}^m (1-D_X(F(Y_j))^2,
    & L_{GAN_2}(F, D_S, T, S) = \mathbb{E}_{s \sim P_s} [(D_S(S)-1)^2]\\
    &  \hspace{3cm}   +\mathbb{E}_{t \sim P_{t}} [D_T(F(T))^2],
    \end{aligned}
\end{equation}

%\noindent where, $j$ is IQ slice $j \in [1, 2, ...m]$.
\noindent where each $S$ and $T$ has $m$ number of IQ slices that are represented by $[s_i]_j^m  \in s$, and  $[t_i]_j^m \in T$, where ${s \sim P_s}$ and ${t \sim P_t}$ are the data distribution of each related domain.

\gls{signcrf} uses the cycle consistency loss approach in Machine Translation that requires a reverse translation, e.g., to translate a phrase from French to English, one should translate it back from English to French to enforce forward and backward consistency that should reduce the space of possible mapping functions. Applying this concept to \gls{signcrf} means that the IQ slices developed by the mapping function $G(S)$ in the first generator will be used as input to the mapping function $F(G(S))$ of the second generator, Thus, the resulted IQ slices should fit the original IQ slices, i.e., $F(G(S))\approx S$. This is called ``forward cycle consistency'' as illustrated in Fig.~\ref{fig:cgan_methodology}(b). The reverse operation is also true, called ``backward cycle consistency'', and leads to constructing $G(F(T))\approx T$, as shown in Fig.~\ref{fig:cgan_methodology}(c). Equation~(\ref{eq:cycle_loss}) represents the mathematical representation of the cycle consistency loss. This operation helps regularize the generators and guides the IQ slices construction process. The total objective loss is presented in equation~(\ref{eq:loss_full}). This loss sums up all discussed losses and introduces $\lambda$ as a new hyperparameter to weight the relative importance of the two objective functions. We consider $\lambda=10$ in our setup, as suggested in~\cite{zhu2017unpaired}.

\begin{equation}\label{eq:cycle_loss}
    \begin{aligned}[b]
    %  & L_{cyc}(G,F) = \frac{1}{m} \sum\limits_{j=1}^m [(F(G(S_j))-S_j )\\
    %  & \hspace{1.5cm} +(G(F(T_j))-T_j)]  
    & L_{cyc}(G,F) = \mathbb{E}_{s \sim P_s} [\| F(G(S))-S \|_1]\\
    &  \hspace{1.5cm}   +\mathbb{E}_{t \sim P_{t}} [\| G(F(T))-T \|_1]
    \end{aligned}
\end{equation}
\begin{equation}\label{eq:loss_full}
    \begin{aligned}[b]
     & L_{full} = L_{GAN_1} + L_{GAN_2} + \lambda L_{cyc}
    % & L_{cyc}(G,F) = \mathbb{E}_{X \sim P_X} [\| F(G(X))-x \|_1]\\
    % &  \hspace{1.5cm}   +\mathbb{E}_{Y \sim P_{Y}} [\| G(F(Y))-Y \|_1]
    \end{aligned}
\end{equation}

Note that $F$ and $G$ are autoencoders in nature~\cite{kingma2013auto}. We train them jointly to map IQ slices to themselves through an intermediate representation that is a translation of IQ slices into another domain. Adversarial losses are used to train these autoencoders to match the targeted distribution each time, which can be seen as a distinct case of adversarial autoencoders~\cite{makhzani2015adversarial,zhu2017unpaired}. In \gls{signcrf} framework the target distribution for the source domain $S$ is the target domain $T$ distribution. The final goal of \gls{signcrf} is to minimize the following objective function:
\begin{equation}\label{eq:full_obj}
     G, F = \arg \min_{G,F} \max_{D_S,D_T} L(G,F,D_S,D_T).
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{\gls{signcrf} Neural Network Architecture}\label{sec:cgan_arc}

\begin{figure}[!t]
    %\vspace{-10pt}
    \centering
    \includegraphics[width=1\columnwidth]{Figures/network_architecture.pdf}
    \caption{\gls{signcrf} Deep Learning \gls{nn} architecture (a) Generators $F$ and $G$, with a ResNet block; (b) Discriminators $D_S$ and $D_T$; (c) Baseline classifier.} %\vspace{0.2cm}
    \label{fig:cgan_arc}
\end{figure}

Fig.~\ref{fig:cgan_arc} illustrates the deep learning model architectures used for (a) both generators to develop the mapping functions $G$ and $F$, (b) both discriminators $D_S$ and $D_T$, and (c) the baseline classifier that is trained in the base environment and used to authenticate the radios; we employ this classifier to authenticate all datasets determined in Sec.~\ref{sec:rf_cgan_data}. We use the sliding window approach to cut the received transmission to a predefined number of slices. Specifically, given an I/Q sequence in complex 32-bit floating-point samples stored in little-endian format as shown in Fig.~\ref{fig:sliding_appr}, we create a \gls{2d} array for I and Q values. To slice the \gls{2d} array, we need to specify the number of required slices, slice length, and stride. %In our case, we generate 12000 slices each with length 288 and stride 1 for the WiFi dataset as introduced in~\cite{shawabka2020exposing} and 9000 slices each slice with length 128 and stride 1 as specified in~\cite{al2021deeplora} for the LoRa dataset. The number of slices is constrained by the number of samples available in the collected datasets and the required slice length. We refer the readers to~\cite{shawabka2020exposing} for more insights on how to train a Baseline classifier.
For more details on how we slice our datasets please refer to Sec.~\ref{sec:train_NN_}.

\begin{figure}[!b]
    %\vspace{-10pt}
    \centering
    \includegraphics[width=1\columnwidth]{Figures/slicing.pdf}
    \caption{Sliding window approach to create 2D slices.} %\vspace{0.2cm}
    \label{fig:sliding_appr}
\end{figure}

\gls{signcrf} takes IQ slices as input and generates transposed IQ slices as output. The model, as shown in Fig.~\ref{fig:cgan_arc}(a) applies (i) a sequence of three downsampling convolutional blocks to encode the input IQ slices, and nine residual network (ResNet) convolutional blocks to transform the IQ slices; and (ii) two upsampling convolutional blocks to generate the output slices. We do not compile the generator models directly during the training. Instead, they are updated via composite models that are utilized to train each generator. It is also required to share the weights with the related discriminator and the other generator models. Both generators are updated to minimize the adversarial loss predicted by the discriminator for the generated IQ slices marked as ``real''. By this step, the generators are maintained to create IQ slices that better fit into the target domain. The discriminator model shown in Fig.~\ref{fig:cgan_arc}(b) predicts whether the IQ slices that are fed to this discriminator are ``real'' or ``fake''. We refer interested readers to~\cite{li2016precomputed, isola2017image} for more insights about \gls{gan} discriminator structure and to~\cite{zhu2017unpaired, cgan} for more detailed insights about the \gls{gan} generator and the composite models structures.


\noindent\textit{\underline{Baseline Classifier.}} Fig.~\ref{fig:cgan_arc}(c) illustrates the 1D CNN baseline model architecture inherited from AlexNet CNN~\cite{AlexNet}. This model is employed to classify the Generator $G$ output, explained earlier in Fig.~\ref{fig:cgan_app}(c). The model consists of two one-dimension (1D) ConvLayers with 128 filters each. Filter sizes of 1x7 and 1x5 are utilized, respectively, for the first and second ConvLayers. Each ConvLayer is followed by a rectified linear units (ReLU) activation function and 1x2 MaxPooling layer. This structure is repeated five times and then fed to three fully connected (FC) layers with 256, 256, and 128 neurons, respectively. A ReLU activation function follows each FC layer. Finally, an FC layer with a softmax activation function is used to determine the radios classification probabilities.

\noindent\textit{\underline{Per Device Customization Process.}} To further improve the performance of the \gls{signcrf}, we optimize the model to encounter the most promising combination of the hyperparameters and the number of epochs that can lead to the most willing feature detection for a specific radio. Upon accepting this work, we will share with the research community the related codes with full explanations of such optimizations.



\section{Experiment Results}\label{sec:exp_result}
% \subsection{RF Signature Emulator Performance Results.}\label{sec:res}
We analyze the performance results of the \gls{signcrf} with WiFi~\cite{shawabka2020exposing}, and LoRa (payload, and preamble) datasets~\cite{al2021deeplora}.

\subsection{Performance Metrics}\label{sec:cgan_met}

To assess the \gls{signcrf} performance, we consider the following performance metrics:

\noindent{\textit{Per-slice Testing Accuracy \textbf{(PSTest)}},} evaluates the performance of a pre-trained deep learning model (baseline model) using new datasets (not seen during the training process), and it measures the percentage of the correctly predicted slices out of the total testing slices;

\noindent{\textit{Train-and-Test-in-Other-Domain \textbf{(TTOD)} Accuracy},} represents the PSTest performance when the testing dataset is collected in a domain other than the domain used to train the pre-trained classifier. The new domain can be another day or environments; However, the other testing settings remain the same, e.g., radios, the technology used, and the structure of the packets;

\noindent{\textit{Radio Recognition Percentage \textbf{(RRP)}}.}  We consider radio $i$  to be correctly classified if its Softmax classification probability of being itself (actual radio) is the highest among all other radios. Based on this, the RRP represents the percentage of the correctly classified radios among all others. By this metric, we measure the capability of our \gls{signcrf} in improving the classification probability of the correct radios.

\noindent{\textit{Percentage Increase \textbf{(Improvement)}},} represents the amount of increase from the original \textit{TTOD or RRP} values before applying \gls{signcrf} to the final \textit{TTOD or RRP} values after implementing \gls{signcrf} in terms of 100 parts of the original values.

\subsection{Datasets}\label{sec:rf_cgan_data}

\subsubsection{The WiFi Dataset: An Overview}\label{sec:rf_cgan_data_wifi}
We employ I/Q samples transmitted using the IEEE 802.11a/g (WiFi) standard~\cite{IEEE-WiFi-Standard} that is publicly shared in~\cite{shawabka2020exposing}. This WiFi standard applies orthogonal frequency division multiplexing (OFDM) and thus multiple subcarriers to transmit each digital symbol using BPSK, QPSK, 16QAM or 64 QAM modulation, with different levels of convolutional coding (1/2 or 3/4). The used WiFi framework consists of a short training sequence (STS) for frame detection, and a long training sequence (LTS) for time synchronization. Then, to recover the transmitted digital symbols, the algorithm uses Fast Fourier Transform (FFT) to transfer the I/Q samples from the time domain to the frequency domain. Finally, before decoding the equalized IQ samples, the LTS is again employed to perform channel estimation and offset correction.  This dataset is collected in Arena~\cite{bertizzolo2019arena}, an ``in the wild''  testbed using 20 software-defined radios (SDRs), composed of thirteen N210 and seven X310 Universal Software Radio Peripherals (USRPs). %The receiver is an N210 SDR.
The testbed presents a rich and diverse environment to collect challenging datasets. To evaluate \gls{signcrf}, we use the equalized dataset collected from 20 USRPs in three different days to validation and testing in Real-time implementations.

\subsubsection{The LoRa Dataset: An Overview}\label{sec:rf_cgan_data_lora}
We employ the LoRa dataset introduced in~\cite{al2021deeplora} and publicly released by InterDigital\footnote{https://www.interdigital.com/data\_sets/lora\--radio\--data}. This dataset is collected in rich environments spanning different days with 100 \textit{bit-similar} Pysense sensors connected to 100 \textit{bit-similar} FiPy radios that operate as transmitters on a carrier of 902.3~MHz in the 915~MHz ISM band. Each radio transmits ten consecutive bursts of packets in each test environment. One second of silence separates each burst. The burst consists of 100 consecutive packets separated by 10 ms. Each packet contains the payload information carrying the temperature, the humidity, and the device voltage readings. We extract the preamble and the payload datasets collected from two different days in an outdoor environment based on the methodology described in~\cite{al2021deeplora}. Then we use these datasets to validate the performance of \gls{signcrf}. 

\subsubsection{Train \gls{nn} and Dataset Generation: }\label{sec:train_NN_}We train our NNs using Keras running on top of TensorFlow over an NVIDIA Cuda-enabled Tesla K80m GPU system. We generate 12000 slices each with length 288 and stride 1 for the WiFi dataset as introduced  in~\cite{shawabka2020exposing} and 9000 slices each slice with length 128 and stride 1 as specified in~\cite{al2021deeplora} for the LoRa dataset. The number of samples available in the collected datasets and the required slice length constrain the number of slices. We employed 80\%, 10\%, and 10\% of the slices generated on Day \textit{T} to train, validate, and test (TTSD performance) the baseline model, respectively, as shown in Fig.~\ref{fig:dataset_split}(a). To get the TTOD results without \gls{signcrf}, we test the baseline model using 10\% of the slices generated on Day \textit{S}, as indicated in Fig.~\ref{fig:dataset_split}(b). 
To train \gls{signcrf} (i) we reserve 10\% of the validation slices generated on Day \textit{T}; and (ii) 10\% of the testing slices generated on Day \textit{S}, as displayed in Fig.~\ref{fig:dataset_split}(c). Note that we take 10\% of the data collected in Day \textit{S} that is consistent with the size of the data used for testing the Baseline Classifier. 
The remaining 90\% of the testing slices generated on Day S will pass through the pre-trained \gls{signcrf} system before being classified to create the new TTOD results. 

\begin{figure}[!b]
    %\vspace{-10pt}
    \centering
    \includegraphics[width=1\columnwidth]{Figures/dataset_split_v2.pdf}
    \caption{Dataset structure to (a) train the Baseline Classifier and evaluate the performance of TTSD; (b) evaluate the performance of TTOD; (c) train the \gls{signcrf} and evaluate the performance of TTOD.} %\vspace{0.2cm}
    \label{fig:dataset_split}
\end{figure}





% \subsection{Understanding the Batch size impact.}
% Before analyzing the performance results, we identify how we decide on the batch size employed to develop the deep learning model discussed earlier in Sec.~\ref{sec:cgan_arc}.

% First, we analyze how the training batch size influences the overall performance of the proposed RF Signature Emulator. We inspect our Emulator using three different batch sizes 1, 32, and 64. Fig.~\ref{fig:TTOD_wifi_per_batch} shows the overall TTOD accuracy after implementing our RF Signature Emulator using these three batch sizes. We train a ground-truth classifier using a WiFi dataset collected from five X310 radios transmitting the same WiFi packets as defined in Sec.~\ref{sec:cgan_framework} ``Step 1''. Then, we use our RF Signature Emulator to create customized models per device, batch size, and epoch to reshape the source dataset (domain $X$) to the target dataset (domain $Y$) as described in Sec.~\ref{sec:cgan_framework} ``Step 2''. 
% Fig.~\ref{fig:TTOD_wifi_per_batch} shows the overall improvement in the TTOD accuracy using these three batch sizes (1, 32, 64) while increasing the number of training epochs. But, training with batch size 32 shows long-lasting effects with a slight boost over batches (1 and 64) and utilizing less computational resources than batch size 1. \textbf{Thus- we consistently determine and use batch size 32 in the remaining sections.}

% \begin{figure}[t!]
% \captionsetup{skip=5pt}
%     \centering
%     \input{./Figures/wifi_batch_comparison}
%     \caption{Batch size impact per epoch on the RF Signature Emulator TTOD\% performance for equalized WiFi dataset collected from 5 \textit{bit-similar} radios transmitting the same data over WiFi technology.}
%     % \vspace{-10pt}
%     \label{fig:TTOD_wifi_per_batch}%\vspace{-0.2cm}
% \end{figure} 



% % \begin{figure}[h!]
% % \captionsetup{skip=5pt}
% %     \centering
% %     % \vspace{-10pt}
% %     \input{./Figures/wifi_per_device_per_epoch}
% %     \caption{TTOD\% performance per device per epoch for equalized WiFi dataset collected from 5 \textit{bit-similar} radios transmitting the same data over WiFi technology;  (i) {before} RF Signature Emulator represented with 0 epochs; and (ii) {after} RF Signature Emulator represented by the epochs from 10 to 100.}
% %     \label{fig:wifi_per_device_per_epoch}%\vspace{-0.2cm}
% % \end{figure}

% Furthermore, Fig.~\ref{fig:TTOD_wifi_per_batch} illustrates a slight decrease in the fingerprinting accuracy after 60 epochs. We investigate this behavior by observing the TTOD performance per radio while increasing the training epochs. We conclude that each radio has its "signature" characterized by its hardware impairments. These impairments are impacted and altered by the surrounding environment and the wireless channel conditions during the transmission process -still, the required degree of transformation to impersonate the prominent impairments of the targeted domain will vary from one radio to another. The proposed RF Signature Emulator boosts these unique impairments by reshaping the source dataset characteristics to mate the targeted domain's prominent impairments. Yet, the source and the targeted domains can't mate using our Emulator unless they were transmitted from the same radio, which eliminates the adversarial action as demonstrated in Sec. IV-D. 
% In this regard, the "per radio" customization of the RF Signature Emulator can further enhance the performance because each radio has its unique signature. Still, the non-stationary wireless channel will modify each signature differently, which requires a special customization per radio to remove this alteration partially and re-boost the unique signature.\\

\subsection{WiFi Dataset Results}\label{sec:wifi_res}

% Fig.~\ref{fig:wifi_per_device_per_epoch} shows the per device per epoch TTOD accuracy of RF Signature Emulator created to convert IQ samples collected from five X310 radios transmitting the same WiFi packets from day/source $X$ to day/target $Y$. This figure indicates that the RF Signature Emulator successfully boosts the prominent impairments of 4 out of 5 of the tested radios. Nonetheless, in limited cases, e.g., one radio out of five (around 20\% of the overall radios), using RF Signature Emulator may not improve the results, which can be subject of future work. In addition a minor degradation can be observed while training the RF Signature Emulator with several epochs, but this behavior is expected as (i) the dataset is transferred from one domain to another, and slight drifts in the impairments is unavoidable and may mislead the overall classification, especially when we are investigating a very challenging \gls{rffdl} scenario (\textit{bit-similar} devices transmitting the same packets over and over); and (ii) we cannot guarantee the quality of the impairments associated with all samples used to train the model for any specific signature; however, new samples can be recollected for such devices for further validation. In any case, the degradation explained here can be avoided by using the Max Rule step explained earlier in Sec.~\ref{sec:cgan_framework}


\begin{figure}[!t]
\captionsetup{skip=5pt}
    %\vspace{-10pt}
    \centering
    \begin{subfigure}[t]{0.48\columnwidth}
       \captionsetup{skip=5pt}
        \centering
        \setlength\fwidth{0.7\columnwidth}
        \setlength\fheight{0.5\columnwidth}
        \input{./Figures/CM_wifi_5dev_without_cgan}
        \caption{ {Before} \gls{signcrf} implementations the TTOD\% performance = 18\%, and RRP\% performance = 20\%.(1 out of 5 radios classified correctly).}
        \label{fig:cm_5_wifi}%\vspace{-0.2cm}
    \end{subfigure} 
    \hfill
    \begin{subfigure}[t]{0.48\columnwidth}
       \captionsetup{skip=5pt}
       \centering
        \setlength\fwidth{0.7\columnwidth}
        \setlength\fheight{0.5\columnwidth}
        \input{./Figures/CM_wifi_5dev_with_cgan}
        \caption{ {After} \gls{signcrf} implementation the TTOD \% performance = 83\%, and RRP\% performance = 100\%.(5 out of 5 radios classified correctly).}
        \label{fig:cm_5_wifi_withcgan}%\vspace{-0.2cm}
    \end{subfigure} 
    \caption{Confusion matrices of equalized WiFi dataset collected from 5 \textit{bit-similar} radios transmitting the same data over WiFi technology; (i)  {before},  and (ii) {after} applying \gls{signcrf}.}
    \label{fig:cm_5_wifi_w_withcgan}%\vspace{-0.2cm}
\end{figure}

\noindent\textbf{Small-scale WiFi testbed:} We follow the three steps specified in Sec.~\ref{sec:cgan_framework} to assess the performance of applying \gls{signcrf} to a small WiFi testbed consisting of 5 \textit{bit-similar} X310 radios. Figures~\ref{fig:cm_5_wifi} and \ref{fig:cm_5_wifi_withcgan} show the TTOD and RRP performance before and after \gls{signcrf}, respectively. The figures indicate that \gls{signcrf} improves the \textit{TTOD results} \textbf{from 18\% to 83\%} and the \textit{RRP} \textbf{from 20\% to 100\%}, i.e., \gls{signcrf} is able to authenticate all the devices with 100\% confidence, a significant improvement compared to the state-of-the-art~\cite{shawabka2020exposing}.\\

\noindent\textbf{Medium-scale WiFi testbed:} \gls{signcrf} preserves promising results in improving the \gls{rffdl} performance for the WiFi dataset collected from 20 \textit{bit-similar} radios over different days. We use the same methodology described in Fig.~\ref{fig:cgan_app} to improve the TTOD accuracy of medium-size testbed with 20 \textit{bit-similar} radios transmitting the same WiFi packets repeatedly. Our proposed method improves the \textit{TTOD accuracy} from 9\% to 34\%. To the best of our knowledge, this paper, for the first time, improves the \gls{rffdl} of the WiFi technology by a significant factor of 4x in worst-case scenario, i.e., training in one domain and testing in another, using deep learning. Figures~\ref{fig:cm_20_wifi} and \ref{fig:cm_20_wifi_withcgan} show the classification results in confusion matrices before and after applying \gls{signcrf} to convert domain $S$ to domain $T$. Additionally, \gls{signcrf} boosted the \textit{RRP} \textbf{from 30\% to 90\%}, i.e., \gls{signcrf} is able to accurately authenticate 90\% of the devices, a significant improvement compared to the state-of-the-art which can only authenticate 30\% of the devices~\cite{shawabka2020exposing}. 

\begin{figure}[!b]
\captionsetup{skip=5pt}
    \centering
    %\vspace{-10pt}
    \begin{subfigure}[t]{0.48\columnwidth}
       \captionsetup{skip=5pt}
        \centering
        \setlength\fwidth{0.7\columnwidth}
        \setlength\fheight{0.5\columnwidth}
        \input{./Figures/CM_wif_20dev_without_cgan}
        \caption{ {Before} \gls{signcrf} implementation-TTOD\% performance = 9\%, and RRP\% performance = 30\%.(6 out of 20  radios classified correctly).}
        \label{fig:cm_20_wifi}%\vspace{-0.2cm}
    \end{subfigure} 
    \hfill
    \begin{subfigure}[t]{0.48\columnwidth}
       \captionsetup{skip=5pt}
       \centering
        \setlength\fwidth{0.7\columnwidth}
        \setlength\fheight{0.5\columnwidth}
        \input{./Figures/CM_wifi_20dev_with_cgan}
        \caption{ {After} \gls{signcrf} implementation the TTOD\% performance = 34\%, and RRP\% performance = 90\%.(18 out of 20 radios classified correctly.}
        \label{fig:cm_20_wifi_withcgan}%\vspace{-0.2cm}
    \end{subfigure} 
    \caption{Confusion matrices of equalized WiFi dataset collected from 20 \textit{bit-similar} radios transmitting the same data over WiFi technology; (i)  {before},  and (ii) {after} applying \gls{signcrf}.}
    \label{fig:cm_20_wifi_w_withcgan}%\vspace{-0.2cm}
    %\vspace{-10pt}
\end{figure}

We benchmark our WiFi dataset results with DeepRadioID system proposed by Restuccia \emph{et al.}~\cite{restuccia2019deepradioid}. Authors of DeepRadioID have been able to improve the channel resilience of \gls{rffdl} algorithms by carefully applying optimized \gls{fir} filters. The best improvements of the \gls{rffdl} accuracy that DeepRadioID made were 1.5x and 1.7x using 5 and 20 WiFi radios, respectively. Our \gls{signcrf} outperforms DeepRadioID with accuracy improvements of 4.6x and 3.7x using 5 and 20 WiFi radios, respectively, achieving up to 100\% and 90\% \textit{RRP} as reported later in Sec.~\ref{sec:conclusion}, Table~\ref{table:summary_rrp}.

%\hl{this paragraph can be removed from here if we need to save some space at the end}\textcolor{blue}{No problem}
%Applying \gls{rffdl} to \textit{bit-similar} radios that transmit the same WiFi packets repeatedly from the exact location and over different days is defined as the worst-case scenario in previous research. The proposed RF Signature Emulator method, proposed in this paper, reports a significant improvement with this worst-case scenario over different technologies for the first time as per our knowledge. Solving this problem is essential for the practical application of the \gls{rffdl}. %Our RF Signature Emulator managed to solve this challenging scenario partially.
%The radios are very similar and transmit the same packets, e.g., in preamble packets. In addition, the channel conditions change dynamically from day to day. With all these challenges, our RF Signature Emulator manages to improve the TTOD and the RRP performances of this complex problem. Moreover, the created RF Signature Emulator model proved its capabilities to work in Real-Time situations. However, more fine-tuning to the RF Signature Emulator is required to classify all the tested radios correctly.

%%% Domain Z stuff
% To evaluate \gls{signcrf} in a Real-Time mode, we utilize a dataset collected on the third day, called as Domain $S_2$. In this regard, we test the same RF Signature Emulator model that is trained for Domains $X$ and $T$, but we use Domain $S_2$ dataset as the input (a domain that is not seen by the model before). In this scenario, RF Signature Emulator converts IQ samples in Domain $S_2$ to Domain $T$. The results demonstrate promising potentials in improving the \gls{rffdl} in Real-Time scenarios, increasing the \textit{TTOD accuracy} \textbf{from 28\% before applying the RF Signature Emulator to 43\% after mapping Domain $S_2$ to Domain $T$ using RF Signature Emulator.}


% \begin{figure}[H]
% \captionsetup{skip=5pt}
%     \centering
%     \includegraphics[width=1\columnwidth]{Figures/LoRa_payload_5_Dev_mod.pdf}
%   \caption{Fingerprinting LoRa payload dataset collected from 5 \textit{bit-similar} LoRa radios transmitting the same data over LoRa technology; (i) {before}, and (ii) {after} applying RF Signature Emulator to reshape source $S$ datasets.}
%   \label{fig:cm_5_lora_w_withcgan}\vspace{-0.2cm}
% \end{figure}



\subsection{LoRa Payload Dataset Results}\label{sec:lora_pay_res}

To further evaluate the capability of \gls{signcrf} in improving the data-driven authentication for diverse technologies, we use a dataset generated using LoRa technology transmission over the air. We extract the payload of the received LoRa packets to create our dataset using the methodology described in~\cite{al2021deeplora}. Then we assess the performance of \gls{signcrf} system in three testbed scales, namely, small, medium, and large with 5, 20, and 100 \textit{bit-similar} LoRa radios respectively. This further verifies the \gls{signcrf} proficiency in improving the \gls{rffdl} performance regardless of the (i) testbed scale, (ii) the adopted technology, and (iii) the type of IQ samples used in the classification process. i.e., the preamble or the payload part of the received packets.\\






% \begin{figure}[h!]
% \captionsetup{skip=5pt}

%     \vspace{-10pt}
%     \centering
%     \begin{subfigure}[t]{0.48\columnwidth}
%       \captionsetup{skip=5pt}
%         \centering
%         \setlength\fwidth{0.7\columnwidth}
%         \setlength\fheight{0.5\columnwidth}
%         \input{./Figures/100_lora_payload_nogan}
%         \caption{ {Before} xxx implementation the TTOD \% performance = 6\%, and RRP\% performance = 9\%.}
%         \label{fig:100_lora}%\vspace{-0.2cm}
%     \end{subfigure} 
%     \hfill
%     \begin{subfigure}[t]{0.48\columnwidth}
%       \captionsetup{skip=5pt}
%       \centering
%         \setlength\fwidth{0.7\columnwidth}        \setlength\fheight{0.5\columnwidth}
%         \input{./Figures/100_lora_payload_w_cgan}
%         \caption{ {After} xxx implementation the TTOD \% performance = 53\%, and RRP\% performance = 73\%.}
%         \label{fig:cm_100_lora_withcgan}%\vspace{-0.2cm}
%     \end{subfigure} 
%     \caption{Confusion matrices of LoRa payload dataset collected from 100\textit{bit-similar} LoRa radios (i) {before}, and (ii) {after} applying RF Signature Emulator to reshape day $X$ datasets.}
%     \label{fig:100_lora_payload}\vspace{-0.2cm}
% \end{figure}


\noindent\textbf{Small-scale LoRa payload testbed:} Our small testbed consists of the payload dataset extracted from 5 \textit{bit-similar} LoRa radios. Each LoRa radio transmits the voltage, temperature, and humidity readings in its payload. The results are shown in Figures~\ref{fig:cm_5_lora} and \ref{fig:cm_5_lora_withcgan} for before and after applying our proposed \gls{signcrf} respectively, indicating that the \gls{signcrf} system succeeded in enhancing the \textit{TTOD results} \textbf{from 18\% to 80\%} and the \textit{RRP} \textbf{from 20\% to 80\%}.\\


\begin{figure}[t!]
\captionsetup{skip=5pt}

    %\vspace{-10pt}
    \centering
    \begin{subfigure}[t]{0.48\columnwidth}
      \captionsetup{skip=5pt}
        \centering
        \setlength\fwidth{0.7\columnwidth}
        \setlength\fheight{0.5\columnwidth}
        \input{./Figures/CM_lora_5_withot_cgan}
        \caption{ {Before} \gls{signcrf} implementations the TTOD\% performance = 18\%, and RRP\% performance = 20\%.(1 out of 5 radios classified correctly).}
        \label{fig:cm_5_lora}%\vspace{-0.2cm}
    \end{subfigure} 
    \hfill
    \begin{subfigure}[t]{0.48\columnwidth}
      \captionsetup{skip=5pt}
      \centering
        \setlength\fwidth{0.7\columnwidth}
        \setlength\fheight{0.5\columnwidth}
        \input{./Figures/CM_lora_5_with_cgan}
        \caption{ {After} \gls{signcrf} implementation the TTOD\% performance = 80\%, and RRP\% performance = 80\%.(4 out of 5 radios classified correctly).}
        \label{fig:cm_5_lora_withcgan}%\vspace{-0.2cm}
    \end{subfigure} 
    \caption{Confusion matrices of LoRa payload dataset collected from 5 \textit{bit-similar} LoRa radios transmitting the same data over LoRa technology; (i) {before}, and (ii) {after} applying \gls{signcrf}.}
    \label{fig:cm_5_lora_w_withcgan}%\vspace{-0.2cm}
    %\vspace{-5pt}
\end{figure}

\noindent\textbf{Medium-scale LoRa payload testbed:} Fig.~\ref{fig:TTOD_payload_per_epoch} illustrates the effectiveness of the \gls{signcrf} in increasing the TTOD accuracy per epoch during the classification process of 20 LoRa \textit{bit-similar} radios using their payload dataset without applying any per device customization. This figure shows a consistent trend in improving the fingerprinting performance while increasing the number of epochs. \gls{signcrf} works perfectly in polishing the impairments associated with 15 LoRa radios out of 20. The \textit{TTOD accuracy} of this scenario boosted \textbf{from 13\% to 52\%} after applying \gls{signcrf} without applying any further per device customization, and \textbf{from 13\% to 73\%} with the customized \gls{signcrf}, using the per device customization process described earlier in Sec.~\ref{sec:cgan}.

The authors in~\cite{al2021deeplora} applied \textit{DeepLoRa}, a data augmentation methodology to enhance the \textit{TTOD accuracy} of 20 \textit{bit-similar} LoRa radios using their payload dataset. The \textit{TTOD accuracy} before applying \textit{DeepLoRa}~\cite{al2021deeplora} is 13\% using a CNN-2D deep learning model proposed in~\cite{al2021deeplora}. \textit{DeepLoRa}~\cite{al2021deeplora} improves the \textit{TTOD accuracy} from 13\% to only 22\%, and the \textit{RRP performance} from 15\% to only 35\%. Fig.~\ref{fig:TTOD_CM_with/out_Aug_cgan} benchmarks \gls{signcrf} against \textit{DeepLoRa}~\cite{al2021deeplora}. It compares the performance (i) after applying the Baseline classification model, (ii) after applying \textit{DeepLoRa}, and (iii) after applying \gls{signcrf}. Our proposed method, the \gls{signcrf}, significantly outperforms \textit{DeepLoRa} by improving the \textit{TTOD accuracy} \textbf{from 13\% to 73\%} and the \textit{RRP performance} \textbf{from 15\% to 75\%}, a significant improvement compared to the state-of-the-art~\cite{al2021deeplora}.\\

\begin{figure}[t!]
\captionsetup{skip=5pt}
    %\vspace{-10pt}
    \centering
    \input{./Figures/payload_acc_lora}
    \caption{TTOD\% performance per epoch after implementing \gls{signcrf} over LoRa payload dataset collected from 20 \textit{bit-similar} LoRa radios transmitting the same data over LoRa technology. \textbf{Note: this figure shows a smooth increase of TTOD\% after applying the general \gls{signcrf} solution without any further per device customization.}}
    \label{fig:TTOD_payload_per_epoch}%\vspace{-0.2cm}
    %\vspace{-10pt}
\end{figure} 


\begin{figure}[b!]
\captionsetup{skip=5pt}
    %\vspace{-10pt}
    \centering
    \begin{subfigure}[t]{0.48\columnwidth}
    \captionsetup{skip=5pt}
        \centering
        \setlength\fwidth{.7\columnwidth}
        \setlength\fheight{0.5\columnwidth}
        \input{./Figures/CM_lora_20_orig}
        \caption{{Before} both \textit{DeepLoRa} data augmentation and \gls{signcrf} the TTOD\% performance = 13\%, and RRP\% performance = 15\%. (3 of 20 radios classified correctly). }
        \label{fig:20_dev_no_aug}
    \end{subfigure}
    %
    \vfill
    %
    \begin{subfigure}[t]{0.48\columnwidth}
    \captionsetup{skip=5pt}
        \centering
        \setlength\fwidth{.7\columnwidth}
        \setlength\fheight{0.5\columnwidth}
        \input{./Figures/CM_lora_20_deeplora_pa}
        \caption{{After} \textit{DeepLoRa} data augmentation\cite{al2021deeplora} the TTOD\% performance = 22\%, and RRP\% performance = 35\%.(7 out of 20 radios classified correctly).}
        \label{fig:20_dev_PA}
    \end{subfigure}
     \hfill
    \begin{subfigure}[t]{0.48\columnwidth}
    \captionsetup{skip=5pt}
        \centering
        \setlength\fwidth{.7\columnwidth}
        \setlength\fheight{0.5\columnwidth}
        \input{./Figures/CM_lora_20_with_cgan}
        \caption{{After} applying customized \gls{signcrf} the TTOD\% performance = 73\%, and RRP\% performance = 75\%.(15 out of 20 radios classified correctly)}
        \label{fig:20_dev_lora_RF Signature Emulator}
    \end{subfigure}
    \caption{Confusion matrices of LoRa payload dataset collected from 20 \textit{bit-similar} LoRa radios transmitting the same data over LoRa technology in an outdoor environment. \ref{fig:20_dev_no_aug} {before} both \textit{DeepLoRa} and \gls{signcrf}; \ref{fig:20_dev_PA}, {after} \textit{DeepLoRa} outdoor-to-indoor pedestrian environments with channels A)\cite{al2021deeplora}; and \ref{fig:20_dev_lora_RF Signature Emulator} {after} \gls{signcrf}.}
    %\vspace{-5pt}
     \label{fig:TTOD_CM_with/out_Aug_cgan}%\vspace{-0.2cm}
\end{figure}
 
% To prove the effectiveness of our new approach over the previous one, we applied the RF Signature Emulator approach over this specific scenario to benchmark our results with DeepLoRa in \cite{}. Fig.~\ref{fig:benchmerck_payload_lora} compareâ€™s the best TTOD classifications accuracy results after utilizing (i) DeepLoRa\cite{} methodology; (ii) RF Signature Emulator with a Max Rule methodology proposed in this paper. This Figure determines how RF Signature Emulator outperformed the DeepLoRa and increased the TTOD accuracy from 13\% to 71\% with the Max Rule technique; besides, the number of radios classified correctly rose from 3 to 15 radios out of 20 among the worst-case scenario as defined in \cite{}.
% Such improvements can serve the constraints associated with the practical implementation of Radio Fingerprinting based on deep learning algorithms. RF Signature Emulator plays a significant role in mapping the impairments related to the targeted radio under certain circumstances to the same radio in different conditions, opening the door for the practical implementations of Radio Fingerprinting based on deep learning algorithms.
%
%
% \begin{figure}[hbt!]
% \captionsetup{skip=5pt}
%     \centering
%     \input{./Figures/payload_acc_with_without_cgan}
%     \caption{{}.}
%       \label{fig:benchmerck_payload_lora}\vspace{-0.2cm}
% \end{figure} 
\noindent\textbf{Large-scale LoRa testbed:} To exhibit the ultimate effectiveness of \gls{signcrf} approach at scale, we evaluate its performance using the largest dataset in the literature collected from 100 \textit{bit-similar} LoRa radios. Fig.~\ref{fig:100_lora_payload} shows the effectiveness of \gls{signcrf} in increasing the \textit{TTOD accuracy} \textbf{from 6\% to 53\%} and \textit{RRP performance} \textbf{from 9\% to 73\%}. To the best of our knowledge, we are the first to develop a channel-agnostic \gls{rffdl} framework that improves the performance in the worst-case scenario using a large-scale dataset collected in the wild, unearthing a guaranteed way to authenticate the IoT radios based on \gls{rffdl} in the real world is necessary. As these results show, \gls{signcrf}, with its endowment to be customized per device, plays a significant role in opening the doors for practical real-time \gls{rffdl} implementations.

\begin{figure}[!h]
    %\vspace{-5pt}
    \centering
    %  \input{./Figures/100_lora_payload_nogan}
    \includegraphics[width=1\columnwidth]{Figures/100_lora_payload_both.pdf}
    \caption{Confusion matrices of LoRa payload dataset collected from 100\textit{bit-similar} radios (i) {Before} \gls{signcrf} implementation the TTOD \% performance = 6\%, and RRP\% performance = 9\%, and (ii) {After} \gls{signcrf} implementation the TTOD \% performance = 53\%, and RRP\% performance = 73\%.} %\vspace{0.2cm}
    \label{fig:100_lora_payload}
\end{figure}



\subsection{LoRa Preamble Dataset Results}\label{sec:lora_prea_res}

We further validate \gls{signcrf} using preamble datasets collected from \textit{bit-similar} LoRa devices. Authenticating the radios based on the preamble dataset is in particular challenging and non-trivial as indicated in~\cite{al2021deeplora}; mainly due to the LoRa preamble characteristics, which make it resilient to noise, fading, and interference~\cite{sundaram2019survey, al2021deeplora}. However, our proposed solution boosts the \gls{rffdl} performance even for this complex case. Table~\ref{table:preamble_TTOD_rrp} summarizes the \gls{signcrf} effect on the radio fingerprinting performance using 5, 20, and 100 \textit{bit-similar} LoRa preamble datasets. The table shows an increase of \textbf{6.8x}, \textbf{8.5x} and \textbf{3.5x} on the \textit{TTOD accuracy} and an increase of \textbf{8x}, \textbf{11x} and \textbf{21x} on the \textit{RRP performance} of 5, 20, 100-bit-similar LoRa devices respectively, after implementing the \gls{signcrf}. This robustness of the proposed \gls{signcrf} in challenging conditions.

\begin{table}[h!]
\captionsetup{skip=5pt}
    %\vspace{-5pt}
    \centering
    % \ra{0.8}
    \begin{threeparttable}
    \caption{Preamble dataset Summary Table: \gls{rffdl} performance of LoRa preamble datasets per testbed size.}\label{table:preamble_TTOD_rrp}
    \begin{tabular}{M{0.9cm}M{0.6cm}M{0.5cm}M{0.5cm}M{0.5cm}M{0.5cm}M{0.5cm}M{0.5cm}M{0.5cm}M{0.5cm}}\toprule

    \multicolumn{2}{c}{\multirow{3}{*}{\textbf{Model}}} & \multicolumn{3}{c}{\textbf{TTOD}} & \phantom{abc}& \multicolumn{3}{c}{\textbf{RRP}} \\
\cmidrule{3-5} \cmidrule{7-9} && 5 & 20 & 100 &&  5 & 20 & 100\\ \cmidrule{3-5} \cmidrule{7-9}
       
        \multicolumn{2}{c}{Baseline} & 5 & 4  & 2  && 5 & 5 & 4 \\
        \multicolumn{2}{c}{\gls{signcrf}} & 39 & 38  & 9 && 45 & 60 & 29\\
        \\
        \multicolumn{2}{c}{\textbf{Improvement}}  & \textbf{6.8x} & \textbf{8.5x} & \textbf{3.5x} && \textbf{8x} & \textbf{11x} & \textbf{21x}
    \\\bottomrule
    \end{tabular}
    \end{threeparttable}
    %\vspace{-5pt}
\end{table}

% \begin{figure}[t!]
% \captionsetup{skip=5pt}

%     \centering
%     \begin{subfigure}[t]{0.48\columnwidth}
%       \captionsetup{skip=5pt}
%         \centering
%         \setlength\fwidth{0.7\columnwidth}
%         \setlength\fheight{0.5\columnwidth}
%         \input{./Figures/CM_lora_preamble_20_no_cgan}
%         \caption{{Before} RF Signature Emulator implementations the TTOD\% performance = 5\%, and RRP\% performance = 5\%.(1 out of 20 radios classified correctly).}
%         \label{fig:lora_pream_all_testbeds}%\vspace{-0.2cm}
%     \end{subfigure} 
%     \hfill
%     \begin{subfigure}[t]{0.48\columnwidth}
%       \captionsetup{skip=5pt}
%       \centering
%         \setlength\fwidth{0.7\columnwidth}
%         \setlength\fheight{0.5\columnwidth}
%         \input{./Figures/CM_lora_preamble_20_cgan}
%         \caption{{After} RF Signature Emulator implementations the TTOD\% performance = 39\%, and RRP\% performance = 45\%.(9 out of 20 radios classified correctly).}
%         \label{fig:cm_20_lora_pream_with_cgan}%\vspace{-0.2cm}
%     \end{subfigure} 
%     \caption{Confusion matrices of LoRa preamble dataset collected from 20 \textit{bit-similar} LoRa radios transmitting the same data over LoRa technology; (i) {before}, and (ii) {after} applying RF Signature Emulator to reshape day $X$ datasets.}
%     \label{fig:cm_20_lora_pream}%\vspace{-0.2cm}
%     %\vspace{-10pt}
% \end{figure}

\subsection{The Impact of Adversarial Action on \gls{signcrf}}\label{sec:adv_action}

Lastly, to test the robustness of \gls{signcrf}, we design an adversarial scenario in which we use the model created by \gls{signcrf} for radio $i$ to reshape the dataset collected by radio $j$, where $j$ $\neq$ $i$. We create and test this adversarial case with the payload dataset extracted from 20 LoRa \textit{bit-similar} radios. Fig.~\ref{fig:adv_results} summarizes the fingerprinting performance (top) without applying the proposed \gls{signcrf}; (middle) with \gls{signcrf}, and (bottom) with an adversary who managed to control the transmission of legitimate devices but stuck with the \gls{signcrf} puzzle. The \textit{TTOD accuracy} for this adversarial scenario is suppressed \textbf{from 73\% to 6\%}, which translates to zero mis-authentication of adversary radios who try to impersonate legitimate devices. Even if an adversary can control the legitimate radios, it still needs to know how to map the waveforms transmitted from this legitimate device on the \gls{signcrf} side. The \gls{signcrf} is designed to map the waveforms of one domain to another domain depending on common characteristics generated by radio $i$ and presented in both domains since it is a device-oriented approach. This explains why the adversary will not be able to break the \gls{signcrf} system. The adversary can succeed in hacking the system if, and only if, the hacker can access and control (i) the legitimate radio itself and (ii) the \gls{signcrf} structure which is completely unknown to any transmitter (including the adversary); therefore, \gls{signcrf} is immune from adversarial actions by adding an extra security layer.

\begin{figure}[t!]
    %\vspace{-5pt}
    \centering
    \includegraphics[width=1\columnwidth]{Figures/adversary_v2.pdf}
    \caption{\textit{TTOD accuracy} of Adversarial scenario described in~\ref{sec:adv_action} for payload dataset extracted from 20\textit{bit-similar} LoRa radios: (top) before applying \gls{signcrf}; (middle) after \gls{signcrf}; and (bottom) After adversarial action.}
    %\vspace{-20pt}
    \label{fig:adv_results}
\end{figure}
 
% \begin{figure}[b!]
%     %\vspace{-5pt}
%     \centering
%     \includegraphics[width=1\columnwidth]{Figures/conc_table_9.pdf}
%     \caption{Summary table of the \textit{RRP performance} per technology dataset(WiFi, LoRa preamble and LoRa Payload) per testbed size(5, 20 and 100 radios.}
%     %\vspace{-5pt}
%     \label{fig:summary_rrp}
% \end{figure}

\section{Conclusions}\label{sec:conclusion}

This work proposes \gls{signcrf}, a novel and data-driven framework for real-time, diverse, and channel-agnostic \gls{rffdl} applications. To the best of our knowledge, we are the first to: (i) leverage the \gls{gan} concept to fingerprint wireless radios independent of the channel/environment dynamics and in a real-time and practical manner in the worst-case scenario, i.e., when several radios with identical manufacturing processes transmit the same baseband signal over different days and/or in diverse environments; (ii) improve the fingerprinting accuracy of WiFi technology up to 4x (100\% correct authentication) without applying any \gls{dsp} techniques and at scale; (iii) improve the fingerprinting accuracy for LoRa payload up to 6.3x (80\% correct authentication) at scale using 100 \textit{bit-similar} radios; (iv) prove that our technique works even with only preamble datasets in \gls{rffdl} applications to fingerprint LoRa radios; and (v) introducing a data-driven authentication approach that is robust and resilient to adversarial actions. In addition, our results show that \gls{signcrf} outperforms previous research for small- and medium-scale testbeds, and is the first successfully tested data-driven authentication method in a large-scale testbed. Our TTOD\% and RRP\% results are summarized in Tables \ref{table:summary_ttod} and \ref{table:summary_rrp}.

\begin{table}[hbt!]
 \begin{adjustbox}{width=\columnwidth,center}
    \centering
    \begin{tabular}{ccccccccc}\toprule
        \centering
        &\multicolumn{6}{c}{\textbf{TTOD\% per testbed scale per dataset}} & \phantom{abc}
        \\
        \cmidrule{2-7}
        &\multicolumn{3}{c}{\textbf{LoRa}} & \phantom{abc}& \multicolumn{2}{c}{\textbf{WiFi}}
        \\
        \multirow{3}{*}{Model} & \multicolumn{3}{c}{\textbf{Payload}} & \phantom{abc}& \multicolumn{2}{c}{\textbf{Equalized}}
        \\
        \cmidrule{2-4} \cmidrule{6-6} \cmidrule{6-7} & 5& 20 & 100 && 5& 20 \\ \cmidrule{2-4} \cmidrule{6-6} \cmidrule{6-7}
        Baseline &18\%&13\%&6\%&&18\%&9\%  \\
        DeeploRa\cite{al2021deeplora} &-&22\%& - && - & - \\
        \gls{signcrf} &80\%&73\%&53\%&&83\%&34\% \\
        \\
        {\textbf{Improvement}} & \textbf{4.5x} & \textbf{5.6x} & \textbf{8.8x} && \textbf{4.6x}& \textbf{3.7x}
        \\\bottomrule
    \end{tabular}%\vspace{-0.3cm}
    \end{adjustbox}
    \captionsetup{skip=5pt}
    \caption{Summary table for TTOD\% per technology per testbed size.}\label{table:summary_ttod}
\end{table}

\begin{table}[hbt!]
 \begin{adjustbox}{width=\columnwidth,center}

    \centering
    \begin{tabular}{ccccccccc}\toprule
        \centering
        &\multicolumn{6}{c}{\textbf{RRP\% per testbed scale and type}} & \phantom{abc}
        \\
        \cmidrule{2-7}
        &\multicolumn{3}{c}{\textbf{LoRa}} & \phantom{abc}& \multicolumn{2}{c}{\textbf{WiFi}}
        \\
        \multirow{3}{*}{Model} & \multicolumn{3}{c}{\textbf{Payload}} & \phantom{abc}& \multicolumn{2}{c}{\textbf{Equalized}}
        \\
        \cmidrule{2-4} \cmidrule{6-6} \cmidrule{6-7} & 5& 20 & 100 && 5& 20 \\ \cmidrule{2-4} \cmidrule{6-6} \cmidrule{6-7}
        Baseline &20\%&15\%&9\%&&20\%&30\%  \\
        DeeploRa\cite{al2021deeplora} &-&35\%& - && - & - \\
        \gls{signcrf} &80\%&75\%&73\%&&100\%&90\% \\
        \\
        {\textbf{Improvement}} & \textbf{4x} & \textbf{5x} & \textbf{8x} && \textbf{5x}& \textbf{3x}

        \\\bottomrule
    \end{tabular}%\vspace{-0.3cm}
      \end{adjustbox}
      \captionsetup{skip=5pt}
    \caption{Summary table for RRP\% per technology per testbed size.}\label{table:summary_rrp}
\end{table}
%\section*{Acknowledgments}
%\footnotesize
\bibliographystyle{IEEEtran}
\bibliography{mybib}
\vskip 0pt plus -1fil

\begin{IEEEbiography}
[{\includegraphics[width=1in,height=1.25in,keepaspectratio]{Figures/amani2.jpg}}]{Amani Al-Shawabka} is currently a Ph.D. candidate at Northeastern University in the Electrical and Computer Engineering department. She received her Master's degree in Computer Engineering from Northeastern University in 2019. She started her professional career in mobile network companies after completing her Bachelor's degree in Communication Engineering from Yarmouk University in Jordan. Her research interests are wireless communications through deep learning, embedded systems, and wireless network security.
\end{IEEEbiography} 





\vskip 0pt plus -1fil

\begin{IEEEbiography}
[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{Figures/phill_pic_croped.png}}]{Philip Pietraski} received the PhD, EE degree from Polytechnic University, now NYU (2000). Philâ€™s background is in signal processing and communication. Phil has been with InterDigital since 2001 and has a diverse history spanning modem algorithm design \& simulation, radio propagation \& impairments studies, and air interface R\&D spanning CDMA, HSPA, LTE, 5G, mmW, WiFi. He was the algorithm lead for a HSDPA coprocessor and facilitated tech-transfer to customers.  He was a 3GPP WG4 and WG1 delegate and hold over 100 patents. He spent some time with the Government Solutions team where he designed hybrid beamforming algorithms and related protocols for interference suppression and signature minimization. He is currently the lead of the AI-native air interface program at InterDigital â€“ exploring the exciting intersection of Machine Learning and Wireless Communications. Prior to joining InterDigital, he worked as a Research Engineer at the DoE lab National Synchrotron Light Source (NSLS) at Brookhaven National Laboratory, working in diverse areas including pulsed-power RF systems, electron-beam control and diagnostics, and high-rate X-ray detectors; ultimately becoming Lead Engineer of the X-ray detector development project at the NSLS.  He also does volunteer work by serving on the board of trustees until 2019 and currently on the advisory committee for DeVry University, NJ; and coaching/mentoring for FIRST Robotics.
\end{IEEEbiography}





\vskip 0pt plus -1fil

\begin{IEEEbiography}
[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{Figures/sudhir_pic_cro.png}}]{Sudhir B Pattar} received  MSEE degree from Indian Institute of Science, Bangalore (1997). Sudhirâ€™s background and interests are in wireless communications, signal processing, system engineering and application of machine learning for wireless communications. Sudhir has been with InterDigital since 2002 and is currently leading the Government Solutions program at Interdigital. In past, Sudhir has worked on modem algorithms, and protocols. Sudhir is currently Principal Investigator for multiple government funded projects. Sudhir has represented InterDigital at multiple cellular standards organizations. Sudhir worked at Broadcom as a Principal Engineer and worked on LTE modem development. Prior to joining InterDigital, he worked as a Research Engineer at NEC labs, working on coexistence of Wireless and cellular wireless systems.
\end{IEEEbiography}






\vskip 0pt plus -1fil

\begin{IEEEbiography}
[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{Figures/pedram.png}}]{Pedram Johari} is a Principal Research Scientist at the Institute for Wireless Internet of Things at Northeastern University, Boston MA, since January 2020. Pedram has received his Ph.D. in Electrical Engineering from the University at Buffalo, the State University of New York in 2018. He was a Research Assistant Professor and Adjunct Lecturer at the University at Buffalo in 2018 and 2019. Pedram was also the CTO of NanoThings Inc., New York City NY, in 2018 and 2019. His research interests are in the fusion of AI and future generation of cellular networks (5G and beyond), in particular focused on spectrum sharing, vehicular communications, full protocol wireless network emulators enabling wireless digital twins, and Internet of wireless medical things. Pedram has collaborated with several academic, industrial, and governmental research collaborators, including University at Buffalo, Georgia Tech, Qualcomm, MathWorks, InterDigital, MITRE, and VIAVI. Pedram is also the managing editor of Elsevier journal on Software Impacts.
\end{IEEEbiography}
\vskip 0pt plus -1fil

\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{Figures/tommaso_cropped.png}}]{Tommaso Melodia } (M'07, SM'16, F'18) is the William Lincoln Smith Chair Professor with the Department of Electrical and Computer Engineering at Northeastern University in Boston. He is also the Founding Director of the Institute for the Wireless Internet of Things and the Director of Research for the PAWR Project Office. He received his Ph.D. in Electrical and Computer Engineering from the Georgia Institute of Technology in 2007. He is a recipient of the National Science Foundation CAREER award. Prof. Melodia has served as Associate Editor fo IEEE Transactions on Wireless Communications, IEEE Transactions on Mobile Computing, Elsevier Computer Networks, among others. He has served as Technical Program Committee Chair for IEEE Infocom 2018, General Chair for IEEE SECON 2019, ACM Nanocom 2019, and ACM WUWnet 2014. Prof. Melodia is the Director of Research for the Platforms for Advanced Wireless Research (PAWR) Project Office, a \$100M public-private partnership to establish 4 city-scale platforms for wireless research to advance the US wireless ecosystem in years to come. Prof. Melodia's research on modeling, optimization, and experimental evaluation of Internet-of-Things and wireless networked systems has been funded by the National Science Foundation, the Air Force Research Laboratory the Office of Naval Research, DARPA, and the Army Research Laboratory.  Prof. Melodia is a Fellow of the IEEE and a Senior Member of the ACM.
 
\end{IEEEbiography}



\end{document}

\begin{comment}
Radio Frequency Fingerprinting through Deep Learning (RFFDL) is a data-driven IoT authentication technique that leverages the unique hardware-level manufacturing imperfections associated with a particular device to recognize (fingerprint) the device based on variations introduced in the transmitted waveform. The proposed SignCRF is a scalable, channel-agnostic, data-driven radio authentication platform with unmatched precision in fingerprinting wireless devices based on their unique manufacturing impairments, and independent of the dynamic channel irregularities caused by mobility. SignCRF consists of: (i) a baseline classifier finely trained to authenticate devices with high accuracy and at scale; (ii) an environment translator carefully designed and trained to remove the dynamic channel impact from RF signals while maintaining the radio's specific signature; (iii) a Max-Rule module that selects the highest precision authentication technique between the baseline classifier and the environment translator per radio. We design, train and validate the performance of SignCRF for multiple technologies in dynamic environments and at scale (100 LoRa and 20 WiFi devices). We demonstrate that SignCRF significantly improves the RFFDL performance by achieving as high as 5x and 8x improvement in correct authentication of WiFi and LoRa devices when compared to the state-of-the-art respectively.
\end{comment}
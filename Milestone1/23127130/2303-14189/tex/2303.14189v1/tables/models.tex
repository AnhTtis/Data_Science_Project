\newcommand{\modelname}{FastViT}
\newcommand{\tabincell}[2]{\begin{tabular}{@{}#1@{}}#2\end{tabular}}

\newcommand{\blockc}[4]{
$\begin{bmatrix}
	\begin{array}{l}
	R_1=#1 \\
	N_1=#2 \\
	E_1=#3 \\
	\end{array}
\end{bmatrix} \times #4$
}

\newcommand{\sblock}[3]{
$\begin{matrix}
E_{#1}=#2 \\
L_{#1}=#3 \\
\end{matrix}$
}

\newcommand{\poollayer}{
Mixer & \multicolumn{7}{c}{RepMixer}\\
\cline{4-11}
}

\newcommand{\stitle}[7]{
\multirow{5}{*}{#1} & \multirow{5}{*}{\scalebox{1}{$\frac{H}{#2}\times \frac{W}{#2}$}} & \multicolumn{2}{c|}{\multirow{2}{*}{\tabincell{c}{Patch Embed.}}} & \multicolumn{7}{c}{$7 \times 7$ MobileOne Style, stride $#4$} \\
\cline{5-11}
    &    &    \multicolumn{2}{c|}{} & $#5$ & \multicolumn{5}{c|}{$#6$} & $#7$ \\
\cline{3-11}
& & \multirow{3}{*}{\tabincell{c}{\modelname{}\\Block}} 
}

\begingroup
\renewcommand{\arraystretch}{1.1}
\begin{tabular}{c|c|c|c|c|c|c|c|c|c|c}
\toprule
  \multirow{2}{*}{Stage} & \multirow{2}{*}{\#Tokens} & \multicolumn{2}{c|}{\multirow{2}{*}{Layer Spec.}} & \multicolumn{7}{c}{\modelname{}} \\
\cline{5-11}
 & & \multicolumn{2}{c|}{} & T8 & T12 & S12 & SA12 & SA24 & SA36 & MA36 \\
\cline{1-11}
\multirow{3}{*}{Stem} & \multirow{3}{*}{\scalebox{0.8}{$H \times W$}} & \multicolumn{2}{c|}{\multirow{3}{*}{Conv.}} & \multicolumn{7}{c}{$3 \times 3$, stride $2$} \\
\cline{5-11}
& & \multicolumn{2}{c|}{} & \multicolumn{7}{c}{$3 \times 3$ MobileOne Style, stride $2$} \\
\cline{5-11}
& & \multicolumn{2}{c|}{} & 48 & \multicolumn{5}{c|}{64} & 76 \\
\cline{1-11}
\stitle{1}{4}{7}{2}{48}{64}{76}    & \poollayer
 & & & Exp. & \multicolumn{2}{c|}{3} & \multicolumn{5}{c}{4} \\
\cline{4-11}
 & & & Blocks & 2 & 2 & 2 & 2 & 4 & 6 & 6 \\
\hline
\stitle{2}{8}{3}{2}{96}{128}{152}  & \poollayer
 & & & Exp. & \multicolumn{2}{c|}{3} & \multicolumn{5}{c}{4} \\
 \cline{4-11}
 & & & Blocks & 2 & 2 & 2 & 2 & 4 & 6 & 6 \\
\hline
\stitle{3}{16}{3}{2}{192}{256}{304} & \poollayer
 & & & Exp. & \multicolumn{2}{c|}{3} & \multicolumn{5}{c}{4} \\
\cline{4-11}
 & & & Blocks & 4 & 6 & 6 & 6 & 12 & 18 & 18 \\
\hline
\stitle{4}{32}{3}{2}{384}{512}{608} & Mixer & \multicolumn{3}{c|}{RepMixer} & \multicolumn{4}{c}{Attention}\\
\cline{4-11}
 & & & Exp. & \multicolumn{2}{c|}{3} & \multicolumn{5}{c}{4} \\
 \cline{4-11}
 & & & Blocks & 2 & 2 & 2 & 2 & 4 & 6 & 6 \\
\hline
\multicolumn{4}{c|}{Parameters~(M)} & 3.6 & 6.8 & 8.8 & 10.9 & 20.6 & 30.4 & 42.7 \\
\hline
\multicolumn{4}{c|}{FLOPs~(G)} & 0.7 & 1.4 & 1.8 & 1.9 & 3.8 & 5.6 & 7.9 \\
\bottomrule
\end{tabular}
\endgroup

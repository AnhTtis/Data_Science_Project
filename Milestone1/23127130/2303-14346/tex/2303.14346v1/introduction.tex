\section{Introduction}
\label{sec:intro}
%\textcolor{blue}{1. UQ important: example (Figure 1 first) 2. why other method not work, our works: emphasize our novelty}


Object detection~\cite{feng2021review} and multiple object tracking (MOT)~\cite{Luo_2021_ICCV} represent crucial steps of self-driving. Both the accuracy and uncertainty quantification (UQ) of these steps are important to facilitate various onboard modules including perception, prediction and planning, to improve the safety and robustness of the autonomous systems~\cite{han2022behavior, boris2022propagating, mpUncertain_icra14}. Multi-agent collaborative object detection (COD) has been proposed to leverage the viewpoints of multiple agents in order to enhance detection accuracy beyond that achievable with individual viewpoints~\cite{li2022v2x,xu2022opencood}. Numerous studies have demonstrated the advantages of COD in enhancing the detection accuracy~\cite{arnold2020cooperative,Chen2019CooperCP,li2021learning,li2022multi} and reducing the uncertainty~\cite{Su2022uncertainty}. Currently, Tracking-by-Detection is considered as one of the most effective paradigms~\cite{zhang2021bytetrack}, using Kalman Filter to predict the next location based on the previous detection results and then performing tracklet-by-detection data association~\cite{bewley2016simple, cao2022observation, pang2021quasi, wojke2017simple}. %The Hungarian method is frequently used for data association, with an association metric such as Intersection-over-Union (IoU) distance. 

\begin{figure}
    \centering
    \includegraphics[width=1\linewidth]{figs/MOT-UP-teaser.pdf}
    % \vspace{-2mm}
    \caption{\textbf{Difference in data association for multi-object tracking (MOT) with and without considering uncertainty}. Ground truth bounding boxes are in green, detected bounding boxes in orange, and tracklets' bounding boxes in red, labeled with object IDs. Shadow ellipses indicate detected bounding box uncertainty. SORT~\cite{bewley2016simple}, which doesn't consider uncertainty, is on the left side of the figure, while our MOT-CUP framework, which incorporates uncertainty, is on the right side. At time t-1, both MOT algorithms output tracklet ID 186. However, at time t, SORT fails to associate the low-quality detected object with tracklet 186 due to a large IoU distance. Thus, SORT removes the tracklet. In contrast, our MOT-CUP framework quantifies the uncertainty of COD with a larger shadow ellipse to represent the uncertainty of the bounding box for tracklet 186, and successfully associates the low-quality detected object by considering the COD uncertainty.}
    \label{fig:teaser}
    % \vspace{-5mm}
\end{figure}

However, there are limitations for the above mentioned methods. For the Kalman Filter (KF) in the motion prediction step, existing algorithms usually input a fixed measured uncertainty for all detections, with no efforts made to input rigorously estimated uncertainty into the KF to enhance the prediction accuracy. Furthermore, the use of Intersection-over-Union (IoU) distance without considering uncertainty as an association metric in the Hungarian algorithm may not be suitable for low-quality detection results caused by occlusion. Hence, it remains challenging to rigorously define how to propagate the uncertainty from COD to tracking, considering both the KF and the association process. For instance, Fig.~\ref{fig:teaser} illustrates how our framework outperforms original SORT in associating tracklet 186 (red bounding box) with the low-quality object detection (orange bounding box) at time $t$. The IoU distance metric in SORT fails to match them due to the poor quality of the detection; and when we quantify the uncertainty of the COD result, low-quality COD usually corresponds to high uncertainty represented by the shadow ellipses. In contrast,  our framework leverages the uncertainty of the detected object in the association step, and successfully associates the tracklet 186 even based on the low-quality detected object. This demonstrates that incorporating uncertainty into MOT can improve tracking performance, especially in scenarios where objects are poorly detected.

%\sanbao{For example, as shown in Fig.~\ref{fig:teaser}, at the association step of time $t$, red bounding box, representing the bounding box of tracklet 186, is challenging to match with the orange bounding box, which represents the detected object and exhibits poor quality, using the IoU distance metric in original SORT algorithm. Low-quality detections tend to have high uncertainty which is represented by the shadow ellipses. Since our framework considers  the uncertainty of the detected object on the association, it successfully associates the tracklet 186 with the low-quality detected object. This demonstrates that incorporating uncertainty into MOT can improve tracking performance, especially in scenarios where objects are poorly detected.} \hsy{For instance, Fig.~\ref{fig:teaser} illustrates how our framework outperforms original SORT in associating tracklet 186 (red bounding box) with the low-quality object detection (orange bounding box) at time $t$. The IoU distance metric in SORT fails to match them due to the poor quality of the detection; and when we quantify the uncertainty of the COD result, low-quality COD usually corresponds to high uncertainty represented by the shadow ellipses. In contrast, our framework leverages the uncertainty of the detected object with a boudngin box that covers the uncertain prediction in the association step, and successfully associates the tracklet 186 even based on the low-quality detected object. This demonstrates that incorporating uncertainty into MOT can improve tracking performance, especially in scenarios where objects are poorly detected.}
%The uncertainty set constructed by these shadow ellipses exhibits a significant overlap with the red bounding box, indicating that an association metric that accounts for uncertainty would be beneficial in this scenario.\sanbao{Add a figure where one object detection bounding box is bad which makes the original association algorithm hard to associate it with the object in previous frames. But with our association with NLL, we could handle this case successfully.}. 
    

%\textcolor{blue}{This paragraph contenct about UQ can be used in the following paragraph explaning why UQ and what we do in UQ of COD and propogation to tracking}
%  Recent research has also highlighted the importance of uncertainty quantification (UQ) in the context of collaborative detection~\cite{Su2022uncertainty}. UQ is of paramount importance for collaborative perception of safety-critical systems such as robots~\cite{rss19, perceptionCBF_corl21} and connected and autonomous vehicles~\cite{han2022behavior}. While it seems plausible that the incorporation of uncertainty for each detected object could benefit subsequent modules in self-driving tasks, such as trajectory prediction~\cite{boris2022propagating} and motion planning~\cite{mpUncertain_icra14}, there is no research about how to leverage uncertainty quantification from collaborative object detection to improve the tracking performance yet.
  
  %has yet proposed concrete methods for leveraging this uncertainty to improve overall performance
%Nevertheless, the effective utilization of estimated uncertainty remains a formidable challenge in the context of collaborative perception. .





In this paper, we propose a novel uncertainty propagation framework designed for these Tracking-by-Detection algorithms, called MOT-CUP (Multiply Object Tracking with Conformal Uncertainty Propagation), to improve their performance. Specifically, our proposed MOT-CUP involves uncertainty quantification of collaborative object detection (COD) via direct modeling and conformal prediction techniques. 
The uncertainty obtained from the COD stage is subsequently incorporated into both the Kalman Filter and the association procedure for MOT. In particular, we define a new association metric with Negative Log Likelihood (NLL) considering the uncertainty of COD and potential low-quality detection results. Through extensive experimentats on V2X-SIM~\cite{li2022v2x} and a series of Tracking-by-Detection MOT algorithms, we show that our proposed MOT-CUP framework improves accuracy with up to 2\% and reduce uncertainty with up to $2.67\times$. Our results also provide strong validation for the effectiveness of conformal prediction in producing more rigorous uncertainty quantification. Overall, our findings highlight the potential benefits of incorporating uncertainty quantification and propogation into MOT algorithms.

The main contributions of this work are as follows:
\begin{enumerate}
    \item To the best of our knowledge, our MOT-CUP framework is the first attempt to leverage quantified uncertainty from collaborative object detection to improve MOT performance. This framework can be applied to most object detection model and MOT algorithms.
    \item In the collaborative object detection stage, we employ direct modeling and conformal prediction techniques to rigorously quantify the uncertainty.
    \item For MOT, we further improve the original MOT algorithm by designing two novel methods that effectively leverage uncertainty information for both the Kalman Filter and association.
    % \item 
\end{enumerate}


%The rest of this paper is organized as follows. Section~\ref{sec:relatedwork} discussed the related works. Section~\ref{sec:approach} presents our MOT-CUP framework. Section~\ref{sec:experiment} shows the experimental results. Finally, Section~\ref{sec:conclusion} concludes the paper.
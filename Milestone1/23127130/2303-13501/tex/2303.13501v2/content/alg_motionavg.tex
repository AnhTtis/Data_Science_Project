\begin{algorithm}[t]%\label{alg:train}
\setstretch{1.13}
\caption{Motion averaging on Flag manifolds.}\label{alg:motionavg}
 \textbf{Input}: {Motions $\{\bm{\gamma} \}_{i=1}^p \subset SE(3)$, scale $\lambda \in R$}\\
 % $\{\Rot_i,\tb_i\}_{i=1}^p$, scale $\lambda$}\\
 \textbf{Output}: Average motion $\bm{\gamma^*} \in SE(3)$ \\[0.25em]
 % \textbf{Output}: {$\Rot^\star\in SO(3),\tb^\star\in\R^3$} \\[0.25em]
 %Compute $\{\Phi_{\lambda}(\gamma_i) \in SO(4)\}$ using~\cref{prop:se3so4} for all inputs\\
 Compute $\{\Phi_{\lambda}(\gamma_i)\}_{i=1}^p \subset SO(4)$ using~\cref{prop:se3so4}\\
 % Compute $\{[\![\X^{(i)}]\!]\in FL^+(1,2,3;4)\}$ using~\cref{prop:so4flag} for all $\{\Phi(\gamma_i)\}$\\
 Compute $\left\{[\![\X^{(i)}]\!]\right\}_{i=1}^p \subset FL^+(1,2,3;4)\}$ from $\{\Phi(\gamma_i)\}_{i=1}^p$ using~\cref{prop:so4flag}\\
 \textbf{Mean}:$\quad [\![\Y^*]\!] \gets \text{flag-mean}\left( \left\{ [\![\X^{(i)}]\!] \right\}_{i=1}^p\right)$\\
 \textbf{Median}: $[\![\Y^*]\!] \gets \text{flag-median}\left(\left\{[\![\X^{(i)}]\!]\right\}_{i=1}^p\right)$\\
 Use~\cref{prop:FLtoSO4} to compute $\M^\star\in SO(4)$\\
 Use~\cref{prop:so4tose3} to compute $\Rot^\star\in SO(3)$ and $\tb^\star\in\R^3$
\end{algorithm}%\vspace{-2mm}
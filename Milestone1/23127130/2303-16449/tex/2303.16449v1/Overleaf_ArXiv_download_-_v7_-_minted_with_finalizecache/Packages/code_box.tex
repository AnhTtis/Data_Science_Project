% --- colors
\definecolor{lightterminal}{HTML}{f7f7ff}
\definecolor{energy_orange}{HTML}{ffdbc9}
\definecolor{light_blue}{HTML}{f2f5ff}

%New colors defined below
\definecolor{darkterminal}{HTML}{8792f5} %  --> subtle
\definecolor{quasiblack}{HTML}{545880} %  --> hard
\definecolor{softblue}{HTML}{4759ff} %
\definecolor{deep_purple}{HTML}{6f00ff}
\definecolor{boxcolor}{HTML}{e5e3fa}

% ------------------ rounded rectangle--------------------
\newcommand{\round}[2]{\tikz[baseline=-4pt]\node [draw=#2,fill=#2,semithick ,rectangle, inner sep=3pt, rounded corners=1pt] (X) {\footnotesize{\transparent{1}\texttt{#1}}};}
\newcommand{\python}{\round{{\color{blue}python}}{boxcolor}\hspace{5pt}}

% --- package for code display
\usepackage{verbatim}
% --- Minted for code highlights
%\usepackage[finalizecache,cachedir=minted-cache]{minted}
\usepackage[frozencache,cachedir=minted-cache]{minted}

\usepackage{etoolbox,xpatch}

\makeatletter
\AtBeginEnvironment{minted}{\dontdofcolorbox}
\def\dontdofcolorbox{\renewcommand\fcolorbox[4][]{##4}}
\xpatchcmd{\inputminted}{\minted@fvset}{\minted@fvset\dontdofcolorbox}{}{}
\xpatchcmd{\mintinline}{\minted@fvset}{\minted@fvset\dontdofcolorbox}{}{} % see https://tex.stackexchange.com/a/401250/
\makeatother

%\usemintedstyle{rainbow_dash}
\usemintedstyle{vs}
\renewcommand\theFancyVerbLine{\color{darkterminal}\footnotesize\arabic{FancyVerbLine}}

% --- \ref in colour for code
\newcommand{\coderef}[1]{{\hypersetup{linkcolor=white}\ref{#1}}}

% minted styles for Python and MATLAB and Mathematica
\setminted[python]{xleftmargin=20pt,baselinestretch=1.2,linenos}
\setminted[MATLAB]{xleftmargin=20pt,baselinestretch=1.2,linenos}
\setminted[Mathematica]{xleftmargin=20pt,baselinestretch=1.2,linenos}

\newtcbox{\circled}[1][lightterminal]{on line,
    colback=#1, colframe=#1, boxsep=0pt, boxrule=0pt, size=small, arc=2pt}
    
% ---- code box
\newtcolorbox[auto counter, number within = section, number freestyle={\noexpand\thesection.\noexpand\arabic{\tcbcounter}}]{code_box}[4]{breakable,center, fonttitle = \bfseries\sffamily, coltitle = white, colback = lightterminal, fontlower = \footnotesize, arc=1mm, width=\textwidth, frame style = softblue, pad at break=3mm, boxrule=0.5pt,
break at=-\baselineskip/0pt, enhanced jigsaw,
height fixed for=middle, before upper={\parindent7pt\noindent}, toprule=0pt, boxsep = 5pt, left=4pt, right=1.5pt,
title={\small\textcolor{energy_orange}{Script{ }\thetcbcounter:}{ } #2 {\hspace{5pt}} \href{#1}{\includegraphics[width=2.5mm]{Packages/link.pdf}} \hfill \circled{\textcolor{quasiblack}{\texttt{#4}}}}, label=#3}

\newtcolorbox{eqbox}{center, breakable, colback = lightterminal, arc=2mm, colframe = softblue,  boxrule=0.8pt, width = \textwidth}

% --- Code command
\newcommand{\code}[5]{
\begin{code_box}{#1}{#2}{#3}{#4}
\footnotesize
\inputminted{#4}{#5}
\end{code_box}
}

\newtcolorbox{codeline}[1]{colback=lightterminal, colframe=softblue,fonttitle=\bfseries,colbacktitle=softblue, enhanced, attach boxed title to top left={yshift=-7.1mm, xshift = 1.6mm},title={\footnotesize\texttt{#1}},boxrule=0.5pt}

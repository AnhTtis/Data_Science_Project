\section{Introduction}
\label{sec:intro}

% \note{- Why curve extraction from point cloud is important?
% \begin{itemize}
%     \item Sharp geometric features, e.g. edges, are fundamental to represent the shape and function of the 3D model. Detecting and reconstructing sharp features from scanned data is a core part of geometry processing.
%     \item \cite{buonamici2018reverse}
% \end{itemize}
% }

% \xiangyu{Test!} 
% \dong{Test!}
% \yinyu{Test!}
% \xg{Test!}

The advances of 3D scanning techniques have enabled us to digitize and reconstruct the physical world, benefiting a wide range of applications including 3D modeling, industrial design, robotic vision, \textit{etc}. 
However, point clouds, the raw output of a 3D scanner, are typically noisy, unstructured, and can exhibit strong sampling bias.
Hence, extracting structured features, such as the feature edges, from an unordered point cloud is a vital geometry processing task.
Sharp geometric edges can be used as an abstraction of a complex 3D shape, facilitating downstream tasks including surface reconstruction, normal estimation, and shape classification.
Previous state-of-the-art methods mainly resort to a \emph{keypoint fitting} strategy to extract parametric edge curves from a point cloud.
Specifically, they first detect a sparse set of keypoints, such as the endpoints or points on sharp edges, and then group these points into individual sets according to predefined topologies.
Finally, each point set is converted into a parametric curve using spline fitting.

\input{figures/teaser}

Recent approaches have strove to improve the accuracy of edge point detection by using hand-crafted features~\cite{merigot2010voronoi} or deep neural networks~\cite{yu2018ec,wang2020pie,bazazian2021edc,matveev2022def}. 
Despite the impressive progress that has been made, existing works still have the following limitations.
1) The widely adopted \emph{point-wise} classification approaches tend to generate noisy estimations -- the predicted edge points typically contain a spurious set of candidate points (see Fig.~\ref{fig:comp_edgepoints_vis}), which requires further processing for keypoint cleaning and increases the risk of false/missing connections.
2) The grouping procedure highly relies on the accuracy of endpoint detection. 
However, it remains difficult to accurately locate endpoints especially when the normal of its surrounding points change smoothly.
3) They require tedious treatments to cope with different curve topologies, including curve type estimation, topology-dependent artifact points removal and curve connection, \emph{etc}.

% Their outputs are limited to a preset categories of curve topologies~\yinyu{citations}, e.g. line, circles, or B-splines, making it difficult to scale to more complex free-form curves. 

% CAD models are originally represented by parametric curves. To extract those curves from a point cloud is known as a reverse engineering task. It plays a very fundamental role in industrial applications \cite{}. Existing methods usually solve this problem using a ``\emph{detect-group-fit}'' workflow \cite{}. First, they always detect the points which lie on sharp edges and also the corner points. Then, those edge points are grouped into some individual open-curve set (the curve connects corner points) or closed-curve set. At last, each point set is converted into a parametric curve with spline fitting.  

% Although recent methods used deep learning to benefit both the detection and grouping module \cite{}, the results are still far from satisfaction. We found the challenges come from three aspects: 1) The detected edge points tend to have band-width, making both grouping and fitting be prone to error. 2) The grouping procedure is highly relying on the accuracy of corner points detection. However, it is usually difficult to determine if a point is a corner especially when the normal of its surrounding points changed smoothly. 3) Open-curves and closed-curves need to be processed separately in different manners, making the complexity be increased. 

% \note{-- Key idea of our approach: 1) Instead of extracting structures from unstructured points, we proposed to infer structured edges directly, which bypasses the limitation of point-wise classification. }

Our key observation is that the above issues can be resolved if we can \emph{directly predict structured edges} in the form of \emph{piece-wise linear} (PWL) curves from the input point cloud. 
This bypasses the problematic keypoint detection and avoids the error-prone edge extraction in the curve fitting stage.
In addition, PWL curve is a general representation of free-form curves, removing the need of curve topology estimation and the laborious curve fitting and post-processing dependent on curve category.
Furthermore, PWL curves can be easily converted to parametric curves using the off-the-shelf solutions.
However, unlike its parametric counterpart, PWL curves are notoriously difficult to predict due to its large degrees of freedom.  

Towards this end, we propose \emph{\modelName{}}, a novel neural edge representation in a volumetric fashion. 
As shown in Fig.~\ref{fig:cube_definition},  \modelName{} represents 3D structured edges using a regular grid of volumetric cubes -- each cube encodes rich structural information including 1) one binary indicator of edge occupancy, 2) edge orientations (if any), and 3) one edge point position (if any).
Thereby, \modelName{} can be readily converted to PWL curves by connecting the edge points enclosed by \modelName{} cubes according to the encoded point connectivity.
The introduction of \modelName{} brings several advantages. 
First, the generated \modelName{} cubes are structured by itself, which greatly simplifies the process of curve extraction.
Second, it is fully compatible with the PWL curve representation, and hence, can deal with all types of curves in a unified manner.
Third, \modelName{} cubes can be viewed as a coarse representation of the point cloud. Predicting the occupancy of a volumetric cube is easier and more robust than point-wise classification. 
Therefore, we are less likely to suffer from the issue of missing curves (see our results in Fig.~\ref{fig:comp_paramcurve}). %(see comparisons between DEF~\cite{matveev2022def} and ours in Fig.~\ref{fig:comp_paramcurve}). 
Lastly, inferring \modelName{} can be formulated as a voxel-wise classification and regression problem, where the well-developed 3D convolutional networks can be directly employed.


% Taking these issues into account, we think the main reason is lying at the inherent difficulty to extract structures from unstructured points. Thus, an interesting question is coming: \emph{Is it possible to infer structured edges directly?} We then found the possibility if the point cloud is converted into a volumetric representation. Specifically, let us consider two adjacent cubes $A$ and $B$ in the volume. If we first know that both $A$ and $B$ contain edges inside, and we also know a point $p$ in $A$ and a point $q$ in $B$ that lies on the edge. If it is also known the face $f$ between $A$ and $B$ is crossed by the edge, we can infer a line segment $\hat{pq}$ which belongs to the edge. (Note that, $A$ and $B$ may be crossed by two separate edges, while it can be ignored when the cube is small enough. Practically, we found the resolution of $32^3$ works well.) After all adjacent cubes are processed in the above way, a lot of line segments can be produced, as seen in Fig. ~\ref{}. Based on these structured edge segments, it becomes easy to connect them to form polylines, making the curve fitting convenient.   

% To this end, in this paper, we propose a novel neural edge representation in the volumetric fashion, termed as \emph{NerVE}. For each voxel, it contains three attributes: a binary status defines if it contains edges, 3 binary status defines which adjacent face has edge connection, and an edge point inside it. We found this novel representation brings many advantages and can address the issues of existing methods very well. Firstly, the edge caused by \emph{NerVE} is itself structured which greatly simplifying the procedure of curve extraction. Secondly, there is no need to consider open or closed curve categories. \emph{NerVE} processes all curves in a unified fashion. Lastly and most importantly, extracting \emph{NerVE} from a point cloud can be directly formulated as voxel-wise classification and regression problem, where the well-developed volumetric learning methods can be employed.  

% We further propose a volumetric learning framework to predict \modelName{} from the input point cloud. 
% To deal with the prediction error, a carefully-designed post-processing step is presented for topology correction of the caused edges. 
% Finally, parametric curves are obtained by a straightforward spline fitting. 

% \yinyu{TODO: paragraphs below and contribution list need to be improved}

We further propose a volumetric learning framework to predict \modelName{} from the input point cloud. 
We first encode the point features into a volumetric feature grid with the same resolution of the output.
Then, a multi-head decoder is used to predict the attributes of a \modelName{} cube from its corresponding feature cell.
After converting the \modelName{} cubes into PWL curves, a specially-tailored post-processing procedure is proposed to correct potential topology errors in the resulting curves. 
Finally, the parametric curves can be obtained via a straightforward spline fitting algorithm. 

We evaluate our method on the ABC dataset~\cite{koch2019abc}, a large-scale collection of computer-aided design (CAD) models with challenging topology variations.
In particular, we compare with the state-of-the-art approaches on two different tasks: edge estimation and parametric curve extraction.
Experimental results show that by leveraging the proposed \modelName{} representation, our method can faithfully extract complete and accurate edges and parametric curves from intricate CAD models, outperforming the other methods both qualitatively and quantitatively.

We summarize our contributions as follows:
\begin{itemize}
   % \item We propose a simple and effective curve representation for parametric curve extraction with neural networks. Curves with different types and complicated topology in CAD models can be represented in a unified form.
   \item We propose \emph{NerVE}, a learnable neural volumetric edge representation that supports direct estimation of structured 3D edges, seamless conversion with general PWL curves, and compatibility with latest volumetric learning framework. 

   \item A pipeline for parametric curve extraction from point cloud that consists of a learning-based framework for faithful  \modelName{} cubes estimation and a post-processing module for curve topology correction. 
   
   \item We set a new state-of-the-art on the ABC dataset  in the task of parametric curve extraction from point cloud. 
\end{itemize}

% We first compare our method with the state-of-the-art edge estimation methods (VCM~\cite{merigot2010voronoi}, EC-Net~\cite{yu2018ec} and PIE-Net~\cite{wang2020pie}) on the closeness of the detected edge points to the groundtruth. 
% This demonstrates that NerVE can help to extract thinner and more accurate edges. 
% Then, for parametric curve extraction, our method is compared with the state-of-the-art methods (DEF~\cite{matveev2022def} and ComplexGen~\cite{guo2022complexgen}) which also demonstrates that our method outperforms them both qualitatively and quantitatively.

% Experiments are conducted on the ABC dataset \cite{}. 
% We first compare our method with existing edge estimation methods (VCM \cite{}, EC-Net \cite{} and PIE-Net \cite{}) on the closeness of the detected edge points to the groundtruth. This demonstrates that our \emph{NerVE} can help to extract thinner and more accurate edges. Then, for parametric curve extraction, our method is compared with the state-of-the-art methods (DEF \cite{} and ComplexGen \cite{}) which also demonstrates that our method outperforms them both qualitatively and quantitatively. 
  
% ----------------------
% Contribution list
% ----------------------
% \begin{itemize}
%   % \item We propose a simple and effective curve representation for parametric curve extraction with neural networks. Curves with different types and complicated topology in CAD models can be represented in a unified form.
%   \item We propose \emph{NerVE}, a novel neural edge representation that overturns existing ``detect-group-fit'' workflow. We strongly believe it brings new insights in the community. 
   
%     %\item We develop a learning framework for training and predicting our curve representation from point cloud.

%   \item A learning-based framework is designed to extract \emph{NerVE} from a given point cloud. And, a post-processing method is also proposed for parametric curve extraction. 

%     %\item A Bottom-Up process for parametric curve extraction is suggested based on our curve representation.

%   \item Experiments have demonstrated our method consistently outperforms the SOTA methods, both qualitatively and quantitatively. 
    
% \end{itemize}

% \begin{figure*}[t]
% 	\centering
% 	\begin{subfigure}[t]{0.60\textwidth}
% 		\centering
% 		\includegraphics[width=\linewidth]{plots/model.pdf}
% 		\caption{\red{need caption; dotted lines to denote frozen model parameters.}}
%         \label{figure:model-layout}
% 	\end{subfigure}%
% 	~ 
% 	\begin{subfigure}[t]{0.36\textwidth}
% 		\centering
% 		\includegraphics[width=\linewidth]{plots/constraints.pdf}
% 		\caption{Query alignment constraints [3a]: eq~\ref{Z-a} At most one query per segment; [3b]: eq~\ref{Z-b} All queries must be aligned; [3c]: eq~\ref{Z-c} Ordering constraints between queries obtained from topological sorting. \red{explain the last figure;}}
%         \label{figure:constraints}
% 	\end{subfigure}%
% 	% \caption{}
% 	% \label{figure:model-layout}
% \end{figure*}

\begin{figure*}
\centering
    \includegraphics[width=\linewidth]{plots/model-layout.pdf}
    %\vspace{-10pt}
    \caption{\textbf{NSG model}~(a)~semantic parser converts NL descriptions into a graph $G$ of symbolic queries; query encoders $f^{\theta_{\tau}}$ detect queries in individual video segments $s_t$; and a video aligner aligns $G$ with video segments by computing alignment matrix $\mathrm Z$ via a constrained optimization problem (Eq.~\ref{Z-main}).~(b)~The constraints (Eqs.~\ref{Z-a}~\ref{Z-b}~\ref{Z-c}) and the recursive structure (Eq.~\ref{eq:dp}) enabling use of DP to solve for $\mathrm Z$. Here, the blue box denotes $F^{\ast}((n_j)_j^{N-1}, (s_t)_t^{S-1})$, the green boxes denote $ \log f^{\theta}(a_j, s_t) + F^{\ast}((n_j)_{j+1}^{N-1}, (s_t)_{t+1}^{S-1})$, and the red box denotes $F^{\ast}((n_j)_j^{N-1}, (s_t)_{t+1}^{S-1})$.}
    
    % (a) Semantic Parser parses the language instruction into a graph $G(V, E)$ where vertices represent queries and edges represent ordering constraints. Each query has a \emph{type} and a set of arguments ($a$) and is modeled using a Query Encoder $f^{\theta_{\tau}}$ corresponding to the type. The Query Encoder processes the arguments of the query $a_j$ and a video segment $s_t$ to find the probability of the arguments being true in the video segment $f^{\theta_{\tau}}(a_j, s_t)$. (b) Constraints for DP-based alignment (i) no two queries are aligned to the same segment (Eq.~\ref{Z-a}); (ii) all queries are accounted for in $S$ (Eq.~\ref{Z-b}); (iii) temporal ordering constraints between queries are respected (Eq.~\ref{Z-c}); (iv) visualization of Eq.~\ref{eq:dp}: Here, the blue box denotes $F^{\ast}((n_j)_j^{N-1}, (s_t)_t^{S-1})$, the green boxes denote $ \log f^{\theta}(a_j, s_t) + F^{\ast}((n_j)_{j+1}^{N-1}, (s_t)_{t+1}^{S-1})$, and the red box denotes $F^{\ast}((n_j)_j^{N-1}, (s_t)_{t+1}^{S-1})$. The DP computes the best alignment of the queries and segments in the blue box by computing the $\max$ over the optimal subproblems in the green and red boxes.}
    \label{figure:model-layout}
%\vspace{-10pt}
\end{figure*}
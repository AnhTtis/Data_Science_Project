
\newcommand{\tikznode}[2]{\relax
\ifmmode%
    \tikz[remember picture,baseline=(#1.base),inner sep=0pt] \node (#1) {$#2$};
\else
    \tikz[remember picture,baseline=(#1.base),inner sep=0pt] \node (#1) {#2};%
\fi}
\tikzset{box around/.style={
    draw,rounded corners,
    inner sep=1pt,outer sep=2pt,
    node contents={},fit=#1
},      
}
\newcommand{\BoxAround}[2][]{
\tikz[overlay,remember picture]{%
\node[blue,dash pattern=on 2pt off 1.25pt,#1,box around=#2];
}}
\newcommand{\phij}{\frac34+\langle\bphi_{i,j},\btheta\rangle}
\newcommand{\phji}{\frac14+\langle\bphi_{j,i},\btheta\rangle}
\newcommand{\fbt}[1]{\frac34+\langle\textbf{bit}(#1),\btheta\rangle}
\footnotesize{
\begin{align*}
    \arraycolsep=4pt\def\arraystretch{1.1}
    \begin{tabular}{r}
        $\text{``good''} \left\{ \lefteqn{\phantom{\begin{matrix}  \\  \\  \ \end{matrix}}} \right.  $ \\
        $\text{``bad'' } \left\{ \lefteqn{\phantom{\begin{matrix}  \\  \\  \ \end{matrix}}} \right.  $
    \end{tabular}
    \hspace{-8pt}
    % \left[
    %     \begin{array}{ccc|ccc}
    %         \frac12 & \cdots & \frac12 &         &        &         \\
    %         \vdots  & \ddots & \vdots  &         & \phij  &         \\
    %         \frac12 & \cdots & \frac12 &         &        &         \\ \hline
    %         &        &         & \frac12 & \cdots & \frac12 \\
    %         & \phji  &         & \vdots  & \ddots & \vdots  \\
    %         &        &         & \frac12 & \cdots & \frac12 \\
    %     \end{array}
    % \right]
    \left[
        \begin{array}{c|c}
            \begin{array}{ccc}
                \frac12 & \cdots & \frac12 \\
                \vdots  & \ddots & \vdots  \\
                \frac12 & \cdots & \frac12 \\
            \end{array}
            &
            \tikznode{orig}{\phij} \\ \hline
            \phji
            &
            \begin{array}{ccc}
                \frac12 & \cdots & \frac12 \\
                \vdots  & \ddots & \vdots  \\
                \frac12 & \cdots & \frac12 \\
            \end{array}
        \end{array}
    \right]
    \tikznode{dest}{
    \begin{array}{lllll}
        % {\color{blue} \bphi_{i,j} = \textbf{bit}(i)} & & & \\
        % \\
        \fbt{0}      &  \fbt{0}      &  \cdots      &  \fbt{0} \\
        \fbt{1}      &  \fbt{1}      &  \cdots      &  \fbt{1} \\
        \vdots       &  \vdots       &  \ddots      &  \vdots  \\
        \fbt{2^d-1}  &  \fbt{2^d-1}  &  \cdots      & \fbt{2^d-1}  \\
    \end{array}
    }
\end{align*}
}

\BoxAround[blue]{(orig)}
\BoxAround[blue]{(dest)}
\tikz[overlay,remember picture]{%
\draw[blue,dash pattern=on 2pt off 1.25pt] (dest.north west) edge (orig.north);
}
\tikz[overlay,remember picture]{%
\draw[blue,dash pattern=on 2pt off 1.25pt] (dest.south west) edge (orig.south);
}
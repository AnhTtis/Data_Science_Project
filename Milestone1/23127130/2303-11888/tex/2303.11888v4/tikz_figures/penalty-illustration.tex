\tikzstyle{waypoint} = [ellipse, x radius=6pt, y radius=3pt]
\tikzstyle{legend} = [rectangle, minimum width=0.5cm, align=center, rounded corners, opacity=0.75]
\begin{figure*}
    \centering
    \begin{adjustbox}{width=0.95\textwidth}
        \begin{tikzpicture}[node distance=2cm]
            %%%%%%%%%%%%%%%%%%%%Images%%%%%%%%%%%%%%%%%%%
            \node[inner sep=0pt, label={[label distance=0cm]90:Red Light Penalty}] (red-light-penalty1) at (0,0)
            {\includegraphics[width=5cm]{figures/red_light_penalty1.png}};
            \node[inner sep=0pt, below of=red-light-penalty1, yshift=-2cm] (red-light-penalty2)
            {\includegraphics[width=5cm]{figures/red_light_penalty2.png}};
            
            \node[inner sep=0pt, right of= red-light-penalty1, xshift=3.5cm, label={[label distance=0cm]90:Stop Sign Penalty}] (stop-sign-penalty1) 
            {\includegraphics[width=5cm]{figures/stop_sign_penalty1.png}};
            \node[inner sep=0pt, below of=stop-sign-penalty1, yshift=-2cm] (stop-sign-penalty2)
            {\includegraphics[width=5cm]{figures/stop_sign_penalty2.png}};
            
            \node[inner sep=0pt, right of= stop-sign-penalty1, xshift=3.5cm, label={[label distance=0cm]90:Speed  Penalty}] (speed-penalty1) 
            {\includegraphics[width=5cm]{figures/speed_penalty1.png}};
            \node[inner sep=0pt, below of=speed-penalty1, yshift=-2cm] (speed-penalty2)
            {\includegraphics[width=5cm]{figures/speed_penalty2.png}};
            %%%%%%%%%%%%%%%%%%%%Images%%%%%%%%%%%%%%%%%%%
            
            %%%%%%%%%%%%%%%%%%%%Legend%%%%%%%%%%%%%%%%%%%
            \node (legend1) [legend, below of=red-light-penalty2, xshift=-2.25cm, yshift=-0.5cm, minimum width=0.5cm, minimum height=0.5cm, fill=red, label={[label distance=0cm]0: Penalised waypoints}]  {};
            \node (legend2) [legend, right of=legend1, xshift=1.75cm, yshift=0cm, minimum width=0.5cm, minimum height=0.5cm, fill=green, label={[label distance=0cm]0: Compliant waypoints}]  {};
            %%%%%%%%%%%%%%%%%%%%Legend%%%%%%%%%%%%%%%%%%%
        \end{tikzpicture}
    \end{adjustbox}
    \caption{\textbf{Penalty Illustration.} To ensure compliance with red light and stop penalty rules, as well as promoting deceleration during turning maneuvers, our approach incorporates three distinct penalty types. The first column of the figures exemplifies the red light penalty, wherein waypoints situated beyond the stop line receive a penalty when the traffic light is red. In the second column, we demonstrate the stop sign penalty, wherein predicted waypoints within the vicinity of a stop sign are penalized if the agent fails to decelerate adequately. The speed penalty is enforced during turning actions as shown in last two figures. Specifically, if the predicted waypoints indicate an excessive speed, a speed penalty is imposed. }
    \label{fig:penalties}
\end{figure*}
\pdfoutput=1
\documentclass[11pt]{article}
\usepackage{enumerate}
\usepackage[OT1]{fontenc}
\usepackage{amsmath,amssymb}
% \usepackage{natbib}
\usepackage[usenames]{color}
%\usepackage[dvips]{graphicx}
%\usepackage{bm}
\usepackage{dsfont}
\usepackage{pgfplots}
\usepackage{smile}
\usepackage{multirow}
\usepackage{rotating}
\usepackage{enumerate}
\usepackage{esvect}
%\usepackage{enumitem}
%\usepackage[dvipsnames]{xcolor}
\usepackage{tikz}
\usetikzlibrary{patterns}
\usetikzlibrary{arrows}
\usetikzlibrary{bayesnet}
\usepackage{authblk}
\usepackage{caption}

% \usepackage{subfigure}
%\usepackage{makecell}
\usepackage[colorlinks,
            linkcolor=red,
            anchorcolor=blue,
            citecolor=blue
            ]{hyperref}
%\usepackage{algorithm}  
%\usepackage{algpseudocode}
%\usepackage{algorithmicx}  
\usepackage{algorithm}
\usepackage{algorithmic}
% \usepackage{dutchcal}

\renewcommand{\algorithmicrequire}{\textbf{Input:}}  % Use Input in the format of Algorithm  
\renewcommand{\algorithmicensure}{\textbf{Output:}} % Use Output in the format of Algorithm 




\def\sign{\mathop{\text{sign}}}
\def\supp{\mathop{\text{supp}}}
\def\card{\mathop{\text{card}}}
\def\rank{\mathrm{rank}}
\long\def\comment#1{}
\def\skeptic{{\sc skeptic}}
\def\NPN{\bPiox{\it NPN}}
\def\vec{\mathop{\text{vec}}}
\def\tr{\mathop{\text{Tr}}}
\def\trc{\mathop{\text{TRC}}}
\def\cS{{\mathcal{S}}}
\def\dr{\displaystyle \rm}
\def\skeptic{{\sc skeptic}}
\providecommand{\bnorm}[1]{\Big\vvvert#1\Big\vvvert}
\providecommand{\norm}[1]{\vvvert#1\vvvert}
\def\oper{\mathop{\text{op}}}
\def\fro{\mathop{\text{fro}}}

\newcommand{\bel}{\begin{eqnarray}\label}
\newcommand{\eel}{\end{eqnarray}}
\newcommand{\bes}{\begin{eqnarray*}}
\newcommand{\ees}{\end{eqnarray*}}
\def\bess{\bes\small }
\def\Shat{{\widehat S}}
\def\lam{\rho}
\def\real{{\mathbb{R}}}
\def\R{{\real}}
\def\Ti{T_{\rm init}}
\def\Tm{T_{\rm main}}
\def\bcdot{{\bm \cdot}}
\def\rd{\mathrm{d}}
\newcommand{\red}{\color{red}}
\newcommand{\blue}{\color{blue}}
\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}
\newcommand{\cIs}{\cI_{\hat{s}}}
\newcommand{\pess}{\texttt{Pess}}
\newcommand{\linpess}{\texttt{Pess}}
\let\oldemptyset\emptyset
\let\emptyset\varnothing
\let\hat\widehat
\let\tilde\widetilde
\def\mid{\,|\,}
\def\eps{\epsilon}
\def\reals{{\mathbb R}}
\def\GG{{\mathbb G}}
\def\HH{{\mathbb H}}
\def\E{{\mathbb E}}
\def\B{{\mathbb B}}
\def\htheta{\widehat \btheta}
\def\ttheta{\widetilde \btheta}
\def\hSigma{\widehat \bSigma}
\def\hS{\widehat S}
\def\hR{\widehat \Rb}
\def\hu{\widehat \bu}
\def\supp{\mathop{\text{supp}\kern.2ex}}
\def\argmin{\mathop{\text{\rm arg\,min}}}
\def\argmax{\mathop{\text{\rm arg\,max}}}
\def\Deltab{{\mathbf \Delta}}
\def\given{{\,|\,}}
\def\ds{\displaystyle}
%\def\bs{\backslash}
\def\R{{\mathcal{R}}}
\def\tr{{\rm{Tr}}}
\def\sign{\mathrm{sign}}
\def\supp{\mathop{\text{supp}}}
\def\card{\mathop{\text{card}}}
\def\rank{\mathrm{rank}}
\def\median{\mathrm{median}}
\def\M{{\mathrm M}}
\def\Q{{\mathrm Q}}
\def\Psib{{\mathbf \Psi}}
\def\hmedian{\hat{\mathrm{median}}}
\def\skeptic{{\sc skeptic}}
\def\NPN{\mbox{\it NPN}}
\def\vec{\mathop{\text{vec}}}
\def\tr{\mathrm{Tr}}
\def\trc{\mathop{\text{TRC}}}
\def\var{\mathop{\text{var}}}
\def\I{{\mathbf{I}}}

\def\pa{\mathrm{pa}}
\def\Pie{{\Pi}}
\def\piestar{{\pi^*}}
\def\piehat{{\hat \pi_\cD}}
\def\pie{{\pi}}
\def\pib{{\pi_\text{ob}}}
\def\piepessi{{\hat\pie}}
\newcommand{\op}{o_{\raisemath{-1.5pt}\PP}}
\newcommand{\Op}{O_{\raisemath{-1.5pt}\PP}}
\def\th{{\tilde h}}
\theoremstyle{plain}

\usepackage{mathrsfs}
%\usepackage{refcheck}
\usepackage{fullpage}
\renewcommand{\baselinestretch}{1.25}

\def\sep{\;\big|\;}
\def \trunc{\mathop{\text{trunc}}}
\def \obs {{\rm obs}}
\def \mis {{\rm mis}}
\def \hbSigma {\widehat{\bSigma}}
\def \bbSigma {\bar{\bSigma}}
\def \iid {\stackrel{\text{i.i.d.}}{\sim}}
\def \iidtext {\textrm{i.i.d.}}

\usepackage{hyperref}
% \usepackage{refcheck}
\usepackage[protrusion=false,expansion=true]{microtype}
% \usepackage[activate={true,nocompatibility},final,tracking=true,kerning=true,spacing=true,factor=1100,stretch=10,shrink=10]{microtype}

\def\##1\#{\begin{align}#1\end{align}}
\def\$#1\${\begin{align*}#1\end{align*}}

%%%%%%%%%%%%------------------ Comments -----------------------%%%%%%%%%%%%
\newcommand{\Zhuoran}[1]{{\color{blue}[Zhuoran: #1]}}
\newcommand{\Zhaoran}[1]{{\color{green}[Zhaoran: #1]}}
\newcommand{\Yitan}[1]{{\color{red}[Yitan: #1]}}
\newcommand{\Siyu}[1]{{\color{purple}[Siyu: #1]}}

%%%%%%%%%%%%------------------ LAD PAPER -----------------------%%%%%%%%%%%%
\def\beps{{\bm{\zeta}}}
\usepackage{undertilde}
%\theoremstyle{plain}
\newcommand{\mse}{\mbox{MSE}}
\newcommand\todo{\textcolor{red}}
\def\tianqi{\textcolor{red}}
\newcommand{\sgn}{\mathop{\mathrm{sign}}}



\newcommand{\mk}[1]{\textcolor{green}{Mladen: #1}}
\newcommand{\boxpar}[1]{\fbox{\begin{minipage}{0.9\textwidth}#1\end{minipage}}}

\theoremstyle{mytheoremstyle}
\newtheorem{innercustomass}{Assumption}
\newenvironment{customass}[1]
  {\renewcommand\theinnercustomass{#1}\innercustomass}
  {\endinnercustomass}
\def\PPT{{\mathbb P_*}}

\def\T{{ \mathrm{\scriptscriptstyle T} }}
\def\Pr{\mathrm{Pr}}
\def\nend{\nonumber\\}
\def\CI{\text{CI}}



\def\tpr{\tilde{p}}
\def\vf{\bm{f}}
\def\vF{\cF}

\def\Gb{{\cG_b}}
\def\Ge{{\cG_e}}

\def\pr{p}

\def\vT{{\mathcal{T}}}
\def\vhHstar{{\vh_{\vH}^*}}
\def\vhstar{{\vh^*}}
\newcommand\hHstark[1]{{h^*_{\vH, #1}}}
\def\vareH{{\varepsilon_{\vH}}}
\def\vareTheta{{\varepsilon_{\vTheta}}}
\def\vX{X}
\def\vY{Y}
\def\vZ{Z}
\def\vh{h}
\def\vH{\cH}
\def\vtheta{\theta}
\def\vTheta{{\Theta}}
\def\ve{e}
\def\vcL{\cL}
\newcommand\thetaTstark[1]{{\theta_{\Theta, #1}^*}}


\def\pob{{\pr_{\text{ob}}}}
% \def\pin{{\pr_{\text{in}}}}
\def\EEob{{\EE_{\text{ob}}}}
\def\EEin{{\EE_{\text{in}}}}
\def\CATE{{\text{CATE}}}
\def\aseq{\overset{a.s.}{=}}
\def\CIH{\CI_{\vH, \cD}}
\def\CICATE{\CI_{\cD}}
\newcommand\gpessi[1]{{\hat g^{#1}}}
\def\gHstar{{g_\vH^*}}
\def\gstar{{g^*}}
\newcommand\gH[1]{{g_\cH^#1}}
\newcommand\hstark[1]{h^*_{#1}}
\newcommand\hpessik[2]{\hat h_{#1}^{#2}}
\newcommand\vhpessi[1]{{\hat h^{#1}}}
\def\SubOpt{\text{SubOpt}}
\def\doopt{\text{do}}
\def\vhHpie{{\vh_\vH^\pie}}
\newcommand\hHpiek[1]{{h_{\vH, #1}^\pie}}
\def\gHpie{g_\vH^\pie}
\newcommand\h[2]{h_{#1}^{#2}}
\newcommand{\RNum}[1]{\uppercase\expandafter{\romannumeral #1\relax}}
% \def\gpessi{{\hat g}}
%\hypersetup{colorlinks=true, linkcolor=black}
\def\sF{\mathscr{F}}
\def\sY{\mathscr{Y}}
\newcommand\pin[1]{{p_{\text{in}}^#1}}
\def\tcO{{\tilde\cO}}

\usepackage{subcaption}
\usetikzlibrary{shapes,decorations,arrows,calc,arrows.meta,fit,positioning}
\tikzset{
    -Latex,auto,node distance =1 cm and 1 cm,semithick,
    state/.style ={circle, draw, minimum width = 1 cm},
    missingstate/.style ={circle, draw, minimum width = 1 cm, fill=lightgray},
    hiddenstate/.style ={circle, draw, minimum width = 1 cm, fill=darkgray, text=white},
    point/.style = {circle, draw, inner sep=0.04cm,fill,node contents={}},
    bidirected/.style={Latex-Latex,dashed},
    el/.style = {inner sep=2pt, align=left, sloped},
    normal/.style={-stealth', line width=1},
    double/.style={stealth'-stealth', line width=1},
}


%%%%%%%%%%%%%%%%%%%new command (start)


\title{\huge A Unified Framework of Policy Learning for Contextual Bandit with Confounding Bias and Missing Observations}
\author[1]{Siyu Chen \thanks{Email: siyu.chen.sc3226@yale.edu}}

\author[1]{Yitan Wang \thanks{ Email: yitan.wang@yale.edu}}

\author[2]{Zhaoran Wang \thanks{Email: zhaoranwang@gmail.com}}

\author[1]{Zhuoran Yang \thanks{Email: zhuoran.yang@yale.edu}}


\affil[1]{
% \footnotesize 
\small
\textit{Department of Statistics and Data Science, Yale University}}
\affil[2]{
% \footnotesize 
\small
\textit{Department of Industrial Engineering and Management Sciences, Northwestern University}}
\date{}
\begin{document}
\maketitle
\vspace{-25pt}
\begin{abstract}
We study the offline contextual bandit problem, where we aim to acquire an optimal policy using observational data.
However, this data usually contains two deficiencies: (i) some variables that confound actions are not observed, and (ii) missing observations exist in the collected data.
Unobserved confounders lead to a confounding bias and missing observations cause bias and inefficiency problems.
To overcome these challenges and learn the optimal policy from the observed dataset, we present a new algorithm called Causal-Adjusted Pessimistic (CAP) policy learning, which forms the reward function as the solution of an integral equation system, builds a confidence set, and greedily takes action with pessimism.
With mild assumptions on the data, we develop an upper bound to the suboptimality of CAP for the offline contextual bandit problem.
\end{abstract}

\input{intro}

\input{sec1}

\input{sec2}

\input{sec3}

\input{sec4}

\input{sec5}

\input{sec6}

\input{sec7}

\input{conclu}
%\input{appendix}
%\section*{Acknowledgement}




\newpage
\bibliographystyle{ims}
\bibliography{reference}


\newpage 
\appendix
\input{appendix}


\end{document}

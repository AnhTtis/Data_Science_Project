\subsection{Proof of Theorem \ref{thm:Fast rate}}\label{pro:Fast rate}
In this section, we prove that event $\cE$ holds with probability at least $1-4K\xi$ by Assumption \ref{asp:regularity} in Part \RNum{1}. Then, with Assumptions \ref{asp:Realizability} and \ref{asp:compatibility}, we prove that $\gHstar\in\CI_\cD(e_\cD)$ by showing the upper bound for $\cL_\cD(\vhHstar)$ in Part \RNum{2} and show the upper bound for the projected error $\nbr{\cT(\cdot)}$ for any $\vh\in\CIH(e_\cD)$ in Part \RNum{3}.

\paragraph{Part \RNum{1}. } We prove that event $\cE$ holds with probability at least $1-2K\xi$ with the help of the following two technical lemmas. 
\begin{lemma}[Lemma 11 in \cite{foster2019orthogonal}]\label{lem:1st order localized consistency}
Assume $\sup_{f\in\cF}\|f\|_\infty \le c$ and $f^*\in\cF$. Let $\eta$ be the constant such that
$$\cR_n(\eta;\text{star}(\cF-f^*))\le\eta^2/c$$
Additionally, we assume loss function $l(\cdot,\cdot)$ is $L$-Lipschitz in the first argument. Then with probability at least $1-\delta$ for all $f\in\cF$,
$$|(\EE_n[l(f(x),z)]-\EE_n[l(f^*(x),z)])-(\EE[l(f(x),z)]-\EE[l(f^*(x),z)])| \le L\eta_n(\|f-f^*\|_2+\eta_n),$$
where $\eta_n=\eta+c_0\sqrt{\log(c_1/\delta)/n}$ and $c_0$, $c_1$ are universal constants.
\end{lemma}

\begin{lemma}[Theorem 14.1 in \cite{wainwright2019high}]\label{lem:2nd order localized consistency}
Let $\cG$ be a star-shaped and $b$-uniformly bounded function class and $\eta_n$ be any positive solution of $R_s(\eta;\cG)\le \eta^2/b$. Then for any $t\ge\eta_n + c_0\sqrt{\log(c_1/\delta)/n}$, we have
$$|\|g\|_n^2-\|g\|_2^2| \le \frac{1}{2}\|g\|_2^2+\frac{1}{2}t^2, \quad \forall g\in\cG$$
with probability at least $1-\delta$.
\end{lemma}

In Lemma \ref{lem:1st order localized consistency}, we substitute $f$ for $\alpha_k(\vh, \cY_k)\theta_k(\cZ_k)$ and $f^*$ for a zero-like function. We simply let $l(f(x), z)=f(x)$. For all $\vh\in\CI_{\vH, \cD}(e_\cD)\subseteq\vH$ and $\theta_k\in\Theta_k$, it holds with probability at least $1-\xi$ that 
\begin{align}
    &\abr{\EE_{\cD_k}\sbr{\alpha_k(\vh, \cY_k) \theta_k(\cZ_k)} -\EE_{\cD_k}\sbr{\alpha_k(\vh, \cY_k) \theta_k(\cZ_k)}} \nend
    &\le \eta_k\rbr{\nbr{\alpha_k(\vh, \cY_k)\theta_k(\cZ_k)}_{\mu_k, 2}+\eta_k}\nend
    &\le \eta_k\rbr{L_\alpha\nbr{\theta_k}_{\mu_k, 2}+\eta_k}, \label{eq:2 fr}
\end{align}
where $\eta_k$ bounds the critical radius for $\alpha_k(\vh, \vY_k)\theta_k(\vZ_k)$. Following Lemma \ref{lem:2nd order localized consistency} and substituting $g$ for $\theta_k$, it holds also  with probability at least $1-\xi$ that 
\begin{align}
    \abr{\norm{\theta_k}^2_{\cD_k, 2}-\norm{\theta_k}^2_{\mu_k, 2}}\le \frac 1 2\rbr{\norm{\theta_k}^2_{\mu_k, 2}+\eta_k^2}, \label{eq:1 fr}
\end{align}
where $\eta_k$ also bounds the critical radius for $\theta_k$.
Recall the definition of $\cE$,
\begin{align*}
    \cE &= \Big\{\abr{\EE_{\cD_k}\sbr{\alpha_k(\vh, \cY_k) \theta_k(\cZ_k)} - \EE_{\mu_k}\sbr{\alpha_k(\vh, \cY_k) \theta_k(\cZ_k)}} \le \eta_k\rbr{L_\alpha\nbr{\theta_k}_{\mu_k, 2}+\eta_k},\nend
    &\quad \abr{\norm{\theta_k}^2_{\cD_k, 2}-\norm{\theta_k}^2_{\mu_k, 2}}\le \frac 1 2\rbr{\norm{\theta_k}^2_{\mu_k, 2}+\eta_k^2}, 
    \forall \vh\in \vH, \forall \theta_k\in\Theta_k, \forall k\in\{1, \cdots, K\}\Big\}.
\end{align*}
Combining \eqref{eq:1 fr} and \eqref{eq:2 fr} and taking a union bound over $k\in\{1, \cdots, K\}$, it is straight forward that $\cE$ holds with probability at least $1-2K\xi$.

\paragraph{Part \RNum{2}.}
We prove that $\gHstar\in\CI_\cD(e_\cD)$ if $e_\cD>2\vareH^2+(2L_\alpha^2+5/4)\eta^2$ by showing the upper bound for $\cL_\cD(\vhHstar)$ in this part.
For the empirical loss function with respect to $\vhHstar$, it holds on $\cE$ that
\begin{align*}
    \cL_{k, \cD}(\vhHstar)&=\sup_{\theta_k\in\Theta_k}\EE_{\cD_k}\sbr{\alpha_k(\vhHstar, \cY_k) \theta_k(\cZ_k)}-\frac 1 2 \norm{\theta_k}_{\cD_k, 2}^2\nend
    &\le \sup_{\theta_k\in\Theta_k} \Big\{\abr{\EE_{\cD_k}\sbr{\alpha_k(\vhHstar, \cY_k) \theta_k(\cZ_k)} - \EE_{\mu_k}\sbr{\alpha_k(\vhHstar, \cY_k) \theta_k(\cZ_k)}}\nend
    &\quad + \frac 1 2 \abr{\norm{\theta_k}^2_{\cD_k, 2}-\norm{\theta_k}^2_{\mu_k, 2}}
    + \EE_{\mu_k}\sbr{\alpha_k(\vhHstar, \cY_k) \theta_k(\cZ_k)} - \frac 1 2 \norm{\theta_k}^2_{\mu_k, 2}\Big\}\nend
    &\overset{\cE}{\lesssim} \sup_{\theta_k\in\Theta_k} \Big\{\eta_k\rbr{L_\alpha\norm{\theta_k}_{\mu_k, 2}+\eta_k} + \frac 1 4\rbr{\norm{\theta_k}^2_{\mu_k, 2}+\eta_k^2} \nend 
    &\quad + \EE_{\mu_k}\sbr{\alpha_k(\vhHstar, \cY_k) \theta_k(\cZ_k)} - \frac 1 2 \norm{\theta_k}^2_{\mu_k, 2}\Big\}, 
\end{align*}
where the last inequality holds by the definition of $\cE$. Let $\cL^{\lambda}_k(\cdot)=\sup_{\theta_k\in\Theta_k}\EE_{\mu_k}\sbr{\alpha_k(\cdot, \cY_k) \theta_k(\cZ_k)} - \lambda \norm{\theta_k}^2_{\mu_k, 2}$. It then holds for $\cL_{k, \cD}(\vhHstar)$ that
\begin{align}
   \cL_{k, \cD}(\vhHstar) \le \cL^{1/8}_k(\vhHstar) - \inf_{\theta_k\in\Theta_k}\rbr{\frac 1 8   \norm{\theta_k}^2_{\mu_k, 2} - L_\alpha\eta_k\norm{\theta_k}_{\mu_k, 2}} + \frac 5 4\eta_k^2,\label{eq:3 fr}
\end{align}
We further let $\theta_k^\lambda(\cdot;\vh)=\arg\sup_{\theta_k\in\Theta_k}\cL^\lambda_k(\vh)$.
To bridge $\cL_k^{1/8}$ to $\cL_k^{1/2}$, we first study the scaling property of $\cL_k^\lambda$.
For $\cL^{\lambda_1}_k(\vh)$ and $\cL^{ \lambda_2}_k(\vh)$ where $0<\lambda_1\le \lambda_2$, it holds that
\begin{align}
    \cL^{\lambda_2}_k(\vh) &=\sup_{\theta_k\in\Theta_k}\EE_{\mu_k}\sbr{\alpha_k(\vh, \cY_k) \theta_k(\cZ_k)}-\lambda_2 \norm{\theta_k}_{\mu_k, 2}^2\nend
    &=\frac{\lambda_2}{\lambda_1}\cdot \sup_{\theta_k\in\Theta_k}\cbr{\EE_{\mu_k}\sbr{\frac{\lambda_1}{\lambda_2}\alpha_k(\vh, \cY_k) \theta_k(\cZ_k)}-\lambda_1 \norm{\theta_k}_{\mu_k, 2}^2}\nend
    &\ge \frac{\lambda_2}{\lambda_1}\cdot \rbr{\EE_{\mu_k}\sbr{\frac{\lambda_1}{\lambda_2}\alpha_k(\vh, \cY_k) \cdot \frac{\lambda_1}{\lambda_2}\theta_k^{\lambda_1}( \cZ_k;\vh)}-\lambda_1 \nbr{\frac{\lambda_1}{\lambda_2}\theta_k^{\lambda_1}(\cZ_k;\vh)}_{\mu_k, 2}^2}\nend 
    &\ge \frac{\lambda_1}{\lambda_2} \cL^{ \lambda_1}_k(\vh),\label{eq:4 fr}
\end{align}
where the first inequality holds by letting $\theta_k = \lambda_1\theta_k^{\lambda_1}/\lambda_2$ where $\lambda_1\theta_k^{\lambda_1}/\lambda_2\in\Theta_k$ is guaranteed by noting that $\lambda_1\le\lambda_2$ and that $\Theta_k$ is star-shaped.
Plugging \eqref{eq:4 fr} into \eqref{eq:3 fr}, we see that
\begin{align}
    \cL_{k, \cD}(\vhHstar)
    &\overset{\cE}{\lesssim} 4\cL^{1/2}_k(\vhHstar) - \inf_{\theta_k\in\Theta_k}\rbr{\frac 1 8   \norm{\theta_k}^2_{\mu_k, 2} - L_\alpha\eta_k\norm{\theta_k}_{\mu_k, 2}} + \frac 5 4 \eta_k^2\nend 
    &\le 4\cL^{1/2}_k(\vhHstar) + 
    \rbr{2L_\alpha^2 + \frac 5 4} \eta_k^2, \label{eq:5 fr}
\end{align}
where the second inequality holds by a simple calculation of the infimum. 
Summing up \eqref{eq:5 fr} for each $k$, we have
\begin{align}
    \cL_\cD(\vhHstar)
    &\overset{\cE}{\lesssim} \sum_{k=1}^K 4\cL_k(\vhHstar) + \rbr{2 L_\alpha^2+\frac 5 4}\sum_{k=1}^K\eta_k^2\nend
    &\le 2\nbr{\vT\vhHstar}_{2, \mu}^2+ \rbr{2 L_\alpha^2+\frac 5 4}\eta^2\nend
    & \le 2\vareH^2 + \rbr{2 L_\alpha^2+\frac 5 4}\eta^2,\label{eq:fr 3}
\end{align}
where the second equality holds by noting that
\begin{align*}
    \cL_k(\vhHstar)&=\sup_{\theta_k\in\Theta_k}\EE_{\mu_k}\sbr{\alpha_k(\vh(X), \vY_k) \theta_k(\vZ_k)}-\frac 1 2 \norm{\theta_k}_{\mu_k, 2}^2\nend
    &\le \sup_{\theta_k}\EE_{\mu_k}\sbr{\alpha_k(\vh(X), \vY_k) \theta_k(\vZ_k)}-\frac 1 2 \norm{\theta_k}_{\mu_k, 2}^2\nend
    &=\frac 1 2 \nbr{\cT_k \vh}_{\mu_k, 2}^2.
\end{align*}
The third inequality in \eqref{eq:fr 3} holds by Assumption \ref{asp:Realizability} of the realizability error.
By the nonnegtivity of the metric $\cL_{k, \cD}(\cdot)$, it follows on event $\cE$ that
\begin{align*}
    \cL_{k, \cD}(\vhHstar) - \inf_{\vh\in\vH}\cL_{k, \cD}(\vh)
    \overset{\cE}{\lesssim}
     4\cL^{1/2}_k(\vhHstar)+ \rbr{2 L_\alpha^2+\frac 5 4}\eta_k^2,
\end{align*}
and that
\begin{align*}
    \cL_{\cD}(\vhHstar) - \inf_{\vh\in\vH}\cL_{\cD}(\vh) 
    &\overset{\cE}{\lesssim} 2\vareH^2 + \rbr{2 L_\alpha^2+\frac 5 4}\eta^2. 
\end{align*}
Therefore, by definition of the confidence set in \eqref{def:CI}, with $e_\cD>2\vareH^2+(2L_\alpha^2+5/4)\eta^2$, it holds on $\cE$ that $\vhHstar\in\CI_{\vH, \cD}(e_\cD)$ and thereby $\gHstar\in\CICATE(e_\cD)$.

\paragraph{Part \RNum{3}.}
We derive the upper bound for $\cL_\cD(\vh)$ where $\vh\in\CIH(e_\cD)$ in this part.
We first give the lower bound on the empirical loss $\cL_{k,\cD}(\vh)$. 
It holds for all $\vh\in\CI_{\cD}(e_\cD)$ that
\begin{align} \label{eq:L_D(h_CI)-LB-1}
    \cL_{k,\cD_k}(\vh) 
    &=\sup_{\theta_k\in\Theta_k}\EE_{\cD_k}\sbr{\alpha_k(\vh, \cY_k) \theta_k(\cZ_k)}-\frac 1 2 \norm{\theta_k}_{\cD_k, 2}^2\nend
    &\ge \sup_{\theta_k\in\Theta_k} \Big\{-\abr{\EE_{\cD_k}\sbr{\alpha_k(\vh, \cY_k) \theta_k(\cZ_k)} -\EE_{\mu_k}\sbr{\alpha_k(\vh, \cY_k) \theta_k(\cZ_k)}} \nend
    &\quad -\frac 1 2 \abr{\norm{\theta_k}^2_{\cD_k, 2}-\norm{\theta_k}^2_{\mu_k, 2}} + \EE_{\mu_k}\sbr{\alpha_k(\vh, \cY_k) \theta_k(\cZ_k)} - \frac 1 2 \nbr{\theta_k}_{\mu_k, 2}^2\Big\}\nend
    &\overset{\cE}{\gtrsim} \sup_{\theta_k\in\Theta_k} \Big\{- \eta_k\rbr{L_\alpha\nbr{\theta_k}_{\mu_k, 2}+\eta_k} - \frac 1 4\rbr{\norm{\theta_k}^2_{\mu_k, 2}+\eta_k^2}\nend
    &\quad + \EE_{\mu_k}\sbr{\alpha_k(\vh, \cY_k) \theta_k(\cZ_k)} - \frac 1 2 \nbr{\theta_k}_{\mu_k, 2}^2\Big\}.
\end{align}
where the second equality holds by the definition of $\cE$.
Let $\Theta_k^+(\vh)=\{\theta_k\in\Theta_k: \EE_{\mu_k}\sbr{\alpha_k(\vh, \vY_k) \theta_k(\vZ_k)}>0\}$. For any $\theta_k^+\in\Theta_k^+(\vh)$, suppose that $\EE_{\mu_k}\sbr{\alpha_k(\vh, \vY_k) \theta_k^+(\vZ_k)}=\beta \nbr{\theta_k^+}_{\mu_k, 2}^2$. By definition of $\theta_k^+$, we have that $\beta > 0$.
We let $0<\kappa\le 1$. Note that $\Theta_k$ is star-shaped, and it follows that $\kappa \theta_k^+\in\Theta_k$. Therefore, by plugging in $\kappa \theta_k^+$ in \eqref{eq:L_D(h_CI)-LB-1},  we have for any $\vh\in\CI_{\vH, \cD}(e_\cD)$ and $\theta_k^+\in\Theta_k^+(\vh)$ that
\begin{align}\label{eq:L_D(h_CI)-LB-2}
    \cL_{k,\cD_k}(\vh) 
    &\overset{\cE_{k, 3}}{\gtrsim} \kappa\rbr{\beta-\frac 3 4 \kappa}\nbr{\theta_k^+}_{\mu_k, 2}^2 - \eta_k L_\alpha \kappa\nbr{\theta_k^+}_{\mu_k, 2} -  \frac 5 4\eta_k^2.
\end{align}
Recall the definition of the confidence set $\CIH(e_\cD)$. For any $\vh\in\CIH(e_\cD)$, it holds that
\begin{align}\label{eq:19}
    \cL_{\cD}(\vh)
    &\le \inf_{\vh\in\vH}\cL_{\cD}(\vh) + e_\cD\nend
    &\le \cL_{\cD}(\vhHstar) + e_\cD\nend
    &\overset{\cE}{\lesssim} 2\vareH^2 + \rbr{2 L_\alpha^2+\frac 5 4}\eta^2 + e_\cD,
\end{align}
where the second inequality holds by noting that $\vhHstar\in\vH$ and the last inequality follows from \eqref{eq:fr 3}.  By noting that $\cL_{k, \cD_k}(\cdot)\le \cL_\cD(\cdot)$, we can substitute the left-hand side of \eqref{eq:L_D(h_CI)-LB-2} by \eqref{eq:19} and obtain
\begin{align}\label{eq:quadratic inequation}
    \kappa\rbr{\beta-\frac 3 4 \kappa}\nbr{\theta_k^+}_{\mu_k, 2}^2 - \eta_k L_\alpha \kappa\nbr{\theta_k^+}_{\mu_k, 2} - \Delta_{k, \cD} \overset{\cE}{\lesssim} 0,
\end{align}
where 
\begin{align}
    \Delta_{k, \cD}= \frac 5 4\eta_k^2+2\vareH^2 + \rbr{2 L_\alpha^2+\frac 5 4}\eta^2 + e_\cD. \label{def:Delta}
\end{align} 
Note that \eqref{eq:quadratic inequation} holds for any $0<\kappa\le 1$.
By letting $\kappa = \min\{1, \beta\}$, we see that $\beta-3\kappa/4>0$. by solving the quadratic inequality in \eqref{eq:quadratic inequation}, it holds on event $\cE$ for all $\vh\in\CI_{\vH, \cD}(e_\cD)$ and $\theta_k^+\in\Theta_k^+(\vh)$ that
\begin{align}
    \nbr{\theta_k^+}_{\mu_k, 2}\overset{\cE}{\lesssim} \frac{\sqrt{\rbr{\eta_k L_\alpha \kappa}^2+\kappa\rbr{4\beta-3\kappa}\Delta_{k, \cD}}+\eta_k L_\alpha \kappa}{\kappa\rbr{2\beta-\frac 3 2 \kappa}}.\label{eq:fr 2}
\end{align}
We consider the following two cases.
\paragraph{Case (i) where $\beta\ge 1$.} If $\beta \ge 1$, we just plug in $\kappa=\min\{\beta, 1\}=1$. it holds on $\cE$ that
\begin{align}
    \nbr{\theta_k^+}_{\mu_k, 2}^2 &\overset{\cE}{\lesssim}
    \rbr{\frac{\sqrt{\rbr{\eta_k L_\alpha }^2+\rbr{4\beta-3}\Delta_{k, \cD}}+\eta_k L_\alpha }{\rbr{2\beta-\frac 3 2}}}^2\nend
    &\le 4\rbr{\sqrt{\rbr{\eta_k L_\alpha}^2+\Delta_{k, \cD}}+\eta_k L_\alpha}^2\nend
    &\le 8\rbr{2\rbr{\eta_k L_\alpha}^2+\Delta_{k, \cD}},\label{eq:7 fr}
\end{align}
where the first inequality holds by \eqref{eq:fr 2}, the second inequality holds by noting that $\beta=1$ will maximize the right-hand side.
Rearranging \eqref{eq:quadratic inequation} with $\kappa =1 $, we have on event $\cE$ that
\begin{align}
    \EE_{\mu_k}\sbr{\alpha_k(\vh, \vY_k) \theta_k^+(\vZ_k)} &= \beta \nbr{\theta_k^+}_{\mu_k, 2}^2\nend
    &\overset{\cE}{\lesssim} \frac 3 4 \nbr{\theta_k^+}_{\mu_k, 2}^2 + \eta_k L_\alpha \nbr{\theta_k^+}_{\mu_k, 2} + \Delta_{k, \cD}\nend
    &\le 16\rbr{\eta_k L_\alpha}^2+ 9\Delta_{k, \cD}, \label{eq:8 fr}
\end{align}
where the last inequality holds by the upper bound of $\nbr{\theta_k^+}_{\mu_k, 2}$ in \eqref{eq:7 fr}.
\paragraph{Case (ii) where $\beta<1$. } If $\beta < 1$, we just plug in $\kappa=\beta$. It holds on $\cE$ that
\begin{align*}
    \beta \nbr{\theta_k^+}_{\mu_k, 2} \overset{\cE}{\lesssim} 2\rbr{\sqrt{\rbr{\eta_k L_\alpha \kappa}^2+\Delta_{k, \cD}}+\eta_k L_\alpha}\le 2\rbr{2\eta_k L_\alpha + \sqrt{\Delta_{k, \cD}}},
\end{align*}
which suggests that 
\begin{align}
    \EE_{\mu_k}\sbr{\alpha_k(\vh, \vY_k) \theta_k^+(\vZ_k)} =  \beta \nbr{\theta_k^+}_{\mu_k, 2}^2 \overset{\cE}{\lesssim} 2\rbr{\sqrt{\Delta_{k, \cD}}+2\eta_k L_\alpha} \nbr{\theta_k^+}_{\mu_k, 2}.\label{eq:9 fr}
\end{align}
\paragraph{Combination of Case (i) and Case (ii).}
Combining \eqref{eq:8 fr} and \eqref{eq:9 fr} in these two cases, we then have on event $\cE$ for any $\vh\in\CI_{\vH, \cD}(e_\cD)$ and $\theta_k^+\in \Theta_k^+(\vh)$ that
\begin{align*}
    \EE_{\mu_k}\sbr{\alpha_k(\vh, \vY_k) \theta_k^+(\vZ_k)} &\overset{\cE}{\lesssim} \max\cbr{2\rbr{\sqrt{\Delta_{k, \cD}}+2\eta_k L_\alpha} \nbr{\theta_k}_{\mu_k, 2}, 16\rbr{\eta_k L_\alpha}^2+ 9\Delta_{k, \cD}}\nend
    &=\max\cbr{C_\cD \nbr{\theta_k}_{\mu_k, 2}, C_\cD^2},
\end{align*}
where $C_\cD = 4 \eta_k L_\alpha+ 3\sqrt{\Delta_{k, \cD}}$.
Considering the fact that $\EE_{\mu_k}\sbr{\alpha_k(\vh, \vY_k) \theta_k(\vZ_k)}<0$ for $\theta_k\in\Theta_k\backslash \Theta_k^+(\vh)$, it follows for any $\vh\in\CIH(e_\cD)$, $\theta_k\in\Theta_k$ and $k\in\{1, \cdots, K\}$ that
\begin{align}
    \EE_{\mu_k}\sbr{\alpha_k(\vh, \vY_k) \theta_k(\vZ_k)} \overset{\cE}{\lesssim} \max\cbr{C_\cD \nbr{\theta_k}_{\mu_k, 2}, C_\cD^2}.\label{eq:fr 1}
\end{align}
Recall the definition of the linear operator $\cT_k$ in \eqref{def:cT}. We let $\thetaTstark{k}(\vZ_k;\vh)=\arg\min_{\theta_k\in\Theta_k} \nbr{\theta_k-\cT_k\vh}_{\mu_k, 2}$. By \eqref{eq:fr 1}, it then holds for $h\in\CI_{\vH, \cD}(e_\cD)$ that
\begin{align}
    \EE_{\mu_k}\sbr{\cT_k\vh(\vZ_k) \thetaTstark{k}(\vZ_k;\vh)} &\overset{\cE}{\lesssim}
    \max\cbr{C_\cD \nbr{\thetaTstark{k}(\vh)}_{\mu_k, 2}, C_\cD^2}.\label{eq:fr 5}
\end{align}
For the left-hand side of \eqref{eq:fr 5}, we have
\begin{align}
    \EE_{\mu_k}\sbr{\cT_k\vh(\vZ_k)\thetaTstark{k}(\vZ_k;\vh)}
    &=\EE_{\mu_k}\sbr{\cT_k\vh(\vZ_k)\rbr{\thetaTstark{k}(\vZ_k;\vh)-\cT_k\vh(\vZ_k)+\cT_k\vh(\vZ_k)}}\nend
    &\ge \nbr{\cT_k\vh}_{\mu_k, 2}^2 - \nbr{\cT_k\vh}_{\mu_k, 2}\nbr{\thetaTstark{k}(\vh)-\cT_k\vh}_{\mu_k, 2}\nend
    &\ge \nbr{\cT_k\vh}_{\mu_k, 2}^2 - \nbr{\cT_k\vh}_{\mu_k, 2}\vareTheta, \label{eq:fr 6}
\end{align}
where the first inequality holds by the  Cauchy-Schwartz inequality and the last equality holds by Assumption \ref{asp:compatibility} on the compatibility of the dual function class $\Theta_k$.
For the right-hand side of \eqref{eq:fr 5}, we have,
\begin{align}
    \max\cbr{C_\cD \nbr{\thetaTstark{k}(\vh)}_{\mu_k, 2}, C_\cD^2} 
    &\le C_\cD \rbr{C_\cD + \nbr{\thetaTstark{k}(h)-\cT_k\vh+\cT_k\vh}_{\mu_k, 2}}\nend
    &\le C_\cD\rbr{C_\cD+\nbr{\cT_k\vh}_{\mu_k, 2}+\vareTheta},  \label{eq:fr 7}
\end{align}
where the last inequality holds by the triangular inequality and Assumption \ref{asp:compatibility}.
Combining \eqref{eq:fr 6} and \eqref{eq:fr 7} with \eqref{eq:fr 5}, for all $\vh\in\CI_{\vH, \cD}(e_\cD)$ and $k\in\{1, \cdots, K\}$, it holds on event $\cE$ that
\begin{align*}
    \nbr{\cT_k\vh}_{\mu_k, 2}^2 - (\vareTheta+C_\cD) \nbr{\cT_k\vh}_{\mu_k, 2}-C_\cD(C_\cD+\vareTheta) \overset{\cE}{\lesssim} 0, 
\end{align*}
which gives that
\begin{align*}
    \nbr{\cT_k\vh}_{\mu_k, 2} &\overset{\cE}{\lesssim} \frac 1 2 \rbr{\sqrt{(\vareTheta+C_\cD)^2+4C_\cD(C_\cD+\vareTheta)}+(\vareTheta+C_\cD)}\nend
    &\le \vareTheta+2C_\cD\nend
    &= \vareTheta+ 8\eta_k L_\alpha + 6\sqrt{\frac 5 4\eta_k^2+2\vareH^2 + \rbr{2 L_\alpha^2+\frac 5 4}\eta^2 + e_\cD}\nend
    & = O(\vareTheta) + O(\vareH) + O\rbr{\sqrt{e_\cD}} + O\rbr{\eta} , 
\end{align*}
where the first equality holds by definition of $C_\cD$ and the definition of $\Delta_{k, \cD}$ in \eqref{def:Delta}. The last inequality holds by noting that $\eta_k\le \eta$.
Hence, we complete the proof of Theorem \ref{thm:Fast rate}.
\documentclass[twoside,11pt]{article}

% Any additional packages needed should be included after ewrl_2022.
% Note that ewrl_2022.sty includes epsfig, amssymb, natbib and graphicx,
% and defines many common macros, such as 'proof' and 'example'.
%
% It also sets the bibliographystyle to plainnat; for more information on
% natbib citation styles, see the natbib documentation, a copy of which
% is archived at http://www.jmlr.org/format/natbib.pdf


% To compile for anonymous submission
\usepackage[accepted]{ewrl_2022}

% Our imports
\usepackage{amsfonts, amsmath, amssymb}
\usepackage{xfrac}
\usepackage{graphicx, xcolor, colortbl}
\usepackage{footnote}
% \usepackage{tablefootnote}
\usepackage{natbib}
\usepackage{dsfont}
\usepackage{bbm}
\usepackage{algorithm}
%\usepackage{algorithmic}
\usepackage{algpseudocode}
\usepackage{import}
\usepackage{mathtools}
\usepackage{bm}
\usepackage{xspace}
\usepackage{thmtools,thm-restate} %to restate lemma
\usepackage{accents}
\usepackage{framed}
\usepackage[inline]{enumitem}
\usepackage{booktabs}
\usepackage{color, colortbl}
\usepackage{natbib}
\usepackage{subcaption}

\definecolor{LightGray}{gray}{0.9}


% For  footnote reuse (https://tex.stackexchange.com/questions/35043/reference-different-places-to-the-same-footnote)
% \usepackage{scrextend}

% for multirow in table
\usepackage{multirow}

%\newtheorem{lemma}{Lemma}
% \newtheorem{theorem}{Theorem}
% \newtheorem{corollary}{Corollary}
%
% \theoremstyle{definition}
% \newtheorem{property}{Property}
% \newtheorem{proposition}{Proposition}
% \newtheorem{definition}{Definition}
% \newtheorem{assumption}{Assumption}
%\newtheorem{remark}{Remark}
% \newtheorem{example}{Example}

\usepackage{sty/notations}


% working together
\usepackage{todonotes}
\newcommand{\todoMariana}[1]{\todo[color=violet!40, inline]{\small Mariana: #1}}
\newcommand{\todoPi}[1]{\todo[color=yellow!40, inline]{\small #1}}


% for table of contents (Appendix only)
\usepackage{minitoc}
\renewcommand \thepart{}
\renewcommand \partname{}


% Definitions of handy macros can go here

\newcommand{\dataset}{{\cal D}}
\newcommand{\fracpartial}[2]{\frac{\partial #1}{\partial  #2}}

\ewrlheading{}{}{}{Vargas Vieyra and M\'enard}


\ShortHeadings{Generative Models with Reinforcement Learning}{M. Vargas Vieyra and P. M\'enard}
\firstpageno{1}

\begin{document}

\title{Learning Generative Models with Goal-conditioned Reinforcement Learning}

\author{\name Mariana Vargas Vieyra \email mariana.vargas-vieyra@inria.fr \\
       \addr Inria, France
       \AND
       \name Pierre M\'enard \email pierre.menard@ens-lyon.fr \\
       \addr ENS Lyon, France}


\maketitle

\begin{abstract}%   <- trailing '%' for backward compatibility of .sty file
  We present a novel, alternative framework for learning generative models with goal-conditioned reinforcement learning. We define two agents, a \textit{goal conditioned agent} (GC-agent) and a \textit{supervised agent} (S-agent). Given a user-input initial state, the GC-agent learns to reconstruct the training set. In this context, elements in the training set are the \textit{goals}. During training, the S-agent learns to imitate the GC-agent while remaining agnostic of the goals. At inference we generate new samples with the S-agent. Following a similar route as in variational auto-encoders, we derive an upper bound on the negative log-likelihood that consists of a reconstruction term and a divergence between the GC-agent policy and the (goal-agnostic) S-agent policy. We empirically demonstrate that our method is able to generate diverse and high quality samples in the task of image synthesis.
\end{abstract}

\begin{keywords}
  Generative Models, Goal-conditioned Reinforcement Learning.
\end{keywords}


\input{main/introduction}
\input{main/inference_as_rl}
\input{main/algorithm}
\input{main/experiments}
\input{main/conclusion}



% Acknowledgements should go at the end, before appendices and references

\acks{This work was granted access to the HPC/AI resources of IDRIS under the allocation 2022-AD011011232R2  made by GENCI. We gratefully acknowledge the support of the Centre Blaise Pascal's IT test platform at ENS de Lyon (Lyon, France) The platform operates the SIDUS solution \citep{quemener2013sidus} developed by Emmanuel Quemener. Pierre M\'enard acknowledges the support of the Chaire SeqALO (ANR-20-CHIA-0020-01).}

\vskip 0.2in
\bibliography{generative_by_rl-bib}

% Manual newpage inserted to improve layout of sample file - not
% needed in general before appendices/bibliography.

\newpage
\appendix
\input{appendix/detailed_derivation}
\newpage
\input{appendix/experiments_detail}

\end{document}

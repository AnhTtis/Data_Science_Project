\caption{}
\label{alg:hit}

\begin{algorithmic}[1]

\Function{$\mathtt{IsoType}$}{$\mathbf{A}$, $\bar{a}$}

	\Comment{$\mathbf{A}$ is an algebra and $\bar{a}$ is a tuple from
$A$}

	\State{$\mathtt{V}=[a_{0},\dots,a_{n-1}]$}

	\State{$\mathtt{V'}=[``x_{0}",\dots,``x_{n-1}"]$} \Comment{this
is a list of variables (terms are represented as strings)}\label{initV'}

	\State{$\mathtt{P}=[B_{1},\dots,B_{k}]$ the partition of $\{0,\dots,n-1\}$
where $i,j$ are in the same block iff $a_{i}=a_{j}$}

	\State{$\mathtt{H}=\mathtt{sorted}([\min(B_{j}):B_{j}\in\mathtt{P}])$} \Comment{sorted
increasingly}

	\State{$\mathtt{N=H}$}

	\State{$\mathtt{arities=}[r_{1},...,r_{k}]$} \Comment{ where
$r_{1}<...<r_{k}$ are all the arities of operations in $\mathbf{A}$}

	\While{$\mathtt{N}\neq\emptyset$}

		\State{$\mathtt{H\_old=copy(H)}$}

		\For{$r\in\mathtt{arities}$}\label{fixr}

			\State{$\mathtt{T=sorted}([\bar{l}\in(\mathtt{H\_old})^{r}:l_{j}\in\mathtt{N}\text{ for some }j])$} \Comment{sorted
lexicographically}

			\For{$f\in\mathtt{op}(r)$} \Comment{$\mathtt{op}(r)$ the
list of ops symbols of arity $r$ in the order given by $\tau$}\label{fixf}

				\For{$\bar{l}\in\mathtt{T}$}\label{fixtup}

					\State{$\mathtt{value}=f^{\boldsymbol{A}}(\mathtt{V}[l_{0}],...,\mathtt{V}[l_{r-1}])$}\label{beginvv'}

					\State{append \texttt{value} to \texttt{V}}

					\State{$\mathtt{term}=f\dobleplus``("\dobleplus\mathtt{V'}[l_{0}]\dobleplus``,"\dobleplus...\dobleplus``,"\dobleplus\mathtt{V'}[l_{r-1}]\dobleplus``)"$}\label{compute term}

					\State{append \texttt{term} to \texttt{V$'$}}\label{endvv'}

					\Comment{update of the partition \texttt{P}}

					\If{there is $j\in\mathtt{H}$ such that $\mathtt{value}=\mathtt{V}[j]$} \Comment{\texttt{value}
was already in \texttt{V}}

						\State{add $|\mathtt{V}|-1$ to the block of \texttt{P} that
contains $j$}

					\Else \Comment{\texttt{value} is new}

						\State{add the block $\{|\mathtt{V}|-1\}$ to \texttt{P}}

						\State{add $|\mathtt{V}|-1$ to \texttt{H}}

					\EndIf

				\EndFor

			\EndFor

		\EndFor

		

		\State{$\mathtt{N}=[l:l\in\mathtt{H}\text{ and }l\notin\mathtt{H\_old}]$}\Comment{update of \texttt{N}}

	\EndWhile

	\State{$\mathtt{U}=[\mathtt{V}[j]:j\in\mathtt{H}]$} \Comment{\texttt{U}
lists the elements of $\sg(\bar{a})$ in the order they appeared in
\texttt{V}}

	\State{\Return \texttt{P}, \texttt{U}}

\EndFunction

\end{algorithmic}
\caption{}


\label{alg:posta}
\begin{algorithmic}[1]
\Function{\texttt{$\mathtt{SplittingAlgorithm}$}}{$\mathbf{A}$, \texttt{target}}

    \State{$\mathtt{formula}$ = $\bot$} \Comment{Initialization of candidate formula}
    \State{$\mathtt{full\_blocks}$ = []}
    \State{$k = \ar(\texttt{target})$}
    \State{\texttt{tuples} = \{\texttt{t} for \texttt{t} in $A^{(k)}$\}} \Comment{Tuples without repeated elements}
    \State{\texttt{terms\_to\_process} = [$x_i$ for i in $\{0,\dots,\ar(\mathtt{target})-1\}$]}
    \State{\texttt{witnesses} = []}
    \State{\texttt{new\_witnesses} = []}
    \State{\texttt{local\_formula} = $\top$}
    \State{\texttt{step} = 0} % se usa solo para la prueba
    
    \Comment{Now we create the structure with fields for the Block}
    \State{$B_0$ = Block$(\texttt{tuples}, \texttt{witnesses}, \texttt{new\_witnesses}, \texttt{terms\_to\_process},$}\label{line:creo_block}
    \Statex{\hspace{2.35cm}\texttt{local\_formula}, \texttt{step})}
    \State{\texttt{blocks\_to\_process} = [$B_0$]} \Comment{First block in the stack}
    \While{\texttt{blocks\_to\_process} $\neq$ []}
        \State{$B$ = pop(\texttt{blocks\_to\_process})}
        \If{$B$.$\mathtt{tuples}$ $\subseteq$ \texttt{target}} \label{line:iffull} \Comment{$B$ is a full block}
            \State{$\mathtt{formula}$ = $\mathtt{formula}$ $\lor$ $B$.$\mathtt{formula}$}
            \State{$\mathtt{full\_blocks}$.append($B$)}
            \State{\textbf{continue}} \label{line:fifull}
        \ElsIf{\texttt{$B$}.$\mathtt{tuples}$ $\cap$ \texttt{target} = $\emptyset$} \Comment{$B$ is a disposable block} \label{line:ifdisposable}
            \State{\textbf{continue}}  \label{line:fidisposable}
        \Else \Comment{$B$ is a mixed block}
            \If{$B$.\texttt{terms\_to\_process} == [] and $B$.\texttt{new\_witnesses} == []}
                \State{\Return{(\textbf{False}, $B$)}} \Comment{$B$ is a mixed terminal block, so $B$ is counterexample} \label{line:contraejemplo}
            \EndIf
            \State{\texttt{blocks\_to\_process} = process\_mixed\_block($B$) + \texttt{blocks\_to\_process}}
        \EndIf
    \EndWhile
    \State{\Return{(\textbf{True},$\mathtt{formula}$)}}\label{line:formula_patron}


\EndFunction

\end{algorithmic}
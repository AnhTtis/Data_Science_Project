\newcommand{\thetainterval}{I_\theta}
\newcommand{\levelset}{c}
\newcommand{\interior}[1]{\text{int}\left({#1}\right)}
\newcommand{\state}{X}
\newcommand{\quadrant}{\overline Q}
This section develops a rigorous proof of the claim that conditions~\eqref{eq:stbsfcondzero}-\eqref{eq:stbsfcondpdd} together with appropriately chosen values of controller parameters ensures that the robot converges to the path. 
For practical selection of the controller parameters, only Remark~\ref{rem:smallbeta} is relevant, with $\alpha\geq 0$. 
\subsection{State-Space Model}
We define the state $\vx(t)$ local path coordinates:
\begin{equation}
    \vx(t) = \bmat{\theta(t) \\ d(t)}.
\end{equation}
Figure~\ref{fig:ddwmr} depicts these quantities. %

We are not concerned with the evolution of $s$, as long as $v >0$ and $| \theta(t)| < \pi/2$. %
A similar choice was made in~\cite{wit1993nonlinear}. 
We also assume there is some maximum allowable deviation from the path $\ppath$ characterized by $d^*$. 
Thus, we consider a compact subset $\state \subset \R^2$ of the state-space  given by 
\begin{equation}
    \state = \{ \vx \in \R^2 \colon | \theta | < \pi/2, | d | < d^*\}
\end{equation}

As mentioned earlier, we analyze the case where the curvature of the path is zero. 
Thus, we focus on the system 
\begin{align}
\label{eq:tdot} \dot\theta(t) &= \omega(t), \text{ and}\\
\label{eq:ddot} \dot d(t) &= v(t)\sin\theta(t).
\end{align}
We denote a solution of~\eqref{eq:tdot}-\eqref{eq:ddot} due to an initial condition $\vxz \in \state$ as $\vx(t;\vxz)$. 

\begin{remark}
\label{rem:nonzerocurvature}
The influence of non-zero curvature is in the form of a disturbance term in the right hand side of~\eqref{eq:tdot}. %
%This term is bounded for under approproate bounds on curvature and $d(t)$. 
This term is bounded when both the curvature $\rho(s)$ and $d(t)$ are bounded.
The system~\eqref{eq:tdot}-\eqref{eq:ddot} is easily shown to be locally exponentially stable using linearization, implying robustness to bounded disturbances. 
\end{remark}


We now demonstrate that when the state-based score function $\stbsf$ satisfies conditions~\eqref{eq:stbsfcondzero}-\eqref{eq:stbsfcondpdd}, we can find values for parameters $\alpha$, $\beta$ and $\gamma$ such that the origin of the closed-loop system 
\begin{align}
     \dot\theta &= \gamma \stbsf,\label{eq:thetacloop}\\
     \dot d &= \vctrl \sin\theta,\label{eq:dcloop}
\end{align}
is asymptotically stable. 
This closed loop is a result of applying control laws~\eqref{eq:omega-ctrl-law} and~\eqref{eq:v-ctrl-law} to~\eqref{eq:tdot}-\eqref{eq:ddot}, together with converting the SeBSF $\sebsf$ into a StBSF $\stbsf$. 

The proof of asymptotic stability is based on the intuition that the curve $\stbsf(\vx) = 0$ defines a sliding surface. 
If we use a bang-bang control for $\omega$ based on the sign of $\stbsf(\vx)$ and a small enough forward velocity, then the resulting trajectories  would approach this surface rapidly in finite time and then slide along it to the origin. 
Since we use a smooth controller, we instead show convergence to one of a pair of positively invariant cones, and then show that solutions approach the origin once inside these cones. 

Consider the set $F_0$ given by
$$\stbsf_0 = \{ \vx \in \state \colon \stbsf(\vx) = 0\}.$$
We can express the implicit curve $\stbsf_0$ using an explicit function $h \colon \R \to \R$ so that $d = h(\theta)$ for $\vx \in \stbsf_0$. %
\begin{lemma}
\label{lem:explicitrepofF}
Let the StBSF $\stbsf(\vx)$ satisfy conditions~\eqref{eq:stbsfcondzero}-\eqref{eq:stbsfcondpdd}. %
Then, there exists a continuous function $h \colon \R \to \R$ and an interval such that $h(0)=0$ and $\forall \theta$ the following hold:
\begin{enumerate}
    \item $\vx \in F_0 \iff \stbsf(\theta,h(\theta))=0$
    \item $-\infty < h'(\theta) < 0$
    \item $\theta \neq 0 \implies \theta h(\theta) < 0$
\end{enumerate}
\end{lemma}
\begin{proof}
    Since $\pd{F}{d} < 0$ for all $\vx \in \state$, the implicit function theorem guarantees existence of a unique function $h(\theta)$ such that $\stbsf(\theta,h(\theta))=0$. %
    Since $F(0,0) = 0$, we must have $h(0)=0$. 
    The partial derivative of this function is $$h'(\theta) = -\frac{\pd{F}{\theta}}{\pd{F}{d}}.$$ 
    The function $h'(\theta)$ is strictly negative due to~\eqref{eq:stbsfcondpdtheta} and~\eqref{eq:stbsfcondpdd}, and bounded under the assumption that $\stbsf$ is continuously differentiable. 
    Since $h(0) = 0$ and $h'(\theta) < 0$, it is easy to see that $\theta >0 \implies h(\theta)<0$, and  $\theta <0 \implies h(\theta)>0$ . Therefore, $\theta \neq 0 \implies \theta h(\theta) < 0$. 
\end{proof}

Let $\quadrant_i$ be the $\i^{\mathrm{th}}$ quadrant, meaning 
\begin{align}
\Qone &= \{\vx \in \state \colon \theta \geq 0,\, d \geq 0\}\\
\Qtwo &= \{\vx \in \state \colon \theta \leq 0,\, d \geq 0\}\\
\Qthr &= \{\vx \in \state \colon \theta \leq 0,\, d \leq 0\}\\
\Qfor &= \{\vx \in \state \colon \theta \geq 0,\, d \leq 0\}
\end{align}
Given $h$, we can define two lines in the plane, parametrized by their slopes. 
\begin{lemma}
\label{lem:L-bound}
    Consider a curve $h(\theta)$ which is the explicit form of a function $\stbsf$ satisfying conditions~\eqref{eq:stbsfcondzero}-\eqref{eq:stbsfcondpdd}. There exist quantities $L_1$ and $L_2$ where  $0 < L_1, L_2  <\infty$ such that 
    \begin{enumerate}
        \item $-L_1 \theta < h(\theta) <-L_2 \theta$, \text{ and}
        \item $-L_1  < h'(0) < -L_2$.
    \end{enumerate}
    % \begin{align}
    %     &\forall d\in F_0\cap\Qtwo, d \ge -L\theta, \text{ and},\\
    %     &\forall d\in F_0\cap\Qfor, d \le -L\theta.
    % \end{align}
\end{lemma}
\begin{proof}
    Since $h(\theta)$ is derived from a state-based score function, by Lemma~\ref{lem:explicitrepofF}, we have $-\infty < -M \leq h'(\theta) \leq -\epsilon < 0$. By simple integration, for any $\theta \in \R$ 
    \begin{align}
        \int_{0}^{\theta} -M d\tau  \leq  \int_{0}^{\theta} h'(\tau) d\tau  \leq \int_{0}^{\theta} -\epsilon d\tau  \\
        \implies  - M \theta \leq  h(\theta)  \leq - \epsilon \theta 
    \end{align}
    Let $0< \varepsilon < \epsilon$. choosing $L_1 = M+\varepsilon$ and $L_2 = \epsilon - \varepsilon$ completes the proof.      
\end{proof}
\begin{figure}[tb]
    \centering
    \input{figures/proof_fig}
    \caption{\small Curves and lines in proof of Lemma~\ref{lem:posinvboundedcones}}
    \label{fig:my_label}
\end{figure}

Lemma~\ref{lem:L-bound} implies that $F_0 \subset \Qtwo \cup \Qfor$. 
The quantities $L_1$ and $L_2$ define two cones $K_1, K_2 \subset \state$ as follows:
\begin{align}
    \label{eq:cone1} K_1 &= \{ \vx \in \state \colon \theta \leq 0,\ -L_1 \theta \leq h(\theta) \leq -L_2 \theta\}, \text{ and}\\
    \label{eq:cone2} K_2 &= \{ \vx \in \state \colon \theta \geq 0,\ -L_1 \theta \leq h(\theta) \leq -L_2 \theta\}.
\end{align}
By construction, $K_1 \subset \Qtwo$ and $K_2 \subset \Qfor$. 

% Following our intuition from sliding mode control, we show that trajectories reach $K_1 \cup K_2$ in finite time and that $K_1 \cup K_2$. 
We now show that solutions of~\eqref{eq:thetacloop}-\eqref{eq:dcloop} will enter $K_1 \cup K_2$ in finite time unless they asymptotically approach the origin $\vec 0 \in K_1 \cup K_2$.
\begin{lemma}
\label{lem:coneinfinitetime}
    Consider the set $M = \{ \vx \in \state \colon  \vx \notin K_1 \cup K_2\} $. %
    For each $\vxz \in M$, either $\vx(t;\vxz) \in M\ \forall t\geq 0 \implies \lim_{t \to \infty} \vx(t;\vxz) = 0$ or there exists  $T<\infty$ such that $\vx(T;\vxz) \in K_1 \cup K_2$. %Moreover, $\vx(t;\vxz) \in K_1 \cup K_2 \ \forall t \geq T$.  
\end{lemma}
% This is simply a consequence of the fact that $F \neq 0$ whenever $\vx \notin K_1 \cup K_2$. 
\begin{proof}
    Consider the solution $$\vx(t;\vxz) = (\theta(t;\vxz),d(t;\vxz)),$$ where $\vxz = (\theta_0,d_0) \in M$.
    Let $[0,T(\vxz))$ be the interval over which $\vx(t;\vxz) \in M$ when $\vxz \in M$. 
    
    If $T(\vxz) = \infty$ and $F(\vxz) <0$, then $\dot \theta (t) < 0 \forall t \geq 0$ and $$l = \lim_{t\to \infty} \dot \theta (t) \leq 0.$$ If limit $l=0$, then $\lim_{t\to \infty} F(\vx(t;\vxz)) = 0$, so that the solution asymptotically reaches the line $F_0$. This situation can only occur if $\vx(t;\vxz)$ asymptotically approaches $\vx = 0 \in F_0$. If $\vx(t;\vxz)$ approached any other point in $F_0$, it must have entered $K_1 \cup K_2$ in finite time. Thus, either the limit $l$ is strictly negative, or $T(\vxz) < \infty$. 
    
    If limit $l < 0$, then $\theta(t;\vxz)$ will decrease to $0$ in finite time, say $T'$. 
    If $d(T';\vxz)<0$, then $\vx(t;\vxz)$ must have entered $K_2$ in finite time. 
    If $d(T';\vxz)=0$, then then $\vx(t;\vxz)$ reached the origin in finite time. 
    If $d(T';\vxz)>0$ then $\vx(t;\vxz)$ reaches $\Qtwo$ in finite time. 
    When $\vx(t;\vxz) \in \Qtwo$, then $\theta(t;\vxz) \leq 0$ implying that $\dot d(t) \leq 0$. 
    In turn, $d(t;\vxz)$ decreases, so that $\theta^*(t) = h^{-1}(d(t;\vxz))$ increases. 
    Now, $\theta(t;\vxz)$ will decrease below $\theta^*(t)$ in finite time.
    When $\theta(t;\vxz) = \theta^*$, then $F(\vx(t;\vxz)) = 0$, so that $\vx(t;\vxz)$ must have entered $K_1$ in finite time. 

    An identical argument holds for when $F(\vxz)  > 0$, and is therefore omitted.
\end{proof}
Next, we show that $K_1 \cup K_2$ is positively invariant, and $|d(t)|$ cannot increase when $\vx \in K_1 \cup K_2$. 
\newcommand{\invset}{N}
\begin{lemma}
\label{lem:posinvboundedcones}
    Let \begin{displaymath} \invset_{d^*} = \{ \vx \in \state \colon | d | \leq d^*\}.\end{displaymath}
    Then there exist $\alpha\ge 0$, $\beta > 0$, and $\gamma > 0$ such that the set $\invset_{d^*} \cap (K_1 \cup K_2)$ is positively invariant for all $d^* >0$. 
\end{lemma}
\begin{proof}
Let $\invset_1 = \invset_{d^*} \cap K_1$ and $\invset_2 = \invset_{d^*} \cap K_2$, so that $\invset_1 \cup \invset_2 = \invset_{d^*} \cap (K_1 \cup K_2)$. %
We show that $\invset_1$ is positively invariant, a similar argument holds for $\invset_2$. %
The proof involves showing that the vector field on the boundary is either tangential to or points into the set. 
The set $\invset_1$ is bounded by three lines: $d = d^*$, $d = -L_1 \theta$, and $d = -L_2 \theta$. \newline%
\underline{Line  $d = d^*$:}  By design, $\invset_1 \subset \Qtwo$. 
Therefore, $\forall \vx \in \invset_1$, $\theta \leq 0$. 
By~\eqref{eq:dcloop}, $\dot d = \beta e^{-\alpha F^2} \sin \theta$, so that $\dot d \leq 0$. 
Thus, trajectories cannot leave $\invset_1$ through this line.  \newline 
\underline{Line  $d = -L_2 \theta$:}  We can represent this line by the covector $p_2 = \bmat{L_2 & 1}$, and require that $L_2 \dot \theta + \dot d \leq 0$. We derive
\begin{align}
    &L_2 \dot \theta + \dot d \leq 0\\
    \iff& L_2 \gamma F + \beta e^{-\alpha F^2} \sin \theta  \leq 0\\
    \iff& L_2 \gamma F   \leq \beta e^{-\alpha F^2} (-\sin \theta) \label{eq:L2Nagumo}
\end{align}
For points on the line $d = -L_2 \theta$, $F(\vx)$ is negative, since by Lemma~\ref{lem:L-bound}, $h(\theta) \leq -L_2 \theta$ and $\partial F / \partial d < 0$. Thus, the left hand side of~\eqref{eq:L2Nagumo} is negative. Since $\theta \leq 0$ for all $\vx \in \invset_1$, the right hand side of~\eqref{eq:L2Nagumo} is always non-negative. Therefore, this inequality always holds, and trajectories cannot leave $\invset_1$ through this line. \newline
\underline{Line  $d = -L_1 \theta$:}  Similarly, we can represent this line by the covector $p_1 = \bmat{L_1 & 1}$. 
We require that $L_1 \dot \theta + \dot d \geq 0$ for $\vx$ such that $d = - L_1 \theta$. 
Let $$\stbsf_{L_1}(\theta) = \stbsf(\theta,- L_1 \theta ).$$
We derive
\begin{align}
    &L_1 \dot \theta + \dot d \geq 0 \label{eq:L1Nagumoraw}\\
    \iff& L_1 \gamma \stbsf_{L_1}(\theta) + \beta e^{-\alpha \stbsf_{L_1}(\theta)^2} \sin \theta  \geq 0\\
    \iff& L_1 \gamma \stbsf_{L_1}(\theta)  \geq \beta e^{-\alpha \stbsf_{L_1}(\theta)^2} (-\sin \theta) \label{eq:L1Nagumo}
\end{align}
For $\theta \neq 0$, since $\sin \theta < 0$, we can rewrite~\eqref{eq:L1Nagumo} in the equivalent form
\begin{align}
    \frac{\beta}{\gamma} \leq \frac{L_1  \stbsf_{L_1}(\theta) e^{\alpha \stbsf_{L_1}(\theta)^2}}{-\sin \theta} \label{eq:paramboundL1inv}
\end{align}
For $\theta < 0$, the right hand side of~\eqref{eq:paramboundL1inv} is strictly positive. However, to ensure that~\eqref{eq:L1Nagumo} holds for some $\beta,\gamma >0$, we must confirm that the limit of the right hand side of~\eqref{eq:paramboundL1inv} as $\theta$ approaches zero is strictly positive. 
Taking limits,
\begin{align}
    \Delta = &\lim_{\theta \to 0}  \frac{L_1  \stbsf_{L_1}(\theta) e^{\alpha \stbsf_{L_1}(\theta)^2}}{-\sin \theta} = \frac{0}{0}
\end{align}
Since $\cos 0 \neq 0$, we may use L'Hospital's rule. 
\begin{align}
    \Delta=&\lim_{\theta \to 0}  \frac{L_1  \pd{\stbsf_{L_1}}{\theta} e^{\alpha \stbsf_{L_1}^2} + L_1  \stbsf_{L_1} 2 \alpha \stbsf_{L_1} \pd{\stbsf_{L_1}}{\theta} e^{\alpha \stbsf_{L_1}^2}}{- \cos \theta}\\
    &= \frac{L_1  \pd{\stbsf_{L_1}}{\theta}(0) + 0}{-1} = L_1 \bigpar{-\pd{\stbsf_{L_1}}{\theta}(0) } \label{eq:Delta}
\end{align}
Now, 
\begin{align}
    \pd{\stbsf_{L_1}}{\theta}(0) = \pd{\stbsf}{\theta}(0) + \pd{\stbsf}{d}(0) \cdot (-L_1) \label{eq:FL1prime}
\end{align}
By Lemma~\ref{lem:L-bound}
\begin{align}
    -L_1  <  h'(0)     &\implies -L_1 < -\frac{\pd{F}{\theta}(0)}{\pd{F}{d}(0)} \\
    &\implies \pd{F}{\theta}(0) - L_1 \pd{F}{d}(0) < 0 \label{eq:FL1primeneg}
\end{align}
By~\eqref{eq:FL1prime} and~\eqref{eq:FL1primeneg}, $\Delta > 0$. Thus, if we choose 
\begin{equation}
    \beta < \gamma \Delta, \label{eq:betagammabound}
\end{equation}
then~\eqref{eq:L1Nagumoraw} holds. In turn, trajectories of~\eqref{eq:thetacloop} and~\eqref{eq:dcloop} cannot leave $\invset_1$ through the line $d = -L_1 \theta$. 
Thus, $\invset_1$ is positively invariant for $\beta >0$ and $\gamma >0$ satisfying $\beta < \gamma \Delta$. 
\end{proof}
\begin{remark}
\label{rem:smallbeta}
The quantity $\Delta$ in~\eqref{eq:Delta} may be difficult to estimate. 
Decreasing the ratio $\beta/\gamma$ to a sufficiently small positive value will ensure that~\eqref{eq:betagammabound} is met in practice.    
\end{remark}


% We now show that solutions of~\eqref{eq:thetacloop}-\eqref{eq:dcloop} will enter $K_1 \cup K_2$ in finite time unless they asymptotically approach the origin $0 \in K_1 \cup K_2$.
% \begin{lemma}
% \label{lem:coneinfinitetime}
%     Consider the set $M = \{ \vx \in \state \colon  \vx \notin K_1 \cup K_2\} $. %
%     For each $\vxz \in M$, either $\vx(t;\vxz) \in M\ \forall t\geq 0 \implies \lim_{t \to \infty} \vx(t;\vxz) = 0$ or there exists  $T<\infty$ such that $\vx(T;\vxz) \in K_1 \cup K_2$. %Moreover, $\vx(t;\vxz) \in K_1 \cup K_2 \ \forall t \geq T$.  
% \end{lemma}
% % This is simply a consequence of the fact that $F \neq 0$ whenever $\vx \notin K_1 \cup K_2$. 
% \begin{proof}
%     Consider the solution $$\vx(t;\vxz) = (\theta(t;\vxz),d(t;\vxz)),$$ where $\vxz = (\theta_0,d_0) \in M$.
%     Let $[0,T(\vxz))$ be the interval over which $\vx(t;\vxz) \in M$ when $\vxz \in M$. 
    
%     If $T(\vxz) = \infty$ and $F(\vxz) <0$, then $\dot \theta (t) < 0 \forall t \geq 0$ and $$l = \lim_{t\to \infty} \dot \theta (t) \leq 0.$$ If limit $l=0$, then $\lim_{t\to \infty} F(\vx(t;\vxz)) = 0$, so that the solution asymptotically reaches the line $F_0$. This situation can only occur if $\vx(t;\vxz)$ asymptotically approaches $\vx = 0 \in F_0$. If $\vx(t;\vxz)$ approached any other point in $F_0$, it must have entered $K_1 \cup K_2$ in finite time. Thus, either the limit $l$ is strictly negative, or $T(\vxz) < \infty$. 
    
%     If limit $l < 0$, then $\theta(t;\vxz)$ will decrease to $0$ in finite time, say $T'$. 
%     If $d(T';\vxz)<0$, then $\vx(t;\vxz)$ must have entered $K_2$ in finite time. 
%     If $d(T';\vxz)=0$, then then $\vx(t;\vxz)$ reached the origin in finite time. 
%     If $d(T';\vxz)>0$ then $\vx(t;\vxz)$ reaches $\Qtwo$ in finite time. 
%     When $\vx(t;\vxz) \in \Qtwo$, then $\theta(t;\vxz) \leq 0$ implying that $\dot d(t) \leq 0$. 
%     In turn, $d(t;\vxz)$ decreases, so that $\theta^*(t) = h^{-1}(d(t;\vxz))$ increases. 
%     Now, $\theta(t;\vxz)$ will decrease below $\theta^*(t)$ in finite time.
%     When $\theta(t;\vxz) = \theta^*$, then $F(\vx(t;\vxz)) = 0$, so that $\vx(t;\vxz)$ must have entered $K_1$ in finite time. 

%     An identical argument holds for when $F(\vxz)  > 0$, and is therefore omitted.
% \end{proof}


%\begin{proof}   
%From the definition of $K_1$ in~\eqref{eq:cone1} and $K_2$ in~\eqref{eq:cone2}, it is clear that the set of points satisfying $F(\vx) = 0$ where $\vx \neq 0$ lies in the interior of $K_1 \cup K_2$. Therefore 
%$$ \vx \notin K_1 \cup K_2 \implies F(\vx) \neq  0.$$
%From the dynamics in~\eqref{eq:thetacloop}, $\theta$ increases when $F$ is positive and decreases when it is negative.
%From definition~\ref{def:stbsf}, $\forall \vx\in \Qone\cup\Qthr$, $\dot\theta\theta < 0$ and $\dot d d > 0$.
%These conditions, alongside the partial derivatives of $\stbsf$, imply that $\forall \vx(t;\vxz)\in\interior{\Qone\cup\Qthr}$, $\min_{\vx(t)}|\stbsf| = |\stbsf(0,d_0)|$.
%\end{proof}

\newcommand{\icsetone}{\partial \mathcal N^{+}(\delta)}
\newcommand{\stbsfov}{\overline{\stbsf}}
\newcommand{\neighborhood}[1]{\mathcal N({#1})}
Next, we show that the origin is Lyapunov stable.


\begin{lemma}
    \label{lem:lyap-stab}
    Let $\beta>0$ and $\gamma>0$ satisfy condition~\eqref{eq:betagammabound}. Then, the origin of~\eqref{eq:thetacloop}-\eqref{eq:dcloop} is Lyapunov stable. 
\end{lemma}
\begin{proof}
    Consider the set $\neighborhood{\delta} \subset \state$ given by
\begin{align}
    \neighborhood{\delta} = \{\vx \in \state \colon |\theta|\leq \delta, h(\delta) \leq d \leq h(-\delta) \}.
\end{align}
This set forms a rectangle (see Figure~\ref{fig:LSprooffig}). Since $h(\theta)$ is monotonic in $\theta$, it is straightforward to show that 
\begin{equation}
    \delta_1 < \delta_2 \iff  \neighborhood{\delta_1} \subset \neighborhood{\delta_2}. \label{eq:monotonicneighborhood}
\end{equation} 
Consider a subset $\icsetone$ of the boundary of $\neighborhood{\delta}$:
\begin{align*}
    \icsetone &= \{ \vx \in  \neighborhood{\delta} \colon \theta \geq 0, d = h(-\delta) \} \cup   \\
     & \qquad \{ \vx \in  \neighborhood{\delta} \colon \theta \leq 0, d = h(\delta) \}.
\end{align*}
    The significance of $\icsetone$ is that any solution $\vx(t;\vxz)$ such that $\vxz \in \neighborhood{\delta}$ can only exit $\neighborhood{\delta}$ through $\icsetone$. To see this, note that for other points on the boundary of $\neighborhood{\delta}$:
    \begin{align*}
        d = h(-\delta), \ \theta <0\implies &\dot d <0, \\
        d = h(\delta), \ \theta >0\implies &\dot d >0, \\
        \theta = \delta \implies F \leq 0 \implies &\dot \theta \leq 0, \text{ or}\\
        \theta = -\delta \implies F \geq 0 \implies &\dot \theta \geq 0.
    \end{align*}
    By Lemma~\ref{lem:coneinfinitetime}, the solutions that leave $\neighborhood{\delta}$ must cross the $\theta = 0$ axis in finite time. 
    
    Consider the set of solutions with initial conditions in $\icsetone$. %
    There exists a maximum value for the time taken to reach the $\theta=0$ axis, otherwise Lemma~\ref{lem:coneinfinitetime} is contradicted. Let this time be $T(\delta)$. Then, because $|\dot d(t)| < \beta$, by integration
    \begin{equation}
       | d(t;\vxz) | \leq \max \bigpar{ h(-\delta) + \beta T(\delta), -h(\delta) + \beta T(\delta) }.
    \end{equation}
    Again, by Lemma~\ref{lem:coneinfinitetime}, solutions $\vx(t;\vxz)$ will reach and stay inside $K_1 \cup K_2$ and $|d(t;\vxz)|$ cannot increase. If solutions cross the line $F_0 \subset K_1 \cup K_2$, then $|\theta(t;\vxz)|$ cannot increase.  Thus, solutions stay within $\neighborhood{\epsilon}$ where $\epsilon = \epsilon(\delta)$ is given by
    \begin{equation*}
        \epsilon(\delta) = \max \bigpar{ h^{-1} \bigpar{ h(-\delta) + \beta T(\delta)}, h^{-1} \bigpar{-h(\delta) + \beta T(\delta)} }.
    \end{equation*}
    Then, all solutions with initial conditions in $\neighborhood{\delta}$ remain inside $\neighborhood{\epsilon(\delta)}$. 
    Due to $h(\theta)$ being monotonic, the dynamics being Lipshitz, and property~\eqref{eq:monotonicneighborhood}, $\epsilon(\delta)$ is invertible. 
    Let $B_\alpha$ represent an open ball of radius $\alpha$. 
    Let $\epsilon'$ be the smallest value such that $ \neighborhood{\epsilon'} \subset B_{\epsilon}$. 
    Let $\delta'$ be the largest value such that $B_{\delta'} \subset \neighborhood{\delta(\epsilon')}$.
    Then, for every $\epsilon>0$, we have found $\delta'$ such that solutions that start in $B_{\delta'}$ remain within $B_{\epsilon}$. 
    Therefore, the origin is Lyapunov stable. 
\end{proof}


\begin{figure}[tb]
    \centering
    \input{figures/proof_LS_fig}
    \caption{\small Sets involved in proof of Lemma~\ref{lem:lyap-stab}. Every $\delta >0$ defines a unique $\neighborhood{\delta}$ (light green rectangle). Solutions $\vx(t;\vxz)$ starting inside $\neighborhood{\delta}$ can only exit through $\icsetone$ (thick blue lines). These solutions must reach the $d$-axis, so that $d(t;\vxz)$ remains bounded (see Lemma~\ref{lem:coneinfinitetime}). }
    \label{fig:LSprooffig}
\end{figure}
Finally, we present the main result.

\begin{theorem}
\label{thm:mainasymptoticstability}
    Let $\stbsf$ satisfy conditions~\eqref{eq:stbsfcondzero}-\eqref{eq:stbsfcondpdd} and the gains $\alpha$, $\beta$ and $\gamma$ be chosen according to Lemma~\ref{lem:posinvboundedcones}. 
    Then, the origin $\vx = 0$ of the closed loop system~\eqref{eq:thetacloop}-\eqref{eq:dcloop} is (locally) asymptotically stable.
\end{theorem}
\begin{proof}
    %Lemmas~\ref{lem:posinvboundedcones} and~\ref{lem:coneinfinitetime} together show that the origin is Lyapunov stable, since for any initial condition we can use them to define a bounded set within which the solution remains for all time. %
    Lemma~\ref{lem:lyap-stab} shows that under parameter selection such that the ratio $\beta/\gamma$ is sufficiently small, the origin is Lyapunov stable.
    
    Consider the continuously differentiable candidate Lyapunov function $V(\vx) = d^2 / 2$. 
    On the set $K_1 \cup K_2$, $V(0) = 0$ and $V(\vx) > 0$ when $\vx \neq 0$. 
    Its derivative along solutions of~\eqref{eq:thetacloop}-\eqref{eq:dcloop} is
    \begin{align}
        \dot V(t) = d \dot d = d \beta e^{-\alpha F^2} \sin \theta
    \end{align}
    For $\vx \in K_1 \cup K_2$ where $\vx \neq 0$, both $d \neq 0$ and $\theta \neq 0$. 
    Moreover, $\sign(d) \sign(\theta) < 0$. Therefore, $\dot V < 0$. 
    Therefore, solutions $\vx(t;\vxz)$ for $\vxz \in K_1 \cup K_2$ asymptotically reach the origin.
    %This fact together with Lemma~\ref{lem:coneinfinitetime} shows that the origin is asymptotically stable. 
    Thus, if the ratio $\beta/\gamma$ is selected such that Lemmas~\ref{lem:posinvboundedcones} and~\ref{lem:lyap-stab} are satisfied, the previous fact shows that the origin is asymptotically stable.
\end{proof}
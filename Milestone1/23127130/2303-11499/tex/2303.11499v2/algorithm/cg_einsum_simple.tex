
\begin{algorithm}
\begin{small}

%\label{algo:inter-op}
\caption{Chain of Einsums for Conjugate Gradient. $k$ represents contractions of size $M$ and $j$ represents contractions of size $N$ and $N'$. Line numbers represent significant computation steps referred to throughout the text.}
\label{alg:cg_einsum}
\KwIn{$A_{m,m}$, $B_{m,n}$, $X_{m,n}$}
$R_{m,n} = B_{m,n} - A_{m,k} * X_{k,n}$ \\
$\Gamma_{n,n}=R_{k,n}*R{k,n}$\\
$P_{m, n} = R_{m, n}$ \\
\While{not converged}
{
  \nl  $S_{m,n} = A_{m,k} * P_{k,n}$     \\
 \nl   $\Delta_{n',n} = P_{k,n'} * S_{k,n}$ and $\Lambda_{n',n} = \Delta^{-1}_{n',j} * \Gamma_{j,n}$ \textcolor{gray}{~~~// $\Delta=P^TS$} \\
 \nl   $X_{m,n} = X_{m,n} + P_{m,j} * \Lambda_{j,n}$ \\
\nl    $R_{m,n} = R_{m,n} - S_{m,j} * \Lambda_{j,n}$ \\
$\Gamma\_prev_{n,n}=\Gamma_{n,n}$\\
 \nl   $\Gamma_{n',n} = R_{k,n'} * R_{k,n}$ \textcolor{gray}{~~~~~~~~// $\Gamma=R^TR$} \\
\If{$all(diag(\Gamma)\leq \epsilon)$} 
{
    \textbf{break}
}
\nl    $\Phi_{n',n} = \Gamma\_{prev}^{-1}_{n',j} * \Gamma_{j,n}$ \\
\nl    $P_{m,n} = R_{m,n} + P_{m,j} * \Phi_{j,n}$
}
\textbf{return} $X$
\end{small}
\end{algorithm}



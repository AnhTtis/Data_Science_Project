\vspace{-1mm}
\begin{algorithm}[t]
\begin{footnotesize}
%\label{algo:inter-op}
\SetInd{0em}{1em}
\caption{\begin{small}Determining the loop orders of the tensor operations to exploit reuse\end{small}}\label{alg:looporder}
swizzle\_penalty=0\\
    \For{node $\in$ NODES}
{   
 \textcolor{violet}{If the current node doesn't have a dataflow, assign one}\\
 \textcolor{violet}{If operation is not a tensor mul/add, skip to next node.}\\
%node.numcast=0	\\
\For{edge $\in$ edges(node)}
{
    \If{edge.dest.intra\_dataflow==NOT ASSIGNED}{
    %\textcolor{gray}{//Need to assign a dataflow}\\
    \If{edge.inter\_dataflow==\textcolor{blue}{pipelineable} \textbf{or} \\ edge.inter\_dataflow==\textcolor{cyan}{pipeline\_with\_hold}}
    {
        dat=edge.src.intra\_dataflow.loop\_order\\
        \If{dat[0] is contracted}
        {
            print("Loop order doesn't adhere to pipelining")\\
            \textbf{Retry} \textcolor{gray}{//Loop order is not pipelinable even if the edge is}
        }
       edge.dest.inter\_dataflow.loop\_order[0]=dat[0]\\
        \textcolor{violet}{Pick the remaining ranks}\\
        \textcolor{violet}{Try a new order if swizzle penalty is high}
    
    }
    \If{node.parallel\_multicast==true}
    {
        \textcolor{violet}{Assign same loop order to all non-transitive edges}\\
        \textcolor{violet}{First see if a node is already assigned}
        %\If{Loop order wrt multicasted tensor is different}
       % {multicast\_penalty++}
    }
     \If{edge.inter\_dataflow==\textcolor{BrickRed}{pipeline\_with\_writeback} \textbf{or} edge.inter\_dataflow==sequential}
    {
        \textcolor{violet}{Pick an order that does not swizzle}
    }
}
%\textcolor{gray}{//Look for potential inefficiencies}\\
\If{edge.inter\_dataflow==\textcolor{blue}{pipelineable} \textbf{or}\\edge.inter\_dataflow== \textcolor{cyan}{pipeline\_with\_hold}}
{
\If{edge.src.intra\_dataflow.loop\_order[0] is contracted \textbf{or} edge.dest.intra\_dataflow.loop\_order[0] is unshared
}
{
print("Loop order doesn't adhere to pipelining")\\
            \textbf{Retry} \textcolor{gray}{//Loop order is not pipelinable even if the edge is}
}
\If{edge.tensor.swizzled}
{
print("Loop order doesn't adhere to pipelining")\\
            \textbf{Retry} \textcolor{gray}{//Loop order is not pipelinable even if the edge is}
}
}

 \If{edge.inter\_dataflow==\textcolor{BrickRed}{pipeline\_with\_writeback} \textbf{or}\\edge.inter\_dataflow== sequential}
    {
        \If{edge.tensor.swizzled}
        {
            swizzle\_penalty++
        }
    }

}
}
\If{swizzle\_penalty > $\epsilon$}
{\textbf{Retry}}

\end{footnotesize}

\end{algorithm}
\vspace{-1mm}

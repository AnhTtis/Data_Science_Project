% REVIEW
%\documentclass[acmtog,anonymous,review,table,prologue,dvipsnames]{acmart} 
% ArXiv

% FOR ARXIV
\documentclass[nonacm,acmtog,table,prologue,dvipsnames]{acmart}

% FOR ACM
%\documentclass[acmtog,table,prologue,dvipsnames]{acmart}

\usepackage{booktabs} % For formal tables

% TOG prefers author-name bib system with square brackets
\citestyle{acmauthoryear}
%\setcitestyle{nosort,square} % nosort to allow for manual chronological ordering



\usepackage[ruled]{algorithm2e} % For algorithms
\renewcommand{\algorithmcfname}{ALGORITHM}
\SetAlFnt{\small}
\SetAlCapFnt{\small}
\SetAlCapNameFnt{\small}
\SetAlCapHSkip{0pt}

%Our packages and commands
\newcommand{\etal}{\textit{et al}. }
\usepackage{amsmath}
\usepackage{color}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{enumitem}
\usepackage{multirow}
\definecolor{darkorange}{rgb}{1.0, 0.55, 0.0}
%\newcommand{\steph}[1]{\textcolor{blue}{Steph: #1}}
\newcommand{\willi}[1]{\textcolor{red}{Willi: #1}}
%\newcommand{\eli}[1]{\textcolor{magenta}{E: #1}}
%\newcommand{\sergey}[1]{{\color{cyan}{Sergey: #1}}}
%\newcommand{\vlad}[1]{{\color{darkorange}{\textbf{V: #1}}}}
%\newcommand{\panos}[1]{{\color{green}{Panos: #1}}}

\newcommand{\apref}[1]{Appx.~\ref*{#1}}
\newcommand{\website}{\emph{Supp. Website}}

\newcommand{\tenniscell}[5]{\begin{tabular}{@{}c@{}}\textcolor{red}{#1}\\\textcolor{teal}{#2}\\\textcolor{blue}{#3}\\\textcolor{violet}{#4}\\#5\end{tabular}}
\newcommand{\minecraftcell}[4]{\begin{tabular}{@{}c@{}}\textcolor{red}{#1}\\\textcolor{teal}{#2}\\\textcolor{blue}{#3}\\#4\end{tabular}}

\newcommand{\cellfirst}{\cellcolor{Red!40}}
\newcommand{\cellsecond}{\cellcolor{Orange!25}}
\newcommand{\cellthird}{\cellcolor{Yellow!25}}

\usepackage{amsmath}

\hyphenation{pa-ram-e-tri-zat-ion}

% Metadata Information
\acmJournal{TOG}
%\acmVolume{38}
%\acmNumber{4}
%\acmArticle{39}
%\acmYear{2019}
%\acmMonth{7}

% Copyright

%\setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\setcopyright{usgov}
%\setcopyright{usgovmixed}
%\setcopyright{cagov}
%\setcopyright{cagovmixed}

% DOI
%\acmDOI{0000001.0000001_2}

% Paper history
%\received{February 2007}
%\received{March 2009}
%\received[final version]{June 2009}
%\received[accepted]{July 2009}


% Document starts
\begin{document}
% Title portion
\title{Plotting Behind the Scenes: Towards Learnable Game Engines}
% 

% DO NOT ENTER AUTHOR INFORMATION FOR ANONYMOUS TECHNICAL PAPER SUBMISSIONS TO SIGGRAPH 2019!
\author{Willi Menapace}
\authornote{Work performed while the author was an intern at Snap Inc.}
\affiliation{
  \institution{University of Trento}
  \country{Italy}
}
\email{willi.menapace@unitn.it}
\author{Aliaksandr Siarohin}
\affiliation{
  \institution{Snap Inc.}
  \country{USA}
}
\email{asiarohin@snapchat.com}
\author{St\'{e}phane Lathuili\`{e}re}
\affiliation{
  \institution{LTCI, T\'{e}l\'{e}com Paris, Institut Polytechnique de Paris}
  \country{France}
}
\email{stephane.lathuiliere@telecom-paris.fr}
\author{Panos Achlioptas}
\affiliation{
  \institution{Snap Inc.}
  \country{USA}
}
\email{pachlioptas@gmail.com}
\author{Vladislav Golyanik}
\affiliation{
  \institution{MPI for Informatics, SIC}
  \country{Germany}
}
\email{golyanik@mpi-inf.mpg.de}
\author{Elisa Ricci}
\affiliation{
  \institution{University of Trento, Fondazione Bruno Kessler}
  \country{Italy}
}
\email{e.ricci@unitn.it}
\author{Sergey Tulyakov}
\affiliation{
  \institution{Snap Inc.}
  \country{USA}
}
\email{stulyakov@snapchat.com}

%\renewcommand\shortauthors{Zhou, G. et al}


\begin{abstract}

Game engines are powerful tools in computer graphics. Their power comes at the immense cost of their development. In this work, we present a framework to train game-engine-like neural models, solely from monocular annotated videos. The result—a Learnable Game Engine (LGE)—maintains states of the scene, objects and agents in it, and enables rendering the environment from a controllable viewpoint. Similarly to a game engine, it models the logic of the game and the underlying rules of physics, to make it possible for a user to \emph{play} the game by specifying both high- and low-level action sequences. Most captivatingly, our LGE unlocks the \emph{director's mode}, where the game is played by \emph{plotting behind the scenes}, specifying high-level actions and goals for the agents in the form of \emph{language} and \emph{desired states}. This requires learning “game AI”, encapsulated by our animation model, to navigate the scene using high-level constraints, play against an adversary, devise the strategy to win a point. The key to learning such game AI is the exploitation of a large and diverse text corpus, collected in this work, describing detailed actions in a game and used to train our animation model. To render the resulting state of the environment and its agents, we use a compositional NeRF representation used in our synthesis model. To foster future research, we present newly collected, annotated and calibrated large-scale Tennis and Minecraft datasets. Our method significantly outperforms existing neural video game simulators in terms of rendering quality. Besides, our LGEs unlock applications beyond capabilities of the current state of the art. Our framework, data, and models are available at \href{https://learnable-game-engines.github.io/lge-website/}{learnable-game-engines.github.io/lge-website}. 

\end{abstract}


%
% The code below should be generated by the tool at
% http://dl.acm.org/ccs.cfm
% Please copy and paste the code instead of the example below.
%
\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10010147.10010371.10010372</concept_id>
<concept_desc>Computing methodologies~Rendering</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10010147.10010371.10010352</concept_id>
<concept_desc>Computing methodologies~Animation</concept_desc>
<concept_significance>500</concept_significance>
</concept>

</ccs2012>
\end{CCSXML}

\ccsdesc[500]{Computing methodologies~Rendering}
\ccsdesc[500]{Computing methodologies~Animation}

%
% End generated code
%

\keywords{neural radiance fields, diffusion models, human motion generation,
language modeling}

\begin{teaserfigure}
\centering
  \includegraphics[width=\textwidth]{resources/teaser.pdf}
  \caption{
  We propose Learnable Game Engines (LGEs), a game-engine-like model that is learned from annotated videos. LGEs enable the generation of videos using a wide spectrum of \textcolor{blue}{conditioning signals} such as player poses, object locations, and fine-grained textual actions (see \includegraphics[]{resources/action_icon.pdf}) indicating what each player should do. Our
  \emph{Animation Model} uses this information to generate future, past, or interpolated \textcolor{red}{environment states} according to the learned game logic and laws of physics. At this stage, the model is able to perform complex action reasoning such as generating a winning shot if the action ``the [other] player does not catch the ball'' is specified, as shown in the figure.
  To accomplish this goal, the model decides that the bottom player should hit the ball with a ``lob'' shot, sending the ball high above the opponent, who is unable to catch it.
  As a game engine, LGEs render the scene from a user-defined viewpoint (see \includegraphics[]{resources/camera_icon.pdf}) using a \emph{Synthesis Model} where the style of the scene (see \includegraphics[]{resources/style_icon.pdf}) can be controlled explicitly. The complete video and additional examples are shown in the \website.
  }
  \label{fig:teaser}
\end{teaserfigure}


\maketitle
\input{notation}
\input{introduction}
\input{related}
\input{method}
\input{applications}
\input{evaluation}
\input{conclusions}

% Bibliography
\bibliographystyle{ACM-Reference-Format}
\bibliography{bibliography}

% Appendix
\appendix
\input{appendix/datasets}
\input{appendix/details}
\input{appendix/deformation_modeling}
\input{appendix/implementation_details}
\input{appendix/training_details}
\input{appendix/inference_details}
\input{appendix/applications}
\input{appendix/evaluation}
\input{appendix/discussion}


\end{document}

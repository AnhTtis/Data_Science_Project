%!TEX root = ../main.tex


\section{Introduction}
Safety is critical in high-integrity autonomous systems. In the control community, algorithms based on \emph{energy functions} are widely employed to constrain the system state in a safe set. Among them, \emph{control barrier functions} (CBF) \cite{ames2014cdc-cbforigin} have attracted increasing research interests. A CBF encodes the safe set as its zero superlevel set that is \emph{control invariant}, \ie if the system starts within the safe set, a control sequence exists to keep the system in the safe set. Because dynamics \emph{uncertainty} is ubiquitous in real-world systems, the notion of a \emph{robust} CBF emerges to ensure the system stays safe despite the existence of uncertainties.
% Whenever the CBF's value approaches zero, a control input is picked to guarantee that the function's time derivative is non-negative. 

% On the other hand, dynamics uncertainty is prevalent in real-world applications. With uncertain dynamics models, 
Current literature around (robust) CBF mainly focus on the CBF \emph{deployment} problem: given a CBF, synthesize a safe controller with quadratic programming \cite{taylor2020acc-robustqp} or second-order cone programming \cite{buch21csl-robust}. However, two challenges remain largely unsolved: how to verify and synthesize robust CBFs?
\begin{enumerate}[label=(\roman*)]
    \item Verification. Given a robust CBF candidate, for \emph{all states} belonging to its superlevel set and \emph{all possible dynamics uncertainty}, verify whether there always exists a control input to maintain the system inside the superlevel set.
    \item Synthesis. Find a valid robust CBF (and verify its correctness) from a given function space.
\end{enumerate}

For systems with {polynomial} dynamics and simple \HYedit{polyhedral bounds on the control}, current works convert the verification problem into a convex sum-of-squares (SOS) program~\cite{clark22arxiv-cbf,dai2022arxiv-clfcbfsynveri} and the synthesis problem into a nonconvex bilinear SOS program~\cite{wang2018acc-permissive,zhao22arxiv-cbfsos}. Two drawbacks exist in these approaches. First, the bilinear SOS program is solved via alternation which does not provide global convergence guarantees. Second, they do not handle dynamics uncertainty and general (convex) control constraints. 

\textbf{Contributions.}
We focus on robust CBF verification and synthesis for control-affine polynomial systems with {bounded} state-dependent additive uncertainty and convex \HYedit{polynomial} control constraints.
We first unify and formulate robust CBF verification and synthesis as \emph{multilevel} polynomial optimization problems (POP, Section~\ref{sec:formulation})~\cite{bennett22mp-hierarchical}. Particularly, given a parametric \HYedit{polynomial} robust CBF candidate, the verification problem is casted as a three-level POP hierarchically optimizing the uncertainty, control, and state. The synthesis problem then becomes a four-level POP with an additional search for the best parameter (Section~\ref{sec:formulation:multilevel}). Despite the intractability of multilevel optimization, we show that under convex control constraints and bounded uncertainty, the inner two levels of optimization (over the uncertainty and the control) can be eliminated in closed form via the KKT optimality conditions. Consequently, the verification problem reduces to a single-level POP over the state and the synthesis problem reduces to a min-max POP over the state and the parameter (Section~\ref{sec:formulation:reduction}). We then employ multilevel semidefinite programming (SDP) relaxations to approximately solve the POPs with \emph{asymptotic global convergence guarantees} (Section~\ref{sec:sdprelax}). Specifically, for the verification problem, we relax it via Lasserre's hierarchy of moment relaxations~\cite{lasserre01siopt-global}. For the synthesis problem, we adopt the two-stage relaxation in~\cite{lasserre11jgo-minmaxpop}: in the first stage we use SOS programming to find increasingly tight (piece-wise) polynomial lower bounds to the unknown \emph{value function} of the verification POP, and in the second stage we maximize the polynomial lower bounds to search for valid parameters leading to valid robust CBFs. The reader can refer to Fig.~\ref{fig:vanderpol_clean} for a pictorial illustration of our approach, where the dotted blue line is the unknown value function and the solid lines are the polynomial lower bounds found via SOS programming. We provide an in-depth study of our algorithm on the controlled Van der Pol oscillator (Section~\ref{sec:experiments}).
% \textbf{Our contributions.} Our main contributions are three folds. (1) We provide the first systematic work for robust CBF verification and synthesis with arbitrary convex control limits. Unlike other SOSP approaches, our method guarantees asymptotic global convergence. (2) Even before convergence, our min-max POP solver can provide a sufficient condition for a valid robust CBF's existence, which renders our algorithm computationally efficient. (3) We evaluate our algorithms on a van der Pol oscillator with uncertain dynamics and show its potential power on CBF synthesis problems. 

\textbf{Limitations.} (i) Our approach is limited by the current computational bottleneck in solving large-scale SDPs and can only handle low-dimensional systems. (ii) \HYedit{Our approach does not handle the composition of multiple CBFs yet.}








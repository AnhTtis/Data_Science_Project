\documentclass{article}

% if you need to pass options to natbib, use, e.g.:
%     \PassOptionsToPackage{numbers, compress}{natbib}
% before loading neurips_2021

% ready for submission
\usepackage{iclr2023_conference,times}
\iclrfinalcopy

% to compile a preprint version, e.g., for submission to arXiv, add add the
% [preprint] option:
%     \usepackage[preprint]{neurips_2021}

% to compile a camera-ready version, add the [final] option, e.g.:
%     \usepackage[final]{neurips_2021}

% to avoid loading the natbib package, add option nonatbib:
%    \usepackage[nonatbib]{neurips_2021}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}

% === Start Florent's packages ===
% Optional math commands from https://github.com/goodfeli/dlbook_notation.
\input{math_commands.tex}

\usepackage{nameref}
\usepackage{ifthen}
\usepackage{braket}
\usepackage{amssymb,amsthm}
\usepackage{thm-restate}
\usepackage{mathtools}
\usepackage{graphicx}
\usepackage{scalerel}
\usepackage{stmaryrd}
\usepackage{centernot}
% \usepackage{todonotes}
\usepackage{subcaption}
\usepackage{mathabx}
\usepackage{multibib}
\usepackage{enumerate}
%\usepackage{algorithm}
%\usepackage[noend]{algpseudocode}
\usepackage[ruled, vlined]{algorithm2e}
\usepackage{setspace}
\usepackage{dsfont}
\usepackage{tikz}{\tiny }
\usepackage{wrapfig}
\usepackage[stdsubgroups,nocfg]{nomencl}
\usetikzlibrary{decorations,arrows,shapes,automata,calc}
\usepackage{enumitem}

\newcites{AR}{Additional References}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}{Remark}
%\theoremstyle{remark}
\newtheorem{example}{Example}

\newcommand{\GAP}[1]{\todo[inline]{\textcolor{black}{\textbf{Guillermo: }#1}}}
\newcommand{\AN}[1]{\todo[inline]{\textcolor{blue}{\textbf{Ann: }#1}}}
\newcommand{\FD}[1]{\todo[inline]{\textcolor{white}{\textbf{Florent: }#1}}}
% \presetkeys{todonotes}{disable}{}
\definecolor{OliveGreen}{HTML}{3C8031}
\definecolor{BrickRed}{HTML}{B6321C}

% commands
\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}
\newcommand{\smallparagraph}[1]{\smallskip\noindent\textbf{#1}}
\newcommand{\tabitem}{~~\llap{\textbullet}~~}
\makeatletter
\newcommand{\pushright}[1]{\ifmeasuring@#1\else\omit\hfill$\displaystyle#1$\fi\ignorespaces}
\newcommand{\pushleft}[1]{\ifmeasuring@#1\else\omit$\displaystyle#1$\hfill\fi\ignorespaces}
\makeatother

% numbers
\newcommand{\tuple}[1]{\ensuremath{\left\langle #1 \right\rangle}}
\newcommand{\indexof}[2]{\ensuremath{#1_{\scriptscriptstyle #2}}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\fun}[1]{\ensuremath{\mathopen{}\mathclose\bgroup\left(#1\aftergroup\egroup\right)}}
% \newcommand{\condition}[1]{\ensuremath{\mathds{1}_{#1}}}
\newcommand{\condition}[1]{\ensuremath{\1_{#1}}}
\newcommand{\vect}[1]{\ensuremath{\bm{#1}}}
\newcommand{\entrywise}[3]{\ensuremath{\tuple{#1}_{#2 \in [#3]}}}
\newcommand{\images}[1]{\ensuremath{\mathrm{Im}\fun{#1}}}
\newcommand{\diam}[1]{\ensuremath{\mathrm{diam}\fun{#1}}}

% MDPs
\newcommand{\mdp}{\ensuremath{\mathcal{M}}}
\newcommand{\states}{\ensuremath{\mathcal{S}}}
\newcommand{\actions}{\ensuremath{\mathcal{A}}}
\newcommand{\transitions}{\ensuremath{\mathcal{T}}}
%\newcommand{\probtransitions}[1]{\ensuremath{\mathbf{P}}^{\scriptscriptstyle\transitions}\ifthenelse{\equal{#1}{}}{}{_{\scriptscriptstyle#1}}}
\newcommand{\probtransitions}{\ensuremath{\mathbf{P}}} %^{\transitions}}
\newcommand{\rewards}{\ensuremath{\mathcal{R}}}
\newcommand{\labels}{\ensuremath{\ell}}
\newcommand{\atomicprops}{\ensuremath{\mathbf{AP}}}
\newcommand{\sinit}{\ensuremath{s_{\mathit{I}}}}
\newcommand{\mdptuple}{\langle \states, \actions, \probtransitions, \rewards, \labels, \atomicprops, \sinit \rangle}
\newcommand{\mdpspace}{\ensuremath{\mathbb{M}}}
\newcommand{\statesmdptuple}[2]{\ensuremath{ \tuple{#1, \actions, \transitions_{\scriptscriptstyle#1}, \rewards_{\scriptscriptstyle#1}, \labels_{\scriptscriptstyle#1}, \atomicprops, #2} }}
\newcommand{\previousstate}{\ensuremath{\state^{\scriptscriptstyle -1}}}
\newcommand{\previousaction}{\ensuremath{\action^{\scriptscriptstyle -1}}}
\newcommand{\state}{\ensuremath{s}}
\newcommand{\vstate}{\ensuremath{\vs}}
\newcommand{\action}{\ensuremath{a}}
\newcommand{\vaction}{\ensuremath{\va}}
\newcommand{\reward}{\ensuremath{r}}
\newcommand{\labeling}{\ensuremath{l}}
\newcommand{\labelset}[1]{\ensuremath{\mathsf{#1}}}
\newcommand{\actbot}{\ensuremath{\bot}}
\newcommand{\act}[1]{\ensuremath{\mathit{Act}\ifthenelse{\equal{#1}{}}{}{(#1)}}}
\newcommand{\trajectories}[1]{\ensuremath{\mathit{Traj}^{fin}_{ #1 }}}
% \newcommand{\inftrajectories}[1]{\ensuremath{\mathit{Traj}_{#1}}}
\newcommand{\inftrajectories}[1]{\ensuremath{\mathit{Traj}}}
\newcommand{\seq}[2]{\ensuremath{#1_{\scriptscriptstyle 0:#2}}}
\newcommand{\trajectory}{\tau}
\newcommand{\trajectorytuple}[3]{\ensuremath{\tuple{#1_{\scriptscriptstyle 0:#3}, #2_{\scriptscriptstyle 0: #3-1}}}}
\newcommand{\trace}{\ensuremath{\hat{\trajectory}}}
\newcommand{\tracetuple}[5]{\ensuremath{\tuple{#1_{\scriptscriptstyle 0:#5}, #2_{\scriptscriptstyle 0: #5-1}, #3_{\scriptscriptstyle 0:#5 - 1}, #4_{\scriptscriptstyle 0: #5}}}}
\newcommand{\defaulttrace}{\ensuremath{\tracetuple{\state}{\action}{\reward}{\labeling}{T}}}
\newcommand{\traces}[1]{\ensuremath{\mathit{Traces}_{#1}}}
\newcommand{\policy}{\ensuremath{\pi}}
\newcommand{\policies}[1]{\ensuremath{\Pi_{#1}}}
\newcommand{\mpolicies}[1]{\ensuremath{\Pi}}
% \newcommand{\mpolicies}[1]{\ensuremath{\Pi_{#1}^{\textnormal {ml}}}}
\newcommand{\safepolicy}[1]{\ensuremath{\Pi_{#1}^{\textnormal {safe}}}}
\newcommand{\steadystate}[1]{\ensuremath{\xi_{#1}}}
\newcommand{\car}{\ensuremath{\scaleto{\rotatebox[origin=c]{90}{$\circlearrowright$}}{1.4ex}}}
\newcommand{\selfloop}[2]{\ensuremath{#1^{\nobreak\hspace{.065em} \car #2 }}}
\newcommand{\getstates}[1]{\ensuremath{\llbracket #1 \rrbracket}}
\newcommand{\valuessymbol}[2]{\ensuremath{V_{#1}^{#2}}}
\newcommand{\values}[3]{\ensuremath{\valuessymbol{#1}{#2}\fun{#3}}}
\newcommand{\approxvalues}[3]{\ensuremath{\hat{V}_{#1}^{#2}\fun{#3}}}
\newcommand{\episodereturn}[1]{\ensuremath{\mathbf{R}_{#1}}}
\newcommand{\qvaluessymbol}[2]{\ensuremath{Q_{#1}^{#2}}}
\newcommand{\qvalues}[4]{\ensuremath{\qvaluessymbol{#1}{#2}\fun{#3, #4}}}
\newcommand{\objective}{\ensuremath{\Omega}}
\newcommand{\bscc}[2]{\ensuremath{\mathcal{B}^{#1}_{#2}}}
\newcommand{\stationary}[1]{\ensuremath{\xi_{#1}}}
\newcommand{\bisimulation}{\ensuremath{\mathcal{B}}}

% VAE
\newcommand{\encodersymbol}{\ensuremath{Q}}
\newcommand{\encoder}{\ensuremath{\encodersymbol_\encoderparameter}}
\newcommand{\encoderinit}{\ensuremath{\encodersymbol_{\encoderparameter, I}}}
\newcommand{\decodersymbol}{\ensuremath{P}}
\newcommand{\decoder}{\ensuremath{\decodersymbol_\decoderparameter}}
% \newcommand{\latentbeliefspace}{\ensuremath{\mathcal{Q}}}
% \newcommand{\transitiontolatent}{\ensuremath{P^{\scriptscriptstyle \transitions}_{\scalebox{.8}{$\scriptscriptstyle \states, \latentstates$}}}}
% \newcommand{\sreset}{\ensuremath{\state_{\text{reset}}}}
% \newcommand{\actreset}{\ensuremath{\action_{\text{reset}}}}
\newcommand{\latenttransitions}{\ensuremath{\transitions_\theta}}
\newcommand{\encoderparameter}{\ensuremath{\iota}}
\newcommand{\decoderparameter}{\ensuremath{\theta}}
\newcommand{\generative}{\ensuremath{\mathcal{G}}}
\newcommand{\wassersteinparameter}{\ensuremath{\omega}}


% Objectives
\newcommand{\discount}{\ensuremath{\gamma}}
\newcommand{\discountedreturn}[1]{\ensuremath{\mathit{Disc}_{#1}}}
\newcommand{\totalreturn}{\ensuremath{\rewards^{\scriptscriptstyle \infty}}}
\newcommand{\unsafe}{\ensuremath{\mathit{Unsafe}}}
\newcommand{\safe}{\ensuremath{\mathit{Safe}}}
\newcommand{\always}{\ensuremath{\square}}
\newcommand{\eventually}{\ensuremath{\lozenge}}
\newcommand{\ltlnext}{\ensuremath{\bigcirc}}
\newcommand{\policyequiv}{\ensuremath{R}}
\newcommand{\until}[2]{\ensuremath{#1 \, \mathcal{U} \, #2}}

% Probability and information theory
\newcommand{\Prob}{\ensuremath{\displaystyle \mathbb{P}}}
%\newcommand{\Pr}{\ensuremath{\mathrm{Pr}}}
\newcommand{\measurableset}{\ensuremath{\mathcal{X}}}
\newcommand{\varmeasurableset}{\ensuremath{\mathcal{Y}}}
\newcommand{\borel}[1]{\ensuremath{\Sigma\fun{#1}}}
\newcommand{\sample}[2]{\ensuremath{\displaystyle #1 \sim #2}}
%\newcommand{\sampledot}{\ensuremath{\boldsymbol{\cdotp}}}
\newcommand{\sampledot}{\ensuremath{{\cdotp}}}
\newcommand{\expectedsymbol}[1]{\ensuremath{\mathop{\mathbb{E}}\ifthenelse{\equal{#1}{}}{}{_{#1}}}}
\newcommand{\expected}[2]{\ensuremath{\expectedsymbol{#1} \left[ #2 \right]}}
\newcommand{\expectmdp}[3]{\ensuremath{\displaystyle  \E_{#1}^{#2} [ #3 ]}}
\newcommand{\entropy}[1]{\ensuremath{\displaystyle H(#1)}}
\newcommand{\divergencesymbol}{\ensuremath{D}}
\newcommand{\divergence}[2]{\ensuremath{\divergencesymbol\fun{#1, #2}}}
\newcommand{\dklsymbol}{\ensuremath{\divergencesymbol_{{\mathrm{KL}}}}}
\newcommand{\dkl}[2]{\ensuremath{\dklsymbol\fun{#1 \parallel #2}}}
\newcommand{\dtvsymbol}{\ensuremath{d_{{TV}}}}
\newcommand{\dtv}[2]{\ensuremath{\dtvsymbol\fun{#1, #2}}}
\newcommand{\mean}{\ensuremath{\vmu}}
\newcommand{\covar}{\ensuremath{\mSigma}}
\newcommand{\normal}[3]{\ensuremath{\displaystyle \mathcal{N} ( #1; #2, #3 )}}
% \newcommand{\distributions}[1]{\ensuremath{\mathcal{P}\fun{#1}}}
\newcommand{\distributions}[1]{\ensuremath{\Delta\fun{#1}}}
%\newcommand{\support}[1]{\ensuremath{Supp\fun{#1}}}
\newcommand{\mode}[1]{\ensuremath{\textit{mode}\fun{#1}}}
\newcommand{\distortion}{\ensuremath{\mathbf{D}}}
\newcommand{\rate}{\ensuremath{\mathbf{R}}}
\newcommand{\dataentropy}{\ensuremath{\mathbf{H}}}
\newcommand{\elbo}{\ensuremath{\mathrm{ELBO}}}
\newcommand{\error}{\ensuremath{\varepsilon}}
\newcommand{\proberror}{\ensuremath{\delta}}

% Distributions
\newcommand{\logistic}[2]{\ensuremath{\mathrm{Logistic}(#1, #2)}}
\newcommand{\bernoulli}[1]{\ensuremath{\mathrm{Bernoulli}(#1)}}
\newcommand{\categorical}[1]{\ensuremath{\mathrm{Categorical}(#1)}}
\newcommand{\relaxedcategorical}[2]{\ensuremath{\mathrm{RelaxedCategorical}(#1, #2)}}
\newcommand{\relaxedbernoulli}[2]{\ensuremath{\mathrm{RelaxedBernoulli}(#1, #2)}}
\newcommand{\logit}{\ensuremath{{\alpha}}}
\newcommand{\logits}{\ensuremath{\vect{\logit}}}
\newcommand{\temperature}{\ensuremath{\lambda}}

% Wasserstein
\newcommand{\wassersteinsymbol}[1]{\ensuremath{W}_{#1}}
\newcommand{\wassersteindist}[3]{\ensuremath{\wassersteinsymbol{#1}\left( #2, #3 \right)}}
\newcommand{\distance}{\ensuremath{d}}
\newcommand{\logic}{\ensuremath{\mathcal{L}}}
\newcommand{\tightoverset}[2]{%
  \tikz[baseline=(X.base),inner sep=0pt,outer sep=0pt]{%
    \node[inner sep=0pt,outer sep=0pt] (X) {$#2$}; 
    \node[yshift=1.2pt] at (X.north) {$#1$};
}}
\newcommand{\bidistance}{\ensuremath{\tightoverset{\,\scriptstyle\sim}{\distance}}}
\newcommand{\logicbidistance}{\ensuremath{\tilde{\distance}^{\logic}}}
%\newcommand{\functionalexpr}{\ensuremath{\mathcal{F}_{\discount}^{\logic}}}
\newcommand{\functionalexpr}{\ensuremath{\mathcal{F}}}
%\newcommand{\diam}{\ensuremath{\textit{diam}}}
%\newcommand{\couplings}[2]{\ensuremath{\Lambda\fun{#1, #2}}}
\newcommand{\couplings}[2]{\ensuremath{\Lambda(#1, #2)}}
\newcommand{\coupling}{\ensuremath{\lambda}}
\newcommand{\proj}{\ensuremath{\Pi}}
\newcommand{\Lipschf}[1]{\ensuremath{\mathcal{F}_{#1}}}
%\newcommand{\Lipschf}[1]{\ensuremath{\norm{\cdot}_{#1}} \leq 1}
%\newcommand{\tracedistance}{\ensuremath{\hat{\distance}}}
\newcommand{\tracedistance}{\transitiondistance}
\newcommand{\transitiondistance}{\ensuremath{\ensuremath{\vec{\distance}}}}
\newcommand{\waemdp}{W$^2\!$AE-MDP$\,$}
\newcommand{\waemdps}{W$^2\!$AE-MDPs$\,$}
\newcommand{\ncritic}{\ensuremath{m}}

% Deep MDPs
\newcommand{\overbar}[1]{\mkern 1.5mu\overline{\mkern-1.5mu#1\mkern-1.5mu}\mkern 1.5mu}
\newcommand{\overbarit}[1]{\,\overline{\!{#1}}}
\newcommand{\embed}{\ensuremath{\phi}}
\newcommand{\embeda}{\ensuremath{\psi}}
% \newcommand{\latentembeda}{\ensuremath{\overbarit{\embeda}}}
\newcommand{\actionencoder}{\ensuremath{\embed_{\encoderparameter}^{\scriptscriptstyle\actions}}}
% \newcommand{\transitionencoder}{\ensuremath{\vec{\embed}}}
\newcommand{\transitionencoder}{\ensuremath{q}}
\newcommand{\latentmdp}{\ensuremath{\overbarit{\mdp}}}
\newcommand{\latentprobtransitions}{\ensuremath{\overbar{\probtransitions}}}
\newcommand{\latentstates}{\ensuremath{\overbarit{\mathcal{\states}}}}
\newcommand{\latentrewards}{\ensuremath{\overbarit{\rewards}}}
\newcommand{\latentlabels}{\ensuremath{\overbarit{\labels}}}
\newcommand{\latentmdptuple}{\ensuremath{\tuple{\latentstates, \latentactions, \latentprobtransitions, \latentrewards, \latentlabels, \atomicprops, \zinit}}}
\newcommand{\latentstate}{\ensuremath{\overbarit{\state}}}
\newcommand{\zinit}{\ensuremath{\latentstate_I}}
\newcommand{\latentactions}{\ensuremath{\overbarit{\actions}}}
\newcommand{\latentaction}{\ensuremath{\overbarit{\action}}}
\newcommand{\latentvaluessymbol}[2]{\overbarit{\ensuremath{V}}_{#1}^{#2}}
\newcommand{\latentvalues}[3]{\ensuremath{\latentvaluessymbol{#1}{#2}\fun{#3}}}
\newcommand{\latentqvaluessymbol}[2]{\ensuremath{\overbarit{Q}_{#1}^{#2}}}
\newcommand{\latentqvalues}[4]{\ensuremath{\latentqvaluessymbol{#1}{#2}\fun{#3, #4}}}
\newcommand{\latentpolicy}{\ensuremath{\overbar{\policy}}}
\newcommand{\latentpolicies}{\ensuremath{\overbar{\Pi}}}
% \newcommand{\latentmpolicies}{\ensuremath{\overbar{\Pi}^{\textnormal {ml}}}}
\newcommand{\latentmpolicies}{\ensuremath{\overbar{\Pi}}}
\newcommand{\localtransitionloss}[1]{L_{\probtransitions}^{#1}}
\newcommand{\localrewardloss}[1]{L_{\rewards}^{#1}}
\newcommand{\localtransitionlossupper}[1]{\dot{L}_{\probtransitions}^{#1}}
\newcommand{\localrewardlossupper}[1]{\dot{L}_{\rewards}^{#1}}
\newcommand{\localtransitionlossapprox}[1]{\hat{L}_{\probtransitions}^{#1}}
\newcommand{\localrewardlossapprox}[1]{\hat{L}_{\rewards}^{#1}}
\newcommand{\KV}{\ensuremath{K_{\latentvaluessymbol{}{}}}}
\newcommand{\KR}[1]{\ensuremath{\ifthenelse{\equal{#1}{}}{K_{\latentrewards}}{K_{\latentrewards}^{#1}}}}
\newcommand{\KP}[1]{\ensuremath{\ifthenelse{\equal{#1}{}}{K_{\latentprobtransitions}}{K_{\latentprobtransitions}^{#1}}}}
\newcommand{\Rmax}[1]{\ensuremath{\ifthenelse{\equal{#1}{}}{|\latentrewards^\star|}{|\latentrewards_{#1}^{\star}|}}}
\newcommand{\stationarydecoder}{{\stationary{\decoderparameter}}}
\newcommand{\latentstationaryprior}{{\bar{\xi}_{\latentpolicy_{\decoderparameter}}}}
\newcommand{\norm}[1]{\ensuremath{\left\| #1 \right\|}}
\newcommand{\gradient}{\ensuremath{\nabla}}
\newcommand{\latentvariables}{\ensuremath{\mathcal{Z}}}
\newcommand{\latentvariable}{\ensuremath{z}}
% \newcommand{\originaltolatentstationary}[1]{{\latentprobtransitions_{\embed_{\encoderparameter}\stationary{\ifthenelse{\equal{#1}{}}{\policy}{#1}}}}}
\newcommand{\originaltolatentstationary}[1]{\ensuremath{\mathcal{T}}}
\newcommand{\varsampledfrom}[3]{\ensuremath{#1}_{{#2}, {#3}}}
\newcommand{\steadystateregularizer}[1]{\ensuremath{\mathcal{W}_{\stationary{#1}}}}
\newcommand{\steadystatenetwork}{\ensuremath{\varphi_{\wassersteinparameter}^{\stationary{}}}}
% \newcommand{\steadystatenetwork}{\ensuremath{f_{\wassersteinparameter}}}
\newcommand{\transitionlossnetwork}{\ensuremath{\varphi_{\wassersteinparameter}^{\probtransitions}}}
% \newcommand{\transitionlossnetwork}{\ensuremath{\varphi_{\wassersteinparameter}}}

% Experience replay
\newcommand{\replaybuffer}{\ensuremath{\mathcal{D}}}
\newcommand{\experience}{\ensuremath{\eta}}
\newcommand{\loss}{\ensuremath{L}}

% === Index of Notations ===
\renewcommand{\nomname}{Index of Notations}
\renewcommand{\nomgroup}[1]{%
\ifthenelse{\equal{#1}{M}}{%
      \item[\textbf{Markov Decision Processes}]}{%
        \ifthenelse{\equal{#1}{K}}{%
        \item[\textbf{P}]}{%
          \ifthenelse{\equal{#1}{P}}{%
          \item[\textbf{Probability / Measure Theory}]}{%
            \ifthenelse{\equal{#1}{L}}{%
            \item[\textbf{Latent Space Model}]}{%
              {%
              \ifthenelse{\equal{#1}{W}}{%
            \item[\textbf{Wasserstein Auto-encoded MDP}]}{%
              }}}}}}}
%\usepackage{setspace}
    \makenomenclature

%

% === End Florent's packages ===
\title{Wasserstein Auto-encoded MDPs\\\small Formal Verification of Efficiently Distilled RL Policies with Many-sided Guarantees}

% The \author macro works with any number of authors. There are two commands
% used to separate the names and addresses of multiple authors: \And and \AND.
%
% Using \And between authors leaves it to LaTeX to determine where to break the
% lines. Using \AND forces a line break at that point. So, if LaTeX puts 3 of 4
% authors names on the first line, and the last on the second line, try using
% \AND instead of \And before the third author name.

\author{%
    Florent Delgrange \\
    AI Lab, Vrije Universiteit Brussel (VUB) \\ University of Antwerp\\
    \texttt{florent.delgrange@ai.vub.ac.be}
    \And
    Ann Now\'e \\
    AI Lab, VUB
    \And
    Guillermo A. P\'erez \\
    University of Antwerp \\ Flanders Make
}

\begin{document}
\maketitle
\begin{abstract}
Although deep reinforcement learning (DRL) has many success stories, the large-scale deployment of policies learned through these advanced techniques in safety-critical scenarios is hindered by their lack of formal guarantees.
Variational Markov Decision Processes (VAE-MDPs) are discrete latent space models that provide a reliable framework for distilling formally verifiable controllers from any RL policy.
While the related guarantees address relevant practical aspects such as the satisfaction of performance and safety properties, the VAE approach suffers from several learning flaws (posterior collapse, slow learning speed, poor dynamics estimates), primarily due to the absence of abstraction and representation guarantees to support latent optimization.
We introduce the Wasserstein auto-encoded MDP (WAE-MDP), a latent space model that fixes those issues by minimizing a penalized form of the optimal transport between the behaviors of the agent executing the original policy and the distilled policy, for which the formal guarantees apply.
Our approach yields bisimulation guarantees while learning the distilled policy, allowing concrete optimization of the abstraction and representation model quality.
Our experiments show that, besides distilling policies up to 10 times faster, the latent model quality is indeed better in general.
Moreover, we present experiments from a simple time-to-failure verification algorithm on the latent space. The fact that our approach enables such simple verification techniques highlights its applicability.
\end{abstract}
\section{Introduction}
\input{intro}
\section{Background}\label{sec:background}
\input{background}
\section{Wasserstein Auto-encoded MDPs}
\input{wae}
\section{Experiments}\label{sec:experiments}
\input{experiments}
\section{Conclusion}\label{sec:conclusion}
\input{conclusion}

\subsubsection*{Reproducibility Statement}
We referenced in the main text the Appendix parts presenting the proofs or additional details of every claim, Assumption, Lemma, and Theorem occurring in the paper.
In addition, Appendix~\ref{appendix:experiments} is dedicated to the presentation of the setup, hyperparameters, and other extra details required for reproducing the results of Section~\ref{sec:experiments}.
We provide the source code of the implementation of our approach in Supplementary material \footnote{available at \url{https://github.com/florentdelgrange/wae_mdp}}, and we also provide the models saved during training that we used for model checking (i.e., reproducing the results of Table~\ref{table:evaluation}).
Additionally, we present in a notebook ({\small\texttt{evaluation.html}}) videos demonstrating how our distilled policies behave in each environment, and code snippets showing how we formally verified the policies. 

\subsubsection*{Acknowledgments}
This research received funding from the Flemish Government (AI Research Program) and was supported by the DESCARTES iBOF project. G.A. Perez is also supported by the Belgian FWO “SAILor” project (G030020N).
We thank Raphael Avalos for his valuable feedback during the preparation of this manuscript.

\bibliography{references}
\bibliographystyle{iclr2023_conference}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\appendix
\section*{Appendix}
\input{appendix}

\end{document}

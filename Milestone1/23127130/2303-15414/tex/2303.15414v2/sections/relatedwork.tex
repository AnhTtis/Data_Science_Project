
\section{Related Work}
%Multiple object tracking task aims to find trajectories of different objects in a video clip. In most methods of the MOT task, a tracking-by-detection paradigm is applied, which means they should detect objects frame by frame and then associate the detection results using matching algorithms. Most mainstream methods focus on getting accurate detection results, extracting robust features from detected bounding boxes, and matching the bounding boxes belonging to the same track.

\noindent{\bf Data association in MOT.}
The data association step in \textit{tracking-by-detection} paradigm is generally solved by probabilistic filter or combinatorial optimization techniques.
Classical probabilistic approach includes JPDA \cite{bar1990tracking} and MHT \cite{reid1979algorithm}. The advantage of this approach is to keep all the possible candidates for association, and remain the chance to recover from failures. Nevertheless, their costs are prohibitive if no approximation is applied \cite{hamid2015joint, kim2015multiple}. 
For combinatorial optimization, traditional approach include bipartite matching \cite{bewley2016simple}, dynamic programming \cite{fleuret2007multicamera}, min-cost flow \cite{zhang2008global, berclaz2011multiple} and conditional random field \cite{yang2011learning}. Follow-up work tried to adopt more complex optimization methods \cite{zamir2012gmcp, tang2015subgraph}, reduce the computational cost \cite{pirsiavash2011globally, tang2016multi} or promote an online setting from them \cite{choi2015near, wang2016tracklet}.
Early work of deep learning-based association in MOT such as \cite{wojke2017simple,leal2016learning, sadeghian2017tracking,Li_2020_WACV} mostly focus on learning a better appearance model for each object. 
% Then by the advance of object detection and multi-task learning, several work~\cite{bergmann2019tracking, lu2020retinatrack, zhou2020tracking, zhang2020fair} combine detection and tracking in the same framework. 
More recently, several work tried to bridge the graph optimization and end-to-end deep learning \cite{jiang2019graph, braso2020learning, xu2020train, Li_2020_WACV, hornakova2020lifted,li2022learning}. \cite{jiang2019graph} adopts Graph Neural Network (GNN) to learn an affinity matrix in a data-driven way. MPNTrack \cite{braso2020learning} introduces a message passing network to learn high-order information between vertices from different frames. \cite{Li_2020_WACV} constructs two graph networks to model appearance and motion features, respectively. 
LifT \cite{hornakova2020lifted} proposes a lifted disjoint path formulation for MOT, which introduces lifted edges to capture long term temporal interactions. \cite{hu2020dual} is the first to formulate the MOT task as a graph matching problem and use dual L1-normalized tensor power iteration method to solve it. Different from \cite{hu2020dual} that directly extracts the features from an off-the-shelf neural network, we propose to guide the feature learning by the optimization problem, which can both enjoy the power of deep feature learning and combinatorial optimization. This joint training manner of representation and optimization problem also eliminate the inconsistencies between the training and inference.
%In the pre-deep learning era, several works \cite{zhang2008global, pirsiavash2011globally} propose a global data association approach by mapping the association problem as a cost-flow network with a non-overlap constraint on trajectories. \cite{zamir2012gmcp} and \cite{tang2015subgraph} adopt more complex optimization such as minimum cliques and subgraph multicut. SORT \cite{bewley2016simple} proposes a simple online framework for realtime MOT. Hungarian matching algorithm \cite{kuhn1955hungarian} is used for frame-by-frame data association.

\noindent{\bf Data association in image matching and point cloud registration.} Image matching is a traditional computer vision task, and the main procedures include keypoint detection on the image, keypoint feature extraction, and keypoint matching. Earlier researches mainly focus on the robust keypoint detectors and feature extractors, especially for the local feature descriptor with scale-invariance, rotation-invariance and translation-invariance, such as SIFT~\cite{lowe2004distinctive}, SURF~\cite{bay2006surf} and ORB~\cite{rublee2011orb}. And the matching algorithms are based on the Nearest Neighbor (NN) search with different outlier filtering methods~\cite{lowe2004distinctive,tuytelaars2000wide,sattler2009scramsac}. In the era of deep learning, the CNN-based feature detectors and extractors have emerged, such as D2-net~\cite{dusmanu2019d2} and SuperPoint~\cite{detone2018superpoint}. However, the exploration of end-to-end learnable matching algorithms has just begun. SuperGlue~\cite{sarlin2020superglue} utilizes the attentional graph neural network to model the long-range relationship in the image, and the matching module is designed as a differentiable Sinkhorn layer, which is the approximation of graph matching without explicitly modeling the edge in the graph. LoFTR~\cite{sun2021loftr} is a kind of dense matching algorithm, from patch matching to pixel matching in coarse-to-fine style. 
As for point cloud registration, there are two kinds of methods: correspondence-based methods and direct registration methods. The correspondence-based methods~\cite{deng2018ppfnet, choy2019fully,qin2022geometric} extract correspondences between two point clouds and solve the transformation matrix with pose estimators, e.g. SVD, RANSAC, LGR. Direct registration methods~\cite{wang2019prnet, huang2020feature, fu2021robust} use an end-to-end neural network to regress the transformation matrix.\par
% \noindent{\bf Deep learning in MOT.}
% Early work of deep learning in MOT such as \cite{wojke2017simple,leal2016learning, sadeghian2017tracking,Li_2020_WACV} mostly focus on learning a better appearance model for each object. Then by the advance of object detection and multi-task learning, several work~\cite{bergmann2019tracking, lu2020retinatrack, zhou2020tracking, zhang2020fair} combine detection and tracking in the same framework. More recently, several work tried to bridge the graph optimization and end-to-end deep learning \cite{jiang2019graph, braso2020learning, xu2020train, Li_2020_WACV, hornakova2020lifted}. \cite{jiang2019graph} adopts Graph Neural Network (GNN) to learn an affinity matrix in a data-driven way. MPNTrack \cite{braso2020learning} introduces a message passing network to learn high-order information between vertices from different frames. \cite{Li_2020_WACV} constructs two graph networks to model appearance and motion features, respectively. 
% LifT \cite{hornakova2020lifted} proposes a lifted disjoint path formulation for MOT, which introduces lifted edges to capture long term temporal interactions.
%Above methods mainly focus on modeling the connection of nodes between different frames, while ignore the graph context with in a frame. To address this issue, we adopt graph matching to find the data association. Through combining the edges information between nodes in the same frame, we can generate more robust matching results.
\begin{comment}
\noindent{\bf Neighborhood and context information in MOT.} Pedestrians usually walk in a group, so the motion of them are highly clustered. Modeling neighborhood and context relationships may provide important clues for the MOT task. Several early work \cite{rodriguez2009tracking,hu2008detecting} consider the group model as a prior in motion model for the crowd scenes. 
\cite{yoon2016online} considers the distance between detections as the neighborhood relationship during the data association.
% In the proposed group model, a group should have a similar motion, stay close with neighbors and keeping a distance from others. 
However, these hand-crafted priors can be quite limited in complicated scenes. Recently, many methods~\cite{liang2020enhancing,peng2020tpm,liugsm,lan2016online} learn appearance and geometric information by passing messages among neighbors. However, their goal is still to enhance the appearance features. They do not consider them explicitly in the association across frames.
In this work, we propose to explicitly consider the neighborhood context in data association via differentiable graph matching and use it to guide the feature learning in an end-to-end manner. 
% In other tasks, such as person search~\cite{yan2019learning} and trajectory prediction~\cite{xu2018encoding}, the collaboration between neighbors or in a group is also a common consideration. 
%However, for the MOT task, combining the graph model and neighbor information, despite the limited application, graph matching, which considers edge similarity, is a kind of better representation. 
\end{comment}
\noindent{\bf Graph matching and combinatorial optimization.}
%Combinatorial optimization is the optimization problem whose optimization variable is discrete, such as Traveling Salesman Problem, Knapsack Problem, etc. The graph matching problem is also a combinatorial optimization problem. 
Pairwise graph matching, or more generally Quadratic Assignment Problem (QAP), has wide applications in various computer vision tasks \cite{vento2013graph}.
Compared with the linear assignment problem that only considers vertex-to-vertex relationship, pairwise graph matching also considers the second-order edge-to-edge relationship in graphs. 
The second-order relationship makes matching more robust. However, as shown in \cite{hartmanis1982computers}, this problem is an NP-hard problem. 
There is no polynomial solver like Hungarian algorithm~\cite{kuhn1955hungarian} for the linear assignment problem. In the past decades, many work engages in making the problem tractable by relaxing the original QAP problem~\cite{leordeanu2005spectral,schellewald2005probabilistic,torr2003solving}. Lagrangian decomposition~\cite{swoboda2017study} and factorized graph matching~\cite{facgm} are two representative ones. 
To incorporate graph matching into deep learning, one stream of work is to treat the assignment problem as a supervised learning problem directly, and use the data fitting power of deep learning to learn the projection from input graphs to output assignment directly ~\cite{wang2019learning,Yu2020Learning}.
Another more theoretically rigorous is to relax the problem to a convex optimization problem first, and then utilize the KKT condition and implicit function theorem to derive the gradients w.r.t all variables at the optimal solution ~\cite{barratt2018differentiability}. Inspired by it, in this paper, we propose a learnable graph matching layer to solve the challenging graph matching problem in data association.
% As shown in ~\cite{amos2017optnet}, the universality and transferability of the latter approach are much better than the first one. Thus, in this paper, we derive a graph matching layer based on this spirit to solve the challenging graph matching problem in MOT.

% In MOT task, the application of graph matching is very limited.
%Algorithm complexity will be extremely high when the number of nodes in the graph increases. 

% Recently, an emerging trend is to incorporate graph matching and other combinatorial optimization problems into deep learning. 

% GMN~\cite{zanfir2018deep} is the first differential and end-to-end learned model to solve the graph matching problem. It makes the parameters in feature extractor, affinity matrix end-to-end learnable with a matching based loss function. Many works follow and improve it by aggregating features using graph neural network~\cite{wang2019learning} and modifying the loss function~\cite{Yu2020Learning}. 


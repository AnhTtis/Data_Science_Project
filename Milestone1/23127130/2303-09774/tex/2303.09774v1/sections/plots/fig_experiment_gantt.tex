% \begin{figure}[t]
% \centerline{\includegraphics[width=\linewidth]{figures/timeline.pdf}}
% \caption{An illustration of the effect of our proposed system on the breakdown of a recurring job. Expensive read/writes of intermediate tables during job execution are significantly reduced.}
% \label{fig:intro}
% \end{figure}
\begin{figure*}[t]
\begin{subfigure}[b]{\linewidth}
\begin{tikzpicture}
% labels
\begin{scope}[every node/.style={rectangle,thick, anchor=east}]
    \node[align=right] (label1) at (1, 3.2) {Traditional};
    \node[align=right] (label2) at (0, 2.5) {\footnotesize Exec};
    \node[align=right] (label3) at (0, 2) {\footnotesize Blocking I/O} ;
    \node[align=right] (label4) at (1, 0.5) {Ours (\system)};
    \node[align=right] (label5) at (0, -0.2) {\footnotesize Exec};
    \node[align=right] (label6) at (0, -0.7) {\footnotesize Blocking I/O} ;
    \node[align=right] (label6) at (0, -1.2) {\footnotesize Serializer I/O} ;
    \node[align=right] (label7) at (16, 1.2) {\footnotesize Time};
    \node[align=right] (label8) at (16, -1.8) {\footnotesize Time} ;
\end{scope}

% plot lines
\begin{scope}[>={Stealth[black]},
              every node/.style={fill=none,circle},
              every edge/.style={draw=black}]
    \draw (0,3) -- (0, 1.4);
    \draw (0,0.3) -- (0, -1.6);
    \draw[->] (0,1.4) -- (16, 1.4);
    \draw[->] (0,-1.6) -- (16, -1.6);
\end{scope}

% ticks
\begin{scope}[>={Stealth[black]},
              every node/.style={fill=none,circle},
              every edge/.style={draw=black}]
    \draw (1,1.4) -- (1, 1.45);
    \draw (2,1.4) -- (2, 1.45);
    \draw (3,1.4) -- (3, 1.45);
    \draw (4,1.4) -- (4, 1.45);
    \draw (5,1.4) -- (5, 1.45);
    
    \node[] at (1, 1.25) {\footnotesize 10} ;
    \node[] at (2, 1.25) {\footnotesize 20} ;
    \node[] at (3, 1.25) {\footnotesize 30} ;
    \node[] at (4, 1.25) {\footnotesize 40} ;
    \node[] at (5, 1.25) {\footnotesize 50} ;
    
    \draw (1,-1.6) -- (1, -1.55);
    \draw (2,-1.6) -- (2, -1.55);
    \draw (3,-1.6) -- (3, -1.55);
    \draw (4,-1.6) -- (4, -1.55);
    \draw (5,-1.6) -- (5, -1.55);
    
    \node[] at (1, -1.75) {\footnotesize 10} ;
    \node[] at (2, -1.75) {\footnotesize 20} ;
    \node[] at (3, -1.75) {\footnotesize 30} ;
    \node[] at (4, -1.75) {\footnotesize 40} ;
    \node[] at (5, -1.75) {\footnotesize 50} ;
\end{scope}

% traditional
\begin{scope}[every node/.style={rectangle,draw, anchor=west, inner sep=0cm,minimum height = 3mm}]
    \node[fill=SAColor, minimum width = 20.2mm] (X) at (0,2) {\scriptsize R(s\_sales)};
    \node[fill=SAColor, minimum width = 0.4mm] (A1) at (2.02, 2.5) {};
    \node[fill=SAColor, minimum width = 12.7mm] (X) at (2.06,2) {\scriptsize W(ss)};
    \node[fill=SAColor, minimum width = 1.9mm] (X) at (3.33,2) {\scriptsize};
    \node[fill=SAColor, minimum width = 0.1mm] (A1) at (3.52, 2.5) {};
    \node[fill=SAColor, minimum width = 1.2mm] (X) at (3.53,2) {\scriptsize};
    \node[fill=SAColor, minimum width = 10.1mm] (X) at (3.65,2) {\scriptsize R(c\_sales)};
    \node[fill=SAColor, minimum width = 0.3mm] (A1) at (4.66, 2.5) {};
    \node[fill=SAColor, minimum width = 7.1mm] (X) at (4.69,2) {\scriptsize W(cs)};
\end{scope}

% traditional labels
\node[] (A1) at (2.02, 2.8) {\scriptsize ss};
\node[] (A1) at (3.52, 2.8) {\scriptsize sr};
\node[] (A1) at (4.66, 2.8) {\scriptsize cs};
\node[] (A1) at (2.9, 1.6) {\scriptsize R(s\_returns)};
\node[] (A1) at (4.0, 1.6) {\scriptsize W(ss)};
% traditional labels
\begin{scope}[>={Stealth[black]},
              every node/.style={fill=none,circle},
              every edge/.style={draw=black}]
    \draw [] (3.4, 1.85) --  (3.0, 1.7);
    \draw [] (3.6, 1.85) --  (4.0, 1.7);
\end{scope}

% ours
\begin{scope}[every node/.style={rectangle,draw, anchor=west, inner sep=0cm,minimum height = 3mm}]
    \node[fill=SAColor, minimum width = 18.0mm] (X) at (0,-0.7) {\scriptsize R(s\_sales)};
    \node[fill=SAColor, minimum width = 0.4mm] (A1) at (1.8, -0.2) {};
    \node[fill=SAColor, minimum width = 12.5mm] (X) at (1.84,-0.7) {\scriptsize W(ss)};
    \node[fill=SAColor, minimum width = 1.8mm] (X) at (3.09,-0.7) {\scriptsize};
    \node[fill=SAColor, minimum width = 0.1mm] (A1) at (3.27, -0.2) {};
    \node[fill=SAColor, minimum width = 1.3mm] (X) at (3.28,-0.7) {\scriptsize};
    \node[fill=SAColor, minimum width = 0.1mm] (A1) at (3.41, -0.2) {};
    \node[fill=SAColor, minimum width = 10.8mm] (X) at (3.42,-0.7) {\scriptsize R(c\_sales)};
    \node[fill=SAColor, minimum width = 0.2mm] (A1) at (4.5, -0.2) {};
    \node[fill=SAColor, minimum width = 6.2mm] (X) at (4.52,-0.7) {\scriptsize};
    \node[fill=SAColor, minimum width = 0.1mm] (A1) at (5.14, -0.2) {};
    \node[fill=SAColor, minimum width = 2mm] (X) at (5.15,-0.7) {\scriptsize};
\end{scope}

% ours serializer
\begin{scope}[every node/.style={rectangle,draw, anchor=west, inner sep=0cm,minimum height = 3mm}]
    \node[fill=SAColor, minimum width = 2.0mm] (X) at (3.28,-1.2) {\scriptsize};
    \node[fill=SAColor, minimum width = 0.6mm] (X) at (3.48,-1.2) {\scriptsize};
    \node[fill=SAColor, minimum width = 10mm] (X) at (4.52,-1.2) {\scriptsize W(cs)};
\end{scope}

% traditional labels
\node[] (A1) at (1.82, 0.1) {\scriptsize ss};
\node[] (A1) at (3.23, 0.1) {\scriptsize sr};
\node[] (A1) at (3.46, 0.1) {\scriptsize cr};
\node[] (A1) at (4.51, 0.1) {\scriptsize cs};
\node[] (A1) at (5.0, 0.1) {\scriptsize ws};
\node[] (A1) at (4.8, 0.3) {\scriptsize R(w\_sales)};
% traditional labels
\begin{scope}[>={Stealth[black]},
              every node/.style={fill=none,circle},
              every edge/.style={draw=black}]
    \draw [] (4.8,0.1) --  (4.8,-0.6);
    \draw [] (3.6, 1.85) --  (4.0, 1.7);
\end{scope}

%zigzag lines
    \draw[fill=white,draw=white] (5.2,2.8) -- (5.4,3.4) -- (5.8,3.4) -- (5.6,2.8) -- cycle;
    \draw[draw=black] (5.2,2.8) -- (5.4,3.4);
    \draw[draw=black] (5.6,2.8) -- (5.8,3.4);
    \draw[fill=white,draw=white] (5.4,2.2) -- (5.2,2.8) -- (5.6,2.8) -- (5.8,2.2) -- cycle;
    \draw[draw=black] (5.4,2.2) -- (5.2,2.8);
    \draw[draw=black] (5.8,2.2) -- (5.6,2.8);
    \draw[fill=white,draw=white] (5.2,1.6) -- (5.4,2.2) -- (5.8,2.2) -- (5.6,1.6) -- cycle;
    \draw[draw=black] (5.2,1.6) -- (5.4,2.2);
    \draw[draw=black] (5.6,1.6) -- (5.8,2.2);
    \draw[fill=white,draw=white] (5.4,1.0) -- (5.2,1.6) -- (5.6,1.6) -- (5.8,1.0) -- cycle;
    \draw[draw=black] (5.4,1.0) -- (5.2,1.6);
    \draw[draw=black] (5.8,1.0) -- (5.6,1.6);
    \draw[fill=white,draw=white] (5.2,0.4) -- (5.4,1.0) -- (5.8,1.0) -- (5.6,0.4) -- cycle;
    \draw[draw=black] (5.2,0.4) -- (5.4,1.0);
    \draw[draw=black] (5.6,0.4) -- (5.8,1.0);
    \draw[fill=white,draw=white] (5.4,-0.2) -- (5.2,0.4) -- (5.6,0.4) -- (5.8,-0.2) -- cycle;
    \draw[draw=black] (5.4,-0.2) -- (5.2,0.4);
    \draw[draw=black] (5.8,-0.2) -- (5.6,0.4);
    \draw[fill=white,draw=white] (5.2,-0.8) -- (5.4,-0.2) -- (5.8,-0.2) -- (5.6,-0.8) -- cycle;
    \draw[draw=black] (5.2,-0.8) -- (5.4,-0.2);
    \draw[draw=black] (5.6,-0.8) -- (5.8,-0.2);
    \draw[fill=white,draw=white] (5.4,-1.4) -- (5.2,-0.8) -- (5.6,-0.8) -- (5.8,-1.4) -- cycle;
    \draw[draw=black] (5.4,-1.4) -- (5.2,-0.8);
    \draw[draw=black] (5.8,-1.4) -- (5.6,-0.8);
    \draw[fill=white,draw=white] (5.2,-2.0) -- (5.4,-1.4) -- (5.8,-1.4) -- (5.6,-2.0) -- cycle;
    \draw[draw=black] (5.2,-2.0) -- (5.4,-1.4);
    \draw[draw=black] (5.6,-2.0) -- (5.8,-1.4);
    
\end{tikzpicture}
\end{subfigure}
\label{fig:example_timeline}
\vspace{-4mm}
\caption{Comparison between executing workload 1 on the scale 100 TPC-DS dataset with \system and a raw engine (Polars). \system reduces the I/O time by 54\% using 32GB of spare memory to persist intermediate tables.}
\end{figure*}

\ignore{
\begin{figure*}[t]
\centerline{\includegraphics[width=\linewidth, height=4cm]{figures/experiment_gantt.jpg}}
\caption{Comparison between executing workload 1 on the scale 100 TPC-DS dataset with \system and a raw engine (Polars). \system reduces the I/O time by 54\% using 32GB of spare memory to persist intermediate tables.}
\label{fig:experiment_gantt}
\end{figure*}
}
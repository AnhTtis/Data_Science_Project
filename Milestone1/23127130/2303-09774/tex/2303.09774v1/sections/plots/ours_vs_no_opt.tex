%!TEX root = main.tex

\begin{figure*}[t]

\pgfplotsset{accfig/.style={
    width=90mm,
    height=50mm,
    legend columns=5,
    every axis/.append style={font=\footnotesize},
    % ymajorgrids,
    % yminorgrids,
    minor grid style=lightgray,
    % nodes near coords,
    % every node near coord/.append style={font=\footnotesize,anchor=west,rotate=60}
}}

\pgfplotsset{timefig/.style={
    width=58mm,
    height=35mm,
    xmin=10,
    xmax=100,
    ymin=0,
    ymax=60,
    xlabel=Number of Queries,
    ylabel=Runtime (sec),
    xlabel near ticks,
    ylabel near ticks,
    ylabel style={align=center},
    xtick={0, 10, ..., 100},
    % xticklabels={80\%, 85\%, 90\%, 95\%, 99\%, 99.5\%},
    ytick={0, 10, ..., 60},
    % yticklabels={0\%, 10\%, 20\%, 30\%},
    % xticklabel style={rotate=30,yshift=-2mm,anchor=east,xshift=1.5mm},
    % yticklabels={0 hr, 0.5 hr, 1 hr, 1.5 hr, 2.0 hr},
    % extra y ticks={10, 20, 30, 40},
    % extra y tick style={yticklabels={}},
    ylabel shift=-2pt,
    xlabel shift=-2pt,
    legend style={
        at={(0,1.15)},anchor=south west,column sep=2pt,
        draw=black,fill=none,line width=.5pt,
        /tikz/every even column/.append style={column sep=5pt}
    },
    legend columns=4,
    every axis/.append style={font=\footnotesize},
    % ymajorgrids,
    % yminorgrids,
    minor grid style=lightgray,
    % nodes near coords,
    % every node near coord/.append style={font=\footnotesize,anchor=west,rotate=60}
}}

\begin{subfigure}[b]{0.96\linewidth}
\begin{tikzpicture}
\begin{axis}[accfig,
    ybar,
    bar width=1.2mm,
    xlabel=RMS Error,
    xmin=0.5,
    xmax=5.5,
    xtick={1, 2, ..., 5},
    xticklabels={Job 1, Job 2, Job 3, Job 4, Job 5},
    ylabel=Time (ms),
    ymin=1,
    ymax=600,
    ytick={100, 200, 300, 400, 500, 600},
    yticklabels={100, 200, 300, 400, 500, 600},
    xticklabel style={yshift=2mm},
    xlabel style={yshift=0mm},
    xtick style={draw=none},
    legend style={
        at={(1.0,1.1)},anchor=south east,column sep=2pt,
        draw=black,fill=white,line width=.5pt,
        /tikz/every even column/.append style={column sep=5pt}
    },
    legend columns=4,
    area legend,
    clip=false,
    ymajorgrids,
    % yminorgrids,
    ylabel shift=-4pt,
    ]

% No Memory
\addplot[
thick,draw=vintagegreen,fill=vintagegreen,
]
table[x=x,y=y] {
x y
1 353.672
2 65.734
3 539.266
4 151.718
5 306.163
};

% 8GB Memory
\addplot[
thick,draw=vintageorange,fill=vintageorange,
]
table[x=x,y=y] {
x y
1 268.877
2 64.408
3 541.616
4 150.532
5 269.597
};

% 16GB Memory
\addplot[
thick,draw=vintageorange,fill=vintageorange,
]
table[x=x,y=y] {
x y
1 266.361
2 64.407
3 447.216
4 114.764
5 259.06
};

% 32GB Memory
\addplot[
thick,draw=vintageorange,fill=vintageorange,
]
table[x=x,y=y] {
x y
1 185.925
2 64.407
3 361.805
4 114.763
5 190.967
};

% \node[anchor=north west,draw=black,align=left,fill=white] at (axis cs: 0.6, 500000) {dataset: \dmv};

% \addlegendentry{STHoles}
\addlegendentry{$M =$ 0}
% \addlegendentry{ISOMER+QP}
\addlegendentry{$M =$ 8GB}
\addlegendentry{$M =$ 16GB}
\addlegendentry{$M =$ 32GB}

% \node[draw=black!50!vintagegreen,fill=white,font=\small,anchor=north east]
%   at (axis cs: 4.8,52) {2400 sec};

\end{axis}
\end{tikzpicture}

\vspace{-2mm}
\caption{Error vs.~Time}
\label{fig:exp:perf:c}
\end{subfigure}

\caption{
Comparison between  and
query-driven histograms. 
The lower, the better.
% The errors are the absolute errors of selectivity estimates in root-mean-square (rms). 
Left: 
The per-query overhead of 
was extremely low. Middle:  was the most accurate for the same time budget.
% \emph{(note: QueryModel's error reached 8,793\% for \insta)}.
Right:  required significantly less time for the same accuracy.
}
% The top row is for the \dmv dataset; the bottom row is for the \insta dataset.
\label{fig:exp:acc}
\end{figure*}

\begin{figure}[t]
\begin{subfigure}[b]{\linewidth}
\centering
\begin{tikzpicture}[scale=0.95]
\begin{scope}[every node/.style={circle,thick,draw,align=center,inner sep=0.1mm}]
    \node[fill=FlagColor] (v1) at (0.5, 0) {\scriptsize  $v_1$\\[-0.3em]\scriptsize 20GB};
    \node[] (v2) at ($(v1) + (-0.5, 1.0)$) {\footnotesize $v_2$\\[-0.3em]\scriptsize 100GB} ;
    \node[fill=FlagColor] (v3) at ($(v2) + (1.0, 0)$) {\footnotesize $v_3$\\[-0.3em]\scriptsize 80GB} ;
    \node[fill=FlagColor] (v4) at ($(v2) + (-0.5, 1.0)$) {\footnotesize $v_4$\\[-0.3em]\scriptsize 80GB};
    \node[fill=FlagColor] (v5) at ($(v4) + (1.0, 0)$) {\scriptsize $v_5$\\[-0.3em]\scriptsize 20GB} ;
    \node[] (v6) at ($(v5) + (1.0, 0)$) {\scriptsize $v_6$\\[-0.3em]\scriptsize 20GB} ;
    \node[] (v7) at ($(v6) + (-0.5, 1.0)$) {\footnotesize $v_7$\\[-0.3em]\scriptsize 100GB} ;
\end{scope}

\begin{scope}[>={Stealth[black]},
              every node/.style={fill=none,circle},
              every edge/.style={draw=black, thick}]
    \path [->] (v1) edge node {} (v2);
    \path [->] (v1) edge node {} (v3);
    \path [->] (v2) edge node {} (v4);
    \path [->] (v2) edge node {} (v5);
    \path [->] (v3) edge node {} (v5);
    \path [->] (v3) edge node {} (v6);
    \path [->] (v6) edge node {} (v7);
\end{scope}

% red path
\begin{scope}[>={Stealth[black]},
              every node/.style={fill=none,circle},
              every edge/.style={draw=ExampleColor2,line cap=round}]
    \node[] (r1) at (-0.1, -0.1) {};
    \node[] (r2) at (1.1, 2.0) {};
    \node[] (r3) at (1.25, 2.3) {};
    \node[] (rx) at (1.25, 2.7) {};
    \node[] (ry) at (1.1, 2.7) {};
    \node[] (rz) at (1.1, 2.5) {};
    \node[] (ra) at (1.1, 2.3) {};
    \node[] (r4) at (0.5, 1.3) {};
    \node[] (r5) at (0.3, 1.5) {};
    \node[] (r6) at (0.3, 1.7) {};
    \node[] (r7) at (0.1, 2.0) {};
    \node[] (r8) at (-0.9, 3.0) {};
    \path [line width = 0.75mm] (r1.south) edge[] node {} (r2.south);
    \path [line width = 0.75mm] (r2.south) edge[bend right = 10] node {} (r3.south);
    \path [line width = 0.75mm] (r3.south) edge[] node {} (rx.south);
    \path [line width = 0.75mm] (rx.south) edge[bend right = 90] node {} (ry.south);
    \path [line width = 0.75mm] (ry.south) edge[] node {} (rz.south);
    \path [line width = 0.75mm] (rz.south) edge[bend left = 20] node {} (ra.south);
    \path [line width = 0.75mm] (ra.south) edge[] node {} (r4.south);
    \path [line width = 0.75mm] (r4.south) edge[bend left = 45] node {} (r5.south);
    \path [line width = 0.75mm] (r5.south) edge[] node {} (r6.south);
    \path [line width = 0.75mm] (r6.south) edge[bend right = 40] node {} (r7.south);
    \path [line width = 0.75mm, arrows={->[ExampleColor2]}] (r7.south) edge node {} (r8.south);
\end{scope}
\node[text=red] (txt1) at (-0.6, 3) {\small DFS} ;

% % red nodes
% \begin{scope}[every node/.style={circle,align=center,fill=ExampleColor2,draw=Redborder, inner sep=0cm, minimum width = 3mm}]
%     \node[] at (0, -0.3) {};
%     \node[] at (0.7, 1.2) {};
%     \node[] at (1.5, 2.9) {};
%     \node[] at (1.4, 4.0) {};
%     \node[] at (0.2, 1.6) {};
%     \node[] at (0, 3) {};
%     \node[] at (-0.8, 3.45) {};
% \end{scope}

% blue path
\begin{scope}[>={Stealth[black]},
              every node/.style={fill=none,circle},
              every edge/.style={draw=ExampleColor1,line cap=round}]
    \node[] (r1) at (1.1, -0.1) {};
    \node[] (r2) at (-0.2, 2.0) {};
    \node[] (r3) at (-0.1, 2.1) {};
    \node[] (r4) at (0.6, 1.4) {};
    \node[] (r5) at (0.8, 1.5) {};
    \node[] (r6) at (0.8, 1.9) {};
    \node[] (r7) at (1.0, 2.1) {};
    \node[] (r8) at (1.1, 2.1) {};
    \node[] (r9) at (1.2, 2.3) {};
    \node[] (r10) at (0.3, 3.4) {};
    \path [line width = 0.75mm] (r1.south) edge[] node {} (r2.south);
    \path [line width = 0.75mm] (r2.south) edge[bend left =75] node {} (r3.south);
    \path [line width = 0.75mm] (r3.south) edge[] node {} (r4.south);
    \path [line width = 0.75mm] (r4.south) edge[bend right = 45] node {} (r5.south);
    \path [line width = 0.75mm] (r5.south) edge[] node {} (r6.south);
    \path [line width = 0.75mm] (r6.south) edge[bend left = 40] node {} (r7.south);
    \path [line width = 0.75mm] (r7.south) edge node {} (r8.south);
    \path [line width = 0.75mm] (r8.south) edge[bend right = 40] node {} (r9.south);
    \path [line width = 0.75mm,arrows={->[ExampleColor1]}] (r9.south) edge node {} (r10.south);
\end{scope}
\node[text=blue] (txt1) at (-0.1, 3.35) {\small \solutionorder} ;

% % blue nodes
% \begin{scope}[every node/.style={circle,align=center,fill=ExampleColor1,draw=Blueborder, inner sep=0cm, minimum width = 3mm}]
%     \node[] at (1, -0.3) {};
%     \node[] at (0.3, 1.1) {};
%     \node[] at (-0.5, 2.9) {};
%     \node[] at (0.7, 1.6) {};
%     \node[] at (1.0, 3.0) {};
%     \node[] at (1.6, 3.3) {};
%     \node[] at (0.7, 4.35) {};
% \end{scope}

\coordinate (dfsr) at (3.5,2.0);
\coordinate (dfsb) at (3.5,0.3);
% labels
\begin{scope}[every node/.style={rectangle,thick, anchor=east}]
    \node[align=right,text=red] (label1) at ($(dfsr) + (3.6, 1.0)$) {\small DFS};
    \node[align=right] (label2) at ($(dfsr) + (0.5, 1.1)$) {\footnotesize Memory usage};
    \node[align=right] (label3) at ($(dfsr) + (0, 0.8)$) {\footnotesize 100GB} ;
    \node[align=right,text=blue] (label4) at ($(dfsb) + (3.6, 1.0)$) {\small \solutionorder};
    \node[align=right] (label5) at ($(dfsb) + (0.5, 1.1)$) {\footnotesize Memory usage};
    \node[align=right] (label6) at ($(dfsb) + (0, 0.8)$) {\footnotesize 100GB} ;
    \node[align=right] (label7) at ($(dfsr) + (3.7, -0.2)$) {\footnotesize Node};
    \node[align=right] (label8) at ($(dfsb) + (3.7, -0.2)$) {\footnotesize Node} ;
\end{scope}
    \node[text=blue] at ($(dfsb) + (0.4, -0.2)$) {\small 1};
    \node[text=blue] at ($(dfsb) + (0.8, -0.2)$) {\small 2};
    \node[text=blue] at ($(dfsb) + (1.2, -0.2)$) {\small 4};
    \node[text=blue] at ($(dfsb) + (1.6, -0.2)$) {\small 3};
    \node[text=blue] at ($(dfsb) + (2.0, -0.2)$) {\small 5};
    \node[text=blue] at ($(dfsb) + (2.4, -0.2)$) {\small 6};
    \node[text=blue] at ($(dfsb) + (2.8, -0.2)$) {\small 7};
    
    \node[text=red] at ($(dfsr) + (0.4, -0.2)$) {\small 1};
    \node[text=red] at ($(dfsr) + (0.8, -0.2)$) {\small 3};
    \node[text=red] at ($(dfsr) + (1.2, -0.2)$) {\small 6};
    \node[text=red] at ($(dfsr) + (1.6, -0.2)$) {\small 7};
    \node[text=red] at ($(dfsr) + (2.0, -0.2)$) {\small 2};
    \node[text=red] at ($(dfsr) + (2.4, -0.2)$) {\small 5};
    \node[text=red] at ($(dfsr) + (2.8, -0.2)$) {\small 4};

% plot lines
\begin{scope}[>={Stealth[black]},
              every node/.style={fill=none,circle},
              every edge/.style={draw=black}]
    \draw[dashed] ($(dfsr) + (0, 0.8)$) -- ($(dfsr) + (3.4, 0.8)$);
    \draw[dashed] ($(dfsb) + (0, 0.8)$) -- ($(dfsb) + (3.4, 0.8)$);
    \draw[] ($(dfsr) + (0.4, 0)$) -- ($(dfsr) + (0.4, -0.05)$);
    \draw[] ($(dfsr) + (0.8, 0)$) -- ($(dfsr) + (0.8, -0.05)$);
    \draw[] ($(dfsr) + (1.2, 0)$) -- ($(dfsr) + (1.2, -0.05)$);
    \draw[] ($(dfsr) + (1.6, 0)$) -- ($(dfsr) + (1.6, -0.05)$);
    \draw[] ($(dfsr) + (2.0, 0)$) -- ($(dfsr) + (2.0, -0.05)$);
    \draw[] ($(dfsr) + (2.4, 0)$) -- ($(dfsr) + (2.4, -0.05)$);
    \draw[] ($(dfsr) + (2.8, 0)$) -- ($(dfsr) + (2.8, -0.05)$);
    \draw[] ($(dfsb) + (0.4, 0)$) -- ($(dfsb) + (0.4, -0.05)$);
    \draw[] ($(dfsb) + (0.8, 0)$) -- ($(dfsb) + (0.8, -0.05)$);
    \draw[] ($(dfsb) + (1.2, 0)$) -- ($(dfsb) + (1.2, -0.05)$);
    \draw[] ($(dfsb) + (1.6, 0)$) -- ($(dfsb) + (1.6, -0.05)$);
    \draw[] ($(dfsb) + (2.0, 0)$) -- ($(dfsb) + (2.0, -0.05)$);
    \draw[] ($(dfsb) + (2.4, 0)$) -- ($(dfsb) + (2.4, -0.05)$);
    \draw[] ($(dfsb) + (2.8, 0)$) -- ($(dfsb) + (2.8, -0.05)$);
    \draw[->] ($(dfsr)$) -- ($(dfsr) + (0, 1.0)$);
    \draw[->] ($(dfsb)$) -- ($(dfsb) + (0, 1.0)$);
    \draw[->] ($(dfsr)$) -- ($(dfsr) + (3.4, 0)$);
    \draw[->] ($(dfsb)$) -- ($(dfsb) + (3.4, 0)$);
\end{scope}

    \node[draw,fill=ExampleColor2,inner sep=0.05cm,anchor=south west,minimum width = 19mm, minimum height = 1.71mm,fill opacity = 0.6,text opacity=1] at ($(dfsr)$) {\scriptsize $v_1$};
    \node[draw,fill=ExampleColor2,inner sep=0.05cm,anchor=south west,minimum width = 19mm, minimum height = 5.1mm,fill opacity = 0.6,text opacity=1] at ($(dfsr) + (0.4,0.25)$) {$v_3$};
    \node[draw,fill=ExampleColor2,inner sep=0.05cm,anchor=south west,minimum width = 3.9mm, minimum height = 1.71mm,fill opacity = 0.6,text opacity=1] at ($(dfsr) + (2.0, 0)$) {\scriptsize $v_5$};
    \node[draw,fill=ExampleColor2,inner sep=0.03cm,anchor=south west,minimum width = 3.8mm, minimum height = 5.1mm,fill opacity = 0.6,text opacity=1] at ($(dfsr) + (2.4, 0)$) {$v_4$};
    \node[draw,dashed,fill=ExampleColor2,inner sep=0.05cm,anchor=south west,minimum width = 7.6mm, minimum height = 1.71mm,fill opacity = 0.6,text opacity=0.5] at ($(dfsr) + (0.8, 0.8)$) {\scriptsize $v_6$};
    \draw [decorate,
    decoration = {brace}] ($(dfsr) + (0.8, 1.1)$) --  ($(dfsr) + (1.6, 1.1)$);
    \node[] at ($(dfsr) + (1.5, 1.3)$) {\scriptsize No space to flag $v_6$};
    
    \node[draw,fill=ExampleColor1,inner sep=0.05cm,anchor=south west,minimum width = 15.2mm, minimum height = 1.71mm,fill opacity = 0.6,text opacity=1] at ($(dfsb)$) {\scriptsize $v_1$};
    \node[draw,fill=ExampleColor1,inner sep=0.03cm,anchor=south west,minimum width = 3.8mm, minimum height = 5.1mm,fill opacity = 0.6,text opacity=1] at ($(dfsb) + (0.8, 0.25)$) {$v_4$};
    \node[draw,fill=ExampleColor1,inner sep=0.05cm,anchor=south west,minimum width = 3.8mm, minimum height = 1.71mm,fill opacity = 0.6,text opacity=1] at ($(dfsb) + (1.6, 0)$) {\scriptsize $v_5$};
    \node[draw,fill=ExampleColor1,inner sep=0.03cm,anchor=south west,minimum width = 11.4mm, minimum height = 5.1mm,fill opacity = 0.6,text opacity=1] at ($(dfsb) + (1.2, 0.25)$) {$v_3$};
    \node[draw,dashed,fill=ExampleColor1,inner sep=0.05cm,anchor=south west,minimum width = 7.6mm, minimum height = 1.71mm,fill opacity = 0.6,text opacity=0.5] at ($(dfsb) + (2.0, 0)$) {\scriptsize $v_6$};
    \draw[->] ($(dfsb) + (2.6, -0.3)$) -- ($(dfsb) + (2.6, -0.1)$);
    \node[anchor = north, align=center] at ($(dfsb) + (1.5, -0.25)$) {\scriptsize By freeing $v_3$ early we can also flag $v_6$};
    
\node[align=center] (yy) at (2.0, 0) {\footnotesize Flagged\\[-0.3em]\footnotesize node};
\node[draw,circle, fill=FlagColor,inner sep=0.05cm,minimum width = 3mm,text opacity=1] at (1.3, 0.15) {};

\end{tikzpicture}
\end{subfigure}
\vspace{-4mm}
\caption{Intuition behind \solutionorder. Tie-breaking is performed when deciding to schedule $v_2$ or $v_3$ first. \solutionorder correctly schedules $v_2$ first, enabling further speedup by allowing $v_6$ to be flagged. This is not guaranteed under an execution order produced by DFS with random tie-breaking.}
\label{fig:dfs}
\vspace{-4mm}
\end{figure}

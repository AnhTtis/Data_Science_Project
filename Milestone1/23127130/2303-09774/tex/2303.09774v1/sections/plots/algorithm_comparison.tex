%!TEX root = main.tex

\begin{figure}[t]

\begin{subfigure}[b]{0.48\linewidth}
\centering

\begin{tikzpicture}
\pgfplotstableread{ % Read the data into a table macro
Method M1 M2 M3 M4 M5 M6 M7
\textbf{MKP+DFS'(ours)} 0 0 0 0 0 0 934.20
MKP+separator 0 0 0 0 0 1020.82 0
MKP+SA 0 0 0 0 1018.83 0 0
Ratio+DFS' 0 0 0 950.14 0 0 0
Greedy+DFS' 0 0 988.05 0 0 0 0
Random+DFS' 0 953.87 0 0 0 0 0
No+optimization 1528 0 0 0 0 0 0
}\datatable

\begin{axis}[
legend style={ legend columns=3,
                                at={(-0.2,1.1)},anchor=south west,
                                column sep=0mm},
    legend style={font=\scriptsize},
    width=45mm,
    height=28mm,
    bar width=1.5mm,
    xlabel={Time (s)},
    ylabel={Method},
    label style={font=\footnotesize},
    tick label style={font=\footnotesize},
    xlabel style={yshift = 1ex},
    axis y line*=none,
    axis x line*=none,
    xbar stacked,   % Stacked horizontal bars
    xmin=800,
    xmax=1600,% Start x axis at 0
    xtick={800, 1000, ..., 1600},
    ymin=-1,
    ytick=data,     % Use as many tick labels as y coordinates
    yticklabels={,,},  % Get the labels from the Label column of the \datatable
    /tikz/every even column/.append style={column sep=3mm},
]

% \draw[fill=white,draw=white] (axis cs: 1080, 5.5) -- (axis cs: 1090, 6.5) -- (axis cs: 1095, 6.5) -- (axis cs: 1085, 5.5) -- cycle;
%     \draw[draw=black,ultra thick] (axis cs: 1080, 5.5) -- (axis cs: 1090, 6.5);
%     \draw[draw=black,ultra thick] (axis cs: 1085, 5.5) -- (axis cs: 1095, 6.5);
%     \node[anchor=south west] at (axis cs: 1070, 3.5) {1528s};
    
\addplot [NoOptColor,fill=NoOptColor,x tick label style={xshift=-0.3cm}] table [x=M1, y expr=\coordindex] {\datatable};    % Plot the "First" column against the data index
\addlegendentry[]{No Opt};

\addplot [RandomColor,fill=RandomColor,x tick label style={xshift=-0.3cm}]table [x=M2, y expr=\coordindex] {\datatable};
\addlegendentry[]{\random + \solutionorder};

\addplot [GreedyColor,fill=GreedyColor,x tick label style={xshift=-0.3cm}] table [x=M3,y expr=\coordindex] {\datatable};
\addlegendentry[]{\greedy + \solutionorder};

\addplot [HeuristicColor,fill=HeuristicColor,x tick label style={xshift=-0.3cm}] table [x=M4,y expr=\coordindex] {\datatable};
\addlegendentry[]{\ratioshort + \solutionorder};

\addplot [SAColor,fill=SAColor,x tick label style={xshift=-0.3cm}] table [x=M5,y expr=\coordindex] {\datatable};
\addlegendentry[]{\solutionnodes + \simulatedannealing};

\addplot [SeparatorColor,fill=SeparatorColor,x tick label style={xshift=-0.3cm}] table [x=M6,y expr=\coordindex] {\datatable};
\addlegendentry[]{\solutionnodes + \separator};

\addplot [black,fill=SCColor,x tick label style={xshift=-0.3cm}] table [x=M7,y expr=\coordindex] {\datatable};
\addlegendentry[]{\textbf{\solutionnodes + \solutionorder (Ours)}};

\end{axis}
    
\end{tikzpicture}
\vspace{-7mm}
\caption{\footnotesize \tpcds(1.6$\%$ \memory)}
\label{fig:algorithm_a}
\end{subfigure}
\hfill
\vspace{-1mm}
\begin{subfigure}[b]{0.48\linewidth}
\centering

\begin{tikzpicture}
\pgfplotstableread{ % Read the data into a table macro
Method M1 M2 M3 M4 M5 M6 M7
\textbf{MKP+DFS'(ours)} 0 0 0 0 0 0 340.70
MKP+separator 0 0 0 0 0 420.48 0
MKP+SA 0 0 0 0 358.05 0 0
Ratio+DFS' 0 0 0 403.59 0 0 0
Random+DFS' 0 0 351.86 0 0 0 0
Greedy+DFS' 0 358.55 0 0 0 0 0
No+optimization 700 0 0 0 0 0 0
}\datatable

\begin{axis}[
legend style={ legend columns=7,
                                at={(-0,1.1)},anchor=south west,
                                column sep=0.1cm},
    legend style={font=\scriptsize},
    width=45mm,
    height=28mm,
    bar width=1.5mm,
    xlabel={Time (s)},
    ylabel={Method},
    label style={font=\footnotesize},
    tick label style={font=\footnotesize},
    xlabel style={yshift = 1ex},
    axis y line*=none,
    axis x line*=none,
    xbar stacked,   % Stacked horizontal bars
    xmin=200,
    xmax=700,% Start x axis at 0
    ymin=-1,
    ytick=data,     % Use as many tick labels as y coordinates
    yticklabels={,,},  % Get the labels from the Label column of the \datatable
]

% \draw[fill=white,draw=white] (axis cs: 480, 5.5) -- (axis cs: 490, 6.5) -- (axis cs: 495, 6.5) -- (axis cs: 485, 5.5) -- cycle;
%     \draw[draw=black,ultra thick] (axis cs: 480, 5.5) -- (axis cs: 490, 6.5);
%     \draw[draw=black,ultra thick] (axis cs: 485, 5.5) -- (axis cs: 495, 6.5);
%     \node[anchor=south west] at (axis cs: 470, 3.5) {700s};
    
\addplot [NoOptColor,fill=NoOptColor,x tick label style={xshift=-0.3cm}] table [x=M1, y expr=\coordindex] {\datatable};    % Plot the "First" column against the data index

\addplot [RandomColor,fill=RandomColor,x tick label style={xshift=-0.3cm}]table [x=M2, y expr=\coordindex] {\datatable};

\addplot [GreedyColor,fill=GreedyColor,x tick label style={xshift=-0.3cm}] table [x=M3,y expr=\coordindex] {\datatable};

\addplot [HeuristicColor,fill=HeuristicColor,x tick label style={xshift=-0.3cm}] table [x=M4,y expr=\coordindex] {\datatable};

\addplot [SAColor,fill=SAColor,x tick label style={xshift=-0.3cm}] table [x=M5,y expr=\coordindex] {\datatable};

\addplot [SeparatorColor,fill=SeparatorColor,x tick label style={xshift=-0.3cm}] table [x=M6,y expr=\coordindex] {\datatable};

\addplot [black,fill=SCColor,x tick label style={xshift=-0.3cm}] table [x=M7,y expr=\coordindex] {\datatable};

\end{axis}
\end{tikzpicture}
\vspace{-2.3mm}
\caption{\footnotesize \tpcdsdate(.8$\%$ \memory)}
\label{fig:algorithm_b}
\end{subfigure}
\vspace{1mm}
\caption{
Comparison between different methods for solving \optimizationproblem on the 100GB datasets. 
% When the problem is of significant complexity, with intermediate tables of large size relative to size of spare memory, 
Our solution (\solutionnodes + \solutionorder) outperforms ablated methods by saving up to an additional 3\%--11\% of workload execution time.
}
\vspace{-4mm}
\label{fig:algorithm}
\end{figure}

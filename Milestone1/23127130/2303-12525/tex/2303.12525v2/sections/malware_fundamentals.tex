\section{Malware Fundamentals}
\label{sec:malware_basics}

Categorizing malware is difficult because of its growing complexity and diverse properties. Yet, creating a malware taxonomy provides valuable insights into understanding it better. Before exploring the fundamentals of malware operation, let us define a set of keywords commonly used to describe different malware categories \cite{McGraw_Morrisett_2000,Christodorescu_2007}:

\begin{itemize}
	\item \textbf{Virus}: malicious code with the capability of inserting itself into other programs;
 	\item \textbf{Worm}: malicious code that propagates similarly to viruses but does not require a target software to replicate, often exploiting connectivity such as emails;
	\item \textbf{Trojan horse}: malicious code that masquerades as a useful program;
	\item \textbf{Spyware}: malicious code secretly installed into an information system to transmit private user data to an external entity;
	\item \textbf{Adware}: malicious code that displays computer advertisements, primarily aiming for financial benefits;
	\item \textbf{Ransomware}: malicious code that denies access to a userâ€™s data, usually by encrypting it until a ransom is paid;
	\item \textbf{Backdoor}: malicious code that opens systems to external entities by subverting local security policies to allow remote access and control over a network;
	\item \textbf{Keylogger}: malicious code designed to record keystrokes, used to obtain passwords or encryption keys to bypass security measures;
	\item \textbf{Botnet}: a network of infected computers controlled by a remote criminal;
	\item \textbf{Rootkit}: malicious application attackers use to conceal their activities and maintain control over a host.
\end{itemize}

Organizations like NIST \cite{NIST_Glossary_2023} and ENISA \cite{ENISA_Botnets_2023} recognize these malware types. In literature, three common properties describe malware: (i) propagation method, categorizing based on spread and purpose; (ii) concealment strategy, focusing on hiding tactics against users and detection; and (iii) data structure manipulation, dealing with software vulnerability exploitation. Table \ref{tab:classifiers_analysis} organizes malware based on these categories.

\begin{table*}[hbt]
 \centering
\caption{Malware categories based on propagation method, concealment strategy, and data structure manipulation.}\label{tab:malware_classification}
\begin{tabular}{lccc}
\toprule
\textbf{Malware Type} & \textbf{Propagation Method} & \textbf{Concealment Strategy} & \textbf{Data Structure Manipulation} \\
\midrule\\
\rowcolor{shadecolor}
Worms & Network-based transmission & Polymorphisms or metamorphism & Exploitation of memory corruption vulnerabilities \\
\midrule
Viruses & File-based transmission & Polymorphism & Manipulation of data structures \\
\midrule
\rowcolor{shadecolor}
Trojans & Social engineering & No concealment & - \\
\midrule
Spyware & Internet downloads & Encryption & - \\
\midrule
\rowcolor{shadecolor}
Ransomware & Email attachments & Encryption & File system manipulation \\
\midrule
Adware & Software bundling & No concealment & - \\
\midrule
\rowcolor{shadecolor}
Rootkits & Kernel-level exploits & Obfuscation & Manipulation of system structures \\
\midrule
Backdoors & Remote access & Encryption & - \\
\midrule
\rowcolor{shadecolor}
Keyloggers & Phishing, infected software & Encryption & - \\
\midrule
Botnets & Exploitation, social engineering & Encryption and polymorphism & - \\
\bottomrule
\end{tabular}
\end{table*}

Regarding concealment strategy, malware can be categorized into two main groups: (i) no concealment and (ii) stealthy malware \cite{Aycock_2010,You_Yim_2010,Rad_2012}. No concealed malicious code lacks techniques to hide itself, making it easy to detect. However, as shown in Table \ref{tab:malware_classification}, only a small subset of malware does not employ concealment. File infectors like traditional viruses or worms may not heavily focus on concealment, spreading by attaching to executable files. Adware may not invest heavily in hiding and may rely on user interactions. Similarly, if achieved without sophisticated evasion, simple trojans may prioritize their primary goal over concealment.

Conversely, stealthy malware is a general term for all kinds of malicious code capable of hiding from users and detection mechanisms \cite{Stolfo_2007, Rudd_2017}. Its primary purpose is to remain undetected for an extended period in the computing system, allowing compromising computers and stealing information before a suitable detection mechanism can be deployed to protect against it. In general, the concealment actions aim to hide the malware's trails or code. Stealthy malware may employ several techniques:

\begin{itemize}
    \item \textbf{Encryption/obfuscation}: the oldest and simplest technique consists of a decryptor and an encrypted main body. When the infected file runs, the decryptor recovers the main body. The malware may use a different key for each infection to hide its signature, making the encrypted part unique. The decryptor small size compared to the main body reduces detection probability. Encryption complexity ranges from basic operations to strong encryption methods \cite{Aycock_2010,You_Yim_2010, Nadim:2021aa};
    
    \item \textbf{Oligomorphism and polymorphism}: the encryption technique limitation lies in the constant decryptor across exploitations, enabling detection based on code patterns. Oligomorphism employs a small set of decryptors, using a different one for each infection. Polymorphism, similar but with theoretically infinite decryptor variations, relies on obfuscation methods like dead-code insertion and register reassignment for distinct decryptor creation \cite{Aycock_2010,You_Yim_2010,Wong_Stamp_2006,Konstantinou_2008};
    
    \item \textbf{Metamorphism}: the binary sequence is altered by making a new malware version for each new infection through a mutation engine. The mutation engine uses code transforming and obfuscation to change the malicious code \cite{Aycock_2010,You_Yim_2010,Brezinski_2023}.
 \end{itemize}

Several classes of software vulnerabilities can be explored to perform security attacks. This paper focuses on the prevalent memory errors enabling memory corruption for security attacks \cite{Van_der_Veen_2012}, which lead to two main exploit categories: control-flow attacks and data-only attacks.

Control-flow attacks are common, easy to construct, and demand minimal application-specific knowledge. They exploit vulnerabilities like buffer overflows or injection attacks to redirect the program's execution flow, enabling arbitrary code execution \cite{Demme_2013, Khasawneh_2015, Ozsoy_2015, Tang_2014, Wang_Karri_2013}. Techniques such as code injection \cite{Ray_Ligatti_2012}, \gls{ROP} \cite{Prandini_Ramilli_2012}, or \gls{JOP} \cite{Bletsch_2011} divert execution to specific memory locations housing malicious code, bypassing standard security measures.

In contrast, data-only attacks are rarer, subtler, and require advanced knowledge of program semantics. They manipulate critical data while maintaining a valid control flow, compromising target programs without injecting additional code. These attacks alter essential data elements, such as identification or configuration data, influencing target application behaviors during runtime \cite{Chen_2005}.
\section{Numerical approximation}\label{sec:approximation}

In this section we discuss the numerical approximation of Problem
\ref{eq:model},
detailing the strategies adopted to represent the mixed-dimensional objects in
an efficient and effective way.

We start by considering each object separately and, in Subsection
\ref{subsec:coupling}, we discuss their coupling. By substituting the
constitutive equations of Problem \ref{eq:model} into their respective
conservation equation, we obtain a problem in primal form in terms only of the electric
potentials and $j_\lambda$ and $j_{\gamma_i}$. Being $\Upsilon$, $\lambda$ and $\gamma_i$ objects of dimension 3,
2 and 1, respectively, we construct a simplicial grid composed of tetrahedra for
$\Upsilon$, triangles for $\lambda$ and segments for each electrode $\gamma_i$.
For their construction we rely on Gmsh \cite{Geuzaine2009}; more details
are given in Subsection \ref{subsec:grid}.

For the numerical approximation of the
problem, we consider two finite-volume cell-centered schemes normally used in
the context of flows in porous media and other elliptic problems: the
two-point flux approximation (TPFA) as presented in \cite{Aavatsmark2007a}
and the multi-point flux approximation (MPFA) as introduced in
\cite{Aavatsmark2007,Aavatsmark2002}. Both schemes have one degree of freedom
for each cell but different stencils. TPFA is consistent only for the so called
$k$-orthogonal grids,
which are grids
where the faces normals and the connecting lines between the centers of neighboring
cells are orthogonal with respect to the inverse of the diffusion coefficient.
Moreover, TPFA
is very efficient in the construction and solution of the associated linear
problem. MPFA is more expensive but it is convergent for simplicial grids, with
only weak regularity requirements on the mesh \cite{Aavatsmark2007,Aavatsmark2002}.
We will test in Section \ref{sec:experiments} the performance of both
methods with respect to laboratory experiments.

\subsection{Coupling between dimensions}\label{subsec:coupling}

A key aspect in the numerical approximation of Problem \ref{eq:model} is the
actual implementation of the coupling conditions between the electrodes, or the
liner, and $\Upsilon$. We consider the approach  presented in
\cite{Nordbotten2018,Keilegavlen2020}, where new grids, called mortar grids, are constructed to handle
the coupling between dimensions. In particular, since $j_\lambda$ is defined on
both sides of the liner and couples it with the surrounding domain, we construct
two mortar grids that put in communication $\lambda$ with $\Upsilon$. In
principle, these grids may be non-conforming and transfer operators
between them need to be constructed that are not, in general, identity maps. To keep our presentation simple, we
consider only conforming approximations, see \cite{Nordbotten2018,Keilegavlen2020} for more
details for the non-conforming case.

Since the electrodes are mono-dimensional, and smaller than any other objects present
in the problem, to increase the flexibility of the proposed approach, we have
considered for them a non-matching discretization meaning that each segment
composing $\gamma_i$ is immersed in some of the tetrahedra of the $\Upsilon$ grid.
A single mortar grid, for each
$\gamma_i$, is
constructed for the coupling. In this case, transfer operators between
$\Upsilon$, $\gamma_i$ and the mortar grid are accordingly constructed to map
variables and then discretize the coupling condition \eqref{eq:varsigma_electrde}. In this case, $j_{\gamma_i}$ is
the variable defined on the mortar grid that connects $\gamma_i$ with $\Upsilon$.

An example of discretized problem is reported in Figure \ref{fig:grid_coupling}, where the liner is
approximated with the green grid and the two mortar grids surrounding it are in
transparent light green. At the  top of the domain, in red, a set of four electrodes
is represented as non-matching with the grid of $\Upsilon$.
\begin{figure}[tb]
    \centering
    \includegraphics[width=0.75\textwidth]{fig/grid}%
    \caption{Example of computational grid constructed for the approximation of
    the problem. The different objects are separated to make the visualization clearer.}
    \label{fig:grid_coupling}
\end{figure}

\subsection{Construction of the computational grid}\label{subsec:grid}

Another important task in the discretization is to guide the gridding tool to create
appropriate grids, \cite{Aavatsmark2007,Aavatsmark2002}, and thus limit the
numerical error introduced. As discussed before,
the grid of the liner is conforming with the surrounding domain, however the
electrodes are assumed to be immersed in the cells of $\Upsilon$. The presented approach is
more effective when the electrodes are inserted in the centre of the cells, far
from their edges.
To match this condition, our approach is to construct a-priori a set of cells surrounding the electrodes
and force the gridding tool to include them in the construction of the grid. The
error introduced by the non-conforming approximation is thus minimised and the
procedure is fully automatized. Figure \ref{fig:geometry} shows the geometry
given to the gridding  tool to construct the full three-dimensional grid. On the
top of the domain, each of the four electrodes
is immersed in a wedge discretized with three tetrahedra.
\begin{figure}[tb]
    \centering
    \resizebox{0.55\textwidth}{!}{\fontsize{1cm}{2cm}\selectfont\input{fig/geometry.pdf_tex}}%
    \hspace*{0.125\textwidth}%
    \raisebox{0.035\textwidth}{\includegraphics[width=0.15\textwidth]{fig/electrode_tetra}}%
    \hspace*{0.025\textwidth}%
    \raisebox{0.035\textwidth}{\includegraphics[width=0.15\textwidth]{fig/electrode_shrinked}}%
    \caption{Graphical representation of the domain $\Upsilon$, the liner
    $\lambda$ in blue and the electrodes $\gamma_i$ in red. The different groups
    of green tetrahedra
    are associated to each electrodes. On the right, a detail on the construction
    of cells around an electrode.}
    \label{fig:geometry}
\end{figure}

Finally, to detect which cell of $\Upsilon$ intersects each electrode segment,
we have considered a fast algorithm based on an alternating digital tree
(ADT), see \cite{Bonet1991,Thompson1998} for more details. Once these cells are identified, the maps
between them and the intersected electrodes segments are constructed. In general,
these are not identity maps.

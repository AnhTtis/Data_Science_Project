\section{Discretization}    \label{sec:disc}

In this section the discretization approaches used to compute inviscid and viscous fluxes are detailed. The MEG6/MIG4 algorithm of Chamarthi \cite{chamx}, the HLLC Riemann solver, and the $\alpha$-damping approach are explained in the context of generalized curvilinear coordinates with applicability to both stationary and moving grids.

\subsection{Inviscid flux discretization - MEG6 and MIG4 schemes}    \label{Inv-disc}
Monotonocity preserving Explicit sixth order Gradient scheme (MEG6) and the Monotonocity Preserving Implicit 4th order Gradient scheme (MIG4) proposed by Chamarthi \cite{chamx} are a class of gradient-based algorithms to discretize inviscid flux terms in the compressible Navier-Stokes equations. They are primarily driven by the gradients of primitive variables ($\mathbf{P}_{\xi},\mathbf{P}_{\eta}$, and $\mathbf{P}_{\zeta}$) and the Monotonicity Preserving limiter of Suresh and Huynh \cite{suresh1997accurate} for shock capturing. For interpolating the variables to the half locations, the following general form containing the functional values and their corresponding first and second derivatives at cell centers is employed \cite{van1977towards}:

\begin{equation}
   \phi(\xi)=\phi_i+\left( \frac{\partial \phi}{\partial \xi} \right)_i \left(\xi-\xi_i\right)+3 \kappa \left( \frac{\partial^2 \phi}{\partial \xi^2} \right)_i\left[\left(\xi-\xi_i\right)^2-\frac{\Delta \xi_i^2}{12}\right] \quad \text{for} \quad \xi_{i-\frac{1}{2}} \le \xi \le \xi_{i+\frac{1}{2}}
\end{equation}

where $\phi$ is the variable of interest to be interpolated and $\kappa=\frac{1}{3}$ \cite{van1977towards}. Since the above formulation contains functional values and its derivatives that are belonging to location $i$, by substituting $\xi = \pm \frac{\Delta \xi}{2}$ the left ($L$) and right ($R$) biased interpolation formulae for $\phi$ at locations $i+\frac{1}{2}$ and $i-\frac{1}{2}$ are obtained. Simplifying the resulting equations with $\Delta \xi =1$ (since unit grid spacing convention is followed for transformed coordinates) yields the following left and right biased states of $\phi$ at $i+\frac{1}{2}$ location.

\begin{equation} \label{vanleer-poly}
    \begin{aligned}
&\phi_{i+\frac{1}{2}}^L= \phi_i+\frac{1}{2} \left( \frac{\partial \phi}{\partial \xi} \right)_i+\frac{1}{12} \left( \frac{\partial^2 \phi}{\partial \xi^2} \right)_i \\
&\phi_{i+\frac{1}{2}}^R= \phi_{i+1}-\frac{1}{2} \left( \frac{\partial \phi}{\partial \xi} \right)_{i+1}+\frac{1}{12} \left( \frac{\partial^2 \phi}{\partial \xi^2} \right)_{i+1}
\end{aligned}
\end{equation}

The above two polynomials are used to reconstruct the variables in MEG6 and MIG4 schemes. The two methods MEG6 and MIG4 differ from each other only in the scheme that is used to compute the derivatives of primitive variables present in the above equations (Eqn. \ref{vanleer-poly}); the rest of the algorithm (which will be detailed soon) remains the same. Despite the different gradients employed, both MEG6 and MIG4 schemes yield fourth-order accurate estimates of inviscid flux derivatives $\frac{\partial \mathbf{\hat{F}}}{\partial \xi}, \frac{\partial \mathbf{\hat{G}}}{\partial \eta}$, and $\frac{\partial \mathbf{\hat{H}}}{\partial \zeta}$. The theoretical details regarding order of accuracy can be found in Ref. \cite{chamx}. The schemes however differ in their dispersion and dissipation properties. Readers are referred to Fig. 3 of Ref. \cite{chamx} which shows the spectral properties of MEG6 and MIG4 schemes in comparison with other well known discretization approaches.

Fig. \ref{inv_algo} depicts a flow chart view of different steps in computing the inviscid flux residual at half locations. A detailed step-by-step procedure is shown. For simplicity, the procedure is described for $\mathbf{F}_{i+\frac{1}{2}}$ fluxes only. Extending the same to other directions is straightforward. Also, for the sake of simplicity the `$j$' and `$k$' subscripts corresponding to $\eta$ and $\zeta$ directions are omitted in all the expressions to be presented now; the formulations remain the same and are independent of `$j$' and `$k$' indices. \\

% MEG6 uses the standard sixth-order explicit gradients computed using Eqn. \ref{E6_grads}. On the other hand, MIG4 uses a fourth-order implicit scheme as per Eqn. \ref{IG4_grads} with $\alpha=\frac{5}{14}$.

\begin{figure}[h!]
    \centering
    \includegraphics[width=140mm]{Images/inviscid_algo.pdf}
    \caption{Various stages while estimating inviscid flux residual using the MEG/MIG schemes.}
    \label{inv_algo}
\end{figure}

\noindent \textbf{Step-1, Compute gradients:} Compute first and second gradients of primitive variables $\mathbf{P}=[\rho,u,v,w,p]^T$ at cell centers in the computational coordinate system using the following expressions:

\begin{equation}\label{E6_grads}
    \text{For MEG6:}\quad \left(\frac{\partial u}{\partial \xi}\right)_i = \frac{3}{4}\left( u_{i+1} + u_{i-1}\right) - \frac{3}{20}\left(u_{i+2} + u_{i-2}  \right) + \frac{1}{60}\left(u_{i+3} + u_{i-3}  \right)
\end{equation}

\begin{equation}\label{IG4_grads}
    \text{For MIG4:}\quad \alpha \left(\frac{\partial u}{\partial \xi}\right)_{i-1} + \left(\frac{\partial u}{\partial \xi}\right)_{i} + \alpha \left(\frac{\partial u}{\partial \xi}\right)_{i+1} = \frac{2 (2 + \alpha)}{6}\left( u_{i+1} + u_{i-1}\right) + \frac{-1+4 \alpha}{12}\left(u_{i+2} + u_{i-2} \right)
\end{equation}

\begin{equation}
    \text{For both MEG6 and MIG4:}\quad \left(\frac{\partial^{2} u}{\partial \xi^{2}}\right)_{i}=2\left(\hat{u}_{i+1}-2 \hat{u}_{i}+\hat{u}_{i-1}\right)-0.5\left(u_{i+1}^{\prime}-u_{i-1}^{\prime}\right)
\end{equation}

$\alpha=\frac{5}{14}$ is considered for the implicit scheme in Eqn.\ref{IG4_grads}. The above mentioned explicit sixth-order (E6) gradients are used for the MEG6 scheme, and implicit gradients of fourth-order (IG4) are used for the MIG4 scheme.\\

\noindent \textbf{Step-2, Perform characteristic transformation:} The cell center primitive variables $\mathbf{P}=[\rho,u,v,w,p]^T$, their first derivatives, $\frac{\partial \mathbf{P}}{\partial \xi}$ and second derivatives, $\frac{\partial^2 \mathbf{P}}{\partial \xi^2}$ are transformed into characteristic space $\mathbf{W}$, $\frac{\partial \mathbf{W}}{\partial \xi}$ and, $\frac{\partial^2 \mathbf{W}}{\partial \xi^2}$ by multiplying them with the left-eigenvectors of the flux Jacobian matrix, $\frac{\partial \mathbf{F}}{\partial \mathbf{P}}$, using the following relations Eqn. \ref{forward-projection}. Reconstructing the resulting characteristic variables will result in cleaner results without any oscillations near the discontinuities. This is since the Euler equations resemble linear wave equation in characteristic form for which the up-winding in the Riemann solver is designed for (will be discussed in Sec. \ref{sec:riemann-solver}).

\begin{subequations} \label{forward-projection}
    \begin{gather}
    \mathbf{W} = \overline{\mathbf{R}}_{\xi}^{-1} \mathbf{P}, \quad
    \frac{\partial \mathbf{W}}{\partial \xi}     = \overline{\mathbf{R}}_{\xi}^{-1}  \frac{\partial \mathbf{P}}{\partial \xi}, \quad \text{and }
    \frac{\partial^2 \mathbf{W}}{\partial \xi^2} = \overline{\mathbf{R}}_{\xi}^{-1} \frac{\partial^2 \mathbf{P}}{\partial \xi^2}
    \tag{\theequation a-\theequation c}
    \end{gather}
\end{subequations}

\noindent The eigenvector matrices employed in these equations are provided in \ref{app:Eig-structure}.\\

\noindent \textbf{Step-3, Compute left and right biased states of $\mathbf{W}$:} Evaluate the unlimited left and right biased states of characteristic variables at half locations employing Eqns. \ref{vanleer-poly}. Fig. \ref{recon} illustrates the location of these quantities on the interpolation stencil.

\begin{eqnarray} \label{legendre_polys}
    \left(\mathbf{W}_{i+1/2}^L\right)_{unlimited} = \mathbf{W}_{i} + \frac{1}{2} \left(\frac{\partial \mathbf{W}}{\partial \xi}\right)_{i} + \frac{1}{12} \left(\frac{\partial^2 \mathbf{W}}{\partial \xi^2}\right)_{i} \\
    \left(\mathbf{W}_{i+1/2}^R\right)_{unlimited} = \mathbf{W}_{i+1} - \frac{1}{2} \left(\frac{\partial \mathbf{W}}{\partial \xi}\right)_{i+1} + \frac{1}{12} \left(\frac{\partial^2 \mathbf{W}}{\partial \xi^2}\right)_{i+1} 
\end{eqnarray}

\begin{figure}[h!]
    \centering
    \includegraphics[width=50mm]{Images/reconstruct.pdf}
    \caption{An illustration depicting left and right biased states of $W$ on the grid stencil.}
    \label{recon}
\end{figure}

\noindent \textbf{Step-4, Modify $\mathbf{W}_{i+1/2}^{L,R}$ through limiting:} An improved version of the Monotonicity Preserving fifth order limiting algorithm (MP5) \cite{suresh1997accurate} (see \ref{app:MP-limit}) proposed in Ref. \cite{chamx} is employed to check for discontinuities and limit the left and right reconstructed states of the characteristic variables ($\mathbf{W}_{i+1/2}^{L,R}$). This step essentially captures flow discontinuities by limiting the interpolated unlimited value from the previous step and avoids unphysical oscillations. One of the key favourable attributes of the MP5 limiter is that it allows an effective capturing of shock and acoustic waves simultaneously compared to the WENO based strategies \cite{Shu1997}. The limiting procedure is detailed in \ref{app:MP-limit}.

% The limiting procedure is detailed in Ref. \cite{chamx} and is being skipped here to avoid repetition and maintain brevity.\\

\noindent \textbf{Step-5, Map characteristic variables back to primitive variables:} The reconstructed left and right characteristic variable states computed in the previous step are now transformed back to primitive variables by multiplying them with the right-eigenvector matrices provided in \ref{app:Eig-structure}. 

\begin{subequations} \label{rev-projection}
    \begin{gather}
    (\mathbf{P}^L)_{i+1/2} = \overline{\mathbf{R}}_{\xi} (\mathbf{W}^L_{i+1/2})_{limited} \\
    (\mathbf{P}^R)_{i+1/2} = \overline{\mathbf{R}}_{\xi} (\mathbf{W}^R_{i+1/2})_{limited}
    \end{gather}
\end{subequations}

\noindent \textbf{Step-6, Compute interface fluxes:} Now that the flow states on both sides of the interface are known, the mathematical setting at each $i+\frac{1}{2}$ location reduces to a Riemann problem. In this step, the local one-dimensional Riemann problem is solved, and the resultant flux $\textbf{F}_{i+\frac{1}{2}}$ is estimated at each interface. The HLLC approximate riemann solver (Harten–Lax–van Leer with Contact restoration) \cite{toro2009riemann} is employed to estimate the fluxes in the present work. As shown in Eqn. \ref{hllc-function}, the only inputs required in order to compute the fluxes using the HLLC approach are the local left and right reconstructed states of the primitive variables and the interpolated metric terms at the $i+\frac{1}{2}$ locations. The required relations to compute the fluxes via the HLLC Riemann solver in the context of curvilinear coordinates is provided in a dedicated section on Riemann solvers in Section \ref{sec:riemann-solver}.

\begin{equation} \label{hllc-function}
    \hat{\mathbf{F}}_{i+\frac{1}{2}} = \mathbf{f}_{HLLC} \left\{ \mathbf{P}^L_{i+\frac{1}{2}}, \mathbf{P}^R_{i+\frac{1}{2}}, (\hat{\xi}_t)_{i+\frac{1}{2}}, (\hat{\xi}_x)_{i+\frac{1}{2}}, (\hat{\xi}_y)_{i+\frac{1}{2}}, (\hat{\xi}_z)_{i+\frac{1}{2}} \right\}
\end{equation}

% \begin{equation}
%     (\mathbf{P}^L)_{i+1/2}, (\mathbf{P}^R)_{i+1/2}  \xrightarrow{\quad \text{Riemann solver (section \ref{sec:riemann-solver})} \quad} \boldsymbol{F}_{i+\frac{1}{2}}
% \end{equation} \\

% Based on the local wave speeds, the Riemann solver essentially estimates some kind of upwinded solution at each interface.

% The reconstructed left and right biased primitive variables are sent to the HLLC Riemann solver routine to compute the final upwinded fluxes at the interfaces.

\noindent \textbf{Step-7, Compute residual:} Using the interface fluxes estimated through the Riemann solver, the net flux entering into each cell is computed via Eqn. \ref{res-inv}. It should be noted that if the flow problem is linear in nature, the accuracy of this term theoretically yields fourth-order using both E6 and IG4 gradients in step-1 (Eqns. \ref{E6_grads} and \ref{IG4_grads}). More theoretical details including demonstrative tests regarding the order of accuracy can be found in \cite{chamx}. \\

\begin{equation} \label{res-inv}
    \left(\frac{\partial \boldsymbol{F}}{\partial \xi}\right)_i = \frac{ \boldsymbol{F}_{i+\frac{1}{2}}- \boldsymbol{F}_{i-\frac{1}{2}}}{\Delta \xi}
\end{equation}

% Contrary to the conventional LES where the effect of sub-grid-scale (SGS) flow features is approximated using an explicit SGS model (that adds dissipation to filter out the large eddies) \cite{mathew2003explicit}, the present algorithm solves the unfiltered Navier-Stokes equations directly and utilizes the numerical dissipation of the MEG6 and MIG4 schemes to implicitly mimic the effect of SGS models. Such an approach is popularly termed `implicit-LES' or specifically in the present case `Mononically integrated Implicit LES (MILES)' \cite{fureby1999monotonically}, since the MP5 algorithm adapted in the MEG6/MIG4 schemes is high resolution and monotonocity preserving.


% The current approach is featured by high-resolution solutions that are also stable and monotonically converge with grid refinement (this will be demonstrated in section \ref{sec:JNapplication}), as a result, the authors believe that the current approach possess the required capabilities to be treated as an implicit-LES flow solver. This argument is further strengthened in section \ref{sec:results}, by comparing and validating the computed flow solutions with the experimental measurements.

\input{sections/riemann_solvers}
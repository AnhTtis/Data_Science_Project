
\section{Freestream preservation} \label{sec:FP}

In this section, firstly we layout the three essential steps to be followed to ensure freestream preservation for MEG6 and MIG4 schemes. Then we present a proof showing how the metric identities are satisfied with the use of MEG6 and MIG4 schemes to discretize and interpolate the conservative metric term formulae (Eqn. \ref{GCL_metrics}). The following are the three steps to be incorporated while computing metric terms in order to achieve freestream preservation:

\begin{enumerate}
    \item \textbf{Conservative metrics:} Conservative metrics presented in Eqn. \ref{GCL_metrics} should be used to ensure geometric and volume conservation \cite{thomas1979geometric}.
    
    \item \textbf{Consistent discretization using a central scheme}:  While computing the cell-centered metric terms, the same scheme as that of the inviscid flux discretization ($\frac{\partial F}{\partial \xi}$) has to be used to compute derivative terms involved in the conservative metric formulae. Furthermore, in order to estimate the metric terms in a linear fashion, the limiting steps (steps 4 and 5 in Fig. \ref{inv_algo}) are skipped and the left and right biased interpolated states should be averaged. 
    
    For instance, to compute the $(x_{\xi})_i$ term (which is required to compute metric terms), firstly, the values of $x$ at $i+\frac{1}{2}$ and $i-\frac{1}{2}$ should be computed by averaging the left and right biased interpolated values obtained using the formulation described in Eqn. \ref{vanleer-poly}. Then, using Eqn. \ref{FP-interp2} the derivative at location $i$ is computed.
    
    \begin{subequations} \label{FP-interp}
    \begin{gather}
    \begin{aligned}
         x_{i+\frac{1}{2}} &= 0.5\left(x_{i+\frac{1}{2}}^L + x_{i+\frac{1}{2}}^R\right) = 0.5 \left[\left(x_{i} + \frac{1}{2} x'_{i}+ \frac{1}{12} x''_{i} \right) + \left(x_{i+1} - \frac{1}{2} x'_{i+1}+ \frac{1}{12} x''_{i+1} \right) \right], \\
        x_{i-\frac{1}{2}} &= 0.5\left(x_{i-\frac{1}{2}}^L + x_{i-\frac{1}{2}}^R\right) = 0.5 \left[\left(x_{i-1} + \frac{1}{2} x'_{i-1}+ \frac{1}{12} x''_{i-1} \right) + \left(x_{i} - \frac{1}{2} x'_{i}+ \frac{1}{12} x''_{i} \right) \right] 
    \end{aligned}
    \tag{\theequation a-\theequation b}
    \end{gather}
    \end{subequations}
    
    \begin{equation} \label{FP-interp2}
        (x_{\xi})_i = \frac{x_{i+\frac{1}{2}} - x_{i-\frac{1}{2}}}{\Delta \xi}
    \end{equation}
    
    In the above equations, the $x'$ and $x''$ terms should be computed using the formulations described in Eqns. \ref{E6_grads} or \ref{IG4_grads} depending on whether the scheme being employed is MEG6 or MIG4. The procedure leads to linear interpolation and, consequently, a linear estimate of all the metric terms. It should be noted that though $x'$ and $x_{\xi}$ have mathematically the same meaning, they are different in the numerical sense.
    
    \item \textbf{Consistent interpolation using a central scheme}: The same formulation used in interpolating the left and right characteristic variable states in the inviscid flux algorithm (Eqns. \ref{legendre_polys}) should be used to interpolate metric terms from cell centers to cell interfaces. Furthermore, while interpolating metric terms of the form $\frac{\xi_x}{J}$ (which are used in the Riemann solver), the quantity should be interpolated as a whole rather than interpolating $\xi_x$ and $\frac{1}{J}$ separately and then multiplying them later. To make the interpolation central, the left and right states should be averaged. For instance, the following expression should be used to interpolate $\frac{\xi_x}{J}$ to the $i+\frac{1}{2}$ interface.
    
    % (used in Riemann solver and viscous flux computations)
    
    \begin{equation}    \label{interp-formulae}
    \begin{aligned}
        \left(\frac{\xi_x}{J}\right)_{i+\frac{1}{2}} &= 0.5 \left\{\left(\frac{\xi_x}{J}\right)_{i+\frac{1}{2}}^L + \left(\frac{\xi_x}{J}\right)_{i+\frac{1}{2}}^R \right\}\\
        &= 0.5 \left\{\left[\left(\frac{\xi_x}{J}\right)_{i} + \frac{1}{2} \left(\frac{\xi_x}{J}\right)'_{i}+ \frac{1}{12} \left(\frac{\xi_x}{J}\right)''_{i} \right] + \left[\left(\frac{\xi_x}{J}\right)_{i+1} - \frac{1}{2} \left(\frac{\xi_x}{J}\right)'_{i+1}+ \frac{1}{12} \left(\frac{\xi_x}{J}\right)''_{i+1} \right] \right\}
    \end{aligned}
    \end{equation}
    
\end{enumerate}

Now that all the steps are detailed, next, we present a proof showing how freestream preservation is ensured by following these steps. To ensure freestream preservation, the interpolated metrics should satisfy the three metric identities listed in Eqn. \ref{metric-Idty} in the discrete sense \cite{thomas1979geometric,nonomura2010freestream}. These metric identities can be obtained by simplifying the momentum equations by considering the freestream flow assumption (i.e., constant $[\rho,u,v,w,p]$ values throughout the domain). For the sake of brevity, the proof is only presented for the metrics corresponding to MEG6. Nevertheless, following the essential steps, the same result can also be obtained even for metrics that are computed with the MIG4 scheme.
    
\begin{subequations}  \label{metric-Idty}
\begin{gather}
    \frac{\partial}{\partial \xi}\left(\hat{\xi_x}\right)+\frac{\partial}{\partial \eta}\left(\hat{\eta_x}\right)+\frac{\partial}{\partial \zeta}\left(\hat{\zeta_x}\right) =0, \\
    \frac{\partial}{\partial \xi}\left(\hat{\xi_y}\right)+\frac{\partial}{\partial \eta}\left(\hat{\eta_y}\right)+\frac{\partial}{\partial \zeta}\left(\hat{\zeta_y}\right) =0, \\
    \frac{\partial}{\partial \xi}\left(\hat{\xi_z}\right)+\frac{\partial}{\partial \eta}\left(\hat{\eta_z}\right)+\frac{\partial}{\partial \zeta}\left(\hat{\zeta_z}\right) =0
\end{gather}
\end{subequations}



\noindent \textbf{Statement:} The three metric identities (Eqn. \ref{metric-Idty}) will be satisfied in discrete sense if the conservative metrics are discretized and interpolated based on MEG6 or MIG4 schemes (as described in steps 2-3 above).

\noindent \textbf{Proof:} The metric terms $\hat{\xi}_{x}$, $\hat{\eta}_{x}$, and $\hat{\zeta}_{x}$ presented in Eqn. \ref{metric-Idty}a can be analytically expressed as,

\begin{equation}
\hat{\xi}_x=\left(y_\eta z\right)_\zeta-\left(y_\zeta z\right)_\eta, \quad \hat{\eta}_x=\left(y_\zeta z\right)_{\xi}-\left(y_{\xi} z\right)_\zeta, \quad \hat{\zeta}_x=\left(y_{\xi} z\right)_\eta-\left(y_\eta z\right)_{\xi}
\end{equation}

\noindent We proceed to discretize $\hat{\xi}_{x}$, $\hat{\eta}_{x}$ and $\hat{\zeta}_{x}$ at $i,j,k$ locations. Firstly the terms $y_\xi z$, $y_\eta z$, and $y_\zeta z$ are computed using the discretization scheme employed for the MEG6 scheme as follows:

\begin{equation}
    \begin{split}
    \left(y_\xi z\right)_{i,j,k} &= \frac{1}{\Delta \xi}\left(y_{i+\frac{1}{2},j,k} + y_{i-\frac{1}{2},j,k}\right) z_{i,j,k} \\
    &= \frac{1}{2 \Delta \xi}\left(y_{i+\frac{1}{2},j,k}^L+y_{i+\frac{1}{2},j,k}^R\right) z_{i,j,k} + \frac{1}{2 \Delta \xi}\left(y_{i-\frac{1}{2},j,k}^L+y_{i-\frac{1}{2},j,k}^R\right) z_{i,j,k} \\
    &= \frac{2282}{2880\Delta \xi}(y_{i + 1, j, k} - y_{i - 1, j, k})z_{i, j, k} + \frac{-546}{2880\Delta \xi}(y_{i + 2, j, k} - y_{i - 2, j, k})z_{i, j, k} \\
    &+ \frac{89}{2880\Delta \xi}(y_{i + 3, j, k} - y_{i - 3, j, k})z_{i, j, k} +\frac{-3}{2880\Delta \xi}(y_{i + 4, j, k} - y_{i - 4, j, k})z_{i, j, k} \\
    &+ \frac{-1}{2880\Delta \xi}(y_{i + 5, j, k} - y_{i - 5, j, k})z_{i, j, k}.
    \end{split}
\end{equation}

\noindent Similar expressions can be derived for $y_\eta z$ and $y_\zeta z$. Next we compute the terms $\left(y_\eta z\right)_\zeta$ and $\left(y_\zeta z\right)_\eta$ as follows.

\begin{equation}    \label{proof1}
    \begin{split}
    \left[\left(y_\eta z\right)_\zeta\right]_{i,j,k} &= \frac{1}{\Delta \zeta} \left[ \left(y_\eta z\right)_{i,j,k+\frac{1}{2}}-\left(y_\eta z\right)_{i,j,k-\frac{1}{2}} \right] \\
    &= \frac{1}{2 \Delta \zeta}\left[\left(y_\eta z\right)_{i,j,k+\frac{1}{2}}^L+\left(y_\eta z\right)_{i,j,k+\frac{1}{2}}^R\right] + \frac{1}{2 \Delta \zeta}\left[\left(y_\eta z\right)_{i,j,k-\frac{1}{2}}^L+\left(y_\eta z\right)_{i,j,k-\frac{1}{2}}^R\right] \\
    &= \frac{2282}{2880\Delta \zeta}\left[\left(y_\eta z\right)_{i , j, k+ 1} - \left(y_\eta z\right)_{i, j, k- 1}\right] + \frac{-546}{2880\Delta \zeta}\left[\left(y_\eta z\right)_{i, j, k + 2} - \left(y_\eta z\right)_{i, j, k - 2}\right] \\
    & + \frac{89}{2880\Delta \zeta}\left[\left(y_\eta z\right)_{i, j, k + 3} - \left(y_\eta z\right)_{i, j, k - 3}\right] + \frac{-3}{2880\Delta \zeta}\left[\left(y_\eta z\right)_{i, j, k + 4} - \left(y_\eta z\right)_{i, j, k - 4}\right] \\
    & + \frac{-1}{2880\Delta \zeta}\left[\left(y_\eta z\right)_{i, j, k + 5} - \left(y_\eta z\right)_{i, j, k - 5}\right].
    \end{split}
\end{equation}

\noindent After computing the term $\left[(y_{\zeta}z)_{\eta}\right]_{i,j,k}$ in a similar fashion, it can be subtracted from $\left[(y_\eta z)_\zeta\right]_{i,j,k}$ to obtain the metric term $\left(\xi_x\right)_{i,j,k}$. Similarly, other metric terms $\left(\eta_x\right)_{i,j,k}$ and $\left(\zeta_x\right)_{i,j,k}$ can also be computed. The next step is to interpolate $\xi_x$, $\eta_x$, and $\zeta_x$ terms from $(i,j,k)$ locations to the half locations and evaluate Eqn. \ref{metric-Idty}a. For instance, the first term of Eqn. \ref{metric-Idty}a is computed as follows. It should be noted that the grid spacing in the computational coordinates is uniform and taken equal to one unit, i.e., $\Delta \xi = \Delta \eta = \Delta \zeta = 1$.

\begin{equation}
    \begin{aligned}
    \frac{\partial}{\partial \xi}\left(\hat{\xi}_x\right) = \frac{(\xi_x)_{i+\frac{1}{2},j,k}-(\xi_x)_{i-\frac{1}{2},j,k}}{\Delta \xi} &= \frac{1}{2 \Delta \xi}\left[(\xi_x)_{i+\frac{1}{2},j,k}^L+(\xi_x)_{i+\frac{1}{2},j,k}^R\right] - \frac{1}{2 \Delta \xi}\left[(\xi_x)_{i-\frac{1}{2},j,k}^L+(\xi_x)_{i-\frac{1}{2},j,k}^R\right] \\
    &= \frac{1}{23887872000}[-y_{i-5,j-5,k-5}z_{i-5,j-5,k} -3y_{i-5,j-5,k-4}z_{i-5,j-5,k} \\
    & +\quad \cdots \quad  + 3y_{i+5,j+5,k+4}z_{i+5,j+5,k} + y_{i+5,j+5,k+5}z_{i+5,j+5,k}]
    \end{aligned}
\end{equation}

\noindent Similarly, the expressions $\frac{(\eta_x)_{i,j+\frac{1}{2},k}-(\eta_x)_{i,j-\frac{1}{2},k}}{\Delta \eta}$ and $\frac{(\zeta_x)_{i,j,k+\frac{1}{2}}-(\zeta_x)_{i,j,k-\frac{1}{2}}}{\Delta \zeta}$ can also be discretized. Adding up all the expressions will result in a sum equal to zero. The zero-sum proves that the first metric identity is satisfied in a discrete sense. The other two metric identities Eqns. \ref{metric-Idty}b-c can also be proved similarly. Due to the large number of terms involved, full length arithmetic operations are not showed here. A detailed, worked-out Mathematica notebook file has been provided in the supplementary section (Suppl. \ref{sec:supply}1) to support the proof. It was also found that the use of any other interpolation scheme for the present discretization approach (MEG4/MIG4), other than the one mentioned in step 3 above, will not satisfy the metric identities. 
\begin{equation}
     \frac{(\xi_x)_{i+\frac{1}{2},j,k}-(\xi_x)_{i-\frac{1}{2},j,k}}{\Delta \xi} +   \frac{(\eta_x)_{i,j+\frac{1}{2},k}-(\eta_x)_{i,j-\frac{1}{2},k}}{\Delta \eta} +  \frac{(\zeta_x)_{i,j,k+\frac{1}{2}}-(\zeta_x)_{i,j,k-\frac{1}{2}}}{\Delta \zeta} = 0
\end{equation}

\section{Results} \label{sec:results}
The results are organized into three parts. The first part (Sec. \ref{sec:FP-stationary}) presents demonstrative examples to show the freestream preserving nature of the MEG6/MIG4 schemes. The second part (Sec. \ref{sec:dynamic}) explores the efficacy of MEG6 and MIG4 schemes to simulate flows through dynamically deforming grids. Finally, in the third part (Sec. \ref{sec:JNapplication}), the resolving capability of MEG6 and MIG4 in capturing screech tones and unsteady aspects of an under-expanded supersonic jet \cite{ponton1997near} are shown employing coarse grid LES. The test cases used in each of the three parts are enumerated below.

\begin{enumerate}
    \item \textbf{Freestream preservation:} Three-dimensional uniform flow, convecting vortex, and Double Mach reflection.
    \item \textbf{Dynamically deforming meshes:} Three-dimensional uniform flow, stationary vortex, and double periodic shear layer.
    \item \textbf{Application to simulate supersonic jet noise:} Mach 1.35 choked under-expanded supersonic jet.
    % \item \textbf{Experimental validation:} Schardin's test and Mach 1.35 choked under-expanded supersonic jet (sections \ref{sec:schardin} and \ref{sec:JNapplication}).
\end{enumerate}

\subsection{Freestream preservation: Demonstration} \label{sec:FP-stationary}

The test cases in this section were chosen to cover two-dimensional, three-dimensional, subsonic, and supersonic flow scenarios. To discern the effect of using a non-freestream preserving approach for computing metric terms, tests were also performed using a non-conservative metric term approach presented in \ref{app:non-FP}. The non-freestream preserving approach employs a non-conservative form of metrics and explicit fourth order central scheme for first and second derivative evaluation instead of Eqns. \ref{E6_grads} or \ref{IG4_grads}. The non-freestream preserving metrics are referred to with the names \textit{Non-Freestream Preserving MEG6} (Non-FP MEG6) and \textit{Non-Freestream Preserving MEG6} (Non-FP MIG4) when MEG6 and MIG4 schemes were used to compute the inviscid fluxes, respectively.

\subsubsection{Three-dimensional uniform flow} \label{3D-UF}

A fluid stream with uniform density, velocity, and pressure flowing through a periodic domain is simulated to test freestream preservation of MEG6 and MIG4 schemes in this test case. The effect of mesh non-uniformity on the solution is assessed by employing freestream preserving and non-freestream preserving metric terms. Two non-uniform meshes are employed in this test case; the first is a wavy sinusoidal domain, and the second is a randomized grid (Fig. \ref{freestream_grid}). The formulation used to generate the sinusoidal grid \cite{jiang2014free} is as follows:

\begin{equation}
   \begin{aligned}
    x_{i, j, k}=x_{\min }+&\Delta x_0\left[(i-1)+ \sin (\pi(j-1) \Delta y_0) \sin(\pi(k-1) \Delta z_0) \right], \\
    y_{i, j, k}=y_{\min }+&\Delta y_0\left[(j-1)+ \sin (\pi(k-1) \Delta z_0) \sin(\pi(i-1) \Delta x_0) \right], \\
    z_{i, j, k}=z_{\min }+&\Delta z_0\left[(k-1)+ \sin (\pi(i-1) \Delta x_0) \sin(\pi(j-1) \Delta y_0) \right]
    \end{aligned}
\end{equation}

where,

\begin{equation} \label{usual-pars}
    \begin{aligned}
        i=1,2, \cdots, NI, \quad & j=1,2, \cdots, NJ, \quad & k=1,2, \cdots, NK, \\
        \Delta x_0=\frac{L_x}{NI}, \quad & \Delta y_0=\frac{L_y}{NJ}, \quad & \Delta z_0=\frac{L_z}{NK}, \\
        x_{\min }=-\frac{L_x}{2}, \quad & y_{\min }=-\frac{L_y}{2}, \quad & z_{\min }=-\frac{L_z}{2}
    \end{aligned}
\end{equation}

The variables $NI$, $NJ$, and $NK$ represent the total number of cells along the $\xi$, $\eta$, and $\zeta$ directions, respectively; all of them are taken as $20$, thus making the grid resolution $20 \times 20 \times 20$. $L_x$, $L_y$, and $L_z$ are the length parameters taken as four units each. On the other hand, the randomized grid shown in Fig. \ref{freestream_grid}b is generated by randomly moving the uniformly distributed grid node positions by an amount of $20$ percent of the local grid spacing in each direction.

\begin{figure}[h!]
    \centering
    \includegraphics[width=90mm]{Images/freestream_grid.pdf}
    \caption{(a) Sinusoidal grid and (b) Randomized grid used to test freestream preservation nature of MEG6 and MIG4 schemes.}
    \label{freestream_grid}
\end{figure}

The initial conditions of the flow are: $(\rho, u, v, w, p)=(1,1,0,0,\frac{1}{\gamma M^2})$. The value of $\gamma$ is taken to as $1.4$. Inviscid calculations were performed with a Mach number of $0.5$. The initial conditions essentially dictate that the $y$ and $z$ velocities should remain zero everywhere in the domain at the end of the simulation. However, if the scheme is not freestream preserving, the errors associated with the metric cancellation will add up and grow. Consequently, they will be seen as non-zero values in the $y$ and $z$ direction velocities. 

The flow is simulated until a non-dimensional time of 10 units. Then, the $L^2$ norm errors associated with the $y$ and $z$ velocities are computed for both freestream and non-freestream preserving metric approaches. All the $L^2$ errors recorded in the simulations are tabulated in table \ref{freestream_table}. The errors associated with non-freestream preserving schemes presented in the first and second rows of the table can be seen to be significantly high. The errors are in the order of $10^{-3}$ and $10^{-1}$ in magnitude on sinusoidal and randomized grids, respectively. On the other hand, the errors associated with freestream preserving metrics are close to machine zero (of double-precision computations) on both sinusoidal and randomized grids; these errors can be treated as zeros. This clearly demonstrates that the current approach is freestream preserving concerning both MEG6 and MIG4 schemes. Experiments were also performed with conservative metrics computed using the fourth-order scheme (Eqn. \ref{4thorder-grads}), which also failed to preserve the freestream values, as expected.

\begin{table}[h!]
    \centering
    \includegraphics[width=110mm]{Images/freestream_table.pdf}
    \caption{$L^2$ norm errors of $y$ and $z$ component velocity in the freestream preservation test on sinusoidal and randomized grids employing non-conservative and conservative metric term approaches.}
    \label{freestream_table}
\end{table}

\subsubsection{Two-dimensional moving vortex}

\begin{figure}[h!]
    \centering
    \includegraphics[width=135mm]{Images/freestream_COVO.pdf}
    \caption{(a) $64\times64$ 2D grid used for the simulation, (b) Plots of swirl velocity along $y=8$ and, (c,d,e,f) Plots of z-vorticity ($\Omega_z$) at $t=16$ using conservative and non-conservative metrics for MEG6 and MIG4 schemes.}
    \label{freestream_COVO}
\end{figure}

In this test case, an isentropic inviscid vortex is advected through a distorted randomized grid of size $64 \times 64$ to test for the freestream and vortex preservation nature of the MEG6 and MIG4 schemes. The test is performed on a periodic domain spanning over square dimensions of $[0,16]\times[0,16]$. With the advection velocity chosen as one unit and the simulation time $16$ non-dimensional time units, the vortex is allowed to travel one full cycle to reach back to its initialized location. The grid randomization is only done in the central portion of the domain spanning over the region given by ${x \in [3,13] \cup y\in [3,13]}$ (Fig. \ref{freestream_COVO}a). Such an abrupt mesh non-uniformity (also an abrupt change in metric term values) is created intentionally to check the robustness of the schemes. The level of grid randomization in the current simulation is also considered twenty percent, similar to the previous case. The mesh resulting non-uniformities created a maximum included angle of about $160$ degrees in the domain. The initial conditions are given by:

\begin{equation}
\begin{aligned}
& \rho = 1 \\
& u =1-\frac{C\left(y-y_{c}\right)}{U_{\infty} R} \exp \left(-r^{2} / 2\right) \\
& v =\frac{C\left(x-x_{c}\right)}{U_{\infty} R^{2}} \exp \left(-r^{2} / 2\right) \\
& p =1-\gamma M^2 \frac{C^{2}}{U_{\infty}^2 R^{2}} \exp \left(-r^{2}\right) \\
& r^{2} =\left(x-x_{c}\right)^{2}+\left(y-y_{c}\right)^{2}
\end{aligned}
\end{equation}

where $(x_c,y_c) = (8,8)$ are the coordinates of vortex core center. $R$ denotes the vortex core radius. The value of non-dimensional vortex core strength $\frac{C}{U_{\infty}R}$ is taken as $0.02$. The freestream Mach number $M$ is set to $0.1$.

Fig. \ref{freestream_COVO}b shows the swirl velocity profiles (y-direction velocity) along $y=8$ computed using freestream preserving and non-freestream preserving metric schemes in comparison to the exact solution. The blue triangles and the black circles can be noted to follow close to the exact solution, unlike the solution corresponding to the non freestream scheme. A similar conclusion can be drawn from the vorticity contours presented in Fig \ref{freestream_COVO}c-d. While MEG6 and MIG4 conservative approaches preserve the vortex shape and its surrounding field, the solution computed using non-conservative compact fourth-order schemes yields an unphysical solution. This test has successfully demonstrated the vortex-preserving nature of the MEG6 and MIG4 conservative metric approaches.

\subsubsection{Double Mach reflection} \label{DMR-case}

% This popular test case is typically used to test shock capturing schemes and the ability of the scheme to resolve shear layers.

Through this test case, the freestream preservation property of the MEG6 and MIG4 schemes is further accessed in the presence of shock waves and shear layers in the solution field. The problem comprises a planar shock wave moving towards a compression ramp. The ramp is inclined at 30 degrees relative to the shock. The moving shock wave interacts with the wall to form two triple points, two reflected shocks, two Mach stems, and a slip-stream. In order to simplify the computational domain and grid, the planar shock wave is inclined while keeping the ramp wall horizontal; this consequently makes the domain rectangular. Simulations are performed on a domain size of $[0,3]\times[0,1]$ at a resolution of $768\times256$. The grid is randomized in the central portion of the domain by randomly moving the grid nodes in both $x$ and $y$ directions by a maximum distance of fifty percent of the uniform grid spacing. The maximum included angle of the resulting mesh in the entire domain is close to $200$ degrees, making the grid highly skewed and non-uniform. A closeup view of the randomized grid is shown in Fig. \ref{freestream_DMR}a. The initial conditions for this test case are:

\begin{equation}
    (\rho, u, v, p)= \begin{cases}\left(8,8.25 \cos 30^{0},-8.25 \sin 30^{0}, 116.5\right), & x<1 / 6+\frac{y}{\tan 60^{0}} \\ (1.4,0,0,1), & x>1 / 6+\frac{y}{\tan 60^{0}}\end{cases}
\end{equation}

\begin{figure}[h!]
    \centering
    \includegraphics[width=135mm]{Images/freestream_DMR.pdf}
    \caption{(a) $768\times256$ 2D grid used for the simulation, (b,c,d,e) Plots of density contours using conservative and non-conservative metrics for MEG6 and MIG4 schemes. Blow-up view of the shear layer corresponding to (d,e) conservative metrics approach are also shown at the bottom of the image. (f) Close-up view of the shear layer region, corresponding to the results obtained from the WENO-Z simulation employing uniform grid.}
    \label{freestream_DMR}
\end{figure}

% include max skewness and aspect ratio, max included angle

The boundary conditions are as follows. Post-shock flow conditions are set at the left boundary, and zero-gradient conditions are imposed on the right boundary. At the bottom boundary, reflecting boundary conditions are used from $x = 1/6$ to $x = 3.0$ and post-shock conditions for rest of the region i.e., $x \in [0, 1/6]$. A time-varying boundary condition is imposed on the top with pre- and post-shock conditions to the left and right of the shock, respectively, to accommodate the shock motion. The flow is simulated until an end time of $t=0.2$. 

Fig. \ref{freestream_DMR}b-d shows density contours at $t=0.2$ obtained using MEG6 and MIG4 schemes with freestream-preserving and non-freestream preserving metrics. The leftover errors corresponding to the non-freestream preserving schemes can be seen in the central region of the solution as rough patches in Figs. \ref{freestream_DMR}b-c. Interestingly the errors corresponding to MIG4 are minimal and significantly less compared to the MEG6 Non-FP approach (Fig. \ref{freestream_DMR}c). This might be attributed to the accuracy of implicit gradient values used in estimating the metric terms of the MIG4-based derivatives and interpolations. On the other hand, with conservative metric terms evaluated using MEG6 and MIG4 schemes, the solution in the central region can be seen unaffected by the grid distortion. Furthermore, the original solution is noted to be preserved even in the presence of shocks. In addition, the bottom right of the figure illustrates the outcome of a WENO-Z simulation for comparison with the current schemes. The simulation was conducted utilizing a uniform grid at the same resolution. The variations in the shear layer characteristics between the current schemes and the WENO-Z scheme demonstrate the enhanced resolving capabilities of the current schemes. This concludes the discussion on demonstrating the freestream and vortex-preserving nature of the MEG6 and MIG4 schemes. The use of these schemes on dynamically deforming meshes is explored next.\\

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    -------------------- DYNAMIC MESHES --------------------
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Application to dynamically deforming meshes} \label{sec:dynamic}
In this section, we examine the usage of MEG6 and MIG4 schemes to simulate flows through dynamically deforming mesh environments using three canonical test cases, namely `3-D uniform flow', `stationary vortex,' and `doubly periodic shear layer.' The time derivative is split into two parts using the chain rule described in Eqn. \ref{time-split}. To ensure the geometric conservation law (GCL) which is a necessary condition for freestream preservation, the term $\left(\frac{1}{J}\right)_t$ is computed using Eqn. \ref{Jacb2}. The mesh velocities are computed analytically for all the test cases presented in this section. The corresponding expressions are presented while describing the case.

% The use of high order conservative schemes to simulate flows through dynamically deforming meshes especially in the context of compressible flows is quite limited in the literature.

\subsubsection{Three-dimensional uniform flow on deforming sinusoidal grid} \label{3D-moving-FP}
Firstly, we start with the trivial case of three-dimensional uniform flow. The flow is simulated in a dynamically moving mesh environment with periodic boundary conditions on all sides. The initial and boundary conditions for this test case are the same as that of the conditions described in section \ref{3D-UF}. Inviscid calculations are performed using both freestream and non-freestream preserving metric approaches. The time-dependent location of the grid nodes for the simulation is given by: 

\begin{equation}
    \begin{aligned}
        x_{i, j, k}(t)=& x_{\min }+\Delta x_o\left[i+A_x \sin (2 \pi \omega t) \sin \frac{n_{x y} \pi j \Delta y_o}{L_y} \sin \frac{n_{x z} \pi k \Delta z_o}{L_z}\right] \\
        y_{i, j, k}(t)=& y_{\min }+\Delta y_o\left[j+A_y \sin (2 \pi \omega t) \sin \frac{n_{y x} \pi i \Delta x_o}{L_x} \sin \frac{n_{y z} \pi k \Delta z_o}{L_z}\right] \\
        z_{i, j, k}(t)=& z_{\min }+\Delta z_o\left[k+A_z \sin (2 \pi \omega t) \sin \frac{n_{z x} \pi i \Delta x_o}{L_x} \sin \frac{n_{z y} \pi j \Delta y_o}{L_y}\right]
    \end{aligned}
\end{equation}  

Taking the analytical derivative of the above expressions, the following grid time-dependent deformation velocity expressions are obtained:

\begin{equation}
    \begin{aligned}
        x_{i, j, k}^{'}(t)=&  2 \pi \omega \Delta x_o A_x \cos (2 \pi \omega t) \sin \frac{n_{x y} \pi j \Delta y_o}{L_y} \sin \frac{n_{x z} \pi k \Delta z_o}{L_z}, \\
        y_{i, j, k}^{'}(t)=&  2 \pi \omega \Delta y_o A_y \cos (2 \pi \omega t) \sin \frac{n_{y x} \pi i \Delta x_o}{L_x} \sin \frac{n_{y z} \pi k \Delta z_o}{L_z}, \\
        z_{i, j, k}^{'}(t)=&  2 \pi \omega \Delta z_o A_z \cos (2 \pi \omega t) \sin \frac{n_{z x} \pi i \Delta x_o}{L_x} \sin \frac{n_{z y} \pi j \Delta y_o}{L_y},
    \end{aligned}
\end{equation}

where, $i$, $j$, $k$, $\Delta x_o$, $\Delta y_o$, $\Delta z_o$, $x_{\min}$, $y_{\min}$, $z_{\min}$ assume their usual meanings described in Eqn. \ref{usual-pars}. The grid resolution for the simulation is set to $32^3$. The values of the rest of the parameters are: $A_x=A_y=A_z=1.5$, $L_x=L_y=L_z=12$, and $n_{xy}=n_{yz}= \cdots = 4$. The grid deformation oscillation frequency $\omega$ is set to $1$. As the mesh undergoes deformation, the maximum included angle in the domain reaches a maximum value of $\approx 160$.

\begin{figure}[h!]
    \centering
    \includegraphics[width=150mm]{Images/dynamic1.pdf}
    \caption{Snapshots of $20\times20$ three dimensional deforming sinusoidal grid with y-velocity contours on the surface using (a) non conservative (non-FP) metrics and (b) conservative (FP) metrics for MEG6 and MIG4 schemes. (c) $L^2$ norm error in y and z velocities using different different metric schemes.}
    \label{dynamic1}
\end{figure}

Contours of $y$-velocity and the corresponding grid at $t=5.25$ are shown in Fig. \ref{dynamic1}. The contours clearly indicate that the non-conservative metrics (non-FP) approach feeds error into the solution while the conservative metrics (FP) approach does not. Fig. \ref{dynamic1}c shows the $L^2$ norm errors computed using MEG6 and MIG4 schemes. The errors corresponding to the conservative metric formulation can be noted to stay close to machine zero, while the non-conservative approach does not. This clearly demonstrates that the present schemes satisfy the geometric conservation law and are thus freestream preserving even on dynamically deforming meshes.

\subsubsection{Stationary vortex on a three-dimensional deforming mesh}
In this test case, the vortex preservation nature of MEG6 and MIG4 schemes is shown in a moving grid environment. A stationary columnar vortex is initialized at the center of a three-dimensional, cubical domain of dimensions $[-8,8]\times[-8,8]\times[-8,8]$. In each direction, thirty-two cells were used. The grid is set to deform in time according to the same equations presented in the previous test case on \textit{three-dimensional uniform flow} (section \ref{3D-moving-FP}). The oscillation frequency of the grid is set to $\omega=1$.

\begin{figure}[h!]
    \centering
    \includegraphics[width=140mm]{Images/dynamic2.pdf}
    \caption{(a,b) Instantaneous snapshots of vorticity contours collected on the surface corresponding cells on the 16th grid index in the $\zeta$-direction. (c) Swirl velocity plot along NZ/2 and y = 8 at $t=8$.}
    \label{dynamic2}
\end{figure}

Inviscid calculations were performed until an end-time of $t_{end}=8$ using MEG6 and MIG4 schemes. The grid undergoes eight deformation cycles before the end time. Fig. \ref{dynamic2}a-b shows the grid and $z$-vorticity contours computed using the MIG4 scheme (with conservative metrics approach) at two different time instances. The vortex shape can be noted to stay intact and unaffected by the grid motion throughout. Fig. \ref{dynamic2}c shows the computed and exact swirl velocity profiles along the mid-horizontal line. Both MEG6 and MIG4 approaches can be noted to be in excellent agreement with the theoretical solution.

\subsubsection{Double periodic shear-layer on dynamic mesh}
In this test case, the freestream preserving nature of the MEG6 and MIG4 schemes in the presence of viscous stresses are tested. The case consists of two shear layers initially parallel to each other that evolve to produce two large vortices at $t=1$. Viscous forces are dominant near the shear layer in this test case. The non-dimensional parameters concerning the flow are, $\mathrm{Re} = 1 \times 10^4$ and $\mathrm{M} = 0.1$. The value of $\gamma$ is taken as $5/3$. The initial conditions for the flow are:

\begin{subequations}
    \begin{align}
        \rho &= \frac{1}{\gamma \mathrm{M}^2}, \\
        u &= 
        \begin{cases}
            \tanh (80 \times(y-0.25)), & \text{ if } (y \leq 0.5), \\
            \tanh (80 \times(0.75-y)), & \text{ if } (y > 0.5),
        \end{cases} \\
        v &= 0.05 \times \sin (2 \pi(x+0.25)) \\
        T &= 1.
    \end{align}
\end{subequations}

Simulations are performed on a two-dimensional deforming grid of resolution $360 \times 360$ using MEG6 and MIG4 schemes with the freestream preserving metrics. The spatial positions of mesh nodes and their respective velocities in time are given by Eqn. \ref{DPSL-eqn1} and Eqn. \ref{DPSL-eqn2} respectively, as described in Ref-\cite{achu2021entropically}. 

\begin{equation} \label{DPSL-eqn1}
    \begin{aligned}
x_{i, j}(\tau)=x_{\min }+\Delta x_0&\left[(i-1)+A_x \sin (2 \pi \omega \tau) \sin \left(\frac{n_x \pi(j-1) \Delta y_0}{L_y}+\frac{i \phi_x}{I L-1}\right)\right] \\
y_{i, j}(\tau)=y_{\min }+\Delta y_0&\left[(j-1)+A_y \sin (2 \pi \omega \tau) \sin \left(\frac{n_y \pi(i-1) \Delta x_0}{L_x}+\frac{i \phi_y}{J L-1}\right)\right]
\end{aligned}
\end{equation}

\begin{equation} \label{DPSL-eqn2}
    \begin{aligned}
&x_\tau=2 \pi \omega \Delta x_0 A_x \cos (2 \pi \omega \tau) \sin \left(\frac{n_x \pi(j-1) \Delta y_0}{L_y}+\frac{i \phi_x}{I L-1}\right) \\
&y_\tau=2 \pi \omega \Delta y_0 A_y \cos (2 \pi \omega \tau) \sin \left(\frac{n_y \pi(i-1) \Delta x_0}{L_x}+\frac{i \phi_y}{J L-1}\right)
\end{aligned}
\end{equation}

The length parameters $L_x$ and $L_y$ are considered $1$ unit each. The mesh oscillation frequency $\omega$ is set to 1, enabling the mesh to deform through one full cycle during the simulation ($t_{end}=1$).

\begin{equation} \label{KE-Ens}
    \begin{gathered}
E_k=\frac{1}{L_x L_y} \int_0^{L y} \int_0^{L x} \rho \frac{u^2+v^2}{2} \mathrm{~d} x \mathrm{~d} y \\
\mathcal{E}=\frac{1}{L_x L_y} \int_0^{L y} \int_0^{L x} \rho \frac{\boldsymbol{\Omega} \cdot \boldsymbol{\Omega}}{2} \mathrm{~d} x \mathrm{~d} y
\end{gathered}
\end{equation}

\begin{figure}[h!]
    \centering
    \includegraphics[width=150mm]{Images/dynamic3.pdf}
    \caption{(a,b,c,d) Snapshots of instantaneous vorticity contours collected at four different time instances with every 10th point of the grid overlain on the solution computed using MIG4 scheme. Evolution of (e) Kinetic energy (KE) and (f) Enstrophy computed using MEG6 and MIG4 schemes compared against the incompressible solution of Clausen \cite{clausen2013entropically}.}
    \label{dynamic3}
\end{figure}

Fig. \ref{dynamic3} shows the $z$-vorticity field at four equally spaced time instances during the simulation. Two large vortices of opposing angular velocity can be seen to evolve as time progresses. The dynamic mesh motion can be seen to not show any effect on the flow contours (for comparison against the stationary grid DNS solution, please refer to \cite{sainadh2022spectral}). The evolution of Kinetic Energy (KE) and Enstrophy ($\mathcal{E}$) in the entire computational domain is tracked in time for both MEG6 and MIG4 schemes. The expressions to compute these quantities are provided in Eqn. \ref{KE-Ens}. Evolution plots of these quantities are shown in Figs. \ref{dynamic3}e-f in comparison to the solutions corresponding to a stationary grid simulation and the incompressible flow solution of Clausen \cite{clausen2013entropically}, both simulated on a uniform grid with a resolution of on $512 \times 512$. An excellent agreement between the reference solutions and the current calculations can be noted in both KE and Enstrophy plots. This demonstrates that a Navier-Stokes solution computed using the higher accuracy schemes, MEG6 and MIG4, will resist the errors associated with the dynamic grid motion. 

% \subsection{Schardin's test} \label{sec:schardin}

% Schardin's test consists of an unsteady shock wave moving at a speed of Mach 1.3 that interacts with a two-dimensional prism. Due to shock diffraction and reflections, several intricate flow features such as slip-lines, contact discontinuities, acoustic waves, and triple points arise in this problem. The multi-block approach and the shock-capturing strategy of MEG6 and MIG4, as implemented in the current Navier-Stokes solver, are tested through this test case. Fig. \ref{schardin1}a shows domain dimensions and the initial set-up of the problem. First, the shock is initialized at the nose of the prism. The shock then moves towards the right to interact with the inclined surface of the prism, eventually diffracting at the trailing edge. A block-structured body-fitted grid comprising seven blocks with approximately $0.3$ million control volumes is employed for this simulation. The results are compared against the experiments of Schardin \cite{schardin1957high} and fine grid WENO-5 \cite{jiang1996efficient} simulations of Chaudhuri et al. \cite{chaudhuri2011use}. For further details and a complete description of this case, the reader is referred to Ref-\cite{chang2000shock}.

% \begin{figure}[h!]
%     \centering
%         \includegraphics[width=110mm]{Images/schardin1.pdf}
%     \caption{(a) Geometry, problem set-up and initial conditions for the Schardin's test case, (b) Density gradient contours at non-dimensional time $=2.752$ and its comparison with the experimental schlieren data taken from \cite{schardin1957high}.}
%     \label{schardin1}
%     %  (one originated from the top surface of wedge and one from the rightside region.)
% \end{figure}

% \begin{figure}[h!]
%     \centering
%         \includegraphics[width=120mm]{Images/schardin2.pdf}
%     \caption{(a) Trajectories of the two triple points on the upper half of the geometry. (b) Zoomed in view of flow-field close to the prism is shown on the right with a comparison between MEG6 and MIG4.}
%     \label{schardin2}
% \end{figure}

% Fig. \ref{schardin1}b shows the density gradients of the solution at $t = 2.752$ in comparison with the experiments. Several important features visible in the experimental schlieren, such as triple points, Mach stems, and vortices, can be noted in the MIG4 solution reproduced with good fidelity. Fig. \ref{schardin2}a shows the trajectories of two triple points that originate from the upper half of the domain (one from the top surface of the prism and the other from the rear). A good agreement between the present solution computed using MIG4 and the reference solutions of WENO-5 simulations and experiments can be observed. Fig. \ref{schardin2}b shows a comparison between MEG6 and MIG4 solutions. Although both the solutions look almost alike, the vortices at the trailing edge can be noted to have been slightly better resolved in the MIG4 solution. This ensures that the present solver can resolve several transient and intricate flow features with sufficient fidelity on a multi-block curvilinear grid. 

% In the next section, the use of MEG6 and MIG4 schemes to predict screech tones corresponding to a supersonic jet is presented, along with a discussion on the flow physics and grid requirements.
% \newpage

\input{sections/jetnoise.tex}


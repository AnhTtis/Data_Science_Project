%\documentclass{amsart}
%\input{defs}
%\begin{document}
%\section{Necessity proofs}

\subsection{Necessity proof for Grand Schnyder structures}


Let $G$ be a $d$-map, and let $G^+$ be the angular map of $G$. A \emph{star cycle} of $G^+$ is a cycle made of star edges only. 

 \begin{lemma}\label{lem:star_cycle}
 Let $G$ be a $d$-map endowed with a $d$-GS angular orientation. Let $C'$ be a star cycle of $G^+$, and let $\ell$ be its enclosing length (as defined in Section~\ref{sec:lattice_GS}).  
 Then the inward degree of $C'$ is equal to $\ell-d$. 
\end{lemma}
\begin{proof}
The proof is exactly the same as the one of Lemma~\ref{lem:compa}. 
\end{proof}


\begin{figure}
\begin{center}
\includegraphics[width=13cm]{C0}
\end{center}
\caption{For $G$ a $d$-map, the fact that a non-facial cycle $C$ of $G$ is not the enclosing cycle of a star cycle of $G^+$ is witnessed by the existence of two edges $e_1,e_2$  on $C$ that are incident to a same original face $f$ inside $C$, of degree smaller than $d$, such that each of the two portions of $C$ separated by $\{e_1,e_2\}$ contains at least one edge not incident to $f$.
This produces two non-facial cycles of $G$ whose interior is included in the interior of $C$. 
}
\label{fig:C0}
\end{figure}

\begin{prop}\label{prop:necessity_GS}
If a $d$-map $G$ admits a $d$-GS angular orientation, then $G$ is $d$-adapted.
\end{prop}
\begin{proof}
The first step is to show that $G$ has to be non-separable, i.e., $G^+$ has no star-cycle of length $2$. Assume such a cycle $C'$ exists, and let $C$ be its
enclosing cycle. Letting $f$ be the inner face of $G$ corresponding to the star vertex $s$ on $C'$, clearly all edges on $C$ are on the contour of~$f$. By Lemma~\ref{lem:star_cycle}, $C$ has length at least $d$. Hence, $s$ is incident to at least $d-1$ star edges in the exterior of $C'$. Since $s$ is incident to two edges on $C'$, we conclude that $s$ has degree larger than $d$, in contradiction with the fact that $G$ is a $d$-map. Hence, $G$ is non-separable.

Let $X$ be the set of non-facial
cycles of $G$ of length smaller than $d$. Assume $X$ is not empty, and let $C_0$ be a minimal element of $X$ (i.e., there is no other $C_1\in X$ such that the interior of $C_1$ is included in the interior of $C_0$). 
Since $C_0$ has length smaller than $d$, by Lemma~\ref{lem:star_cycle} it can not be the enclosing cycle of a compatible cycle. This means that there exists a face $f$ of $G$ 
inside $C$ that shares at least one edge with $C$, but such that the edges along $f$ that are on $C$ do not form a contiguous set on the contour of $f$. Since $G$
is non-separable, this set of edges is neither contiguous on $C$. 
Hence, we are in the situation shown in  Figure~\ref{fig:C0}. 
We have $L_1+L_2+2=\mathrm{length}(C_0)<d$ and 
$\ell_1+\ell_2+2=\mathrm{deg}(f)\leq d$, so $(L_2+\ell_1+2)+(L_1+\ell_2+2)<2d$, thus at least one of the two cycles on the right-side of  Figure~\ref{fig:C0} has length strictly smaller than~$d$, yielding a contradiction to the minimality of~$C_0$.  
\end{proof}

\subsection{Necessity proof for weak Grand Schnyder structures}

A \emph{relaxed weighted orientation} is a weighted orientation where the arc-weights are in 
$\mathbb{Z}$. As usual, the outgoing weight of a vertex $v$ is the sum of the weights of the arcs going out of $v$, the weight of an edge is the sum of weights of its two arcs, and the inward degree of a cycle is the sum of the weights of the arcs inside the cycle and with their initial vertex on the cycle.  
For a $d$-map $G$, with $G^+$ the angular map, a \emph{relaxed $d$-GS angular orientation} of $G$ is a relaxed weighted orientation of $G^+$ with exactly the same requirements as in Definition~\ref{def:angular}, the only difference being that negative arc-weights are allowed. 

\begin{lemma}\label{lem:weak_compatible}
Let $G$ be a $d$-map. Let $C'$ be a star cycle of $G^+$, and let $\ell$ be its enclosing length. Then, in any relaxed $d$-GS angular orientation of $G$, the inward degree of $C'$ is equal to $\ell-d$. 
\end{lemma}
\begin{proof}
The proof of Lemma~\ref{lem:star_cycle} (i.e., the proof of Lemma~\ref{lem:compa}) can be copied verbatim (it does not use positivity of arc-weights). 
\end{proof}

For $G$ a $d$-map, we call \emph{special quadrangle} of $G^+$ a 4-cycle whose contour contains the two extremities of a 
special original edge $e$ (edge with $e_d=-1$) and the two star-vertices for the faces of $G$ incident to $e$. 



\begin{lemma}\label{lem:transition}
If a $d$-map $G$ admits a weak $d$-GS angular orientation, then $G$ admits a relaxed $d$-GS angular orientation (on $G^+$) such that any cycle of $G^+$ has nonnegative inward degree, except for the special quadrangles, which have inward degree~$-1$.  
\end{lemma}
\begin{proof}
By applying the rules of Figure~\ref{fig:local_rules_transition} at each edge-vertex of a weak $d$-GS angular orientation, we obtain a relaxed $d$-GS angular orientation, where the only arcs of negative weight are on the special original  edges: each such edge has an arc of weight $-1$ and an arc of weight $0$. Now let $C'$ be a cycle in $G^+$, and consider an arc of weight $-1$ having its origin on $C'$, on a special original edge $e$. Then one easily checks that, if none of the $4$ green edges arising from $e$ (in the intermediate step in Figure~\ref{fig:local_rules_transition}) contributes to the inward degree of $C'$ (i.e., has its origin on $C'$ and its end inside $C'$), then $C'$ is reduced to the special quadrangle enclosing $e$. Hence, only these cycles have negative inward degree (equal to $-1$), any other cycle has nonnegative inward degree. 
\end{proof}


\begin{figure}
\begin{center}
\includegraphics[width=13cm]{local_rules_transition}
\end{center}   
\caption{The local rule applied at every special original edge $e$ ($e_d=-1$), to produce a relaxed $d$-GS angular orientation from a weak $d$-GS angular orientation (arcs with no weight indication have weight $1$, arcs not shown on their edge have weight $0$). The edge $e$ yields $4$ simply directed ``green edges" in the intermediate step.}
\label{fig:local_rules_transition}
\end{figure}

\begin{prop}\label{prop:necessity_weak_GS}
If a $d$-map $G$ admits a weak $d$-GS angular orientation, then $G$ is weakly $d$-adapted. 
\end{prop}
\begin{proof}
As in Proposition~\ref{prop:necessity_GS}, the first step is to check that $G$ must be non-separable, i.e., that $G^+$ has no 2-cycle of star edges. Assume there is such a cycle $C'$, with $s$ the star vertex on $C'$, and $f$ the inner face of $G$ corresponding to $s$. Since $C'$ is not a special quadrangle, Lemma~\ref{lem:weak_compatible} and Lemma~\ref{lem:transition} ensure that 
$C$ has length at least $d$. Hence, $s$ has at least $d-1$ incident edges in the exterior of $C'$. Since $s$ is also incident to two edges on $C'$, it has degree larger than $d$, in contradiction with the fact that $G$ is a $d$-map.  


We now prove that any chordless non-facial cycle in $G$ has length at least $d$, by the same argument as in the proof of Proposition~\ref{prop:necessity_GS}. 
Let $X$ be the set of non-facial \emph{chordless}  
cycles of $G$ of length smaller than $d$. 
Assume $X$ is not empty, and let $C_0$ be a minimal element of $X$ (i.e., there is no other $C_1\in X$ such that the interior of $C_1$ is included in the interior of $C_0$). Since $C_0$ has length smaller than $d$ and is chordless, by Lemma~\ref{lem:weak_compatible} and Lemma~\ref{lem:transition} it can not be the enclosing cycle of a star cycle. 
Hence, there exists a face $f$ of $G$ 
inside $C$ that shares at least one edge with $C$, but such that the edges on $C$ and along $f$ do not form a contiguous set on the contour of $f$. Since $G$
is non-separable, this set of edges is neither contiguous on $C$. 
Hence, we are in the situation shown in  Figure~\ref{fig:C0}, with $L_1+L_2+2=\mathrm{length}(C_0)<d$ and 
$\ell_1+\ell_2+2=\mathrm{deg}(f)\leq d$, so $(L_2+\ell_1+2)+(L_1+\ell_2+2)<2d$, thus at least one of the two cycles on the right-side of  Figure~\ref{fig:C0} has length smaller than $d$, yielding a contradiction to the minimality of $C_0$. By contradiction, we conclude that any chordless non-facial cycle has length at least $d$.

Now, consider a non-facial cycle $C$ of $G$ having at least one chord. 
It admits a decomposition (at chords) into chordless cycles, as shown in Figure~\ref{fig:decomp_cycle}. If $C$ has at least one vertex inside, then one
of these chordless components is non-facial, hence has length at least $d$. Note that the length of $C$ is at least the length of any of its components, hence the length of $C$ is at least $d$.  

In order to conclude that $G$ is weakly $d$-adapted, the last case to consider is a non-facial cycle $C$ with no vertex inside, and at least two edges inside (all edges inside are chords). In that case, the components of the decomposition of $C$ into chords are facial cycles. Consider a pair of adjacent components of $C$, and let $C''$ be the contour of the union of these two faces. The length of $C''$
is at least $d-1$ since $G$ admits a weak $d$-GS angular orientation.  
In addition, since $C$ is not equal to $C''$, and since we assume all faces of $G$ to have degree at least $3$, the length of $C$ is larger than the length of $C''$, hence is at least~$d$. 
\end{proof}

\begin{figure}
\begin{center}
\includegraphics[width=13cm]{chord}
\end{center}   
\caption{Decomposition of a cycle into chordless components.}
\label{fig:decomp_cycle}
\end{figure}


%\end{document}
%\documentclass[a4paper]{amsart}%[a4paper]
%\input{defs}
%\begin{document}
%\section{Bipartite case and connection to known structures}



In this section we study a class of structures that can be defined on bipartite $d$-maps, when $d=2b$ is an even integer. We will call such structures \emph{$b$-bipartite-grand-Schnyder structures}, or \emph{$b$-BGS structures} for short. These structures 
%OB removed:are greatly reminiscent of the $2b$-GS structures, and in fact they 
can be identified with a subclass of $2b$-GS structures called \emph{even} (even $2b$-GS structures form a proper, non-empty, subclass of $2b$-GS structures for bipartite $2b$-maps). As we will see, specific classes of $b$-BGS structures can be identified with previously known structures.
%For this subclass definitions take a simplified form, and We emphasize that this is indeed a proper subclass: after providing the precise definitions, it will be clear that not every $2b$-GS structure on a bipartite $2b$-map corresponds to a $b$-BGS structure. 
%The importance of this subclass lies in the fact that for specific $b$ and bipartite $2b$-maps, $b$-BGS structures can be identified with previously known structures.

We start this section by giving the four incarnations of $b$-BGS structures and then state their equivalence. 
%This equivalence can be thought of as a specialization of the general bijections, which are stated in Section~\ref{sec:statements}. 
In the second part we will state the existence condition for $b$-BGS structures. 
%OB removed: while assuming the existence theorem~\ref{thm:main} for (ordinary) GS structures. 
In the third part we explain the connection between $b$-BGS structures and previously known structures.
%for specific $b$ and bipartite $2b$-maps to previously known structures.

\subsection{Incarnations of bipartite grand-Schnyder structures}\label{sec:incar_bipartite}\hfill\\
In this section, we fix an integer $b\geq 2$ and a bipartite $2b$-map $G$. 
We also fix the bicoloring of the vertices of $G$ in black and white by requiring the outer vertex $v_1$ to be black (and hence the outer vertex $v_i$ is black if and only if $i$ is odd). 

We now define 4 incarnations of $b$-BGS structures. They are represented in Figure~\ref{fig:bipartite_compiled2}. Our first incarnation is in terms of corner labelings.
\fig{width=\linewidth}{bipartite_compiled2}{Four incarnations of a 3-bipartite-grand-Schnyder structure.}

\begin{definition}\label{def:BGS-labeling}
A \emph{$b$-bipartite-grand-Schnyder corner labeling}, or \emph{$b$-BGS labeling}, of $G$ is a $2b$-GS labeling of $G$ such that the corners incident to black vertices have odd labels, while the corners incident to white vertices have even labels.
\end{definition}

%% \begin{remark}\label{reduced_labeling}
%% Observe that the parity condition implies we can replace each label $i \in \{1,...,2b\}$ by $\lfloor (i-1)/2 \rfloor$ with no loss of information. The result of this operation was studied on some special subclasses of adapted maps \cite{OB-EF:Schnyder, Barriere-Huemer:4-Labelings-quadrangulation, FeHuKa}. See subsection~\ref{sec:bipartite_angulations} for more details.
%% \end{remark}

The parity condition is equivalent to requiring the \emph{label jumps} (as defined in Section~\ref{sec:incarnations}) between consecutive corners in clockwise order around a vertex to be even, and the label jumps between consecutive corners in clockwise order around an inner face to be odd. This observation underlies the other incarnations of BGS structures.

First, recall the mapping $\Phi$ defined in Section~\ref{sec:statements} between corner labelings and marked orientations. Observe that by specializing $\Phi$, the set of $b$-BGS labelings is in bijection with the subclass of $2b$-GS marked orientations of $G$ such that the weight of each inner arc is even, and the number of marks in each inner corner is even. Let us call this subclass the \emph{even $2b$-GS marked orientations} of $G$. For an even $2b$-GS marked orientation, we can divide the weight of each arc and the number of marks in each corner by 2 without loss of information. This leads to the following definition.

\begin{definition}\label{def:BGS-marked}
A \emph{$b$-bipartite-grand-Schnyder marked orientation}, or \emph{$b$-BGS marked orientation}, of $G$ is a weighted orientation of $G$ together with a corner marking satisfying the following conditions. 
\begin{itemize}
  %\item[(BM0)] The weight of outer arcs are 0. For any inner arc $a$ whose origin is an outer vertex $v_i$, the weight of $a$ is equal to the number of marks in the corner at $v_i$ on the left of $a$. the weight of $a$ and the number of marks in the corner of $v_i$ on the left of $a$ are both equal to $b-\text{deg}(f)/2$, where $f$ is the face on the left of $a$.
  \item[(BM0)] The weight of every outer arc is 0. For any inner arc $a$ whose initial vertex is an outer vertex $v_i$, the weight of $a$ and the number of marks in the corner of $v_i$ on the left of $a$ are both equal to $b-\mathrm{deg}(f)/2$, where $f$ is the face on the left of $a$.
  \item[(BM1)] For any inner face $f$, the total number of marks in the corners of $f$ is $b - \mathrm{deg}(f)/2$.
  \item[(BM2)] The weight of every inner edge is $b-1$, and the outgoing weight of every inner vertex $v$ is $b+m$, where $m$ is the number of marks in the corners incident to $v$.
  \item[(BM3)] The weight of every inner arc $a$ is at least $b-\mathrm{deg}(f)/2$, where $f$ is the face on the left of $a$.
\end{itemize}
\end{definition}

% Note that the conditions (BM0), (BM1) and (BM3) combined implies that for an inner arc $a$ whose origin is an outer vertex $v_i$, the weight of $a$ and the number of marks in the corner of $v_i$ on the left of $a$ are both equal to $b-\text{deg}(f)/2$, where $f$ is the face on the left of $a$. 

It is clear that $b$-BGS marked orientations are in bijection with even $2b$-GS marked orientations. Hence, from the above discussion we get:

\begin{lem}\label{lem:bij-BGS-beta}
The set $\bBL_G$ of $b$-BGS labelings of $G$ and the set $\bBM_G$ of $b$-BGS marked orientations of $G$ are in bijection. 
\end{lem}

The next incarnation is in terms of angular orientations. Recall the bijection $\Psi$ between marked orientations and angular orientations. Under $\Psi$, the even $2b$-GS marked orientations of $G$ correspond to the $2b$-GS angular orientations of $G$ such that the weight of every arc of the angular map $G^+$ is even. We shall call this subclass of $2b$-GS angular orientations \emph{even}. As before, we can divide every weight by 2, which leads to the following definition.
%in the previous case, we do not use this description as the definition of $b$-BGS angular orientations, but use the version which divides the weight of every arc by 2 instead. 

\begin{definition}\label{def:BGS-angular}
A \emph{$b$-bipartite-grand-Schnyder angular orientation}, or \emph{$b$-BGS angular orientation}, of $G$ is a weighted orientation of the angular map $G^+$ satisfying the following conditions: 
\begin{itemize}
  \item[(BA0)] The weights of outer arcs are 0. Any inner arc $a$ of $G^+$ whose initial vertex is an outer vertex $v_i$ has weight 0 unless $a$ is the arc preceding the outer edge ($v_i,v_{i-1}$) in clockwise order around $v_i$. %For this arc, the weight is $b-\text{deg}(f_i)/2$.
  \item[(BA1)] The outgoing weight of any star vertex $v_f$ is $b-\mathrm{deg}(f)/2$, and the weight of every star edge incident to $v_f$ is $b-\mathrm{deg}(f)/2$.
  \item[(BA2)] The outgoing weight of any inner original vertex is $b$. The weight of any original inner edge is $\mathrm{deg}(f)/2+\mathrm{deg}(f')/2-b-1$, where $f,f'$ are the faces of $G$ incident to $e$.
\end{itemize}
\end{definition}


It is clear that $b$-BGS angular orientations are in bijection with even $2b$-GS angular orientations. Hence, from the above discussion we get:

\begin{lem}\label{lem:bij-BGS-gamma}
The set $\bBM_G$ of $b$-BGS marked orientations of $G$ and the set $\bBA_G$ of $b$-BGS angular orientations of $G$ are in bijection.
\end{lem}


\begin{remark} \label{rk:weight-frozen-bip}
Note that Conditions (BA0) and (BA1) together imply that the inner arc $a$ whose initial vertex is an outer vertex $v_i$ and is pointing toward the star vertex $v_{f_i}$, where $f_i$ is the inner face incident to the outer edge $\{v_i,v_{i-1}\}$, has weight $b-\mathrm{deg}(f_i)/2$.
\end{remark}

Now we give the final incarnation of bipartite $2b$-GS structures as a $b$-tuple of trees. Let us recall the bijection $\Theta$ defined in Section~\ref{sec:statements} between GS corner labelings and GS woods. Observe that under $\Theta$ the set of $b$-BGS labelings of $G$ is in bijection with the subclass of $2b$-GS woods satisfying the following condition: 
\begin{itemize}
%  \item[($\dagger$)] \emph{For every $i \in \{1,\ldots,b\}$, and each black (resp. white) inner vertex $v$, the arcs leading $v$ to its parent in $W_{2i}$ and in $W_{2i-1}$ (resp. in $W_{2i}$ and $W_{2i+1}$) are the same.}
\item[($\dagger$)] \emph{For every $i \in \{1,\ldots,b\}$, and each black (resp. white) inner vertex $v$, the incident outgoing arcs in $W_{2i}$ and in $W_{2i-1}$ (resp. in $W_{2i}$ and $W_{2i+1}$) are the same.}
\end{itemize}

%Observe that under $\Theta$ the $b$-BGS labelings of $G$ are in bijection with the subclass of $2b$-GS woods satisfying the condition that
%
% for every $i \in \{1,\ldots,b\}$, and each black (resp. white) inner vertex $v$, the arcs leading $v$ to its parent in $W_{2i}$ and in $W_{2i-1}$ (resp. in $W_{2i}$ and $W_{2i+1}$) are the same. 
 
 Let us call this subclass the \emph{even $2b$-GS woods}. Note that Condition ($\dagger$) implies that there are redundancies in considering both the odd and the even colors. Focusing on the even colors leads to the following definition.

%% \begin{definition}\label{def:BGS-woods}
%% A \emph{$b$-bipartite-grand-Schnyder wood}, or \emph{$b$-BGS wood}, of $G$ is a $b$-tuple $(W_1',\ldots,W_b')$ of subsets of arcs satisfying:\begin{itemize}
%%   % \item[(BW0)] For all $i \in [b]$, $W_i'$ is a spanning tree of $G$ rooted at $v_{2i}$ and oriented toward its root. It contains all the outer edges except $\{v_{2i}, v_{2i+1}\}$ and does not contain any inner edge incident to $v_{2i}$ or $v_{2i+1}$.
%%   \item[(BW0)] For all $i \in [b]$, every vertex $v \neq v_{2i}$ has exactly one outgoing arc in $W_i'$, while $v_{2i}$ has no outgoing arc in $W_i'$. For $k \neq 2i$, the arc in $W_i'$ going out of the outer vertex $v_k$ is the outer arc oriented from $v_k$ to $v_{k+1}$. Lastly, $W_i'$ does not contain any inner arc oriented toward $v_{2i}$ or $v_{2i+1}$.
%%   \item[(BW1)] For every inner vertex $v$, the incident outgoing arcs $a_1',\ldots,a_b'$ in $W_1',\ldots,W_b'$ are not all the same, and they appear in clockwise order around $v$.
%%   \item[(BW2)] Let $v$ be a black (resp. white) vertex with outgoing arcs $a_1',\ldots,a_b'$ in $W_1',\ldots,W_b'$ respectively (for $v = v_{2i}$ we adopt the convention $a_i' = (v_{2i}, v_{2i-1})$). If $a$ is an inner arc oriented toward $v$ that belongs to $W_i'$, then $a$ appears strictly between $a_{i+1}'$ and $a_i'$ (resp. $a_i'$ and $a_{i-1}'$) in clockwise order around $v$.
%%   \item[(BW3)] \SL{Updated according to Olivier's corrections:}\\
%% \sl{Let $v$ be a black (resp. white) vertex with outgoing arcs $a_1',\ldots,a_b'$ in $W_1',\ldots,W_b'$ respectively (for $v = v_{2i}$ we adopt the convention $a_i' = (v_{2i}, v_{2i-1})$). Let $a$ be an inner arc oriented toward $v$, let $f$ be the face on its right, and let $\epsilon$ be the number of sets in $W_1',...,W_b'$ containing the opposite arc $-a$.
  
%%   If $a$ belongs to $W_i'$, and $b-\deg(f)/2-\eps \geq 0$, then $a$ appears strictly between $a_{i+1+b-\deg(f)/2-\eps}'$ and $a_i'$ (resp. $a_{i+b-\deg(f)/2-\eps}'$ and $a_{i-1}'$) in clockwise order around $v$.
  
%%   If $a$ does not belong to any tree but is between the outgoing arcs in $W_i'$ and $W_{i+1}'$ in clockwise order around the initial vertex of $a$, and $b-\deg(f)/2-\eps \OB{>} 0$, then $a$ appears strictly between $a_{i+1+b-\deg(f)/2-\eps}'$ and $a_{i+1}'$ (resp. $a_{i+b-\deg(f)/2-\eps}'$ and $a_{i}'$) in clockwise order around $v$.}
%%    \OB{My suggestion was slightly different actually, although it does not change the math:}
%% \ob{Suppose $a$ is an inner arc oriented toward $v$ that belongs to $W_i$. Let $f$ be the face on the right of $a$ and $\epsilon$ be the number of sets in $W_1',...,W_b'$ containing the opposite arc $-a$. If $b-\text{deg}(f)/2-\eps \geq 0$, then $a$ appears strictly between $a_{i+1+b-\text{deg}(f)/2-\eps}'$ and $a_{i+1}'$ (resp. $a_{i+b-\text{deg}(f)/2-\eps}'$ and $a_{i}'$) in clockwise order around $v$. The same holds if $a$ does not belong to any tree but is between the outgoing arcs in $W_i'$ and $W_{i+1}'$ in clockwise order around the origin of $a$.}
 
%%  \SL{Maybe we should explain, when $b - \deg(f)/2 - \eps = 0$, what "$a$ appears strictly between $a_{i+1}'$ and $a_{i+1}'$ " means: I think this only says the opposite arc cannot have color $i+1$.}
%% \OB{Yes I }

%% \end{itemize}
%% \end{definition}

%\SL{I wonder if we should combine (BW2) and (BW3) into one condition (similar to (BW2')) since now they look more alike (than those for ordinary GS woods). Such as:} 
%\OB{Do you say they look more alike because we need to add the convention for $v = v_{2i}$ for BW2 as well? I am ok with either formulation.}

\begin{definition}\label{def:BGS-woods}
A \emph{$b$-bipartite-grand-Schnyder wood}, or \emph{$b$-BGS wood}, of $G$ is a $b$-tuple $(W_1',\ldots,W_b')$ of subsets of arcs satisfying:\begin{itemize}
  \item[(BW0)] For all $i \in [b]$, every vertex $v \neq v_{2i}$ has exactly one outgoing arc in $W_i'$, while $v_{2i}$ has no outgoing arc in $W_i'$. For $k \neq 2i$, the arc in $W_i'$ going out of the outer vertex $v_k$ is the outer arc oriented from $v_k$ to $v_{k+1}$. Lastly, $W_i'$ does not contain any inner arc oriented toward $v_{2i}$ or $v_{2i+1}$.
  \item[(BW1)] For every inner vertex $v$, the incident outgoing arcs $a_1',\ldots,a_b'$ in $W_1',\ldots,W_b'$ are not all the same, and they appear in clockwise order around $v$.
  \item[(BW2)] Let $v$ be a black (resp. white) vertex with outgoing arcs $a_1',\ldots,a_b'$ in $W_1',\ldots,W_b'$ respectively (for $v = v_{2i}$ we adopt the convention $a_i' = (v_{2i}, v_{2i-1})$). Let $a$ be an inner arc oriented toward $v$, let $f$ be the face on its right, let $\epsilon$ be the number of sets in $W_1',...,W_b'$ containing the opposite arc $-a$ and let $m = \max(0,b-\deg(f)/2-\eps)$.

 If $a$ belongs to $W_i'$, then $a$ appears strictly between $a_{i+1+m}'$ and $a_i'$ (resp. $a_{i+m}'$ and $a_{i-1}'$) in clockwise order around $v$. 
  
 If $a$ belongs to none of the sets $W_1',\ldots,W_b'$ but is between the outgoing arcs in $W_i'$ and $W_{i+1}'$ in clockwise order around the initial vertex of $a$, then $a$ appears strictly between $a_{i+1+m}'$ and $a_{i+1}'$ (resp. $a_{i+m}'$ and $a_i'$) in clockwise order around $v$. If $m=0$ this condition means that $-a\neq a_{i+1}'$ (resp. $-a\neq a_{i}'$).
\end{itemize}
\end{definition}



\fig{width=\linewidth}{def-bip-woods}{Condition (BW2)  of $b$-BGS woods, where $m := \max(0,b-\deg(f)/2-\eps)$.}


Conditions (BW2)  are represented in Figure~\ref{fig:def-bip-woods}. We now mention a few facts about $b$-BGS woods, but omit their proofs because they are either easy or similar to the one provided for ordinary GS woods in Section~\ref{sec:remaining-proofs}.
%to see or similar results are claimed in Section~\ref{sec:incarnations} for ordinary GS woods and will be proved in Section~\ref{sec:remaining-proofs}.

\begin{remark}\label{rem:reduced-wood}\hfill
\begin{compactitem}
  % \item \SL{(To be confirmed!)} (BW2) and (BW3) imply that for $i \in [b]$, and $a$ an inner arc in $W_i'$ oriented toward an outer vertex, the terminal vertex of $a$ cannot be in $\{v_{2i},...,v_{2i+1+d-\mathrm{deg}(f)}\}$, where $f$ is the face on the right of $a$. Hence the last statement of $(BW0)$ is redundant.
  \item For each $i \in [b]$, $W_i'$ is a spanning tree of $G$ oriented toward its root $v_{2i}$.
  \item  Similar to the case of ordinary GS woods, if $G$ is $2b$-adapted, then the last statement in Conditions (BW2) (about arcs which are in none of the trees $W_1',\ldots,W_b'$) can be dropped because it is redundant with the other conditions.
%%   \begin{itemize} \item[(BW2')] Let $v$ be a black (resp. white) vertex with outgoing arcs $a_1',\ldots,a_b'$ in $W_1',\ldots,W_b'$ respectively (for $v = v_{2i}$ we adopt the convention $a_i' = (v_{2i}, v_{2i-1})$). Suppose $a$ is an inner arc oriented toward $v$ that belongs to $W_i$, then $a$ appears strictly between $a_{i+1+m}'$ and $a_i'$ (resp. $a_{i+m}'$ and $a_{i-1}'$) in clockwise order around $v$, where $m = \max(0,b-\deg(f)/2-\eps)$, $f$ is the face on the right of $a$, and $\eps$ is the number of trees in $W_1',\ldots,W_b'$ containing the opposite arc $-a$.
%% \OB{I agree with this.}. 
%% \SL{If we adopt the new Condition (NEW BW2), then we'll just say the last statement is redundant.}
\end{compactitem}
\end{remark}

Next, we claim that $b$-BGS woods are in bijection with even $2b$-GS woods. This is not obvious and will be elaborated in the following lemma.

\begin{lemma}\label{lem:reduced-wood}
Let $G$ be a bipartite $2b$-map. Let $\cW=(W_1,...,W_{2b})$ be an even $2b$-GS wood and define the mapping $\lambda$ as $\lambda(W_1,...,W_{2b}) = (W_2,...,W_{2b}) = (W_1',...,W_b')$. Then $\lambda$ is a bijection between even $2b$-GS woods and $b$-BGS woods.
As a result, the set $\bBL_G$ of $b$-BGS labelings of $G$ and the set $\bBW_G$ of $b$-BGS woods of $G$ are in bijection.
\end{lemma}

\begin{proof}
%\SL{To be updated.} First we show that $(W_1',...,W_b') = \lambda(W_1,...,W_{2b})$ is indeed a $b$-BGS wood. Conditions (BW0) and (BW1) are immediate from the conditions (W0) and (W1) of oridinary $2b$-GS woods. 
%Conditions (BW2) and (BW3) can also be easily deduced from the conditions (W2), (W3) and the evenness of $(W_1,...,W_{2b})$. 
%Consider for instance the condition (BW3) for a black vertex $v$. Let $a$ be an arc of $W_{2i}$ oriented toward $v$, and let $f$ be the face on the right of $a$, and let $\delta$ be number of trees in $W_1,\ldots,W_{2b}$ containing the opposite arc $-a$. Suppose $2b-\text{deg}(f) - \delta \geq 0$. By (W3), $b$ is strictly between the arcs $a_{2i+1+d-\text{deg}(f)-\delta}$ and $a_{2i-1}$, where $a_1,\ldots,a_{2b}$ are the arcs in $W_1,...,W_{2b}$ having initial vertex $v$. Since $\cW$ is even, we have $\delta = 2\eps$, $a_{2i-1}=a_{2i}=a_i'$ and $e_{2i+1+d-\text{deg}(f)-\delta}=e_{2i+2+d-\text{deg}(f) - \delta} = e'_{i+1+b-\text{deg}(f)/2-\eps}$. The argument for (BW2) and for white vertices is similar.\OB{The above may need to be adjusted, lumping (BW2) and (BW3) together, if (BW3) is updated according to the above.}
 First we show that $(W_1',...,W_b') = \lambda(W_1,...,W_{2b})$ is indeed a $b$-BGS wood. Conditions (BW0) and (BW1) are immediate from Conditions (W0) and (W1) of ordinary $2b$-GS woods.
Condition (BW2) can also be easily deduced from Conditions (W2), (W3) and the evenness of $(W_1,...,W_{2b})$ as follows.
%Consider the case where $v$ is black. 

Let $a = (u,v)$ be an inner arc of $G$. We consider the case where $v$ is black.
Let $f$ be the face on the right of $a$, and let $2\eps$ be number of sets in $(W_1,\ldots,W_{2b})$ containing the opposite arc $-a$. Let us first assume  $a$ is in $W_i'$. By definition, $a$ is in $W_{2i}$, and since $u$ is white, $a$ is also in $W_{2i+1}$. By applying Conditions (W2) and (W3) to the color $2i$ and $2i+1$, we conclude that $a$ appears strictly between the outgoing arcs in $W_{2i+2k+2}$ and $W_{2i}$ in clockwise order around $v$, where $k = \max(0, 2b-\deg(f)-2\eps)$. This translates to $a$ being strictly between $a_{i+1+m}'$ and $a_i'$, where $m = k/2$. 

Now, suppose $a$ is not in any of the sets $W_1',...,W_b'$, but between the outgoing arcs  $W_i'$ and $W_{i+1}'$ in clockwise order around $u$. Since $u$ is white, $a$ is between the outgoing arcs in $W_{2i+1}$ and $W_{2i+2}$ in clockwise order around $u$.
%$W_1,...,W_{2b}$ but is between the outgoing arcs in $W_{2i+1}$ and $W_{2i+2}$ in clockwise order around $u$ (i.e. $a$ is between the outgoing arcs in $W_i'$ and $W_{i+1}'$). 
The last statement of (W3) implies that $a$ appears strictly between the outgoing arcs in $W_{2i+2k+2}$ and $W_{2i+1}$ in clockwise order around $v$, where $k = \max(0, 2b-\deg(f)-2\eps)$. This translates into $a$ being strictly between $a_{i+1+m}'$ and $a_{i+1}'$. The case where $v$ is white is similar.

Next we prove that $\lambda$ is a bijection. Injectivity follows directly from definition~\ref{def:BGS-woods} as the odd colors $(W_1,W_3,...,W_{2b-1})$ can be recovered from the even ones: the outgoing edge of $W_{i}' = W_{2i}$ at a black (resp. white) inner vertex now also belongs to $W_{2i-1}$ (resp. $W_{2i+1}$). The assignment of odd colors to outer edges is different: for each $i \in [b]$, we simply force that the outer arc $(v_{2i},v_{2i+1})$ to have all the odd colors, and the outer arc $(v_{2i-1},v_{2i})$ to have all the odd colors except for color $2i-1$.

To prove surjectivity, we need to show for any $b$-tuple $\cW'=(W_1',...,W_b')$ satisfying Conditions (BW0-BW2), the tuple $\cW=(W_1,W_2,...,W_{2b})$ obtained by the recovery rule outlined above is an even $2b$-GS wood. As before, it is easy to check that Conditions (BW0-BW2) for $\cW'$ imply Conditions (W0-W3) for $\cW$.
%\OB{I think that the last statement of (W0) is not harder to check than (W2) or (W3) so I deleted the specific discussion about it.}
Hence $\cW$ is a $2b$-GS wood. Moreover it is clear from the definition that $\cW$ is even, which complete the proof of the surjectivity of $\lambda$.
%% Moreover, it is clear that if $\cW$ is a $2b$-GS wood, then it is even. It remains to verfy (W0).
%% The only nontrivial point of (W0) is its last statement. For $i \in [b]$, the last statement of (BW0) guarantees that $W_{2i} = W_i'$ does not contain any inner arc oriented toward $v_{2i}$ or $v_{2i+1}$. To complete the proof, we need to show $W_{2i-1}$ does not contain any inner arc oriented toward $v_{2i-1}$ or $v_{2i}$. Note that by construction an inner arc in $W_{2i_1}$ is either an inner arc in $W_{2i}$ whose initial vertex is a black inner vertex or an inner arc in $W_{2i-2}$ whose initial vertex is a white inner vertex. However, the terminal vertex of the former kind cannot be $v_{2i}$ by (BW0) and also $v_{2i-1}$ since $v_{2i-1}$ is black, and the terminal vertex of the later kind avoids $v_{2i-1}$ by (BW0) and also $v_{2i}$ since $v_{2i}$ is white. Therefore we have proved that for each $k$, $W_k$ does not contain any inner arc oriented toward $v_i$ or $v_{i+1}$ and hence proved the whole lemma.
%% \SL{Or: by the third bullet point of Remark~\ref{rem:reduced-wood}, after (W2) and (W3) are verified, the last statement of (W0) is just a consequence.}
%% \OB{That would not work since Remark~\ref{rem:reduced-wood} is for bipartite woods, and the corresponding statement for ordinry GS has been deleted.}

The argument above immediately implies that the set $\bBL_G$ of $b$-BGS labelings of $G$ and the set $\bBW_G$ of $b$-BGS woods of $G$ are in bijection.  
\end{proof}

%% Lemma~\ref{lem:reduced-wood} immediately implies the following result.

%% \begin{prop}\label{prop:bij-BGS-theta}
%% The set $\bBL_G$ of $b$-BGS labelings of $G$ and the set $\bBW_G$ of $b$-BGS woods of $G$ are in bijection.
%% \end{prop}

%Lemma~\ref{lem:reduced-wood} immediately implies that the set $\bBL_G$ of $b$-BGS labelings of $G$ and the set $\bBW_G$ of $b$-BGS woods of $G$ are in bijection.  
%We conclude this part by summarizing our results:
%Proposition~\ref{prop:bij-BGS-beta}, Proposition~\ref{prop:bij-BGS-gamma} and Proposition~\ref{prop:bij-BGS-theta} into one theorem.

We conclude this subsection with following Theorem, which summarizes Lemma \ref{lem:bij-BGS-beta},  Lemma \ref{lem:bij-BGS-gamma} and Lemma \ref{lem:reduced-wood}:

\begin{thm}\label{thm:bij-BGS}
Given a bipartite $2b$-map $G$, the sets $\bBL_G$ of $b$-BGS labelings, $\bBW_G$ of $b$-BGS woods, $\bBM_G$ of $b$-BGS marked orientations and $\bBA_G$ of $b$-BGS angular orientations are in bijections.
\end{thm}

\subsection{Existence Result}
In this subsection, we state the existence theorem for $b$-BGS structures, and show that it is a consequence of Theorem~\ref{thm:main} for non-bipartite GS structures.

\begin{thm}\label{thm:BGS-main}
Let $b \geq 2$, and let $G$ be a bipartite $2b$-map. There exists a $b$-BGS wood (resp. labeling, marked orientation, angular orientation) for $G$ if and only if $G$ is $2b$-adapted. 

Moreover for any fixed $b$, there is an algorithm which takes as input a $2b$-adapted map, and outputs a $b$-BGS wood (resp. labeling, marked orientation, angular orientation) in linear time in the number of vertices. 
\end{thm}

\begin{proof}
We assume Theorem~\ref{thm:main}, which will be proved in Section~\ref{sec:proof-existence}. Note that $b$-BGS woods can be identified as a subclass of $2b$-GS wood (which is especially clear from the $b$-BGS labeling incarnation), so the necessity of $2b$-adaptedness is clear from Theorem~\ref{thm:main}. 

It remains to prove the sufficiency of $2b$-adaptedness. Let $G$ be a $2b$-adapted bipartite map. By Theorem~\ref{thm:bij-BGS} the different incarnations of $b$-BGS structures are in bijection. Hence it suffices to prove the existence of a $b$-BGS angular orientation. In turn this reduces to proving the existence of an even $2b$-GS angular orientation.

%After establishing the equivalence among different incarnations and their reduced forms, it suffices to prove the existence of one of the incarnations. Here we choose the angular orientation incarnation. 

By Theorem~\ref{thm:main}, $G$ admits a $2b$-GS angular orientation $\cA$. Let us call \emph{odd} the arcs of $G^+$ having an odd weight in $\cA$. If there is no odd arc, then $\cA$ is even and we are done. Otherwise, let us explain how to produce an angular orientation $\cA'$ with fewer odd arcs. 
%If $\cA$ is even, then we can obtain a $b$-BGS angular orientation by dividing the weight of each arc by 2. The rest of the proof is devoted to showing how to convert an uneven $2b$-GS angular orientation to an even one.
Since $G$ is bipartite, the degree of every face is even. Hence the outgoing weight of every vertex of $G^+$ is even and the total weight of every edge of $G^+$ is even. Now, suppose that the arc $a_1 = (u_0, u_1)$ is odd, then the opposite arc $-a = (u_1, u_0)$ is also odd. Since the total outgoing weight of $u_1$ is even, $u_1$ must have another outgoing odd arc $a_2 = (u_1,u_2) $. By repeating this process we get a path of odd arcs $a_1 = (u_0, u_1), a_2 = (u_1,u_2),\ldots$. Note that this path cannot reach the outer vertices, because every arc incident to an outer vertex has even weight. Therefore, the sequence of odd arcs must contain a directed cycle. Note that if we subtract 1 from the weight of every arc in this cycle and add 1 to their opposite arcs, the resulting weighted orientation $\cA'$ is still a $2b$-GS angular orientation of $G$. Moreover, $\cA'$ has fewer odd arcs as promised, and repeating this process leads to an even $2b$-GS angular orientation. 
%In fact, this procedure will become intuitive after we discuss the lattice property of $2b$-GS structures in Section~\ref{sec:lattice}. The operation of subtracting 1 from every arc in a directed cycle while adding 1 to their opposite arcs is closely related to the ordering of the lattice of $2b$-GS structures on $G$.

For the runtime, if $G$ has $n$ vertices, once we obtain some $2b$-GS angular orientation $\cA$, which takes linear time by Theorem~\ref{thm:main}, testing whether $\cA$ is even, or finding all the odd arcs if it is not, takes only linear time since the total number of edges is linear in $n$. The runtime of eliminating all odd arcs is linear in the total number of odd arcs. Hence the total runtime to construct an even $2b$-GS angular orientation is linear in $n$. The conversion from an even $2b$-GS structure to a $b$-BGS structure takes linear time, and the bijections between the different incarnations are also linear, which concludes the proof.
\end{proof}

\begin{Remark}
In the above proof we showed that Theorem~\ref{thm:main} implies Theorem~\ref{thm:BGS-main}. We mention that, conversely, Theorem~\ref{thm:BGS-main} implies Theorem~\ref{thm:main}. Indeed, let us assume Theorem~\ref{thm:BGS-main}, and prove the existence of $d$-GS marked orientations for $d$-adapted maps. Given a $d$-adapted map $G$ we can draw an ``edge vertex'' at the center of every edge to obtain a bipartite $2d$-adapted $2d$-map $\overline{G}$. By Theorem~\ref{thm:BGS-main}, $\overline{G}$ admits a $2d$-GS marked orientation. We can then delete the edge vertices and obtain a $d$-GS marked orientation of $G$ in the way illustrated in Figure~\ref{fig:bgs_to_gs}.
\end{Remark}

\fig{width=\linewidth}{bgs_to_gs}{Merge an edge of $\overline{G}$.}

\subsection{Connections to Known Structures}\label{sec:bip-classical}

%\input{other_structures_bipartite}



%\end{document}

%\documentclass{amsart}
%\input{defs.tex}
%\begin{document}
%\section{A further incarnation for a subclass of $d$-adapted maps}\label{sec:arc_labeling}


We give here a further incarnation of grand-Schnyder structures for a subclass of $d$-adapted maps, called \emph{edge-tight}. This incarnation
%, very close to the corner labeling incarnation, 
will be particularly convenient to establish connections between grand-Schnyder structures and classical objects such as transversal structures and Felsner woods.


A $d$-map $G$ is called \emph{edge-tight} if for every inner edge $e$ the incident faces $f,f'$ satisfy $\deg(f)+\deg(f')=d+2$. Equivalently, $G$ is 
edge-tight if for every inner edge $e$ the cycle enclosing the two faces incident to $e$ has length~$d$. 
It is easy to see that, for such a map, there exist some integers $g,h$ such that $g+h=d+2$ and all inner faces have degree $g$ or $h$, and every inner edge has a face of degree $g$ on one side and of degree $h$ on the other side. Note also that if $g\neq h$, then every inner vertex has even degree. The example in Figure~\ref{fig:example_edge_tight} has $g=3,h=4$. 

For a $d$-map $G$, an \emph{arc labeling} is the assignment of a label in $[d]$ to any inner arc, and the assignment of label $i$ to the outer arc $(v_i,v_{i+1})$ for all $i\in[d]$. 
A \emph{label jump} from an arc $a$ labeled $i$ to an arc $a'$ labeled $i'$ is defined as the integer $\delta\in \{0,1,\ldots,d-1\}$ such that $i+\delta=i'$ modulo $d$. For an inner vertex $v$ of $G$, we consider the arcs having initial vertex $v$, and we call \emph{$v$-clockwise jump} a label jump from such an arc to the next in clockwise order around $v$.
For an inner face $f$ of $G$, we consider the incident arcs having $f$ on their right, and we call \emph{$f$-clockwise jump} a label jump from such an arc to the next in clockwise order around $f$.
%Old version: For any arc $a$, the face incident to $a$ is considered here to be the face on its right. A clockwise jump around an inner vertex (resp. inner face) is the jump of labels from an arc to the next arc in clockwise order around the vertex (resp. face).  

\begin{figure}
\begin{center}
\includegraphics[width=0.85\linewidth]{local_arc}
\end{center}
\caption{The local rules for grand-Schnyder arc labelings.}
\label{fig:local_arc}
\end{figure}

\begin{definition}\label{def:arcLabeling}
For $G$ a $d$-map, a \emph{grand-Schnyder arc labeling} of $G$ (or \emph{$d$-GS arc labeling} for short) is an arc labeling of $G$  satisfying the following conditions which are represented in Figure~\ref{fig:local_arc}:
\begin{itemize}
\item[(AL0)] For all $i\in [d]$, all the inner arcs with initial vertex $v_i$ have label $i$.
\item[(AL1)] For every inner vertex $v$ of $G$, the sum of $v$-clockwise jumps  is $d$.
\item[(AL2)] 
%For every inner vertex $v$ and every clockwsise-consecutive arcs $a,a'$ having initial vertex $v$, the label jump from $a$ to $a'$ is at most $d-\deg(f)$, where  $f$ is the face at the right of $a$.
For every two consecutive arcs $a,a'$ in clockwise order around an inner vertex $v$ (both having initial vertex $v$), the label jump from $a$ to $a'$ is at most $d-\deg(f)$, where  $f$ is the face containing the corner between $a$ and $a'$. 
\item[(AL3)] For two opposite inner arcs $a$ and $-a$,  the label-jump from $a$ to $-a$ is $d+1-\deg(f)$, where $f$ is the face on the right of $a$. 
\end{itemize}
\end{definition}
An example is given in Figure~\ref{fig:example_edge_tight}. 

\begin{figure}
\begin{center}
\includegraphics[width=\linewidth]{example_edge_tight}
\end{center}
\caption{Center: an edge-tight 5-adapted map (with inner face degrees in $\{3,4\}$), 
endowed with a $5$-GS arc labeling, where labels of arcs are indicated on the right of the arcs. 
Left: the corresponding corner labeling obtained by applying the bijection $\Lambda$ (that is, pulling 
the label of every arc to the corner at the initial vertex of the arc, on the right side of the arc).  
Right: the corresponding $5$-GS angular orientation obtained by applying the bijection $\Gamma$ (the weights of original arcs are 0 since the map is edge-tight).}
\label{fig:example_edge_tight}
\end{figure}

\begin{lemma}\label{lem:necessity_balanced}
If a $d$-map $G$ can be endowed with a $d$-GS arc labeling, then $G$ is edge-tight.
\end{lemma}
\begin{proof}
Let $a,a'$ be two opposite inner arcs, and let $f,f'$ be the incident faces on the right of $a$ and $a'$ respectively. Condition (AL3) implies that the label-jump from $a$ to $a'$ is $d+1-\deg(f)$, while the  label-jump from $a'$ to $a$  is $d+1-\deg(f')$. Since these jumps are non-zero (and less than $d$), they must add up to $d$, so that $\deg(f)+\deg(f')=d+2$. 
\end{proof}

%\SL{trivial case (only a d-gon)?}\EF{The statement seems to still work (?)}\OB{Yes the statement is still true for that case.}

We also have the following property (the analog of Property (L2) and Property (L1) for faces in the definition of $d$-GS corner labelings, the property is here a consequence of the definition):

\begin{lemma}\label{lem:arc-label}
Let $G$ be a $d$-map  endowed with a $d$-GS arc labeling. For any inner face $f$, the $f$-clockwise jumps are non-zero and add up to $d$.
\end{lemma}
\begin{proof}
Let $a',a''$ be a pair of opposite arcs on an inner edge $e$ of $G$, let $v$ be the origin of $a'$, let $f$ be the face
on the right of $a''$, and let $a$ be the next arc after $a'$ in counterclockwise order around $v$. 
%Let $\ell,\ell',\ell''$ be the labels of $a,a',a''$. 
By (AL3), the label jump from $a''$ to $a'$ is $\jp(a'',a')=d+1-\deg(f)$. 
 If $v$ is an inner vertex, by (AL2) the label jump from $a$ to $a'$ satisfies 
 $\jp(a,a')\leq d-\deg(f)$. If $v$ is an outer vertex $v_i$ (for $i\in[d]$), then we have
 $\jp(a,a')=0\leq d-\deg(f)$. So in both cases  $\jp(a,a')<\jp(a'',a')$.
 
 Since $\jp(a,a')<\jp(a'',a')$, the label jump from $a''$ to $a$ satisfies
 \[
 \jp(a'',a)=\jp(a'',a')-\jp(a,a').
 \]
 It also implies that $\jp(a'',a)>0$. When $a',a''$ cover all ordered pairs of opposite inner arcs, $a'',a$ cover all pairs of consecutive arcs in clockwise order around inner faces, except for the pairs whose first  arc is $(v_i,v_{i+1})$ for some $i\in[d]$, for which the clockwise jump is $1$. Hence, all clockwise jumps in inner faces are non-zero. 

Let $V,E,F$ be the sets of inner vertices, inner edges, and inner faces of $G$; and let $J$ be the sum of clockwise-jumps around the inner faces of $G$. 
 Then, the sum of the left-hand-side in the above identity (over all ordered pairs $a',a''$ of  opposite arcs on inner edges) is $J-d$. The sum of the first (resp. second) term of the right-hand side is $d|E|$ (resp. $d|V|$). Hence,  $J-d=d|E|-d|V|$, which gives $J=d|F|$ by the Euler relation. 
Since the sum of $f$-clockwise jumps is a non-zero multiple of $d$ for every inner face $f$, we conclude that it must be equal to $d$ for every inner face.  
\end{proof}

As we now explain, for an edge-tight $d$-map, the $d$-GS arc labelings are in easy bijection with the $d$-GS corner labeling. The bijection $\Lambda$ is illustrated in Figure \ref{fig:example_edge_tight}.

\begin{prop}
For $G$ an edge-tight $d$-map endowed with a $d$-GS arc labeling $\cAL$, let $\cL=\Lambda(\cAL)$ be the 
labeling of inner corners of $G$ such that any inner corner receives the label of the arc that has the corner on its right at its origin.  Then $\Lambda$ is a bijection between the set $\bAL_G$ of $d$-GS arc labelings of $G$, and the set $\bL_G$ of $d$-GS corner labelings of $G$.

Hence, by Theorem~\ref{thm:main}, a $d$-map admits a $d$-GS arc labeling if and only if it is edge-tight and $d$-adapted.
\end{prop}

\begin{proof}
Conditions (AL0), (AL1), (AL3), and Lemma~\ref{lem:arc-label} ensure that $\Lambda(\cAL)$ is a $d$-GS corner labeling. The inverse mapping $\bLa$ is as follows. For $\cL$ a $d$-GS corner labeling, $\cAL=\bLa(\cL)$ is the arc labeling of $G$ such that each arc $a$ receives the label of the corner at its origin and in the face on its right. Since $\cL$ is a $d$-GS corner labeling, Properties (AL0), (AL1) are satisfied by $A$. Next, we prove Property (AL3).
Let  $a,a'$ be opposite inner arcs, and let $f,f'$ be the faces on the right of $a,a'$ respectevily. Condition (L3) implies that the label-jump from $a$ to $a'$ satisfies $\jp(a,a')\geq 1+d-\deg(f)$, 
and that the label-jump from $a'$ to $a$ satisfies $\jp(a',a)\geq 1+d-\deg(f')$. Since 
$\deg(f)+\deg(f')=d+2$, we must have  $\jp(a,a')= 1+d-\deg(f)$ and
 $\jp(a',a)= 1+d-\deg(f')$, so that (AL3) holds. It remains to prove (AL2).
Let $a,a'$ be two consecutive arcs in clockwise order around an inner vertex $v$, let $f$ be the face on the right of $a$, and let $a''$ be the arc opposite to $a'$. 
Conditions (L1) and (L2) imply that $1\leq \jp(a'',a)\leq d+1-\deg(f)$. Since $\jp(a'',a')=d+1-\deg(f)$, we conclude that $\jp(a,a')\leq d-\deg(f)$, hence Condition (AL2) holds.  Thus, $\cAL=\bLa(\cL)$ is a $d$-GS arc labeling.

Lastly, it is clear that $\bLa\circ\Lambda=\Id_{\bAL_G}$ and $\Lambda\circ\bLa=\Id_{\bL_G}$, thus $\Lambda,\bLa$ are bijections.
\end{proof}



In terms of $d$-GS angular orientations, the condition of being edge-tight is reflected by the fact that all original edges have weight $0$. Let $G$ be a $d$-adapted edge-tight map. The bijection $\Gamma$ between the $d$-GS arc labelings of $G$ and the $d$-GS angular orientations of $G$ is represented in Figure \ref{fig:bij-arc-labeling-angular}. For an arc labeling $\cAL$ of $G$, the angular orientations $\Gamma(\cAL)$ is obtained as follows:  for each pair $a,a'$ of consecutive inner arcs in clockwise order around a vertex $v$, with $f$ the face incident to $v$ between $a$ and $a'$, the weight of the star-arc from $v$ to $v_f$ is equal to the clockwise jump from $a$ to $a'$ (moreover, letting $s_i$ be the star vertex in the face incident to $(v_{i-1},v_i)$, as usual the weight of the star-arc from $v_i$ to $s_i$ is set to $d-\mathrm{deg}(s_i)$ and the weight of the star-arc from 
$v_{i+1}$ to $s_i$ is set to $0$). An example is given in Figure~\ref{fig:example_edge_tight}.  
\fig{width=\linewidth}{bij-arc-labeling-angular}{Bijection $\Gamma=\Psi\circ\Phi\circ\Lambda$ between the sets $\bAL$ of $d$-GS arc labelings and the set $\bA$ of angular orientations for an edge-tight map $G$}
%\newcommand{\bE}{\mathbf{E}}


The conditions of being $d$-adapted and edge-tight are quite restrictive, and impose some constraints on the degrees of the faces. Recall that for an edge-tight $d$-adapted map there exist some integers $g, h$, with $g+h=d+2$, such that every inner edge has a face of degree $g$ on one side and a face of degree $h$ on the other side. %For $g\leq h$ we denote by   $\bE_{g,h}$ the set of edge-tight $(g+h-2)$-adapted maps with inner face degrees in $\{g,h\}$. 

\begin{lem}\label{lem:degree-edge-tight}
Let $g\leq h$. The set $\bE_{g,h}$ of edge-tight $(g+h-2)$-adapted maps with inner face degrees in $\{g,h\}$ and at least one inner vertex is non-empty if and only if $(g,h)$ belongs to the set
\begin{equation*}%\label{eq:degree-tight}
S=\{(2,d),~d\geq 3\}\cup \{(3,3), (3,4), (3,5),(4,4),(5,5)\}.
\end{equation*}
Moreover, in that case, the family $\bE_{g,h}$ is infinite. 
\end{lem}

%\SL{trivial case with no inner vertices (i.e. (g+h-2)-gon with one chord)?}\EF{Fixed in the statement, thanks!}

\begin{proof} 
It is easy to see that the inner vertices in edge-tight adapted maps have degree at least 3. Moreover, if $g\neq h$ the degree of vertices is even, hence at least 4.
Combining these observations with the Euler relation (and the incidence relation between faces and edges), one can easily check that $E_{g,h}$ is empty unless it is in the set $S$. 
About the second statement,  
the maps in $\bE_{2,d}$ are those obtained from $d$-angulations of girth $d$, opening 
every inner edge (and an arbitrary subset of the outer edges) into a face of degree $2$. 
The maps in $\bE_{3,3}$ (resp. $\bE_{4,4}$) are the so-called \emph{irreducible} triangulations of the 4-gon (resp. \emph{irreducible} quadrangulations of the hexagon) which are known to form an infinite family \cite{tutte1962census,mullin1968enumeration,FuPoScL,Fu07b,bouttier2014irreducible}.  
Finally, for the three other cases $(g,h)\in\{(5,5),(3,4),(3,5)\}$, as shown in Figure~\ref{fig:fractal}, one can construct infinitely many maps in $\bE_{g,h}$ by a ``tunnel-construction": given a sequence $L_0,\ldots,L_k$
such that $L_i$ has a marked corner in the outer face for $0\leq i<k$, and a marked corner in an inner face for $0< i\leq k$, the assembled map is obtained by identifying the 
marked outer corner of $L_i$ with the marked inner corner of $L_{i+1}$ for $0\leq i<k$ (thereby identifying the contours of their incident faces). 
\end{proof}

\begin{figure}
\begin{center}
\includegraphics[width=\linewidth]{fractal_bis}
\end{center}
\caption{The maps $(L_i)_{0\leq i\leq k}$ whose tunnel-assembling yields a map in $\bE_{5,5}$ (left column), $\bE_{3,4}$ (middle column), and $\bE_{3,5}$ (right column).} 
\label{fig:fractal}
\end{figure}

%% \begin{remark}
%% The condition of being $d$-adapted and edge-tight is quite restrictive. Indeed, all inner vertices in such maps must have degree larger than $2$. Using the Euler relation, one easily checks that,  for $g< h$ positive integers, if $\bE_{g,h}$ denotes the set of edge-tight $(g+h-2)$-adapted maps with inner face degrees in $\{g,h\}$ and with at least one inner vertex, then the values of $g,h$ for which $\bE_{g,h}$ is non-empty are $\{g=2,h\geq 3\}$, and $\{g=3,h\in\{4,5\}\}$. 
%% And if $\bE_{d}$ denotes the set of $(2d-2)$-adapted maps with inner faces of degree~$d$ (necessarily edge-tight), and at least one inner vertex, then the values of $d$ for which $\bE_{d}$ is non-empty are $d\in\{3,4,5\}$ \OB{Warning: this is not the same $d$ as usual !}
%%   (for example, regular polyhedra with one edge removed).  
%% \end{remark}


\begin{figure}
\begin{center}
\includegraphics[width=\linewidth]{octogon}
\end{center}
\caption{Left: an edge-tight pentagulated 8-adapted map endowed with an $8$-GS arc labeling. 
Right: the 4 associated plane bipolar orientations $B_1,B_2,B_3,B_4$.}
\label{fig:octogon}
\end{figure}



For the rest of this section we focus on the special case of $2b$-adapted maps with all inner faces of the same degree $b+1$. These are edge-tight maps, and by Lemma \ref{lem:degree-edge-tight} only the values $b\in \{2,3,4\}$ are relevant. Note that for any arc labeling $\cAL$ of such a map, the  labels of any two opposite inner arcs are opposite modulo $2b$ (that is, the labels of an edge are of the form $\{j,j+b\}$). We now associate to $\cAL$ a tuple of oriented submaps, as illustrated in  Figure~\ref{fig:octogon}.
\begin{definition}\label{def:Delta}
Let $G$ be such a $(b+1)$-angulation of the $2b$-gon. To an arc labeling $\cAL$ of $G$, we associate a tuple $\beta(\cAL)=(B_1,\ldots,B_{2b})$ of oriented maps. For each  $i\in[2b]$,  the oriented map $B_i$ is obtained from $\cAL$ as follows:
%made of the inner arcs of $G$ whose label $j$ satisfy $i<j<i+b$, together with the 2 directed paths made of outer arcs going from $s_i:=v_{i+\lfloor b/2\rfloor}$ to $t_i:=v_{i-\lceil b/2\rceil}$.
\begin{itemize}
\item
The inner edges of $G$ with arc labels $\{i,i+b\}$ are removed, and the other inner edges are oriented as their arc whose label $j$ satisfy $i<j<i+b$.
\item
The outer edges of $G$ are directed so as to form two paths from $s_i:=v_{i+\lfloor b/2\rfloor}$ to $t_i:=v_{i-\lceil b/2\rceil}$.
\end{itemize} 
\end{definition}
Note that if $\beta(\cAL)=(B_1,\ldots,B_{2b})$, then the oriented map $B_{i+b}$ is the reverse of $B_i$. 
%% Let $G$ be such a $(b+1)$-angulation of the $2b$-gon, endowed with an arc labeling $\cAL$. Note that the labels of any two opposite inner arcs are opposite modulo $2b$. 
%% For each  $i\in[2b]$,  one can form an oriented map $B_i$ as follows (see Figure~\ref{fig:octogon}):
%% \begin{itemize}
%% \item
%% The outer edges are directed so as to form two paths from $s_i:=v_{i+\lfloor b/2\rfloor}$ to $t_i:=v_{i-\lceil b/2\rceil}$.
%% \item
%% The inner edges of arc labels $(i,i+b)$ are removed, and each other inner edge is oriented as its arc whose
%% label is between $i$ and $i+b$.  
%% \end{itemize} 
%% Note that $B_{i+b}$ is the reverse of $B_i$. 

\begin{Def}
A \emph{plane bipolar orientation} is a plane map $B$ endowed with an acyclic orientation having a unique source $s$ and a unique sink $t$ (also called its target), both incident to the outer face. 
\end{Def}

Let $B$ be a plane bipolar orientation with source $s$ and sink $t$. It is well known that for any vertex $v\in\{s,t\}$, the edges incident to $v$ form an interval of ingoing edges and an interval of outgoing edges~\cite{de1995bipolar}. 
The \emph{leftmost outgoing tree} of $B$ is the spanning tree rooted at the sink, where the parent-edge of any non-sink vertex is its leftmost outgoing edge. The \emph{rightmost ingoing tree} of $B$ is the spanning tree rooted at the source, where the parent-edge of any non-source vertex is its rightmost ingoing edge (the last one in counterclockwise order).  

\begin{prop}
Let $b\in\{2,3,4\}$, and let $G$ be an edge-tight $2b$-adapted map with inner faces of degree $b+1$, endowed with a $(2b)$-GS arc labeling $\cAL$. Then for $i\in[2b]$, the oriented map $B_i$ is a plane bipolar orientation with source $s_i$ and target $t_i$.  
\end{prop}



\begin{proof}
Let $i\in[2b]$. Property (AL2) ensures that, in $G$, the clockwise-jumps around an inner vertex $v$ are at most $b-1$, hence in $B_i$ $v$ has at least one outgoing and at least one ingoing edge. Also, by construction, the only source (resp. sink) among the outer vertices is $s_i$ (resp. $t_i$). It remains to show that $B_i$ is acyclic. 

First, one easily checks that no directed cycle can visit an outer vertex (indeed, for each of the two outer paths from $s_i$ to $t_i$, the vertices on the first half of the path have all their incident inner edges outgoing, and the vertices on the second half of the path have all their incident inner edges ingoing). 

Next, one checks that no contour of an inner face $f$ of $G$ can be a directed cycle in $B_i$. 
From what we have seen above, we can assume that $f$ is not incident to any outer vertex. In that case,  
the clockwise arcs around $f$ that are (seeing an arc as a directed edge) in $B_i$ are those of label between $i$ and $i+b$ (excluded).  By Lemma~\ref{lem:arc-label},   
all clockwise-jumps around $f$ are at most~$b$.
Hence, not all edges around $f$ can be clockwise in $B_i$, so there is no inner face of $G$ whose contour is a clockwise cycle of $B_i$. Similarly,  
no contour of inner face of $G$ is a   counterclockwise cycle of $B_i$.    

Finally, for $i\in[2b]$, assume that $B_i$ has a directed cycle, and let $C$ be a minimal one, i.e., the interior of $C$ does not contain the interior of another directed cycle $C'$. Assume there is a vertex $v$ in the interior of $C$. Since the vertices in the interior of $C$ are different from  $\{s_i,t_i\}$, from $v$ starts a directed path in $B_i$. By minimality of $C$, this path can not loop into a cycle, hence 
it has to reach a vertex on $C$. Similarly, from $v$ starts a path of edges of $B_i$ taken in reverse direction, which also has to reach a vertex on $C$. The concatenation of these two paths forms a directed path in $B_i$, in the interior of $C$, starting and ending on $C$. This contradicts the minimality of $C$. Hence there is no vertex in the interior of $C$. Similarly there can be no edge of $B_i$ inside $C$ (it would form a chord, contradicting the minimality of $C$). Since $C$ is not the contour of a face of $G$, there must a chord $e$  inside $C$ with labels $(i,i+b)$. However, if $C$ is clockwise, Condition (AL1) ensures that no arc of label $i$ can leave a vertex of $C$ toward the interior of $C$; similarly, if $C$ is counterclockwise, no arc of label $i+b$ can leave a vertex of $C$ toward the interior of $C$. 
We reach a contradiction. Hence, $B_i$ is a plane bipolar orientation.        
\end{proof}


Figure~\ref{fig:octogon} shows an example for $b=4$. We will discuss the case $b=2$ (connected to transversal structures) in Section~\ref{sec:transversal}, and the case $b=3$ (connected to Felsner woods) in Section~\ref{sec:Felsner}. 

\begin{remark}\label{rk:bipolarBi}
Let $b\in\{2,3,4\}$, and let $G$ be an edge-tight $2b$-adapted map with inner faces of degree $b+1$, endowed with a $(2b)$-GS arc labeling $\cAL$. 
There is a close connection between the plane bipolar orientations $B_i$, and the $(2b)$-GS wood $(W_1,\ldots,W_{2b})$ in bijection with $\cAL$.
%Note that, for $G$ an edge-tight $2b$-adapted map with inner faces of degree $b+1$, endowed with a $b$-GS arc labeling $\cAL$, the corresponding $(2b)$-GS wood $(W_1,\ldots,W_{2b})$ is such that, 
Namely, for $i\in[2b]$, $W_i$ is the leftmost outgoing tree of $B_i$ (and also the rightmost ingoing tree of $B_{i+b}$), up to changing the root-vertex from $v_i$ to $v_{i-\lceil b/2\rceil}$, and changing the missing outer edge from $(v_i,v_{i+1})$ to $(v_{i+\lfloor b/2\rfloor -1},v_{i+\lfloor b/2\rfloor})$ (that is, the missing outer edge is the same for $b\in\{2,3\}$, and changes to $(v_{i+1},v_{i+2})$ for $b=4$).
\end{remark}






%\bibliographystyle{plain}
%\bibliography{biblio-Schnyder}
%\end{document}

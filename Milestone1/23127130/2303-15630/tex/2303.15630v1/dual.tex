%\documentclass[a4paper]{amsart}%[a4paper]
%\input{defs}
%\begin{document}
%\section{Dual of Grand-Schnyder Structures and the Bipartite Case}


In this section, we study the structures obtained by taking the ``dual" of grand-Schnyder structures, and of their bipartite analogs. In the forthcoming article \cite{OB-EF-SL:4-GS-drawing}, we will use the dual of 4-grand-Schnyder woods to design some graph-drawing algorithms.
%gives rise to an orthogonal graph-drawing algorithm, that is, every edge of the (plane) graph is drawn as sequence of horizontal and vertical segments.

Recall that the \emph{dual} $G^*$ of a plane map $G$ is obtained as follows: 
\begin{compactitem}
\item we draw a vertex $v_f$ of $G^*$ inside every face $f$ of $G$ and call $v_f$ the \emph{dual vertex} of $f$, %(in previous sections, we used the term \emph{star vertex}). 
\item and we draw an edge $e^*$ of $G^*$ connecting $v_f$ and $v_g$ across each edge $e$ separating the faces $f$ and $g$ of $G$, and call $e^*$ the \emph{dual edge} of the \emph{primal edge} $e$.
\end{compactitem}
The dual vertex of the outer face of $G$ is called the \emph{root-vertex} of $G^*$ and is denoted by $v^*$. Under this construction, the degree of the vertex $v_f$ is equal to the degree of the face $f$. The \emph{dual of a corner} is also well-defined: it is the corner of $G^*$ that faces the original corner of $G$.

If $G$ is a $d$-map, then we call its dual $G^*$ a \emph{dual $d$-map}. More concretely, a \emph{dual $d$-map} is a vertex-rooted plane map whose vertices have degree at most~$d$ and whose root-vertex has degree~$d$ and is incident to $d$ distinct faces. In this case, the edges $e_1^*,\ldots,e_d^*$ in counterclockwise order around $v^*$ are called \emph{root-edges}, where $e_i^*$ is the dual edge of $\{v_i,v_{i+1}\}$. The faces $f_1^*,\ldots,f_d^*$ in counterclockwise order around $v^*$ are called \emph{root-faces}, where $f_i^*$ is dual to $v_i$.

% If in addition $G$ is $d$-adapted, then its dual $G^*$ is called \emph{dual $d$-adapted}: it satisfies the characteristic property that every \emph{cut} that does not separate a single vertex has size at least $d$. Hence a dual $d$-map $G^*$ is dual $d$-adapted if and on if its primal map $G$ is $d$-adapted.

We call a dual $d$-map $G^*$ \emph{dual $d$-adapted} if every \emph{cut} that does not separate a single vertex has size at least $d$. Note that this is exactly the dual notion of $d$-adaptedness, hence a dual $d$-map $G^*$ is dual $d$-adapted if and on if its primal map $G$ is $d$-adapted.

\subsection{Dual of grand-Schnyder structures}\label{sec:dual-GS} \hfill\\
We give two incarnations for the ``dual'' of $d$-GS structures, one in terms of corner labeling and the other as a tuple of trees. These two incarnations are represented in Figure~\ref{fig:4_dual}. They are closely related to the corner labeling and wood incarnations of GS structures of the primal map. 
%OB: I deleted: Even though it is also possible to ``dualize'' the other two incarnations of GS structures, namely marked orientations and angular orientations, they are neither natural nor useful in the view of the algorithms we are proposing in the forthcoming article. Hence they are omitted.

\fig{width=\linewidth}{4_dual}{Wood and labeling of a dual 4-GS structure.}

\begin{definition}\label{def:dual-GS-labeling}
Let $G$ be a $d$-map. A \emph{dual $d$-grand-Schnyder corner labeling}, or \emph{dual $d$-GS labeling}, of $G^*$ is an assignment to each corner of $G^*$ of a label in $[d]$ satisfying: \begin{itemize}
  \item[(L0\sups{*})] The corners incident to the root-face $f_i^*$ have label $i$.
  \item[(L1\sups{*})] Around every non-root face or non-root vertex, the sum of clockwise jumps is $d$.
  \item[(L2\sups{*})] Consecutive corners around a vertex have distinct labels.
  \item[(L3\sups{*})] Let $a$ be an arc not incident to the root-vertex, and let $v$ be its initial vertex. Then the sum of the clockwise jump across $a$ and the clockwise jump along $a$ is at least $1+d-\text{deg}(v)$.
\end{itemize} 
\end{definition}

\fig{width=\linewidth}{dual-labeling}{Conditions defining dual $d$-GS labelings.}

The conditions defining dual $d$-GS labelings are represented in Figure~\ref{fig:dual-labeling}. As indicated in Figure~\ref{fig:4_dual}(a), there is a simple bijection between the $d$-GS labelings of $G$ and the dual $d$-GS labelings of $G^*$.
 Consider the following operation: given a corner labeling $\cL$ of $G$,  we first complement $\cL$ by labeling the outer corner at $v_i$ by $i$, and then give every corner of $G^*$ the label of its dual corner. We denote this operation by $\De$. It is easy to see that the Conditions (L0\sups{*}) $\sim$ (L3\sups{*}) are just translations of the Conditions (L0) $\sim$ (L3) of $d$-GS labelings via $\Delta$. Hence Theorem~\ref{thm:main} gives:

\begin{prop}\label{prop:existence-dual-labeling}
Let $G$ be a $d$-map. The mapping $\De$ is a bijection between the set of $d$-GS labelings of $G$ and the set of dual $d$-GS labelings of $G^*$. Hence $G^*$ admits a dual $d$-GS labeling if and only if $G^*$ is dual $d$-adapted, and in this case a dual $d$-GS labeling can be computed in linear time in the number of vertices of $G^*$.
\end{prop}

Now we present the incarnation of dual GS structures as a tuple of subsets of arcs $(W^*_1,...,W^*_d)$. We will see in Proposition~\ref{prop:primal_dual_woods} that a dual GS wood is also a tuple of spanning trees of the dual map, though this is not explicitly stated in the definition. As before, we interpret the tuple $(W^*_1,...,W^*_d)$ in terms of colorings, and say that an arc $a$ of $G^*$ \emph{has a color $i$} if this arc is in $W_i^*$. 

\begin{definition}\label{def:dual-GS-woods}
Let $G$ be a $d$-map. A \emph{dual $d$-grand-Schnyder wood}, or \emph{dual $d$-GS wood} of $G^*$ is a tuple $\mathcal{W^*} = (W^*_1,...,W^*_d)$ of subsets of arcs of $G^*$ satisfying: \begin{itemize}
  % \item[(W0\sups{*})] For each $i \in [d]$, every non-root vertex $v$ has exactly one outgoing arc in $W^*_i$. The arc of $e_i^*$ with initial vertex $v^*$ has no color, and its opposite arc has only the color $i$.
  % \item[(W1\sups{*})] Every arc whose initial vertex is not $v^*$ is in at least one of the sets $W^*_1,...,W^*_d$. Let $v$ be a non-root vertex with outgoing arcs $a_1,...,a_d$ in the sets $W^*_1,...,W^*_d$, respectively. The arcs $a_1,...,a_d$ appear in clockwise order around $v$ (with the situation $a_i = a_{i+1}$ allowed.)
  % \item[(W2\sups{*})] \SL{(To be confirmed!)} Let $a$ be an arc with initial vertex $v \neq v^*$ and let $\de$ be the number of sets $W^*_1,...,W^*_d$ containing $a$. If $a$ is in $W^*_i$, then the opposite arc $-a$ is not in $W^*_i,...,W^*_{i+m}$, where $m = \max(0, 1+d-\text{deg}(v)-\de)$.
  \item[(W0\sups{*})] For each $i \in [d]$, every non-root vertex $v$ has exactly one outgoing arc with color $i$. The arc of $e_i^*$ with initial vertex $v^*$ has no color, and its opposite arc has only color $i$.
  \item[(W1\sups{*})] Every arc whose initial vertex is not $v^*$ has at least one color. Let $v$ be a non-root vertex with outgoing arcs $a_1,...,a_d$ with colors $1,...,d$, respectively. The arcs $a_1,...,a_d$ appear in clockwise order around $v$ (with the situation $a_i = a_{i+1}$ allowed).
  \item[(W2\sups{*})] Let $a$ be an arc with initial vertex $v \neq v^*$ and let $\de$ be the number of colors of $a$. If $a$ has color $i$, then the colors of the opposite arc $-a$ form a subset of $[i+1+m:i[$, where $m = \max(0, 1+d-\text{deg}(v)-\de)$.
  
%\SL{I wonder if we should formulate this into a crossing condition: Let $a$ be an arc with initial vertex $v \neq v^*$ and $\de$ be the number of colors of $a$. Let $u$ be the terminal vertex of $a$ and $a_1,...,a_d$ be its outgoing arcs in $W_1^*,...,W_d^*$, respectively. If $a$ has color $i$, then $a$ appears strictly between $a_{i+m}$ and $a_i$, in clockwise order around $u$. We need to mention that if $m = 0$, then it only requires that two opposite arcs cannot have the same color (as for dual Schnyder decomposition for $d$-regular maps). Also, root-edges may need a few more words.} \OB{The crossing condition version is more complicated, so I would stick with the current one. However we can add a remark to explain this interpretation. I have writen it bellow. I suggest we don't repeat it for the bipartite case: the reader can figure it out.}
\end{itemize}
\end{definition}

A dual $d$-GS wood is represented in Figure~\ref{fig:4_dual}(b). 
\begin{remark}
Condition (W2\sups{*}) of dual $d$-GS woods can be interpreted as a ``crossing condition'' for the trees $(W^*_1,...,W^*_d)$. Precisely, let $a$ be an arc in $W_i^*$ with terminal vertex $v\neq v^*$, and let $a_1,...,a_d$ be the arcs in $W_1^*,...,W_d^*$ with initial vertex $v$. Then (W2\sups{*}) states that $a$ appears strictly between $a_{i+m}$ and $a_i$, in clockwise order around $v$, where $m = \max(0, 1+d-\text{deg}(v)-\de)$ and $\de$ is the number of colors of $a$ (when $m=0$ this simply means $a\neq -a_i$).
\end{remark}


In the definition of dual $d$-GS woods the arcs with initial vertex $v^*$ are quite special. We will call \emph{outside arcs} the arcs with initial vertex $v^*$, and \emph{inside arcs} all the other arcs.
%out of our consideration. Hence we give them a special name: we call arcs with initial vertex $v^*$ the \emph{outside arcs}. All other arcs are called \emph{inside arcs}. 

We now define a mapping $\Theta^*$ between the dual $d$-GS labelings and dual $d$-GS woods that is very similar to the mapping $\Theta$ defined in Section \ref{sec:statements}: given a dual $d$-GS labeling $\cL^*$, let $\Theta^*(\cL^*) = (W^*_1,\ldots,W^*_d)$ be the tuple such that each arc whose initial vertex is not $v^*$ has the color set $[i:j[$, where $i$ and $j$ are the labels of the corners that are respectively on its left and on its right, at its initial vertex. We do not assign colors to outside arcs.

\begin{prop}\label{prop:bij-dual-labeling-wood}
The mapping $\Theta^*$ is a bijection between the dual $d$-GS labelings of $G^*$ and the dual $d$-GS woods of $G^*$.
\end{prop}

\begin{proof}
Let $\cL^*$ be a dual $d$-GS labeling on $G^*$. First we show that $\Theta^*(\cL^*)$ is indeed a dual $d$-GS wood. The properties (W0\sups{*}) and (W1\sups{*}) are clear from (L0\sups{*}) $\sim$ (L2\sups{*}) plus the convention that $\Theta^*$ uses about outside arcs. 

It remains to verify (W2\sups{*}). Observe that if $a$ incident to the root-verted, then (W2\sups{*}) holds by construction, so we now assume that $a$ is not incident to the root-vertex.  Observe that the sum of counterclockwise jumps around $e$ is equal to $d$. % (which is true even for root-edges). 
This property follows from Lemma~\ref{lem:ccw-jumps-edges} via duality. 
%To prove the claim we can do a similar counting argument as in Lemma~\ref{lem:ccw-jumps-edges}, where we showed this fact in the primal case. 
%Alternatively, we can simply observe under the bijection $\De$ the sum of counterclockwise jumps around a primal inner edge of $G^*$ is exactly the same as that of its dual edge. Since $\De(\cL^*)$ is a GS labeling, Lemma~\ref{lem:ccw-jumps-edges} guarantees the sum of counterclockwise jumps around an inner edge is $d$.

%Now, let $p \neq q$ be the labels of the corners on the left and right of $a$, and let $r \neq s$ be the label of the corner on the left and right of $-a$ as indicated in Figure~\ref{fig:labels-around-dual-edge}. 
Let $i_1,i_2,i_3,i_4$ be the labels in counterclockwise order around $a$ as indicated in Figure \ref{fig:labels-around-dual-edge}. The map $\Theta^*$ assigns to $a$ the colors $[i_2:i_3[$ and to $-a$ the colors $[i_4:i_1[$. The above observation implies that the intervals $[i_2:i_3[$ and $[i_4:i_1[$ are disjoint. Hence if $a$ has color $i$, then $[i_4:i_1[\subseteq[i+1:i[$. Moreover, if $a$ has $\delta$ colors, then (L3\sups{*}) implies that the label jump from $i_3$ to $i_4$ is at least $m = \max(0, 1+d-\text{deg}(v)-\de)$, so $[i_4:i_1[\subseteq[i+1+m:i[$. 
% In particular, if $a$ has color $i$, then its opposite arc $-a$ does not have color $i$.
%Suppose $a$ has in total $\de \leq 1+d-\deg(v)$ colors, including the color $i$, i.e. $i \in [p:q[$ and $\de = |[p:q[| \leq d-\deg(v)$. By (L3\sups{*}), the jump from $q$ to $m$ is at least $1 + d - \deg(v) - \de$, so $m$ is at least $i + 1 + (1 + d - \deg(v) - \de)$. Also, $n$ is ``preceding" $p$, hence the $[m:n[$ for a subinterval of $[i+1+(1+d-\deg(v)-\de):p[ \ \subseteq [i+1+(1+d-\deg(v)-\de):i[$.
This completes the proof that $\Theta^*(\cL^*)$ has property (W2\sups{*}), hence is a dual GS wood.

\fig{width=0.3\linewidth}{labels-around-dual-edge}{The labels around a non-root edge.}

Now we show that $\Theta^*$ is a bijection. Injectivity is clear as it is easy to recover corner labels after the assignment of colors: the corners incident to the root-face $f_i^*$ all get label $i$ and the corners on the left and right side of an arc $a$ with color set $[p:q[$ will have labels $p$ and $q$, respectively. To prove surjectivity, we consider a tuple $\mathcal{W^*} = (W^*_1,\ldots,W^*_d)$ satisfying Conditions (W0\sups{*}-W2\sups{*}). We label the corners of $G^*$ according to the rule just mentioned, and want to show that the result $\cL^*$ is a dual $d$-GS labeling.
Note that Property (L0\sups{*}) holds by construction, and that (L2\sups{*}) follows directly from the first statement of (W1\sups{*}). Given the discussion in the previous paragraph, it is also easy to see that (L3\sups{*}) is a consequence of (W2\sups{*}). 

It remains to show that $\cL^*$ satisfy (L1\sups{*}). Let $\mathbf{v}, \mathbf{e}, \mathbf{f}$ be the number of vertices, edges and faces of $G^*$, respectively. Around a non-root vertex, the sum of clockwise jumps is $d$ by the second part of (W1\sups{*}), while that of the root-vertex $v^*$ is $d(d-1)$. The sum of counterclockwise jumps around each root-edge is $d$ by construction. Also, Condition (W0\sups{*}) implies that for a non-root edge the color sets of the two arcs are disjoint consecutive subsets of $[d]$, hence the sum of counterclockwise jumps around each non-root edge is also $d$. Therefore the sum of counterclockwise jumps around all edges is $d\mathbf{e}$, which is equal to the sum of clockwise jumps around all faces and all vertices. Consequently, the sum of clockwise jumps around all faces is equal to $d\mathbf{e} - d(\mathbf{v}-1)-d(d-1) = d(\mathbf{e}-\mathbf{v}+2-d) = d(\mathbf{f}-d)$, where the last equality is from Euler's relation. Note that $\mathbf{f}-d$ is exactly the total number of non-root faces. But since the sum of clockwise jumps around each root-face is 0 and that of each non-root face has to be a multiple of $d$, it is exactly $d$ for each non-root face. Hence $\cL^*$ satisfy (L1\sups{*}). This completes the proof that $\Theta^*$ is surjective, hence a bijection.
\end{proof}

The following theorem summarizes our results for dual $d$-GS structures. 
%This theorem is a consequence of Propositions~\ref{prop:existence-dual-labeling} and~\ref{prop:bij-dual-labeling-wood}.

\begin{thm}\label{thm:dual-main}
Let $d \geq 3$ and let $G$ be a $d$-map. There exists a dual $d$-GS wood (resp. labeling) for $G^*$ if and only if $G^*$ is dual $d$-adapted. 

Moreover, for any fixed $d$, there is an algorithm which takes as input a dual $d$-adapted map and computes a dual $d$-GS wood (resp. labeling) in time linear in the number of vertices. 

Lastly, the set $\bL^*_G$ of dual $d$-GS labelings of $G^*$, the set $\bL_G$ of $d$-GS labelings of $G$, the set $\bW^*_G$ of dual $d$-GS woods of $G^*$, and the set $\bW_G$ of $d$-GS woods of $G$ are all in bijection.
\end{thm}

In fact, we can give a more direct description of the bijection between the dual $d$-GS woods of $G^*$ and the $d$-GS woods of $G$. This description shows that the dual $d$-GS woods is a tuple of spanning trees of $G^*$.

Recall the mapping $\Delta$ in Proposition~\ref{prop:existence-dual-labeling} between $d$-GS labelings of the primal map $G$ and dual $d$-GS labelings of the dual map $G^*$. By the above results, the map $\chi = \Theta^* \circ \Delta \circ \Theta^{-1}:\bW_G \to \bW^*_G$ is a bijection between the $d$-GS woods of $G$ and the dual $d$-GS woods of $G^*$. The local definition of these mappings around an inner edge $e$ is indicated in Figure~\ref{fig:primal_dual_woods}. %For an primal inner edge $e$ with its dual edge $e^*$, suppose the four corner labels counterclockwise around $e$ are $i,j,k,l$, then these mappings are illustrated in Figure~\ref{fig:primal_dual_woods}. 
Observe that, through $\chi$, the dual edge $e^*$ gets exactly the colors that the primal edge $e$ does not have. For outer edges/root-edges, the conventions were chosen so that the same property holds.%: the outer edge $(v_i,v_{i+1})$ in the primal map only misses the color $i$, whereas its dual edge $e_i^*$ only has color $i$ (and the arc bearing this color is pointing toward $v^*$).

\fig{width=.7\linewidth}{primal_dual_woods}{The mappings $\Theta,\Theta^*$ and $\De$.}

For $i \in [d]$, let us call \emph{support} of $W^*_i$ the set of edges $\bar{W}^*_i$ of $G$ bearing the arcs in $W^*_i$. The \emph{support} $\bar{W}_i$ of the primal GS tree $W_i$ is defined similarly. By the above observation $\bar{W}^*_i$ is the \emph{dual-complement} of $\bar{W}_i$, that is, $\bar{W}^*_i$ is the set of edges which are dual to edges not in $\bar{W}_i$. %If by abuse of notation we still call the supports $W^*_i$ and $W_i$, then $W^*_i$ is the \emph{complemented dual} of $W_i$. 
It is well-known that the dual-complement of a spanning tree is also a spanning tree. Hence $\bar{W}^*_i$ is a spanning tree of $G^*$, for all $i\in [d]$. Moreover, by (W0\sups{*}), $v^*$ is the only vertex without an outgoing arc in $W^*_i$, so $W^*_i$ is a tree oriented toward the root-vertex $v^*$. To summarize: 

\begin{prop}\label{prop:primal_dual_woods}
Let $\cW = (W_1,...,W_d)$ be a GS wood of $G$. Then $\chi(\cW) = (W^*_1,...,W^*_d)$ is formed in the following way: for each $i \in [d]$, the support $\bar{W}^*_i$ of $W^*_i$ is the spanning tree of $G^*$ that is the dual-complement of the support of $W_i$: it contains edges of $G^*$ which are dual to the edges of $G$ not in $W_i$. $W^*_i$. Moreover, $W^*_i$ is obtained by orienting the tree $\bar{W}^*_i$ toward the root-vertex $v^*$ (every edge oriented from child to parent).
\end{prop}

Before closing this subsection let us observe that Lemma~\ref{lem:nb-color-arcs} for $d$-GS woods translates into the following property:
%To conclude this subsection we give a Corollary analogous to Lemma~\ref{lem:nb-color-arcs}, which bounds the number of colors of an edge.

\begin{cor}\label{cor:nb-color-dual-arcs}
Let $G$ be a $d$-map, and $\cW^* = (W^*_1,...,W^*_d)$ be a dual $d$-GS wood of $G^*$. The total number of colors $n_e$ of a non-root edge $e = \{u,v\}$ satisfies $$2 ~\leq ~n_e ~\leq 2+(d-\deg(u))+(d-\deg(v)).$$ 
In particular, if $G^*$ is $d$-regular, then every non-root edge has exactly $2$ colors.
\end{cor}

%% \begin{proof}
%%   Note that Proposition~\ref{prop:primal_dual_woods} implies that the colors of a non-root dual edge in $G^*$ is exactly the missing colors of its primal edge in $G$. Then if we assume Lemma~\ref{lem:nb-color-arcs}, which will be proved in Section~\ref{sec:remaining-proofs} the claimed result follows.
%% \end{proof}

%% \begin{remark}\label{rem:nb-color-dual-arcs}
%% In fact, we can prove the claimed Corollary without referring to Lemma~\ref{lem:nb-color-arcs}. Recall that in the primal map $G$, the label jump \emph{along} an arc is at most $1+(d-\deg(f))$, where $f$ is the face on the right of the arc. Hence in the dual map $G^*$, the label jump \emph{across} an arc $a$ with initial vertex $v$ is at most $1+(d-\deg(v))$. The claimed Corollary follows trivially.
%% \end{remark}

\subsection{Dual of bipartite grand-Schnyder structures}\label{sec:dual-BGS} \hfill\\
In this subsection we investigate the bipartite case of dual GS structures. Let $d = 2b$ be an even integer, and let $G$ be a bipartite $2b$-map.  
Note that every vertex of the dual map $G^*$ has even degree.
As before we fix the bicoloring of the vertices of $G$ in black and white in which the outer vertex $v_1$ is black. The faces of the dual map $G^*$ are colored according to the colors of their corresponding primal vertices. 


%the primal map $G$ is \emph{simple},  no multiple edges. Hence the dual map $G^*$ has no vertex of degree 2. 

\begin{definition}\label{def:dual-BGS-labeling}  Let $G$ be a bipartite $2b$-map. A \emph{dual $b$-BGS labeling} of $G^*$ is a dual $2b$-GS labeling of $G^*$ such that the corners of black faces have odd labels, while the corners of white faces have even labels.
\end{definition}

Note that dual $b$-BGS labelings are exactly the dual, via $\Delta$, of $b$-BGS labelings defined in Section~\ref{sec:bipartite}. The parity condition is equivalent to requiring the label jump between consecutive corners in clockwise order around a vertex to be odd, and the label jump between consecutive corners in clockwise order around a face to be even.


%% % is exactly the dual definition of bipartite GS labelings~\ref{def:BGS-labeling}. The parity condition is equivalent to requiring that the jump between every two consecutive corners in clockwise order around a vertex to be odd, and the jump between every two consecutive corner in clockwise order around a face to be even. By Theorem~\ref{thm:BGS-main}, we have:

%% \begin{lem}\label{lem:existence-dual-BGS-labeling}
%%   For a bipartite $2b$-map $G$, the bijection $\Delta$ between primal and dual GS labelings restricts to a bijection between bipartite GS and dual bipartite GS labelings. %Hence the dual map $G^*$ admits a dual $b$-BGS labeling if and only if $G$ is $2b$-adapted, and in this case a dual $b$-BGS labeling can be computed in linear time in the number of vertices of $G^*$. 
%% \end{lem}

Next we give the definition of dual bipartite GS woods. Under the bijection $\Theta^*$  between dual GS labelings and dual GS woods, the dual $b$-BGS labelings of $G$ are in bijection with the subclass of dual $2b$-GS woods satisfying the following condition: 
%If we recall the mapping $\Theta^*$ defined in the previous subsection between dual GS labelings and dual GS woods, it is easy to see that under $\Theta^*$ 
%the dual $b$-BGS labelings of $G$ are in bijection with the subclass of dual $2b$-GS woods satisfying the following condition: 
\begin{itemize}
  \item[($\dagger^*$)] \emph{For an inside arc, if the face on its right is black (resp. white), then it has exactly one more even (resp. odd) colors than odd (resp. even) colors.}
\end{itemize}

%In particular, for this subclass, every inside arc has an odd number of colors. 
% Moreover, since every vertex has degree at least $4$, no arc can have \emph{all} the even colors (more generally, no arc can have ). 
Let us call this subclass the \emph{even} dual $2b$-GS woods. Although this is not obvious, there is no loss of information in keeping only the information about even colors. In order to simplify the statements and analysis, we now make the further assumption that $G$ has no face of degree 2, or equivalently $G^*$ has no vertex of degree 2. Note that, under this asumption, no arc of $G^*$ can have $2b-1$ colors, hence no arc can have all the even colors.

%We first characterize the resulting subsequences of trees and then prove their one-to-one correspondence with the even woods.

\begin{definition}\label{def:dual-BGS-wood}
 Let $G$ be a bipartite $2b$-map having no face of degree 2. A \emph{dual $b$-BGS wood} of $G^*$ is a tuple $\mathcal{W'^*} = (W_1'^*,...,W_b'^*)$ of subsets of arcs of $G^*$ satisfying: \begin{itemize}
  \item[(BW0\sups{*})] For each $i \in [b]$, every non-root vertex $v$ has exactly one outgoing arc with color $i$. For all $i\in[b]$, the arc of the root-edge $e_{2i}^*$ going toward $v^*$ has only color $i$. The other arcs of root-edges have no color.
  
  \item[(BW1\sups{*})] Every inside arc with a black face on its right is in at least one color. 
  Let $v$ be a non-root vertex with outgoing arcs $a_1',...,a_b'$ with colors $1,...,b$, respectively. 
  The arcs $a_1',...,a_b'$ appear in clockwise order around $v$.
  
  \item[(BW2\sups{*})] Let $a$ be an inside arc with initial vertex $v$ and let $\de$ be the number of colors of $a$.

  If $a$ has a black (resp. white) face on its right and has color $i$, then the colors of the opposite arc $-a$ form a subset of $[i+1+m: i[$, where $m = \max(0, 1+b-\deg(v)/2-\de)$ (resp. $m = \max(0, b-\deg(v)/2-\de)$).

  % If $a$ has a white face on its right and has color $i$, then the colors of the opposite arc $-a$ form a subset of $[i+1+m:i[$, where $m = \max(0, b-\deg(v)/2-\de)$.
  If $a$ has a white face on its right and has no color, but is between the outgoing arcs of colors $i$ and $i+1$ in clockwise order around $v$, then the colors of the opposite arc $-a$ form a subset of $[i+1+m:i]$, where $m = \max(0, b-\deg(v)/2)$.
  
  %\SL{Similarly, should we formulate this into a crossing condition?}\OB{Let's stick to the current version, which is simpler to state.}
\end{itemize}
\end{definition}

\begin{lemma}\label{lem:reduced-dual-wood}
Let $G$ be a bipartite $2b$-map having no face of degree 2. For an even dual $2b$-GS wood $(W_1^*,...,W_{2b}^*)$, we define $\Lambda(W_1^*,...,W_{2b}^*) = (W_2^*,...,W_{2b}^*)$. Then, $\Lambda^*$ is a bijection between even dual $2b$-GS woods and dual $b$-BGS woods.
\end{lemma}

\begin{proof}
First we show that for any even dual $2b$-GS wood $\cW^*=(W_1^*,...,W_{2b}^*)$, the image  $\cW'^*=(W_1'^*,...,W_{b}'^*)=\Lambda(W_1^*,...,W_{2b}^*)$ is a $b$-BGS wood.
It is easy to check that $\cW'^*$ satisfies (BW0\sups{*}) and (BW1\sups{*}).  
For (BW2\sups{*}), there are three cases to check. Let us first consider an inside arc $a$ which has at least one even color $2i$ in $\cW^*$. If $a$ has a black face on its right, let $2\de-1$ be the number of colors of $a$, where $\de \geq 1$ is the number of even colors. By (W2\sups{*}), the colors of $-a$ in $\cW^*$ form a sub-interval of $[2i+1+k:2i[$, where $k = \max(0, 2+2b-\deg(v)-2\de)$ and $v$ is the initial vertex of $a$. Hence the colors of $-a$ in ${\cW'}^*$ form a sub-interval of $[i+1+m:i]$, where $m = k/2$. Hence $a$ satisfies (BW2\sups{*}). 
The argument is similar for an arc with a white face on its right and at least one even color. 
Lastly, consider an arc $a$ with no even color which is between outgoing arcs of even colors $2i$ and $2i+2$ in $\cW^*$. The arc $a$ has a single color $2i+1$ and has a white face on its right. By (W2\sups{*}), the colors of $-a$ form a sub-interval of $[2i+2+k:2i+1[$, where $k = \max(0, 2b-\deg(v))$. Hence the colors of $-a$ in $\cW'^*$ form a sub-interval of $[i+1+k/2:i]$, which is (BW2\sups{*}). Hence $\cW'^*$ satisfies (BW2\sups{*}) and is a $b$-BGS wood.  


The map $\Lambda^*$ is injective because the colors assigned by $\Lambda^*$ correspond to the original even colors, and we can recover the odd colors from the even colors. %If an arc $a$ is part of a root-edge, this is trivial. 
Indeed, if an arc $a$ has a black face on its right, then it has at least one even color, but not all even colors (as noted above), so the odd colors can be recovered. Once the colors for the arcs with a black face on their right are known, this determines the colors for the arcs with a white face on their right by Condition (W1\sups{*}).

%% If an arc $a$ is part of a root-edge, this is trivial. In the case that $a$ is not part of a root-edge. If $a$ has at least one even color, as noted before it cannot have all the even colors, then its even colors form a proper (consecutive) subset of $\{2,4,...,2b\}$. We can easily recover its odd colors depending on the color of the face on its right. For example, suppose $a$ has even colors $\{2i,2i+2,...,2j\} \subsetneq \{2,4,...,2b\}$ and has a white face on its right, then the odd colors of $a$ must be $\{2i-1,2i+3,...,2j+1\}$.
%%   Now suppose $a$ has no even color, let $v$ be the its initial vertex. Since $v$ has degree at least 4, the arcs preceding and following $a$ in clockwise order around $v$ are \emph{distinct}, and hence have even colors because they have black faces on their right. We can easily determine the (only) odd color of $a$ from, say, the last even color of the arc preceding $a$.

  Finally we prove surjectivity. Let $\cW'^*=(W_1'^*,...,W_b'^*)$ be a $b$-BGS wood of $G^*$. It is easy to see that the recovery rule layed out in the previous paragraph is still well-defined. Moreover, the result $\cW^*$ of this operation clearly satisfies (W0\sups{*}) and (W1\sups{*}) as well as the evenness condition~($\dagger^*$).  It remains to check Condition (W2\sups{*}) for every inside arc $a$.
%. Let $a$ be an inside arc with initial vertex $v$. 
There are again three cases (depending on whether $a$ has a color, and has a black or white face on its right), and one can check that Condition (BW2\sups{*}) for $\cW'^*$ translates into Condition (W2\sups{*}) for $\cW^*$ for each case.
  %% For example, if $a$ has a black face on its right and is in $\de \geq 1$ of the sets $(W_1'^*,...,W_b'^*)$, including $W_i'^*$. By (BW2\sups{*}), the colors of $-a$ form a subinterval of $[i+1+m:i[$, where $m = \max(0,1+b-\deg(v)/2-\de)$. 
  %% The recovery rule will give $a$ the even color $2i$ and the even colors of $-a$ will form a (consecutive) subset of $\{2i+2+k,2i+4+k,...,2i-2\}$, where $k = \max(0,1+2b-\deg(v)-(2\de-1))$. Note that $(2\de-1)$ is the total number of colors assigned to $a$ by the recovery rule. Since $-a$ has a white face on its right, the odd colors of $-a$ will form a (consecutive) subset of $\{2i+1+k,2i+3+k,...,2i-1\}$. In total, the colors assigned to $-a$ will form a subinterval of $[2i+1+k:2i[$. If the recovery rule also assigns to $a$ some odd color $2i-1$ (which happens if $\de \geq 2$), a similar argument will show that the colors of $-a$ will form a subinterval of $[2i+k:2i-1[$. Therefore (W2\sups{*}) for this case holds. 
  %% The other two cases, namely one where $a$ has a white face on its right with $\de \geq 1$ and the other one where $a$ has a white face on its right with $\de = 0$, are similar. 
This completes the proof that $\Lambda^*$ is surjective, hence a bijection.
\end{proof}


We now summarize our main result for dual bipartite GS structures.

\begin{thm}\label{thm:dual-BGS-main}
  Let $b \geq 2$ and let $G$ be a  bipartite $2b$-map with no face of degree 2. There exists a dual $b$-BGS wood (resp. labeling) for its dual map $G^*$ if and only if $G$ is $2b$-adapted.

  Moreover for any fixed $b$, there is an algorithm which takes as input a bipartite $2b$-adapted map and computes a dual $b$-BGS wood (resp. labeling) for $G^*$ in linear time.

  Lastly, the set $\mathbf{BL}_G^*$ of dual $b$-BGS labelings of $G^*$, the set $\mathbf{BL}_G$ of $b$-BGS labelings of $G$, the set $\mathbf{BW}_G^*$ of dual $b$-BGS woods of $G^*$, and the set $\mathbf{BW}_G$ of $b$-BGS woods of $G$ are all in bijection.
\end{thm}

%\end{document}

%
%\begin{remark}
%   Dual BGS labelings and \emph{even} dual GS woods are still well-defined without the assumption that the primal map $G$ has no face of degree 2. But the occurrence of vertices of degree 2 in the dual map $G^*$ makes it possible that some arcs have \emph{all} the even colors. As a result, the odd colors can no longer be restored from the even colors merely by local information as in the proof of Lemma~\ref{lem:reduced-dual-wood}. In this situation, condition (BW2\sups{*}) becomes ambiguous and the characterization of dual BGS woods becomes quite convoluted.
%% becomes quite since $i$ is not well-defined. As a result, the odd colors can no longer be restored from the even colors merely by local information as in the proof of Lemma~\ref{lem:reduced-dual-wood}.
%%Note that when this happens the initial vertex $v$ of such an arc must have degree 2, and the other incident arc of $v$ has no even color at all. 
%%In this case, the last condition of (BW2\sups{*}) is ambiguous since $i$ is not well-defined. As a result, the odd colors can no longer be restored from the even colors merely by local information as in the proof of Lemma~\ref{lem:reduced-dual-wood}. 
%  % If $G$ is $2b$-adapted, however, it is possible to recover the odd colors and the bijection holds, but the argument would be lengthy.
%\end{remark}

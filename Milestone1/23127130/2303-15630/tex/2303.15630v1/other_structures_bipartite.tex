%\documentclass{amsart}
%\input{defs.tex}
%\begin{document}
%\subsection{Connections to previously known structures}

\subsubsection{Bipartite grand-Schnyder structures on $2b$-angulations of girth $2b$, and their relation to 2-orientations and bipolar orientations}\label{sec:bipartite_angulations}
%\input{other_structures_bipartite_1}
In this subsection we relate $b$-BGS structures to the \emph{even Schnyder decompositions} defined in~\cite{OB-EF:Schnyder} for $2b$-angulations. The special case $b=2$ is the most classical, as $2$-BGS structures are in bijection with plane bipolar orientations.


Recall from Section~\ref{sec:classical} that a $d$-angulation $G$ is $d$-adapted if and only if it has girth $d$, and that all four incarnations of $d$-GS structures can be simplified in this case. These structures where studied in~\cite{OB-EF:Schnyder} under the name of \emph{$d$-Schnyder structures}. 
%These structures were studied by the first and the second author~\cite{OB-EF:Schnyder} under the name of $d$-Schnyder structures. 
In particular, the $d$-GS marked orientation incarnation and the $d$-GS angular orientation incarnation both simplify into the same type of weighted orientations of $G$ (with no marks) called \emph{$d/(d-2)$-orientations}. In~\cite{OB-EF:Schnyder} the $d$-GS corner labelings and the $d$-GS woods of $d$-angulations were called \emph{$d$-Schnyder labelings} and \emph{$d$-Schnyder decompositions}, respectively.

When $d=2b$ is an even integer, a (nonempty) subclass of Schnyder structures on $2b$-angulations of girth $2b$ called \emph{even} was studied in~\cite{OB-EF:Schnyder}. %Again we fix the bicoloring of the vertices so that the outer vertex $v_1$ is black. 
The class of even $d$-Schnyder structures can easily be identified with the class of $b$-BGS structures of $2b$-angulations:% defined in Section~\ref{sec:incar_bipartite} was characterized in a similar way as in the first subsection~\ref{sec:incar_bipartite}, and is closely related to the $b$-BGS structures on $2b$-angulations. More precisely,
\begin{compactitem}
\item A $2b$-Schnyder labeling is \emph{even} if all the corners incident to black (resp. white) vertices have odd (resp. even) labels. This characterization exactly coincides with the definition of $b$-BGS labelings on $2b$-angulations.
\item A $2b/(2b-2)$-orientation is \emph{even} if the weight of every inner arc is even. Dividing every weight by 2 gives a structure called \emph{$b/(b-1)$-orientation} in~\cite{OB-EF:Schnyder} (these are weighted orientations of the inner edges such that edges have weight $b-1$ and vertices have weight $b$). For a $2b$-angulation the $b/(b-1)$-orientations exactly coincide with the $b$-BGS marked orientations (no mark) and $b$-BGS angular orientations (weight 0 on star edges).
\item A $2b$-Schnyder decomposition is \emph{even} if for every $i \in \{1,...,d\}$, and each black (resp. white) inner vertex $v$, the arcs leading $v$ to its parent in $W_{2i}$ and in $W_{2i-1}$ (resp. in $W_{2i}$ and $W_{2i+1}$) are the same. It was shown in~\cite{OB-EF:Schnyder} that keeping only the trees of even color does not result in any loss of information. This simplified structures, called \emph{reduced Schnyder decompositions} in~\cite{OB-EF:Schnyder}, coincide with the $b$-BGS woods of $2b$-angulations.
%It can be shown, by an similar argument as in Lemma~\ref{lem:reduced-wood}, that taking only the trees of even colors will not incur any loss of information, and by doing so we retrieve exactly the $b$-BGS woods on $2b$-angulations. 
\end{compactitem}


The case $b=2$ (of $b$-BGS structures on $2b$-angulations) is classical and precedes~\cite{OB-EF:Schnyder}. Let $G$ be a quadrangulation. By definition, a $2/1$-orientation of $G$ is simply an (unweighted) orientation of the inner edges of $G$ such that every inner vertex has outdegree 2. These are simply called \emph{2-orientations} of $G$, and $G$ admit such an orientation if and only if it is simple (that is, has no double edge, which is equivalent to having girth 4 in this case). 
Next consider the corner labeling incarnation: because of the parity condition in BGS corner labeling, there is no loss of information in replacing each label $i$ by $\lfloor (i-1)/2 \rfloor$. 
%As mentioned in Section~\ref{sec:incar_bipartite}, an even $2b$-Schnyder labeling on a $2b$-angulation can be modified (without loss of information) by replacing each label $i$ by $\lfloor (i-1)/2 \rfloor$. In particular, for plane quadrangulations (case $b=2$), the labels are 0,0,1,1 around each inner face. 
This incarnation of 2-orientations was studied by Felsner et al. in~\cite{FeHuKa}.
%\OB{The preceding citation needs to be more explicit (if there is a generalization beyond $b=2$).}


As explained in the introduction, $2$-oriented quadrangulations are in bijection with plane bipolar orientations. The bijection is given by Figure~\ref{fig:2-orientations}. 
%\OB{We could move the figure and discussion from the introduction to this place.}



%In terms of orientations, the 2-BGS structures of quadrangulations correspond to the so-called 2-orientations

%\begin{remark}\label{rem:bipartite_4} 
Let us finally mention that 2-orientations were used by Barri\'ere and Huemer~\cite{Barriere-Huemer:4-Labelings-quadrangulation} to design a straight-line drawing algorithm for quadrangulations. These structures (in the form of, dual, even $4$-Schnyder structures) were also used in~\cite{OB-EF:Schnyder} to design a drawing algorithm for 4-regular plane maps. In a forthcoming article~\cite{OB-EF-SL:4-GS-drawing}, we will present extensions of these two algorithms (and of the drawing algorithm of He~\cite{He93:reg-edge-labeling}, which is based on transversal structures).

%$2$-BGS structures for plane quadrangulations (i.e. even $4$-Schnyder structures) are known to have many drawing applications. Barri\'ere and Huemer~\cite{Barriere-Huemer:4-Labelings-quadrangulation} used such structures, though in a different incarnation, to design a straight-line drawing algorithm for quadrangulations. The first and the second author used the \emph{dual} of such structures, which we will define in Section~\ref{sec:dual}, to design an \emph{orthogonal} drawing algorithm for 4-regular plane maps. In a forthcoming article~\cite{OB-EF-SL:4-GS-drawing}, we will present extensions of both algorithms. In particular, the evenness condition can be dropped in both cases. 
%\end{remark}
\subsubsection{BGS structures for quadrangulations of the hexagon, and their relation to Felsner woods}\label{sec:Felsner} 
In this subsection, we consider the $3$-BGS structures for \emph{quadrangulations of the hexagon} (6-maps where inner faces have degree 4). This case bears a strong analogy to the case of transversal structures discussed in Section~\ref{sec:transversal}. For these maps (which are edge-tight) the BGS structures can be identified with certain edge colorings, and they are related to the Felsner woods of 3-connected plane maps. 


\begin{figure}
\begin{center}
\includegraphics[width=\linewidth]{Felsner_woods}
\end{center}
\caption{On the left, a Felsner edge-coloring of an quadrangulation of the hexagon, and the 3 associated bipolar orientations (blue-green, red-blue, and green-red). 
On the right, the corresponding coloring of corners of the diagonal-map, and the 3 associated spanning trees.}
\label{fig:Felsner_woods}
\end{figure}


Let $G$ be a quadrangulation of the hexagon. Clearly, such a map is 6-adapted if it is simple and every 4-cycle bounds a face.\footnote{The 6-adapted quadrangulations of the hexagon are sometimes called \emph{irreducible quadrangulations of the hexagon} in the literature~\cite{FuPoScL,bouttier2014irreducible}.}
%We now consider the case of $6$-adapted maps with inner faces of degree $4$, also called \emph{irreducible quadrangulations of the hexagon} in the literature~\cite{FuPoScL,bouttier2014irreducible} (irreducible means that every 4-cycle bounds a face). It bears a strong analogy to the case of transversal structures discussed in Section~\ref{sec:transversal}. 
A \emph{Felsner edge-coloring} of $G$ is a coloring of the 
inner edges of $G$ in red, blue, green with the following properties (see the top-left part of 
Figure~\ref{fig:Felsner_woods}):
\begin{itemize}
\item[(C0)]
All inner edges incident to $v_1$ and $v_4$ are blue, all inner edges incident to $v_2$ and $v_5$ are green, and all inner edges incident to $v_3$ and $v_6$ are red.
\item[(C1)]
Around every inner vertex, the incident edges form 3 non-empty groups in clockwise order: red edges, green edges, and blue edges. 
\end{itemize} 
Felsner edge-colorings are closely related to extensions of Schnyder structures developed by Felsner~\cite{F01,Felsner:geodesic-embedbings,Felsner:lattice} for $3$-connected maps. 
Precisely, with the bi-partition of the vertices of $G$ into black and white vertices (where $v_1$ is black), one can classically associate a plane map $M$ to $G$, called the \emph{diagonal-map} of $G$, where the vertices of $M$ are 
the black vertices of $G$, and there is one edge of $M$ for each inner face $f$ of $G$, which connects the two diagonally opposed black vertices around $f$. 
The obtained map is actually a \emph{suspended map}, that is, a map with $3$ distinguished vertices ($v_1,v_3,v_5$) incident to the outer face, whose marking is indicated by a dangling half-edge incident to the outer face; the dangling half-edges at $v_1,v_3,v_5$ are colored blue, red, and green respectively. 
Let $M^{\infty}$ be the map obtained from $M$ by joining the dangling half-edges to an additional vertex $v_{\infty}$ in the outer face. 
The map $M$ is called \emph{quasi-3-connected} (case considered by Felsner) if $M^{\infty}$ is $3$-connected, which is equivalent to the fact that $G$ is 6-adapted and has at least one inner edge incident to each of $v_1,v_3,v_5$. Since each edge of $G$ corresponds to a corner of $M$, a Felsner edge-coloring is equivalent (see the top-right part of Figure~\ref{fig:Felsner_woods}) to a coloring of the 
corners of $M$ in red, blue or green such that:
\begin{itemize}
\item[(C0')]
For each color $c\in\{$red, blue, green$\}$, the corners of label $c$ in the outer face are those in the interval delimited by the dangling half-edges of the two other colors; 
and all inner corners incident to the distinguished outer vertex carrying the dangling half-edge of color $c$ have color~$c$.
\item[(C1')]
Around every non-distinguished vertex and every inner face, the incident corners in clockwise order form 3 non-empty groups: red corners, green corners, and blue corners. 
\end{itemize} 
These are exactly the corner colorings defined by Felsner in~\cite{Felsner:geodesic-embedbings}. 
%He also shows that in such a structure, around each edge the $3$ colors appear among the 4 incident corners, and the color appearing twice is at two corners that are not diagonally opposed around the edge. 
%In the Felsner coloring of $G$, upon coloring the outer edges in clockwise order as blue/green/red/blue/green/red starting with $(v_1,v_2)$, this condition translates to the property that every face has the 3 colors on its boundary, and has a unique unicolored corner. 
Felsner also shows that such a coloring yields $3$ spanning trees of $M$ (thus giving an extension of Schnyder woods to 3-connected plane maps). The red (resp. blue, green) tree is rooted at $v_3$ (resp. $v_1$, $v_5$), with the parent edge of each non-root vertex of $M$ being the unique incident edge marking the separation between the groups of green/blue edges (resp. of red/green edges, of blue/red edges). These trees are represented in the bottom-right part of Figure~\ref{fig:Felsner_woods}.  


%Similarly as for transversal structures, one can associate some plane bipolar orientations (three here) to a Felsner edge-coloring. 
As we now explain, one can associate some plane bipolar orientations to a Felsner edge-coloring, in a way that is similar to the case of transversal structures treated in Section~\ref{sec:transversal}.
%Precisely, 
For a quadrangulation of the hexagon $G$ endowed with a Felsner edge-coloring, we define the \emph{red-blue bipolar orientation} as the oriented map obtained by deleting the green edges, orienting the red edges from white to black, orienting the blue edges from black to white, and orienting the $6$ outer edges in the flow-direction from $v_6$ to $v_3$. Similarly, the green-red (resp. blue-green) bipolar orientation is obtained by erasing the blue (resp. red) edges, orienting the red (resp. green) edges from black to white, orienting the green (resp. blue) edges from white to black, and orienting the outer edges in the flow-direction from $v_2$ to $v_5$ (resp. $v_4$ to $v_1$), see the bottom-left part of Figure~\ref{fig:Felsner_woods}. 

\begin{remark}
The three bipolar orientations defined above are also natural in the context of orthogonal surface representations (which are specific 3D representations) associated with the Felsner structures~\cite{Felsner:geodesic-embedbings,felsner2008schnyder}. Then the faces of the red-blue (resp. green-red, blue-green) bipolar orientation correspond to the \emph{flats} of the orthogonal surface in the direction orthogonal to the $y$-axis (resp. $x$-axis, $z$-axis), and the dual bipolar orientation indicates order constraints on the $y$-coordinates (resp. $x$-coordinates, $z$-coordinates) of those flats so as to have a valid \emph{rigid} orthogonal surface representation of the Felsner structure. The red-blue bipolar orientation has also been recently used to obtain enumerative results on Felsner structures~\cite{enumerationFelsnerColorings}. 
\end{remark}

\begin{figure}
\begin{center}
\includegraphics[width=12cm]{corner_labeling_felsner}
\end{center}
\caption{On the left, a $3$-BGS arc labeling on a quadrangulation of the hexagon.
 On the right, the corresponding Felsner edge-coloring (upon coloring blue/green/red the outer edges $(v_i,v_{i+1})$ for $i=1/2/3$ modulo $3$). 
The two bottom rows show the local conditions at inner vertices and inner faces (of 6 possible types) when superimposing both structures. The top row shows the associated $3$-BGS angular orientation. 
}
\label{fig:corresp_BGS_Felsner_coloring}
\end{figure}

We now discuss the link with bipartite grand-Schnyder structures. First note that quadrangulations of the hexagon are edge-tight in the sense of Section~\ref{sec:arc_labeling}. 
%\OB{I have removed the terminology ``irreducible'' from most of the paper. Sometimes I replaced it with ``6-adapted'', but sometimes I just deleted it, which slightly changes the statement like in the following sentence (or, with lesser importance, the previous sentence).}
As illustrated in Figure~\ref{fig:corresp_BGS_Felsner_coloring}, for $G$ a quadrangulation of the hexagon, there is a direct bijection between the Felsner edge-colorings of $G$ and the $3$-BGS structures of $G$. 
Let $\cAL$ be a $6$-GS arc labeling of $G$. It corresponds to a 3-BGS corner labeling if and only if the inner arcs with black (resp. white) initial vertex have odd (resp. even) labels. We call such an arc labeling a \emph{$3$-BGS arc labeling} of $G$. 
Condition (AL2) and the parity property imply that in a $3$-BGS arc labeling $\cAL$, around any black (resp. white) inner vertex there are 3 non-empty groups of outgoing arcs of label 1,3,5 (resp. 2,4,6). Hence, to a $3$-BGS arc labeling $\cAL$, one can associate a Felsner edge-coloring $\eta(\cAL)$ by coloring blue (resp. green, red) the inner edges with arc labels $\{1,4\}$ (resp. $\{2,5\}$, $\{3,6\}$). Conversely, to a Felsner edge-coloring $\cF$ of $G$, one associates a $3$-BGS arc labeling $\beeta(\cF)$ by giving the label 1 (resp. 3,5) to the arcs of color blue (resp. red, green) with black initial vertex, and the label 2 (resp. 4,6) to the arcs of color green (resp. blue, red) with white initial vertex. It is clear that $\eta$ and $\beeta$ are inverse mappings, hence bijections, between the set of $3$-BGS arc labelings and the set of Felsner edge-colorings of $G$.



%As illustrated in Figure~\ref{fig:corresp_BGS_Felsner_coloring}, for $G$ a quadrangulation of the hexagon, there is a direct bijection between the Felsner edge-colorings of $G$ and the $3$-BGS arc labelings of $G$: for $\cAL$ a $3$-BGS arc labeling of $G$, each inner edge with labels $\{1,4\}$ (resp. $\{2,5\}$, $\{3,6\}$) is turned into a blue (resp. green, red) edge. 

Note that the red-blue (resp. green-red, blue-green) bipolar orientation of the Felsner edge-coloring $\eta(\cAL)$ is exactly the plane bipolar orientation $B_5$ (resp. $B_1$, $B_3$) associated to the $3$-BGS arc labeling $\cAL$ by the mapping $\beta$ (see Section~\ref{sec:arc_labeling}). Hence, according to Remark~\ref{rk:bipolarBi}, the even grand-Schnyder wood $\cW=(W_1,W_2,W_3,W_4,W_5,W_6)$ associated to $\cAL$ can be easily obtained from these bipolar orientations. Precisely, up to changing the tree-root of $W_i$ from $v_i$ to $v_{i-2}$ for all $i$, 
the tree $W_5$ (resp. $W_2$) is the leftmost outgoing tree (resp. rightmost ingoing tree) of the red-blue bipolar orientation, 
the tree $W_1$ (resp. $W_4$) is the leftmost outgoing tree (resp. rightmost ingoing tree) of the green-red bipolar orientation, and the tree $W_3$ (resp. $W_6$) is the leftmost outgoing tree (resp. rightmost ingoing tree) of the blue-green bipolar orientation. This correspondence is represented in Figure~\ref{fig:corresp_BGS_Felsner_coloring}. (Note that the trees $W_1,\ldots,W_6$ of the grand-Schnyder wood are closely related to the three bipolar orientations rather than to the three spanning trees of the Felsner wood.) 


Let us finally consider the angular orientations incarnation.
In~\cite{Felsner:lattice} Felsner shows that (when $G$ has at least one inner edge incident to each of $v_1,v_3,v_5$) his corner labelings of $M$ correspond to orientations of the star edges of $G^+$ (these edges are those of the superimposition of $M$ with its dual, upon considering that there are 3 outer faces separated by the dangling half-edges) such that $v_1,v_3,v_5$ have outdegree~$2$, $v_2,v_4,v_6$ have outdegree $0$, all inner vertices of $G$ have outdegree $3$, and the star vertices have outdegree $1$. Letting $s_i$ be the star vertex in the inner face containing the outer edge $(v_{i-1},v_i)$, these orientations of $G^+$ defined in~\cite{Felsner:lattice} coincide with the $3$-BGS angular orientations of $G$, upon returning the edges $(v_2,s_2), (v_1,s_2), (v_4,s_4), (v_3,s_4), (v_6,s_6), (v_5,s_6)$. 
Moreover, as shown in the top-part of Figure~\ref{fig:corresp_BGS_Felsner_coloring}, the correspondence in~\cite{Felsner:lattice} commutes with our correspondence $\Gamma$ between $3$-BGS arc labelings and $3$-BGS angular orientations. 
 

 
%\bibliographystyle{plain}
%\bibliography{biblio-Schnyder}

%\end{document}

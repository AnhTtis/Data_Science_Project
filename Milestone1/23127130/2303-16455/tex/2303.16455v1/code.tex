clear

close all

m=2;
n=1e2;

ntrial=1e0;

s1=1.2;
s2=0.9;
s12=0.4;

rho=s12/s1/s2;

v1=0.8;





p1=qfunc(v1/s1);
p2=qfunc(v1/s2);
p12=orthoscheme(s1,s2,s12,v1,v1);




t1=v1/s1;
t2=v1/s2;

p1=qfunc(t1);
p2=qfunc(t2);
p12=orthoscheme(s1,s2,s12,v1,v1);

f1=-1/sqrt(2*pi)*exp(-t1^2/2);
a1=1/f1;
d1=-v1/t1^2*a1;

f2=-1/sqrt(2*pi)*exp(-t2^2/2);
a2=1/f2;
d2=-v1/t2^2*a2;

de1=orthoscheme_de_var(s1,s2,s12,v1,v1);
de2=orthoscheme_de_var(s2,s1,s12,v1,v1);
de12=orthoscheme_de(s1,s2,s12,v1,v1);

r=[-de1*d1/de12,-de2*d2/de12,1/de12];


F_1=Fisher_const_thre(s1,s2,s12,v1,v1,n);

M_1=inv(F_1)

var_1=d1^2*p1*(1-p1)/n



v2=1.4;

p1=qfunc(v2/s1);
p2=qfunc(v2/s2);
p12=orthoscheme(s1,s2,s12,v2,v2);

t1=v2/s1;
t2=v2/s2;

p1=qfunc(t1);
p2=qfunc(t2);
p12=orthoscheme(s1,s2,s12,v2,v2);

f1=-1/sqrt(2*pi)*exp(-t1^2/2);
a1=1/f1;
d1=-v2/t1^2*a1;

f2=-1/sqrt(2*pi)*exp(-t2^2/2);
a2=1/f2;
d2=-v2/t2^2*a2;

de1=orthoscheme_de_var(s1,s2,s12,v2,v2);
de2=orthoscheme_de_var(s2,s1,s12,v2,v2);
de12=orthoscheme_de(s1,s2,s12,v2,v2);

r=[-de1*d1/de12,-de2*d2/de12,1/de12];


F_2=Fisher_const_thre(s1,s2,s12,v2,v2,n);

M_2=inv(F_2)

var_2=d1^2*p1*(1-p1)/n



v3=1.0;

p1=qfunc(v3/s1);
p2=qfunc(v3/s2);
p12=orthoscheme(s1,s2,s12,v3,v3);

t1=v3/s1;
t2=v3/s2;

p1=qfunc(t1);
p2=qfunc(t2);
p12=orthoscheme(s1,s2,s12,v3,v3);

f1=-1/sqrt(2*pi)*exp(-t1^2/2);
a1=1/f1;
d1=-v3/t1^2*a1;

f2=-1/sqrt(2*pi)*exp(-t2^2/2);
a2=1/f2;
d2=-v3/t2^2*a2;

de1=orthoscheme_de_var(s1,s2,s12,v3,v3);
de2=orthoscheme_de_var(s2,s1,s12,v3,v3);
de12=orthoscheme_de(s1,s2,s12,v3,v3);

r=[-de1*d1/de12,-de2*d2/de12,1/de12];


F_3=Fisher_const_thre(s1,s2,s12,v3,v3,n);

M_3=inv(F_3)

var_3=d1^2*p1*(1-p1)/n



M=inv(F_1+F_2+F_3)

var=1/(1/var_1+1/var_2+1/var_3)

M(1,1)-var

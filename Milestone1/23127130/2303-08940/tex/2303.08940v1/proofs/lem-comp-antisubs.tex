%\begin{proof}
    We are going to generalize the original statement by replacing $\del$ with $\gtype$.
    \\ \\
    The proof follows by induction over $t$:
    \begin{itemize}
        \item Case $t = y$. Then we have to consider two cases:
        \begin{itemize}
            \item Let $t = y \not= x$. Then $t \subs{x}{v} = y$. Let $\Gam_v = \eset$, $\M = \emul$, $b_v = m_v = d_v = 0$. Then, $\Phi_v$ is derivable using rule ($\ruleMany$) with no premise. We also take $\Phi_t = \Phi_{t \subs{x}{v}}$, so that, in particular $\Gam_t = \Gam_{t \subs{x}{v}}$. Then, we can conclude with $\Gam_{t \subs{x}{v}} = \Gam_t + \Gam_v = \Gam_t$, $b = b_t + b_v = b_t$, $m = m_t + m_v = m_t$, and $d = d_t + d_v = d_t$.
            \item Let $t = y = x$. Then $t \subs{x}{v} = v$. Let $\Gam_t = \eset$, and $b_t = m_t = s_t = 0$. Now we will consider two cases depending on the form of $v$:
            \begin{itemize}
                \item Case $v = z$. Then $t \subs{x}{v} = z$ and we can proceed by case analysis of the last rule in $\Phi_{t\subs{x}{v}}$. In all of them, we can build $\Phi_t$ from $\Phi_{t \subs{x}{v}}$, by simply replacing $x$ with $z$, and $\Phi_v$ as follows:
                \[ \begin{prooftree}
                    \infer0[(\ruleAx)]{\seqi{z : \mul{\sig}}{z}{\sig}{(0,0,0)}}
                    \infer1[(\ruleMany)]{\seqi{z : \mul{\sig}}{z}{\mul{\sig}}{(0,0,0)}}
                \end{prooftree} \]
                And we can conclude since all the counters are zero.
                \item Case $v = \lam z.p$. Then $t \subs{x}{v} = \lam z.p$ and we can proceed by case analysis of the last rule in $\Phi_{t \subs{x}{v}}$. In all of them, we can always build $\Phi_t$ using either (\ruleAx) (case (\ruleApp)), (\ruleAxP) (case (\ruleLamP)),  (\ruleAx) plus (\ruleMany) (case (\ruleMany)), or (\ruleAx) plus (\ruleMany) plus (\ruleLift) (case (\ruleLift)). $\Phi_v$  is either $\Phi_{t \subs{x}{v}}$ (case (\ruleMany)), or it can be built from $\Phi_{t \subs{x}{v}}$ plus rule (\ruleMany) (all other cases).
            \end{itemize}
        \end{itemize}
        \item Case $t = \lam y.u$. Then $t \subs{x}{v} = (\lam y.u)\subs{x}{v} = \lam y.(u \subs{x}{v})$ and we must consider three cases:
        \begin{itemize}
            \item Case $\Phi_{t \subs{x}{v}}$ ends with rule (\ruleLam), then it must be of the following form: 
            \[ \begin{prooftree}
                \hypo{\Phi_{u \subs{x}{v}} \tr \seqi{\Gam_{u \subs{x}{v}}; y : \M'}{u \subs{x}{v}}{\comptype{\stype}{\ctype}}{(b,m,d)}}
                \infer1[(\ruleLam)]{\seqi{\Gam_{u \subs{x}{v}}}{\lam y.(u \subs{x}{v})}{\M' \ta (\comptype{\stype}{\ctype})}{(b,m,d)}}
            \end{prooftree} \]
            where $\gtype = \M' \ta (\comptype{\stype}{\ctype})$ and $\Gam_{t \subs{x}{v}} = \Gam_{u \subs{x}{v}}$. By the \ih, we have $\Phi_u \tr \seqi{\Gam_u; y : \M'; x : \M}{u}{\comptype{\stype}{\ctype}}{(b_u,m_u,d_u)}$ and $\Phi_v \tr \seqi{\Gam_v}{v}{\M}{(b_v,m_v,d_v)}$, such that $\Gam_{u \subs{x}{v}} = \Gam_u + \Gam_v$, $b = b_u + b_v$, $m = m_u + m_v$, and $d = d_u + d_v$. So we can build $\Phi_{\lam y.u}$ as follows:
            \[ \begin{prooftree}
                \hypo{\Phi_u \tr \seqi{\Gam_u; y: \M'; x : \M}{u}{\comptype{\stype}{\ctype}}{(b_u,m_u,d_u)}}
                \infer1[(\ruleLam)]{\seqi{\Gam_u; x : \M}{\lam y.u}{\M' \ta (\comptype{\stype}{\ctype})}{(b_u,m_u,d_u)}}
            \end{prooftree} \]
            And we can pick $\Phi_t = \Phi_{\lam y.u}$, and conclude with $\Gam_{t \subs{x}{v}} = \Gam_{u \subs{x}{v}} = \Gam_u + \Gam_v$, $b = b_u + b_v$, $m = m_u + m_v$, and $d = d_u + d_v$.
            \item Case $\Phi_{t \subs{x}{v}}$ ends with rule (\ruleLamP). Then it must be of the following form:
            \[ \begin{prooftree}
                \infer0[(\ruleLamP)]{\seqi{}{\lam y.(u \subs{x}{y})}{\tcomptype{\stype}{\vl}{\stype}}{(0,0,0)}}
            \end{prooftree} \]
            where $\Gam_{t \subs{x}{v}} = \eset$, $\gtype = \tcomptype{\stype}{\vl}{\stype}$, and $b = m = d = 0$. Let $\Gam_t = \eset$, $\M = \emul$, and $b_t = m_t = d_t = 0$. Then, we can construct $\Phi_t$ as follows:
            \[ \begin{prooftree}
                \infer0[(\ruleLamP)]{\seqi{}{\lam y.u}{\tcomptype{\stype}{\vl}{\stype}}{(0,0,0)}}
            \end{prooftree} \]
            Let $\Gam_v = \eset$, and $b_v = m_v = d_v = 0$. Then $\Phi_v$ can be constructed by using rule ($\ruleMany$) with no premises. So we can conclude with $\Gam_{t \subs{x}{v}} = \eset = \Gam_t + \Gam_v$, and $b = 0 = b_t + b_v$, $m = 0 = m_t + m_v$, and $d = 0 = d_t + d_v$.
            \item Case $\Phi_{t \subs{x}{v}}$ ends with rule ($\ruleMany$). Then $t \subs{x}{v}$ is a value, and $\Phi_{t \subs{x}{v}}$ must be of the following form:
            \[ \begin{prooftree}
                \hypo{(\Phi_i \tr \seqi{\Gam_i}{t \subs{x}{v}}{\rdel_i}{(b_i,m_i,d_i)})_{\iI}}
                \infer1[(\ruleMany)]{\seqi{+_{\iI} \Gam_i}{t \subs{x}{v}}{\mul{\rdel_i}_{\iI}}{(+_{\iI} b_i, +_{\iI} m_i, +_{\iI} d_i)}}
            \end{prooftree} \]
            where $\gtype = \mul{\rdel_i}_{\iI}$, $\Gam_{t \subs{x}{v}} = +_{\iI} \Gam_i$, $b = +_{\iI} b_i$, $m = +_{\iI} m_i$, and $d = +_{\iI} d_i$. By the \ih over each $\Phi_i$, we have the following derivations $\Phi^i_t \tr \seqi{\Gam^i_t; x : \M_i}{t}{\rdel_i}{(b^i_t,m^i_t,d^i_t)}$ and $\Phi^i_v \tr \seqi{\Gam^i_v}{v}{\M_i}{(b^i_v, m^i_v, d^i_v)}$, such that $\Gam_i = \Gam^i_t + \Gam^i_v$, $b = b^i_t + b^i_v$, $m = m^i_t + m^i_v$, and $d = d^i_t + d^i_v$, for each $\iI$. So we can construct $\Phi_t$ as follows:
            \[ \begin{prooftree}
                \hypo{(\Phi^i_t \tr \seqi{\Gam^i_t; x : \M_i}{t}{\rdel_i}{(b^i_t,m^i_t,d^i_t)})_{\iI}}
                \infer1[(\ruleMany)]{\seqi{+_{\iI} \Gam^i_t; x : \sqcup_{\iI} \M_i}{t}{\mul{\rdel_i}_{\iI}}{(+_{\iI} b^i_t, +_{\iI} m^i_t, +_{\iI} d^i_t)}}
            \end{prooftree} \]
            such that $\Gam_t = +_{\iI} \Gam^i_t$, $\M = \sqcup_{\iI} \M_i$, $b_t = +_{\iI} b^i_t$, $m_t = +_{\iI} m^i_t$, and $d_t = +_{\iI} d^i_t$. By~\cref{lem:comp-merge-values}, we can take the following derivation $\Phi_v \tr \seqi{+_{\iI} \Gam^i_v}{v}{\M}{(+_{\iI} b^i_v, +_{\iI} m^i_v, +_{\iI} d^i_v)}$. And we can conclude with $\Gam_{t \subs{x}{v}} = +_{\iI} \Gam_i = +_{\iI} (\Gam^i_t + \Gam^i_v) = +_{\iI} \Gam^i_t +_{\iI} \Gam^i_v = \Gam_t + \Gam_v$, $b = +_{\iI} b_i = +_{\iI} (b^i_t + b^i_v) = +_{\iI} b^i_t +_{\iI} b^i_v = b_t + b_v$, $m = +_{\iI} m_i = +_{\iI} (m^i_t + m^i_v) = +_{\iI} m^i_t +_{\iI} m^i_v = m_t + m_v$, and $d = +_{\iI} d_i = +_{\iI} (d^i_t + d^i_v) = +_{\iI} d^i_t +_{\iI} d^i_v = d_t + d_v$.
        \end{itemize}
        \item Let $t = wu$. Then $t \subs{x}{v} = (wu) \subs{x}{v} = (w \subs{x}{v})(u \subs{x}{v})$, and we have to consider three cases:
        \begin{itemize}
            \item Case $\Phi_{t \subs{x}{v}}$ ends with ($\ruleApp$). Assume $\Phi_{w \subs{x}{v}} \tr \seqi{\Gam_{w \subs{x}{v}}}{w \subs{x}{v}}{\M' \ta (\comptype{\stype'}{\ctype})}{(b',m',d')}$ and $\Phi_{u \subs{x}{v}} \tr \seqi{\Gam_{u \subs{x}{v}}}{u \subs{x}{v}}{\tcomptype{\stype}{\M'}{\stype'}}{(b'',m'',d'')}$. $\Phi_{t \subs{x}{v}}$ must be of the following form:
            \[ \begin{prooftree}
                \hypo{\Phi_{w \subs{x}{v}}}
                \hypo{\Phi_{u \subs{x}{v}}}
                \infer2[(\ruleApp)]{\seqi{\Gam_{w \subs{x}{v}} + \Gam_{u \subs{x}{v}}}{(w \subs{x}{v})(u \subs{x}{v})}{\comptype{\stype}{\ctype}}{(1+b'+b'',m'+m'',d'+d'')}}
            \end{prooftree} \]
            where $\gtype = \comptype{\stype}{\ctype}$, $\Gam_{t \subs{x}{v}} = \Gam_{w \subs{x}{v}} + \Gam_{u \subs{x}{v}}$, $b = 1+b'+b''$, $m = m'+m''$, and $d = d'+d''$. By the \ih over $\Phi_{w \subs{x}{v}}$, we have $\Phi_w \tr \seqi{\Gam_w; x : \M_1}{w}{\M' \ta (\comptype{\stype'}{\ctype})}{(b_w,m_w,d_w)}$ and $\Phi^1_v \tr \seqi{\Gam^1_v}{v}{\M_1}{(b^1_v,m^1_v,d^1_v)}$, such that $\Gam_{w \subs{x}{v}} = \Gam_w + \Gam^1_v$, $b' = b_w + b^1_v$, $m' = m_w + m^1_v$, and $d' = d_w + d^1_v$. And by the \ih over $\Phi_{u \subs{x}{v}}$, we have $\Phi_u \tr \seqi{\Gam_u; x : \M_2}{u}{\tcomptype{\stype}{\M'}{\stype'}}{(b_u, m_u,d_u)}$ and $\Phi^2_v \tr \seqi{\Gam^2_v}{v}{\M_2}{(b^2_v,m^2_v,d^2_v)}$, such that $\Gam_{u \subs{x}{v}} = \Gam_u + \Gam^2_v$, $b'' = b_u + b^2_v$, $m'' = m_u + m^2_v$, and $d'' = d_u + d^2_v$. By~\cref{lem:comp-merge-values}, we can take $\Phi_v \tr \seqi{\Gam^1_v + \Gam^2_v}{v}{\M_1 \sqcup \M_2}{(b^1_v+b^2_v, m^1_v+m^2_v, d^1_v+d^2_v)}$, such that $\Gam_v = \Gam^1_v + \Gam^2_v$, $b_v = b^1_v + b^2_v$, $m_v = m^1_v + m^2_v$, and $d_v = d^1_v + d^2_v$. And we can build $\Phi_{wu}$ as follows:
            \[ \begin{prooftree}
                \hypo{\Phi_w}
                \hypo{\Phi_u}
                \infer2[(\ruleApp)]{\seqi{(\Gam_w + \Gam_u); x : \M_1 \sqcup \M_2}{wu}{\comptype{\stype}{\kappa}}{(1+b_w+b_u,m_w+m_u,d_w+d_u)}}
            \end{prooftree} \]
            such that $\Gam_t = \Gam_w + \Gam_u$, $b_t = 1 + b_w + b_u$, $m_t = b_w + b_u$, and $d_t = d_w + d_u$. So we can pick $\Phi_t = \Phi_{wu}$, and conclude with $\Gam_{t \subs{x}{v}} = \Gam_{w \subs{x}{v}} + \Gam_{u \subs{x}{v}} = (\Gam_w + \Gam^1_v) + (\Gam_u + \Gam^2_v) = (\Gam_w + \Gam_u) + (\Gam^1_v + \Gam^2_v) = \Gam_t + \Gam_v$, $b = 1 + b' + b'' = 1 + b_w + b^1_v + b_u + b^2_v = (1 + b_w + b_u) + (b^1_v + b^2_v) = b_t + b_v$, $m = m' + m'' = m_w + m^1_v + m_u + m^2_v = (m_w + m_u) + (m^1_v + m^2_v) = m_t + m_v$, and $d = d' + d'' = d_w + d^1_v + d_u + d^2_v = (d_w + d_u) + (d^1_v + d^2_v) = d_t + d_v$.
            \item Case $\Phi_{t \subs{x}{v}}$ ends with (\ruleAppPOne) or (\ruleAppPTwo). These cases are very similar to the case where $\Phi_{t \subs{x}{v}}$ ends with (\ruleApp).
        \end{itemize}
        \item Let $t = \get{l}{y}{u}$. Then $t \subs{x}{v} = \get{l}{y}{u \subs{x}{v}}$ and $\Phi_{t \subs{x}{v}}$ must be of the following form:
        \[ \begin{prooftree}
            \hypo{\Phi_{u \subs{x}{v}} \tr \seqi{\Gam_{u \subs{x}{v}}; y : \M'}{u \subs{x}{v}}{\comptype{\stype}{\ctype}}{(b,m',d)}}
            \infer1[(\ruleGet)]{\seqi{\Gam_{u \subs{x}{v}}}{\get{l}{y}{u \subs{x}{v}}}{\comptype{\conj{(l : \M')} \splus \stype}{\ctype}}{(b,1+m',d)}}
        \end{prooftree} \]
        where $\Gam_{t \subs{x}{v}} = \Gam_{u \subs{x}{v}}$ and $m = 1+m'$. By the \ih, we have $\Phi_u \tr \seqi{\Gam_u; y : \M'; x : \M}{u}{\comptype{\stype}{\ctype}}{(b_u,m_u,d_u)}$ and $\Phi_v \tr \seqi{\Gam_v}{v}{\M}{(b_v,m_v,d_v)}$, such that $\Gam_{u \subs{x}{v}} = \Gam_u + \Gam_v$, $b = b_u + b_v$, $m' = m_u + m_v$, and $d = d_u + d_v$. So we can build $\Phi_{\get{l}{y}{u}}$ as follows:
        \[ \begin{prooftree}
            \hypo{\Phi_u \tr \seqi{\Gam_u; y : \M'; x : \M}{u}{\comptype{\stype}{\ctype}}{(b_u,m_u,d_u)}}
            \infer1[(\ruleGet)]{\seqi{\Gam_{u}; x : \M}{\get{l}{y}{u}}{\comptype{\conj{(l : \M')} \splus \stype}{\ctype}}{(b_u,1+m_u,d_u)}}
        \end{prooftree} \]
        And we can pick $\Phi_t = \Phi_{\get{l}{y}{u}}$, and conclude with $\Gam_{t \subs{x}{v}} = \Gam_{u \subs{x}{v}} = \Gam_u + \Gam_v$, $b = b_u + b_v$, $m = 1 + m' = 1 + m_u + m_v = (1 + m_u) + m_v$, and $d = d_u + d_v$.
        \item Let $t = \set{l}{w}{u}$. Then $t \subs{x}{v} = (\set{l}{w}{u}) \subs{x}{v} = \set{l}{w \subs{x}{v}}{u \subs{x}{v}}$. Assume $\Phi_{w \subs{x}{v}} \tr \seqi{\Gam_{w \subs{x}{v}}}{w \subs{x}{v}}{\M}{(b',m',d')}$ and $\Phi_{u \subs{x}{v}} \tr \seqi{\Gam_{u \subs{x}{v}}}{u \subs{x}{v}}{\comptype{\conj{(l : \M)}; \stype}{\ctype}}{(b'',m'',d'')}$. $\Phi_{t \subs{x}{v}}$ must be of the following form:
        \[ \begin{prooftree}
            \hypo{\Phi_{w \subs{x}{v}}}
            \hypo{\Phi_{t \subs{x}{v}}}
            \infer2[(\ruleSet)]{\seqi{\Gam_{w \subs{x}{v}} + \Gam_{u \subs{x}{v}}}{\set{l}{w \subs{x}{v}}{u \subs{x}{v}}}{\comptype{\stype}{\ctype}}{(b'+b'',1+m'+m'',d'+d'')}}
        \end{prooftree} \]
        where $\Gam_{t \subs{x}{v}} = \Gam_{w \subs{x}{v}} + \Gam_{u \subs{x}{v}}$, $b = b'+ b''$, $m = 1 + m'+m''$, and $d = d' + d''$. By the \ih over $\Phi_{w \subs{x}{v}}$, we have $\Phi_w \tr \seqi{\Gam_w; x : \M_1}{w}{\M}{(b_w,m_w,d_w)}$ and $\Phi^1_v \tr \seqi{\Gam^1_v}{v}{\M_1}{(b^1_v,m^1_v,d^1_v)}$, such that $\Gam_{w \subs{x}{v}} = \Gam_w + \Gam^1_v$, $b' = b_w + b^1_v$, $m'= m_w + m^1_v$, and $d' = d_w+d^1_v$. And by the \ih over $\Phi_{u \subs{x}{v}}$, we have $\Phi_u \tr \seqi{\Gam_u; x : \M_2}{u}{\comptype{\conj{(l : \M)}; \stype}{\ctype}}{(b_u,m_u,d_u)}$ and $\Phi^2_v \tr \seqi{\Gam^2_v}{v}{\M_2}{(b^2_v,m^2_v,d^2_v)}$, such that $\Gam_{u \subs{x}{v}} = \Gam_u + \Gam^2_v$, $b'' = b_u + b^2_v$, $m'' = m_u + m^2_v$, and $d'' = d_u + d^2_v$. By~\cref{lem:comp-merge-values}, we can take $\Phi_v \tr \seqi{\Gam^1_v + \Gam^2_v}{v}{\M_1 \sqcup \M_2}{(b^1_v + b^2_v, m^1_v+m^2_v, d^1_v + d^2_v)}$, such that $\Gam_v = \Gam^1_v + \Gam^2_v$, $b_v = b^1_v + b^2_v$, $m_v = m^1_v + m^2_v$, and $d_v = d^1_v + d^2_v$. And we can build $\Phi_{\set{l}{w}{u}}$ as follows:
        \[ \begin{prooftree}
            \hypo{\Phi_w \tr \seqi{\Gam_w; x : \M_1}{w}{\M}{(b_w,m_w,d_w)}}
            \hypo{\Phi_u \tr \seqi{\Gam_u; x : \M_2}{u}{\comptype{\conj{(l : \M)}; \stype}{\ctype}}{(b_u,m_u,d_u)}}
            \infer2[(\ruleSet)]{\seqi{(\Gam_w + \Gam_u); x : \M_1 \sqcup \M_2}{\set{l}{w}{u}}{\comptype{\stype}{\ctype}}{(b_w+b_u, 1+m_w+m_u,d_w+d_u)}}
        \end{prooftree} \]
        such that $\Gam_t = \Gam_w + \Gam_u$, $b_t = b_w + b_u$, $m_t = 1 + m_w + m_u$, and $d_t = d_w + d_u$. So we can pick $\Phi_t = \Gam_{\set{l}{w}{u}}$, and conclude with $\Gam_{t \subs{x}{v}} = \Gam_{w \subs{x}{v}} + \Gam_{u \subs{x}{v}} = (\Gam_w + \Gam^1_u) + (\Gam_u + \Gam^2_v) = (\Gam_w + \Gam_u) + (\Gam^1_v + \Gam^2_v) = \Gam_t + \Gam_v$, $b = b' + b'' = (b_w + b^1_v) + (b_u + b^2_v) = (b_w + b_u) + (b^1_v + b^2_v) = b_t + b_v$, $m = 1+ m' + m'' = 1+ (m_w + m^1_v) + (m_u + m^2_v) = (1 + m_w + m_u) + (m^1_v + m^2_v) = m_t + m_v$, and $d = d' + d'' = (d_w + d^1_v) + (d_u + d^2_v) = (d_w + d_u) + (d^1_v + d^2_v) = d_t + d_v$.
    \end{itemize}
%\end{proof}

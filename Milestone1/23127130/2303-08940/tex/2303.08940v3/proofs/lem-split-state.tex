\begin{proof}
    The proof for values is very similar to the corresponding proof for $\lam_s$, so we are only going to show the split lemma for states.
    The proof follows by induction on the structure of $s$: \begin{itemize}
        \item Case $s = \estate$. Then the statement is vacuously true.
        \item Case $s = \upd{l'}{w}{q'}$. Then $\Phi_s$ is of the form: 
        \[ \begin{prooftree}
            \hypo{\Phi_{w} \tr \seqi{\Gam_{w}}{w}{\M}{(b_w,m_w,d_w)}}
            \hypo{\Phi_{q'} \tr \seqi{\Gam_{q'}}{q'}{\stype_{q'}}{(b_{q'}, m_{q'},d_{q'})}}
            \infer2[(\ruleUpd)]{\seqi{\Gam_{w} + \Gam_{q'}}{\upd{l'}{w}{q'}}{\conj{(l' : \M)}; \stype_{q'}}{(b_w+b_{q'},m_w+m_{q'},d_w+d_{q'})}}
        \end{prooftree} \] where $\Gam = \Gam_{w} + \Gam_{q'}$, $\stype = \conj{(l' : \M)}; \stype_{q'}$, $b = b_w + b_{q'}$, $m = m_w + m_{q'}$, and $d = d_w + d_{q'}$. 
        We  consider two cases: \begin{itemize}
            \item Case $l' = l$. Then we simply take $v = w$ and $q = q'$ and we are done.
            \item Case $l' \not= l$.  Since $l \in \dom{\conj{(l' : \M)}; \stype_{q'}}$ and $l' \not= l$, then $l \in \dom{\stype_{q'}}$. By applying the \ih to $q'$, we have that  $q' \equivstate \upd{l}{w'}{q''}$, $\Phi_{w'} \tr \seqi{\Gam_{w'}}{w'}{\stype_{q'}(l)}{(b_{w'},m_{w'},d_{w'})}$ and $\Phi_{q''} \tr \seqi{\Gam_{q''}}{q''}{\stype_{q''}}{(b_{q''},m_{q''},d_{q''})}$, such that $\Gam_{q'} = \Gam_{w'} + \Gam_{q''}$, $\stype_{q'} = \conj{(l : \stype_{q'}(l))}; \stype_{q''}$, $b_{q'} = b_{w'} + b_{q''}$, $m_{q'} = m_{w'} + m_{q''}$, and $d_{q'} = d_{w'} + d_{q''}$. But $s = \upd{l'}{w}{\upd{l}{w'}{q''}} \equivstate \upd{l}{w'}{\upd{l'}{w}{q''}}$, so we can take $v = w'$, $q = \upd{l'}{w}{q''}$, and consider $\Phi_q$ to be the following derivation:
            \[ \begin{prooftree}
                \hypo{\Phi_{w} \tr \seqi{\Gam_{w}}{w}{\M}{(b_w,m_w,d_w)}}
                \hypo{\Phi_{q''} \tr \seqi{\Gam_{q''}}{q''}{\stype_{q''}}{(b_{q''}, m_{q''}, d_{q''})}}
                \infer2[(\ruleUpd)]{\seqi{\Gam_{w} + \Gam_{q''}}{\upd{l'}{w}{q''}}{\conj{(l' : \M)}; \stype_{q''}}{(b_w+b_{q''}, m_w + m_{q''}, d_w+d_{q''})}}
            \end{prooftree} \] where  $\Gam_q = \Gam_{w} + \Gam_{q''}$ and $\stype_q=\conj{(l' : \M)}; \stype_{q''}$. We can then conclude with the following observations:
            \begin{itemize}
            \item $\Gam_v + \Gam_q = \Gam_{w'} +\Gam_{w} + \Gam_{q''} =
              \Gam_{w} + \Gam_{q'} = \Gam$,
                \item Since $\stype = \conj{(l' : \M)}; \stype_{q'}$ and $l' \not= l$, then $\stype(l) = \stype_{q'}(l)$ and
                \begin{align*}
                    \stype = \conj{(l' : \M)}; \stype_{q'} & = \conj{(l': \M)}; \conj{(l : \stype_{q'}(l))}; \stype_{q''} \\
                    & = \conj{(l : \stype_{q'}(l))}; \stype_{q} \\
                    & = \conj{(l : \stype(l))}; \stype_q
                \end{align*}
              \item $b_v + b_q= b_{w'} + b_{w} + b_{q''}=
                 b_w + b_{q'} = b$, $m_v + m_q= m_{w'} + m_{w} + m_{q''}=
                 m_w + m_{q'} = b$ and
                 $d_v + d_q= d_{w'} + d_{w} + d_{q''}=
                 d_w + d_{q'} = d$.
            \end{itemize} 
        \end{itemize}
    \end{itemize}
\end{proof}

%\begin{proof}
    We show a stronger statement of the form:

    Let $(t,s) \red[\gname] (u,q)$. If  $\Phi' \tr \seqi{\Gam}{(u,q)}{\ctype}{(b',m',d)}$, $\Gam$ is tight, and ($\ctype$ is tight or $\neg \isvalue{t}$), then $\Phi \tr \seqi{\Gam}{(t,s)}{\ctype}{(b,m,d)}$, where $\gname =\beta$ implies $b' = b - 1$ and $m' = m$, while $\gname \in \{\getname, \setname\}$ implies $b'=b$ and $m' = m - 1$.

    We proceed by induction on $(t, s) \red (u,q)$: 
    \begin{itemize}
        \item Case $(t,s) = ((\lam x.p) v,s) \redbeta (p \subs{x}{v}, s) = (u,q)$. Then $\Phi'$ must be of the following form:
        \[ \begin{prooftree}
            \hypo{\Phi_{p \subs{x}{v}} \tr \seqi{\Gam_{p \subs{x}{v}}}{p \subs{x}{v}}{\comptype{\stype}{\ctype}}{(b'',m'',d'')}}
            \hypo{\Phi_s \tr \seqi{\Gam_s}{s}{\stype}{(b_s,m_s,d_s)}}
            \infer2[(\ruleConf)]{\seqi{\Gam_{p \subs{x}{v}} + \Gam_s}{(p \subs{x}{v}, s)}{\ctype}{(b''+b_s,m''+m_s,d''+d_s)}}
        \end{prooftree} \]
        such that $\Gam = \Gam_{p \subs{x}{v}} + \Gam_s$, $b' = b''+b_s$, $m' = m''+m_s$, and $d' = d''+d_s$. By~\cref{lem:comp-subs-antisubs}.\ref{lem:comp-antisubs}, there exist $\Phi_p \tr \seqi{\Gam_p; x : \M}{p}{\comptype{\stype}{\ctype}}{(b_p,m_p,d_p)}$ and $\Phi_{v} \tr \seqi{\Gam_v}{v}{\M}{(b_v,m_v,d_v)}$, such that $\Gam_{p \subs{x}{v}} = \Gam_p + \Gam_v$, $b'' = b_p+b_v$, $m'' = m_p+m_v$, and $d'' = d_p + d_v$. We can build $\Phi$ as follows:
        \[ \begin{prooftree}
            \hypo{\Phi_p \tr \seqi{\Gam_p; x : \M}{p}{\comptype{\stype}{\ctype}}{(b_p,m_p,d_p)}}
            \infer1[(\ruleLam)]{\seqi{\Gam_p}{\lam x.p}{\M \ta (\comptype{\stype}{\ctype})}{(b_p,m_p,d_p)}}
            \hypo{\Phi_{v} \tr \seqi{\Gam_v}{v}{\M}{(b_v,m_v,d_v)}}
            \infer1[(\ruleLift)]{\seqi{\Gam_v}{v}{\tcomptype{\stype}{\M}{\stype}}{(b_v,m_v,d_v)}}
            \infer2[(\ruleApp)]{\seqi{\Gam_p + \Gam_v}{(\lam x.p)v}{\comptype{\stype}{\ctype}}{(1+b_p+b_v,m_p+m_v,d_p+d_v)}}
            \hypo{\Phi_s}
            \infer2[(\ruleConf)]{\seqi{(\Gam_p + \Gam_v) + \Gam_s}{((\lam x.t')v, s)}{\ctype}{(1+b_p+b_v+b_s,m_p+m_v+m_s,d_p+d_v+d_s)}}
        \end{prooftree} \]
        such that $b = 1+b_p+b_v+b_s$, $m = m_p+m_v+m_s$, and $d = d_p+d_v+d_s$. And we can conclude with $\Gam = \Gam_{p \subs{x}{v}} + \Gam_s = (\Gam_p + \Gam_v) + \Gam_s$, $b' = b'' + b_s = b_p + b_v + b_s = (1 + b_p + b_v + b_s) - 1 = b - 1$, $m' = m'' + m_s = (m_p + m_v) + m_s = m$, and $d' = d'' + d_s = (d_p + d_v) + d_s = d$.
        \item Case $(t,s) = (vp,s) \ra (vp',q) = (u,q)$, such that $(p,s) \ra (p',q)$. Then we have three cases for the type derivation $\Phi_{p'}$ of $p'$ inside $\Phi'$:
        \begin{itemize}
            \item Case $\Phi_{vp'}$ ends with ($\ruleApp$). Let $\Phi_0$ be the following derivation:
            \[ \begin{prooftree}
                \hypo{\Phi_{v} \tr \seqi{\Gam_v}{v}{\M \ta \comptype{\stype'}{\ctype}}{(b_v,m_v,d_v)}}
                    \hypo{\Phi_{p'} \tr \seqi{\Gam_{p'}}{p'}{\tcomptype{\stype}{\M}{\stype'}}{(b'',m'',d'')}}
                    \infer2[(\ruleApp)]{\seqi{\Gam_v + \Gam_{p'}}{v p'}{\comptype{\stype}{\ctype}}{(1+b_v+b'', m_v+m'', d_v+d'')}}
            \end{prooftree} \]
            $\Phi'$ must be of the following form: 
            \[ \begin{prooftree}
                \hypo{\Phi_0}
                \hypo{\Phi_q \tr \seqi{\Gam_q}{q}{\stype}{(b_q,m_q,d_q)}}
                \infer2[(\ruleConf)]{\seqi{(\Gam_v + \Gam_{p'}) + \Gam_q}{(v p', q)}{\ctype}{(1+b_v+b''+b_q,m_v+m''+m_q,d_v+d''+d_q)}}
            \end{prooftree} \]
            such that $\Gam = (\Gam_v + \Gam_{p'}) + \Gam_q$ tight, $b' = 1+b_v+b''+b_q$, $m' = m_v+m''+m_q$, and $d' = d_v+d''+d_q$. So we can build $\Phi_{(p',q)}$ as follows:
            \[ \begin{prooftree}
                \hypo{\Phi_{p'} \tr \seqi{\Gam_{p'}}{p'}{\tcomptype{\stype}{\M}{\stype'}}{(b'',m'',d'')}}
                \hypo{\Phi_q \tr \seqi{\Gam_q}{q}{\stype}{(b_q,m_q,d_q)}}
                \infer2[(\ruleConf)]{\seqi{\Gam_{p'} + \Gam_q}{(p', q)}{\conftype{\M}{\stype'}}{(b''+b_q,m''+m_q,d''+d_q)}}
            \end{prooftree} \]
            Since $\Gam$ is tight, then $\Gam_{p'} + \Gam_q$ is tight. Moreover, $(p, s) \red (p',q)$ implies $\neg\isvalue{p}$. Then we can apply the \ih, and thus there exists a derivation for $(p,s)$ that must be of the following form:
            \[ \begin{prooftree}
                \hypo{\Phi_p \tr \seqi{\Gam_p}{p}{\tcomptype{\stype''}{\M}{\stype'}}{(b_p,m_p,d_p)}}
                \hypo{\Phi_s \tr \seqi{\Gam_s}{s}{\stype''}{(b_s,m_s,d_s)}}
                \infer2[(\ruleConf)]{\seqi{\Gam_p + \Gam_s}{(p, s)}{\conftype{\M}{\stype'}}{(b_p+b_s,m_p+m_s,d_p+d_s)}}
            \end{prooftree} \]
            where $\Gam_p + \Gam_s = \Gam_{p'} + \Gam_q$ is tight, and either (1) $b''+b_q = b_p+b_s-1$, $m''+m_q=m_p+m_s$, and $d''+d_q = d_p+d_s$, or (2) $b''+b_q = b_p+b_s$, $m''+m_q=m_p+m_s-1$, and $d''+d_q = d_p+d_s$. So, we can build $\Phi$ as follows:
            \[ \begin{prooftree}
                \hypo{\Phi_{v} \tr \seqi{\Gam_v}{v}{\M \ta (\comptype{\stype'}{\ctype})}{(b_v,m_v,d_v)}}
                \hypo{\Phi_p \tr \seqi{\Gam_p}{p}{\tcomptype{\stype''}{\M}{\stype'}}{(b_p,m_p,d_p)}}
                \infer2[(\ruleApp)]{\seqi{\Gam_v + \Gam_p}{vp}{\comptype{\stype''}{\ctype}}{(1+b_v+b_p,m_v+m_p,d_v+d_p)}}
                \hypo{\Phi_s}
                \infer2[(\ruleConf)]{\seqi{(\Gam_v + \Gam_p) + \Gam_s}{(vp, s)}{\kappa}{(1 + b_v + b_p+b_s,m_v+m_p+m_s,d_v+d_p+d_s)}}
            \end{prooftree} \]
            where $\Gam_v + \Gam_p + \Gam_s = \Gam_v + \Gam_{p'} + \Gam_q = \Gam$, $b = 1+b_v+b_p+b_s$, $m = m_v+m_p+m_s$, and $d = d_v+d_p+d_s$. We can conclude since:
            \begin{itemize}
                \item Case (1): $b' = 1 + b_v + b'' + b_q = 1 + b_v + b_p + b_s - 1 = b -1$, and the other counters are easy to check;
                \item Case (2): $m' = m_v + m'' + m_q = m_v + m_p + m_s - 1 = m - 1$, and the other counters are easy to check.
            \end{itemize}
            \item Case $\Phi_{vp'}$ ends with (\ruleAppPOne) or (\ruleAppPTwo). These two cases are very similar to the previous case.
        \end{itemize}
        \item Case $(t,s) = (\get{l}{x}{p},s) \ra (p \subs{x}{v},s) = (u,q)$, such that $s \equivstate \upd{l}{v}{s'}$. Let $\Phi_0$ be the following derivation:
        \[ \begin{prooftree}
            \hypo{\Phi^2_v \tr \seqi{\Gam^2_v}{v}{\M_2}{(b^2_v,m^2_v,d^2_v)}}
            \hypo{\Phi_{s'} \tr \seqi{\Gam_{s'}}{s'}{\stype}{(b_{s'},m_{s'},d_{s'})}}
            \infer2[(\ruleUpd)]{\seqi{\Gam^2_v + \Gam_{s'}}{\upd{l}{v}{s'}}{\conj{(l : \M_2)}; \stype}{(b^2_v+b_{s'},m^2_v+m_{s'},d^2_v+d_{s'})}}
        \end{prooftree} \]
        Then $\Phi'$ must be of the following form:
        \[ \begin{prooftree}
            \hypo{\Phi_{p \subs{x}{v}} \tr \seqi{\Gam_{p \subs{x}{v}}}{p \subs{x}{v}}{\comptype{\conj{(l : \M)}; \stype}{\ctype}}{(b'',m'',d'')}}
            \hypo{\Phi_0}
            \infer2[(\ruleConf)]{\seqi{\Gam_{p \subs{x}{v}} + (\Gam^2_v + \Gam_{s'})}{(p \subs{x}{v}, \upd{l}{v}{s'})}{\ctype}{(b''+b^2_v+b_{s'},m''+m^2_v+m_{s'},d''+d^2_v+d_{s'})}}
        \end{prooftree} \]
        such that $\Gam = \Gam_{p \subs{x}{v}} + (\Gam^2_v + \Gam_{s'})$, $b' = b'' + b^2_v + b_{s'}$, $m' = m'' + b^2_v + b_{s'}$, and $d' = d'' +d^2_v+d_{s'}$. By~\cref{lem:comp-subs-antisubs}.\ref{lem:comp-antisubs}, there exist $\Phi_p \tr \seqi{\Gam_p; x : \M_1}{p}{\comptype{\conj{(l : \M_2)}; \stype}{\ctype}}{(b_p,m_p,d_p)}$ and $\Phi^1_v \tr \seqi{\Gam^1_v}{v}{\M_1}{(b^1_v,m^1_v,d^1_v)}$, such that $\Gam_{p \subs{x}{v}} = \Gam_p + \Gam^1_v$, $b'' = b_p + b^1_v$, $m'' = m_p + m^1_v$, and $d'' = d_p + d^1_v$. Therefore, we can build $\Phi_{\get{l}{x}{p}}$ as follows:
        \[ \begin{prooftree}
            \hypo{\Phi_p \tr \seqi{\Gam_p; x : \M_1}{p}{\comptype{\conj{(l : \M_2)}; \stype}{\ctype}}{(b_p,m_p,d_p)}}
            \infer1[(\ruleGet)]{\seqi{\Gam_p}{\get{l}{x}{p}}{\comptype{\conj{(l : \M_1 \sqcup \M_2)}; \stype}{\ctype}}{(b_p,1+m_p,d_p)}}
        \end{prooftree} \]
        By~\cref{lem:comp-merge-values}, we have $\Phi_v \tr \seqi{\Gam^1_v + \Gam^2_v}{v}{\M_1 \sqcup \M_2}{(b^1_v+b^2_v,m^1_v+m^2_v,d^1_v+d^2_v)}$. Thus, we can build $\Phi_{\upd{l}{v}{s'}}$ as follows:
        \[ \begin{prooftree}
            \hypo{\Phi_v \tr \seqi{\Gam^1_v + \Gam^2_v}{v}{\M_1 \sqcup \M_2}{(b^1_v+b^2_v,m^1_v+m^2_v,d^1_v+d^2_v)}}
            \hypo{\Phi_{s'} \tr \seqi{\Gam_{s'}}{s'}{\stype}{(b_{s'},m_{s'},d_{s'})}}
            \infer2[(\ruleUpd)]{\seqi{(\Gam^1_v + \Gam^2_v) + \Gam_{s'}}{\upd{l}{v}{s'}}{\conj{(l : \M_1 \sqcup \M_2)}; \stype}{(b^1_v+b^2_v+b_{s'},m^1_v+m^2_v+m_{s'},d^1_v+d^2_v+d_{s'})}}
        \end{prooftree} \]
        Finally, we can build $\Phi$ as follows:
        \[ \begin{prooftree}
            \hypo{\Phi_{\get{l}{x}{p}}}
            \hypo{\Phi_{\upd{l}{v}{s'}}}
            \infer2[(\ruleConf)]{\seqi{\Gam_p + (\Gam^1_v + \Gam^2_v) + \Gam_{s'}}{(\get{l}{x}{p}, \upd{l}{v}{s'})}{\ctype}{(b_p+b^1_v+b^2_v+b_{s'},1+m_p+m^1_v+m^2_v+m_{s'},d_p+d^1_v+d^2_v+d_{s'})}}
        \end{prooftree} \]
        such that $b = b_p+b^1_v+b^2_v+b_{s'}$, $m = 1+m_p+m^1_v+m^2_v+m_{s'}$, and $d = d_p+d^1_v+d^2_v+d_{s'}$. And we can conclude with $\Gam = \Gam_{p \subs{x}{v}} + (\Gam^2_v + \Gam_{s'}) = \Gam_p + \Gam^1_v + \Gam^2_v + \Gam_{s'}$, $b' = b'' + b^2_v + b_{s'} = b_p + b^1_v + b^2_v + b_{s'} = b$, and $m' = m'' + m^2_v + m_{s'} = m_p + m^1_v + m^2_v + m_{s'} = (1 + m_p + m^1_v + m^2_v + m_{s'}) - 1 = m - 1$, $d' = d'' + d^2_v + d_{s'} = d_p + d^1_v + d^2_v + d_{s'} = d$.
        \item Case $(t,s) = (\set{l}{v}{p},s) \ra (p, \upd{l}{v}{s}) = (u,q)$. Let $\Phi_0$ be the following derivation:
        \[ \begin{prooftree}
            \hypo{\Phi_{v} \tr \seqi{\Gam_v}{v}{\M}{(b_v,m_v,d_v)}}
            \hypo{\Phi_{s} \tr \seqi{\Gam_s}{s}{\stype}{(b_s,m_s,d_s)}}
            \infer2[(\ruleUpd)]{\seqi{\Gam_v + \Gam_s}{\upd{l}{v}{s}}{\conj{(l : \M)}; \stype}{(b_v+b_s,m_v+m_s,d_v+d_s)}}
        \end{prooftree} \]
        $\Phi'$ must be of the following form:
        \[ \begin{prooftree}
            \hypo{\Phi_p \tr \seqi{\Gam_p}{p}{\comptype{\conj{(l : \M)}; \stype}{\ctype}}{(b_p,m_p,d_p)}}
            \hypo{\Phi_0}
            \infer2[(\ruleConf)]{\seqi{\Gam_p + (\Gam_v + \Gam_s)}{(p, \upd{l}{v}{s})}{\kap}{(b_p+b_v+b_s,m_p+m_v+m_s,d_p+d_v+d_s)}}
        \end{prooftree} \]
        such that $\Gam = \Gam_p + (\Gam_v + \Gam_s)$, $b' = b_p + b_v + b_s$, $m' = m_p + m_v + m_s$, and $d' = d_p + d_v + d_s$. Therefore, we can build $\Phi$ as follows:
        \[ \begin{prooftree}
            \hypo{\Phi_{v} \tr \seqi{\Gam_v}{v}{\M}{(b_v,m_v,d_v,)}}
            \hypo{\Phi_p \tr \seqi{\Gam_p}{p}{\comptype{\conj{(l : \M)}; \stype}{\ctype}}{(b_p,m_p,d_p)}}
            \infer2[(\ruleSet)]{\seqi{\Gam_v + \Gam_p}{\set{l}{v}{p}}{\comptype{\stype}{\ctype}}{(b_v+b_p,1+m_v+m_p,d_v+d_p)}}
            \hypo{\Phi_s}
            \infer2[(\ruleConf)]{\seqi{(\Gam_v + \Gam_p) + \Gam_s}{(\set{l}{v}{p}, s)}{\ctype}{(b_v+b_p+b_s,1+m_v+m_p+m_s,d_v+d_p+d_s)}}
        \end{prooftree} \]
        Notice that the type environment of the conclusion is $(\Gam_v + \Gam_p) + \Gam_s = \Gam$, and the counters are as expected.
    \end{itemize}
%\end{proof}
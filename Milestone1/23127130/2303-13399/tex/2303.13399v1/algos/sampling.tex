\begin{algorithm}[t]
  \caption{Top-down Sampling}
  \label{algo:sampling}

  \SetKwInOut{Input}{Input}
  \SetKwInOut{Output}{Output}

  \Input{Merge tree $ \mT $, decay coefficient $ \alpha $}
  \Output{Node index $ k $}

  \emph{Initialization: $ p \leftarrow 1.0, \ k \leftarrow n - 1 $}

  \While{$ \mathrm{Rand}() < p $ and $ k > 0 $}{
    \eIf{$ \mathrm{Rand}() < 0.5 $}{$ k \leftarrow \mT_{k,0} - n $\;}{$ k \leftarrow \mT_{k,1} - n $\;}
    $ p \leftarrow \alpha \cdot p $\;
  }
  
  $ k \leftarrow k + n $\;
\end{algorithm}

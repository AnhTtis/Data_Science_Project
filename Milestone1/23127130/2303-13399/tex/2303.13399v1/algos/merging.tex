\begin{algorithm}[t]
  \caption{Bottom-up Merging}
  \label{algo:merging}

  \SetKwInOut{Input}{Input}
  \SetKwInOut{Output}{Output}

  \Input{Patch features $ \mF \in \sR^{n \times c} $}
  \Output{Merge tree $ \mT \in \sZ^{(n - 1) \times 2} $}

  \emph{Initialization: $ \sS \leftarrow \{1,2,\dots,n\} $}

  \For{$ k \leftarrow 1 $ \KwTo $ n - 1 $}{
    $ i,j \leftarrow \underset{i,j \in \bm{S}}{\arg\min} \ \mathrm{Cost}(i,j,\mF) \ \mathrm{s.t.}\ \mathrm{Connect}(i,j) $\;
    $ \mT_{k, :} \leftarrow (i, j) $\;
    $  $
    $ \sS \leftarrow \complement_{\sS}{\{i, j\}} \cup \{n + k\} $\;
  }
\end{algorithm}

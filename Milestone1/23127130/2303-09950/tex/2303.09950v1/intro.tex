%!TEX root = graphsc.tex

\section{Introduction}
\label{sec:intro}

Non-rigid point cloud registration is a fundamental and critical problem in computer graphics, computer vision, and robotics. It aims at recovering the non-rigid warping function that transforms a source point cloud to a target one.
In practice, the two point clouds are usually incomplete and share partial and even low overlap, which considerably increases the difficulty of registration.

Estimating the warping function relies on extracting accurate correspondences.
Benefiting from the recent advances in deep point representation~\cite{qi2017pointnet,wang2019dynamic,thomas2019kpconv,vaswani2017attention}, learning-based matching methods~\cite{deng2018ppfnet,gojcic2019perfect,choy2019fully,huang2021predator,li2022lepard,qin2022geometric,trappolini2021shape,wu2020pointpwc,puy2020flot} have obtained significantly high quality of putative correspondences. However, similar success has yet to be achieved in deformable cases. Under significant deformation, these methods are inevitably prone to outliers, which can drastically degrade the accuracy of registration.

\input{figures/teaser}

Outlier rejection is a common technique for robust point cloud registration.
However, most existing methods focus on rigid registration.
An effective method of outlier pruning for non-rigid registration has so far been missing.
On the one hand, a rigid transformation can be pinned down by a small set of inlier correspondences (\eg, a rotation can be determined by $3$ non-colinear inliers) such that sampling consensus methods (\eg, RANSAC~\cite{fischler1981random}) can effectively remove the outliers and recover the alignment transformation in a hypothesize-and-verify manner. However, non-rigid registration requires dense and thoroughly-distributed correspondences to precisely describe the deformation, thus preventing the application of sampling consensus methods.
On the other hand, rigid transformations preserve Euclidean distance between every pair of points. This spatial consistency provides a strong necessary condition for finding inlier correspondences and has been extensively adopted in rigid registration~\cite{bai2021pointdsc,leordeanu2005spectral,chen2022sc2,lee2021deep}.
Apparently, such spatial consistency does not hold for non-rigid cases.
These difficulties make outlier rejection for non-rigid registration a challenging problem.

We propose an outlier rejection network named \emph{Graph-based Spatial Consistency Network} (\ours{}) tailored for non-rigid registration. Our method is designed around the local rigidity of non-rigid deformations, \ie, non-rigid deformations are locally isometric such that the local shape of the point cloud is approximately preserved.
We first design a \emph{graph-based local spatial consistency} measure on the deformation graph~\cite{sumner2007embedded} built over the source point cloud.
It measures the geometric compatibility between the correspondences in the vicinity of a given graph node.
Based on this measure, we propose an attention-based \emph{graph-based correspondence embedding} module to extract \emph{spatial-consistency-aware features} for correspondences, which are further used for discriminative classification of inlier and outlier.
Thanks to the powerful local spatial consistency, our method can effectively prune outliers in putative correspondences while keeping as many inliers as possible. To our knowledge, our method is the first \emph{learning-based outlier rejection for non-rigid point cloud registration}.
Extensive experiments on three challenging benchmarks demonstrate clear superiority of our method.
In particular, \ours{} outperforms the recent state-of-the-art NDP~\cite{li2022non} by over $10\%$ on AccS and AccR for both high- and low-overlap scenarios on the 4DMatch benchmark~\cite{li2022lepard}.

Our main contributions include:
\begin{itemize}
	\vspace{-8pt}
	\item An outlier rejection network for non-rigid point cloud registration which is, to our knowledge, the first learning-based approach to outlier correspondence pruning for non-rigid scenarios.
	\vspace{-8pt}
	\item A graph-based local spatial consistency which measures the local geometric compatibility between correspondences within a local region.
	\vspace{-8pt}
	\item An attention-based correspondence embedding module which encodes the local spatial consistency for learning robust correspondence representation.
\end{itemize} 
\begin{tikzpicture}
    %% 8: fail: flag0
    \node[Node,  minimum width=5.75cm, fill=orange!30] (fail1) at (1,-3.75) {\small Exit with flag = 0};
        \node[Node,  minimum width=5.75cm, fill=orange!30] (fail2) at (9, -19.5) {\small Exit with flag = 0};
    %% 0: input
    \node[Node, minimum height=2cm, minimum width=5.75cm] (YW) at (1, -0.25) {};
        \node at (-1,0.3) [right] {\small $\bY_s = \begin{pmatrix} \by_1 ,  \ldots ,  \by_m\end{pmatrix} \in  \mathbb{R}_{n \times m}$};
        \node at (-1,-0.3) [right] {\small $\bW = \begin{pmatrix} \bw_1 ,  \ldots ,  \bw_m\end{pmatrix} \in \mathbb{R}_{n \times m}$};
        \node at (-1.7,-0.9) [right] {\small Set flag = 0, \ $\rm{dim}(\rm{ker}(\bW)) = \bw^*$};
    %% 1: generator
    \node[Node, minimum height=2cm, minimum width=7cm] (dw) at (9,-0.25) {};
        \node at (6.5,0.3) [right] {\small Find a minimal set of generators};
        \node at (7.1,-0.3) [right] {\small $d_{\bW}=\{\bd_1,\bd_2,...,\bd_r\}$};
        \node at (6.5,-0.9) [right] {\small of the pointed cone $\text{ker}(\bW)\cap\mathbb{R}^m_{\geq 0}$};
        \draw[Edge] (YW)--(dw) node {};   
        \draw[Edge] (7,-1.25) to (7,-2.5) node [above=17pt,left] {\small \ttfamily\bfseries \textcolor{blue}{if} $\displaystyle\bigcup_{i=1}^r \text{supp} (\bd_i) \neq [m]$ or other $r$} to (1,-2.5)  to (fail1);
    %% 2: sub-algorithm on (Y, W)
    \node[Node,  minimum width=7cm, minimum height=1.5cm] (subalg) at (9,-3.75) {};
        \node at (9,-3.5) {\small Check $\bY_s, \bW$ output a weakly reversible};
        \node at (9,-4) {\small realization with a single linkage class};
        \draw[Edge] (dw)--(subalg) node [above= 54pt, left] {\small \ttfamily\bfseries \textcolor{blue}{if} $r = 2$};
        \draw[Edge] (subalg) node[xshift=-3.9cm, above] {\small no}--(fail1);
    %% 3. success: flag1
    \node[Node,  minimum width=7cm, minimum height=1cm, fill=green!30] (flag1) at (9,-6) {};
        \node at (9,-6) {\small Exit with flag = 1};
        % \node at (9,-6.5) {\small realization with a single linkage class found};
    \draw[Edge] (subalg)--(flag1) node [above=30pt, right] {\small yes};
    %% 4: S1 & S2
    \node[Node, minimum height=1cm, minimum width=7cm] (S1S2) at (9,-9.5) {};
        \node at (9,-9.5) {\small Set $S_1 = \{\bd_i, \bd_j\}$ and $S_2 = \bd_{\bW}\setminus S_1$};
        \draw[Edge] (10,-1.25) to (10,-2.5) node [above = 18pt,right] {\small \ttfamily\bfseries \textcolor{blue}{if} $r > 2$ and $r = \bw^*$ or $\bw^* + 1$} to (14,-2.5)  to (14,-7) to (9,-7) to (S1S2);
        \draw[Edge] (9,-7)--(S1S2) node [above = 50pt, left] {\small \ttfamily\bfseries \textcolor{blue}{for} $i = 1, \ldots, r-1$ };   
        \draw[Edge] (9,-7)--(S1S2) node [above = 35pt, left] {\small \ttfamily\bfseries \textcolor{blue}{for} $j = i+1, \ldots, r$ };
    %% 5: Lp and (Yp, Wp)
    \node[Node, minimum height=2.5cm, minimum width=7cm] (Lp) at (9,-12) {};
        \node at (9,-11.2) {\small Depend on $r = \bw^*$ or $\bw^* + 1$, and};
        \node at (9,-11.7) {\small the supports on vectors in $S_1$ and $S_2$};
        \node at (9,-12.3) {\small Define linkage classes $\{L_p\}^{r-1}_{p=1}$ or $\{L_p\}^{r-2}_{p=1}$,};
        \node at (9,-12.9) {\small Set $\bY_p, \bW_p$ associated to linkage class $L_p$};
        \draw[Edge] (S1S2)--(Lp) node {\small };
    %% 6: sub-algorithm on (Yp, Wp)
    \node[Node,  minimum height=2.5cm, minimum width=7cm] (YpWp) at (9,-15.3) {};
        \node at (9,-14.6) {\small Check if all pair matrices $\bY_p, \bW_p$};
        \node at (9,-15.3) {\small output a weakly reversible realization};
        \node at (9,-16.0) {\small consisting of a single linkage class};
        \draw[Edge] (Lp)--(YpWp) node[below] {};
        \node at (9,-18) {$\bullet$};
        \node at (9,-17.75) [left] {\small \ttfamily\bfseries \textcolor{blue}{endfor}\,};
        \node at (9,-18.25) [left] {\small \ttfamily\bfseries \textcolor{blue}{endfor}\,};
        \draw[Edge] (YpWp) to (9,-18) to (13,-18) to (13,-8) to (9, -8);
    %% 7: success: flag2 and flag3
    \node[Node,  minimum width=5.75cm, fill=green!30] (flag2) at (1,-13.3) {\small Exit with flag = 2};
        \node[Node,  minimum width=5.75cm, fill=green!30] (flag3) at (1,-17.3) {\small Exit with flag = 3};
        \draw[Edge] (YpWp) node [xshift=-3.9cm,above]  {\small yes} to (5.5,-15.3) to (1,-15.3) node [above= 20pt,left] {\small \ttfamily\bfseries \textcolor{blue}{if} $r = \bw^*$} to (flag2);
        \draw[Edge] (YpWp) to (5.5,-15.3) to (1,-15.3)node [below= 20pt,left] {\small \ttfamily\bfseries \textcolor{blue}{if} $r = \bw^*+1$} to (flag3);
        \node at (1,-15.3) {$\bullet$};
        \draw[Edge] (YpWp)--(fail2) node [above=70pt, right] {\small no};; 
\end{tikzpicture}  
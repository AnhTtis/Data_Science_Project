%% bare_jrnl.tex
%% V1.4b
%% 2015/08/26
%% by Michael Shell
%% see http://www.michaelshell.org/
%% for current contact information.
%%
%% This is a skeleton file demonstrating the use of IEEEtran.cls
%% (requires IEEEtran.cls version 1.8b or later) with an IEEE
%% journal paper.
%%
%% Support sites:
%% http://www.michaelshell.org/tex/ieeetran/
%% http://www.ctan.org/pkg/ieeetran
%% and
%% http://www.ieee.org/

%%*************************************************************************
%% Legal Notice:
%% This code is offered as-is without any warranty either expressed or
%% implied; without even the implied warranty of MERCHANTABILITY or
%% FITNESS FOR A PARTICULAR PURPOSE! 
%% User assumes all risk.
%% In no event shall the IEEE or any contributor to this code be liable for
%% any damages or losses, including, but not limited to, incidental,
%% consequential, or any other damages, resulting from the use or misuse
%% of any information contained here.
%%
%% All comments are the opinions of their respective authors and are not
%% necessarily endorsed by the IEEE.
%%
%% This work is distributed under the LaTeX Project Public License (LPPL)
%% ( http://www.latex-project.org/ ) version 1.3, and may be freely used,
%% distributed and modified. A copy of the LPPL, version 1.3, is included
%% in the base LaTeX documentation of all distributions of LaTeX released
%% 2003/12/01 or later.
%% Retain all contribution notices and credits.
%% ** Modified files should be clearly indicated as such, including  **
%% ** renaming them and changing author support contact information. **
%%*************************************************************************


% *** Authors should verify (and, if needed, correct) their LaTeX system  ***
% *** with the testflow diagnostic prior to trusting their LaTeX platform ***
% *** with production work. The IEEE's font choices and paper sizes can   ***
% *** trigger bugs that do not appear when using other class files.       ***                          ***
% The testflow support page is at:
% http://www.michaelshell.org/tex/testflow/



\documentclass[journal]{IEEEtran}
%
% If IEEEtran.cls has not been installed into the LaTeX system files,
% manually specify the path to it like:
% \documentclass[journal]{../sty/IEEEtran}





% Some very useful LaTeX packages include:
% (uncomment the ones you want to load)


% *** MISC UTILITY PACKAGES ***
%
%\usepackage{ifpdf}
% Heiko Oberdiek's ifpdf.sty is very useful if you need conditional
% compilation based on whether the output is pdf or dvi.
% usage:
% \ifpdf
%   % pdf code
% \else
%   % dvi code
% \fi
% The latest version of ifpdf.sty can be obtained from:
% http://www.ctan.org/pkg/ifpdf
% Also, note that IEEEtran.cls V1.7 and later provides a builtin
% \ifCLASSINFOpdf conditional that works the same way.
% When switching from latex to pdflatex and vice-versa, the compiler may
% have to be run twice to clear warning/error messages.






% *** CITATION PACKAGES ***
%
%\usepackage{cite}
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of the IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% noadjust option (cite.sty V3.8 and later) if you want to turn this off
% such as if a citation ever needs to be enclosed in parenthesis.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 5.0 (2009-03-20) and later if using hyperref.sty.
% The latest version can be obtained at:
% http://www.ctan.org/pkg/cite
% The documentation is contained in the cite.sty file itself.






% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  % \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi
% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/pkg/graphicx
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/pkg/epslatex
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). The IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex





% *** MATH PACKAGES ***
%
%\usepackage{amsmath}
% A popular package from the American Mathematical Society that provides
% many useful and powerful commands for dealing with mathematics.
%
% Note that the amsmath package sets \interdisplaylinepenalty to 10000
% thus preventing page breaks from occurring within multiline equations. Use:
%\interdisplaylinepenalty=2500
% after loading amsmath to restore such page breaks as IEEEtran.cls normally
% does. amsmath.sty is already installed on most LaTeX systems. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/amsmath





% *** SPECIALIZED LIST PACKAGES ***
%
%\usepackage{algorithmic}
% algorithmic.sty was written by Peter Williams and Rogerio Brito.
% This package provides an algorithmic environment fo describing algorithms.
% You can use the algorithmic environment in-text or within a figure
% environment to provide for a floating algorithm. Do NOT use the algorithm
% floating environment provided by algorithm.sty (by the same authors) or
% algorithm2e.sty (by Christophe Fiorio) as the IEEE does not use dedicated
% algorithm float types and packages that provide these will not provide
% correct IEEE style captions. The latest version and documentation of
% algorithmic.sty can be obtained at:
% http://www.ctan.org/pkg/algorithms
% Also of interest may be the (relatively newer and more customizable)
% algorithmicx.sty package by Szasz Janos:
% http://www.ctan.org/pkg/algorithmicx




% *** ALIGNMENT PACKAGES ***
%
%\usepackage{array}
% Frank Mittelbach's and David Carlisle's array.sty patches and improves
% the standard LaTeX2e array and tabular environments to provide better
% appearance and additional user controls. As the default LaTeX2e table
% generation code is lacking to the point of almost being broken with
% respect to the quality of the end results, all users are strongly
% advised to use an enhanced (at the very least that provided by array.sty)
% set of table tools. array.sty is already installed on most systems. The
% latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/array


% IEEEtran contains the IEEEeqnarray family of commands that can be used to
% generate multiline equations as well as matrices, tables, etc., of high
% quality.




% *** SUBFIGURE PACKAGES ***
%\ifCLASSOPTIONcompsoc
%  \usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
%\else
%  \usepackage[caption=false,font=footnotesize]{subfig}
%\fi
% subfig.sty, written by Steven Douglas Cochran, is the modern replacement
% for subfigure.sty, the latter of which is no longer maintained and is
% incompatible with some LaTeX packages including fixltx2e. However,
% subfig.sty requires and automatically loads Axel Sommerfeldt's caption.sty
% which will override IEEEtran.cls' handling of captions and this will result
% in non-IEEE style figure/table captions. To prevent this problem, be sure
% and invoke subfig.sty's "caption=false" package option (available since
% subfig.sty version 1.3, 2005/06/28) as this is will preserve IEEEtran.cls
% handling of captions.
% Note that the Computer Society format requires a larger sans serif font
% than the serif footnote size font used in traditional IEEE formatting
% and thus the need to invoke different subfig.sty package options depending
% on whether compsoc mode has been enabled.
%
% The latest version and documentation of subfig.sty can be obtained at:
% http://www.ctan.org/pkg/subfig




% *** FLOAT PACKAGES ***
%
%\usepackage{fixltx2e}
% fixltx2e, the successor to the earlier fix2col.sty, was written by
% Frank Mittelbach and David Carlisle. This package corrects a few problems
% in the LaTeX2e kernel, the most notable of which is that in current
% LaTeX2e releases, the ordering of single and double column floats is not
% guaranteed to be preserved. Thus, an unpatched LaTeX2e can allow a
% single column figure to be placed prior to an earlier double column
% figure.
% Be aware that LaTeX2e kernels dated 2015 and later have fixltx2e.sty's
% corrections already built into the system in which case a warning will
% be issued if an attempt is made to load fixltx2e.sty as it is no longer
% needed.
% The latest version and documentation can be found at:
% http://www.ctan.org/pkg/fixltx2e


%\usepackage{stfloats}
% stfloats.sty was written by Sigitas Tolusis. This package gives LaTeX2e
% the ability to do double column floats at the bottom of the page as well
% as the top. (e.g., "\begin{figure*}[!b]" is not normally possible in
% LaTeX2e). It also provides a command:
%\fnbelowfloat
% to enable the placement of footnotes below bottom floats (the standard
% LaTeX2e kernel puts them above bottom floats). This is an invasive package
% which rewrites many portions of the LaTeX2e float routines. It may not work
% with other packages that modify the LaTeX2e float routines. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/stfloats
% Do not use the stfloats baselinefloat ability as the IEEE does not allow
% \baselineskip to stretch. Authors submitting work to the IEEE should note
% that the IEEE rarely uses double column equations and that authors should try
% to avoid such use. Do not be tempted to use the cuted.sty or midfloat.sty
% packages (also by Sigitas Tolusis) as the IEEE does not format its papers in
% such ways.
% Do not attempt to use stfloats with fixltx2e as they are incompatible.
% Instead, use Morten Hogholm'a dblfloatfix which combines the features
% of both fixltx2e and stfloats:
%
% \usepackage{dblfloatfix}
% The latest version can be found at:
% http://www.ctan.org/pkg/dblfloatfix




%\ifCLASSOPTIONcaptionsoff
%  \usepackage[nomarkers]{endfloat}
% \let\MYoriglatexcaption\caption
% \renewcommand{\caption}[2][\relax]{\MYoriglatexcaption[#2]{#2}}
%\fi
% endfloat.sty was written by James Darrell McCauley, Jeff Goldberg and 
% Axel Sommerfeldt. This package may be useful when used in conjunction with 
% IEEEtran.cls'  captionsoff option. Some IEEE journals/societies require that
% submissions have lists of figures/tables at the end of the paper and that
% figures/tables without any captions are placed on a page by themselves at
% the end of the document. If needed, the draftcls IEEEtran class option or
% \CLASSINPUTbaselinestretch interface can be used to increase the line
% spacing as well. Be sure and use the nomarkers option of endfloat to
% prevent endfloat from "marking" where the figures would have been placed
% in the text. The two hack lines of code above are a slight modification of
% that suggested by in the endfloat docs (section 8.4.1) to ensure that
% the full captions always appear in the list of figures/tables - even if
% the user used the short optional argument of \caption[]{}.
% IEEE papers do not typically make use of \caption[]'s optional argument,
% so this should not be an issue. A similar trick can be used to disable
% captions of packages such as subfig.sty that lack options to turn off
% the subcaptions:
% For subfig.sty:
% \let\MYorigsubfloat\subfloat
% \renewcommand{\subfloat}[2][\relax]{\MYorigsubfloat[]{#2}}
% However, the above trick will not work if both optional arguments of
% the \subfloat command are used. Furthermore, there needs to be a
% description of each subfigure *somewhere* and endfloat does not add
% subfigure captions to its list of figures. Thus, the best approach is to
% avoid the use of subfigure captions (many IEEE journals avoid them anyway)
% and instead reference/explain all the subfigures within the main caption.
% The latest version of endfloat.sty and its documentation can obtained at:
% http://www.ctan.org/pkg/endfloat
%
% The IEEEtran \ifCLASSOPTIONcaptionsoff conditional can also be used
% later in the document, say, to conditionally put the References on a 
% page by themselves.




% *** PDF, URL AND HYPERLINK PACKAGES ***
%
%\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/url
% Basically, \url{my_url_here}.




% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
% There should be no need to do such things with IEEEtran.cls V1.6 and later.
% (Unless specifically asked to do so by the journal or conference you plan
% to submit to, of course. )


% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}

\usepackage{comment}
\usepackage{bm}
\usepackage{amssymb}
\usepackage{enumitem}
\usepackage{amssymb}
\usepackage{mathptmx}
\usepackage{url}
\usepackage[scaled=.90]{helvet}
\usepackage{courier}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{datetime}
\usepackage{nomencl} 
\usepackage{hyperref}
\usepackage[Sonny]{fncychap} %for the chapter headings
\usepackage{makeidx}
\usepackage{float}
\usepackage{amsmath}
\usepackage{amssymb}
\newtheorem{theorem}{Theorem}
\usepackage[figuresright]{rotating}
\usepackage{xcolor}
\usepackage{multirow}

\begin{document}
%
% paper title
% Titles are generally capitalized except for words such as a, an, and, as,
% at, but, by, for, in, nor, of, on, or, the, to and up, which are usually
% not capitalized unless they are the first or last word of the title.
% Linebreaks \\ can be used within to get better formatting as desired.
% Do not put math or special symbols in the title.



% \title{ Relay-based Identification of Time-delay Systems with Applications for Unmanned Aerial Vehicles}
\title{Relay-based identification of Aerodynamic and Delay Sensor Dynamics with applications for Unmanned Aerial Vehicles }
% \title{}


%
%
% author names and IEEE memberships
% note positions of commas and nonbreaking spaces ( ~ ) LaTeX will not break
% a structure at a ~ so this keeps an author's name from being broken across
% two lines.
% use \thanks{} to gain access to the first footnote area
% a separate \thanks must be used for each paragraph as LaTeX2e's \thanks
% was not built to handle multiple paragraphs
%

\author{Anees~Peringal,
        Mohamad~Chehadeh,~\IEEEmembership{Member, IEEE,}
        and~Igor~Boiko,~\IEEEmembership{Senior Member,~IEEE}
        and~Yahya~Zweiri,~\IEEEmembership{Member, IEEE}% <-this % stops a space
\thanks{This work was supported by the Khalifa University of Science and Technology under Award CIRA-2020-082 and Award RCI-2018-KUCARS.}
\thanks{A. Peringal, M. Chehadeh and Y. Zweiri are with the Department of Aerospace Engineering, Khalifa University, Abu Dhabi, United Arab Emirates and Khalifa University Center for Autonomous Robotic Systems (KUCARS), Khalifa University, Abu Dhabi, United Arab Emirates.}
\thanks{Y. Zweiri is the Director of the Advanced Research and Innovation Center (ARIC), Khalifa University,
Abu Dhabi, United Arab Emirates.}
\thanks{I. BOIKO is with the Department of Electrical Engineering and Computer Science, Khalifa University, Abu Dhabi, United Arab Emirates.}}
% \thanks{M. Shell was with the Department
% of Electrical and Computer Engineering, Georgia Institute of Technology, Atlanta,
% GA, 30332 USA e-mail: (see http://www.michaelshell.org/contact.html).}% <-this % stops a space
% \thanks{J. Doe and J. Doe are with Anonymous University.}% <-this % stops a space
% \thanks{Manuscript received April 19, 2005; revised August 26, 2015.}}

% note the % following the last \IEEEmembership and also \thanks - 
% these prevent an unwanted space from occurring between the last author name
% and the end of the author line. i.e., if you had this:
% 
% \author{....lastname \thanks{...} \thanks{...} }
%                     ^------------^------------^----Do not want these spaces!
%
% a space would be appended to the last name and could cause every name on that
% line to be shifted left slightly. This is one of those "LaTeX things". For
% instance, "\textbf{A} \textbf{B}" will typeset as "A B" not "AB". To get
% "AB" then you have to do: "\textbf{A}\textbf{B}"
% \thanks is no different in this regard, so shield the last } of each \thanks
% that ends a line with a % and do not let a space in before the next \thanks.
% Spaces after \IEEEmembership other than the last one are OK (and needed) as
% you are supposed to have spaces between the names. For what it is worth,
% this is a minor point as most people would not even notice if the said evil
% space somehow managed to creep in.



% The paper headers
\markboth{Journal of \LaTeX\ Class Files,~Vol.~14, No.~8, August~2015}%
{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for IEEE Journals}
% The only time the second header will appear is for the odd numbered pages
% after the title page when using the twoside option.
% 
% *** Note that you probably will NOT want to include the author's ***
% *** name in the headers of peer review papers.                   ***
% You can use \ifCLASSOPTIONpeerreview for conditional compilation here if
% you desire.




% If you want to put a publisher's ID mark on the page you can do it like
% this:
%\IEEEpubid{0000--0000/00\$00.00~\copyright~2015 IEEE}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark.



% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}




% make the title area
\maketitle

% As a general rule, do not put math, special symbols or citations
% in the abstract or keywords.
\begin{abstract}
In this paper, we present a real-time system identification method based on relay feedback testing with applications to multirotor unmanned aerial vehicles. The proposed identification method provides an alternative to the expensive lab testing of certain UAV dynamic parameters. Moreover, it has the advantage of identifying the parameters that get changed throughout the operation of the UAV which requires onboard identification methods. The modified relay feedback test (MRFT) is used to generate stable limit cycles at frequency points that reveal the underlying UAV dynamics. The locus of the perturbed relay system (LPRS) is used to predict the exact amplitude and frequency of these limit cycles. Real-time identification is achieved by using the homogeneity properties of the MRFT and the LPRS which are proven in this paper. The proposed identification method was tested experimentally to estimate the aerodynamic parameters as well as the onboard sensor's time delay parameters. The MRFT testing takes a few seconds to perform, and the identification computations take an average of 0.2 seconds to complete in modern embedded computers. The proposed identification method is compared against state-of-the-art alternatives. Advantages in identification accuracy and quantification of uncertainty in estimated parameters are shown.
\end{abstract}

% Note that keywords are not normally used for peerreview papers.
\begin{IEEEkeywords}
Sensor signal processing, robotics and automation applications, sensor decision and fusion.
\end{IEEEkeywords}






% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle

\section{Introduction}
\label{introduction}
\subsection{Literature Review}
System identification is the process of obtaining the mathematical model of a dynamical system by observing the system response to a certain input excitation \cite{ljung2010perspectives}. Obtaining a model is equivalent to building a hypothesis about the system, which can be used to conveniently analyze system properties. System identification requires a model structure, data observations to fit the model, and a set of rules to fit the data to the model structure, which is done with the help of a metric to quantify the quality of the developed model. Since the possible specifications on models, data, and metrics are quite vast, the literature offers a plethora of system identification methods, each with its own pros and cons.

System identification techniques may be categorized into grey-box or black-box methods based on the model structure considered. A model is referred to as a grey-box model when it is based on physical principles. Some examples of grey-box models are the steel frame structure like the one used in \cite{Hann2009Sensors}, and the Wiener model used in the identification of creep in \cite{Qi2021Sensors}. On the other hand, black-box models can be arbitrarily complex, and are thus more versatile but are hardly usable for subsequent design, e.g. controller or estimator design. Some examples of black-box models for system identification would use different classes of neural networks to learn the dynamics of the system based on its input-output data. In \cite{Jiang2022}, a feed-forward neural network is used to learn the dynamics of a UAV from flight data. The parameters obtained from this class of identification are the weights of the neural network, but these weights cannot be interpreted in a physical sense for subsequent analysis of the UAV system. Another widely used model is the autoregressive moving average with exogenous input (ARMAX) \cite{Babaei2008Sensors} which suffers from the same limitations of neural networks. 

From a data perspective, in some methods, called asymptotic methods, the model parameters are proved to converge in an asymptotic sense \cite{astrm1966_PE} hence theoretically requiring infinite amounts of data. Asymptotic methods are usually formulated in a statistical framework like the maximum likelihood estimators (MLE), the prediction error method (PEM), and various versions of Kalman filters that are used for model parameters' estimation \cite{Hwang2022Sensors}. The infinite amounts of data required by asymptotic methods motivated the interest in system identification techniques with finite sample complexity, like the non-asymptotic methods that require finite amounts of data with guarantees on error bounds. Examples of non-asymptotic methods include the identification of systems based on ordinary least-squares (OLS) for partially observed linear time-invariant (LTI). In \cite{Necmiye2019ACC}, the Markov parameters of the unknown LTI system are estimated using the OLS framework based on a single trajectory of the system. The authors in \cite{Sarkar2022Finite} offered an alternative approach to \cite{Necmiye2019ACC} in which the Hankel matrix of the system is estimated. Both \cite{Necmiye2019ACC} and \cite{Sarkar2022Finite} required the LTI systems to be strictly stable. The work of \cite{Zheng2021multi} extended the methods in \cite{Necmiye2019ACC,Sarkar2022Finite} to unstable systems at the expense of requiring multiple system trajectories. There is a common drawback in all of these asymptotic and non-asymptotic methods in that they do not offer a specific guideline on how data generation (i.e. rolling out trajectories) should be achieved. This results in some practical challenges, like the way data should be generated from unstable or critically stable systems while attaining safety.

Another approach to identification is based on relay testing \cite{astrm1984RFT}, which offers advantages in safety and the use of a standard data generation approach. Due to its simplicity and safety, relay-based testing was adopted in many robotics and automation applications \cite{Boiko2013}. The main drawback of relay-based identification is that they are limited to low-order models, e.g. first-order or second-order models with time delay. These low-order models are usually an approximation of high-order dynamics, which results in issues in the trade-off between robustness and performance that may constrain the desired system performance.  In \cite{Luyben1987}, a first-order system with time delay is identified using a relay feedback test (RFT) while assuming that the static gain of the system is known as apriori. In \cite{Alfaro2021high} the authors developed a method for the identification of high-order models but it is quite restrictive since it is limited to the model with repeated poles and time delay. Another drawback of relay-based identification is the use of the approximate describing function (DF) method which requires the unknown process to exhibit low-pass filtering properties. The use of DF was mitigated, and an exact method based on the locus of the perturbed relay system (LPRS) was suggested for the identification of first-order plus time delay models in \cite{Boiko2008Autotune}, and was extended to higher-order models in \cite{Castellanos2008}. The method in \cite{Castellanos2008}, which is also based on LPRS, requires the solution of a set of equations which would not be feasible in real-time. 

\begin{comment}
    It is important to note that identification can be driven by different criteria that depend on how the model would be used. For example, identified models that would be used for control may use robust control metrics in the identification criteria to obtain models that are less sensitive to mismatches. A recent example is the deep neural network and the modified relay feedback test (DNN-MRFT) approach that uses a robustness metric in the backpropagation of the DNN training. Therefore identification for control methods does not guarantee the convergence of the estimated parameters to the true parameters. However, in this work, the criteria of identification is the norm of the error of the identified system parameters. Thus the identified models are not optimized for a specific task; they can be used for control design, estimation, fault detection, and so on. Most importantly, a benefit of accurate models that is growing recently is that the use of these models for simulations is indispensable in reinforcement learning, where a control policy may be used based on the behaviour of the UAV learned in simulations.
\end{comment}
\subsection{Motivation}
System identification of UAV dynamics is a preferred alternative to expensive lab testing. For example, the total drag and the total time delay, which have a significant effect on system dynamics and the required controller, are technically difficult and expensive to obtain through first principles. Moreover, some of the UAV dynamics might change during operation such that re-identification of dynamics would be required using limited onboard sensors, e.g. change of the aerodynamic characteristics or a change of the sensor used for positioning which changes the system delay. Safety and short identification time is a must for uninterrupted missions. Moreover, partial knowledge of some system parameters is easily accessible. For example, propulsion dynamics and the inertia of the system are easy to obtain through bench testing. Knowledge of some parameters a priori would make identification faster and more reliable.

The UAV applications motivate the need for a safe and real-time identification method that accurately estimates the unknown parameters of high-order models given a known model structure and partial knowledge about some parameters of the system.
\begin{comment}
    Similar practical scenarios in fields like mechatronic systems and robotics share the challenges and requirements of the illustrated example. 
\end{comment}

\subsection{Contribution}
In this work, we propose a method for the identification of high-order LTI time delay systems with known model structure and partial knowledge of some system parameters based on the modified relay feedback test (MRFT). The proposed method inherits the safety and operational convenience of relay-based testing methods, while being applicable in real-time. The real-time capability is achieved by taking advantage of the homogeneous properties of the LPRS which will be used to compute a normalized identification space called the unit frequency manifold (UFM). The UFMs of multiple MRFT tests that will be used onboard the UAV are preloaded in memory for real-time identification. Thus, our contributions can be summarized by the following:
\begin{enumerate}
    \item Proof of homogeneous properties of the LPRS against time and gain scales as well as MRFT parameters scaling.
    \item Construction of an efficient real-time identification algorithm based on the LPRS properties and UFMs.
    \item Experimental validation on multiple multirotor UAVs.
\end{enumerate}

We have applied the proposed identification method to two different UAV platforms. The experimental results show that the identification of each of the dynamic loops (i.e. altitude, roll, or pitch) takes around ten seconds to complete. To validate the identification method accuracy, we intentionally add a known delay in the flight controller software. The identification method correctly estimates the time delay increment. Moreover, time delay and aerodynamic identification results were consistent for loops with the same hardware setup indicating the high precision of the proposed method. A video abstract of the paper is provided in \cite{paper_video}. 

%The presented identification technique relies on time-scale and invariance properties that are necessary to construct a normalized identification space called the unit frequency manifold (UFM). The identification consists of three steps: transforming the test data to the UFM, identification on the UFM, and transforming the results back from the UFM to get the system parameters. We show that the UFM exist in a certain class of nonlinearities, like the relay, the modified relay, and the two relay controller. 
%Our analysis shows that for unique identification of UAV parameters, one of the time constants of the UAV has to be known apriori. We choose the time constant of the actuator system since we use the same actuator system on multiple drones, the time constant can be assumed to be same on all the actuators.
%From the experiments conducted in this paper, we were able to identify the time delay of the UAV with an error of 9ms.
%Our analysis shows that the knowledge of \(N-2\) parameters of the system, where \(N\in \mathcal{Z}^+\) is the total number of system parameters, is required for identification. Successive application of the identification algorithm is possible under certain conditions so that only the prior knowledge of \(N-2S\) instead of \(N-2\) parameters of the system would be required, where \(S\in\mathcal{Z}^+\) is the number of possible successive tests. The proposed identification method is verified in simulations and experiments on a VTOL UAV. The experimental results show that the proposed identification method increased the identified parameters accuracy by x percentage compared to x methods given the same time window, while having advantages in safety and real-time applicability.

%analysis for the uniqueness of the estimated system parameters for valid identification. 

%\subsection{Paper Organization}
%The paper is organized as follows: First, the considered identification problem and assumptions are presented in Section \ref{sec_prop_statement}. Then the procedure for the construction of the UFM and the necessary conditions for its existence based on LPRS invariance and homogeneity analysis are presented in Section \ref{sec_ufm}. This would be followed by presenting the UAV dynamics that account for propulsion dynamics and aerodynamics in Section \ref{sec_uav_case}. Experimental and simulation validation of the identification performance, and comparison with other methods are presented in Section \ref{sec_results}. Finally, conclusions and outlook are presented in Section \ref{sec_conclusion}

\section{Problem Statement}\label{sec_prop_statement}
Let $W_l(s,\mathbf{p})$ be an unknown LTI dynamical system, and let $\mathbf{p}\in \mathbb{R}^N$ be the vector of parameters that characterize \(W_l\), which includes time constants, gains, and delay. Further, let \(\mathbf{\hat{p}}\) be an estimateabout the unknown parameters \(\mathbf{p}\), and let \(E\) and \(I\) represent a set of equality and inequality constraints applied to \(\mathbf{\hat{p}}\), respectively. The set \(E\) represents the pre-known system parameters, e.g. from bench tests or reference manuals. The set \(I\) represents possible pre-known ranges for identification, e.g. range of the unknown mass of a UAV is between 100 g and 10 kg. The constraints \(E\) and \(I\) characterize a subspace \(U \subset \mathbb{R}^N\), such that \(\mathbf{\hat{p}}\in U\).

Since a relay-based test would be used, we further define the relay test as a map (\(\mathbf{p},\mathbf{\zeta})\mapsto (\Omega_t,a_t)=M(\mathbf{p},\mathbf{\zeta})\), where \(\mathbf{\zeta}\) is a vector that characterizes the test parameters, and \(\Omega_t\), \(a_t\) are the frequency and amplitude of the generated limit cycle respectively. The goal of the identification is to find an inverse map \((\Omega_t,a_t,E,I)\mapsto (\mathbf{\hat{p}})=M^{-1}(\Omega_t,a_t,E,I)\) such that \(||\mathbf{p}-\mathbf{\hat{p}}||_n\) is minimized.

In the case of UAV attitude dynamics, a second-order integral plus time delay (SOIPTD) system is to be identified \cite{multirotors}. The nominal model structure is of the form:
\begin{equation}
    \begin{bmatrix}
        \dot{\theta} \\
        \dot{\omega} \\
        \dot{M}  
    \end{bmatrix} = 
    \begin{bmatrix}
        0 & 1 & 0\\
        0 & -\frac{B_x}{J_x}& \frac{1}{J_x}\\
        0 &0 &\frac{1}{T_p} 
    \end{bmatrix}\begin{bmatrix}       
        \theta \\
        \omega \\
        M  
    \end{bmatrix} + \begin{bmatrix}       
        0 \\
        0 \\
        \frac{k_{M,b_x}}{T_p} 
    \end{bmatrix}u(t-\tau_p)
\end{equation}
where $B_x$ is the rotor drag coefficient, $J_x$ is the moment of inertia of the UAV and $k_{M,b_x}$ is the moment gain of the actuator. In the transfer function form, it is written as:
\begin{equation}\label{eq_altitude_attitude_dynamics}
    G(s) = \frac{KT_de^{-\tau s}}{s(T_ps+1)(T_ds+1)}
\end{equation}
where the time constants \(T_p\) and \(T_d = \frac{J_x}{B_x}\) represent the propulsion and aerodynamics time constants respectively, \(\tau\) is the time delay and $K$ is the static gain of the system.

\begin{figure*}[ht]
    \centering
    \includegraphics[width = \textwidth]{images/conditions_ufm_ugm.png}
    \caption{Effect of time and gain scaling of process parameters on MRFT excited oscillations frequency and amplitude. We prove the homogeneity of arbitrary closed-loop linear dynamics with MRFT using the LPRS.}
    \label{fig_conditions_ufm_ugm}
    \vspace{-5mm}
\end{figure*}

\section{Identification on the Normalized Subspace}\label{sec_ufm}
The design of the map \(M\) is essential for the accuracy of estimating \(\mathbf{\hat{p}}\). The definition of \(M\) requires the selection of the relay nonlinearity used in the test algorithm and its tunable parameters \(\mathbf{\zeta}\). For some cases, it is possible to find an analytical solution for \(M^{-1}\) through the use of the Locus of the Perturbed Relay System (LPRS). But for the cases where analytical solutions do not exist, a numerical estimate of \(M^{-1}\) is required. It is possible for the range \(U\) to be an open set, and hence even a numerical estimate of \(M^{-1}\) would not be feasible.

It is yet possible under certain conditions for \(U\) to be mapped to a compact set represented by two special manifolds \(\mathcal{P}\) and \(\mathcal{R}\) which we called the UFM and the \emph{unit gain manifold} (UGM), respectively. Normalizing to unit frequency and unit gain is chosen as a convention. The conditions for the existence of UFM and UGM depend on the properties of the relay used in the test. In this section we introduce MRFT, the test that would be used for data generation, and the conditions for the existance of the UFM and UGM. Finally we discuss the generation of UFM and UGM for the model considered in Eq. \eqref{eq_altitude_attitude_dynamics}.

\subsection{The modified relay feedback test}
The MRFT \cite{Boiko2013} is an algorithm that produces a switching output at a specified phase. The MRFT is given by:
\begin{equation}\label{eq_mrft_algorithm}
u_M(t)=
\left\{
\begin{array}[r]{l l}
h\; &:\; e(t) \geq b_1\; \lor\; (e(t) > -b_2 \;\land\; u_M(t-) = \;\;\, h)\\
-h\; &:\; e(t) \leq -b_2 \;\lor\; (e(t) < b_1 \;\land\; u_M(t-) = -h)
\end{array}
\right.
\end{equation}
where \(b_1 = -\beta e_{min}\) and \(b_2 = \beta e_{max}\), and \(u_M(-t)\), \(e_{max}\), and \(e_{min}\) are the previous command, maximum error, and minimum error, respectively. MRFT has tunable parameters \(\bm{\zeta}=[\beta\;h]^T\) which needs to be designed. The describing function (DF) of MRFT is presented in \cite{Boiko2013} as:
\begin{equation}\label{eq_mrft_df}
N_M(a)=\frac{4h}{\pi a}(\sqrt{1-\beta^{2}}-j\beta)
\end{equation}

Using the DF, it could be shown that the MRFT achieves oscillations at a specified phase angle by satisfying the HB equation \cite{Boiko2013}:
\begin{equation}\label{eq_hb}
W_l(j{\Omega}_t)=\frac{-1}{N_M({a}_t)}
\end{equation}
with the RHS given by:
\begin{equation}
    \frac{-1}{N_M({a}_t)}=\frac{-\pi {a}_t}{4h}\left(\sqrt{1-\beta^2} +j\beta\right) 
\end{equation}
and the corresponding magnitude and phase of the RHS of Eq. \eqref{eq_hb} given by:
\begin{equation}\label{eq_mrft_hb_mag_phase}
    \begin{aligned}
        |\frac{-1}{N_M({a}_t)}|=\frac{\pi {a}_t}{4h}\\
        \arg \frac{-1}{N_M({a}_t)}= -\pi+\arcsin{\beta}
    \end{aligned}
\end{equation}

Note that the existence of a stable limit cycle for the UAV model when using MRFT was proven in \cite{ayyad2021multirotors}, and is assumed hereafter. The predicted limit cycle frequency \({\Omega}_t\) and amplitude \({a}_t\) are exact since the LPRS is adopted in the present paper.

\vspace{-3mm}
\subsection{Proof of homogeneity properties using the LPRS}\label{proof_lemmas}
\begin{comment}
    assuming that we always have a stable limit cycle, are as follows:
\begin{itemize}[font=\bfseries]
    \item \textbf{Lemma 1:} Invariance of the test frequency \(\Omega_t\), with respect to scaling of the static system gain or relay amplitude scale.
    \item \textbf{Lemma 2:} Equivariance of the change of the amplitude of the test \(a_t\) to relay amplitude scale and system gain scale. 
    \item \textbf{Lemma 3:} Homogeneous change of the test frequency \(\Omega_t\) with respect to time scale of the time parameters of the system.
    \item \textbf{Lemma 4:} Homogeneous change of the amplitude of the test \(a_t\) with respect to time scale of the time parameters of the system. 
\end{itemize}
\end{comment}
 
The conditions for the generation of UFM and UGM is governed by the four lemmas summarized in Fig. \ref{fig_conditions_ufm_ugm}. Lemmas 1 and 2 would allow the system parameters to be split \(\mathbf{p}=[K\;\mathbf{p_t}]^T\) where \(\mathbf{p_t}\) are the time-dependent parameters of the system. Lemmas 3 and 4 relate the generated test frequency with the unknown system time parameters. To prove these lemmas we use the LPRS. 

The LPRS is a method that was introduced in \cite{BOIKO2005677} which can provide an exact solution of the periodic motion in a relay feedback system. A variation of LPRS, denoted as the \(\Phi(\omega)\) function \cite{boiko2007analysis}, can be used to provide the exact solution for oscillations when the system is excited by MRFT. The complex function \(\Phi(\omega)\) was designed to be compatible with the HB formulation so that the MRFT DF can be used to predict limit cycles. The LPRS based approach for analysis of periodic motion is achieved by replacing the system frequency response \(W_l(j\Omega_t)\) in the HB Eq. \eqref{eq_hb} by \(\Phi\) to obtain:
\begin{equation}\label{eq_exact_hb}
    \Phi(\Omega_t)=\frac{-1}{N_M(a_t)}
\end{equation}
though the DF of MRFT is used, the predicted limit cycle frequency \(\Omega_t\) and amplitude \(a_t\) are exact since \(\Phi(\omega)\) accounted for all harmonics in the relay switching. The Lemmas 1-4 will be proven using \(\Phi(\omega)\). The complex function \(\Phi(\omega)\) is given by:
\begin{equation}\label{eq_phi_mrft}
    \Phi(\omega)=-\sqrt{[a_y(\omega)]^2-y^2(\frac{\pi}{\omega},\omega)}+jy(\frac{\pi}{\omega},\omega)
\end{equation}
where \(y(\frac{\pi}{\omega},\omega)\) is the value of the system periodic output at the instant of switch of MRFT from \(-h\) to \(h\).  The amplitude of the process output \(a_y(\omega)\) is given by:
\begin{equation}\label{eq_amplitude_mrft_exact}
    a_y(\omega)=\max_{t\in[0,T]}|y(t,\omega)|
\end{equation}

Note that \(y(\frac{\pi}{\omega},\omega)=\beta a_y(\omega)\). The periodic output signal \(y(t,\omega)\) may be found using the Fourier series:
\begin{equation}\label{eq_fourier_series_mrft}
\begin{aligned}
y(t,\omega)=\frac{4h}{\pi}\sum_{k=1}^\infty & \frac{(-1)^{k+1}}{2k-1}\sin[(2k-1)\omega t+\\
&\varphi_l((2k-1)\omega)]A_l((2k-1)\omega)
\end{aligned}
\end{equation}
where \(\varphi_l(\omega)=\arg W_l(j\omega)\), \(A_l(\omega)=|W_l(j\omega)|\). Assuming a nominal system \(W_{l0}\) given by:
\begin{equation}
    W_{l0}(j\omega_0)=K_0\frac{\prod_i(jT_{N_i}\omega_0+1)e^{-j\tau \omega_0}}{(j\omega_0)^{n_i}\prod_j(jT_{D_j}\omega_0+1)}
\end{equation}
with corresponding function \(\Phi_0(\omega_0)\), amplitude of oscillation \(a_{y,0}(\omega_0)\), and output \(y_0(t,\omega_0)\). The magnitude \(|W_{l0}(j\omega_0)|\) is then given by:
\begin{equation*}
    |W_{l0}(j\omega_0)|=K_0\frac{\prod_i\sqrt{(T_{N_i}\omega_0)^2+1}}{(\omega_0)^{n_i}\prod_j\sqrt{(T_{D_j}\omega_0)^2+1}}
\end{equation*}
and the phase \(\arg W_{l0}(jk\omega_0)\) is given by:
\begin{align*}    
    \arg W_{l0}(j\omega_0)=\sum_i\arctan{T_{N_i}  \omega_0}-\sum_i\arctan{T_{D_i}  \omega_0}\\-n_i\frac{\pi}{2}-\tau \omega_0
\end{align*}

\paragraph*{\textbf{Lemma 1}}  The frequency $\Omega_t$ of the test oscillations under the MRFT is invariant to the change of the static gain of the system

\paragraph*{Proof of Lemma 1}

Let $\Omega_{t0}$ be the frequency of the test oscillations corresponding to the process \(W_{l0}\). Further let \(W_{l\alpha}(j\omega_\alpha)\) be a system that is related to the nominal system \(W_{l0}\) by a scaled static gain \(K_\alpha=\alpha_K K_0\). Since  \(\arg W_{l\alpha}(j\omega_\alpha)\) is independent of \(K_\alpha\), we get \(\arg W_{l\alpha}(j\omega_\alpha)=\arg W_{l0}(j\omega_0)\). This leads to the phase balance of Eq. \eqref{eq_exact_hb}, which leads to the invariance of test frequency \(\Omega_{t\alpha}=\Omega_{t0}\). 

Moreover, changing the MRFT amplitude \(h\) in Eq. \eqref{eq_mrft_hb_mag_phase} does not change the limit cycle phase, and hence the phase balance in the Eq. \eqref{eq_exact_hb} remains the same, leading to invariance of the test frequency \(\Omega_{t0}\). Hence, Lemma 1 is proved. 

\paragraph*{\textbf{Lemma 2}}  The amplitude $a_t$ of the test oscillations under the MRFT is a homogeneous function of the system static gain and MRFT amplitude

\paragraph*{Proof of Lemma 2}
Given the magnitude relationship \(|W_{l\alpha}(j\omega_0)|=\alpha|W_{l0}(j\omega_0)|\), we obtain \(y_\alpha(t,\omega_0)=\alpha y_0(t,\omega_0)\) for Eq. \eqref{eq_fourier_series_mrft}, and \(a_{y,\alpha}=\alpha a_{y,0}\) for Eq. \eqref{eq_amplitude_mrft_exact}. Then, using Eq. \eqref{eq_phi_mrft}, the LPRS \(\Phi_\alpha(\omega_0)\) is related to \(\Phi_0(\omega_0)\) by:
\begin{multline}
    \Phi_\alpha(\omega_0)=-\sqrt{\alpha^2[a_{y,0}(\omega_0)]^2-\alpha^2y_0^2\left(\frac{\pi}{\omega},\omega_0\right)}+\alpha jy_0(\frac{\pi}{\omega_0},\omega_0)\\=
    \alpha(-\sqrt{[a_{y,0}(\omega_0)]^2-y_0^2(\frac{\pi}{\omega_0},\omega_0)}+jy_0(\frac{\pi}{\omega_0},\omega_0))=\alpha\Phi_0(\omega_0)
    \label{eq_gain_scale_mag}
\end{multline}
which is homogeneous with degree one. 

Note that scaling the relay amplitude in the RHS of Eq. \eqref{eq_exact_hb} as \(h_{\alpha_h}=\alpha_h h_0\) would simply result in \(a_{t,\alpha_h}=\alpha_h a_{t,0}\) which is also homogeneous with degree one. Since both scaling the system gain and the MRFT amplitude resulted in the same homogeneity degree, there is an equivariance between these scales, which proves Lemma 2.

\paragraph*{\textbf{Lemma 3}}  The frequency $\Omega_t$ of the test oscillations under the MRFT is a homogeneous function of the system time parameters

\paragraph*{Proof of Lemma 3} Consider the system \(W_{l\gamma}(j\omega_\gamma)\) related to the nominal system \(W_{l0}(j\omega_0)\) by the scale of the system time parameters \(\bm{p}_\gamma=\gamma\bm{p}_0\). Given the phase equation of \(W_{l\gamma}(j\omega_\gamma)\):
\begin{align*}
    \arg W_{l\gamma}(j\omega_\gamma)=\sum_i\arctan{\gamma T_{N_i} \omega_\gamma}-\sum_i\arctan{\gamma T_{D_i} \omega_\gamma}\\-n_i\frac{\pi}{2}-\gamma\tau \omega_\gamma
\end{align*}
and assuming the new frequency \(\omega_\gamma\) is related to the nominal system frequency by:
\begin{equation}\label{eq_time_scale_effect}
    \omega_\gamma=\frac{\omega_0}{\gamma}
\end{equation}
we obtain \(\arg W_{l\alpha}(j\frac{\omega_0}{\gamma})=\arg W_{l0}(j\omega_0)\), which leads to the homogeneous relation of the test frequency \(\Omega_\gamma=\frac{\Omega_0}{\gamma}\), and therefore, proves Lemma 3.


\paragraph*{\textbf{Lemma 4}}  The amplitude $a_t$ of the test oscillations under the MRFT is a homogeneous function of the system time parameters


\paragraph*{Proof of Lemma 4} The magnitude of the system \(W_{l\gamma}(j\omega_\gamma)\) is related to the nominal system by:
\begin{align}
    |W_{l\gamma}(j\omega_\gamma)|&=\gamma^{n_i}K_0\frac{\prod_i\sqrt{(\gamma T_{N_i}\omega_\gamma)^2+1}}{(\omega_\gamma)^{n_i}\prod_j\sqrt{(\gamma T_{D_j}\omega_\gamma)^2+1}}
\end{align}
and using the result from Lemma 3 proof:
\begin{align}
    |W_{l\gamma}(j\frac{\omega_0}{\gamma})|&=\gamma^{n_i}K_0\frac{\prod_i\sqrt{(T_{N_i}\omega_0)^2+1}}{(\omega_0)^{n_i}\prod_j\sqrt{(T_{D_j}\omega_0)^2+1}}\\
    &=\gamma^{n_i}|W_{l0}(j\omega_0)|
\end{align}
which leads to \(y_\gamma(\gamma t,\frac{\omega_0}{\gamma})=\gamma^{n_i}y_0(t,\omega_0)\) and the LPRS of the nominal and time-scaled systems are related by (we use the results from Eq. \eqref{eq_gain_scale_mag}):
\begin{equation}
    \Phi_\gamma(\frac{\omega_0}{\gamma})=\gamma^{n_i}\Phi_0({\omega_0})
\end{equation}

Hence, the amplitude of the test is homogeneous with respect to time scaling with degree \(n_i\), which proves Lemma 4.
\begin{comment}
\subsection{Using LPRS}
The LPRS is given by:
\begin{equation}
    J(\omega)=\Sigma_{k=1}^{\infty}(-1)^{k+1}\text{Re}W_l(k\omega)+j\Sigma_{k=1}^{\infty}\frac{1}{2k-1}\text{Im}W_l[(2k-l)\omega]
\end{equation}
which can be rewritten in polar form as:
\begin{equation}
    J(\omega)=\Sigma_{k=1}^{\infty}(-1)^{k+1}|W_l(k\omega)|\cos{\angle W_l(k\omega)}+j\Sigma_{k=1}^{\infty}\frac{1}{2k-1}|W_l[(2k-l)\omega]|\sin{\angle W_l[(2k-l)\omega]}
\end{equation}
For a strictly proper linear system, the magnitude is given by:
\begin{multline}\label{series_phase}
|W_l(k\omega)|=K\frac{\prod_{i}\sqrt{(T_{Ni}^2(k\omega)^2+1)}}{(k\omega)^{n_i}\prod_{j}\sqrt{(T_{Dj}^2(k\omega)^2+1)}}
\end{multline}
and the phase by:
\begin{multline}
    \angle W_l(k\omega)= \sum_{i} \arctan{T_{Ni}k\omega} -\sum_{j} \arctan{T_{Di}k\omega}-\frac{\pi}{2}^{n_i}-\tau\omega
\end{multline}
Let varying the gain scale \(\alpha\) result in \(W_{l,\alpha}(k\omega_{\alpha})\). Since the phase equation \eqref{series_phase} is independent of the system gain \(K\) then \(\angle W_{l,\alpha}(k\omega_{\alpha})=\angle W_{l}(k\omega)\). Thus test frequency is invariant to gain scale, i.e. \(\omega_{\alpha}=\omega\). The magnitude of the scaled system is given by \(|W_{l,\alpha}(k\omega_{\alpha})|=\alpha|W_{l}(k\omega)|\), and hence it is a homogeneous map with degree of \(r_1=1\).

Let varying the time scale \(\gamma\) result in the time scaled system \(W_{l,\gamma}(k\omega_{\gamma})\). Since the phase of the DF remains unchanged, the phase balance \(\angle W_{l,\gamma}=\angle W_{l}\) is maintained:
\begin{multline}
    \sum_{i} \arctan{T_{Ni}k\omega} -\sum_{j} \arctan{T_{Di}k\omega}-\frac{\pi}{2}^{n_i}-\tau\omega = \sum_{i} \arctan{T_{Ni}k\gamma\omega_{\gamma}} -\sum_{j} \arctan{T_{Di}k\gamma\omega_{\gamma}}-\frac{\pi}{2}^{n_i}-\gamma\tau\omega_{\gamma}
\end{multline}
which results in \(\omega_{\gamma}=\frac{\omega}{\gamma}\), i.e. homogeneity degree \(r_4=-1\). Substituting in the magnitude balance gives:
\begin{equation}
    |W_{l,\gamma}(k\frac{\omega}{\gamma})|=\gamma^{n_i}|W_{l}(k\omega)|
\end{equation}
which is homogeneous with degree \(r_3=n_i\).
\end{comment}

\vspace{-3mm}
\subsection{Unit frequency manifold}\label{UFM}
Achieving parameter identification in the unbounded parameter space in real-time is not feasible. To overcome this, a bounded normalized parameter space is obtained by leveraging the homogeneity properties of MRFT. 
% In Section \ref{proof_lemmas}, it was proven using LPRS that 
If the time parameters of a nominal process are scaled by a factor $\gamma$, the frequency of oscillation also scales by a factor of $\frac{1}{\gamma}$. From this result, we may argue that for every process in the parameter space that produces oscillations of frequency $\Omega_0$, we can find a corresponding process that produces oscillations at an arbitrary frequency $\hat{\Omega}$ by choosing $\gamma = \frac{\Omega_0}{\hat{\Omega}}$. Using this, we find a set of process parameters that produce the same frequency; the identification will be done on this set. The set of processes that produce any other frequency of oscillations can be obtained by simple scaling. By convention, we choose all the processes on the set to have oscillations of 1Hz frequency, and therefore, we call this set the \textit{unit frequency manifold} (UFM). Similarly, by Lemma 1, due to the invariance of the frequency to the static gain of the system, the processes in the UFM may have different static gains. By convention, we define the static gain of all the processes in the UFM to be unity. Therefore, the set of amplitudes of the processes in the UFM is called \textit{unit gain manifold} (UGM). 

Introducing the idea of UFM and UGM offers us many practical advantages. Firstly, for a class of LTI systems, the UFM and UGM can be computed beforehand, which allows the identification to be performed in real-time. This was not feasible before in the LPRS-based identification. Secondly, the parameter space is compacted to a surface which would decrease the computing power and memory required for identification. 

Consider the SOIPTD model of the UAV dynamics as described in Eq. \eqref{eq_altitude_attitude_dynamics}.
%This type of a model is of particular interest because the altitude, as well as roll/pitch dynamics of a UAV, follows this model structure. 
The UFM and the corresponding UGM of this model for a particular beta were computed and illustrated in Fig. \ref{fig:UFM} and Fig. \ref{fig:UGM}.
\begin{figure}
     \centering
     \begin{subfigure}[b]{0.45\textwidth}
         \centering
         \includegraphics[width=\textwidth]{images/UFM_UGM_fig1.png}
         \caption{Unit frequency manifold for $\beta = -0.5$}
         \label{fig:UFM}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.45\textwidth}
         \centering
         \includegraphics[width=\textwidth]{images/UFM_UGM_fig2.png}
         \caption{Unit gain manifold for $\beta = -0.5$}
         \label{fig:UGM}
     \end{subfigure}
    % \begin{subfigure}[b]{0.32\textwidth}
    %      \centering
    %      \includegraphics[width=\textwidth]{images/UFM_UGM_fig3.png}
    %      \caption{Non unique mapping from amplitude to system parameters}
    %      \label{fig:UGM}
    %  \end{subfigure}
     \caption{A slice of the UFM which corresponds to the known $T_p$ is shown in red in Fig. \ref{fig:UFM}. The amplitude of oscillations for this set of processes is shown in 
    Fig. \ref{fig:UGM}.}
     \hfill
     \vspace{-7mm}
\end{figure}
It was found through simulation tests that using UGM for identification gives inaccurate results in the presence of noise. Therefore, the identification is done solely based on the frequency of oscillations. We require two oscillations from MRFT to identify the parameters of a UAV.
The simulation results that show the inaccuracies from using the UGM are further discussed in Section \ref{sim_results}.
% The Fig \ref{fig:UGM} shows that multiple processes in the UFM map to the same amplitude. Therefore, we cannot uniquely identify three time parameters based on the UGM. The identification will be done based on the frequency of oscillations alone, and for this, we require some apriori information about the UAV dynamics in order to identify the time parameters of the UAV uniquely.

%Consider the example of the same process, but we accurately know $T_1$. This simplifies the problem, yet it is not trivial to uniquely identify the other time parameters of the UAV dynamics. The UFM and UGM subject to the constraint of the known $T_1$ is illustrated in \textcolor{red}{generate the figure of UFM/UGM at a $T_p$ slice}. At a lower \textcolor{red}
%{$T_d$}, the UGM shows non-uniqueness of the mapping. Therefore, we cannot use the amplitude of the MRFT oscillations in order to identify time parameters accurately. This necessitates the need for another MRFT for unique identification of time parameters.
%\textcolor{blue}{I should  show the LPRS based identification will go to one of the other minima. It is not trivial since describing function }


%\textcolor{blue}{Here I will mention about the idea of a UFM and UGM for a generic LTI system. This is also the right place to mention that we cannot identify all the system parameters using MRFT. This is why we need prior information. Also why we need to use two frequencies (non-uniqueness)}
%\paragraph{\textcolor{blue}{Figures}}
%{\begin{itemize}
%    \color{blue}
%    \item Powerpoint drawn figure representing a generic UFM and UGM (similar to the progress report presentation)
%    \item Actual UFM and UGM showing non-uniqueness
%\end{itemize}




%\subsection{Successive Application}
% \begin{figure}\label{fig_}
%      \centering
%      \begin{subfigure}[b]{0.45\textwidth}
%          \centering
%          \includegraphics[width=\textwidth]{images/unit_freq_construction.png}
%          \caption{Step 1: Obtaining a surface of equal frequency processes}
%          \label{fig: unit_frequency_construction}
%      \end{subfigure}
%      \hfill
%      \begin{subfigure}[b]{0.45\textwidth}
%          \centering
%          \includegraphics[width=\textwidth]{images/Figure1.png}
%          \caption{Step 2: Identification}
%          \label{fig:three sin x}
%      \end{subfigure}
%      \caption{A two step process for identification is proposed in this paper. The first step obtains a set of processes that produce equal frequency oscillations. The second step incorporates the test data obtained from the UAV to identify the process parameters uniquely. This is analogous to training and inference in machine learning applications}
% \end{figure}
\section{UAV Model}\label{sec_uav_case}
\subsection{Reference Frames and Conventions}
We define an inertial frame \(\mathcal{F}_I\) having basis \( \bm{[i_x, i_y, i_z]} \) with \(\bm{i_z}\) antiparallel to the gravity vector, and a body-fixed reference frame \(\mathcal{F}_B\) centered at the center of gravity of the UAV with rotation matrix \(  {}^I_B\bm{R} = \bm{[b_x, b_y, b_z]} \in \text{SO(3)} \), which gives the transformation from \(\mathcal{F}_B\) to \(\mathcal{F}_I\), where \( \bm{b_z} \) is parallel to the thrust vector. We also define the horizon frame $\mathcal{F}_H$ with its origin coincident with the origin of $\mathcal{F}_I$, its basis \(\bm{h_z}\) being coincident with \(\bm{i_z}\), and it is yaw aligned with $\mathcal{F}_B$. A vector can be expressed in a particular reference frame, e.g. \({}^I\bm{p}\) is the position vector expressed in the inertial frame. The components of a vector are referred to with the subscripts as in \({}^I\bm{p}=[{}^Ip_x {}^Ip_y {}^Ip_z]^T\). For compatibility of notation with vector quantities we use \(K_x\) to represent the element \(K_{11}\) in a diagonal matrix, and so on.

\begin{comment}
    For example, for a symmetric hexarotor UAV with equispaced arms of length \(l\) they are defined as:
\begin{equation}
\begin{aligned}
    G_F &= \begin{bmatrix}
    -l & l & l/2 & -l/2 & -l/2 & l/2 \\
    0 & 0 & -\frac{\sqrt{3}}{2}l & \frac{\sqrt{3}}{2}l & -\frac{\sqrt{3}}{2}l & \frac{\sqrt{3}}{2}l \\
    0 & 0 & 0 & 0 & 0 & 0 \\
    1 & 1 & 1 & 1 & 1 & 1
    \end{bmatrix} \\
    G_M &= \begin{bmatrix}
    0 & 0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & 0 \\
    1 & -1 & 1 & -1 & 1 & -1  \\
    0 & 0 & 0 & 0 & 0 & 0
    \end{bmatrix}
\end{aligned}
\end{equation}
\end{comment}

\subsection{Nonlinear Time Delay UAV Model}
\label{sec_time_delay_model}
We define the motor commands as follows:
\begin{equation}
    \begin{bmatrix}
    \bm{u_\eta} \\
    u_T
    \end{bmatrix} = \bar{G}\bm{u_i}
\end{equation}
where \(\bm{u_\eta}=[u_{b_x} u_{b_y} u_{b_z}]^T\) represents torque commands around \(\mathcal{F}_B\) bases, \(u_T\) is the thrust command, and \(\bm{u_i}\in[0,1]\) is the dimensionless individual motor command with \(i\in \{1,...,\mu_n\}\) where \(\mu_n\) represents the number of propellers used. \(\bar{G}\in\mathbb{R}^{4\times \mu_n}\) provides a static map independent of UAV dynamics, with \(\text{rank}(\bar{G})=4\) and its MoorePenrose inverse \(\bar{G}^{+}\) is defined and unique. The individual propulsion system thrust and moment dynamics are given by:
\begin{equation}
\label{eq_act_dynamics_time}
\begin{aligned}
    F_i(t) &= k_F u_i(t-\tau_p)-T_p \dot{F}_i(t) \\
    M_i(t) &= k_M u_i(t-\tau_p)-T_p \dot{M}_i(t)
\end{aligned}
\end{equation}
where \(k_F\), \(k_M\), \(\tau_p\), and \(T_p\) are the thrust gain, moment gain, propulsion system time delay, and propulsion system time constant respectively. Note that we assume that all propulsion units are matched, i.e. the parameters \(k_F\), \(k_M\), \(\tau_p\), and \(T_p\) are the same for all rotors. Also, it is assumed that the thrust and moments applied to the rigid body are defined by the relation:
\begin{equation}
    \begin{bmatrix}
    \bm{M} \\
    F
    \end{bmatrix} = G_F\bm{F_p}+G_M\bm{M_p}
\end{equation}
where \(\bm{F_p}=[F_1 F_2 ... F_{\mu_n}]^T\) and \(\bm{M_p}=[M_1 M_2 ... M_{\mu_n}]^T\). \(G_F\) and \(G_M\) are static maps which may contain UAV dynamic parameters. The UAV body dynamics are then given by:
\begin{equation}
\label{eq_uav_dynamics}
    \begin{aligned}
        {}^I\dot{\bm{p}}&={}^I\bm{v}\\
        {}^I\dot{\bm{v}}&=-g\bm{i_z}+\frac{F}{m}\bm{b_z}-{}_B^I{R}D{}_I^B{R}{}^I\bm{v}\\
        \dot{R}&={}_B^IR{}^B\bm{\omega}\\
        \bm{\dot{\omega}}&=J^{-1}(\bm{M}-\bm{\omega}\times J\bm{\omega}-\bm{M_g}-A{}_I^B{R}{}^I{\bm{v}}-B\bm{\omega})
    \end{aligned}
\end{equation}
where the diagonal matrices \(D\), \(J\), \(A\) and \(B\) represents profile drag and inflow motion drag due to translational motion, moment of inertia, drag due to blade flapping, and rotational drag due to body profile and inflow motion, respectively. The vector \(\bm{M_g}\) represents gyroscopic moments due to the interaction between rotating propellers and rotating UAV body.

\vspace{-2mm}
\subsection{Dynamics decoupling}
Analysis of decoupled dynamics can be achieved by projecting the 3D space into a 2D space. Specifically for decoupling, we assume that \(\mathcal{F}_I:=\mathcal{F}_H\) and, without loss of generality, project on the plane defined by \(\bm{i_y}\times \bm{i_z}\). The rotation around \(\bm{b_x}\) is indicated by the angle \(\theta\). We use near-hover linearization assumptions, i.e. we linearize about zero pitch and roll angles, and we use linear drag models. The rotational dynamics become:
\begin{equation}\label{eq_attitude_linearized}
    \begin{aligned}
        \dot{\theta}&=\omega_x\\
        \dot{\omega}_x&=\frac{1}{J_x}(M_x-A_x{}^Iv_y-B_x\omega_x)\\
        \dot{M}_x&=\frac{-M_x+k_{M,b_x}u_{b_x}(t-\tau_p)}{T_p}
    \end{aligned}
\end{equation}

We assume that the contribution of the term \(A_x{}^Iv_y\) is small since the lateral velocity during identification near-zero, and hence we neglect it. Then the angular dynamics take the structure of Eq. \eqref{eq_altitude_attitude_dynamics} with the model parameters given by:
\begin{equation}\label{eq_parameters_for_attitude}
    \begin{aligned}
        T_d&=\frac{J_x}{B_x}\\
        \tau&=\tau_p+\tau_{imu}
    \end{aligned}
\end{equation}
where $\tau_{imu}$ is the time delay that arises from the IMU measurement and the real-time processing.

The dynamics of altitude loop on the plane \(\bm{i_y}\times \bm{i_z}\) is given by:
\begin{equation}
    \begin{aligned}
    {}^I\dot{p}_z=&{}^Iv_z\\
    {}^I\dot{v}_z=&\cos\theta a_F - (d_y\sin\theta\cos\theta+d_z\sin\theta \cos\theta){}^Iv_y \\
    &- (d_y\sin^2\theta+d_z\cos^2\theta){}^Iv_z\\
    \dot{a}_F=&\frac{\mu_n\frac{k_F}{m}u_T(t-\tau_p)}{T_p}-\frac{a_F}{T_p}
    \end{aligned}
\end{equation}
where $a_F = F/m$.
Given the fact that we perform identification on altitude with \(\theta\approx0\) the altitude dynamics become:
\begin{equation}
    \begin{aligned}
    {}^I\dot{p}_z=&{}^Iv_z\\
    {}^I\dot{v}_z=& a_F -d_z{}^Iv_z\\
    \dot{a}_F=&\frac{\mu_n\frac{k_F}{m}u_T(t-\tau_p)}{T_p}-\frac{a_F}{T_p}
    \end{aligned}
\end{equation}
and thus, similar to the angular dynamics, the altitude dynamics take the form of Eq. \eqref{eq_altitude_attitude_dynamics} with the model parameters given by:
\begin{equation}\label{eq_parameters_for_altitude}
    \begin{aligned}
        T_d&=\frac{1}{D_z}\\
        \tau&=\tau_p+\tau_{pos}
    \end{aligned}
\end{equation}
Where $\tau_{pos}$ includes the time delay that comes from the position sensor as well as the onboard flight computer used.

\section{Results}\label{sec_results}
\subsection{Simulation results}\label{sim_results}
The proposed identification method is first validated in simulation since we have access to the ground truth process parameters. Consider the UAV attitude dynamics given by:
% \begin{equation}\label{simulated_example}
%     G(s) = \frac{1.4e^{-0.06 s}}{s(0.1s+1)(0.7s+1)}
% \end{equation}
\begin{equation}\label{simulated_example}
    \begin{bmatrix}
        \dot{\theta} \\
        \dot{\omega} \\
        \dot{M}  
    \end{bmatrix} = 
    \begin{bmatrix}
        0 & 1 & 0\\
        0 & -1.42& 1.42\\
        0 &0 & 10 
    \end{bmatrix}\begin{bmatrix}       
        \theta \\
        \omega \\
        M  
    \end{bmatrix} + \begin{bmatrix}       
        0 \\
        0 \\
        1.4 
    \end{bmatrix}u(t-0.06)
\end{equation}
To assess the sensitivity of the identification method, white Gaussian noise was added to the frequency and amplitude obtained from simulation to study the effect of noisy measurements on the identified UAV parameters. First, the system in Eq. \eqref{simulated_example} was excited by MRFT with $\beta=-0.7$, which resulted in oscillations with frequency and amplitude of $1.022$ Hz and $0.05$, respectively. With the addition of white noise with a standard deviation of 3\% of the resultant amplitude and frequency, the mean $T_d$ was found to be 0.39 s with a standard deviation of 0.089 s, a 44\% error from the true value. Similarly, the mean $\tau$ was found to be 0.12 s with a standard deviation of 0.0133 s, a 100\% error from the true value. This shows that the UGM exhibits an asymmetric nonlinear effect leading to high biases. Therefore, the amplitude of the oscillations can hardly be used for accurate identification.

This necessitates the use of the frequencies of two MRFT tests in identification to avoid the use of the amplitude of the oscillations. We excited the system in Eq. \eqref{simulated_example} with two MRFTs of $\beta = -0.4$ and $\beta = -0.7$ which produced oscillations with frequencies of $0.708$ Hz and $1.022$ Hz respectively. A similar sensitivity analysis was conducted for the identification based on the two frequencies where a white noise with standard deviation of 3\% was added to the two resultant frequencies, which resulted in the identification with mean $T_d = 0.6404$ s and standard deviation of $0.1956$ s, and for the time delay, we have mean $\tau = 0.0679$ s with standard deviation of $0.0168$ s. The error percentage in this case was 8.5\% and 6.73\% for $T_d$ and $\tau$ respectively, which is significantly lower than the case when the amplitude of the oscillations was considered in the identification. Therefore, we only depend on frequency measurements for experimental identification. The computations required for the identification using the two frequencies case was less than $0.1$ seconds on common modern processors, leading to real-time applicability.

% The frequency of oscillations obtained when exciting this process with MRFT of $\beta = -0.4$ and $\beta = -0.7$ is $0.708$ Hz and $1.022$ Hz respectively. Normalizing the UFMs of $\beta = -0.4$ and $\beta = -0.7$ with their corresponding test frequencies followed by finding the intersection of the two normalized curves gives the unknown system parameters (see Fig. 5 for an illustration on experimental results). The identification results in $T_d = 0.6976$ and $\tau = 0.0599$ which are close to the ground truth process. The identification computations require less than $0.1$ seconds on common modern processors, leading to real-time applicability







% \begin{figure}
%     \centering\includegraphics[width = \columnwidth]{images/Simulation_id.png}
%     \caption{In simulation, the process parameters are identified accurately}
%     \label{fig:simulated id}
% \end{figure}

\subsection{Experimental setup}
We validate the proposed identification methodology experimentally using two different UAV platforms. Furthermore, we have developed a test rig for the estimation of UAV propulsion system dynamics which will be used as prior knowledge for MRFT-based identification.

\subsubsection{UAV platform}
The UAV platform used for the experiments is a dji F550 hexarotor that uses a Navio2 flight controller with Raspberry Pi 3B+. Two UAV designs equipped with \textit{TDK-Lambda i7A} DC-DC voltage regulators on their electric power train are used for experimentation. The voltage regulators fix the static gain of the system; therefore, the battery voltage drop no longer affects propulsion system gain. In \emph{UAV Design I} dji E305 propulsion system is used, and in \emph{UAV Design II} dji E600 propulsion system is used. The position and yaw states of the UAVs are measured using OptiTrack motion capture system with sampling at 200Hz, and the roll and pitch measurements of the UAV are obtained from the onboard IMU with sampling at 200Hz. The communication between the ground station and the flight controller is done over a WiFi network, with ROS being used as a middleware. The UAV Design II used in the experiments is shown  Fig. \ref{fig:flight_env}.
\begin{figure}
    \centering
    \includegraphics[width = 0.7\columnwidth]{images/experimental_UAV.jpg}
    \caption{The experimental hexarotor UAV Design II.}
    \label{fig:flight_env}
\end{figure}

\subsubsection{Test rig for the estimation of propulsion system dynamics}\label{test_bench}
The altitude dynamics of the UAV system consist of two time constants and a time delay. The time constant corresponding to aerodynamic drag and the time delay are expensive to test offline. Therefore, the time constant of the propulsion system is identified offline on a test rig, and the other two parameters will be identified online based on the MRFT oscillations. 

To test propulsion dynamics, we prepared a fulcrum balance that is free to rotate around its center. We placed the propulsion system on one side of the balance and \textit{Kistler 9272} force sensor with a high sampling rate of 1KS/s on the other side of the balance. A step command is then used as an input to the propulsion system and the resultant force is then observed by the force sensor.

%It was observed experimentally that the static gain of the propulsion system changes over time as a function of the onboard battery voltage. To ensure that the propulsion system parameters remain constant, a DC-DC voltage converter is designed to regulate the voltage for the propulsion system.

For the two propulsion systems used in the experimentation, a least mean squares method was used to fit the parameters of the propulsion system to the measurement data. The parameters thus obtained for the two propulsion systems are tabulated in Table \ref{tab:act_params} and the step response of the identified propulsion dynamics model is compared with the measured propulsion force in Fig. \ref{fig:act_identified}.

\begin{figure}
    \centering
    \includegraphics[width = \columnwidth]{images/actuation_system_identification.png}
    \caption{The identified propulsion dynamics are compared to the step test of the actual propulsion system}
    \label{fig:act_identified}
\end{figure}
\begin{table}
    \centering
    \begin{tabular}{|c|c|c|}
    \hline
         Actuator system & $T_P$ & $\tau$ \\\hline
         Dji E305 (used in UAV Design I) & 0.0422 & 0.017 \\
         Dji E600 (used in UAV Design II) & 0.0499 & 0.0203\\\hline
    \end{tabular}
    \caption{The parameters identified for different propulsion systems}
    \label{tab:act_params}
    \vspace{-5mm}
\end{table}

%\textcolor{blue}{Here, I will mention the construction of the UAV system. The flight environment (Rpi, optitrack etc). The need for the DC-DC converter 
%beta sweep that was done experimentally to find out which beta value performs better considering sampling effects. 
%}
%\paragraph{\color{blue} Figures}
%\begin{itemize}
%    \color{blue}
%    \item pictorial representation of the whole system
%     \item drop in thrust as a function of battery voltage. 
%     \item beta sweep plots( maybe it is only sufficient to mention which values were found in words)
% \end{itemize}

\subsection{Real-time identification results}

The identification is performed on each control loop separately. Altitude is tested with MRFT of $\beta$ values of $-0.4$ and $-0.7$, and attitude is tested with beta parameters of $\beta =-0.5$ and $-0.8$. The MRFT parameters are chosen to be spread out as much as possible within the constraints of the amplitude and frequency permissible in the experimental setup. For the attitude dynamics, higher values of $\beta$ are used because lower values of $\beta$ produced oscillations with amplitudes that are dangerously high.

The frequencies of the two oscillations obtained for altitude dynamics are 0.63 Hz and 1.1 Hz for $\beta=-0.4$ and $\beta=-0.7$, respectively. The known $T_p$ is scaled down to the UFM to obtain the set of possible UAV parameters $\left[T_p, T_d,\tau \right]$ on the UFM. The intersection of the two scaled manifolds gives the identified process parameters as illustrated in Fig. \ref{fig_pitch_alt_ident}. Identification results for both altitude and attitude dynamics are shown in Table \ref{tab:main_results}.
%For the pitch dynamics, the identified parameters are shown in Fig. \ref{fig:pitch_identification}.

% \begin{figure}
%     \centering
%     \includegraphics[width = \columnwidth]{images/Altitude_identification_big_hexa_small_motors.png}
%     \caption{The parameters identified for the altitude dynamics of the system are given by the point of intersection of the two manifolds.}
%     \label{fig:alt_identified}
% \end{figure}

% Similarly, the parameters of the attitude dynamics of the UAV is identified. The parameters identified is tabulated in Table \ref{tab:Identified parameters 1}

\begin{figure}
     \centering
     \vspace{-10mm}
     \begin{subfigure}[b]{0.43\textwidth}
         \centering
         \includegraphics[width=\textwidth]{images/pitch_identification_big_hexa_small_motors.png}
         \caption{Identification of the pitch parameters based on the intersection of the two manifolds}
         \label{fig:pitch_identification}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.43\textwidth}
         \centering
            \includegraphics[width = \textwidth]{images/Altitude_identification_big_hexa_small_motors_20ms.png}
            \vspace{-8mm}
        \caption{The parameters identified for the altitude dynamics of the system with additional 20 ms added are given by the point of intersection of the two manifolds.}
        \label{fig:alt_identified}
     \end{subfigure}
     \caption{The parameters for the altitude dynamics as well as the attitude dynamics is obtained from the intersection point of the two manifolds}
     \label{fig_pitch_alt_ident}
\end{figure}

\begin{table}
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|c|}
    \hline  
         & & mean $T_d$ &  std $T_d$ & mean $\tau$ & std $\tau$\\\hline
        \multirow{4}{*}{UAV Design I} & Altitude & 2.669 & 0.6612 & 0.0464 & 0.0012\\\cline{2-6} 
        &Added 20 ms & 3.5077 & 1.203 & 0.0660   & 0.0041\\\cline{2-6}
          & Roll & 1.301 & 0.8395 & 0.0297 & 0.0042 \\ \cline{2-6}
          & Pitch & 1.6026 & 1.3094 & 0.0289 & 0.0066\\\hline 
         
        \multirow{4}{*}{UAV Design II} & Altitude & 1.8345 & 0.1754 & 0.0498  & 0.0017 \\\cline{2-6} 
         &Added 20 ms & 4.1755 &  0.5544&0.0636 & 0.0017 \\\cline{2-6}
          & Roll & 0.887 & 0.4574 & 0.0228 & 0.0053 \\ \cline{2-6}
          & Pitch & 0.6312 & 0.2874 & 0.0308 & 0.0071\\\hline 
    \end{tabular}
    \caption{Mean and standard deviation of the parameters identified. We get multiple steady state oscillations and hence we got multiple parameters measurements. The 20 ms delay is added in the altitude loop.}
    \label{tab:main_results}
    \vspace{-5mm}
\end{table}

The accuracy of the identified parameters in the identification experiments cannot be assessed because we cannot access the ground truth parameter values. We propose to
% (1) the identification method is compared with other identification methods that exist in the literature \textcolor{blue}{DNN-MRFT}. (2) 
introduce some increment to the time delay in the flight controller software, which is known and, therefore can be compared against the estimated value. We chose to add a time delay of 20 ms to the altitude feedback loop. The manifolds' intersection is shown in Fig. \ref{fig:alt_identified} for the case of 20 ms additional time delay. Also Table \ref{tab:main_results} shows the identification results with the added delay. The experiemental video and results are given in \cite{paper_video}.
% \begin{figure}
%      \centering
%      \begin{subfigure}[b]{0.45\textwidth}
%          \centering
%          \includegraphics[width=\textwidth]{images/pitch_identification_big_hexa_small_motors_20ms.png}
%          \caption{Identification of parameters for the pitch dynamics with additional 20ms added.}
%          \label{fig:pitch_identification}
%      \end{subfigure}
%      \hfill
%      \begin{subfigure}[b]{0.45\textwidth}
%          \centering
%          \includegraphics[width=\textwidth]{images/roll_identification_big_hexa_small_motors_20ms.png}
%          \caption{Identification of parameters for the roll dynamics with additional 20ms added.}
%          \label{fig:roll_identification}
%      \end{subfigure}
%      \hfill
% \end{figure}

% \subsection{cross-validation with different platform}
%The identification method is conducted on UAV Design I and II. The results from identification for both the UAVs are given in Table \ref{tab:main_results}.
\vspace{-2mm}
\subsection{Comparison with the literature}
The identified parameters are compared to the parameters obtained by another state-of-the-art identification method which is the deep neural network with the modified relay feedback test (DNN-MRFT) method \cite{Ayyad2020RealTimeSI}. The parameters obtained by DNN-MRFT are close to the parameters obtained from our proposed identification methods for the altitude dynamics. However, DNN-MRFT failed to pick up the additional 20 ms introduced to the altitude dynamics. This might be attributed to the fact that DNN-MRFT performs identification by selecting from a discrete set of values, i.e. the  DNN used within this method is a classifier.

%, DNN-MRFT obtains the same set of parameters as the nominal case, whereas the proposed identification method picked up the additional 20 ms.


%Although the parameters obtained from DNN-MRFT are not the ground truth parameter values, the behaviour of the identification can be compared between the two methods. The oscillations obtained for the altitude dynamics of the UAV are compared against the parameters obtained from DNN-MRFT. 
\begin{table}
    \centering
    \begin{tabular}{|c|c|c|c|c|}
    \hline
     & \multicolumn{2}{|c|}{Nominal dynamics} &\multicolumn{2}{|c|}{Additional 20 ms dynamics} \\\hline   
         &  Ours & DNN-MRFT & Ours & DNN-MRFT\\\hline
        $T_p$ & 0.0422 & 0.0321 &  
        0.0422 & 0.0321\\\hline
        $T_d$ & 2.669 & 1.6877 & 3.5077 & 1.6877\\\hline
        $\tau$ & 0.0464 & 0.06 & 0.066 & 0.06\\\hline
    \end{tabular}
    \caption{Comparison between the proposed identification method and DNN-MRFT. The identification was performed on the altitude loop of UAV Design I.}
    \label{tab:my_label}
    \vspace{-3mm}
\end{table}

\section{Conclusion}\label{sec_conclusion}
This paper presented a real-time system identification method utilizing the homogeneity properties of the MRFT and the  LPRS. The identification method presented can identify the drag coefficient and time delay of a UAV. The identification method is shown to be fast and stable and, therefore, applicable in real-time applications. 
The two MRFTs required for identification are performed within seconds and the parameters can be found within a fraction of a second, which facilitates the real-time applicability of the method.
The accuracy of the identification is demonstrated by showing the identification of the known incremental delay of the system. It was also shown that this method more accurately identifies the known incremental delays than another benchmark real-time identification method, which also provides very accurate controller tuning. 

So far, the altitude and the attitude dynamics of the UAV are considered for identification, but a similar identification could be employed in the future to identify the parameters of the underactuated lateral dynamics of the UAV as well. 

%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
%% \appendix

%% \section{}
%% \label{}

%% References
%%
%% Following citation commands can be used in the body text:
%% Usage of \cite is as follows:
%%   \cite{key}         ==>>  [#]
%%   \cite[chap. 2]{key} ==>> [#, chap. 2]
%%

%% References with BibTeX database:
\bibliographystyle{ieeetr}
\bibliography{bare_jrnl}
\vspace{-10mm}

\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{images/perin.jpg}}]{Anees Peringal} received his BSc. degree in Aerospace engineering from Khalifa University, Abu Dhabi. He is currently pursuing an MSc. degree in Aerospace engineering at Khalifa University. He is interested in research related to control of dynamic systems and autonomous robotics. 

\end{IEEEbiography}
\vspace{-10mm}

\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{images/Mohamad_Chehadeh.jpg}}]{Mohamad Chehadeh} received his MSc. in Electrical Engineering from Khalifa University, Abu Dhabi, UAE, in 2017. He is currently with Khalifa University Center for Autonomous Robotic Systems (KUCARS). His research interest is mainly focused on identification, perception, and control of complex dynamical systems utilizing the recent advancements in the field of AI.
\end{IEEEbiography}
\vspace{-8mm}
\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{images/Igor_Boiko.jpeg}}]{Igor Boiko} received his MSc, PhD and DSc degrees from Tula State University and Higher Attestation Commission, Russia. His research interests include frequency-domain methods of analysis and design of nonlinear systems, discontinuous and sliding mode control systems, PID control, process control theory and applications. Currently, he is a Professor with Khalifa University, Abu Dhabi, UAE.
\end{IEEEbiography}

\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{images/Yahya_Zweiri.jpg}}]{Yahya Zweiri} (Member, IEEE) received the Ph.D. degree from the Kings College London in 2003. He is currently an Associate Professor with the Department of Aerospace Engineering and director of the Advanced Research and Innovation Center - Khalifa University, United Arab Emirates. He was involved in defense and security research projects in the last 20 years at the Defense Science and Technology Laboratory, Kings College London, and the King Abdullah II Design and Development Bureau, Jordan. He has published over 130 refereed journals and conference papers and filed ten patents in USA and UK. His main research is in the area of robotic systems for extreme conditions with particular emphasis on applied AI aspects and neuromorphic vision systems.
\end{IEEEbiography}

\end{document}



\section{Using IRCM for Warm-Starting}
\label{section c2svm3+}

As stated in Theorem \ref{algo2up}, the solution found by
Algorithm~\ref{Second version} is feasible for
Problem~\eqref{equation2}.
Hence, we can use it for warm-starting the solution process of
Problem~\eqref{equation2}.
The next lemma establishes that unlabeled points can be fixed to be in
one side of the hyperplane.
\begin{lem}
  \label{lemma1}
  Let $(\bar{\omega}, \bar{b}, \bar{\xi}, \bar{\eta}, \bar{z})$ be a
  feasible point of Problem~\eqref{equation2} with objective function
  value~$\bar{f}$.
  Furthermore, let $(\omega^*,b^*, \xi^ *, \eta^*, z^*)$ be an optimal
  solution of Problem~\eqref{equation2} with objective function
  value~$f^*$.
  Set
  \begin{align*}
    P_u & \define \Defset{i \in [n+1,N]}{(\omega^*)^{\top}  x^i + b^* >0 },
    \\
    N_u & \define \Defset{i \in [n+1,N]}{(\omega^*)^{\top}  x^i + b^* < 0},
  \end{align*}
  and let $S_p \subseteq P_u$, $S_n \subseteq N_u$ be arbitrarily chosen
  subsets and let $x^s \notin S_n$ be an unlabeled point with
  $\bar{\omega}^{\top} x^s + \bar{b} <0$.
  Then, the objective function value $\tilde{f}$ given by any feasible
  point of the problem
  \begin{varsubequations}{P5}
    \label{equation5}
    \begin{align}
      \min_{\omega,b,\xi,\eta, z} \quad
      & \frac{\Vert\omega \Vert ^ 2  }{2} + C_1
        \sum_{i=1}^n \xi_i +C_2 (\eta_1 + \eta_2)
        \label{svmfunction4} \\
      \text{s.t} \quad
      & y_i (\omega^{\top} x^i +b)  \geq 1 - \xi_i, \quad   i \in
        [1,n],
        \label{constraintx1} \\
      & \omega^{\top}  x^i +b \leq z_iM, \quad  i\in [n+1,N]
        \setminus (\{s\} \cup S_p \cup S_n),
        \label{constraintc11} \\
      & \omega^{\top}  x^i +b \geq -(1-z_i)M, \quad i\in
        [n+1,N] \setminus (\{s\} \cup S_p \cup S_n),
        \label{constraintc21} \\
      & \omega^{\top}  x^i +b \geq 0, \quad i\in S_p,
        \label{constraintc2a1}\\
      & \omega^{\top}  x^i +b \leq 0, \quad i\in S_n,
        \label{constraintc2b1}\\
      &  0 \leq   \omega^{\top}  x^s +b \leq z_sM,
        \label{constraintc2d1}\\
      &   \tau - \eta_1  \leq \vert S_p\vert +
        \sum_{i\in[n+1,N]\setminus( S_p \cup S_n)   } z_i
        \leq \tau + \eta_2,
        \label{constraints11} \\
      & \xi_i   \geq 0, \quad  i \in [1, n],
        \label{constraintxi1} \\
      & \eta_1, \eta_2 \geq 0,
        \label{constrainteta1} \\
      & z_i \in \{0,1\}, \quad i\in[n+1,N]\setminus( S_p \cup S_n),
        \label{constraintz1}
    \end{align}
  \end{varsubequations}
  with $M$ as defined in \eqref{BigM 2}, satisfies the following properties:
  \begin{enumerate}
  \item[(a)] $\tilde{f}$ is an upper bound for $f^*$,
  \item[(b)] if $\tilde{f}$ is the optimal objective function value of
    Problem~\eqref{equation5} and $\bar{f} < \tilde{f}$ is satisfied, it
    holds $(\omega^*)^{\top} x^s + b^* <0$, i.e., $x^s \in N_u.$
  \end{enumerate}
\end{lem}
\begin{proof}
  \begin{enumerate}
  \item[(a)] The points that satisfy Constraints
    \eqref{constraintx1}--\eqref{constraintz1} are feasible for
    Problem~\eqref{equation2} and provide an objective function value
    $\tilde{f}$.
    Since $f^*$ is the optimal objective function value of
    Problem~\eqref{equation2}, $f^* \leq \tilde{f}$ holds.
  \item[(b)] Consider by contradiction that $(\omega^*)^{\top} x^s +
    b^* \geq 0$ holds.
    This means that $(\omega^*,b^*, \xi^ *, \eta^*, z^*)$ satisfies
    \eqref{constraintx1}--\eqref{constraintz1}.
    Moreover, since $\tilde{f}$ is the objective function for
    Problem~\eqref{equation5}, we get $f^* = \tilde{f}$.
    However, $f^* \leq \bar{f}$ holds.
    Thus,
    \begin{equation*}
      f^* \leq \bar{f} < \tilde{f } = f^*
    \end{equation*}
    yields a contradiction.
    \qedhere
  \end{enumerate}
\end{proof}

Note that the last lemma can be adapted for the case
$\bar{\omega}^{\top} x^s + \bar{b}> 0$.
In this case, the constraints~\eqref{constraintc2d1} need to be
replaced with
\begin{equation}
  \label{subs1}
  -(1-z_s)M \leq  \omega^{\top}  x^s +b \leq 0
\end{equation}
and (b) needs to be replaced with $(\omega^*)^{\top} x^s +
b^* >0$, i.e., $x^s \in P_u$.
Note that the more points we have fixed on one side, the solution
of Problem~\eqref{equation2} tends to be faster as there are fewer binary
variables.

Moreover, the solution of Problem~\eqref{equation2}  can be found by
solving the problem
\begin{varsubequations}{P6}
  \label{equation7}
  \begin{align}
    \min_{\omega,b,\xi,\eta, z} \quad
    & \frac{\Vert\omega \Vert ^ 2  }{2} + C_1  \sum_{i=1}^n
      \xi_i +C_2 (\eta_1 + \eta_2)
      \label{svmfunction5} \\
    \st \quad
    & y_i (\omega^{\top} x^i -b)  \geq 1 - \xi_i, \quad  i \in
      [1,n],
      \label{constraintx1a} \\
    & \omega^{\top}  x^i +b \leq z_iM, \quad  i\in [n+1,N]
      \setminus ( S_p \cup S_n),
      \label{constraintc11a}\\
    & \omega^{\top}  x^i +b \geq -(1-z_i)M, \quad  i\in [n+1,N]
      \setminus ( S_p \cup S_n),
      \label{constraintc21a} \\
    & \omega^{\top}  x^i +b \geq 0, \quad  i\in S_p,
      \label{constraintc2a1a}\\
    & \omega^{\top}  x^i +b \leq 0,  \quad  i\in S_n,
      \label{constraintc2b1a}\\
    & \tau - \eta_1  \leq \vert S_p\vert + \sum_{i\in[n+1,N]\setminus(
      S_p \cup S_n) } z_i \leq \tau + \eta_2,
      \label{constraints11a} \\
    & \xi_i   \geq 0, \quad i \in [1, n],
      \label{constraintxi1a} \\
    & \eta_1, \eta_2 \geq 0
      \label{constrainteta1a} \\
    & z_i \in \{0,1\}, \quad  i\in [n+1,N]
      \setminus ( S_p \cup S_n),
      \label{constraintz1a}
  \end{align}
\end{varsubequations}
where $S_p$ and $S_n$ are subsets of $P_u$ and $N_u$,
respectively.

Based on these results, we propose the following.
We compute the point $(\bar{\omega},\bar{b}, \bar{\xi},\bar{\eta},
\bar{z})$ using Algorithm~\ref{Second version}, leading to an
objective function value~$\bar{f}$ for Problem~\eqref{equation2}.
Afterward, we sort the indices $i \in \set{n+1, N}$, indicated by the
permutation~$\alpha : \set{n+1, N} \to \set{n+1, N}$, so that $\vert
\bar{\omega}^{\top}x^{\alpha(i)} + \bar{b} \vert \geq \vert
\bar{\omega}^{\top}x^{\alpha(i)+1} + \bar{b} \vert$ holds.

Consider now a given and fixed parameter~$B_{\max}$, a factor~$\gamma
\in (1, m / B_{\max}]$, and let~$\beta$ be $\gamma B_{\max}$
rounded to the next integer.
While the number of fixed points is smaller than~$B_{\max}$, we do the
following.
For $i \in \set{1,\dotsc, \beta}$, if
$\bar{\omega}^{\top}x^{\alpha(i)} + \bar{b} < 0$ holds, we try to solve
Problem~\eqref{equation5} using the limit time of~$T_{\max}$ and the
upper bound~$\bar{f}$.
If there is a feasible point of this problem,
we set $(\bar{\omega},\bar{b}, \bar{\xi},\bar{\eta}, \bar{z})$ to this
point and update the objective function value $\bar{f}$ accordingly.
If no feasible point could be computed and if the limit time was not
reached, we fix $x^s$ to be in the negative side.

Similarly, we do the same if $\bar{\omega}^{\top}x^{d_\ell} +
\bar{b} > 0$ holds with \eqref{constraintc2d1} replaced
by~\eqref{subs1}.
The method is formally described in Algorithm~\ref{Scheme version}.

\begin{algorithm}
  \caption{Improved \& Warm-Started Re-Clustering Method (WIRCM)}
  \label{Scheme version}
  \SetAlgoLined
  \SetKwInOut{Input}{Input}\SetKwInOut{Output}{Output}
  \SetAlgoLined
  \SetKwInput{Input}{Input}\SetKwInOut{Output}{Output}
  \Input{$X~\in~\mathbb{R}^{d\times N}$ , $y \in \set{-1,1}^n$, $k^1
    \in \mathbb{N}$, $C_1 > 0$, $C_2 > 0$, $\tau \in \mathbb{N}$,
    $\hat{\Delta}^1 \in (0,1)$, $\tilde{\Delta} \in (0,1)$,
    $\mathcal{G}^1 = \emptyset$, $k^+ \in \mathbb{N}$, $T_{\max} > 0$,
    $B_{\max} \in \mathbb{N}$, and $\gamma \in (1, m / B_{\max}]$.}
  Compute the hyperplane $(\bar{\omega}, \bar{b})$ and $\bar{\xi},
  \bar{\eta}, \bar{z}$ using Algorithm~\ref{Second
    version}, leading to the objective function value~$\bar{f}$.
  Let $M$ be the last $M^t$ of Algorithm~\ref{Second version}.
  \label{Scheme version:call-other-alg}\\
  Sort the indices $i \in \{n+1,N\}$ such that
  $\vert \bar{\omega}^{\top}x^{\alpha(i)} + \bar{b} \vert  \geq \vert
  \bar{\omega}^{\top}x^{\alpha(i) + 1} + \bar{b} \vert$ holds
  and set $\beta$ to be $\gamma B_{\max}$ rounded to the next integer.
  \\
  \For{$i \in \set{1, \dotsc, \beta}$}{
    \If{$\vert S_p \vert + \vert S_n \vert \leq  B_{\max}$ }{
      \uIf{$\bar{\omega}^{\top} x^s + \bar{b} <0$}{
        Solve Problem~\eqref{equation5} with upper bound~$\bar{f}$ and
        a time limit $T_{\max}$.
        \\
        \uIf{there is a feasible point}{
          update $(\bar{\omega}, \bar{b}, \bar{\xi},
          \bar{\eta}, \bar{z})$, and $\bar{f}$
        }
        \ElseIf{$T_{\max}$ was not reached}{
          $S_n \leftarrow S_n \cup \{s\}$}
      }
      \ElseIf{$\bar{\omega}^{\top} x^s + \bar{b} >0$}{
        Solve the problem~\eqref{equation5} with
        \eqref{constraintc2d1} replaced by~\eqref{subs1}, using
        $\bar{f}$ as an upper bound and a time limit of $T_{\max}$.
        \\
        \uIf{there is a feasible point}{
          update $(\bar{\omega}, \bar{b}, \bar{\xi},
          \bar{\eta}, \bar{z})$, and $\bar{f}$
        }
        \ElseIf{$T_{\max}$ was not reached}{
          $S_p \leftarrow S_p \cup \{s\}$}
      }
    }
  }
  Compute the solution $(\omega^*, b^*, \xi^*, \eta^*, z^*)$ of
  Problem~\eqref{equation7} with $(\bar{\omega}, \bar{b}, \bar{\xi},
  \bar{\eta}, \bar{z})$ value and $\bar{f}$ as an upper bound.
\end{algorithm}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "constrained-svm-preprint"
%%% End:

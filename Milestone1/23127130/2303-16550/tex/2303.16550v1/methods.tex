\section*{Methods}

\subsection*{Navier--Stokes equations and their lattice Boltzmann form}

The Navier--Stokes equations (NSE) governing fluid dynamics read
\begin{equation}
  \frac{\partial \bm{u}}{\partial t} + \bm{u}\cdot(\bm{\nabla u})  =
  -\frac{{\bm{\nabla}} p}{\rho}
  + \nu \nabla^2 \bm{u} + \bm{F} ,
\label{turb}
\end{equation}
\begin{equation}
  \label{eq:continuity}
  \frac{\partial\rho}{\partial t} + {\bm{\nabla}}\cdot(\rho\bm{u}) = 0 ,
\end{equation}
where $\bm{u}$ is the flow velocity,  
$p$ is the pressure, $\rho$ is the fluid
density, $\nu$ is the kinematic viscosity, and $\bm{F}$ is the forcing term. 
The nonlinearity of \Eq{turb} is exhibited in  $\bm{u}\cdot(\bm{\nabla u})$.
This term and the viscosity term $\nu \nabla^2\bm{ u}$ together determine the multiscale property of a turbulent flow characterized by the Reynolds number $\text{Re} =
\bm{u}\cdot(\bm{\nabla u})/(\nu \nabla^2\bm{u})$.
Flow systems in nature are often characterized by high
$\text{Re}$ (e.g., $\text{Re}\approx 10^7$ for atmospheric flows and
$\text{Re}\approx 10^{21}$ for astrophysical flows), which are intractable
to simulate using classical computers, as the best-case computational cost
scales as $\text{Re}^3$ according to the Kolmogorov
theory\citep{pope2000turbulent}. The compressibility of the flow is
characterized by the Mach number $\text{Ma}=\vert \bm{u} \vert/c_s$ with $c_s$
being the speed of sound.

\ifarXiv
We
\else
As discussed in the main text, we
\fi
solve the lattice Boltzmann
  form of the NSE to reduce the nonlinearity from
  Re-determined $\bm{u}\cdot(\bm{\nabla u})$ to Ma-determined
  $u^2=\vec{u}\cdot\vec{u}$. The discrete-velocity Boltzmann form of \Eq{turb} with Bhatnagar--Gross--Krook (BGK)
collision \cite{Bhatnagar1954ASystems} leads to:
\begin{equation}
\label{eq:lbm_origin}
\frac{\partial\tilde{f}_m}{\partial\tilde t} +\tilde{\vec{e}}_m \cdot
\tilde{\bm{\nabla}} \tilde{f}_m = -\frac{1}{\tilde\tau}
\left(\tilde{f}_m-\tilde{f}_m^{\rm eq}\right),\quad m \in 1, \dots, Q,
\end{equation}
where $\tilde{f}_m(\tilde{\bm{x}}, \tilde{t})$ is the particle velocity distribution function
describing the probability density of finding a particle around position
$\tilde{\bm{x}}$ at time $\tilde{t}$ with unit discrete velocity
$\tilde{\bm{e}}_m$, and $Q$ is the number of discrete velocities
\citep{Chen1998LatticeFlows}.  If a spatial discretization uses $n$
grid points, the dimensionality of $f$ is $n\times Q$; as we will
discuss below, $Q$ is a fixed, small number ($Q\leq 27$ in widespread
practice), whereas simulations with large domains or fine resolutions
are often desirable, resulting in $n\gg 1$. In our complexity analysis, we
therefore treat $Q$ as a constant and $n$ as a parameter of the
problem whose effects in the large-$n$ limit are of particular
practical interest.
In one, two, and three dimensions, the square or cubic lattices D1Q3,
D2Q9, and D3Q27 are in widespread use \cite{Chen1998LatticeFlows}.
$\tilde{f}^{\rm{eq}}_{m}$ is the local Maxwell equilibrium
that $\tilde{f}_m(\bm{x}, t)$ relaxes to at a relaxation time of $\tilde{\tau}$. 
$\tilde{\bm{\nabla}}$ represents the spatial gradient
in the $\tilde{x}$, $\tilde{y}$, and $\tilde{z}$ directions. By using a reference
density $\rho_r$ and speed $e_r$, characteristic macroscopic length scale $L$,
and particle collision $t_c$, one obtains the nondimensional form of
\Eq{eq:lbm_origin}, termed the lattice Boltzmann equation (LBE):
\begin{equation}
\partial_t f_m+\bm{e}_m \cdot \bm{\nabla} f_m = -\frac{1}{\tau\, \kn} (f_m-f_m^{\rm eq}), \quad m = 1, \dots, Q,
\label{eq:LBMs}
\end{equation}
where
\begin{align}
  f_m &= \tilde{f}_m/\rho_r, \\
  \feq_m &= \tilde{f}^{\rm{eq}}_m/\rho_r,  \\
  \label{eq:scale-t}
  t &= \tilde{t}/(L/e_r), \\
  \vec{e} &= \tilde{\vec{e}}/e_r, \\
  \label{eq:scale-x}
  \nabla &= L\tilde\nabla, \text{ and} \\
  \tau &= \tilde\tau/t_c. 
\end{align}
(To minimize clutter in the following, variables without tilde are
nondimensional, and variables with tilde are their dimensional physical counterparts.)
The Knudsen number describing the ratio of collision time to flow time is defined as 
\begin{equation}
  \label{eq:epsilon}
  \kn=e_r \frac{t_c}L 
\end{equation}
 and forms the basis for the Chapman--Enskog expansion
\cite{Chen1998LatticeFlows} of the LBE, which recovers the
NSE in the limit $\kn\ll 1$.
The macroscopic fluid density $\rho(\bm{x}, t)$ is retrieved as
\begin{equation}
\rho(\bm{x}, t)=\sum_m f_m(\bm{x},t)
\label{eq:rho}
\end{equation}
and the macroscopic fluid velocity as 
\begin{equation}
\bm{u}(\bm{x}, t)=\frac 1 \rho \sum_m f_m(\bm{x},t)\bm{e}_m.
\label{eq:u}
\end{equation}
To recover the NSE from \Eq{eq:LBMs}, the equilibrium
distribution function $f_m(\bm{x}, t)$ is chosen as the Taylor
expansion of the Maxwell distribution function:
\begin{equation}
\feq_m = \rho w_m[a+b{\bm e}_m\cdot {\bm u}+c({\bm e_m}\cdot{\bm u})^2+d\vert{\bm u}\vert^2];
\label{eq:feq}
\end{equation}
quadratic degree enables the LBE to reproduce the quadratic NSE to $O(\ma^2)$, and the
constants $a=1$, $b=3$, $c=9/2$, and $d=-3/2$ are the Taylor coefficients \cite{Chen1998LatticeFlows}.

Constants $a$ through $d$ are all $O(1)$ quantities as, in the lattice Boltzmann method (LBM), they are
proportional to the powers of the speed of sound, which is $O(1)$ due to
the velocity rescaling. The lattice constants $w_1,\dots, w_Q$ provide
the Maxwell weighting of the different discrete velocities $\vec
e_1,\dots,\vec e_Q$ (which are not necessarily unit vectors) and satisfy
\begin{equation}
\sum_m w_m = 1.
\end{equation}
The lattice constants depend on the dimension $D
\in \{1,2,3\}$ of the simulation and the number $Q$ of discrete velocities used. 
As the speed of sound is $O(1)$, the macroscopic
velocity $\vert \vec u \vert = O(\text{Ma})$, i.e., $\vert \vec u \vert \ll 1$ in weakly
compressible applications. We remark that the LBM is suitable for high Reynolds number flow since the condition of $\text{Kn}=O\text{(Ma/Re)}$ can be well met \citep{Toschi05} with $\text{Re}\gg 1$. This feature of LBM is crucial for the complexity analysis discussed below. 

\subsection*{Carleman linearization of the lattice Boltzmann equation}

The LBE (\Eq{eq:LBMs}) contains terms that are nonlinear in $f$
due to the presence of the $\rho u^2$ terms in $\feq_m$ (i.e., \Eq{eq:feq}).  These nonlinear terms
involve the ratio of quadratic combinations of $f_m$ in the numerator and linear
combinations of $f_m$ in the denominator.  Because the deviation of the
denominator (macroscopic density $\rho$) from 1 is small ($\rho \approx 1$) in weakly
compressible flow, we can approximate $1/\rho$ to first-order Taylor expansion as
\begin{equation}
  \label{eq:rhotaylor}
  \frac 1 \rho \approx 2 - \rho, \quad \lvert 1 - \rho \rvert \ll 1
\end{equation}
with $O(\ma^4)$ error; this is acceptable, since the LBE recovers NSE
to $O(\ma^2)$.  Substituting the expansion of $1/\rho$ yields
polynomial combinations of $f_m$ up to cubic degree in 
$\feq_m$.  Cubic degree is therefore the minimum usable Carleman
degree that can recover NSE when $\text{Ma}\ll1$.

We collect the terms of different polynomial degree in \Eq{eq:LBMs} after the expansion of  \Eq{eq:feq}, with linear terms on the first, quadratic on
the second, and cubic terms on the third lines:
\begin{align}
  \ddt{f_m} = &-\vec{e}_m\cdot\nabla f_m - \frac{1}{\kn\tau}f_m +
  \frac 1{\kn\tau} w_m \left[a\sum_{n=1}^Q f_n + b \vec{e}_m \cdot \sum_{n=1}^Q \vec{e}_nf_n
  \right] \nonumber \\
  & + \frac 2 {\kn\tau} w_m \left[c\left(\vec{e}_m\cdot\sum_{n=1}^Q \vec{e}_n f_n\right)^2 +
    d\left(\sum_{n=1}^Q \vec{e}_n f_n\right)^2\right] \nonumber \\
  \label{eq:lbm-grouped}
  & - \frac 1 {\kn\tau} w_m \left[\sum_{n=1}^Qf_n\right]\left[c\left(\vec{e}_m\cdot\sum_{n=1}^Q \vec{e}_n f_n\right)^2 +
    d\left(\sum_{n=1}^Q \vec{e}_n f_n\right)^2\right]
\end{align}
In the following, we adopt the \citet{Forets2017} notation and separate the
linear, quadratic, and cubic terms into products of constant coefficient matrices
$F_1$, $F_2$, and $F_3$ and 1-, 2-, and 3-forms.  Note that we will treat the streaming
operator
\begin{equation}
  Sf=\vec{e}_m\cdot\nabla f_m
\end{equation}
separately for reasons that will become apparent in the discussion of $n$-point
grids.  We write
\Eq{eq:lbm-grouped} as 
\begin{equation}
  \label{eq:lbm-carleman}
  \ddt{f} = -Sf + F^{(1)}f + F^{(2)} f^{[2]} + F^{(3)} f^{[3]},
\end{equation}
where
\begin{equation}
f = (f_1, \dots, f_Q)^\trans;\label{eq:def-f}
\end{equation}
the superscript $^{[k]}$ denotes Kronecker
exponentiation:
\begin{equation}
  f^{[k]} = \underset{k \text{ times}}{\underbrace{f\otimes \cdots \otimes f}}
\end{equation}
$f^{[k]}$ is the $Q^k$-length vector of polynomial permutations
of $f_m$ of degree $k$, including terms that are degenerate because of
commutativity under multiplication. The Kronecker product operator $\otimes$
acts on vectors
\begin{equation}
  x\otimes y = (x_1 y_1, x_1 y_2,\ldots, x_1 y_m, x_2 y_1,\ldots,x_2 y_m, \ldots, x_n y_1,\ldots, x_n y_m)^\trans
\end{equation}
and matrices
\begin{equation}
  A \otimes B = \begin{pmatrix}
    a_{11}B &\ldots&a_{1n}B \\
    \vdots & & \vdots \\
    a_{m1}B & \ldots &a_{mn}B 
  \end{pmatrix}
\end{equation}
by forming all product permutations of their elements.  $F^{(k)}$ is a
$Q\times Q^k$ matrix of constant coefficients of the polynomial combinations of
$f_m$.  The procedure of Carleman linearization
\citep{Carleman1932} recasts this system of $Q$ polynomial differential
equations as an infinite system of coupled linear differential equations by
treating $f^{[k]}$ as new degrees of freedom whose time derivatives are
determined from \Eq{eq:lbm-carleman} by the Leibniz product rule.  Denoting
\begin{equation}
  V^{(k)} = (f, f^{[2]}, \dots, f^{[k]})^\trans,
\end{equation}
the infinite-dimensional Carleman form of \Eq{eq:lbm-carleman} reads
\begin{equation}
  \ddt{V^{(\infty)}} = C^{(\infty)} V^{(\infty)},
  \label{eq:cv}
\end{equation}
with 
\begin{equation}
C^{(\infty)} = \begin{pmatrix}
A_1^1 & A_2^1 & A_3^1 & 0 & 0 & 0 & \ldots \\ 
0 & A_2^2 & A_3^2 & A_4^2 & 0 & 0 & \ldots \\
0 & 0 & A_3^3 & A_4^3 & A_5^3 & 0 & \ldots \\   
\vdots &  \vdots &  \vdots &  \vdots  & \vdots &\vdots & \ddots &\\
\end{pmatrix} \label{eq:Cinfdef}
\end{equation}
and 
\begin{align}
A^i_{i+j-1} = \sum_{r=1}^i \overset{i \text{ factors}}{\overbrace{\IdQ \otimes \cdots \otimes \underset{\underset{r\text{th position}}{\uparrow}}{F^{(j)}} \otimes  \cdots  \otimes \IdQ }}. \label{eq:defiBij}
\end{align}
$\IdQ$ is the identity matrix; 
a proof is given in \citet{Forets2017}.  The truncated Carleman
  linearization simply terminates the series at degree $k$, neglecting all
terms of degree $k+1$ and higher:
\begin{equation}
C^{(k)} = \begin{pmatrix}
A_1^1 & A_2^1 & A_3^1 & 0 & 0 & \ldots & 0 & 0 & 0 & 0 \\ 
0 & A_2^2 & A_3^2 & A_4^2 & 0 & \ldots & 0 & 0 & 0 & 0 \\
\vdots &  \vdots &  \vdots &  \vdots  & \vdots & \ddots & \vdots &  \vdots &  \vdots &  \vdots \\
0 & 0 & 0 & 0 & 0 & \ldots & 0 & A_{k-2}^{k-2} & A_{k-1}^{k-2} & A_{k}^{k-2} \\
0 & 0 & 0 & 0 & 0 & \ldots & 0 & 0 & A_{k-1}^{k-1} & A_k^{k-1} \\
0 & 0 & 0 & 0 & 0 & \ldots & 0 & 0 & 0 & A_k^k  \\
\end{pmatrix} \label{eq:Cdef}.
\end{equation}

\subsubsection*{Carleman-linearized LBE on spatial discretization grids}

To describe a spatially discretized system with $n$ grid points, we
introduce the following notation.  Greek letters are used to index grid points
(e.g., $\vec{x}_\alpha$, $\alpha\in 1,\dots,n$), to prevent confusion with the
(italic) indices of discrete velocities.  In place of the single-point objects
$f$, $V$, $A$, $F$, and $C$, we use $\phi$, $\mathcal{V}$, $\mathcal{A}$,
$\mathcal{F}$, and $\mathcal{C}$ to denote their $n$-point counterparts.

The distribution functions $f_m(\vec{x}_\alpha)$ at each grid point
are arranged into an $nQ$-length vector
\begin{align}
  \phi(\vec{x}) &= (f(\vec{x_1}), \dots, f(\vec{x_n}))^\trans \nonumber \\
  &= (f_1(\vec{x}_1), \dots, f_Q(\vec{x}_1), f_1(\vec{x}_2), \dots,
  f_Q(\vec{x}_2), \dots, f_1(\vec{x}_n), \dots, f_Q(\vec{x}_n))^\trans.
\end{align}
The $k$-forms $\phi^{[k]}(\vec x)$, then, include both local and nonlocal terms, i.e., products of
distribution functions at different positions.  While the streaming operator $S$ in
\Eq{eq:lbm-carleman}, implemented as finite differences, connects
distribution functions at different locations,  the collision operator is purely
local.  Thus, the $n$-point versions of
$F^{(1)}$, $F^{(2)}$, and $F^{(3)}$ are $n$-fold block repetitions of the single-point
versions; define
\begin{equation}
  \label{eq:F_i_alpha}
  \mathcal F^{(i)}(\vec{x}_\alpha) =  \delta_\alpha^{[i]} \otimes F^{(i)},
\end{equation}
where the local nature of the collision operator is expressed by the vector 
\begin{equation}
  \label{eq:delta-alpha}
  \delta_\alpha = (\underset{n \text{ elements}}{\underbrace{0, \dots,
      \overset{\alpha\text{th position}}{\overbrace 1}, \dots, 0}}).
\end{equation}
Further define
\begin{equation}
  \label{eq:F_i_n}
  \mathcal F^{(i)}(\vec{x}) = (\mathcal F^{(i)}(\vec{x}_1), \dots, \mathcal F^{(i)}(\vec{x}_n)).
\end{equation}
It follows from \Eq{eq:F_i_alpha} that
\begin{equation}
  \label{eq:diagonality-F}
  \mathcal F^{(i)}(\vec x_\alpha) [\underset{i \text{ factors}}{\underbrace{f(\vec x_\beta)
    \otimes \dots \otimes f(\vec x_\gamma)}}] = F^{(i)} f^{[i]}(\vec x_\alpha) \delta_{\alpha\beta}\dots\delta_{\alpha\gamma},
\end{equation}
where $\delta_{\alpha\beta}$ is the Kronecker delta function.
In other words, products of the form
$\mathcal F^{(i)}(\vec{x})\phi^{[i]}(\vec{x})$ only involve operations on
individual grid points even though the $\mathcal F^{(i)}(\vec x)$ matrices and
$\phi(\vec x)$ vector span all $n$ grid points.  We will refer to this property as
diagonality in $\vec x$.

Analogous to \Eq{eq:lbm-carleman}, the $n$-point LBE is
\begin{equation}
  \label{eq:eq:lbm-carleman-n}
  \ddt{\phi(\vec x)} = -S\phi(\vec x) + \mathcal F^{(1)}(\vec x)\phi(\vec x) +
  \mathcal F^{(2)}(\vec x)\phi^{[2]}(\vec x) + \mathcal F^{(3)}(\vec x)\phi^{[3]}(\vec x).
\end{equation}
The $n$-point Carleman matrix involves $n$-point versions of the transfer
matrices $A^i_j$; these are obtained by inserting
\Eq{eq:F_i_n} into the $n$-point equivalent of \Eq{eq:defiBij}:
\begin{equation}
  \label{eq:nptAij}
  \mathcal A^i_{i+j-1}(\vec x) =
  \sum_{r=1}^i \overset{i \text{ factors}}{\overbrace{
      \IdnQ \otimes \cdots \otimes
      \underset{\underset{r\text{th position}}{\uparrow}}{\mathcal F^{(j)}(\vec x)}
      \otimes  \cdots  \otimes \IdnQ }}. 
\end{equation}
It follows from \Eq{eq:diagonality-F} that
\begin{equation}
  \label{eq:diagonality-A}
  \mathcal A^i_{i+j-1}(\vec x_\alpha) [\underset{i+j-1 \text{ factors}}
  {\underbrace{f(\vec x_\beta) \otimes \dots \otimes f(\vec x_\gamma)}}] =
  A^i_{i+j-1} f^{[i]}(\vec x_\alpha)\delta_{\alpha\beta}\dots\delta_{\alpha\gamma}.
\end{equation}
Thus, $\mathcal A^i_{i+j-1}(\vec x_\alpha)$ is also diagonal in $\vec x$.

The streaming operator can be implemented as finite differences between
neighboring points (not necessarily restricted to nearest neighbors if better
than second-order accuracy is desired, but $O(Q)$ for any reasonable finite
difference implementation).  This results in a matrix form for $S$ with
$O(Q)$ off-diagonal bands, and transfer matrices that are obtained from
\Eq{eq:nptAij} by inserting $S$ instead of $\mathcal F^{(1)}$.  We denote
these transfer matrices of $S$ as $\mathcal B^i_i$; since
$S\phi(\vec{x})$ is linear in $\phi(\vec{x})$, $\mathcal B$ only enters on the block diagonal
of $\mathcal C(\vec{x})$.  (Note that, while $\mathcal B$ is diagonal in
Carleman degree, it is not diagonal in $\vec x$.)

The sum of the streaming Carleman matrix

\begin{equation}
  \label{eq:npt-stream}
  \mathcal C_s^{(k)}(\vec x) = - \begin{pmatrix}
    \mathcal B_1^1 & 0 & 0 & 0 & 0 & \ldots & 0 & 0 & 0 & 0 \\ 
    0 & \mathcal B_2^2 & 0 & 0 & 0 & \ldots & 0 & 0 & 0 & 0 \\
    \vdots &  \vdots &  \vdots &  \vdots  & \vdots & \ddots & \vdots &  \vdots &  \vdots &  \vdots \\
    0 & 0 & 0 & 0 & 0 & \ldots & 0 & \mathcal B_{k-2}^{k-2} & 0 & 0 \\
    0 & 0 & 0 & 0 & 0 & \ldots & 0 & 0 & \mathcal B_{k-1}^{k-1} & 0 \\
    0 & 0 & 0 & 0 & 0 & \ldots & 0 & 0 & 0 & \mathcal B_k^k  \\
  \end{pmatrix} 
\end{equation}
and the collision-term $n$-point Carleman matrix
\begin{equation}
  \label{eq:npt-coll}
  \mathcal C_c^{(k)}(\vec x) = \begin{pmatrix}
    \mathcal A_1^1(\vec x) & \mathcal A_2^1(\vec x) & \mathcal A_3^1(\vec x) & 0 & 0 & \ldots & 0 & 0 & 0 & 0 \\ 
    0 & \mathcal A_2^2(\vec x) & \mathcal A_3^2(\vec x) & \mathcal A_4^2(\vec x) & 0 & \ldots & 0 & 0 & 0 & 0 \\
    \vdots &  \vdots &  \vdots &  \vdots  & \vdots & \ddots & \vdots &  \vdots &  \vdots &  \vdots \\
    0 & 0 & 0 & 0 & 0 & \ldots & 0 & \mathcal A_{k-2}^{k-2}(\vec x) & \mathcal A_{k-1}^{k-2}(\vec x) & \mathcal A_{k}^{k-2}(\vec x) \\
    0 & 0 & 0 & 0 & 0 & \ldots & 0 & 0 & \mathcal A_{k-1}^{k-1}(\vec x) & \mathcal A_k^{k-1}(\vec x) \\
    0 & 0 & 0 & 0 & 0 & \ldots & 0 & 0 & 0 & \mathcal A_k^k(\vec x)  
  \end{pmatrix}
\end{equation}
then yields the $n$-point truncated Carleman matrix at degree $k$:
\begin{equation}
  \label{eq:n_point_Carleman}
  \mathcal C^{(k)}(\vec x) = \mathcal C_s^{(k)}(\vec x) + \mathcal C_c^{(k)}(\vec x).
\end{equation}
Similarly, the $n$-point Carleman vector becomes
\begin{equation}
  \mathcal V^{(k)}(\vec x) = (\phi(\vec x), \phi^{[2]}(\vec x), \dots,
  \phi^{[k]}(\vec x))^\trans,
\end{equation}
leading to the Carleman-linearized truncated LBE over $n$ grid points:
\begin{equation}
  \frac{\partial \mathcal V^{(k)}(\vec x)}{\partial t} = \mathcal C^{(k)}(\vec x)
  \mathcal V^{(k)}(\vec x),
  \label{eq:clbm}
\end{equation}
which, like the single-point Carleman LBE, is a system of linear differential
equations in matrix form.  In contrast to the single-point Carleman vector
$V^{(k)}$, which has dimension $\sum_{i=1}^k Q^i$, the dimension of the $n$-point Carleman vector
$\mathcal V^{(k)}(\vec x)$ is $\sum_{i=1}^k n^iQ^i$.  Note that $\mathcal
C_c^{(k)}(\vec x)$, all its transfer-matrix blocks being diagonal in $\vec x$ by
\Eq{eq:diagonality-A}, is also diagonal in $\vec x$, a property we will use
extensively in the quantum-algorithm complexity analysis.

The first problem that we would like to solve involves assuming that we are given an initial distribution $\phi(0)$ that is efficiently computable over our lattice, an evolution time $t$ and an error tolerance $\epsilon_{\rm dyn}$ to generate a quantum state $\ket{\mathcal{V}^{(k)}(x,t)}$ such that $\| \ket{\mathcal{V}^{(k)}(x,t)} - {\mathcal{V}^{(k)}(x,t)}/\|{\mathcal{V}^{(k)}(x,t)}\| \le \epsilon_{\rm dyn}$.  

The problem is the natural problem to first look at, however, it ignores the fact that the observables we are interested in do not act on the extended Hilbert space invoked through the use of Carleman linearization.  The overall problem that we are interested in is then if we define the projector onto the first Carleman block to be $\ket{\phi_0}\!\bra{\phi_0}\otimes I$ then we aim to minimize
\begin{equation}
\|(\bra{\phi_0}\otimes I)(\ket{\mathcal{V}^{(k)}(x,t)} / \|(\bra{\phi_0}\otimes I)(\ket{\mathcal{V}^{(k)}(x,t)}\| - \phi(x)/\|\phi(x)\| \|\le \epsilon_{\rm total}.
\end{equation}
Our aim is then to separate the two sources of error in the problem and use to observation that if $\epsilon_{\rm total} \le \epsilon_{\rm dyn} + \epsilon_{\rm carl}$ then it suffices to make both of these error sources small.  Through existing arguments, we can construct a quantum algorithm that makes the former small.  We will make arguments here based on perturbation theory backed by numerics that $\epsilon_{\rm carl}$ can be made small in regimes of practical interest using small values of $k$.

\ifarXiv
\section*{Results}
\label{sec:results}
\fi

\subsection*{Carleman truncation error}

We now analyze the effect of truncating the infinite-dimensional Carleman system
of equations at a finite degree.  We show that the zeroth and first moments of the 
lattice Boltzmann distribution functions ($\rho$ and $\rho \vec u$) at $k$th degree
receive corrections from the higher-order Carleman variables at degrees $k+1$ and
$k+2$ and that these corrections are suppressed by $O(\text{Ma}^2)$.

The macroscopic properties of the LBE
fluid are given by moments of the lattice Boltzmann distribution functions, as
can be seen from \Eq{eq:rho}--(\ref{eq:u}): the
zeroth moment gives $\rho$, and the first moment gives $\rho \vec u$.  We introduce the
coefficient vectors
\begin{equation}
  \Phi_\rho = (1, \dots, 1)
\end{equation}
and
\begin{equation}
  \Phi_{\rho u} = (\vec{e}_1, \dots, \vec{e}_Q),
\end{equation}
which recover the macroscopic fluid variables by matrix-multiplying the vector of distribution functions such that
\begin{equation}
\rho = \sum_m (\Phi_\rho)_m f_m = \Phi_\rho f
\end{equation}
and
\begin{equation}
\rho \vec u = \sum_m (\Phi_{\rho u})_m f_m = \Phi_{\rho u} f.
\end{equation}
From the mixed-product property of the
Kronecker product,
\begin{equation}
  \label{eq:kromipro}
  (A \otimes B) (C \otimes D) = (AC) \otimes (BD),
\end{equation}
it follows that 
\begin{align}
  (\rho)^p (\rho \vec u)^q &= (\Phi_\rho f)^{[p]} (\Phi_{\rho u} f)^{[q]}\nonumber \\
                           &= \left(\Phi_\rho^{[p]}\otimes\Phi_{\rho u}^{[q]}\right) f^{[p+q]}
\end{align}
for arbitrary integers $p$ and $q$ (where products of spatial vectors imply the dot product).

Furthermore, inserting the quadratic and cubic terms in
\Eq{eq:lbm-grouped}, we obtain
(introducing the shorthand notation $\zeta_2$ and $\zeta_3$): 
\begin{align}
  \Phi_\rho     F^{(2)}f^{[2]} &= \frac 2 {\kn\tau} \sum_m w_m\left[c (\vec{e}_m\cdot
                                 \rho\vec{u})^2 + d\rho^2 u^2 \right] =
                                 \zeta_2 \rho^2 \nonumber \\
  \label{eq:rhoF2f2}
  &= O((\kn\tau)^{-1}\rho^{2}u^2) \\
  \Phi_\rho     F^{(3)}f^{[3]} &= -\frac 1 {\kn\tau} \sum_m w_m \left[c\rho^3(\vec{e}_m\cdot
                                 \vec{u})^2 + d\rho^3u^2 \right] =
                                 \zeta_3\rho^3 \nonumber \\
  \label{eq:rhoF3f3}
  &= O((\kn\tau)^{-1}\rho^{3}u^2) \\
  \\
  \label{eq:rhouF2f2}
  \Phi_{\rho u} F^{(2)}f^{[2]} &= \frac 2 {\kn\tau} \sum_m w_m\vec{e}_m\left[c (\vec{e}_m\cdot
                                 \rho\vec{u})^2 + d\rho^2 u^2 \right] = 0\\
  \label{eq:rhouF3f3}
  \Phi_{\rho u} F^{(3)}f^{[3]} &= -\frac 1 {\kn\tau} \sum_m w_m \vec{e}_m \left[c\rho^3(\vec{e}_m\cdot
                                 \vec{u})^2 + d\rho^3u^2 \right] = 0,
\end{align}
where the result $\Phi_{\rho u} F^{(2)}f^{[2]} = \Phi_{\rho u} F^{(3)}f^{[3]} =
0$ is a consequence of lattice symmetry dictating that the nonresting particles
occur in pairs of equal weight $w_m$ but opposite direction
$\vec{e}_m$, and the bounds in \Eq{eq:rhoF2f2} and
\Eq{eq:rhoF3f3} stem from $w_m=O(1)$ and $\sum_m w_m=1$.

The lowest-order correction to $\partial V^{(k)}/\partial t$ is given by the
elements of $C^{(k+1)}$ that are not present in $C^{(k)}$.  At this point, for
concreteness, we consider $k=3$ as an example:
\begin{align}
  \label{eq:f2c4}
  \left[\ddt{f^{[2]}}\right]'_{(4)} &= A^2_4 f^{[4]} \\
  \label{eq:f3c4}
  \left[\ddt{f^{[3]}}\right]'_{(4)} &= A^3_4 f^{[4]} ,
\end{align}
where $[\partial/\partial t]'_{(k+1)}$ denotes said correction%  due to the
% elements of $C^{[k+1]}$ that are not present in $C^{[k]}$
.  By the definition
of $A^i_{i + j - 1}$ (\Eq{eq:defiBij}),
\begin{align}
  A^2_4 &= F^{(3)}\otimes \IdQ + \IdQ \otimes F^{(3)} \\
  A^3_4 &= F^{(2)}\otimes \IdQ \otimes \IdQ + \IdQ \otimes F^{(2)}\otimes \IdQ +
          \IdQ \otimes \IdQ \otimes F^{(2)}.
\end{align}
Using $\Phi_\rho$ and $\Phi_{\rho u}$ to construct corrections to degree 2 and 3
polynomials of $\rho$ and $\rho \vec u$ yields, again by the mixed-product rule
(\Eq{eq:kromipro}), substituting the expressions from
\Eq{eq:lbm-grouped} for $F^{(2)}f^{[2]}$ and $F^{(3)}f^{[3]}$,
and making use of \Eq{eq:rhoF2f2}--(\ref{eq:rhouF3f3}):
\begin{align}
  \left[\ddt{\rho^2}\right]'_{(4)}
  &= \Phi_\rho^{[2]} \left[\ddt{f^{[2]}}\right]'_{(4)} = \Phi_\rho^{[2]} A^2_4  f^{[4]} \nonumber \\
  &= (\Phi_\rho \otimes \Phi_\rho) \left(F^{(3)}\otimes \IdQ + \IdQ \otimes
    F^{(3)}\right) (f \otimes f \otimes f \otimes f) \nonumber \\
  &= (\Phi_\rho F^{(3)} f^{[3]})\otimes(\Phi_\rho\IdQ f) + (\Phi_\rho\IdQ
    f)\otimes(\Phi_\rho F^{(3)} f^{[3]}) \nonumber \\
  \label{eq:rho2c4}
  &= -\frac{2}{\kn\tau}du^2\rho \\
  \left[\ddt{\rho^2u^2}\right]'_{(4)}
  &= \Phi_{\rho u}^{[2]} \left[\ddt{f^{[2]}}\right]'_{(4)} = \Phi_{\rho u}^{[2]} A^2_4  f^{[4]} \nonumber \\
  &= (\Phi_{\rho u} \otimes \Phi_{\rho u}) \left(F^{(3)}\otimes \IdQ + \IdQ \otimes
    F^{(3)}\right) (f \otimes f \otimes f \otimes f) \nonumber \\
  \label{eq:rho2u2c4}
  &= 0.
\end{align}

We now derive a recursion formula for the higher-order corrections to powers of
$\rho$ and $\rho \vec u$ at arbitrary order, following steps very similar to the
$k=3$ example.  At any Carleman order $k$, corrections to $f^{[k-1]}$ and
$f^{[k]}$ arise due to the neglected terms containing $f^{[k+1]}$, which, by
inspection of \Eq{eq:Cdef}, can be written as
\begin{align}
  \left[\ddt{f^{[k-1]}}\right]'_{(k+1)} &= A^{k-1}_{k+1} f^{[k+1]} \\
  \left[\ddt{f^{[k]}}\right]'_{(k+1)} &= A^{k}_{k+1} f^{[k+1]}.
\end{align}
These equations are analogous to \Eq{eq:f2c4}--(\ref{eq:f3c4}) for the $k=3$
example.  Only these two subvectors of $V$ receive corrections due to the
diagonal band structure of \Eq{eq:Cinfdef}, whose striping is determined by
the presence of terms up to cubic degree in \Eq{eq:lbm-carleman}.  The
corresponding corrections to powers of the macroscopic fluid variables can be
derived by left multiplication with Kronecker powers of $\Phi_\rho$ and
$\Phi_{\rho u}$ in analogy to \Eq{eq:rho2c4}--(\ref{eq:rho2u2c4}):
\begin{align}
  \left[\ddt{\rho^{k-1}}\right]'_{(k+1)}
  &= \Phi_\rho^{[k-1]}A^{k-1}_{k+1}
    f^{[k+1]} \nonumber \\
  &= \left(\Phi_\rho^{[k-2]}\otimes\Phi_\rho\right)
    \left[\sum_{r=1}^{k-1} \IdQ^{[r-1]} \otimes F^{(3)} \otimes \IdQ^{[k-r-1]} \right]
    \left(f^{[k-2]}\otimes f^{[3]}\right)\nonumber \\
  &= -\frac{k-1}{\kn\tau}\left(\sum_m w_m \left[c\rho^3(\vec{e}_m\cdot\vec{u})^2 +
    d\rho^3u^2 \right]\right)\rho^{k-2} \nonumber \\
  &= O(k(\kn\tau)^{-1}\rho^{k+1}u^2) \\
  \left[\ddt{\rho^{k}}\right]'_{(k+1)}   &= \Phi_\rho^{[k]}A^{k}_{k+1} f^{[k+1]}
                                           \nonumber \\
  &= \left(\Phi_\rho^{[k-1]}\otimes\Phi_\rho\right)
    \left[\sum_{r=1}^{k} \IdQ^{[r-1]} \otimes F^{(2)} \otimes \IdQ^{[k-r]} \right]
    \left(f^{[k-1]}\otimes f^{[2]}\right)\nonumber \\
  &= \frac{2k}{\kn\tau}\left(\sum_m w_m \left[c\rho^2(\vec{e}_m\cdot\vec{u})^2 +
    d\rho^2u^2 \right]\right)\rho^{k-1} \nonumber \\
  &= O(k(\kn\tau)^{-1}\rho^{k+1}u^2) \\
  \label{eq:rhouF3fn}
  \left[\ddt{\rho^{p}u^{q}}\right]'_{(k+1)} &= 0, \quad p \geq 0, q > 0, p +
                                              q = k - 1 \\
  \label{eq:rhouF2fn}
  \left[\ddt{\rho^{p}u^{q}}\right]'_{(k+1)}   &= 0, \quad p \geq 0, q > 0, p +
                                              q = k,
\end{align}
for integer $p$ and $q$, where \Eq{eq:rhouF3fn} and \Eq{eq:rhouF2fn} follow from
\Eq{eq:rhouF2f2} and \Eq{eq:rhouF3f3}.  Thus, the macroscopic fluid
properties follow a hierarchy where subsequent higher-order corrections are
suppressed by factors of $O(u^2) = O(\text{Ma}^2)$ relative to the
highest-order retained terms. 
Since the LBE is restricted to $\text{Ma}\ll 1$, the
Carleman truncation error and the Taylor expansion error on $1/\rho$
are small even when a low Carleman truncation order is used.  We also note that
the expression for the truncation error is independent of the system
size and Reynolds number, since the overall $(\kn\tau)^{-1}$ normalization is
common to the retained and neglected terms.
\ifarXiv
\else
This is the basis of our claim in the main text that the Carleman order can be kept
constant as the system size is extended or $\text{Re}$ is increased.
\fi

As a numerical consistency check of the Carleman-linearized nonlinear collision term of \Eq{eq:LBMs}, we perform the
LBM and the Carleman-linearized LBM numerical experiments. We choose the two-dimensional Taylor--Green (TG) flow because it is an analytical solution \citep{Batchelor} of the NSE and can serve as a benchmark for validating the simulation results.
The simulations are initialized with a given TG initial velocity $U_0$. The periodic boundary condition is adopted. To check the Ma dependency of the relative error, we perform simulations for different initial Ma with the same initial Re. This is achieved by varying $\nu$ and initial velocity while keeping $n$ the same. 
The relative error of the maximum $u_x$ ($x$ component of the simulated velocity of the TG flow) of LBM with the Carleman-linearized collision term compared to LBM is shown in \Fig{error_Re_CLBM-LBM_Ma}. We first observe that the relative error is small ($O(10^{-10})$) (\Fig{error_Re_CLBM-LBM_Ma}), showing that the Carleman-linearized LBM can accurately reproduce the LBM over the range considered. At a given time, the relative error increases with increasing initial Ma, which is consistent with our finding that the Carleman truncation error scales with Ma. 

\begin{figure*}[t!]\begin{center}
\includegraphics[trim=30 180 50 180,clip, width=0.7\textwidth]{errorUmax_Ma}
\end{center}
\caption{Relative error of the maximum $u_x$ between Carleman-linearized LBM and LBM simulations for different initial $\text{Ma}$ (Ma = 0.01, 0.02, 0.04, 0.09 are represented by magenta triangles, blue dots, green pluses, and red squares, respectively) at fixed initial $\text{Re}=100$. The x-axis represents the simulation time $t$ normalised by the kinetic diffusion time scale $\nu/U_0^2$, i.e., kinetic viscosity divided by square of the initial flow velocity. }
\label{error_Re_CLBM-LBM_Ma}
\end{figure*}

\subsection*{Quantum algorithm complexity}
\label{sec:qac}

In this section, we derive bounds on the complexity of applying the
\citet{Berry2017QuantumPrecision} algorithm to the Carleman-linearized
LBE of degree 3 at $n$ spatial grid points with $Q$ discrete
velocities (\Eq{eq:clbm}). For notational compactness, we
introduce the abbreviated notation
\begin{align}
  \mathcal V &= \mathcal V^{(3)}(\vec x) \\
  \mathcal C &= \mathcal C^{(3)}(\vec x).
\end{align}
Carleman order $k=3$ is explicitly chosen as we showed above that the
truncation error at $k=3$ is $O(\ma^2)$, which is sufficient to
prevent truncation error from dominating the solution error.

\subsubsection*{Properties of the physical system}

Before proceeding further, we summarize the properties of the physical
systems which can be simulated using our procedure, including
conditions that the systems must satisfy for the procedure to be
applicable.  We also give typical values of system parameters for a
particular application (atmospheric turbulence).  The key unrestricted
parameter of the physical application is the number of grid points
$n$.  For simulations of turbulent flows, the $n\gg 1$ behavior of the
algorithm is of utmost interest; for example, for direct simulations
of atmospheric turbulence, $n > 10^{20}$ is desirable (and
unattainable using state-of-the-art algorithms on classical computers).

\paragraph{Parameters of restricted range}
\label{sec:prop-of-phys-syst:param-restr-range}

The fluid flow to be modeled by our procedure needs to satisfy certain
conditions.  These conditions restrict two parameters of the flow, the
Mach number $\ma$ and Knudsen number $\kn$.  First, the flow needs to
be ``weakly compressible'', i.e., $\ma \ll 1$.  This is a
requirement both for the LBE to recover the NSE and for the linearized
LBE to approximate the nonlinear LBE (both of which errors scale as
$\ma^2$).  In LBM practice, $\ma < 10^{-1}$ is a typical upper bound,
but atmospheric flow satisfies $\ma \leq 10^{-2}$ in most
circumstances.  Second, the flow to be modeled must also be
``continuum flow'', i.e., macroscopic features like turbulent eddies
must be much larger than the molecular scale.  This is reflected in
Boltzmann relaxation parameter $\kn\tau\ll 1$.  Typical values in the
atmosphere are $\kn < 10^{-8}$.  The scaled relaxation $\tau$ is
restricted to the range $0.5<\tau\leq 1$ in LBM practice.
Furthermore, the relaxation
parameter restricts the number of grid points according to
\Eq{eq:kn-logn} to $\log n \ll (\kn\tau)^{-3}$.
This restriction is unlikely to have practical consequences; in the
atmospheric example, it is equivalent to $n \ll \exp(10^{24})$.
For
atmospheric flow, $\ma\ll 1$ is the most restrictive condition.

\paragraph{Free parameters}

The number of spatial grid points $n$ used to resolve the flow is
unrestricted, i.e., application science would like the largest value
possible subject to getting a result within a reasonable wallclock
time limit.  Reynolds number $\re$ is similarly unrestricted, i.e.,
application science would like the largest value possible.  Typical
values of these parameters currently attainable using state-of-the-art
classical algorithms and computers are $n\approx 10^9$ and
$\re \approx 10^5$.  The parameters $\re$, $n$, and physical integral
domain size $L$ are not independent; higher $\re$ requires finer
resolution, implying higher $n/L^d$ (in $d$ spatial dimensions).  A transformational capability in
atmospheric science would be direct numerical simulation of entire cloud systems
($L\approx 100$ km) at $\re\approx10^9$, which requires a spatial grid spacing of 1 mm (Kolmogorov length scale) or $n\approx 10^{21}$.

The physical integration time $\tilde T$ depends on specifics of the
physical problem.  It is typically determined by the time required for
the turbulence to spin up from homogeneous initial conditions and
for the turbulent eddies then to turn over several times so that
domain-mean statistics are representative of the fully developed
turbulent steady state.

\paragraph{Constants}

The number of discrete molecular velocities $Q$ is fixed, i.e., the same
value can be used for simulation of arbitrary systems (as long as
$\ma \ll 1$); values in widespread use are $Q\in\{3,9,27\}$ for 1D, 2D,
and 3D fluid flows, respectively.  The constants $a=1$, $b=3$, $c=9/2$, $d=-3/2$
are fixed for all lattice geometries, and the $w_m$ are fixed for each
specific lattice geometry.  For this reason, we consider these parameters to be constants; however, for some simulations it may be appropriate to take these to be free parameters that change as the desired simulation accuracy increases to minimize algorithmic complexity.

\paragraph{Solution error sources}

Two distinct sources of solution error appear.  The first is due to
the Carleman-linearized LBE being an approximation to the actual NSE
dynamics of the system; this error is $O(\ma^2)$, hence the $\ma\ll 1$
requirement for our procedure to be applicable.  The second is
discretization error in the time integration of $\partial\mathcal V/\partial t
= \mathcal C \mathcal V$ in the quantum algorithm; this is
parameterized by $\epsilon$, which should be chosen so it is not the
dominant error, i.e., $\epsilon=O(\ma^2)$.

\subsubsection*{Contributions to algorithm complexity}
  
The complexity of solving \Eq{eq:clbm} is given by \Eq{eq:ca} in terms
of the properties of the coefficient matrix $\mathcal C$ and the solution vector
$\mathcal V$; for ease of reference, the equation is
reproduced here:
\begin{equation}
\tag{\ref{eq:ca}}
\text{gate complexity}=O(\Vert \mathcal C\Vert \kappa_J g T s\cdot
\text{poly}(\log{(\kappa_J s g \beta T \Vert \mathcal C \Vert N/\epsilon)})),
\end{equation}
where $\mathcal C=\mathcal J \mathcal D \mathcal J^{-1}$ is an $N\times N$ diagonalizable matrix with
eigenvalues $\mathcal D=\text{diag}(\lambda_i)$ ($i \in 1,\dots, N$) whose real part
$\mathcal{R}(\lambda_i)\leq 0\ \forall i$. The norm $\|\mathcal C\|$ is the
2-norm, the largest singular value of $\mathcal C$.  Here we consider the gate complexity to be the number of one and two-qubit gates needed for the simulation.  The condition number in the above expression,
\begin{equation}
    \kappa_\mathcal{J} = \|\mathcal{J}\|\cdot\|\mathcal{J}^{-1}\|,
\end{equation}
is the condition number of the matrix $\mathcal{J}$ of
eigenvectors of $\mathcal C$.
The dissipation parameter $g$ is defined as
\begin{equation}
\label{eq:g}
g = \underset{t\in[0,T]}{\max} \Vert
\mathcal V(t)\Vert/\Vert \mathcal V(T)\Vert,
\end{equation}
with $T$ the evolution time, and $s$ is the sparsity (number of nonzero
entries per row) of $\mathcal C$.  The initial condition norm enters through
\begin{equation}
\label{eq:beta}
\beta = (\| \vert{\mathcal V}_\text{in}\rangle \|) / \| \vert{\mathcal V}(T)\rangle \| = O(1), 
\end{equation}
which is dependent on the physical problem under consideration but independent
of other system parameters.
The number of degrees of freedom $N$, which is the dimension of $\mathcal C$ and
$\mathcal V$, is given in terms of the number of grid points $n$ and discrete
velocities $Q$ by
\begin{equation}
  N = (n^3Q^3 +  n^2Q^2 + nQ).
\end{equation}
The term-by-term analysis of the factors that determine the algorithmâ€™s complexity (\Eq{eq:ca}) is
conducted below.

\paragraph{Sparsity}

The coefficient matrices $F^{(1)}$, $F^{(2)}$, and $F^{(3)}$ and resulting transfer matrices $A^i_j$
for a single point contain $O(Q^3\times Q^3)$ elements.  In the $n$-point
Carleman matrix, locality is enforced by \Eq{eq:F_i_alpha}, so that the
nonzero elements of the collision Carleman matrix (\Eq{eq:npt-coll}) are
diagonal in $\vec x$.

The streaming operator $S$ involves the $O(Q)$ nearest (or potentially
next-to-nearest, next-to-next-to-nearest, etc., if higher-order accuracy for the
gradient operator is desired) neighbors in space. This results in bands in $S$
that are not diagonal in $\vec x$, yielding an additional $O(Q^3\times Q^3)$ off-diagonal
elements in the streaming Carleman matrix, i.e., the first term in \Eq{eq:n_point_Carleman}.

The sparsity, i.e., the total number of nonzero elements in each row of
$\mathcal C$, is bounded by the sum of the sparsity of the collision Carleman
matrix and the sparsity of the streaming Carleman matrix, both of
which are $O(Q^3)$; thus,
\begin{equation}
  s=O(1),\label{eq:sparsity}
\end{equation}
i.e, sparsity is independent of the number of grid points $n$ and other free parameters of the
system for the fixed discretization schemes considered here.

\paragraph{Matrix norm}
We now determine the norm of the Carleman matrix $\mathcal C$ (\Eq{eq:n_point_Carleman}).
The matrix 2-norm of a matrix $M$ is bounded by its 1-norm and its $\infty$-norm: 
\begin{equation}
  \label{eq:specnorm}
  \|M\| \leq \sqrt{\|M\|_1 \|M\|_\infty}.
\end{equation}
The 1-norm and $\infty$-norm of $\mathcal C$ can both be directly bounded, since
they equal the maximum absolute column sum and maximum absolute row sum of the
matrix, respectively.  By \Eq{eq:sparsity}, there are $O(Q^3)$ nonzero
elements in each row.  From \Eq{eq:lbm-grouped}, these elements are each
$O((\kn\tau)^{-1})$, so that $\|\mathcal C\|_\infty = O(Q^3(\kn\tau)^{-1})$.  We
note that \Eq{eq:sparsity} also gives the number of nonzero elements in each
column due to the diagonality of $\mathcal C$ in $\vec x$, so that
$\|\mathcal C\|_1$ has the same scaling as $\|\mathcal C\|_\infty$.  Therefore,
the overall scaling of the matrix norm with the free parameters of the
system is
\begin{equation}
  \label{eq:normc}
  \|\mathcal C\| = O((\kn\tau)^{-1}).
\end{equation}
In practice, $\tau = O(1)$, because $\tau > 0.5$ is required for the stability of the
LBM \cite{Sterling1996StabilityMethods}.   Thus we have
\begin{equation}
    \|\mathcal{C} \| = O(\kn^{-1}).
\end{equation}

\paragraph{Condition number}

To bound  $\kappa_{\mathcal{J}}$, we need to find the eigenvectors of $\mathcal C$.  This is
not possible analytically for arbitrary $n$; if an analytic expression for the
eigenvectors could be obtained, a quantum algorithm, or any numerical
simulation, would no longer be required to calculate the dynamics of the system
described by $\mathcal C$.  We will derive a bound on $\kappa_\mathcal{J}$ in three steps.
First, we will numerically diagonalize the single-point collision Carleman
matrix $C$ at Carleman order $k=3$ (\Eq{eq:Cdef}) for lattice structures used
to recover the NSE from the LBE; these are specific matrices with
fixed, explicitly known $a$, $b$, $c$, $d$, $w_m$, and $Q$ parameters
in \Eq{eq:lbm-grouped}, but they can solve
general flows \cite{Chen1998LatticeFlows}.  Second, we will show that the
eigenvectors of the $n$-point collision Carleman matrix $\mathcal C_c(\vec x)$,
defined in \Eq{eq:npt-coll}, can be constructed from the eigenvectors of the
single-point $C$.  Third, we will perform a perturbative expansion to include
the effect of the streaming Carleman matrix $\mathcal C_s(\vec x)$, defined in
\Eq{eq:npt-stream}, and derive an approximate expression for $\kappa_\mathcal{J}$ that
holds as long as the Knudsen number of the flow is small; this condition needs
to be satisfied for the LBE to describe the flow.  The numbered paragraphs below
provide the details of these three steps.

\begin{enumerate}
\item In one, two, and three spatial dimensions, the D1Q3, D2Q9, and D3Q27
  lattice topologies are frequently used and are known to recover the NSE in the
  $\ma\ll 1$ limit \cite{Chen1998LatticeFlows} on which the present work
  focuses.  The single-point collision Carleman matrices $C$ and their
  spectral decompositions $C=JDJ^{-1}$ are provided as a data
  supplement \cite{url}. 
  By inspection of these numerical results,
  all eigenvalues of $C$ are 
  $-(\kn\tau)^{-1} \times \{0, 1, 2, 3\}$, that is, they are either degenerate or separated by gaps of
  $(\kn\tau)^{-1}$, as shown by the histogram of the eigenvalue spectra
  $\mathcal{R}(\lambda)$ in Fig.~\ref{fig:spectral}.  The eigenvector matrices
  $J$ and $J^{-1}$  are similarly constant for each choice of $Q\in\{3,9,27\}$.
  The corresponding condition numbers are $\kappa_J = 12.94$ for D1Q3, $\kappa_J
  = 85.66$ for D2Q9, and $\kappa_J = 2269$ for D3Q27.  Bounds based on
  \Eq{eq:specnorm} are $\kappa_J \le 62.41$ for D1Q3, $\kappa_J
  \le 2252$ for D2Q9, and $\kappa_J \le 1.152\times 10^5$ for D3Q27; these bounds will be used
  to generalize to $n$ grid points below.
\item Denote the eigenvectors of the single-point $C$ as $\xi_i$, $i\in
  1,\dots,Q$, and decompose
  \begin{equation}
    \xi_i = (\xi_i^{(1)}, \xi_i^{(2)}, \xi_i^{(3)})^\trans
  \end{equation}
  according to whether its elements represent 1-, 2-, or 3-form elements (powers of $f_m$ polynomials defined in \Eq{eq:lbm-carleman}) of the
  single-point Carleman vectors $V$.  Using the $\delta_\alpha$ vector from
  \Eq{eq:delta-alpha}, we can construct localized eigenvectors $\Xi_i(\vec
  x_\alpha)$ of the $n$-point collision Carleman matrix (\Eq{eq:npt-coll}):
  \begin{equation}
    \label{eq:Xi}
    \Xi_i(\vec x_\alpha) =
    (\delta_\alpha \otimes \xi_i^{(1)},
    \delta_\alpha^{[2]} \otimes \xi_i^{(2)},
    \delta_\alpha^{[3]} \otimes \xi_i^{(3)})^\trans.
  \end{equation}
  By \Eq{eq:diagonality-A}, $\Xi_i(\vec x_\alpha)$ is an eigenvector of the
  $n$-point collision matrix $\mathcal C_c^{(3)}(\vec x)$ for any
  $\alpha\in 1,\dots,n$, as the diagonality of the $n$-point transfer matrices
  in $\vec x$ ensures that the nonzero blocks of $\mathcal C_c$ are aligned with
  the nonzero blocks of $\Xi_i(\vec x_\alpha)$.  The eigenvectors of the
  $n$-point collision Carleman matrix $\mathcal C_c$ are therefore a simple
  blockwise repetition of the eigenvectors of the single-point $C$.
  Furthermore, it follows from \Eq{eq:Xi} that
  \begin{equation}
    \label{eq:Xi-ortho}
    \Xi_i(\vec x_\alpha)^\trans \Xi_j(\vec x_\beta) = \xi_i^\trans \xi_j \delta_{\alpha\beta},
  \end{equation}
  i.e., the eigenvectors at different grid points are mutually orthogonal.  The
  corresponding eigenvalues are equal for all $\alpha \in 1,\dots,n$, i.e., they
  are repetitions of the eigenvalues of $C$.

  The $\Xi_i(\vec x_\alpha)$ are stacked column-wise or row-wise to
  form the eigenvector matrices of $\mathcal C_c$.  Denote these eigenvector
  matrices as $\mathcal J_0$ and $\mathcal J_0^{-1}$.  (The subscript 0 notation
  is used in anticipation of the perturbation analysis carried out in the next
  paragraph.)  By \Eq{eq:Xi-ortho}, the eigenvectors localized at different grid points
  form blocks in $\mathcal J_0$ and $\mathcal J_0^{-1}$ that ensure that row and
  column sums on $\mathcal J_0$ and $\mathcal J_0^{-1}$ consist of the
  same $O(Q^3)$
  nonzero elements as row and column sums on the \textit{single-point constant}
  eigenvector matrices $J$ and $J^{-1}$, rather than the full
  $O(n^3Q^3)$ dimension of the $n$-point 
  matrices.  Thus, the same spectral-norm bound from
  \Eq{eq:specnorm} applies to $\|J\|$ and $\|\mathcal J_0\|$; and
  the same bound applies to $\|J^{-1}\|$ and $\|\mathcal J_0^{-1}\|$.
  Thus, $\kappa_{\mathcal{J}_0}$ is fixed (for fixed $Q$), independent
  of $n$.
  
\item Finally, we bound the effect of the streaming contribution $\mathcal C_s$
  to the eigenvectors of $\mathcal C=\mathcal C_s + \mathcal C_c$ and thence the
  effect on $\mathcal J$, $\mathcal J^{-1}$, and $\kappa_{\mathcal J}$.
  Inspection of \Eq{eq:lbm-grouped} shows that the streaming term in the LBE
  is suppressed by $\kn\ll 1$ relative to the collision term; this suggests that
  we can treat streaming using well established principles of (degenerate)
  perturbation theory \cite{Sakurai1994}, with the collision Carleman matrix in
  \Eq{eq:n_point_Carleman} constituting the base matrix (with known
  eigenvectors) and the streaming term constituting the $O(\kn)\ll 1$
  perturbation.

  Item 2.\ above derived the properties of the $n$-point collision eigenvector
  matrices $\mathcal J_0$ and $\mathcal J_0^{-1}$ in terms of the single-point
  eigenvector matrices $J$ and $J^{-1}$ that had to be computed numerically.
  When the perturbation due to $\mathcal C_s$ is included, the eigenvectors are
  perturbed \cite{Sakurai1994} in proportion to the perturbation strength
  ($\kn\tau$) and the gap size of the eigenvalue spectrum of $\mathcal C_c$,
  neglecting until the next paragraph the issue of degenerate eigenvalues.  For
  notational convenience, we suppress the $\vec x_a$ notation on the
  eigenvectors of $\mathcal C_c$; the perturbed eigenvectors to first order are
  then given by $\Xi_i + \Xi_i'$, where
  \begin{equation}
    \label{eq:pertnondeg}
    \Xi_i' =  \kn\tau \sum_{k\neq i} \frac{\Xi_i^\trans \mathcal C_s \Xi_k}{\lambda_i -
      \lambda_k} \Xi_k.
  \end{equation}
  Numerical calculation of the eigenvalue spectrum of the single-point Carleman
  matrices in item 1.\ above showed the gap between nondegenerate eigenvalues
  to be integer multiples of $(\kn\tau)^{-1} \gg 1$, so the perturbation to the eigenvectors is
  proportional to $O((\kn\tau)^{2}) \ll 1$ times the expectation values $\sum\Xi_i^\trans
  \mathcal C_s \Xi_k$.  In the nondegenerate case, the eigenvectors
  form an orthonormal basis, and the vector norm of the $\Xi_i'$ can be bounded
  as follows:
  \begin{align}
    \vert \Xi_i'\vert^2 &= (\kn\tau)^2 \sum\limits_{k\neq i}
                          \frac{\Xi_i^\trans\mathcal C_s \Xi_k
                          \Xi_k^\trans\mathcal C_s^\dagger \Xi_i}{(\lambda_k -
                          \lambda_i)^2} \nonumber \\
    &\leq \frac{(\kn\tau)^2}{\min_k (\lambda_k - \lambda_i)^2} \sum\limits_{k\neq i}
      \Xi_i^\trans\mathcal C_s \Xi_k \Xi_k^\trans\mathcal C_s^\dagger
      \Xi_i \nonumber \\
    \label{eq:temp1}
    &\leq \frac{(\kn\tau)^2}{\min_k (\lambda_k - \lambda_i)^2} \left[\sum\limits_k
      \Xi_i^\trans\mathcal C_s \Xi_k \Xi_k^\trans\mathcal C_s^\dagger \Xi_i
      - \left\vert \Xi_i^\trans \mathcal C_s \Xi_i\right\vert^2\right].
  \end{align}
  Using completeness and noting that the final term in \Eq{eq:temp1} is
  nonpositive-definite,
  \begin{equation}
    \vert \Xi_i'\vert^2 \leq \frac{(\kn\tau)^2}{\min_k (\lambda_k -
      \lambda_i)^2} \Xi_i^\trans \mathcal C_s \mathcal
    C_s^\dagger \Xi_i,
  \end{equation}
  and therefore
  \begin{equation}
    \vert \Xi_i'\vert \leq \frac{\kn\tau}{\min_k (\lambda_k -
      \lambda_i)} \|\mathcal C_s \|.
  \end{equation}
  The eigenvalues of the streaming operator correspond to the spectrum of
  wavenumbers supported by the spatial discretization.  On the lattice, these
  wavenumbers are rescaled according to \Eq{eq:scale-x} so that the maximum
  wavenumber is $O(1)$, and hence
  \begin{equation}
    \vert \Xi_i'\vert = O\left(\frac{\kn\tau}{\min_k (\lambda_k -
      \lambda_i)}\right).
  \end{equation}
  As we determined numerically in
  Fig.~\ref{fig:spectral}, there are up to four (only three in
  the one-dimensional LBE) discrete eigenvalues $-\{0, 1, 2, 3\}
  \times (\kn\tau)^{-1}$, so 
  \begin{equation}
    \label{eq:vecnorm-xiprime}
    \vert \Xi_i'\vert = O((\kn\tau)^2).
  \end{equation}
  
  The repetition of the single-point Carleman eigenvalues in the $n$-point
  Carleman eigenvalue spectrum means that each eigenvalue is highly degenerate.  We
  therefore need to treat the case of eigenvalue degeneracy in
  \Eq{eq:pertnondeg}.  This, too, is a textbook application of perturbation
  theory \cite{Sakurai1994}.  The procedure treats each degenerate
  subspace of $\mathcal J_0$ and chooses the eigenbasis such that it diagonalizes the perturbation within each of the subspaces.  There are up to four (only three in
  the one-dimensional LBE) such degenerate subspaces
  corresponding to the four discrete eigenvalues $-\{0, 1, 2, 3\}
  \times (\kn\tau)^{-1}$; we label these spaces $D_0$ through $D_3$.
  For each space, we define a projection operator
  \begin{equation}
    \label{eq:projection}
    P_l = \sum\limits_{\Xi_i \in D_l} \frac{\Xi_i \Xi_i^\trans}{\|\Xi_i\|^2}.
  \end{equation}
  We then diagonalize the perturbation operator $\mathcal C_s$ in each
  degenerate subspace in turn.  
  For the $l$th subspace, the
  first-order eigenvector perturbation is given by
  \begin{equation}
    \label{eq:pertdeg}
    P_l \Xi_i' = (\kn\tau)^2
    P_l \sum\limits_{j\neq i} \frac{\Xi_i}{\mu_j - \mu_i}
    \sum\limits_{k\notin D_l} \Xi_i^\trans \mathcal C_s \Xi_k
    \frac{1}{\lambda_{D_l} - \lambda_k} \Xi_k^\trans \mathcal C_s \Xi_j \ ,
  \end{equation}
  where the projection operator ensures that the degeneracy-breaking
  diagonalization of $\mathcal C_s$ is only performed within each
  degenerate subspace and $\mu_{i,j}$ are the eigenvectors of
  $\mathcal C_s$; between subspaces, \Eq{eq:pertnondeg} continues
  to apply.  The scaling of the terms in \Eq{eq:pertdeg} is
  familiar except for $\sum (\mu_j - \mu_i)^{-1}$.  This term
  needs careful examination because the smallest difference in
  eigenvalues of $\mathcal C_s$ is set by the smallest difference in
  scaled wavenumbers, which scales with the number of grid points as
  $n^{-1/D}$ in $D\in\{1,2,3\}$ spatial dimensions.  In the $n\gg 1$ limit, we can
  bound this factor by
  \begin{equation}
    \sum\limits_{j\neq i} \frac{1}{\mu_j - \mu_i} \propto
    \int\limits_{\vec{k}_i \neq \vec{k}_j} \frac{d^D\vec{k}_j}
    {\vert\vec{k}_j - \vec{k}_i\vert} \propto \int\limits_{k =
      O\left(n^{-\frac 1 D}\right)}^{O(1)} \frac{dk}{k} = O\left(\frac 1 D \log n\right).
  \end{equation}

  Combining the various factors, the degenerate perturbations to $\Xi_i$ are suppressed
  relative to the unperturbed eigenvectors (treating $D$ as a fixed
  value rather than a parameter of the problem) by $O((\kn\tau)^3\log
  n)$.  The nondegenerate perturbations are suppressed
  by $O((\kn\tau)^2)$.  The singular values of $\mathcal J$ are not
  necessarily smooth but can be evaluated from the eigenvalues of the
  square of $\mathcal J$, i.e., $\Sigma = {\mathcal{J}}^\dagger {\mathcal{J}}$.  We then have that \begin{equation}
        \|{\mathcal{J}}^\dagger {\mathcal{J}} - {\mathcal{J}_0}^\dagger {\mathcal{J}_0}\| \le (\|\mathcal{J}\| +\|\mathcal{J}_0\|)\|\mathcal{J} - \mathcal{J}_0\|.
  \end{equation}  This shows that the singular values remain smooth provided that $\mathcal{J}_0$ is non-singular and further  places
  the restrictions
  \begin{align}
    (\kn\tau)^2 \ll 1 \\
    \label{eq:kn-logn}
    (\kn\tau)^3 \log n \ll 1 
  \end{align}
  on the free parameters of the system.  The first condition is less
  restrictive than the $\kn\tau \ll 1$ condition the system must
  already satisfy, while the second is unlikely to be a practical
  impediment for reasonable values of $n$.

  Lastly, we need to bound the effect of the perturbation on
  $\|\mathcal J^{-1}\|$.  To accomplish this, we use the approximation
  \begin{equation}
    \mathcal J^{-1} \approx (\mathcal J_0 + \mathcal J')^{-1} = \mathcal
    J_0^{-1} + \mathcal J_0^{-1} \mathcal J' \mathcal J_0^{-1}
  \end{equation}
  where $\mathcal J' = \mathcal J - \mathcal J_0$ is the perturbation
  to the eigenvectors; since this perturbation scales as
  $O((\kn\tau)^2)$, the neglected terms in the expansion of the
  inverse scale as $O((\kn\tau)^4)$.  By the submultiplicative property
  of the spectral norm,
  \begin{equation}
    \|\mathcal J^{-1} - J_0^{-1}\| \le \|\mathcal J_0^{-1}\|^2 \|\mathcal J'\|.
  \end{equation}
 % Using $\|\mathcal J_0^{-1}\| = \|\mathcal J_0^{-1}\|$
  Using $\|\mathcal J_0^{-1}\|$
  from the block structure
  of $\mathcal C_c$ and $\max_i \vert \Xi_i'\vert = O((\kn\tau)^2)$ from
  \Eq{eq:vecnorm-xiprime} to bound $\|\mathcal J'\|$, we conclude that the
  $n$-point $\|\mathcal J^{-1}\|$ is also independent of $n$.
\end{enumerate}

\begin{figure}
  \centering
  \includegraphics[width=12cm]{spectral-plot-1} 
    \caption{Histograms of eigenvalue spectra $\mathcal{R}(\lambda)$ of 3rd-degree Carleman-linearized D1Q3, D2Q9, and
    D3Q27 LBM matrices.  Up to floating point error $<10^{-12}$ from the numerical
    diagonalization, the eigenvalues are all discrete multiples $-\{0, 1, 2, 3\}
  \times (\kn\tau)^{-1}$ of the Boltzmann relaxation scale $(\kn\tau)^{-1}$.
  Again up to numerical fuzz $<10^{-13}$, all eigenvalues are purely real.}
  \label{fig:spectral}
\end{figure}

\paragraph{Stability}

Matrix stability refers to $\mathcal{R}(\lambda)\leq 0$ and is a necessary
condition for the \citet{Berry2017QuantumPrecision} algorithm. We now show that
$\mathcal C$ satisfies that condition if the underlying physical system is linearly
stable.

Because of its block triangular structure (in Kronecker degree, not $\vec x$),
the eigenvalue problem for $\mathcal C$ reduces to finding the eigenvalues of the block-diagonal
(in Kronecker degree) elements: the transfer matrices
\begin{align}
  \mathcal A_1^1 - \mathcal B_1^1  =& \mathcal F^{(1)} - S \\
  \mathcal A_2^2 - \mathcal B_2^2 =& \IdnQ\otimes (\mathcal F^{(1)} - S) + 
                                    (\mathcal F^{(1)} - S) \otimes\IdnQ \\
  \mathcal A_3^3 - \mathcal B_3^3 =& \IdnQ^{(2)}\otimes (\mathcal F^{(1)} - S)
                                    \nonumber \\
  &+ \IdnQ\otimes (\mathcal F^{(1)} - S)\otimes\IdnQ \nonumber \\
  &+ (\mathcal F^{(1)} - S)\otimes\IdnQ^{(2)}.
\end{align}

Denote the eigenvectors and eigenvalues of $\mathcal F^{(1)} - S$ as $v_i$ and $\mu_i$
($i\in 1,\dots, nQ$).  It is trivial to show that the eigenvectors and eigenvalues
of $(\mathcal F^{(1)} -  S) \otimes \IdnQ$ and $\IdnQ \otimes (\mathcal F^{(1)} - S)$ are simply
$v^{(2)} = v \otimes v$ and $\mu^{(2)} = \mu_i + \mu_j$
($i,j\in 1,\dots, nQ$); similarly for $(\mathcal F^{(1)} - S) \otimes \IdnQ^{(2)}$, etc.
Therefore, if all eigenvalues of $(\mathcal F^{(1)} - S)$ are nonpositive, the eigenvalues of
$\mathcal C$ will also be nonpositive.

The stability of $\mathcal C$ is thus determined by the stability of
$\mathcal F^{(1)} - S$.  This is equivalent to a linear stability analysis on
the lattice Boltzmann system \cite{Sterling1996StabilityMethods}.  Linear
stability (or a stronger stability criterion) will be satisfied by any physical
system to which the quantum solver will be applied, as the simulation would be
physically nonsensical otherwise.

\paragraph{Evolution time}

The physical evolution time $\tilde T$ is imposed by the nature of the system
being simulated.  Physical and lattice evolution time are related by the
\citet{Sterling1996StabilityMethods} factor (\Eq{eq:scale-t}),
\begin{equation}
  \label{eq:evolutionT}
  T=\tilde T/\left(\frac{L}{e_r}\right).
\end{equation}


\subsubsection*{Final quantum gate complexity to solve \Eq{eq:clbm}}
Finally, inserting \Eq{eq:sparsity}--(\ref{eq:evolutionT}) into
\Eq{eq:ca} yields the following result for the quantum algorithm complexity as quantified by the number of two-qubit gates needed in the simulation:
\begin{equation}
  \label{eq:complong}
  \text{gate complexity} = O(\kn^{-1}e_r L^{-1}\tilde{T}\poly\log(n/\epsilon)),
\end{equation}
where $\tilde T$ is the physical evolution time, and $L$ and $e_r$ are characteristic
scales chosen for the LBE formalism. The scaling of each term in \Eq{eq:ca} is summarized in Table~\ref{tab:scaling}.
\begin{table}
  \centering
  \begin{tabular}{lll}
    \hline\hline
    Term & Scaling & Reference \\ \hline
    $\kappa_J$ & $\le 1.152\times 10^5$ &         \\
    $\|\mathcal C\|$    & $O(\kn^{-1})$ & \Eq{eq:normc}    \\
    $s$        & $O(1)$              &  \Eq{eq:sparsity} \\
    $g$        & $O(1)$                &  \Eq{eq:g}        \\
    $\beta$    & $O(1)$                &  \Eq{eq:beta}     \\
    \hline\hline
  \end{tabular}
  \caption{Scaling of each term in \Eq{eq:ca} with lattice Boltzmann equation parameters leading to the
    result of \Eq{eq:final-result}.  A reference to equation numbers
    for each term is provided in the Results. 
    }
  \label{tab:scaling}
\end{table}
\ifarXiv
\else
In the main text, \Eq{eq:complong}
is discussed in terms of the physical parameters of the turbulence
simulation problem.  
\fi

The solution error of using the quantum linear system algorithm (QLSA) of \citet{Berry2017QuantumPrecision} to solve \Eq{eq:LBMs} come from two sources: the Carleman truncation error and the QLSA error. Since the solution error from QLSA contributes $\text{poly}(\log(\epsilon)$ to the gate complexity expressed in \Eq{eq:ca}, we focus on bounding the Carleman truncation error, which is $O(\text{Ma}^2)$. For weakly compressible flow, $\text{Ma}\ll1$, therefore, the Carleman truncation error is very small. In \citet{Liu21}, a QLSA with gate complexity scales with $T^2$ was used due to their time dependent Carleman matrix. A time dependent Carleman matrix requires discretizing time using the forward Euler method, which contributes to the solution error. In contrast, our Carleman matrix $\mathcal{C}$ is constant, which affords us to use the QLSA of \citet{Berry2017QuantumPrecision} with a gate complexity scales with $T$ (\Eq{eq:ca}). Overall, our method of using QLSA to solve \Eq{turb} has yields a gate complexity scaling with $\poly(\log{N})$ and $T$ for any arbitrary Reynolds number comparing to \citet{Liu21}'s complexity scaling with $T^2$ for $\text{Re}<\sqrt{2}$.   


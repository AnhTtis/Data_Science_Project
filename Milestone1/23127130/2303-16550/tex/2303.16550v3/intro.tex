\ifarXiv
Complex systems exhibiting multiscale dynamics are ubiquitous in
nature. Developing the ability to understand, predict, or modify these systems
ranks among the ``grand challenges'' of science and engineering
\citep{Omenn2006,WCRP,NASEM2016}. 
Areas of application for this knowledge
include the Earth's ocean and atmosphere
\cite{Hasselmann1976,Majda2003,Bony2015,Ghil2020,Gupta2022}, 
biological
systems \cite{Bernaschi2019}, and synthesis of advanced materials
\cite{Boles2016,Salzmann2021,DeYoreo2015,DeYoreo2022,Russel}.  
The dynamics of these systems admits no analytic solution, but numerical
simulation needs to either parameterize the small-scale processes---which
introduces large uncertainties---or explicitly resolve the smallest
scales---which is prohibitively expensive. 
\fi

Turbulence as an example of nonlinear fluid dynamics embodies a defining feature of complex systems: the
lack of scale separation \cite{pope2000turbulent, Bodenschatz2010}. As all
scales interact with each other, they cannot be investigated individually.
Nonlinear fluid dynamics contribute to the multiscale behavior of many of the complex systems
mentioned above, including geophysical  \cite{Sherwood2014,Bretherton2015,Donner2016}, astrophysical, and many engineering
fluid dynamics applications.  Because the length and time
scales of the constituent processes can be a minute fraction of the integral
scale of the system (e.g., the turbulent length scale range is $\sim 10^{7}$ for
atmospheric flows), outright scale range-resolving simulations are simply not
feasible on classical computers \cite{Exascale2017,Schneider2017ClimateClouds}.  

Attempts to understand nonlinear fluid dynamics have centered on the Navier--Stokes equations
(NSE).  These equations describe the macroscopic momentum and density evolution
of fluids; multiscale interactions arise from the nonlinear advection term
$\vec{u}\cdot\nabla\vec{u}$ for the fluid velocity field $\vec{u(\vec{x},t)}$
in space $\vec{x}$ and time $t$ (see \Eq{turb} in Methods).  Approaches to solving the NSE
numerically include using ``reduced'' models that are based on
a proper orthogonal decomposition with key representative modes to mimic the
dynamics of the full spectrum \citep{berkooz1993proper,podvin2017few} and averaging over those scales not explicitly
resolved (e.g., with Reynolds averaging) and using a constitutive relation (e.g., eddy
viscosity) to close the Reynolds-averaged NSE
\citep{tennekes1972first, Durbin18}. Such
approaches parameterize the small-scale behavior based on the resolved-scale
state of the model, which produces tractable simulations at the expense of an
artificial scale separation.  This unavoidable model defect results in
persistent uncertainty in projections
of complex systems' emergent behaviors
\cite{Artime2022,Hasselmann1976,Feingold2016}, e.g., the sensitivity of the
climate to anthropogenic perturbations \cite{Wheatcraft1991,Carslaw2018,Muelmenstaedt2018,Ge2019,Sherwood2020,Bellouin2020,Moum2021}. 

A structurally different formulation of fluid dynamics exists in the form of the
Boltzmann equation.  This formulation describes the evolution of particle
distribution functions $f(\vec{x},\vec{v},t)$ in space and particle velocity
$\vec{v}$ (see \Eq{eq:LBMs} and \Eq{eq:feq} in Methods).  These distribution functions are mesoscopic objects that comprise sufficiently large
numbers of molecules for a statistical-mechanics treatment but that are smaller
than the macroscopic fluid elements.  The Boltzmann equation is still nonlinear (see
below), but in an important difference from the NSE, its
nonlinearity does not reside in the advection term \cite{Chen1998LatticeFlows}.
In classical time-marching spectral or spatial discretization algorithms, the
Boltzmann equation is even more prohibitively expensive than the NSE
\cite{Orszag1986}; in quantum computing algorithms, as we will show, the
trade-off goes the other way, largely due to the linear
Boltzmann advection term.

\leavevmode
\begin{figure}[t!]\begin{center}
% trim=left bottom right top  
%XY: for Science submission. For others, use the first line below.
%\begin{overpic}[width=0.75\textwidth]{PCSD_0590_ILLUS.3}\put(20,97){(a)}\put(49,91){(b)}\put(30,49){(c)}\put(20,15){(d)}\end{overpic}\end{center}
\begin{overpic}[scale=0.17]{PCSD_0590_ILLUS.3}\put(20,97){(a)}\put(49,91){(b)}\put(30,49){(c)}\put(20,15){(d)}\end{overpic}\end{center}
\caption{Illustration of the complexity of solving Navier--Stokes equations
using quantum algorithms: (a) Reynolds number-determined strongly nonlinear
Navier--Stokes equations; (b) Mach number-determined weak nonlinear
lattice Boltzmann form of Navier--Stokes equations; (c) Carleman-linearized lattice Boltzmann equation; (d) exponential quantum advantage in solving the Carleman-linearized lattice Boltzmann equation.
}
\label{PCSD_0590_ILLUS.3}
\end{figure}


\subsection{Requirements for Quantum Algorithm}
Whether the NSE or Boltzmann equation is chosen, explicit simulation of
fluid dynamics requires large numbers of degrees of freedom $N$.  In both spatial
and spectral discretization, $N$ reflects the ratio between the largest
and smallest scales, i.e., the integral system scale and the Kolmogorov scale.  
As quantum computers inherently grant the ability to manipulate vectors in
exponentially large vector spaces in polynomial time, one may ask whether such
methods could be used to solve fluid dynamics.

Harrow, Hassidim, and Lloyd~\cite{Harrow09} answer this question in
the affirmative for generic linear systems.  This vector manipulation
approach naturally leads to a strategy for achieving a potential
exponential speedup when solving systems of coupled ordinary differential equations~\cite{berry2014high, Berry2017QuantumPrecision}
\ifarXiv
.
\input{qlsa}

\else
(see Methods).
\fi
Taking the algorithm of \citet{Berry2017QuantumPrecision} as an example, the
overall algorithm complexity, as measured by the number of two-qubit quantum gates and oracle queries, depends on $\log N$, but also on numerous other
properties of the system of equations being solved (expressed through the
$N\times N$ coefficient matrix $\mathcal C$):
\begin{equation}
  \label{eq:ca}
  \text{gate complexity}=O(\Vert \mathcal C\Vert \kappa_J g T s\cdot \text{poly}(\log{(\kappa_J s g \beta T \Vert \mathcal C \Vert N/\epsilon)})).
\end{equation}
These properties include the spectral norm of the coefficient matrix $\|\mathcal C\|$, the condition
number $\kappa_J$ of the eigenvectors of $\mathcal C$, the dissipation parameter $g$, the
evolution time $T$, the sparsity $s$, the norm of the initial state $\beta$, and
the desired solution error $\epsilon$.  If any of $\|\mathcal C\|$, $\kappa_J$, $g$, $T$,
or $s$ has implicit
polynomial (or worse) dependence on $N$, or if
$\beta$ or $\epsilon$ has exponential (or worse) dependence on $N$, the
headline exponential advantage is negated.  

When the underlying system of equations is
nonlinear, the requirements for efficient
solution become more stringent still.  
The complexity of the best known quantum algorithm  that can be directly applicable to nonlinear differential
equations
is exponential in the evolution time $T$ \citep{leyton2008quantum}.
Alternatively, the nonlinear system
can first be approximated by a (larger)
system of linear equations
\cite{Lloyd2020QuantumEquations,Liu21}.
Whether the quantum algorithm is still
efficient after this approximation depends on
the degree of nonlinearity \cite{Liu21}.  The
nonlinearity of NSE is characterized by the
Reynolds number (see Methods).  Quantum
algorithms are unable to simulate NSE
\citep{Liu21} with $R \ge 1$\footnote{$R$ is a parameter characterizing the ratio of the nonlinearity and forcing to the linear dissipation and is analogous to the Reynolds number}, which
is far from the values in many relevant cases
(e.g., atmospheric turbulence
\citep{Siebert06,
Grabowski2013GrowthEnvironment} with $\re
\approx 10^7$). 

We will now analyze whether the Boltzmann form of fluid dynamics, after
linearization, can take advantage of quantum algorithms' efficient handling of large $N$
without violating these algorithms' strict requirements.
Our aim in this manuscript is not quantum algorithm development but, rather, 
showing that nonlinear fluid dynamics is tractable with existing quantum algorithms,
provided the Boltzmann formulation, rather than the NSE formulation, is used.



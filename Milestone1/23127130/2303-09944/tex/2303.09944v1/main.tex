\documentclass[%
 %reprint,
 twocolumn,
%superscriptaddress,
%groupedaddress,
%unsortedaddress,
%runinaddress,
%frontmatterverbose, 
%preprint,
%preprintnumbers,
%nofootinbib,
%nobibnotes,
%bibnotes,
 amsmath,amssymb,
 aps,
%pra,
prb,
%rmp,
%prstab,
%prstper,
%floatfix,
]{revtex4-2}

\usepackage{natbib,hyperref}

\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{bm}
\usepackage[dvipsnames]{xcolor}
\usepackage{epsfig}
\usepackage{amsfonts}
\usepackage{bbold}
%\usepackage{kbordermatrix}%
%%% NEW PACKAGES FOR THE TABLE  %%%%%
\usepackage{multirow} % Para las tablas
\usepackage{footnote}
\usepackage{blkarray}% http://ctan.org/pkg/blkarray
%\makesavenoteenv{tabular}
%\makesavenoteenv{table}
\usepackage[]{appendix}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\usepackage{cancel}
\usepackage[makeroom]{cancel}
\makeatletter
% #1, #2 offset of label   #6 extra width to clear arrowhead
% #3, #4 vector direction  #7 superscript label style
% #5 vector width          #8 superscript label
\def\cantox@vector#1#2#3#4#5#6#7#8{%
  \dimen@.5\p@
  \setbox\z@\vbox{\boxmaxdepth.5\p@
   \hbox{\kern-1.2\p@\kern#1\dimen@$#7{#8}\m@th$}}%
  \ifx\canto@fil\hidewidth  \wd\z@\z@ \else \kern-#6\unitlength \fi
  \ooalign{%
    \canto@fil$\m@th \CancelColor
    \vcenter{\hbox{\dimen@#6\unitlength \kern\dimen@
      \multiply\dimen@#4\divide\dimen@#3 \vrule\@depth\dimen@\@width\z@
      \vector(#3,-#4){#5}%
    }}_{\raise-#2\dimen@\copy\z@\kern-\scriptspace}$%
    \canto@fil \cr
    \hfil \box\@tempboxa \kern\wd\z@ \hfil \cr}}
\def\bcancelto#1#2{\let\canto@vector\cantox@vector\cancelto{#1}{#2}}
\makeatother
\usepackage[]{hyperref}
\usepackage{soul} % para tachar palabras

\newcommand{\ds}{\displaystyle}
\newcommand{\ome}{\omega}
\newcommand{\eps}{\epsilon}
% Special matrixes
\newcommand{\matindex}[1]{\mbox{\scriptsize#1}}% Matrix index
\newcommand{\jose}[1] {{\color{blue}{#1}}\color{black}\normalsize}
\newcommand{\tacha}[1] {{\color{blue}{{\textst{#1}}}}}
\newcommand{\nico}[1] {{\color{orange}{#1}}\color{black}\normalsize}
\newcommand{\chris}[1] {{\color{pink}{#1}}\color{black}\normalsize}

%% Citation commands
\newcommand{\expSTMESR}{~\cite{Baumann_Paul_science_2015,
Natterer_Yang_nature_2017,Choi_Paul_natnano_2017,Willke_Paul_sciadv_2018,Yang_Bae_prl_2017,
Willke_Bae_science_2018,Y_Bae_advanced_science_2018,Willke_Singha_nanolett_2019,
Willke_Yang_natphys_2019,Yang_Paul_prl_2019,yang_coherent_2019,Seifert_Kovarik_pr_2020,
Seifert_Kovarik_eabc_2020,
Weerdenburg_Steinbrecher_2020,Steinbrecher_Weerdenburg_2020,kim2021spin}}
\newcommand{\bias}{~\cite{Baumann_Paul_science_2015,
Natterer_Yang_nature_2017,Choi_Paul_natnano_2017,Willke_Paul_sciadv_2018,Yang_Bae_prl_2017,
Willke_Bae_science_2018,Y_Bae_advanced_science_2018,Willke_Singha_nanolett_2019,
Willke_Yang_natphys_2019,Yang_Paul_prl_2019,yang_coherent_2019}}
\newcommand{\microw}{~\cite{Seifert_Kovarik_pr_2020,Seifert_Kovarik_eabc_2020}}



\begin{document}


\title{Many-body non-equilibrium effects in all-electric electron spin resonance} 

\author{Jose Reina-G{\'{a}}lvez}
\email{galvez.jose@qns.science}
\affiliation{Center for Quantum Nanoscience, Institute for Basic Science (IBS), Seoul 03760, Korea}
\affiliation{Ewha Womans University, Seoul 03760, Korea}
\author{Christoph Wolf}
\email{wolf.christoph@qns.science}
\affiliation{Center for Quantum Nanoscience, Institute for Basic Science (IBS), Seoul 03760, Korea}
\affiliation{Ewha Womans University, Seoul 03760, Korea}
\author{Nicol{\'a}s Lorente}
\email{nicolas.lorente@ehu.eus}
\affiliation{Centro de F{\'{i}}sica de Materiales
        CFM/MPC (CSIC-UPV/EHU),  20018 Donostia-San Sebasti\'an, Spain}
\affiliation{Donostia International Physics Center (DIPC),  20018 Donostia-San Sebasti\'an, Spain}



\begin{abstract}
Motivated by recent developments in measurements of electron spin resonances of individual atoms and molecules with the scanning tunneling microscope (ESR-STM), we study electron transport through an impurity under periodic driving as a function of the transport parameters in a model junction. 
The model consists of a single-orbital quantum impurity connected to two electrodes via  time-dependent hopping terms. The hopping terms are treated at the lowest order in perturbation theory to recover a Lindblad-like quantum master equation with electron transport.
 As in the experiment, the ESR-STM signal is given by the variation of the long-time DC current with the driving frequency. The density-matrix coherences play an important role in the evaluation of the ESR-STM signal. 
Electron correlation is included in our impurity mode. The charging energy $U$ has significant influence on the spin dynamics depending on the sign and magnitude of the applied DC bias. Our model allows direct insight into the origin of the ESR signal from the many-body dynamics of the impurity. 

\end{abstract}

\date{\today}

\maketitle


\section{Introduction}

The use of time-dependent techniques in the scanning tunneling microscope
(STM) at GHz frequencies ushered in  the acquisition of electron-spin
resonances (ESR) with the STM\expSTMESR.  These developments
grant access to new phenomena thanks to the unprecedented high-energy
resolution of ESR combined with the subatomic precision of the STM.
Examples are the analysis of elusive atomic configurations on
surfaces by measuring the actual magnetic moment of f-electron atoms
\cite{Natterer_Yang_nature_2017}, or the determination of isotopes of
single adsorbates \cite{Willke_Bae_science_2018}.

The ESR-STM technique measures the direct current (DC) through a localized spin impurity, such as single atoms or molecules, in the STM junction as the tip-sample bias is periodically modulated. At a certain
modulation frequency, the DC current experiences a variation that can
be detected. The ESR spectra are values of the junction DC current as
a function of driving frequency, typically in the GHz ($\mu$eV) range. To drive the localized electron spin, a suitable alternating electric field is fed either directly to the tip\bias\  or to the entire sample via an antenna \cite{Baumann_Paul_science_2015,Willke_Paul_sciadv_2018}. 
The mechanism that couples the electric field to a local magnetic moment is not clear
and substantial effort has been devoted to
try to understand under what circumstances ESR is produced (for a recent review please refer to Ref. [\onlinecite{Delgado_Lorente_pss_2021}]).
Clarifying the origin of ESR in the STM is not only conceptually, but also practically important, because the full development of the ESR-STM technique
requires a high degree of control to acquire meaningful signals.

In the present work, we address the effect of the transport
parameters in the ESR signal. Understanding how
transport affects the signal yields key information
on the way the ESR is produced. In previous publications \cite{J_Reina_Galvez_2019,J_Reina_Galvez_2021},
we have shown that a time-dependent modulation of the tunneling matrix elements
between electrodes and impurity is sufficient to produce a sizable ESR
signal. It is well-known that electric fields efficiently modulate
these transfer matrix elements \cite{Jauho_Wingreen_1994,arrachea-moskalets-2006}, and in turn, this modulation drives
the spin~\cite{J_Reina_Galvez_2019,J_Reina_Galvez_2021}.
Moreover, the suggested adiabatic motion of the impurity in
the time-dependent electric field \cite{Baumann_Paul_science_2015,Lado_Ferron_prb_2017}
would only increase the tunneling modulation.
Our model is based on a transport description of the electron
current in the presence of driving via the modulation of the tunneling matrix
elements. We treat the spin degrees of freedom via a reduced density
matrix, which allows us to develop a quantum master equation for the transport process under driving and with quantum spins~\cite{J_Reina_Galvez_2021}.



\begin{figure}
\includegraphics[width=1.\linewidth]{./General_scheme.png}
\caption{(a) Scheme of the electron transport geometry for an impurity (here a  molecule) in a junction under an external drive given by the applied bias. In an ESR-STM setup, the left (L) and right (R) electrodes represent STM tip and substrate.
(b) The model used in our Hamiltonian representing the system in (a). A single orbital is connected via time-dependent hopping elements, $T_L(t)$ and $T_R(t)$, to the left
and right free-electron electrodes. Under an external magnetic field, the singly occupied spin up ($\uparrow$) and down ($\downarrow$) levels are split by
the Zeeman energy with Larmor or resonance frequency $f_0$. The orbital contains electron-electron correlation by the introduction of a charging
energy (or intra-orbital Coulomb repulsion) $U$.
}
\label{General_scheme}
\end{figure}


The article is organized as follows. In Sec.~\ref{sec_theory},
we summarize the model and the theoretical approach. In the present article, we put special emphasis
on clarifying the different equations and on how to treat the extended basis set to include electronic correlations under a finite charging energy $U$. We present the results of simulations with a set of parameters compatible with experimental ESR-STM setups in Sec.~\ref{Results}. The calculations explore
the behavior of the continuous wave (CW) ESR-STM signal (change in DC current as the driving frequency is changed) as a function of the DC bias. The results clearly show the role of the involved  states, the importance of having changing populations and coherences, as well as their influence
in the DC current that is ultimately the experimental observable. 
 The results corroborate the importance of coherent charge fluctuations to have a measurable signal in ESR-STM.


\section{Theoretical approach \label{sec_theory}}

%\subsection{Model \label{Model_Hamiltonian}}

Figure~\ref{General_scheme} shows a representative model of the type of system considered in this work. A central region that can be solved exactly is coupled via some hopping matrix elements to electron reservoirs. These hoppings need to be small compared to the typical energies of the central region in order to obtain a quantum master equation (QME) as will be shown in the following. We solve this QME in the long-time limit using Floquet's theorem that treats linear differential equations under a periodic drive~\cite{Grifoni_Hanggi_2021}. Finally in this section, we derive the equation for the time-dependent electronic current and for its DC component in this long-time limit.

\subsection{The model Hamiltonian}
The model for the full quantum system consists of a quantum impurity (a magnetic adsorbate, such as a single atom or molecule) tunnel-coupled to two electron reservoirs, see Fig. \ref{General_scheme}. The full system is described by
\begin{equation}\label{eq:ht}
H(t)=H_{\rm elec}+H_{\rm I}+H_{\rm T}(t),
\end{equation}
where the first term describes the two electrodes, the second term is
the impurity Hamiltonian and the third term is the tunneling Hamiltonian,
which is the only time-dependent one. The electrodes are
assumed to be described by one-electron states,
%spin-$1/2$ fermions,
\begin{equation}\label{eq:hres}
H_{\rm elec}=\sum_{\alpha k\sigma }\varepsilon_{\alpha k}c^{\dagger}_{\alpha k \sigma }c_{\alpha k \sigma },
\end{equation}
 $\alpha$ identifies the electrode ($\alpha=$ L,R), while $\sigma =\uparrow, \downarrow$ is the electron spin projection along the quantization axis and $k$ is its momentum. Each electrode is characterized by a chemical potential $\mu_{\alpha}$ such that the total DC bias is $eV_{DC}=\mu_L-\mu_R$. Following Ref.~\cite{J_Reina_Galvez_2021}, the quantum impurity consists of a single orbital with intra-orbital
correlation represented by the charging energy $U$. The impurity is subjected to
 an external magnetic field such that its Hamiltonian is given by
\begin{eqnarray}\label{eq:himp0}
H_{\rm I}= \sum_{\sigma} \varepsilon d^{\dagger}_{\sigma }d_{\sigma }
+U \hat{n}_{d \uparrow} \hat{n}_{d\downarrow} +g\mu_B \mathbf{{B}}\cdot\mathbf{\hat{s}},
\end{eqnarray}
where $\varepsilon$ is the orbital energy of the impurity, 
$U$ is the corresponding Coulomb repulsion, and $\hat{n}_{d\sigma}=d^{\dagger}_{\sigma}d_{\sigma}$ is the occupation operator of the orbital.   
Its spin operator, $\mathbf{\hat{s}}$ has components
$\hat{s}^j=\hbar\sum_{\sigma,\sigma'}d^{\dagger}_{\sigma} \hat{\sigma}^j_{ \sigma \sigma'}d_{\sigma'}/2$, where $\hat{\sigma}^j$ ($j=x,y,z$) are the Pauli matrices. The last term of Eq. (\ref{eq:himp0}) is the Zeeman contribution to the Hamiltonian.


The coupling between the impurity and the two reservoirs is described by the tunneling Hamiltonian 
\begin{equation}\label{eq:ht0}
H_{T}(t)=\sum_{\alpha k\sigma}\left(T_{\alpha }(t)c^{\dagger}_{\alpha k\sigma }d_{\sigma}+T_{\alpha  }^*(t)d^{\dagger}_\sigma c_{\alpha k\sigma }\right).
\end{equation}
The periodic drive is introduced by a time-dependent hopping, $T_{\alpha} (t)$, parameterized as: \begin{equation}
T_{\alpha  }(t)=T_{\alpha }^0 \left[1+A_{\alpha }\cos (\omega t) \right], \label{hopping}
\end{equation}
following Refs.~\cite{J_Reina_Galvez_2019,J_Reina_Galvez_2021}. This approximation captures the effect of the driving electric field on the electron transfer probability because of the changing tunneling barrier. Figure~\ref{Energy_Sch} (a) shows a simple scheme for the modulation of the transmission of the wave function across one of the barriers, under varying external electric field. Although not needed, the presence of piezoelectric effects~\cite{Phark} would enhance the tunneling modulation in the time-dependent electric field.

\begin{figure}
\centering 
\includegraphics[width=1.0\linewidth]{./Fig2.png}
\caption{(a) Barrier modulation represented here by two barriers at two different external electric fields. The transmitted wavefunction (given by the log of the density in thick orange and cyano curves) is much larger for one of the applied bias, illustrating the effect of the \textit{modulation of the hopping} that provides the electric-field coupling to the impurity spin. (b) Energy scheme of the quantum impurity. The four possible states are $|p\rangle=\uparrow, \downarrow, 2,\emptyset$. To simplify, we assume that the eigenstate basis $|l\rangle$ is, in first approximation, the same as the $|p\rangle$-basis. In order to be able to compare the energies of states with different number of electrons, we assume that the missing electrons are at the chemical potential of the electrodes at zero bias. The zero-electron state is  at zero energy.} 
\label{Energy_Sch}
\end{figure}

Tunneling modulation is very efficient in driving the spin. In Ref.~\cite{J_Reina_Galvez_2019}, we showed that the tunneling modulation directly enters the Rabi flip-flop rate in an effective two-level system where electrons hop in and out the impurity. Indeed, the tunneling modulation implies an effective change of state of the impurity due to charge transfer from the electrodes.

To formulate the problem in terms of the reduced density matrix, we consider all possible configurations for zero, one and two electrons in the impurity. Figure~\ref{Energy_Sch} (b) shows an energy diagram with the four possible eigenstates of the simplest spin-1/2 system. These configurations are $|p\rangle $ with $p=\uparrow, \downarrow, 2,\emptyset$. The first two account for one electron states while the third and forth are labelling the spin singlets with two and zero electrons, respectively. The impurity Hamiltonian in this basis is given by:
\begin{eqnarray}\label{eq:himp}
H_{\rm I}&=&\sum_{p}\varepsilon_{p} |p\rangle \langle p|+\frac{g\mu_B}{2}\left\{ (B_x+iB_y)|\downarrow\rangle\langle\uparrow|\right.\nonumber \\ 
\crcr
&&+\left. (B_x-iB_y)|\uparrow\rangle \langle\downarrow| \right\}
\end{eqnarray}
where $\varepsilon_{p}$ takes the values $\varepsilon_{\sigma}  =\varepsilon +g\mu_B B_z\sigma$ for $\sigma=\uparrow$ or $\downarrow$, $\varepsilon_{2}=2\varepsilon+U$ and $\varepsilon_\emptyset=0$.
The tunneling Hamiltonian in this $|p\rangle$ basis set is:
\begin{equation}\label{ht}
H_T(t)=\sum_{\alpha k \sigma}\left(T_{\alpha }(t)c^{\dagger}_{\alpha k\sigma } |\emptyset\rangle \langle \sigma|+ T_{\alpha }(t) c^{\dagger}_{\alpha k\sigma } |\bar{\sigma}\rangle \langle 2|  + h.c. \right) 
\end{equation}
where $\bar{\sigma}$ indicates the opposite to the $\sigma$ spin projection. 

Since the impurity Hamiltonian does not depend on time, we can use the eigenbasis of the impurity to describe the reduced density matrix. This eigenstate basis is given by
\begin{equation}
H_{\rm I} |l\rangle = E_{l} |l \rangle.
\label{l-basis}
\end{equation}
From now on, Latin characters ($l,j,u,v,\dots$) refer to eigenstates that are combined electronic and spin configurations of the impurity. Accordingly, we write $H_T(t)$ in terms of the Hubbard operators $|l\rangle   \langle   j|$
obtained from these impurity many-body eigenstates~\cite{Hewson_book_1997},
\begin{equation*}
H_T(t)=\sum_{\alpha k \sigma lj} \left(T_{\alpha }(t)c^{\dagger}_{\alpha k\sigma } \lambda_{l j\sigma} |l\rangle   \langle   j|  + h.c. \right),
\end{equation*}
that explicitly contains the matrix element that reflects the change of the many-body configurations of the impurity $j$ of $N+1$ electrons to $l$ of $N$ electrons:
\begin{equation}
    \lambda_{lj\sigma} = \langle l | d_\sigma |j\rangle=\langle l|\emptyset\rangle \langle \sigma |j \rangle+\langle l|\bar{\sigma}\rangle \langle 2| j \rangle.
    \label{landa}
\end{equation}

\subsection{The quantum master equation}
We derive the QME by treating the coupling between the impurity and the reservoirs to the lowest  order in perturbation theory in $H_T$  like in Refs. [\onlinecite{schoen-94,koenig-96-1,koenig-96-2,spletts-06,Esposito_Galperin_prb_2009,cava-09,Bibek_Bhandari_2021_nonequilibrium,J_Reina_Galvez_2021}]. This approximation amounts to the Born-Markov approximation \cite{rammer_2007,Dorn_2021}).
The reduced density matrix in the impurity eigenstate basis set is 
\begin{equation}\label{rho}
\rho_{lj} (t) = \mbox{Tr}\left[\hat{\rho}_{T} (t) |l\rangle\langle j| \right],
\end{equation}
with  the trace taken over all the degrees of freedom of the total system and $\hat{\rho}_{T} (t)$ the time-dependent density matrix of also the total system~\cite{J_Reina_Galvez_2021,Bibek_Bhandari_2021_nonequilibrium}. 

The QME for $\rho_{lj}(t)$ is 
\begin{eqnarray}
\hbar\dot{\rho}_{lj}(t)&-& i\Delta_{lj}\rho_{lj}(t)= \sum_{vu}\left\{\left[\Gamma_{vl,ju}(t)+\Gamma^*_{uj,lv}(t)\right] \rho_{vu}(t) \right. \nonumber \\
&-&\left.   \Gamma_{jv,vu}(t)\rho_{lu}(t)-\Gamma^*_{lv,vu}(t)\rho_{uj}(t)\right\},
\label{rho_master_eq_6_0}
\end{eqnarray}
where we have denoted $\Delta_{l,j}=E_l-E_j$. All indices ($l,j,v,u$) refer only to many-body eigenstates of the impurity Hamiltonian, $H_{\rm I}$. 

The above QME, Eq. (\ref{rho_master_eq_6_0}), is physically meaningful in the limit of weak coupling between impurity and electrodes. Here, weak means that the induced broadening of the impurity levels is smaller than the typical separation between levels, $\Delta_{l,j}$. In this way, we make sure that the dynamics induced by the electrode is a small perturbation of the intrinsic impurity dynamics. In this limit, the different approaches to obtain a linear equation in the reduced density matrix yield the same QME \cite{Timm}.
 

The rates $\Gamma(t)$ can be written as the sum of two contributions per electrode $\alpha$: 
\begin{equation}
\Gamma_{vl,ju}(t) =\sum_\alpha\left[ \Gamma_{vl,ju,\alpha}^{-}(t) + \Gamma_{vl,ju,\alpha}^{+}(t)\right].
\label{rate}
\end{equation}
 These rates can be expressed as
\begin{eqnarray}
	\Gamma_{vl,ju,\alpha}^{-}(t)&=&\frac{i}{2\pi}\sum_{\sigma}  \lambda_{vl\sigma}\lambda_{uj\sigma}^*
       \left(1+A_{\alpha }\cos (\omega t) \right) \gamma_{\alpha\sigma}  \nonumber\\
       &\times& \int^\infty_{-\infty} d \epsilon f_\alpha (\epsilon)\left(
       \frac{1}{\epsilon-\Delta_{ju}+i\hbar/\tau_c}  \right.\nonumber \\ &+&  \left.e^{i\omega t} \frac{A_\alpha/2}{\epsilon-\Delta_{ju}\hbar\omega+i\hbar/\tau_c} + \right.\nonumber\\ &+& \left. e^{-i\omega t} \frac{A_\alpha/2}{\epsilon-\Delta_{ju}-\hbar\omega+i\hbar/\tau_c}  \right)
	\label{rateT}
\end{eqnarray}
and
\begin{eqnarray}
	\Gamma_{vl,ju,\alpha}^{+}(t)&=&-\frac{i}{2\pi}\sum_{\sigma}  \lambda_{lv\sigma}^*\lambda_{ju\sigma}
       \left(1+A_{\alpha }\cos (\omega t) \right) \gamma_{\alpha\sigma}  \nonumber\\ &\times& \int^\infty_{-\infty} d \epsilon (1-f_\alpha (\epsilon))\left( \frac{1}{\epsilon+\Delta_{ju}-i\hbar/\tau_c}  \right.\nonumber \\ &+& e^{i\omega t} \frac{A_\alpha/2}{\epsilon+\Delta_{ju}+\hbar\omega-i\hbar/\tau_c}  \nonumber \\ &+& \left. e^{-i\omega t} \frac{A_\alpha/2}{\epsilon+\Delta_{ju}-\hbar\omega-i\hbar/\tau_c}  \right).
	\label{rateTle}
\end{eqnarray}
The Fermi occupation function is given by $f_\alpha(\epsilon)=1/\left(e^{\beta_\alpha(\epsilon-\mu_{\alpha})}+1\right)$  where $\beta_\alpha$ is the inverse temperature times the Boltzmann constant for electrode $\alpha$. Additionally, $\gamma_{\alpha\sigma}$ is the level broadening due to the hopping, $T^0_\alpha$, to electrode $\alpha$ for spin $\sigma$:
\begin{equation}\label{pol}
    \gamma_{\alpha\sigma}=2\pi D_{\alpha\sigma}|T^0_\alpha|^2,
\end{equation}
that depends on the spin-dependent density of states, given by 
\begin{equation}
D_{\alpha\sigma}=D_{\alpha}(1/2+\sigma P_\alpha).
\label{Pol}
\end{equation}
Here, $\sigma=\pm1/2$ and $P_\alpha$ is a real number between -1 and 1 giving the spin polarization of the electrode, and  $D_\alpha$ is
the density of states of the electrode at the Fermi energy.

The above rate expressions neglect the time-dependence of the electrodes \cite{J_Reina_Galvez_2021}. This approximation is valid when the AC amplitude is much smaller than the DC component of the bias, otherwise Eq. (\ref{rateT}) should include further Bessel functions to take into account the time-dependence of the electrode's Green's function~\cite{Jauho_Wingreen_1994,arrachea-moskalets-2006}. 

The physical interpretation of the rates is straightforward. The rates are proportional to $\gamma_{\alpha\sigma}$, Eq. (\ref{pol}), that is the usual broadening induced
by the hopping-matrix elements and the density of states of the electrodes. Whether the process involves electrons or holes is contained in the appearance of the Fermi occupation factors. The expressions given in Eqs. (\ref{rateT}) and (\ref{rateTle}) contain the $\lambda$ matrix elements that take in the right weights of each impurity state. Finally, the factors including the magnitude of the hopping modulation $A_\alpha$ take into account whether the electron-transfer process involves the absorption or emission of a photon from the microwave field. 

Finally, a finite $1/\tau_c$ improves the convergence of the Green's function. Its inclusion leads to a small renormalization (or Lamb shift) of the spectrum.

%A finite value of  $1/\tau_c$ leads to a Lamb shift in the spectrum. Further, $1/\tau_c$ also gives Rabi-flop rates that originate from the imaginary part of the rate that multiplies the coherences in the QME, Eq. (\ref{rho_master_eq_6_0}). In the long-time and on-resonance or sequential regime (level between the Fermi energies of the two electrodes), the Lamb shift is small compared to effects stemming from the decoherence \cite{J_Reina_Galvez_2021}.

%A finite value for  $1/\tau_c$ leads to imaginary parts in the rates multiplying the coherence terms in the QME, Eq. (\ref{rho_master_eq_6_0}) always resulting in a non-zero Rabi rate. Further, $1/\tau_c$ leads to a small re-normalization (or Lamb shift) in the spectrum. This effect is less noticeable in the on-resonance regime where broadening of the spectrum stemming from decoherence dominates.\cite{J_Reina_Galvez_2021} 


%A finite value of  $1/\tau_c$ (finite broadening) allows us to explore the transition between open and close channels, something not previously possible.\cite{J_Reina_Galvez_2021} Exploring the effects that  $1/\tau_c$ has on the simulation shows that the transition region from closed to open channel is particularly interesting as it provides low decoherence and strong Rabi oscillations, stemming from the imaginary part of the rates that multiply the coherence terms  in Eq (\ref{rho_master_eq_6_0}). The spectra also show a small but visible re-normalization (or Lamb shift). When the channel is fully open we found that decoherence effects dominate and the effects mentioned above no longer play an important role in the ESR signal. 

\subsection{The long-time limit}
The rate is periodic in time at a fixed drive of frequency $\omega/2 \pi$ and can be expanded in terms of Fourier components allowing us to 
express all equations in Floquet components. We introduce the Floquet index $n$ as the Fourier index of the rate~\cite{Grifoni_Hanggi_2021}:
\begin{eqnarray}
\Gamma_{vl,ju,\alpha}(t) &=&\sum_{n} e^{-in\omega t}\;\Gamma_{vl,ju,\alpha;n}(\omega).
\label{Rate_Floquet_form}
\end{eqnarray}
%


From Eqs. (\ref{rho_master_eq_6_0}) and (\ref{Rate_Floquet_form}), we can write the Floquet master equation,
%\begin{widetext}
\begin{eqnarray}
 \Delta_{lj}\rho_{lj;n}  &+& n\hbar \omega  \rho_{lj;n}= \nonumber \\
 i\sum_{vu; n'}\{[\Gamma_{vl,ju;n'}(\omega)&+&{\Gamma}_{uj,lv;-n'}^{*}(\omega)]\rho_{vu;n-n'} \nonumber \\
 -{\Gamma}_{lv,vu;-n'}^{*}(\omega)\rho_{uj;n-n'}&-& \Gamma_{jv,vu;n'}(\omega)\rho_{lu;n-n'}\}.
\label{rho_master_eq_Floquet}
\end{eqnarray}

\subsection{Expressions for the electronic current}
 
The  current flowing out of electrode $\alpha$ is defined as $I_{\alpha}=-e\frac{d\langle N_{\alpha}\rangle}{dt} $. This translates
into the usual Meir-Wingreen formula \cite{meir_wingreen_prl_1992}, where
now the matrix elements of all quantities appear in terms of  many-body eigenstates, $l,j,u$ (see Ref.~\cite{J_Reina_Galvez_2021}):
\begin{equation}
I_{\alpha}(t)=
\frac{2e}{\hbar}\sum_{lju} \mbox{Re} \left\{\rho_{lu}(t) \left[ \Gamma_{lj,ju,\alpha}^{-}(t) - \Gamma_{lj,ju,\alpha}^{+}(t)\right] \right\}.
\label{current_t}
\end{equation}
Using $I_L=-I_R$, we symmetrize the current by making $I=(I_{L}+I_L)/2=(I_{L}-I_R)/2$ and the above expression can be rewritten as
\begin{eqnarray}
I(t)=
-\frac{2e}{\hbar}\sum_{lju} \mbox{Re}&& \left\{\rho_{lu}(t) \left[ \Gamma_{lj,ju,R}^{-}(t) + \Gamma_{lj,ju,L}^{+}(t) -\right.\right. \nonumber \\ 
&&\left.\left. \Gamma_{lj,ju,L}^{-}(t)-\Gamma_{lj,ju,R}^{+}(t) \right] \right\}.
\label{current_sym}
\end{eqnarray}
This expression differs from previous approaches  because it now contains the contribution of the coherences of the density matrix not only the populations \cite{Rossier_prl_2009,Delgado_Rossier_prb_2010,Yinan_Choi_2021}. 
We will show that under certain conditions the coherences are crucial for the correct calculation of the ESR signal.

Since CW ESR-STM experiments measure the DC current in the long-time limit, we express it in Floquet components as:

\begin{eqnarray}
I(\omega)=
-\frac{2e}{\hbar}&&\sum_{lju;n'} \mbox{Re}  \bigg\{\rho_{lu;-n'}(\omega) \times \nonumber\\  && \left[ \Gamma_{lj,ju,R;n'}^{-} + \Gamma_{lj,ju,L;n'}^{+} -\right. \nonumber \\ 
&&\left. \Gamma_{lj,ju,L;n'}^{-}-\Gamma_{lj,ju,R;n'}^{+} \right]  \bigg\}.
\label{Current_floquet_simp}
\end{eqnarray}

Finally, let us emphasize that the full description based on a QME
is possible when keeping to the lowest order in the hopping terms. This order is
sufficient when the impurity level lies within the two Fermi levels. However, outside this
bias window, higher-order terms may become comparable to or larger than
the lower-order term. These higher-order terms contain sums over intermediate
states opening the possibility to co-tunneling processes 
and to Kondo scattering (see for example Ref. \cite{J_Reina_Galvez_2019} and \cite{Korytar2011,DJ2017}). In the present approach these processes are absent.


\input{Resultados_2}




\section{Summary and conclusions}

This work explores the ESR signal in the DC current through a quantum impurity connected to two electron reservoirs under bias. The model is intended to reproduce the conditions of ESR-STM, where the applied bias contains a DC component and a AC component usually in the GHz frequency range. We extend previous work~\cite{J_Reina_Galvez_2021} to include finite intra-atomic correlation, and we show its impact on the DC-bias dependence of the ESR signal. Our theory is based on a Linblad-like QME that was obtained by keeping the modulation of the tunneling matrix element to lowest order. This limits the transport regime to the sequential or on-resonance one. This situation seems to be similar to transition-metal impurities, molecules, or alkali metal dimers that have s-electrons close to the Fermi energy of the substrate~\cite{Jinkyung_Hyperfine_2022, zhang_electron_2022, kovarik_electron_2022,Kawaguchi_2022}. We only treat spin-1/2 systems in the present study but the extension to larger spin systems can be achieved with relative ease.

The addition of the impurity charging energy, $U$, breaks the electron-hole symmetry of the system. This has wide ranging implications for the transport when taking into account the opening and closing of different transport channels as the applied DC bias varies.
As a consequence, spin-1/2 systems such as the ones of Refs.~\cite{Jinkyung_Hyperfine_2022, zhang_electron_2022, kovarik_electron_2022,Kawaguchi_2022} should exhibit a bias-sign dependence of the ESR signal in the experiment. 
%, their change is somewhat different from the one shown in our model, indicating that additional transport channels might contribute in the experiment. 

%show clear bias-sign differences on the ESR signal that imply a very different sequence of opening and closing channels with the DC bias due to the charging properties of the impurity as discussed in this work.

%Although the dynamics of the state populations are fundamental to the calculation of the electronic current, they only play an indirect role in the ESR signal.

Our work highlights the importance of properly including the complete reduced density matrix in the calculation of the ESR signal. In the open-channel case, we found that the ESR signal is proportional to the coherences or off-diagonal elements of the density-matrix. However, in the closed-channel region, the diagonal elements or populations play a significant role. Therefore, the ESR-induced change in the DC current can be indicative of coherences or population changes of the system depending on the transport regime. 
 
 The present theory is based on a charge-fluctuation description where the impurity charge is changing during the electron transport process, and the fluctuations induce the spin-flip processes that in turn lead to the  ESR-signal as long as driving and polarization are maintained. Our results emphasize  the need to correctly treat the coherent charge fluctuation and include the coherence in the description of the full transport processes, not only for the evaluation of the impurity's population but also in the equation of the electron current.
 





%\vspace*{-1.05cm}
\begin{acknowledgments}
We are pleased to thank our collaborators for important discussions. A non-exhaustive list of the
many contributors to our discussions is:
L. Arrachea,
D.-J. Choi,
F. Delgado,
F. Donati,
J.-P. Gauyacq,
A. J. Heinrich,
S.-H. Phark.\\
\newline
This work was supported by the Institute for Basic Science (IBS-R027-D1). Further financial support from projects RTI2018-097895-B-C44 and PID2021-127917NB-I00 funded by MCIN/AEI/10.13039/501100011033 is gratefully acknowledged. Funded by the European Union. Views and opinions expressed are however those of the author(s) only and do not necessarily reflect those of the European Union. Neither the European Union nor the granting authority can be held responsible for them. 
\end{acknowledgments}



%\bibliographystyle{naturemag}
\bibliographystyle{apsrev}
\bibliography{references.bib}
%%\printbibheading
%%\printbibliography


\end{document}



\begin{tikzpicture}
    % Workspace modification
    \node [draw,
        text width=8em, fill=blue!20, text centered,
        minimum height=5em, rounded corners
    ]  (obs_trans) at (0,0) {Workspace\\ modification};
    % Path generator
    \node [draw,
        text width=8em, fill=blue!20, text centered, 
        minimum height=5em, rounded corners,
        right=5em of obs_trans
    ] (path_gen) {Reference path\\ generation};
    % Motion controller 
    \node [draw,
        text width=8em, fill=blue!20, text centered, 
        minimum height=5em, rounded corners,
        right=3em of path_gen
    ] (controller) {Tunnel-following MPC};
    % Robot block
    \node [draw,
        text width=5em, fill=white!20, text centered, 
        minimum height=3em, rounded corners,
        below=3em of path_gen
    ]  (robot) {Robot};
    % Scene input
    \node [left=2em of obs_trans](scene){};
    \node [below=1em of path_gen](x){};
    \node [right=1em of controller](u){};
    \node [above=1.5em of controller](rho){};
    % Arrows with text label
    \draw[-stealth] (scene.center) -- (obs_trans.west) 
        node[near start,above]{$\mathcal{O}, p^g$};
    \draw[-stealth] (obs_trans.east) -- (path_gen.west) 
        node[midway,above,text width=5em,text centered]{$\mathcal{O}^{\star}, r^0, r^g$};
    \draw[-stealth] (path_gen.east) -- (controller.west) 
        node[midway,above]{$\mathcal{P}$};
    \draw[-] (controller.east) -- (u.center)
        node[near end,above]{$u$};
    \draw[-stealth] (u.center) |- (robot.east);
    % \draw[-] (controller.east) -- ++ (.5,0) 
    %     node[](u_node){}node[midway,above]{$u$};
    \draw[-] (robot.north) -- (x.center)
        node[midway,left]{$x$};
    \draw[-stealth] (x.center) -| (controller.south);
    \draw[-stealth] (x.center) -| (obs_trans.south);
    \draw[-] (obs_trans.north) |- (rho.center)
        node[near start,right]{$\rho$};
    \draw[-stealth] (rho.center) -- (controller.north);
    % \draw[-] (workspace.west) -| (scene_node.center) 
        % node[near start,above]{$\mathcal{O}, x, x_g$};
    \end{tikzpicture}
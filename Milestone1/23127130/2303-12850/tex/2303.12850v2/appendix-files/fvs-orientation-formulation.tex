% \subsection{Orientation based Formulation}\label{sec:orientation-formulation}
In this section, we give another polynomial-sized ILP for FVS whose LP-relaxation has integrality gap at most $2$. This ILP is based only on orientation constraints and does not require cycle cover constraints (in contrast to the ILP presented in Section \ref{sec:orientation-and-cycle-cover-formulation}). We consider the following formulation and denote it as the (\textsc{FVS-IP: Complete-Orient}):
\begin{align}
\min & \sum_{u\in V} c_u x_u \nonumber\\
x_v + x_w + y^{f}_{e, v}+y^f_{e, w}&\ge 1\ \forall\ e=vw\in E, f\in E \label{constraint:orientation}\\
x_v+\sum_{e=vw\in E}y^f_{e,w}&\ge 1\ \forall\ v\in V, f\in E \label{constraint:load}\\
\sum_{v\in V-\{a,b\}}x_v + \sum_{e=vw\in E-\{f\}}(y^f_{e,w}+y^f_{e,v})&\le |V|-2\ \forall\ f=ab\in E \label{constraint:cumulative}\\
x_u&\ge 0\ \forall u\in V \label{constraint:x-nonnegative}\\
y^f_{e,v}&\ge 0\ \forall e\in\delta(v), v\in V, f\in E \label{constraint:y-nonnegative}\\
x_u&\in \Z\ \forall u\in V \nonumber\\
y^f_{e,v}&\in \Z\ \forall e\in\delta(v), v\in V, f\in E. \nonumber
\end{align}


\Cref{thm:poly-sized-LP-with-integrality-gap-atmost-2-for-FVS} follows from the following lemma. 

%\commentop{Chandra: Can we move the formulation to outside the lemma statement? Describe it, give it a name and then state the Lemma saying that the integrality gap of the named LP is at most 2?}
\begin{lemma}\label{lemma:strong-density-orientation-lp}
For an input graph $G=(V, E)$ with non-negative vertex costs $c:V\rightarrow \R_{\ge 0}$, 
(\textsc{FVS-IP: Complete-Orient}) is an integer linear programming formulation for FVS. Moreover, its LP-relaxation has integrality gap at most $2$.  
\end{lemma}
\begin{proof}
Let $x$ be the indicator vector of a feedback vertex set $S$ of $G$. 
We show that there exists a binary vector $y$ satisfying the constraints. Let $T$ be a spanning tree of $G$ containing all edges of $G$ that are not incident to vertices in $S$. 
Fix an edge $f=ab\in E$. 
For each vertex $v\in V\setminus (S\cup \{a, b\})$, set $y^f_{e,w}=1$ where $e=vw$ is the first edge on the unique path from $v$ to $a$ in $T$. Moreover, set $y^f_{f,a}=y^f_{f,b}=1$ and all other $y^f$ variables to $0$. We prove that this choice of $y$ satisfies all constraints. 

For an edge $e=vw\in E$, if $|S\cap \{v,w\}|\ge 1$, then $x_v+x_w\ge 1$ and if $v, w\not\in S$, then $e\in T$ and consequently, either $y_{e,v}^f=1$ or $y^f_{e,w}=1$ and hence, the constraint $x_v + x_w + y^{f}_{e, v}+y^f_{e, w}\ge 1$ holds. For a vertex $v\in V$, if $v\in S$, then $x_v\ge 1$ and if $v\in V-S$, then there exists an edge $e=vw\in T$ and hence, $y^f_{e,w}=1$ and consequently, the constraint $x_v+\sum_{e=vw\in E}y^f_{e,w}\ge 1$ holds. It remains to show that the constraint $\sum_{v\in V-\{a,b\}}x_v + \sum_{e=vw\in E-\{f\}}(y^f_{e,w}+y^f_{e,v})\le |V|-2$ holds. By the choice of $x$, it suffices to show that $|S\setminus \{a, b\}| + \sum_{e=vw\in T-\{f\}}(y^f_{e,w}+y^f_{e,v})\le |V|-2$ holds. By the choice of $y^f$, it suffices to show that $|S\setminus \{a, b\}| + \sum_{e=vw\in T}(y^f_{e,w}+y^f_{e,v})\le |V|$. Simplifying this further, it suffices to show that 
\[
\sum_{e=vw\in T}(y^f_{e,w}+y^f_{e,v})\le |(V-S)\cup\{a, b\}|.
\]
We note that $\sum_{e=vw\in T}(y^f_{e,w}+y^f_{e,v}) = \sum_{v\in V}(\sum_{e=vw\in T}y^f_{e,w})$. Hence, it suffices to show that 
\[
\sum_{v\in V}\left(\sum_{e=vw\in T}y^f_{e,w}\right) \le |(V-S)\cup\{a, b\}|.
\]
We have the following four inequalities:
\begin{align*}
\sum_{e=vw\in T}y^f_{e, w}&\le 1\ \forall v\in V-(S\cup \{a, b\}),\\
\sum_{e=vw\in T}y^f_{e, w}&= 0\ \forall v\in S-\{a, b\},\\
\sum_{e=aw\in T}y^f_{e, w}&= y^f_{e,b}=1, \text{ and}\\
\sum_{e=bw\in T}y^f_{e, w}&= y^f_{e,a}=1.
\end{align*}
Hence, $\sum_{v\in V}\left(\sum_{e=vw\in T}y^f_{e,w}\right) \le |(V-S)\cup\{a, b\}|$. 

Next, we show that an integral solution to the system of inequalities (\ref{constraint:orientation}), (\ref{constraint:load}), (\ref{constraint:cumulative}), (\ref{constraint:x-nonnegative}), and (\ref{constraint:y-nonnegative}) is the indicator vector of a feedback vertex set. 
%and bound the integrality gap of the LP-relaxation. 
We will use the following claim. 
%for both. 
\begin{claim}\label{claim:orientation-constraints-imply-strong-density}
Constraints (\ref{constraint:orientation}), (\ref{constraint:load}), (\ref{constraint:cumulative}), (\ref{constraint:x-nonnegative}), and (\ref{constraint:y-nonnegative}) imply the strong density constraints. 
\end{claim}
\begin{proof}
Let $(x, y)$ be a solution satisfying constraints (\ref{constraint:orientation}), (\ref{constraint:load}), (\ref{constraint:cumulative}), (\ref{constraint:x-nonnegative}), and (\ref{constraint:y-nonnegative}). Let $S\subseteq V$ such that $E[S]\neq \emptyset$. We will show that 
\[
\sum_{u\in S}(d_S(u)-1)x_u \ge |E[S]|-|S|+1.
\]
Equivalently, we will show that 
\[
|E[S]|-|S| - \sum_{u\in S}(d_S(u)-1)x_u \le -1.
\]
Let us rewrite the LHS as
\[
|E[S]|-|S| - \sum_{u\in S}(d_S(u)-1)x_u = \sum_{vw\in E[S]} (1-x_v-x_w) + \sum_{v\in S}(x_v-1).
\]
Let us inspect each sum separately. Fix an arbitrary $f=ab\in E[S]$. We have that 
\begin{align*}
\sum_{vw\in E[S]} (1-x_v-x_w) 
&= \sum_{vw\in E[S]} \left(1-x_v-x_w-y^f_{e,w}-y^f_{e,v}\right) + \sum_{vw\in E[S]} \left(y^f_{e,v} + y^f_{e,w}\right)\\
&\le 1-x_a-x_b-y^f_{f,a}-y^f_{f,b}+\sum_{vw\in E[S]} \left(y^f_{e,v} + y^f_{e,w}\right)
\end{align*}
where the inequality follows from (\ref{constraint:orientation}) and the fact that $f=ab\in E[S]$. We also have that 
\begin{align*}
\sum_{v\in S}(x_v -1) 
&= \sum_{v\in S} \left(x_v -1 +\sum_{e=vw\in E}y^f_{e, w}\right) - \sum_{v\in S}\sum_{e=vw\in E} y^f_{e,w}\\
&\le \sum_{v\in V} \left(x_v -1 +\sum_{e=vw\in E}y^f_{e, w}\right) - \sum_{v\in S}\sum_{e=vw\in E} y^f_{e,w}
\end{align*}
where the last inequality follows from (\ref{constraint:load}). Before adding the two upper bounds, we also note that 
\[
\sum_{vw\in E[S]} \left(y^f_{e,v} + y^f_{e,w}\right) - 
\sum_{v\in S}\sum_{e=vw\in E} y^f_{e,w}
\le 0
\]
by (\ref{constraint:y-nonnegative}). 
Hence, 
\begin{align*}
\sum_{vw\in E[S]} (1-x_v-x_w) + \sum_{v\in S}(x_v -1) 
&\le 1-x_a-x_b-y^f_{f,a}-y^f_{f,b}+\sum_{v\in V} \left(x_v -1 +\sum_{e=vw\in E}y^f_{e, w}\right) \\
&= 1 - |V| + \sum_{v\in V-\{a, b\}}x_v + \sum_{vw\in E-\{f\}}(y^f_{e,v}+y^f_{e,w})\\
&\le -1
\end{align*}
where the last inequality follows from (\ref{constraint:cumulative}). 
\end{proof}
By the results of Chudak, Goemans, Hochbaum, and Williamson \cite{CHUDAK1998111}, every integral solution satisfying strong density constraints corresponds to the indicator vector of a feedback vertex set. Thus, by Claim \ref{claim:orientation-constraints-imply-strong-density}, an integral solution to the system of inequalities (\ref{constraint:orientation}), (\ref{constraint:load}), (\ref{constraint:cumulative}), (\ref{constraint:x-nonnegative}), and (\ref{constraint:y-nonnegative}) is the indicator vector of a feedback vertex set. This completes the proof that the formulation given in the lemma is indeed an integer linear programming formulation for FVS. 

Finally, we bound the integrality gap of the LP-relaxation. By the results of Chudak, Goemans, Hochbaum, and Williamson \cite{CHUDAK1998111}, we know that (\ref{FVS-IP: SD})
%$\min\{\sum_{u\in V} c_u x_u: x\in \strongdensitypolyhedron(G)\cap \Z^V\}$ 
is an ILP formulation for FVS and the integrality gap of its LP-relaxation 
(\ref{FVS-LP: SD}) 
%$\min\{\sum_{u\in V} c_u x_u: x\in \strongdensitypolyhedron(G)\}$ 
is at most $2$. 
We have already shown that the ILP in the lemma statement is a valid formulation for FVS. 
By Claim \ref{claim:orientation-constraints-imply-strong-density}, the LP-relaxation of the ILP in the lemma statement has integrality gap at most $2$.  
\end{proof}

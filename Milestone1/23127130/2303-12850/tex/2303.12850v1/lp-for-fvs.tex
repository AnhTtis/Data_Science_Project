\section{Polynomial-sized LP-relaxations for FVS with integrality gap at most $2$}\label{sec:poly-sized-lp-relaxation-with-gap-atmost-two-for-fvs}
In this section, we prove \Cref{thm:poly-sized-LP-with-integrality-gap-atmost-2-for-FVS} by giving three polynomial-sized LP-relaxations for FVS with integrality gap at most $2$. Our first formulation is based on orientation and cycle cover polyhedra and we show that its LP-relaxation is at least as strong as (\ref{FVS-LP:weak-density-cycle-cover}). Our second formulation is Chekuri-Madan's formulation specialized for FVS and we show that its LP-relaxation is at least as strong as our first formulation. The strength of these formulations along with \Cref{thm:integrality-gap-wd+cycle-cover} imply that the integrality gap of the LP-relaxation of these two formulations is at most $2$. Our third formulation is based only on orientation constraints (without relying on cycle cover constraints). We show that its LP-relaxation is at least as strong as that of the strong density constraints based formulation. Since we know that the LP-relaxation of the strong density constraints based formulation has integrality gap at most $2$ (as shown by \cite{CHUDAK1998111}), the integrality gap of the LP-relaxation of our third formulation is also at most $2$.   

\subsection{Orientation and Cycle Cover based Formulation}
\label{sec:orientation-and-cycle-cover-formulation}
In this section, we give a polynomial-sized ILP for FVS based on orientation and cycle cover constraints. Moreover, we show that the integrality gap of the LP-relaxation of this formulation is at most $2$. 
Our ILP is based on the following lemma.
\begin{lemma}\label{lemma:integrality-gap-orient-intersect-cycle-cover}
The following is an integer linear programming formulation for FVS for a graph $G=(V, E)$ with non-negative vertex costs $c: V\rightarrow \R_{\ge 0}$: 
\[
\min\left\{\sum_{u\in V}c_u x_u: x\in \projectedorientationpolyhedron(G)\cap \cyclecoverpolyhedron(G)\cap \Z^V \right\}.
\]
Moreover, its LP-relaxation has integrality gap at most $2$. 
\iffalse
Let $G=(V, E)$ be a graph with non-negative costs $c:V\rightarrow \R_{\ge 0}$. 
The following is an LP-relaxation for FVS with integrality gap at most $2$ 
\[
\min\left\{\sum_{u\in V}c_u x_u: x\in \projectedorientationpolyhedron(G)\cap \cyclecoverpolyhedron(G)\right\}.
\]
\fi
\end{lemma}
\begin{proof}
The indicator vector $x$ of a feedback vertex set of $G$ is contained in $\projectedorientationpolyhedron(G)\cap\cyclecoverpolyhedron(G)$. Moreover, every integral solution $x\in \projectedorientationpolyhedron(G)\cap\cyclecoverpolyhedron(G)$ is the indicator vector of a feedback vertex set: since $x\in \projectedorientationpolyhedron(G)\cap \Z^V$, we have that $x\in \{0,1\}^V$ and since $x\in \cyclecoverpolyhedron(G)$, we have that $x$ is the indicator vector of a feedback vertex. 

We now show that the integrality gap of the LP-relaxation is at most $2$. 
By Lemma \ref{lemma:orientation-formulation}, $\projectedorientationpolyhedron(G)\subseteq \weakdensitypolyhedron(G)$ and hence, the integrality gap of the LP-relaxation is at most the integrality gap of (\ref{FVS-LP:weak-density-cycle-cover}). By Theorem \ref{thm:integrality-gap-wd+cycle-cover}, the integrality gap of (\ref{FVS-LP:weak-density-cycle-cover}) is at most $2$. 
\end{proof}


%Our goal is to obtain a polynomial-sized LP-relaxation with integrality gap at most $2$ for FVS based on \Cref{lemma:integrality-gap-orient-intersect-cycle-cover}. 
%We know that $\projectedorientationpolyhedron(G)$ can be expressed using polynomial number of variables and constraints (see the description of $\orientationpolyhedron(G)$). 

\Cref{thm:poly-sized-LP-with-integrality-gap-atmost-2-for-FVS}  follows from \Cref{lemma:integrality-gap-orient-intersect-cycle-cover} and \Cref{lemma:cycle-cover-poly-sized-lp} and by observing that  $\projectedorientationpolyhedron(G)$ can be expressed using polynomial number of variables and constraints (see the description of $\orientationpolyhedron(G)$).


\subsection{Chekuri-Madan's Formulation}
In this section, we show that the polynomial-sized ILP for FVS given by Chekuri and Madan is such that its LP-relaxation has integrality gap at most $2$. Chekuri and Madan formulated a polynomial-sized ILP for the more general problem of Subset Feedback Vertex Set (SFVS). SFVS is defined as follows: The input is a graph $G=(V, E)$ with non-negative vertex costs $c: V\rightarrow \R_{\ge 0}$ along with a  set of terminals $T\subseteq V$. A subset $U$ of non-terminals is said to be a subset feedback vertex set if $G-U$ has no cycle containing a vertex of $T$. 
The goal is to find a least cost subset feedback vertex set. We will discuss Chekuri-Madan's ILP for SFVS with some background and notation in Section \ref{sec:CM-LP}, specialize it to FVS in Section \ref{sec:reduction-from-FVS-to-SFVS}, and show that the integrality gap of its LP-relaxation is at most $2$ in Section \ref{sec:cm-lp-integrality-gap}. 
%of this LP-relaxation by showing that the LP constraints imply orientation and cycle cover constraints. Consequently, the integrality gap of their LP-relaxation is at most that of $\min\{\sum_{u\in V} c_ux_u: x\in \projectedorientationpolyhedron(G)\cap \cyclecoverpolyhedron(G)\}$ which is at most $2$ by \Cref{lemma:integrality-gap-orient-intersect-cycle-cover}. 

\subsubsection{Chekuri-Madan's ILP for SFVS}
\label{sec:CM-LP}
In this section, we discuss Chekuri-Madan's ILP for SFVS. Let $H = (V_H, E_H)$ denote the input graph, $S_H\subseteq V_H$ denote the terminal set, and $c_H:V_H\rightarrow \mathbb{R}_{\ge 0}$ denote the vertex cost function. We will say that a cycle is \emph{interesting} if it contains a terminal. Let $\calC_H$ denote the set of interesting cycles in the graph $H$.

Henceforth, we will assume that a SFVS of finite cost exists in the graph $H$. Furthermore, we will assume without loss of generality that the instance $H$ satisfies the following properties (see \cite{chekuri-madan16} for a justification of these assumptions): 
\begin{enumerate}[label=(\roman*)]
\item the graph $H$ is connected, 
\item each terminal $s_i \in S_H$
has infinite cost, is a degree two vertex with
neighbors $a_i, b_i$ having infinite cost, 
\item no two terminals
are connected by an edge or share a neighbor, 
\item there
exists a special non-terminal degree one vertex $r\in V$ with
infinite cost, and 
\item each interesting cycle contains at
least two terminals.
\end{enumerate} 

\paragraph{Notation.} Throughout this section we will use the following notation: We let $k = |S_H|$ denote the number of terminals. We refer to the set $P_i := \{a_i, b_i\}$ as the \emph{pivot set} for the terminal $s_i$, and the set $P_H = \cup_{i \in [k]}P_i$ as the set of all pivots. We define the set 
\[
\ell_H(u) = \{i\in [k]: \text{$s_i$ is reachable from $u$  via a path not containing any other terminals}\} \cup \{k+1\} 
\]
as the set of \emph{labels} for each vertex $u \in V_H \backslash S$. We denote $\Tilde{V}_H$ as the set of vertices in $V_H$ that are not in $S_H \uplus P_H \uplus \{r\}$. We denote $\Tilde{E}_H$ as the set of edges in $E_H$ that are not incident to any terminals and the set $E'_H$ as the set of edges incident to terminals. We will refer to $E'_H$ as special edges. 
%Finally, for each $u \in V_H \backslash S$, we define the set $\ell_H(u) = \{i\in [k]: \text{$s_i$ is reachable from $u$  via a path not containing any other terminals}\} \cup \{k+1\}$ as the set of \emph{labels} for vertex $u$. 

\paragraph{Chekuri-Madan's ILP.} See \Cref{fig:CM-lp-SFVS} for Chekuri-Madan's labelling-based ILP for SFVS. In this ILP, we have vertex variables $x_u$ for each $u \in \Tilde{V}$ indicating whether the vertex $u$ is in the SFVS $F$, and vertex labelling variables $z_{u, i}$ for each $u \in \Tilde{V}\cup P_H, i\in [k]$ indicating whether vertex $u$ receives label $i$. We note that \Cref{fig:CM-lp-SFVS} simplifies the exposition of the ILP from \cite{chekuri-madan16} by explicitly substituting the values for variables whose values are directly set by constraints, i.e. $x_u = 0$ for $u \in S \cup\{r\}$, $z_{s_i, i} = 1$ for $i \in [k]$, and $z_{r, k+1} = 1$. Moreover, it slightly strengthens the first constraint (Chekuri-Madan used a slightly weaker constraint: $x_u + \sum_{i\in [k+1]}z_{u, i}=1$).

%Imposing integrality constraints on the LP-relaxation formulates SFVS. 
The constraints can be interpreted as follows: Let $F$ be a minimal finite cost subset feedback vertex set of $H$. 
Constraint (1) says that if a vertex $u \in \Tilde{V}_H$ is not in $F$, then it must receive exactly one of the labels in $\ell_H(u)$. Constraint (2) says that exactly one of $a_i$ and $b_i$ can receive the label $i$ for each $i \in [k]$. Constraint (3) is a spreading constraint that says that both end vertices of every non-special edge in $H - F$ must receive the same label. Constraint (4) is a cycle covering constraint and says that the solution $F$ must intersect every interesting cycle in at least one vertex. Constraint (5) ensures that the set $F$ contains no pivot vertices.

\iffalse
\begin{figure}[H]
    \centering
    \begin{mdframed}
    \textbf{Subset Feedback Vertex Set:}
    \begin{align*}
        \text{min}\qquad&\displaystyle\sum\limits_{u \in \Tilde{V}_H} w_{u}x_{u}&\\
        \text{s.t.}\qquad&&\\
        (1)\ \ &x_u + \sum_{i \in [k+1]}z_{u,i} = 1& \forall\ u\in \Tilde{V}_H\cup P_H\\
        (2)\ \ &z_{a_i, i} + z_{b_i, i} = 1& \forall\ i \in [k]\\
        (3) \ \ &x_u + z_{u,i} - z_{v, i} \geq 0&     \forall\ uv\in \Tilde{E}_H,  \ i\in [k+1] \\
        %(4)\ \ &z_{u,i} - z_{v, i} \geq 0&     uv\in \Tilde{E}_H : u \in  P_H\cup\{r\}, \ i\in [k+1] \\
        %&z_{s_i, i} = 1& \  \text{ $i \in [k]$}\\
        %&z_{r, k+1} = 1&\\
        %&x_{u} = 0& u\in S_H \cup P_H \\
        (4)\ \ &\sum_{u\in C}x_u \geq 1& \forall\ C\in\calC_H\\
        (5)\ \ &x_u = 0&\forall\ u \in P_H\\
        (6)\ \ &z_{u, i} \geq 0&\forall\  \text{  $u \in \Tilde{V}_H \cup P_H, i\in [k+1]$}\\
        (7)\ \ &x_u \geq 0&\forall\  u \in \Tilde{V}_H
    \end{align*}
    \end{mdframed}
    \caption{Chekuri-Madan LP relaxation for SFVS}
  \label{fig:CM-lp-SFVS-as-is}
\end{figure}
\fi

We now briefly address why a labeling satisfying the LP constraints must exist for every minimal finite weight subset feedback vertex set $F$ (see \cite{chekuri-madan16} for further details). We note that none of the vertices of $S\cup P\cup \{r\}$ are in $F$ as these have infinite cost. Let the graph $H' = (V_{H'}, E_{H'})$ be defined as $H' = H - F$. For simplicity, we first assume that the graph $H'$ is connected and then address the more general case when $H'$ is not connected. Since there is no cycle containing any terminal in $H'$, each terminal is a cut vertex in $H'$. Consider the \emph{block-cut-vertex tree} decomposition $T'$ of $H'$ --- (refer to \cite{west_introduction_2000} for details on block-cut-vertex tree decompositions). We label a vertex $u$ of $H'$ as $i \in [k]$ if terminal $s_i$ is the first terminal encountered on any path from vertex $u$ to the root $r$ in the graph $H'$. If no terminals are encountered, then we label the vertex as $k+1$. We note that such a labelling is well-defined as $T'$ is the block-cut-vertex tree and the set $S$ are cut vertices. In this labelling, we observe that every non-special edge $uv \in \Tilde{E}_{H'}$ has the property that both end points receive the same label. Finally, in the case where $H'$ is not connected, we
can justify the existence of such a labeling by picking an arbitrary
non-terminal vertex from each component, imagining a dummy edge connecting it to the root $r$, and considering the labeling corresponding to block-cut-vertex tree of this (implicit) graph.

\iffalse
\paragraph{Strengthening the Chekuri-Madan LP.} We make a simple observation that strengthens the original Chekuri-Madan LP. We will subsequently show that the integrality gap of this strengthened LP is at most $2$. We recall the block-cut-vertex tree based labelling of $H' = H - F$ where each vertex is labelled by an index $i \in [k]$ if $s_i$ is the first terminal encountered on every path from vertex $u$ to the root $r$ in the tree $T'$. We define the set $\ell_H(u) = \{i\in [k]: \text{$s_i$ is reachable from $u$  via a path not containing any other terminals}\} \cup \{k+1\}$ as the set of \emph{labels} for each vertex $u \in V_H \backslash S$. Then, we observe that in the block-cut-vertex tree based labelling, a vertex $u$ can receive a label $i \in [k]$ only if $i \in \ell_H(u)$. Thus, we strengthen constraint (1) of the LP of \Cref{fig:CM-lp-SFVS-as-is} to be $$x_u + \sum_{i \in \ell_H(u)}z_{u, i} = 1 \qquad \text{ for each } u \in \Tilde{V}_H.$$ We write this LP in \Cref{fig:CM-lp-SFVS}.
\fi

\begin{figure}
    \centering
    \begin{mdframed}
    \textbf{Subset Feedback Vertex Set:}
    \begin{align*}
        \text{min}\qquad&\displaystyle\sum\limits_{u \in \Tilde{V}_H} c_{u}x_{u}&\\
        \text{s.t.}\qquad&&\\
        (1)\ \ &x_u + \sum_{i \in \ell_H(u)}z_{u,i} = 1& \forall\ u\in \Tilde{V}_H\cup P_H\\
        (2)\ \ &z_{a_i, i} + z_{b_i, i} = 1& \forall\ i \in [k]\\
        (3) \ \ &x_u + z_{u,i} - z_{v, i} \geq 0&     \forall\ uv\in \Tilde{E}_H,  \ i\in [k+1] \\
        %(4)\ \ &z_{u,i} - z_{v, i} \geq 0&     uv\in \Tilde{E}_H : u \in  P_H\cup\{r\}, \ i\in [k+1] \\
        %&z_{s_i, i} = 1& \  \text{ $i \in [k]$}\\
        %&z_{r, k+1} = 1&\\
        %&x_{u} = 0& u\in S_H \cup P_H \\
        (4)\ \ &\sum_{u\in C}x_u \geq 1& \forall\ C\in\calC_H\\
        (5)\ \ &x_u = 0&\forall\ u \in P_H\\
        (6)\ \ &z_{u, i} \geq 0&\forall\  \text{  $u \in \Tilde{V}_H \cup P_H, i\in [k+1]$}\\
        (7)\ \ &x_u \geq 0&\forall\  u \in \Tilde{V}_H\\
        (8)\ \ &z_{u, i} \in \Z&\forall\  \text{  $u \in \Tilde{V}_H \cup P_H, i\in [k+1]$}\\
        (9)\ \ &x_u \in \Z &\forall\  u \in \Tilde{V}_H
    \end{align*}
    \end{mdframed}
    \caption{Chekuri-Madan's ILP for SFVS}
  \label{fig:CM-lp-SFVS}
\end{figure}

\subsubsection{Reduction from FVS to SFVS satisfying the Chekuri-Madan properties}\label{sec:reduction-from-FVS-to-SFVS}
FVS can be seen as a special case of SFVS where every vertex in the graph is a terminal. However, this simple reduction does not result in an SFVS instance satisfying the properties assumed by the Chekuri-Madan LP (see properties (i)--(v) mentioned in the first paragraph of Section \ref{sec:CM-LP}). In this section, we show how to construct 
an SFVS instance from an FVS instance such that the SFVS instance satisfies the required properties. Let $G= (V_G, E_G)$ with vertex costs $c_G:V_G\rightarrow \R_{\ge 0}$ be the FVS instance. We will construct 
an SFVS instance $H = (V_H, E_H)$ with terminals $S_H$ and vertex costs  $c_H:V_{H}\rightarrow\mathbb{R}_{\ge 0}$ satisfying the required properties. We may assume that the FVS instance $G$ has an infinite-weighted degree-1 root vertex $r$, satisfying property (iv) since adding such a vertex does not change the set of minimal feasible solutions. We construct $H$ as follows:

\begin{enumerate}
    \item For each edge $e = uv \in E_G$, we subdivide the edge $e$ so that the edge becomes a path $u, a_e, s_e, b_e, v$ of length $4$. %Let $a_e, s_e, b_e$ be the edges added by this step. 
    %\item For an edge $e \in E_G$, we denote the vertices added in step (1) as $a_e, s_e, b_e$. Thus, each edge $e=uv$ becomes the path $u,a_e,s_e,b_e,v$ in the graph $H$.
    \item We let $S_H = \bigcup_{e\in E(G)} \{s_e\}$ denote the terminal set. Thus, the set $P_e := \{a_e, b_e\}$ is the set of pivot vertices for each terminal $s_e \in S_H$, and the set $P_H := \bigcup_{e\in E(G)}P_e$ is the set of all pivots of the graph $H$.
    \item We define the cost function as $c_H(u) = c_G(u)$ if $u \in V_G$, and $c_H(u) = \infty$ otherwise (i.e., if $u \in S_H\cup P_H$).
\end{enumerate}

We observe that the graph $H$ satisfies properties (i)-(v) assumed by the Chekuri-Madan LP. The next proposition says that solving FVS in the graph $G$ with cost function $c_G$ is equivalent to solving SFVS in the graph $H$ with terminal set $S_H$ with cost function $c_H$. The proposition follows by construction.

\begin{proposition}\label{prop:reduction-FVS-to-SFVS}
Let $F\subseteq V_G$. The set $F$ is a feedback vertex set for $G$ if and only if the set $F$ is a subset feedback vertex set for the graph $H$ with terminal set $S_H$. Furthermore, the cost of $F$ in both graphs is the same, i.e. $c_G(F) = c_{H}(F)$.
\end{proposition}

Chekuri and Madan showed that the LP-relaxation of their ILP for SFVS given in \Cref{fig:CM-lp-FVS} has integrality gap at most $13$. It immediately follows that the integrality gap of that LP-relaxation on the instance $H$ constructed as above is also at most $13$. 
In the subsequent section, we tighten this integrality gap to $2$ for instances $H$ constructed as above.

\subsubsection{Bounding the Integrality Gap}\label{sec:cm-lp-integrality-gap}
In this section, we show that the LP-relaxation of the ILP for SFVS given in \Cref{fig:CM-lp-SFVS} for the instance $H$ constructed as given in the reduction in Section \ref{sec:reduction-from-FVS-to-SFVS} has integrality gap at 
 most $2$. We prove this by showing that the LP constraints imply orientation and cycle cover constraints. 
Consequently, the integrality gap of the LP-relaxation is at most that of $\min\{\sum_{u\in V} c_ux_u: x\in \projectedorientationpolyhedron(G)\cap \cyclecoverpolyhedron(G)\}$. By \Cref{lemma:integrality-gap-orient-intersect-cycle-cover}, it follows that the integrality gap of the LP-relaxation is at most $2$. 

%This, coupled with \Cref{thm:integrality-gap-wd+cycle-cover}, will help us conclude that the integrality gap of the LP in \Cref{fig:CM-lp-FVS} is at most $2$ for SFVS instances that are constructed from FVS instances as given in the reduction in Section \ref{sec:reduction-from-FVS-to-SFVS}.

%will complete the proof of \Cref{thm:poly-sized-LP-with-integrality-gap-atmost-2-for-FVS}. 

We begin by simplifying the ILP given in \Cref{fig:CM-lp-SFVS} for SFVS instances $H$ that are constructed from FVS instances as given in the reduction in Section \ref{sec:reduction-from-FVS-to-SFVS}. 
We make two observations that will help us in the simplification.
The first observation is that each edge $e \in E_G$ corresponds to a unique terminal $s_e \in V_H$. Thus, we may replace the set $[k]$ which indexed the set of terminals in the LP of \Cref{fig:CM-lp-SFVS} with the set $E_G$. For ease of exposition, we denote $e_r$ by the label $k+1$.
We now give the second observation. Let $u \in V_G$ be arbitrary. Since each edge $e \in \delta_G(u)$ has been subdivided in the graph $H$ and contains a terminal $s_e$, the only terminals that $u$ can reach via a path that does not contain any other terminal is exactly $\{s_e: e \in \delta_G(u)\}$. For an arbitrary pivot vertex $u \in P_H$, let $g(u)$ denote the unique non-terminal neighbor of $u$ in $H$. Then, the only terminals that $u$ can reach via a path that does not contain any other terminal is exactly $\{s_e: e \in \delta_G(g(u))\}$. We summarize these observations in the next proposition.

% \begin{figure}[H]
%     \centering
%     \begin{mdframed}
%     \begin{align*}
%         \text{min}&\displaystyle\sum\limits_{u \in V(G)} w_{u}x_{u}&\\
%         \text{s.t.}&&\\
%         &x_u + \sum_{e \in \delta(u)}z_{u,e} = 1& \  \text{  $u\in V(H)$}\\
%         &z_{s_e, e} = 1& \  \text{ $e \in E(G)$}\\
%         &z_{r, |E(G)|+1} = 1&\\
%         &z_{a_e, e} + z_{b_e, e} = 1& \text{ $e \in E(G)$}\\
%         &x_u + z_{v,e} - z_{u, e} \geq 0& \  \text{ $e = uv\in E - E_S$}\\
%         &x_{u} = 0& \  \text{  $u \in \cup_{e \in E(G)}\{a_e, s_e, b_e\}$} \\
%         &\sum_{u\in C}x_u \geq 1& \  C\in\calC\\
%         &z_{u, e} \geq 0&\  \text{  $u \in V(H), e \in E(G)$}\\
%         &x_u \geq 0&\  \text{ $u \in V(H)$}
%     \end{align*}
%     \end{mdframed}
%     \caption{LP relaxation for FVS}
%   \label{fig:CM-lp-FVS}
% \end{figure}

\begin{proposition}\label{prop:cm-lp-fvs-stronger-label-set}
We have that
\begin{enumerate}
    \item For each vertex $u \in V_G$, we have that $\ell_H(u) = \delta_G(u)\cup \{e_r\}$;
    \item For each pivot vertex $u \in P$, we have that $\ell_H(u) = \delta_G(g(u))\cup \{e_r\}$.
\end{enumerate}
\end{proposition}

Using \Cref{prop:cm-lp-fvs-stronger-label-set} and the first observation mentioned above, we simplify the ILP in \Cref{fig:CM-lp-SFVS} for the SFVS instance $H$ and write its LP-relaxation in \Cref{fig:CM-lp-FVS}. 
\begin{figure}[H]
    \centering
    \begin{mdframed}
    \textbf{Chekuri-Madan LP for graph $H$:}
    \begin{align*}
        \text{min}\qquad&\displaystyle\sum\limits_{u \in \Tilde{V}_H} c_{u}x_{u}&\\
        \text{s.t.}\qquad&&\\
        (1)\ \ &x_u + \sum_{e \in \ell_H(u)}z_{u,e} = 1& \forall u\in \Tilde{V}_H\cup P_H\\
        (2)\ \ &z_{a_e, e} + z_{b_e, e} = 1& \forall e \in E_G\\
        (3) \ \ &x_u + z_{u,e} - z_{v, e} \geq 0&  \forall   uv\in \Tilde{E}_H, \  e\in E_G\cup\{e_r\} \\
        %(4)\ \ &z_{u,e} - z_{v, e} \geq 0&     uv\in \Tilde{E}_H : u \in  P_H\cup\{r\}, \ e\in E_G \\
        %&z_{s_i, i} = 1& \  \text{ $i \in [k]$}\\
        %&z_{r, k+1} = 1&\\
        %&x_{u} = 0& u\in S_H \cup P_H \\
        (4)\ \ &\sum_{u\in C}x_u \geq 1& \ \forall C\in\calC_H\\
        (7)\ \ &x_u = 0&\  \text{ $\forall u \in P_H$}\\
        (6)\ \ &z_{u, e} \geq 0&\  \text{  $\forall u \in \Tilde{V}_H\cup P_H, e\in E_{G}\cup \{e_r\}$}\\
        (7)\ \ &x_u \geq 0&\  \text{ $\forall u \in \Tilde{V}_H$}
    \end{align*}
    \end{mdframed}
    \caption{Chekuri-Madan LP relaxation for FVS}
  \label{fig:CM-lp-FVS}
\end{figure}


We now show that the constraints of the LP in \Cref{fig:CM-lp-FVS} imply the orientation and cycle cover constraints for $G$. 

\begin{lemma}\label{lem:cm-implies-orientation}
Let $(\overline{x}, \overline{z})$ be a feasible solution to the LP in \Cref{fig:CM-lp-FVS}. Then,
\begin{enumerate}
\item $\overline{x}\in \cyclecoverpolyhedron(G)$ and 
\item  
$(\overline{x}, \overline{y}) \in \orientationpolyhedron(G)$, where $\overline{y}_{e, u}=\overline{z}_{u, e}$ for all $e\in \delta(u), u\in V_G$. 
\end{enumerate}
\end{lemma}
\begin{proof}
We have that $\overline{x}\in \cyclecoverpolyhedron(G)$ owing to inequality (4). We now show that $(\overline{x}, \overline{y}) \in \orientationpolyhedron(G)$.
We have that $\overline{x}_u\ge 0$ for all $u\in V_G$ and $\overline{y}_{e, u}\ge 0$ for all $e\in \delta_G(u), u\in V_G$. We now show that $\overline{x}_u + \sum_{e\in \delta_G(u)}\overline{y}_{e,u}\le 1$ for every $u\in V_G$. Let $u\in V$. We have that 
\[
\overline{x}_u + \sum_{e\in \delta_G(u)}\overline{y}_{e,u}=\overline{x}_u + \sum_{e\in \ell_H(u)}\overline{z}_{u, e}-\overline{z}_{u, e_r}= 1-\overline{z}_{u, e_r}\le 1,
\]
where the last inequality holds since $\overline{z}_{u, e_r}\ge 0$. 

Finally, we show that $\overline{x}_u + \overline{x}_v + \overline{y}_{e, u} +\overline{y}_{e,v}\ge 1$ for every $e=uv\in E_G$. Let $e=uv\in E_G$. Let $u, a_e, s_e, b_e,v$ be the path in the graph $H$ corresponding to the subdivided edge $e$. Then, we have that 
\begin{align*}
\overline{x}_u + \overline{x}_v + \overline{y}_{e, u} + \overline{y}_{e, v}& =
    \overline{x}_u + \overline{x}_v + \overline{z}_{u, e} + \overline{z}_{v, e}&\\
    &= (\overline{x}_u + \overline{x}_v + \overline{z}_{u, e} + \overline{z}_{v, e}) + (\overline{z}_{a_e, e} + \overline{z}_{b_e, e}) - (\overline{z}_{a_e, e} + \overline{z}_{b_e, e}) &\\
    &= 1 + ( \overline{x}_u + \overline{z}_{u,e} - \overline{z}_{a_e, e})+ ( \overline{x}_v + \overline{z}_{v,e} - \overline{z}_{b_e, e})&\\
    & \geq 1.&
\end{align*}
Here, the second equality follows from constraint (2) and the final inequality follows from constraint (3) of \Cref{fig:CM-lp-FVS}.
\end{proof}

\Cref{lem:cm-implies-orientation}  implies that $\min\{\sum_{u\in V}c_u x_u: x\in \projectedorientationpolyhedron(G)\cap \cyclecoverpolyhedron(G)\}$ is a relaxation of the LP in \Cref{fig:CM-lp-FVS}.  \Cref{lemma:integrality-gap-orient-intersect-cycle-cover} tells us that the integrality gap of $\min\{\sum_{u\in V}c_u x_u: x\in \projectedorientationpolyhedron(G)\cap \cyclecoverpolyhedron(G)\}$ is at most $2$. Consequently, the integrality gap of the LP in \Cref{fig:CM-lp-FVS} is also at most $2$. We note that the LP in \Cref{fig:CM-lp-FVS} can be converted to a polynomial-sized LP by replacing inequality (4) using a polynomial-sized description of cycle cover constraints as given in \Cref{lemma:cycle-cover-poly-sized-lp}. 


\subsection{Orientation based Formulation}\label{sec:orientation-formulation}
In this section, we give another polynomial-sized ILP for FVS whose LP-relaxation has integrality gap at most $2$. This ILP is based only on orientation constraints and does not require cycle cover constraints (in contrast to the ILP presented in Section \ref{sec:orientation-and-cycle-cover-formulation}). \Cref{thm:poly-sized-LP-with-integrality-gap-atmost-2-for-FVS} follows from the following lemma. 
\begin{lemma}\label{lemma:strong-density-orientation-lp}
The following is an integer linear programming formulation for FVS for a graph $G=(V, E)$ with non-negative vertex costs $c:V\rightarrow \R_{\ge 0}$:
\begin{align}
\min & \sum_{u\in V} c_u x_u \nonumber\\
x_v + x_w + y^{f}_{e, v}+y^f_{e, w}&\ge 1\ \forall\ e=vw\in E, f\in E \label{constraint:orientation}\\
x_v+\sum_{e=vw\in E}y^f_{e,w}&\ge 1\ \forall\ v\in V, f\in E \label{constraint:load}\\
\sum_{v\in V-\{a,b\}}x_v + \sum_{e=vw\in E-\{f\}}(y^f_{e,w}+y^f_{e,v})&\le |V|-2\ \forall\ f=ab\in E \label{constraint:cumulative}\\
x_u&\ge 0\ \forall u\in V \label{constraint:x-nonnegative}\\
y^f_{e,v}&\ge 0\ \forall e\in\delta(v), v\in V, f\in E \label{constraint:y-nonnegative}\\
x_u&\in \Z\ \forall u\in V \nonumber\\
y^f_{e,v}&\in \Z\ \forall e\in\delta(v), v\in V, f\in E. \nonumber
\end{align}
Moreover, its LP-relaxation has integrality gap at most $2$.  
\end{lemma}
\begin{proof}
Let $x$ be the indicator vector of a feedback vertex set $S$ of $G$. 
We show that there exists a binary vector $y$ satisfying the constraints. Let $T$ be a spanning tree of $G$ containing all edges of $G$ that are not incident to vertices in $S$. 
Fix an edge $f=ab\in E$. 
For each vertex $v\in V\setminus (S\cup \{a, b\})$, set $y^f_{e,w}=1$ where $e=vw$ is the first edge on the unique path from $v$ to $a$ in $T$. Moreover, set $y^f_{f,a}=y^f_{f,b}=1$ and all other $y^f$ variables to $0$. We prove that this choice of $y$ satisfies all constraints. 

For an edge $e=vw\in E$, if $|S\cap \{v,w\}|\ge 1$, then $x_v+x_w\ge 1$ and if $v, w\not\in S$, then $e\in T$ and consequently, either $y_{e,v}^f=1$ or $y^f_{e,w}=1$ and hence, the constraint $x_v + x_w + y^{f}_{e, v}+y^f_{e, w}\ge 1$ holds. For a vertex $v\in V$, if $v\in S$, then $x_v\ge 1$ and if $v\in V-S$, then there exists an edge $e=vw\in T$ and hence, $y^f_{e,w}=1$ and consequently, the constraint $x_v+\sum_{e=vw\in E}y^f_{e,w}\ge 1$ holds. It remains to show that the constraint $\sum_{v\in V-\{a,b\}}x_v + \sum_{e=vw\in E-\{f\}}(y^f_{e,w}+y^f_{e,v})\le |V|-2$ holds. By the choice of $x$, it suffices to show that $|S\setminus \{a, b\}| + \sum_{e=vw\in T-\{f\}}(y^f_{e,w}+y^f_{e,v})\le |V|-2$ holds. By the choice of $y^f$, it suffices to show that $|S\setminus \{a, b\}| + \sum_{e=vw\in T}(y^f_{e,w}+y^f_{e,v})\le |V|$. Simplifying this further, it suffices to show that 
\[
\sum_{e=vw\in T}(y^f_{e,w}+y^f_{e,v})\le |(V-S)\cup\{a, b\}|.
\]
We note that $\sum_{e=vw\in T}(y^f_{e,w}+y^f_{e,v}) = \sum_{v\in V}(\sum_{e=vw\in T}y^f_{e,w})$. Hence, it suffices to show that 
\[
\sum_{v\in V}\left(\sum_{e=vw\in T}y^f_{e,w}\right) \le |(V-S)\cup\{a, b\}|.
\]
We have the following four inequalities:
\begin{align*}
\sum_{e=vw\in T}y^f_{e, w}&\le 1\ \forall v\in V-(S\cup \{a, b\}),\\
\sum_{e=vw\in T}y^f_{e, w}&= 0\ \forall v\in S-\{a, b\},\\
\sum_{e=aw\in T}y^f_{e, w}&= y^f_{e,b}=1, \text{ and}\\
\sum_{e=bw\in T}y^f_{e, w}&= y^f_{e,a}=1.
\end{align*}
Hence, $\sum_{v\in V}\left(\sum_{e=vw\in T}y^f_{e,w}\right) \le |(V-S)\cup\{a, b\}|$. 

Next, we show that an integral solution to the system of inequalities (\ref{constraint:orientation}), (\ref{constraint:load}), (\ref{constraint:cumulative}), (\ref{constraint:x-nonnegative}), and (\ref{constraint:y-nonnegative}) is the indicator vector of a feedback vertex set. 
%and bound the integrality gap of the LP-relaxation. 
We will use the following claim. 
%for both. 
\begin{claim}\label{claim:orientation-constraints-imply-strong-density}
Constraints (\ref{constraint:orientation}), (\ref{constraint:load}), (\ref{constraint:cumulative}), (\ref{constraint:x-nonnegative}), and (\ref{constraint:y-nonnegative}) imply the strong density constraints. 
\end{claim}
\begin{proof}
Let $(x, y)$ be a solution satisfying constraints (\ref{constraint:orientation}), (\ref{constraint:load}), (\ref{constraint:cumulative}), (\ref{constraint:x-nonnegative}), and (\ref{constraint:y-nonnegative}). Let $S\subseteq V$ such that $E[S]\neq \emptyset$. We will show that 
\[
\sum_{u\in S}(d_S(u)-1)x_u \ge |E[S]|-|S|+1.
\]
Equivalently, we will show that 
\[
|E[S]|-|S| - \sum_{u\in S}(d_S(u)-1)x_u \le -1.
\]
Let us rewrite the LHS as
\[
|E[S]|-|S| - \sum_{u\in S}(d_S(u)-1)x_u = \sum_{vw\in E[S]} (1-x_v-x_w) + \sum_{v\in S}(x_v-1).
\]
Let us inspect each sum separately. Fix an arbitrary $f=ab\in E[S]$. We have that 
\begin{align*}
\sum_{vw\in E[S]} (1-x_v-x_w) 
&= \sum_{vw\in E[S]} \left(1-x_v-x_w-y^f_{e,w}-y^f_{e,v}\right) + \sum_{vw\in E[S]} \left(y^f_{e,v} + y^f_{e,w}\right)\\
&\le 1-x_a-x_b-y^f_{f,a}-y^f_{f,b}+\sum_{vw\in E[S]} \left(y^f_{e,v} + y^f_{e,w}\right)
\end{align*}
where the inequality follows from (\ref{constraint:orientation}) and the fact that $f=ab\in E[S]$. We also have that 
\begin{align*}
\sum_{v\in S}(x_v -1) 
&= \sum_{v\in S} \left(x_v -1 +\sum_{e=vw\in E}y^f_{e, w}\right) - \sum_{v\in S}\sum_{e=vw\in E} y^f_{e,w}\\
&\le \sum_{v\in V} \left(x_v -1 +\sum_{e=vw\in E}y^f_{e, w}\right) - \sum_{v\in S}\sum_{e=vw\in E} y^f_{e,w}
\end{align*}
where the last inequality follows from (\ref{constraint:load}). Before adding the two upper bounds, we also note that 
\[
\sum_{vw\in E[S]} \left(y^f_{e,v} + y^f_{e,w}\right) - 
\sum_{v\in S}\sum_{e=vw\in E} y^f_{e,w}
\le 0
\]
by (\ref{constraint:y-nonnegative}). 
Hence, 
\begin{align*}
\sum_{vw\in E[S]} (1-x_v-x_w) + \sum_{v\in S}(x_v -1) 
&\le 1-x_a-x_b-y^f_{f,a}-y^f_{f,b}+\sum_{v\in V} \left(x_v -1 +\sum_{e=vw\in E}y^f_{e, w}\right) \\
&= 1 - |V| + \sum_{v\in V-\{a, b\}}x_v + \sum_{vw\in E-\{f\}}(y^f_{e,v}+y^f_{e,w})\\
&\le -1
\end{align*}
where the last inequality follows from (\ref{constraint:cumulative}). 
\end{proof}
By the results of Chudak, Goemans, Hochbaum, and Williamson \cite{CHUDAK1998111}, every integral solution satisfying strong density constraints corresponds to the indicator vector of a feedback vertex set. Thus, by Claim \ref{claim:orientation-constraints-imply-strong-density}, an integral solution to the system of inequalities (\ref{constraint:orientation}), (\ref{constraint:load}), (\ref{constraint:cumulative}), (\ref{constraint:x-nonnegative}), and (\ref{constraint:y-nonnegative}) is the indicator vector of a feedback vertex set. This completes the proof that the formulation given in the lemma is indeed an integer linear programming formulation for FVS. 

Finally, we bound the integrality gap of the LP-relaxation. By the results of Chudak, Goemans, Hochbaum, and Williamson \cite{CHUDAK1998111}, we know that (\ref{FVS-IP: SD})
%$\min\{\sum_{u\in V} c_u x_u: x\in \strongdensitypolyhedron(G)\cap \Z^V\}$ 
is an ILP formulation for FVS and the integrality gap of its LP-relaxation 
(\ref{FVS-LP: SD}) 
%$\min\{\sum_{u\in V} c_u x_u: x\in \strongdensitypolyhedron(G)\}$ 
is at most $2$. 
We have already shown that the ILP in the lemma statement is a valid formulation for FVS. 
By Claim \ref{claim:orientation-constraints-imply-strong-density}, the LP-relaxation of the ILP in the lemma statement has integrality gap at most $2$. 
%By Claim \ref{claim:orientation-constraints-imply-strong-density} and the fact that the integer linear program in the lemma statement is a formulation for FVS, it follows that the integrality gap of the LP-relaxation is also at most $2$.  
\end{proof}

\section{Semi-oblivious amplitude amplification}
\label{apx:amplitude-amplification}

\noindent In Section~\ref{sec:phase-extraction-problem} we have the following unitary:
\begin{align*}
    S \ket{00} \ket{\psi}^{\otimes n} = \ket{00} H_c \ket{\psi} + \ket{\Phi}
\end{align*}
\smallskip

\noindent where $\braket{00}{\Phi} = 0$, and $H_c \ket{x} = \frac{1}{2} \sqrt{\Tilde{c}(x)} \ket{x}$. Unfortunately, we cannot apply an oblivious amplitude amplification~\cite{berryExponentialImprovementPrecision2014a} procedure, not even in its robust version~\cite{berrySimulatingHamiltonianDynamics2015}. This because we would need $H_c$ to be (almost-)unitary, but it can even have zero eigenvalues. On the other hand, however, we only need to transform one particular state, i.e.\ $\ket{+}^{\otimes n}$. We use the Quantum Singular Value Transform (QSVT)~\cite{gilyenQuantumSingularValue2019a, gilyenQuantumSingularValue2019c} in a similar way it was used in~\cite{martynGrandUnificationQuantum2021} for Grover's search. We introduce some notation: let $\ket{\Psi} = \ket{00} \ket{+}^{\otimes n}$ denote our initial state, while $\ket{w} = \ket{00} \frac{H_c \ket{+}^{\otimes n}}{||H_c \ket{+}^{\otimes n}||}$ is our (normalized) target state. If $\Pi' = \ketbra{00}{00} \otimes \id, \Pi = \ketbra{\Psi}{\Psi}$. Then
\begin{align*}
    \Pi' S \Pi \ket{\Psi} = \ket{00} H_c \ket{+}^{\otimes n} = \sigma \ket{w}
\end{align*}
where $\sigma = ||H_c \ket{+}^{\otimes n}|| = \Theta(\sqrt{\bar{c}})$. Since any state orthogonal to $\ket{\Psi}$ is canceled out by $\Pi$, then it means that a singular value decomposition is
\begin{align*}
    \Pi' S \Pi = \sigma \ketbra{w}{\Psi}.
\end{align*}
Notice that, in our case, reflections and rotations of $\Pi', \Pi$ can be easily implemented and we can use the polynomial that approximates $\erf(k[x - c])$ (see, e.g.\,~\cite[Section III]{martynGrandUnificationQuantum2021}), having constant success probability with only
$$\bigO\left(\frac{1}{\sigma}\right) = \bigO\left(\frac{1}{\sqrt{\bar{c}}}\right)$$
calls to $S$.
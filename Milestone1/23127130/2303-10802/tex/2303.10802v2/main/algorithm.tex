\begin{algorithm}[t!]
    \caption{Sample Selection and Training of Noise-Robust Classifiers}\label{procedure:Proposed_Procedure}
    \begin{algorithmic}[1]
    { %\footnotesize{
        \Procedure{PASS}{$\Tilde{D}, \Psi, E$}
            \LComment{$\Tilde{D}=\{(\mathbf{x}_i, \hat{\mathbf{y}}_i)\}_{i=1}^{n}$: noisy-labelled dataset}
            \LComment{$E$: total number of epochs}
            \LComment{$\Psi$: training algorithm to use, e.g., DivideMix}
            \State Initialise three classifiers randomly: \(\{\gamma_{j}\}_{j = 1}^{3}\)
            \For{$e = 1:E$} \Comment{for each epoch}
                \LComment{Select clean/noisy samples for classifier $h_{\gamma_{1}}$}
                % \LComment{\(L_{1}\): clean data, \(U_{1}\): noisy data}
                \State $L_{1}, U_{1} \gets$ \Call{Sample-Selection}{$ \Tilde{D}, h_{\gamma_{2}}, h_{\gamma_{3}}$} \Comment{$L$: clean, $U$: noisy}
                \State $\mathsf{L}_{(1)}^{\mathrm{(\Psi)}} \gets$ \Call{Loss}{$ L_{1}, U_{1}, h_{\gamma_{1}}$}
                \State \(\gamma_{1} \gets\) \Call{SGD}{$\mathsf{L}_{(1)}^{\mathrm{(\Psi)}}, \gamma_{1}$} \Comment{update parameter}
                \State Repeat for $h_{\gamma_{2}}$ and $h_{\gamma_{3}}$
            \EndFor
            \State \Return ${\gamma_{1}}, {\gamma_{2}}, {\gamma_{3}}$
        \EndProcedure
        \Statex  % Blank line
        \Function{Sample-Selection}{$\Tilde{D}, h_{\gamma_{j}},h_{\gamma_{k}}$}
            \State $\mathbf{s} \gets \pmb{0}$  \Comment{vector to store cosine similarity}
            \For{each $ (\mathbf{x}_{i}, \hat{\mathbf{y}}_{i})$ in $\Tilde{D}$}
                \State $\mathbf{s}_{i} \gets$ \Call{Cosine-Similarity}{$h_{\gamma_{j}}(\mathbf{x}_{i}), h_{\gamma_{k}}(\mathbf{x}_{i})$}
            \EndFor
            \State $t \gets$ \Call{Otsu}{$\mathbf{s}$}  \Comment{Find thresholding with Otsu}
            \State $D_{\text{clean}} \gets \varnothing, D_{\text{noisy}} \gets \varnothing$
            \For{ each $(\mathbf{x}_{i}, \hat{\mathbf{y}}_{i})$ in $\Tilde{D}$}
                \If{$\mathbf{s}_i \geq t$}  \Comment{Highly-agreed}
                    \State $D_{\mathrm{clean}} \gets D_{\text{clean}} \cup {(\mathbf{x}_i, \hat{\mathbf{y}}_i)}$
                \Else  \Comment{Lowly-agreed}
                    \State $D_{\mathrm{noisy}} \gets D_{\mathrm{noisy}} \cup {(\mathbf{x}_i, \hat{\mathbf{y}}_i)}$
                \EndIf
            \EndFor
            \State \Return $D_{\mathrm{clean}}, D_{\mathrm{noisy}}$
        \EndFunction
        %}
        }
    \end{algorithmic}
\end{algorithm}
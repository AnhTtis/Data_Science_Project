\documentclass[
 reprint,
twocolumn,
superscriptaddress,
longbibliography,
%groupedaddress,
%unsortedaddress,
%runinaddress,
%frontmatterverbose, 
%preprint,
%preprintnumbers,
%nofootinbib,
%nobibnotes,
%bibnotes,
 amsmath,amssymb,
 aps,
% prl,
prb,
%rmp,
%prstab,
%prstper,
%floatfix,
]{revtex4-2}


\usepackage{braket}
\usepackage{physics}
\usepackage{comment}
\usepackage{xcolor}
\usepackage{appendix}
\usepackage{caption}
\captionsetup{justification=raggedright,singlelinecheck=false}
\usepackage{subcaption}
\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage[mathscr]{euscript}
\usepackage[scr=boondox]{mathalpha}
\usepackage{bm}% bold math
\usepackage[linktocpage]{hyperref}% add hypertext capabilities
\hypersetup{colorlinks=true,citecolor=blue,linkcolor=blue, urlcolor=blue, breaklinks=true}
%\usepackage[mathlines]{lineno}% Enable numbering of text and display math
%\linenumbers\relax % Commence numbering lines

\makeatletter
\newcommand\xlabel[2][]{\phantomsection\def\@currentlabelname{#1}\label{#2}}
\makeatother
%\usepackage[showframe,%Uncomment any one of the following lines to test 
%%scale=0.7, marginratio={1:1, 2:3}, ignoreall,% default settings
%%text={7in,10in},centering,
%%margin=1.5in,
%%total={6.5in,8.75in}, top=1.2in, left=0.9in, includefoot,
%%height=10in,a5paper,hmargin={3cm,0.8in},
%]{geometry}
%%% Custom %%%

\newcommand{\naren}[1]{{\color{purple}\footnotesize{(NM: #1)}}}
\newcommand{\yuxuan}[1]{{\color{magenta}\footnotesize{(YZ: #1)}}}
\newcommand{\ryohei}[1]{{\color{orange}\footnotesize{(RK: #1)}}}

\newcommand{\Z}{\mathbb{Z}}
\newcommand{\OO}{\text{o}}
\newcommand{\HH}{\mathcal{H}}
\newcommand{\Cmop}{\tilde{C}_{M_{\text{o}}}^+}
\newcommand{\Cmom}{\tilde{C}_{M_{\text{o}}}^-}
\newcommand{\Cmopm}{\tilde{C}_{M_{\text{o}}}^{\pm}}
\newcommand{\MO}{M_\text{o}}


		\newcommand{\commentmb}[1]{\textcolor{red}{[MB: #1]}}
% \newcommand{\floor{#1}}{\lfloor #1 \rfloor}

\begin{document}

\title{Complete crystalline topological invariants from partial rotations in (2+1)D \\ invertible fermionic states and Hofstadter's butterfly}


\author{Yuxuan Zhang, Naren Manjunath, Ryohei Kobayashi, Maissam Barkeshli}
\affiliation{Department of Physics, Joint Quantum Institute, and Condensed Matter Theory Center, University of Maryland,
College Park, Maryland 20742, USA}


\begin{abstract}
The theory of topological phases of matter predicts invariants protected only by crystalline symmetry, yet it has been unclear how to extract these from microscopic calculations in general. Here we show how to extract a set of many-body invariants $\{\Theta_\OO^{\pm}\}$, where $\OO$ is a high symmetry point, from partial rotations in (2+1)D invertible fermionic states.  Our results apply in the presence of magnetic field and Chern number $C \neq 0$, in contrast to previous work.
$\{\Theta_{\OO}^{\pm}\}$ together with $C$, chiral central charge $c_-$, and filling $\nu$ provide a complete many-body characterization of the topological state with symmetry group $G = \text{U}(1) \times_\phi [\mathbb{Z}^2 \rtimes \mathbb{Z}_M]$. Moreover, all these many-body invariants can be obtained from a single bulk ground state, without inserting additional defects.
We perform numerical computations on the square lattice Hofstadter model. Remarkably, these match calculations from conformal and topological field theory, where $G$-crossed modular $S, T$ matrices of symmetry defects play a crucial role. Our results provide additional colorings of Hofstadter's butterfly, extending recently discovered colorings by the discrete shift and quantized charge polarization.
\end{abstract}


\maketitle

There has been intense work over the past decade in developing a comprehensive characterization and classification of topological phases of matter with internal \cite{Kitaev2009periodic,ryu2010,Chen2013,kapustin2014SPTbeyond,kapustin2015fSPT,Wang2020fSPT,Senthil2015SPT,barkeshli2019,barkeshli2021invertible,aasen2021characterization,bulmashSymmFrac} and crystalline symmetries \cite{Chiu2016review,cheng2016lsm,Bradlyn2017tqc,Po2017symmind,Kruthoff2017TCI,Huang2017,Thorngren2018,cheng2018rotation,zhang2020realspace,Elcoro2021tqc,manjunath2021cgt,manjunath2020FQH}. Despite much progress, the problem of how to fully characterize such systems, in particular by numerically extracting a complete set of invariants, remains partially solved \cite{shiozaki2017invt,Shapourian2017FSPT,zhang2022fractional,zhang2022pol,herzogarbeitman2022interacting}. 


In this paper, we study (2+1)D topological states of fermions with symmetry group $G = \text{U}(1) \times_\phi [\mathbb{Z}^2 \rtimes \mathbb{Z}_M]$, which consists of $\text{U}(1)$ charge conservation, discrete magnetic translation and point group rotation symmetries. We focus on invertible fermionic phases, which have a unique ground state on all manifolds \cite{barkeshli2021invertible,aasen2021characterization}. We show how to numerically extract a set of many-body invariants $\{\Theta^{\pm}_{\OO}\}$ associated to the crystalline symmetries by computing expectation values of partial rotations centered at high symmetry points $\OO$ of the unit cell. For example, if $\OO$ is preserved by rotations of order $M_{\OO}$ where $M_{\OO}$ is even, then for a fixed Chern number, $\Theta^{+}_{\OO}$ and $\Theta^{-}_{\OO}$ define $\Z_{M_{\OO}/2}$ and $\Z_{2M_{\OO}}$ invariants respectively, for each $\OO$. Our numerical results are in remarkable agreement with analytical calculations from conformal and topological field theory; specifically, the invariants $\{\Theta^{\pm}_{\OO}\}$ encode the $G$-crossed modular $S,T$ matrices of symmetry defects \cite{barkeshli2019,manjunath2020FQH}. 


 \begin{figure}[t]
    \centering
    \includegraphics[width=7cm]{theta_b.png}
    \caption{$\Theta_{\beta}^+ \mod 2$ for Hofstadter model, plotted using an empirical formula Eq.~\eqref{eq:Theta_full} and Eq.~\eqref{eq:theta_beta} in App.~\ref{app:num}.}
    \label{fig:beta_plus}
\end{figure}

 \begin{figure*}[t]
    \centering
    \includegraphics[width=16cm]{theta_a_unit.png}
    \caption{$\Theta_{\alpha}^+ \mod 2$ for Hofstadter model, where $\alpha$ is a plaquette center, plotted using an empirical formula Eq.~\eqref{eq:Theta_full} and Eq.~\eqref{eq:theta_alpha} in App.~\ref{app:num}. The choice of square lattice unit cell is shown on the right.}
    \label{fig:alpha_plus}
\end{figure*}

For square lattice and $\text{U}(1)$ charge conservation symmetries, the expected theoretical classification of topological invariants is given by the group $\Z^3\times\Z_8\times \Z_2\times \Z_4^2$ \cite{zhang2020realspace,manjunath2023classif}. 
We find that the invariants $\{\Theta^{\pm}_{\OO}\}$, together with the Chern number $C$, the chiral central charge $c_-$ and the filling $\nu$, give a \textit{complete} characterization of these invariants. In particular, the discrete shift $\mathscr{S}_{\OO}$ and quantized charge polarization $\vec{\mathscr{P}}_{\OO}$ studied in Refs.~\cite{zhang2022fractional,zhang2022pol} can be obtained from $\{\Theta^{\pm}_{\OO},C,c_-,\nu\}$. Our methods to extract $\{\Theta_{\OO}^{\pm}\}$ require only a single bulk ground state on a disk, without needing to insert additional defects, adding to a line of work that extracts topological invariants from single bulk ground states \cite{levin2006,kitaev2006topological,shiozaki2017invt,dehghani2021,cian2021,cian2022extracting,Kim2022ccc,fan2022}. 
%This gives an additional way of obtaining $\mathscr{S}_{\OO}$ and $\vec{\mathscr{P}}_{\OO}$ without needing to insert additional magnetic flux or lattice defects. 

As an application, we study the square lattice Hofstadter model and obtain a number of additional colorings of Hofstadter's butterfly, extending the colorings by $\mathscr{S}_{\OO}$ and $\vec{\mathscr{P}}_{\OO}$ discovered in \cite{zhang2022fractional,zhang2022pol}. Analogous classification results hold for point group rotations of order 2,3 and 6, and will be mentioned at the end of the paper.

Partial rotations and partial translations on a cylinder have been studied in prior works and have been shown to yield invariants such as topological spins of anyons, central charges~\cite{Qi2012momentumpolarization, FQHEDMRG, kobayashi2023extracting}, and invariants of symmetry-protected topological (SPT) states~\cite{Zaletel2014bosonicSPT,shiozaki2017invt, Shiozaki2018antiunitary, kobayashi2019,You2020hoe}. In contrast our results apply both in the presence of arbitrary rational magnetic flux, $C \neq 0$, demonstrate a complete set of invariants for crystalline symmetries, and also incorporate several subtleties missed in prior work. These include the proper use of $G$-crossed modular matrices,  the quantization of $\{\Theta^{\pm}_{\OO}\}$, and their dependence on $\OO$.  



 

\paragraph*{Symmetries and model.} We study gapped phases of matter with the symmetry group $G = \text{U}(1) \times_{\phi} [\mathbb{Z}^2 \rtimes \Z_M]$, where $\Z^2$ denotes magnetic lattice translations, $\Z_M$ for $M = 2,3,4,6$ denotes point group rotations. We assume $M=4$ throughout, and briefly comment on $M=2,3,6$ at the end of the paper.

The symbol $\times_{\phi}$ implies that the magnetic translation operators, generated by $\tilde{T}_{\bf x}, \tilde{T}_{\bf y}$, obey the algebra $\tilde{T}_{\bf y}^{-1} \tilde{T}_{\bf x}^{-1} \tilde{T}_{\bf y} \tilde{T}_{\bf x} = e^{i \phi \hat{N}}$ where $\hat{N}$ is the total fermion number. The tilde indicates that the definition of the operator involves a $\text{U}(1)$ gauge transformation. Note $e^{i \pi \hat{N}} = (-1)^F$, which is fermion parity. 

Let $2\pi/M_{\OO}$ be the smallest angle of rotation which preserves the rotation center $\OO$. The possible high symmetry points $\OO$ of the square lattice are shown in Fig.~\ref{fig:alpha_plus}; they are $\alpha, \beta$ (plaquette center and vertex respectively, with $M_{\alpha} = M_{\beta}=4$) and $\gamma$ (edge center, with $M_{\gamma}=2$)~\footnote{Note we will abuse language somewhat and use $\OO$ both as the rotation center and as a maximal Wyckoff position.}. As shown in \cite{zhang2022fractional,zhang2022pol} and reviewed in App.~\ref{app:num}, there is a canonical choice of magnetic point group rotation operators $\Cmop$ which are centered at $\OO$ and satisfy $(\Cmop)^{\MO} = +1$. We also define another set of operators 
$\tilde{C}_{M_\OO}^- := e^{i \frac{\pi}{M_{\OO}} \hat{N}} \tilde{C}_{M_{\OO}}^+$,
and $\tilde{C}_{M_{\OO}, \chi}^{\pm} := e^{i\chi \frac{2\pi}{\MO} \hat{N}} \tilde{C}_{M_{\OO}}^\pm$. Note that
$\tilde{C}_{M_{\OO}}^- = \tilde{C}_{M_{\OO}, 1/2}^+$ and $(\Cmom)^{\MO} = (-1)^F$. 

We study the spinless free fermion Hofstadter model with flux $\phi$ per unit cell, with Hamiltonian
$H = -\sum_{\langle ij \rangle} e^{-i A_{ij}} c_i^{\dagger} c_j + \text{h.c.}$. Our numerical methods and theoretical analysis hold even if we consider further neighbor hopping and/or interaction terms. 

\begin{figure*}[t]
    \centering
    \includegraphics[width=18cm]{all_thetaminus_v3.png}
    \caption{Raw data for $\Theta_{\OO}^-$ calculated on a $30\times 30$ open disc. The diameter of the partial rotation region $D$ is taken to be roughly half the system size. In the $C=\{1,2,3\}$ main Landau levels, $\Theta_{\beta}^{-}$ quantizes to $\{15/4\pm 0.003,
    1\pm 0.022, 3/4\pm 0.051\}$. $\Theta_{\OO}^-$ calculated on either an open disk or a torus yields the same result up to an exponentially small correction.}
    \label{fig:all}
\end{figure*}




\textit{Partial rotation calculation.} 
Consider a state $|\Psi\rangle$, which can be defined on a system with either open or periodic boundary conditions. 
Let $\Cmopm|_D$ be the restriction of $\Cmopm$ to an invariant subregion $D$ centered at $\OO$.


We find that 
$\bra{\Psi}\tilde{C}_{M_{\OO},\chi}^{\pm}|_D\ket{\Psi} =
e^{\frac{2\pi i}{M_{\OO}}l^\pm_{D,\OO,\chi} -\gamma^{\pm}_{D,\OO, \chi}}$. $\gamma^{\pm}_{D,\OO,\chi} \propto |\partial D|$ sets the real-valued amplitude. When $\chi$ is an integer, we find
\begin{equation}\label{eq:angular_momentum}
    l^\pm_{D,\OO,\chi}=\frac{C\chi^2}{2}+\mathscr{S}^{\pm}_{\OO}\chi + K^{\pm}_{\OO} \mod \MO
\end{equation}
$\mathscr{S}^+_{\OO}$ is the discrete shift, which was studied in Refs.\cite{zhang2022fractional,zhang2022pol} and was referred to there as $\mathscr{S}_{\OO}$. Here we define $\mathscr{S}^-_{\OO}$ analogously, as the term linear in $\chi$ in Eq. \ref{eq:angular_momentum}. 
Empirically we observe that $K^{\pm}_{\OO} \mod \MO$ may not be invariant throughout a given lobe in the Hofstadter model: $K^+_{\OO}$ can jump by multiples of $\MO/2$ within a single lobe, but there are no jumps in $K^-_{\OO}$. For an intuitive explanation of these jumps, which are system size dependent, see App.~\ref{app:num}.
We thus define
\begin{align}
    \Theta_{\OO}^+ :=
        K^+_{\OO} \mod \frac{\MO}{2}, \;\;\;\; \Theta_{\OO}^- := K^-_{\OO} \mod \MO.
\end{align}
The main result of this paper is that $\{\Theta_{\OO}^{\pm}\}$ are topological invariants protected by point group rotational symmetry about $\OO$.
$\Theta_{\OO}^+$ is in general an integer or half-integer, while $\Theta_{\OO}^-$ is a multiple of $1/4$. For a fixed Chern number, they can take $\MO/2$ and $2\MO$ different values respectively and thus define $\Z_{\MO/2}$ and $\Z_{2\MO}$ invariants, respectively. 
We find both empirically and analytically using Eq. \ref{eq:mainresultCFT} that $\Theta_\gamma^+ = 0 \mod 1$, and so it will henceforth be ignored. When $C = 0$, $\{\Theta_{\OO}^{\pm}\}$ are closely related to the many-body real-space indicators defined in \cite{herzogarbeitman2022interacting}.

The values of $\Theta_{\OO}^{\pm}$ are plotted for the square lattice Hofstadter model in Figs.~\ref{fig:beta_plus}, \ref{fig:alpha_plus}, and \ref{fig:all}. 
The values of $\Theta_{\OO}^+$ satisfy the empirical relation
\begin{equation}\label{eq:Theta+_vs_k3}
    \Theta_{\OO}^+ =
    k_{3,\OO}^+-\frac{C}{2} \mod 2, \;\; \OO = \alpha,\beta 
\end{equation}
where $k^+_{3,\OO}$ is an integer. The subscript 3 is used to match a convention from \cite{manjunath2021cgt}.
$\Theta_{\OO}^-$ satisfies
\begin{equation}\label{eq:Theta-_vs_k3}
    \Theta_{\OO}^- = \begin{cases}k^-_{3,\OO} + \frac{k_{s,\OO}}{2}-\frac{3C}{4} \mod 4, &  \OO = \alpha,\beta \\
    k_{3,\OO}^-+ \frac{k_{s,\OO}}{2} -\frac{C}{4} \mod 2, & \OO = \gamma,\end{cases}
\end{equation}
where $k_{s,\OO} \in \{0,1\}$ and $k_{3,\OO}^-$ is an integer.  Eqs.~\eqref{eq:Theta+_vs_k3},~\eqref{eq:Theta-_vs_k3} are in excellent agreement with a conformal field theory calculation, which predicts the basic quantization and $C$ dependence of $\Theta^{\pm}_{\OO}$ exactly, but does not give the actual values of $k_{3,\OO}^{\pm}$ and $k_{s,\OO}$ for a particular model. The CFT prediction is summarized by Eq.~\eqref{eq:mainresultCFT}. 



If we view $\Theta^{\pm}_{\OO}$ in the square lattice Hofstadter model as a function of $\phi$, $\Theta^{\pm}_{\beta}$ has period $2\pi$ while $\Theta^{\pm}_{\alpha}$ has period $8\pi$. A similar periodicity depending on origin was observed for the discrete shift in Ref.~\cite{zhang2022pol}. Mathematically, the lack of periodicity in $2\pi$ arises because $\tilde{C}_{M_{\OO}}$ is not a gauge-invariant operator, and $H$ is only periodic (without a gauge transformation) under $\phi \rightarrow \phi + 8 \pi$ (For details see App.~\ref{app:num}). The lack of $2\pi$ periodicity is physically meaningful and arises because $\phi$ must be defined as a real number to consistently specify generic perturbations of $H$ \cite{zhang2022pol}.

The continuum limit of the Hofstadter model is obtained by taking $\phi \rightarrow 0^+, \nu \rightarrow 0^+$. In this limit states with Chern number $C$ are equivalent to $C$ filled Landau levels (LLs), and we have
\begin{align}
    \Theta^+_{\OO,\text{LL}} &= 
   % \begin{cases}
        \frac{C^3}{6}-\frac{2C}{3}\mod 2, \;\; \OO = \alpha,\beta
        %\\ 0 \mod 1, & $\OO = \gamma$
   % \end{cases} 
   \label{eq:Theta+LL}
   \\ 
    \Theta^-_{\OO,\text{LL}} &=
    \begin{cases}
        \frac{C^3}{6}+\frac{C^2}{4}-\frac{2C}{3}\mod 4& \OO = \alpha,\beta \\ \frac{C^3}{6}+\frac{C^2}{4}-\frac{C}{6}\mod 2 & \OO = \gamma
    \end{cases}
    . \label{eq:Theta-LL} 
\end{align}
As explained below, we can derive Eqs. \ref{eq:Theta+LL}, \ref{eq:Theta-LL}  analytically using results from CFT and TQFT, and also verify them empirically in our numerical calculations. 
$\Theta^{\pm}_{\OO}$ are closely related to the topological  term $\frac{\ell_{s,\OO}^{\pm}}{4\pi} \omega \wedge d \omega$ which appears in the effective response theory of continuum LLs coupled to an $\text{SO}(2)$ spin connection $\omega$ \cite{Wen1992shift}.

The empirical data for $\Theta^+_{\OO}$ can be fit to precise formulas throughout the square lattice Hofstadter model, which we use to fully color the butterflies in Fig.~\ref{fig:beta_plus},\ref{fig:alpha_plus}. These equations all have the general form
\begin{equation}\label{eq:Theta_full}
    \Theta^{\pm}_{\OO} = \Theta^{\pm}_{\OO,\text{LL}} + \Theta^{\pm}_{\OO,\text{diff}}.
\end{equation}
Eq.~\eqref{eq:Theta_full} indicates that we can express any given state with $C \ne 0$ as a stack of $C$ filled LLs (which contribute $\Theta^{\pm}_{\OO,\text{LL}}$) and a state with zero Chern number (which contributes $\Theta^{\pm}_{\OO,\text{diff}}$). Thus, $\Theta^{\pm}_{\OO,\text{diff}}$ specifies how the given state differs from the limit of $C$ filled LLs.
The empirical formulas for $\Theta^{+}_{\OO,\text{diff}}$ throughout the butterfly are summarized in App.~\ref{app:num}. We have not obtained empirical formulas for $\Theta^-_{\OO,\text{diff}}$ as these are substantially more complicated. 


\paragraph*{Verification using conformal field theory.}
Eqs.~\eqref{eq:Theta+_vs_k3},~\eqref{eq:Theta-_vs_k3} can be analytically derived by using the cut-and-glue approach established in~\cite{Qi2012entanglement}, which describes the entanglement spectrum of the disk subregion in the long wavelength limit by that of the (1+1)D CFT on its edge. That is, the reduced density matrix for the disk subregion $D$ is effectively given by $\rho_{D} =\rho_{\mathrm{CFT}}$,
where $\rho_{\mathrm{CFT}}$ denotes the CFT on the edge of the disk.
The edge of the disk entangled with the complement subsystem is described by a thermal density matrix of a perturbed edge CFT within a fixed topological sector~\cite{Haldane2008entanglement}.
The form of the perturbation in the entanglement Hamiltonian is not universal.
In the following, we assume that the entanglement Hamiltonian is that of the unperturbed CFT: $\rho_{\mathrm{CFT}} = e^{-\beta H}$, and check the validity of this assumption with our numerics.

In accordance with the crystalline equivalence principle \cite{Thorngren2018,manjunath2022mzm}, the $\tilde C_{\MO}$ rotation symmetry acts as a translation symmetry combined with an internal $\Z_{\MO}$ symmetry of the CFT on the boundary of $D$. The expectation value of $\Cmopm$ for the disk $D$ without any additional flux insertion is hence evaluated in terms of the symmetry generators in the CFT as follows:
\begin{equation}
\begin{split}
&\bra{\Psi}\Cmopm|_D\ket{\Psi} = \frac{\mathrm{Tr}[e^{iQ_{\MO}\frac{\pi}{\MO}}e^{i\tilde{P}\frac{L}{\MO}}e^{-\frac{\xi}{v} H}]}{\mathrm{Tr}[e^{-\frac{\xi}{v} H}]} \\
&= e^{-\frac{2\pi i}{24\MO}c_-}\frac{\sum_{a=1,\psi}\chi_a(\frac{i\xi}{L}-\frac{1}{\MO};[\mathrm{AP},0],[\mathrm{AP},1])}{\sum_{a=1,\psi}\chi_a(\frac{i\xi}{L};[\mathrm{AP},0],[\mathrm{AP},0])}
\end{split}
\label{eq:partialrot_as_CFT}
\end{equation}
where we introduced the velocity $v$ of the CFT, finite temperature correlation length of the edge theory $\xi:=\beta v$, the length of the boundary $L=|\partial D|$, and $\{\text{AP,P}\}$ denotes the boundary condition with respect to $\Z_2^f$ fermion parity symmetry. The action of the $\MO$-fold rotation on the CFT is expressed as the combination $e^{iQ_{\MO}\frac{\pi}{\MO}}e^{i\tilde{P}\frac{L}{\MO}}$, where $Q_{\MO}$ generates an internal $\Z_{2\MO}^f$ (resp.~$\Z_{\MO}$) symmetry when we take the rotation symmetry to be $\Cmop$ (resp.~$\Cmom$). $\tilde{P}$ is the normalized translation operator 
\begin{align}
    \tilde{P}:=\frac{1}{v}(H-E_0) = \frac{2\pi}{L}\left[L_0-\frac{c_-}{24}-\langle L_0-\frac{c_-}{24}\rangle\right]
\end{align}
so that $\tilde{P}\ket{\mathrm{vac}}=0$ on the vacuum state $\ket{\mathrm{vac}}$ of the CFT.
$\chi_a(\tau;[s,j],[s',j'])$ with $s,s'\in\{\mathrm{AP},\mathrm{P}\}$, $j,j'\in\Z_{\MO}$ is the CFT character that corresponds to the partition function on a torus equipped with spin structure and $\Z_{\MO}$ gauge field.
As shown in App.~\ref{app:CFT}, the above CFT characters at high temperature $\xi \ll L$ can be evaluated using the modular $S,T$ matrices of the $G$-crossed braided fusion category \cite{barkeshli2019,manjunath2020FQH} describing the invertible phase. Our calculation uses the precise defect sectors of the $G$-crossed modular $S,T$ matrices that correspond to the boundary conditions which define the CFT character; the use of $G$-crossed modularity allows us to readily treat any symmetry action on the state encoded in the classification of fermionic invertible phases in (2+1)D~\cite{barkeshli2021invertible,aasen2021characterization}, some of whose details are missed in Ref.~\cite{shiozaki2017invt}. %\naren{check this}  
The results for even $\MO$ are to leading order given by 
\begin{align}
\bra{\Psi}\Cmop|_D\ket{\Psi}_{\text{CFT}} &\propto 
e^{-\frac{2\pi i}{24}(\MO-\frac{1}{\MO})c_-} \mathcal{I}_{M_{\OO}}^{+} = e^{\frac{2\pi i}{\MO}\Theta_{\OO}^+} \nonumber \\
\bra{\Psi}\Cmom|_D\ket{\Psi}_{\text{CFT}} &\propto e^{-\frac{2\pi i}{24}(\MO+\frac{2}{\MO})c_-} \mathcal{I}_{M_{\OO}}^- = e^{\frac{2\pi i}{\MO} \Theta_{\OO}^-}
\label{eq:mainresultCFT}
\end{align}
where 
\begin{align}
\label{IMeq}
\mathcal{I}_{M_{\OO}}^{\pm} := e^{\frac{2\pi i}{M_{\OO}} \frac{\ell_{s,\OO}^{\pm}}{2}} = e^{\frac{2\pi i}{\MO} \left( (1 \mp 1)\frac{ k_{s,\OO}}{4} + (1 \pm 1) \frac{c_-}{16} + k_{3,\OO}^{\pm} \right)} 
\end{align}
for integers $k^{\pm}_{3,\OO} \in \Z_{\MO}$ and $k_{s,\OO} \in \Z_2$. Eqs. \eqref{eq:mainresultCFT} and \eqref{IMeq} directly give Eqs.~\eqref{eq:Theta+_vs_k3},~\eqref{eq:Theta-_vs_k3}. 
Moreover, we have an equivalence $k^{+}_{3,\OO} \simeq k^{+}_{3,\OO} + \MO/2$ which comes from relabelling symmetry defects in the CFT by fermions, but no such equivalence for $k^{-}_{3,\OO}$.
We set $c_- = C$ to describe the non-interacting Hofstadter model. Combining Eqs.~\eqref{eq:mainresultCFT} and \eqref{IMeq} gives

\begin{align}\label{eq:ells_vs_Theta}
    \ell^{\pm}_{s,\OO} &=\begin{cases}
        \frac{11 \mp 1}{8}C+2\Theta^{\pm}_{\OO} \mod 4 \quad \OO=\alpha,\beta\\
        \frac{1\mp1}{4}C+2\Theta^{\pm}_{\OO} \mod 2\quad \OO=\gamma .
    \end{cases}
\end{align}


\paragraph*{Relation to topological action.}
$\ell^{\pm}_{s,\OO}$ appear in a general topological action which was derived for (2+1)D bosonic topological phases with symmetry $G = \text{U}(1) \times_\phi [\mathbb{Z}^2 \rtimes \mathbb{Z}_M]$ in Refs.~\cite{manjunath2021cgt,manjunath2020FQH}, and extended to invertible fermionic systems in the appendix of Ref.~\cite{zhang2022fractional}. It is written in terms of a $\text{U}(1)$ gauge field $A$, and crystalline gauge fields $(\vec{R},\omega)$. $\omega$ is a background `rotation' gauge field, which is treated as a real field with quantized holonomies. We can define $\omega$ as a $\Z_M$ gauge field or a $\Z_{2M}$ gauge field corresponding to the subgroups of $G$ generated by $\Cmop$ and $\Cmom$ respectively. We use $+$ and $-$ superscripts for the coefficients that appear in the action in each case. The coefficients with supercript $-$ can be obtained by replacing $A \rightarrow A + \omega/2$ in the action with only $+$ superscripts. 

The full action includes a term $\frac{\ell_{s,\OO}^{\pm} - c_-/12}{4\pi} \omega \wedge d\omega$, where
%$\tilde{\ell}^{\pm}_{s,\OO} := \ell^{\pm}_{s,\OO} - \frac{c_-}{12}$. 
$\ell^{\pm}_{s,\OO}$ is quantized mod $\MO$, while $ - \frac{c_-}{12}$ is a contribution from the framing anomaly \cite{witten1989,Gromov2015}. The quantities $\ell^{\pm}_{s,\OO}$ determine the invariant of invertible phases protected purely by rotations about $\OO$ \cite{cheng2018rotation}, and arise in the CFT computation above through the $G$-crossed modular $S, T$ matrices. 
$\ell^{\pm}_{s,\OO}$ are directly related to $\Theta^{\pm}_{\OO}$, by Eq.~\eqref{eq:ells_vs_Theta}.
We defer a discussion of the remaining topological response coefficients, which include an angular momentum polarization $\vec{\mathscr{P}}_{s,\OO}^{\pm}$ and angular momentum filling $\nu_s^{\pm}$, to Ref. \cite{manjunath2023classif}. 




For continuum Landau levels, $\ell^{\pm}_{s,\text{LL}}$ is an origin- independent $\Z$ invariant associated to continuous $\text{SO}(2)$ rotational symmetry. Now $\ell^{+}_{s,\text{LL}}$ is the coefficient of the term $\frac{1}{4\pi} \omega \wedge d\omega$ that arises in the effective action upon integrating out the fermion fields \cite{Wen1992shift}, $\mathcal{L} = \frac{1}{4\pi} \sum_{n=1}^C(A + s_n \omega) \wedge d(A + s_n \omega)$, where $s_n = \frac{2n-1}{2}$ is the spin of the fermion in the $n$th LL; and $\ell^{-}_{s,\text{LL}}$ is similarly obtained after replacing $A \rightarrow A + \omega/2$. Moreover, in the continuum limit of the Hofstadter model, we have
$\ell^{\pm}_{s,\OO,\text{LL}} = \ell^{\pm}_{s,\text{LL}} \mod \MO$. After simplification (see App.~\ref{app:LL}), we obtain 
\begin{align}\label{eq:ls-LL}
    % \mathscr{S}_{\OO,\text{LL}} &= \begin{cases}\frac{C^2}{2} \mod 4 & \tilde{C}_{4,\OO}^4=+1\\
    % & \tilde{C}_{4,\OO}^4=(-1)^F\end{cases} \\
    \ell^+_{s,\OO,\text{LL}} &= \frac{C^3}{3}-\frac{C}{12} \mod \MO \nonumber \\
    \ell^-_{s,\OO,\text{LL}} &= \frac{C^3}{3}+\frac{C^2}{2}+\frac{C}{3} \mod \MO.
\end{align}
Combining Eq.~\eqref{eq:ls-LL} and Eq.~\eqref{eq:ells_vs_Theta} provides the analytical derivation of Eqs.~\eqref{eq:Theta+LL} and~\eqref{eq:Theta-LL}.  


\paragraph*{Classification.} There are various relationships involving $\{\Theta^{\pm}_{\OO}\}$:
\begin{align}
\label{eq:Theta+-}
    2(\Theta^-_{\OO}-\Theta^+_{\OO}) &= \mathscr{S}^+_{\OO} \mod \MO,
\\
\Theta_\alpha^+ + \Theta_\beta^+ &=\Theta_\alpha^- + \Theta_\beta^- + 2 \Theta_\gamma^- - \frac{\kappa}{2} + C  \mod 2. \label{eq:nus+-}
\end{align}
Eqs.~\eqref{eq:Theta+-},~\eqref{eq:nus+-} can be derived in the LL limit (where $\kappa = 0$ but $C \ne 0$) using Eq. \eqref{eq:Theta+LL},~\eqref{eq:Theta-LL} and in the case of $C = 0$ using a real-space Wannier function argument \cite{manjunath2023classif}; combining the two results using linearity under stacking gives ~\eqref{eq:Theta+-},~\eqref{eq:nus+-}. Eq.~\eqref{eq:nus+-} implies that the 5 invariants $\{\Theta^{+}_{\alpha},\Theta^{+}_{\beta},\Theta^{-}_{\alpha},\Theta^{-}_{\beta},\Theta^{-}_{\gamma}\}$ define 4 independent invariants.

Eqs.~\eqref{eq:Theta+_vs_k3},~\eqref{eq:Theta-_vs_k3} imply that $I_1 := 2\Theta_\alpha^- + C/2$, 
$I_2 := \Theta_\alpha^+ + C/2$, and $I_3 := 2 \Theta_\gamma^- + C/2$ are integers modulo $8$, $2$, and $4$, respectively. Additionally,
 $I_4 := \Theta_\alpha^- + \Theta_\beta^- + 2\Theta_\gamma^- - \kappa/2$
is an integer modulo $4$. This can also be established in the LL limit using~\eqref{eq:Theta+LL},~\eqref{eq:Theta-LL} and in the case of $C = 0$ using a real-space Wannier function argument, and finally by combining the two using linearity under stacking. 

The above results imply that $\{I_1, I_2, I_3, I_4\} \in \Z_8 \times \Z_2 \times \Z_4 \times \mathbb{Z}_4$. But note that the overall classification of invertible fermionic phases with $G = \text{U}(1) \times_\phi [\mathbb{Z}^2 \rtimes \mathbb{Z}_4]$ is a group $\Z^3 \times \Z_8 \times \Z_2 \times\Z_4^2$ \cite{zhang2020realspace,manjunath2023classif}. The three $\mathbb{Z}$ invariants are $c_-$, $C$, $\kappa = \nu - \frac{C \phi}{2\pi}$. A subset of this classification which assumes $c_-=0, C=0$ was derived in Ref.~\cite{zhang2020realspace} through a real space construction. The full derivation will be explained in detail in a forthcoming work \cite{manjunath2023classif}, which also shows that $I_1, I_2, I_3, I_4$ are independent. From this, we can conclude that
$\{c_-, C, \kappa, I_1, I_2, I_3, I_4\}$, or equivalently $\{c_-, C, \kappa, \Theta^{\pm}_{\OO}\}$ fully characterize invertible fermionic states with symmetry group $G$.  



\paragraph*{Discussion.} We have obtained the remarkable result that we can extract a \textit{complete} set of invariants (apart from $C,c_-,\nu$) from partial rotations, without inserting any extra magnetic flux or lattice defects. As a corollary, we can extract the previously studied invariants $\mathscr{S}^+_{\OO}, \vec{\mathscr{P}}^+_{\OO}$ in terms of $\{\Theta^{\pm}_{\OO},C,c_-,\nu\}$ as well, using Eq.~\eqref{eq:Theta+-} and the relationships between $\mathscr{S}^+_{\OO}$ and $\vec{\mathscr{P}}^+_{\OO}$ derived in \cite{zhang2022pol}. We also showed how to understand the topological response theory coefficients $\ell^{\pm}_{s,\OO}$ in terms of $\Theta^{\pm}_{\OO}$. 

We can instead study the eigenvalues of a \it global \rm rotation operator on a torus; this was used in \cite{zhang2022fractional,zhang2022pol} to find $\mathscr{S}^+_{\OO},\vec{\mathscr{P}}^+_{\OO}$, and also discussed in Ref.~\cite{herzogarbeitman2022interacting}. Some preliminary results for global rotations are shown in App.~\ref{app:global}; it is unclear how much of the classification can be obtained in this way.


It is worth highlighting that we have extracted $\{\Theta^{\pm}_{\OO}\}$ from a single wave function without requiring the insertion of additional magnetic flux or lattice defects. Note that one can also extract from a single wave function the quantities $c_-$ \cite{Haldane2008entanglement,FQHEDMRG,Qi2012momentumpolarization,Kim2022ccc}, $C$ \cite{shiozaki2017invt,dehghani2021,cian2021,fan2022}, and $\nu$. The above discussion then implies that one can in principle extract all the many-body invariants characterizing an invertible state with $G = \text{U}(1)\times_{\phi}[\Z^2\rtimes \Z_M]$ from a single wavefunction. 

Above, we focused on the square lattice, with $M=4$ and $M_{\OO} = 2$ or 4. For any orientation preserving space group symmetry, we have the following results \cite{manjunath2023classif}. If $\MO = 2, 4, 6$, $\Theta^+_{\OO}$ defines a $\Z_{\MO/2}$ invariant, while $\Theta^-_{\OO}$ defines a $\Z_{2\MO}$ invariant. (This means that if we know $C$, $\Theta^{+}_{\OO}$ and $\Theta^-_{\OO}$ can take $\MO/2$ and $M$ values respectively, although their precise quantization will depend on $C$.) On the other hand, if $\MO = 3$, both $\Theta^+_{\OO}$ and $\Theta^-_{\OO}$ define $\Z_{\MO}$ invariants. In either case, $\{\Theta^{\pm}_{\OO}\}$ along with $C, \nu$ and $c_-$, fully characterize the many-body crystalline invariants of systems with symmetry $\text{U}(1) \times_{\phi} [\mathbb{Z}^2 \rtimes \Z_M]$, and these can be extracted using a single wave function. 


\paragraph*{Acknowledgements.}
This work is supported by NSF CAREER grant (DMR- 1753240), and the Laboratory for Physical Sciences through the Condensed Matter Theory Center. RK is supported by a JQI postdoctoral fellowship at the University of Maryland.

\bibliography{bibliography}
\clearpage
\appendix

\input{appendix}



\end{document}

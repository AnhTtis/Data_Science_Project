
%Defining tikz classes for tree diagrams
\tikzset{
    parent/.style={align=center,text width=3cm,rounded corners=3pt, 
    % l sep = 4mm,
    % s sep = 4mm, 
    % inner sep=4mm
    },
    child/.style={
        align=center,text width=3cm,rounded corners=3pt,
        }}

\colorlet{col1}{white}
\colorlet{col2}{blue!15}
\colorlet{col3}{red!15}
\colorlet{col4}{green!15}
\colorlet{col5}{yellow!15}
\colorlet{colline1}{orange!60}
\colorlet{colline2}{blue!60}
\colorlet{colline3}{brown!60}
\colorlet{colline4}{green!60}
\colorlet{colline5}{gray!60}

\begin{figure*}[!b]
% \vspace{-3mm}
\resizebox*{.98\linewidth}{!}{
\begin{forest}
        for tree={
            grow'=east,
            anchor=west,
            node options={draw, thick, font=\sffamily, align=center, },
            edge={semithick},
            forked edges,
            l sep=8mm, % 横向间隔
            s sep=8mm, % 纵向间距
            % inner xsep = 2mm,
            % inner ysep = 2mm, % 矩形的高度
            text width=2.3cm,
            fork sep = 2mm,           % new, distance from parent to branching point
        },
        [\textbf{Dialogue Safety}, fill=col1, parent, rotate=90,font=\LARGE, 
        for tree={s sep=2.0mm},
        [{\textbf{Safety Issues} \\ \emph{(\S, Table )}}, font=\large,
            for tree={child, fill=col3}, 
            [\textbf{Abusive and Toxic Contents} \\\emph{(\S)}, text width = 3.6cm,
                % for tree = {child, fill = col3,text width = 2.8cm}
                [Sentence-level,fill = col3,text width = 1.8cm
                    [
                    % {WTC \cite{10.1145/3038912.3052591}, BBF \cite{dinan2019build}, UCC \cite{Price}, OLID \cite{Zampieri2019a}, COLD \cite{deng2022cold}},
                    % {WTC, BBF, UCC, OLID, COLD},
                    {BBF , UCC , OLID , COLD , etc.},
                    text width=5.5 cm,draw=colline1,line width=1.2pt,fill=col1,]
                ]
                [Context-Aware,fill = col3,text width = 1.8cm
                    [
                    {TalkDown , BAD , Ad-Hominems , MDRDC , etc.},
                    % {TalkDown, BAD, Ad-Hominems, MDRDC},
                    text width=5.5 cm,draw=colline1,line width=1.2pt,fill=col1,]
                ]
                [Context-Sensitive,fill = col3,text width = 1.8cm
                    [
                    {CCC , DiaSafety , CDialBias , etc.},
                    % {CCC, DiaSafety, CDialBias},
                    text width=5.5 cm,draw=colline1,line width=1.2pt,fill=col1,]
                ]
                [Counter Speech,fill = col3,text width = 1.8cm
                    [{CONAN , MultiTargetCN , InterveneDial , etc.},% \textit{CN-TreeConv?}
                    text width=5.5 cm,draw=colline1,line width=1.2pt,fill=col1,]
                ]
            ]
            [\textbf{Unfairness and Discrimination} \\\emph{(\S)},
                for tree = {child, fill = col3,text width = 3.6 cm}
                [
                    % {Demographic Groups and Attributes, Stereotype and Bias Opinions}, 
                    {CrowdPair, StereoSet, SBIC , Bold, HolisticBias },
                    text width=8.4 cm,draw=colline1,line width=1.2pt,fill=col1,
                ]
            ]
            [\textbf{Ethics and Morality Issues} \\\emph{(\S)},
                for tree = {child, fill = col3,text width = 3.6cm}
                [
                    {Social-Chem-101 , Commonsense Norm Bank, MIC , ProsocialDialog},
                    % {human values, morality, ethics, and social norms},
                    text width=8.4cm,draw=colline1,line width=1.0pt,fill=col1,
                ]
            ]
            [\textbf{Risk of Misleading and Privacy Information} \\\emph{(\S)}, 
                for tree = {child, fill = col3,text width = 3.6cm}
                [{Privacy and Information Leakage, Inappropriate Suggestions , Controversial opinions},
                text width=8.4 cm,draw=colline1 ,line width=1.0pt,fill=col1,
                ]
            ]
        ]
        [\textbf{Safety \\Evaluation} \\\emph{(\S)}, font=\large, for tree={child, fill=col2}
            [\textbf{Expose} \\\emph{(\S)},
                for tree = {child, fill = col2, text width=2.8cm,}
                [Internal Safety Assessment, text width=2.8cm,
                    [{CrowdPair, French CrowSPairs , StereoSet},
                    text width=5.3cm,draw=colline2,line width=1.2pt,fill=col1]
                ]
                [Trigger Unsafe Generation, text width=2.8cm,
                    [{Template-based , Real-world trigger , Human attacker , LM attacker},
                    text width=5.3cm,draw=colline2,line width=1.0pt,fill=col1]
                ]
            ]
            [\textbf{Detection} \\\emph{(\S)},
                for tree = {child, fill = col2,text width=2.8cm}
                [Data-level, text width=2.8cm,
                    [
                    % {Dataset construction, Knowledge enhancement},
                    {Human-in-the-loop, LM generation },
                    text width=5.3cm,draw=colline2,line width=1.2pt,fill=col1]
                    ]
                [Model-level, text width=2.8cm,
                    [{Feature engineering , Finetuning , % Algorithm-based, 
                    LM self-diagnosis },
                    text width=5.3cm,draw=colline2,line width=1.0pt,fill=col1]
                ]
            ]
        ]
        [{\textbf{Safety\\ Improvement} \\\emph{(\S})},font=\large, for tree={child, fill=col5}, 
        [\textbf{E2E Model} \\\emph{(\S\ref{sec:e2emodel})},
            for tree = {child, fill = col5,text width = 2.8cm},
            [
            {Pre-processing, Training phrase , inference\&post-processing },
             text width=9.1cm,draw=colline3,line width=1.0pt,fill=col1]
            ]
        [\textbf{Pipeline System} \\\emph{(\S)},
            for tree = {child, fill = col5,text width = 2.8cm},
            [{Post-edit, Rejection sampling, Hate speech countering, Detection \& safe response},
             text width=9.1cm,draw=colline3,line width=1.0pt,fill=col1]
            ]
        ]
        [\textbf{Challenges} \& \\\textbf{Opportunities} \\ \quad\quad\emph{(\S)},for tree={child, fill=col4,align=left}, % base=left
        [{1) Explainable safety monitoring, ~~~~~~~~~~~2) Continuous learning of safety issues, \\3) Robustness against malicious attacks, ~4) Multimodal information processing, \\5) Unified research framework, ~~~~~~~~~~~~6) Multidisciplinary theory integration},
        text width=13.1cm]
        ]
        ]
        \end{forest}
        }
\caption{Framework for surveying safety issues in dialogue systems.}
% \vspace{-5mm}
\label{fig:frame}
\end{figure*}


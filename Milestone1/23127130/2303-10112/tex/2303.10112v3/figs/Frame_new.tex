
%Defining tikz classes for tree diagrams
\tikzset{
    parent/.style={align=center,text width=3cm,rounded corners=3pt, 
    % l sep = 4mm,
    % s sep = 4mm, 
    % inner sep=4mm
    },
    child/.style={
        align=center,text width=3cm,rounded corners=3pt,
        }}

\colorlet{col1}{white}
\colorlet{col2}{blue!15}
\colorlet{col3}{red!15}
\colorlet{col4}{green!15}
\colorlet{col5}{yellow!15}
\colorlet{colline1}{orange!60}
\colorlet{colline2}{blue!60}
\colorlet{colline3}{brown!60}
\colorlet{colline4}{green!60}
\colorlet{colline5}{gray!60}

\begin{figure*}[!b]
% \vspace{-3mm}
\resizebox*{.98\linewidth}{!}{
\begin{forest}
        for tree={
            grow'=east,
            anchor=west,
            node options={draw, thick, font=\sffamily, align=center, },
            edge={semithick},
            forked edges,
            l sep=8mm, % 横向间隔
            s sep=8mm, % 纵向间距
            text width=2.3cm,
            fork sep = 2mm,           % new, distance from parent to branching point
        },
        [\textbf{Temporal Causal Discovery}, fill=col1, parent, rotate=90,font=\LARGE, 
        for tree={s sep=2.0mm},
        [{\textbf{MTS\\Causal Discovery} \\ \emph{(\S~\ref{sec:mts}, Table~\ref{tab:ts_category_overview})}}, font=\large,
            for tree={child, fill=col3, text width = 4.0cm}, 
            [\textbf{Constraint-Based Approaches} \\\emph{(\S~\ref{subsection:CB})}, text width = 3.6cm,
                [With Causal Sufficiency,fill = col3,text width = 2.8cm
                    [
                    {oCSE~\cite{MTS/CB/oCSE/siamads/0007TB15}, PCGCE~\cite{MTS/others/information_criterion/uai/AssaadDG22}, PCMCI~\cite{MTS/CB/PCMCI_runge2019detecting, MTS/CB/insPCMCI_Runge20}},
                    text width=5.5 cm,draw=colline1,line width=1.2pt,fill=col1,]
                ]
                [Without Causal Sufficiency,fill = col3,text width = 2.8cm
                    [
                    {ANLTSM~\cite{MTS/CB/jmlr_ChuG08}, tsFCI~\cite{MTS/CB/FCI_tsFCI_entner2010causal}, SVAR-FCI~\cite{MTS/CB_FCI_SVAR_FCI_MalinskyS18}, LPCMCI~\cite{MTS/CB/LPCMCI_GerhardusR20}},
                    text width=5.5 cm,draw=colline1,line width=1.2pt,fill=col1,]
                ]
            ]
            [\textbf{Score-Based Approaches} \\\emph{(\S~\ref{subsection:SB})},  text width = 3.6cm,
                for tree = {child, fill = col3,text width = 3.6 cm}
                [Combinatorial Search,fill = col3,text width = 2.8cm
                    [
                    {Structural EM~\cite{MTS/SB/learnDBN/uai/FriedmanMR98}, Greedy Hill-climbling Search~\cite{MTS/SB/CV_DBN_prl/PenaBT05}, Structural Constraints~\cite{MTS/SB/learnDBN/jmlr/CamposJ11}, etc.},
                    text width=5.5 cm,draw=colline1,line width=1.2pt,fill=col1,]
                ]
                [Continuous Optimization,fill = col3,text width = 2.8cm
                    [
                    {DYNOTEARS~\cite{MTS/SB/Dynotears_aistats_PamfilSDPGBA20}, NTS-NOTEARS~\cite{MTS/SB/NTS_NOTEARS}, IDYNO~\cite{MTS/SB/Dynotears_interventionalDATA/icml/GaoBNLY22}},
                    text width=5.5 cm,draw=colline1,line width=1.2pt,fill=col1,]
                ]
            ]
            [\textbf{FCM-Based Approaches} \\\emph{(\S~\ref{subsection:FCM})},
                for tree = {child, fill = col3,text width = 3.6 cm}
                [Independent Component Analysis,fill = col3,text width = 2.8cm
                    [
                    {VAR-LiNGAM~\cite{MTS/FCM/VAR_LINGAM_icml_HyvarinenSH08, MTS/FCM/VAR_LINGAM_v2_jmlr_HyvarinenZSH10}, MCD~\cite{MTS/FCM/ijcai2013/SchaechtleSB13}, NCDH~\cite{MTS/FCM/cikm_WuWWLC22}},
                    text width=5.5 cm,draw=colline1,line width=1.2pt,fill=col1,]
                ]
                [Additive Noise Model,fill = col3,text width = 2.8cm
                    [
                    {TiMINo~\cite{MTS/FCM/nips_PetersJS13},  NBCB~\cite{MTS/FCM_maybe/pkdd/AssaadDGA21}},
                    text width=5.5 cm,draw=colline1,line width=1.2pt,fill=col1,]
                ]
            ]
            [\textbf{Granger Causality \\Based Approaches} \\\emph{(\S~\ref{subsection:Granger_base})}, 
                for tree = {child, fill = col3,text width = 3.6cm}
                [{HSIC-Lasso-GC~\cite{MTS/Granger/Kernel_ren2020novel}, (R)NN-GC~\cite{MTS/Granger/NN_GC_MontaltoSFTPM15, MTS/Granger/RNN_GC_WangLQLFWP18}, MPIR~\cite{MTS/Granger/MPIR_ICML19TS_workshop}, NGC~\cite{MTS/Granger/pamiNGC22}, eSRU~\cite{MTS/Granger/iclr20_esru}, SCGL~\cite{MTS/Granger/SCGL_CIKM_XuHY19}, GVAR~\cite{MTS/Granger/iclr21_GVAR_MarcinkevicsV}, TCDF~\cite{MTS/Attention/TCDF_NautaBS19}, CR-VAE~\cite{MTS/Granger/CR_VAE2023}, InGRA~\cite{MTS/Attention/icdm_InGRA_ChuWMJZY20}, ACD~\cite{Discussion/NewForm/ACD_LoweMSW22}, etc.},
                text width=9.4 cm,draw=colline1 ,line width=1.0pt,fill=col1,
                ]
            ]
            [\textbf{Others} \\\emph{(\S~\ref{subsection:MTS_others})}, 
                for tree = {child, fill = col3,text width = 3.6cm}
                [{Information-theoretic Statistics~\cite{TE_origin/schreiber2000measuring, MTS/others/information/PRE_runge2012quantifying, MTS/Others/concepts/causationEntropy/sun2014causation}, Differential Equation Based Methods~\cite{MTS/others/difference_based/uai/VoortmanDD10, MTS/Others/NGM_neuralode_iclr_BellotBS22}, Nonlinear State-space Methods~\cite{MTS/CCM/work2_main_science_sugihara2012detecting}, Logic-based Methods~\cite{MTS/logic/uai/KleinbergM09}, Hybrid Methods~\cite{MTS/SB/MMHO_DBN/tcbb/LiCZN16}, etc.},
                text width=9.4 cm,draw=colline1 ,line width=1.0pt,fill=col1,
                ]
            ]
        ]
        [\textbf{Event Sequence Causal Discovery} \\\emph{(\S~\ref{sec:event})}, font=\large,  for tree={child, fill=col2, text width = 4.0cm} % text width = 4.0cm,
            [\textbf{Multivariate Point Process} \\\emph{(\S~\ref{subsec:MPP})},
                for tree = {child, fill = col2, text width=3.6cm,}
                [{Basics: Intensity Function, Log-likelihood},
                text width=9.4 cm,draw=colline1 ,line width=1.0pt,fill=col1,
                ]
            ]
            [\textbf{Granger Causality\\Based Approaches} \\\emph{(\S~\ref{subsec:event_Granger})},
                for tree = {child, fill = col2,text width=3.6cm}
                [GLM Point Process, text width=2.8cm,
                    [
                    % {Dataset construction, Knowledge enhancement},
                    {GLM Model~\cite{10.1371/journal.pcbi.1001110}},
                    text width=5.5cm,draw=colline2,line width=1.2pt,fill=col1]
                    ]
                [Hawkes Process, text width=2.8cm,
                    [{MLE-SGLP~\cite{pmlr-v48-xuc16}, THP~\cite{Cai2021THPTH}, $L_0$Hawkes~\cite{NEURIPS2021_15cf7646}, HGEM~\cite{pmlr-v138-yu20a}, NPHC~\cite{pmlr-v70-achab17a}, GC-nsHP~\cite{CHEN202222}, MDLH~\cite{Schindler_Plant_2022}, etc.},
                    text width=5.5cm,draw=colline2,line width=1.0pt,fill=col1]
                ]
                [Wold Process, text width=2.8cm,
                    [{Granger-Busca~\cite{NEURIPS2018_aff0a6a4}, VI-MWP~\cite{pmlr-v130-etesami21a}},
                    text width=5.5cm,draw=colline2,line width=1.0pt,fill=col1]
                ]
                [Neural Point Process, text width=2.8cm,
                    [{CAUSE~\cite{pmlr-v119-zhang20v}},
                    text width=5.5cm,draw=colline2,line width=1.0pt,fill=col1]
                ]
            ]
            [\textbf{Others} \\\emph{(\S~\ref{subsec43})},
                for tree = {child, fill = col2,text width=3.6cm}
                [Constraint-Based Approaches, text width=2.8cm,
                    [
                    {MMP-LR/NI~\cite{Bhattacharjya2022ProcessIT}, CA~\cite{article}},
                    text width=5.5cm,draw=colline2,line width=1.2pt,fill=col1]
                    ]
                [Score-Based Approaches, text width=2.8cm,
                    [{PGEM~\cite{NEURIPS2018_f1ababf1}},
                    text width=5.5cm,draw=colline2,line width=1.0pt,fill=col1]
                ]
            ]
        ]
        [{\textbf{Applications} \\\emph{(\S~\ref{sec:app}, Table~\ref{tab:application_overview})}},font=\large, for tree={child, fill=col5, text width = 4.0cm}, 
            [\textbf{Scientific Endeavors}, % \\\emph{(\S)},
            for tree = {child, fill = col5,text width = 3.6cm},
                [
                {Earth Science, Neuroscience, Bioinformatics, etc.},
                 text width=9.4cm,draw=colline3,line width=1.0pt,fill=col1]
                ]
            [\textbf{Industrial\\Implementations}, % \\\emph{(\S~\ref{})},
                for tree = {child, fill = col5,text width = 3.6cm},
                [{Anomaly Detection, Root Cause Analysis, Business Intelligence in Online Systems, Video Analysis, Urban Data Analysis, Clinical Data Analysis, etc.},
                 text width=9.4cm,draw=colline3,line width=1.0pt,fill=col1]
            ]
        ]
        [{\textbf{Discussions}\ \&\\\textbf{New Perspectives} \\ \emph{(\S~\ref{sec:discuss})} }, font=\large, for tree={child, fill=col4, text width = 4.0cm}, % base=left
            [\textbf{Challenges \& Practical Considerations} \\\emph{(\S~\ref{subsec:challenges})},
                for tree = {child, fill = col4, text width=3.6cm,}
                [{1) Non-stationarity, 2) Heterogeneity, 3) Unobserved Confounders, 4) Subsampling, 5) Expert Knowledge},
                text width=9.4 cm,draw=colline4 ,line width=1.0pt,fill=col1,
                ]
            ]
            [\textbf{New Perspectives}  \\\emph{(\S~\ref{subsec:newper})},
                for tree = {child, fill = col4,text width = 3.6cm}
                [{1) Amortized Paradigm, 2) Supervised Paradigm, 3) Causal Representation Learning},
                 text width=9.4cm,draw=colline4,line width=1.0pt,fill=col1]
            ]
        ]
        ]
        \end{forest}
} 
\caption{Framework for causal discovery from temporal data. }
% \vspace{-5mm}
\label{fig:frame}
\end{figure*}


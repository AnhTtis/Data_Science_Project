\documentclass[journal]{IEEEtran}

\usepackage{amsmath, amsfonts, amssymb, amscd}
\usepackage[usenames,dvipsnames]{color} 

\usepackage[capitalize]{cleveref}
\usepackage{longtable}
\usepackage{multicol}
\usepackage{pdfpages}
\usepackage[utf8]{inputenc}

\usepackage{graphics}
\usepackage{subfigure}
\usepackage{tikz}

\usepackage{pgfplots}
\usetikzlibrary{pgfplots.fillbetween}
\pgfplotsset{scaled x ticks=false}
\pgfplotsset{compat=newest}
\pgfplotsset{every axis/.append style={axis on top}}
\setlength{\unitlength}{1in} 
\usepgfplotslibrary{groupplots}

\usepackage{nomencl}
\usepackage{enumerate}
\usepackage{cancel}

\usepackage[none]{hyphenat}

\usepackage[style=ieee, url=false, doi=false]{biblatex}
\renewcommand*{\bibfont}{\footnotesize}
\addbibresource{IEEEfull.bib}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newif\ifdraft

% For final version, replace next line by \draftfalse
% \drafttrue for draft version with comments
\drafttrue
% \draftfalse
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% *** MISC UTILITY PACKAGES ***
%
%\usepackage{ifpdf}
% Heiko Oberdiek's ifpdf.sty is very useful if you need conditional
% compilation based on whether the output is pdf or dvi.
% usage:
% \ifpdf
%   % pdf code
% \else
%   % dvi code
% \fi
% The latest version of ifpdf.sty can be obtained from:
% http://www.ctan.org/pkg/ifpdf
% Also, note that IEEEtran.cls V1.7 and later provides a builtin
% \ifCLASSINFOpdf conditional that works the same way.
% When switching from latex to pdflatex and vice-versa, the compiler may
% have to be run twice to clear warning/error messages.


% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  % \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi
% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/pkg/graphicx
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/pkg/epslatex
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). The IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex




% *** SPECIALIZED LIST PACKAGES ***
%
%\usepackage{algorithmic}
% algorithmic.sty was written by Peter Williams and Rogerio Brito.
% This package provides an algorithmic environment fo describing algorithms.
% You can use the algorithmic environment in-text or within a figure
% environment to provide for a floating algorithm. Do NOT use the algorithm
% floating environment provided by algorithm.sty (by the same authors) or
% algorithm2e.sty (by Christophe Fiorio) as the IEEE does not use dedicated
% algorithm float types and packages that provide these will not provide
% correct IEEE style captions. The latest version and documentation of
% algorithmic.sty can be obtained at:
% http://www.ctan.org/pkg/algorithms
% Also of interest may be the (relatively newer and more customizable)
% algorithmicx.sty package by Szasz Janos:
% http://www.ctan.org/pkg/algorithmicx



% *** ALIGNMENT PACKAGES ***
%
%\usepackage{array}
% Frank Mittelbach's and David Carlisle's array.sty patches and improves
% the standard LaTeX2e array and tabular environments to provide better
% appearance and additional user controls. As the default LaTeX2e table
% generation code is lacking to the point of almost being broken with
% respect to the quality of the end results, all users are strongly
% advised to use an enhanced (at the very least that provided by array.sty)
% set of table tools. array.sty is already installed on most systems. The
% latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/array


% IEEEtran contains the IEEEeqnarray family of commands that can be used to
% generate multiline equations as well as matrices, tables, etc., of high
% quality.



% *** FLOAT PACKAGES ***
%
%\usepackage{fixltx2e}
% fixltx2e, the successor to the earlier fix2col.sty, was written by
% Frank Mittelbach and David Carlisle. This package corrects a few problems
% in the LaTeX2e kernel, the most notable of which is that in current
% LaTeX2e releases, the ordering of single and double column floats is not
% guaranteed to be preserved. Thus, an unpatched LaTeX2e can allow a
% single column figure to be placed prior to an earlier double column
% figure.
% Be aware that LaTeX2e kernels dated 2015 and later have fixltx2e.sty's
% corrections already built into the system in which case a warning will
% be issued if an attempt is made to load fixltx2e.sty as it is no longer
% needed.
% The latest version and documentation can be found at:
% http://www.ctan.org/pkg/fixltx2e


%\usepackage{stfloats}
% stfloats.sty was written by Sigitas Tolusis. This package gives LaTeX2e
% the ability to do double column floats at the bottom of the page as well
% as the top. (e.g., "\begin{figure*}[!b]" is not normally possible in
% LaTeX2e). It also provides a command:
%\fnbelowfloat
% to enable the placement of footnotes below bottom floats (the standard
% LaTeX2e kernel puts them above bottom floats). This is an invasive package
% which rewrites many portions of the LaTeX2e float routines. It may not work
% with other packages that modify the LaTeX2e float routines. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/stfloats
% Do not use the stfloats baselinefloat ability as the IEEE does not allow
% \baselineskip to stretch. Authors submitting work to the IEEE should note
% that the IEEE rarely uses double column equations and that authors should try
% to avoid such use. Do not be tempted to use the cuted.sty or midfloat.sty
% packages (also by Sigitas Tolusis) as the IEEE does not format its papers in
% such ways.
% Do not attempt to use stfloats with fixltx2e as they are incompatible.
% Instead, use Morten Hogholm'a dblfloatfix which combines the features
% of both fixltx2e and stfloats:
%
% \usepackage{dblfloatfix}
% The latest version can be found at:
% http://www.ctan.org/pkg/dblfloatfix



%\ifCLASSOPTIONcaptionsoff
%  \usepackage[nomarkers]{endfloat}
% \let\MYoriglatexcaption\caption
% \renewcommand{\caption}[2][\relax]{\MYoriglatexcaption[#2]{#2}}
%\fi
% endfloat.sty was written by James Darrell McCauley, Jeff Goldberg and 
% Axel Sommerfeldt. This package may be useful when used in conjunction with 
% IEEEtran.cls'  captionsoff option. Some IEEE journals/societies require that
% submissions have lists of figures/tables at the end of the paper and that
% figures/tables without any captions are placed on a page by themselves at
% the end of the document. If needed, the draftcls IEEEtran class option or
% \CLASSINPUTbaselinestretch interface can be used to increase the line
% spacing as well. Be sure and use the nomarkers option of endfloat to
% prevent endfloat from "marking" where the figures would have been placed
% in the text. The two hack lines of code above are a slight modification of
% that suggested by in the endfloat docs (section 8.4.1) to ensure that
% the full captions always appear in the list of figures/tables - even if
% the user used the short optional argument of \caption[]{}.
% IEEE papers do not typically make use of \caption[]'s optional argument,
% so this should not be an issue. A similar trick can be used to disable
% captions of packages such as subfig.sty that lack options to turn off
% the subcaptions:
% For subfig.sty:
% \let\MYorigsubfloat\subfloat
% \renewcommand{\subfloat}[2][\relax]{\MYorigsubfloat[]{#2}}
% However, the above trick will not work if both optional arguments of
% the \subfloat command are used. Furthermore, there needs to be a
% description of each subfigure *somewhere* and endfloat does not add
% subfigure captions to its list of figures. Thus, the best approach is to
% avoid the use of subfigure captions (many IEEE journals avoid them anyway)
% and instead reference/explain all the subfigures within the main caption.
% The latest version of endfloat.sty and its documentation can obtained at:
% http://www.ctan.org/pkg/endfloat
%
% The IEEEtran \ifCLASSOPTIONcaptionsoff conditional can also be used
% later in the document, say, to conditionally put the References on a 
% page by themselves.




% *** PDF, URL AND HYPERLINK PACKAGES ***
%
%\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/url
% Basically, \url{my_url_here}.



% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
% There should be no need to do such things with IEEEtran.cls V1.6 and later.
% (Unless specifically asked to do so by the journal or conference you plan
% to submit to, of course. )


\begin{document}

\title{Inferring Traffic Models in Terminal Airspace \\ from Flight Tracks and Procedures}

\author{Soyeon~Jung~and~Mykel~J.~Kochenderfer
\thanks{Manuscript received TODO.}
\thanks{
This material is based upon work supported by the Department of the Air Force under Air Force Contract FA8702-15-D-0001.
Opinions, findings, conclusions and recommendations are those of the authors and do not necessarily reflect the views of the Department of the Air Force.
}
\thanks{The authors are with the Stanford Intelligent Systems Laboratory in the Department of Aeronautics and Astronautics, Stanford University, Stanford, CA 94305 USA
(e-mail: soyeonjung429@gmail.com, mykel@stanford.edu).}}


% The paper headers
\markboth{IEEE Transactions on Intelligent Transportation Systems} %,~Vol.~14, No.~8, August~2015}%
{Jung and Kochenderfer: }
% The only time the second header will appear is for the odd numbered pages
% after the title page when using the twoside option.
% 
% *** Note that you probably will NOT want to include the author's ***
% *** name in the headers of peer review papers.                   ***
% You can use \ifCLASSOPTIONpeerreview for conditional compilation here if
% you desire.


% If you want to put a publisher's ID mark on the page you can do it like
% this:
%\IEEEpubid{0000--0000/00\$00.00~\copyright~2015 IEEE}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark.

% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}

\maketitle

\begin{abstract}
Realistic aircraft trajectory models are useful in the design and validation of air traffic management (ATM) systems. 
Models of aircraft operated under instrument flight rules (IFR) require capturing the variability inherent in how aircraft follow standard flight procedures.
The variability in aircraft behavior varies among flight stages.
In this paper, we propose a probabilistic model that can learn the variability from the procedural data and flight tracks collected from radar surveillance data.
For each segment, a Gaussian mixture model is used to learn the deviations of aircraft trajectories from their procedures.
Given new procedures, we can generate synthetic trajectories by sampling a series of deviations from the trained Gaussian distributions and reconstructing the aircraft trajectory using the deviations and the procedures.
We extend this method to capture pairwise correlations between aircraft and show how a pairwise model can be used to generate traffic involving an arbitrary number of aircraft.
We demonstrate the proposed models on the arrival tracks and procedures of the John F. Kennedy International Airport.
The distributional similarity between the original and the synthetic trajectory dataset was evaluated using the Jensen--Shannon divergence between the empirical distributions of different variables.
We also provide qualitative analyses of the synthetic trajectories generated from the models.
\end{abstract}

% Note that keywords are not normally used for peerreview papers.
\begin{IEEEkeywords}
Air traffic control, trajectory modeling, Gaussian mixture model, conditional distribution, generative model, probabilistic model, machine learning, unsupervised learning.
\end{IEEEkeywords}

% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
% \IEEEpeerreviewmaketitle

\newlength\figureheight
\newlength\figurewidth


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\IEEEPARstart{T}{he} Federal Aviation Administration's (FAA) Next Generation Air Transportation System (NextGen) \cite{FAAnextgen} and EUROCONTROL's Single European Sky ATM Research Program (SESAR) \cite{Sesar} have led the modernization of global air traffic management (ATM) systems.
A cornerstone of these systems is a trajectory-based operations (TBO) concept, which manages air traffic based on four-dimensional trajectory (4DT) information, consisting of a series of three-dimensional coordinates (latitude, longitude, and altitude) with an added time variable.
Constructing robust aircraft trajectory models is important for the successful implementation of modern ATM systems. 
These trajectory models can be useful for developing new concepts of operation, flight planning, aircraft scheduling, and conflict detection. 

The trajectory models should be able to represent aircraft behavior following real operations.
Aircraft operated under instrument flight rules (IFR) are instructed to follow standard flight procedures, defined as a series of virtual waypoints.
However, the actual paths flown by each aircraft vary due to various factors such as pilot behavior, weather, and preferences of air traffic controllers. 
Aircraft trajectory models should capture this variability as well as the general tendency of aircraft to follow the procedures.

Furthermore, the variability of aircraft behavior differs between flight stages.
For example, during the initial approach, aircraft tend to have high variability in following procedures because they are converging from various directions to the landing runway, and they can be radar vectored to the final approach course.
In contrast, aircraft on final approach have low variability because they need to stay aligned with the runway to land safely.


Various approaches have been proposed for modeling aircraft trajectories.
Traditional methods explicitly model aircraft behavior based on kinematic equations of motion.
Several studies predicted the nominal trajectory by propagating the state estimates into the future \cite{chatterji1996route, chatterji1999short} or to the next flight segments \cite{slattery1997trajectory}.
Aircraft performance models, such as Base of Aircraft Data (BADA) \cite{nuic2010user}, were also developed based on aircraft dynamics models for trajectory simulation and prediction.
These physics-based approaches do not account for the uncertainties that lie in aircraft trajectory prediction \cite{yepes2007new}.

Recent efforts have developed probabilistic methods for modeling aircraft behavior.
Some studies involved learning aircraft dynamics or navigational intent based on dynamic Bayesian networks to account for the uncertainty in the future states of aircraft \cite{liu2011probabilistic,kochenderfer2008uncorrelated,weinert2013uncorrelated,  lowe2015learning, mahboubi2017learning}.
Researchers also applied supervised learning algorithms such as regression models \cite{kun20084, hamed2013statistical}, neural networks \cite{le1999using}, and generalized linear models (GLM) \cite{de2013machine} to predict future trajectories or the estimated times of arrival.

Taking advantage of the large amount of historical data available, a few recent studies presented recurrent neural networks (RNNs) to learn spatiotemporal patterns of aircraft trajectories \cite{liu2018predicting, pang2019aircraft}.
Another recent study applied generative adversarial imitation learning (GAIL) to learn the optimal policy given historical trajectories from expert demonstrations \cite{bastas2020data}.
Other researchers proposed unsupervised clustering algorithms such as $k$-means clustering \cite{gariel2011trajectory}, hierarchical clustering \cite{hong2015trajectory}, and Gaussian mixture models (GMMs) \cite{mahboubi2017learning, Barratt2019}.
Some of them clustered turning points extracted from trajectories represented as a sequence of these clusters \cite{gariel2011trajectory} or transitions from one another \cite{mahboubi2017learning}.
Others clustered the entire trajectories directly using position measurements \cite{hong2015trajectory, conde2016trajectory, Barratt2019}.

Much of the prior work on trajectory models have not focused on the relation between aircraft trajectories and flight procedures.
The procedures, however, are the basis of air traffic control that facilitates control over many aircraft.
In our recent work \cite{Jung2019}, we proposed a probabilistic model that learns aircraft behavior in relation to procedures directly from recorded radar flight tracks and standard procedural data. 
We fit a GMM to learn a sequence of deviations between aircraft trajectory points and corresponding points on the flight procedure.
To accommodate the varying relationship between aircraft trajectories and procedures over multiple flight stages, we segmented aircraft trajectories for each flight stage and fit a separate model for each segment.

This paper extends the trajectory model from our prior work to incorporate multiple aircraft into full traffic scenes. 
We fit GMMs for pairs of trajectories and generate multiple trajectories by combining the mean vectors and covariance matrices of the pairwise GMMs.
This approach allows us to efficiently generate an arbitrary number of trajectories using a single model.
In addition, we further develop the trajectory model by performing a low-rank approximation for the covariance matrices in GMMs.
This technique helps avoid feature redundancy and improve robustness of the model.

The remainder of this paper is structured as follows. Section \ref{sec:dataset} describes the trajectory and procedure data.
Section \ref{sec:single trajectory model} outlines the single trajectory model with discussions on the approximation method and synthetic trajectory generation method.
Section \ref{sec:multiple trajectory model} then extends the single trajectory model to incorporate multiple aircraft.
Section \ref{sec:experiments} presents experimental results, and section \ref{sec:conclusions} closes with a summary and future works.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Trajectory and Procedure Data}
\label{sec:dataset}
\subsection{Trajectory Data}
In this paper, we use a trajectory dataset that is generated from the Federal Aviation Administration (FAA) multisensor fusion tracker \cite{jagodnik2008fusion}.
The tracker collects radar detections from multiple sensors (primary radar, mode A/C and S transponders, wide area multilateration systems, and ADS-B receivers) and fuses them into a set of flight tracks.
Each track contains timestamped entries of the target address (used to group entries into flights), aircraft ID (if available), latitude and longitude (in WGS84), pressure altitude, geometric altitude (if available), and horizontal and vertical velocities.
The data were collected for six months starting March 2012 from three locations: Central Florida, New York City, and Southern California.
We focus on the vicinity of John F. Kennedy International Airport (KJFK), located within the New York Class B airspace that includes Newark Liberty International Airport (KEWR) and LaGuardia Airport (KLGA).

We process the track data as follows. First, the latitude-longitude-altitude coordinates of each position measurement are transformed to the local east-north-up (ENU) coordinates centered at the airport.
Next, we extract trajectories that enter into the airspace defined as 25 NM from the airport center.
The trajectories are then sorted into arrivals, departures, and overflights, based on the change in distance to the airport and altitude over time.
Finally, we separate the trajectories based on the runways: 04L/22R, 04R/22L, 13L/31R, and 13R/31L.
Fig. \ref{fig:jfk_arrivals_hist} shows the lateral view of a log-histogram of all arrival flight tracks to KJFK.
The origin indicates the center of the airport and the blue lines indicate the runways in use.
\begin{figure}[bt]
\centering
\setlength\figureheight{7cm}
\setlength\figurewidth{7cm}
\input{figures/jfk_all_original_hist.tex}
\caption{Log-histogram of all actual arrival tracks of KJFK.}
\label{fig:jfk_arrivals_hist}
\end{figure}

\subsection{Flight Procedure Data}
Another dataset used in this paper is the standard flight procedures published by the air navigation service providers (e.g., the FAA). 
The procedures are defined as a set of waypoints, fixed points in 2D space (latitude and longitude). Each aircraft is instructed to fly from one waypoint to the next along the procedure.
With the arrival traffic, two types of standard flight procedures are involved: standard terminal arrival routes (STARs) and instrument approach procedures (IAPs).
A STAR connects the end of an airway from the en-route airspace to the vicinity of the airport.
An IAP, used for the final approach, allows the pilots to align the aircraft with the runway, make final descend, and land safely in low visibility conditions. 
For the integration of multiple traffic approaching and the smooth transition of each aircraft from a STAR to an IAP, air traffic controllers (ATC) often provide radar vectoring (i.e., guide aircraft by assigning headings, altitudes, and speeds).

For KJFK, only the final approach and radar vectoring stages fall in the range of 25 NM from the airport.
Since there are no standard procedures published for radar vectoring, we take the nominal paths extracted from the actual trajectory set as the radar vector procedures.
To extract the nominal paths, we cluster the trajectory set using $k$-means and then manually select the ones representative of the flight patterns.
Fig. \ref{fig:jfk_04R_orginal_paths} shows the arrival traffic to runway 04R of KJFK and the associated procedures overlaid on them.
The radar vector procedures are indicated with blue dotted lines, while the IAP is indicated with a white dashed line with orange edges.
\begin{figure}[bt]
\centering
\setlength\figureheight{7cm}
\setlength\figurewidth{7cm}
\input{figures/jfk_04R_original_hist_paths.tex}
\caption{Log-histogram of actual arrival tracks to KJFK 04R and associated flight procedures.}
\label{fig:jfk_04R_orginal_paths}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Single Trajectory Model}
\label{sec:single trajectory model}
This section outlines our method to learn the distribution of aircraft trajectories relative to their flight procedures and to generate synthetic traffic scenarios. 
The interactions between multiple aircraft are not considered in this section.

\subsection{Construction of Input Vector}
\label{subsec:input vector construction}
Prior to training a separate Gaussian mixture model for each flight stage, we need to construct the input vector sets in proper format. 
First, each aircraft trajectory is divided into radar vector and final approach segments based on the distance to its IAP.
Then the radar vector trajectory is assigned to one of the radar vector procedures using dynamic time warping (DTW) \cite{Muller2007}.

DTW is an algorithm for measuring similarity between two temporal sequences, which may vary in length
It finds the shortest distance between them using a dynamic programming approach.
Given a pair of vectors ${x_1=[x_1^{(1)},\ldots, x_1^{(m)}] \in \mathbb{R}^m}$ and ${x_2=[x_2^{(1)}, \ldots, x_2^{(n)}] \in \mathbb{R}^n}$, the DTW distance between them is computed as
\begin{equation}
    DTW(x_1, x_2) = D(m, n)
\end{equation}
where for all ${i \in \{1,\ldots,m\},\ j \in \{1,\ldots,n\}}$,
\begin{equation}
    D(i, j) = \lVert x_1^{(i)} - x_2^{(j)} \rVert_2 + \min \begin{cases}
        D(i, j-1) \\ D(i-1, j) \\ D(i-1, j-1).
    \end{cases}
\end{equation}
After measuring the DTW distances between the radar vector trajectory and each of the radar vector procedures, we label the trajectory as the procedure with the shortest DTW distance from it.

Now with the two sets of aircraft trajectory-procedure pairs, one for each flight stage, we would like to train a GMM that takes as input the sequence of deviations between aircraft positions and the procedure points.
One challenge for training a GMM is that all the input vectors are required to be of the same length.
To deal with the issue of varying lengths of trajectories, we separately interpolate each dimension in an aircraft trajectory as a polynomial function of time, and then re-sample a fixed number of points.
We also generate the procedural trajectories by interpolating the waypoints of the procedures and re-sampling the same number of points.
To integrate time into the spatial procedural trajectories of IAPs, we extract aircraft trajectories that pass really close to all the waypoints and take their mean. The radar vector procedures already involve temporal factors because the procedures are defined as the nominal paths extracted from aircraft trajectories.
For the interpolation, we use the piecewise cubic Hermite interpolation method. This method fits a cubic polynomial for each piece of the given function and imposes the continuity of the first derivative.
It preserves monotonicity and avoids oscillation on the intervals where the data is monotonic.
This property makes the piecewise cubic Hermite interpolation method appropriate for interpolating trajectory data, especially the procedural trajectories, which should not oscillate between the sample points.

Finally, we have two sets of training input vectors. An individual input ${\tau \in \mathbb{R}^{3T+2}}$ is defined as
\begin{align}
\begin{split}
\tau = &[t, d, (x_1-x_1^p), (y_1-y_1^p), (z_1-z_1^p),\\
&\ldots,(x_T-x_T^p), (y_T-y_T^p), (z_T-z_T^p)]
\end{split}
\label{eq:single_model_training_data}
\end{align}
where $t$ and $d$ are the transit time and the total distance of the trajectory,
$[x_{1:T}, y_{1:T}, z_{1:T}]$ are the ENU coordinates of the aircraft trajectory at each timestep from 1 to $T$, and $[x_{1:T}^p, y_{1:T}^p, z_{1:T}^p]$ are the ENU coordinates of the corresponding procedural trajectory. 
We keep the transit time and total distance information of each trajectory so that we can later generate synthetic trajectories with reasonable airspeed.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Gaussian Mixture Model}
\label{subsec:GMM}

The Gaussian mixture model (GMM) is a probabilistic generative model which assumes the data points are generated from a mixture of Gaussian distributions.
This model is capable of representing the multimodality and the uncertainty of complex data distributions.
Also, it can generate samples that capture representative characteristics of the training data.
These advantages align with our objectives of modeling the aircraft behavior and generating realistic trajectories. 

For each flight stage, we construct a GMM with a set of training input vectors defined as (\ref{eq:single_model_training_data}).
If a single vector $\tau$ is sampled from $K$ mixture components, the marginal probability distribution of $\tau$ is 
\begin{align}
    \label{eq:gmm}
    p(\tau) = \sum_{j=1}^K \pi_j \mathcal{N}(\tau \mid \mu_j, \Sigma_j)
\end{align}
where ${\pi_j}$ are mixing coefficients that must satisfy ${ {\textstyle\sum}_{j=1}^{K} \pi_j=1}$ and ${\pi_j \geq 0}$ for all ${j \in \{1,\ldots,K\}}$.
Each Gaussian density ${\mathcal{N}(\tau  \mid \mu_j, \Sigma_j)}$ is called a component of the mixture.
The maximum likelihood estimates of the parameters ${\{\pi_j, \mu_j, \Sigma_j\}}$ for all $j$ given a dataset of the observations are obtained using the expectation-maximization (EM) algorithm \cite{dempster1977maximum}.

Our model learns the sequence of deviations (i.e., relative positions) of an aircraft from the corresponding points of the procedure. Fig. \ref{fig:gmm_deviations} shows an example sequence of deviations. 
The aircraft positions and the procedure points are indicated by black and blue crosses respectively, and the deviations are indicated by red dotted lines.
\begin{figure}[tb!]
\centering
\setlength\figureheight{4.8cm}
\setlength\figurewidth{6.3cm}
\input{figures/gmm_dev.tex}
\caption{Example sequence of deviations between aircraft and procedural trajectory.}
\label{fig:gmm_deviations}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Low-rank Approximation of Covariance Matrices}
\label{subsec:low-rank approximation}
Derived from the aircraft and procedural trajectories as in (\ref{eq:single_model_training_data}), the input data matrix of our model is likely to be high-dimensional and contain redundant features.
Also, the model can overfit to the noise in the training set. %sparsity
To eliminate redundant features and reduce overfitting, we perform a low-rank approximation for each covariance matrix of our GMM in Section \ref{subsec:GMM} using eigenvalue decomposition. 

Consider the covariance of the $j$th Gaussian component ${\Sigma_j \in \mathbb{R}^{n \times n}}$.
The eigenvalue decomposition of ${\Sigma_j}$ is
\begin{align}
    \begin{split}
    \Sigma_j = Q\Lambda Q^{-1} &= Q\Lambda Q^T
    = \sum_{i=1}^n \lambda_i q_i q_i^T
    \end{split}
\end{align}
where ${\Lambda = \text{diag}(\lambda_1, \ldots, \lambda_n) \in \mathbb{R}^{n \times n}}$ is a diagonal matrix with eigenvalues in decreasing order, and ${Q \in \mathbb{R}^{n \times n}}$ is a matrix of the associated eigenvectors.

The best rank-${k}$ (${k \leq n}$) approximation of ${\Sigma_j}$ is obtained by 
\begin{align}
    \widehat{\Sigma}_j = Q_k \Lambda_k Q_k^{-1}
\end{align}
where ${\Lambda_k \in \mathbb{R}^{k \times k}}$ is a diagonal matrix with the largest $k$ eigenvalues, and the columns of ${Q_k \in \mathbb{R}^{n \times k}}$ are the first $k$ eigenvectors.
This is closely related to principal component analysis (PCA) where the $k$ principal axes, a set of orthonormal axes onto which the projection of the original data maximizes variance, are given by the first $k$ eigenvectors.
We can obtain equivalent results from performing a singular value decomposition of $\tau_j$, a set of data vectors assigned to the $j$th Gaussian component.

While the eigenvalue decomposition or PCA provide an analytical solution, both require the rank $k$ to be specified. 
To determine the optimal rank $k^*$ from the observed data rather than setting a specific value for $k$, we adopt the probabilistic principal component analysis (PPCA), a probabilistic formulation of PCA based on a latent variable model \cite{tipping1999mixtures}.

Consider a dataset ${x = \{x_i\}_{i=1}^m \in \mathbb{R}^{m \times n}}$ of $m$ observations.
PPCA assumes that each observation ${x_i \in \mathbb{R}^n}$ is generated from a low-dimensional latent variable ${z_i \in \mathbb{R}^k}$ (${k<n}$) via the following model. For ${i \in \{1,...,m\}}$, 
\begin{align}
    \label{eq:ppca}
    x_i &= W z_i+\mu+\varepsilon_i
\end{align}
where ${z_i \sim \mathcal{N}(0,I)}$ is a Gaussian latent variable with unit variance, 
${W \in \mathbb{R}^{n \times k}}$ is the weight matrix explaining the dependencies between latent and observed variables,
${\mu \in \mathbb{R}^n}$ is the location parameter that shifts the data,
and ${\varepsilon_i \sim \mathcal{N}(0, \sigma^2 I)}$ is an isotropic Gaussian noise unique to each observed variable.
From (\ref{eq:ppca}), we can compute the following conditional and marginal distributions:
\begin{align}
    \begin{split}
    x_i \mid z_i &\sim \mathcal{N}(W z_i+\mu, \sigma^2 I)\\
    x_i &\sim \mathcal{N}(\mu, WW^T + \sigma^2 I).
    \end{split}
\end{align}

The maximum likelihood estimate (MLE) of the parameters ${\{W, \sigma^2 \}}$ can be solved in closed form \cite{tipping1999mixtures} or using the EM algorithm \cite{roweis1998algorithms}.
The columns of the estimated $W$ define the principal subspace of standard PCA.

The optimal rank $k^*$ can be determined by choosing the latent dimension ${\mathbb{R}^{k}}$ that maximizes the marginal likelihood of the model.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Trajectory Generation}
\label{subsec:trajs_generation}
Once we have the GMM parameters for each segment, we can generate synthetic trajectories of aircraft positions based on the trained models and test procedures.
To test the model on a set of procedures not used for the training, we need the procedural trajectories with the relative frequencies of procedures in each segment.

We start generating an aircraft trajectory with its radar vector segment.
First, we randomly select one of the test radar vector procedures with probability proportional to their relative frequencies.
Then, we sample a sequence of deviations ${\tau^v}$ from the radar vector GMM. Next, we construct a trajectory of aircraft positions using the sampled deviations and the test procedural trajectory.
While the total distance an aircraft travels varies with the procedure it follows, the reconstructed trajectory always has the same number of points. 
To generate a trajectory with reasonable airspeed, we first compute the adjusted total transit time as ${t'^v = (\tau^v_1 / \tau^v_2) \times d'^v}$
where ${\tau^v_1, \tau^v_2}$ are the transit time and total distance of the sample, and ${d'^v}$ is the total distance of the given test procedure.
Then we align the trajectory with a vector of evenly spaced numbers over the interval ${[0, t'^v]}$.

For a smooth transition between two separately modeled segments of our generated trajectory,
we take the final $n$ positions of the reconstructed radar vector trajectory to compute the first $n$ deviations from the test final approach procedure.
Then, we form a conditional distribution of the final approach GMM to sample the remainder of final approach segment given the first $n$ measurements.

Suppose the input vector and the Gaussian components in (\ref{eq:gmm}) are partitioned as
\begin{align}
    p\left(
    \begin{bmatrix} 
        \tau_a \\ \tau_b 
    \end{bmatrix}\right) 
    &= \sum_{j=1}^K \pi_j \mathcal{N}\left(
    \begin{bmatrix} 
        \tau_a \\ \tau_b 
    \end{bmatrix} \;\middle|\;
    \begin{bmatrix}
        \mu_{j,a} \\ \mu_{j,b} 
    \end{bmatrix}, 
    \begin{bmatrix}
        \Sigma_{j,aa} \ \Sigma_{j,ab} \\
        \Sigma_{j,ba} \ \Sigma_{j,bb} 
    \end{bmatrix}\right).
\end{align}

Then, the posterior distribution of ${\tau_b}$ given ${\tau_a}$ is
\begin{align}
    \begin{split}  
    p(\tau_b \mid \tau_a) &=
    \sum_{j=1}^K \pi_{j,b \mid a}
    \mathcal{N}\left(\tau_b \mid \mu_{j, b \mid a}, \Sigma_{j, b \mid a}
    \right)\\
    \text{where } \ \pi_{j,b \mid a} &= \frac{\pi_j \mathcal{N}\left( \tau_a \mid \mu_{j,a}, \Sigma_{j,aa} \right)}{\sum_{k=1}^K \pi_k \mathcal{N}\left( \tau_a \mid \mu_{k,a}, \Sigma_{k,aa} \right)} \\
    \mu_{j, b \mid a} &= \mu_{j,b} + \Sigma_{j,ba}\Sigma_{j,aa}^{-1}(\tau_a - \mu_{j,a}) \\
    \Sigma_{j,b \mid a} &= \Sigma_{j,bb} - \Sigma_{j,ba} \Sigma_{j,aa}^{-1} \Sigma_{j,ba}^T.
    \end{split}
    \label{eq:conditional_density_GMM}
\end{align}

We form this conditional distribution for the final approach GMM by partitioning each vector $\tau^f$ as illustrated in Fig. \ref{fig:traj_generate_conditional}.
In our case, $\tau_a$ is defined as the first $n$ 3D coordinates of deviations and $\tau_b$ corresponds the remainder of the vector.
In the figure, the blue crosses indicate the procedural points along the IAP. 
The set of dotted lines are the sequence of deviations $\tau^f$ partitioned into $\tau_a$ and $\tau_b$, and
the dots are the reconstructed trajectory of aircraft positions. 
Those marked red correspond to the conditioned part.

\begin{figure}[tb!]
\centering
\input{figures/traj_generate_conditional.tex}
\caption{Partition of the sequence of deviations for the final approach segment to form a conditional distribution.}
\label{fig:traj_generate_conditional}
\end{figure}

After we sample the remaining final approach segment of deviations from the conditional, we reconstruct an aircraft position trajectory as we need for the radar vector segment.
We also repeat the process for integrating time into the trajectory using $\tau^f_1$ and $\tau^f_2$.
Finally, the whole synthetic trajectory is obtained by combining the aircraft trajectories of both segments.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Multiple Trajectory Model}
\label{sec:multiple trajectory model}
When multiple aircraft are within close proximity, their behavior will likely influence each other.
To capture correlations in behavior, we extend the single trajectory GMM described in Section \ref{sec:single trajectory model} to a pairwise trajectory GMM.
Then, we introduce a method to generate multiple trajectories based on the pairwise GMM.
This pairwise approach can scale to large sizes of trajectory set and efficiently generate an arbitrary number of trajectories from a single model, whereas fitting a GMM for the whole set of trajectories may lead to failure in EM due to singularities and quadratic increase in the covariance parameters.
To illustrate, we provide the steps to generate a set of three arrival trajectories.
To define the range of influence, we use the inter-arrival time between each pair of successive arrivals. 

\subsection{Pairwise Trajectory GMM}
For each combination of two procedures, a pairwise trajectory GMM is trained using the trajectory data of two aircraft following their corresponding procedures.
Each training input has the form
\begin{align}
\tau^{pair} = [\tau^{(1)}, \delta^{12}, \tau^{(2)}]
\end{align}
where $\delta^{12}$ is the inter-arrival time between the pair of aircraft, and
\begin{align*}
\tau^{(1)} = \ &[t^1, d^1, (x_1^1-x_1^{1p}), (y_1^1-y_1^{1p}), (z_1^1-z_1^{1p}),\\
& \ \ldots,(x_T^1-x_T^{1p}), (y_T^1-y_T^{1p}), (z_T^1-z_T^{1p})] \in \mathbb{R}^{3T + 2},\\
\tau^{(2)} = \ &[t^2, d^2, (x_1^2-x_1^{2p}), (y_1^2-y_1^{2p}), (z_1^2-z_1^{2p}),\\
& \ \ldots,(x_T^2-x_T^{2p}), (y_T^2-y_T^{2p}), (z_T^2-z_T^{2p})] \in \mathbb{R}^{3T + 2}
\end{align*}
are the sequences of deviations for the first and the second aircraft,
each of which are in the form of
(\ref{eq:single_model_training_data}).


\subsection{Multiple Trajectory Generation}
\label{subsec:construction_of_cov_matrix}

\begin{figure}[tb!]
    \centering
    \includegraphics[width=3.6in]{figures/cov_matrix_3trajs.pdf}
    \caption{
        Sub-blocks of the covariance matrix $\Sigma_{set}$.
        }
    \label{fig:cov_set_subblocks}
\end{figure}

\begin{figure*}[tb!]
    \centering
    \subfigure[Step 1. Construct $\Sigma_{1\&2}$ by sampling a Gaussian component from the trained pairwise trajectory model.]{
        \label{fig:cov_set_step1}
        \includegraphics[width=2in]{figures/cov_set_step1.pdf}}
    \hspace*{2em}%
    \subfigure[Step 2. Construct $\Sigma_{2\&3}$ by selecting the Gaussian component from the pairwise model that has the closest $\Sigma_{22}$ sub-block from the sampled one in step 1.]{
        \label{fig:cov_set_step2}
        \includegraphics[width=2in]{figures/cov_set_step2.pdf}}
    \hspace*{2em}%
    \subfigure[Step 3. Construct $\Sigma_{1\&3}$ by selecting the Gaussian component from the pairwise model that has the closest $\Sigma_{11}$ and $\Sigma_{33}$ sub-blocks from the sampled ones in the previous steps.]{
        \label{fig:cov_set_step3}
        \includegraphics[width=2in]{figures/cov_set_step3.pdf}}
    \caption{The process of constructing $\Sigma^{set}$, the covariance matrix of $\tau^{set}$.}
    \label{fig:cov_set_construction}
\end{figure*}

Using the mean vectors and the covariance matrices of the trained pairwise trajectory GMM, we can generate a set of three arrival trajectories that are within the range of influence.
The output vector is
\begin{align}
    \label{eq:input_multiple}
    \tau^{set} = [\tau^{(1)}, \delta^{12}, \tau^{(2)}, \delta^{23}, \tau^{(3)}]
\end{align}
where $\tau^{(1)}$, $\tau^{(2)}$, and $\tau^{(3)}$ are the sequences of deviations for the three aircraft indexed by the order of arrival time, 
and $\delta^{12}$ and $\delta^{23}$ are the inter-arrival times between the aircraft.

We sample $\tau^{set}$ from a Gaussian distribution parameterized by a mean vector $\mu^{set}$ and covariance matrix $\Sigma^{set}$.
To construct $\Sigma^{set}$, we partition the matrix and use its sub-blocks, $\Sigma_{11}, \Sigma_{22}, \Sigma_{33}, \Sigma_{1\&2}, \Sigma_{2\&3}, \text{ and } \Sigma_{1\&3}$. 
These are indicated in Fig. \ref{fig:cov_set_subblocks}.
Then, $\mu^{set}$ and $\Sigma^{set}$ are constructed as follows:
    \begin{enumerate}[1)]
    \setlength{\itemindent}{1em}
    \item Construct $\mu^{1\&2}$ and $\Sigma_{1\&2}$ by sampling a Gaussian component from the trained pairwise trajectory model.
    \item Construct $\mu^{2\&3}$ and $\Sigma_{2\&3}$ by selecting the Gaussian component from the pairwise model that has the closest $\Sigma_{22}$ sub-block from the sampled one in step 1.
    \item Construct $\Sigma_{1\&3}$ by selecting the Gaussian component from the pairwise model that has the closest $\Sigma_{11}$ and $\Sigma_{33}$ sub-blocks from the sampled ones in the previous steps.
    \end{enumerate}
The corresponding process of constructing $\Sigma^{set}$ is also illustrated in Fig. \ref{fig:cov_set_construction}.

We can scale up to larger number of trajectories by extending this process.
To construct a diagonal pairwise sub-block $\Sigma_{k\&k+1}$, we repeat step 2) to select the Gaussian component that has the closest $\Sigma_{k-1\&k}$ sub-block that is already chosen.
For the other pairwise sub-blocks $\Sigma_{j\&k}$, we repeat step 3) to select the Gaussian component that has the closest $\Sigma_{jj}$ and $\Sigma_{kk}$ sub-blocks that are already constructed in the previous steps.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Experiments}
\label{sec:experiments}
We evaluate the proposed models on the arrival trajectories to KJFK.
We trained the models on the flight tracks and procedures for all the runways except for 13L.
Then, the performance of the models are validated using 13L data.
This makes an approximately 90-10 training-test split of our data. 
To construct the input vectors as described in Section \ref{subsec:input vector construction}, we set the input length to be 150 for the final approach segment and 350 for the radar vector segment.

\subsection{Model Selection}
\label{subsec:model_selection}

The number of clusters is an important hyper-parameter for clustering algorithms including the GMM.
To determine the number of clusters, i.e. Gaussian components in GMMs, we evaluate the cluster performance of our models with different numbers of Gaussian components using the silhouette method.
The silhouette method selects the number of clusters by finding the number that maximizes the silhouette score, i.e. the average of silhouette coefficients over all data points in the entire dataset.
A silhouette coefficient measures how well a data point is matched to its own cluster (cohesion) versus to the other clusters (separation) \cite{rousseeuw1987silhouettes}.
The silhouette coefficient for the $i$th data point is
\begin{align}
s(i) = \frac{b(i)-a(i)}{\max \{ a(i), b(i) \} }
\end{align}
where $a(i)$ is the mean intra-cluster distance (i.e., mean Euclidean distance to the other points in the same cluster) and $b(i)$ is the mean nearest-cluster distance (i.e., mean Euclidean distance to the points in the closest cluster).
The value of $s(i)$ ranges from $-1$ to $+1$, where a higher value indicates that $i$ is well matched to its cluster while poorly to its neighboring cluster. 
If most points have high values, the data points are appropriately clustered.

The silhouette method has several advantages for optimizing the number of clusters. 
It provides an exact solution whereas other methods including the elbow method have to rely on heuristics. 
The silhouette method also provides a better quantification of the clustering performance, as it evaluates both intra-cluster and inter-cluster distances. A good clustering can be characterized by high inter-cluster distance and low intra-cluster distance.

We select the number of Gaussian components that maximizes the silhouette score.
Fig. \ref{fig:silhouette_iap_vector} shows the silhouette scores with different numbers of Gaussian components for the final approach model and radar vector model.
The final approach model has the highest score of 0.5432 with two Gaussian components, and the radar vector model has the highest score of 0.4937 with six Gaussian components.
\begin{figure}[bt!]
\centering
\setlength\figureheight{5.5cm}
\setlength\figurewidth{9cm}
\input{figures/silhouette_iap_vector.tex}
\caption{Number of Gaussian components vs. silhouette scores.}
\label{fig:silhouette_iap_vector}
\end{figure}


Once we determine the numbers of Gaussian components, we optimize the ranks for the low-rank approximations of the covariance matrices 
as described in Section \ref{subsec:low-rank approximation}.
Fig. \ref{fig:low_rank_approximation_iap_vector} shows the log-likelihood with different numbers of principal components (PCs) for the final approach model and the radar vector model.
As a result, the 452-dimensional input data of final approach model can be best represented with 82 PCs, and the 1052-dimensional input data of radar vector model can be best represented with 241 PCs.
\begin{figure}[bt!]
    \centering
    \subfigure[Final approach model]{
    \setlength\figureheight{5cm}
    \setlength\figurewidth{8cm}
    \input{figures/PPCA_IAP}}
    \subfigure[Radar vector model]{
    \setlength\figureheight{5cm}
    \setlength\figurewidth{8cm}
    \input{figures/PPCA_vector}}
    \caption{Number of principal components (PC) vs. log-likelihood.}
    \label{fig:low_rank_approximation_iap_vector}
\end{figure}


\subsection{Model Validation and Generalization}
\label{subsec:experiment_single_trajectory_model}
With the optimal parameters, we train the single trajectory model and generate synthetic trajectories from the trained model
as described in Section \ref{sec:single trajectory model}.

Fig. \ref{fig:jfk_13L_hist_org} and Fig. \ref{fig:jfk_13L_hist_syn} show 2D log-histograms of 1,200 actual trajectories and 1,000 synthetic trajectories arriving at KJFK 13L.
As in Fig. \ref{fig:jfk_04R_orginal_paths}, the radar vector procedures and the IAP are indicated in blue dotted lines and in a white dashed line with orange edges, respectively.
From the generated trajectories, we observe that the model can learn the general behavior of aircraft with respect to the procedure, but not the distinctive patterns of each individual procedure.
This is because after our model obtains the deviation trajectories with different procedures, it merges all of them into a single dataset for each segment.
\begin{figure}[bt!]
    \centering
    \subfigure[Actual trajectories]{
    \setlength\figureheight{7cm}
    \setlength\figurewidth{7cm}
    \input{figures/jfk_13L_original_hist_1200.tex}
    \label{fig:jfk_13L_hist_org}}
    \subfigure[Synthetic trajectories]{
    \setlength\figureheight{7cm}
    \setlength\figurewidth{7cm}
    \input{figures/jfk_13L_synthetic_hist_1000.tex}
    \label{fig:jfk_13L_hist_syn}}
    \caption{Log-histograms of arrival tracks to KJFK 13L and associated flight procedures.}
    \label{fig:jfk_13L_org_syn}
\end{figure}

To investigate how well the proposed model  generalizes to a new environment, we generated synthetic trajectories given Charlotte Douglas Airport (KCLT) runway 36C arrival procedures using the model trained with KJFK data.
Fig. \ref{fig:clt_36C_hist_org} shows a density plot of one month of actual arrivals to KCLT 36C in 2016.
Fig. \ref{fig:clt_36C_hist_syn} is a density plot of 1,000 synthetic trajectories generated by sampling the deviation trajectories from our model and re-constructing the position trajectories with the given flight procedures.
Again, the radar vector procedures and the IAP are indicated in blue dotted lines and in a white dashed line with orange edges, respectively.

From the two histograms, we see that some traffic patterns in the actual trajectory set do not appear in the synthetic trajectory set.
Part of the reason is because some trajectories do not appear to follow any of the procedures. 
For example, in Fig. \ref{fig:clt_36C_hist_org}, there is no standard procedure for those trajectories approaching from the northwest, passing north of the airport, and joining the downwind leg on the east side.
Another reason is because the two environments are extremely different.
The radar vector procedures and the actual trajectories of KCLT are mostly straight with only some parts curved, while
those of KJFK do not have straight segments. 
Also, the KJFK trajectories have greater variability in their early arrival stages, while the variability of KCLT trajectories depends on the procedure.
Thus, the synthetic trajectories in Fig. \ref{fig:clt_36C_hist_syn} is more representative of KJFK traffic than KCLT traffic.
\begin{figure}[tb]
    \centering
    \subfigure[Actual trajectories]{
        \setlength\figureheight{7cm}
        \setlength\figurewidth{7cm}
        \input{figures/clt_36C_original_hist.tex}
        \label{fig:clt_36C_hist_org}}
    \subfigure[Synthetic trajectories]{
        \setlength\figureheight{7cm}
        \setlength\figurewidth{7cm}
        \input{figures/clt_36C_synthetic_hist_500.tex}
        \label{fig:clt_36C_hist_syn}}
  \caption{Log-histograms of arrival tracks to KCLT 36C and RNAV standard arrival procedures.
  }
\end{figure}

We also provide quantitative analyses on the single trajectory model in the next section, along with the multiple trajectory model.


\subsection{Analyses on Multiple Trajectory Scenarios}
To evaluate the performance of the single and multiple trajectory models, we experiment both models on traffic scenarios where three aircraft arrive at KJFK 13L with inter-arrival times less than 180 seconds.
As described in Section \ref{sec:multiple trajectory model}, we train a pairwise trajectory model for each combination of two procedures, and generate synthetic trajectory sets of three aircraft.
We also generate synthetic trajectory sets using the single trajectory model. 
This is done by generating each trajectory independently and then connecting the trajectory data points through the inter-arrival time variables.

\begin{figure*}[tb!]
    \centering
    \subfigure[xEast. $D_{JS}$: 0.0119 (multiple), 0.0245 (single)]{
        \label{fig:hist_x_coords}
        \input{figures/hist_x}}
    \hspace*{1em}%
    \subfigure[yNorth. $D_{JS}$: 0.0446 (multiple), 0.0166 (single)]{
        \label{fig:hist_y_coords}
        \input{figures/hist_y}}
    \vspace*{1em}%
    \hspace*{0.8em}%
    \subfigure[horizontal speed. $D_{JS}$: 0.0147 (multiple), 0.0650 (single)]{
        \label{fig:hist_speed}
        \input{figures/hist_hor_speed}}
    \hspace*{1em}%
    \subfigure[distance to the closest aircraft. $D_{JS}$: 0.0307 (multiple), 0.0261 (single)]{
        \label{fig:hist_encounter}
        \input{figures/hist_encounter}}
    \caption{Distributions of position coordinates, horizontal speed, and distance to the closest aircraft (actual vs. synthetic--multiple vs. synthetic--single trajectories of KJFK 13L).}
    \label{fig:result-hist}
\end{figure*}

Fig. \ref{fig:result-hist} shows the empirical distributions of the position coordinates, horizontal speed, and distance to the closest aircraft, for the actual dataset and the synthetic datasets from each model.
From Fig. \ref{fig:hist_speed} and \ref{fig:hist_encounter}, we observe for both variables that the synthetic distribution from the multiple trajectory model (synthetic--multiple) is more concentrated near its mode than the one from the single trajectory model (synthetic--single).
This result is probable because the multiple model not only learns individual trajectories but also the pairwise relations between them. 

We observe from the figures that the synthetic trajectory sets have much higher densities than the actual dataset at lower speeds and ranges.
In practice, most aircraft cannot maintain $100$ knots, which is why the actual dataset has minimal density in this range. 
Also, it is specified in FAA Order JO 7110.65Y \cite{FAAorderATC} that the separation minimum between two IFR aircraft flying below FL$290$ within $40$ miles from the radar antenna is $3$ miles horizontally and $1,000$ feet vertically.
The invalid outputs may occur from the fact that our models do not directly learn the aircraft trajectories, but learn the deviations and then re-construct the trajectories.

To measure the similarity between the actual distribution and each of the synthetic distributions,
we use the Jensen--Shannon divergence $(D_{JS})$, which is a symmetric and smoothed variation of the Kullback--Leibler divergence $(D_{KL})$ \cite{lin1991divergence}.
The $D_{JS}$ between two empirical distributions $P$ and $Q$ is defined as
\begin{align}
    \begin{split}
        D_{JS}(P, Q) &= \frac{1}{2} \Big( D_{KL}(P, M) + D_{KL}(Q, M) \Big)\\
        &= \frac{1}{2}\sum_{x_i} \Big( P(x_i) \log \frac{P(x_i)}{M(x_i)} + Q(x_i) \log \frac{Q(x_i)}{M(x_i)} \Big)
    \end{split}
\end{align}
where ${M = (P+Q)/2}$. The output is bounded by $0$ and $1$.

Fig. \ref{fig:result-hist} shows the $D_{JS}$ between the actual distribution and each of the synthetic distributions for different variables.
We find that the multiple model outperforms the single model in terms of horizontal speed, not only because the multiple model has lower $D_{JS}$ but the single model outputs speeds that are too high or too low.
For the closest distance, the single model has slightly lower JS divergence.
What is more important, however, is the loss of separation that occurs whenever the separation minima are breached.
We counted the number of times when the distance to the closest aircraft goes below $3$ miles within the 1,000 trajectory sets generated using each model.
It turns out that loss of separation occurred $781$ times when using the single model, and $482$ times when using the multiple model.
These results indicate that the multiple model performs better, or at least comparably, than the single model in terms of both similarity and safety.

Fig. \ref{fig:multi_trajs_generation_sets} shows two sample three-trajectory sets generated using the multiple model.
Along each trajectory, the dots indicate the current positions and the ticks indicate previous positions at each minute.
For example, the ${-1}$ ticks indicate the locations of the three aircraft one minute ago.
For the first set shown in Fig. \ref{fig:multi_trajs_generation_set1}, the model successfully generated the trajectories, satisfying the horizontal and vertical separation requirements.
After the second AC gets close to the first AC, it makes a detour and reduces speed to maintain the horizontal and vertical separation from the first AC.
For the second set shown in Fig. \ref{fig:multi_trajs_generation_set2}, on the other hand, loss of separation occurred between the first AC and the second AC at ${t=-2}$.
Besides, at the current time-step, the second AC and the third AC overlap in the top view.
Although the two AC's are maintaining the vertical separation minimum, in practice, the air traffic controllers do not want to see overlapping tracks from their radar control screen.
A plausible reason for this undesirable output is the configuration of the procedures.
As with all the other experiments, each trajectory follows one of the procedures for KFJK 13L shown in Fig. \ref{fig:jfk_13L_org_syn}.
We can see that the procedures themselves overlap with each other.
Thus, the synthetic trajectories for KJFK 13L arrivals are likely to overlap or fail in separation even if our models separate them based on their inter-arrival times.
We could use some heuristics to solve this problem, or experiment on another environment such as KCLT 36C where the procedures do not overlap. For now, we will leave these for future work.

\begin{figure*}[bt!]
    \centering
    \subfigure[First example set.]{
    \includegraphics[width=7.1in]{figures/gen_three_trajs_set1_t=560.pdf}
    \label{fig:multi_trajs_generation_set1}}
    \subfigure[Second example set.]{
    \includegraphics[width=7.1in]{figures/gen_three_trajs_set2_t=240.pdf}
    \label{fig:multi_trajs_generation_set2}}
    \caption{Example sets of three trajectories generated based on the multiple trajectory model. Top view (left column) and side views from north and east (right column).}
    \label{fig:multi_trajs_generation_sets}
\end{figure*}

To visualize the behavior of multiple trajectories over time, we developed a dynamic simulation tool embedded with Google maps.
The source code for the experiments and a simulation demo are publicly available at https://github.com/sisl/terminal\_airspace\_modeling.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions}
\label{sec:conclusions}

In this paper, we presented a method for modeling aircraft behavior in terminal airspace based on radar flight tracks and procedure data. 
We first partitioned the aircraft trajectories into segments based on the structures of flight procedures.
Then, we investigated Gaussian mixture model (GMM) and conditional Gaussian distributions 
for modeling the deviations of aircraft trajectories from their intended flight procedures.
A low-rank approximation was performed on the covariance matrices in GMMs in order to remove 
feature redundancy and improve robustness of our model. 
Furthermore, we proposed an idea of modeling pairwise correlations between aircraft which can efficiently generate traffic scenes involving an arbitrary number of aircraft.
The results showed that the proposed models are able to capture the major patterns as well as uncertainties in aircraft behavior relative to the flight procedures.

There are many potential directions for extending this work. First, while the significance of this work lies in its ability to generate trajectories given any procedural data, the proposed model is not generalizable to flight procedures that have distinctively different characteristics from the ones in the training data. Future study should investigate how the knowledge can be transferred across different traffic environments incorporating minimal procedural information into the model. 
Second, further research could be done to reduce the model complexity without sacrificing performance. Using an autoencoder instead of PPCA would further reduce the feature space dimension as it can encode non-linear relationships between variables. Using distances and relative bearings instead of the ENU coordinates to define the deviations could better represent the aircraft behavior, and thus comprise a more explainable feature set. 
Finally, this work distinguished modeling single trajectories and their pairwise correlations in two separate problems. Future work could evaluate these two models on various scenarios with longer durations and different numbers of aircraft involved in order to explore how they can be integrated.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgments}
The authors acknowledge the FAA and the MITRE Corporation for sharing the surveillance data.
They thank Evan Maki, Randal Guendel, and Mikhail Krichman from MIT Lincoln Laboratory for their support and assistance.
This article benefited from the work of Shane Barratt, and conversations with Rachael Tompa and Kyle Julian.


\ifCLASSOPTIONcaptionsoff
  \newpage
\fi

\printbibliography

\begin{IEEEbiography}[{\includegraphics[width=1in,clip,keepaspectratio]{figures/soyeon.jpg}}]{Soyeon Jung}
received the B.S. and M.S. degrees in Air Transportation from Korea Aerospace University in 2015 and 2017.
She is currently working towards the Ph.D. degree in the department of Aeronautics and Astronautics at Stanford University, and is a member of the Stanford Intelligent Systems Laboratory.
\end{IEEEbiography}

\begin{IEEEbiography}
[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{figures/mykel.jpg}}]{Mykel J. Kochenderfer} received the B.S. and M.S. degrees in Computer Science from Stanford University in 2003 and a Ph.D. degree from the University of Edinburgh in 2006. He was a member of the technical staff at MIT Lincoln Laboratory, where he worked on airspace modeling and aircraft collision avoidance. He is now an Associate Professor of Aeronautics and Astronautics at Stanford University and the director of the Stanford Intelligent Systems Laboratory.
\end{IEEEbiography}

\vfill

\end{document}



%\documentclass[review,hidelinks,onefignum,onetabnum]{siamart220329}
\documentclass{amsart}
\usepackage[left=3.25cm, right=3.25cm, top=3cm, bottom=3cm]{geometry}

\usepackage{lipsum}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage{float}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{multirow,makecell}
\usepackage{bm,amsfonts,booktabs,amssymb}
%\allowdisplaybreaks
\usepackage{amsmath}
\makeatletter
\g@addto@macro\normalsize{%
  \setlength\abovedisplayskip{7pt}
  \setlength\belowdisplayskip{7pt}
  \setlength\abovedisplayshortskip{8pt}
  \setlength\belowdisplayshortskip{8pt}
}
\makeatother
\usepackage{mathtools}
\usepackage{enumitem}
% \usepackage{caption}
% \captionsetup{belowskip=0pt}
\usepackage{subcaption}
\usepackage[font={small,it}]{caption}
\usepackage{comment}
\usepackage{nicematrix}
\usepackage[hidelinks]{hyperref}
\usepackage{cleveref}
\usepackage{autonum}
\usepackage{longtable}
\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows}

\ifpdf
  \DeclareGraphicsExtensions{.eps,.pdf,.png,.jpg}
\else
  \DeclareGraphicsExtensions{.eps}
\fi

% Add a serial/Oxford comma by default.
\newcommand{\creflastconjunction}{, and~}

% Used for creating new theorem and remark environments
\newtheorem{claim}{Claim}


\newcommand{\retainlabel}[1]{\label{#1}\sbox0{\ref{#1}}}

\newcommand*{\vertbar}{\rule[-1ex]{0.5pt}{2.5ex}}
\newcommand*{\horzbar}{\rule[.5ex]{2.5ex}{0.5pt}}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{M}[1]{>{\centering\arraybackslash}m{#1}}
\newcommand{\makeheadbox}{\relax}
%\newtheorem{example}{Example}
%\setlength\parindent{0pt}
\setcounter{MaxMatrixCols}{20}

\def\TODO#1{{\color{red} \textbf{#1}}}

\newcommand{\ac}[1]{\textcolor{green}{Alex: #1}}

\newcommand{\dk}[1]{\textcolor{blue}{Dhruv: #1}}

\newcommand{\acomment}[1]{\textcolor{orange}{#1}}
%\newcommand{\revadd}[1]{\textcolor{blue}{#1}}
\newcommand{\revadd}[1]{#1}
\newcommand{\revdel}[1]{\textcolor{red}{}}

\newcommand{\gm}[1]{\textcolor{purple}{Gal: #1}}

\newcommand{\edit}[1]{\textcolor{black}{#1}}

\newcommand{\editt}[1]{\textcolor{black}{#1}}

\newcommand{\edittt}[1]{\textcolor{black}{#1}}

%\DeclareSymbolFont{ebgletters}{OML}{EBGaramond-Maths}{m}{it}
%\DeclareMathSymbol{w}{\mathalpha}{ebgletters}{`k}


\newtheorem{assump}{Assumption}
\newtheorem{dfn}{Definition}[section]
\newtheorem{thm}{Theorem}[section]
\newtheorem{cor}{Corollary}[section]
\newtheorem{lem}{Lemma}[section]
\newtheorem{prop}{Proposition}[section]
\newtheorem{rmk}{Remark}[section]
\newtheorem{ex}{Example}[section]

% \newtheorem{assump}{Assumption}
% \newtheorem{dfn}{Definition}
% \newtheorem{thm}{Theorem}
% \newtheorem{cor}[thm]{Corollary}
% \newtheorem{lem}[thm]{Lemma}
% \newtheorem{prop}[thm]{Proposition}
% \newtheorem{rmk}{Remark}
% \newtheorem{ex}{Example}
%\newdefinition{note}{Note}
%\newproof{pf}{Proof}
%\newtheorem{contrib}{Contribution}

\newcommand{\proofoffirst}[1]{\noindent \underline{\textbf{Proof of #1.}}}
\newcommand{\proofof}[1]{\smallskip \noindent \underline{\textbf{Proof of #1}}.}

\newcommand{\argmin}{\mathop{\mathrm{argmin}}}
\newcommand{\argmax}{\mathop{\mathrm{argmax}}}


% Definitions of handy macros can go here

\newcommand{\dataset}{{\cal D}}
\newcommand{\fracpartial}[2]{\frac{\partial #1}{\partial  #2}}

\newcommand{\Tr}{{\mathrm{Tr}}}
\newcommand{\QR}{{\mathrm{QR}}}
\newcommand{\PF}{{\mathrm{PF}}}
\newcommand{\EXP}{{\mathrm{Exp}}}
\newcommand{\pf}{{\mathrm{pf}}}
\newcommand{\qf}{{\mathrm{qf}}}
\newcommand{\grad}{{\mathrm{grad}}}
%\newcommand{\diag}{{\mathrm{diag}}}
\newcommand{\vecz}{{\mathrm{vec}}}
\newcommand{\Hess}{{\mathrm{Hess}}}
\newcommand{\blockdiag}{{\mathrm{block\text{-}diag}}}
\newcommand{\Skew}{{\mathrm{Skew}}}
\newcommand{\Sym}{{\mathrm{Sym}}}
\newcommand{\rank}{{\mathrm{rank}}}

\newif\iftodos
%\todostrue % comment out to hide answers

% Heading arguments are {volume}{year}{pages}{date submitted}{date published}{paper id}{author-full-names}

%\setcitestyle{square}

% \renewcommand{\citep}[2][]{[\citenum{#2}, {#1}]}
%\renewcommand{\citep}[2][]{\cite[{#1}]{#2}}
\newcommand{\citea}[2][]{\cite{#2}}
\newcommand{\citeb}[2][]{\cite[#1]{#2}}

\makeatletter
\newcommand*{\addFileDependency}[1]{% argument=file name and extension
\typeout{(#1)}% latexmk will find this if $recorder=0
% however, in that case, it will ignore #1 if it is a .aux or 
% .pdf file etc and it exists! If it doesn't exist, it will appear 
% in the list of dependents regardless)
%
% Write the following if you want it to appear in \listfiles 
% --- although not really necessary and latexmk doesn't use this
%
\@addtofilelist{#1}
%
% latexmk will find this message if #1 doesn't exist (yet)
\IfFileExists{#1}{}{\typeout{No file #1.}}
}\makeatother

\newcommand*{\myexternaldocument}[1]{%
\externaldocument[nocite]{#1}%
\addFileDependency{#1.tex}%
\addFileDependency{#1.aux}%
}


% Sets running headers as well as PDF title and authors
% \title[Non-degenerate Rigid Alignment in a Patch Framework]{Non-degenerate Rigid Alignment in a Patch Framework}

% Title. If the supplement option is on, then "Supplementary Material"
% is automatically inserted before the title.
% \title{Non-degenerate Rigid Alignment in a Patch Framework\thanks{Submitted to the editors on Aug 11, 2023.}}

% Authors: full names plus addresses.
% \renewcommand{\thefootnote}{\fnsymbol{footnote}}
% \footnotetext[1]{Department of Mathematics, UC San Diego (dhkohli@ucsd.edu, acloninger@ucsd.edu)}
% \footnotetext[2]{Halicio\u{g}lu Data Science Institute, UC San Diego (gmishne@ucsd.edu).}

% \author[D. Kohli, G. Mishne, A. Cloninger]{Dhruv Kohli\thanks{Department of Mathematics, UC San Diego (dhkohli@ucsd.edu, acloninger@ucsd.edu)} \and  Gal Mishne \and Alexander Cloninger}

\usepackage{amsopn}
\DeclareMathOperator{\diag}{diag}

\setlength{\belowcaptionskip}{0pt}
\setlength{\abovecaptionskip}{0pt}
\setlength{\intextsep}{0pt}

%%% Local Variables: 
%%% mode:latex
%%% TeX-master: "ex_article"
%%% End: 

\everypar{\looseness=-1}

% Information that is shared between the article and the supplement
% (title and author information, macros, packages, etc.) goes into
% ex_shared.tex. If there is no supplement, this file can be included
% directly.

%\input{ex_shared}

% Optional PDF information
\ifpdf
\hypersetup{
  pdftitle={Non-degenerate Rigid Alignment in a Patch Framework},
  pdfauthor={D. Kohli, G. Mishne and A. Cloninger}
}
\fi

% The next statement enables references to information in the
% supplement. See the xr-hyperref package for details.

%\myexternaldocument{ex_supplement}
%\externaldocument[supp:][nocite]{ex_supplement}

% FundRef data to be entered by SIAM
%<funding-group specific-use="FundRef">
%<award-group>
%<funding-source>
%<named-content content-type="funder-name"> 
%</named-content> 
%<named-content content-type="funder-identifier"> 
%</named-content>
%</funding-source>
%<award-id> </award-id>
%</award-group>
%</funding-group>

%%%%%%%%%%----------------------------
%%%%%%%%%%----------------------------

\begin{document}
% make footnote style to be symbols
\renewcommand{\thefootnote}{\fnsymbol{footnote}}
\footnotetext[1]{Department of Mathematics, UC San Diego (dhkohli@ucsd.edu, acloninger@ucsd.edu)}
\footnotetext[2]{Halicio\u{g}lu Data Science Institute, UC San Diego (gmishne@ucsd.edu).}

\title[Non-degenerate Rigid Alignment in a Patch Framework]{Non-degenerate Rigid Alignment in a Patch Framework}
\author[D. Kohli, G. Mishne, A. Cloninger]{Dhruv Kohli${}^{\ast}$, Gal Mishne${}^\dagger$, Alexander Cloninger${}^{\ast, \dagger}$}

% reset back to arabic
\renewcommand{\thefootnote}{\arabic{footnote}}

\begin{abstract}%
% Given a set of overlapping local views (patches) of a dataset, we consider the problem of finding a rigid alignment of the views that minimizes a $2$-norm based alignment error. In general, the views are noisy and a perfect alignment may not exist. In this work, we characterize the non-degeneracy of an alignment in the noisy setting based on the kernel and positivity of a certain matrix. This leads to a polynomial time algorithm for testing the non-degeneracy of a given alignment. Consequently, we focus on Riemannian gradient descent for minimization of the error and obtain a sufficient condition on an alignment for the algorithm to converge (locally) linearly to it.  In the case of noiseless views, a perfect alignment exists, resulting in a realization of the points that respects the geometry of the views. Under a mild condition on the views, we show that the non-degeneracy of a perfect alignment is \revdel{equivalent}\revadd{implies the} local rigidity of the resulting realization. By specializing the characterization of a non-degenerate alignment to the noiseless setting, we obtain necessary and sufficient conditions on the overlapping structure of the views for a \revadd{non-degenerate alignment}\revdel{locally rigid realization}. Similar results are also obtained in the context of a unique perfect alignment and global rigidity.
Given a set of overlapping local views (patches) of a dataset, we consider the problem of finding a rigid alignment of the views that minimizes a $2$-norm based alignment error. In general, the views are noisy and a perfect alignment may not exist. In this work, we characterize the non-degeneracy of an alignment in the noisy setting based on the kernel and positivity of a certain matrix. This leads to a polynomial time algorithm for testing the non-degeneracy of a given alignment. Subsequently, we focus on Riemannian gradient descent for minimizing the alignment error, providing a sufficient condition on an alignment for the algorithm to converge (locally) linearly to it. \revadd{Additionally, we provide an exact recovery and noise stability analysis of the algorithm}. In the case of noiseless views, a perfect alignment exists, resulting in a realization of the points that respects the geometry of the views. Under a mild condition on the views, we show that a non-degenerate perfect alignment \revadd{characterizes the infinitesimally rigidity of a realization, and thus the local rigidity of a generic realization}. By specializing the non-degeneracy conditions to the noiseless case, we derive necessary and sufficient conditions on the overlapping structure of the views for \revadd{a perfect alignment to be non-degenerate and equivalently, for the resulting realization to be infinitesimally rigid}. Similar results are also derived regarding the uniqueness of a perfect alignment and global rigidity.
% Given a set of overlapping local views (patches) of a dataset, we consider the problem of finding a rigid alignment of the views that minimizes a $2$-norm based alignment error. In general, the views are noisy and a perfect alignment may not exist. In this work, we characterize the non-degeneracy of an alignment in the noisy setting based on the kernel and positivity of a certain matrix. This leads to a polynomial time algorithm for testing the non-degeneracy of a given alignment. Subsequently, we focus on Riemannian gradient descent for minimizing the alignment error, providing a sufficient condition on an alignment for the algorithm to converge (locally) linearly to it. Additionally, we provide an exact recovery and noise stability analysis of our algorithm. In the case of noiseless views, a perfect alignment exists, resulting in a realization of the points that respects the geometry of the views. Under a mild condition on the views, we show that a non-degenerate perfect alignment characterizes the infinitesimally rigidity of a realization, and thus the local rigidity of a generic realization. By specializing the non-degeneracy conditions to the noiseless case, we derive necessary and sufficient conditions on the overlapping structure of the views for a perfect alignment to be non-degenerate and equivalently, for the resulting realization to be infinitesimally rigid. Similar results are also derived regarding the uniqueness of a perfect alignment and global rigidity.
\end{abstract}

% \begin{keywords}
\keywords{Nondegeneracy, rigid alignment, infinitesimal rigidity, local rigidity, affine rigidity, linear convergence, Riemannian gradient descent, quotient manifold, noise stability.}
% \end{keywords}

% \begin{MSCcodes}
\subjclass[2010]{52C25, 53B21, 53B20, 65K10, 65Y20, 40A05, 05C50.}
% \end{MSCcodes}
% Optional TODOs:
% \begin{enumerate}
%     \item Counter example for theorem 31.
%     \item More references on local and global rigidity.
%     \item More references on the papers dealing with rigid alignment of views.
%     \item Remember to on the todo switch to see technical todos.
% \end{enumerate}
\maketitle
\section{Introduction}
\label{sec:intro}
\input{sections/intro}

\section{A Quadratic Program in Orthogonal Groups for Aligning Views}
\label{sec:setup}
\input{sections/setup}

\section{Non-degeneracy and Uniqueness in the General Setting}
\label{sec:non_deg}
\input{sections/non_deg}

\section{Non-degeneracy and Uniqueness in the Noiseless Regime}
\label{sec:noiseless_non_deg_results}
\input{sections/noiseless}

\section{Linear Convergence of RGD}
\label{sec:convergence}
\input{sections/convergence_rev}

\section{Discussion}
\label{sec:conc}
\input{sections/conc}

\section*{Acknowledgements}
We thank Lijun Ding for providing references which assisted the noise stability analysis. DK was partly supported by a grant from Kavli Institute for Brain and Mind (UCSD). GM was partially funded by NSF CCF-2217058. AC was partially funded by NSF DMS-2012266 and a gift from Intel Research.

\appendix
\input{sections/all_proofs}
%\input{sections/todos}
%\clearpage
%\setcitestyle{numbers}
\bibliographystyle{siamplain}
\bibliography{loc_rigid}

\end{document}

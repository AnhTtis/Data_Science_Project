% !TEX root = main.tex
%\vspace{-6pt}
\section{Evaluation}\label{sec:evaluation}








% Please add the following required packages to your document preamble:
% \usepackage{multirow}
\begin{table}[t]
\centering
\scriptsize
\caption{\footnotesize{Implementation details}}
\vspace{-10pt}
\label{tab:implementation_details}
\setlength{\tabcolsep}{3.0pt}
\begin{tabular}{c|c|cc|cc}
\toprule
\multirow{2}{*}{Dataset}                                                  & \multirow{2}{*}{Model} & \multicolumn{2}{c|}{Learning Rate Schdeluder}                   & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Training \\ Epochs\end{tabular}} & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Weight \\ decay\end{tabular}} \\
                                                                          &                        & Initial LR & \begin{tabular}[c]{@{}c@{}}Decay \\ Epochs\end{tabular} &                                                                             &                                                                          \\ \hline
\multirow{2}{*}{MNIST}                                                    & LeNet-5                & 0.1                                                              & N/A                                                     & 100                                                                         & 0.0                                                                      \\
                                                                          & LeNet-300-100          & 0.0012                                                           & N/A                                                     & 100                                                                         & 0.0                                                                      \\ \hline
\multirow{7}{*}{CIFAR-10}                                                 & ResNet-56              & 0.1                                                              & {[}91, 136{]}                                   & 182                                                                         & 2.00E-04                                                                 \\
                                                                          & ResNet-50              & 0.1                                                              & {[}91, 136{]}                                   & 182                                                                         & 2.00E-04                                                                 \\
                                                                          & ShuffleNet             & 0.1                                                              & {[}60, 120, 160{]}                              & 200                                                                         & 4.00E-05                                                                 \\
                                                                          & MobileNet-V2           & 0.1                                                              & {[}150, 225{]}                                  & 300                                                                         & 4.00E-05                                                                 \\
                                                                          & VGG-16                 & 0.05                                                             & {[}150, 180, 210{]}                             & 240                                                                         & 5.00E-04                                                                 \\
                                                                          & VGG-19                 & 0.05                                                             & {[}150, 180, 210{]}                             & 240                                                                         & 5.00E-04                                                                 \\
                                                                          & LeNet-5                & 0.0002                                                           & N/A                                                     & 24                                                                          & 1.00E-04                                                                 \\ \hline
\multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Tiny-\\ ImageNet\end{tabular}} & ResNet-101             & 0.1                                                              & {[}150, 225{]}                                  & 300                                                                         & 2.00E-04                                                                 \\
                                                                          & VGG-19                 & 0.1                                                              & {[}150, 225{]}                                  & 300                                                                         & 2.00E-04                                                                 \\ \hline
ImageNet                                                                  & ResNet-50              & 0.256                                                            & {[}30, 60, 80{]}                                & 90                                                                          & 1.00E-04                                                                 \\ 
\bottomrule
\end{tabular}
\end{table}



\begin{table}[t]
\centering
\scriptsize
\caption{\footnotesize{Results from ResNet-56 and ResNet-50 on CIFAR-10. \kaiqi{For the Acc. ↓ (\%) column, a negative value means an increase in accuracy. The baseline Top-1 accuracy of ResNet-56 and ResNet-50 is 92.84\% and 91.83\%, respectively.}}}
% \caption{Results from ResNet-56 and ResNet-50 on CIFAR-10. \kaiqi{For the Acc. ↓ (\%) column, a negative value means an increase in accuracy. The baseline Top-1 accuracy of ResNet-56 and ResNet-50 is 92.84\% and 91.83\%, respectively.}}
% The numbers of the related works are cited from their papers. The baseline Top-1 accuracy of uncompressed ResNet-56 and ResNet-50 is 92.84\% and 91.83\% (5 runs), respectively.
\vspace{-10pt}
\label{tab:resnet_cifar10}
% \begin{tabular}{p{1.0cm}cccccc}
\setlength{\tabcolsep}{5.0pt}
\begin{tabular}{p{1.0cm}llllll}
\toprule
\multicolumn{1}{l}{Model}    & Target                                                                     & \begin{tabular}[c]{@{}c@{}}Target\\  Level\end{tabular} & Method          & \begin{tabular}[c]{@{}c@{}}Acc. \\ ↓ (\%)\end{tabular} & \begin{tabular}[c]{@{}c@{}}Params. \\ ↓ (\%)\end{tabular} & \begin{tabular}[c]{@{}c@{}}FLOPs. \\ ↓ (\%)\end{tabular} \\ \hline
\multirow{34}{*}{ResNet-56}  & \multirow{12}{*}{\begin{tabular}[c]{@{}c@{}}Acc. \\ ↓ (\%)\end{tabular}}   & \multirow{7}{*}{0\%}                                    & SCOP            & 0.06                                                   & 56.30                                                     & 56.00                                                    \\
                             &                                                                            &                                                         & HRank           & 0.09                                                   & 42.40                                                     & 50.00                                                    \\
                             &                                                                            &                                                         & SWP             & 0.03                                                   & 42.60                                                     & 43.60                                                    \\
                             &                                                                            &                                                         & ILP             & 0.00                                                   & 13.04                                                     & -                                                        \\
                             &                                                                            &                                                         & NSP             & -0.03                                                  & -                                                         & 47.00                                                    \\
                             &                                                                            &                                                         & EagleEye        & -1.40                                                   & -                                                         & 50.41                                                    \\
                             &                                                                            &                                                         & \textbf{AAP-P} & -0.33                                         & \textbf{79.11}                                            & \textbf{56.97}                                               \\
                             &                                                                            &                                                         & \textbf{AAP-F} & -0.08                                         & \textbf{65.78}                                                & \textbf{70.13}                                           \\ \cline{3-7} 
                             &                                                                            & \multirow{5}{*}{1\%}                                    & CP             & 1.00                                                   & 50.00                                                     & -                                                        \\
                             &                                                                            &                                                         & ILP             & 1.00                                                   & 41.18                                                     & -                                                        \\
                             &                                                                            &                                                         & GAL             & 0.52                                                   & 44.80                                                     & 48.50                                                    \\
                             &                                                                            &                                                         & \textbf{AAP-P} & 0.86                                          & \textbf{88.23}                                            & \textbf{70.09}                                               \\
                             &                                                                            &                                                         & \textbf{AAP-F} & 0.77                                          & \textbf{78.69}                                                & \textbf{81.19}                                           \\ \cline{2-7} 
                             & \multirow{7}{*}{\begin{tabular}[c]{@{}c@{}}Params. \\ ↓ (\%)\end{tabular}} & \multirow{4}{*}{70\%}                                   & DCP             & -0.01                                                  & 70.30                                                     & -                                                    \\
                             &                                                                            &                                                         & GBN             & 0.03                                                   & 66.70                                                     & -                                                    \\
                             &                                                                            &                                                         & HRank           & 2.38                                                   & 68.10                                                     & -                                                    \\
                             % &                                                                            &                                                         & GDP             & -0.35                                                  & 65.64                                                     & -                                                        \\
                             &                                                                            &                                                         & \textbf{AAP}   & \textbf{-0.60}                                          & 71.57                                            & -                                               \\ \cline{3-7} 
                             % &                                                                            & \multirow{4}{*}{50\%}                                   & CP              & 1.00                                                   & -                                                         & -                                                    \\
                             &                                                                            & \multirow{3}{*}{50\%}                                                        & SFP             & 1.33                                                   & 50.60                                                     & -                                                    \\
                             &                                                                            &                                                         & FPGM            & 0.10                                                   & 50.60                                                     & -                                                    \\
                             % &                                                                            &                                                         & GDP             & -0.07                                                  & 53.35                                                     & -                                                        \\
                             &                                                                            &                                                         & \textbf{AAP}   & \textbf{-1.06}                                         & 53.89                                            & -                                               \\ \cline{2-7} 
                             & \multirow{11}{*}{\begin{tabular}[c]{@{}c@{}}FLOPs. \\ ↓ (\%)\end{tabular}}  & \multirow{2}{*}{75\%}                                   & HRank           & 2.38                                                   & -                                                     & 74.10                                                    \\
                             &                                                                            &                                                         & \textbf{AAP}   & \textbf{0.97}                                          & -                                                & 75.97                                           \\ \cline{3-7} 
                             &                                                                            & \multirow{3}{*}{70\%}                                   & DeepHoyer              & 2.54                                                   & -                                                         & 71.00                                                    \\
                             &                                                                            &                                                         & NSP             & 1.17                                                   & -                                                         & 71.00                                                    \\
                             &                                                                            &                                                         & \textbf{AAP}   & \textbf{0.30}                                           & -                                                & 71.44                                           \\ \cline{3-7} 
                             &                                                                            & \multirow{6}{*}{55\%}                                   & CP              & 1.00                                                      & -                                                         & 50.00                                                    \\
                             &                                                                            &                                                         & SFP             & 1.33                                                   & -                                                     & 52.60                                                    \\
                             &                                                                            &                                                         & FPGM            & 0.10                                                   & -                                                     & 52.60                                                    \\
                             &                                                                            &                                                         & AMC             & 0.90                                                   & -                                                         & 50.00                                                    \\
                             &                                                                            &                                                         & SCP             & 0.46                                                   & -                                                         & 51.50                                                    \\
                             &                                                                            &                                                         & \textbf{AAP}   & \textbf{-0.63}                                         & -                                                & 52.92                                           \\ \hline
\multirow{2}{*}{ResNet-50}   & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Params. \\ ↓ (\%)\end{tabular}} & \multirow{2}{*}{60\%}                                   & AMC             & -0.02                                                  & 60.00                                                     & -                                                        \\
                             &                                                                            &                                                         & \textbf{AAP}   & \textbf{-0.86}                                         & 64.81                                            & -                                               \\
\bottomrule
\end{tabular}
% \vspace{-10pt}
\end{table}




\begin{table}[t]
\centering
\scriptsize
\caption{\footnotesize{Results from VGG, LetNet, MobileNet, and ShuffleNet models on CIFAR-10. \kaiqi{For the Acc. ↓ (\%) column, a negative value means an increase in accuracy.
The baseline Top-1 accuracy of VGG-16, VGG-19, MobileNet-V2, ShuffleNet, and LeNet-5 are 93.64\%, 93.90\%, 94.46\%, 93.28\%, and 69.67\%, respectively.}}}
% \caption{Results from VGG, LetNet, MobileNet, and ShuffleNet models on CIFAR-10. \kaiqi{For the Acc. ↓ (\%) column, a negative value means an increase in accuracy.
% The baseline Top-1 accuracy of VGG-16, VGG-19, MobileNet-V2, ShuffleNet, and LeNet-5 are 93.64\%, 93.90\%, 94.46\%, 93.28\%, and 69.67\%, respectively.}}
% ``AAP-P'' and ``AAP-F'' denote the cases where the pruning objective is set to minimize the number of parameters and FLOPs, respectively, while meeting the accuracy target. 
%The numbers of the related works are cited from their papers.}
\vspace{-10pt}
\label{tab:other_models_cifar10}
\setlength{\tabcolsep}{4.7pt}
% \begin{tabular}{p{1.0cm}cccccc}
\begin{tabular}{p{1.0cm}llllll}
\toprule
\multicolumn{1}{l}{Model}    & Target                                                                     & \begin{tabular}[c]{@{}c@{}}Target\\  Level\end{tabular} & Method          & \begin{tabular}[c]{@{}c@{}}Acc. \\ ↓ (\%)\end{tabular} & \begin{tabular}[c]{@{}c@{}}Params. \\ ↓ (\%)\end{tabular} & \begin{tabular}[c]{@{}c@{}}FLOPs. \\ ↓ (\%)\end{tabular} \\ \hline
                            %  \hline
\multirow{15}{*}{VGG-16}      & \multirow{5}{*}{\begin{tabular}[c]{@{}c@{}}Acc. \\ ↓ (\%)\end{tabular}}    & \multirow{5}{*}{0\%}                                    & PFS             & -0.19                                                  & -                                                        & 50.00                                                        \\
                             % &                                                                            &                                                         & SCP             & 0.06                                                   & 66.23                                                     & -                                                        \\
                             &                                                                            &                                                         & VCNNP           & 0.07                                                   & -                                                      & 60.90                                                        \\
                             &                                                                            &                                                         & Hinge           & 0.43                                                   & -                                                     & 39.07                                                        \\
                             &                                                                            &                                                         & HRank           & 0.53                                                   & -                                                      & 53.60                                                        \\
                             % &                                                                            &                                                         & GDP           & -0.10                                                   & -                                                      & 69.45                                                        \\
                             % &                                                                            &                                                         & \textbf{AAP-P}   & -0.29                                       & \textbf{70.54}                                            & \textbf{41.72}                                           \\
                             &                                                                            &                                                         & \textbf{AAP-F}   & -0.16                                         & \textbf{72.85}                                            & \textbf{61.17}                                           \\ \cline{2-7} 

                            %  & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Params. \\ ↓ (\%)\end{tabular}} & \multirow{2}{*}{70\%}                                   & GDP             & -0.1                                                   & 69.45                                                     & -                                                        \\
                            %  &                                                                            &                                                         & \textbf{AAP}   & \textbf{-0.29}                                         & \textbf{70.54}                                            & \textbf{-}                                           \\ \hline
                          & \multirow{8}{*}{\begin{tabular}[c]{@{}l@{}}Params. \\ ↓ (\%)\end{tabular}} & \multirow{4}{*}{70\%}                                   & IMP-Refill              & 0.10                                                    & 67.00                                                        & -                                                        \\
                                                                                   &                                                                            &                                                         & IMP-Refill+             & 0.63                                                   & 70.00                                                        & -                                                        \\
                                                                                   &                                                                            &                                                         & IMP-Regroup             & 0.10                                                    & 69.00                                                        & -                                                        \\
                                                                                   &                                                                            &                                                         & \textbf{AAP}                     & \textbf{-0.27}                                                  & 70.04                                                     & -                                                        \\ \cline{3-7} 
                                                                                   &                                                                            & \multirow{4}{*}{80\%}                                   & IMP-Refill              & 0.55                                                   & 80.00                                                        & -                                                        \\
                                                                                   &                                                                            &                                                         & IMP-Refill+             & -                                                    & 80.00                                                        & -                                                        \\
                                                                                   &                                                                            &                                                         & IMP-Regroup             & -0.05                                                  & 80.00                                                        & -                                                        \\
                                                                                   &                                                                            &                                                         & \textbf{AAP}                     & \textbf{-0.09}                                                  & 81.21                                                     & -                                                        \\ \hline
\multirow{7}{*}{VGG-19}      & \multirow{5}{*}{\begin{tabular}[c]{@{}c@{}}Acc. \\ ↓ (\%)\end{tabular}}    & \multirow{5}{*}{0\%}                                    & EigenDamage     & 0.19                                                   & 78.18                                                     & 37.13                                                    \\
                             &                                                                            &                                                         & NN Slimming     & 1.33                                                   & 80.07                                                     & 42.65                                                    \\
                                                          &                                                                            &                                                         & PFS     & -0.31                                                   & -                                                     & 52.00                                                    \\
                             &                                                                            &                                                         & \textbf{AAP-P}   & -0.26                                         & \textbf{85.99}                                            & \textbf{56.22}                                           \\  
                             &                                                                            &                                                         & \textbf{AAP-F}   & -0.03                                         & \textbf{87.63}                                            & \textbf{61.31}                                           \\ \cline{2-7} 

                             & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}FLOPs. \\ ↓ (\%)\end{tabular}}  & \multirow{2}{*}{85\%}                                   & EigenDamage     & 1.88                                                   & -                                                         & 86.51                                                    \\
                             &                                                                            &                                                         & \textbf{AAP}   & \textbf{1.81}                                          & -                                                & 89.02                                           \\ \hline

\multirow{6}{*}{\begin{tabular}[c]{@{}c@{}}MobileNet \\ -V2 \end{tabular}} & \multirow{6}{*}{\begin{tabular}[c]{@{}c@{}}Acc. \\ ↓ (\%)\end{tabular}}    & \multirow{6}{*}{0\%}                                    & GDP             & -0.26                                                  & -                                                     & 46.22                                                        \\
                                 &                 &           & MDP             & -0.12                                                  & -                                                     & 28.71                                                        \\
                            %  &                                                                            &                                                         & \textbf{AAP-P}   & \textbf{-0.54}                                         & \textbf{60.16}                                            & \textbf{35.93}                                           \\ \cline{2-7} 
                             &                        &                                    & SCOP            & 0.24                                                   & -                                                     & 40.30                                                        \\
                             &                                                                            &                                                         & DMC             & -0.26                                                  & -                                                        & 40.00                                                        \\
                             &                                                                            &                                                         & \textbf{AAP-P}   & -0.28                                          & \textbf{79.68}                                            & \textbf{55.67}                                           \\ %\cline{4-7} 
                             &                                                                            &                                                         & \textbf{AAP-F}   & -0.26                                          & \textbf{76.79}                                            & \textbf{58.99}                                           \\ %\cline{4-7} 

                             \hline 
% \multirow{6}{*}{\begin{tabular}[c]{@{}c@{}}MobileNet \\ -V2 \end{tabular}} & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Acc. \\ ↓ (\%)\end{tabular}}    & \multirow{3}{*}{0\%}                                    & GDP             & -0.26                                                  & 46.22                                                     & -                                                        \\
%                              &                                                                            &                                                         & MDP             & -0.12                                                  & 28.71                                                     & -                                                        \\
%                              &                                                                            &                                                         & \textbf{AAP-P}   & \textbf{-0.54}                                         & \textbf{60.16}                                            & \textbf{35.93}                                           \\ \cline{2-7} 
%                              & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Params. \\ ↓ (\%)\end{tabular}} & \multirow{3}{*}{40\%}                                   & SCOP            & 0.24                                                   & 40.30                                                     & -                                                        \\
%                              &                                                                            &                                                         & DMC             & -0.26                                                  & 40                                                        & -                                                        \\
%                              &                                                                            &                                                         & \textbf{AAP}   & \textbf{-0.8}                                          & \textbf{43.77}                                            & -                                           \\ %\cline{4-7} 
%                              \hline


\multirow{2}{*}{ShuffleNet}   & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Acc. \\ ↓ (\%)\end{tabular}} & \multirow{2}{*}{0\%}                                   & QP             & 0.31                                                  & 28.57                                                     & -                                                        \\
                             &                                                                            &                                                         & \textbf{AAP-P}   & 0.19                                         & \textbf{50.87}                                            & \textbf{26.67}                                               \\ \hline
                             
\multirow{2}{*}{LeNet-5}   & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Params. \\ ↓ (\%)\end{tabular}} & \multirow{2}{*}{90\%}                                   & ILP             & 10.24                                                  & 89.60                                                     & -                                                        \\
                             &                                                                            &                                                         & \textbf{AAP}   & \textbf{1.85}                                         & 90.38                                            & -                                               \\ %\hline

\bottomrule
\end{tabular}
% \vspace{-10pt}
\end{table}




\begin{table}[t]
\scriptsize
\centering
\caption{\footnotesize{Results from ResNet-50 on ImageNet, and VGG-19 and ResNet-101 on Tiny-ImageNet. \kaiqi{For the Acc. ↓ (\%) column, a negative value means an increase in accuracy.
The baseline Top-1 accuracy of ResNet-50 (ImageNet), VGG-19 (Tiny-ImageNet), and ResNet-101 (Tiny-ImageNet) are 75.06\%, 59.64\%, and 52.93\%, respectively.}}} 
% \caption{Results from ResNet-50 on ImageNet, and VGG-19 and ResNet-101 on Tiny-ImageNet. \kaiqi{For the Acc. ↓ (\%) column, a negative value means an increase in accuracy.
% The baseline Top-1 accuracy of ResNet-50 (ImageNet), VGG-19 (Tiny-ImageNet), and ResNet-101 (Tiny-ImageNet) are 75.06\%, 59.64\%, and 52.93\%, respectively.}}
%The result of ILP is from our implementation, and all the other numbers of the related works are cited from their papers. 
% ``Ours-1'' and ``Ours-2'' denote the cases where the pruning objective is to minimize the number of parameters and FLOPs, respectively, while meeting the accuracy target.
\vspace{-10pt}
\label{tab:resnet50_imagenet}
% \begin{tabular}{p{1.0cm}cccccc}
\setlength{\tabcolsep}{4.7pt}
\begin{tabular}{p{1.0cm}llllll}
\toprule
\multicolumn{1}{l}{Model}    & Target                                                                     & \begin{tabular}[c]{@{}c@{}}Target\\  Level\end{tabular} & Method          & \begin{tabular}[c]{@{}c@{}}Acc. \\ ↓ (\%)\end{tabular} & \begin{tabular}[c]{@{}c@{}}Params. \\ ↓ (\%)\end{tabular} & \begin{tabular}[c]{@{}c@{}}FLOPs. \\ ↓ (\%)\end{tabular} \\ \hline
\multirow{13}{*}{ResNet-50} & \multirow{6}{*}{\begin{tabular}[c]{@{}c@{}}Acc. \\ ↓ (\%)\end{tabular}} & \multirow{3}{*}{0\%}  & PFP-A         & 0.22           & 18.10          & 10.80          \\
                            &                                  &                       & \textbf{AAP-P} & -0.12 & \textbf{24.55} & \textbf{11.26}  \\
                            &                                  &                       & \textbf{AAP-F} & 0.18  & \textbf{24.09} & \textbf{11.62} \\ \cline{3-7} 
                            &                                  & \multirow{4}{*}{1\%}  & SSS-41        & 0.68           & 0.78           & 15.06          \\
                            &                                  &                       & ILP           & 1.00           & 11.50          & -          \\
                            &                                  &                       & \textbf{AAP-P} & 0.64  & \textbf{30.39} & \textbf{22.70} \\
                            &                                  &                       & \textbf{AAP-F} & 0.83  & \textbf{29.26} & \textbf{32.26} \\ \cline{2-7} 
                            & \multirow{5}{*}{\begin{tabular}[c]{@{}c@{}}Params. \\ ↓ (\%)\end{tabular}}  & \multirow{3}{*}{40\%} & SSS-26          & 4.30           & 38.82          & -          \\
                            &                                  &                       & Hrank         & 1.17           & 36.70          & -          \\
                            &                                  &                       & \textbf{AAP} & \textbf{1.69}  & 40.85 & -     \\ \cline{3-7} 
                            % &                                  &                       & \textbf{AAP} & \textbf{1.09}  & \textbf{37.17} & -     \\ \cline{3-7} 
                            &                                  & \multirow{2}{*}{30\%} & PFP-B         & 0.92           & 30.10          & -          \\
                            &                                  &                       & \textbf{AAP} & \textbf{0.80}  & 31.19 & -     \\ \cline{2-7} 
                            & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}FLOPs. \\ ↓ (\%)\end{tabular}}   & \multirow{2}{*}{30\%} & SSS-32        & 1.94           & -          & 31.08          \\
                            &                                  &                       & \textbf{AAP} & \textbf{0.57}  & -     & 31.88 \\ \cline{1-7} 
\multirow{5}{*}{VGG-19} & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Acc. \\ ↓ (\%)\end{tabular}}   & \multirow{2}{*}{3\%}       & EigenDamage     & 3.36          & 61.87           & 66.21             \\
                            &                                 &                       & \textbf{AAP-P} & 2.75 & \textbf{73.69} & \textbf{79.87} \\
                            &                                 &                       & \textbf{AAP-F} & 2.61 & \textbf{72.58} & \textbf{78.97} \\
                        \cline{3-7} 
                        & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Params. \\ ↓ (\%)\end{tabular}}   & \multirow{3}{*}{60\%}       & NN Slimming     & 10.66          & 60.14           & -             \\
                            &                                 &                       & \textbf{AAP} & \textbf{-0.34} & 60.21 & - \\ \hline
                                                                                                                                                
\multirow{6}{*}{ResNet-101}   & \multirow{6}{*}{\begin{tabular}[c]{@{}c@{}}Acc. \\ ↓ (\%)\end{tabular}} & \multirow{5}{*}{0\%} & NN Slimming  & 1.36  & 75.00    & 75.00   \\
                            % &                                                                            &             & DBP   & 3.48  & 76 & {-}                                               \\ 
                            &                                                                            &             & GAL   & 0.50  & 45.00 & {76.00}                                               \\ %\hline
                            &                                                                            &             & DHP   & 0.01  & 50.00 & {75.00}                                               \\ %\hline
                            &                                                                            &             & ACTD   & -0.44  & 51.00 & {75.00}                                               \\ %\hline
                            &                                                                            &             & \textbf{AAP-P}   & -0.57  & \textbf{92.72} & \textbf{76.58}                                               \\ %\hline
    

\bottomrule
\end{tabular}
% \vspace{-7pt}
\end{table}





\begin{table}[t]
\centering
\scriptsize
% \caption{\footnotesize{Results from VGG, LetNet, MobileNet, and ResNet models on MNIST, CIFAR-10, and ImageNet.}}
\caption{\footnotesize{\kaiqi{Results from LetNet-5 and LetNet-300-100 on MNIST. For the Acc. ↓ (\%) column, a negative value means an increase in accuracy.
The baseline Top-1 accuracy of LetNet-5 and LeNet-300-100 are 99.11\% and 97.34\%, respectively.}}}
% \caption{\kaiqi{Results from LetNet-5 and LetNet-300-100 on MNIST. For the Acc. ↓ (\%) column, a negative value means an increase in accuracy.
% The baseline Top-1 accuracy of LetNet-5 and LeNet-300-100 are 99.11\% and 97.34\%, respectively.}}
\vspace{-10pt}
\label{tab:resnet_mnist}
% \begin{tabular}{cccccc}
\begin{tabular}{llllll}
\toprule
Model                                                                              & Target                                                                     & \begin{tabular}[c]{@{}l@{}}Target \\ Level\end{tabular} & Method                  & \begin{tabular}[c]{@{}l@{}}Acc. \\ ↓ (\%)\end{tabular} & \begin{tabular}[c]{@{}l@{}}Params. \\ ↓ (\%)\end{tabular}  \\ \hline
\multirow{2}{*}{\begin{tabular}[c]{@{}l@{}}LeNet-300-100\end{tabular}}   & \multirow{2}{*}{\begin{tabular}[c]{@{}l@{}}Params. \\ ↓ (\%)\end{tabular}} & \multirow{2}{*}{90\%}                                   & PFP & 0.41                                                   & 84.32                                                                                                            \\
                                                                                   &                                                                            &                                                         & \textbf{AAP}                     & \textbf{0.38}                                                   & 89.94                                                                                                           \\ \hline
\multirow{6}{*}{\begin{tabular}[c]{@{}l@{}}LeNet-5\end{tabular}}         & \multirow{6}{*}{\begin{tabular}[c]{@{}l@{}}Params. \\ ↓ (\%)\end{tabular}} & \multirow{6}{*}{99\%}                                   & PFP & 0.35                                                   & 92.37                                                                                                           \\
                                                                                   &                                                                            &                                                         & AP+Coreset-K            & 0.00                                                   & 99.39                                                                                                        \\
                                                                                   &                                                                            &                                                         & AP+Coreset-S            & 0.01                                                   & 99.48                                                                                                            \\
                                                                                   &                                                                            &                                                         & AP+Coreset-A            & 0.01                                                   & 99.48                                                                                                          \\
                                                                                   &                                                                            &                                                         & ADMM-NN-S               & 0.20                                                   & 98.86                                                                                                          \\
                                                                                   &                                                                            &                                                         & \textbf{AAP}                     & \textbf{-0.01}                                                  & 99.34                                                                                                           \\ \bottomrule
\end{tabular}
\end{table}




%\subsection{Experimental Setup}

%\boldhdr{Models and Datasets} \kaiqi{We evaluated our proposed method on representative image classification DNNs and datasets: 1) ResNet-56, ResNet-50, VGG-16, VGG-19 and MobileNetV2 on CIFAR-10 (\cite{krizhevsky2009learning}); 2) VGG-19 on Tiny-ImageNet; and 3) ResNet-50 on ImageNet (\cite{deng2009imagenet}).}
%ResNet-56 has 852K parameters on CIFAR-10, and ResNet-50 have 25.5M parameters on ImageNet.
%CIFAR-10 dataset consists of 50k training and 10k testing 32 × 32 images in 10 classes. ImageNet (ILSVRC-2012) is a large-scale dataset containing 1.28M training  and 50K validation 256 x 256 images from 1000 classes. 

%\smallskip
%\boldhdr{Implementation Details} 
% We implemented our proposed method on PyTorch version 1.6.0.
% %following standard hyperparameters~\cite{renda2020comparing} in our implementations. 
% %For CIFAR-10, the original ResNet-56 model was trained for 182 epochs with a batch size of 128.
% For ResNet models on CIFAR-10, the learning rate is set to 0.1 initially and decays with a rate of 0.1 at the epoch 91 and 136. Weight decay is set to 0.0002. 
% %For ImageNet, the original ResNet-50 model was trained for 90 epochs with a batch size of 64.
% %We followed the same learning rate warmup and decay schedule used by Frankle and Carbin~\cite{renda2020comparing, frankle2019stabilizing}. 
% For ResNet-50 on ImageNet, the learning rate increases to 0.256 in a warmup mechanism during the first 5 epochs, and decays with a factor of 0.1 at epochs 30, 60, 80 (\cite{renda2020comparing, frankle2019stabilizing}).
% %The pruned models remains the same experimental settings with its corresponding original model, but their learning rate starts from the rewinding epoch.
% %
% Nesterov SGD optimizer is used with a momentum of 0.9 for all models. The simple data augmentation (random crop and random horizontal flip) is used for all training images. Learning rate rewinding is used for iterative pruning, which rewinds to the epoch at roughly 60\% of the total training duration (see Appendix~\ref{apd:rewinding} for an analysis of the effect of rewinding epochs on the accuracy of the pruned models). For adaptive pruning, $T$ and $\lambda$ are initialized to 0.0 and 0.005, respectively. 

%For the proposed method, we use one batch of images on one GPU to calculate activation mean values. $\lambda$ and Threshold is set to 0.005 and 0.0 initially. After pruning, we use learning rate rewinding and rewind to roughly 60\% of the total training duration, i.e., rewind to epoch 110 for ResNet-56 on CIFAR-10, 54 for ResNet-50 and ResNet-34 on ImageNet (total training epochs are 182, 90, 90, respectively). Then, we retrain the models for remaining 40\% of total training epochs. We repeat the cycle for many pruning rounds, and measure the Top-1 test accuracy and the remaining number of unpruned weights at the end of each pruning round.

%\smallskip
%\boldhdr{Evaluation Metrics} We evaluate a pruned network on the following three criteria: 1) \emph{Accuracy:} Top-1 accuracy; 2) \emph{Model Size:} total number of parameters. For pruned models, we consider only the unmasked weights; 3) \emph{Compute Intensity:} the total number of floating point operations (FLOPs) required to perform model inference. For pruned models, we consider only the computation of the unmasked weights.

% \sloppy
We did an extensive evaluation on diverse models (ResNet, VGG, MobileNet, LeNet and ShuffleNet) and datasets (\kaiqi{MNIST \cite{xiao2017fashion}}, CIFAR-10 \cite{krizhevsky2009learning}, Tiny-ImageNet \cite{le2015tiny} and ImageNet \cite{deng2009imagenet}), and provided a thorough comparison to SOTA works (discussed in Section \ref{sec:background} \kaiqi{and \ref{sec:methodology}}). %(Table~\ref{tab:compared_method}).
%
For the proposed AAP, we consider different pruning policies: 1) meet accuracy target while minimizing the number of model parameters (\textit{AAP-P}) or FLOPs (\textit{AAP-F}); 2) meet parameter reduction target while minimizing accuracy loss (\textit{AAP}); and 3) meet FLOP reduction target while minimizing accuracy loss (\textit{AAP}).
Multi-objective, multi-constraint pruning with AAP is also considered (Section \ref{sec:discussion}).
%guarantee   when the pruning objective is set to minimize the number of parameters and FLOPs, respectively, while meeting the accuracy target. For other cases where the target is parameter or FLOPs reduction, the pruning objective is to minimize the accuracy loss and we simply denote our method as AAP.


\smallskip
\noindent \textbf{Implementation Details} 
%
% Our code is uploaded in the Supplementary Material. 
%
% For ResNet models On CIFAR-10, the learning rate is set to 0.1 initially and decays with a rate of 0.1 at epochs 91 and 136. Weight decay is set to 0.0002. For ResNet-50 on ImageNet, the learning rate increases to 0.256 in a warmup mechanism during the first five epochs and decays with a factor of 0.1 at epochs 30, 60, 80 (\cite{renda2020comparing, frankle2019stabilizing}).
%
% The implementation details are present in Table~\ref{tab:implementation_details}. 
%
\kaiqi{
We implemented AAP on PyTorch version 1.6.0 and conducted experiments on four Nvidia RTX 2080 GPUs.
% We implement AAP on PyTorch version 1.6.0 and conduct experiments on four Nvidia RTX 2080 GPUs.
% We used 1 GPU for training models on MNIST, 2 GPUs on CIFAR-10 and Tiny-ImageNet, and 4 GPUs on ImageNet.
% For LeNet-5 on CIFAR-10, the Adam optimizer is used, and the learning rate is set to 0.0002 without decay.
The implementation details are present in Table~\ref{tab:implementation_details}. 
% For LeNet-5 on CIFAR-10, the Adam optimizer is used.
% For other models on other datasets, the Nesterov SGD optimizer is used with a momentum of 0.9. 
The learning rate decays with a factor of 0.1 at decay epochs. %shown in Table~\ref{tab:implementation_details}. 
Nesterov SGD optimizer is used with a momentum of 0.9. 
The batch size is set to 256, 128, 256, and 64 for the models on MNIST, CIFAR-10, Tiny-ImageNet, and ImageNet, respectively.
Simple data augmentation (random crop and random horizontal flip) is used for all training images.}
% Other configurations are detailed in Table~\ref{tab:implementation_details}.
% Other configurations are detailed in Appendix~\ref{sec:implementation_details}.}
%The learning rate scheduler, training epochs, and weight decay are detailed in the Supplementary Material.







%\vspace{-6pt}
\subsection{Results on CIFAR-10}\label{sec:results_on_cifar10}
%\m{Compare our method to iterative weight magnitude based pruning to show the advantage of activation based pruning}
%\m{Compare our method to AMC to show the advantage of our automated pruning method}
%\m{to be consistent, use parameters reduction and FLOP reduction in the discussion, not compression ratio and speedup}

% Table~\ref{tab:resnet56_cifar10} shows the experiment results of ResNet-56 on CIFAR-10 dataset. Note that a negative accuracy drop means that the pruned model achieves better accuracy than its unpruned baseline model.  Targeting no accuracy drop, our method achieves the largest compression ratio (2.71X) and highest speedup (2.75X) with the smallest accuracy loss (-0.04\%); Within 1\% accuracy drop, the compression ratio and speedup achieved by our method are more than 2 times than that of related works (Compression ratio: 4.77X vs 2.0X, 1.7X, and 1.81X; Speedup: 4.21X vs 1.94X). In all the cases targeting parameter and FLOPs reduction, our method could achieve better performance than recent benchmark approaches. For example, in target 55\% FLOPs reduction, that means the speedup is about 2X, our method enables the pruned model getting higher accuracy than the unpruned model by -0.63\%, whereas other approaches lead to different levels of accuracy loss (1.0\%, 1.33\%, and 0.1\%). 

%\kaiqi{Table~\ref{tab:resnet_cifar10} and Table~\ref{tab:other_models_cifar10} list the results from CIFAR-10 on ResNet-56, ResNet-50, VGG-16, VGG-19, MobileNet-V2, ShuffleNet, and LeNet-5}. 
%
% We compare our method with the state-of-the-art works, including \textbf{SCOP}~\cite{tang2020scop}, \textbf{HRank}~\cite{lin2020hrank}, \textbf{ILP}~\cite{renda2020comparing}, \textbf{PPR}~\cite{zhuang2020neuron}, \textbf{RFR}~\cite{he2017channel}, \textbf{GAL}~\cite{lin2019towards}, \textbf{DCP}~\cite{zhuang2018discrimination}, \textbf{GD}~\cite{you2019gate}, \textbf{CP}~\cite{he2017channel}, \textbf{SFP}~\cite{he2018soft}, \textbf{FPGM}~\cite{he2019filter}, \textbf{DeepHoyer (DH)}~\cite{yang2019learning}, \textbf{AMC}~\cite{he2018amc}, \textbf{PFS}~\cite{wang2020pruning}, \textbf{SCP}~\cite{kang2020operation}, \textbf{VCNNP}~\cite{zhao2019variational}, \textbf{Hinge}~\cite{li2020group}, \textbf{GDP}~\cite{guo2021gdp}, \textbf{EigenDamage (ED)}~\cite{wang2019eigendamage}, \textbf{NN Slimming (NS)}~\cite{liu2017learning}, \textbf{MDP}~\cite{guo2020multi}, \textbf{EagleEye (EE)}~\cite{li2020eagleeye} and \textbf{DMC}~\cite{gao2020discrete}. \m{replace the list with a small table} 
%
% Note that a negative accuracy drop means that the pruned model achieves better accuracy than its unpruned baseline model. ``Ours-1'' and ``Ours-2'' denote the cases where the pruning objective is set to minimize model size and FLOPs, respectively, while meeting the accuracy target.
%
In all cases targeting accuracy, model size, and compute intensity, the proposed method AAP significantly outperforms the recent related works. 
%
Table~\ref{tab:resnet_cifar10} shows the results from the widely used ResNet models on CIFAR-10. 
For example, for ResNet-56, without accuracy drop, AAP achieves the largest parameters reduction (79.11\%), outperforming the related works by 22.81\% to 66.07\%, and the largest FLOPs reduction (70.13\%), outperforming the related works by 14.13\% to 26.53\%.
%
With 70\% of parameters reduction, AAP achieves the smallest accuracy loss (-0.6\%), outperforming the related works by 0.59\% to 2.98\%.
%
Also, with 70\% of FLOPs reduction, AAP achieves the smallest accuracy loss (0.3\%), outperforming the related works by 0.87\% to 2.24\%. 
%
Note that the proposed AAP also produces a pruned model that reaches 0.6\% or 1.06\% higher accuracy than the original model but with only 28.43\% or 46.11\%, respectively, of the original parameters. Such small and accurate models are useful for many real-world applications.

%\m{No need to summarize all the other results. Just discuss the most important ones. But do explain why we consider them. For example, ResNet is a SOTA large model; MobileNet is lightweight and optimized for mobile applications; ...}




% \kaiqi{Table~\ref{tab:other_models_cifar10} shows the results from other model architectures. For example, on VGG-16, without an accuracy drop, AAP achieves the largest FLOPs reduction (61.17\%), outperforming the related works by 0.27\% to 22.1\%.}
% On VGG-16, without accuracy drop, our method achieves the largest parameter reduction (72.85\%), outperforming the related works by 6.62\% to 33.78\%; With 70\% of parameter reduction, the accuracy loss achieved by our method is lower than GDP by 0.19\%.
% %
% On VGG-19, with no accuracy loss, our method achieves the largest parameter reduction (85.99\%) which outperforms the related works by 5.92\% to 7.81\%, and the largest FLOPs reduction (56.22\%) which outperforms the related works by 13.57\% to 19.09\%; With 85\% of FLOPs reduction, the accuracy loss achieved by our method is lower than EigenDamage by 0.07\%.
%
%\kaiqi{MobileNet is lightweight and optimized for mobile applications, so it is hard to compress.}
Table~\ref{tab:other_models_cifar10} shows the results from other model architectures. 
\kaiqi{For example, on VGG-16, without any accuracy drop, AAP achieves the largest FLOPs reduction (61.17\%), outperforming the related works by 0.27\% to 22.1\%.}
%
AAP can also effectively compress models (MobileNet, ShuffleNet) that are already designed to be compact. 
\kaiqi{For example, on MobileNet-V2, without an accuracy drop, AAP achieves the largest FLOPs reduction (58.99\%), speeding up this already lightweight model by more than half and outperforming the related works by 12.77\% to 30.28\%.}

% For example, on MobileNet-V2, without accuracy drop, AAP achieves the largest parameter reduction (79.68\%), cutting the size of this already lightweight model by more than half and outperforming the related works by 33.46\% to 50.97\%.

% respectively; With 40\% of parameter reduction, the accuracy loss achieved by AAP is lower than SCOP and DMC by 1.04\% and 0.54\%, respectively.


% On ShuffleNet-V2, without accuracy drop, our method achieves a 50.87\% parameter reduction, higher than QP by 22.3\%.
% %
% On LetNet-5, with 90\% of parameter reduction, the accuracy loss of our method is lower than ILP by 8.39\%.
% %
% On LetNet-300-100 \m{not listed in the table}, with no accuracy loss, our method achieves the largest parameter reduction (89.94\%), outperforming the related works by 5.62\% to 14.93\%.





%\vspace{-6pt}
\subsection{Results on ImageNet and Tiny-ImageNet}

Table~\ref{tab:resnet50_imagenet} shows that AAP can also significantly outperform the SOTA methods for various models trained on ImageNet and Tiny-ImageNet. 
%the results of ResNet-50 on ImageNet dataset, VGG-19 and ResNet-101 on Tiny-ImageNet dataset.
% , comparing our method with \textbf{PFB}~\cite{liebenwein2019provable}, \textbf{HRank}~\cite{lin2020hrank}, \textbf{ILP}~\cite{renda2020comparing}, Sparse Structure Selection (\textbf{SSS})~\cite{huang2018data}, \textbf{NN Slimming (NS)}~\cite{liu2017learning}, and \textbf{EigenDamage (ED)}~\cite{wang2019eigendamage}
%
For example, on ResNet-50 with ImageNet, for the same level of accuracy loss, AAP reduces significantly more parameters (6.45\% to 29.61\% higher than the related works) and more FLOPs (0.82\% to 17.2\% higher than the related works);
%
For the same level of parameters or FLOPs reduction, AAP achieves the smallest accuracy loss, lower than the related works by 0.08\% to 2.61\%. 
%
On VGG-19 with Tiny-ImageNet, for the same level of parameters reduction, AAP achieves significantly lower accuracy loss than NN Slimming~\cite{liu2017learning} by 11\%. %For the same level of accuracy loss, AAP achieves higher parameter reduction (72.58\% vs. 61.87\%) and higher FLOPs reduction (78.97\% vs. 66.21\%) than EigenDamage (ED).
%
On ResNet-101 with Tiny-ImageNet, without accuracy loss, AAP achieves the highest parameters reduction (92.72\%), outperforming the related works by 17.72\% to 47.72\%.






\subsection{Results on MNIST}\label{sec:results_on_cifar10}
%
\kaiqi{
Table~\ref{tab:resnet_mnist} shows that AAP can also significantly outperform the related works for LeNet-5 and LetNet-300-100 trained on MNIST. 
On LeNet-5, with 99\% of parameters reduction, AAP achieves the smallest accuracy loss (-0.01\%), outperforming the related works by 0.01\% to 0.36\%.
%
Note that ADMM-NN-S~\cite{ma2021non} applies quantization after pruning, and AAP can also be further improved using quantization.
Even without quantization, with the same level of parameters reduction, AAP achieves a lower accuracy loss than ADMM-NN-S by 0.21\%.
%
On LeNet-300-100, with 90\% of parameters reduction, AAP achieves a lower accuracy loss than PFP~\cite{liebenwein2019provable} by 0.03\%.}



% ADMM-NN-S outperforms very recent works since it applies quantization after pruning. 
% A full-precision pruned model can be quantized to a lower-bit-precision model with a small performance drop. 
% AAP can also be further improved using quantization. 
% Even without quantization, with the same level of parameters reduction, AAP achieves a lower accuracy loss than ADMM-NN-S by 0.21\% and 0.28\% on LeNet-5 (MNIST) and MobileNet-v2 (CIFAR-10), respectively.
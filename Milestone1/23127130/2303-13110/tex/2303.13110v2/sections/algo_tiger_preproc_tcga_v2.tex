\begin{algorithm*}
    \caption{TIGER pre-processing step for TCGA samples } % \smp{Define $Sz_c$, $Sz_t$}
    \label{alg:tcga_preproc}
    \begin{algorithmic}[1]
        % \Comment{Loop over all sample, one-to-many tissue-to-cell relationship}
        \State \textbf{Input} $\mathcal{D}_{TCGA}$ \Comment{TCGA dataset}
        \State \textbf{Output} $\mathcal{D}_{proc}$ \Comment{Pre-processed dataset}
        \State $Sz_c$, $Sz_t$ $\gets$ 128, 512  \Comment{Cell and tissue patch sizes, respectively}
        \State $\mathcal{D}_{proc} \gets [\hspace{0.25em}]$ \Comment{Initialize pre-processed dataset to empty list}
        \ForAll{$(img_t, imgs_c^{ROIs}, masks_t$, $bboxes_c^{ROIs}$, $info^{ROIs})$  \textbf{in} $\mathcal{D}_{TCGA}$} \Comment{Loop over the dataset}
        
            \State $H_t, W_t$ $\gets$ Size($img_t$) \Comment{Tissue image dimension}
            \ForAll{$(img_c$ ,$bboxes_c$, $info_c)$ \textbf{in} $(imgs_c^{ROIs},  bboxes_c^{ROIs}, info^{ROIs})$} \Comment{Loop over cell ROIs in a sample}
                \State $H_c, W_c$ $\gets$ Size($img_c$) \Comment{Cell image dimension}
                \State $y_c$, $x_c$ $\gets$ GetROILocation($info_c$) \Comment{Getting the top-left coordinates of the cell ROI}
                \If{$W_c < Sz_c$ or $H_c < Sz_c$} \Comment{Ignore small cell ROIs}
                    \State \textbf{continue}  
                \EndIf
                \State $img_c \gets$ Crop($img_c$, ($0,0$), $Sz_c$) \Comment{Cropping cell ROI from the top-left corner (0,0) and size $Sz_c$} %\smp{What is (0, 0)?}
                \State $bboxes_c$ $\gets$ FilterBboxes($bboxes_c$, $y_c$, $x_c$, $Sz_c$) \Comment{Removing cell bounding boxes due to previous cropping}
                \ForAll{$(i_t,j_t) \in [0..Sz_t/Sz_c] \times [0..Sz_t/Sz_c]$} \Comment{Loop over 16 surrounding tissue patches per cell ROI}
                    \State $y_t, x_t \gets y_c - i_t \cdot Sz_c, x_c - j_t \cdot Sz_c$ \Comment{Defining surrounding tissue coordinates}
                    \If{CheckTissueExcelsImg($y_t, x_t, Sz_t, H_t, W_t$)} \Comment{Ignore tissue patches exceeding the image}
                        \State \textbf{continue} 
                    \EndIf
                    % Indexing tissue img and mask
                    \State $curImg_t \gets$ Crop($img_t$, ($y_t,x_t$), $Sz_t$) \Comment{Cropping tissue surrounding patch}
                    \State $curMask_t \gets$ Crop($mask_t$, ($y_t,x_t$), $Sz_t$)
                    %\State $curImg_t$ $\gets$ $img_t$[$y_t:y_t+Sz_t, x_t:x_t+Sz_t, :$] \Comment{Slicing tissue patch from tissue image}
                    %\State $curMask_t$ $\gets$ $mask_t$[$y_t:y_t+Sz_t, x_t:x_t+Sz_t, :$] \Comment{Slicing tissue mask patch}
                    % Resize Tissue
                    \State $resImg_t$ $\gets$ Resize($curImg_t$, ($Sz_c$,$ Sz_c$)) \Comment{Matching tissue to cell size}
                    \State $resMask_t$ $\gets$ Resize($curMask_t$, ($Sz_c$, $Sz_c$))
                    % Export
                    \State AppendTo($\mathcal{D}_{proc}$, ($img_c$, $bboxes_c$, $resImg_t$, $resMask_t$)) \Comment{Save sample in pre-processed dataset}
                \EndFor
            \EndFor
        \EndFor
    \end{algorithmic}
\end{algorithm*}

\documentclass[10pt,twocolumn,letterpaper]{article}
\usepackage[rebuttal]{cvpr}

% Include other packages here, before hyperref.
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{booktabs}
\usepackage{enumitem}


% If you comment hyperref and then uncomment it, you should delete
% egpaper.aux before re-running latex.  (Or just hit 'q' on the first latex
% run, let it finish, and you should be clear).
\usepackage[breaklinks,colorlinks,bookmarks=false]{hyperref}

% Support for easy cross-referencing
\usepackage[capitalize]{cleveref}
\crefname{section}{Sec.}{Secs.}
\Crefname{section}{Section}{Sections}
\Crefname{table}{Table}{Tables}
\crefname{table}{Tab.}{Tabs.}

\setlist[itemize]{align=parleft,left=0.2mm,itemsep=-0.8mm}

% If you wish to avoid re-using figure, table, and equation numbers from
% the main paper, please uncomment the following and change the numbers
% appropriately.
%\setcounter{figure}{2}
%\setcounter{table}{1}
%\setcounter{equation}{2}

% If you wish to avoid re-using reference numbers from the main paper,
% please uncomment the following and change the counter for `enumiv' to
% the number of references you have in the main paper (here, 6).
%\let\oldthebibliography=\thebibliography
%\let\oldendthebibliography=\endthebibliography
%\renewenvironment{thebibliography}[1]{%
%     \oldthebibliography{#1}%
%     \setcounter{enumiv}{6}%
%}{\oldendthebibliography}

% Remove the bibliography title
\usepackage{etoolbox}
\patchcmd{\thebibliography}{\section*{\refname}}{}{}{}
\let\OLDthebibliography\thebibliography
\renewcommand\thebibliography[1]{
  \OLDthebibliography{#1}
  \setlength{\parskip}{0.3mm}
  \setlength{\itemsep}{0pt}
}

% Use alphabet to refer to bibliography entries
\usepackage{alphalph}
\makeatletter
\def\@bibitem#1{\item\if@filesw \immediate\write\@auxout
  {\string\bibcite{#1}{\alphalph{\value{\@listctr}}}}\fi\ignorespaces}
\def\@biblabel#1{[\alphalph{#1}]}
\makeatother

% Set the figure numbering with prefix R
\renewcommand{\thepage}{R\arabic{page}} 
\renewcommand{\thesection}{R\arabic{section}}  
\renewcommand{\thetable}{R\arabic{table}}  
\renewcommand{\thefigure}{R\arabic{figure}}

% Macro to refer to the main paper
\newcommand{\main}[1]{\textcolor{blue}{#1}}

%%%%%%%%% PAPER ID  - PLEASE UPDATE
\def\cvprPaperID{8858} % *** Enter the CVPR Paper ID here
\def\confName{CVPR}
\def\confYear{2022}

%%%% OUR OWN MACROS
\input{macros.tex}

\newcommand{\head}[1]{\vskip 0.4mm\noindent\textbf{#1}.\xspace}

\newcommand{\Rone}[0]{\textcolor{BurntOrange}{R{\scriptsize RAi6}}}
\newcommand{\Rtwo}[0]{\textcolor{OliveGreen}{R{\scriptsize wYEu}}}
\newcommand{\Rthree}[0]{\textcolor{BrickRed}{R{\scriptsize 2PUi}}}
\newcommand{\Rfour}[0]{\textcolor{Plum}{R{\scriptsize VwU6}}}

\begin{document}

%%%%%%%%% TITLE - PLEASE UPDATE
\title{OCELOT: Overlapped Cell on Tissue Dataset for Histopathology}  % **** Enter the paper title here

\maketitle
\thispagestyle{empty}
\appendix

% Copied from AAA rebuttal, is this fine?
\noindent
We thank all reviewers for their thoughtful comments and for appreciating both the release of the OCELOT dataset and the importance of investigating the cell-tissue relationship. 
% Note that references to the main paper are \main{shown in blue}.

% \emph{Note: references to the main paper are \main{shown in blue}.}

% We thank the reviewers for their positive and thoughtful comments. \biagio{First sentence is enough, the other two are superfluous. Save space for informative sentences.} We believe it will help us in having a stronger camera-ready. Please find our answers to the reviewers’ questions below.
% \wookie{Should we emphasize more the positive comments from reviewers? It's not super necessary since we have favorable reviews}

\head{More Cell Detection Baselines (\Rthree, \Rfour)}
In the paper, we focus on comparing various cell-tissue integration methods while fixing the base architecture as DeepLabV3+~\main{[10]} to show that cell detection benefits from tissue context.
% \biagio{Running new experiments during rebuttal makes the paper weaker and subjected to rejection. If it is necessary, try at least to defend our position on why we didn't do it. Like: "it wasn't necessary for this reason bla bla bla... but to make the reviewer happy we run the following experiment....". For example, our is a dataset paper, we could argue that we focus on the task and leave space for the community try adapting novel methods.. not sure about this though...}
Nevertheless, as requested by reviewers, we provide more cell detection baselines (U-Net and MFoVCE-Net~\main{[6]}) on the OCELOT dataset. 
Note that, MFoVCE-Net is a strong baseline that further utilizes a large FoV patch as an input, but not a corresponding tissue annotation.
% To provide stronger evidence, we compare our performance to other Cell-only baselines, U-Net and MFoVCE-Net \main{[6]} on the OCELOT dataset.
% Note that, MCSpatNet is a state-of-the-art baseline that was recently shown~\cite{abousamra2021multi} to outperform HoVer-Net \main{[17]}.
\autoref{tab:more-baseline} shows that the proposed Pred-to-inter-2 still outperforms all the baselines by a large margin.
This emphasizes the importance of the additional larger FoV input and associated tissue label. We will add these results to our camera-ready.

% To provide stronger evidence, we compare our performance to other cell-only baselines, U-Net and MCSpatNet~\cite{abousamra2021multi} on the OCELOT dataset.
% Note that, MCSpatNet is a state-of-the-art baseline that was recently shown~\cite{abousamra2021multi} to outperform HoVer-Net \main{[17]}.
% \autoref{tab:more-baseline} shows \textcolor{red}{that none of the methods provide a notable boost in performance compared to the cell-only baseline.}
% This emphasizes the importance of the additional larger FoV input, and associated tissue label. We will add these results to our camera-ready.

\head{Two-class Annotations (\Rthree, \Rfour)}
% \biagio{I believe this is the most crucial point of the reviews. In general it is a good answer, but it is hard to understand and reviewers don't have time to spend on understanding rebuttal. The language should be shorter and straight to the point. I like the word "budget" used on the doc notes, it immediately gives the reader idea of what's going on. Please use that.}
%
% \rjw{sergio can help on this}
% \wookie{I wrote a version, see below}
% \smp{I think it is good! I wonder if it is worth stressing that BG cells are actually annotated, and suggest in the future the dataset can be more easily refined with new classes.}
% \wookie{That is indeed a good point to mention!}
%
% Within budget limitations, we decided to focus on covering multiple organs and a large number of cells, which constrained the type of cells to tumor vs non-tumor. \wookie{I would never talk about budget limitations -- the reviewer won't be interested}
% Also, we aim to collect a dataset that allows studying cell-tissue relationships, in which tumor/non-tumor classes for cell and background/cancer-area classes for tissue are sufficient. \wookie{``sufficient'' is a bit weak. I will try to re-write this}
%
The annotation of cells and tissue regions is notoriously expensive in CPATH due to the need for multiple board-certified pathologists.
Under constrained budgets, datasets strategically select just a few factors to vary.
Our interest was in studying the cell-tissue relationship, particularly tumor cells and cancer area.
Thus, to better demonstrate the general applicability of our insights, we prioritize data quantity (2$\times$ TIGER) and diversity (6 cancer types) over cell categories.
% \biagio{This previous sentence can be written much shorter, like "We prioritize data quantity (2$\times$TIGER) and diversity (cancer types) over cell categories.". In general the language should be more compact and straight to the point, no "decided to", "notoriously" or "accordingly".}
Consequently, our insights from OCELOT transfer well to other settings in pathology such as TILs in breast cancer (TIGER) or IHC-stained imagery (CARP), showing that OCELOT is a good test-bed for exploring cell-tissue relationships and their impact on cell detection.
Furthermore, we annotate BC (all other cells except TC) to allow for easier future refinements of the dataset with new cell classes. 
% \biagio{Maybe something like: "Our focus is on improving cell detection with tissue context, we selected the minimum-denominator across CPath field (detecting TC) so that it is easy to build on top (e.g. adding more cell types), while keeping our insights valid. "}

\head{TC-on-CA (\Rone)}
% \biagio{can we shorten tumor cancer to TC?}
%
% It is certainly valid to wonder about the performance of cell detection when applying hard constraints manually.
Tumor cells are typically found on cancer area (\main{Tab.~3a}).
Setting this via hard constraints (post-processing) can be a strong baseline (denoted as ``TC-on-CA'').
% and as such we can experimentally define a hard rule which enforces that all detected cells in cancer predicted regions are tumor cells (and all other cells are non-tumor).
We show the results in \autoref{tab:tc_on_ca}, where TC-on-CA outperforms Cell-only, showing that applying a hard constraint between the tumor cell and the cancer area can mitigate the issue due to low FoV.
%\smp{We conducted the experiment, and TC-on-CA (Val: 71.57 +- 1.44; Test: 68.90 +- 1.53) outperforms Cell-only (Val: 68.87 +- 1.76; Test: 64.44 +- 1.82), showing that applying a hard constraint between the tumor cell and the cancer area can mitigate the issue due to low FoV.}
% However, our Pred-to-inter-2 method still performs better, which shows that the complex relationship between tumor cells and cancer area benefits from being encoded via supervised learning, and that tumor cells can exist outside of CA (\main{Tab.~3a}).
However, Pred-to-inter-2 still performs better, which shows that the complex relationship between tumor cells and cancer area should be learned.
%\smp{However, Pred-to-inter-2 (Val: 72.68 +- 1.58; Test: 71.23 +- 0.96) still performs better, which shows that the complex relationship between tumor cells and cancer area benefits should be learned.}
In addition, 7.4\% of tumor cells exist outside of the cancer area (\main{Tab.~3a}), and it is still important to detect those tumor cells, which makes TC-on-CA inappropriate.

% \smp{we can talk about tumor cells out of CA as the reviewer mentioned and say how ...}
% \biagio{The reviewer already explained the approach, you can use that to shorten this paragraph by a lot. Just say "We implemented the interesting suggestion from RAi6 and achieves 68.9\% on test, 2.3\% less than our method, still better than cell-only. We will include it in the supplementary." That's all you need to say and save a full table. You are not writing a paper here...}

\head{Missing Details (\Rtwo)}
We promise all items will be addressed in our paper or supplementary materials. Also, all WSIs are publicly available on TCGA (\main{L292}) and we will release the IDs to facilitate further details consultation.
%Also, the TCGA subject IDs will be released so that anyone can check further details regarding to the dataset.
% \smp{We can promise to release the TCGA subject IDs, so that anyone can check further details that are not here.}

\vspace{-2mm}
\begin{itemize}
\item (Staining) OCELOT uses H\&E stained images (\main{L136}).
\item (Scale) All patches are on the same scale of 0.2 Microns-per-Pixel (\main{L318-323}).%, wh in 0.8 MPP (\main{L318-323}).
% All the WSIs for train/validation/test subsets are stained with Hematoxylin and Eosin (H\&E). 
% \biagio{Do we really never mention this in the paper? This is bad, I don't believe it. Can we point at the line where we mention it? Always use the paper to answer reviewers when possible!}\aaron{It is mentioned in line 136, where we list the contributions.}
% , as mentioned in line 136.
% Information on the staining used in the whole slides, and on the distribution of the staining over subsets is missing

% SKIP
% \item (Patient Info.) \textcolor{red}{Patient histories/prognoses/tumor types are missing}

\item (Subset Def.) Subsets are defined by randomly splitting the data at the WSI level, i.e. patches from the same WSI must be in the same subset (\main{L356}). We do so while keeping the ratio of cancer types consistent across each subset.
% It is not mentioned how the splitting into subsets is done. Was it random or was a stratified strategy followed?

\item (Annotation Rule) For cells, annotators were asked to annotate the center point of each cell. For tissue, annotators were asked to draw contours as accurately as possible.
% The annotation rules for cells (any random point in the cell was annotated/central point was sought?), for regions (how closely were the boundaries respected?) are omitted

% SKIP
% \item \textcolor{red}{(Magnification)} At what magnification/scale are the images taken? Are all of them on the same scale?
% At what magnification/scale are the images taken? Are all of them at the same scale?

\item (Consensus Strategy) Each tissue patch is annotated by a single pathologist. Each cell patch is annotated by three pathologists with the following consensus strategy. 
First, two pathologists annotate the same cell patch independently. 
Then, the third pathologist merges the two annotations taking the discrepancies into account. 
This strategy was specifically designed to reduce the naturally high inter-rater variability when annotating cells.

% Each tissue patch is annotated by a single board-certified pathologist while for the cell patches, we adopt a 2+1 annotation strategy with a final validation step. First, 2 independent pathologists annotate the same cell patch. Then, a third pathologist merges the annotations taking into account the discrepancies. Lastly, a final pathologist validates the annotations. This strategy was specifically designed to reduce the naturally high inter-variability when annotating cells.


% \textcolor{red}{(what is 2+1? need to directly explain consensus strategy)} 

% It is not clear if there are multiple observers for each cell/region/image, and whether there was a consensus strategy if so. This also leaves the question of possible inter-operator variability.

% SKIP
% \item \textcolor{red}{(Annotation Time Cost)} Finally, the time required for annotation might also be helpful in some cases.
% Finally, the time required for annotation might also be helpful in some cases.

% SKIP
% \item (Train/Inference Time)
% Run times for training and predictions should be included in a benchmark.
% In case of OCELLOT, training \textit{Cell-only} takes $\sim$4h and \textit{Pred-to-inter-2} takes $\sim$4.5h using 4 T4 GPUs.

% SKIP
% \item (Data Aug.) 
% Employed data augmentation should be noted.

% SKIP
% \item (Loss)
% Training losses and their relatives weights are missing.
% DICE losses are used for both cell and tissue segmentation and weighted equally.

% SKIP
% \item Among $4^3$ possible feature-sharing models, we chose a final model that shows the best validation set mF1 score on the OCELOT dataset.
% The chosen feature-sharing model is depicted in \main{Fig. 6} (\main{L583}).
% Finally, the details on which was feature sharing model chosen out of the 4**3 possibilities (line 583) are missing.

\item (Applying to TIGER) We formulate cell detection as a segmentation task (\main{L478-504}) and predict segmentation maps where each channel represents the probability of each class. Thus, the model implementations are agnostic to the number of classes.
% An important aspect that is not mentioned is how the employed models were tested on TIGER. TIGER has only one type of cell, unlike the proposed dataset, which has two. It appears from Figure 4 and from line 480 that the detection task as two aspects - localization and classification. Was this implemented in a different manner for TIGER where there is no classification necessary?
% \biagio{Are all these info really completely missing in the paper? If I was an AC and I read this answer, I would question the quality of the paper...} 

\item (Others) Data augmentation, training losses, and training/inference time will be added to our camera-ready.

\end{itemize}


%%%%%%%%% TABLES

\begin{table}[t]
\small
\centering
\setlength{\tabcolsep}{0.5em}
\begin{tabular}{llrcl}
\toprule
\textbf{Method} & \textbf{Architecture} & \multicolumn{1}{c}{\textbf{Val}} & \multicolumn{1}{c}{\textbf{Test}}\\ 
\midrule
Cell-only & DeepLabV3+ \main{[10]} & \score{68.87}{1.76} & \score{64.44}{1.82} \\
Cell-only & U-Net & \score{67.75}{1.42} & \score{63.46}{4.59} \\
%Cell-only & MCSpatNet & \score{66.23}{1.37} & \score{64.84}{1.30}\\
Cell-only$\dagger$ & MFoVCE-Net \main{[6]} & \score{69.14}{0.52} & \score{67.12}{1.96}\\
\midrule
Pred-to-inter-2 & DeepLabV3+ \main{[10]} & \score{72.68}{1.58} & \score{71.23}{0.96}\\
%\midrule
%\textcolor{gray}{U-Net (pred-to-inter-2)} & 67.81±2.94 & 63.59±4.19 \\
%\textcolor{gray}{U-Net (pred-to-inter-2) 2} & 66.83±2.34 & 67.37±4.99 \\
%\textcolor{gray}{U-Net (feature-sharing)} & 65.33±1.65 & 65.73±7.07 \\
%\textcolor{gray}{U-Net (feature-sharing) 2} & 64.23±3.13 & 68.29±1.93 \\
\bottomrule
\end{tabular}
\vskip -2mm
\caption{\textbf{More cell detection baselines.} Comparison with various cell detection methods. $\dagger$ denotes that a large FoV patch is further utilized as an input.
% \biagio{Don't waste too much time on this, focus on writing the rebuttal. The reviewer only mentions HoVer-Net, can we not implement that? If not only 1 is enough, we don't need 2. Why Fast R-CNN?}
% \wookie{We should add Pred-to-Inter-2 results to show that it is still better.}
}
\label{tab:more-baseline}
\vspace*{-1mm}
\end{table}

\begin{table}[t]
\small
\centering
\setlength{\tabcolsep}{0.2em}
\begin{tabular}{lrrcl}
\toprule
\textbf{Method} & \multicolumn{1}{c}{\textbf{Val}} & \multicolumn{1}{c}{\textbf{Test}}\\ 
\midrule
Cell-only & \score{68.87}{1.76} & \score{64.44}{1.82}\\
TC-on-CA & \score{71.57}{1.44} & \score{68.90}{1.53}\\
% val-0.7188 / test-0.6808
% val-0.7228 / test-0.6867
% val-0.7056 / test-0.6995
Pred-to-inter-2 & \score{72.68}{1.58} & \score{71.23}{0.96}\\
\bottomrule
\end{tabular}
\vskip -2mm
\caption{\textbf{TC on CA.} Applying hard cell class constraints based on predicted tissue class.}
\label{tab:tc_on_ca}
\vspace*{-3mm}
\end{table}

\vspace{-2mm}
\head{What is the best model? (\Rthree)} 
Pred-to-inter-2 performs best overall in \main{Tab.~5} and \main{Tab.~6}, so we use it in our ablation study and qualitative analysis in \main{Sec.~6}.

\head{Statistical Tests (\Rthree)} 
Comparing the best model Pred-to-inter-2 and the baseline Cell-only, the performance improvement is statistically significant (p-value $< 0.01$).

\head{Feature Sharing Model (\Rfour)} 
As illustrated in \main{Fig.~5b}, the injected cell features are from only the annotated crop.

\head{Repeated Numbers (\Rfour)} 
The repeated numbers in the first row of \main{Tab.~7} are intended since both represent the performance of the Cell-Only baseline.

% \head{Miscellaneous}
% Pred-to-inter-2 performs best overall in \main{Tab.~5} and \main{Tab.~6}, so we use it in our ablation study and qualitative analysis in \main{Sec.~6} (\Rthree). 
% Comparing the best model Pred-to-inter-2 and the baseline Cell-only, the performance improvement is significant (p-value $< 0.01$) (\Rthree).
% OCELOT Val  0.00005
% OCELOT Test 0.00000 
% TIGER  Val  0.00528  <-
% TIGER  Test 0.07716  <- 
% CARP   Val  0.00039
% CARP   Test 0.00186 
% Mann-Whitney U 
% OCELOT Val  0.00397
% OCELOT Test 0.00397 
% TIGER  Val  0.01587 
% TIGER  Test 0.11111 
% CARP   Val  0.00397 
% CARP   Test 0.00397 
% In the feature sharing model (\main{Fig.~5b}), the injected cell features are from only the annotated crop (\Rfour).
% The repeated numbers in the first row of \main{Tab.~7} are intended since both represent the performance of the Cell-Only baseline (\Rfour).


% \wookie{TODO: see if \Rone's comment: ``solution of only the unique problem for the cell detection in histopathology. If they claim that the paper contributes to solve more general problem, the paper would be more valuable.'' should be addressed.}
% Sergio and Jeongun feels it's okay to skip this one.


% \wookie{TODO: see if \Rthree's comment: ``3. From tables, it is not easy to find one specific model with best performance across all tasks. In practice, how to decide which model to use?'' should be addressed.}


% \biagio{References within a rebuttal take too much space. can we skip them? If we have these references in the main paper we can just point at them.}
% %%%%%%%%% REFERENCES
% \vspace{2mm}
% \hrule
% \vspace*{-1mm}
% \renewcommand{\thepage}{}  % hide page number reference
% {\scriptsize
% %\bibliographystyle{ieee_fullname}
% \bibliographystyle{unsrt2authabbrvpp}
% \bibliography{egbib}
% }

\end{document}
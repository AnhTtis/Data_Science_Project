\begin{tikzpicture}[
image/.style={rectangle, draw=none},
small/.style={rectangle, draw=none, fill=blue!20, rounded corners=2mm},
large/.style={rectangle, draw=none, fill=blue!40, rounded corners=2mm},
image_encoder/.style={minimum height=10mm, minimum width=10mm},
text_encoder/.style={minimum height=10mm, minimum width=10mm},
box/.style={rectangle, draw=white, fill=red!70, minimum width=2mm, minimum height=2mm},
CLIP/.style={dashed, draw=violet },
BUILD/.style={dotted, draw=black,thick,rounded corners=2mm},
RUNTIME/.style={dotted, draw=black,thick,rounded  corners=2mm},
arrow/.style={->,thick,blue!70},
bar/.style={thick, blue!70},
]

% \draw[help lines,step=5mm,gray!20] (0,0) grid (12,8);
\foreach \src/\x in {000000000285.jpg/0.0, 000000001584.jpg/0.1, 000000001584.jpg/0.2, 000000006040.jpg/0.3}{
    \node[image] () at (\x, \x) {\includegraphics[width=20mm, height=10mm]{images/\src}};
}

\node[small, image_encoder] at (30mm, 1mm) (small_image_encoder)  {$I_s$};
% \node[small, text_encoder] at (45mm, 20mm) (small_text_encoder)  {$\tilde E^{\mathcal{T}}$};

\node[large, image_encoder] at (60mm, 1mm) (small_image_encoder)  {$I_l$};
\node[large, text_encoder] at (50mm, 15mm) (small_text_encoder)  {$T$};

\foreach \y in {-0.2,0.0,...,0.4}{
% image to the first CLIP
    \node[box] at (45mm, \y){};
    \draw [arrow] (13mm, \y) -- (25mm,\y);
    \draw [arrow] (35mm, \y) -- (44mm,\y);
}
\draw [arrow] (50mm, 10mm) --  (45mm,5mm);
\foreach \y in {0.2,0.4}{
%first CLIP to the second CLIP
    \node[box, fill=green] at (45mm, \y){};
    \node[box, fill=green] at (50mm, \y){};
    \draw [arrow] (46mm, \y) -- (49mm,\y);
    \draw [arrow] (51mm, \y) -- (55mm,\y);
    \node[box] at (75mm, \y){};
    \draw [arrow] (65mm, \y) -- (74mm,\y);
}
\draw [arrow] (50mm, 10mm) -- (75mm,5mm);
\node[box, fill=green] at (75mm, 4mm){};
\node[box, fill=green] at (80mm, 4mm){};
\draw [arrow] (76mm, 4mm) -- (79mm,4mm);
\draw [arrow] (81mm, 4mm) -- (85mm,4mm);

\node[] at (50mm, 25mm) {``A photo of a tram."};
\foreach \x in {5}{
        \draw[arrow] (50mm, 23mm) -- (\x, 20mm);
}

\draw[arrow] (0mm, -5mm) -- (0mm, -10mm) -- (50mm, -10mm) -- (50mm, 1mm);
\draw[arrow] (50mm, -10mm) -- (80mm, -10mm) -- (80mm, 3mm);

% \draw[CLIP] (23mm, -15mm) rectangle (52mm, 30mm);
% \draw[CLIP] (53mm, -15mm) rectangle (82mm, 30mm);
% \node[text=violet] at (45mm,-10mm) {$f_1$};
% \node[text=violet] at (75mm,-10mm) {$f_2$};
\draw[BUILD] (20mm, -15mm) rectangle (37mm, 20mm);
\draw[RUNTIME] (38mm, -15mm) rectangle (85mm, 20mm);
\node[text=black] at (28mm, -13mm) {build time};
\node[text=black!100] at (60mm, -13mm) {run time};

\end{tikzpicture}
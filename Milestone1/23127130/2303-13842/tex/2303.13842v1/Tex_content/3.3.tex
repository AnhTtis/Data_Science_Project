Considering the hierarchical structure of the features obtained using the Swin Transformer backbone, more advanced techniques for dense prediction, such as Feature Pyramid Networks (FPN)~\cite{lin2017feature} and U-Net~\cite{ronneberger2015u}, can be employed for linking the hierarchical information. 
In our work, we incorporate UPerNet~\cite{xiao2018unified} with our proposed PCA.

As depicted in Fig.~\ref{fig:upernet}, UPerNet features a top-down architecture with lateral connections that facilitate the fusion of high-level semantic information with lower-level details. The model utilizes a Pyramid Pooling Module (PPM)~\cite{zhao2017pyramid} to achieve a larger receptive field and generate effective global prior representations.
UPerNet has the capability to learn visual attributes for semantic segmentation and image completion at multiple levels.
Let $\{F_{1}, F_{2}, F_{3}, F_{4}\}$ denotes the set of the resulting feature maps of each stage of the backbone.
The corresponding downsampling rate for the $\{F_{1}, F_{2}, F_{3}, F_{4}\}$ are $\{4,8,16,32\}$, respectively.
In the decoder stage,  the PPM is only used at the top of $F_{4}$, where the resulting feature map can be denoted as $\hat{F}_{4}$.
Then, $\hat{F}_{4}$ is upsampled and sum with $F_{3}$ to progressively fuse multi-level features. The upsampling and downsampling rates are kept the same and finally four feature maps are obtained through the decoder stage.
The corresponding feature maps for the four stages of the decoder are be referred to as $\{\hat{F}_{1}, \hat{F}_{2}, \hat{F}_{3}, \hat{F}_{4}\}$. $\hat{F}_{4}$ (which is alternatively denoted as $z_s$) is then merged with the feature $z_c$ from the image completion branch by using the PCA module explained in the next subsection.
The final feature map can be obtained as follows: 
\begin{equation}
    \centering
    z_{out} = Fuse(\hat{F}_{1}, \hat{F}_{2}, \hat{F}_{3}, z_{pca}),
\end{equation}
where the $z_{pca}$ denotes the output feature map of the PCA mechanism. We fuse the feature maps via concatenation.

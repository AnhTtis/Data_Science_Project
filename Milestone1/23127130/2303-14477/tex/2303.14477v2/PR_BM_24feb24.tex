\documentclass[11pt,reqno]{amsart}

\usepackage[T1]{fontenc}
%\usepackage{lmodern}
\usepackage{slantsc}
\usepackage{bold-extra}

\usepackage{amssymb}
\usepackage{enumitem}
\usepackage{geometry}
\usepackage{accents}
% \geometry{
% a4paper,
% total={170mm,257mm},
% left=20mm,
% top=20mm,
% }
%\geometry{bottom=3.5cm}
 
\usepackage{mathtools}
\usepackage{mathrsfs}
\usepackage{xcolor}
\usepackage[colorlinks=false, linkcolor=black, citecolor=black, urlcolor=black]{hyperref}
\usepackage{cleveref}
\usepackage{bookmark}

\usepackage{graphicx, caption, subfig}
%\renewcommand{\thefigure}{\arabic{part}.\arabic{figure}}
\captionsetup[figure]{margin=25pt, font=footnotesize, labelfont=sc, %labelsep=endash
}
\captionsetup[subfigure]{labelformat=simple, labelsep=space, font=scriptsize, labelfont=normalfont, margin=0pt}

\usepackage[section]{placeins}
\usepackage[export]{adjustbox}

\usepackage{tikz}

%\usepackage[symbol]{footmisc}
%\renewcommand{\thefootnote}{\fnsymbol{footnote}}


\newtheorem{thm}{Theorem}[section]
\newtheorem{prop}[thm]{Proposition}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{cor}[thm]{Corollary}
\crefname{thm}{Theorem}{Theorems}
\crefname{prop}{Proposition}{Propositions}
\crefname{lem}{Lemma}{Lemmas}
\crefname{cor}{Corollary}{Corollaries}

\newtheorem{claim}[thm]{Claim}
\newtheorem{step}{Step}
\crefname{claim}{Claim}{Claims}
\crefname{step}{Step}{Steps}

\theoremstyle{definition}
\newtheorem{definition}[thm]{Definition}
\newtheorem{example}[thm]{Example}
\crefname{definition}{Definition}{Definitions}
\crefname{example}{Example}{Examples}

\theoremstyle{remark}
\newtheorem{remark}[thm]{Remark}
\crefname{remark}{Remark}{Remarks}


\numberwithin{equation}{section}

\renewcommand\qedsymbol{$\blacksquare$}

%%% New macro for big dot for punctured balls %%%%%
\newcommand*{\dt}[1]{%
	\accentset{\mbox{\large\bfseries .}}{#1}}

\newcommand{\pair}[2]{\ensuremath\langle#1,#2\rangle}
\newcommand{\norm}[1]{\ensuremath\lVert#1\rVert}
\newcommand{\compl}{^\mathsf{c}}
%\newcommand{\compl}{^\complement}
\newcommand{\defeq}{\vcentcolon=}
\newcommand{\trinorm}[1]{\ensuremath|\!|\!|#1|\!|\!|}
\newcommand{\leqold}{\leq}
\newcommand{\geqold}{\geq}
%\newcommand{\emptyold}{\emptyset}
\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
%\renewcommand{\emptyset}{\varnothing}
\newcommand{\ssubset}{%
%\subset\joinrel\subset
\Subset}
\newcommand{\phii}{\phi}
\renewcommand{\phi}{\varphi}
\newcommand{\epsi}{\epsilon}
\renewcommand{\epsilon}{\varepsilon}

\newcommand{\tildee}[1]{\widetilde{#1}}

\newcommand{\ap}{\textsuperscript}
\newcommand{\ped}{\textsubscript}

\DeclareMathOperator{\LSC}{LSC}
\DeclareMathOperator{\USC}{USC}
\DeclareMathOperator{\Lip}{Lip}
\DeclareMathOperator{\epi}{epi}
\DeclareMathOperator{\conv}{conv}
\DeclareMathOperator{\Diff}{Diff}
\DeclareMathOperator{\intr}{int}
\DeclareMathOperator{\Aff}{Aff}
\DeclareMathOperator*{\osc}{osc}
\DeclareMathOperator*{\aplimsup}{ap\,lim\,sup}
\DeclareMathOperator*{\aplim}{ap\,lim}

\newcommand{\fns}{\footnotesize}

\newcommand{\C}{\call C^+}
\newcommand{\cont}{\mathscr{C}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Pc}{\mathcal{P}}
\newcommand{\Sc}{\mathscr{S}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\de}{\partial}
\newcommand{\di}{\mathrm{d}}
\newcommand{\R}{{\mathbb{R}}}
\newcommand{\I}{I}
\newcommand{\call}[1]{\ensuremath\mathcal{#1}}
\newcommand{\frk}[1]{\ensuremath\mathfrak{#1}}
\newcommand{\scr}[1]{\ensuremath\mathscr{#1}}
%\newcommand{\barr}[1]{\ensuremath\bar{#1}}
\newcommand{\barr}[1]{\ensuremath\overline{#1}}
\newcommand{\dto}{\ensuremath{\searrow}}
\newcommand{\uto}{\ensuremath{\nearrow}}

\newcommand{\Q}{Q}
\newcommand{\RR}{R}

\newcommand\restr[2]{{% we make the whole thing an ordinary symbol
  \left.\kern-\nulldelimiterspace % automatically resize the bar with \right
  #1 % the function
  \vphantom{|} % pretend it's a little taller at normal size
  \right|_{#2} % this is the delimiter
  }}
  

%comandi da Payne
%\setlength\marginparwidth{2cm}
\newcommand{\noticina}[1]{\marginpar{\tiny\emph{#1}}}

%numeri sezioni
\makeatletter
%\@addtoreset{section}{part}
\makeatother
\renewcommand\thesection{\arabic{section}}
\renewcommand\thepart{\Roman{part}}
%

%per indentare le subsections nella toc
\makeatletter
\def\@tocline#1#2#3#4#5#6#7{\relax
  \ifnum #1>\c@tocdepth % then omit
  \else
    \par \addpenalty\@secpenalty\addvspace{1.1pt}%original:\addvspace{#2}
    \begingroup \hyphenpenalty\@M
    \@ifempty{#4}{%
      \@tempdima\csname r@tocindent\number#1\endcsname\relax
    }{%
      \@tempdima#4\relax
    }%
    \parindent\z@ \leftskip#3\relax \advance\leftskip\@tempdima\relax
    \rightskip\@pnumwidth plus4em \parfillskip-\@pnumwidth
    #5\leavevmode\hskip-\@tempdima
      \ifcase #1
       \or\or \hskip 1em \or \hskip 2em \else \hskip 1em \fi%
      #6\nobreak\relax
    \hfill\hbox to\@pnumwidth{\@tocpagenum{#7}}\par% <---- \dotfill -> \hfill
    \nobreak
    \endgroup
  \fi}
\makeatother
%%


\setlist[enumerate]{leftmargin=2em}
\setlist[itemize]{leftmargin=2em}

%%CHANGE APPEAREANCE OF PARTS
\makeatletter
%default definition of article.cls
%using \renewcommand instead of \newcommand
\renewcommand\part{%
   \if@noskipsec \leavevmode \fi
   \par
   \addvspace{4ex}%
   \@afterindentfalse
   \secdef\@part\@spart}

\def\@part[#1]#2{%
    \ifnum \c@secnumdepth >\m@ne
      \refstepcounter{part}%
      \addcontentsline{toc}{part}{\partname~\thepart.\hspace{1em}#1}%
    \else
      \addcontentsline{toc}{part}{#1}%
    \fi
    {\parindent \z@ \raggedright
     \interlinepenalty \@M
     \normalfont
     \ifnum \c@secnumdepth >\m@ne
      \center \Large \bfseries \partname\nobreakspace\thepart
     .%  \par\nobreak
     \fi
     \enspace \Large \bfseries #2%
     %%%\markboth{}{}\par}% removing redefinition of headings
     \par}%
    \nobreak
    \vskip 3ex
    \@afterheading}
\def\@spart#1{%
    {\parindent \z@ \raggedright
     \interlinepenalty \@M
     \normalfont
     \huge \bfseries #1\par}%
     \nobreak
     \vskip 3ex
     \@afterheading}
\makeatother
%%


\begin{document}

%toglie le note
%\renewcommand{\marginpar}[2][]{}
%%

\date{\today} \linespread{1.1}

\title[Quasi-convex functions in nonlinear potential theories]{A primer on quasi-convex functions in nonlinear potential theories}
%\author{Marco Cirant}
%\address{Dipartimento di Matematica ``T.\ Levi-Civita''\\ Università degli Studi di Padova\\ \newline Via Trieste 63\\ 35121--Padova, Italy}
%\email{cirant@math.unipd.it (Marco Cirant)}
%%\thanks{Cirant partially supported by the Fondazione CaRiPaRo Project ``Nonlinear Partial Differential Equations: Asymptotic Problems and Mean-Field Games'' and the Programme ``FIL-Quota Incentivante'' of University of Parma, co-sponsored by Fondazione Cariparma.}
\author{Kevin R.\ Payne}
\address{Dipartimento di Matematica ``F.\ Enriques''\\ Università degli Studi di Milano\\ Via~C.~Saldini~50\\ 20133--Milano, Italy}
\email{kevin.payne@unimi.it (Kevin R. Payne)} %\thanks{Payne partially supported by the Gruppo Nazionale per l'Analisi Matematica, la Probabilit\`a e le loro Applicazioni (GNAMPA) of the Istituto Nazionale di Alta Matematica (INdAM) and the projects: GNAMPA 2017 ``Viscosity solution methods for fully nonlinear degenerate elliptic equations'', GNAMPA 2018 ``Costanti critiche e problemi asintotici per equazioni completamente non lineari'' e GNAMPA 2019 ``Problemi differenziali per operatori fully nonlinear fortemente degeneri''.}
\author{Davide F.\ Redaelli}
\address{Dipartimento di Matematica ``T.\ Levi-Civita''\\ Università degli Studi di Padova\\ Via Trieste 63\\ 35121--Padova, Italy}
\email{redaelli@math.unipd.it (Davide F.\ Redaelli)}

\keywords{}

\subjclass[2010]{}

\begin{abstract}
We present a self-contained treatment of the fundamental role that {\em quasi-convex functions} play in general (nonlinear second order) potential theories, which concerns the study of {\em generalized subharmonics} associated to a suitable closed subset ({\em subequations}) of the space of $2$-jets. Quasi-convex functions build a bridge between classical and viscosity notions of solutions of the natural Dirichlet problem in any potential theory. Moreover, following a program initiated by Harvey and Lawson in~\cite{hldir09}, a potential-theoretic approach is widely being applied for treating nonlinear partial differential equations (PDEs). This viewpoint revisits the conventional viscosity approach to nonlinear PDEs~\cite{user} under a more geometric prospective inspired by Krylov~\cite{kr} and takes much insight from classical pluripotential theory. The possibility of a symbiotic and productive relationship between general potential theories and nonlinear PDEs relies heavily on the class of quasi-convex functions, which are themselves the generalized subharmonics of a pure second order constant coefficient potential theory. 
\end{abstract}

\maketitle

\setcounter{tocdepth}{3}
\tableofcontents

\section*{Introduction}

This work is dedicated to foundational aspects of general (nonlinear) second order potential theories as initiated by Reese Harvey and Blaine Lawson, beginning with a trio of papers, \cite{hlpotcg}, \cite{hlpluri09} and \cite{hldir09}, published in 2009. A general potential theory concerns the study of generalized {\em subharmonic functions} with respect to a given constraint set on the space of $2$-jets, called a {\em subequation}. The boundary of a subequation provides a second order partial differential equation. Our aim is to give a comprehensive presentation of the main tools in quasi-convex analysis which are useful in order to study general potential theories as well as to deal with nonlinear PDEs by a the potential-theoretic approach of Harvey and Lawson, which (in many cases) can recast the operator theory in a flexible and more geometric way through the use of an associated potential theory. Recently, a powerful {\em correspondence principle} has been established in the presence of {\em sufficient monotonicity} for the constant coefficient case in the monograph \cite{chlp} and in the additional presence of {\em fiberegularity} for the general case in the paper \cite{cprdir}. This correspondence principle is used to embed a given partial differential operator into an associated potential theory and then to deduce properties about the operator theory from the corresponding potential theoretic properties. Moreover, these properties are shared by any operator compatible to the given potential theory. In that light, the present work can be viewed as a prequel to the aforementioned works and our main aim is to provide a comprehensive introduction to the foundations on which the Harvey-Lawson theory rests. Given the comprehensive nature of the work, some of the results we present will be well known. Many others are much less well known, and this work aims to change that fact. There will also be new results and new interpretations of recent known results, which derive from the insight of Harvey and Lawson.

Before continuing with the presentation, an important remark concerning terminology should be made. We follow the usage of Harvey and Lawson (as well as \cite{chlp} and \cite{cprdir}) by saying that an upper semicontinuous function $u$ is \emph{quasi-convex} if a quadratic perturbation $u + \frac{\lambda}{2}| \cdot|^2$ is convex for some $\lambda \geq 0$, which is equivalent to asking that the Hessian of $u$ is bounded below (in the viscosity sense). This is often called \emph{semiconvexity} (especially in the conventional viscosity literature such as \cite{user}). We prefer the term quasi-convex since these functions are not ``half-convex'' in the same way that semicontinuous functions are  ``half-continuous'' and the term quasi-convex is consistent with the use of \emph{quasi-plurisubharmonic} in several complex analysis, as noted in~\cite{hpsurvey}. Moreover, one should also note that in convex analysis, quasi-convexity is often used to mean that inverse images of half-lines bounded above are convex sets. Perhaps a different term such as ``convexable'' might be advisable, or to use \emph{Hessian bounded below} as in \cite{slod}. Indeed, any $C^2$ function is locally quasi-convex, which shows that quasi-convex functions are far from being ``half-convex''.

In order to set the stage for the role that quasi-convex functions play in general potential theories, we begin with a description of the program initiated by Harvey and Lawson. Their program was in part inspired by the geometric approach of Krylov~\cite{kr} in order to formulate a general notion of ellipticity. In the pure second order case, Krylov calls a differential operator $u \mapsto F(D^2u)$ elliptic if it there exists an {\em elliptic set} for $F$; that is, an open subset $\Theta \subset \call S(n)$ such that $F$ is increasing for $A \in \Theta$ and the differential inclusion $D^2 u(x) \in \partial \Theta$ for each $x \in \Omega$  is called an \emph{elliptic branch} of the equation $F(D^2u) = 0$ if $\partial \Theta \subset \{ F = 0 \}$. One can then ``forget'' about the particular form of the operator $F$ and concentrate instead on the constraint set $\Theta$ as many operators $F$ will give rise to the same $\Theta$. Harvey and Lawson recognized similarities of this idea in pluripotential theory and starting instead from closed sets $\call F\subset \call S(n)$ (the closure of $\Theta$),  formulated a suitable notion of \emph{duality} which recasts the notion of viscosity solutions in a precise topological framework and developed a \emph{monotonicity--duality} method for proving the comparison principle in general potential theories. With additional work, this yields the comparisn principle for any fully nonlinear second-order partial differential which is compatible with  given potential theory. The comparison principle of course implies uniqueness of solutions for the associated Dirichlet problem in both contexts (potential theory and PDEs). Another major breakthrough in the Harvey-Lawson approach is to use asymptotic interiors of the constraint set to determine the correct notion of {\em boundary pseudoconvexity} for which one can construct the barriers needed to complete Perron's method for proving existence of solutions for the Dirichlet problem. 

After their pioneering paper \cite{hldir09} for pure second order constant coefficient potential theories, a sequence of ambitious papers of Harvey and Lawson followed, such as \cite{hldir} which studies the Dirichlet problem for fully nonlinear second-order equations on Riemannian manifolds, \cite{hlcharsmp} which characterizes the validity of the strong maximum principle, \cite{hllagma} and \cite{hlpssl} which treat the special Lagrangian potential equation, \cite{hlpotcg} on potential theory in calibrated geometry and \cite{hlidir} on the inhomogeneous Dirichlet problem for ``natural'' operators. Inspired by \cite{hldir09}, Marco Cirant and the first author began an investigation on embedding large classes of differential operators into the potential theoretic framework of Harvey and Lawson. The variable coefficient pure second order and gradient-free cases were treated in \cite{cpaux} and \cite{cpmain} respectively, where the continuity of the  fiber map $x \mapsto \mathcal{F}_x = \Theta(x)$ (now called {\em fiberegularity}) was shown to be a sufficient additional condition in order to transport the monotonicity-duality method from the constant coefficient to the variable coefficient setting. In addition, a rudimentary version of the correspondence principle was established in \cite{cpaux} and \cite{cpmain} but followed more explicitly the ideas of Krylov ((proper) elliptic maps $\Theta$ and associated branches of the PDE) as opposed to the subequation formulation. Joining forces in \cite{chlp}, a complete and robust treatment of constant coefficient potential theories and PDEs in Euclidian spaces by the monotonicity-duality method was given, including the aforementioned correspondence principle, a classification of {\em monotonicity cone subequations} and numerous illustrations of the method. Finally, the general variable coefficient case in the presence of sufficient monotonicity ({\em proper ellipticity} and {\em directionality}) and fiberegularity is treated by the authors and Cirant in \cite{cprdir}. 
 
Having recalled the context of the prequel that will be presented here, some declarations of intent are in order. The present work was born with the purpose of unifying and harmonizing the two articles \cite{hlqc} and \cite{hlae} and of Harvey and Lawson on quasi-convex functions and their use in general potential theories, which were deposited in the arXiv in 2016. These two preprints are full of foundational aspects of non-smooth analysis, some well known, others less well known and many new things. In particular, the two unpublished manuscripts contain many refinements and efficient use of quasi-convex functions for unifying and simplifying many aspects of the conventional viscosity theory, and as such, merit a comprehensive and unified presentation. The authors of this work are extremely grateful to Harvey and Lawson for their encouragement to attempt this synthesis, which was the basis of the Master's Thesis of the second author, supervised by the first author. 

It should be noted that the present work is more than a mere merging of the two preprints \cite{hlqc} and \cite{hlae}, whose combined length is less than one third of the present work. Beyond the question of length, the current presentation benefits from the numerous developments in the theory over the past decade. The last three paragraphs of the introduction will indicate what is ``new'' here. Finally, we should mention that there are many instances of lost opportunities of synergy between general nonlinear potential theories and nonlinear PDEs, with many concepts being discovered independently in the two realms.  We will focus on one such example in the discussion of the Jensen and S{\l}odkowski Lemmas towards the end of this introduction. Another major aim of this work is to contribute to the many opportunities for productive interplay between these two realms. The reader may also want to consult the introductions of \cite{chlp} and \cite{hpsurvey} for a more organic discussion. 


Before describing the contents of the present work, it will be useful to recall the definitions of subequation (constraint sets) and their subharmonics which are the basic objects in any potential theory. A {\em subequation} on an open subset $X \subset \R^n$ is a (closed) subset 
$$ \call F \subset \call J^2(X) := X \times \call J^2 := X \times \R \times \R^n \times \call S(n)
$$ 
of the bundle of $2$-jets over $X$ satisfying the properties of {\em positivity} (P), {\em negativity} (N) and {\em topological stability} (T). Properties (P) and (N) are {\em monotonicity} properties which combine to ask that for each $x \in X$ the fibers $\call F_x := \{J  \in \call J^2: (x,J) \in \call F\}$ satisfy
\begin{equation*}
J = (r,p,A) \in \call F_x \ \ \Rightarrow \ \ (r + s,p,A + P) \in \call F_x \quad \forall \, s \leq 0 \ \text{in} \ \R, \forall \, P \geq 0 \ \text{in} \ \call S(n).
\end{equation*}
When $\call F$ is defined by an operator $F \in C(\call J^2(X))$; for example, if 
$$
	\call F = \{ (x,r,p,A) \in \call J^2(X): \ F(x,r,p,A) \geq 0 \},
$$
 these monotonicity properties correspond to the differential operator being {\em proper elliptic}. This is the minimal monotonicity that must be assumed for the validity of the natural comparison principles associated to both $\call F$ and $F$. Property (T) helps to ensure a robust potential theory associated to a subequation $\call F$ (see Definitions~\ref{defnsubeq} and \ref{defn_prim_subeq}) including a natural notion of {\em duality} (see Section~\ref{sec:duality}). Given a subequation $\call F$, a function $u \in C^2(X)$ is said to be {\em $\call F$-subharmonic in $x \in X$} if
\begin{equation}\label{subh1_intro}
	J^2_x u := (u(x), Du(x), D^2u(x)) \in \call F_x
\end{equation}
and {\em $\call F$-subharmonic on $X$} if \eqref{subh1_intro} holds for each $x \in X$. For merely upper semicontinuous functions $u \in \USC(X)$, the definition \eqref{subh1_intro} is taken in the {\em viscosity sense}; that is, 
\begin{equation}\label{subh2_intro}
J^{2,+}_x u \subset \call F_x 
\end{equation}
where $J^{2,+}_x u$ is the set of {\em upper contact jets for $u$ at $x$}:
$$ 
J^{2,+}_x u := \{ J^2_x \varphi: \varphi \ \text{is $C^2$ near $x$ and}\ u \leq \varphi \ \text{near $x$ with equality at $x$} \}.
$$
Property (P) is necessary in order for \eqref{subh2_intro} to be useful and should be regarded as the weakest form of ellipticity necessary for a meaningful viscosity theory of subharmonics and subsolutions, as explained in Remark \ref{rem:weakly_elliptic}. Property (P) also ensures {\em coherence} in the sense that for $u$ twice differentiable in $x$, the classical notion \eqref{subh1_intro} implies the viscosity notion \eqref{subh2_intro}. Coherence is discussed in Remark \ref{rem:coherence}. Duality is then used to define the notions of a function $u$ being {\em $\call F$-superharmonic} and {\em $\call F$-harmonic} (see Sections \ref{sec:conset} and \ref{sec:duality}).

We are now ready to give a description of the contents of this work. We will attempt to highlight the main results and to indicate how they relate to the preprints \cite{hlqc} and \cite{hlae} on which this primer is based. The work is divided into two parts. Each part begins with a detailed guide for the reader, which complements the following synopsis of the two parts. 

Part I is dedicated to three fundamental and complementary aspects of quasi-convex analysis. The first aspect concerns differentiability properties of first and second order for locally quasi-convex functions, including the essential  {\bf {\em Alexandrov's Theorem }}\ref{aleks}  on the almost eveywhere differentiability of second order for (locally quasi-) convex functions. The second aspect concerns a detailed analysis of their {\em upper contact jets} and {\em upper contact points} and culminates in two fundamental results on locally quasi-convex functions at or near  points of upper (quadratic) contact: the {\bf {\em Upper Contact Jet Theorem}} \ref{ucjt}, which describes first and second order differentiability properties and the {\bf {\em Summand Theorem}} \ref{pusc:sum} which deduces useful and important information about upper contact points and upper contact jets of two functions $u,v$  from an upper contact jet for the sum $w(x) = u(x) + v(x)$. This last result has a clear relation to the {\em Theorem on Sums} of Crandall, Ishii, and Lions~\cite{user}, which instead treats sums such as $w(x,y) = u(x) + v(y) - \alpha |x - y|^{\alpha}$ with $\alpha > 0$ and large, and is a lynchpin on which much of the conventional viscosity theory rests. Interestingly, the Summand Theorem yields immedately a {\bf {\em quasi-convex version of the Theorem on Sums}} (as will be noted in Corollary \ref{tosqc2}). The third aspect concerns the deep analytical results which ensure the existence of sets of contact points with positive measure. This part of the analysis will culminate in the so-called {\bf {\em Jensen--S{\l}odkowski Theorem}} \ref{jenslod}, which unifies and generalizes two historically distinct approaches to a central problem in a viscosity approach in potential theory and operator theory. We will return to this point at the end of the introduction as an illustration of parallel developments in nonlinear potential theories and nonlinear PDEs.


These three aspects of Part I are essential for the implementation of the viscosity theory of subharmonics and supersolutions of Part II, as will be described at the end of the guide for the reader to Part I. Moreover, they represent the ``hard analysis'' part of the viscosity theory. This part expands upon results contained primarily in \cite{hlqc}, but also expands upon some results in \cite{hlae}.

Part II is dedicated to general nonlinear second order potential theories and the fundamental role that quasi-convex functions play in such theories. The presentation will involve three stages which can be summarized in the following way. Stage one gives a self-contained introduction to general second order potential theories, which is the context in which we will operate. Particular emphasis will be paid to the notions of {\em duality} and {\em monotonicity} which will have important consequences in all that follows.

Stage two is represented by two additional fundamental results of \cite{hlae}. The first result is the {\bf \emph{Almost Everywhere Theorem}}, which will also be called the AE Theorem, states that a locally quasi-convex function which is $\call F$-subharmonic almost everywhere (with respect to Lebesgue measure) in the classical sense \eqref{subh1_intro} is in fact $\call F$-subharmonic everywhere in the viscosity sense \eqref{subh2_intro}. This is particularly relevant in light of the easy extension of Alexandrov's theorem from convex to locally quasiconvex functions. The second result, which follows from the AE Theorem, is a quasi-convex version of the so-called {\bf \emph{Subharmonic Addition Theorem}} \ref{add}. Subharmonic addition theorems concern the validity ot the following implication: given a trio $\call F, \call G$ and $\call H$ of subequation constraint sets in $\call J^2(X)$ on an open set $X \subset \R^n$ (which then determine spaces of subharmonic functions $\call F(X), \call G(X)$ and $\call H(X)$ on $X$), from a purely algebraic statement on the space of $2$-jets
\begin{equation}\label{SA1}
\forall \, x \in X: \quad	\mathcal{F}_x + \mathcal{G}_x \subset \mathcal{H}_x \quad \text{({\em jet addition})},
\end{equation}
one concludes an analytic statement at the potential theory level
\begin{equation}\label{SA2}
\mathcal{F}(X) + \mathcal{G}(X) \subset \mathcal{H}(X) \quad \text{({\em subharmonic addition})}.
\end{equation}
When the subequations have constant coefficients, the Subharmonic Addition Theorem is extended in Corollary \ref{ccsa} to upper semicontinuous subharmonics by {\em quasi-convex approximation}, which preserves subharmonicity in the constant coefficient setting (see Proposition \ref{prop:approx}). Although we will not discuss this here, in the variable coefficient case, the aforementioned assumption of {\em fiberegularity} of the subequations yields a suitable alternative quasi-convex approximation scheme and the Subharmonic Addition Theorem extends to this setting (see \cite{cprdir} for details). 

Stage three concerns the use of quasi-convex analysis in the proof of {\em comparison principles} for nonlinear potential theories, as sketched in \cite{hlae}. Two distinct settings will be discussed. The first setting is when there is {\em sufficient monotonicity} in the sense that the subequation $\call F$ defining the potential theory admits a constant coefficient {\em monotonicity cone subequation} $\call M$; that is,  \eqref{SA1} holds with $\call G = \call M$ and $\call H = \call F$ and duality gives the jet addition formula
$$
	\forall \, x \in X: \quad	\call F_x + \widetilde{\call F}_x \subset \call M.
$$
If the Subharmonic Addition Theorem holds, then the comparison principle on a domain $\Omega$ reduces to the {\em Zero Maximum Principle} for $\widetilde{\call M}$-subharmonics:
$$
w \leq 0 \ \text{on} \ \partial \Omega \implies w \leq 0 \ \text{in} \ \Omega, \quad \forall \, w \in \USC(\overline{\Omega}) \cap \widetilde{\call M}(\Omega).
$$
 This is the idea of the aforementioned {\em monotonicity-duality method} initiated by Harvey and Lawson in \cite{hldir09} in the constant coefficient pure second order case. It has developed into a robust and general method which can also be transported to every nonlinear degenerate elliptic PDE which is {\em compatibile} with a given potential theory. The reader is invited to consult \cite{hldir, cpaux, cpmain, chlp, cprdir} for many of these developments. We will derive this method from first principles and then discuss the constant coefficient pure second order and gradient-free cases, which also includes the characterizzation of the dual cone subharmonics, which are the {\em subaffine} and {\em subaffine-plus} functions, respectively. The second setting is when there is the {\em minimal monotonicity} that every subsequation possesses and one obtains a weaker form of the comparison principle, called {\em strict comparison}. In the variable coefficient case, when the subharmonics are quasi-convex the proof of strict comparison is a simple consequence of the Summand Theorem. Two approaches to strict comparison for semicontinuous subharmonics are presented in the constant coefficient case. Both approaches use quasi-convex approximations; one implicitly and one explicitly. 

This completes the synopsis of Parts I and II, where we note that there are also two appendices which, together, give a self-contained proof of Alexandrov's Theorem. The proof 
depends on two ingredients: 1) second order differentiability at ``non-critical points'' of functions $f$ which are quadratic perturbations of a bounded convex function $u$, where the non-critical ponts are the non-critical values of the subdifferential of the convex {\em Legendre transformation} of $f$ (see \Cref{mplt}) and 2) a Lipschitz version of Sard's theorem (see Lemma \ref{sard}), which shows that the set of ``critical points''  has Lebesgue measure zero. 

We conclude this introduction with two considerations, which were previously mentioned. The first concerns parallel developments in nonlinear potential theories and nonlinear PDEs and the second concerns what is ``new'' in this primer, with respect to the two unpublished manuscripts \cite{hlqc} and \cite{hlae}.

As described above, the ``hard analysis part'' in nonlinear potential theories is contained in two deep results on quasi-convex functions; namely, Alexandov's Theorem and the Jensen--S{\l}odkowski Theorem. Indeed, Alexandov's Theorem (and basic properties of subequations) implies the validity of the AE Theorem and hence the Subharmonic Addition Theorem. The Jensen--S{\l}odkowski Theorem is used in both the proof of the hardest part of the Upper Contact Jet Theorem, {\em partial upper semicontinuity of second derivatives}, and the proof of the Summand Theorem. In addition, {\em quasi-approximation via sup-convolution} is a robust method for reducing a potential-theoretic question for semicontinuous functions to its quasi-convex counterpart. As is well known, the same basic ingredients play the same role in the conventional viscosity theory for nonlinear PDEs. Indeed, the proof of the crucial Theorem on Sums depends on Alexandrov's Theorem, Jensen's Lemma and ``magical properties'' of the sup-convolution.  

A deep and impressive insight of Harvey and Lawson in \cite{hlqc} is that two seemingly different measure-theoretic results (implicit in the discussion above), when properly reformulated in the language of quadratic upper contact jets, are equivalent and can be merged into the aforementioned Jensen--S{\l}odkowski Theorem \ref{jenslod}. The first result due to S{\l}odkowski~\cite{slod}, which was developed in the context of pluripotential theory, gives a lower bound on the {\em lower Lebesgue density} of sublevel sets of the {\em generalized largest eigenvalue of the Hessian} of a locally convex function (see Lemma \ref{slod}). The second result due to Jensen~\cite{jensen}, which was developed in the context of the uniqueness machinery for viscosity solutions of PDEs, says that near a strict local maximum of a quasi-convex function $w$ there is a set of positive Lebesgue  measure of points where small linear perturbations of $w$ has a local maximum. 
Harvey and Lawson reformulate the S{\l}odkowski and Jensen Lemmas in terms of quadratic upper contact jets, called here the {\bf {\em HL-S{\l}odkowski Lemma}} \ref{hlKb} and the {\bf {\em HL-Jensen Lemma}} \ref{hl:jen}. These two reformulations are shown to be equivalent in Proposition \ref{prop:HLJS}, and are also equivalent to the full Jensen--S{\l}odkowski Theorem, as noted in Remark \ref{rem:HLSJ}. A lack of recognition of this equivalence represents a missed opportunity in the possible interplay between potential theories and PDEs. \Cref{pt1} offers a systematic study of these pivotal theorems and a presentation of some important related results.

We conclude this introduction with some remarks on what is ``new'' in this primer with respect to the unpublished manuscripts \cite{hlqc} and \cite{hlae}. In a general sense, almost everything one finds in the two preprints of Harvey and Lawson is included here, albeit sometimes arranged in a different manner, with modified, clarified and more detailed proofs. Many additional results and remarks have been included to enrich the presentation, which also takes into account the numerous developments in general nonlinear potential theory over the past decade. 

In a more technical sense, they are many things here that are not included in \cite{hlqc} and \cite{hlae}. Some of these are well known, such as elements of convex function theory and the proof of the Lipschitz version of Sard's theorem, which have been included in order to make the primer as self-contained as reasonably possible. Others are less well known, but needed for the exposition, such as the background material on subequations and their subharmonics in Sections \ref{sec:conset}, \ref{sec:duality} and \ref{bastool}. Finally, there are some genuinely ``new'' things, many of which revolve around the following consideration.

A key point in Harvey and Lawson's study of Jensen--S{\l}odkowski equivalences was to replace the spherical contact points considered by S{\l}odkowski with paraboloidal contact points which are more natural for the viscosity theory. This ``paraboloidal'' machinery is examined in detail in Subsection \ref{sec:vertex_map}. In addition, using this machinery, we augment the results in \cite{hlqc}. In particular, we formulate and prove a paraboloidal version of  S{\l}odkowski's upper bound on the largest eigenvalue of the Hessian (Lemma \ref{hlKb}) and we give a paraboloidal proof of S{\l}odkowski's density estimate (Lemma \ref{slodthm}) and S{\l}odkowski's Largest Eigenvalue Theorem \ref{slodle}. Finally, in Subsection \ref{sec:JSAlex}, making use of an important observation of Harvey~\cite{har:pc}, we prove that the general Jensen--S{\l}odkowski Theorem \ref{jenslod} can be derived by Alexandrov's maximum principle (Theorem \ref{alexmp}), which is turn is derived from the Area formula for gradients of quasi-convex functions (Theorem \ref{area:cor}). This leads to the interesting conclusion that, in the end, the hard analysis part rests on the validity of the area formula. 

Finally, an organic presentation of the quasi-convex approximation of $\call F$ subharmonics is discussed in Section \ref{sec:QCSH}, which is then used to give an alternate proof of strict comparison per semicontinuous subharmonics (Theorem \ref{scqc}) by reducing to the quasi-convex version of strict comparison (Theorem \ref{scqc}).


%%comes from a partial upper semicontinuity property for the second-derivatives of quasi-convex functions, which is proved invoking two nontrivial results on quasi-convex functions, namely the Jensen--S{\l}odkowski Theorem and the celebrated Alexandrov's theorem on second-order differentiability of convex functions. These are precisely the main results in \cite{hlqc}, while 

%The article \cite{hlae} also contains a discussion about constant coefficient pure second-order and gradient-free subequations that summarises certain results on subharmonic addition and comparison which can be found in other works of Harvey and Lawson, such as \cite{hldir09} or the research monograph \cite{chlp} with Cirant and the first author. A \emph{strict comparison} theorem for quasi-convex subharmonics is also included which is the nonconstant coefficient counterpart of \cite[Corollary~C.3]{hldir} with an additional quasi-convexity assumption.

%We point out that such results in nonlinear potential theory are clever instruments which help one to prove maximum and comparison principles, which are undeniably useful; for instance, in order to prove existence and uniqueness of solutions of Dirichlet problems for general potential theories and for all fully nonlinear PDEs (which are {\em compatible} with the potential theory) via the Perron method. Harvey and Lawson's point of view ``encodes'' a PDE in the potential theoretic language, by substituting the differential operator with a geometric constraint (the \emph{subequation constraint set}), which is then studied with a monotonicity--duality method for proving the comparison principle, which imples uniqueness of solutions to the Dirichlet problem. This will be discussed in \Cref{sas}. Moreover, their approach has the huge advantage that the potential theory also correctly identifies the suitable geometric notion of {\em strict boundary pseudoconvexity} on domains for them to admit the required barrier functions needed for the existence part of Perron's method. We will not discuss existence here, but the reader may wish to consult \cite{hpsurvey} for a recent survey on this aspect.


 


\part{Quasi-convex apparatus} \label{pt1}


This first part is dedicated to two fundamental and complementary aspects of quasi-convex analysis. The first aspect concerns differentiability properties of first and second order for locally quasi-convex functions, including the the essential theorem of Alexandrov on the almost eveywhere differentiability of second order for (locally quasi-) convex functions. The second aspect concerns a detailed analysis of their {\em upper contact jets} and {\em upper contact points}, including the deep analytical results which ensure the existence of sets of contact points with positive measure. These two aspects are essential for the implementation of the viscosity theory of subharmonics and supersolutions, as will be described at the end of this introduction. Moreover, they represent the ``hard analysis'' part of the viscosity theory. A brief guide to the reader follows. 

\vspace{2ex}

\begin{center}
	{\bf Guide for the reader}
\end{center}

We begin in Section \ref{convediff} with some elementary properties of the  first-order subdifferential of convex functions which will be useful in many of the results we will present, including in the proof of Alexandrov's theorem. A complete and self-contained proof of Alexandrov's theorem is provided in Appendix~\ref{ap:legalex} and depends on two key ingredients: several important properties of the \emph{Legendre transform} and a {\em Lipschitz version of Sard's theorem}. For completeness, the highly techncial proof of this last ingredient is also given in Appendix~\ref{proofsard}. 

In Section \ref{qcfaj}, we introduce the notion of \emph{upper contact jet} and examine its interplay with quasi-convex functions. This investigation culminates with the Upper Contact Jet (\Cref{ucjt}) and the Summand (\Cref{pusc:sum}). The first result groups together three fundamental properties of first and second order differentiability of a locally quasi-convex function at or near a point of upper (quadratic) contact. The second result produces interesting and important information about upper contact points of locally quasi-convex $u, v$ at or near a point of upper of upper (quadratic) contact of the sum $w = u + v$. Interestingly, the Summand Theorem immediately yields a quasi-convex version of the celebrated {\em Theorem on Sums} when doubling variables; that is, $w(x,y):= u(x) + v(y)$. The Theorem on Sums for upper semicontinuous $u,v$ is a linchpin on which much of the conventional viscosity theory of Crandall-Ishii-Lions rests. For completeness, in Subsection \ref{ss:tosu}, we will also give a novel proof of the semicontinuous version as a corollary of the quasi-convex version and the standard device of quasi-convex approximation by way of the \emph{sup-convolution} which produces a controllable displacement of the upper contact points of every given upper contact jet. 

We will devote \Cref{sec:js} to a comprehensive study of the aforementioned hard analysis part of the theory which ensures the existence of sets of upper contact points with positive measure nearby points of {\em strict} upper contact. The most well-known result of this type is Jensen's lemma (see Lemma \ref{u:jen} as one finds in \cite{jensen,user}). An important and impressive insight of Harvey and Lawson is that Jensen's lemma when reformulated into the language of upper contact points (as stated in Lemma \ref{hl:jen}) has a deep connection to an older result of S{\l}odkowski~\cite{slod} concerning a lower bound on the Lebesgue density of sublevel sets of the largest eigenvalue of the Hessian of a convex function (see Lemma \ref{slodthm}). S{\l}odkowski's result, when translated into the language of upper contact points (as stated in Lemma \ref{slod}), is equivalent to the reformulated Jensen Lemma. This equivalence is proven in Proposition \ref{prop:HLJS}. Moreover, these two reformulations can be merged into the more general Jensen--S{\l}odkowski Theorem \ref{jenslod}. 

A key point in Harvey and Lawson's study of Jensen--S{\l}odkowski equivalences was to  replace the spherical contact points considered by S{\l}odkowski with paraboloidal contact points which are more natural for the viscosity theory. This ``paraboloidal'' machinery is examined in detail in Subsection \ref{sec:vertex_map}. In addition, using this machinery, we augment the results in \cite{hlqc}. In particular, we formulate and prove a paraboloidal version of  S{\l}odkowski's upper bound on the largest eigenvalue of the Hessian (Lemma \ref{hlKb}) and we give a paraboloidal proof of S{\l}odkowski's density estimate (Lemma \ref{slodthm}) and S{\l}odkowski's Largest Eigenvalue Theorem \ref{slodle}. Finally, in Subsection \ref{sec:JSAlex}, making use of an important observation of Harvey~\cite{har:pc}, we prove that the general Jensen--S{\l}odkowski Theorem \ref{jenslod} can be derived by Alexandrov's maximum principle (Theorem \ref{alexmp}), which is turn is derived from the Area formula for gradients of quasi-convex functions (Theorem \ref{area:cor}). This leads to the interesting conclusion that, in the end, the hard analysis part rests on the validity of the area formula. 

We now describe the importance of the two fundamental aspects of quasi-convex analysis treated here in the context of the viscosity theory for potential theories and PDEs. These two aspects can been synthetically represented by the theorems of Alexandrov and Jensen--S{\l}odkowski. For a robust viscosity theory, which is based on quadratic upper test functions, one has the problem of how to ensure \emph{a priori} the existence of a sufficient amount of upper contact points for an upper semicontinuous function. These two theorems yield the Summand Theorem \ref{pusc:sum} and the Almost Everywhere Theorem \ref{aet}, which ensure that, for locally quasi-convex functions, \emph{almost all} (Alexandrov) points admit an upper test function, and they are \emph{enough} (AE Theorem) for the viscosity-theoretic purposes. Hence, locally quasi-convex functions can be seen as an a potential bridge between the classical theory (twice differentiable functions) and the viscosity theory (semicontinuous functions).

This bridge is completed by the well-known device of approximating a given upper semicontinuous function by a sequence of quasi-convex functions by way of the {\em sup-convolution}, as we will discuss in~\Cref{sec:apqc}). While the fundamental theorems of Alexandrov and Jensen--S{\l}odkowski provide sufficient information for the viscosity theory along the quasiconvex approximation, one will also need to have suitable ``stability'' or  ``control'' of the approximation procedure in order to close the circle and obtain results for the semicontinuous functions one has started with. This is a crucial problem, which we will address only in a few basic situations, in~\Cref{sas}. For further investigations on the possibility of applying such a quasi-convex approximation technique inside the context of potential theory, we invite the reader to consult ~\cite{cpaux,cpmain,cprdir}.

Of course, the conventional viscosity theory also makes use of the same ingredients: Alexandrov's Theorem, Jensen's Lemma and the sup-convolution approximation. However, the more detailed quasi-convex analysis presented here can be exploited in a more efficient manner than the conventional approach, as well as providing a more regular ``test case'' for checking whether a desired result for semicontinuous function can be true. This is accomplished by first proving a (locally) quasi-convex version with the help of Alexandrov's Theorem and the Almost Everywhere Theorem, and then by analyzing the sup-convolution approximation as a last step. In particular, for proving the comparison principle, one can make good use of the structure of the constraint set of a given potential theory (or structural properties of a differential operator) which need not satisfy the standard structrual conditions of the conventional viscosity theory.

\section{Differentiability of convex functions} \label{convediff}

In this section, we present the well-established theory of of differentiability of first and second order for convex functions and their extensions to locally quasi-convex functions. This will culminate in the essential theorem of Alexandrov on second order differentiability in the Peano sense on sets of full measure.

\subsection{First order theory}

We begin by recalling the notion of a convex function and showing that they are {\em subdifferentiable} everywhere, where subdiffifferentiability is a weak and, in general, multi-valued notion. The results that we are going to discuss actually hold in a more general context, but we limit ourselves to the context that suits our purposes.  Here we follow and expand upon the treatment in~\cite{hlqc}.

\begin{definition} \label{defn:convex}
	Let $u \colon X \to \R$ be a function defined on a convex subset $X\subset \R^n$. We say that $u$ is \emph{convex} if its epigraph $\epi(u) \defeq \{ y \in \R : y \geq u(x) \}$ is convex.
	%\footnote{The notation $\barr\epi$, instead of $\epi$, is coherent with the choice made in Subsection~\ref{subs:svop} of denoting by $\epi$ the \emph{open} (or \emph{strict}) epigraph.}
\end{definition}

\begin{remark}
	It is immediate that one has the standard inequality formulation for convexity; that is, $u$ is convex in the sense of \Cref{defn:convex} if and only if: for each $x_1, x_2 \in X$ one has
	\begin{equation}\label{Jensen_2}
	u(t x_1 + (1-t)x_2) \leq t u(x_1) + (1-t) u(x_2)\quad  \text{for each} \  t \in [0,1].
	\end{equation}
	Of course, this means that the restriction of $u$ to each segment $[x_1,x_2] \subset X$ is a convex function of one variable. Moreover, the inequality \eqref{Jensen_2} is a version of {\em Jensen's inequalty} for convex functions.
\end{remark}

\begin{lem}[Jensen's inequality; finite form] \label{lem:Jensen} Let $u: X \to \R$ be convex on $X \subset \R^n$ convex. Then for each collection of points $\{x_j\}_{j=1}^N \subset X$ with $N \geq 2$ 
	\begin{equation}\label{Jensen_N}
	u \Bigg( \sum_{j=1}^N t_j x_j \!\Bigg) \leq  \sum_{j=1}^N t_j u(x_j), \quad  \text{for each}  \ \{t_j\}_{j=1}^N  \subset [0,1] \ \text{with} \ \sum_{j=1}^N t_j = 1.
	\end{equation}	
\end{lem}
The proof of Lemma \ref{lem:Jensen} is standard and typically done by induction on $N \geq 2$, where the case $N = 2$ is \eqref{Jensen_2}.
\begin{remark}
	We also briefly remind the reader of the following obvious facts: affine functions are convex; nonnegative weighted sums of convex functions are convex; the (pointwise) supremum of any family of convex functions is convex.
\end{remark}

We will see that convex functions have the following multi-valued differentiability property at each point in their domain.

\begin{definition} \label{def:subd}
Let $u \colon X \to \R$ be a (not necessarily convex) function defined on a subset $X\subset\R^n$. We define its \emph{subdifferential at $x\in X$} as the set
\begin{equation} \label{defsubd}
\de u(x) \defeq \{ p \in \R^n :\ u(y) \geq u(x) + \pair{p}{y-x}\ \; \forall y \in X \}.
\end{equation}
Each $p \in \de u(x)$ will be called a \emph{subgradient} of $u$ at $x$, and we will say that {\em $u$ is subdifferentiable at $x$} if $\de u(x) \neq \emptyset$.
\end{definition}

\begin{remark} \label{geointerpsubdiff}
Geometrically, this means that the hyperplane which is the graph of the affine function $u(x) + \pair{p}{\cdot - x}$ over $X$ is a supporting hyperplane from below at $x$ for the epigraph of $u$, for all $p \in \de u(x)$. One can also say that if $u$ is subdifferentiable at $x$, then $x$ belongs to the {\em (global) lower contact set of $u$}. Moreover, one should note the simple but useful fact that $x$ is a global minimum point for $u$ if and only if $0 \in \de u(x)$. In particular, all functions are subdifferentiable at global minima.
\end{remark}

\begin{remark}
We have essentially two ways to interpret the \emph{subdifferential} of $u$: as a map
\[
\de u \colon X \to \scr P(\R^n), \quad x \mapsto \de u(x)
\]
or as a subset of a trivial bundle over $X$ whose fiber over each $x \in X$ is $\de u(x)$; that is,
\[
\de u \defeq \bigsqcup_{x \in X} \de u(x) \subset X \times \R^n.
\]
Note that in the latter interpretation, if one considers the projection $\pi \colon \de u \to X$ which maps $\de u(x) \ni p \mapsto x$, then adopting the former interpretation means that we are calling $\pi^{-1} = \de u$.  We will mainly adopt the former interpretation; for example, when using the notation
\[
\de u(\Omega) = \bigcup_{x \in \Omega} \de u (x) \subset \R^n, \quad \text{$\Omega\subset X$},
\]
yet we will also write
\[
(x,p) \in \de u \quad\iff\quad p \in \de u(x),
\]
thus employing the latter interpretation.
\end{remark}

Convex functions $u$ on $X$ (open and convex) are {\em subdifferentiable} in the sense of \Cref{def:subd}. Moreover, this property characterizes the convexity of $u$.

\begin{prop}[Subdifferentiability of convex funtions]\label{prop:subd_convex}
For any function $u: X \to \R$ defined on an open and convex subset $X\subset \R^n$, one has 
\begin{equation*}
	u \ \text{is convex} \ \ \Leftrightarrow \ \ \partial u(x) \neq \emptyset, \ \forall \, x \in X;
\end{equation*}
that is, $u$ is convex on $X$ if and only if $u$ is subdifferentiable on $X$.
	\end{prop}

\begin{proof}
	If $u$ is convex, then by the Hahn--Banach Theorem for any $x \in X$ there exists a supporting hyperplane for the convex set $C \defeq \barr\epi(u)$ at the point $(x,u(x))$; that is, there exist $(q,r) \in \R^n \times \R \setminus \{(0,0)\}$ such that
	\begin{equation} \label{subdiffnonempty:hb}
	\pair{q}{y-x} + r(z-u(x)) \geq 0 \quad \text{for each $(y,z) \in C$.}
	\end{equation}
	With the choices $y=x$ and $z > u(x)$, the inequality \eqref{subdiffnonempty:hb} implies that $r \geq 0$. By choosing now $z = u(x)$, one has that
	\[
	\pair{q}{y-x} + r(u(y)-u(x)) \geq 0 \quad \forall y \in X,
	\]
	which yields $-r^{-1}q \in \de u(x)$, provided that $r \neq 0$. To show that in fact $r\neq 0$, notice that otherwise by inequality \eqref{subdiffnonempty:hb} one would have $\pair{q}{y-x} \geq 0$ for each $y \in X$, which is impossible since $X$ is open.
	
	Conversely, if $x = \lambda x_1 + (1-\lambda) x_2$ for some $\lambda \in [0,1]$, we have
	\[
	u(x_1) \geq u(x) + (1-\lambda)\pair{p}{x_1-x_2} \quad \text{and} \quad u(x_2) \geq u(x) - \lambda \pair{p}{x_1-x_2}
	\] 
	for every $p\in \de u(x)$, thus yielding $u(x) \leq \lambda u(x_1) + (1-\lambda)u(x_2)$; that is, $u$ is convex.  
	\end{proof}

Convex functions are also locally bounded.

\begin{lem}\label{lem:convex_loc_bdd} Let $u: X \to \R$ be convex on $X$ open and convex. Then 
	\begin{equation}\label{loc_lim1}
	\mbox{$u$ is bounded on every compact subset $K \subset X$,}
	\end{equation}
or equivalently,
\begin{equation}\label{loc_lim2}
\mbox{$u$ is bounded on some neighborhood of every $x \in X$.}
\end{equation}
	\end{lem}

\begin{proof}
	The equivalence of \eqref{loc_lim1} and \eqref{loc_lim2} is standard. Let $K \subset X$ be compact. By choosing any $x \in K$
	 and any $p \in \partial u(x) \neq \emptyset$, one has 
	 \[
	 u(y) \geq u(x) + \langle p,y-x \rangle := a_x(y), \ \ \text{for every} \ y \in X,
	 \]  
	 where $a_x$ is affine and hence bounded from below on $K$ compact. Hence $u$ is bounded from below on $K$.
	 
	 For the local boundedness from above, let $x \in X$ be arbitrary and consider any compact cube $\mathcal{C}$ centered in $x$ such that $\mathcal{C} \subset X$. We denote by $\{v_j\}_{j=1}^{N}$ the collection of vertices of $\mathcal{C}$. Every closed cube is the (closed) convex hull of its vertices and hence for each $y \in \mathcal{C}$ one has
 \[
 	y = \sum_{j=1}^N t_j v_j \quad \text{with} \ \ \sum_{j=1}^N t_j = 1 \ \ \text{and each} \ \ t_j \in [0,1].
 \]
By Jensen's inequality \eqref{Jensen_N} we have
\[
	u(y) = u \Bigg( \sum_{j=1}^N t_j v_j  \Bigg) \leq \sum_{j=1}^N t_j  u(v_j) \leq \max_{1 \leq j \leq N} \lvert u(v_j) \rvert < + \infty,
\]
and hence $u$ is bounded from above on every compact cube contained in $X$.
	\end{proof}

Two interesting properties concerning the subifferential of a convex function are given in the following lemma. 

\begin{lem}\label{lem:intpropsubdiff}
For each convex function $u: X \to \R$, one has:
\begin{itemize}
\item[(a)]	the fiber $\de u(x) \subset \R^n$ is closed and convex  for each $x \in X$;
\item[(b)]	for each pair of points $x$ and $y$ in $X$,
\begin{equation} \label{slope}
\pair{p}{y-x} \leq u(y) - u(x) \leq \pair{q}{y-x} \quad \forall p\in \de u(x),\ q\in \de u(y),
\end{equation}
\end{itemize}
\end{lem}

\begin{proof}
For the claims of part (a), it is easy to see that
\[
\de u(x) = \bigcap_{y \in X} \big\{ p \in \R^n: u(x) + \pair{p}{y-x} \leq u(y) \big\} 
\]
is the intersection of closed affine half-spaces and therefore it is closed and convex. This follows from the fact that intersections of convex sets are clearly convex. Notice that the above argument applies to any function $u$; the convexity ensures that $\de u(x)$ is not empty.

For the chain of inequalities of part (b), by \Cref{prop:subd_convex}, the subdifferentials $\partial u(x)$ and $\partial u(y)$ are non-empty. By the definition (\ref{defsubd}), for each fixed $x \in X$ one has
\begin{equation} \label{slope_1}
u(y) \geq u(x) + \pair{p}{y-x}  \quad \forall p\in \de u(x), \ \forall \, y \in X 
\end{equation}
and for each fixed $y \in X$ one has
\begin{equation} \label{slope_x}
u(x) \geq u(y) + \pair{q}{x-y}  \quad \forall q\in \de u(y), \ \forall \, x \in X,
\end{equation}
from which \eqref{slope} easily follows.
\end{proof}

We will see that the chain of inequalities in \eqref{slope} is estremely useful. Notice that the geometric meaning of (\ref{slope}) is that if we restrict our attention to the segment $[x,y]$ with intrinsic real coordinate such that $x\leq y$, then $\barr p \leq s \leq \barr q$, where $\barr p$, $\barr q$ are the slopes of the supporting hyperplane at $x,y$ identified by $p,q$ and $s$ is the slope of the chord connecting $(x, u(x))$ and $(y,u(y))$. An immediate consequence of \eqref{slope} is the following monotonicity property.

\begin{prop} \label{subdmon}
The subdifferential $\de u \colon X \to \scr P(\R^n)$ is a monotone operator; that is,
\begin{equation} \label{eq:subdmon}
\pair{q-p}{y-x} \geq 0 \qquad \forall \, (x,p), (y,q) \in \de u.
\end{equation}
\end{prop}

This generalizes the definition of (nondecreasing) monotonicity for single-valued functions from $\R$ to $\R$, since in that case \eqref{eq:subdmon} is equivalent to $(\de u(y) - \de u(x))\cdot (y-x) \geq 0$, that is $\de u(x) \leq \de u(y)$ whenever $x\leq y$.

\begin{remark}[Monotonicity of the subdifferential] \label{equiv:subdmonconv}
Since the chain of inequalities \eqref{slope} directly follows from the subdifferentiability of \Cref{def:subd}, \Cref{subdmon} tells us that the subdifferential $\de u$ of \emph{any} function $u \colon X \to \R$ is monotone in the sense that \eqref{eq:subdmon} holds whenever $x,y$ are such that $\de u(x) \neq \emptyset \neq \de u(y)$. In general, this is of no use, since $\de u$ can be empty in ``too many'' (possibly all) points. However, if  $u$ is convex on $X$ open and convex then \Cref{lem:intpropsubdiff} shows that the inequality \eqref{eq:subdmon} is meaningful for each pair of points $x,y \in X$, since the domain of $\de u$ is the whole $X$; that is, $\mathrm{dom}\,\de u \defeq \{ x \in X : \de u(x) \neq \emptyset \} = X$. Furthermore, for differentiable functions $u \colon \R \to \R$ one knows that convexity is equivalent to the (nondecreasing) monotonicity of $Du = u'$, which is in fact equivalent to the monotonicity of $\de u$ in the sense of \eqref{eq:subdmon} (cf.~also  \Cref{deusingv} below). Hence, one might wonder whether a characterization of convexity for generic functions exists in term of the monotonicity of their subdifferential. We have essentially just commented on the fact that the answer is no. Indeed, all functions have monotone (possibly empty) subdifferential. Moreover, adding a hypothesis like $\mathrm{dom}\,\de u \neq \emptyset$ would also be too weak; one needs to assume that $\mathrm{dom}\,\de u = X$. In fact, consider $u$ defined by $u \defeq f$ on $X \setminus \{x_0\}$ and $u(x_0) \defeq \alpha > f(x_0)$ for some convex function $f$ on $X$. Note that $\mathrm{dom}\,\de u = X \setminus \{ x_0 \}$ but $u$ is not convex. On the other hand, the assumption $\mathrm{dom}\,\de u = X$ is too strong because it is in fact itself equivalent to the convexity of $u$. In any case, for the sake of completeness, we mention that a characterization of convexity in terms of the monotonicity of ``a subdifferential'' actually exists, and uses the so-called \emph{proximal subdifferential} (see \cite[Theorem 4.1]{csw} and the references therein).
\end{remark}

For future use, we prove a particular case of the equivalence discussed in \Cref{equiv:subdmonconv}.

\begin{prop} \label{conviffmon}
Let $u$ be differentiable on an open convex set $X\subset \R^n$; then
\[
\text{$u$ is convex} \quad \iff \quad \text{$Du$ is monotone}.\footnote{That is, $\pair{Du(x) - Du(y)}{x-y} \geq 0$ for all $x,y \in X$.}
\]
\end{prop}

\begin{proof}
The implication ($\Longrightarrow$) immediately follows from the monotonicity of the subdifferential (\Cref{subdmon}) and the upcoming \Cref{deusingv} that characterizes convex and differentiable functions. Alternatively, a direct proof is also instructive. The convexity of $u$ is equivalent to the convexity of $u$ restricted to every segment $[x,y] \subset X$ convex with arbitrary endpoints $x,y \in X$; that is, to the convexity of all functions of the form
\[
\tilde u(t) \defeq u(x+t(y-x)), \quad t \in [0,1],
\]
with $x,y \in X$. The convexity of each $\tilde u$ is equivalent to
\begin{equation} \label{convonline}
\frac{\tilde u(t_2) - \tilde u(t_1)}{t_2-t_1} \leq \frac{\tilde u(t_3) - \tilde u(t_2)}{t_3-t_2} \quad \text{whenever $0 \leq t_1 < t_2 < t_3 \leq 1$}.
\end{equation}
Letting $t_2 \dto t_1 = 0$ one obtains
\begin{equation} \label{monder:1}
\pair{Du(x)}{y-x} \leq \frac{u(x+t(y-x)) - u(x)}{t} \quad \forall t \in (0,1],
\end{equation}
while letting $t_2 \uto t_3 = 1$ one obtains
\begin{equation} \label{monder:2}
\frac{u(y) - u(x+t(y-x))}{1-t} \leq \pair{Du(y)}{y-x} \quad \forall t \in [0,1).
\end{equation}
Combining \eqref{convonline}, \eqref{monder:1} and \eqref{monder:2} yields
\[
\pair{Du(x)}{y-x} \leq \pair{Du(y)}{y-x},
\]
which is the monotonicity of $Du$. For the reverse implication ($\Longleftarrow$), by the Mean Value Theorem, for $j=1,2$ there exist $\xi_j \in [x+t_j(y-x), x+t_{j+1}(y-x)]$ such that $\tilde u(t_{j+1}) - \tilde u(t_j) = \pair{Du(\xi_j)}{(t_{j+1} - t_j)(y-x)}$, and hence condition \eqref{convonline} holds if and only if
\begin{equation} \label{quasimon}
\pair{Du(\xi_1)}{y-x} \leq \pair{Du(\xi_2)}{y-x},
\end{equation}
for some
\[
\xi_1 = x + s_1(y-x), \ \ \xi_2 = x+ s_2(y-x), \quad 0 < s_1 < s_2 < 1.
\]
Therefore we have
\[
\xi_2 - \xi_1 = (s_2 - s_1)(y-x),
\]
and we can rewrite \eqref{quasimon} as
\[
(s_2-s_1)^{-1} \pair{Du(\xi_2) - Du(\xi_1)}{\xi_2 - \xi_1} \geq 0,
\]
which is satisfied by the monotonicity of $Du$ (since $s_2 - s_1 > 0$). This concludes the proof.
\end{proof}


Additional important consequences of the chain of inequalities \eqref{slope} concern the restrictions of convex functions to compact subsets.

\begin{thm}\label{thm:convex_Lip} Let $u: X \to \R$ be convex on $X \subset \R^n$ open and convex. Then for each $K \subset X$ compact
	\begin{itemize}
\item[(a)] $\de u(K) = \bigcup_{x \in K} \de u (x)$ is compact in $\R^n$;
\item[(b)] $u \in \rm{Lip}(K)$ with
\begin{equation}\label{convex_Lip}
	|u(x) - u(y)| \leq \max_{p \in \partial u(K)} \!|p| \cdot |x - y|, \ \ \forall \, x,y \in K.
\end{equation}
In particular, $u$ is continuous on $X$.
\end{itemize}
\end{thm}

\begin{proof}
First, we prove that $\de u(K)$ is bounded. Since $K$ is compact in $X$ there exists  $\delta > 0$ such that $K^{\delta}:= \{ x \in X: \ d(x,K) \leq \delta \} \subset X$, where
$K^{\delta}$ is compact. By Lemma \ref{lem:convex_loc_bdd}, $u$ is bounded on $K^{\delta}$ and by \eqref{slope} one has
\begin{equation}\label{bounded1}
\pair{p}{y-x} \leq u(y) - u(x) \leq 2 \max_{K^{\delta}}|u| < + \infty, \ \ \forall \, x \in K,\,  y \in K^{\delta},\,  p \in \partial u(x).
\end{equation}
With $y:= x + \delta p/|p|$ for $p\neq 0$ in \eqref{bounded1}, one has
$$
\frac{\delta}{|p|} \pair{p}{p} \leq 2 \max_{K^{\delta}}|u|,
$$
and hence
$$
	|p| \leq \frac{2}{\delta} \max_{K^{\delta}}|u|, \ \ \forall \, p \in \partial u(K),
$$
which gives $\de u(K)$ is bounded in $\R^n$.

Next, we prove the Lipschitz estimate \eqref{convex_Lip}. Again using the inequality chain \eqref{slope} we have
$$
\forall x,y \in K: \quad |u(x) - u(y)| \leq \max \{|p|, |q| \} \, |x-y|, \quad \forall \, p \in \partial u(x), q \in \partial u(y),
$$
which implies \eqref{convex_Lip}, and hence the continuity of $u$ on $X$.

Finally, we show that $\partial u(K) \subset \R^n$ is closed, which together with the boundedness of $\partial u(K)$ shows that $\partial u(K)$ is compact. Let $\{ p_k\}_{k \in \N}  \subset \partial u(K)$ be any convergent sequence with $p_k \to p$ in $\R^n$ for $k \to \infty$. We need to show that $p \in \partial u(K)$. For each $k \in \N$, $p_k \in \partial u(K)$ implies that there exists $x_k \in K$ such that $(x_k, p_k) \in \partial u$. Since $K$ is compact, there exist $x \in K$ and a subsequence $\{x_{k_j}\}_{j \in \N}$ such that $x_{k_j} \to x$ as $j \to \infty$. Since $p_{k_j} \in \partial u(x_{k_j})$ for each $j \in \N$, we have 
	$$
	u(y) \geq u(x_{k_j}) + \pair{ p_{k_j}}{ y - x_{k_j} }, \quad \forall \, y \in X,\ \forall \, j \in \N
	$$ 
and passing to the limit $j \to \infty$ gives $u(y) \geq u(x) + \pair{p}{ y - x}$ 	for all $y \in X$, and hence $p \in \partial u(x) \subset \partial u(K)$.
\end{proof}

\begin{remark}\label{rem:equivalences} 
In the end, for $u: X \to \R$ convex on $X$ open and convex, the following are equivalent:
\begin{enumerate}[label=(\arabic*)]
	\item[(1)] $u$ is locally Lipschitz on $X$;
	\item[(2)] $u$ is continuous on $X$;
	\item[(3)] $u$ is continuous at some point $x \in X$;
	\item[(4)] $u$ is locally bounded on $X$;
	\item[(5)] $u$ is locally bounded from above on $X$.
\end{enumerate}
In fact, the implications $(1) \Rightarrow (2) \Rightarrow (3) \Rightarrow (5)$ and $(2) \Rightarrow (4) \Rightarrow (5)$ are obvious. Hence it is enough to show that $(5) \Rightarrow (1)$, which follows from the considerations above. 
\end{remark}

An important consequence on the differentiability of a convex function follows. 

\begin{cor} \label{deusingv}
For $u: X \to \R$ convex on $X$ open and convex, one has
\begin{equation}\label{equivalences}
u \ \text{is differentiable on $X$} \ \ \Leftrightarrow \ \ \de u \ \text{is single-valued on $X$}  \ \ \Leftrightarrow \ \  u\ \text{is $ C^1(X)$},
\end{equation}
with $\de u (x) = Du (x)$ for each $x \in X$.
\end{cor}

\begin{proof}
We first show that if $\de u(x) = \{p\}$ then $u$ is differentiable in $x$ with $Du(x) = p$. Consider a nested sequence of compact sets $\{K_j\}_{j \in \N}$ such that $\bigcap_{j \in \N} K_j = \{x\}$, then by compactness
\[
\{p\} = \bigcap_{j \in \mathbb{N}} \de u(K_j),
\]
and thus
\begin{equation} \label{contconv}
p = \lim_{\substack{y\, \to\, x \\ q\, \in\, \de u(y)}} q.
\end{equation}
By (\ref{slope}) we have for each $x,y \in X$ with $x \neq y$:
\[
0 \leq \frac{ u(y)-u(x) - \pair{p}{y-x} }{ |y-x| } \leq \pair{q-p}{e},
\]
where $e \defeq (y-x)/|y-x| \in \mathbb{S}^{n-1}$. Hence for $y \to x$, \eqref{contconv} shows that $u$ is differentiable in $x$ with $Du(x) = p$. This also completes the implication that $\de u$ is single valued implies that $u$ is differentiable everywhere. 

Conversely, if $u$ is differentiable at $x$, let $p \in \de u(x) \neq \emptyset$. Again by (\ref{slope}) we have $t\pair{p}{e} \leq u(x+te) -u(x)$ for all $e \in \mathbb{S}^{n-1}$ and $t$ small. This implies that $\pair pe \leq \pair{Du(x)}e$, which, by linearity, forces $p = Du(x)$. This completes the first equivalence in \eqref{equivalences}.

Finally, we show that $u$ convex is differentiable on $X \ \ \Leftrightarrow \ \ u \in C^1(X)$. The implication $(\Leftarrow)$ is obvious and the implication $(\Rightarrow)$ follows from (\ref{contconv}) since it now gives
\[
		Du(x) = \lim_{y \to x} Du(y). \qedhere
\]
\end{proof}

Since $u$ convex is locally Lipschitz by Theorem \ref{thm:convex_Lip}(b), one can deduce first-order differentiability properties of convex functions, by exploiting the following famous result of Rademacher~\cite{rademacher}.

\begin{thm}[Rademacher] \label{rade}
Let $\Omega\subset \R^n$ be open and $G\colon \Omega \to \R^m$ be Lipschitz continuous. Then $G$ is differentiable almost everywhere in $\Omega$, with respect to the Lebesgue measure.
\end{thm}

The unidimensional version of Rademacher's theorem can be proved as a corollary of the analogous result for monotone functions, which can be extended to functions of bounded variation thanks to Jordan's decomposition, and thus to the subspace of Lipschitz continuous functions (see e.g.\ \cite{anr, evansgar}). The passage to higher dimensions essentially uses the Fubini--Tonelli theorem (see e.g.\ \cite[Theorem~2.2.4]{meast} or \cite[Theorem~3.1.6]{fed:geo}).

An immediate consequence of Theorem \ref{thm:convex_Lip}(b) (convex functions are locally Lipschitz) and Rademacher's \Cref{rade} is the following.

\begin{cor} \label{rade:conv}
A convex function is differentiable almost everywhere, with respect to the Lebesgue measure.
\end{cor}

This is the first-order counterpart of Alexandrov's theorem on second-order differentiability of convex functions (\Cref{aleks}), which we are going to prove in \Cref{sec:so}.

\medskip
Finally, we conclude this section by highlighting two properties about sums and differences of convex functions, when one of them is quadratic. We note that it is false in general that $\de (u+v) = \de u + \de v$; nevertheless, the equality holds if, for example, $v = \phi$ is a quadratic function. 

\begin{lem} \label{lem:subdiffsum}
Let $u$ be convex on a convex open set $X \subset \R^n$ and let $\phi$ be a quadratic convex function; then
\begin{equation} \label{eq:equalitysubdiff}
\de(u + \phi) = \de u + D\phi \quad \text{on $X$}.
\end{equation}
\end{lem}

\begin{proof}
Fix $x \in X$. By the definition \eqref{defsubd} of the subdifferential we always have $\de (u+ \phi)(x) \supset \de u(x) + \de \phi(x)$, and since $\phi$ is smooth by \Cref{deusingv} we know that $\de \phi(x) = \{D\phi(x)\}$. So let
\begin{equation} \label{barpinde}
\barr p \in \de(u+\phi)(x)
\end{equation}
(which is nonempty by \Cref{prop:subd_convex}), and set $p \defeq \barr p - D\phi(x)$. We want to show that $p \in \de u(x)$. Since one can write 
$$
	\phi(\cdot) = \phi(x) + \pair{D\phi(x)}{\cdot - x} + \tfrac12\pair{P(\cdot-x)}{\cdot-x},
	$$
where $P\geq 0$ is such that $D^2\phi \equiv P$ on $X$, we see that \eqref{barpinde} is equivalent to
\[
u(\cdot) \geq \psi(\cdot) \defeq u(x) + \pair p{\cdot - x} - \tfrac12\pair{P (\cdot -x)}{\cdot - x}.
\]
Hence $\epi(u) \subset \epi(\psi)$. Now, any dilation $\rho_t$ by $t>0$ centered at $(x, u(x))$ preserves this inclusion; that is,
\begin{equation}\label{sum_quad1}
	\rho_t(\epi(u)) \subset \rho_t(\epi(\psi)), \quad \forall \, t > 0.
\end{equation}
By the convexity of $u$ we also have 
\begin{equation}\label{sum_quad2}
	\epi(u) \subset \rho_t\epi(u), \quad \forall \, t \geq 1. 
\end{equation}
Combining \eqref{sum_quad1} and \eqref{sum_quad2}, for all $t\geq 1$ one has $\epi(u) \subset \rho_t\epi(\psi)$ where 
$$
\rho_t\epi(\psi) = (x,u(x)) + t\,\big\{ (z-x,y-u(x)) \in (X-x) \times \R :\ y \geq \psi(z) \big\} 
$$
which can be written as
$$
 \big\{ (z',y') \in (t(X-x)+x) \times \R :\ y' \geq u(x) + \pair{p}{z'-x} - \tfrac{1}{2t}\pair{P(z'-x)}{z'-x} \big\}.
$$
Letting $t \to +\infty$ shows that the dilations of the epigraph of $\psi$ decrease to the half-space $H$ which is the closed epigraph of the affine function $u(x) + \pair{p}{\cdot-x}$. Hence $\epi(u) \subset H$, yielding $p \in \de u(x)$.
\end{proof}

\begin{remark}
One might wonder if an analogous result could hold for either $u$ or $\phi$ not necessarily convex. The answer is no, in general. For example, if $u = \psi$ is a quadratic convex function and $\phi = -2\psi$, then $\de(u+\phi)(x)$ is empty for each $x \in X$, while $\de u(x) + D\phi(x)$ is not.

On the other hand, the answer is yes if both $u$ and $\phi$ are not convex (though one gets the useless identity $\emptyset = \emptyset$). In that case the right-hand side of \eqref{eq:equalitysubdiff} is clearly empty, and so is the left-hand side. Indeed, if it were nonempty, then $u+\phi$ would be convex (by \Cref{prop:subd_convex}); since $\phi$ is supposed to be smooth and not convex near $x$, it is (strictly) concave near $x$, yielding $u = (u+\phi) + (-\phi)$ convex near $x$ (being it the sum of two convex functions), thus contradicting the assumption that $u$ is not convex.
\end{remark}

In addition to the result of \Cref{lem:subdiffsum} on sums of a convex function $u$ and a quadratic convex function $\phi$, one has an interesting result about differences as well. It states that convex functions $u$ are differentiable at points $x$ of {\em quadratic upper contact} and is a precursor to the results on {\em upper contact jets} in Section \ref{qcfaj} which play a key role in all that will follow.

\begin{lem}[Differentiability at points of upper quadratic contact] \label{ch1:datucp}
Let $u$ be convex on $X$ and suppose there exists a quadratic function $\phi$ such that
\[
(u- \phi)(y) \leq 0 \qquad \text{$\forall y$ near $x \in X$, with equality at $x$}.
\]
Then $u$ is differentiable at $x$ and $Du(x) = D\phi(x)$.
\end{lem}

\begin{proof}
Since $u$ is convex, $\de u(x)$ is nonempty and hence there exists $q\in\R^n$ such that $u(x) + \pair q{\cdot-x} \leq u$ on $X$. Consider now the convex function $\tilde u \defeq u - u(x) - \pair q{\cdot-x}$ which satisfies $\tilde u \geq 0$ on $X$ and $\tilde u(x) = 0$.
Hence $0\in\de\tilde u(x)$ and then, since
\[
\phi = \phi(x) + \pair{D\phi(x)}{\cdot-x} + \tfrac12\pair{D^2\phi(x)(\cdot-x)}{\cdot-x}, \qquad \phi(x) = u(x),
\]
by defining $\tilde\phi \defeq \phi - \phi(x) - \pair q{\cdot-x}$ one has
\[
(\tilde u- \tilde \phi)(y) \leq 0 \qquad \text{$\forall y$ near $x$, with equality at $x$.}
\] 
It follows that
\[
0 \leq \tilde u(y) \leq \pair{D\phi(x)-q}{y-x} + o(|y-x|)	\qquad	\forall \, y\ \text{near}\ x,
\]
and thus $q=D\phi(x)$. Indeed, if that were not the case, by choosing $y=x+t(D\phi(x)-q)$, for sufficiently small $t\in \R$, one has $0 \leq t + o(t)$ for each $t$ near $0$, which is false since $t$ can change sign.
Finally, since  
$0\leq \tilde u(y) \leq o(|y-x|)$ for all $y$ near $x$, one sees that
\[
\frac{|\tilde u(y)|}{|y-x|} = o(1) 	\qquad	\text{as}\ y\to x,
\]
and hence $\tilde u$ is differentiable at $x$ with $D\tilde u(x) = 0$, which shows that $u$ is differentiable at $x$ with $Du(x) = D\phi(x)$. Alternatively, since our argument shows that $\de u(x) = \{ D\phi(x) \}$ and hence one knows that $u$ is differentiable at $x$ with $Du(x) = D\phi(x)$ by \Cref{deusingv}.
\end{proof}

\begin{remark}
Note that a consequence of \Cref{ch1:datucp} is that \emph{all} upper contact quadratic functions for a convex function at some point $x$ share the same differential at $x$. 
\end{remark}


\subsection{Second order theory: Alexandrov's theorem} \label{sec:so}

We begin with the following well-known definition.

\begin{definition}
Let $X \subset \R^n$ be open. A function $u \colon X \to \R$ is \emph{twice differentiable (in the Peano sense) at $x \in X$} if there exist $p \in \R^n$ and a symmetric $n\times n$ real matrix $A \in \call S(n)$ such that
\begin{equation} \label{2od:def}
u(y) = u(x) + \pair{p}{y-x} + Q_A(y-x) + o(|y-x|^2) \quad \text{as $y \to x$},
\end{equation}
where $Q_A \defeq \frac12 \pair{A\cdot}\cdot$ is the quadratic form associated to $\frac12 A \in \call S(n)$ whose Hessian is $A$. We will denote by
\begin{equation}\label{Diff2}
\mathrm{Diff}^2 u := \{x \in X: \ \text{$u$ is twice differentiable in $x$} \}.
\end{equation}
\end{definition}
The following elementary lemma will be used often.

\begin{lem}\label{lem:Diff2}
Given $u: X \to \R$ such that there exist $p \in \R^n$ and $A \in \call S(n)$ such that \eqref{2od:def} holds for $x \in X$. Then
\begin{itemize}
	\item[(a)] $u$ is differentiable in $x$ with gradient $Du(x) = p$ ($p$ is unique);
	\item[(b)] $A$ is unique as well, and we denote $D^2u(x) = A$.
\end{itemize}
\end{lem}

\begin{proof}
It is clear that twice differentiability at $x$ implies differentiability at $x$ since \eqref{2od:def} implies
\begin{equation}\label{Diff1}
u(y)  = u(x) + \pair{p}{y-x} + o(|y-x|) \quad \text{as $y \to x$}.
\end{equation}
The uniqueness of $p$ follows easily from \eqref{Diff1}. In fact, if \eqref{Diff1} holds for $p$ and $p'$ with $p \neq p'$ one has
$$
\pair{p-p'}{y-x} = o(|y-x|) \quad \text{as $y \to x$},
$$
but choosing $y:=x+t(p-p')$ with $t \neq 0$ so small that $y \in X$ one obtains
$$
t|p - p'|^2 = |p - p'| \, o(t) \quad \text{as $t \to 0$},
$$
which gives $|p - p'| = o(1)$ for $t \to 0$, which contradicts $p-p'\neq 0$.

To see that $A$ is also unique, suppose that there exist $A \neq A \in \call S(n)$ such that \eqref{2od:def} holds with $p = Du(x)$. Hence one has
$$
\pair{(A - A')(y-x)}{y-x} = o(|y-x|^2) \quad \text{as $y \to x$}.
$$
Choosing $y = x + te$ for some eigenvector $e$ of $A-A'$ with eigenvalue $\lambda \neq 0$ one obtains a contradiction, since $\lambda t^2 = o(t^2)$ for $t \to 0$.
\end{proof}

We conclude this first section by stating the celebrated theorem of Alexandrov on second-order differentiability of convex functions. For the convenience of the reader, a complete proof of this crucial theorem can be found in Appendix~\ref{ap:legalex}, complemented by Appendix~\ref{proofsard}.

\begin{thm}[Alexandrov] \label{aleks}
Let $X \subset \R^n$ be open and convex, and let $u \colon X \to \R$ be convex. Then $u$ is twice differentiable (in the Peano sense) almost everywhere in $X$, with respect to the Lebesgue measure.
\end{thm}

The proof we offer in Appendix \ref{ap:legalex} depends on two ingredients, which we can roughly describe here as a crucial property about the non-critical points of the Legendre transform of convex quadratic perturbations of a convex function (see Lemma \ref{mplt}) and a Lipschitz version of Sard's theorem (see Lemma \ref{sard}), which shows that the set of ``bad'' points (the critical values) has Lebesgue measure zero. For completeness, we also give a proof of Lemma \ref{sard} in Appendix \ref{proofsard} which relies on the Besicovitch covering Lemma\ref{app:bes}, whose proof is also given. The reader is invited to have a look at Appendix~\ref{ap:legalex} for a presentation of the Legendre transform and a more detailed discussion of the needed ingredients.


\section{Quasi-convex functions and upper contact jets} \label{qcfaj}  

With Alexandrov's theorem now in hand, we will discuss the next important ingredient for the theory of viscosity solutions, which roughly speaking concerns the existence of a sufficient amount of upper (and lower) test functions. These test functions are used in the viscosity formulation of subsolutions (and supersolutions) for weakly elliptic PDEs and for the subharmonics (and superharmonics) in general potential theories. This will be systematically developped in Part II of this work, but it is perhaps useful to recall the viscosity formalism as motivation.

Given a continuous differential operator $F \in C(X \times \R \times \R^n \times \call S(n))$ on an open domain $X \subset \R^n$, an upper semicontinuous function $u \in \USC(X)$ is said to be a {\em viscosity subsolution} (on $X$) of the equation
\begin{equation} \label{viscosityequation}
F[u] \defeq F(x,u(x), Du(x), D^2u(x)) = 0, \quad x\in X
\end{equation}
if and only if, for each $x\in X$ fixed, one has $F[\phi] \geq 0$ for all \emph{upper test functions} $\phi$ of class $C^2$ for $u$ in $x$; that is, if and only if, for each $x \in X$ fixed, any $\phi$ of class $C^2$ in a neighborhood of $x$ such that
\begin{equation} \label{eq:ucqf}
u \leq \phi \quad \text{near $x$, with equality at $x$,}
\end{equation}
satisfies
\begin{equation} \label{visceqtest}
F(x, \phi(x), D\phi(x), D^2\phi(x)) \geq 0.
\end{equation}

Notice that an upper semicontinuous function \emph{may fail to admit} an upper test function at a given point. For example, this happens for $u = |\cdot|$ at $x = 0$. It is not difficult to show that there exists \emph{at least one} upper test function in \emph{every neighborhood} of each point of their domain.\footnote{See the beginning of the proof of \Cref{p:uvm}.} However, this is not sufficient for a useful viscosity theory based on upper test functions since this guarantees the possibility to check for the validity of \eqref{visceqtest} only in countably many points $x$. 

On the other hand, as we pointed out in the introduction, for \emph{locally quasi-convex  functions} one does have enough upper test functions for viscosity subsolutions by combining Alexandrov's Theorem \ref{aleks:qc}, the Jensen-S{\l}odkowski Theorem \ref{jenslod} (or any of its equivalent formulations) and the Almost Everywhere Theorem \ref{aet}. In addition, the  Upper Test Jet Theorem \ref{ucjt} gives ``nice continuity properties'' for test jets of quasi-convex functions. Then, under certain hypotheses, the quasi-covex approximation by way of the sup-convolution allow one to pass from quasi-convex to upper semicontinuous subsolutions in viscosity theory (see~\Cref{sas}).

\subsection{Quasi-convex functions}

The definition we adopt of a (locally) quasi-convex function is the following.

\begin{definition} \label{def:qc}
A function $u\colon C\to \R$ is said $\lambda$-\emph{quasi-convex} on the convex set $C \subset \R^n$ if there exists a real number $\lambda \geq 0$ such that the function $u + \frac{\lambda}{2}|\cdot|^2$ is convex on $C$.

We say that $u$ is \emph{locally quasi-convex} on $X$ if for every $x\in X$ there exists a ball $B\subset X$ with $x\in B$ such that $u$ is $\lambda$-quasi-convex on $B$, for some nonnegative real number $\lambda = \lambda(x)$. 
\end{definition}

Note that we have included convexity into the definition when $\lambda = 0$. In many proofs involving quasi-convex functions, we can assume without loss of generality that the functions are in fact convex. For instance, this is possible for results about differentiability, since the quadratic perturbation $\frac{\lambda}{2}|\cdot|^2$ is smooth. This is the case for Alexandrov's~\Cref{aleks}, which clearly extends from convex to locally quasi-convex functions; that is, the following result holds.

\begin{thm}[Alexandrov: locally quasi-convex version] \label{aleks:qc}
Let $X \subset \R^n$ be open and let $u$ be locally quasi-convex on $X$. Then $u$ is twice differentiable (in the Peano sense) almost everywhere on $X$ with respect to the Lebesgue measure.
\end{thm}

\begin{proof}
Since the Euclidean space is Lindel{\"o}f (that is, from any open covering of a set we can extract a countable subcovering), we know that there exists a countable family of balls $\{ B_i \}_{i\in\N}$ such that $u$ is $\lambda_i$-quasi-convex on each $B_i \subset X$, for some $\lambda_i \geq 0$, and $X = \bigcup_{i\in\N} B_i$. Since each $v_i \defeq u + \frac{\lambda_i}2|\cdot|^2$ is convex on $B_i$, by Alexandrov's \Cref{aleks}
\[
\big| B_i \setminus \Diff^2\! v_i \big| = 0 \quad \forall i \in \N,
\]
where we also note that $\Diff^2\! v_i = \Diff^2\! u$ since the norm squared is a smooth function. Hence we have, by the $\sigma$-subadditivity of the Lebesgue measure,
\[
\big| X \setminus \Diff^2\! u \big| \leq \sum_{i\in\N} \big| B_i \setminus \Diff^2\! u \big| = 0;
\]
that is, $u$ is twice differentiable almost everywhere on $X$, as desired.
\end{proof}

\begin{remark} \label{rmk:ch2:datucp}
Another property that quasi-convex functions inherit from convex functions is the differentiability points of upper quadratic contact \Cref{ch1:datucp}; indeed, note that if $\phi$ is an upper contact quadratic test function for a $\lambda$-quasi-convex function $u$ at some point $x$, then $\tilde\phi \defeq \phi + \frac\lambda2|\cdot|^2$ is an upper contact quadratic test function for the convex function $v \defeq u + \frac\lambda2|\cdot|^2$ at $x$, and one recovers the identity $Du(x) = D\phi(x)$. This property will be used shortly in the proof of \Cref{charc11}, and it will be also paraphrased in the language of {\em upper contact jets} later on in \Cref{datucp}.
\end{remark}

\subsection{A quasi-convexity characterization of $C^{1,1}$}\label{sec_charqc}
It is well-known that a function is affine if and only if it is simultaneously convex and concave. 
%For a better understanding of the notion of quasi-convexity, we are able to characterize those function that are simultaneously quasi-convex and quasi-concave. 
An interesting fact which helps to understand the notion of quasi-convexity is that functions which are both quasi-convex and quasi-concave must be differentiable with Lipschitz gradient (that is, of class $C^{1,1}$).
Of course, we say that $u$ is quasi-concave if $-u$ is quasi-convex. 

This characterization is included in \cite{hlkry} as an appendix, and was previously to be found in~\cite{hlqc}, in an appendix beginning as follows: ``It is interesting that the condition that a function be $ C^{1,1}$ is directly related to quasi-convexity, in fact it is equivalent to the function being simultaneously quasi-convex and quasi-concave. This was probably first observed by Hiriart-Urruty and Plazanet in \cite{hiriart}. An alternate proof appeared in \cite{eber}.''

The proof exploits the fact that quasi-convexity is preserved when one convolves with a \emph{mollifier}, that is a function $\eta$ such that
\[
\eta \in  C_\text{c}^\infty(\R^n), \quad \mathrm{supp}\,\eta \subset B_1,\quad \eta \geq 0,\quad \int_{\R^n} \eta = 1.
\]
This fact is formalized in the following lemma, where we use the standard notation
\[
\eta_\epsilon \defeq \frac1{\epsilon^n}\,\eta\!\left(\frac\cdot\epsilon\right), \quad \forall \epsilon > 0.
\]

\begin{lem} \label{convqc}
Suppose $u$ is $\lambda$-quasi-convex on $\R^n$ and let $\eta$ be a mollifier; let $\{\eta_\epsilon\}_{\epsilon>0}$ the approximate identity based on $\eta$. Then $u_{\epsilon} \defeq u \ast \eta_\epsilon$ is $\lambda$-quasi-convex.
\end{lem}

\begin{proof}
Let $f\defeq u + \frac\lambda2 |\cdot |^2$ be convex. It is easy to see that $f_{\epsilon} \defeq f \ast \eta_\epsilon$ is still convex and is smooth. In addition one has
\[ \begin{split}
\left(|\cdot|^2  \ast \eta_\epsilon \right)\!(x) \defeq \int_{\R^n} |x-z|^2\eta(z/\epsilon) \epsilon^{-n}\di z 
%\\&=  \int_{\R^n} |x-\epsilon y|^2\, \eta(y)\, \di y
= |x|^2 - 2\epsilon \pair{x}{a} + \epsilon^2 b,
\end{split} \]
where
\[
a \defeq \int_{\R^n} y\, \eta(y)\,\di y \in \R^n \quad \text{and}\quad b \defeq \int_{\R^n} |y|^2\,\eta(y)\,\di y \in \R.
\]
Therefore, $0\leq D^2 f_{\epsilon} = D^2 u_{\epsilon} + \lambda\I$ and the thesis follows.
\end{proof}

\begin{prop} \label{charc11}
$u$ is of class $\lambda$-$ C^{1,1}$ (that is, $u \in C^{1,1}$ and the Lipschitz constant of $Du$ is $\lambda$) if and only if both $\pm u$ are $\lambda$-quasi-convex.
\end{prop}

\begin{proof}
Suppose $u$ is of class $\lambda$-$ C^{1,1}$ and let $f\defeq u + \frac\lambda2|\cdot|^2$.
 We prove that $u$ is $\lambda$-quasi-convex; the proof for $-u$ is analogous. We have
\[
\pair{Df(x) - Df(y)}{x-y} \geq \left(\lambda|x-y| - |Du(x) - Du(y)| \right) |x-y| \geq 0, 
\]
thus proving (cf.~\Cref{conviffmon}) that $f$ is convex, i.e.\ $u$ is $\lambda$-quasi-convex.

Conversely, suppose $\pm u$ are $\lambda$-quasi-convex. We first assume that $u$ is smooth; then we have $-\lambda\I \leq D^2u(x) \leq \lambda \I$ for all $x$. By the Mean Value Theorem,
\[
\text{$Du(x) - Du(y) = D^2u(z) (x-y)$ \quad for some $z\in[x,y]$,}
\]
therefore $|Du(x) - Du(y)| \leq \lambda|x-y|$.

For the general case, note that quasi-convexity and quasi-concavity together imply $u$ being $C^1$. Indeed, both $f_\pm \defeq \pm u + \frac\lambda2 |\cdot|^2$ have a supporting hyperplane from below at every point; this means that, for every $x$, there exist $p_\pm=p_\pm(x)$ such that the affine (and thus quadratic) functions $\phi_\pm \defeq -f_\pm(x) - \pair{p_\pm}{\cdot - x}$ are upper contact functions for $-f_\pm$ at $x$ (in the sense of \Cref{ch1:datucp}). Note now that $-f_\pm$ are both $2\lambda$-quasi-convex, since both $\pm u$ are $\lambda$-quasi-convex, and thus by \Cref{ch1:datucp} (cf.~also \Cref{rmk:ch2:datucp}) we know that $p=D(-f_+)(x)$, $q=D(-f_-)(x)$, yielding $(q-p)/2 = Du(x)$. That is to say, $u$ is differentiable everywhere. By \Cref{deusingv} we conclude that $u$ is $C^1$.
 
Finally, approximate $u$ by $u_{\epsilon}$ and recall that $Du_{\epsilon} \to Du$ locally uniformly, since $u$ is $C^1$ (see, for instance, \cite[Theorems 9.3 and 9.8]{wheedzyg}). Therefore, since by \Cref{convqc} and what we showed above in the smooth case we know that $Du_{\epsilon}$ is $\lambda$-Lipschitz, so $Du$ is and we are done.
 \end{proof}

\subsection{Upper contact jets}

The next definition is of crucial importance for all that follows. We recall that $\call S(n)$ denotes the space of symmetric $n\times n$ real matrices which is equipped with its standard partial ordering (the Loewner order) where the quadratic form associated to $A \in \call S(n)$ will often be normalized:
\[
Q_A(y) \defeq \tfrac12\pair{Ay}y, \quad \text{so that}\ D^2Q_A \equiv A.
\]

\begin{definition} \label{def:ucp}
We say that a point $x \in X$ is an \emph{upper contact point for $u$} if there exists $(p,A)\in \R^n\times \call S(n)$ such that 
\begin{equation}	\label{ucp}
u(y) \leq u(x) + \pair p{y-x} + Q_A(y-x) \qquad \forall y \in X\ \text{near}\ x;
\end{equation}
in this case, we write $(p,A) \in J_x^{2,+}u$, and we say that $(p,A)$ is an \emph{upper contact jet} for $u$ at $x$. In addition, if \eqref{ucp} holds with strict inequality for $y\neq x$, then $x$ is called a \emph{strict upper contact point}, and $(p,A)$ is called a \emph{strict upper contact jet}, for $u$ at $x$. 
\end{definition}

\begin{remark} \label{rmk:ucqf}
Note that we always have equality in~(\ref{ucp}) for $y=x$ which justifies the use of \emph{contact} point for $u$ at $x$. Also notice that $(p,A) \in J^{2,+}_xu$ if and only if the unique quadratic function $\phi$ such that $J^2_x \phi \defeq (\phi, D\phi, D^2\phi)(x) = (u(x), p , A)$ satisfies \eqref{eq:ucqf}; that is, if and only if $\phi$ is a \emph{quadratic upper test function for $u$ at $x$} in the viscosity sense.
\end{remark}

\begin{remark}[Alternate spaces of upper contact jets]\label{rem:UCJ}
In addition to the notion of strictness of upper contact jets given in \Cref{def:ucp}, there are other useful variants, including a quantified version of ``uniform'' strictness, which we call \emph{$\epsilon$-strictness}: given $\epsilon > 0$ fixed, we say that a point $x \in X$ is an \emph{$\epsilon$-strict upper contact point for $u$} if there exists $(p,A) \in \R^n \times \call S(n)$ such that
\begin{equation}	\label{esucp}
u(y) \leq u(x) + \pair p{y-x} + Q_A(y-x) - \epsilon | y - x |^2 \qquad \forall y \in X\ \text{near}\ x;
\end{equation}
and, as above, $(p,A)$ will be called an \emph{$\epsilon$-strict upper contact jet for $u$ at $x$}.

When it comes to viscosity theory, both for subharmonics of a subequation constraint set $\call F$ and for subsolutions of an equation determined by an operator $F$, it is equivalent to work with upper contact jets or $\epsilon$-strict upper contact jets in the sense described in the next paragraph.  We discuss here the more well-known case of a continuous operator $F$, but the same considerations hold for a potential theory determined by $\call F$ which is closed.

 Notice that the validity of inequality \eqref{visceqtest} for any upper test function $\phi$ for $u$ at $x$, which defines the notion of $u$ being a subsolution of the equation \eqref{viscosityequation}: $F[u] = 0$ at $x$, is equivalent to the validity, for $(p,A) = (D\phi(x), D^2\phi(x))$ for some such $\phi$, of
\begin{equation} \label{visceq:jet}
F(x,u(x), p, A) \geq 0.
\end{equation}
Notice (cf.~\Cref{rmk:ucqf}) that such jets are not upper contact jets in general, yet they are \emph{little-o upper contact jets}; that is,
\begin{equation}	\label{loucp}
u(y) \leq u(x) + \pair p{y-x} + Q_A(y-x) + o(|y-x|^2) \qquad \forall y \in X\ \text{near}\ x.
\end{equation}
Hence, we have five families of upper contact jets (for $u$ at $x$), namely
\begin{enumerate}
\item {$J_S(x,u)$, \emph{$\epsilon$-strict upper contact jets}, for some $\epsilon > 0$ possibly different from jet to jet},
\item {$J_s(x,u)$, \emph{strict upper contact jets} according to \Cref{def:ucp}},
\item {$J_Q(x,u)$, \emph{quadratic upper contact jets}; that is, $J_Q(x,u) = J^{2,+}_x u$ is the set of all the upper contact jets for $u$ at $x$ according to \Cref{def:ucp}},
\item {$J_{ C^2}(x,u)$, \emph{ $C^2$ upper contact jets} associated to upper test functions $\phi \in C^2$; the usual ones of viscosity theory},
\item {$J_o(x,u)$, \emph{little-o upper contact jets} as in \eqref{loucp}, also often employed in viscosity theory}.
\end{enumerate}
It is easy to see that, for $(x,u)$ fixed,
\begin{equation} \label{inclusionsformulations}
J_S(x,u) \subset J_s(x,u) \subset J_Q(x,u) \subset J_{C^2}(x,u) \subset J_o(x,u),
\end{equation}
and one can prove (see \cite[Lemma C.1]{chlp}) that
\[
J_o(x,u) \subset \barr{J_S}(x,u),
\]
so that the closures of all sets in \eqref{inclusionsformulations} in fact coincide. By the continuity of the operator $F$, this shows that, in order to prove that $u$ is a viscosity subsolution of \eqref{viscosityequation} at $x$, one can check for \eqref{visceq:jet} to hold for all upper contact jets in any of the families above.
\end{remark}

As noted by Harvey and Lawson \cite{hlae}, there are two extreme cases where the set of upper contact jets of a function $u$ at a point $x$ are completely understood. The first extreme case is where $u$ has no upper contact jets at $x$; for instance, this is true of $u = |\cdot|$, at $x = 0$. The other extreme case is when the function is twice differentiable at $x$; by basic differential calculus one has the following result.

\begin{prop} \label{baspropucp}
Suppose $u$ is twice differentiable at $x \in X$ (as open subset); then 
\[
(p,A) \in J^{2,+}_x u \implies (p,A) = \big(Du(x), D^2u(x) + P\big),\ P\geq 0
\]
and the converse is true if $P > 0$.
\end{prop}

\begin{proof}
Since $u$ is twice differentiable at $x$ one has the Taylor formula
\begin{equation} \label{twdiff}
u(y) = u(x) + \pair{Du(x)}{y-x} + Q_{D^2u(x)}(y-x) + o(|y-x|^2) \quad \forall\, y\ \text{near}\ x.
\end{equation}
and by the definition of upper contact jet (\ref{ucp}) one sees that $(p,A) \in J^{2,+}_x u$ if and only if
\begin{equation} \label{d-a}
\pair{Du(x)-p}{y-x} + Q_{D^2u(x)-A}(y-x) + o(|y-x|^2) \leq 0 \quad \forall\, y\ \text{near}\ x.
\end{equation}
By choosing $y = x + t(Du(x) - p)$ for $t$ small, one has
\[
t|Du(x)-p|^2 + o{(t)} \leq 0 \quad \forall t\ \text{small},
\]
which forces $Du(x) = p$. At this point, recall that the Hessian of a twice differentiable function is symmetric and let $e$ be a unit eigenvector of $D^2u(x) - A$, relative to an eigenvalue $\lambda$; then by choosing $y = x+te$ with $t$ small one has
\[
\lambda t^2 + o(t^2) \leq 0,
\]
forcing $\lambda \leq 0$, and thus all the eigenvalues of $D^2u(x) - A$ have to be nonpositive, that is $A = D^2u(x) + P$ for some $P\geq 0$. Conversely, by (\ref{d-a}) it immediately follows that $(p,A) = (D^2u(x), D^2u(x) + P)$ is an upper contact jet for $u$ at $x$ if $P> 0$.
%
%For the second part, note that if $(q,B) \in J_x^{2,+} v$, then by (\ref{ucp}) and (\ref{twdiff})
%\[
%(v+u)(y) \leq (v+u)(x) + \pair{q+Du(x)}{y-x} + Q_{B+D^2u(x)}(y-x) + o(|y-x|^2) 
%\]
%for all $y$ near $x$, yielding $(q+Du(x), B+D^2u(x)) \in J^{2,+}_x(v+u)$, since the sign is preserved without the term $o(|y-x|^2)$ for $|y-x|$ small enough. Conversely, if $(q+Du(x), B+D^2u(x)) \in J^{2,+}_x(v+u)$, then analogously
%\[
%v(y) \leq v(x) + \pair{q}{y-x} + Q_{B}(y-x) + o(|y-x|^2), 
%\]
%and thus $(q,B) \in J_x^{2,+} v$.
\end{proof}

A pair of remarks concerning contact functions and jets are in order.

\begin{remark}[Lower contact functions and jets] \label{rmk:LTJ} One can also define \emph{lower} contact points and jets by reversing the inequality in (\ref{def:ucp}). Hence the set $J^{2,-}_xu$ of all lower contact jets for $u$ at $x$ can be considered as a \emph{local second-order subdifferential} of $u$ at $x$; indeed, if $(p,0) \in J^{2,-}_xu$, then $p \in \de u(x)$ according to \Cref{def:subd}, provided that we restrict the domain of $u$ to a neighborhood of $x$ in which (\ref{ucp}) holds.
\end{remark}

\begin{remark}[Flat contact points and local maxima] \label{rmk:FCJ} As we pointed out in \Cref{geointerpsubdiff}, if $x$ is an upper (resp.~lower) contact point whose associated upper (resp.~lower) contact jets have zero matrix component, then $u$ has, for each such jet, one locally supporting hyperplane from above (resp.~below) at $x$. Hence, we will call such points \emph{flat} contact points. Also, it is worth noting that $(0,0) \in J^{2,+}_x u$ (resp.~$(0,0) \in J^{2,-}_xu$) is equivalent to $x$ being a local maximum (resp.~minimum) point for $u$.
	\end{remark}

\subsection{The theorems on upper contact jets and on summands}
The main result on upper contact jets we wish to present can be found in \cite[Theorem~4.1]{hlqc}. Two thirds of this result have been essentially proven above since these parts are the easy and natural extensions to quasi-convex functions of frist order properties already established for convex functions in \Cref{convediff}. The third part concerning the {\em partial upper semicontinuity of second derivatives} will be ``new'' also per convex functions.

\begin{thm}[Upper Contact Jet Theorem] \label{ucjt}
Let $u$ be quasi-convex on a neighborhood of $x$ and suppose $(p,A)$ is an upper contact jet for $u$ at $x$. Then
\begin{itemize}
\item {\sf(D\;at\;UCP)} \ if $(p,A)$ is an upper contact jet for $u$ at $x$, then $u$ is differentiable at $x$ and $p=Du(x)$ is unique.
\end{itemize}
Furthermore, for every set $E$ of full measure in a neighborhood of $x$ there exist a sequence $\{x_j\}_{j\in\N} \subset E \cap \Diff^2\! u$, with $x_j \to x$ as $j\to\infty$, and $\bar A \in \call S(n)$ such that
\begin{itemize}
\item {\sf(PC\;of\;FD)} \ $Du(x_j) \to Du(x) = p$;
\item {\sf(PUSC\;of\;SD)} \ $D^2u(x_j) \to \bar A \leq A$.
\end{itemize}
\end{thm}

The proof of the theorem reduces to the proof of the three Lemmas~\ref{datucp}, \ref{pcfd} and \ref{pusc} below. As suggested above, the first two lemmas follow directly from corresponding results that we proved for convex functions. In particular, the {\em differentiability at upper contact points} of Lemma \ref{datucp} is the extension to quasi-convex functions (reformulated in the language of upper contact jets) of the differentiability at points of upper quadratic contact for convex functions of \Cref{ch1:datucp} and the {\em partial continuity of first derivatives} of Lemma \ref{pcfd} for quasi-convex functions is immediately deduced from formula \eqref{contconv} of Corollary \ref{deusingv} which showed that convex  differentiable functions are of class $C^1$. For the sake of completeness, we will include their short proofs. 

\begin{lem}[Differentiability at upper contact points, {\sf D\;at\;UCP}] \label{datucp}
Let $u$ be locally quasi-convex. If $x$ is an upper contact point for $u$, then $u$ is differentiable at $x$. Moreover, if $(p, A)$ is any upper contact jet for $u$ at $x$, then $p = Du(x)$ is unique.
\end{lem}

\begin{proof}
There exists a ball $B$ about $x$ and a quadratic function $\phi$ such that $u$ is $\lambda$-quasi-convex on $B$ for some $\lambda>0$ and $u \leq \phi$ on $B$, with $u(x) = \phi(x)$ (that is, $\phi$ is an upper contact quadratic function for $u$ at $x$). Hence $\tilde\phi \defeq \phi + \frac\lambda2|\cdot|^2$ is an upper contact quadratic function for the convex function $\tilde u \defeq u + \frac\lambda2|\cdot|^2$ at $x$. Therefore by \Cref{ch1:datucp} $\tilde u$ is differentiable at $x$ with $D\tilde u(x) = D\tilde \phi(x)$; that is, $u$ is differentiable at $x$ with $Du(x) = D\phi(x)$. Finally, the same argument also proves that $p = Du(x)$ is unique for any $(p,A) \in J^{2,+}_xu$ (cf.~also \Cref{baspropucp}).
\end{proof}

\begin{lem}[Partial continuity of first derivatives, {\sf PC\;of\;FD}] \label{pcfd}
Let $u$ be locally quasi-convex, and $x_j \to x$. If $u$ is differentiable at each $x_j$ and at $x$, then $Du(x_j) \to Du(x)$.
\end{lem}

\begin{proof}
As above, let $B$ be a ball about $x$ on which $\tilde u \defeq u+\frac\lambda2|\cdot|^2$ is convex. Eventually, $x_j,x \in B \cap \Diff^1\!\tilde u$, hence by the continuity property \eqref{contconv} (being $\de \tilde u(x_j) = \{ D\tilde u(x_j) \}$ and $\de \tilde u(x) = \{ D\tilde u(x) \}$), $D\tilde u(x_j) \to D\tilde u(x)$; this immediately yields $Du(x_j) \to Du(x)$, as desired.
\end{proof}

\begin{proof}[Proof of Theorem \ref{ucjt}]
\Cref{datucp} clearly gives the first point of \Cref{ucjt}, while \Cref{datucp,pcfd} together give the second point. Indeed, since $(p,A) \in J^{2,+}_x u$, by \Cref{datucp} $x \in \Diff^1\!u$, and by Rademacher's and Alexandrov's theorems $|{\Diff^k\! u \cap \call U}| = \left|\,\call U\right|$ for $k=1,2$, where we denoted by $\call U$ the neighborhood of $x$ which we consider. Also, we know that $x$ is a limit point for $E \subset \call U$ with $|E| = |\,\call U|$ (otherwise there would exists a small ball $B_\rho(x) \subset \call U \cap E\compl$, yielding $|E| < |\,\call U|$, contradiction). Analogously $x$ is a limit point for $E \cap \Diff^1\! u$ as well, hence we can conclude by invoking \Cref{pcfd}. 

The third point of \Cref{ucjt} is the content of the following lemma, which states indeed the ``deepest'' of the three properties; we postpone its proof in \Cref{sec:proof:pusc}, as we will exploit the Jensen--S{\l}odkowski Theorem \ref{jenslod} in combination with Alexandrov's \Cref{aleks:qc}.
\end{proof}



\begin{lem}[Partial upper semicontinuity of second derivatives, {\sf PUSC\;of\;SD}] \label{pusc}
Let $u$ be a locally quasi-convex function, and $E$ be a set of full measure in a neighborhood of $x$. If $(p,A)$ is an upper contact jet for $u$ at $x$, then there exists a sequence of upper contact points $\{x_j\} \subset E\cap \Diff^2(u)$ such that $D^2u(x_j) \to \bar A \in \call S(n)$ with $\bar A \leq A$.
\end{lem}

\medskip
While the Upper Contact Jet \Cref{ucjt} collects the basic information about upper contact jets of a single locally convex function $u$, the following result shows that for the sum of two locally quasi-convex functions one obtains useful information on the upper contact jets of the summands from each upper contact jet of the sum. Interestingly, this theorem, which is \cite[Theorem~7.1]{hlae}, can be interpreted in multiple ways:
\begin{enumerate}
	\item it obviously complements the partial upper semicontinuity of second derivatives for quasi-convex functions;
	\item it easily yields a quasi-convex version of the so-called {\em Theorem on Sums}, which plays a crucial role in the viscosity theory;
	\item  it conceals within a very useful \emph{addition theorem}.
\end{enumerate} 
The second interpretation is given below in \Cref{tosqc2} while the third one will be explained later on in \Cref{rmkone}.

\begin{thm}[Summand Theorem] \label{pusc:sum}
Suppose $u$ and $v$ are locally quasi-convex and that the sum $w \defeq u+v$ has an upper contact jet $(p,A)$ at $x$. Then the following hold:
\begin{enumerate}[label=(\roman*)]
\item	$x$ is an upper contact point for both the summands $u$ and $v$ (which are therefore differentiable at $x$ by \Cref{datucp}), whose upper contact jets at $x$ are of the form $(Du(x), \ast)$ and $(Dv(x), \ast)$;
\item 	for every set $E$ of full measure in a neighborhood of $x$, there exist a sequence $\{x_j\}_{j\in\N}$ of upper contact points for $w$, $x_j\in E \cap \Diff^2\! u \cap \Diff^2 \! v$, $x_j \to x$, and $B,C \in \call S(n)$, such that 
\begin{gather*}
Du(x_j) \to Du(x), \quad \text{and} \quad Dv(x_j) \to Dv(x),\\
D^2u(x_j) \to B \quad \text{and} \quad D^2v(x_j) \to C,\quad \text{with $B+C \leq A$}.
\end{gather*}
\end{enumerate}
\end{thm}

\begin{proof}
For the claim (i), we can suppose without loss of generality that $u$ and $v$ are convex. By the Hahn--Banach Theorem there exists $q\in \R^n$ such that $(-q, 0)$ is an upper contact jet for $-v$ at $x$, thus $(p-q, A)$ is an upper contact jet for $u = w-v$ at $x$. Analogously we prove that $x$ is an upper contact point for $v$ as well. 

For the claim (ii), we begin by noting that the sum $w$ of locally quasi-convex functions $u$ and $v$ is clearly locally quasi-convex. Now, by applying \Cref{pusc} to the sum $w$ there exist a sequence $\{x_j\}\subset E \cap \Diff^2\!u \cap \Diff^2\!v$ and a matrix $\bar A \in \call S(n)$, $\bar A \leq A$, such that $x_j \to x$ and $D^2w(x_j) \to \bar A$ as $j\to\infty$.\footnote{Note that in order to apply the lemma we are considering $E\cap \Diff^2(u)$ as the set of full measure near $x$.} Finally, if
\begin{equation} \label{arebounded} 
\{ D^2u(x_j) \}_{j\in\N} \ \text{and} \ \{ D^2v(x_j) \}_{j\in\N} \ \text{are bounded in $\call S(n)$},
\end{equation}
then there exist $B,C \in \call S(n)$ such that, up to a subsequence, $D^2u(x_j) \to B$ and $D^2v(x_j) \to C$, where $B+C = \lim_{j\to\infty}\left( D^2u(x_j) + D^2v(x_j) \right) = \lim_{j\to\infty} D^2w(x_j) = \bar A \leq A$. In order to prove \eqref{arebounded}, let $\lambda >0$ be such that both $u$ and $v$ are $\lambda$-quasi-convex in a neighborhood of $x$, and note that for any $\epsilon > 0$ there exists $j_0 = j_0(\epsilon) \in \N$ such that 
\[
-\lambda I \leq D^2u(x_j) = D^2w(x_j) - D^2v(x_j) \leq \bar A + \epsilon I + \lambda I \qquad \forall j \geq j_0.
\]
By fixing for instance $\epsilon = 1$ one sees that the tail $\{ D^2u(x_j) \}_{j\geq j_0}$ is bounded, thus the whole sequence $\{ D^2u(x_j) \}_{j\in\N}$ is bounded as well. The proof for $\{D^2v(x_j)\}_{j\in\N}$ is analogous.
\end{proof}

\begin{remark} \label{rmk:puscsum}
Note that since upper contact points for $w$ are also upper contact points for both $u$ and $v$, if $(p,A) \in J^{2,+}_x w$, then (cf.\ the proof above) we have $(p-q, A) \in J^{2,+}_x u$ and $(p-q', A) \in J^{2,+}_x v$, with $q+q' = p$, because one knows by \Cref{datucp} that $(p-q)+(p-q') = Du(x) + Dv(x) = Dw(x) = p$.
\end{remark}

\begin{remark} 
We used the basic fact that each interval $[A, B] \subset (\call S(n), \leq)$ is compact  (with respect to the subspace topology inherited from $\R^{n^2}$). To prove it, let $Y \in [A,B]$ and note that by the Courant--Fischer min-max theorem one has that $\lambda_i(A) \leq \lambda_i(Y) \leq \lambda_i(B)$ for all $i = 1,\dots,n$.  Hence, if the eigenvalues are arranged in increasing order, the entries of $Y$ are bounded by $n\left(|\lambda_1(A)| \vee |\lambda_n(B)|\right)$, thus, since it is trivial that $[A,B]$ is closed, one concludes by invoking the Heine--Borel theorem.
\end{remark}

%Note that one may suppose that by construction the sequence $\{x_j\}$ of \Cref{pusc:sum} enjoys all the properties guaranteed by \Cref{ucjt}. This makes the \emph{Summand Theorem} a powerful tool, possibly stronger than the classic Theorem on Sums.

As we said, a version of the Theorem on Sums for quasi-convex functions immediately follows if we double the variables, as it is easy to see.

\begin{cor}[Theorem on Sums for quasi-convex functions] \label{tosqc2}
Let $u$ and $v$ be $\lambda$-quasi-convex on the open subsets $X$ and $Y$ of $\R^n$, respectively. Define 
\[
w(x,y) \defeq u(x) + v(y)
\]
on $X\times Y \subset \R^n \times \R^n$ and suppose that $(p,A)$ is an upper contact jet for $w$ at $z = (\hat x,\hat y) $. Then $\hat x$, $\hat y$ are contact points for $u$, $v$, respectively, and for each set $E$ of full measure near $z$ there exists a sequence $(x_j, y_j) \in E \cap \left( \Diff^2(u) \times \Diff^2(v) \right)$ such that
\[\begin{split}
(x_j, u(x_j), Du(x_j), D^2u(x_j)) &\to (\hat x, u(\hat x), Du(\hat x), A_1), \\
(y_j, v(y_j), Dv(y_j), D^2v(y_j)) &\to (\hat y, u(\hat y), Du(\hat y), A_2),
\end{split}\] 
with
\[
-\lambda I \leq \left(\! \begin{array}{cc}
A_1 &  0 \\
0  & A_2 \\
\end{array}\! \right)
\leq A.
\]
\end{cor}

By induction, one can also extend this result by adding additional variables, so that it assumes a form which more closely resembles the classical Theorem on Sums for semicontinuous functions, in the equivalent formulation one finds in~\cite[Appendix, Theorem 3.2$'$]{user}. We leave it to the reader to write an appropriate statement.
%Let us give the following definition to streamline the upcoming statement.
%
%
%\begin{defn}
%Let $u$ be a real-valued function defined on a subset $E$ of $\R^n$ and, for $N > n$, let $\pi\colon \R^N \to \R^n$ the projection onto the first component of the product $ \R^n \times \R^{N-n}  \simeq\R^N$. We define the \emph{cylindrical extension} of $u$ to $E \times \R^{N-n} \subset \R^N$ to be $\tilde u \defeq u\circ \pi$.
%\end{defn}
%
%\begin{thm} \label{tosqc}
%Let $u_i$ be $\lambda_i$-quasi-convex in a neighborhood $V_i$ of $0\in \R^{n_i}$, for $i=1,\dots, k$, with $u_i(0) = 0$. Let $\tilde{u_i}$ be the cylindrical extension of $u_i$ to $\R^{n_1} \times \cdots \times V_i \times \cdots \times \R^{n_k}$ and set
%\[
%w \defeq \sum_{i=1}^k \tilde{u_i} \qquad \text{on $V_1  \times \cdots \times V_k$}.
%\]
%Suppose that $(0,A)$ is an upper contact jet for $w$ at $0 \in \R^N$, where $N\defeq \sum_{i=1}^k n_i$.
%
%Then $Du_i(0) = 0$ and there exist sequences $\{x_j^i\}_{j\in \mathbb{N}} \subset \Diff^2(u_i)$ converging to $0$ such that $D^2u_i(x^i_j) \to A_i \in \Sc(n_i)$ with
%\[
%-\Lambda I \leq \left( \begin{array}{ccc}
%A_1 & \cdots & 0 \\
%\vdots & \ddots & \vdots \\
%0 & \cdots & A_k \\
%\end{array} \right)
%\leq A,
%\]
%where $\Lambda \defeq \max_i \lambda_i$.
%\end{thm}

For the sake of completeness, in Subsection \ref{ss:tosu}, we will give a proof of the classical Theorem on Sums for semicontinuous functions (see Theorem \ref{tosu}). It is easily deduced from its quasi-convex counterpart because, roughly speaking, it is possible to transform a function which is bounded above into a quasi-convex function in such a way that it produces a regular displacement of the contact points of every given upper contact jet. More precisely, the displacement is proportional to the gradient-component of the jet, as we will see in Subsection \ref{ch:qca}. In addition, in Subsection \ref{sec:SC} we will introduce and prove a potential theoretic version of Harvey and Lawson in Theorem \ref{tospt}, which they used in their proof of strict comparison principles with minimal monotonicity for constant coefficient potential theories.

\section{The lemmas of Jensen and S{\l}odkowski} \label{sec:js}

In the crucial passage ``from almost everywhere to everywhere'', two classical instruments dealing with (quasi-)convex functions are {\em S{\l}odkowski's density estimate}~\cite[Theorem~3.2]{slod} and {\em Jensen's Lemma}~\cite[Lemma~3.10]{jensen}. The first instrument yields S{\l}odkowski's \emph{Largest Eigenvalue Theorem} \cite[Corollary~3.5]{slod} which, in turn, plays an essential role in Harvey and Lawson's proof of the Subaffine Theorem~\cite[Theorem~6.5]{hldir09}. The second instrument yields Jensen's maximum principle \cite[Theorem~3.1]{jensen} which, in turn, is a key ingredient in the proof of the Theorem on Sums~\cite[Theorem~3.2]{user}. These two instruments were developed independently. The first in the context of pluripotential theory and the second in the context of machinery for proving the uniqueness of viscosity solutions. As we will see, they are in some sense equivalent as was shown by Harvey and Lawson. This long unrecognized equivalence is a good example of a missed opportunity for synergy between potential theory and operator theory where such a synergy is a main theme of the program initiated by Harvey and Lawson.  

S{\l}odkowski's original proof of his density estimate is based on two nontrivial properties~\cite[Proposition~3.3(iii) and Lemma~3.4]{slod}. The first property concerns the largest generalized eigenvalue of the Hessian at $x$ of a convex function $u$~\cite[Definition~3.1]{slod} and the second property concerns spheres which support from above the graph $\Gamma(u)$ of $u$ at the point $(x,u(x))$; that is, spheres in $\R^{n+1}$ lying above $\Gamma(u)$ and touching it only at $(x, u(x))$. Following Harvey and Lawson~\cite{hlqc}, our proof of S{\l}odkowski's estimate will be based on the simpler ``paraboloidal'' counterparts of such properties.

This approach will lead to an important consequence, which Harvey and Lawson call S{\l}odkowski's lemma, and which turns out to be equivalent to a reformulation of theirs of Jensen's lemma. This eventually allows one to merge the two lemmas into a \emph{Jensen--S{\l}odkowski's theorem}, and enlightens an interesting path to prove both Jensen's lemma and S{\l}odkowski's Largest Eigenvalue Theorem.

At the end of the section, a second non classical proof of Jensen's lemma will be proposed. Jensen points out that his lemma is based ideas of Pucci \cite{pucci} and gives a proof which relies on the area formula (see, e.g.,~\cite[Theorem~3.2.3]{fed:geo}); we will offer a different area-formula-based proof by reformulating Jensen's lemma \emph{à la} Harvey--Lawson~\cite{hlqc} and then following an argument by Harvey~\cite{har:pc} which passes also through Alexandrov's maximum principle (see, for example, \cite{cafcab}).

\subsection{Classical statements: a review}

For the convenience of the reader, we recall some classical statements of the Jensen and S{\l}odkowki lemmas which we deal with.

In \cite{slod}, S{\l}odkowski proves an estimate for the Lebesgue lower density of sub-level sets of his function $\call K(u,x)$ defining a generalized notion of the largest eigenvalue of the Hessian at $x$ of a convex function $u$. We recall, that for $u$ convex (but not necessarily twice differentiable), S{\l}odkowski defines
\begin{equation}\label{LEF}
\call K(u,x) \defeq \limsup_{\epsilon \to 0} 2\epsilon^{-2} \max_{{\mathbb S}^{n-1}} \! \big( u(x+\epsilon\,\cdot\,) - u(x) - \epsilon\pair{Du(x)}{\cdot\,} \big)
\end{equation}
if $x \in \Diff^1\! u$ and $\call K(u,x) \defeq +\infty$ otherwise, and proves the following estimate (see \cite[Theorem~3.2]{slod}). We will give an original ``paraboloidal'' proof of this result as a corollary of our novel Lemma \ref{hlKb}.

\begin{lem}[S{\l}odkowski's density estimate] \label{slodthm}
Let $u$ be convex near $x^* \in \R^n$, and suppose that $\call K(u,x^*) = k^* < +\infty$. Then for any $k > k^*$ the set $\{ x : \ \call K(u,x) < k \}$ is Borel and its Lebesgue lower density at $x^*$ satisfies
\[
\delta^-_{x^*}(\{ \call K(u,\cdot) < k\}) \geq \left(\frac{k-k^*}{2k}\right)^n.
\]
\end{lem}
We recall that the Lebesgue lower density at $x^*$ of a measurable set $E$ is defined as
\[
\delta^-_{x^*}(E) \defeq \liminf_{\epsilon \dto 0} \frac{|E \cap B_\epsilon(x^*)|}{|B_\epsilon(x^*)|} .
\]

\begin{remark}
$\call K(u,x)$ indeed generalizes the concept of \emph{largest eigenvalue} of the Hessian of a convex function $u$ at $x$, since, if $u$ has second-order Peano derivatives at $x$, then $\call K(u,x) = \lambda_n(D^2u(x))$, the largest eigenvalue of the Hessian $D^2u(x)$:
\[
\call K(u,x) = \limsup_{\epsilon \to 0}\, 2 \epsilon^{-2} \displaystyle\max_{|h|=1}\! \Big(  \epsilon^2 Q_{D^2u(x)}(h) + o(\epsilon^2) \Big) = \Vert D^2u(x) \Vert = \lambda_n(D^2u(x)).
\]
\end{remark}

The two nontrivial properties on which S{\l}odkowski's proof of the density estimate are recalled in the following two lemmas which correspond to Proposition 3.3(iii) and Lemma 3.4, resepectively, in \cite{slod}.

\begin{lem}[Upper bound on the largest eigenvalue of the Hessian]\label{slod(iii)}
Let $U\subset \R^n$ be open and $u \colon U \to \R$ be convex. Suppose there exists a sphere $\mathbb S(c,r) \defeq \de B_r(c) \subset \R^{n+1}$ which supports $\Gamma(u)$ from the above at $(x,u(x))$, with $x \in \Diff^1\!u$; then
\[
\call K(u,x) \leq \frac{\left(1+|Du(x)|^2\right)^{\frac32}}{r}.
\]
\end{lem}

We will formulate and prove an original ``paraboloidal'' version of this upper bound in Lemma \ref{hlKb}, which exploits the paraboloidal machinery developed by Harvey and Lawson in \cite{hlqc} and leads to the aforementioned paraboloidal proof of Lemma \ref{slodthm}.

\begin{lem}[Lower bound on the lower density of spherical contact points]\label{slodestlem}
Let $u$ be nonnegative and convex on $B_\rho \subset \R^n$, for some $\rho > 0$, with $u(0) = 0$ and $Du(0) = 0$. Assume that there exists a ball $B_R((0,\dots,0,R)) \subset \R^{n+1}$ which intersects the graph of $u$ only at $0 \in \R^{n+1}$, and let, for $0<r<R$,
\[
X_r \defeq \big\{ x \in B_\rho :\ \text{$\exists\,c \in \R^{n+1}$\! s.t.\ $\mathbb S(c,r)$ supports $\Gamma(u)$ from the above at $(x,u(x))$} \big\}.
\]
Then the lower density of $X_r$ at $0$ satisfies
\[
\delta^-_0(X_r) \geq \left(\frac{R-r}{2r}\right)^n.
\]
\end{lem}

As a corollary of his density estimate in Lemma \ref{slodthm}, S{\l}odkowski obtains the following interesting result (see Corollary 3.5 of \cite{slod}).

\begin{thm}[S{\l}odkowski's Largest Eigenvalue Theorem] \label{slodle}
Let $u$ be locally convex on an open set $X$ and suppose $K(u,x) \geq M$ for a.e.\ $x\in X$. Then $K(u,x) \geq M$ for all $x \in X$.
\end{thm}
We will give a proof of this result under the weaker hypothesis that $u$ is just locally quasi-convex in Theorem \ref{thm:LET_qc} as a consequence of the Jensen-S{\l}odkowski Theorem.

We conclude this subsection by recalling {\em Jensen's lemma}, which we present as one finds in Lemma A.3 of the \emph{User's guide}~\cite{user}.

\begin{lem}[Jensen's Lemma] \label{u:jen}
 Let $w\colon \R^n \to \R$ be quasi-convex and $\hat x$ be a strict local maximum point of $w$. For $p\in\R^n$, set $w_p(x) =w(x) + \pair px$. Then, for $r,\delta>0$, the set
\[
K\defeq\{x\in \barr B_r(\hat x):\ \text{$\exists\, p\in \barr B_\delta$ for which $w_p$ has a local maximum at $x$} \}
\]
has positive Lebesgue measure. 
\end{lem}

\begin{remark}
Jensen's original statement~\cite[Lemma~3.10]{jensen} uses seemingly different hypotheses; that is, Jensen assumes that $u$ is continuous, $u$ belongs to $W^{1,\infty}$ and satisfies $D_\nu^2 u \geq -\lambda I$ in the sense of distributions, for all directions $\nu$. Nevertheless, one can see that these requirements are equivalent to asking that $u$ be $\lambda$-quasi-convex (for instance, one can use \cite[Theorem~31]{dudley}).
\end{remark}


\subsection{Upper contact quadratic functions and the vertex map}\label{sec:vertex_map}

Our journey towards the reformulation of the classical results of Jensen and S{\l}odkowski begins with a presentation  the ``paraboloidal'' machinery  of of Harvey-Lawson \cite{hlqc} which substitutes the original ``spherical'' machinery of S{\l}odkowski \cite{slod}. This machinery concerns upper quadratic test functions of a given {\em radius}, upper contact points and jets of {\em type $A$} (with fixed matrix component $A \in \call S(n)$) and the important associated \emph{upper vertex map}. In the next subsection, these notions will lead to estimates on the measure of contact points of fixed type.  

\begin{definition}
We say that $\phi$ is a \emph{quadratic function of radius $r$} if $D^2\phi \equiv \frac1r\I$. In this case it is easy to see that $\phi$ can be written in a unique way as $\phi = \phi(v) + \frac{1}{2r}|\cdot - v|^2$; we will call $v$ the \emph{vertex point} of $\phi$. 
\end{definition}

\begin{definition} 	\label{ucqf}
Let $u \colon X \to \R$ be any function. We say that a quadratic function $\phi$ is an \emph{upper contact quadratic function for $u$ at $x\in X$} if condition \eqref{eq:ucqf} holds; that is, if
\begin{equation}\label{ucqf1}
\text{$u(y) \leq \phi(y)$ for all $y \in X$ near $x$, \quad and \quad $u(x) = \phi(x)$.}
\end{equation}
If the inequality is strict for all $y\neq x$, then we say that $\phi$ is \emph{strict} upper contact quadratic function; if it holds for all $y\in X$, we say that $\phi$ is \emph{global} upper contact quadratic function \emph{on $X$}.
\end{definition}

We recall that in Definition \ref{def:ucp}, a point $x \in X$ for which \eqref{ucqf1} holds for some quadratic function $\varphi$ was called an upper contact point for $u$ and we presented the upper contact quadratic functions in the form $\varphi(x) = u(x) + \langle p, y - x \rangle + Q_A(y-x)$ where $Q_A(x) =  \frac{1}{2} \langle Ax,x \rangle$ and the contact condition  \eqref{ucqf1} takes the form \eqref{ucp}; that is,
\begin{equation}\label{ucqf2}
u(y) \leq u(x) + \pair p{y-x} + Q_A(y-x) \qquad \forall y \in X\ \text{near}\ x.
\end{equation}
Note that $\varphi$ is the (unique) quadratic function with $J^2_x(x) = (u(x), p, A)$ and $(p,A) \in J^{2,+}_x u$ was called an upper contact jet for $u$ in $x$. Two variants of upper contact jets will be used; namely those with fixed matrix component $A \in \call S(n)$
and then also those for which \eqref{ucqf2} holds on a fixed subset of $X$.

\begin{definition}\label{defn:ucp}
An upper contact jet for $u$ at $x$ is said to be of \emph{type $A$} if it is of the form $(p,A)$ for some $p \in \R^n$, and $x \in X$ will be called an \emph{upper contact point of type $A$ for $u$}. 
The set of all \emph{global} upper contact points of type $A$ for $u$ on $X$ will be denoted by $\C(u, X, A)$; that is,
\[
\C(u, X, A) \defeq \{ x \in X :\ \text{$\exists \, p \in \R^n$ such that \eqref{ucp} holds $\forall \, y \in X$} \}.
\]
\end{definition}

Note that, according to \cref{def:ucp}, the set of the contact points for some global upper contact quadratic function of radius $r$ coincides with $\C(u, X, \lambda I)$, for $\lambda = \frac1{r}$.

\begin{remark}[Notation]
We will denote by $B_\rho(x) \subset \R^n$ the open ball of radius $\rho$ about $x$, and we will omit the center when it is the origin; that is, we will use the notation $B_\rho \defeq B_\rho(0)$.
\end{remark}

\begin{remark}
We are going to focus our attention on sets of upper contact points of fixed type which are global on \emph{closed} balls; that is of the form $\C(u, \barr B_\rho, A)$, up to translations that center the ball at the origin. In particular, we will be mainly interested in the Lebesgue measure of such sets, so let us also point out that, when it comes to measures, if $u$ is continuous, then one can equivalently consider open or closed balls, since
\[
\C(u, B_\rho, A) \subset \C(u, \barr B_\rho, A) \quad\text{and}\quad \C(u, \barr B_\rho, A) \setminus \C(u, B_\rho, A) \subset \de B_\rho.
\]
\end{remark}

\begin{remark} 
We are going to discuss the Lebesgue measure of the set $\C(u, X, A)$ in the special case when $u$ is locally quasi-convex. For the sake of completeness, we note that $\C(u, X, A)$ is a measurable set when $u$ is locally quasi-convex. Indeed, if one defines 
%$h_{y,p,A} = u - u(y) + \pair p{y-\,\cdot} + \tfrac12\pair{A(y-\,\cdot)}{y-\,\cdot}$, 
$h_{y,p,A} \defeq u - u(y) + \pair p{y-\,\cdot} + Q_A(y-\,\cdot)$, then it is easy to see that
\[
\C(u, X, A) = \bigcup_{p\in \R^n} \bigcap_{y \in X} h_{y,p,A}^{-1}([0,+\infty)),
\]
where, by \Cref{datucp},
\[
\bigcap_{y \in X} h_{y,p,A}^{-1}([0,+\infty)) =\vcentcolon \C(u,X,A;\,p) \subset Du^{-1}(p);
\]
hence in fact
\[
\C(u,X,A) = \bigcap_{y \in X} \tilde h_{y,A}^{-1}([0,+\infty)) \subset \Diff^1\! u,
\]
where
\[
\tilde h_{y,A} \defeq u - u(y) + \pair {Du}{y-\cdot} + Q_A(y-\cdot) \quad \text{on} \ \Diff^1\! u,
\]
and $\Diff^1\! u$ has full measure by Rademacher's \Cref{rade} (or Alexandrov's \Cref{aleks:qc}, if one prefers). Now, clearly $\tilde h_{y,A}$ is a measurable function, so that each $\tilde h_{y,A}^{-1}([0,+\infty))$ is a measurable set; and to conclude, note that by the continuity of the map
\[
y \mapsto u(x) - u(y) + \pair{Du(x)}{y-x} + Q_A(y-x), \quad \text{with $x$ fixed},
\]
we can also write
\[
\C(u,X,A) = \bigcap_{y \in D} \tilde h_{y,A}^{-1}([0,+\infty)), \quad \text{for some $D \subset X$ countable and dense},
\]
so that one finally sees that $\C(u,X,A)$ is measurable.
\end{remark}

The following result, which is Lemma 5.1 of \cite{hlqc}, is an interesting exercise that shows an elementary geometric property of the convex hull of two open paraboloids (namely the open epigraphs of two quadratic functions). It will play a key role in Harvey and Lawson's paraboloidal treatment of the S{\l}odkowski Lemma \ref{slodthm}. We will denote the graph of $\phi$ by $\Gamma(\phi)$, its \emph{open} epigraph by $\epi(\phi)$, and the convex hull of a subset $S \subset \R^{n+1}$ by $\conv(S)$.

\begin{lem}[Slubbed hull property] \label{shp}
There is an open vertical slab $\frk S\subset \R^n\times\R$ written as the intersection $\call{H}_1 \cap \call{H}_2$ of two parallel vertical open half-spaces with the following property. Let $\frk C \defeq \conv(\epi(\phi_1) \cup \epi(\phi_2))$, then
\[
\Gamma(\phi_j) \cap \frk C =  \Gamma(\phi_j)\cap \call H_j \qquad \text{for}\ j=1,2.
\]
Moreover, if $v_j$ is the vertex point of $\phi_j$, for $j=1,2$, then the width of $\frk S$ is $|v_1 - v_2|$.
\end{lem}


\begin{remark}[Tangent plane to the union of two paraboloids] \label{parab:cases}
Let $z\in \de\big(\!\epi(\phi_1)\cup\epi(\phi_2)\big) \setminus \big(\Gamma(\phi_1) \cap \Gamma(\phi_2)\big) =\vcentcolon \frk B$ and let $H_z$ be the tangent hyperplane to $\epi(\phi_1)\cup\epi(\phi_2)$ at $z$. Then one of the following is verified (see \Cref{fig:parabcases}):
\begin{enumerate}[label=\textit{(\roman*)}]
\item	$H_z \cap \de(\epi(\phi_1) \cup \epi(\phi_2))$ is a singleton;
\item	$H_z \cap \de(\epi(\phi_1) \cup \epi(\phi_2))$ is a doubleton;
\item	$H_z \cap \de(\epi(\phi_1) \cup \epi(\phi_2))$ is infinite.
\end{enumerate}
In the cases \emph{(i)} and \emph{(ii)} we have that $z \in \mathrm{ext}\,\barr{\frk C}$ (the \emph{extreme points} of the closure of the convex hull defined in \Cref{shp}), and in the case \emph{(iii)} we have $z \in \frk B \setminus \frk C$. Also, if $\frk S = \call H_1 \cap \call H_2$ satisfies
\[
\de \frk S \cap \de\!\bigcup_{j=1,2}\!\epi(\phi_j) = \{ z: H_z\ \text{satisfies \emph{(ii)}} \} = \bigcup_{j=1,2}(\de \call H_j \cap \Gamma(\phi_j)),
\]
then $\call H_j \subset (\mathrm{ext}\,\barr{\frk C} \cap \Gamma(\phi_j))\compl$, for $j=1,2$, in such a way that $\de\frk C \setminus \frk S = \mathrm{ext}\,\barr{\frk C}$. We leave the details to the interested reader. 
\end{remark}

\begin{figure}[ht]
\renewcommand\thesubfigure{\emph{(\roman{subfigure})}}
\centering
\subfloat[][\centering The hyperplane touches only one paraboloid.]
	{\scalebox{0.69}{\includegraphics{paraboloidi_tan1.pdf}}} \qquad\quad 
\subfloat[][\centering The hyperplane is tangent to both paraboloids.]
	{\scalebox{0.69}{\includegraphics{paraboloidi_tan2.pdf}}} \qquad\quad
\subfloat[][\centering The hyperplane cuts the other paraboloid.] 
	{\scalebox{0.69}{\includegraphics{paraboloidi_sec.pdf}}} 
\caption{The three situations described in \Cref{parab:cases}.}
\label{fig:parabcases}
\end{figure}


\begin{proof}[Proof of \Cref{shp}]
Set 
\[
e \defeq \frac{v_2 - v_1}{|v_2-v_1|} \quad \text{and} \quad m \defeq \frac{\phi_2(v_2)-\phi_1(v_1)}{|v_2-v_1|}
\]
and consider $z_1\defeq(y_1, \phi_1(y_1))\in\Gamma(\phi_1)$ and $z_2\defeq(y_2, \phi_2(y_2))\in\Gamma(\phi_2)$. We want to determine a condition on $y_1$ and $y_2$ which ensures that $z_1$ and $z_2$ have a common tangent hyperplane $H$. Equating normals $(D\phi_1(y_1), -1)$ and $(D\phi_2(y_2), -1)$ yields 
\[
y_1-v_1 = y_2-v_2.
\]
 Thus $y_1 = v_1 + w$ and $y_2=v_2 + w$ for some $w\in\R^n$, so that $(\frac w r, -1)$ is normal to $H$. Since $z_1, z_2 \in H$ we have
\[
\tfrac1r\pair{y_1}w - \phi_1(y_1) = \tfrac1r\pair{y_2}w - \phi_2(y_2), 
\]
therefore $r(\phi_2(v_2) - \phi_1(v_1)) = \pair{y_2 - y_1}w = \pair{v_2-v_1}w$. Furthermore, since in particular $|y_1- v_1| = |y_2 - v_2|$, we know that $\phi_2(v_2) - \phi_1(v_1) = \phi_2(y_2) - \phi_1(y_1)$, proving that $\pair ew = rm$. Hence, if we decompose $w\in\R^n =  \langle e \rangle \oplus \langle e \rangle^\perp$, then there exists $\barr w\in\langle e \rangle^\perp$ such that 
\[
y_j = v_j+ rme + \barr w
\]
 for $j=1,2$.
Define now $\call H_1$ to be the open half-space whose boundary hyperplane $\de\call H_1$ has interior normal $(e,0)$ and passes through $(v_1+rme, 0)$. Similarly, define $\call H_2$ to have interior normal $(-e, 0)$ and boundary $\de \call H_2$ passing through $(v_2 + rme, 0)$. Clearly $\frk S = \call H_1 \cap \call H_2$ has width $|v_1-v_2|$. Also, the above proves that the mapping $\barr w \mapsto z_j$ parametrizes $\Gamma(\phi_j) \cap \de\call H_j$, for $j=1,2$, and the conclusion follows.
\end{proof}

\begin{figure}[ht]
\begin{tikzpicture}
  \pgfdeclareimage{img}{paraboloidi_proof.pdf}
  \node (S) at (0,0) {\pgfuseimage{img}};
	\node (ort) at (-0.75,-3.85) {\scriptsize $\langle e \rangle^\perp$};
	\node (Re) at (4.2,0.9) {\scriptsize $\langle e \rangle$};
	\node (vj) at (0.75,-0.7) {\scriptsize $v_j$};
	\node (rme) at (1.15,-0.17) {\scriptsize $rme$};
	\node (w) at (1.45,-0.7) {\scriptsize $\overline{w}$};
\end{tikzpicture}
\caption{The slab constructed in the proof of \Cref{shp}.}
\end{figure}

The slabbed hull lemma will be used to prove a crucial property of the {\em vertex map}, which is the main tool we will need. In preparation for the definition of this map, we note that a generic upper contact quadratic function of radius $r$ for $u$ at $x$ takes the form $\phi(\cdot) = u(x) + \pair p{\cdot - x} + \frac1{2r}|\cdot -\, x|^2$ and has vertex $v=x-rp$. Moreover, if $x\in \mathrm{Diff}^1(u)$, then $p=Du(x)$ is unique. This motivates the following definition.

\begin{definition}
Let $u\in \USC(X)$. For each real number $r > 0$, the map
\[
V_r \colon \C(u, X, \tfrac1r\I) \cap \mathrm{Diff}^1(u) \to \R^n, \quad \text{with} \ \ V_r\defeq \I - rDu,
\]
is called the \emph{upper vertex map (of radius $r$) for $u$}.
\end{definition}

\begin{remark} \label{rmk:vertexc}
Note that the domain of $V_r$ consists of those points $x \in X$ which admit a global upper contact quadratic function of radius $r$ and for which $u$ is differentiable. If $u$ is (locally quasi-)convex, then the upper vertex map is well-defined on all of $\C(u, X, \tfrac1rI)$ since $\C(u, X, \frac1rI) \subset \mathrm{Diff}^1(u)$ by \Cref{datucp} (locally quasi-convex functions are differentiable at all upper contact points).

In particular, if $u$ is smooth, then the Jacobian of $V_r$ is $D V_r = \I - rD^2u$, and thus $0\leq DV_r \leq \I$ on $\C(u, X, \frac1r\I)$; that is, $V_r$ is nonexpansive (or 1-Lipschitz). This fact extends to $u$ which is merely convex.
\end{remark} 

\begin{prop} \label{prop:contr}
Given a convex function $u$ defined on an open convex set $X \subset \R^n$ and given $r > 0$, the upper vertex map $V_r\colon \C(u, X, \frac1r\I) \to \R^n$ is nonexpansive.
 \end{prop}
 
\begin{proof}
For $j=1,2$, given $x_j \in \C(u, X, \frac1r\I)$, let $\phi_j$ be the upper contact quadratic function of radius $r$ for $u$ at $x_j$ with vertex $v_j \defeq V_r(x_j)$. With the notation in \Cref{shp}, since $u$ is convex and whose graph lies below those of the $\phi_j$'s, then $\frk C \subset \epi(u)$. Recall that $\epi$ is the \emph{open} epigraph, so that $z_j\defeq(x_j, \phi_j(x_j)) = (x_j, u(x_j))\in \Gamma(\phi_j) \setminus \epi(u)$; hence $z_j\in\Gamma(\phi_j) \setminus\frk C$. Therefore, by \Cref{shp}, $z_j \notin \call H_j$. It follows that the $z_j$'s lie on opposite sides of $\frk S$, therefore $|x_1 - x_2| \geq |v_1 - v_2|$.
\end{proof}

We also have a condition under which $V_r(x)$ cannot be too far from $x$; it is a consequence of the following result, which guarantees a wealth of upper contact points for any upper semicontinuous function which is bounded from below.

\begin{prop}	\label{p:uvm}
Suppose that $u\in\USC(K)$ is bounded from below on the compact subset $K \subset \R^n$ and let $\osc_K u \defeq \sup_K u - \inf_K u$ denote the oscillation of $u$ on $K$. Set 
\[
K_\delta \defeq\{y\in K:\ d(y, \de K) > \delta\}, \quad \text{with} \ \delta \defeq \sqrt{2r\osc_K u},
\]
and let $\C(u, K, \tfrac1r\I, v)$ be the set of the points of $K$ at which $u$ has an upper contact quadratic function of radius $r$ and vertex point $v$.
Then, for each $v\in K_\delta$, the set $\C(u, K, \tfrac1r\I, v)$ is a nonempty and compact subset of $\barr B_\delta(v) \subset K$.
\end{prop}

\begin{proof}
Set 
\[
c\defeq \sup_{y\in X} \left( u(y) - \tfrac1{2r}|y-v|^2 \right),
\]
where $c$ is finite since $u\in\USC(K)$. Then $\phi _v= \phi_v(v) + \frac1{2r}|\cdot -\, v|^2$ is an upper contact quadratic function of radius $r$ for $u$ at $x$ with vertex point $v$ if and only if $\phi_v(v) = c$ and the supremum is attained at $x$. Thus,
\[
\C(u, K, \tfrac1r\I, v) = \{x\in K: u(x) = \phi_v(x) \}
\]
is nonempty and compact.  

Since $u$ is bounded below, its oscillation is finite. Suppose that $\delta$ is small enought to ensure that $K_\delta$ is not empty and fix $v\in K_\delta$. Clearly, if $x\in\C(u,K,\frac1r\I, v)$, then
\[
\tfrac1{2r}|v-x|^2 = \phi_v(x) - \phi_v(v) = u(x) - c \leq u(x) - u(v) \leq  \osc_K u.
\]
This proves that $\C(u, K, \frac1r\I, v) \subset \barr B_\delta(v)$.
\end{proof}

\subsection{A paraboloidal proof of S{\l}odkowski's density estimate}\label{sec:slod_par}

The tools above allow one to prove the following ``paraboloidal'' counterpart of \Cref{slodestlem} which one finds in~\cite{hlqc} which gives a lower bound on the measure of global upper contact points of type $\frac{1}{r}I$ on closed balls as defined in  Definition \ref{defn:ucp}.

\begin{lem}[Lower bound on the measure of the set of upper contact points] \label{jen:den}
Let $u$ be a convex function on $\barr B_{\barr\rho}$, such that, for some $R>0$,
\[
0\leq u(y) < \frac{|y|^2}{2R} \quad \text{for $y\neq 0$}.
\]
Then
\[
\frac{|\C(u, \barr B_\rho, \tfrac1r\I)|}{|B_\rho|} > \left(1-\sqrt{\frac rR} \,\right)^n
\]
for all $r \in (0,R\,]$ and $\rho \in (0,\barr\rho\,]$.
\end{lem}

\begin{proof}
Apply \Cref{p:uvm} with $K= \barr B_\rho$, $\rho\leq\barr\rho$, and $r\leq R$. Since by our assumptions $\osc_K u = M(\rho) \defeq \sup_{B_\rho} u$, we have $\delta = \delta(\rho) = \sqrt{2rM(\rho)}$ and for every $v\in \barr B_{\rho-\delta}$, the contact set $\C(u, \barr B_\rho, \frac1r\I, v)$ is a nonempty subset of $B_\rho$. Note that, by convexity, if $x$ is a point in the radius $r$ contact set, then the upper vertex map $V_r$ is well-defined at $x$. Hence, for every $v\in \barr B_{\rho-\delta}$ we have that $v= V_r(x)$ for some $x\in \C(u, \barr B_\rho, \frac1r\I, v) \subset \C(u, \barr B_\rho, \frac1r\I)$; that is,
\[
\barr B_{\rho-\delta} \subset V\!\left( \C(u, \barr B_\rho, \tfrac1r\I) \right).
\]
Since $V_r$ is a contraction, one obtains that
\begin{equation} \label{slodineq1}
|B_{\rho-\delta}| \leq | \C(u, \barr B_\rho, \tfrac1r\I) |.
\end{equation}
One concludes by noting that Bauer's maximum principle (see~\cite{bau}) says that $M(\rho) = \max_{\de B_\rho} u$, and thus $M(\rho) < \rho^2/(2R)$, whence $\delta < \rho\sqrt{r/R}$. Therefore
\begin{equation} \label{slodineq2}
\rho - \delta > \rho \left(1-\sqrt{\frac rR}\, \right) \geq 0
\end{equation}
and the desired conclusion easily follows.
\end{proof}

On the other hand, a novel ``paraboloidal'' version of \Cref{slod(iii)} is now easy to formulate and prove.

\begin{lem}[Upper bound on the largest eigenvalue of the Hessian: paraboloidal version] \label{hlKb}
Let $U\subset \R^n$ be open and $u \colon U \to \R$ be convex. Suppose there exists a paraboloid of radius $r$ (i.e., $\barr\epi(\phi)$, with $\phi$ quadratic of radius $r$), which supports $\Gamma(u)$ from the above at $(x,u(x))$. Then
\[
\call K(u,x) \leq \frac{1}{r} \,.
\]
\end{lem}

\begin{proof}
By \Cref{ucjt}({\small\sf D\;at\;UCP}) one knows that $x \in \Diff^1\! u$, and
\[
u(x+\cdot\,) \leq u(x) + \pair{Du(x)}{\cdot\,} + \frac1{2r}|\cdot|^2 \quad \text{near $0$}.
\]
The inequality $\call K(u,x) \leq \frac1r$ then immediately follows from the definition of $\call K$.
\end{proof}

These two paraboloidal instruments of Harvey and Lawson are sufficient to prove S{\l}odkowski's density estimate by following the same basic reasoning of S{\l}odkowski with his ``spherical'' instruments.

\begin{proof}[Proof of \Cref{slodthm}]
Without loss of generality, suppose that $x^* = 0$, $u(0) = 0$ and $Du(0) = 0$. These reductions imply that $u \geq 0$ since $u$ is convex. Take $k^* < K < k$, and note that by the definition of $\call K$ there exists some $\bar\rho > 0$ such that $u < \frac K2 |\cdot|^2$ on $B_{\bar\rho}$.
Now, for any $r > 0$ such that $k^{-1} < r < K^{-1}$, by \Cref{hlKb}, one has
\[
\C(u,\bar B_\rho, \tfrac 1r I) \subset \{ x :\ \call K(u,x) < k \} \qquad \forall \rho \in (0,\bar\rho).
\]
Hence, by \Cref{jen:den} with $R = K^{-1}$, one has
\[
\delta^-_{0}(\{ \call K(u,\cdot) < k \}) \geq \liminf_{\rho \dto 0} \frac{|\C(u,\bar B_\rho, \frac1r I)|}{|B_\rho|} \geq \left( 1-\sqrt{\frac{r}{R}} \right)^n.
\]
Letting $K \dto k^*$ (that is, $R \uto (k^*)^{-1}$) and $r \dto k^{-1}$, one finds that
\[
\delta^-_{0}(\{ \call K(u,\cdot) < k \}) \geq \bigg( 1-\sqrt{\frac{k^*}{k}} \,\bigg)^n = \left({\frac{k-k^*}{\sqrt{k}(\sqrt{k} + \sqrt{k^*})}} \right)^n \geq \left(\frac{k-k^*}{2k}\right)^n,
\]
as desired.
\end{proof}

\subsection{The Jensen--S{\l}odkowski theorem}

We are now ready to present the reformulations of Harvey and Lawson of the classical lemmas of S{\l}odkowski and Jensen. There will be a Harvey--Lawson (HL) version for both lemmas, which will be shown to be equivalent. Moreover, the HL versions of the Jensen lemma will be shown to be equivalent to the original formulation. Finally, the two versions will be merged into a more general result in the Jensen--S{\l}odkowski Theorem~\ref{jenslod}.

We begin by using the HL lower bound on the measure of the set of lower contact points in \Cref{jen:den} to prove the HL version of the S{\l}odkowski lemma as done in~\cite{hlqc}.

\begin{lem}[HL--S{\l}odkowski lemma] \label{slod}
Suppose that $u$ is a locally convex function on $X\subset \R^n$ with strict upper contact jet $(0,\lambda \I)$ at $x$. Then there exists $\barr\rho > 0$ such that
\[
|\C(u,\barr B_\rho(x),\lambda \I)| > 0 \qquad \forall \rho \in (0,\barr\rho\,].
\]
\end{lem}

\begin{proof}
Since $(0,\lambda \I)$ is strict upper contact jet at $x$ for $u$ convex, one has $\lambda \geq 0$. The case $\lambda = 0$ happens only when $u$ is constant near $x$ and the thesis is trivial in this case. Hence,  we may assume that $\lambda >0$ and, without loss of generality, that $x=0$ and $u(x) = 0$. Then the hypothesis of $(0, \lambda\I)$ being a strict upper contact jet for $u$ at $x=0$ is equivalent to the statement that there exists $\barr\rho >0$ such that
\[
0\leq u(y) < \frac1{2R}|y|^2 \qquad \text{for}\ 0<|y|\leq \barr\rho,
\]
where $R=1/\lambda$. Indeed, if $(0, \lambda\I)$ is a strict upper contact jet at $0$, then by \Cref{datucp} of differentiability at upper contact points, $Du(0) = 0$ and by convexity $u \geq 0$; the converse implication is trivial. The thesis now follows from \Cref{jen:den} with $r = R$.
\end{proof}


This lemma assures that if $u$ is convex then the set of contact points for some global upper contact quadratic function of radius $r$ on a ball $B_\rho(x)$ cannot be too small (in the sense of the Lebesgue measure), provided that $x$ is the vertex point of a strict upper contact quadratic function of radius $r$ for $u$ at $x$ and $\rho$ is sufficiently small. Indeed, the requirement that $x$ is both a contact point of such a quadratic function and that $x$ is its vertex point is equivalent to the statement that $(0, \lambda I)$ is a strict upper contact jet for $u$ at $x$.

Furthermore, note that the HL--S{\l}odkowski lemma can be paraphrased by saying that if $u$ is locally convex and its quadratic perturbation $u-\frac{\lambda}{2}|\cdot-\,x|^2$ has a strict local maximum at $x$, then the set of global upper contact points of type $\lambda I$ for $u$ on each small ball about $x$ has positive measure. Analogously, Jensen's \Cref{u:jen} considers a quasi-convex function with a strict local maximum at $\hat x$ and states that the set of the upper contact points near $\hat x$ whose associated upper contact jets are of the form $(p, 0)$, with $p \in \R^n$ small ($|p| \leq \delta$), has positive measure. 

With the intuition that a bridge between convex and quasi-convex functions can relate the two lemmas, Harvey and Lawson~\cite{hlqc} prove that the HL--S{\l}odkowski lemma is equivalent to the following result, which they simply called \emph{Jensen's lemma}. It roughly states that if $u$ is locally quasi-convex, then the set of contact points of locally supporting hyperplanes from above near a strict local maximum point cannot be too small.

\begin{lem}[HL--Jensen lemma]  \label{hl:jen}
Suppose that $w$ is a locally quasi-convex function on $X\subset \R^n$ with strict upper contact jet $(0, 0)$ at $x$. Then there exists $\barr\rho > 0$ such that
\[
|\C(w,\barr B_\rho(x),0)| > 0	\qquad  \forall \rho \in (0,\barr\rho\,].
\]
\end{lem}

\begin{prop}\label{prop:HLJS}
The HL--S{\l}odkowski and the HL--Jensen lemmas are equivalent.
\end{prop}

\begin{proof}
Consider $u$ and $w$ related by the identity $u = w + \frac\lambda 2|\cdot -\, x|^2$. Then, on $B_\rho(x)$, $u$ is convex if and only if $w$ is $\lambda$-quasi-convex; note that by~\cref{def:qc}, the parameter of quasi-convexity $\lambda(x)$ is locally constant, therefore we may assume that the locally quasi-convex function $w$ is $\lambda$-quasi-convex on $B_\rho(x)$ if $\rho>0$ small enough. Furthermore, $(0,\lambda\I)$ is a strict upper contact jet for $u$ at $x$ if and only if $(0,0)$ is for $w$. This shows that $\C(w,\barr B_\rho(x),0) = \C(u,\barr B_\rho(x),\lambda \I)$, and completes the proof of the desired equivalence.
\end{proof}

Next we will show that the HL--Jensen Lemma \ref{hl:jen} is indeed a reformulation of Jensen's \Cref{u:jen}. In view of our discussion above, note that one only needs to show that \emph{all} global upper contact jets of type $0 \in \call S(n)$ for $w$ whose associated upper contact points are close enough to $x$ are of the form $(p, 0)$ with $|p|\leq \delta$.

\begin{prop} \label{cl:j-hlj}
The Jensen and the HL--Jensen lemmas are equivalent.
\end{prop}

\begin{proof}
Note that the request that $w$ has a strict local maximum at $\hat x$ is equivalent to the request that $(0,0)$ is a strict upper contact jet for $w$ at $\hat x$, which for $w$ $\lambda$-quasi-convex is equivalent to the requirement that $(0, \lambda I)$ is a strict upper contact jet for $u \defeq w + \frac\lambda2|\cdot-\,\hat x|^2$ at $\hat x$. Furthermore, $w_p$ has a local maximum at $x$ if and only if $(-p, 0)$ is an upper contact jet for $w$ at $x$; hence
\[
K = \bigcup_{|p| \leq \delta} \C(w,\barr B_r(\hat x),0\,;\, p),
\]
where the set $\C(w,\barr B_r(\hat x),0\,;\, p)$ denotes the set of the global upper contact points on $\barr B_r(\hat x)$ for $w$ associated to the jet $(p,0)$.
It is easy to see that $\C(w, \barr B_r(\hat x), 0\,;\, p)$ is the set of those points $x\in \barr B_r(\hat x)$ such that $(p + \lambda(x-\hat x), \lambda I)$ is an upper global upper contact jet (of radius $r = 1/\lambda$) for $u$ at $x$. By~\Cref{datucp}, $Du(x) = p + \lambda(x-\hat x)$ and thus
\[
V_{\frac{1}{\lambda}}(x) := \left(I - \frac{1}{\lambda}Du\right)(x) = \hat x - \frac p\lambda \quad \implies\quad  |p| = \lambda\,|V_{\frac{1}{\lambda}}(x) - \hat x|,
\]
where $V_{\frac{1}{\lambda}}\colon \C(u, \barr B_r(\hat x), \lambda I) \to \R^n$ is the upper vertex map of radius $r = 1/\lambda$ associated to $u$.
Since $V_{\frac{1}{\lambda}}$ is nonexpansive (\Cref{prop:contr}) and $V_{\frac{1}{\lambda}}(\hat x) = \hat x$,  we see that
\[
|V_{\frac{1}{\lambda}}(x) - \hat x| \leq |V_{\frac{1}{\lambda}}(x) - V_{\frac{1}{\lambda}}(\hat x)| + |V_{\frac{1}{\lambda}}(\hat x)- \hat x| \leq |x-\hat x|,
\]
whence $|p| \leq \lambda r$. Therefore, for $r \leq \delta/\lambda$, we have
\begin{equation*} \label{fatica}
K = \bigcup_{p \in \R^n} \C(w,\barr B_r(\hat x),0\,;\, p) = \C(w,\barr B_r(\hat x), 0).\qedhere
\end{equation*}
\end{proof}

\begin{remark}
We implicitly assumed that in the statement of Jensen's \Cref{u:jen}, by \emph{local} one means \emph{global on $\barr B_r(\hat x)$}. In this case, the thesis of Jensen's lemma holds for every $\delta >0$ and sufficiently small $r>0$, and the statements of the Jensen and HL--Jensen lemmas are equivalent. If instead, one requires that the thesis of Jensen's lemma must hold for all $r>0$, then, in the definition of $K$, $w_p$ having a local maximum at $x$ means that there exists $\eta=\eta(x)>0$ such that $x\in \C(w, \barr B_\eta(x), 0)$, so that the set $K$ is \emph{a priori} larger than $\C(w, \barr B_\rho(\hat x), 0)$ for any $\rho\leq r$. 
\end{remark}

\begin{remark}
The proof of Proposition \ref{cl:j-hlj} also completes an alternate proof of Jensen's \Cref{u:jen} which exploits Harvey and Lawson's strategy of focusing on upper contact quadratic functions.
\end{remark}

We now merge the two equivalent Lemmas~\ref{slod} and \ref{hl:jen} into a theorem which, despite being another equivalent reformulation of the previous results, unveils their full generality. This is also done in~\cite{hlqc}.

\begin{thm}[Jensen--S{\l}odkowski Theorem] \label{jenslod}
Suppose that $w$ is a locally quasi-convex function with strict upper contact jet $(p, A)$ at $x$. Then there exists $\barr\rho > 0$ such that
\[
|\C(w,\barr B_\rho(x),A)| > 0	\qquad  \forall \rho \in (0,\barr\rho\,].
\]
\end{thm}

\begin{proof}

Take 
\[
\phi \defeq -\pair p{\cdot - x} - Q_A(\,\cdot - x) + \frac\lambda2 |\cdot-\,x|^2,
\]
 for some $\lambda >0$ to be determined. It is easy to see that $(0, \lambda\I)$ is a strict upper contact jet for $u\defeq w+\phi$ at $x$, and $\C(w, \barr B_\rho(x), A) = \C(u, \barr B_\rho(x), \lambda\I)$. Moreover, let $\alpha, \beta >0$ such that $w$ is $\alpha$-quasi-convex and $A\leq \beta\I$; then $u$ is convex if $\lambda \geq \alpha + \beta$. The thesis now follows from \Cref{slod}.
 \end{proof}
 
 \begin{remark}\label{rem:HLSJ}
 We have just proved that the HL--S{\l}odkowski lemma implies the Jensen--S{\l}odkowski theorem, while it is clear that the converse is also true. Hence, the two results (and the HL--Jensen lemma as well) are in fact equivalent.
 \end{remark}
 
 \subsection{Consequences of the Jensen-S{\l}odkowski Theorem} \label{sec:proof:pusc}
 
 As previously mentioned, the main consequence of the Jensen--S{\l}odkowski theorem (\Cref{jenslod}) that concerns us in this work is the property of partial upper semicontinuity of second derivatives of a locally quasi-convex function ({\small\sf PUSC\;of\;SD}, \Cref{pusc}). We will now give the proof, which also competes the proof of the Upper Contact Jet Theorem (\Cref{ucjt}).
 
\begin{proof}[Proof of \Cref{pusc}]
Given a sequence $\epsilon_k\dto 0$ of positive numbers, pick 
\[
x_k \in E \cap \Diff^2(u) \cap \C(u, \barr B_{\epsilon_k}(x), A+ \epsilon_k I).
\]
Note that this is certainly possible for every sufficiently small $\epsilon>0$ since $E \cap \Diff^2(u)$ has full measure in a neighborhood of $x$ by Alexandrov's \Cref{aleks:qc} and $(p,A+\epsilon I)$ is a strict upper contact jet for $u$ at $x$, therefore $\C(u, \barr B_{\epsilon}(x), A+ \epsilon I)$ has positive measure for $\epsilon$ small by the Jensen--S{\l}odkowski Theorem~\ref{jenslod}.
We know that since $u$ is twice differentiable at $x_k$, then $D^2u(x_k) \leq A+\epsilon_k I$. Furthermore, by quasi-convexity, $D^2u(x_k) + \lambda I \geq 0$ for some $\lambda\geq0$. By compactness, there exists a subsequence $\{x_j\}$ such that $D^2u(x_j) \to \bar A$ for some $\bar A \in [-\lambda I, A]$.
\end{proof} 

We also wish to note here that, as the HL--S{\l}odkowski and the HL--Jensen lemmas are equivalent, despite dealing with convex and quasi-convex functions, respectively, one should expect results coming from the former lemma to have a counterpart holding for quasi-convex functions as well. This is the case, for instance, of S{\l}odkowski's Largest Eigenvalue \Cref{slodle}. In fact, if $u$ is $\lambda$-quasi-convex near $x^*$ with $\call K(u,x) = k^*$, then $\tilde u \defeq u + \frac\lambda2|\cdot|^2$ is convex with $\call K(\tilde u, x^*) = \call K(u,x^*) + \lambda = k^* + \lambda$. Then \Cref{slodthm} tells that, for $k > k^*$,
\[
\delta^-_{x^*}(\{ \call K(u, \cdot) < k \}) = \delta^-_{x^*}(\{ \call K(\tilde u, \cdot) < k + \lambda \}) \geq \left(\frac{k-k^*}{2(k+\lambda)}\right)^n.
\]
Exploiting this density estimate for quasi-convex functions one can deduce a quasi-convex version of S{\l}odkowski's Largest Eigenvalue Theorem. Alternatively, it is possible to prove it directly from the Jensen--S{\l}odkowski \Cref{jenslod}, as we do here. 
 
 \begin{thm}[S{\l}odkowski's Largest Eigenvalue Theorem: quasi-convex version] \label{thm:LET_qc}
 	Let $u$ be locally quasi-convex on an open set $X$ and suppose $K(u,x) \geq M$ for a.e.\ $x\in X$. Then $K(u,x) \geq M$ for all $x \in X$.
 \end{thm}
 \begin{proof}
Suppose that $u$ is locally quasi-convex on $X$ open and that $\call K(u,x) \geq M$ for a.e.\ $x \in X$. Seeking a contradiction to $\call K(u,x) \geq M$ for every $x \in X$, suppose that there exists $\hat x\in X$ such that $\call K(u, \hat x) < M$; say $\call K(u, \hat x) = M - 3\delta$ for some $\delta > 0$. By the definition \eqref{LEF} of $\call K$, there exists $\barr\epsilon >0$ such that $\barr B_{\barr\epsilon}(\hat x) \subset X$ and
\[
2 \epsilon^{-2} \displaystyle\max_{|h|=1} \big( u(\hat x+\epsilon h) - u(\hat x) - \epsilon\pair{Du(\hat x)}{h} \big) \leq M-2\delta \qquad \forall\, \epsilon \in (0, \barr \epsilon),
\]
which is equivalent to
\[
u(\hat x + z) \leq  u(\hat x) + \pair{Du(\hat x)}{z} + \tfrac12(M-2\delta)|z|^2 \qquad \forall\, z\in B_{\barr\epsilon}(0).
\]
This last inequality is equivalent to $(Du(\hat x), (M-2\delta)I)$ being an upper contact jet for $u$ at $\hat x$. Hence, $(Du(\hat x), (M-\delta)I)$ is strict and by~\Cref{jenslod} we have 
\[
|\C(u, \barr B_\rho(\hat x), (M-\delta)I)| > 0
\]
 for some $\rho > 0$. Since, by definition,
\[
u(y) \leq u(x) + \pair{Du(x)}{y-x} + \tfrac12(M-\delta)|y-x|^2
\]
for all $x\in \C(u, \barr B_\rho(\hat x), (M-\delta)I)$ and every $y \in \barr B_\rho(\hat x)$, this implies that
\[
\C(u, \barr B_\rho(\hat x), (M-\delta)I) \subset \{ \call K(u,\cdot) \geq M \}\compl,
\]
thus contradicting the hypothesis that $\call K(u,\cdot) \geq M$ almost everywhere.
 \end{proof}

\subsection{An area formula proof of the Jensen--S{\l}odkowski theorem}\label{sec:JSAlex}

We conclude this section with the very interesting  fact observed by Reese Harvey~\cite{har:pc}; namely, that the Jensen--S{\l}odkowski theorem can be seen as an immediate consequence of Alexandrov's maximum principle, a short proof of which can be in turn built around the well-known area formula (see \cite[Area Theorem~3.2.3]{fed:geo}).  Therefore, if one also considers that the Lipschitz version of Sard's theorem we used in the proof of Alexandrov's theorem can be seen as a corollary of the area formula as well (cf.~\cite[Notes on the appendix]{user}),\footnote{The proof of Sard's theorem we propose in Appendix~\ref{proofsard}, based on Besicovitch's covering theorem, could seem at first sight more involuted than just invoking the area formula, yet the reader should be aware that classical proofs of the area formula itself (see, e.g.~\cite{evansgar}) rely, among other instruments, on the Radon--Nikodym theorem, which in turn also requires Besicovitch's result.} then the Area Theorem arises as the pillar of the theory we discussed so far.

We recall the following definitions of \emph{approximate limit superior} and \emph{approximate differential} (for further details, see \cite[p.\ 212]{fed:geo}). 

\begin{definition}
Let $g$ be a measurable function in a neighborhood of a point $x$. The \emph{approximate limit superior} of $g$ at $x$ is the quantity
\[
\aplimsup_{y\to x} g(y) \defeq \inf \left\{ t \in \R\ :\ \lim_{r \dto 0} \frac{|g^{-1}((t,+\infty)) \cap B_r(x)|}{|B_r(x)|}= 0 \right\}.
\]
\end{definition}

\begin{definition}\label{defn:AD}
Let $f\colon A \to \R^n$ with $A$ and $f$ measurable, $A\subset \R^n$. The \emph{approximate differential} of $f$ at $a \in A$ is the unique linear map $\mathrm{ap}\,Df(a) \colon \R^n \to \R^n$ such that 
\[
\aplim_{x\to a} \frac{|f(x) - f(a) - \mathrm{ap}\, Df(a) (x-a)|}{|x-a|} = 0.
\]
\end{definition}

Now, with $f$ be as in Definition \ref{defn:AD} if one defines the {\em Stepanov set of $f$} by
\[ 
S(f) \defeq \left\{ x \in A:\ \aplimsup_{y\to x} \frac{|f(y) - f(x)|}{|y-x|} < \infty \right\},
\]
then by H.~Federer's extension of W.~Stepanoff's theorem \cite[Lemma~3.1.7 and Theorem~3.1.8]{fed:geo}, $f$ has an approximate differential almost everywhere in $S(f)$; also, as noted in the beginning of~\cite[Section~3.2]{fed:geo}, the Area Theorem can be stated as follows.

\begin{thm}[Area Theorem] \label{area}
For each measurable subset $E\subset S(f)$,
\[
|f(E)| \leq \int_{\R^n} N(\restr{f}{E}, y)\, \di y = \int_E |{\det \mathrm{ap}\,Df(x)}|\, \di x,
\]
where $N(\restr{f}{E}, y) \equiv \#\{x\in E:\ f(x) = y\}$.
\end{thm}

Let $u\colon X \to \R$ be locally quasi-convex on $X$ open in $\R^n$ and consider the gradient map $Du \colon \Diff^1(u) \to \R^n$. We know that both $\Diff^1(u)$ and $\Diff^2(u)$ have full measure in $X$, and hence the next result follows easily.

\begin{lem}
Let $u$ be as above. Then $\Diff^2(u) \subset S(Du)$.
\end{lem}

\begin{proof}
Let $f\defeq Du$. Fix $x\in \Diff^2(u)$ and set
\[
E_t \defeq \left\{ y\in \Diff^1(u)\ :\  g(y)\defeq\frac{|f(y) - f(x)|}{|y-x|} > t \right\}.
\]
Since $|Du(y) - Du(x)| \leq |D^2u(x)|\,|y-x| + o(|y-x|)$ for $y \to x$, let $t>|D^2u(x)|$ and $\epsilon > 0$ be such that $g(y) \leq t$ for all $y\in B_\epsilon(x)\cap \Diff^1(u)$. Hence $|E_t \cap B_\epsilon(x)| = 0$,  yielding $\aplimsup_{y\to x} g(y) \leq |D^2u(x)|$ and the desired conclusion follows.
\end{proof}

Hence, we have the following version of the Area Theorem, which is more suitable for our purposes. 

\begin{thm}[Area Theorem for gradients of locally quasi-convex functions] \label{area:cor}
Given $u: X \to \R$ a locally quasi-convex function. For every measurable set $E\subset \Diff^2(u)$, one has
\begin{equation}\label{AT_lqc}
|\Sigma| := |Du(E)| \leq \int_E |\det D^2u(x)|\, \di x.
\end{equation}
\end{thm}

Next, we use this Area Theorem \ref{area:cor} for locally quasi-convex functions to prove a locally quasi-convex version of \emph{Alexandrov's maximum principle}, which takes the form of the following pointwise \emph{a priori} estimate.

\begin{thm}[Alexandrov's maximum principle for locally quasi-convex functions] \label{alexmp}
Let $\Omega \subset \R^n$ be open and bounded. If $u\in\USC(\overline\Omega)$ is locally quasi-convex, then 
\begin{equation} \label{alexineq}
\sup_{\overline{\Omega}} u \leq \sup_{\de\Omega} u^+ + \frac{\mathrm{diam}(\Omega)}{\omega_n^{1/n}} \Bigg(\int_{E} |\det D^2u(x)|\,\di x\Bigg)^{1/n},
\end{equation}
where $\omega_n := |B_1|$ is the Lebesgue measure of the unit ball in $\R^n$ and 
\begin{equation}\label{E}
E := \C(u, \Omega, 0) \cap \Diff^2(u)
\end{equation}
is the set of all flat global upper contact points at which $u$ is twice differentiable.
\end{thm}

\begin{proof}
The idea of the proof is to show that the image of the gradient map $\Sigma:= Du(E)$ (or some superset of $\Sigma$ with the same measure) contains an open ball $B_{\delta}$ (about the origin) of a suitable radius $\delta$. In particular, if one defines
\begin{equation} \label{alex:delta}
\delta \defeq \frac{\sup_{\overline\Omega} u - \sup_{\de\Omega} u^+}{\mathrm{diam}(\Omega)}\,.
\end{equation}
Now, if one can show that $B_{\delta} \subset \Sigma := Du(E)$, then 
\begin{equation} \label{alexball}
\omega_n \, \delta^n = |B_\delta| \leq |Du(E)| \leq \int_{E} |\det D^2u(x) |\,\di x,
\end{equation}
where the second inequality is the area formula \eqref{AT_lqc}. Solving the inequality \eqref{alexball} for $\delta$ defined by \eqref{alex:delta} gives the desired inequality \eqref{alexineq}.

Notice that, without loss of generality, we can assume that $\delta$ defined by \eqref{alex:delta} is positive because if if $\delta \leq 0$ then $|B_{\delta}| = 0$ and the inequality \eqref{alexineq} is trivial. This also underlines the meaning of the estimate \eqref{alexineq}; one has an upper bound on the value of positive interior maximum value for $u$.

Exploting the argument above, it suffices to show that $B_{\delta} \subset  Du(E)$. We will, in fact, show a weaker inclusion, but one which is still sufficient to use the argument. More precisely, consider the \emph{a priori} enlargement of $E$ defined by \eqref{E} by eliminating the request that $u$ be twice differentiable; that is, 
\begin{equation}\label{Etilde}
\widetilde E := \C(u, \Omega, 0).
\end{equation} 
The gradient map $Du$ is well defined on $\widetilde E$ since $\C(u, \Omega, 0) \subset \Diff^1(u)$ by property ({\small\sf D\;at\;UCP}) of the Upper Contact Jet \Cref{ucjt}. With $u, \delta, E$ and $\tilde E$ as above, in the following two lemmas, we will show that
\begin{equation}\label{E_Etilde}
|Du(\widetilde E) \setminus Du(E)| = 0 \quad \text{and} \quad B_{\delta} \subset Du(\tilde E),
\end{equation}
which clearly yields the desired estimate \eqref{alex:delta} since $|B_{\delta}| \leq |Du(\widetilde E)| = |Du(E)|$ and then one can use the area formula as in \eqref{alexball}.
	\end{proof}
As noted, the proof of Theorem \ref{alexmp} has been reduced to the claims in \eqref{E_Etilde}, which we now prove. 

\begin{lem}
Let $u, E$ and $\widetilde E$ be as above. Then $Du(\tilde E) \setminus Du(E)$ is null; that is, it has zero Lebesgue measure.
\end{lem}

\begin{proof}
We will prove that the larger set $Du(\widetilde E \setminus E)$ is null. First, note that  $u$ being locally quasi-convex implies that $\widetilde E\setminus E$ is null by Alexandrov's \Cref{aleks:qc}. This suggests using the well-known fact that Lipschitz maps on $\R^n$ send null sets to null sets. To this end, the local quasi-convexity of $u$ also implies that there is an exhaustion of $\Omega$ by compact convex sets  $\{K_i\}_{i\in\N}$ such that $u$ is $\lambda_i$-quasi-convex on $K_i$. For each $i \in \N$, set 
$$
	E^{{(i)}} \defeq \widetilde E \cap K_i \subset \C(u, K_i, 0) \quad  \text{and} \quad u_i \defeq u + \frac{\lambda_i}2|\cdot|^2,
$$
which is convex on $K_i$. 

Since $\C(u, K_i, 0) = \C(u_i, K_i, \lambda_i\I)$, we know that the upper vertex map $V_{1/\lambda_i}$ for $u_i$ is well-defined and $1$-Lipschitz on $E^{{(i)}}$ (by \Cref{rmk:vertexc} and \Cref{prop:contr}); that is, with $ V_{1/\lambda_i}:= I - \lambda_i^{-1}Du_i$ one has
$$
	\left| \left( I - \frac{1}{\lambda_i}Du_i\right)(p) - \left( I - \frac{1}{\lambda_i}Du_i\right)(q) \right| \leq |p - q|, \ \ \forall p,q \in \R^n.
$$
 This implies that $Du_i$ is $2\lambda_i$-Lipschitz, and thus $Du$ is $3\lambda_i$-Lipschitz on $E^{{(i)}}$. We can now conclude that $Du(E^{{(i)}} \setminus E)$ is null for every $i\in\N$, by using the fact noted above that Lipschitz functions map null sets into null sets (see, e.g., \cite[Theorem~2.8(i)]{evansgar}). The claim now follows from the countable subadditivity of the Lebesgue measure.
\end{proof}

\begin{lem}
Let $u, \widetilde{E}$ and $\delta$ be as above. Then $B_\delta \subset Du(\tilde E)$.
\end{lem}

\begin{proof}
As noted above, we may assume that $\delta$ defined by \eqref{alex:delta} is positive since the desired inclusion is trivial for $\delta \leq 0$. This means that $u$ has a positive interior maximum which is attained only at interior points. 


For each $p\in B_\delta$, set $k_p := \max_{\overline{\Omega}} \left( u(\cdot) - \langle p, \cdot \rangle \right)$ which is finite since $u(\cdot) - \langle p, \cdot \rangle \in \USC(\overline{\Omega})$. Let $x_p \in \overline{\Omega}$ be a point realizes this maximim and hence one has 
\begin{equation}\label{x_p}
	u(y) \leq u(x_p) + \langle p, y -  x_p \rangle, \quad \forall \, y \in \overline{\Omega}.
\end{equation}
If we can show that
\begin{equation}\label{x_p_interior}
	x_p \in \Omega \quad  \text{($x_p$ is an interior point)}
\end{equation}
then \eqref{x_p} says that $x_p$ a contact point of type $0$ for $u$ on $\Omega$; that is, $u \in \widetilde E = \C(u, \Omega, 0)$. Hence, by \Cref{ucjt}({\small\sf D\;at\;UCP}), $u$ is differentiable at $x_p$ with $Du(x_p) = p$ so that $p \in Du(\widetilde E)$, which proves the lemma since $p \in B_{\delta}$ was arbitrary.

To see that \eqref{x_p_interior} holds we use an argument by contradiction. Suppose that $x_p\in\de\Omega$ and pick $y\in\overline\Omega$ with $u(y) = \sup_{\overline\Omega} u$ (in fact, $y \in \Omega$ in light of the assumption $\delta > 0$). Then from \eqref{x_p} one has
\[
\sup_{\overline\Omega} u = u(y) \leq x_p + \pair p{y-x_p} \leq \sup_{\partial \Omega} u^+ + |p| \, {\rm diam}(\Omega),
\]
and hence $|p| \geq \left( \sup_{\overline\Omega} u - \sup_{\partial \Omega} u^+\right)/{\rm diam}(\Omega):= \delta$, which contradicts $p\in B_\delta$.
\end{proof}

A proof of the Jensen--S{\l}odkowski Theorem \ref{jenslod} using Alexandrov's maximum principle (Theorem \ref{alexmp}) now proceeds as follows.

\begin{proof}[An area formula proof of \Cref{jenslod}]
We begin by recalling that Remark \ref{rem:HLSJ} noted that the HL--Jensen \Cref{hl:jen} is an equivalent formulation of the Jensen--S{\l}odkowski Theorem \ref{jenslod}. Hence, we will prove that for all $\rho > 0$ small, $|\C(u, \barr B_\rho(x), 0)| > 0$ assuming that $u$ is a locally quasi-convex with strict upper contact jet $(0, 0)$ at $x$. By translating $u$ we can assume that $u(x) > 0$ and hence for all $\rho > 0$ small, the radius $\delta$ defined by~(\ref{alex:delta}) is positive. By (\ref{alexball}) with $\Omega =  B_\rho(x)$, for all sufficiently small $\rho > 0$ one has
\[
0 < |B_\delta| \leq \int_{E} |\det D^2 u(y)|\, \di y \quad \text{with} \ E:=  \C(u, \Omega, 0) \cap \Diff^2(u),
\]
which forces $\C(u, \barr B_\rho(x), 0)$ to have positive measure. 
\end{proof}

The ``paraboloidal'' proof of the Jensen--S{\l}odkowski theorem passed through a density estimate for a certain set of global upper contact points for a convex function (\Cref{jen:den}); likewise, we can deduce a similar estimate, for the set of flat global upper contact points for a quasi-convex function on small balls around a strict local maximum point, using Alexandrov's maximum principle.

\begin{cor}
Let $u \colon X \to \R^n$ be $\lambda$-quasi-convex, with strict upper contact jet $(0,0)$ at $x$. Then there exists $\bar\rho > 0$ such that
\[
\frac{|\C(u, \barr B_\rho(x), 0)|}{|B_\rho(x)|} \geq  \left(\frac{\sup_{B_\rho(x)} u - \sup_{\de B_\rho(x)} u^+ }{2\lambda\rho^2}\right)^n \qquad \forall \, \rho \in (0,\bar\rho\,].
\]
\end{cor}

\begin{proof}
Consider $y\in E:=  \C(u, \Omega, 0) \cap \Diff^2(u)$. By the quasi-convexity of $u$ we have $D^2u(y) \geq - \lambda \I$, for some $\lambda>0$, and since $y$ is a maximum point of $u + \pair p\cdot$ for some $p\in \R^n$, we have $D^2u(y) \leq 0$. Hence $|\det D^2 u| \leq \lambda^n$ on $E$, and, letting $\delta$ be as in \eqref{alex:delta}, \Cref{alexmp} with $\Omega = B_\rho(x)$ (along with \Cref{aleks:qc}) yields $|B_\delta| \leq \lambda^n |\widetilde E|$, with $\widetilde E = \C(u, \barr B_\rho(x), 0)$. The desired conclusion now is obtained by noting that
\[
 |B_\delta|= \left(\frac{\sup_{B_\rho(x)} u - \sup_{\de B_\rho(x)} u^+ }{2\rho^2}\right)^n |B_\rho(x)|. \qedhere
\]
\end{proof}



\section{Quasi-convex approximation of USC functions} \label{sec:apqc}

In this section we present the well-known quasi-convex approximation of upper semicontinuous functions by way of the {\em supconvolution}. This approximation is of crucial importance for both general potential theories and the viscosity theory for PDEs since it allows one to use information on upper contact jets along the approximating sequences.

\subsection{Elementary properties of semicontinuous functions}

We begin by recalling the definitions and some well-known and useful properties of semicontinuous functions. Here and below $\dt{B}_{\rho}(x_0) := B_{\rho}(x_0) \setminus \{x_0\}$ denotes the punctured open ball of radius $\rho > 0$ and center $x_0$.

\begin{definition}\label{defn:usc_lsc}
Let $X \subset \R^n$.
\begin{itemize}
	\item[(a)] A function $u \colon X \to  [-\infty, +\infty)$ is \emph{upper semicontinuous at $x_0 \in X$} if
\begin{equation}\label{usc1}
	u(x_0) \geq \limsup_{X \ni x \to x_0} u(x) := \lim_{\rho \to 0^+} \sup_{x \in \dt{B}_{\rho}(x_0) \cap X} u(x) = \inf_{\rho > 0} \sup_{x \in \dt{B}_{\rho}(x_0) \cap X} u(x)
\end{equation}
If \eqref{usc1} holds for each limit point $x_0 \in X$,  $u$ is  \emph{upper semicontinuous on $X$} which is denoted by $u \in \USC(X)$.
	\item[(b)] A function $u \colon X \to (-\infty, +\infty]$ is \emph{lower semicontinuous at $x_0 \in X$} if
\begin{equation}\label{lsc1}
u(x_0) \leq \liminf_{X \ni x \to x_0} u(x) := \lim_{\rho \to 0^+} \sup_{x \in \dt{B}_{\rho}(x_0) \cap X} u(x) = \sup_{\rho > 0} \sup_{x \in \dt{B}_{\rho}(x_0) \cap X} u(x).
\end{equation}
if \eqref{lsc1} holds for each $x_0 \in X$, $u$  is \emph{lower semicontinuous on $X$} which is denoted by $u \in \LSC(X)$.
\end{itemize}
\end{definition}
Before recalling some well-known properties, a few remarks are in order. First, any function $u$ is both upper and lower semicontinuous at isolated points $x_0 \in X$ since, by definition $\sup \emptyset = - \infty$ and $\inf \emptyset = + \infty$. Second, clearly $u$ is lower semicontinuous in $x_0$ if and only if $-u$ is upper semicontinuous in $x_0$ and hence one can (and we will) focus primarily on upper semicontinuous functions.  Third, there are other equivalent definitions of upper semicontinuity in terms of the topology of upper and lower level sets of $u$; for example, $u \in \USC(X)$ in the sense of Definition \ref{defn:usc_lsc} if and only if
$$
\mbox{$\{ x \in X: \ u(x) < \alpha \}$ is (relatively) open in $X$ for each $\alpha \in \R$.}
$$
Fourth, semicontinuous functions which take values in $\R$ or $[\infty, +\infty]$ are also of use, but the choices made in Defintion \ref{defn:usc_lsc} will be useful for the viscosity calculus of Part II. This choice is explained in the following remark.

\begin{remark}[Choice of codomain] \label{rmk:codom} For upper semicontinuous functions allowing $-\infty$ but excluding $+\infty$ as possible values yields the following facts.
Let $u: X \to [-\infty, +\infty)$ be upper semicontinuous on $X$.
	\begin{itemize}
		\item[(a)]If $X$ is closed, then 
		\[
		\hat u(x) \defeq \begin{cases}
		u(x) & \text{on $X$} \\
		-\infty & \text{outside $X$}\,.
		\end{cases}
		\]
		defines un upper semicontinuous extension of $u$ to all of $\R^n$.
		\item[(b)] For each $K \subset X$ compact, if $u \not\equiv -\infty$ admits a finite maximum on $K$ (see Proposition \ref{prop:usc} (c)).
	\end{itemize}
Analogous facts hold for  $u: X \to (-\infty, +\infty]$ which is lower semicontinuous on $X$.
\end{remark}

\begin{prop}[Elementary properties of semicontinuous functions]\label{prop:usc} Let $X \subset \R^n$. 
	\begin{itemize}
		\item[(a)] A real-valued function on $X$ is continuous in $x_0 \in X$ if and only if it is both upper and lower semicontinuous in $x_0$. In particular, $\USC(X) \cap \LSC(X) = C(X)$.
		\item[(b)] The sum of two $(-\infty, +\infty]$-valued functions on $X$ which are both upper semicontinuous in $x_0 \in X$ is upper semicontinuous in $x_0$. In particular, $\USC(X) + \USC(X) \subset \USC(X)$.
		\item[(c)] For every compact subset $K \subset X$, any upper semicontinuous function $K$ admits a maximum value $\max_K u \in [-\infty, +\infty)$ which is finite if $u \not\equiv -\infty$ on $K$.
		\item[(d)] Suppose that $u \in \USC(\R^n)$ is \emph{anti-coercive}; that is, $u(x) \to - \infty$ as $|x| \to \infty$. Then $u$ is bounded above and the supremum $\sup_{\R^n} u$ is attained; that is, there exists $\bar x \in \R^n$ such that
		\[
		\sup_{\R^n} u = \max_{\R^n} u = u(\bar x).
		\]
		\item[(e)] The pointwise infimum of any family of upper semicontinuous functions on $X$ is upper semicontinuous; that is, 
		$$
			\inf_{i \in I} u_i \in \USC(X) \quad \text{if} \ \{u_i\}_{i \in I} \subset \USC(X),
			$$
			where the index set $I$ has arbitrary cardinality. On the other hand, the pointwise supremum
			\[
			 \sup_{i \in I} u_i = \max_{i \in I} u_i \in \USC(X), \quad \text{provided that $I$ if finite}.
			\]		
	\end{itemize}
	\end{prop}
\begin{proof}
\underline{\emph{(a)}} It is enough to note that the continuity of $u$ in $x_0$
$$
 \lim_{X \ni x \to x_0} u(x) \quad 
$$
is clearly equivalent to the two inequalities \eqref{usc1} and \eqref{lsc1}. 

\noindent\underline{\emph{(b)}} It is enough to note that the sup operation is sublinear
$$
 \sup_{x \in \dt{B}_{\rho}(x_0) \cap X}(u(x) + v(x)) \leq  \sup_{x \in \dt{B}_{\rho}(x_0) \cap X}u(x) +  \sup_{x \in \dt{B}_{\rho}(x_0) \cap X} v(x)
$$
for any pair of functions $u$ and $v$ on $X$, and then one passes to the limit as $\rho \dto 0$ if both $u$ and $v$ are upper semicontinuous in $x_0$.

\noindent\underline{\emph{(c)}} We can assume that $K$ is not a singleton $\{x_0\}$, since the conclusion is trivial in this case. Then, if $u \in \USC(K)$ is not identically $-\infty$, consider a maximizing sequence $\{ x_j \}_{j\in\N} \subset K$ such that
\begin{equation} \label{uscmax1}
u(x_j) \to \sup_K u  \quad \text{as $j\to\infty$}.
\end{equation}
Since $K$ is sequentially compact, there exists a point $x_0 \in K$ and a subsequence $x_{j_k} \to x_0$ as $k \to + \infty$. Since $u \not\equiv -\infty$, by the choice of the codomain and by the semicontinuity of $u$, one has 
\begin{equation} \label{uscmax2}
+\infty > u(x_0) \geq \limsup_{k\to\infty} u(x_{j_k}) = \lim_{k \to +\infty} u(x_{j_k}) = \sup_K u,
\end{equation}
so that $x_0 \in K$ realizes $\sup_K u$.

\noindent\underline{\emph{(d)}} Let $M \defeq \sup_{\R^n} u$. By the anti-coercivity of $u$, there exists an open ball $B$, centered at the origin, such that $u|_{B\compl} < M$. Therefore $\sup_{\R^n} u = \sup_{\barr B} u$, and the conclusion follows from the previous point.

\noindent\underline{\emph{(e)}} For the first claim, if $v:= \inf_{i \in I} u$ then one has
\begin{equation}\label{inf1}
	v(x) \leq u_i(x) \quad \forall \, x \in X, \forall \, i \in I.
\end{equation}
Now, for each $x_0 \in X$ by upper semicontinuity and \eqref{inf1} one finds
\begin{equation}\label{inf2}
	u_i(x_0) \geq \limsup_{X \ni x \to x_0} u_i(x) \geq \limsup_{X \ni x \to x_0} v(x) \quad \forall \, i \in I,
\end{equation}
and taking the infimum over $i \in I$ yields
$$
v(x_0) \geq \limsup_{X \ni x \to x_0} v(x).
$$
The second claim of part (d) is left to the reader.
	\end{proof}

\begin{remark}\label{rem:usc_ext_X_compact}
	As a consequence of Proposition~\ref{prop:usc}(c), the extension $\hat{u}$ of Remark~\ref{rmk:codom}(a) is bounded above if $X$ is compact.
	\end{remark}

\subsection{Quasi-convex approximation via supconvolution} \label{ch:qca}

One reason that quasi-convex functions are so interesting in general potential theories and the viscosity theory of nonlinear PDEs is the widely used fact that any upper semicontinuous $u$ function (which is bounded above) is a decreasing limit of a sequence of quasi-convex functions. The convergence of the quasi-convex approximation is pointwise and can be locally uniform if  $u$ is more regular. This fact is well-known and for further details see, for example, \cite{lioham, crankoc, hldir09}). The quasi-convex approximation of $u$ is given by \emph{supconvolutions} of $u$ which are defined next.

\begin{definition} \label{def:supconv}
Let $X \subset \R^n$ and let $u \in \USC(X)$ be bounded above. For each $\epsilon >0$ the $\epsilon$-\emph{supconvolution} of $u$ the function defined by
\begin{equation} \label{supconv}
u^\epsilon(x) \defeq \sup_{y \in X} \Big( u(y) - \frac1{2\epsilon} |y-x|^2 \Big), \quad \text{for each} \ x \in  \R^n.
\end{equation}
\end{definition}

Before proving the results we need, here are three noteworthy facts.

\begin{remark}
One can visualize how a function is transformed by the supconvolution operation by noticing that $u^\epsilon$ is the upper envelope of all quadratic functions of radius $-2\epsilon$ with vertex at some point of the graph of $u$.\footnote{By \emph{upper envelope} of a family of functions $\scr F$ we mean the function $g \defeq \sup_{f \in \scr F} f$. Also note that a quadratic function with negative radius is well-defined: it just opens downwards.} Also, notice that, even if we decided to ``preserve'' the domain of $u$ in \Cref{def:supconv} by defining its supconvolution only on $X$, $u^\epsilon$ is in fact well-defined by \eqref{supconv} on the whole space $\R^n$.
\end{remark}

\begin{remark}
The use of the term \emph{convolution} for $u^\epsilon$ defined above is justified by the fact that it is obtained by a transformation which is an actual convolution. Indeed, if we consider the functions to be valued in the so-called \emph{tropical semiring} $(\R \cup \{-\infty\}, \vee, +)$, we see that $u^\epsilon = u \ast (-\frac1{2\epsilon}|\cdot|^2)$.
\end{remark}

\begin{remark}
In \Cref{baspropsc} below, we prove that supconvolutions are quasi-convex functions. In the obvious manner, one can also define the \emph{inf-convolution} and prove that it is quasi-concave. Moreover, it is not difficult to see that if $\epsilon$ is sufficiently small, then the $\epsilon$-supconvolution (resp.\ $\epsilon$-inf-convolution) of a quasi-concave (resp.\ quasi-convex) function remains quasi-concave (resp.\ quasi-convex). This fact, along with the characterization given in \Cref{charc11},  proves a part of a well-known result of Lasry and Lions~\cite{laslio} on \emph{sup-inf-convolutions} being $C^{1,1}$.
\end{remark}

Four important properties of the supconvolution are gathered in the following theorem. We have already partially revealed the first one.

\begin{thm} \label{baspropsc}
Let $u \in \USC(X)$ be bounded above, let $u^\epsilon$ be its $\epsilon$-supconvolution. The following hold:
\begin{enumerate}[label=\it(\roman*)]
\item	$u^\epsilon$ is $\frac1\epsilon$-quasi-convex on $\R^n$;
\item	if $X$ is closed then the supremum in (\ref{supconv}) is attained; that is, for every $x \in \R^n$ there exists $\xi = \xi(\epsilon,x) \in \R^n$ such that $u^\epsilon(x) = u(\xi) - \frac1{2\epsilon}|\xi-x|^2$;
\item	$u^\epsilon$  decreases pointwise to $u$ on $X$ as $\epsilon\dto 0$; also, if $x \in X$ is a local maximum point for $u$, then $u^\epsilon(x) = u(x)$ for any $\epsilon$ sufficiently small;
\item	if $u$ is also bounded from below, and thus $|u| \leq M$ for some $M>0$, then
\begin{equation} \label{supcball}
u^\epsilon = \max_{z \in \barr B_\delta} \Big( u(\cdot-z) - \frac1{2\epsilon} |z|^2 \Big), \quad \text{where $\delta \defeq 2\sqrt{\epsilon M}$},
\end{equation}
on $X_\delta \defeq \{ x \in X :\ d(x,\de X) > \delta \}$.
\end{enumerate}
\end{thm}

\begin{proof}
\underline{\emph{(i)}}. It suffices to note that
\[
u^\epsilon(\cdot) + \frac1{2\epsilon}|\cdot|^2 = \sup_{y \in \R^n} \bigg( u(y) -  \frac1{2\epsilon}|y|^2 +  \frac1{\epsilon}\pair y\cdot \bigg)
\]
is the supremum of a family of affine functions, hence it is convex.

\noindent\underline{\emph{(ii)}}. For each $x \in X$ fixed, one has
\begin{equation}\label{max1}
u^{\epsilon}(x):= \sup_{y \in X} v_x(y) \quad \text{where} \quad  v_x(y):= u(y) - \frac1{2\epsilon} |y-x|^2.
\end{equation}
Each function $v_x$ is upper semicontinuous on $X$ since it is the sum of upper semicontinuous functions. If $X \subsetneq \R^n$ and $X$ is closed, then extend each $v_x$ to be the upper semicontinuous function $\hat{v}_x$ defined on all of $\R^n$ by assigning the value $-\infty$ on $X^c$ (see Remark~\ref{rmk:codom}(a)). Notice that with this extension,  one can rewrite \eqref{max1} as
\begin{equation}\label{max2}
u^{\epsilon}(x):= \sup_{y \in \R^n}\hat{v}_x(y), \quad \forall \, x \in \R^n.
\end{equation}
Moreover, since  $\hat{v}_x \equiv \infty$ on $X^c$ and is defined by \eqref{max1} on $X$ (where $u$ is bounded above), one has that $\hat{v}_x$ is anti-coercive . Hence, for each $x \in \R^n$ and $\epsilon > 0$ fixed, applying Proposition~\ref{prop:usc}{(d)} to $\hat{v}_x$ gives the existence of a point $\xi = \xi(x, \epsilon) \in \R^n$ which realizes $u^{\epsilon}(x)$ given by \eqref{max2}.
%Fix $x \in \R^n$; define, for $\eta >0$ small,
%\[
%\call O(x) \defeq  \sup_{\R^n} u - u^\epsilon(x) + \eta \quad\text{and}\quad  \rho(x) \defeq \sqrt{2\epsilon \call O(x)}.
%\]
%Note that $\call O$ and $\rho$ depend also on $\epsilon$ and $\eta$, nevertheless we decided not to write this dependence explicitly in order to keep our notation as cleaner as possible. Note now that for every $y \notin  B_{\rho(x)}(x)$ one has
%\[
%u(y) - \frac1{2\epsilon}|y-x|^2 \leq \sup_{\,\R^n} u - \frac{\rho(x)^2}{2\epsilon} = u^\epsilon(x) - \eta.
%\]
%Hence 
%\begin{equation} \label{maxatt}
%u^\epsilon(x) = \sup_{y \in \barr B_{\rho(x)}(x)} \Big( u(y) - \frac1{2\epsilon} |y-x|^2 \Big)
%\end{equation}
%for all $\eta >0$. Since $\barr B_{\rho(x)}(x)$ is compact, the supremum is actually a maximum thanks to the upper semicontinuity of $u$, thus proving \emph{(ii)}.

\noindent\underline{\emph{(iii)}}. Since $y = x \in X$ competes in the definition \eqref{supconv} of $u^{\epsilon}(x)$ and since the penalization term in \eqref{supconv} is non positive, one  has
\begin{equation} \label{uepsdecr}
\forall \, x \in X: \quad u(x)\leq u^{\epsilon'}(x) \leq u^\epsilon(x) \quad \text{whenever $\epsilon' \leq \epsilon$}.
\end{equation}
The argument of point {\em(ii)} (where each $\hat{v}_x$ is anti-coercive) shows that for each $x \in \R^n$ there exists a ball $B_{\rho(x, \epsilon)}(x)$ about $x$ such that
\begin{equation} \label{questa}
u^\epsilon (x) = \max_{\barr B_{\rho(x, \epsilon)}(x)} \left(u - \frac1{2\epsilon} | \cdot - \, x|^2\right) \leq \max_{\barr B_{\rho(x, \epsilon)}(x)} u,
\end{equation}
where we can write ``$\max$'' in place of ``$\sup$'' since both $u$ and its quadratic penalizations are upper semicontinuous and the closed balls are compact. It is easy to see that for each fixed $x$,  $\rho(x,\epsilon) \dto 0$ as $\epsilon \dto 0$. Indeed, if not, then for all $\epsilon$ sufficiently small, $\arg\max_{y \in X} \left( u - \frac1{2\epsilon} |\cdot -\, x|^2\right) \subset B_r(x)\compl$, for some $r = r(x) > 0$ independent of $\epsilon$, yielding $u^\epsilon(x) \leq \sup_{B_r(x)} u - \frac{r^2}{2\epsilon} < u(x)$ if $\epsilon$ is sufficiently small, which contradicts \eqref{uepsdecr}. Hence, the rightmost term in \eqref{questa} converges to $u(x)$ as $\epsilon \dto 0$,\footnote{The term converges to $\max\{ u(x), \limsup_{y\to x} u(y) \}$, where $ \limsup_{y\to x} u(y) \leq u(x)$ by the upper semicontinuity of $u$.} yielding $u^\epsilon(x) \dto$ $u(x)$.

By \eqref{questa} we also see that if $x$ is a local maximum point for $u$, then for $\epsilon$ so small that $x$ is a global maximum on $\barr B_{\rho(x)}(x)$ we have $u^\epsilon(x) \leq u(x)$ and hence the equality.

\noindent\underline{\emph{(iv)}}. If $u$ is bounded with $|u| \leq M$ then for each $y$ with $|y-x|^2 > 4\epsilon M:= \delta^2$ one has
\[
\left( u(y) - \frac{1}{2\epsilon} |y-x|^2 \right) - u(x) < M - \frac{1}{2\epsilon} 4 \epsilon M + M = 0;
\] 
that is, 
$$
	\sup_{y \in X \cap B_\delta(x)\compl} \left( u(y) - \frac{1}{2\epsilon} |y-x|^2 \right) \leq u(x) \leq u^\epsilon(x).
	$$ 
	Hence, another expression for the supconvolution is given by  
	$$
	u^\epsilon(x) = \sup_{y \in X \cap \bar B_\delta(x)} \left( u(y) - \frac{1}{2\epsilon} |y-x|^2 \right),$$
	 which is \eqref{supcball} after the change of variables $x-y= z$, provided that $B_\delta(x) \ssubset X$ (which is true if $x \in X_\delta$).
\end{proof}

%\begin{remark}
%If we make the dependence on $\eta$ explicit in the proof above by writing $\rho_\eta$ instead of $\rho(x)$, we see that as $\eta \dto 0$ one obtains a sequence of points $\xi_k \in \barr B_{\rho_{\eta_k}}(x)$ such that $u(\xi_k) -\frac1{2\epsilon}|\xi_k-x|^2 = u^\epsilon(x)$. Since $B_{\rho_\eta}(x) \subset B_{\rho_{\eta'}}(x)$ if $\eta < \eta'$ we have that $\{\xi_\eta\}_{\eta<\eta'} \subset \barr B_{\rho_{\eta'}}(x)$, hence by compactness, up to a subsequence, $\xi_k \to \xi \in \barr B_{\rho_0}(x)$. By the semicontinuity of $u$ one has 
%\[
%u^\epsilon(x) = \limsup_{\xi_k \to \xi}\big( u(\xi_k) - \tfrac1{2\epsilon}|\xi_k-x|^2\big) \leq u(\xi) - \tfrac1{2\epsilon}|\xi-x|^2 \leq u^\epsilon(x),
%\]
%therefore (\ref{maxatt}) holds also for $\eta = 0$.
%\end{remark}

\begin{remark}
Property \emph{(iv)} is crucial for the quasi-convex approximation technique described in the Part II on nonlinear potential theoriesdetermined by a subequation $\call F$. In particular, property \emph{(iv)} ensures that the supconvolution of an $\call F$-subharmonic function remains $\call F$-subharmonic on a suitably shrunk domain (cf.~\Cref{prop:approx}).
\end{remark}

A finer result on the correspondence between upper contact points and associated upper contact jets of a function $u$ with those of its  supconvolutions $u^{\epsilon}$ is the following, which Crandall--Ishii--Lions~\cite{user} call the \emph{magic property} of the supconvolution.

\begin{prop} \label{magprop}
Let $u \in \USC(\R^n)$ be bounded above and, for $\epsilon >0$, let $u^\epsilon$ be its $\epsilon$-supconvolution. If $(p,A)$ is an upper contact jet for $u^\epsilon$ at $x$, then $(p,A)$ is also an upper contact jet for $u$ at $x+ \epsilon p$. 

Furthermore, if $(0,A)$ is the limit as $j \to +\infty$ of a sequence of upper contact jets $(p_j, A_j)$ for $u^\epsilon$ at points $x_j \to 0$, then the corresponding sequence of upper contact points for $u$ satisfies $x_j + \epsilon p_j \to 0$ and $u$ is continuous at $x = 0$ along this sequence contact points.
\end{prop}

\begin{proof}
Let $\xi\in \R^n$ such that
\begin{equation} \label{eq0:magprop}
u(\xi) - \frac1{2\epsilon} |\xi-x|^2 = u^\epsilon(x);
\end{equation}
note that such a point $\xi$ exists by part (b) of \Cref{baspropsc}. For every $z\in \R^n$ and every $y \in B_{\rho}(x)$, with $\rho > 0$ sufficiently small, we have
\begin{equation} \label{eq1:magprop}
u(z) - \tfrac1{2\epsilon}|y-z|^2 \leq  u^{\epsilon}(y) \leq u^{\epsilon}(x) + \pair{p}{y-x}+ Q_A(y-x),
\end{equation}
where the first inequality follows from the definition of $u^\epsilon$ and the second inequality holds since $(p,A)$ is an upper contact jet for $u^\epsilon$ at $x$. Now using 
the choice of $\xi$ in \eqref{eq0:magprop} we can rewrite \eqref{eq1:magprop} as
\begin{equation} \label{eq2:magprop}
u(z) - \tfrac1{2\epsilon}|y-z|^2 \leq  u(\xi)- \tfrac1{2\epsilon}|\xi-x|^2 + \pair{p}{y-x}+ Q_A(y-x),
\end{equation}
which holds for every $z \in \R^n$ and every  $y \in B_{\rho}(x)$.


By choosing $z=y-x+\xi$ in \eqref{eq2:magprop} and using the fact that $y \in B_\rho(x)$ is arbitrary, one has
\[
u(z) \leq u(\xi) + \pair{p}{z-\xi} + Q_A(z-\xi), \quad \forall \, z \in B_\rho(\xi);
\]
that is, $(p,A)$ is an upper contact jet for $u$ at $\xi$. 

For the first part of the proposition, it remains only to show $\xi = x + \epsilon p$. One makes the choices 
\[
z = \xi \quad \text{and} \quad y=x + \frac{t}{\epsilon}(x +\epsilon p -\xi )
\]
with
\[
|t| < \frac{\rho}{\epsilon |x  + \epsilon p - \xi|} \quad \text{if $\xi \neq x+\epsilon p$}, \qquad \text{$t$ arbitrary if $\xi = x+\epsilon p$},
\]
so that $y \in B_{\rho}(x)$ and one can again apply ~\eqref{eq2:magprop} (multiplied by $\epsilon^2$) to find that as $t \to 0$,
\[
- \pair{x-\xi}{t(x + \epsilon p -\xi)} + o(t) \leq \epsilon \pair{p}{t(x+\epsilon p-\xi)} + o(t);
\]
that is,
\begin{equation} \label{abs:magprop}
t|x + \epsilon p - \xi |^2 + o(t) \geq 0.
\end{equation}
Since along a sequence $0 > t_n \uto 0^-$ the left-hand side of the above inequality~\eqref{abs:magprop} is eventually negative when $\xi \neq x+\epsilon p$, the only possibility for that to hold is that
\begin{equation} \label{xi=:magprop}
\xi = x + \epsilon p.
\end{equation}

It is now immediate to see that if $(p_j, A_j) \to (0, A)$ are upper contact jets for $u^\epsilon$ at $x_j \to 0$, then they are upper contact jets for $u$ as well, at $x_j + \epsilon p_j \to 0$. Finally, note that plugging \eqref{xi=:magprop} into \eqref{eq0:magprop}, one has $u^\epsilon(x) = u(x+\epsilon p) - \frac\epsilon2|p|^2$. Since  $u \leq u^\epsilon$, $u^\epsilon$ is continuous, and $u$ is upper semicontinuous, it follows that
\[
\begin{split}
u(0) \leq u^\epsilon(0) &= \lim_{j\to\infty} \!\big( u^\epsilon(x_j) + \tfrac\epsilon2|p_j|^2 \big) \\&=  \liminf_{j\to\infty} u(x_j + \epsilon p_j) \leq \limsup_{j\to\infty} u(x_j + \epsilon p_j) \leq u(0);
\end{split}
\]
this implies that $u(x_j + \epsilon p_j) \to u(0)$, and the proof is concluded.
\end{proof}

\subsection{The Crandall--Ishii--Lions Theorem on Sums} \label{ss:tosu}

We will rely heavily on the properties the quasi-convex approximation via supconvolution contained in \Cref{baspropsc} in Part II of this paper which treats subharmonics in nonlinear potential theory. Moreover, as is well known, the quasi-convex approximation of semicontinuous functions is also a key ingredient in the theory of viscosity solutions for nonlinear PDEs. In particular, together with Jensen's \Cref{u:jen}, one is able to prove the important Theorem on Sums (see the Appendix of~\cite{user}). As an application of what has been developed thus far, we give a short proof of that celebrated theorem. From our point of view, the idea is to use \Cref{magprop} to extend the quasi-convex version in \Cref{tosqc2} to upper semicontinuous functions.
%In some situations the magic property (\Cref{magprop}) is not required, and the other properties are sufficient in order to develop a quasi-convex approximation technique, as we are going to show in the next part (see \Cref{bastool}). Nevertheless, sometimes such a technique cannot be applied, as one needs some finer analysis; in this direction, a natural consequence of \Cref{magprop} is the Theorem on Sums.

\begin{thm}[On Sums; {\cite[Theorem 3.2]{user}}] \label{tosu}
Let $\scr O_i$ be a locally compact subset of $\R^{N_i}$ for $i = 1, \dots, k$,
\[
\scr O \defeq \scr O_1 \times \cdots \times \scr O_k \subset \R^N, \quad N \defeq N_1 + \cdots + N_k,
\]
$u_i \in \USC(\scr O_i)$, and $\phi$ be continuously differentiable in a neighborhood of $\scr O$. Set
\[
w(x) \defeq u_1(x_1) + \cdots + u_k(x_k) \quad \text{for}\ x = (x_1,\dots,x_k) \in \scr O,
\]
and suppose that $\hat x = (\hat x_1, \dots, \hat x_k) \in \scr O$ is a local maximum of $w - \phi$ relative to $\scr O$. Then for each $\epsilon > 0$ there exists $X_i \in \call S(N_i)$ such that
\[
(D_i \phi(\hat x), X_i) \in \bar J^{2,+}_{\scr O_i} u_i(\hat x_i) \quad \text{for}\ i = 1, \dots, k,
\]
and the block diagonal matrix $X$ with entries $X_i$ satisfies
\begin{equation} \label{matineq_tos}
-\bigg(\frac1\epsilon + \norm{D^2\phi(\hat x)}\bigg) I \leq X \leq D^2\phi(\hat x) + \epsilon D^2\phi(\hat x)^2.
\end{equation}
\end{thm}

\begin{remark}
The ``closure'' $\bar J^{2,+}_{\scr O_i} u_i(\hat x_i)$ appearing above is, with the terminology we have used so far, the set of jets $(p,A)$ such that there exists a sequence $(y_n, u(y_n), p_n, A_n) \to (\hat x_i, u_i(\hat x_i), p, A)$ where $(p_n, A_n)$ are global upper contact jets for $u_i$ at $y_n$ on $\scr O_i$.
\end{remark}

\begin{remark}
As noted in \cite{user}, some straightforward reductions can be made without loss of generality:
\begin{itemize}
\item due to the local nature of upper contact jets, the local compactness of $\scr O_i$, and the possibility to trivially extend upper semicontinuous functions outside compact sets (cf.~Remarks~\ref{rmk:codom} (a) and~\ref{rem:usc_ext_X_compact}), one may suppose that $\scr O_i = \R^{N_i}$;
\item up to translations, one may suppose that $\hat x = 0$, $u_i(0) = 0$, and $\phi(0) = 0$;
\item by replacing $\phi$ and $u_i$ with $\phi - \pair{D\phi(0)}{\cdot}_{\R^N}$ and $u_i - \pair{D_i\phi(0)}{\cdot}_{\R^{N_i}}$, respectively, one may suppose that $D\phi(0) = 0$.
\end{itemize}
With these reductions, $w(x) \leq Q_{D^2\phi(0)}(x) + o(|x|^2)$ for $x \to 0$, hence by redefining $u_i \defeq -\infty$ outside a small ball about $0 \in \R^{N_i}$ one has that $w - Q_{D^2\phi(0)+\eta I}$, for any $\eta>0$ small, has a global maximum at $0 \in \R^N$; therefore, one last reduction is possible:
\begin{itemize}
\item one may suppose that $\phi$ is quadratic.
\end{itemize}
Indeed, if the inequality \eqref{matineq_tos} holds with $D^2\phi(0) + \eta I$ in place of $D^2\phi(0)$, it suffices to let $\eta \dto 0$ in order to have the desired conclusion.
\end{remark}

Finally, in addition to the reductions listed above, for the proof (of the theorem with these reductions) it suffices to consider a pair of functions; that is, $k = 2$, as noted in \cite{user} when they declare that the formulation of Theorem \ref{tosu} is {\em ``formulated in a useful but distracting generality''}. Taking these considerations together, one arrives at the following statement, which is also rephrased in the formalism of upper contact jets.

\begin{thm}[On Sums, reduced] \label{tos}
Let $u,v \in \USC(\R^n)$, bounded above, with $u(0) = 0 = v(0)$. Define 
\[
w(x,y) \defeq u(x) + v(y)
\]
on $\R^n \times \R^n$ and suppose that $(0,A)$ is an upper contact jet for $w$ at $0 \in \R^{2n}$. Then $0 \in \R^n$ is a contact point for both $u$ and $v$, and for every $\epsilon >0$ there exist $A_1, A_2\in \call S(n)$ such that $(0,A_1), (0,A_2)$ are limits of upper contact jets for $u, v$, respectively, at points converging to $0$,
with
\begin{equation} \label{tosineq}
-\Big(\,\frac1\epsilon + \Vert A\Vert \Big) \,I \leq \left(\! \begin{array}{cc}
A_1 &  0 \\
0  & A_2 \\
\end{array}\! \right)
\leq A + \epsilon A^2.
\end{equation}
Also, $u$ and $v$ are continuous along the respective sequences of contact points.
\end{thm}

\begin{proof}
Fix $\epsilon >0$. Easy calculations exploiting the Cauchy--Schwarz inequality yield\footnote{For the sake of completeness, here are the calculations (recall that $A$ is symmetric):
\[\begin{split}
0 &\leq \Big(\sqrt{\epsilon} |A \xi| - \frac1{\sqrt\epsilon}|z-\xi|\Big)^2 \\
&\leq \epsilon |A \xi|^2 - 2\pair{A\xi}{z-\xi} + \frac1\epsilon|z-\xi|^2 \\
&= \pair{A\xi}{\xi} + \epsilon \pair{A\xi}{A\xi} + \frac1\epsilon|z-\xi|^2 + \pair{A(z-\xi)}{z-\xi} - \pair{Az}{z} \\
&\leq \pair{(A+\epsilon A^2)\xi}{\xi} + \Big(\frac1\epsilon + \norm{A}\Big) |z-\xi|^2 - \pair{Az}{z}.
\end{split}\]
%The second author wishes to thank E.~Danesi for the crucial contribution in clarifying the genesis of this inequality.
}
\[
\pair{Az}{z} \leq \pair{(A+\epsilon A^2)}{\xi} + \lambda|z-\xi|^2, \qquad \forall z,\xi \in \R^{2n}, \ \lambda \defeq \frac1\epsilon + \Vert A\Vert.
\]
Therefore
\[
%w(z) - \frac\lambda2|z-w|^2 \leq \tfrac12 \pair{(A+\epsilon A^2)w}{w},
w(z) - \frac\lambda2|z-\xi|^2 \leq Q_{A+\epsilon A^2}(\xi),
\]
hence, on taking the supremum over $z\in \R^{2n}$ and writing $\xi=(x,y)$, we have $(0, A+\epsilon A^2)$ is an upper contact jet at $0$ for the supconvolution
\[
w^{1/\lambda}(x,y) =  u^{1/\lambda}(x) +  v^{1/\lambda}(y).
\]
Indeed, $u^{1/\lambda}(0) \geq u(0) = 0$ by definition, and the same holds for $v$, while $w^{1/\lambda}(0) \leq 0$, and thus $u^{1/\lambda}(0) = 0 = v^{1/\lambda}(0)$. Now, by \Cref{tosqc2} we know that there exist jets $(0, A_i)$ which are the limits of upper contact jets for the $\lambda$-quasi-convex functions $u^{1/\lambda}, v^{1/\lambda}$ at some points (of second-order differentiability) converging to $0$ and that the $A_i$'s satisfy~(\ref{tosineq}). The conclusion now follows from \Cref{magprop}.
\end{proof}

\begin{remark}
In view of \Cref{tosqc2} and the proof of \Cref{magprop}, we can also say that one may choose the converging sequences of upper contact jets in \Cref{tos} to be $(Du^{1/\lambda}(x_j), D^2u^{1/\lambda}(x_j))$ and $(Dv^{1/\lambda}(y_j), D^2v^{1/\lambda}(y_j))$, for some sequences $\{x_j\}, \{y_j\}$ of points at which the supconvolutions $u^{1/\lambda}, v^{1/\lambda}$ are twice differentiable.
\end{remark}

\part{Nonlinear potential--theoretic analysis}\label{sas}

This second part is dedicated to general nonlinear second order potential theories and the fundamental role that quasi-convex functions play in such theories. The presentation will involve three stages which will be summarized in the guide for the reader below. It should be noted that this part incorporates the results in nonlinear potential theory contained in \cite{hlae}, with updated interpretations and additional results of subsequent and related investigations. 

\vspace{2ex}


\begin{center}
{\bf Guide for the reader}
\end{center}

Stage one consists of three sections and is dedicated to the foundations of nonlinear potential theory. In section \ref{sec:conset} we start by deducing the minimal properties that a {\em subequation} constraint set $\call F$ in the $2$-jet bundle over a Euclidean domain needs to satisfy in order to have a well defined and coherent potential theory of {\em $\call F$-subharmonic functions}. A few representative examples are given at the end of the section, which include both convex funtions and $\lambda$-quasi-convex functions. In section \ref{sec:duality}, we briefly review the important notions of {\em duality} and {\em monotonicity}. Duality yields a reformulation of {\em $\call F $-superharmonics} in terms subharmonics for the dual subequation $\widetilde{\call F}$ and monotonicity is a unifying notion in the theory, with many implications. When combined, these two notions are the basis of an important method for proving the comparison principle. Finally, section \ref{bastool} presents basic tools for establishing that a given function is $\call F$-subharmonic including the {\em Bad Test Jet} Lemma \ref{l:btj} and the {\em Definitional Comparison} Lemma \ref{defcompa} as well as several often used constructions in Proposition \ref{elemprop}.

Stage two is presented in section \ref{sec:QCSH} and treats the main theme of this work on the efficient use of quasi-convex functions in nonlinear potential theories and PDEs. The first main result is the \emph{Almost Everywhere Theorem}~\ref{aet} that states that for any (primitive) subequation $\call F$ on $X$, a locally quasi-convex function will be $\call F$-subharmonic on $X$ whenever it is $\call F$-subharmonic on a set of full (Lebesgue) measure. When combined with Alexandrov's Theorem \ref{aleks:qc} and the coherence property of Remark \ref{rem:coherence}, the $\call F$-subharmonicity for a locally quasi-convex function then reduces to a classical statement almost everywhere. The second main result is the \emph{Subharmonic Addition Theorem}~\ref{add} for locally quasi-convex functions. A subharmonic addition theorem concerns the following implication: given subequation constraint sets $\call F, \call G$ and $\call H$, a purely algebraic statement of \emph{jet addition} in the fibers over each $x \in X$ implies the funcional analytic statement of \emph{subharmonic addition}; that is, given three subsequation constraint sets $\call F, \call G$ and $\call H$
$$
\call F_x + \call G_x \subset \call H_x, \ \ \forall \, x \in X \implies \call F(X)   +  \call G(X) \subset \call H(X).
$$
When $\call F$ is $\call M$-monotone for a (constant coefficient) monotonicity cone subequation $\call M$, by using this implication with $\call G = \widetilde{\call F}$ and $\call H = \widetilde{\call M}$, one has the basis of the \emph{monotonicity-duality method} for proving the comparison principle in nonlinear potential theories, as noted in Remark \ref{rem:SAT_CC}. This will be developed further in Section \ref{sec:comp}. Stage two is completed by showing that the quasi-convex approximation preserves $\call F$-subharmonicity in the constant coefficient setting (see Proposition \ref{prop:approx}), which then yields the Subharmonic Addition Theorem for merely semicontinuous subharmonics in Corollary \ref{ccsa}. 

Stage three is presented in Section \ref{sec:comp} and concerns the use of quasi-convex analysis in the proof of {\em comparison principles} for nonlinear potential theories, as sketched in \cite{hlae}. Two distinct settings will be discussed. The first setting is when there is {\em sufficient monotonicity} in the sense that the subequation $\call F$ defining the potential theory admits a constant coefficient {\em monotonicity cone subequation} $\call M$. If the Subharmonic Addition Theorem holds, then the comparison principle on a domain $\Omega$ reduces to the {\em Zero Maximum Principle} for $\widetilde{\call M}$-subharmonics.
This is the idea of the {\em monotonicity-duality method} initiated by Harvey and Lawson in \cite{hldir09} in the constant coefficient pure second order case and which had developed into a robust and general method, as described in the introduction.

We will begin by ``deriving'' the method from first principles. Then, in Subsection \ref{sec:cccc}, we will represent the two important special cases of constant coefficient subequations of {\em pure second-order} and {\em gradient-free} (see Definitions~\ref{psos} and \ref{gfs}). In these two situations, one automatically has the {\em fiberegularity} and {\em sufficient monotonicity} of the subequation constraint set $\call F$, which are the general conditions need for the validity of the Subhrmonic Addition Theorem, and the comparison principle holds on arbitrary bounded domains. Moreover, these two illustrations make use of the two most basic monotonicity cone subequations $\call M$, whose dual subharmonics (which determine the validity of the comparison principle) has the interesting characterizations as the {\em subffine} and {\em subaffine plus} functions, respectively.

The second setting, presented in Subsection \ref{sec:SC}, treats the opposite situation in which there is only the {\em minimal monotonicity} that every subsequation possesses. We will prove a weaker form of the comparison principle, called {\em strict comparison} in Theorem. In the variable coefficient case, when the subharmonics are quasi-convex the proof of strict comparison is a simple consequence of the Summand \Cref{pusc:sum}. Two approaches to strict comparison for semicontinuous subharmonics in the constant coefficient case are presented in in Theorem \ref{sccc}. Both approaches use quasi-convex approximations; one implicitly and one implicitly. 

In \cite{hlae}, these three potential-theoretic theorems are stated in a more general form on manifolds; in this work we remain in Euclidean spaces, and a brief discussion on how one can extend such results to manifolds is included at the end of this part in Section \ref{sec:mflds}.

%Exploiting and adapting a quasi-convex approximation technique outlined in \cite{hldir09}, we deduce a subharmonic addition theorem for constant coefficient subequations from its quasi-convex counterpart; similarly, strict comparison holds in the constant coefficient case without the quasi-convexity assumption. We mention that the first result can also be found in \cite[Theorem~7.1]{chlp}, with an analogous proof, while the latter has a Theorem-of-Sums-based proof in \cite[Corollary~C.3]{hldir}.


%Furthermore, we will show that the basic properties of dual subequations proven in \cite{hldir09, hldir} and regathered in \cite{chlp}, as well as the \emph{definitional comparison} \cite[Lemma~3.14]{chlp}, hold for nonconstant coefficient subequations, too. Consequently, we extend \emph{almost all} the elementary properties of families of subharmonic functions contained in \cite{hldir09, hldir, chlp} to nonconstant coefficient subequations; only one of them must be left behind, namely the \emph{translation property}, so that a possible extensions of potential theoretic comparison must confront themselves with the lack of this property. \noticina{Change this conclusion} We will not discuss this key fact, as this work is meant to be a introductory presentation to Harvey and Lawson's theory, and we refer the interested reader to~\cite{cpaux,cpmain,cprdir}.
% \noticina{To rewrite---We don't have this part here anymore.}A brief discussion about the implications of the lack of this property in the nonconstant coefficient case in included at the beginning of the last section, where we adapt certain results of Cirant--Payne on variable coefficient gradient-free subequations~\cite{cpaux, cpmain} to variable coefficient subequations depending on the gradient too, by adding a \emph{directionality} assumption inspired by the theory of monotonicity cones in \cite{chlp}. Such results are then used in the proof of a \emph{strict comparison theorem for uniformly continuous subequations with directionality}. 
%\footnote{We decided not to discuss the \emph{vice versa}, that is the problem of associating a ``compatible'' operator to a given subequation. The reader can see~\cite[part~11]{chlp} for some results in this direction.}


\section{Subequation constraint sets and their subharmonics} \label{sec:conset}

We start with a discussion of the axioms which should be placed on a {\em subequation} constraint set $\call F$ in the space of  $2$-jets in order to have a well defined and coherent potential theory of $\call F$-subharmonic functions. We will see that a monotonicity property with respect to the $\call S(n)$ variable is needed. In order to have a useful notion of duality, a certain topological stability axiom is useful, and leads to a natural notion of $\call F$-superharmonics by duality. Finally, in order to prevent certain obvious counterexamples to the validity of the comparison principle, another monotonicity property with respect to the $\R$ variable is needed. We recall that the comparison principle is an essential tool for treating the natural Dirichlet problem, since it ensures uniqueness of solutions and plays a key role in existence by Perron's method.

Potential theories associated to subequations are interesting from two different points of view. First, there are many interesting geometric contexts with naturally associated potential theories as reviewed in Section~1.1 of \cite{hpsurvey}. Second, subequation constraint sets and their associated potential theory can arise naturally in the study of a given (weakly ellipitc) PDE, which we recall now for the benefit of those familiar with the standard viscosity theory of PDEs but not with the corresponding general potential theoretic context. Suppose we are given an operator $F \in C(X \times \R \times \R^n \times \call S(n))$ on some open set $X\subset \R^n$ which determines a PDE
\begin{equation} \label{Fxududdu=0}
F(x, u(x), Du(x), D^2u(x)) = 0, \quad x \in X.
\end{equation} 
A classical \emph{subsolution} of (\ref{Fxududdu=0}) is a function $u\in C^2(X)$ which satisfies
\begin{equation} \label{Fxududdu>0}
F(x, u(x), Du(x), D^2u(x)) \geq 0 \quad \forall x \in X.
\end{equation}
The inequality \eqref{Fxududdu>0} identifies a closed subset $\call F \subset \call J^2(X) = X \times \R \times \R^n \times \call S(n))$,\footnote{Note that in fact this Cartesian product represents for us the bundle $\call J^2(X)$ of the $2$-jets of functions on $X$; indeed, for a Riemannian $m$-dimensional manifold $M$ one has the following isomorphism for the bundle of the $2$-jets of functions on $M$:
\[
\call J^2(M) \simeq M\times \R \underset{M}{\oplus} T^*M \underset{M}{\oplus} \call S(T^*M),
\]
where $\call S(T^*M)$ denotes the space of all symmetric $(0,2)$-tensor fields on $M$.}
\begin{equation}\label{compatibility}
\call F := \{(x,p,r,A) \in \call J^2(X) : F(x, r, p, A) \geq 0 \},
\end{equation}
which is a natural constraint set associated to classical subharmonics where one says that $u \in C^2(X)$ is \emph{$\call F$-subharmonic on $X$} if 
\begin{equation}\label{C2FSH}
J^2_x u \defeq (u(x), Du(x), D^2u(x))\in \call F_x \qquad \forall x \in X,
\end{equation}
where
\[
\call F_x \defeq \left\{(r,p,A)\in \R \times \R^n \times \call S(n):\ (x,r,p,A) \in \call F \right\}
\] 
is the fiber of $\call F$ over $x$. One extends the notions of subsolutions and subharmonics to upper semicontinuous functions by using a pointwise viscosity formulation in terms of $2$-jets of spaces of upper contact test functions; that is, spaces of upper contact jets. Under minimal conditions on $\call F$, there are many equivalent formulations as will be discussed below in Remark \ref{rem:equiv_FSH}. 

\begin{definition}\label{defn:FSH} Given a function $u\in\USC(X)$:
	\begin{itemize}
		\item[(a)] a function $\varphi$ which is $C^2$ near $x \in X$ is said to be a {\em $C^2$ upper test function for $u$ at $x$} if
		\begin{equation}\label{TF}
		u-\varphi \leq \ 0  \ \ \text{near}\ x \ \ \ \text{and} \ \ \  
		u-\varphi = 0  \ \ \text{at} \ x;  
		\end{equation}	
		\item[(b)] the function $u$ is said to be {\em $\call F$-subharmonic at $x$} if \begin{equation}\label{FSubx}
		\mbox{$J^2_{x} \varphi \in \call F_x$ for all $C^2$ upper test functions $\varphi$ for $u$ at $x$};
		\end{equation} 
		\item[(c)] the function $u$ is said to be {\em $\call F$-subharmonic on $X$} if $u$ is $\call F$-subharmonic at each $x \in X$. 
	\end{itemize} 
	
	The space of all $\call F$-subharmonic functions on $X$ will be denoted by $\call F(X)$.
\end{definition}

The corresponding (and standard) notion of $u\in\USC(X)$ being a {\em viscosity subsolution of the PDE \eqref{Fxududdu=0} in $x \in X$} is that
\begin{equation}\label{Vsubx}
	F(x, J^2_{x} \varphi) \geq 0 \quad \text{for all upper $C^2$ test functions $\varphi$ for $u$ at $x$}.
\end{equation}
The analogous notion of $u\in\LSC(X)$ being a {\em viscosity supersolution of the PDE \eqref{Fxududdu=0} in $x \in X$} is that
\begin{equation}\label{Vsuperx}
F(x, J^2_{x} \varphi) \leq 0 \quad \text{for all lower $C^2$ test functions $\varphi$ for $u$ at $x$},
\end{equation}
where one merely inverts the inequalities in \eqref{TF} and \eqref{Vsubx}. 

In the case that a constraint $\call F \subset \call J^2(X)$ is determined by a differential operator $F \in C(\call J^2(X))$ by \eqref{compatibility}, the definition of supersolution \eqref{Vsuperx} suggests defining $u \in \LSC(X)$ to be {\em $\call F$-superharmonic in $x \in X$} if
\begin{equation}\label{FSuperx}
\mbox{$J^2_{x} \varphi \not\in \intr \call F_x$ for all $C^2$ lower test functions $\varphi$ for $u$ at $x$.}
\end{equation}
Finally, a function $u \in C(X)$ is said to be {\em $\call F$-harmonic in $x \in X$} if both \eqref{FSubx} and \eqref{FSuperx} hold. In the next section, we will use a natural notion of {\em duality} to reduce superharmonics to subharmonics of a dual constraint set. 

 \begin{remark}[Weak ellipticity]\label{rem:weakly_elliptic} 
In order to be meaningful, the viscosity formulation of $\call F$-subharmonic functions of Definition~\ref{defn:FSH} requires making a monotonicity assumption on the constraint set $\call F$ with respect to the $\call S(n)$ variable. More precisely one needs to assume that a constraint set $\call F$ fiberwise satisfies the {\em positivity}  property:
\begin{equation}\label{property_P}
\text{for each $x \in X$:} \quad (r,p,A) \in \call F_x \implies (r,p,A+P) \in \call F_x \quad \forall P \geq 0 \ \text{in} \ \call S(n).
\end{equation}
Indeed, if \eqref{property_P} fails then there exist $x_0 \in X$ and $P_0 > 0$ such that
\begin{equation}\label{P1}
\mbox{$(r,p,A) \in \call F_{x_0}$ \quad but \quad $(r,p,A + P_0) \not\in \call F_{x_0}$.}
\end{equation}
Let $u \in \call F(X)$ with $u(x_0) \neq -\infty$ and suppose that $\varphi$ is an upper test function for $u$ at $x_0$. Since $u$ is $\call F$-subharmonic in $x_0$ we have $(r,p,A):= J^2_{x_0} \varphi \in \call F_{x_0}$ but the function 
$$
	\psi:= \varphi + \frac{1}{2} \langle P_0(x - x_0), x - x_0 \rangle
	$$
is also an upper test function for $u$ at $x_0$ but, by \eqref{P1}, satisfies
$$
J^2_{x_0} \psi = J^2_{x_0} \varphi + P_0 \not\in \call F_{x_0},
$$
which contradicts $u$ being $\call F$-subharmonic in $x_0$. 

When $\call F$ is {\em compatibile} with an operator $F \in C(\call J^2(X))$ in the sense that
\begin{equation}\label{compatible}
\call F = \{(x,r,p,A) \in \call J^2(X): \ F(x,r,p,A) \geq 0\},
\end{equation}
positivity of $\call F$ is implied by $F$ being {\em degenerate ellipitc} 
\begin{equation}\label{deg_ell}
(r,p,A) \in \call F_x \implies (r,p,A+P) \in \call F_x \quad \forall P> 0,
\end{equation}
while positivity of $\call F$ implies that $F$ satisfies $F(x,r,p,A+P)\geq 0$ for all $P\geq 0$ if $F(x,r,p,A)\geq 0$. 

This monotonicity (\eqref{property_P} or \eqref{deg_ell}) should be viewed as the weakest possible notion of ellipticity suitable for a meaningful viscosity theory in both contexts.
 	\end{remark}
 
A widely used consequence of the positivity condition \eqref{property_P} should be noted. 

\begin{remark}[Positivity and coherence]\label{rem:coherence}
Of fundamental importance in many constructions is to have the following \emph{coherence property} for $\call F$-subharmonics in the sense of Definition \ref{defn:FSH} with $\call F \neq \emptyset$: if $u$ is $C^2$ near $x_0 \in X$ then
\begin{equation}\label{coherence}
\mbox{$u$ is $\call F$-subharmonic at $x_0 \ \Leftrightarrow \ J^2_{x_0}u \in \call F_{x_0}$.}
\end{equation}
The implication $(\Rightarrow)$ is obvious since $u$ is its own upper test function in $x_0$. The reverve implication $(\Leftarrow)$ requires the positivity condition \eqref{property_P}. Indeed, suppose that $J^2_{x_0}u \in \call F_{x_0}$ and that $\varphi$ is $C^2$ upper test function for $u$ in $x_0$. Since $u - \varphi$ has a local maximum value of $0$ in $x_0$, by elementary calculus, one has
$$
	\varphi(x_0) = u(x_0), D\varphi(x_0) = Du(x_0), \text{and} \ D^2\varphi(x_0) \geq Du(x_0),
$$
and denoting by $P:= D^2\varphi(x_0) - Du(x_0) \geq 0$ in $\call S(n)$ and hence
$$
J^2_{x_0} \varphi = J^2_{x_0} u + P \quad \text{with} \ P \geq 0,
$$
which yields $J^2_{x_0} \varphi \in \call F_{x_0}$ if and only if the positivity property \eqref{property_P} holds.
\end{remark}
The same equivalence holds if $u$ is merely twice differentiable in $x_0$ by using the {\em little-o} formulation of upper test jets and second order Taylor expansions, provided that the fibers $\call F_x$ are closed. See Proposition \ref{elemprop} (iii).

\begin{remark}[Equivalent notions of $\call F$-subharmonicity]\label{rem:equiv_FSH} In the notation of Remark~\ref{rem:UCJ}, Definition~\ref{defn:FSH} says that
\begin{equation}\label{equiv1}
\mbox{$u$ is $\call F$-subharmonic in $x \ \Leftrightarrow \ (u(x), p, A) \subset \call F_x \quad  \forall \, (p,A) \in J_{C^2}(x,u)$,}
\end{equation}
where $J_{C^2}(x,u)$ is the space of $C^2$ upper contact jets for $u$ in $x$ ($(p,A) = (D \varphi(x), D^2 \varphi(x)$ with $\varphi$ a $C^2$ upper contact function for $u$ in $x$). As noted in Remark \ref{rem:UCJ}, in the chain of inclusions \eqref{inclusionsformulations}
\begin{equation}\label{equiv2}
J_S(x,u) \subset J_s(x,u) \subset J_Q(x,u) \subset J_{C^2}(x,u) \subset J_o(x,u),
\end{equation}
\cite[Lemma C.1]{chlp} shows that all of these spaces have the same closure in $\call J^2$ for each $x \in X$. Hence, if 
\begin{equation}\label{equiv3}
\mbox{the fiber $\call F_x$ is closed in $\call J^2$},
\end{equation}
then in \eqref{equiv1} one can replace the space of upper contact jets $J_{C^2}(x,u)$ with any of the others in the chain \eqref{equiv2}. Moreover, if 
\begin{equation}\label{equiv4}
\mbox{$\call F$ is closed in $\call J^2(X)$,}
\end{equation} 
then one can also replace $J_{C^2}(x,u)$ with a limiting space $\overline{J}_{C^2}(x,u)$ consisting of those $(p,A) \in \R^n \times \call S(n)$ for which there are sequences $\{x_k\}_{k \in \N} \subset X$ and $(p_k, A_k\}_{k \in \N} \subset J_{C^2}(x,u)$ for which
$$
(x_k, u(x_k),p_k,A_k) \to (x, u(x), p, A)) \quad \text{as $k \to + \infty$},
$$
and simarly for the closures of the other spaces of upper test jets. 
\end{remark}


The considerations above lead us to a first class of constraint sets $\call F$ which have a meaningful and flexible notion of upper semicontinuous $\call F$-subharmonic functions.

\begin{definition}\label{defn_prim_subeq}
	A subset $\call F \subset \call J^2(X)$ with $X$ open is called a \emph{primitive subequation (constraint set)} if
	\begin{equation} \tag{C} \label{(C)}
	\mbox{$\call F$ is closed in $\call J^2(X)$,}
	\end{equation}
	and $\call F$ satisfies fiberwise the \emph{positivity} condition:
	\begin{equation} \tag{P} \label{(P)}
	\text{for each $x \in X$:} \quad (r,p,A) \in \call F_x \implies (r,p,A+P) \in \call F_x \quad \forall P> 0.
	\end{equation}
\end{definition}

As noted in Remarks \ref{rem:weakly_elliptic} and \ref{rem:coherence}, the positivity condition (P) is essential for a meaningful notion of upper semicontinuous $\call F$-subharmonics and in order to have $C^2$-coherence, while the closedness condition (C) ensures the equivalent formulations of Remark \ref{rem:equiv_FSH}. Condition (C) also ensures that the elementary properties of $\call F(X)$ involving limits and upper envelopes hold (see \cite[Theorem~2.6]{hldir}; the same properties are also listed, for nonconstant coefficient subequations, in \Cref{elemprop}).

The two minimal conditions (C) and (P), however, are not sufficient for all of our purposes. First, as already mentioned, in order to treat the natural Dirichlet problem for $\call F$-harmonic functions, we will need to prove {\em comparison}; that is, to show that
\begin{equation}\label{intro_CP}
u\leq v\ \text{on $\de X$} \implies u\leq v\ \text{on $X$}
\end{equation}
whenever $u$ and $v$ are $\call F$-subharmonic and $\call F$-superharmonic respectively (or a sub/super-solution pair for a degenerate elliptic PDE). In order to avoid obvious counterexamples to comparison \eqref{intro_CP}, one needs to require that $\call F$ has another fiberwise monotonicity property with respect to $\R$ variable: that is, that $\call F$ satisfies the \emph{negativity} property
\begin{equation} \tag{N} \label{(N)}
\mbox{ for each $x \in X: \quad (r,p,A) \in \call F_x \implies (r+s, p, A) \in \call F_x \quad \forall s < 0$.}
\end{equation}
The simplest counterexample is the following.
\begin{example}
Consider, for $n=1$, the ordinary differential equation $u''+u = 0$ on $\R$, that is $F(u, u'') = 0$, with $F(r,A) = A+ r$. It is clear that the associated $\call F$ does not satisfy \eqref{(N)} and comparison does not hold on arbitrary bounded domains, but only on intervals of length less than $\pi$.
\end{example}

Property (N) will have additional implications and utility, including the fact that it guarantees a \emph{sliding property} for subharmonics: if $u$ is a subharmonic, then so is $u-m$ for each constant $m \geq 0$. Indeed, if $(p,A)$ is an upper contact jet for $u$ at $x$, so it will be for $u-m$. This sliding property will play a key role in some upcoming constructions and is included, along with many elementary properties mentioned above, in \Cref{elemprop}. Hence, in general, one also wants property (N) for a constraint set $\call F$. There are important exceptions to this, including when treating {\em generalized principal eigenvalues} and associated eigendirections where typically one has the opposite monotonicity in the $r$ variable (see \cite{BP21}, for example.)


\begin{remark}[Proper ellipticity]\label{rem:PE}  The combined monotonicity properties of positivity (P) and negativity (N) for a constraint $\call F$ determined by an operator $F$ with fibers
\[
\call F_x \defeq \left\{(r,p,A) \in \call J^2:\ F(x,r,p,A) \geq 0\right\}
\]
is implied by the operator $F$ being \emph{proper elliptic}\footnote{In the standard viscosity theory, $F$ is often said to be merely {\em proper}. We prefer the term proper elliptic to recall the crucial importance of weak (degenerate) ellipticity required for the viscosity theory}; that is, for each $(x,r,p,A) \in \call J^2(X)$
\begin{equation} 
F(x,r+s,p,A)+P) \geq F(x,r,p,A) \quad  \forall \,  s \leq 0 \ \text{in} \ \R, P \geq 0 \ \text{in} \ \call S(n).
\end{equation}

\end{remark}

Two final considerations are needed before arriving at the desired class of constraint sets.

\begin{remark}[Proper fibers and topological stability]\label{rem:T}
Note that if some fiber $\call F_x$ of a constraint set were to be empty, then $X$ might not admit an $\call F$-subharmonic. To see this, the same argument we used at the beginning of the proof of \Cref{p:uvm} shows that the space of upper quadratic test jets $J^{2,+}_xu$ for $u$ at $x$ is non empty for some $x \in X$ and hence for each $(p,A) \in J^{2,+}_xu$ the condition $(u(x), p, A) \in \call F_x$ fails if $\call F_x$ is empty.

Moreover, if some fiber $\call F_x$ were to be equal to the entire space of $2$-jets $\call J^2$, the property of being $\call F$-subharmonic in $x$ is satisfied by all functions with are upper semicontinuous in some neighborhood of $x$. Hence one should consider only constraint sets $\call F$ such that 
$$
\mbox{for each $x \in X: \quad \call F_x$ is closed, non empty with $\call F_x \neq \call J^2$.}
$$

Finally, one obtains a well behaved and useful theory of constraint sets $\widetilde{\call F}$ which are {\em dual} to a given constraint set $\call F$ {provided} that one also assumes the three conditions of {\em topological stability}
\begin{equation} \tag{T} \label{(T)}
\call F = \barr{\intr{\call F}}, \qquad (\intr{\call F})_x = \intr(\call F_x), \ \forall \, x \in X \qquad \call F_x = \barr{\intr{\call F}_x}, \ \forall \, x \in X .
\end{equation} 
Notice that the first condition above implies the closedness condition (C) and the third condition above implies that all fibers are closed.
\end{remark}

The desired class of constraint sets $\call F$ with a robust associated potential theory is now at hand.

\begin{definition} \label{defnsubeq}
	A {\em subequation (constraint set)} on an open set $X \subset \R^n$ is subset $\call F \subset $ with nontrivial fibers (that is, proper and nonempty fibers) which satisfies the {\em positivity property}
		\begin{equation} \tag{P} \label{(P)}
	\text{for each $x \in X$:} \quad (r,p,A) \in \call F_x \implies (r,p,A+P) \in \call F_x \quad \forall P> 0.
	\end{equation}
	the {\em negativity property}
	\begin{equation} \tag{N} \label{(N)}
	\mbox{ for each $x \in X: \quad (r,p,A) \in \call F_x \implies (r+s, p, A) \in \call F_x \quad \forall s < 0$.}
	\end{equation}
	and the {\em topological property}
\begin{equation} \tag{T} \label{(T)}
\call F = \barr{\intr{\call F}}, \qquad (\intr{\call F})_x = \intr(\call F_x), \ \forall \, x \in X \qquad \call F_x = \barr{\intr{\call F}_x}, \ \forall \, x \in X .
\end{equation}
\end{definition}



In addition to ensuring a well-behaved duality including the {\em reflexivity} property $\widetilde{\widetilde{\call F}} = \call F$, property (T) also ensures the \emph{local existence of strict classical subharmonics}, when we adopt the following notion of strictness.

\begin{definition} \label{def:strict}
	A function $u\in C^2(X)$ is said to be \emph{strictly} $\call F$-subharmonic at $x$ if
	\[
	 J^2_x u \in \intr{\call F}_x
	\]
 \emph{strictly} $\call F$-subharmonic on $X$ if this inclusion holds for each $x \in X$.
\end{definition}

\begin{remark}[Local existence of strict classical subharmonics] \label{exquadsub}
	Using the topological condition \eqref{(T)}, one can prove that for each $x \in X$  there exists a quadratic function which is strictly $\call F$-subharmonic on a neighborhood of $x$. Indeed, by \eqref{(T)} we know that $\intr{\call F}_x \neq \emptyset$ for all $x \in X$; hence, let $J = (r, p, A) \in \intr{\call F}_x$ and consider the quadratic function $\phi_{J}$ associated to $J$, namely
	\[
	%\phi_{J} = r + \pair{p}{\cdot -\, x} + \tfrac12 \pair{A(\cdot -\, x)}{\cdot -\, x},
	\phi_{J} = r + \pair{p}{\cdot -\, x} + Q_A(\,\cdot - x),
	\]
	so that $J^2_x \phi_J= J$. Since $\phi_J$ is $C^2$ and $(x, J) \in \intr{\call F}$, we have that $J^2_y \phi_J \in \intr{\call F}_y$ for all $y$ in some neighborhood $U$ of $x$, hence $\phi_J \in \call F(U)$.
\end{remark}

Two interesting remarks that one finds in \cite{hlae} are worth noting. They play an important role in the {\em Almost Everywhere Theorem} (cf.\ \Cref{aet}).

\begin{remark}\label{subinclusion}
The notion of being $\call F$-subharmonic can be expressed in terms of an inclusion between subequations. Indeed, each upper semicontinuous function $w$ on $X$ determines a minimal primitive subequation $\call G$ such that $w$ is $\call G$-subharmonic, namely $\call G=\barr{\call J^{2,+}w}$, where 
\begin{equation}\label{J2+w}
	\call J^{2,+}w:= \{ (x,w(x),p,A): \ x \in X, (p,A) \in J^{2,+}_xw \}
\end{equation}
Therefore $w$ is $\call F$-subharmonic if and only if $\call J^{2,+}w \subset \call F$, if and only if $\call G \subset \call F$ since $\call F$ is closed.
\end{remark}


\begin{remark} \label{ae?}
Note that we already found a subset which surely contains $\call J^{2,+}w$. Indeed, if we set 
\begin{equation}\label{JwE}
\call J(w,E) \defeq \big\{ (x, w(x), Dw(x), D^2w(x) + P):\ x \in E \cap \Diff^2(w),\ P \geq 0 \big\},
\end{equation}
then \Cref{pusc} says that if $w$ is locally quasi-convex and $E$ has full measure, then $\call J^{2,+}w \subset \barr{\call J(w,E)}$.
\end{remark}

We conclude this section with a brief discussion of an important class of subequations that has been extensively studied in the monograph \cite{chlp}. 

\begin{definition}
A (primitive) subequation $\call F$ is said a \emph{constant coefficient}, or \emph{translation invariant}, (primitive) subequation if the mapping $x \mapsto \call F_x$ is constant, that is if the fibers do not depend on the point $x$.
\end{definition}

\begin{remark} \label{rmkccs}
Since our definition of subequation requires that all the fibers are nontrivial, it is important to specify the open set $X$ on which we are considering a subequation $\call F$. Nevertheless, if $\call F$ is a constant coefficient subequation on $X$, it can be naturally extended to the whole $\R^n$ by setting, for some $x_0 \in X$ fixed, $\call F_y = \call F_{x_0}$ for all $y \in \R^n$. Hence any constant coefficient subequation can be thought of as defined on all of $\R^n$ and hence identify them with a nontrivial subset of $\call J^2 \defeq \R \times \R^n \times \call S(n)$ that satisfies the conditions \eqref{(P)}, \eqref{(N)} and \eqref{(T)}). Notice that in this case, the property (T) reduces to the single condition $\call F = \overline{\intr \call F}$ in $\call J^2$. Obviously, when speaking about $\call F$-subharmonics/superharmonics/harmonics, we must specify on which open set $X$ we are working. 
\end{remark}

Finally, we present a few representative examples of constant coefficient subequations on an arbitrary open set $X$ in $\R^n$, starting from the classical case of (Laplacian) subharmonics.

\begin{example}[The Laplacian subequation]\label{exe:Delta} The {\em Laplacian subequation} is $\call F = X \times \call F_{\Delta}$ where
	$$
\call	F_{\Delta}:= \{(r,p,A) \in \call J^2: \ {\rm tr}(A) \geq 0\}
	$$
and its subarmonics are characterterized by 
\begin{equation}\label{Subharmonic_Delta}
\mbox{$\displaystyle{u \in \call F(X) \ \Leftrightarrow \ u(x_0) \leq \frac{1}{|B_{\rho}(x_0)|} \int_{B_{\rho}(x_0)} u(x) \, dx}$ for each $B_{\rho}(x_0) \Subset X$.}
\end{equation}
This subsequation is {\em self-dual} $\widetilde{\call F} = \call F$ in terms of the duality operation recalled in the following section.
	\end{example}

\begin{example}[The convexity subequation]\label{exe:P} The {\em convexity subequation} is $\call F := X \times \call M(\call P)$ where
	$$
	\call M(\call P) := \R \times \R^n \times \call P:= \{(r,p,A) \in \call J^2: \ A \geq 0 \} 
	$$
	and its subarmonics are characterterized by 
	\begin{equation}\label{Subharmonic_P}
 \mbox{$u \in \call F (X) \ \Leftrightarrow \ u$ is convex} 
	\end{equation}
	(away from the connected components on which $u \equiv - \infty$). The subharmonics of the dual subequation are the so-called {\em subaffine} functions (they satisfy the comparison principle with respect to all affine functions).
	
	This example is the most basic example of a {\em monotonicity cone subequation} (a subequation which is also a closed convex cone with vertex at the origin) as will be discussed in the following section. This particular cone is used in the proof of the comparison principle for all pure second order subequations and degenerate elliptic PDEs, as will be discussed in Section~\ref{sec:comp}. A {\em fundamental family} of such cones can be found in Chapter 5 of \cite{chlp}.
\end{example}

Related examples are fundamental to our discussion.

\begin{example}[Quasi-convex functions]\label{exe:qc} For $\lambda >  0$, The {\em $\lambda$-quasi-convexity subequation} is  $\call F_{\lambda} := X \times \call M(\call P_{\lambda})$ where
	$$
	\call M(\call P_{\lambda}) := \R \times \R^n \times \call P_{\lambda}:= \{(r,p,A) \in \call J^2: \ A + \lambda I \geq 0 \} 
	$$
	and its subarmonics are characterterized by 
	\begin{equation}\label{Subharmonic_qc}
	\mbox{$u \in \call F_{\lambda} (X) \ \Leftrightarrow \ u$ is $\lambda$-quasi-convex} 
	\end{equation}
	(away from the connected components on which $u \equiv  -\infty$). 
	
	Moreover, it is clear that the notion of being $\call F$-subharmonic is local since the notion of upper contact jet is local (see Proposition \ref{elemprop}(i)). Hence one can characterize the space $\mathsf{qc}_\text{loc}(X)$ of {\em locally quasi-convex functions on $X$} as those $u \in \USC(X)$ such that
	\begin{equation}\label{qc_loc}
	\text{for each} \ x_0 \in X \ \text{there exist} \ \rho_0 > 0 \ \text{and} \ \lambda_0 > 0 \ \text{such that} \ u \in \call F_{\lambda_0}(B_{\rho_0}(x_0)).
	\end{equation}
\end{example}

\section{Duality and monotonicity} \label{sec:duality}

This section is dedicated to two fundamental notions in general second order potential theories. Duality is reviewed first with its important consequence of reformulating $\call F$-superharmonics as subharmonics for a dual subequation $\widetilde{\call F}$. Next, the unifying notion of monotonicity is reviewed. Together, they give rise to the {\em duality-monotonicity} method for proving the validity of the comparison principle, which is a key ingredient in the treatment of uniqueness and uniqueness of solutions to the Dirichlet problem for $\call F$-harmonic functions. 

A subequation $\call F$ naturally gives rise to a dual subequation $\widetilde{\call F}$, which will play a crucial role in all that follows. Consider the following notion of duality, introduced by Harvey and Lawson~\cite{hldir09, hldir} and is defined in a purely set-theoretic way.

\begin{definition} \label{def:dual}
Given a proper subset $\call F \subset \call J^2(X)$, we define its \emph{Dirichlet dual}
\[
\tildee{\call F} \defeq  (-\intr{\call F})\compl = - (\intr{\call F})\compl,
\]
where the complement is relative to $\call J^2(X)$.
\end{definition}

It turns out that if $\call F$ is a subequation, then $\tildee{\call F}$ is a subequation as well; this is a consequence of the following proposition, which collects some elementary properties of the Dirichlet dual. These properties are to be found in \cite[Section 4]{hldir09} in a pure second-order context and in \cite[Section 3]{hldir} for subequations on Riemannian manifolds, as well as  in \cite[Proposition~3.2]{chlp} for constant coefficient subequations;  we essentially reproduce the proof of this last proposition, in order to point out that it works fine also if one has nonconstant coefficients. This happens because of a consequence of the topological condition \eqref{(T)}, as noted in \cite{hldir}. More precisely, if we define the dual of the fiber $\call F_x \subset \R \times \R^n \times \call S(n)$ relative to the ambient space $\R \times \R^n \times \call S(n)$, one can compute the dual of $\call F$ fiberwise; that is,
\[
\tildee{\call F} = \bigsqcup_{x\in X}  (-\intr{\call F}_x)\compl,
\]
where the complement is relative to $\R \times \R^n \times \call S(n)$, so there is no ambiguity in the notation $\tildee{\call F}_x$.

\begin{prop} \label{propdual}
Let $\call F$ and $\call G$ be proper subsets of $\call J^2(X)$ and let $J \in \R \times \R^n \times \call S(n)$. Then the following hold:
\begin{enumerate}[label={\it(\arabic*)}, topsep=7pt, itemsep=4pt, partopsep=1.1pt, parsep=1.1pt]
\item\ $\call F_x \subset \call G_x \implies \tildee{\call G}_x \subset \tildee{\call F}_x$;
\item\ $\call F_x + J \subset \call F_x \implies \tildee{\call F}_x + J \subset \tildee{\call F}_x$;
\item\ $\tildee{\call F_x + J} = \tildee{\call F}_x - J$;
\item\ $\call F$ satisfies \eqref{(P)} $\implies$ $\tildee{\call F}$ satisfies \eqref{(P)};
\item\ $\call F$ satisfies \eqref{(N)} $\implies$ $\tildee{\call F}$ satisfies \eqref{(N)};
\item\ $\call F =\barr{\intr{\call F}}$ $\iff$ $\tildee{\tildee{\call F}} = \call F$;
\item\ $\call F$ satisfies \eqref{(T)} $\implies$ $\tildee{\call F}$ satisfies \eqref{(T)};
\item\ $\call F$ is a subequation $\implies$ $\tildee{\call F}$ is a subequation.
\end{enumerate}
\end{prop}

\begin{proof}
Properties~\emph{(4)} and~\emph{(5)} follow from~\emph{(2)}, and property~\emph{(8)} follows from properties~\emph{(4)}, \emph{(5)} and~\emph{(7)}. 
Property~\emph{(1)} follows from \Cref{def:dual}. 
For property~\emph{(2)}, note that $\call F_x + J \subset \call F_x$ implies that $\intr{\call F}_x + J$ is an open subset of $\call F$, hence $\intr{\call F}_x + J \subset \intr{\call F}_x$, which yields, taking the complements, $\tildee{\call F}_x \subset \tildee{\call F}_x -J$, as desired. 
Similarly, since $\intr{\call F}_x + J$ is the interior of $\call F_x + J$, we have $\tildee{\call F_x + J} = \tildee{\call F}_x - J$, which is property \emph{(3)}.
Note now that by \Cref{def:dual}
\begin{equation} \label{bidual}
\tildee{\tildee{\call F}} = \big(\intr\big((\intr\call F)\compl\big)\big)\compl;
\end{equation}
since for any subset $\call S \subset \call J^2(X)$ one has $\intr{\call S} = {\barr{\call S\compl}}\compl$, equality~(\ref{bidual}) yields $\tildee{\tildee{\call F}} = \barr{\intr{\call F}}$.
This proves property \emph{(6)}.
Similarly, if $\call F$ satisfies \eqref{(T)}, consider the following chain of equalities:
\[
\barr{\intr{\tildee{\call F}}} = \barr{{\barr{\tildee{\call F}\,{\vphantom{I}}\compl}\,}\compl} = \barr{{\barr{ - \intr{\call F}}\,}\compl} = \barr{ - \call F\compl} = (-\intr{\call F})\compl = \tildee{\call F}.
\]
This shows the first and the last of the three conditions in \eqref{(T)}, since it also holds with $\call F_x$ instead of $\call F$. Furthermore, we also read in it that
\[
(\intr{\tildee{\call F}})_x = -( \call F\,\compl)_x =  - (\call F_x)\compl= \intr(\tildee{\call F}_x)
\]
and hence the second condition is satisfied, thus proving property {\em(7)}.
\end{proof}

\begin{remark} \label{invert}
Property \emph{(6)} is the aforementioned \emph{reflexivity} of $\call F$, which together with property \emph{(8)} shows that the $\sim$ operation gives a true duality.  Note also that this implies that we can reverse all the implications in \Cref{propdual}.
\end{remark}

By making use of duality, we can reformulate the notions of being $\call F$-subharmonic and $\call F$-harmonic, which we record in the following observation.

\begin{remark}[{$\call F$-superharmonics by duality}] 
For $v\in \LSC(X)$, one can define $v$ to be $\call F$-superharmonic on $X$ if  $-v$ is $\tildee{\call F}$-subharmonic on $X$. This is equivalent to \ref{FSuperx}; indeed, the condition $(v(x), q, B) \notin \intr{\call F}_x$ for each $(q,B) \in J^{2,-}_x v$ is equivalent to $(-v(x), p, A) \notin -\intr{\call F}_x$ for each $(p,A) = (-q,-B) \in J^{2,+}_x (-v)$, since it is immediate to see (cf.\ \Cref{def:ucp}) that $- J^{2,-}_x v = J^{2,+}_x (-v)$. This means that $v$ is $\call F$-superharmonic at $x$ if and only if $-v$ is $\tildee{\call F}$-subharmonic at $x$, because 
\[
(-v(x), p, A) \notin -\intr{\call F}_x \iff (-v(x), p, A) \in \tildee{\call F}_x,
\]
by the definition on the dual of $\call F$.

Finally, this yields the following equivalent definition of viscosity solution: a function $u\in C(X)$ is \emph{$\call F$-harmonic on $X$} if and only if  $u\in \call F(X)$ and $-u\in\tildee{\call F}(X)$.
\end{remark}

We now turn to the notion of monotonicity. This fundamental notion appears in various guises. It is a useful and unifying concept. One says that a subequation $\call F$ is {\em $\call M$-monotone} for some subset $\call M \subset \call J^2(X)$ if 
\begin{equation}\label{monotone}
\call F_x + \call M_x \subset \call F_x \ \ \text{for each} \  x \in X.
\end{equation}
For simplicity, we will restrict attention to (constant coefficient) {\em monotonicity cones}; that is, monotonicity sets $\call M$ for $\call F$ which have constant fibers which are closed cones with vertex at the origin. 

First and foremost, the properties (P) and (N) are monotonicity properties. As noted previously, property (P) for subequations $\call F$ corresponds to {\em degenerate elliptic} operators $F$ and properties (P) and (N) together correspond to {\em proper elliptic} operators. Properties (P) plus (N) can be expressed as the single monotonicity property 
\begin{equation}\label{MM}
\call F_x + \call M_0 \subset \call F_x   \ \ \text{for each} \ x \in X
\end{equation}
where
\begin{equation}\label{MMC}
\call M_0 := \call N \times \{0\} \times \call P \subset \call J^2 = \R \times \R^n \times \call S(n)
\end{equation}
with
\begin{equation}\label{NP}
\call N := \{ r \in \R : \ r \leq 0 \} \quad \text{and} \quad  \call P := \{ P \in \call S(n) : \ P \geq 0 \} .
\end{equation}
Hence $\call M_0$ will be referred to as the {\em minimal monotonicity cone} in $\call J^2$. However,  it is important to remember that $\call M_0 \subset \call J^2$ is {\bf not} a subequation since it has empty interior so that property (T) fails. 

Monotonicity is also used to formulate {\em reductions} when certain jet variables are ``silent'' in the subequation constraint $ \call F$. See section 2.2 of \cite{hpsurvey} for details. 

Most importantly, monotonicity when combined with duality and {\em fiberegularity} in the variable coefficient case (the natural continuity of the fiber map $x \mapsto \call F_x$)), yields has a very general, flexible and elegant geometrical approach to comparison when a subequation $\call F$ admits a constant coefficient monotonicity cone subequation $\call M$. This will be described section \ref{sec:comp}.


\section{Basic tools in nonlinear potential theory} \label{bastool}

In this section, we introduce various results that are included in the ``basic tool kit of viscosity solution techniques'' in \cite{chlp}: the Bad Test Jet \Cref{l:btj}, the Definitional Comparison \Cref{defcompa} and \Cref{elemprop} which gathers various widely used constructions of $\call F$-harmarmonics obatined by alegebraic opertions, optimization procedures and limits. 
We begin with the first tool which is very useful when one seeks to check the validity of subharmonicity at a point by a contradiction argument. More precisely, if $u$ fails to be subharmonic at a given point, then one must have the existence of a \emph{bad test jet} at that point, as stated in the following lemma. This criterion is essentially the contrapositive of the definition of viscosity subsolution, when one takes \emph{strict} upper contact quadratic functions as upper test functions (see \cite[Lemma 2.8 and Lemma C.1]{chlp}). Nevertheless, for the benefit of the reader, we provide a brief proof based on \Cref{defn:FSH} ($\call F$-subharmonics). 

\begin{lem}[Bad Test Jet Lemma] \label{l:btj}
Given $u \in \USC(X)$, $x \in X$ and $\call F_x \neq \emptyset$, suppose $u$ is not $\call F$-subharmonic at $x$. Then there exists $\epsilon > 0$ and a $2$-jet $J \notin \call F_x$ such that the (unique) quadratic function $\phi_J$ with $J^2_x\phi_J = J$ is an upper test function for $u$ at $x$ in the following $\epsilon$-strict sense:
\begin{equation} \label{btj:i}
u(y) - \phi_J(y) \leq -\epsilon|y-x|^2 \quad \text{$\forall y$ near $x$ (with equality at $x$)}.
\end{equation}
\end{lem}

\begin{proof}
If $u$ fails to be $\call F$-subharmonic at $x$, then according to \Cref{defn:FSH} there exists an upper test function $\varphi$ for $u$ at $x$ such that
$$
	J: = J^2 \varphi_x \not\in \call F_x
$$
Since the complement of $\call F_{x}$ (with respect to $\R \times \R^n \times \call S(n)$) is open, we have that $J'\defeq J+(0,0, 2\epsilon I) \notin \call F_{x}$ for $\epsilon$ small. Also, $J'$ is a quadratic upper test jet for $u$ in $x$ by \Cref{def:ucp}; that is, if $(p,A)$ is an upper contact jet for $u$ at $x$, so is $(p, A+\eta I)$ for any $\eta > 0$. This means that 
\[
u(y) \leq \phi_{J'}(y) \quad \text{$\forall y$ near $x$ (with equality at $x$)},
\]
but $\phi_{J'} = \phi_J - \epsilon|\cdot - \,x|^2$, hence (\ref{btj:i}) follows.
\end{proof}

The second tool is a \emph{comparison principle} whose validity characterizes the $\call F$-subharmonic functions for a given subequation $\call F$. We begin by recalling two equivalent forms of potential theoretic comparison which will play an important role in all of our proofs of comparison principles.

Given a subequation $\call F$, we say that \emph{comparison holds for $\call F$ on a domain $\Omega \subset \R^n$} if
\begin{equation} \tag{CP}
u \leq w\ \text{on $\de\Omega$} \implies u\leq w\ \text{on $\Omega$}
\end{equation}
for all $u\in \USC(\barr \Omega)$, $w \in \LSC(\barr \Omega)$ which are $\call F$-subharmonic, $\call F$-superharmonic on $\Omega$, respectively. Making use of the duality reformulation with $v \defeq -w$, comparison (CP) is equivalent to
\begin{equation} \tag{CP$'$}
u +v\leq 0\ \text{on $\de\Omega$} \implies u+v\leq 0\ \text{on $\Omega$}
\end{equation}
for all $u,v \in \USC(\barr\Omega)$ which are, respectively, $\call F$-, $\tildee{\call F}$-subharmonic on $\Omega$.
This in turn is equivalent to the following \emph{zero maximum principle}:
\begin{equation} \tag{ZMP}
z \leq 0\ \text{on $\de\Omega$} \implies z\leq 0\ \text{on $\Omega$}
\end{equation}
for all $z \in \USC(\barr \Omega) \cap \big(\call F(\Omega) + \tildee{\call F}(\Omega)\big)$.

We are now ready for the lemma, which states that comparison holds if the function $z$ in (ZMP) is the sum of a $\call F$-subharmonic and a $C^2$-smooth and strictly $\tildee{\call F}$-subharmonic. 
It is called \emph{definitional} comparison because it relies only upon the ``good'' definitions we gave for subharmonic and for subequations, which includes the negativity condition \eqref{(N)} which is important in the proof. It was stated and proven by Cirant, Harvey, Lawson, and Payne~\cite[Lemma 3.14]{chlp} in a context of constant coefficient subequations; we reproduce here its proof to highlight that it holds in the nonconstant coefficient case, too.

\begin{lem}[Definitional Comparison] \label{defcompa}
Let $\call F$ be a subequation and $u \in \USC(X)$.
\begin{enumerate}[label=\it(\roman*)]
\item	If $u$ is $\call F$-subharmonic on $X$, then the following form of the comparison principle holds for each bounded domain $\Omega \ssubset X$:
\[
u+v \leq 0\ \text{on}\ \de \Omega \implies u+v \leq 0\ \text{on}\  \Omega
\]
whenever $v \in \USC(\barr \Omega) \cap C^2(\Omega)$ is strictly $\tildee{\call F}$-subharmonic on $\Omega$.
\item	Conversely, suppose that for each $x\in X$ there is a neighborhood $\Omega \ssubset X$ of $x$ where the above form of comparison holds. Then $u$ is $\call F$-subharmonic on $X$. 
\end{enumerate}
\end{lem}

\begin{proof}
If the form of comparison in \emph{(i)} fails for some domain $\Omega \ssubset X$ and some regular strict $\tildee{\call F}$-subharmonic function $v$, then $u+v \in \USC(\barr \Omega)$ will have a positive maximum value $m>0$ at an interior point $x_0 \in \Omega$ and hence $\phi\defeq -v+m$ is $C^2$ near $x_0$ and satisfies
\[
u-\phi \leq 0 \quad \text{near $x_0$, with equality at $x_0$}.
\]
Since $u$ is $\call F$-subharmonic at $x_0$, this implies that
\[
J^2_{x_0}(-v+m) = - J^2_{x_0}v + (m, 0,0) \in \call F_{x_0},
\]
which contradicts the property \eqref{(N)} for $\call F$ since $m>0$ and 
\[
 J^2_{x_0}v \in \intr{\tildee{\call F}}_{\!x_0} = (-\call F_{x_0})\compl.
\]

Conversely, suppose that $u$ fails to be $\call F$-subharmonic at some $x_0\in X$. By the Bad Test Jet \Cref{l:btj}, there exist $\rho, \epsilon > 0$ and an upper contact jet $(p,A) \in J^{2,+}_{x_0} u$ such that $J=(u(x_0), p, A) \notin \call F_{x_0}$ and
\begin{equation} \label{btj}
u(x) - \phi_J(x) \leq -\epsilon|x-x_0|^2 \quad \text{on $B_\rho(x_0)$, with equality at $x_0$},
\end{equation}
where $\phi_J$ is the upper contact quadratic function for $u$ at $x_0$ with $ J^2_{x_0}\phi_J = J$. Consequently, the function $-\phi_J$ is smooth and strictly $\tildee{\call F}$-subharmonic at $x_0$ and therefore, by choosing $\rho$ sufficiently small, the function $\tilde v \defeq -\phi_J + \epsilon \rho^2$ will be smooth and strictly $\tildee{\call F}$-subharmonic on $B_\rho(x_0)$.\footnote{Notice that one can make such a choice since there exist $r,R>0$ such that
\[
\call B_R\big(J^2_{x}(-\phi_J)\big) \subset \tildee{\call F}_{x} \quad \forall x \in B_r(x_0),
\]
and thus $J^2_{x}(-\phi_J+\epsilon\rho^2) \in \intr \tildee{\call F}_x$ for each $x \in B_\rho(x_0)$, provided that $\rho < \min \big\{ r, \sqrt{R/\epsilon} \big\}$.} Since reducing $\rho$ preserves the validity of (\ref{btj}), the form of comparison in \emph{(i)} fails for $\tilde v$ on $B_\rho(x_0)$ since
\[
u+\tilde v = 0 \ \text{on $\de B_\rho(x_0)$} \quad \text{but}\quad u(x_0)+\tilde v(x_0) = \epsilon \rho^2 > 0. \qedhere
\]
\end{proof}

\begin{remark}[Applying definitional comparison] \label{appldefcompa}
Sometimes it is useful to prove the contrapositive of the form of comparison in part {\it(i)} of \Cref{defcompa} in order to conclude $\call F$-subharmonicity. That is to say, in order to show by {\it(ii)} that $u$ is  $\call F$-subharmonic on $X$ one proves that, for each $x \in X$ there is a neighborhood $\Omega \ssubset X$ of $x$ where
\begin{equation} \label{appdefcompa}
(u+v)(x_0) > 0 \ \text{for some $x_0 \in \Omega$} \ \implies \ (u+v)(y_0) > 0 \ \text{for some $y_0 \in \de\Omega$}
\end{equation}
for every $v \in \USC(\barr \Omega) \cap C^2(\Omega)$ which is strictly $\tildee{\call F}$-subharmonic on $\Omega$. Conversely, one can also infer that the implication (\ref{appdefcompa}) holds whenever one knows that $u$ is  $\call F$-subharmonic on $X$. In situations where we are interested in proving the  $\call F$-subharmonicity of a function which is somehow related to a given  $\call F$-subharmonic, this helps to close the circle (for example, see the proof of upcoming \Cref{elemprop}).
\end{remark}

Finally, we give a collection of tools which represents elementary properties shared by functions in $\call F(X)$, the set of $\call F$-subharmonics on $X$. They are to be found in \cite[Section~4]{hldir09} for pure second-order subequations, in \cite[Theorem 2.6]{hldir} for subequations on Riemannian manifolds, in \cite[Proposition D.1]{chlp} for constant-coefficient subequations. We place it here because by invoking the definitional comparison lemma one can perform most of the proofs along the lines of those in  Harvey--Lawson \cite{hldir09}. Indeed, we are going to use the definitional comparison in order to make up for the lack, for arbitrary subequations, of a result like \cite[Lemma 4.6]{hldir09}.

\begin{prop}[Elementary properties of $\call F(X)$] \label{elemprop}
Let $X \subset \R^n$ be open. For any subequation $\call F$ on $X$, the following properties hold:
\begin{itemize}[align=left, left=5pt, itemsep=2.5pt] 
\item[(i:] \!\emph{\bf local}) \	$u \in \USC(X)$ locally $\call F$-subharmonic $\iff$ $u \in \call F(X)$;
\item[(ii:] \!\emph{\bf maximum}) \	$u,v \in \call F(X)$ $\implies$ $\max\{u,v\}\in \call F(X)$;
\item[(iii:] \!\emph{\bf coherence}) \ if $u \in \USC(X)$ is twice differentiable at $x_0\in X$, then
\[
\text{$u$ $\call F$-subharmonic at $x_0$}\ \iff\ \text{$J^2_{x_0} u \in \call F_{x_0}$;}
\]
\item[(iv:] \!\emph{\bf sliding}) \ $u\in \call F(X)$ $\implies$ $u-m \in \call F(X)$ for any $m >0$;
\item[(v:] \!\emph{\bf decreasing sequence}) \ $\{u_k\}_{k\in \mathbb{N}} \subset \call F(X)$ decreasing $\implies$ $ \lim_{k\to\infty} u_k \in \call F(X)$;
\item[(vi:] \!\emph{\bf uniform limits}) \ $\{u_k\}_{k\in \mathbb{N}} \subset \call F(X)$, $u_k \to u$ locally uniformly $\implies$ $u \in \call F(X)$;
\item[(vii:] \!\emph{\bf families locally bounded above}) \ if $\scr F \subset \call F(X)$ is a family of functions which are locally uniformly bounded above, then the upper semicontinuous envelope $u^*$ of the Perron function $u(\,\cdot\,) \defeq \sup_{w \in \scr F} w(\,\cdot\,)$ belongs to $\call F(X)$.\footnote{Recall that the \emph{upper semicontinuous envelope} of a function $g$ is defined as the function
\[
g^\ast (x) \defeq \lim_{r\dto 0}\sup_{y \in B_r(x)} g(y).
\]
It is immediate to see that the \emph{upper semicontinuous envelope operator} ${}^* \colon g \mapsto g^*$ is the identity on the set of all upper semicontinuous functions. Also, we called \emph{Perron function} the upper envelope of the family $\scr F$, since $\scr F$ is a family of subharmonics.}
\end{itemize}
Furthermore, if $\call F$ has constant coefficients, the following property also holds:
\begin{itemize}[align=left, leftmargin=*, left=5pt, itemsep=2pt]
\item[(viii:] \!\emph{\bf translation}) \ $u \in \call F(X)$ $\iff$ $u_y\defeq u(\cdot - y) \in \call F(X + y)$, for any $y \in \R^n$.
\end{itemize}
\end{prop}

\begin{proof}
\underline{\textit{(i)}}. It follows immediately from the local nature of the notion of $\call F$-subharmonicity.

\noindent\underline{\textit{(ii)}}. Let $w\defeq \max\{u,v\}$ and note that if $(p,A) \in J^{2,+}_x w$, then either $(p,A) \in J^{2,+}_x u$ or  $(p,A) \in J^{2,+}_x v$ since $w(x)$ is either $u(x)$ or $v(x)$ and, in general, $u(y), v(y) \leq w(y)$. Therefore, in any case, $(w(x),p,A) \in \call F_x$.

\noindent\underline{\textit{(iii)}}. It follows from the positivity condition \eqref{(P)}, thanks to the elementary fact that, for $u$ which is at least twice differentiable at $x$, if $(p,A)$ is an upper contact jet for $u$ at $x$, then $(p,A) = (Du(x), D^2u(x) + P)$ for some $P\geq 0$.

\noindent\underline{\textit{(iv)}}. It follows immediately from the negativity condition \eqref{(N)}.

\noindent\underline{\textit{(v)}}. We are going to use the \emph{definitional comparison}. Since the decreasing limit $u$ of $\{u_k\}_{k\in \mathbb N} \subset \USC(X)$ belongs to $\USC(X)$, by \Cref{defcompa} it suffices to show that for each $\Omega \ssubset X$, one has $u+v \leq 0$ on $\Omega$ for each $v \in \USC(\barr\Omega) \cap C^2(\Omega)$ which is strictly $\tildee{\call F}$-subharmonic on $\Omega$ with $u+v \leq 0$ on $\de\Omega$.
For each $\epsilon >0$ fixed, consider the sets
\[
\mathfrak E_k \defeq (u_k+v)^{-1}([\epsilon, + \infty)) \cap \de\Omega.
\]
By the upper semicontinuity of each $u_k$ (and thus of each $u_k+v$), $\mathfrak E_k$ are closed subsets of the compact set $\de \Omega$ and hence each $\mathfrak E_k$ is compact. Since $\{u_k\}_{k \in \mathbb N}$ is decreasing, they are nested; that is, $\mathfrak E_{k+1} \subset \mathfrak E_k$ for all $k \in \mathbb N$. Since $u+v \leq 0$ on $\de \Omega$, they have empty intersection:
\[
\bigcap_{k\in\mathbb{N}} \mathfrak E_k = (u+v)^{-1}([\epsilon, +\infty)) \cap \de \Omega = \emptyset.
\]
Therefore, by the well-known property of nested families of compact sets, the $\mathfrak E_k$'s must be eventually empty. This means that $u_k+ v < \epsilon$ on $\de \Omega$ for $k$ large and since $v - \epsilon$ is still a smooth and strict $\tildee{\call F}$-subharmonic by the sliding property, the definitional comparison lemma yields $u_k + v \leq \epsilon$ on $ \Omega$. Hence $u+v \leq u_k + v \leq \epsilon$ on $\Omega$, for any $\epsilon >0$, which, on letting $\epsilon \dto 0$, gives $u+v \leq 0$ on $\Omega$ and thus $u\in \call F(X)$, again by definitional comparison.

\noindent\underline{\textit{(vi)}}. If $u_k$ converges to $u$ uniformly on the compact $\barr\Omega$ and we suppose $u+v \leq 0$ on $\de \Omega$ as above, then, for any $\epsilon > 0$ fixed, $u_k + v < \epsilon$ on $\de\Omega$ for $k$ large. The definitional comparison lemma yields $u_k + v \leq \epsilon$ on $\Omega$, hence $u+v = (u-u_k) + (u_k +v) < 2\epsilon$ on $\Omega$ for $k$ large, where one exploits the uniform convergence to say that $u-u_k < \epsilon$ on $\Omega$ if $k$ is large. On letting $\epsilon \dto 0$, we have $u+v \leq 0$ on $\Omega$ and thus, by the converse implication of the definitional comparison, $u \in \call F(X)$.

\noindent\underline{\textit{(vii)}}. If $u^\ast +v \leq 0$ on $\de \Omega$, then $w+ v \leq 0$ on $\de \Omega$ for all $w \in \scr F$. By the implication \emph{(i)} of the definitional comparison lemma, $w+ v \leq 0$ on $\Omega$ for all $w \in \scr F$ and thus $u+v \leq 0$ on $\Omega$. Since $v$ is smooth and since the upper semicontinuous envelope operator preserves inequalities, we conclude that $u^* + v = (u+v)^* \leq 0$ on $\Omega$ and the thesis follows from the implication \emph{(ii)} of definitional comparison.

\noindent\underline{\textit{(viii)}}. This property holds only in a constant coefficient context; indeed, its validity for every $y\in \R^n$ is actually equivalent to the fiber $\call F_x$ being independent of the point $x\in X$. Indeed, since by the respective definitions $u_y(x+y) = u(x)$ and  $J^{2,+}_x u= J^{2,+}_{x+y} u_y$, one has, for $z \in X+y$, that $J^{2,+}_z u_y \subset \call F_{z-y}$ and thus property \emph{(viii)} holds if and only if $\call F_{z-y} = \call F_z$.
\end{proof}
 
As a final remark, the coherence property {\it(iii)} says that an upper semicontinuous function which is twice differentiable and classically $\call F$-subharmonic on $X$ (it satisfies the condition~(\ref{coherence} for all $x\in X$), then it is $\call F$-subharmonic in the viscosity sense. One might hope to have the same conclusion even if~(\ref{coherence}) is satisfied almost everywhere, with respect to the Lebesgue measure.
This is true if $u$ is locally quasi-convex and is known as the {\em Almost Everywhere Theorem} from \cite{hlae}. This deep result will be discussed in the next section.  It was first established in the pure second-order case in \cite[Corollary 7.5]{hldir09}.


\section{Quasi-convex functions and subharmonics}\label{sec:QCSH}

In this section, we treat the main theme of this work on the efficient use of quasi-convex function in nonlinear potential theories. We begin with a first fundamental result, which says that in the potential theory defined by a given subequation constraint set $\call F$,  a locally quasi-convex function is $\call F$-subharmonic on an open set if it is $\call F$-subharmonic on a set of full (Lebesgue) measure. Moreover, by Alexandrov's Theorem \ref{aleks:qc} and the coherence property of Remark \ref{rem:coherence}, the $\call F$-subharmonicity then reduces to a classical statement almost everywhere.

\begin{thm}[Almost Everywhere Theorem]\label{aet}
Suppose that $\call F$ is a primitive subequation on an open set $X\subset \R^n$ and
$u \colon X \to \R$ is a locally quasi-convex function. Then
\[
 J_x^2u \in \call F_x\ \text{for almost all $x\in X$}\quad \iff\quad u\in \call F(X).
\]
\end{thm}

\begin{proof}
By \Cref{ae?} with $E \defeq \{x \in X:\  J^2_xu \in \call F_x\}$, we know that $\call J^{2,+}u \subset \barr{\call J(u,E)}$, where $\call J^{2,+}u$ is defined in \eqref{J2+w} and $\call J(u,E)$ is defined in \eqref{JwE}; that is,
\[
	\call J^{2,+}u:= \{ (x,u(x),p,A): \ x \in X, (p,A) \in J^{2,+}_x u \}
\]
and
\[
	\call J(u,E) \defeq \big\{ (x, u(x), Du(x), D^2u(x) + P):\ x \in E \cap \Diff^2(u),\ P \geq 0 \big\}.
\]
By property \eqref{(P)} one has $\call J(u,E) \subset \call F$ and by property \eqref{(C)} also $\barr{\call J(u,E)} \subset \call F$. Hence by \Cref{subinclusion}, $u \in \call F(X)$.

Conversely, for every $P>0$, we know that $(Du(x), D^2u(x) + P)$ is an upper contact jet for $u$ at $x \in \Diff^2(u)$. Therefore, in particular, $J^2_x u + (0,0,\epsilon I) \in \call F_x$ for all $\epsilon >0$. By taking $\epsilon \dto 0$ and using the fact that $\call F$ is closed, we get $J_x^2u \in \call F_x$ for all $x\in \Diff^2(u)$ and hence the conclusion follows from Alexandrov's theorem.
\end{proof}

Before moving on to the next fundamental result, a technical remark is in order.

\begin{remark}[On the proof of Theorem \ref{aet}]\label{rem:aet} The proof avove relies heavily on Remarks \ref{subinclusion} and \ref{ae?}, which, in some sense, ``hide the hard analysis'' of the combined use of the Jensen--S{\l}odkowski \Cref{jenslod} and of Alexandrov's \Cref{aleks:qc}. For somewhat more explicit proofs one can consult \cite{hlae} or \cite[Lemma 2.10]{chlp}, where the Bad Test Jet Lemma is also used.
\end{remark}

We are now ready for the second fundamental result. As noted by Harvey and Lawson in \cite{hlae}, an immediate consequence of the Almost Everywhere \Cref{aet} is a {\em subharmonic addition theorem} for locally quasi-convex functions. That is, by restricting attention to suharmonics which are locally quasi-convex, then a purely algebraic statement of \emph{jet addition} always implies the funcional analytic statement of \emph{subharmonic addition}. This can be written as
\begin{equation}\label{SAT}
\call F_x + \call G_x \subset \call H_x, \ \ \forall \, x \in X \implies (\call F(X) \cap \mathsf{qc}_\text{loc}(X)) +  (\call G(X) \cap \mathsf{qc}_\text{loc}(X)) \subset \call H(X),
\end{equation}
where $\mathsf{qc}_\text{loc}(X)$ is the space of all locally quasi-convex functions on $X$, which were characterized in formula \eqref{qc_loc} of Example \ref{exe:qc}. The result is formalized in the following way.

\begin{thm}[Subharmonic addition for quasi-convex functions]\label{add}
Suppose $\call F$ and $\call G$ are primitive subequations on an open set $X\subset \R^n$ and let $\call K \defeq \barr{\call F + \call G}$; suppose $u\in \call F(X)$ and $v\in \call G(X)$ are locally quasi-convex functions on $X$. Then $u+v \in \call K(X)$.
\end{thm}

\begin{proof}
Since $u \in \call F(X)$ and $v \in \call G(X)$ are locally quasi-convex, by the reverse implication in the Almost Everywhere \Cref{aet} we have $J^2_x u \in \call F_x$ and $J^2_x v \in \call G_x$ for almost every $x \in X$. Hence $J^2_x(u+v) = J^2_x u + J^2_x v \in \call K_x$ almost everywhere, with $u + v$ locally quasi-convex. The forward implication of the Almost Everywhere \Cref{aet} now yields $u+v \in \call K(X)$. 
\end{proof}

\begin{remark}
Theorem \ref{add} implies subharmonic addition in the form \eqref{SAT} even if $\call H \supset \call F + \call G$ is not a (primitive) subequation. This is because $\call K$ is the minimal primitive subequation containing $\call F + \call G$. Indeed, the (fiberwise) sum satisfies \eqref{(P)}, therefore so does its closure. 
 \end{remark}
 
 \begin{remark}
Taking the closure of the sum is necessary in order to assure that property \eqref{(C)} holds. For example, consider $\call F$ and $\call G$ induced by the two equations $F(u) = 0$ and $G(u) = 0$ on $\R^n$, with 
\[
F(r) \defeq \chi_{[0, +\infty)}(r) \sin^2(\pi r^2) - \tfrac34 \quad \text{and} \quad G(r) \defeq \chi_{(-\infty, 0]}(r) \sin^2(\pi (r+\alpha)^2)  - \tfrac34,
\]
for some $\alpha \in (\frac13, \frac23)$. Then it is easy to see that $(0,0,0,0) \notin \call F + \call G$, yet it is a limit point, since for every positive integer $k$, we have that  $\sqrt{1/3 + k} - \sqrt{2/3 - \alpha + k} = O\big(1/\sqrt k\big)$ belongs to the $\R$-component of each jet in $\call F + \call G$.
\end{remark}

With respect to \Cref{add} on subharmonic addition, two observations are in order. The first observation contains a reformulation of the Summand Theorem \ref{pusc:sum} which provides a stronger version of \Cref{add} while the second observation notes, as in \cite{hlae}, that the quasi-convexity assumption on the subharmonics is not needed in the constant coefficient case.

\begin{remark}[\emph{A stronger form of subharmonic addition}] \label{rmkone}
It is worth noting that the Summand Theorem \ref{pusc:sum} leads to a slightly stronger form of \Cref{add}.
Indeed, it tells us that if $(p,A)$ is an upper contact jet for the sum $w = u+v$ at $x$, then there exist two jets 
\[
(x, u(x), Du(x), B') \in \barr{\call J^{2,+}u}, \quad (x, v(x), Dv(x), C) \in \barr{\call J^{2,+}v}
\]
 which sum to $(w(x), p, A)$. To see this, note that the sequence $\{x_j\}$ can be selected in such a way that $Du(x_j) \to Du(x)$ and $Dv(x_j) \to Dv(x)$, according to~\Cref{pusc}; hence it is sufficient to take $B' = A + P$, where  $P = A - B - C \geq 0$. To write this succinctly,
\[
\call J^{2,+}u + \call J^{2,+}v \subset \call J^{2,+}(u+v) \subset \barr{\call J^{2,+}u} + \barr{\call J^{2,+}v},
\]
where the former inclusion is trivial and the latter is the thesis of the proposition.

In other words,  \Cref{pusc:sum} assures that every upper contact $2$-jet of the sum $u+v$ of two quasi-convex functions can be represented as the sum of two $2$-jets of $\call F$ and $\call G$, respectively, hence $u+v \in \call F + \call G\,(X)$. This will be used in the proof of the strict comparison for quasi-convex functions (\Cref{scqc}).
\end{remark}

\begin{remark}
Furthermore, if $\call F$ and $\call G$ are constant coefficients subequations, then the assumption that $u$ and $v$ are quasi-convex can be dropped; therefore we have 
\[
\call F(X) + \call G(X) \subset \barr{\call F + \call G}\,(X).
\]
This follows from a quasi-convex approximation technique that was introduced in \cite{hldir09} in a context of pure second-order subequations and that works fine also for general constant coefficient subequations.
%We here state another property of the supconvolution that is useful in order to deduce results for semicontinuous functions from their counterparts for quasi-convex functions, as we said. 
\end{remark}

As we anticipated in the previous part, the supconvolution is known to provide an effective way to approximate upper semicontinuous functions by a quasi-convex \emph{regularization} of them (see \Cref{baspropsc} for four basic properties of the supconvolution).
The next proposition which imitates \cite[Theorem~8.2]{hldir09} shows that, for constant coefficent subequations $\call F$, if one takes the supconvolution of a bounded $\call F$-subharmonic with, then it remains $\call F$-subharmonic, provided we are far enough from the boundary of the domain $X$. 

\begin{prop}[Quasi-convex approximation of $\call F$-subharmonics] \label{prop:approx}
Let $\call F$ be a constant coefficient subequation and suppose that $ u \in \call F(X)$ is bounded. For $\epsilon >0$, let $\delta \defeq 2\sqrt{\epsilon \sup_X\! |u|}$, and $X_\delta \defeq \{ y \in X:\ d(y, \de X) > \delta\}$. Then $u^\epsilon \in \call F(X_\delta)$.
\end{prop}

\begin{proof}
Since $\call F$ has constant coefficients, we have that $u_z \defeq u(\cdot - z) \in \call F(X_\delta)$ for all $z \in B_\delta$. Indeed, it is easy to see that $J^{2,+}_x u_z \subset \call F_{x-z} = \call F_x$ for every $x \in X_\delta$. If we now take
\[
\scr F \defeq \bigg\{ u_z - \frac{1}{2\epsilon}|z|^2:\ z \in B_\delta \bigg\},
\]
then $\scr F \subset \call F(X_\delta)$ by the negativity condition \eqref{(N)} and, by (\ref{supcball}), its upper envelope is $u^\epsilon$, and it coincides with $(u^\epsilon)^\ast$ because it is quasi-convex, hence upper semicontinuous. Therefore, we have $u^\epsilon \in \call F(X_\delta)$, by the families-locally-bounded-above property of \Cref{elemprop}.
\end{proof}

The final result of this section with an important application of the quasi-convex approximation technique by deducing a Subharmonic Addition Theorem for merely upper semicontinuous subharmonics for constant coefficient subequations from its quasi-convex counterpart \Cref{add}. This result was first stated in \cite[Theorem~7.1]{chlp} and we essentially reproduce the original proof. 

\begin{cor}[Subharmonic addition for constant coefficient subequations] \label{ccsa}
Suppose $\call F$ and $\call G$ are constant coefficient subequations. Then, for any open set $X\subset \R^n$, jet addition implies subharmonic addition; that is,
\[
\call F + \call G \subset \call H \implies \call F(X) + \call G(X) \subset \call H(X).
\]
\end{cor}

\begin{proof}
Let $u\in \call F(X)$, $v \in \call G(X)$. Since the result is local, it is sufficient to show that, for each $x\in X$, one has $u+v \in \call H( U)$, where $ U$ is any neighborhood of $x$. Hence by upper semicontinuity we may assume that $u$ and $v$ are bounded above. Also, we may assume that $u$ and $v$ are bounded below, since it suffices to consider, for any positive integer $m$, the subharmonics $u \vee (\phi -m) \defeq \max\{u, \phi - m\} \in \call F( U)$ and $v \vee (\psi -m) \defeq \max\{v, \psi- m\} \in \call G( U)$, for some bounded quadratic functions $\phi \in \call F( U)$ and $\psi \in \call G( U)$, and then take the limit $m\to \infty$. We have already highlighted in \Cref{exquadsub} that the existence of such quadratic functions is guaranteed by the topological property \eqref{(T)} and that their translations by negative constants are still subsolutions by the sliding property yielded by the properness condition \eqref{(N)}, while the \emph{truncated} functions are subharmonic thanks to the \emph{maximum property} of constant coefficient subequation. With these assumptions, by \Cref{prop:approx} there exist sequences $\{u_j\}$, $\{v_j\}$ of quasi-convex subharmonics near $x$ that converge monotonically downward to $u, v$  respectively, as $j \to \infty$. By \Cref{add} we know that $u_j + v_j \in \call H(X)$ and by the \emph{decreasing sequence property} we conclude $u+v \in \call H(X)$. 
\end{proof}

We conclude this section with some remarks on the utility, limitations and generalizations of the subharmonic addition theorem for constant coefficient subequations in Corollary \ref{ccsa}. First, we give one important use of Corollary \ref{ccsa}, which concerns the valiidty of the comparison principle and will be the subject of Section \ref{sec:comp}.

\begin{remark}[Subharmonic addition and the comparison principle]\label{rem:SAT_CC}
If a subequation constraint set $\call F$ on $X$ (not necessarily with constant coefficients) is $\call M$-monotone for some constant coefficient monotonicity cone subequation $\call M$ as in \eqref{monotone}; that is
$$
	\call F_x + \call M \subset \call F_x, \quad \forall\, x \in X,
$$
then duality gives the jet addition formula
$$
	\call F_x + \widetilde{\call F}_x \subset \widetilde{\call M}, \quad \forall\, x \in X.
$$
Using then $\call G = \widetilde{\call F}$ and $\call H = \widetilde{\call M}$, the validity of a subharmonic addition theorem would yield
\begin{equation}\label{monodual}
	\call F (X) + \widetilde{\call F} (X) \subset \widetilde{\call M}(X).
\end{equation}
Again using duality, the validity of the comparison principle on $\Omega \ssubset X$ can be reduced to the validity of the {\em Zero Maximum Principle} (ZMP) for $z \in \USC(\overline{\Omega} \cap  \widetilde{\call M}(\Omega)$:
\begin{equation}\label{ZMP}
	z \leq 0 \ \text{on $\partial \Omega$} \ \ \Rightarrow \ \ 	z \leq 0 \ \text{on $\partial \Omega$},
\end{equation}
by considering every $z:= u + v$ with $u \in \USC(\overline{\Omega}) \cap \call F(\Omega)$ and $v \in \USC(\overline{\Omega}) \cap \widetilde{\call F}(\Omega)$. Corollary \ref{ccsa} says that if $\call F$ has constant coefficients, then \eqref{monodual} indeed holds. This is the {\em monotonicty-duality} method for proving comparison, which is extensively treated in the constant coefficient setting in \cite{chlp} including a classification of monotonicity cone subequations $\call M$ and the validity of the (ZMP) in \eqref{ZMP} for the dual cone subharmonics. 
\end{remark}

Next, we discuss the limitations and generalizations of Corollary \ref{ccsa}.

\begin{remark}[Subharmonic addition for variable coefficient subequations]\label{rem:SAT_VC}
In the constant coefficient setting, the quasi-convex approximation preserves $\call F$-subharmonicity. This is essentually due to validity of the translation property of Proposition \ref{elemprop} (\emph{viii}), which one loses when passing to nonconstant coefficients (as seen at the end of the proof of this proposition). In the variable coefficient setting, one can extend the quasi-convex approximation technique to obtain the subharmonic addition theorem and its consequences provided that the variable coefficient subequation $\call F$ is both {\em $\call M$-monotone} (for some monotonicty cone subequation $\call M$) and {\em fiberegular}. 

The $\call M$-monotonicty of $\call F$ always holds for variable coefficient pure second order and gradient-free subequations, but when there is gradient dependence, one also needs {\em directionality}, as studied in \cite{cprdir}. Moreover, in this case, the assupmtion of $\call M$-monotonicity is also needed for the monotonicity-duality method for proving the comparison principle, as noted in Remark \ref{rem:SAT_CC}. 

The fiberegularity of $\call F$ is just the continuity of the fiber map $\Theta: X \to \wp(\call J^2)$ defined by $\Theta_x:= \call F_x$ for each $x \in X$. Using this regularity property and the $\call M$-monotonicity, one can replace the translation property by the {\em uniform translation property}, which roughly speaking means that \emph{\em if $u \in \call F(\Omega)$, then there are small $C^2$ strictly $\call F$-subharmonic perturbations of \underline{all small translates} of  $u$ which belong to  $\call F(\Omega_{\delta})$}, where  $\Omega_{\delta}:= \{ x \in \Omega: d(x, \partial \Omega) > \delta \}$ (see Theorem 3.3 of \cite{cprdir} for a precise statement and the proof). This uniform translation property was developed first in the variable coefficient pure second order case in \cite{cpaux} and generalized to the variable gradient-free case in \cite{cpmain}, where we stress again that the needed $\call M$ monotonicity holds in these two gradient-free cases.
\end{remark}


\section{Comparison principles}\label{sec:comp}

In this section, we illustrate some aspects of the {\em monotonicity-duality method} for proving the comparison principle in nonlinear potential theories. We gave a synthetic sketch of the method in Remark \ref{rem:SAT_CC} as an application of the Subharmonic Addition Theorem. Here, we will derive the method from first principles. Then we will provide various illustrations of its applications, as described in the introduction to Part II.

We begin by recalling that, before stating the definitional comparison, we rewrote the comparison principle on $\Omega \ssubset X$
\begin{equation} \tag{CP}
\begin{cases}
\text{$u$ $\call F$-subharmonic, $v$ $\call F$-superharmonic on $X$} \\
u \leq v\ \text{on $\de\Omega$}
\end{cases}
\implies u\leq v\ \text{on $\Omega$}
\end{equation}
as the zero maximum principle for sums
\begin{equation} \label{eq:ZMP} \tag{ZMP}
\begin{cases}
w \in \call F(X) + \tildee{\call F}(X) \\
w \leq 0\ \text{on $\de\Omega$}
\end{cases}
\implies w\leq 0\ \text{on $\Omega$},
\end{equation}
which merely exploits the fact that $v$ is $\call F$-superharmonic if and only if $-v \in \tildee{\call F}(X)$.
This suggests that a key role in the proof of comparison could be played by a subharmonic addition theorem; that is, one would like to know if 
\[
\call F_x + \tildee{\call F_x} \subset \call G_x,  \ \ \forall x \in X \implies \call F(X) + \tildee{\call F}(X) \subset \call G(X).
\]
This would be particularly useful if two things were true. First, that $\call G$ does not depend on the specific form of $\call F$, but, for example, only on the monotonicity properties of $\call F$. Second, if we are able to say that comparison holds for $\call G$-subharmonics, for example, by way of a suitable characterization of $\call G(X)$.

In order to find a suitable $\call G$, note that if $\call F$ is $\call M$-monotone; that is,
\begin{equation} \label{1moncon}
\call F_x + \call M_x \subset \call F_x, \ \ \forall \, x \in X,
\end{equation}
then by properties \emph{(1)}, \emph{(2)} and \emph{(3)} of \Cref{propdual} one has, for each $J \in \call F_x$,
\[
J + \call M_x \subset \call F_x \implies \tildee{\call F}_x \subset \tildee{\call M}_x - J,
\]
hence
\begin{equation*}\label{jetadd:f}
\call F_x + \tildee{\call F}_x \subset \tildee{\call M}_x, \ \ \forall \, x \in X
\end{equation*}
and one may choose $\call G = \tildee{\call M}$. Moreover, one knows that such a subset $\call M$ always exists. Indeed, regardless of the subequation $\call F$, thanks to the conditions \eqref{(P)} and \eqref{(N)} a set (with constant fibers) that satisfies (\ref{1moncon}) is
\[
\call M = \call N \times \{0\} \times \call P,
\]
where
\begin{equation} \label{def:np}
\call N \defeq \{r \in \R:\ r\leq 0\} \quad \text{and} \quad \call P \defeq \{A \in \call S(n):\ A \geq 0 \}.
%\footnote{That is, $\call P \defeq \lambda_1^{-1}(\R_{\geq 0})$, where $\lambda_1 \colon \call S(n) \to \R$ is the \emph{minimal eigenvalue operator}.}
\end{equation}
Note that $\call M$ is a constant coefficient primitive subequation (it is closed and satisfies property (P)) and $\call M$ satisfies the negativity property (N). However, $\call M$ it is not a subequation because, having empty interior due to the factor $\{0\}$, it fails to satisfy the topological property (T). This trivial factor says that there may be monotonicity of $\call F$ with respect to the gradient variable $p \in \R^n$.

Assuming that $\call M$ can be enlarged to be a \emph{monotonicity cone subequation} satisfying \eqref{1moncon}, the only missing piece would be to prove that comparison holds for functions in $\tildee{\call M}(X)$.  Notice that choosing $\call M$ as large as possible facilitates the proof of the ZMP for $\tildee{\call M}(X)$, which becomes smaller as $\call M$ increases. This represents the main observation to the monotonicity--duality method of Harvey and Lawson, as discussed in \cite{chlp}. 

Having derived the monotonicity-duality method, we will present a few illustrative applications of it.
First, a pair of constant coefficient situations coming from \cite{hldir09, chlp} for which comparison holds on all bounded domains and the needed (ZMP) for the $\widetilde{\call M}$-subharmonics is accomplished by characterizing them. Then, beginning in the next subsection, we will discuss {\em strict comparison} for quasi-convex functions in the variable coefficient setting and for semicontinuous functions in the constant coefficient setting. 

\subsection{Comparison with constant coefficients and sufficient monotonicity} \label{sec:cccc} 
We will present two basic examples of classes of $\call M$-monotone subequations for which comparison holds on all bounded domains. The classes are determined by the two most elementary  monotonicity cone subequations $\call M$, which have interesting characterizations of the dual subharmonics $\tildee{\call M}(X)$, as known from \cite{hldir09,chlp}. These characterizations easily lead to a direct proof that the $\tildee{\call M}$-subharmonics satisfy the (ZMP) on all bounded domains, and hence the comparison principle in all $\call M$-monotone potential theories. The two classes discussed here can be included in a much more general result that will be recalled in Remark \ref{rem:CP_cc} below.



%\subsubsection{Pure second-order constant coefficient subequations} 
%
%Here is a formal definition.
 
\begin{definition} \label{psos}
A \emph{  pure second-order constant coefficient subequation} is a  closed subset of $\call J^2$ of the form  $\call F = \R \times \R^n \times \call A$ with $\call A \subset \call S(n)$ satisfying the positivity property ($\call P$-monotonicity)
\begin{equation}\label{pos_PSO}
 \call A  + \call P \subset \call A, 
\end{equation}
where $\call P = \{ P \in \call S(n): P \geq 0\}$.
\end{definition}

\begin{remark} \label{identify}
We have used \Cref{rmkccs} to identify a constant coefficient subequation $\call F \subset \call J^2(\R^n)$ with a subset $\R \times \R^n \times \call S(n)$. Notice that such an $\call F$ is indeed a subequation because the negativity property (N) is automatic and the topological property (T) follows from the $\call P$-monotonicity, which implies the following monotonicity property
$$
	\call F + (\R \times \R^n \times \call P) \subset \call F,
$$ 
where the property $\call F + (\R \times \R^n \times \{0\}) \subset \call F$ is an elegant way to say that $\call F$ is of pure second order.

In addition, since the only component of a jet that is actually relevant to define a subsolution is the one living in $\call S(n)$, we will often identify $\call F$ with $\call A \subset \call S(n)$ that satisfies the positivity condition \eqref{pos_PSO}. Hence, we can say that a  pure second-order constant coefficient subequation is a closed subset $\call A \subset \call S(n)$ which is $\call P$-monotone. 
\end{remark}

Given $A\in \call S(n)$ we denote by $\lambda_1(A)$ and $\lambda_n(A)$ its minimum and its maximum eigenvalue, respectively (that is, we order the eigenvalues $\lambda_1 \leq \lambda_2 \leq \cdots \leq \lambda_n$). The most basic of all examples is the \emph{convex} subequation (cf.\ (\ref{def:np}))
\[
\call P \defeq \{ A \in \call S(n):\ \lambda_1(A) \geq 0 \},
\]
whose dual subequation is the \emph{co-convex} or \emph{subaffine} subequation
\[
\tildee{\call P} \defeq \{ A \in \call S(n):\ \lambda_n(A) \geq 0 \}.
\]
The name \emph{subaffine} comes from the fact, proved in~\cite[Proposition 4.5]{hldir09}, that an upper semicontinuous function on $X$ is a subsolution of $\tildee{\call P}$ if and only if it is \emph{subaffine} on $X$; that is
\begin{equation} \label{p=sa}
\tildee{\call P}(X) = \mathrm{SA}(X),
\end{equation} 
where $\mathrm{SA}(X)$ is the space of all subaffine functions on $X$, in the sense of the following definition.

\begin{definition}
A function $w\in \USC(X)$ is called \emph{subaffine on $X$}, and we write $w \in \mathrm{SA}(X)$,  if, for every open subset $\Omega \ssubset X$ and each affine function $a \in \mathrm{Aff}$,
\[
w \leq a\ \text{on $\de \Omega$} \implies  w \leq a\ \text{on $\Omega$}.
\]
\end{definition}

\begin{remark}
We wrote the space of all affine functions as $\mathrm{Aff}$, without specifying their domain because it is known that any $a$ which is affine on an open subset $\Omega$ has a unique extension to the whole space $\R^n$ (see, e.g., \cite{vesely}).
\end{remark}

%It is also known that, for every pure second-order subequation $\call F\subset \Sc(n)$, one has 
%\begin{gather*}
%\call F + \call P \subset \call F  \iff \tildee{\call F} + \call P \subset \tildee{\call F}, \\
%\call F + \tildee{\call F} \subset \tildee{\call P}.
%\end{gather*}
%This follows from~\Cref{propdual} and~\Cref{invert}, since the first line is a consequence of property \emph{(4)} and the second one is equivalent to $\call F + \call P \subset \call F$, which is in turn equivalent to the condition (P). Indeed, for every $J \in \call F$ one has
%\[
%J + \call P \subset \call F \iff \tildee{\call F} \subset \tildee{J + \call P} = \tildee{\call P} - J.
%\]

Note that $\call P$ is a monotonicity cone subequation for all pure second-order constant coefficient subequations (and it is minimal in this sense), hence a straightforward application of the Subharmonic Addition Theorem (\Cref{ccsa}) yields the following result. For a proof that uses S{\l}odkowski's Largest Eigenvalue Theorem and quasi-convex approximation, the reader can instead refer to \cite{hldir09}.

\begin{thm}[{Subaffine Theorem; \cite[Theorem 6.5]{hldir09}}] \label{t:subaff}
If $\call F$ is a pure second-order constant coefficient subequation, then for any open set $X \subset \R^n$
\[
\call F(X) + \tildee{\call F}(X) \subset \mathrm{SA}(X).
\]
\end{thm}

At this point it is evident that comparison holds, provided that one has the following strengthening of the property of subaffinity.

\begin{lem} \label{str:sub}
Let $\Omega \subset \R^n$ a domain and $w\in \USC(\barr\Omega)\cap \mathrm{SA}(\Omega)$. Then
\[
w \leq a\ \text{on $\de \Omega$} \implies w \leq a\ \text{on $ \Omega$}
\]
for all $a \in \mathrm{Aff}$.
\end{lem}

\begin{proof}
Assume without loss of generality that $a=0$. We consider an exhaustion of  $\Omega$ by an increasing sequence of compact sets $\{ K_j\}_{j \in \N}$ and set $U_\delta \defeq \{ x\in \barr \Omega:\ w(x) < \sup_{\de\Omega} w + \delta\}$, for any $\delta > 0$. Since $w\in \USC(\barr\Omega)$, we know that $U_\delta$ is an open neighborhood of $\de\Omega$ in $\barr \Omega$. Therefore $\de K_j \subset U_\delta$ for all  $j$ sufficiently large and, since $w$ is subaffine, $\sup_{K_j} \leq \sup_{\de \Omega} w + \delta$.
 This proves that $\sup_{\Omega} w \leq \sup_{\de \Omega} w + \delta$; since $\delta$ is arbitrary, $w\leq 0$ in $\de\Omega$ and $w$ is continuous, we conclude that $w \leq 0$ on $\barr\Omega$, which is the desired conclusion.
\end{proof}

\begin{thm}[Comparison for pure second-order subequations]\label{thm:C_pso}
Let $\call F$ be a pure second-order constant coefficient subequation. Then comparison holds on every domain $\Omega \subset \R^n$:
\[
u+v \leq 0\ \text{on $\de \Omega$} \implies u+v \leq 0\ \text{on $ \Omega$}
\]
if $u \in \USC(\barr \Omega) \cap \call F(\Omega)$ and $v \in \USC(\barr \Omega) \cap \tildee{\call F}(\Omega)$.
\end{thm}

\begin{proof}
It follows from~\Cref{str:sub} with $a=0$, since $u+v$ is a subaffine function by the Subaffine \Cref{t:subaff}.
\end{proof}

%\subsubsection{Gradient-free constant coefficient subequations}

The case of pure second-order constant coefficient subequations is a subset of the one we are going to discuss now, yet we considered \emph{historically significant} to introduce them separately. Again, we will show that comparison holds on all bounded domains.

\begin{definition} \label{gfs}
A \emph{gradient-free constant coefficient subequation } is a closed subset of $\R \times \R^n \times \call S(n)$ of the form $\call F = \call R \times \R^n \times \call A$ with $\call R \subset \R$ and $\call A \subset \call S(n)$ satisfying the conditions of negativity and positivity, respectively; that is, 
\begin{equation}\label{PN_GF}
\call R  + \call N \subset \call R \quad \text{and} \quad \call A  + \call P \subset \call A,
\end{equation}
where $\call N = \{ r \in \R: r \leq 0\}$ and $\call P = \{ P \in \call S(n): P \geq 0\}$.
\end{definition}



\begin{remark}\label{rem:CC_GF}
Just as in Remark \ref{identify}, we have identified the constant coefficient $\call F$ with a subset of $\call J^2$ and it is indeed a subequation, since the remaining topological property (T) again follows by the $(\call N \times \R^n \times \call P)$-monotonicity of $\call F$. 

Moreover, one can again {\em reduce} the subequation by suppressing the ``silent'' gradient variable, which then allows one to further identift $\call F$ with a subset of $\R \times \call S(n)$. Hence, one can say that a gradient-free constant coefficient subequation is a closed subset $\call F \subset \R \times \call S(n)$ which is $\call Q$-monotone where
\begin{equation}\label{def_Q}
\call Q:= \call N \times \call P \subset \call \R \times \call S(n)
\end{equation}
\end{remark}

The most basic example of a gradient-free constant coefficient subequation is the (reduced) monotonicity cone subequation $\call Q$ defined in \eqref{def_Q}. Its dual subequation is the so-called \emph{subaffine-plus} subequation
\begin{equation}\label{def_Qtilde}
\tildee{\call Q} = \{ (r,A) \in \R \times \call S(n): \ r \leq 0 \ \ \text{or} \ \ A \geq 0 \}.
\end{equation}
Also in this case the name comes from a characterization of dual subharmonics. By \cite[Theorem 10.7]{chlp}, an upper semicontinuous function on $X$ is $\tildee{\call Q}$-subharmonic if and only if it is \emph{subaffine-plus} on $X$; that is,
\[
\tildee{\call Q}(X) = \mathrm{SA}^+(X),
\] 
where $\mathrm{SA}^+(X)$ is the space of all subaffine-plus functions on $X$, which are defined as follows.

\begin{definition}
For $K\subset \R^n$ compact, we denote by
\[
\mathrm{Aff}^+(K) \defeq \{ \restr{a}{K}:\ a \in \mathrm{Aff},\ a \geq 0\ \text{on $K$} \}
\]
the space of \emph{affine-plus functions on $K$}.
\end{definition}

\begin{definition}
A function $w\in \USC(X)$ is called \emph{subaffine-plus on $X$}, and we write $w \in \mathrm{SA}^+(X)$,  if, for every open subset $\Omega\ssubset X$,
\[
w \leq a_+\ \text{on $\de \Omega$} \implies  w \leq a_+\ \text{on $\Omega$} \qquad
\forall a_+\! \in \mathrm{Aff}^+(\barr\Omega).
\]
\end{definition}


In analogy with the pure second-order case, $\call Q$ is a monotonicity cone subequation for all gradient-free subequations (and it is minimal in this sense), hence it is now immediate to see that, by~\Cref{ccsa}, we have an analogue of the Subaffine Theorem.

\begin{thm}[{Subaffine-Plus Theorem; \cite[Theorem 10.8]{chlp}}]
If $\call F$ is a gradient-free constant coefficient subequation, then for any open set $X \subset \R^n$
\[
\call F(X) + \tildee{\call F}(X) \subset \mathrm{SA}^+(X).
\]
\end{thm}
 

Also, since $0\in \mathrm{A}^+(\R^n)$, we have comparison. We omit the proof, which is essentially the same as in the case of pure second-order subequations. 

\begin{thm}[Comparison for gradient-free constant coefficient subequations]\label{thm:C_gf}
Let $\call F$ be a gradient-free constant coefficient subequation. Then comparison holds on every domain $\Omega \subset \R^n$:
\[
u+v \leq 0\ \text{on $\de \Omega$} \implies u+v \leq 0\ \text{on $ \Omega$}
\]
if $u \in \USC(\barr \Omega) \cap \call F(\Omega)$ and $v \in \USC(\barr \Omega) \cap \tildee{\call F}(\Omega)$.
\end{thm}

We conclude this subsection by noting that the results presented here are part of a more general program, which exploits a general method for determining the validity of the (ZMP) for dual cone subharmonics.

\begin{remark}[A general comparison theorem for constant coefficient potential theories]\label{rem:CP_cc}
The comparison principles of Theorems \ref{thm:C_pso} and \ref{thm:C_gf} are also corollaries of the general comparison principle for constant coefficient potential theories contained in \cite[Theorem~7.5]{chlp}. This result states that comparison for a constant coefficient subequation $\call F$ on a domain $\Omega$ holds if $\call F$ is $\call M$-monotone for a monotonicity cone subequation $\call M$ for which there exists a $C^2$-strictly $\call M$-subharmonic function $\psi$ on $\Omega$, as described in Remark \ref{rem:SAT_CC} above. The point is that the existence of $\psi$ ensures the validity of the (ZMP) for the $\widetilde{\call M}$-subharmonics on $\Omega$. Theorems \ref{thm:C_pso} and \ref{thm:C_gf} correspond to the monotonicity cone subequations
\begin{equation}\label{elem_cones}
	\call M(\call P) = \R \times \R^n \times \call P \quad \text{and} \quad \call M(\call N, \call P) = \call M(\call N) \cap \call M(\call P) = \call N \times \R^n \times \call P,
\end{equation}
	respectively. These two cones do admit a (quadratic) $C^2$-strictly $\call M$-subharmonic function $\psi$ on every bounded domain $\Omega$, as shown in Theorem 6.6 of \cite{chlp}. Moreover, the two cones in \eqref{elem_cones} are two members of a {\em fundamental family} of monotonicity cone subequations which are generated by double and triple intersections of $\call M(\call P)$ above, $	\call M(\call N) := \call N \times \R^n \times \call S(n)$ and three one-parameter cones:
	$$
	\call M(\gamma) := \{ (r,p,A) \in \call J^2: \ r \leq - \gamma |p| \}, \quad \gamma \in (0, +\infty);
	$$
		$$
	\call M(R) := \left\{ (r,p,A) \in \call J^2: \  A \geq \frac{|p|}{R} I  \right\}, \quad R \in (0, +\infty);
	$$
	$$
		\call M(\call D) := \R \times \call D \times \call S(n), \quad \call D \subset \R^n \ \text{is a {\em directional cone}};
	$$
that is,  $\call D$ is a closed convex cone with vertex at the origin and non-empty interior. Notice that $\call M(\call P)$ and $\call M(\call N)$ are the ``limits'' of $\call M(R)$ and $\call M(\gamma)$ for $R \nearrow + \infty$ and $\gamma \searrow 0$, respectively. For all of the cones in the fundamental family, the validity of the (ZMP) for  the $\widetilde{\call M}$-subharmonics on $\Omega$ and hence the vadidity of comparison for any $\call M$-monotone potential theory is known from the detailed analysis in \cite{chlp}. There is a simple dichotomy: comparison holds on every bounded $\Omega$ except for the case when the cone has a generator $\call M(R)$ with $R$ finite, and in this case comparison holds on all domains $\Omega$ which are contained in a translate of the truncated cone $\call D_R = \call D \cap B_R(0)$. The family above is fundamental in the sense that any monotonicity cone subequation contains one of the fundamental cones, and hence for every constant coefficient $\call M$-monotone potential theory, the comparison principle holds (with possibly a restriction on the size of the domain $\Omega$). 
\end{remark}

As a final consideration, the analysis discussed in Remark \ref{rem:CP_cc} has two additional extensions. First, by exploiting the {\em correspondence principle} of Theorem 11.13 of \cite{chlp} one deduces the validity of the comparison principle for every constant coefficient and $\call M$-monotone differential operator $F$ which is {\em compatible} with an $\call M$-monotone constant coefficient subequation $\call F$. Many applications of this are discussed in Part IV of \cite{chlp}. Second, in the variable coefficient case, if $\call F$ is also {\em fiberegular}, then the analysis above extends to the potential theory defined by $\call F$ as well as to associated PDE for any operator $F$ which is compatible with $\call F$. This program was carried out in \cite{cprdir}, which also gives characterizations of $\widetilde{\call M}$-subharmonics for the other monotonicty cones $\call M$ in the fundamental family, extending the characterizations above for the cones $\call M(\call P)$ and $\call M(\call N, \call P)$ (see Section 6 of \cite{cprdir})  The following subsection treats some complementary results to \cite{chlp} and \cite{cprdir}. 

\subsection{Strict comparison with minimal monotonicity and quasi-convex functions}\label{sec:SC}

In this subsection, we present some comparison principles which are not included in the aforementioned \cite{chlp} and \cite{cprdir}. These results give additional situations in which one has sufficient monotonicity in order to prove a form of comparison. In fact, the minimal monotonicity present in every subequation becomes sufficient, if one weakens comparison to a notion of {\em strict comparison}. In the variable coefficient setting, this form of comparison is shown to hold for quasi-convex functions, while, in the constant coefficient setting, it is shown to hold for functions which are merely semicontinuous. Two approaches for the semicontinuous version will be presented, both of which use quasi-convex approximation; one in an implicit sense and one in an explicit sense, which will be compared in Remark \ref{rem:SC}

We begin by noting that, by properties (P) and (N), every (variable coefficent) subequation $\call F$ has a constant coefficient monotonicity cone; namely the \emph{minimal monotonicity cone} 
$$
\call M_0 =\call N \times \{0\} \times \call P,
$$
which, \emph{a priori}, might be the maximal monotonicity cone for $\call F$. As noted previously, $\call M_0$ is not a subequation because it has empty interior and hence does not satisfy the topological property (T). In such a situation, the methods described in the previous subsection do not apply. However, one can ask under what situations does $\call M_0$-monotonicity for $\call F$  still yield comparison in the potential theory determined by $\call F$? One way is to focus on \emph{quasi-convex} subharmonics and to add a \emph{strictness} assumption. To that end, we give the following notion of \emph{strong strictness}.

\begin{definition} \label{def:strictv}
We say that $u \in \USC(X)$ is \emph{strongly strictly $\call F$-subharmonic on $X$} if $u \in \call G(X)$ for some subequation $\call G \subset \intr{\call F}$. We will write $u \in \call F_{\rm strict}(X)$.
\end{definition}

Note that this notion is, in general, stronger than the one of \Cref{def:strict}, even for classical subsolutions.

\begin{example}
For $n=1$ and $X=(0,1)$, consider $F(x,p) = x-p$. Then $u(x) = \frac{x^3}3$ is a strict smooth subsolution on $X$, according to \Cref{def:strict}, but it is not strongly strict in the viscosity sense of \Cref{def:strictv}. 
\end{example}

Harvey and Lawson~\cite{hlae} showed that one always has the \eqref{eq:ZMP} form of comparison if the subsolutions are quasi-convex and one of them is strongly strict, just like the Definitional Comparison \Cref{defcompa} tells that \eqref{eq:ZMP} holds, even without the quasi-convexity assumption, if one of the subsolutions is strict and smooth.

\begin{thm}[Strict comparison for quasi-convex functions] \label{scqc}
Let $\Omega \ssubset \R^n$ be a bounded domain and let $\call F$ be a subequation on $\Omega$.  Then strict comparison holds for quasi-convex functions:
\[
u+v \leq 0\ \text{on $\de\Omega$} \implies u+v \leq 0\ \text{on $\Omega$}.
\]
if $u \in \USC(\barr\Omega) \cap \call F_{\rm strict}(\Omega)$ and $v \in \USC(\barr\Omega) \cap \tildee{\call F}(\Omega)$ are locally quasi-convex on $\Omega$.
\end{thm}

\begin{proof}
Suppose, by contradiction, that strict comparison fails on $\Omega \ssubset \R^n$. Then $w= u+v$ must have a positive interior maximum $m\defeq w(x_0) > 0$ at $x_0 \in \Omega$. Hence $w$ has $(0,0)$ as an upper contact jet at $x_0$ and the Theorem \ref{pusc:sum} on summands yields
\[
(u(x_0), p, A) \in \call G_{x_0} \qquad \text{and} \qquad (v(x_0), q, B) \in \tildee{\call F}_{x_0}, 
\]
with $p+q = 0$ and $A+B = -P \leq 0$. This contradicts $\call G_{x_0} \subset \intr{\call F}_{x_0}$, since by positivity and negativity
\[
-(v(x_0), q, B) = (u(x_0)-m, p, A+P)  \in \call G_{x_0},
\]
but $-(v(x_0), q, B) \notin \intr{\call F}_{x_0}$ by the definition of the dual subequation.
\end{proof}

\begin{example}
\Cref{scqc} is indeed useful if we can assure \emph{a priori} that subsolutions and \emph{dual subsolutions} of a given equation are quasi-convex. For example, consider the Monge--Amp\`{e}re equation
\begin{equation}\label{maex}
\det D^2 u = f
\end{equation}
for some $f\in \LSC(\barr \Omega)$ which is positive and bounded from above. If we look for convex solutions, we immediately see that they are strongly convex, in the sense that the minimum eigenvalue $\lambda_1({D^2u}) \geq C$ on $\Omega$, for some $C>0$; indeed by semicontinuity and compactness we know that $f \geq c$ on $\Omega$, for some $c > 0$, while $\det D^2u \leq M$ for some upper bound $M>0$ on $f$. Therefore, if we restrict ourselves to strongly convex sub-- and supersolutions, we trivially have that subsolutions are quasi-convex. Also, since the fibers of the subequation associated to (\ref{maex}) are
\[
\call F_x = \R \times \R^n \times \big\{ A \in \Sc(n):\ \det A - f(x) \geq 0 \big\}, 
\]
we have that
\[
\tildee{\call F}_x = \R \times \R^n \times \big\{ B \in \Sc(n):\ \det (-B) - f(x) \leq 0 \big\}
\]
and the strong convexity assumption on the supersolutions leads us to require that the matrices $B$ are negative definite with their maximum eigenvalue $\lambda_n (B ) \leq \ell$ for some $\ell < 0$, independent of $x$. Therefore, we see that
\[
-\lambda_1(B)\cdot(-\ell)^{n-1} \leq \det(-B) \leq M \quad\implies\quad  \lambda_1(B) \geq -\Lambda \defeq \frac{-M}{(-\ell)^{n-1}},
\]
hence the dual subsolutions we are interested in are $\Lambda$-quasi-convex.
\end{example}

The assumption that $u$ and $v$ are quasi-convex can be dropped if $\call F$ and $\call G$ are constant coefficient subequations. The following result is  Corollary~C.3 of~\cite{hldir}. 
% The proof by quasi-convex approximation we are going to propose here is of course longer and appears more technical than Harvey--Lawson's one; nevertheless, the Theorem on Sums, which certainly is not a trivial result, hides most of the technicalities in proofs that exploits it. In this sense, our proof could be considered more elementary, as it explicitly uses only some basic properties of quasi-convex functions and constant coefficient subequations, yet we point out that it still needs all the nontrivial instruments (Alexandrov, Jensen) required in order to prove the Theorem on Sums: in our case, they are hidden in \Cref{pusc:sum}, which is used in the proof of \Cref{scqc}.
% 
\begin{thm}[Strict comparison for constant coefficient subequations] \label{sccc}
Let $\call F$ be a constant coefficient subequation.  Then the strict comparison holds on every bounded domain $\Omega \ssubset \R^n$:
\[
u+v \leq 0\ \text{on $\de\Omega$} \implies u+v \leq 0\ \text{on $\Omega$}
\]
 if $u \in \USC(\barr\Omega) \cap \call F_{\rm strict}(\Omega)$ and $v \in  \USC(\barr\Omega) \cap\tildee{\call F}(\Omega)$.
 \end{thm}
 
We will omit the short proof, which one finds in \cite{hldir}, noting only that it follows the same argument of its quasi-convex counterpart (\Cref{scqc}), where the Theorem in Summands \ref{pusc:sum} for (locally) quasi-convex functions is replaced by a potential-theoretic version of the Theorem on Sums~\ref{tosu} for semicontinuous functions.  Eventhough we will sketch an alternate proof of Theorem \ref{sccc}, for the benefit of the reader and in order to comment on the two approaches, we present Harvey and Lawson's potential-theoretic version (which is Theorem C.1 of \cite{hldir}). 

\begin{thm}[On Sums, simplified potential theoretic version] \label{tospt}
Let $\call F, \call G \subset \call J^2(X)$ be two subequations and let $u \in \call F(X)$, $v \in \call G(X)$. Suppose that $u+v$ does not satisfies the Zero Maximum Principle on $\Omega \ssubset X$. Then there exist a point $x_0 \in \Omega$ where $u(x_0) + v(x_0) >0$, a net $\{(x_\epsilon, y_\epsilon)\}_{\epsilon > 0} \subset \Omega \times \Omega$ converging to $(x_0, x_0)$, and matrices $A_\epsilon, B_\epsilon \in \call S(n)$ such that
\begin{gather} \label{tosptinc}
\Big(u(x_\epsilon), \frac{x_\epsilon-y_\epsilon}\epsilon, A_\epsilon\Big) \in \call F_{x_\epsilon}, \quad \Big(v(y_\epsilon), -\frac{x_\epsilon-y_\epsilon}\epsilon, B_\epsilon\Big) \in \call G_{y_\epsilon},
\\ \label{tosptconv}
u(x_\epsilon) + v(y_\epsilon) \dto u(x_0) + v(x_0),
\\ \label{tosptrate}
|x_\epsilon - y_\epsilon| = o(\sqrt\epsilon\,)
\\ \label{tosptineq}
-\frac3\epsilon \left(\! \begin{array}{cc}
I &  0 \\
0  & I \\
\end{array}\! \right) \leq \left(\! \begin{array}{cc}
A_\epsilon &  0 \\
0  & B_\epsilon \\
\end{array}\! \right) \leq \frac3\epsilon
\left(\! \begin{array}{cc}
I &  -I \\
-I  & I \\
\end{array}\! \right).
\end{gather} 
\end{thm}

\begin{proof}
Let $w(x,y) \defeq u(x) + v(y)$. For any $\epsilon > 0$, let $(x_\epsilon, y_\epsilon)$ be a maximum of $w(x,y) - Q_{\epsilon^{-1} I}(x-y)$ on $\barr\Omega \times \barr\Omega$;  by \cite[Proposition~3.7]{user}, by taking $\epsilon$ small enough, we may suppose that $(x_\epsilon, y_\epsilon) \in \Omega \times \Omega$. Then by \Cref{tosu} there exist $A_\epsilon, B_\epsilon$ such that \eqref{tosptinc} holds since $u \in \call F(X)$, $v \in \call G(X)$ and the fibers of subequations are closed, and
\[
-\frac1\epsilon \bigl( 1 + \Vert J\Vert \bigr) \,I \leq \left(\! \begin{array}{cc}
A_\epsilon &  0 \\
0  & B_\epsilon \\
\end{array}\! \right)
\leq \frac1\epsilon \bigl( J + J^2 \bigr), 
\]
which is easily seen to be \eqref{tosptineq}. Finally, all the remaining properties to prove easily follow again from \cite[Proposition~3.7]{user}.
\end{proof}

We conclude with some reflections on the role of quasi-convex approximation in strict comparison under minimal monotonicity.

\begin{remark}[Strict comparison and quasi-convex approximation]\label{rem:SC}
The proof of Theorem \ref{sccc} above is an ``almost conventional'' viscosity theory proof in that it exploits a potential-theoretic formulation of the conventional Theorem on Sums (based on the doubling of variables and penalization). Quasi-convex approximation (by way of the supconvolution) appears implicitly in the proof, since it plays a crucial role in the proof of the Theorem on Sums. 

One might ask if an explicit use of the quasi-convex approximation technique can reduce  Theorem \ref{sccc} to the quasi-convex version of Theorem \ref{scqc}. If so, one would be extending the quasi-convex approximation technique from sufficient monotonicity $\call M$ (as discussed in the previous subsection) to minimal monotonicity $\call M_0$, at least for strict comparison. One encounters a possibile obstruction to this intent; namely, one would like to know that the quasi-convex approximations preserve subharmonicity for the subequations $\call G$ and $\widetilde{\call F}$. \Cref{prop:approx} says that this is true, provided that such subharmonics are bounded. 

Boundedness from above on compact sets is ensured by the upper semicontinuity of the subharmonics. The problem is that they may not be bounded from below. The decreasing limits property of $\call F$-subharmonics in Proposition \ref{elemprop} v) suggests that one might first approximate an $\call F$-subharmonic $u$ with a deceasing sequence $\{u_m\}_{m \in N}$ of functions which are bounded from below and $\call F$-subharmonic. Simple truncation from below with $u_m := \max \{ u,- m\}$ works if each constant $m \in N$ is an $\call F$-subharmonic by the maximum property of Proposition \ref{elemprop} ii). More generally, as seen in the proof proof of \Cref{ccsa}, one can take $u_m := \max \{ u, \varphi - m\}$ for any fixed $\call F$-subharmonic which is bounded from below. Unfortunately, the existence of such a bounded subharmonic $\varphi$ is, in general, only guaranteed locally (as discussed in Remark \ref{exquadsub}).

Therefore, in a proof of strict comparison with minimal monotonicity $\call M_0$ by an explicit quasi-convex approximation, one should first show that one can assume without loss of generality that the subharmonics are bounded (for example, by proving the existence of  a bounded global subharmonic for $\call G$ and $\widetilde{\call F}$) or find a way to carry the global information of the behavior of $u+v$ on $\de\Omega$ into a neighborhood of some given point (for instance, a point in $\Omega$ at which $u+v$ assumes its positive maximum, if one is proceeding by contradiction). If instead, one tries to work only locally as in the proof of \Cref{scqc}, then the most immediate path probably leads to a proof with the flavour of the Theorem on Sums, since it is likely that one eventually ends up needing results like \Cref{pusc:sum} and \Cref{magprop}.

%The hard analysis part, which combines Jensen's Lemma, Alexandrov's Theorem and the supconvolution are hidden in the proof the Theorem on Sums. 
	
	
%We believe that ``any'' proof of the above result trying to exploit the quasi-convex approximation technique we depicted ends up using the same instruments around which the proof of the Theorem on Sums is built. Indeed, proving \Cref{sccc} via \Cref{scqc} would hide the use of Alexandrov's theorem and of the Jensen--S{\l}odkowski Theorem, which are combined in the proof of \Cref{pusc}, yielding \Cref{pusc:sum}. Also, if one wishes to use \Cref{prop:approx} in order to make the subharmonics quasi-convex (and still subharmonic) in order to apply \Cref{scqc}, the problem is that an additional hypothesis of boundedness of the subsolutions could be needed. Note that one cannot simply truncate the functions from below, say by defining $\tilde u \defeq \max\{u, -m\}$, $m>0$, since in general (and this is the case) the subharmonicity is not preserved if one takes the maximum of a subharmonic and a nonsubharmonic. The standard method of showing that one can assume, without loss of generality, that subsolutions are also bounded from below is the method used in the proof of \Cref{ccsa}. More precisely, one defines $\tilde u \defeq \max\{u, \phi-m\}$, where $\phi$ is any bounded subharmonic, so that the subharmonicity of $\tilde u$ is guaranteed by the maximum property. However, for comparison this method encounters the difficulty that bounded subharmonics are in general only known to locally exist (see \Cref{exquadsub}), while the global information $u+v\leq 0$ on $\de\Omega$ should be somehow preserved.
	
%Hence, in our opinion, Harvey--Lawson's proof of \Cref{sccc} via the Theorem on Sums should be considered the most natural proof via quasi-convex approximation. An alternative proof might be more explicit, but not more elementary. On the other hand, if one knows that the subsolutions are bounded (or that there exist a bounded $\call G$-subharmonic and a bounded $\tildee{\call F}$-subharmonic), then \Cref{magprop} is not needed and thus a slightly more elementary proof is possible.
\end{remark}


To complete the discussion, we give a proof of strict comparison for constant coefficient potential theories with minimal monotonicity $\call M_0$, provided that the following additional hypothesis is made:
\begin{equation}\label{sc_hyp}
\mbox{\em there exist $\Phi \in \call G(\Omega)$ and $\Psi \in \tildee{\call F}(\Omega)$ which are bounded (from below) on $\barr\Omega$.}
\end{equation}

\begin{proof}[Proof of \Cref{sccc} assuming \eqref{sc_hyp}] 
	By contradiction, suppose that strict comparison fails for some $\Omega \ssubset \R^n$; hence there exists $\barr x \in \Omega$ such that $u(\barr x) + v(\barr x) := M > 0$. For each $\eta \in (0, M)$ fixed, by the sliding property of Proposition \ref{elemprop} iv), $\hat u \defeq u-\eta \in \call G(\Omega)$ and one still has $\hat u(\barr x) + v(\barr x) > 0$. 
	
	Now, with $\Phi$ and $\Psi$ satisfying \eqref{sc_hyp}, define for each for $m \in \N$
	$$
	u_m \defeq \max\{ \hat u, \Phi - m\} \quad \text{and} \quad v_m \defeq \max\{ v, \Psi - m\}.
	$$ 
	Note that $u_m$ and $v_m$ are bounded on $\barr\Omega$, $u_m \dto u$ and $v_m \dto v$ pointwise on $\barr\Omega$ as $m \to +\infty$, and $u_m(\barr x) + v_m(\barr x) \geq \hat u(\barr x) + v( \barr x) > 0$ for all $m \in \N$. In addition, one has $u_m \in \call G(\Omega)$ and $v_m \in \tildee{\call F}(\Omega)$, by the maximum property.
	Quasi-convex approximation (\Cref{prop:approx}) yields the supconvolutions $u_m^\epsilon \in \call G(\Omega_\delta)$ and $v_m^\epsilon \in \tildee{\call F}(\Omega_\delta)$,  where 
	$$
		\delta = \delta(\epsilon) \defeq 2\sqrt{\epsilon \max\{\max_{\barr{\Omega}}|u_m|, \max_{\barr{\Omega}}|v_m|\}}.
	$$
	These quasi-convex approximations satisfy $u_m^\epsilon(\barr x) + v_m^\epsilon(\barr x) \geq u_m(\barr x) + v_m(\barr x) > 0$ for each small $\epsilon > 0$.
	Therefore, by the strict comparison for quasi-convex functions (\Cref{scqc}), for any $\epsilon >0$ so small that $\barr x \in \Omega_\delta$, there exists a point $y_\epsilon$ such that 
	\begin{equation} \label{disban}
	u_m^\epsilon(y_\epsilon) + v_m^\epsilon(y_\epsilon) > 0,\quad y_\epsilon\in \de\Omega_\delta.
	\end{equation}
	Consider now a vanishing sequence $\epsilon_k \dto 0$. By the compactness of $\barr{\Omega}$, up to a subsequence, $y_k \defeq y_{\epsilon_k} \to \barr y \in \de \Omega$ as $k\to\infty$. Set $\delta_k := \delta(\epsilon_k)$ and note that, by (\ref{disban}), one has
	\[
	u_m^{\epsilon_k}(y_k) + v_m^{\epsilon_k}(y_k) > 0, \quad y_k \in \de\Omega_{\delta_k} \qquad \forall\, k\in \mathbb{N}.
	\]
	Also, by (\ref{supcball}), one has
	\begin{equation}\label{SC_bound}
	u_m^{\epsilon_k}(y_k) \leq \max_{\barr B_{\delta_k}(y_k)} u_m \qquad  \forall k\in \mathbb{N}.
\end{equation}
	Now, since $\delta_k \dto 0$ and $y_k \to \barr y \in \de\Omega$ as $k \to +\infty$, for each  $\rho > 0$ fixed one has  $B_{\delta_k}(y_k) \subset B_\rho(\barr y)$ if $k$ is large enough.  Hence, taking the limsup in \eqref{sc_bound}, one obtains
	\[
	\limsup_{k\to\infty} u_m^{\epsilon_k}(y_k) \leq \max_{\barr B_\rho( \barr y)} u_m \qquad \forall \rho > 0
	\]
	and then taking the limit $\rho \dto 0$ yields
	\[
	\limsup_{k\to\infty} u_m^{\epsilon_k}(y_k) \leq \limsup_{z \to  \barr y} u_m(z) \leq u_m( \barr y),
	\]
	where the last inequality comes from the upper semicontinuity of $u_m$.
	The same argument applied to $v_m$ gives that $u_m( \barr y) + v_m( \barr y) \geq 0$
	and, letting $m \to +\infty$, one has $\hat u( \barr y) + v( \barr y) \geq 0$;
	that is,
	\[
	u( \barr y) + v( \barr y) \geq \eta > 0, \quad  \barr y \in \de \Omega,
	\]
	which gives the desired contradiction.
\end{proof}



\section{From the Euclidean space to manifolds: a brief note}\label{sec:mflds}

In our presentation we decided to remain in the Euclidean context. However, many of the results discussed here extend to Riemannian manifolds; for example, the Almost Everywhere Theorem~\ref{aet}, the Subharmonic Addition Theorem~\ref{add} and the Strict Comparison Theorem~\ref{scqc} have been given in \cite{hlae} in a more general form on manifolds. We note that, roughly speaking, \emph{all local results naturally extend from Euclidean spaces to manifolds}, via a suitable use of local coordinates. 

In this passage, one needs to extend the definition of quasi-convex function to real-valued functions defined on a manifold $M$. The usual definition of a convex function on a Riemannian manifold is that of a function which is convex \emph{along each geodesic}; that is, $f \colon M \to \R$ is convex on a geodesically convex subset $U \subset M$ if and only if $f \circ \gamma \colon (-\epsilon, \epsilon) \to \R$ is convex (in the real sense) for every geodesic segment $\gamma\colon (-\epsilon, \epsilon) \to U$.
Hence, by paraphrasing the idea that a quasi-convex function is convex modulo a quadratic perturbation, one can give, on connected manifolds, the following definition:
\begin{center}
\emph{$f$ is $2\lambda$-quasi-convex if $f + \lambda\, d(\cdot, p)^2$ is convex for all $p \in M$},
\end{center}
where $d$ is the standard metric on $M$ induced by the Riemmann structure.

When $M = \R^n$ is a Euclidian space, this definition is equivalent to the one we have  given in $\R^n$. Alternatively, one could only ask that $f+\lambda\;\! d(\cdot, p)^2$ be convex for at least one point $p \in M$. The two definitions are clearly equivalent in the Euclidean case, and in general on every manifold with zero sectional curvature. However, the first definition is, in general, stronger and it is the right definition for many purposes. For example, the stronger definition gives the extension to Riemannian manifolds of the characterization $$
\mbox{\emph{functions which are both quasi-convex and quasi-concave are of class $C^{1,1}$}}, 
$$
as noted in \cite{azgafeqc}.\footnote{Let us also note that on manifolds with positive curvature it could be tedious that $d(\cdot, p)^2$ is not convex; for instance, one cannot say that $f$ being $\lambda$-quasi-convex implies that $f$ is $\mu$-quasi-convex for all $\mu > \lambda$.}

On the other hand, often one needs only \emph{local} quasi-convexity, a notion which requires some additional explanation. One makes use of the {\em normal neighborhood theorem} (see, e.g., Theorem 9.14 of \cite{spi1}) which states that for every $p_0 \in M$ and $\epsilon > 0$ there exists a neighborhood $W$ of $p_0$ such that each pair of points $q, q' \in W$ is connected by a unique minimal geodesic parametrized on $[0,1]$ and of length less than $\epsilon$; namely, $\gamma_{q,q'}(t) = \exp_q(tv)$ for the unique $v = v(q,q') \in T_qM$ with $|v| < \epsilon$. For such a normal neighborhood $W$, one then can define
\[
\text{\em $f$ is $2\lambda$-quasi-convex on $W$ if} \ \ \left\{ \begin{array}{l} \text{\em the map $t \mapsto f(\exp_q(t v))+ \lambda|tv|^2$ is convex on $[0,1]$} \\ \text{\em for each $q \in W$ and any $v \in B_\epsilon(0) \subset T_qM$}.
\end{array} \right.
\]
This leads to a natural extension of the definition of local quasi-convexity. Notice that, in a normal chart $(U,\phi)$ about $q \in M$,\footnote{That is, a coordinate chart $(U, \phi)$ with $U = \exp_q(B_\epsilon(0))$ and $\phi = \psi \circ \exp^{-1}$, for some linear isometry $\psi \colon T_q M \to \R^{m}$, where $m =\mathrm{dim}\, M$.} the function $f \circ \phi^{-1}$ is $2\lambda$-quasi-convex along each small linear segment starting from $0 \in \R^m$.
This partially motivates why one can also rightfully say, without relying on the metric, that
\[
\text{\em $f$ is locally quasi-convex on $M$ if} \ \ \left\{ \begin{array}{l} \text{\em $f \circ \phi^{-1}$ is quasi-convex on $\phi(U) \subset \R^m$} \\ \text{\em for at least one chart $(U, \phi)$ per $p\in M$}.
\end{array} \right.
\]
Adopting this definition of local quasi-convexity, one straightforwardly extends to Riemannian manifolds the results mentioned at the beginning of the section.

\section*{Acknowledgements}
The authors express their deep gratitude to Blaine Lawson and Reese Harvey for their generosity and encouragement to perform and updated and enriched synthesis of the unpublished manuscripts \cite{hlqc} and \cite{hlae}. In addition, numerous useful conversations with Reese Harvey have contributed to the development of this work. The authors are partially supported by the Gruppo Nazionale per l'Analisi
Matematica, la Probabilit\`a e le loro Applicazioni (GNAMPA) of the Istituto Nazionale di Alta Matematica
(INdAM), Italy. Redaelli partially supported by Fondazione Cassa di Risparmio di Padova e Rovigo, Italy.

%%CHANGE APPEAREANCE OF APPENDICES
\makeatletter
%default definition of article.cls
%using \renewcommand instead of \newcommand
\renewcommand\part{%
   \if@noskipsec \leavevmode \fi
   \par
   \addvspace{4ex}%
   \@afterindentfalse
   \secdef\@part\@spart}

\def\@part[#1]#2{%
    \ifnum \c@secnumdepth >\m@ne
      \refstepcounter{part}%
      \addcontentsline{toc}{part}{\partname~\thepart.\hspace{1em}#1}%
    \else
      \addcontentsline{toc}{part}{#1}%
    \fi
    {\parindent \z@ \raggedright
     \interlinepenalty \@M
     \normalfont
     \ifnum \c@secnumdepth >\m@ne
      \center \normalsize\bfseries \partname\nobreakspace\thepart
     .%  \par\nobreak
     \fi
     \enspace \normalsize \bfseries #2%
     %%%\markboth{}{}\par}% removing redefinition of headings
     \par}%
    \nobreak
    \vskip 3ex
    \@afterheading}
\def\@spart#1{%
    {\parindent \z@ \raggedright
     \interlinepenalty \@M
     \normalfont
     \huge \bfseries #1\par}%
     \nobreak
     \vskip 3ex
     \@afterheading}
\makeatother
%%

\begin{appendix}
\renewcommand\partname{Appendix}
\renewcommand\thepart{A}
\renewcommand\thesection{A}
\setcounter{thm}{0}

\part{The Legendre transform and Alexandrov's theorem}

\label{ap:legalex}

This appendix, together with the next appendix, provides a self-contained proof of Alexandrov's~\Cref{aleks} on second order differentiability of convex functions. The proof is based on two ingredients. The first ingredient concerns properties of the Legendre transform, which is well known to be an important tool in the study convex functions. Roughly speaking, this transform provides a means of passing from first-order differentiability to second-order differentiability for convex functions. The second ingredient is a Lipschitz version of Sard's theorem (\Cref{sard}).

Our proof of Alexandrov's theorem follows the main steps of Harvey and Lawson's proof (see \cite{hlqc}), which are basically the same as those proposed by Crandall, Ishii and Lions propose in~\cite{user}. A different proof exploiting Lebesgue's Differentiation Theorem and mollifications is given in the monograph of Evans and Gariepy~\cite{evansgar}.

We begin with the definition of Legendre transform. Let $f\colon X \to \R$ be a convex function on a convex open set $X\subset \R^n$, and let $\de f$ be its subdifferential as defined in Definition \ref{def:subd}.
%\footnote{Note that since we implicitly assume (by writing that $f$ is real-valued) that the domain of $f$ is the whole $X$, then $\de f(x) \neq \emptyset$ for all $x\in \Omega$ by the Hahn--Banach Theorem, as we already said. However, what follows holds indeed also if $f$ is proper and $\Omega$ is suitably substituted by $\mathrm{dom}f$.}

\begin{definition}
The {\em Legendre transform $g = \scr Lf$ of $f$} is the function $g\colon \de f(X) \to \R$ defined by the relation
\begin{equation}	\label{leg:def}
f(x) + g(y) = \pair xy \qquad \forall (x,y)\in\de f;
\end{equation}
that is, one defines
\begin{equation}	\label{leg:def2}
g(y) \defeq \pair xy - f(x) \quad \forall y \in \de f(x), \ x \in X
\end{equation}
\end{definition}

\begin{remark}[Alternate definition of the Legendre transform] \label{Lt:aboveremark}
Notice that the definition \eqref{leg:def2} is somewhat implicit; that is, in order to define $g(y) = \scr L f(y)$ for a given $y \in \de f(X) = {\rm dom}(g)$, one must identify a fiber $\de f(x)$ in which $y$ lives. A more explicit way to define the Legendre transform $g$ of $f$ involves an optimization procedure based on the observation that
\[
(x, y) \in \de f \quad \iff \quad f(x) + \pair y{z-x} \leq f(z), \quad \forall z\in X,
\]
or equivalently
$$
f(z) - \pair{y}{z} \geq f(x) - \pair{y}{x}, \quad \forall z\in X.
$$
Hence $(x,y) \in \de f$ if and only if the function $f - \pair y\cdot$ assumes its minimum value on $X$ in the point $x$. That minimum value defines $-g(y)$; that is,
\[
-g(y) \defeq \inf_{z \in X} \big(f(z) - \pair{y}{z} \big) \quad \forall y \in \de f(X),
\]
or equivalently
\begin{equation}\label{def:leg_sup}
g(y) \defeq \sup_{z \in X} \big(\pair{y}{z} - f(z) \big) \quad \forall y \in \de f(X).
\end{equation}
We will see that these equivalent formulations \eqref{leg:def2} and \eqref{def:leg_sup} are both useful.
\end{remark}

The first result we prove is that the Legendre transform is an involution that produces a convex function whose subdifferential is the inverse of the subdifferential of $f$, in the sense of multivalued maps.

\begin{prop} \label{leg:gen}
Let $f: X \to \R$ be convex on $X \subset \R^n$ open and convex. Then the following properties hold.
\begin{itemize}
	\item[(a)] $y \in \de f(X)$ if and only if 
	\begin{equation} \label{leg:sup}
	\scr L f (y) = \sup_{z\in X} \left( \pair yz - f(z) \right);
	\end{equation}
	\item[(b)] $\scr Lf: \de f(X) \to \R$ is convex;
	\item[(c)] for each $x\in X$, $y\in \de f(X)$,
	\[
	(x,y) \in \de f \ \ \iff \ \ (y,x) \in \de \scr L f;
	\]
	\item[(d)] $\scr L$ is an involution; that is, $\scr L(\scr L f)\big|_X = f$.
\end{itemize}
\end{prop}

\begin{proof}
 The equivalence of part (a) has been presented in \Cref{Lt:aboveremark}. 

The convexity of $\scr Lf$ in part (b) now follows from the fact that $\scr L f$ is the supremum of the family of affine functions $\{\pair\cdot z - f(z)\}_{z\in X}$.

For the implication $(\Longrightarrow)$ of part (c), let $(x,y) \in X \times \de f(X)$. Suppose that $(x,y)\in\de f$ (that is, $y \in \de f(x)$). In order to show that $(y,x) \in \de g$ where $g = \scr L f$, one needs to show that $y \in \de f(x)$; that is,
\begin{equation}\label{dual_leg1}
g(y) + \pair{x}{w-y} \leq g(w), \quad \forall \, w \in {\rm dom}(g) = \de f(X).
\end{equation}
For arbitrary $w\in \de f(X)$ we have $w \in \de f(z)$ for some $z\in X$ and hence
\begin{equation}\label{dual_leg2}
f(z) + \pair{w}{\hat{x}-z} \leq f(\hat{x}), \quad \forall \, \hat{x} \in X.
\end{equation}
By the definition \eqref{leg:def2} of the Legendre transform we have
\begin{equation*}%\label{dual_leg3}
w \in \de f(z) \ \ \Rightarrow \ \ g(w):= \pair{z}{w} - f(z)
\end{equation*}
and
\begin{equation*}%\label{dual_leg4}
y \in \de f(x) \ \ \Rightarrow \ \ g(y):= \pair{x}{y} - f(x)
\end{equation*}
which imply
\begin{equation*}%\label{dual_leg5}
g(y) + \pair{x}{w-y} = \pair{x}{w} - f(x) = g(w) + \pair{x-z}{w} + f(z) - f(x) \leq g(w),
\end{equation*}
where the last inequality uses \eqref{dual_leg2} in $\hat{x} = x$ and gives \eqref{dual_leg1}. Notice that we also have $X \subset \de g(\de f(X))$ since $x \in X$ is arbitrary and $y \in \de f(x) \neq \emptyset$ implies $x \in \de g(y)$.

For the involution claim of part (d), notice that we have shown that $(x,y) \in \de f$ implies that $(y,x) \in \de \scr L f = \de g$, where $g$ is convex. Hence, for each $x \in X$, by the definition \eqref{leg:def}, we have
\begin{equation*} \label{eq:Linvol}
\scr L(\scr Lf)(x) = \scr Lg(x) := \pair xy - g(y) := \pair xy - \pair yx + f(x) = f(x), 
\end{equation*}
which proves {(d)} since $x \in X$ is arbitrary.

Finally, we need to prove the implication $(\Longleftarrow)$ of part (c).  Let $(x,y) \in X \times \de f(X)$ and suppose that $(y,x) \in \de \scr Lf$. We now have by \eqref{leg:def2} and the involution of part (d)
$$
\pair{x}{y} =  \scr L f (y) + \scr{L}\!\scr{L}f (y) =  \scr L f (y) + f(x)
$$
and hence by \eqref{leg:sup}
\[
\pair xy = \sup_{z\in X} \left( \pair{y}{z} - f(z) \right) + f(x) \geq  \pair{y}{z} - f(z) + f(x), \quad \forall z \in X,
\]
yielding $f(z) \geq  f(x) + \pair y{z-x}$ for each $z \in X$; that is, $y \in \de f(x)$, which is equivalent to $(x,y) \in \de f$.
\end{proof}

\begin{remark}
It is false in general that
\[
(x,y) \in \de f \ \iff \ (y,x) \in \de g.
\]
This is because the implication ``$\Longleftarrow$'' requires \emph{a priori} that $x \in X$. In other words, $(y,x) \in \de g$ does not imply that $(x,y) \in \de f$ if $x$ is only assumed to belong to $\de g(\de f(X)) \supset X$, which is all that is needed for the definition of the subdifferential of $g$. This happens because, in general, $\de g(\de f(X)) \supsetneqq X$, which also implies that $\scr L\!\scr L f \neq f$. For example, consider $f = |\cdot|$, defined on $X=(-1,1) \subset \R$; it is easy to see that
\[
\de f(x) = \begin{cases}
-1 & \text{if $x \in (-1,0)$} \\
[-1,1] & \text{if $x = 0$} \\
1 & \text{if $x \in (0,1)$}
\end{cases},
\]
so that, according to \eqref{leg:def}
\[
g \defeq \scr Lf \equiv 0 \quad \text{on} \quad \de f(X) = [-1,1].
\]
Therefore,
\[
\de g(y) = \begin{cases}
(-\infty, 0] & \text{if $y = -1$} \\
0 & \text{if $y \in (-1,1)$} \\
[0,+\infty) & \text{if $y = 1$}
\end{cases}
\]
and
\[
\scr L g = \scr L\!\scr L f = |\cdot| \quad \text{on} \quad \de g(\de f(X)) = \de g([-1,1]) = \R \supsetneqq (-1,1) = X.
\]
For the sake of completeness, we also mention that this example is based on the fact that the function $\tilde f$ defined on $\R$ by $\tilde f = f$ in $(-1,1)$ and $f \equiv +\infty$ in $\R \setminus (-1,1)$ is not a {\em closed} convex function.
%\footnote{Recall that function is said to be closed if its epigraph is closed. One can prove that a convex function is closed if and only if it is lower semicontinuous. Furthermore, one can prove that lower semicontinuous convex functions on open convex subsets $X \subset \R^n$ are in fact continuous.}
On the other hand, the Fenchel--Moreau Theorem tells that if $f \colon \R^n \to \R$ is defined on the whole $\R^n$ (that is, we have $f \colon \R^n \to \R$ convex), then the equality $\scr L\!\scr L f = f$ is equivalent to $f$ being closed. Since one can always think of $f \colon X \to \R$ as $\tilde f \colon \R^n \to \R$ letting $\tilde f \equiv +\infty$ on $\R^n \setminus X$, in such a way that $\de f(x) = \de \tilde f(x)$ for each $x \in X$ while $\de \tilde f(x) = \emptyset$ if $x \notin X$ in order not to alter the domain $\de f(X)$ of the Legendre transform, one sees that $\scr L\!\scr Lf = f$ if and only if $\mathrm{dom}\,\scr L\!\scr L\tilde f \defeq \{ x \in \R^n :\ \scr L\!\scr L\tilde f < +\infty \} = \mathrm{dom}\, \tilde f = X$, it and only if $\scr L\!\scr L\tilde f = \tilde f$, if and only if $\tilde f$ is closed, which forces $X = \R^n$. Therefore, we conclude that one has $\scr L\!\scr L f = f$ in \Cref{leg:gen}{\em(iv)} only in the trivial case $X = \R^n$. The reader can consult \cite{rock} or \cite{vesely} for further details.
\end{remark}

Having defined and examined some basic properties of the Legendre transform of an arbitrary convex function, we will know show that much more can said about the Legendre transform of convex functions of the form 
\begin{equation} \label{fform}
f = ru + \tfrac 12 |\cdot |^2, \quad r>0, u \ \text{convex}.
\end{equation}
Recall that our final goal is to prove Alexandrov's theorem and note that $u$ is twice differentiable at some point if and only if $f$ is; this will be used later.

\begin{prop} \label{leg:f}
Let $u\colon X \to \R$ be a convex function and let $r > 0$; define $f$ as in~\emph{(\ref{fform})}. Then the following hold:
\begin{itemize}
	\item[(a)] the subdifferential $\de f \colon X \to \scr P(\R^n)$ is an expansive map; i.e.,
	\begin{equation} \label{leg:espan}
	|y_2 - y_1| \geq |x_2 - x_1| \quad \forall y_j \in \de f(x_j), \ j=1,2;
	\end{equation}
	\item[(b)] the subdifferential $G\defeq \de g$ of $g = \scr L f$ is a single-valued function from $\de f(X)$ onto $X$, and it is the inverse of $\de f$; that is,
	\[
	G(\de f(x)) = x \quad \forall x \in X;
	\] 
	\item[(c)] $G$ is contractive ($1$-Lipschitz); that is,
		\begin{equation} \label{leg:contr}
	|G(y_2) - G(y_1)| \leq |y_2 - y_1| \quad \forall y_j \in \de f(x_j), \ j=1,2.
	\end{equation}	
\end{itemize}
If, in addition, $u$ is bounded with $M\defeq \sup_X |u|$, $\delta \defeq 2\sqrt{rM}$ and $X_\delta \defeq \{ x\in X: d(x,\de X) > \delta \}$, then the following hold:
\begin{itemize}
	\item[(d)]  $X_\delta\subset \de f(X)$ and $\de f(X_{\delta}) \subset X$;
	\item[(e)] $g\defeq \scr L f\in C^1(X_\delta)$, with $Dg = G$ on $X_\delta$.
\end{itemize}
\end{prop}

\begin{proof}
First of all, by \Cref{lem:subdiffsum} applied to $ru$ and $\frac12{|\cdot|^2}$ we have $\de f = r\de u + \I$. Therefore if $x\in X$, $y,p\in\R^n$ are related by $y = x + rp$, then
\begin{equation}\label{subd_legendre}
(x,y) \in \de f \iff (x,p) \in \de u.
\end{equation}

For the expansivity claim of part (a), consider  $(x_j, y_j) \in \de f$, with $j=1,2$ and $p_j \defeq (y_j - x_j)/r$. Using \eqref{subd_legendre}, we have $p_j \in \de u(x_j)$ and then by the monotonicity of $\de u$ (\Cref{subdmon}) we have
\begin{equation}\label{mono_subd}
	\pair{p_2 - p_1}{x_2 - x_1} \geq 0, \quad \forall \, p_j \in \de u(x_j), j = 1,2,
\end{equation}
from which it follows that
\[
|y_2-y_1||x_2-x_1| \geq \pair{y_2-y_1}{x_2-x_1} = |x_2-x_1|^2 + r\pair {p_2-p_1}{x_2-x_1} \geq |x_2 - x_1|^2,
\]
which yields \eqref{leg:espan}. 

For the claims of part (b), let $x_1,x_2 \in G(y) \cap X$ with $y \in \de f(X)$. Then by \Cref{leg:gen}{(c)} one has $y \in \de f(x_1) \cap \de f(x_2)$, and thus $x_1 = x_2$ by \eqref{leg:espan}. Therefore $G(\de f(x)) \cap X = \{ x \}$ for each $x \in X$, and in fact $G(\de f(x)) = \{ x \}$ for each $x \in X$; indeed, this easily follows from the fact that $G(\de f(x))$ is convex (by \Cref{lem:intpropsubdiff}{(a)} and \Cref{leg:gen}{(b)}) and $X$ is open. This shows that $G$ is single-valued and it is the inverse of $\de f$.

The contractivity of $G$ in part (c) follows easily. Indeed, in light of part (b), one has $x_j = G(y_j)$ in \eqref{leg:contr}; that is,
\[
|G(y_2) - G(y_1)| \leq |y_2 - y_1| \quad \forall y \in \de f(X).
\]

Now assuming that $u$ convex is also bounded, we verify the claims of parts (d) and (e). 
First for $y\in X_\delta$ we will show that $y \in \de f(X)$. To that end, we first note that the continuous function defined by $h_y \defeq ru + \frac12|\cdot-\,y|^2$ satisfies
\[
\inf_X  h_y = \min_{\barr B_\delta(y)} h_y.
\]
Indeed, if $z\notin \barr B_\delta(y)$ we have (where by hypothesis $|u| \leq M$ on $X$):
\[
h_y(z) - h_y(y) = ru(z) + \tfrac12|z-y|^2 - ru(y) > -2rM + \tfrac12\delta^2 = 0,
\]
therefore  $\min_{\barr B_\delta(y)} h_y \leq h_y(y) \leq \inf_{X\setminus \barr B_\delta(y)} h_y$. Now let $x \in \barr B_\delta(y)$ be a point which realizes the minimum of $h_y$ on $X$. Hence, $0\in \de h_y(x)$; that is, $0 = rp + (x-y)$ for some $p\in \de u(x)$. Hence, we have that $y\in\de f(X)$ by \eqref{subd_legendre}, which proves the first inclusion in part (d).

Next, for $y\in \de f (X_{\delta})$ we will show that $x \in X$. Since $y\in \de f (X_{\delta})$, we have $y \in \de f (x)$ for some $x\in X_{\delta}$. We know that $f- \pair y\cdot $ has a minimum point on $X$ at $x$. This is equivalent to $h_y$ having a minimum point on $X$ at $x$, since by definition $h_y = f -\pair y\cdot + \frac12|y|^2$. Then, $h_y$ has a minimum point at $x$, and we have
\[
|x-y|^2 \leq 2r(u(z)-u(x)) + |z-y|^2 \quad \forall z\in X, 
\]
yielding
\[
 |x-y|^2 \leq 4rM + |z-y|^2 \quad \forall z\in X
\]
and thus, taking the infimum over $z\in X$,
\begin{equation} \label{usata:lemLf}
|x-y| \leq \sqrt{\delta^2 + d(y, X)^2} \leq \delta + d(y, X).
\end{equation}
Suppose now that $y\notin X$ and consider the linear segment $I\defeq[x,y]$; since it is connected, there exists some point $w\in\de X \cap I$, otherwise $\{X,\barr X{}\compl\}$ would be a separation of $I$. We have
\[
d(x,\de X) \leq |x-w| = |x-y| - |y-w| \leq \delta,
\]
where we used \eqref{usata:lemLf} for the last inequality, since $|y-w| \geq d(y,\barr X) = d(y,X)$. This contradicts the hypothesis that $x\in X_{\delta}$, thus $y\in X$.

Finally, the claims of part (e) follow easily. Since $G=\de g$ is single-valued, we know that $G=Dg$ on $X_\delta \subset \de f(X)$, and that $G$ is continuous; see \Cref{deusingv}.
\end{proof}

The proof of Alexandrov's theorem will depend on two ingredients (\Cref{mplt} and \Cref{sard} below). The former is a crucial property of the Legendre transform, which provides a useful sufficient condition for $f$ defined by~(\ref{fform}), with $u$ convex and bounded, to be twice differentiable. It essentially states that the subdifferential $G$ of the Legendre transform $g$ of $f$ maps the complement of its critical points $k_G$ to a set of points where $f$ is twice differentiable; that is, $G(X_\delta \setminus k_G) \subset \mathrm{Diff}^2 f$, where $X_\delta$ is defined as in \Cref{leg:f}. The latter is a Lipschitz version of Sard's theorem. It allows one to handle the set of ``bad'' points (namely the set of critical values of $G$, which is a Lipschitz function by \Cref{leg:f}{(c)}), by showing that this set has zero Lebesgue measure.

Let us recall what critical points and critical values are, state and prove the former ingredient (\Cref{mplt}). Then we will state the latter ingredient (\Cref{sard}) and use it in the proof of Alexandrov's theorem, while the reader is invited to have a look at the next Appendix~\ref{proofsard} for a technical measure-theoretic proof of \Cref{sard}, based on Besicovitch's covering theorem.

\begin{definition}
Let $\Omega \subset \R^n$ be open and let $G\colon \Omega \to \R^n$. We define the set of \emph{critical points} of $G$ to be
\[
k_G \defeq \big\{x\in \Omega:\ \text{either $DG(x)$ does not exists or $\det DG(x) = 0$} \big\},
\]
and we call $G(k_G)$ the set of \emph{critical values} of $G$.
\end{definition}

The fist needed ingredient is the following.

\begin{lem}[Magic property of the Legendre transform]	\label{mplt}
Let $f$ be defined by (\ref{fform}); that is, $f := ru + \frac{1}{2} | \cdot |^2$ with $r > 0$ a real number and $u$ a convex function which is bounded on $X$. Let $G = \de g = \de \scr Lf$ and $X_\delta$ be defined as in \Cref{leg:f}. Suppose that
\begin{itemize}
\item[(i)] $G$ is differentiable at $y_0 \in X_\delta$, with $B\defeq DG(y_0)$;
\item[(ii)] $x_0 \defeq G(y_0)$ is not a critical value of $G$; that is, ${\rm det} \, DG(y_0) \neq 0$;
\item[(iii)] $f$ is differentiable at $x_0$.
\end{itemize}
Then $f$ is twice differentiable at $x_0$, with $D^2f(x_0) = B^{-1}$.
\end{lem}

\begin{remark} \label{rmk:mplt}
In short, \Cref{mplt} tells that, if $|u| \leq M$ on $X$, $f \defeq ru + \frac12|\cdot|^2$ with $r>0$, and $G = \de \scr Lf$, then
\[
G\!\left( X_{2\sqrt{rM}} \setminus k_{G} \right) \cap \mathrm{Diff}^1 f \subset \mathrm{Diff}^2 f
\]
and
\[
D^2 u \circ G = r^{-1}( (DG)^{-1} - I ) \quad \text{on $\big( X_{2\sqrt{rM}} \setminus k_G \big) \cap G^{-1}(\mathrm{Diff}^1 f)$}.
\]
Clearly, one can also replace each $\mathrm{Diff}^k f$ by $\mathrm{Diff}^k u$, since they are the same set because $\frac12|\cdot|^2$ is smooth.
\end{remark}

\begin{proof}[Proof of \Cref{mplt}]
First of all, we recall that $G = \de g \colon \de f(X) \to \R^n$ is single-valued (hence $G = Dg$) and contractive by \Cref{leg:f}(b)-(c). Now, with $x_0 = G(y_0)$ for $y_0 \in \de f(x_0)$  we have  $Df(x_0) = y_0$ since
\[
	x_0 \in \de g(y_0) = \{ G(y_0)\} \ \iff \ y_0 \in \de f(x_0) = \{ Df(x_0)\} 
\]
by Proposition~\ref{leg:gen} and the hypothesis (iii) that $f$ is differentiable in $x_0$. 
 
 Assume now, without loss of generality, that $x_0 = 0$ and that $f(0) = Df(0) = 0$. This is possible since the function $\tilde f \defeq f(\cdot + x_0) -f(x_0) - \pair {y_0}\cdot$
will satisfy $\tilde f (0) = 0$ and $D \tilde f(0) = Df(x_0) - y_0 = 0$ and will be twice differentiable in $0$ if and only $f$ is twice differentiable in $x_0$. 

By the hypotheses (i) and (ii), $0$ is not a critical value of $G$ and hence $B:= DG(0)$ is invertible. The proof of the lemma reduces to showing that
\begin{equation}\label{D2f(0)}
f(x) - Q_A(x) = o(|x|^2),  \quad \text{for $x \to 0$},
\end{equation}
where $A\defeq B^{-1}$ and $Q_A(x) \defeq \frac12\pair{Ax}x$.

By \Cref{leg:f}(d), given $x\in X_\delta$ there exists $y\in X$ such that $y \in \de f(x)$, then by \Cref{leg:gen}(c), $x \in \de g(y) = \{G(y)\}$; that is, $x=G(y)$. For this pair $(x,y) \in \de f$, by the definition of the Legendre transform one can write
\begin{equation}\label{fg_identity}
%f(x) - \tfrac12\pair{Ax}x  = \tfrac12\pair{By}y - g(y) + \tfrac12\pair{y-Ax}x + \tfrac12\pair{x-By}y.
f(x) - Q_A(x)  = Q_B(y) - g(y) + \tfrac12\pair{y-Ax}x + \tfrac12\pair{x-By}y.
\end{equation}

Since $G$ is differentiable in $y_0 = 0$ with $G(0) = 0$ and $B=DG(0)$, one has 
\begin{equation}\label{taylor1}
	x =G(y) = By + o(|y|) \quad \text{for $y \to 0$},
\end{equation}
which also yields
%\begin{gather}\label{taylor2}
%x - By = o(|y|),
%\\ \label{taylor3}
%\pair{x-By}y = o(|y|^2),
%\\ \label{taylor4}
%\pair{y-Ax}y \leq ||A|| \, |x-By| \, |x| = o(|y|^2).
%\end{gather}
\begin{equation} \label{taylor4}
\pair{y-Ax}y \leq \norm{A} \, |x-By| \, |x| = o(|y|^2).
\end{equation}
Indeed, since $A = B^{-1}$, $G$ is contractive, and $|x-By| = o(|y|)$ by \eqref{taylor1}, for $y \to 0$ one has
\[
\pair{y-Ax}y = \pair{-A(x-By)}{x} \leq \norm{A} \, |x - By| \, |x| \leq \norm{A} \, |xBy| \, |y| = o(|y|^2).
\]

The asymptotic expansion \eqref{taylor1} allows us to show that the Legendre transform $g$ of $f$ is twice differentiable with 
\begin{equation}\label{leg:cl:der}
 D^2g(0) = B.
\end{equation}
By definition $g(0) = 0$ (since $f(0) = 0$ and $(0,0) \in \de f$) and by hypothesis $G(0) = Dg(0) = 0$. Hence  the claim \eqref{leg:cl:der} is equivalent to 
\begin{equation}\label{D2g(0)}
g(y) - Q_B(y) = o(|y|^2) \quad \text{for $y \to 0$.}
\end{equation}
To see that \eqref{D2g(0)} holds, one first uses the mean value theorem for each $y$ fixed near $0$ to conclude that there exists $z\in[0,y]$ such that
\begin{equation}\label{MVT}
%g(y) - \tfrac12\pair{By}y = \pair {Dg(z)- Bz}{y}.
g(y) - Q_B(y) = \pair {Dg(z)- Bz}{y}.
\end{equation}
Indeed, applying the mean value theorem to the function $h := g - Q_B$ which satisfies $h(0) = 0$ there exists $z \in [0,y]$ such that $h(y) = \pair{Dh(z)}{y}$, which is \eqref{MVT}. 
Using \eqref{taylor1} one has
\[
Dg(z) - Bz = G(z) - Bz = o(|z|) \quad \text{for $z \to 0$},
\]
which, since $|z(y)| \leq |y|$, together with \eqref{MVT} implies
$$
| g(y) - Q_B(y)| \leq |DG(z) - Bz| \, |y| = o(|y|^2) \quad \text{for $y \to 0$},
$$
as desired in \eqref{D2g(0)}. 

Finally, we conclude the proof of the lemma by establishing \eqref{D2f(0)}. Using \eqref{taylor1}, \eqref{taylor4} and \eqref{D2g(0)} on the terms on the right-hand side of \eqref{fg_identity} yields
\begin{equation}\label{D2g(0)2}
f(x) - Q_A(x)  = o(|y|^2) \quad \text{for $y \to 0$},
\end{equation}
which implies the needed \eqref{D2f(0)} since we can show that
\begin{equation}\label{bigO}
|y| = O(|x|) \quad \forall \, y \ \text{with $|y|$ small.}
\end{equation}
To see this, note that since $A = B^{-1}$, one has 
\begin{equation}\label{bigO1}
|y| = |ABy| \leq || A|| \, (|x-By| + |x| ), \quad \forall\, x,y \in \R^n,
\end{equation}
thus by \eqref{taylor1} for any $\epsilon > 0$ there exists $\delta > 0$ such that
\[
	|y| \leq \norm{A} (\varepsilon |y| + |x|) \quad \forall \, y \in B_{\delta}(0);
\]
in particular, choosing $\varepsilon < 1/(2\norm{A})$ gives
\[
	|y| \leq 2 \norm{A} \, |x| \quad \forall \, y \in B_{\delta}(0),
\]
while since $G$ is contractive, $|x| = |G(y)| \leq |y|$, and hence \eqref{bigO} is proved, and the proof complete.
\end{proof}

The second needed ingredient is the following, which will be proven in Appendix \ref{proofsard}.

\begin{thm}[Sard's theorem for Lipschitz functions] \label{sard}
Let $\Omega \subset \R^n$ be open. The set of critical values of a Lipschitz function $G: \Omega \subset \R^n \to \R^n$ has (Lebesgue) measure zero.
\end{thm}

\begin{remark}
As the reader might have noticed, our choice of defining the critical points of $G$ as those points at which $G$ either is not differentiable or has singular derivative (sometimes ones uses only the second condition) suggests that the proof of Sard's theorem will make use of Rademacher's theorem on the almost everywhere differentiability of Lipschitz functions.
\end{remark}

\begin{proof}[Proof of Alexandrov's \Cref{aleks}]
Without loss of generality, we can suppose that $u$ is in fact bounded on $X$; indeed, if not, it suffices to consider an exhaustion by compact convex sets $K_j \uto X$ (for instance, one can take $K_j \defeq \big\{ x \in X :\ d(x,\de X) \geq 2^{-j}, \, |x| < 2^j \big\}$ for all $j\in\N$), prove the theorem for $u|_{\intr\! K_j}$ (which is bounded since $u$ is continuous on $X$; cf.~\Cref{thm:convex_Lip}), and then note that the set of all points in $X$ where $u$ is twice differentiable, $\mathrm{Diff}^2 u$, has full measure as well, since 
\[
X \setminus \mathrm{Diff}^2 u  \subset \bigcup_{j\in\N} \left( \intr K_j \setminus \mathrm{Diff}^2 u \right),
\]
which, by the $\sigma$-subadditivity of the Lebesgue measure, yields $|X \setminus \mathrm{Diff}^2 u| = 0$.
%Fix $\epsilon > 0$ and let $X_\epsilon \defeq \{x\in X: d(x,\de X) > \epsilon \}$.
%Since $X$ is second countable, hence Lindel\"of, there exists a countable collection of open balls $\{B^i\}_{i\in\N}$ such that
%\begin{equation} \label{alex:sub}
%{X_{\epsilon}} \subset \bigcup_{i\in\N} {B^i} \subset \bigcup_{i\in\N} \overline{B^i} \subset X \quad \text{$u$ convex on each $B^i$}\footnote{To see this, consider the open cover of $X_\epsilon$ given by $\{ B_{\rho(z)}(z) : z\in X_{\epsilon} \}$, with $\rho(z) < \epsilon$ for all $z\in X_\epsilon$. Then it has a countable subcover satisfying~(\ref{alex:sub}).  
%Indeed, suppose $y\in \barr{B^i} \setminus X$ for some $B^i$ of center $z_i$ and consider the linear segment $\mathrm I \defeq [z_i, y]$; since it is connected, there exists $w\in \mathrm I \cap \de X$ and thus $\epsilon < d(z_i, \de X) \leq d(z_i, y) \leq \rho(z_i)< \epsilon$, contradiction.}
%\end{equation}
%
%Furthermore, by choosing the $\rho(z)$'s to be sufficiently small, we may also assume that $u$ is convex on each $B^i$.
%
%Fix now $i \in \N$ and $r>0$. 

Hence, we will prove the theorem for $u$ bounded on $X$. Fix $r>0$ and let $f \defeq ru + \frac12|\cdot|^2$. By \Cref{mplt} (cf.~also \Cref{rmk:mplt}), we know that
\begin{equation} \label{proofalex:incl}
G(X_\delta \setminus k_G) \cap \mathrm{Diff}^1 u \subset \mathrm{Diff}^2 u, 
\end{equation}
where (cf.~\Cref{leg:f})
\begin{equation} \label{proofalex:delta}
\delta = 2\sqrt{r\norm{u}_\infty}.
\end{equation}
By \Cref{rade:conv}, $\mathrm{Diff}^1 u$ has full measure, and, since $G$ is Lipschitz by \Cref{leg:f}{(c)}, $G(k_G)$ has measure zero by \Cref{sard}. Hence from \eqref{proofalex:incl} we have
\begin{equation} \label{alexproof:ineq}
\big|\mathrm{Diff}^2 u \big| \geq \big|G(X_\delta)\big| \geq \big|X_{2\delta}\big|,
\end{equation}
where the latter inequality comes from the fact that $X_{2\delta} \subset G(X_\delta)$. Indeed, by \Cref{leg:f}{(d)}, $\de f(X_{2\delta}) \subset X_\delta$, which by part {\em(b)} of the same Proposition is equivalent to $X_{2\delta} \subset G(X_\delta)$, as we claimed.

Notice now that $r > 0$ is arbitrary, thus we can let $r \dto 0$; that is, (cf.~\eqref{proofalex:delta}) we can let $\delta \dto 0$ in \eqref{alexproof:ineq}. We obtain
\begin{equation*} \label{leg:proof:ball}
\big|\mathrm{Diff}^2 u \big| \geq | X \big|,
\end{equation*}
then yields $\big|\mathrm{Diff}^2 u \big| = | X \big|$, since the reverse inequality holds trivially. This proves that $\mathrm{Diff}^2 u$ has full measure (in $X$), which is the desired conclusion.
\end{proof}


\renewcommand\thepart{B}
\renewcommand\thesection{B}
\part{Proof of Sard's theorem for Lipschitz functions}
\label{proofsard}

Since \Cref{sard} states that a set of ``bad'' points (critical values of a Lipschitz function $G$) has zero measure, it is not surprising that one needs to appeal to some measure-theoretic covering lemma. We will make use of the Besicovitch covering theorem~\cite{besic}, which we will prove in \Cref{app:bes}) by adapteing the proof of a more general form contained in~\cite{fed:geo}. 

We will also need the following elementary estimate on controlling the {\em Lebesgue outer measure $m$} of images of small balls about points of differentiability of a vector field $G$ on $\R^n$.

\begin{lem} \label{app:ball}
Suppose that $G\colon \Omega \to {\R^n}$ is differentiable at $a \in \Omega$ with $\Omega \subset \R^n$ open. Then for each $\epsilon >0$ there exists $\barr\rho = \barr\rho(a,\epsilon)>0$ such that 
\[
m\big(G\big(B_\rho(a)\big)\big) \leq \left(|{\det DG(a)}|+\epsilon\right)m(B_\rho(a)) \qquad \forall \rho\leq \barr\rho.
\]
\end{lem}

\begin{proof}
Since $G$ is differentiable at $a$, one has that 
\[
| G(x) - \ell(x) | \leq \omega(|x-a|)|x-a|, \quad \text{for all $x$ near $a$}, 
\]
where $\ell \defeq G(a) + \pair{DG(a)}{\cdot-a}$ is the linearization of $G$ at $a$ and $\omega\colon \R_+ \to \R_+$ is a modulus of continuity ($\omega(0^+)=0$). This yields
\[
G\big(B_\rho(a)\big) \subset \ell\big(B_\rho(a)\big) + \omega(	\rho) \rho B_1(0),
\]
By the monotonicity of the outer measure $m$, one has 
\[
m(G(B_\rho(a))) \leq m(\ell(B_1(a)) + \omega(	\rho)  B_1(0))\rho^n,
\]
Now note that
\[
\lim_{\rho \dto 0^+} m(\ell(B_1(a)) + \omega(	\rho)  B_1(0)) = m(\ell(B_1(a))) = |\ell(B_1(a))| = |{\det DG(a)}|\, \alpha_n, 
\]
where $\alpha_n:= m(B_1(0))$ and where the latter equality comes from the change of variables formula. Therefore there exists some $\barr\rho>0$ such that for $\rho\leq \barr\rho$ we have
\[
m\big(G\big(B_\rho(a)\big)\big) \leq m(\ell(B(a)) + \omega(	\rho)  B)\rho^n \leq (|{\det DG(a)}| + \epsilon)\,\alpha_n\rho^n
\]
and hence the result.
\end{proof}

Next is the needed covering lemma.

\begin{lem}[Besicovitch's covering theorem] \label{app:bes}
Let $A\subset \R^n$ and $\rho\,\colon A \to \R_+$ bounded. Then there exists $N\in\N$ depending only on $n$ and $N$ families 
\[
\call B_k = \big\{ B_j^k \defeq B_{\rho(a_j^k)}(a_j^k) :\ a_j^k\in A,\ j\in\N,\ B_j^k \cap B_i^k\ \forall\, i\neq j \big\}, \qquad k=1,\dots, N,
\]
such that 
\[
A \subset \bigcup_{k=1}^N \bigcup_{j\in\N} B_j^k.
\]
\end{lem}

\begin{proof}
We split the proof into four steps.

\underline{Step 1}. \emph{Let $\tau >1$. Then
\[
A \subset \bigcup_{j\in \N} B_j,
\]
where $B_j = B_{\rho_j}(a_j)$, $a_j\in A$, $\rho_j=\rho(a_j)$, satisfying for every $a_i,a_j$
\[
\text{either}\quad |a_i - a_j| > \rho_i > \rho_j/\tau \quad \text{or}\quad |a_i-a_j| > \rho_j > \rho_i/\tau.
\]
}
\indent Consider the class $\Lambda$ of subsets $\Q\subset A$ with the following properties:
%%%
\begin{equation} \tag{\sc i} \label{sc(i)}
\text{either $|a - c| > \rho(a) > \rho(C)/\tau$ or $|a-c| > \rho(C) > \rho(a)/\tau$ for all $a,c\in \Q$;}
\end{equation}
\begin{equation} \tag{\sc ii} \label{sc(ii)}
\text{whenever $b\in A$,}\quad \begin{array}{l} \text{either $|a-b|\leq \rho(a)$ for some $a\in \Q$} \\ \text{or $|a-b| > \rho(a) > \rho(b)/\tau$ for all $a\in \Q$.}\end{array}
\end{equation}
By Hausdorff's maximal principle, $\Lambda$ has a maximal member $\Q$. Then the family $\{B_{\rho(a)}(a) : a\in \Q\}$ covers $A$. Indeed, otherwise 
\[
K\defeq \{ a\in A:\ |a-c| > \rho(a)\ \text{for all}\ a\in  \Q\} \neq \emptyset
\]
and thus we may choose $c\in K$ with $\tau\rho(C) > \sup_{a\in K} \rho(a)$. This implies $\Q\subset \Q \cup \{c\} \in \Lambda$, contrary to the maximality of $ \Q$. Also, since $A$ is second countable, there exists a countable subset of $\Q$ which still covers $A$.

\underline{Step 2}. \emph{Let $P\subset A$. Then there exists $R\subset P$ such that}
\begin{equation} \tag{\sc iii} \label{sc(iii)}
\text{\emph{$|a-b| > \rho(a)+\rho(b)$ for all $a,b\in \RR$;}}
\end{equation}
\begin{equation} \tag{\sc iv} \label{sc(iv)}
\text{\emph{whenever $a\in P$, there exists $b\in R$ with $|a-b| \leq \rho(a) + \rho(b)$ and $\rho(b) > \rho(a)/\tau$.}}
\end{equation}

Consider the class $\Lambda$ of those subsets $R\subset P$ satisfying \eqref{sc(iii)} and
\begin{equation} \tag{\sc v} \label{sc(v)}
\text{whenever $a\in P$,} \quad \begin{array}{l} \text{either $|a-b| > \rho(a) + \rho(b)$ for all $b\in R$} \\ \text{or \eqref{sc(iv)} holds.} \end{array}
\end{equation}
Again by Hausdorff's maximal principle, there exists a maximal member $R$ of $\Lambda$, which satisfies \eqref{sc(iv)}; indeed, otherwise, arguing as in the previous step, property \eqref{sc(v)} would imply that there exists $a\in P\setminus R$ such that $R \cup \{ a \} \in \Lambda$, contrary to the maximality of $R$.

\underline{Step 3}. \emph{Let $\epsilon > 0$ small and $\tau \in (1,2-\epsilon)$ such that
\begin{equation} \label{app:dis}
\epsilon + \frac\tau{2-\epsilon} + \tau(\tau -1) < 1.
\end{equation}
Let $\Q\subset A$ satisfying \eqref{sc(i)} and 
\begin{equation} \tag{\sc vi} \label{sc(vi)}
\text{$|a-b| \leq \rho(a) + \rho(b)$ and $\rho(b) > \rho(a)/\tau$ for all $a,b\in \Q$.}
\end{equation}
Then there exists $N \in \N$ depending on $n$ and $\epsilon$ only such that $\# \Q \leq N$.}
%%%
\setlist[1]{topsep=3.5pt, itemsep=0pt, partopsep=1.1pt, parsep=1.1pt}

First of all, note that such a $\tau$ exists (by continuity) since the left-hand side of \eqref{app:dis} for $\tau = 1$ and $\epsilon = 0$ is $\tfrac12$. Let now $\kappa = (2-\epsilon)/\tau$ and $a\in \Q$. Set
\[
\Q_1 \defeq\Q\cap \left(B_{k\rho(a)}(a) \setminus \{a\}\right), \qquad \Q_2 \defeq\Q\cap B_{k\rho(a)}(a)\compl.
\]
Let $b,c\in \Q_j$ for some $j\in\{1,2\}$ be distinct points with $|a-b| \geq |a-c|$ and $x\in\R^n$ such that
\[
|a-x| = |a-c|, \qquad |b-x| = |a-b| - |a-c|.
\]
Note that actually such an $x$ is uniquely determined by $a,b,c$ because of the strict convexity of the Euclidean norm, namely as
\begin{equation} \label{app:sc}
x = a + \frac{|a-c|}{|a-b|}(b-a).
\end{equation}
We see that 
\[
|x-c| \geq |a-c| + |b-c| - |a-b|
\]
 and distinguish two cases. If $j=1$, since by \eqref{sc(i)}  and \eqref{sc(vi)}, $|b-c| > \min\{\rho(b), \rho(C)\} > \rho(a)/\tau$ and similarly $|a-c| > \rho(a)/\tau$, where $|a-b| \leq \kappa\rho(a) $ and $\kappa\tau - 1 = 1-\epsilon >0$, we obtain
\[
|x-c| > |a-c| - (\rho(a)/\tau)(\kappa\tau-1) > \epsilon |a-c|;
\]
if $j=2$, since $|a-b| \leq \rho(a) + \rho(b)$, $|a-c| > k\rho(a)$,
\[\begin{split}
|b-c| > \rho(b)\ \text{or}\ |b-c| > \rho{(C)} > \rho(b)/\tau \quad &\implies \quad |b-c|-\rho(b) > (1-\tau)\rho{(C)},\\
|a-c| > \rho{(C)}\ \text{or}\ |a-c| > \rho(a) > \rho{(C)}/\tau \quad &\implies \quad |a-c| > \rho{(C)}/\tau,
\end{split}\]
we obtain
\[\begin{split}
|x-c| &\geq |a-c| + |b-c| - \rho(a) -\rho(b) > |a-c| -\rho(a) - \rho{(C)}(\tau-1)\\
&= |a-c|\left( 1- \frac{\rho(a)}{|a-c|} - \frac{\rho{(C)}}{|a-c|}(\tau-1) \right) > |a-c|\left( 1-\frac1k - \tau(\tau-1) \right) \\
&> \epsilon |a-c|,
\end{split}\]
where the last inequality comes from the condition~(\ref{app:dis}).

Therefore we have 
\[
\frac{|x-c|}{|a-c|} \geq \epsilon
\]
for all $a,x,c$ as above. At this point by~(\ref{app:sc}) one sees that 
\[
\frac{|x-c|}{|a-c|} = \left| \frac{b-a}{|b-a|} - \frac{c-a}{|c-a|} \right| = |\pi(b)-\pi{(C)}|,
\]
where $\pi(b),\pi{(C)}$ denote the projections of $b,c$, respectively, onto the sphere $\de B_1(a)$. This implies that there is a one-to-one correspondence between points in $\Q_j$ and their projections and $\#\Q_j \leq \kappa$ for some $\kappa \in \N$. Indeed, we know that $\pi(\Q_j)$ is finite, because otherwise by the compactness of $\de B_1(a)$ it would have a limit point and thus there would exist points $\pi(b),\pi{(C)}$, with $|\pi(b) - \pi{(C)}| < \epsilon$. It is clear that this argument is independent of $a$ and holds for every $\epsilon$-distanced subset of the unit sphere $\mathbb{S}^{n-1}$, hence $\kappa$ depends only on $n$ and $\epsilon$.

Putting all of this together, we have $\# \Q = \#(\Q_1\cup \Q_2 \cup \{a\}) = \#\Q_1 + \#\Q_2 + 1 \leq 2\kappa + 1 =: N$.

\underline{Step 4}. \emph{Let $\tau$ be as in step 3 with $\epsilon = \frac13$ and $P \defeq \{ B_j \}_{j\in\N}$ be as in step 1. Then $P$ is the union of $N$ families of pairwise disjoint balls.}

Applying step 2, we define by induction subsets $P_k$, $\RR_k$ of $P$, starting with $P_0 \defeq P$ and $\RR_0 \defeq \emptyset$ and letting, for $k\geq 1$, $P_k \defeq P_{k-1} \setminus \RR_{k-1}$ and $\RR_k \subset P_k$ satisfying \eqref{sc(iii)} and \eqref{sc(iv)}. Note that condition \eqref{sc(iii)} implies that the family $\call B_k \defeq \{B_j^k \defeq B_{\rho_j^k}(a_j^k):\ a_j^k\in \RR_k\}$ is disjointed for each $k$ and by definition
\[
P_{N+1} = \bigcap_{k=1}^N\, (P \setminus \RR_k) = P \setminus \bigcup_{k=1}^N \RR_k.
\]
Hence we conclude the proof if we show that $P_{N+1} = \emptyset$. In fact, if $a\in P_{N+1}$, one uses property \eqref{sc(iv)} to select, for all $k=1,\dots, N$, some $b_j^k\in \RR_k$ with $|a-b_j^k| \leq \rho(a) + \rho_j^k$ and $\rho_j^k > \rho(a)/\tau$. Therefore $\Q\defeq \{a,b_1,\dots, b_N\}$ satisfies \eqref{sc(i)} and \eqref{sc(iv)}, and also $\#\Q = N+1$ since the $\RR_j$'s are disjointed by definition; but this contradicts what we proved in step 3.
\end{proof}

Next, one can globalize the local measure estimate of Lemma \ref{app:ball} by way of the Besicovitch covering Lemma \ref{app:bes}.
\begin{prop}\label{prop:DG}
Let $\Omega \subset \R^n$ open, $G\colon \Omega\to {\R^n}$ and $A\subset\Omega$ with $m(A)$ finite. Suppose $G$ is differentiable at every $a\in A$ and there exists a constant $M$ such that $|\det DG|\leq M$ in $A$. Then 
\[
m(G(A)) \leq cMm(A),
\]
where the constant $c$ depends only on $n$.
\end{prop}

\begin{proof}
Fix $U\supset A$ open such that $m(U) \leq 2m(A)$; given $\epsilon >0$, by Lemma \ref{app:ball}, for each $a\in A$ there exists some ball $B_{\rho(a)}(a)$ such that $m(G(B_{\rho(a)}(a))) \leq \left(M+\epsilon\right)\cdot m(B_{\rho(a)}(a))$. Also, we may choose $\rho(a)$ in such a way that $B_{\rho(a)}(a) \subset U\cap \Omega$ for all $a\in A$, hence the map $\rho\,\colon A \to \R_+$ is bounded. Besicovitch's covering theorem (Lemma \ref{app:bes}) tells us that there exists a countable subset $\{a_i\}_{i\in\N} \subset A$ such that, letting $\rho_i \defeq \rho(a_i)$, $\{B_i\defeq B_{\rho_i}(a_i)\}_{i\in\N}$ covers $A$ and every point $x\in\R^n$ is in at most $N$ of the balls $B_{\rho_i}(a_i)$. Therefore $\sum_{i\in\N} \chi_{B_i} \leq N\chi_U$ and we have
\[
\sum_{i\in\N} m(B_i) \leq Nm(U) \leq 2N m(A)
\]
and thus
\[\begin{split}
m(G(A)) \leq m\!\left(G\Big(\bigcup_{i\in\N} B_i \Big)\right) \leq \sum_{i\in N} m(G(B_i)) \leq (M+\epsilon)\! \sum_{i\in\N} m(B_i) 
 \leq 2N(M+\epsilon)m(A).
\end{split}\]
As $\epsilon$ is arbitrary, we have the thesis, with $c=2N$.
\end{proof}

The treatment of the critical values corresponding to points of differentiability is now at hand.

\begin{cor}\label{cor:DG}
Let $\Omega\subset\R^n$ open and $G \colon \Omega \to \R^n$; set
\[
\call S_G\defeq \{x\in\Omega:\ G \ \text{is differentiable in $x$ and} \  |\det DG(x)| = 0\}.
\]
Then $G(\call S_G)$ has Lebesgue measure zero.
\end{cor}

\begin{proof}
If $m(\call S_G)<\infty$, then the conclusion follows immediately from Proposition \ref{prop:DG}  with $A = \call{S_G}$ and $M = 0$. If $m(\call S_G) = \infty$, then consider the decomposition $\call S_G = \bigcup_{k \in N}A_k$ with $A_k:= \call  S_G \cap B_k(0)$. One has $m(A_k) = 0$  for each $k$ by the previous step, and the conclusion follows from the subadditivity of $m$. 
\end{proof}

The proof of Sard's theorem follows easily from Corollary \ref{cor:DG} and Rademacher's theorem.


\begin{proof}[Proof of~\Cref{sard}]
For the Lipschitz function  $G$, one needs to show that $m(G(k_G)) = 0$. The set of critical points can be decomposed into $k_G = \call N_G \cup \call S_G$, where $\call N_G$ denotes the set of points at which $G$ is not differentiable and $\call S_G$ is the set of points of differentiability where the Jacobian $DG$ is singular. Since $G$ is Lipschitz, $\call N_G$ has (Lebesgue) measure zero by Rademacher's Theorem \ref{rade} and hence $G(\call N_G)$ has measure zero as well since $G$ is Lipschitz. By the above corollary, $G(\call S_G)$ has measure zero and we are done. \qedhere
\end{proof}

\end{appendix}


%\addtocontents{toc}{\vspace{15pt}}

\begin{thebibliography}{100}
\bibitem{aa} G.\ Alberti and L.\ Ambrosio, \emph{A geometrical approach to monotone functions in $\R^n$}, Math.\ Z.\ {\bf230} (1999), 259--316. 
\bibitem{alex} A.\ D.\ Alexandrov, \emph{Almost everywhere existence of the second differential of a convex function and properties of convex surfaces connected with it} (in Russian), Lenningrad State Univ.\ Ann.\ Math.\ {\bf37} (1939), 3--35.
\bibitem{azgafeqc} D.\ Azagra and J.\ Ferrera, \emph{Regularization by sup-inf convolutions on Riemannian manifolds: An extension of Lasry--Lions theorem to manifolds of bounded curvature}, J.\ Math.\ Anal.\ Appl.\ {\bf423(2)} (2015), 994--1024.
\bibitem{bau} H.\ Bauer, \emph{Minimalstellen von Funktionen und Extremalpunkte}, Archiv der Mathematik {\bf9} (1958), 389--393.
%\bibitem[B]{bur} D.\ Burago, Y.\ Burago, S.\ Ivanov, \emph{A Course in Metric Geometry}, \AmS\ (2001).
\bibitem{besic} A.\ S.\ Besicovitch, \emph{A general form of the covering principle and relative differentiation of additive functions}, Proc.\ Cambridge Philos.\ Soc.\ {\bf41} (1945), 103--110.
\bibitem{BP21} I.\ Birindelli and K.\ R.\ Payne, {\em Principal eigenvalues for $k$-Hessian operators by maximum principle methods},  Math.\ Eng. {\bf 3} \ (2021), 37 pp.
\bibitem{cafcab} L.\ Caffarelli and X.\ Cabré, \emph{Fully nonlinear elliptic equations}, American Mathematical Society Colloquium Publications {\bf43}, American Mathematical Society, Providence, RI (1995).
\bibitem{chlp} M.\ Cirant, F.\ R.\ Harvey, H.\ B.\ Lawson, Jr., and K.\ R.\ Payne, \emph{Comparison principles by monotonicity and duality for constant coefficient nonlinear potential theory and PDEs}, Annals of Mathematics Studies {\bf 218} Princeton University Press, Princeton, NJ, 2023.
\bibitem{cpaux} M.\ Cirant and K.\ R.\ Payne, \emph{O\MakeLowercase{N VISCOSITY SOLUTIONS TO THE \MakeUppercase{D}IRICHLET PROBLEM FOR ELLIPTIC BRANCHES OF NONHOMOGENEOUS FULLY NONLINEAR EQUATIONS}}, Publ.\ Mat.\ {\bf61} (2017), 529--575.
\bibitem{cpmain} \rule{30pt}{.5pt}, \emph{Comparison principles for viscosity solutions of elliptic branches of fully nonlinear equations independent of the gradient.}, Math.\ in Eng.\ {\bf 3(4)} (2021), 1--45.
\bibitem{cprdir}  M.\ Cirant, K.\ R.\ Payne, and D.\ F.\ Redaelli, {\em Comparison principles for nonlinear potential theories and PDEs with fiberegularity and sufficient monotonicity},  Nonlinear Analysis {\bf 235} (2023), 113343.
\bibitem{csw} F.\ H.\ Clarke, R.\ J.\ Stern, and P.\ R.\ Wolenski, \emph{Subgradient criteria for monotonicity, the Lipschitz condition, and convexity}, Can.\ J.\ Math.\ {\bf45(6)} (1993), 1167--1183.
\bibitem{user} M.\ G.\ Crandall, H.\ Ishii, and P.-L.\ Lions, \emph{User’s Guide to Viscosity Solutions of Second Order Partial Differential Equations}, Bull.\ Amer.\ Math.\ Soc.\ {\bf27} (1992), 1--67.
\bibitem{crankoc} M.\ G.\ Crandall, M.\ Kocan, P.\ Soravia, and A.\ {\'S}wi{\k{e}}ch, \emph{On the equivalence of various weak notions of solutions of elliptic PDEs with measurable ingredients}, Pitman Res.\ Notes Math.\ Ser.\ {\bf350} (1996), 136--162.
\bibitem{dephfi} G.\ De Philippis and A.\ Figalli, \emph{The Monge-Amp\`{e}re equation and its link to optimal transportation}, Bull.\ Amer.\ Math.\ Soc.\ (N.S.) {\bf51} (2014), 527--580.
\bibitem{dudley} R.\ M.\ Dudley, \emph{On second derivatives of convex functions}, Math.\ Scandinavica {\bf41(1)} (1977), 159--174.
\bibitem{eber} A.\ Eberhard, \emph{Prox-Regularity and Subjets}, in A.\ Rubinov, B.\ Glover (Ed.), Optimization and Related Topics, Applied Optimization {\bf47}, Springer (2001), 237--313.
\bibitem{evansgar} L.\ C.\ Evans and R.\ F.\ Gariepy, \emph{Measure theory and fine properties of functions}, Studies in Advanced Mathematics, CRC Press, Boca Raton, FL, 2015.
\bibitem{fed:geo} H.\ Federer, \emph{Geometric measure theory}, Grund.\ Math.\ Wiss.\ {\bf153}, Springer-Verlag, Berlin--Heidelberg--New York, 1969.
\bibitem{har:pc} F.\ R.\ Harvey, \emph{Federer knows all}, private communication (Feb.\ 2018).
\bibitem{hlpotcg} F.\ R.\ Harvey and H.\ B.\ Lawson, Jr., \emph{An introduction to potential theory in calibrated geometry}, Amer.\ J.\ Math.\ {\bf131(4)} (2009), 893--944.
\bibitem{hlpluri09} \rule{30pt}{.5pt}, {\em Duality of positive currents and plurisubharmonic functions in calibrated geometry}, Amer.\ J.\ Math.\ {\bf 131}\ (2009), 1211--1239.
\bibitem{hldir09} \rule{30pt}{.5pt}, \emph{Dirichlet duality and the nonlinear Dirichlet problem}, Comm.\ on Pure and Applied Math.\ {\bf62} (2009), 396--443. 
\bibitem{hldir}  \rule{30pt}{.5pt}, \emph{Dirichlet duality and the nonlinear Dirichlet problem on Riemannian manifolds}, J.\ Diff.\ Geom.\ {\bf88} (2011), 395--482.
\bibitem{hlqc} \rule{30pt}{.5pt}, \emph{Notes on the differentiation of quasi-convex functions}, {\url{arXiv:1309.1772v3}} (30 July 2016), 1--18.
\bibitem{hlae} \rule{30pt}{.5pt}, \emph{The AE Theorem and addition theorems for quasi-convex functions}, {\url{arXiv:1309.1770v3}} (30 July 2016), 1--12.
\bibitem{hlcharsmp} \rule{30pt}{.5pt}, \emph{Characterizing the strong maximum principle for constant coefficient subequations,} Rend.\ Mat.\ Appl.\ {\bf37(7)} (2016), 63--104.
\bibitem{hllagma} \rule{30pt}{.5pt}, \emph{Lagrangian Potential theory and a Lagrangian equation of Monge--Amp\`{e}re type}, Surveys in Differential Geometry {\bf22}, International Press of Boston, Inc., Sommerville (2017), 217--258.
\bibitem{hlidir} \rule{30pt}{.5pt}, \emph{The inhomogeneous Dirichlet Problem for natural operators on manifolds}, {\tt arXiv:1805.111213v1} (2018), to appear in Ann.\ Inst.\ Fourier, Grenoble.
\bibitem{hlkry} \rule{30pt}{.5pt}, \emph{A generalization of PDEs from a Krylov point of view}, Adv.\ Math.\ {\bf372} (2020), 1--39.
\bibitem{hlpssl} \rule{30pt}{.5pt}, \emph{Pseudoconvexity for the special Lagrangian potential equation}, Calc.\ Var.\ Partial Differential Equations \ {\bf 60} (2021), Paper No. 6, 37 pp.
\bibitem{hpsurvey} F.\,R.\ Harvey and K.\,R.\ Payne, {\em Interplay between nonlinear potential theory and fully nonlinear PDEs},  Pure Appl.\ Math.\ Q.\, to appear; preprint version online {\tt arXiv:2203.14015v1} (29 Mar 2022), 1--44.
 \bibitem{how} R.\ Howard, \emph{Alexandrov's Theorem on the second derivatives of convex functions via Rademacher's Theorem on the first derivatives of Lipschitz functions}, notes (1998) available online at {\url{http://ralphhoward.github.io/SemNotes/index.html}}.
 \bibitem{hiriart} J.-B.\ Hiriart-Urruty and Ph.\ Plazanet, \emph{Moreau's decomposition theorem revisited}, Annales de l'I.H.P. Analyse non linéaire, {\bf6} (1989), 325--338.
 \bibitem{jensen} R.\ Jensen, \emph{The maximum principle for viscosity solutions of fully nonlinear second order partial differential equations}, Arch.\ Rat.\ Mech.\ Anal.\ {\bf101} (1988), 1--27.
% \bibitem{kir}  M.\ D.\ Kirszbraun, \emph{\"Uber die zusammenziehende und Lipschitzsche Transformationen}, Fund.\ Math.\ {\bf22} (1934), 77--108.
 \bibitem{kr} N.\ V.\ Krylov, \emph{On the general notion of fully nonlinear second-order elliptic equations}, Trans.\ Amer.\ Math.\ Soc.\ {\bf347(3)} (1995), 30--34.
 \bibitem{laslio} J.-M.\ Lasry and P.-L.\ Lions, \emph{A remark on regularization in Hilbert spaces}, Israel Math.\ J.\ {\bf55}, n.\ 3 (1996), 257--266.
 \bibitem{lioham} P.-L.\ Lions, \emph{Generalized Solutions of Hamilton-Jacobi Equations}, Pitman Research Notes in Mathematics Series {\bf 69} Pitman Books Ltd., London, 1982.
 \bibitem{pucci} C.\ Pucci, \emph{Limitazioni per soluzioni di equazioni ellittiche}, Ann.\ Mat.\ Pura Appl.\ {\bf74} (1966), 15--30.
 \bibitem{rademacher} H.\ Rademacher, \emph{{\"U}ber partielle und totale Differenzierbarkeit I.}, Math.\ Ann.\ {\bf79} (1919), 340--359.
\bibitem{anr} F.\ Riesz and B.\ Sz.-Nagy, \emph{Functional Analysis}, Ungar, New York, 1955.
\bibitem{rock} R.\ T.\ Rockafellar, \emph{Convex analysis}, Princeton Mathematical Series {\bf28}, Princeton University Press, Princeton, N.J., 1970.
\bibitem{slod} Z.\ S{\l}odkowski, \emph{The Bremermann--Dirichlet problem for  $q$-plurisubharmonic functions}, Ann.\ SNS di Pisa, Cl.\ di Scienze, 4\ap{a} serie, {\bf11}, n.\ {\bf2} (1984), 303--326.
\bibitem{spi1} M.\ D.\ Spivak, \emph{A Comprehensive Introduction to Differential Geometry}, vol.\ 1, Publish or Perish, 3rd edition (1999).
\bibitem{stein} E.\ M.\ Stein and R.\ Shakarchi, \emph{Real Analysis: Measure Theory, Integration, and Hilbert Spaces}, Princeton University Press (2005).
\bibitem{meast}  T.\ Tao, \emph{An Introduction to Measure Theory}, Graduate Studies in Mathematics {\bf 126}, Amer.\ Math.\ Soc., Provience, RI, 2011.
\bibitem{villani} C.\ Villani, \emph{Optimal transport. Old and new}, Grundlehren der Mathematischen Wissenschaften {\bf338}, Springer-Verlag, Berlin, 2009.
\bibitem{vesely} L.\ Vesely, Notes for the course in Convex Analysis, Università degli Studi di Milano (2019); available online at \url{http://users.mat.unimi.it/users/libor/2018-2019.html}.
\bibitem{wheedzyg} R.\ L.\ Wheeden and A.\ Zygmund, \emph{Measure and Integral: An Introduction to Real Analysis}, Second Edition, Pure and Applied Mathematics {\bf 43}, Chapman and Hall/CRC Press, 2015. 
\end{thebibliography}
\end{document}
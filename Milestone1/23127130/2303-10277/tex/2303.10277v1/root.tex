\documentclass[letterpaper, 10 pt, conference]{ieeeconf}  % Comment this line out if you need a4paper

\input{math_macro.tex}
\usepackage[utf8]{inputenc}
\usepackage{comment}
\usepackage[normalem]{ulem}


\IEEEoverridecommandlockouts                              
% This command is only needed if 
% you want to use the \thanks command

\overrideIEEEmargins                                      
% Needed to meet printer requirements.

%In case you encounter the following error: 
%Error 1010 The PDF file may be corrupt (unable to open PDF file) OR
%Error 1000 An error occurred while parsing a contents stream. Unable to analyze the PDF file.
%This is a known problem with pdfLaTeX conversion filter. The file cannot be opened with acrobat reader
%Please use one of the alternatives below to circumvent this error by uncommenting one or the other
%\pdfobjcompresslevel=0
%\pdfminorversion=4

% See the \addtolength command later in the file to balance the column lengths
% on the last page of the document

% The following packages can be found on http: \\www.ctan.org
%\usepackage{graphics} % for pdf, bitmapped graphics files
%\usepackage{epsfig} % for postscript graphics files
%\usepackage{mathptmx} % assumes new font selection scheme installed
%\usepackage{times} % assumes new font selection scheme installed
%\usepackage{amsmath} % assumes amsmath package installed
%\usepackage{amssymb}  % assumes amsmath package installed
% \documentclass[letterpaper, 10pt, conference]{ieeeconf}

%===============================================================================

\title{\LARGE \bf Zero-shot Transferable and Persistently Feasible Safe Control for\\ High Dimensional Systems by Consistent Abstraction
% via Semi-Consistent System Abstraction
}
\author{Tianhao Wei$^{1}$, Shucheng Kang$^{2}$, Ruixuan Liu$^{1}$, and Changliu Liu$^{1}$% <-this % stops a space
\thanks{*This material is based upon work supported by the National Science Foundation under Grant No. 2144489.}% <-this % stops a space
\thanks{$^{1}$These authors are with Robotics Institute, Carnegie Mellon University, {\tt\small twei2, ruixuanl, cliu6@andrew.cmu.edu}}%
\thanks{$^{2}$Shucheng Kang is with the Department of Electrical Engineering, Tsinghua University. Work done during an internship at Carnegie Mellon.
        {\tt\small ksc19@mails.tsinghua.edu.cn}}%
}

\begin{document}

\maketitle
\thispagestyle{empty}
\pagestyle{empty}

\begin{abstract}                % Abstract of not more than 250 words.
Safety is critical in robotic tasks. Energy function based methods have been introduced to address the problem. To ensure safety in the presence of control limits, we need to design an energy function that results in persistently feasible safe control at all system states.
However, designing such an energy function for high-dimensional nonlinear systems remains challenging.
Considering the fact that there are redundant dynamics in high dimensional systems with respect to the safety specifications, this paper proposes a novel approach called abstract safe control.
% In our framework, showing persistently feasibility of the low-dimensional, abstracted model, is equivalent to showing persistently feasibility. 
We propose a system abstraction method that enables the design of energy functions on a low-dimensional model.
% We first abstract a persistent-feasibility-preserving low-dimensional model from the original model via consistent abstraction. That is, showing persistent feasibility on the abstracted model is equivalent to showing persistent feasibility on the original model.
Then we can synthesize the energy function with respect to the low-dimensional model to ensure persistent feasibility.
The resulting safe controller can be directly transferred to other systems with the same abstraction, e.g., when a robot arm holds different tools. 
The proposed approach is demonstrated on a 7-DoF robot arm (14 states) both in simulation and real-world. Our method always finds feasible control and achieves zero safety violations in 500 trials on 5 different systems.
\end{abstract}

% \begin{keyword}
% Five to ten keywords, preferably chosen from the IFAC keyword list.
% \end{keyword}

% \end{frontmatter}
%===============================================================================


\section{Introduction}

    \input{introduction.tex}

\section{Formulation}
    \input{formulation.tex}

\section{Consistent Abstraction Theory}
    \input{method.tex}

\section{Abstract Safe Control}
    \input{abstract-safe-control.tex}
    
\section{Experiment}\label{sec: experiment}
    \input{experiment.tex}

\section{Discussion}
    \input{conclusion.tex}

\bibliographystyle{IEEEtran}
\bibliography{reference}             % bib file to produce the bibliography
                                                     % with bibtex (preferred)
                                                   
%\begin{thebibliography}{xx}  % you can also add the bibliography by hand

%\bibitem[Able(1956)]{Abl:56}
%B.C. Able.
%\newblock Nucleic acid content of microscope.
%\newblock \emph{Nature}, 135:\penalty0 7--9, 1956.

%\bibitem[Able et~al.(1954)Able, Tagg, and Rush]{AbTaRu:54}
%B.C. Able, R.A. Tagg, and M.~Rush.
%\newblock Enzyme-catalyzed cellular transanimations.
%\newblock In A.F. Round, editor, \emph{Advances in Enzymology}, volume~2, pages
%  125--247. Academic Press, New York, 3rd edition, 1954.

%\bibitem[Keohane(1958)]{Keo:58}
%R.~Keohane.
%\newblock \emph{Power and Interdependence: World Politics in Transitions}.
%\newblock Little, Brown \& Co., Boston, 1958.

%\bibitem[Powers(1985)]{Pow:85}
%T.~Powers.
%\newblock Is there a way out?
%\newblock \emph{Harpers}, pages 35--47, June 1985.

%\bibitem[Soukhanov(1992)]{Heritage:92}
%A.~H. Soukhanov, editor.
%\newblock \emph{{The American Heritage. Dictionary of the American Language}}.
%\newblock Houghton Mifflin Company, 1992.

%\end{thebibliography}

\appendix                                                       
\subsection{\Cref{lem:affine_control} proof} \label{apd:affine_control_proof}
    \begin{proof}
    Based on \cref{eq:z_dyn}, we have
    \begin{align}
        \dot z = f_z(z) + g_z(z) v =  f_z(\Phi(x)) + g_z(\Phi(x)) v \label{eq: affine_a}
    \end{align}
    And in the meantime, we have
    \begin{align}
        \dot z =& \pd[\Phi(x)]{t} = \nabla \Phi(x) \dot x =  \nabla \Phi(x) f(x) + \nabla \Phi(x) g(x) u \label{eq: affine_b}
    \end{align}
    Therefore, connect \cref{eq: affine_a} and \cref{eq: affine_b} we have
    \begin{subequations}
    \begin{align}
        v =&  g_z(\Phi(x))^{-1}[\nabla \Phi(x) f(x) - f_z(\Phi(x))] \nonumber\\
           & + g_z(\Phi(x))^{-1} \nabla \Phi(x) g(x) u\\
        =  & C(x) u + d(x)
    \end{align} 
    \end{subequations}
    \end{proof}{}

\subsection{\Cref{lem:M} proof}\label{apd:M_proof}
\begin{proof}
The radius of the maximum $L_p$-norm inner ball can be found by
\begin{align}
    \max_{r} r \quad \st a_i(x) v \leq b_i(x), \forall \|v\|_p \leq r.
\end{align}
Based on HÃ¶lder's inequality, for $p,q$ that satisfy  $\frac{1}{p}+\frac{1}{q}=1$, we have
\begin{align}
    |a_i(x) v| \leq \|a_i(x)\|_q \|v\|_p
\end{align}
Therefore
\begin{align}
    \max_{\|v\|_p\leq r} a_i(x) v = \max_{\|v\|_p\leq r} |a_i(x) v| \leq \max_{M} \|a_i(x)\|_q M
\end{align}

\end{proof}
% \subsection{Parameter Estimation in safety Index}                             
% We just need to guarantee that $\dot{\phi} \le 0$, $\forall \phi=0$. This means for all $(d, \dot{d}, M)$, s.t. $\phi =d_{min}^{2}-d^2-k\frac{\dot{d}}{M}=0$, there exists $\ddot{d}\in \left[ -M,M \right]$ to satisfy the following inequality:  
% \begin{align}
%     \dot{\phi} &= -2d\dot{d}-k\frac{\ddot{d}}{M}+k\frac{\dot{d}}{M^2}\dot{M} \\
%     &\le -2d\dot{d}-k\frac{\ddot{d}}{M}+\mid \dot{d}\mid \frac{k}{M^2}\dot{M}_{\max}\le 0
% \end{align}
% We choose $\ddot{d}=-M$, then $k\ge -2d\dot{d}+\mid \dot{d}\mid \frac{k}{M^2}\dot{M}_{\max}$.
% % \begin{align}
% %     k\ge -2d\dot{d}+\mid \dot{d}\mid \frac{k}{M^2}\dot{M}_{\max}
% % \end{align}
% Since $\phi=0$, we have $k=M\frac{d_{min}^{2}-d^2}{\dot{d}}$ and 
% \begin{align}
%     k &\ge -2d\dot{d}+\frac{\mid \dot{d}\mid}{\dot{d}}\left( d_{min}^{2}-d^2 \right) \cdot \frac{\dot{M}_{\max}}{M} \\
%     &\ge 2\mid d\dot{d}\mid _{\max}+\mid d_{min}^{2}-d^2\mid _{\max}\cdot \frac{\dot{M}_{\max}}{M_{\min}}
% \end{align}
% which implies $k \ge 133.31$.

\end{document}

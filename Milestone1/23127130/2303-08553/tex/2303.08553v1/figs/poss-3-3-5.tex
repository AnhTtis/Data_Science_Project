\begin{tikzpicture}[scale=1,every node/.style={transform shape}]
% 
\newcommand*{\StrikeThruDistance}{0.3cm}%  
%
\tikzset{Rightarrow/.style={darkcyan,double distance=2pt,>={Implies},->},
         DashedRightarrow/.style={darkcyan,densely dashed,double distance=2pt,>={Implies},->},
         strike through/.append style={decoration={markings, mark=at position 0.5 with {\draw[-] ++ (-2pt,-2pt) -- (2pt,2pt);}},postaction={decorate}},
  loopentryred/.style={->,thick},        
  onebodyred/.style={->,thick,densely dotted},
  onebodyredcol/.style={->,thick,densely dotted},
  onebodyredalert/.style={->,thick,densely dotted,red},
  onebodyredrtc/.style={->>,thick,densely dotted},
  onebodyredrtccol/.style={->>,thick,densely dotted,darkcyan},
  onebodyredrtcalert/.style={->>,thick,densely dotted,red},
  % notoneactbodyredrtc/.style={->>,thick,densely dashed,red},
  % notonebodyredcol/.style={->,
  %                          decoration={markings,mark=at position 0.5 with \node{X};}
  %                          % decoration={markings,mark=at position 0.5 with 
  %                          %              {\draw [red,thick,-] 
  %                          %                 ++ ( 0,-\StrikeThruDistance) 
  %                          %                 -- ( 0, \StrikeThruDistance);}},
  %                          postaction={decorate},
  %                          thick,densely dotted,red},
  % notonebodyredrtccol/.style={->>,
  %                              decoration={markings,mark=at position 0.5 with 
  %                                           {\draw [red,thick,-] 
  %                                              ++ ( 0, -\StrikeThruDistance) 
  %                                              -- ( 0, \StrikeThruDistance);}},
  %                              postaction={decorate},
  %                              thick,densely dotted,red},
  convonebodyred/.style={<-,thick,densely dotted},
  convonebodyredcol/.style={<-,thick,densely dotted},
  oneactbodyred/.style={->,densely dashed},
  oneactbodyredcol/.style={->,thick,densely dashed},
  oneactbodyredtc/.style={-,densely dashed,thick,preaction={draw,DashedRightarrow}},
  oneactbodyredtccol/.style={-,densely dashed,thick,preaction={draw,DashedRightarrow}},
  oneactbodyredrtc/.style={->>,densely dashed},
  oneactbodyredrtccol/.style={->>,densely dashed},
  oneactbodyredrtcalert/.style={->>,thick,densely dashed,red},
  convoneactbodyredrtc/.style={<<-,densely dashed},
  convoneactbodyredrtccol/.style={<<-,thick,densely dashed},
  noonebodyred/.style={-,densely dashed,thick,preaction={draw,Rightarrow}},
  noonebodyredcol/.style={-,thick,red,preaction={draw,Rightarrow}},%{-,densely dashed,thick,darkcyan,preaction={draw,Rightarrow}},
    % triple/.style={-,preaction={draw,Rightarrow}},
    % quadruple/.style={preaction={draw,Rightarrow,shorten >=0pt},shorten >=1pt,-,double,doubledistance=0.2pt}
  strike thru arrow/.style={
    decoration={markings, mark=at position 0.5 with {
        \draw [blue, thick,-] 
            ++ (-\StrikeThruDistance,-\StrikeThruDistance) 
            -- ( \StrikeThruDistance, \StrikeThruDistance);}
    },
    postaction={decorate},
}    
}

% % 
% %---------
% % pos:3.1 
% %--------- 
% \matrix[anchor=center,row sep=0.8cm,column sep=1.15cm,every node/.style={draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt}] at (0,0) {
%                     &  \node(v){};
%   \\[0.25cm]
%   \node(w-1-bar){}; &  \node[draw=none,fill=none](h0){};
%                                     &  \node(w-2-bar){};  
%   \\
%   \node(w-1n){};    &               &  \node(w-2n){};
%   \\[-0.275cm]
%                     &  \node[draw=none,fill=none](label){};
%   \\[-0.275cm]
%   \node(w-11){};    &                &  \node(w-21){};
%   \\
%   \node(w-1){};     &  \node[draw=none,fill=none](h){}; 
%                                     &  \node(w-2){};
%   \\
% };
% \calcLength(v,h0){mylen};
% 
% 
% 
% \path (label) ++ (0pt,-5pt) node{\large \ref{pos:3},\ref{pos:3.1}};
% 
% 
% % (v) outgoing
% %
% \path (v) ++ (0pt,{0.25*\mylen pt}) node{$\avert$};
%   %
%   \path (v) ++ ({-0.5*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt] (v-01){};
%     \draw[loopentryred] (v) to (v-01);
%     \draw[oneactbodyredrtc,bend right,distance={0.35*\mylen pt}] (v-01) to (w-1-bar);
%   \path (v) ++ ({0.5*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt] (v-03){}; 
%     \draw[loopentryred] (v) to (v-03);
%     \draw[oneactbodyredrtc,bend left,distance={0.35*\mylen pt}] (v-03) to (w-2-bar);
%    
%    
% % (w-1-bar) outgoing   
% %     
% \draw[onebodyredcol,out=135,in=180,distance={1*\mylen pt}] (w-1-bar) to (v);         
% \path (w-1-bar) ++ ({-0.4*\mylen pt},{0.1*\mylen pt}) node{$\bvertbari{1}$};
% 
% \path (w-1-bar) ++ ({0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-1-v-11){};
%   \draw[loopentryred] (w-1-bar) to (v-1-v-11);
%   \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=-30,in=20] (v-1-v-11) to (w-1n);
%   
% 
% % (w-1n) outgoing
% % 
% \draw[-,dotted,thick,shorten <={0.2*\mylen pt},shorten >={0.2*\mylen pt}] (w-1n) to (w-11);
% 
% \draw[onebodyredcol,out=170,in=220,distance={0.5*\mylen pt}] (w-1n) to (w-1-bar);
% 
% % (w-1n) incoming
% %
% \draw[convonebodyredcol,out=210,in=90,distance={0.15*\mylen pt}] (w-1n) to ($(w-1n) + ({-0.4*\mylen pt},{-0.3*\mylen pt})$); 
% 
% 
% 
% % (w-11) 
% %
% \draw[onebodyredcol,thick,out=160,in=270,distance={0.25*\mylen pt}] (w-11) to ($(w-11) + ({-0.35*\mylen pt},{0.4*\mylen pt})$);    
% 
% 
% % (w-1) 
% %
% \path (w-1) ++ ({0*\mylen pt},{-0.25*\mylen pt}) node{$\bverti{1}$};
% \draw[onebodyredcol,out=170,in=220,distance={0.5*\mylen pt}] (w-1) to (w-11);
% 
% \path (w-11) ++ ({0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-n1-u-1){};
%   \draw[loopentryred] (w-11) to (v-n1-u-1);
%   \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=-30,in=20] (v-n1-u-1) to (w-1);
% \draw[loopentryred] (w-1n) to ($(w-1n) + ({-0.15*\mylen pt},{-0.3*\mylen pt})$);
% \draw[loopentryred] (w-1n) to ($(w-1n) + ({0.15*\mylen pt},{-0.3*\mylen pt})$);
% 
% 
% 
% 
% 
% % (w-2-bar) outgoing
% % 
% \path (w-2-bar) ++ ({0.4*\mylen pt},{0.1*\mylen pt}) node{$\bvertbari{2}$};
% \draw[onebodyredcol,out=45,in=0,distance={1*\mylen pt}] (w-2-bar) to (v);
% \draw[onebodyredcol,out=10,in=-40,distance={0.5*\mylen pt}] (w-2n) to (w-2-bar);
% 
% \path (w-2-bar) ++ ({-0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-2-v-12){};
%   \draw[loopentryred] (w-2-bar) to (v-2-v-12);
%   \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=210,in=160] (v-2-v-12) to (w-2n);
% 
% \draw[oneactbodyredrtcalert,shorten <= {0.1 *\mylen pt},shorten >={0.1 *\mylen pt}] 
%   (w-2-bar) to node[pos=0.5,sloped]{$\pmb{/}$} (w-1-bar);
% 
% 
% % w-2n outgoing
% % 
% \draw[-,dotted,thick,shorten <={0.2*\mylen pt},shorten >={0.2*\mylen pt}] (w-2n) to (w-21);
% %
% \draw[loopentryred] (w-2n) to ($(w-2n) + ({-0.15*\mylen pt},{-0.3*\mylen pt})$);
% \draw[loopentryred] (w-2n) to ($(w-2n) + ({0.15*\mylen pt},{-0.3*\mylen pt})$);
% 
% \draw[<-,densely dotted,darkcyan,thick,out=-30,in=90,distance={0.15*\mylen pt}] (w-2n) to ($(w-2n) + ({0.4*\mylen pt},{-0.3*\mylen pt})$); 
% 
% 
%                                                                 
%    
% % (w-21) ingoing/outgoing    
% %
% \draw[onebodyredcol,out=20,in=270,distance={0.25*\mylen pt}] (w-21) to ($(w-21) + ({0.35*\mylen pt},{0.4*\mylen pt})$);    
% 
% \path (w-21) ++ ({-0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-n2-u-2){};
%   \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=210,in=160] (v-n2-u-2) to (w-2);     
%   \draw[loopentryred] (w-21) to (v-n2-u-2);
%       
%      
%      
% % (w-2) outgoing    
% %
% \path (w-2) ++ ({0.075*\mylen pt},{-0.25*\mylen pt}) node{$\bverti{2}$};
% \draw[onebodyredcol,out=10,in=-40,distance={0.5*\mylen pt}] (w-2) to (w-21);     
%      
% 
% \draw[-,very thick,bend right,magenta,densely dashed,distance={0.75*\mylen pt}] 
%   (w-1) to node[pos=0.5](mid){} 
%            node[pos=0.65](left){} (w-2);





% %---------
% % pos:3.2
% %--------- 
% \matrix[anchor=center,row sep=0.8cm,column sep=1.15cm,every node/.style={draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt}] at (4.1,0) {
%                     &  \node(v){};
%   \\[0.25cm]
%   \node(w-1-bar){}; &  \node[draw=none,fill=none](h0){};
%                                     &  \node(w-2-bar){};  
%   \\
%   \node(w-1n){};    &               &  \node(w-2n){};
%   \\[-0.275cm]
%                     & \node[draw=none,fill=none](label){};
%   \\[-0.275cm]
%   \node(w-11){};    &                &  \node(w-21){};
%   \\
%   \node(w-1){};     &  \node[draw=none,fill=none](h){}; 
%                                     &  \node(w-2){};
%   \\
% };
% \calcLength(v,h0){mylen};
% 
% 
% 
% \path (label) ++ (0pt,-5pt) node{\large \ref{pos:3},\ref{pos:3.2}};
% 
% 
% % (v) outgoing
% %
% \path (v) ++ (0pt,{0.25*\mylen pt}) node{$\avert$};
%   %
%   \path (v) ++ ({-0.5*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt] (v-01){};
%     \draw[loopentryred] (v) to (v-01);
%     \draw[oneactbodyredrtc,bend right,distance={0.35*\mylen pt}] (v-01) to (w-1-bar);
%   \path (v) ++ ({0.5*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt] (v-03){}; 
%     \draw[loopentryred] (v) to (v-03);
%     \draw[oneactbodyredrtc,bend left,distance={0.35*\mylen pt}] (v-03) to (w-2-bar);
%    
%    
% % (w-1-bar) outgoing   
% %       
% \draw[oneactbodyredrtccol,out=135,in=180,distance={1*\mylen pt}] (w-1-bar) to (v);         
% %\draw[onebodyredalert,out=145,in=150,distance={1.2*\mylen pt},shorten >= 5pt] (w-1-bar) to node[pos=0.5,sloped]{$\pmb{/}$} (v);
% 
% \path (w-1-bar) ++ ({-0.4*\mylen pt},{0.1*\mylen pt}) node{$\bvertbari{1}$};
% 
% \path (w-1-bar) ++ ({0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-1-v-11){};
%   \draw[loopentryred] (w-1-bar) to (v-1-v-11);
%   \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=-30,in=20] (v-1-v-11) to (w-1n);
%   
% 
% % (w-1n) outgoing
% % 
% \draw[-,dotted,thick,shorten <={0.2*\mylen pt},shorten >={0.2*\mylen pt}] (w-1n) to (w-11);
% 
% \draw[onebodyredcol,out=170,in=220,distance={0.5*\mylen pt}] (w-1n) to (w-1-bar);
% 
% % (w-1n) incoming
% %
% \draw[<-,densely dotted,darkcyan,thick,out=210,in=90,distance={0.15*\mylen pt}] (w-1n) to ($(w-1n) + ({-0.4*\mylen pt},{-0.3*\mylen pt})$); 
% 
% 
% 
% % (w-11) 
% %
% \draw[onebodyredcol,out=160,in=270,distance={0.25*\mylen pt}] (w-11) to ($(w-11) + ({-0.35*\mylen pt},{0.4*\mylen pt})$);    
% 
% 
% % (w-1) 
% %
% \path (w-1) ++ ({0*\mylen pt},{-0.25*\mylen pt}) node{$\bverti{1}$};
% \draw[onebodyredcol,out=170,in=220,distance={0.5*\mylen pt}] (w-1) to (w-11);
% 
% \path (w-11) ++ ({0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-n1-u-1){};
%   \draw[loopentryred] (w-11) to (v-n1-u-1);
%   \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=-30,in=20] (v-n1-u-1) to (w-1);
% \draw[loopentryred] (w-1n) to ($(w-1n) + ({-0.15*\mylen pt},{-0.3*\mylen pt})$);
% \draw[loopentryred] (w-1n) to ($(w-1n) + ({0.15*\mylen pt},{-0.3*\mylen pt})$);
% 
% 
% % (w-2-bar) outgoing
% % 
% \path (w-2-bar) ++ ({0.4*\mylen pt},{0.1*\mylen pt}) node{$\bvertbari{2}$};
% \draw[oneactbodyredrtccol,out=45,in=0,distance={1*\mylen pt}] (w-2-bar) to (v);
% \draw[oneactbodyredrtccol,out=10,in=-40,distance={0.5*\mylen pt}] (w-2n) to (w-2-bar);
% 
% \path (w-2-bar) ++ ({-0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-2-v-12){};
%   \draw[loopentryred] (w-2-bar) to (v-2-v-12);
%   \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=210,in=160] (v-2-v-12) to (w-2n);
% 
% \draw[oneactbodyredrtcalert,shorten <= {0.1 *\mylen pt},shorten >={0.1 *\mylen pt}] 
%   (w-2-bar) to node[pos=0.5,sloped]{$\pmb{/}$} (w-1-bar);
% 
% 
% % w-2n outgoing
% % 
% \draw[-,dotted,thick,shorten <={0.2*\mylen pt},shorten >={0.2*\mylen pt}] (w-2n) to (w-21);
% %
% \draw[loopentryred] (w-2n) to ($(w-2n) + ({-0.15*\mylen pt},{-0.3*\mylen pt})$);
% \draw[loopentryred] (w-2n) to ($(w-2n) + ({0.15*\mylen pt},{-0.3*\mylen pt})$);
% 
% \draw[convoneactbodyredrtccol,out=-30,in=90,distance={0.15*\mylen pt}] (w-2n) to ($(w-2n) + ({0.4*\mylen pt},{-0.3*\mylen pt})$); 
% 
% 
%                                                                 
%    
% % (w-21) ingoing/outgoing    
% %
% \draw[oneactbodyredrtccol,out=20,in=270,distance={0.25*\mylen pt}] (w-21) to ($(w-21) + ({0.35*\mylen pt},{0.4*\mylen pt})$);    
% 
% \path (w-21) ++ ({-0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-n2-u-2){};
%   \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=210,in=160] (v-n2-u-2) to (w-2);     
%   \draw[loopentryred] (w-21) to (v-n2-u-2);
%       
%      
%      
% % (w-2) outgoing    
% %
% \path (w-2) ++ ({0.075*\mylen pt},{-0.25*\mylen pt}) node{$\bverti{2}$};
% \draw[oneactbodyredrtccol,out=10,in=-40,distance={0.5*\mylen pt}] (w-2) to (w-21);     
%      
% \draw[onebodyredrtcalert,out=0,in=-15,distance={1.1*\mylen pt},shorten >= 6pt] (w-2) to node[pos=0.5,sloped]{$\pmb{/}$} (w-2-bar);       
%      
%      
% 
% \draw[-,very thick,bend right,magenta,densely dashed,distance={0.75*\mylen pt}] 
%   (w-1) to node[pos=0.5](mid){} 
%            node[pos=0.65](left){} (w-2);
% 




%---------
% pos:3.3
%--------- 
\matrix[anchor=center,row sep=0.8cm,column sep=1.15cm,every node/.style={draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt}] at (-1.4,0) {
                    &  \node(v){};
  \\[0.25cm]
  \node(w-1-bar){}; &  \node[draw=none,fill=none](h0){};
                                    &  \node(w-2-bar){};  
  \\
  \node(w-1n){};    &               &  \node(w-2n){};
  \\[-0.275cm]
                    & \node[draw=none,fill=none](label){};
  \\[-0.275cm]
  \node(w-11){};    &                &  \node(w-21){};
  \\
  \node(w-1){};     &  \node[draw=none,fill=none](h){}; 
                                    &  \node(w-2){};
  \\
};
\calcLength(v,h0){mylen};



\path (label) ++ (0pt,-5pt) node{\LARGE (C3.2)}; %{\large \ref{pos:3},\ref{pos:3.3}};


% (v) outgoing
%
\draw[thick,densely dashed] (v) circle (0.12cm);
\path (v) ++ (0pt,{0.25*\mylen pt}) node{$\avert$};
  %
  \path (v) ++ ({-0.5*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt] (v-01){};
    \draw[loopentryred,shorten <= 2pt] (v) to (v-01);
    \draw[oneactbodyredrtc,bend right,distance={0.35*\mylen pt}] (v-01) to (w-1-bar);
  \path (v) ++ ({0.5*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt] (v-03){}; 
    \draw[loopentryred,shorten <= 2pt] (v) to (v-03);
    \draw[oneactbodyredrtc,bend left,distance={0.35*\mylen pt}] (v-03) to (w-2-bar);
   
   
% (w-1-bar) outgoing   
%     
\draw[oneactbodyredrtccol,out=135,in=180,distance={1*\mylen pt},shorten >= 2pt] (w-1-bar) to (v);         
\path (w-1-bar) ++ ({-0.4*\mylen pt},{0.1*\mylen pt}) node{$\bvertbari{1}$};

\path (w-1-bar) ++ ({0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-1-v-11){};
  \draw[loopentryred] (w-1-bar) to (v-1-v-11);
  \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=-30,in=20] (v-1-v-11) to (w-1n);
  

% (w-1n) outgoing
% 
\draw[-,dotted,thick,shorten <={0.2*\mylen pt},shorten >={0.2*\mylen pt}] (w-1n) to (w-11);

\draw[onebodyredcol,out=170,in=220,distance={0.5*\mylen pt}] (w-1n) to (w-1-bar);

% (w-1n) incoming
%
\draw[convonebodyredcol,thick,out=210,in=90,distance={0.15*\mylen pt}] (w-1n) to ($(w-1n) + ({-0.4*\mylen pt},{-0.3*\mylen pt})$); 



% (w-11) 
%
\draw[onebodyredcol,thick,out=160,in=270,distance={0.25*\mylen pt}] (w-11) to ($(w-11) + ({-0.35*\mylen pt},{0.4*\mylen pt})$);    


% (w-1) 
%
\path (w-1) ++ ({0*\mylen pt},{-0.25*\mylen pt}) node{$\bverti{1}$};
\draw[onebodyredcol,thick,out=170,in=220,distance={0.5*\mylen pt}] (w-1) to (w-11);

\path (w-11) ++ ({0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-n1-u-1){};
  \draw[loopentryred] (w-11) to (v-n1-u-1);
  \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=-30,in=20] (v-n1-u-1) to (w-1);
\draw[loopentryred] (w-1n) to ($(w-1n) + ({-0.15*\mylen pt},{-0.3*\mylen pt})$);
\draw[loopentryred] (w-1n) to ($(w-1n) + ({0.15*\mylen pt},{-0.3*\mylen pt})$);


% w-2-hat outgoing
% 
\path (w-2-bar) ++ ({0.4*\mylen pt},{0.1*\mylen pt}) node{$\bvertbari{2}$};
%\draw[loopentryred,noonebodyredcol,thick,out=45,in=0,distance={1*\mylen pt}] (w-2-bar) to (v);
  
\draw[oneactbodyredrtccol,out=45,in=0,distance={1*\mylen pt},shorten >= 2pt] (w-2-bar) to (v);    
\draw[onebodyredalert,out=35,in=30,distance={1.2*\mylen pt},shorten >= 5pt] (w-2-bar) to node[pos=0.5,sloped]{$\pmb{/}$} (v);




\path (w-2-bar) ++ ({-0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-2-v-12){};
  \draw[loopentryred] (w-2-bar) to (v-2-v-12);
  \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=210,in=160] (v-2-v-12) to (w-2n);

\draw[oneactbodyredrtcalert,shorten <= {0.1 *\mylen pt},shorten >={0.1 *\mylen pt}] 
  (w-2-bar) to node[pos=0.5,sloped]{$\pmb{/}$} (w-1-bar);


% w-2n outgoing
% 
\draw[onebodyredcol,thick,out=10,in=-40,distance={0.5*\mylen pt}] (w-2n) to (w-2-bar);
\draw[-,dotted,thick,shorten <={0.2*\mylen pt},shorten >={0.2*\mylen pt}] (w-2n) to (w-21);
%
\draw[loopentryred] (w-2n) to ($(w-2n) + ({-0.15*\mylen pt},{-0.3*\mylen pt})$);
\draw[loopentryred] (w-2n) to ($(w-2n) + ({0.15*\mylen pt},{-0.3*\mylen pt})$);

\draw[convonebodyredcol,thick,out=-30,in=90,distance={0.15*\mylen pt}] (w-2n) to ($(w-2n) + ({0.4*\mylen pt},{-0.3*\mylen pt})$); 
     
   
% (w-21) ingoing/outgoing    
%
\draw[onebodyredcol,thick,out=20,in=270,distance={0.25*\mylen pt}] (w-21) to ($(w-21) + ({0.35*\mylen pt},{0.4*\mylen pt})$);    

\path (w-21) ++ ({-0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-n2-u-2){};   
  \draw[loopentryred] (w-21) to (v-n2-u-2);
  \draw[oneactbodyred,distance={0.25*\mylen pt},out=210,in=160] (v-n2-u-2) to (w-2);  
      
     
     
% (w-2) outgoing    
%
\path (w-2) ++ ({0.075*\mylen pt},{-0.25*\mylen pt}) node{$\bverti{2}$};
\draw[onebodyredcol,out=10,in=-40,distance={0.5*\mylen pt}] (w-2) to (w-21);     
     

\draw[-,very thick,bend right,magenta,densely dashed,distance={0.75*\mylen pt}] 
  (w-1) to node[pos=0.5](mid){} 
           node[pos=0.65](left){} (w-2);
           
% % 
% %---------
% % pos:3.4 
% %--------- 
% \matrix[anchor=center,row sep=0.8cm,column sep=1.15cm,every node/.style={draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt}] at (0,-6) {
%                     &  \node(v){};
%   \\[0.25cm]
%   \node(w-1-bar){}; &  \node[draw=none,fill=none](h0){};
%                                     &  \node(w-2-bar){};  
%   \\
%   \node(w-1n){};    &               &  \node(w-2n){};
%   \\[-0.275cm]
%                     &  \node[draw=none,fill=none](label){};
%   \\[-0.275cm]
%   \node(w-11){};    &                &  \node(w-21){};
%   \\
%   \node(w-1){};     &  \node[draw=none,fill=none](h){}; 
%                                     &  \node(w-2){};
%   \\
% };
% \calcLength(v,h0){mylen};
% 
% 
% 
% \path (label) ++ (0pt,-5pt) node{\large \ref{pos:3},\ref{pos:3.4}};
% 
% 
% % (v) outgoing
% %
% \path (v) ++ (0pt,{0.25*\mylen pt}) node{$\avert$};
%   %
%   \path (v) ++ ({-0.5*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt] (v-01){};
%     \draw[loopentryred] (v) to (v-01);
%     \draw[oneactbodyredrtc,bend right,distance={0.35*\mylen pt}] (v-01) to (w-1-bar);
%   \path (v) ++ ({0.5*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt] (v-03){}; 
%     \draw[loopentryred] (v) to (v-03);
%     \draw[oneactbodyredrtc,bend left,distance={0.35*\mylen pt}] (v-03) to (w-2-bar);
%    
%    
% % (w-1-bar) outgoing   
% %     
% \draw[oneactbodyredrtccol,out=135,in=180,distance={1*\mylen pt}] (w-1-bar) to (v);         
% \path (w-1-bar) ++ ({-0.4*\mylen pt},{0.1*\mylen pt}) node{$\bvertbari{1}$};
% 
% \path (w-1-bar) ++ ({0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-1-v-11){};
%   \draw[loopentryred] (w-1-bar) to (v-1-v-11);
%   \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=-30,in=20] (v-1-v-11) to (w-1n);
%   
% \draw[oneactbodyredrtcalert,shorten <= {0.1 *\mylen pt},shorten >={0.1 *\mylen pt},out=155,in=25] 
%   (w-2-bar) to node[pos=0.5,sloped]{$\pmb{/}$} (w-1-bar);  
%   
% 
% % (w-1n) outgoing
% % 
% \draw[-,dotted,thick,shorten <={0.2*\mylen pt},shorten >={0.2*\mylen pt}] (w-1n) to (w-11);
% 
% \draw[oneactbodyredrtccol,out=170,in=220,distance={0.5*\mylen pt}] (w-1n) to (w-1-bar);
% 
% \draw[oneactbodyredrtccol,shorten <= {0.1 *\mylen pt},shorten >={0.1 *\mylen pt}] 
%   (w-1-bar) to (w-2-bar);
%   
% % \draw[oneactbodyredrtcalert,shorten <= {0.1 *\mylen pt},shorten >={0.1 *\mylen pt}] 
% %   (w-2-bar) to node[pos=0.5,sloped]{$\pmb{/}$} (w-1-bar);
% 
% 
% 
% % (w-1n) incoming
% %
% \draw[convoneactbodyredrtccol,out=210,in=90,distance={0.15*\mylen pt}] (w-1n) to ($(w-1n) + ({-0.4*\mylen pt},{-0.3*\mylen pt})$); 
% 
% 
% 
% % (w-11) 
% %
% \draw[oneactbodyredrtccol,thick,out=160,in=270,distance={0.25*\mylen pt}] (w-11) to ($(w-11) + ({-0.35*\mylen pt},{0.4*\mylen pt})$);    
% 
% 
% % (w-1) 
% %
% \path (w-1) ++ ({0*\mylen pt},{-0.25*\mylen pt}) node{$\bverti{1}$};
% \draw[oneactbodyredrtccol,out=170,in=220,distance={0.5*\mylen pt}] (w-1) to (w-11);
% 
% \path (w-11) ++ ({0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-n1-u-1){};
%   \draw[loopentryred] (w-11) to (v-n1-u-1);
%   \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=-30,in=20] (v-n1-u-1) to (w-1);
% \draw[loopentryred] (w-1n) to ($(w-1n) + ({-0.15*\mylen pt},{-0.3*\mylen pt})$);
% \draw[loopentryred] (w-1n) to ($(w-1n) + ({0.15*\mylen pt},{-0.3*\mylen pt})$);
% 
% \draw[onebodyredrtcalert,out=180,in=195,distance={1.1*\mylen pt},shorten >= 6pt] (w-1) to node[pos=0.5,sloped]{$\pmb{/}$} (w-1-bar);     
% 
% 
% 
% % (w-2-bar) outgoing
% % 
% \path (w-2-bar) ++ ({0.4*\mylen pt},{0.1*\mylen pt}) node{$\bvertbari{2}$};
% \draw[onebodyredcol,out=45,in=0,distance={1*\mylen pt}] (w-2-bar) to (v);
% \draw[onebodyredcol,out=10,in=-40,distance={0.5*\mylen pt}] (w-2n) to (w-2-bar);
% 
% \path (w-2-bar) ++ ({-0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-2-v-12){};
%   \draw[loopentryred] (w-2-bar) to (v-2-v-12);
%   \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=210,in=160] (v-2-v-12) to (w-2n);
% 
%   
% 
% % w-2n outgoing
% % 
% \draw[-,dotted,thick,shorten <={0.2*\mylen pt},shorten >={0.2*\mylen pt}] (w-2n) to (w-21);
% %
% \draw[loopentryred] (w-2n) to ($(w-2n) + ({-0.15*\mylen pt},{-0.3*\mylen pt})$);
% \draw[loopentryred] (w-2n) to ($(w-2n) + ({0.15*\mylen pt},{-0.3*\mylen pt})$);
% 
% \draw[<-,densely dotted,darkcyan,thick,out=-30,in=90,distance={0.15*\mylen pt}] (w-2n) to ($(w-2n) + ({0.4*\mylen pt},{-0.3*\mylen pt})$); 
% 
% 
%                                                                 
%    
% % (w-21) ingoing/outgoing    
% %
% \draw[onebodyredcol,out=20,in=270,distance={0.25*\mylen pt}] (w-21) to ($(w-21) + ({0.35*\mylen pt},{0.4*\mylen pt})$);    
% 
% \path (w-21) ++ ({-0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-n2-u-2){};
%   \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=210,in=160] (v-n2-u-2) to (w-2);     
%   \draw[loopentryred] (w-21) to (v-n2-u-2);
%       
%      
%      
% % (w-2) outgoing    
% %
% \path (w-2) ++ ({0.075*\mylen pt},{-0.25*\mylen pt}) node{$\bverti{2}$};
% \draw[onebodyredcol,out=10,in=-40,distance={0.5*\mylen pt}] (w-2) to (w-21);     
%      
% 
% \draw[-,very thick,bend right,magenta,densely dashed,distance={0.75*\mylen pt}] 
%   (w-1) to node[pos=0.5](mid){} 
%            node[pos=0.65](left){} (w-2);     
%           
       
       
%---------
% pos:3.5
%--------- 
\matrix[anchor=center,row sep=0.8cm,column sep=1.15cm,every node/.style={draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt}] at (4.1,0) {
                    &  \node(v){};
  \\[0.25cm]
  \node(w-1-bar){}; &  \node[draw=none,fill=none](h0){};
                                    &  \node(w-2-bar){};  
  \\
  \node(w-1n){};    &               &  \node(w-2n){};
  \\[-0.275cm]
                    & \node[draw=none,fill=none](label){};
  \\[-0.275cm]
  \node(w-11){};    &                &  \node(w-21){};
  \\
  \node(w-1){};     &  \node[draw=none,fill=none](h){}; 
                                    &  \node(w-2){};
  \\
};
\calcLength(v,h0){mylen};


\path (label) ++ (0pt,-5pt) node{\LARGE (C3.4)}; %{\large \ref{pos:3},\ref{pos:3.5}};


% (v) outgoing
%

\draw[thick,densely dashed] (v) circle (0.12cm);
\path (v) ++ (0pt,{0.25*\mylen pt}) node{$\avert$};
  %
  \path (v) ++ ({-0.5*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt] (v-01){};
    \draw[loopentryred,shorten <= 2pt] (v) to (v-01);
    \draw[oneactbodyredrtc,bend right,distance={0.35*\mylen pt}] (v-01) to (w-1-bar);
  \path (v) ++ ({0.5*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt] (v-03){}; 
    \draw[loopentryred,shorten <= 2pt] (v) to (v-03);
    \draw[oneactbodyredrtc,bend left,distance={0.35*\mylen pt}] (v-03) to (w-2-bar);
   
\draw[oneactbodyredrtcalert,shorten <= {0.1 *\mylen pt},shorten >={0.1 *\mylen pt},out=155,in=25] 
  (w-2-bar) to node[pos=0.5,sloped]{$\pmb{/}$} (w-1-bar); 
   
% (w-1-bar) outgoing   
% 
\draw[oneactbodyredrtccol,out=135,in=180,distance={1*\mylen pt},shorten >= 2pt] (w-1-bar) to (v);  
\draw[onebodyredalert,out=145,in=150,distance={1.2*\mylen pt},shorten >= 5pt] (w-1-bar) to node[pos=0.5,sloped]{$\pmb{/}$} (v);     
%\draw[noonebodyredcol,out=135,in=180,distance={1*\mylen pt}] (w-1-bar) to (v);  

\draw[oneactbodyredrtccol,shorten <= {0.1 *\mylen pt},shorten >={0.1 *\mylen pt}] 
  (w-1-bar) to (w-2-bar);

       
\path (w-1-bar) ++ ({-0.4*\mylen pt},{0.1*\mylen pt}) node{$\bvertbari{1}$};

\path (w-1-bar) ++ ({0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-1-v-11){};
  \draw[loopentryred] (w-1-bar) to (v-1-v-11);
  \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=-30,in=20] (v-1-v-11) to (w-1n);
  

% (w-1n) outgoing
% 
\draw[-,dotted,thick,shorten <={0.2*\mylen pt},shorten >={0.2*\mylen pt}] (w-1n) to (w-11);

\draw[onebodyredcol,out=170,in=220,distance={0.5*\mylen pt}] (w-1n) to (w-1-bar);

% (w-1n) incoming
%
\draw[<-,densely dotted,thick,out=210,in=90,distance={0.15*\mylen pt}] (w-1n) to ($(w-1n) + ({-0.4*\mylen pt},{-0.3*\mylen pt})$); 



% (w-11) 
%
\draw[onebodyredcol,out=160,in=270,distance={0.25*\mylen pt}] (w-11) to ($(w-11) + ({-0.35*\mylen pt},{0.4*\mylen pt})$);    


% (w-1) 
%
\path (w-1) ++ ({0*\mylen pt},{-0.25*\mylen pt}) node{$\bverti{1}$};
\draw[onebodyredcol,out=170,in=220,distance={0.5*\mylen pt}] (w-1) to (w-11);

\path (w-11) ++ ({0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-n1-u-1){};
  \draw[loopentryred] (w-11) to (v-n1-u-1);
  \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=-30,in=20] (v-n1-u-1) to (w-1);
\draw[loopentryred] (w-1n) to ($(w-1n) + ({-0.15*\mylen pt},{-0.3*\mylen pt})$);
\draw[loopentryred] (w-1n) to ($(w-1n) + ({0.15*\mylen pt},{-0.3*\mylen pt})$);


% (w-2-bar) outgoing
% 
\path (w-2-bar) ++ ({0.4*\mylen pt},{0.1*\mylen pt}) node{$\bvertbari{2}$};
\draw[onebodyredcol,out=45,in=0,distance={1*\mylen pt},shorten >= 2pt] (w-2-bar) to (v);
\draw[onebodyredcol,out=10,in=-40,distance={0.5*\mylen pt}] (w-2n) to (w-2-bar);

\path (w-2-bar) ++ ({-0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-2-v-12){};
  \draw[loopentryred] (w-2-bar) to (v-2-v-12);
  \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=210,in=160] (v-2-v-12) to (w-2n);





% w-2n outgoing
% 
\draw[-,dotted,thick,shorten <={0.2*\mylen pt},shorten >={0.2*\mylen pt}] (w-2n) to (w-21);
%
\draw[loopentryred] (w-2n) to ($(w-2n) + ({-0.15*\mylen pt},{-0.3*\mylen pt})$);
\draw[loopentryred] (w-2n) to ($(w-2n) + ({0.15*\mylen pt},{-0.3*\mylen pt})$);

\draw[<-,densely dotted,thick,out=-30,in=90,distance={0.15*\mylen pt}] (w-2n) to ($(w-2n) + ({0.4*\mylen pt},{-0.3*\mylen pt})$); 


                                                                
   
% (w-21) ingoing/outgoing    
%
\draw[onebodyredcol,out=20,in=270,distance={0.25*\mylen pt}] (w-21) to ($(w-21) + ({0.35*\mylen pt},{0.4*\mylen pt})$);    

\path (w-21) ++ ({-0.25*\mylen pt},{-0.4*\mylen pt}) node[draw,thick,circle,minimum width=2.5pt,fill,inner sep=0pt,outer sep=2pt](v-n2-u-2){};
  \draw[oneactbodyredrtc,distance={0.25*\mylen pt},out=210,in=160] (v-n2-u-2) to (w-2);     
  \draw[loopentryred] (w-21) to (v-n2-u-2);
      
     
     
% (w-2) outgoing    
%
\path (w-2) ++ ({0.075*\mylen pt},{-0.25*\mylen pt}) node{$\bverti{2}$};
\draw[onebodyredcol,out=10,in=-40,distance={0.5*\mylen pt}] (w-2) to (w-21);     
     

\draw[-,very thick,bend right,magenta,densely dashed,distance={0.75*\mylen pt}] 
  (w-1) to node[pos=0.5](mid){} 
           node[pos=0.65](left){} (w-2);       
       
       
\end{tikzpicture}
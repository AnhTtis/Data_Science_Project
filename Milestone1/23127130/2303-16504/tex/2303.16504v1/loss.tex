\section{Induction Part 2: For Loss}\label{sec:induction_for_loss}

In Section~\ref{sec:induction_for_loss}, we establish a bound for the loss at any time. To accomplish this, we decompose the loss $\|y-F(k+1)\|_2^2$ into three parts, namely $C_1,C_2$, and $C_3$, which are defined and discussed in Section~\ref{sec:indcution_for_loss:decomposition}. We provide our choices for $m$ and $\eta$ in Section~\ref{sec:induction_for_loss:choice_parameters}, while Section~\ref{sec:induction_for_loss:C_1}, Section~\ref{sec:induction_for_loss:C_2}, and Section~\ref{sec:induction_for_loss:C_3} respectively establish bounds for $C_1,C_2$, and $C_3$.

\subsection{Decomposition for \texorpdfstring{$\|y-F(t+1)\|_2^2$}{}}\label{sec:indcution_for_loss:decomposition}

In this section, we decompose the loss $\|y-F(t+1)\|_2^2$ into three parts $C_1, C_2$ and $C_3$.

\begin{lemma}\label{lem:rewrite_shrinking_one_step}
Assuming the following condition is met:
\begin{itemize}
    \item $C_1 = -2m \eta (F(t)-y)^\top H(t) (F(t)-y)$
    \item $C_2 = 2 m \eta^2 (F(t)-y)^\top H_{\asy} (t) (F(t)-y)$
    \item $C_3 = \| F(t+1) - F(t) \|_2^2$
\end{itemize}
then
\begin{align*}
\|F(t+1) - y\|_2^2 \leq \| F(t )-y\|_2^2 + C_1 + C_2 + C_3
\end{align*}
\end{lemma}
\begin{proof}
In the following manner, we can express $F(t+1) - F(t) \in \R^n$:
\begin{align*}
F(t+1) - F(t) = v_1 + v_2 .
\end{align*}




Using the notation of $H$, we can express $v_{1,i} \in \R$ as follows: 

\begin{align*}
v_{1,i} 
= & ~  \sum_{r\in [m]} a_r  \cdot \exp(\langle x_i,w_r(t)\rangle) \cdot (-\eta \langle x_i,\Delta w_r(t) \rangle ) \\
= & ~  \sum_{r\in [m]} a_r  \cdot \exp(\langle x_i,w_r(t)\rangle) \cdot ( - \eta  \sum_{j\in [n]} (F_j(t) - y_j) a_r x_j^\top \exp( w_r^\top x_j ) ) x_i\\
= & ~ - m\eta \cdot \frac{1}{m} \sum_{j\in [n]} x_i^\top x_j (F_j - y_j) \sum_{r\in [m]} \exp( \langle w_r(t) , x_i \rangle ) \cdot \exp( \langle w_r(t) , x_j \rangle) \\
= & ~ - m \eta \cdot  \sum_{j\in [n]} (F_j - y_j) ( H_{i,j}(t) ) ,
\end{align*}
where the second step follows from Definition~\ref{def:Delta_w_r_at_time_t}.

The equation above indicates that the vector $v_1 \in \R^n$ can be expressed as
\begin{align}\label{eq:rewrite_v1}
v_1 = m \eta ( y - F(t) )^\top ( H( t ) ) .
\end{align}

Let $p_{i,r} \in [-1,1]$.
Similarly
\begin{align*}
v_{2,i} 
= & ~ \sum_{r\in [m ]} a_r  \cdot \exp(\langle w_r(t),x_i\rangle) \cdot (\eta^2 p_{i,r} \langle \Delta x_i,w_r(t) \rangle ) \\
= & ~ \sum_{r\in [m]} a_r  \cdot \exp(\langle w_r(t),x_i\rangle) \cdot (  \eta^2 p_{i,r} \cdot \sum_{j=1}^n (F_j(t) - y_j) a_r x_j^\top \exp( \langle w_r, x_j \rangle) ) x_i\\
= & ~  m \eta^2 \frac{1}{ m } \sum_{j\in [n]} x_i^\top x_j (F_j - y_j) \sum_{r=1}^m p_{i,r} \exp( \langle w_r(t) , x_i \rangle ) \cdot \exp( \langle w_r(t) , x_j \rangle) \\
= & ~ m \eta^2 \sum_{j=1}^n (F_j - y_j) ( (H_{\asy}(t))_{i,j} ) ,
\end{align*}
The expression $\| y - F(t+1) \|_2^2$ can be rewritten in the following:
\begin{align*}
& ~\| y - F(t+1) \|_2^2\\
= & ~ \| y - F(t) - ( F(t+1) - F(t) ) \|_2^2 \\
= & ~ \| y - F(t) \|_2^2 - 2 ( y - F(t) )^\top  ( F(t+1) - F(t) ) +  \| F(t+1) - F(t) \|_2^2 .
\end{align*}

We can rephrase the second term in the Equation above as follows:
\begin{align*}
 & ~ \langle y - F(t), F(t+1) - F(t)\rangle \\
= & ~ \langle y - F(t) , v_1 + v_2 \rangle \\
= & ~ \langle y - F(t) , v_1\rangle + \langle y - F(t),v_2\rangle  \\
= & ~ m\eta (  F(t)-y )^\top H(t) (F(t) -y) - m \eta^2 ( F(t)-y )^\top H_{\asy}  (F(t)-y),
\end{align*}
where the third step is from Eq.~\eqref{eq:rewrite_v1}.



 

Therefore, we can conclude that
\begin{align*}
\| F(t+1)-y \|_2^2 
\leq  \| F(t)- y \|_2^2 + C_1 + C_2 + C_3
\end{align*}
where the last step follows from Lemma~\ref{lem:loss_one_step_shrinking}. 
\end{proof}

\subsection{Choice of Parameters}\label{sec:induction_for_loss:choice_parameters}
In  this section, we propose our choice of parameters $m,\eta, R, B$.
\begin{lemma} \label{lem:loss_one_step_shrinking}
    If the following conditions hold
\begin{itemize}
    \item Condition 1. $m = \Omega( \lambda^{-2} n^2 \exp(4 B) \log(n/\delta))$
    \item Condition 2. $\eta=0.01 \lambda / ( m n^2 \exp(4 B) ) $ 
    \item Condition 3. $R = 0.01 \lambda / ( n \exp( B) )$  
    \begin{itemize} 
        \item Required by Claim~\ref{cla:C1}
    \end{itemize}
    \item Condition 4. $R \leq 1 \leq B$
    \begin{itemize}
        \item Required by Claim~\ref{cla:C2} and Claim~\ref{cla:C3}
    \end{itemize}
    \item Condition 5. $D = 8 \lambda^{-1} \exp(B+R) \frac{ \sqrt{n} }{m} \| y - F(0) \|_2$
    \item Condition 6. $D < R$
    
    \item Condition 7. $\eta \| \Delta_r (t) \|_2 \leq 0.01$ for all $r \in [m]$
    \begin{itemize}
        \item Required by Claim~\ref{cla:C3}
    \end{itemize}
\end{itemize}
Then it holds that
\begin{align*}
    \|F(t+1)- y  \|_2^2 \leq  \|  F(t)-y  \|_2^2 \cdot ( 1 - m \eta \lambda / 2 )
\end{align*}
holds with probability $1-\delta$.
\end{lemma}
\begin{proof}
We can show
\begin{align*}
\| F(t+1)-y \|_2^2 
\leq & ~ \|  F(t)-y \|_2^2 + C_1 + C_2 + C_3 \\
\leq & ~ (1- m \eta \lambda + 2 m^2 \eta^2 n^2 \exp(4 B)) \cdot \|  F(t)-y \|_2^2 .
\end{align*}
where the first step follows from Lemma~\ref{lem:rewrite_shrinking_one_step}, the second step follows from Claim~\ref{cla:C1}, Claim~\ref{cla:C2}, and Claim~\ref{cla:C3}.
 

\paragraph{Choice of $\eta$.}

Next, we want to choose $\eta$  such that
\begin{equation}\label{eq:choice_of_eta_R}
(1- m \eta \lambda + 2 m^2 \eta^2 n^2 \exp(4 B))\leq (1- m \eta\lambda/2) .
\end{equation}

Using the choice of $\eta$ in Condition 2
\begin{align*}
 2 m^2 \eta^2 n^2 \exp(4 B) \leq  m \eta \lambda /4 
\end{align*}
This indicates:
\begin{align}\label{eq:1-eta_lambda_2}
\|  F(t+1) -y\|_2^2 \leq & ~( 1 - m \eta \lambda / 2 )\cdot \|F(t)-y\|_2^2  
\end{align}

\paragraph{lower bound for $m$, over-parametrization Size}



We require the following two conditions
\begin{itemize}
    \item $ D= 8 \lambda^{-1} \exp(B +  R) \cdot \frac{\sqrt{n}}{m} \|y-F(0)\|_2 < R = 0.01 \lambda /(n \exp(B)) $
    \item $\| y - F(0)\|_2 = O(\sqrt{n})$
    \item $3n^2\exp(-mR/10)\leq  \delta$
\end{itemize}

Therefore, it suffices to choose:
 \begin{align*}
 m = \Omega( \lambda^{-2} n^2 \exp(4 B) \log(n/\delta) ).
 \end{align*}
\end{proof}




\subsection{Bounding the first order term}\label{sec:induction_for_loss:C_1}
In this section, we bound the first order term $C_1$.
\begin{claim}\label{cla:C1}
If the following conditions hold
\begin{itemize}
    \item Let $B$ be defined as Definition~\ref{def:B}
    \item $C_1 = -2 m\eta (F(t)-y)^\top H(t) (F(t)-y)$
    \item $R\leq 0.01 \lambda / ( n \exp( B) )$
    \item $m = \Omega( \lambda^{-2} \cdot n^2 \cdot \exp(2B) \cdot \sqrt{\log(n/\delta)} )$
\end{itemize}
Then, we have
\begin{align*}
C_1 \leq - m\eta \lambda\cdot \| y - F(t) \|_2^2 
\end{align*}
holds with probability at least $1-(n^2 \cdot \exp(-m R/10)+\delta)$.
\end{claim}

\begin{proof}
By Lemma \ref{lem:perturb_w}, with probability $1-(n^2 \cdot \exp(-m R/10)+\delta)$, we have
\begin{align}\label{eq:upper_lambda}
   & ~ \|H(0)-H(t)\|_F \notag \\
   \leq & ~ 3n R  e^{B}\notag\\
    \leq & ~ \lambda / 4
\end{align}
where the last step follows from choice of $R$ (see Claim Statement).

Given that $\lambda=\lambda_{\min}(H(0))$, by Lemma~\ref{lem:3.1}, we have
\begin{align*}
& ~ \lambda_{\min}(H(t)) \\
\geq & ~ \lambda_{\min}(H(0))- \|H(0)-H(t)\| \\
\geq & ~ \lambda /2.
\end{align*}
where the second step follows from $\lambda_{\min}(H(0))\geq \lambda/2$ and Eq.\eqref{eq:upper_lambda}.

And now we can conclude that
\begin{align*}
  (F(t)-y)^\top H(t) (F(t)-y ) \geq \lambda / 2\cdot\|F(t)-y \|_2^2 .
\end{align*}
\end{proof}

\subsection{Bounding the second order term}\label{sec:induction_for_loss:C_2}
In this section, we bound the second order term $C_2$.


\begin{claim}\label{cla:C2}
If the following conditions hold
\begin{itemize}
    \item $C_2 =  2 \langle y - F(t),v_2\rangle$.
    \item $ R < B $
\end{itemize}
Then we can conclude that
\begin{align*}
C_2 \leq 2 m\eta^2 n \exp(4B) \cdot \| F(t) - y \|_2^2  .
\end{align*}
with probability at least $1-n\cdot \exp(-mR)$.
\end{claim}
\begin{proof}
It holds that
\begin{align*}
C_2 \leq & ~ 2m\eta^2 (F(t)-y)^\top H_{\asy} (F(t)-y) \\
\leq & ~ 2m\eta^2 \| F(t)-y\|_2^2 \cdot \| H_{\asy} \| \\
\leq & ~ 2m\eta^2 \| F(t)-y\|_2^2 \cdot \| H_{\asy} \|_F \\
\leq & ~ 2m\eta^2 \| F(t)-y\|_2^2 \cdot n \| H_{\asy} \|_{\infty} \\
\leq & ~ 2m\eta^2 \| F(t)-y\|_2^2 \cdot n \cdot \exp(4 B )
\end{align*}
where the first step is from $P \in [-1,1]^{m\times n} $, the second step is from Fact~\ref{fac:norm}, the third step is from Fact~\ref{fac:norm}, the forth step follows from Fact~\ref{fac:norm}, the fifth step follows from Claim~\ref{cla:upper_bound_HP}.


\end{proof}







\subsection{Bounding \texorpdfstring{$\| F(t+1) - F(t) \|_2^2$}{}}\label{sec:induction_for_loss:C_3}
In this section, we bound the third order term $C_3$.

\begin{claim}\label{cla:C3}
If the following conditions hold
\begin{itemize}
 \item $C_3  = \| F(t+1) - F(t) \|_2^2$.
 \item $\eta \| \Delta w_r(t) \|_2 \leq 0.01$
 \item $R \leq B$
\end{itemize}
Then with probability at least $1-\delta$, we have
\begin{align*}
C_3 \leq m^2 \eta^2 \cdot n^2 \cdot \exp(8 B) \cdot \| F(t)-y \|_2^2.
\end{align*}
\end{claim}
 
\begin{proof}
According to definition of $F_i(t)$, we have
\begin{align*}
& ~ F_i(t+1) - F_i(t) \\
= & ~   \sum_{r\in [m]} a_r \cdot ( \exp( \langle x_i,w_r(t+1)\rangle ) - \exp(\langle w_r(t),x_i\rangle ) )  \\
= & ~  \sum_{r\in [m]} a_r \cdot \exp(\langle x_i,w_r(t)\rangle) \cdot ( \exp(- \eta 
\langle \Delta  w_r(t),x_i\rangle) - 1 ) 
\end{align*}

Then we have
\begin{align}\label{eq:bound_u_i_k}
|F_i(t+1) - F_i(t) |
\leq & ~ \sum_{r=1}^m \exp(w_r(t)^\top x_i) \cdot | \exp(- \eta \Delta w_r(t)^\top x_i) - 1 | \notag \\
\leq & ~ \sum_{r=1}^m \exp(B+R) \cdot | \exp(- \eta \Delta w_r(t)^\top x_i) - 1 | \notag \\
\leq & ~ \sum_{r=1}^m \exp(B+R) \cdot 2 \eta \| \Delta w_r(t) \|_2 \notag \\
\leq & ~ 2 \eta \exp(B+R) \sum_{r=1}^m \| \Delta w_r(t) \|_2 \notag \\
\leq & ~ 2 \eta \exp(B+R) \sum_{r=1}^m \exp(B + R)  \sqrt{n}\| y - F(t) \|_2 \notag \\
= & ~ 2 m \eta \exp( 2 (B+R) )  \sqrt{n}\| y - F(t) \|_2 
\end{align}     
where the second step is from Lemma~\ref{lem:bound_on_exp_w_and_perturb_w}, the third step is from $\eta \| \Delta w_r(t) \|_2 \leq 0.1 $ and Fact~\ref{fac:taylor}, the fifth step is due to Lemma~\ref{lem:bound_Delta_w_at_time_s}.

We can conclude
\begin{align*}
\| F(t+1) - F(t) \|_2^2 \leq & ~ n \cdot ( 2 m \eta \cdot \exp( 2 (B+R) )  \sqrt{n}\|  F(t)-y \|_2 )^2 \\
\leq & ~ 4 m^2 \eta^2 \cdot n^2 \cdot \exp(4 (B+R) ) \cdot \| F(t)-y \|_2^2 \\
\leq & ~ 4 m^2 \eta^2 \cdot n^2 \cdot \exp( 8 B ) \cdot \| F(t) -y\|_2^2
\end{align*}
where the first step is due to Eq.~\eqref{eq:bound_u_i_k}.
\end{proof}

\begin{figure}
    \centering
    \begin{tikzpicture}
    \begin{axis}[
        xmode=log,
        width=\textwidth,
        height=.6\textwidth,
        bar width=.35cm,
        stack negative=separate,
        ybar stacked,
        xmin=0.667,
        xmax=3072,
        ymin=-2,
        ymax=1.0,
        xtick={1,2,4,8,16,32,64,128,256,512,1024,2048},
        xticklabels={8M{\\}1N,16M{\\}2N,32M{\\}4N,64M{\\}8N,128M{\\}16N,256M{\\}32N,512M{\\}64N,1B{\\}128N,2B{\\}256N, 4B{\\}512N, 8B{\\}1024N, 16B{\\}2048N},
        % xtick={1,4,16,64,256,1024,4096},
        % xticklabels={8M{\\}1N,32M{\\}4N,128M{\\}16N,512M{\\}64N,2B{\\}256N,8B{\\}1024N,16B{\\}2048N},
        % xtick={2,8,32,128,512,2048},
        % xticklabels={16M{\\} 2N, 64M{\\}8N, 256M{\\}32N, 1B{\\}128N, 4B{\\}512N, 16B{\\}2048N},
        xticklabel style={align=center,text width=9.49mm},
        xlabel={Matrix dimension (1M=$10^6$, 1B=$10^9$), number of nodes (1N = 56 cores)},
        x label style={at={(axis description cs:0.5,-0.15)},anchor=north},
        ylabel={time (s)},
        ymajorgrids=true,  
        yminorgrids=true,
        minor y tick num=1,
        % legend pos=north east,
        legend columns=5,
        legend style={at={(0.5,1.12)}, anchor=north},
        % ytick={-0.2, 0, 0.2, 0.4, 0.6, 0.8, 1.0},
        % yticklabels={0.2, 0, 0.2, 0.4, 0.6, 0.8, 1.0},
    ]
    \addplot +[draw=black,
    color=blue5_2,
    fill opacity=0.8,
    ] table [x=Node,y=SpMV] {Review/weak_L8_prec.dat};
    \addplot +[draw=black,
    color=hcorange,
    fill opacity=0.8,
    ] table [x=Node,y=Solve] {Review/weak_L8_prec.dat};
    \addplot +[draw=black,
    color=green5_2,
    fill opacity=0.6,
    ] table [x=Node,y=Ortho_Comp] {Review/weak_L8_prec.dat};
    \addplot +[draw=black,
    color=black,
    fill opacity=0.8,
    ] table [x=Node,y=Ortho_Comm] {Review/weak_L8_prec.dat};
    \addplot +[draw=black,
    color=hcred,
    fill opacity=0.8,
    ] table [x=Node,y=Others] {Review/weak_L8_prec.dat};
    \legend{SpMV, Prec., Comp., Comm., Other};
    \end{axis}
    \end{tikzpicture}
    \caption{Timing breakdown for weak scaling test of preconditioned 3D Laplace matrix using the adaptive s-step GMRES algorithm. The timings of SpMVs and preconditioning steps (Prec.) are inverted in the bar plot to showcase scalability of different operations. The orthogonalization steps include both computational costs (Comp.) and communication costs (Comm.). Other miscellaneous operations such as updating the upper Hessenberg matrix and checking for convergence are included as well though their timings are almost negligible.}
    \label{fig:weakscaling_pc}
\end{figure}
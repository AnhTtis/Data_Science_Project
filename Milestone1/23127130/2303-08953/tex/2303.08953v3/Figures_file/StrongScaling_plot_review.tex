\begin{figure}[!htbp]
\centering
\subfloat{
    \begin{tikzpicture}
    \begin{axis}[
        xmode=log,
        ymode=log,
        width=.98\textwidth,
        height=.6\textwidth,
        stack negative=separate,
        ymin=0.5,
        ymax=2048,
        xtick={1,2,4,8,16,32,64},
        xticklabels={1N,2N,4N,8N,16N,32N,64N},
        xticklabel style={align=center,text width=10mm},
        xlabel={number of nodes (1 Node = 56 cores)},
        x label style={at={(axis description cs:0.5,-0.15)},anchor=north},
        ylabel={Speedup of the orthogonalization step},
        ymajorgrids=true,
        legend pos=north east,
        ytick={1,2,4,8,16,32,64,128,256,512,1024},
        yticklabels={1,2,4,8,16,32,64,128,256,512,1024},
        legend pos=south east,
    ]
    \addplot [dashed, color=black] coordinates {
    (1, 32)
    (64, 2048)
    };
    \addplot [mark=o, color=hcred] table [x=Nodes,y=MGS] {Review/strong_speedup.dat};
    \addplot [mark=o, color=hcblue] table [x=Nodes,y=CGS2] {Review/strong_speedup.dat};
    \addplot [mark=diamond,color=hcgreen] table [x=Nodes,y=TSQR] {Review/strong_speedup.dat};
    \addplot [mark=diamond,color=hcorange] table [x=Nodes,y=CholQR] {Review/strong_speedup.dat};
    \legend{Linear, MGS, CGS2, TSQR, Adapt.};
    \end{axis}
    \end{tikzpicture}
}\\
\subfloat{
    \begin{tikzpicture}
    \begin{axis}[
        xmode=log,
        ymode=log,
        width=.98\textwidth,
        height=.6\textwidth,
        stack negative=separate,
        ymin=0.5,
        ymax=1024,
        xtick={1,2,4,8,16,32,64},
        xticklabels={1N,2N,4N,8N,16N,32N,64N},
        xticklabel style={align=center,text width=10mm},
        xlabel={number of nodes (1 Node = 56 cores)},
        x label style={at={(axis description cs:0.5,-0.15)},anchor=north},
        ylabel={Speedup of the entire algorithm},
        ymajorgrids=true,
        legend pos=north east,
        ytick={1,2,4,8,16,32,64,128,256,512},
        yticklabels={1,2,4,8,16,32,64,128,256,512},
        legend pos=south east,
    ]
    \addplot [dashed, color=black] coordinates {
    (1, 10)
    (64, 640)
    };
    \addplot [mark=o, color=hcred] table [x=Nodes,y=Total_MGS] {Review/strong_speedup.dat};
    \addplot [mark=o, color=hcblue] table [x=Nodes,y=Total_CGS2] {Review/strong_speedup.dat};
    \addplot [mark=diamond,color=hcgreen] table [x=Nodes,y=Total_TSQR] {Review/strong_speedup.dat};
    \addplot [mark=diamond,color=hcorange] table [x=Nodes,y=Total_CholQR] {Review/strong_speedup.dat};
    \legend{Linear, MGS, CGS2, TSQR, Adapt.};
    \end{axis}
    \end{tikzpicture}
}
\caption{Speedup plot for strong scaling test of 3D Laplace matrix with dimension 64M. The four algorithms (and their corresponding legends) are MGS-GMRES (MGS), CGS2-GMRES (CGS2), BCGS2-TSQR-GMRES (TSQR) and adaptive s-step GMRES (Adapt.). Top figure shows the speedup of orthogonalization operations (including both computation and commmunication) and the bottom figure shows the speedup of overall runtime. Both algorithms use the corresponding MGS-GMRES time at 1 node as the reference for computing the speedup.}
\label{fig:strongscaling_speedup}
\end{figure}


% \begin{figure}
%     \centering
%     \begin{tikzpicture}
%     \begin{axis}[
%         xmode=log,
%         ymode=log,
%         width=\textwidth,
%         height=.6\textwidth,
%         stack negative=separate,
%         ymin=0.5,
%         ymax=2048,
%         xtick={1,2,4,8,16,32,64},
%         xticklabels={1N,2N,4N,8N,16N,32N,64N},
%         xticklabel style={align=center,text width=10mm},
%         xlabel={number of nodes (1 Node = 56 cores)},
%         x label style={at={(axis description cs:0.5,-0.15)},anchor=north},
%         ylabel={Speedup, higher is better},
%         ymajorgrids=true,
%         legend pos=north east,
%         ytick={1,2,4,8,16,32,64,128,256,512,1024},
%         yticklabels={1,2,4,8,16,32,64,128,256,512,1024},
%         legend pos=south east,
%     ]
%     \addplot [dashed, color=black] coordinates {
%     (1, 32)
%     (64, 2048)
%     };
%     \addplot [mark=o, color=hcred] table [x=Nodes,y=MGS] {Review/strong_speedup.dat};
%     \addplot [mark=o, color=hcblue] table [x=Nodes,y=CGS2] {Review/strong_speedup.dat};
%     \addplot [mark=diamond,color=hcgreen] table [x=Nodes,y=TSQR] {Review/strong_speedup.dat};
%     \addplot [mark=diamond,color=hcorange] table [x=Nodes,y=CholQR] {Review/strong_speedup.dat};
%     \legend{Linear, MGS-GMRES, CGS2-GMRES, BCGS2-TSQR-GMRES, Adapt. GMRES};
%     \end{axis}
%     \end{tikzpicture}
%     \caption{Speedup of GMRES and adaptive $s$-step GMRES (labeled CAGMRES in the legend) for strong scaling test of 3D Laplace matrix with dimension \text{64M}. Besides the speedup of overall runtime, the speedup of orthogonalization operations (computation and communication) is computed as well. Both algorithms use the corresponding GMRES time at 1 node as the reference for computing the speedup.}
%     \label{fig:strongscaling_speedup2}
% \end{figure}
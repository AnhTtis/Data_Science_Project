\begin{figure}[!tbhp]
\centering
\begin{tikzpicture}
\begin{groupplot}[
    group style={
        group size=2 by 4,
        horizontal sep=1.5cm,
        vertical sep=1.5cm,
        },
]
\nextgroupplot[
    width=0.4\textwidth,
    % height=0.3\textwidth,
    ymin=-1,
    ymax=1,
    xlabel={Re$(\lambda_i)$}, 
    ylabel={Im$(\lambda_i)$},
    ]
    \addplot [
    hcred, only marks,
    mark=*,
    mark repeat=10,
    ] table [x=eig_real,y=eig_imag] {Figures_data/ErrorEstimator/Diagonal_200_error_updated.dat};
    
\nextgroupplot[
    ymode=log,
    width=0.4\textwidth,
    % height=0.3\textwidth,
    xmin=1,
    xmax=150,
    ymin=1e-2,
    ymax=1e16,
    xlabel={column, $j$}, 
    ytick={1, 1e8, 1e16},
    % ylabel={block size, $s$},
    ]
    \addplot [
    hcgreen, 
    mark=*,
    mark repeat=12,
    ] table [x=i,y=cond] {Figures_data/ErrorEstimator/Diagonal_200_error_updated.dat};
    \addplot [
    hcblue,
    mark=*,
    mark repeat=12,
    ] table [x=i,y=vecnorm] {Figures_data/ErrorEstimator/Diagonal_200_error_updated.dat};
    \addplot [
    black, 
    mark=triangle*,
    mark repeat=12,
    ] table [x=i,y=E] {Figures_data/ErrorEstimator/Diagonal_200_error_updated.dat};
    \addplot [
    hcorange,
    mark=triangle*,
    mark repeat=12,
    ] table [x=i,y=E_true] {Figures_data/ErrorEstimator/Diagonal_200_error_updated.dat};
    
\nextgroupplot[
    width=0.4\textwidth,
    % height=0.3\textwidth,
    ymin=-1,
    ymax=1,
    xlabel={Re$(\lambda_i)$}, 
    ylabel={Im$(\lambda_i)$},
    ]
    \addplot [
    hcred, only marks,
    mark=*,
    % mark repeat=10,
    ] table [x=eig_real,y=eig_imag] {Figures_data/ErrorEstimator/Diagonal_2000_error_updated.dat};
    
\nextgroupplot[
    ymode=log,
    width=0.4\textwidth,
    % height=0.3\textwidth,
    xmin=1,
    xmax=30,
    ymin=1e-2,
    ymax=1e16,
    xlabel={column, $j$}, 
    % xtick={2,4,6,8,10,12,14,16,18},
    ytick={1, 1e8, 1e16},
    % ylabel={block size, $s$},
    legend entries={$\kappa(V_{:,1:j})$,$\|V_{:,j}\|$,$\|E_j\|$,$\|E^L_j\|$},
    % legend columns=-1,
    legend style={at={(1.7,-0.2)},anchor=east},
    ]
    \addplot [
    hcgreen, 
    mark=*,
    mark repeat=2,
    ] table [x=i,y=cond] {Figures_data/ErrorEstimator/Diagonal_2000_error_updated.dat};
    \addplot [
    hcblue, 
    mark=*,
    mark repeat=2,
    ] table [x=i,y=vecnorm] {Figures_data/ErrorEstimator/Diagonal_2000_error_updated.dat};
    \addplot [
    black, 
    mark=triangle*,
    mark repeat=2,
    ] table [x=i,y=E] {Figures_data/ErrorEstimator/Diagonal_2000_error_updated.dat};
    \addplot [
    hcorange, 
    mark=triangle*,
    mark repeat=2,
    ] table [x=i,y=E_true] {Figures_data/ErrorEstimator/Diagonal_2000_error_updated.dat};
    
\nextgroupplot[
    width=0.4\textwidth,
    % height=0.3\textwidth,
    xlabel={Re$(\lambda_i)$}, 
    ylabel={Im$(\lambda_i)$},
    ]
    \addplot [
    hcred, only marks,
    mark=*,
    % mark repeat=10,
    ] table [x=eig_real,y=eig_imag] {Figures_data/E20R5000/E20R5000_spectrum.dat};
    
\nextgroupplot[ymode=log,
    width=0.4\textwidth,
    % height=0.3\textwidth,
    xmin=1,
    xmax=150,
    ymin=1e-2,
    ymax=1e16,
    xlabel={column, $j$}, 
    ytick={1, 1e8, 1e16},
    % ylabel={block size, $s$},
    ]
    \addplot [
    hcgreen, 
    mark=*,
    mark repeat=12,
    ] table [x=i,y=cond] {Figures_data/ErrorEstimator/E20R5000_error_updated.dat};
        \addplot [
    hcblue, 
    mark=*,
    mark repeat=12,
    ] table [x=i,y=vecnorm] {Figures_data/ErrorEstimator/E20R5000_error_updated.dat};
    \addplot [
    black, 
    mark=triangle*,
    mark repeat=12,
    ] table [x=i,y=E] {Figures_data/ErrorEstimator/E20R5000_error_updated.dat};

    
\nextgroupplot[
    width=0.4\textwidth,
    % height=0.3\textwidth,
    xlabel={Re$(\lambda_i)$}, 
    ylabel={Im$(\lambda_i)$},
    ]
    \addplot [
    hcred, only marks,
    mark=*,
    % mark repeat=10,
    ] table [x=eig_real,y=eig_imag] {Figures_data/E20R5000_ILU/E20R5000ILU_spectrum.dat};

\nextgroupplot[
ymode=log,
    width=0.4\textwidth,
    % height=0.3\textwidth,
    xmin=1,
    xmax=20,
    ymin=1e-2,
    ymax=1e16,
    xlabel={column, $j$}, 
    xtick={2,4,6,8,10,12,14,16,18},
    ytick={1, 1e8, 1e16},
    % ylabel={block size, $s$},
    ]
        \addplot [
    hcgreen, 
    mark=*,
    % mark repeat=6,
    ] table [x=i,y=cond] {Figures_data/ErrorEstimator/E20R5000ILU_error_updated.dat};
    \addplot [
    hcblue, 
    mark=*,
    % mark repeat=6,
    ] table [x=i,y=vecnorm] {Figures_data/ErrorEstimator/E20R5000ILU_error_updated.dat};
    \addplot [
    black, 
    mark=triangle*,
    % mark repeat=6,
    ] table [x=i,y=E] {Figures_data/ErrorEstimator/E20R5000ILU_error_updated.dat};


\end{groupplot}
\end{tikzpicture} 
\caption{Eigenvalue spectra (left) and performance of initial step size estimators (right) for four matrix problems (from top to bottom): (1) diagonal matrix with eigenvalues uniformly in (1, 200); (2) same diagonal matrix as the previous one but the largest eigenvalue is increased to 2,000; (3) E20R5000; (4) E20R5000 with ILUTP preconditioner.}
\label{fig:errorestimator}
\end{figure}
%%% use twocolumn and 10pt options with the asme2ej format
\documentclass[twocolumn,10pt]{asme2ej}
\let\proof\relax
\let\endproof\relax
\usepackage{amsthm,amsmath,amssymb,amsfonts}
\usepackage{array}
\usepackage{graphicx}
\usepackage{mathtools}%% for loading jpg figures
\usepackage{hyperref}   % to set up hyperlinks
\usepackage{subcaption}
\hypersetup{
	colorlinks=true,
	linkcolor=blue,
	citecolor=blue,
	urlcolor=blue,
}
\usepackage[square,numbers]{natbib}
\newtheorem*{remark}{Remark}
\newtheorem{proposition}{Proposition}
\newtheorem{thm}{Theorem}
\newtheorem{defn}{Definition}
\newtheorem{lemma}{Lemma}
\newcommand{\revres}{\textcolor{black}} %red text
\newcommand{\reviewer}[1]{\textcolor{black}{\textsuperscript{[#1]}}}

%% The class has several options
%  onecolumn/twocolumn - format for one or two columns per page
%  10pt/11pt/12pt - use 10, 11, or 12 point font
%  oneside/twoside - format for oneside/twosided printing
%  final/draft - format for final/draft copy
% cleanfoot - take out copyright info in footer leave page number
%  cleanhead - take out the conference banner on the title page
%  titlepage/notitlepage - put in titlepage or leave out titlepage
%  
%% The default is oneside, onecolumn, 10pt, final

\title{Design and validation of a state-dependent Riccati equation filter for state of charge estimation in a latent thermal storage device}
%\title{Experimental validation of a state-dependent Riccati estimator for state of charge estimation in a latent thermal storage device}

%%% first author
\author{Michael Shanks\\
    School of Mechanical Engineering\\
    Purdue University \\
    West Lafayette, Indiana, 47907\\
    shanks5@purdue.edu
}

%%% second author
%%% remove the following entry for single author papers
%%% add more entries for additional authors
\author{Uduak Inyang-Udoh\\
    School of Mechanical Engineering\\
    Purdue University \\
    West Lafayette, Indiana, 47907\\
    uinyangu@purdue.edu
}

%%% third author
%%% remove the following entry for single author papers
%%% add more entries for additional authors
\author{Neera Jain\\
    School of Mechanical Engineering\\
    Purdue University \\
    West Lafayette, Indiana, 47907\\
    neerajain@purdue.edu
}

\begin{document}

\maketitle    

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}
{\it\indent Latent thermal energy storage (TES) devices could enable advances in many thermal management applications, including peak load shifting for reducing energy demand and cost of HVAC or providing supplemental heat rejection in transient thermal management systems. However, real-time feedback control of such devices is currently limited by the absence of suitable state of charge estimation techniques, given the nonlinearities associated with phase change dynamics. In this paper we design and experimentally validate a state-dependent Riccati equation (SDRE) filter for state of charge estimation in a phase change material (PCM)-based TES device integrated into a single-phase thermal-fluid loop. The advantage of the SDRE filter is that it does not require linearization of the nonlinear finite-volume model; instead, it uses a linear parameter-varying system model which can be quickly derived using graph-based methods. We leverage graph-based methods to prove that the system model is uniformly detectable, guaranteeing that the state estimates are bounded.  Using measurements from five thermocouples embedded in the PCM of the TES and two thermocouples measuring the fluid temperature at the inlet and outlet of the device, the state estimator uses a reduced-order finite-volume model to determine the temperature distribution inside the PCM and in turn, the state of charge of the device.  We demonstrate the state estimator in simulation and on experimental data collected from a thermal management system testbed to show that the state estimation error converges near zero and remains bounded.
}
\end{abstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{nomenclature}
\entry{$a$}{Area $\left[\textup{m}^2\right]$}
\entry{$A$}{State-space coefficient matrix}
\entry{$\mathcal{A}$}{Set of adjacent control volumes}
\entry{$B$}{State-space input matrix}
\entry{$c_p$}{Specific heat $\left[\frac{\textup{J}}{\textup{kg-K}}\right]$}
\entry{$C$}{State-space output matrix}
\entry{$\mathcal{C}$}{Set of PCM control volumes}
\entry{$d$}{Distance $\left[\textup{m}\right]$}
\entry{$e$}{Estimation error}
\entry{$e_{rms}$}{Root-mean-square error}
\entry{$f_m$}{Melt fraction of a PCM control volume}
\entry{$\mathcal{F}$}{Set of fluid control volumes}
\entry{$h$}{Specific enthalpy $\left[\frac{\textup{J}}{\textup{kg}}\right]$}
\entry{$h_{fus}$}{Specific enthalpy of fusion $\left[\frac{\textup{J}}{\textup{kg}}\right]$}
\entry{$H$}{Enthalpy $\left[\textup{J}\right]$}
\entry{$i,j,l$}{Control volume indices}
\entry{$I_n$}{$n\times n$ identity matrix}
\entry{$k$}{Discrete time step index}
\entry{$K$}{Kalman gain}
\entry{$L$}{Graph Laplacian matrix}
\entry{$m$}{Mass $\left[\textup{kg}\right]$}
\entry{$\dot{m}$}{Mass flow rate $\left[\frac{\textup{kg}}{\textup{s}}\right]$}
\entry{$M$}{Capacitance matrix}
\entry{$n$}{Number of control volumes}
\entry{$N_s$}{Number of time steps}
\entry{$\mathcal{N}$}{Gaussian random variable}
\entry{$p$}{Number of outputs}
\entry{$P$}{State estimate error covariance}
\entry{$\mathcal{P}$}{Set of metal plate control volumes}
\entry{$\dot{Q}$}{Heat transfer rate $\left[\textup{W}\right]$}
\entry{$R$}{Thermal resistance $\left[\frac{\textup{K}}{\textup{W}}\right]$}
%\entry{$RMSE$}{Root mean square error}
\entry{$t$}{Time $\left[\textup{s}\right]$}
\entry{$T$}{Temperature $\left[\textup{K}\right]$}
\entry{$T_{pc}$}{Phase-change temperature $\left[\textup{K}\right]$}
\entry{$u$}{Input vector}
\entry{$U$}{Convective heat transfer coefficient $\left[\frac{\textup{W}}{\textup{m}^2\textup{-K}}\right]$}
\entry{$v$}{Measurement noise vector}
\entry{$V$}{Measurement noise covariance}
\entry{$w$}{Process noise vector}
\entry{$W$}{Process noise covariance}
\entry{$x$}{State vector}
\entry{$\hat{x}$}{Estimated state vector}
\entry{$x_{soc}$}{State of charge}
\entry{$y$}{Output or measurement vector}
\entry{$\alpha$}{Specific heat function width parameter}
\entry{$\Gamma$}{Discrete-time input matrix}
\entry{$\kappa$}{Thermal conductivity $\left[\frac{\textup{W}}{\textup{m-K}}\right]$}
\entry{$\Phi$}{Discrete-time state transition matrix}
\end{nomenclature}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{01_Introduction_Shanks_Inyang-Udoh_Jain_ASME_JDSMC_2022}
\input{02_TES_Model_Shanks_Inyang-Udoh_Jain_ASME_JDSMC_2022}
\input{03_SDRE_Shanks_Inyang-Udoh_Jain_ASME_JDSMC_2022}
\input{04_Experimental_Setup_Shanks_Inyang-Udoh_Jain_ASME_JDSMC_2022}
\input{05_Testing_Shanks_Inyang-Udoh_Jain_ASME_JDSMC_2022}
\input{06_Conclusion_Shanks_Inyang-Udoh_Jain_ASME_JDSMC_2022}
\input{07_Appendix_Shanks_Inyang-Udoh_Jain_ASME_JDSMC_2022.tex}
\begin{acknowledgment}
This work is supported by the U.S. Office of Naval Research Thermal Science and Engineering Program under contract number N00014-21-1-2352.
\end{acknowledgment}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{asmems4}
\bibliography{references}

\end{document}
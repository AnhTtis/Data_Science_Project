\section{State of the Art}
\label{sec:SectionII}

This section presents the quality properties of taxonomies and then discusses the existing classification schemes for smart contract vulnerabilities. The classification schemes presented are have their origins in: a) existing research on smart contract vulnerability classification; b) community-oriented initiatives; and also c) vulnerability detection research. The section closes with a discussion of the gaps and limitations of current classification.

\subsection{Taxonomy Quality Properties}

We analyzed a set of reference works centered around the definition of taxonomies as well as critical analyses of vulnerability taxonomies \cite{Bishop1996, lindqvist_how_1997, Mann1999, Rameder2022, lough_taxonomy_2001, hansman_taxonomy_2005} to identify a set of quality properties criteria, which should be followed when designing a taxonomy that is expected to be long-lived. The following paragraphs discuss the identified properties.

A classification system may benefit from a \textbf{hierarchical organization} as it allows to show similar characteristics of related vulnerabilities, which may be helpful for vulnerability prevention \cite{Bishop1996}. A hierarchical structure may be a tree in which each node refers to a category of vulnerabilities, and each leaf corresponds to individual vulnerabilities. Thus, the granularity of the categories should generally vary from large to fine as we traverse the tree from the root to the leaves.

Nodes at a certain tree level must be as uniform as possible, i.e., ideally representing the same \textbf{level of abstraction} or a group of vulnerabilities viewed from the same perspective. Obviously, this is quite difficult to achieve because, many times, this has to be balanced with the creation of taxonomy trees that become too complex, which in the end, may make it less comprehensible or less helpful. Also, sometime the nature of the problem is simply an unbalanced or heterogeneous (in structure) one, which basically disallows this criteria. Anyway, a uniform taxonomy may contribute to fewer errors (in its use) and, as such, a higher probability of adoption by practitioners. In practice, it may contribute to a taxonomy that is \textbf{useful} and \textbf{comprehensible} \cite{lindqvist_how_1997} (i.e., understandable by security experts but also by less specialized people). 

The selection of names to be used in a classification scheme is particularly important. The name that describes a certain vulnerability must be a \textbf{unique identifier}) and \textbf{non-ambiguous} \cite{howard_analysis_1997, lindqvist_how_1997}, meaning that the name and also the associated description must allow not only for easy identification but should include enough information to distinguish it from other vulnerabilities \cite{Mann1999, Bishop1996}. Whenever possible, existing \textbf{terminology} should be used \cite{lindqvist_how_1997}. The name and characteristics of a certain defect should characterize what the issue is and not additional dimensions, such as the effect of exploiting it. While it is acceptable to understand the effect of exploiting a certain vulnerability starting from its description, the characteristics of the problem itself cannot be omitted and should be clearly identified \cite{Mann1999, Bishop1996}.

Regardless of the perspective of the individual using the taxonomy, a certain defect should be classified in the same manner by different individuals (e.g., developers, users, testers). This means that not only the names and structure should be as clear as possible, but also that the process of classifying a certain defect must be made clear (whenever the structure and nomenclature are not sufficient), i.e., there must be a \textbf{deterministic} \cite{krsul_software_1998} way of classifying a certain defect, which fosters \textbf{repeatability} \cite{howard_analysis_1997, krsul_software_1998} of using the classification.

Finally, a taxonomy should also allow for \textbf{completeness} \cite{amoroso_fundamentals_1994}, i.e., the taxonomy should provide a \textbf{good coverage} \cite{Rameder2022} of the vulnerabilities identified in state of the art or reported by vulnerability detection tools. Also, it should be \textbf{open to the community} (i.e., accept new entries from the community) and shareable (i.e., no distribution restrictions) \cite{Mann1999}. The fact that it is open is also a factor that can contribute to it being \textbf{accepted} \cite{amoroso_fundamentals_1994, howard_analysis_1997}.

%Mutually exclusive (Howard, 1997, Lindqvist and Jonsson, 1997): A mutually exclusive taxonomy will categorise each attack into, at most, one category.

\subsection{Smart Contract Vulnerability Classification Schemes}

To the best of our knowledge, the first initiative to classify smart contract vulnerabilities (for Ethereum systems) is proposed in \cite{Atzei2017}. The authors listed 12 vulnerabilities, which we overview in Table \ref{tab:atzei}, and implemented nine of the corresponding attacks.

\input{tables/tableI}

This initial effort is quite relevant but holds some limitations. Some of the selected names do not really specify the nature of the vulnerabilities or are not clear about the problem being characterized (e.g., "call to the unknown"). This limitation was mitigated in \cite{Zhou2022} and \cite{arganaraz_detection_2020}, where the authors tried to make the names used more specific. In \cite{Atzei2017} three categories of issues are proposed: i) Solidity Issues (i.e., language weaknesses), ii) EVM Issues (i.e., residuals faults in byte code), and iii) Blockchain Issues (i.e., vulnerabilities from blockchain technology). Despite allowing an initial separation of the issues (which may help developers in dealing with the faults), this scheme does not benefit from the presence of a more complex hierarchy, which is a better fit for cases where we find several interrelated families of vulnerabilities. We have also identified that these three categories may generate some ambiguity as some cases could potentially fit into multiple categories. For example, \textit{Immutable Bugs} could be classified into EVM or Blockchain. Despite this, the separation between the cases referring to the programs (i.e., solidity source code or EVM binary code) and the blockchain platform is helpful. This classification is not available in a public repository and, due to its age, its coverage is relatively low, accounting for 12 evulnerabilities.

Table  \ref{tab:Vyper} overviews the vulnerability classification presented in \cite{Vyper.vs.solidity.2020},  which has the goal of allowing comparison between the security of the Solidity and Vype languages. The work presents 18 vulnerabilities, along with a detailed explanation for each one, and individual code examples for each vulnerability. Being mostly a list of vulnerabilities, there are no benefits associated with hierarchical structures. There is no open public repository associated with the proposal, and the 18 vulnerabilities are nowadays a small amount, e.g., the work in \cite{ Rameder2022} identifies a total of 54 defects.

 \input{tables/tableVI}

A vulnerability classification is presented in \cite{arganaraz_detection_2020} with the goal of exposing threats and, ultimately, minimizing the presence of software bugs in smart contracts. Table \ref{tab:arganaraz} presents the proposed classification in which we find faults separated into two levels: i) security (i.e., faults that may be exploited by attacks; and ii) functional (i.e., faults that violate the program's functionality). Each fault is also associated with a criticality level, which may be useful for getting developers' attention while coding. We found that certain cases, such as \textit{Non-verified maths} and \textit{Malicious libraries}, may indicate the same vulnerability, indicating a potential need for further clarification and refinement of the classification process to address any ambiguity. Similar to the previously presented works, there is no hierarchical structure besides the two groups of vulnerabilities. The names used in the classification are quite specific (i.e.,  \textit{Use of tx.origin}), which makes it difficult to understand the problem in a more abstract manner. Only 13 faults are considered, with no possibility of expansion. Still, the idea of classifying the faults into two broad concepts of security and functionality is a vision that may be interesting for newer classifications (e.g., targeting different types of systems).


\input{tables/tableII}

A smart contract vulnerability classification is presented in \cite{Zhou2022}, based on the previous work in \cite{Atzei2017}. In this classification, summarized in Table \ref{tab:Zhou}, the groups were maintained (i.e., Solidity, EVM, Blockchain), but the vulnerability entries were modified (i.e., some names were removed, like \textit{stack size limit} and \textit{gasless send} and others names were included, like \textit{tx. origin} and \textit{default visibility}). The authors linked the proposed names to an external taxonomy, namely CWE \cite{CWECommunity2009}, which is helpful for understanding each vulnerability, verifying the correctness of the proposed classification, and also for standardization purposes. The proposed classification defines a basic separation of vulnerabilities, mostly distinguishing cases related to the programs from cases related to the platform. Again the number of vulnerabilities listed is quite small (i.e.,13 vulnerabilities), and the work could benefit from a repository open to community contributions.

\input{tables/tableIII}

Table \ref{tab:Amiet} presents a vulnerability classification proposed by \cite{Amiet2021}. The classification is based in two categories: i) core blockchain vulnerabilities (i.e., vulnerabilities related to the blockchain platform); ii) smart contracts vulnerabilities (i.e., vulnerabilities related to the programs deployed in the blockchain). At the blockchain level, examples are provided (e.g., attacks on the consensus mechanism), whereas, at the contract level, pseudo-code is presented, which clarifies the security issues identified. These two broad groups are a basis for applying the classification to other types of systems. There are no further hierarchical levels present in this taxonomy, and we found vulnerability names that are unclear, such as \textit{Improper Blockchain Magic Validation}, which does not really characterize the technical details involving the vulnerability. As with previous cases, the 12 vulnerabilities represent a quite small number of currently known vulnerabilities.

\input{tables/tableIV}

A classification of 28 vulnerabilities is proposed in \cite{Staderini_2020} and was further evolved to categorize a total of 33 vulnerabilities in \cite{Staderini2022}. Table \ref{tab:Mirko} presents an overview of the authors' classification, identifying the acronym and name of the vulnerability and an associated CWE \cite{CWECommunity2009}.

\input{tables/TableX.tex}

As we can see in Table \ref{tab:Mirko}, the additional characterization by CWE is quite helpful although it is not accompanied by a blockchain-specific classification scheme, such as SWC \cite{swc} which could help in unifying knowledge. The source of information is based on a set of four references in \cite{Staderini_2020} and in five in \cite{Staderini2022}, which do not  directly map with the state of the practice (e.g., tools for vulnerability detection). Still, the process for building the classification is insightful and helpful as a way to solidify our own classification, e.g., by allowing a verification of our own mapping to CWE.


A consolidated taxonomy is presented in \cite{Rameder2022}. The authors were able to collect 54 vulnerabilities reported from different verification tools and grouped them into 10 categories. Table \ref{tab:Rameder} overviews the taxonomy created by the authors.

\input{tables/TableVIII.tex}

 This classification is more fine-grained than the previously discussed ones. However, there are a few issues with some names given to the vulnerabilities. For instance, it is not obvious to what extent \textit{integer bugs or arithmetic issues - 7C} is different from \textit{Integer over- or underflow - 7A} or \textit{Integer division - 7B}, and there are names like \textit{Gas costly loops} and \textit{Gas costly pattern} which seem very similar. Also, names like \textit{configuration error} are quite generic and could lead to a more specific vulnerability like \textit{Environment Configuration Issues}. 
Regarding the structure itself, the taxonomy has a flat organization in which the categories do not really represent aspects at the same abstraction or conceptual level. For instance, \textit{Denial of Service} is generally considered as a type of attack or the effect of an exploited vulnerability, or \textit{Configuration Issues} is quite generic, and it does not characterize the vulnerability sufficiently. We can observe a similar issue between the names given to the categories and to the specific vulnerabilities, e.g., \textit{Bad Coding Group} versus \textit{Coding error Vulnerability}. Although the classification lists 54 vulnerabilities, it would benefit of a way for evolving and including more recent ones (e.g., via an open repository).


\subsection{Community-Based Classification Schemes}

This section discusses taxonomies or classification initiatives maintained by communities. One of the most popular ones is \textit{Smart Contract Weakness Classification} SWC \cite{swc}, a vulnerability classification scheme for smart contracts whose main goals are: i) Provide a straightforward way to classify 'weaknesses' of a smart contract; ii) Identify weaknesses that lead to vulnerabilities; iii) Define a common language to describe weaknesses in the architecture, design, and coding of smart contracts; and finally, iv) Being a way to improve the effectiveness of smart contract security analysis tools \cite{epi1470}.

In SWC, each software defect has an external relationship with another taxonomy (i.e., CWE \cite{CWECommunity2009}), and there are examples (i.e., faulty and non-faulty code) to illustrate the vulnerability and a correction. SWC is a flat list structure, where the distinction between vulnerabilities and other types of defects is many times unclear. Also, it is worthwhile mentioning that there are cases where it is difficult to distinguish whether the problem is related to the blockchain platform or to the smart contract itself (e.g., \textit{Weak Sources of Randomness from Chain Attributes}, \textit{Unencrypted Private Data On-Chain}). A positive aspect is that SWC is associated withan open repository, although, at the time of writing, the last update was made in 2018. Considering the changes and new knowledge about smart contract vulnerabilities, this means that practitioners' involvement is now impaired. For instance, the classification presented in \cite{Rameder2022} identifies several new defects that are not present in SWC.

The NCC Group initiated the Decentralized Application Security Project (DASP) in 2018, which includes a vulnerability classification scheme for smart contracts. The idea of the classification is to present the top 10 threats to smart contract security, for which a single iteration was carried precisely in 2018. Thus, it does not really reflect the whole landscape of vulnerabilities. DASP provides a short description for each class of vulnerabilities, which is accompanied by pseudo-code as a way of explaining the defects. The classification emphasizes the impact the vulnerability had in real-world scenarios (e.g., reentrancy loss estimated at 3.5M ETH ~50M USD at the time). References to real-world attacks are provided (i.e., reports, magazines, etc.), which present a historical view of vulnerability exploitation. The nomenclature is clear, although some parts of the structure are questionable. For instance, the \textit{Denial of Service} category in DASP refers to \textit{gas limit reached}, \textit{unexpected throw}, \textit{unexpected kill}, and \textit{access control breached}. The description is sometimes so short that may become ambiguous (e.g., \textit{access control breached} may refer to a vulnerability that would simply fit in \textit{Access Control}, which is another DASP category). In \cite{durieux_empirical_2020}, the authors used DASP but concluded that the categories were not sufficient to cover the vulnerabilities found.

SIGP \cite{SIGP2018} is a vulnerability classification scheme for smart contracts written in Solidity that forms the basis of 
of the work in \cite{antonopoulos_mastering_2018}. The classification considers three main elements: vulnerability, preventive technique, and a real-world example. The first element conceptually describes the reported vulnerability. It also presents the vulnerable code and explains how the attack is performed. The second element presents a solution for the problem, and the last element discusses a real-world attack in which the vulnerability was exploited. The clarity of the names used for the vulnerabilities could be improved (e.g., \textit{entropy illusion} and \textit{constructors with care} are ambiguous). There is an open repository associated, but not receiving any updated, at the time of writing. As in previous cases, there are only 16 vulnerabilities listed, which is currently far from the state of the practice.

The SMARTDEC classification \cite{SmartDec2018} originated from the experience gathered from the creation of Smartcheck \cite{tikhomirov_smartcheck_2018}. The vulnerabilities are organized into three main categories: Blockchain (i.e., vulnerabilities from  the blockchain system), Language (i.e., programming language defects), and Model (i.e., vulnerabilities caused by mistakes in the model). Each group has several entries (up to a total of 11), where each entry corresponds to a set of related vulnerabilities. The entry names are unique, although they are also quite generic, and therefore less descriptive (e.g., \textit{Trust}). The authors provide a mapping between their taxonomy and other classifications, namely DASP \cite{nccgroup_decentralized_2021}, SWC \cite{swc}, and SIGP \cite{SIGP2018}. As an example, the \textit{Arithmetic} category is related to \textit{Over/underflow} in SWC-101, DASP-3, and SP-2 and to \textit{Precision issues} in SP-15. The repository is open to contributions, although, at the time of writing, there has been no update since 2018.

\subsection{Classification Schemes used in Vulnerability Detection Research}

Research in smart contract vulnerability detection for smart contracts is generally accompanied by custom vulnerability classification schemes \cite{luu_making_2016,kalra_zeus_2018,wang_vultron_2019,ghaleb_how_2020,SMARTIAN_2021,SAILFISH_2022}. This is primarily due to lacking an appropriate and up-to-date classification standard or taxonomy. As a result, biased and limited classifications emerged, which are coupled to the context in which they were created. The next paragraphs describe the classification schemes of selected research, namely of three of the most cited vulnerability detection research works (at the time of writing and according to Google Scholar). In all of these cases, the heterogeneity is clear, as well as the divergence with other classification schemes, such as the ones previously presented in this section.


A symbolic execution tool named Oyente is proposed in \cite{luu_making_2016} with the goal of allowing practitioners to detect security vulnerabilities. Within the tool proposal the authors identify a small set of security vulnerabilities, as illustrated in Table \ref{tab:Oyente}. 

\input{tables/Oyente}

Although the work in Oyente targets a specific set of vulnerabilities, the absence of a standard way for categorizing and naming the vulnerabilities impairs the assessment and comparison of results with other tools or approaches.


Securify \cite{tsankov_securify_2018} is a vulnerability detection tool based on symbolic execution methods, which, at the time of writing, is able to detect 37 security defects \cite{Tsankov2018}, which the tool groups by severity, as we can see in Table \ref{tab:Securify}. 


\input{tables/Securify}

Again, as with the previous tool, the groups and the names or vulnerability definition are non-standard, although there is an effort in to classify most of them according to SWC \cite{swc}.


Zeus is a tool based on abstract interpretation and symbolic execution \cite{kalra_zeus_2018}. Table \ref{tab:Zeus} shows the vulnerability classification performed by the authors and targeted by the tools.

\input{tables/Zeus}

As we can see in Table \ref{tab:Zeus}, the authors created several groups (e.g., incorrect contracts, unfair contracts), in which several defects are placed. Although this is obviously a partial classification of known vulnerabilities, the heterogeneity of the naming and definitions and also general classification structures is clear (when compared to other works), which again emphasizes the need for a more standard way of categorizing defects.


%\input{tables/tableIX}


\subsection{Limitations of Current Classification Schemes}

In this section, we highlight the main gaps and limitations identified during the analysis of the different vulnerability classifications previously described, as follows: 

\begin{enumerate}[-]

\item Classifications proposed in the literature tend to have simple structures, most of them simply grouping the vulnerabilities into related groups. Many times, no groups at all are used. Such structures are often ad-hoc and consequently short-lived, resulting in limited adoption. The classifications that collect more vulnerabilities are found in \cite{Rameder2022, swc, Tsankov2018}, with \cite{Tsankov2018} grouping vulnerabilities by criticality and with \cite{Rameder2022} using conceptual groups to fit related vulnerabilities.

\item  There is a large diversity of names being used in state of the art to refer to the same vulnerability (e.g., both \textit{Integer bugs or arithmetic issues} and \textit{Integer over- or underflow} \cite{Rameder2022} refer to the same vulnerability). There are also cases in which very similar names refer to different vulnerabilities (e.g., \textit{unpredictable state} \cite{bauer_semantic_2018} refers to wrong class inheritance order defect while \textit{vulnerable state} \cite{krupp_teether_2018} refers to uninitialized storage variable defect). In some cases, the same name refers to different vulnerabilities, e.g., Transaction Order Dependency (TOD) is the name used in \cite{liao_soliaudit_2019} and in \cite{SAILFISH_2022}, which however refers respectively to "5.1.5 Transfer Amount Dependent on Transaction Order" and to "5.1.6 Transfer Recipient Dependent on Transaction Order".

\item Current classifications include several generic names that do not assist in the classification of specific defects (e.g., \textit{call to the unknown} \cite{Atzei2017} or \textit{unexpected function invocation} \cite{Chen2020a}). In several cases, unclear nomenclatures are used, such as \textit{entropy illusion}, \textit{constructors with care} \cite{SIGP2018}, or \textit{Improper Blockchain Magic Validation} \cite{Amiet2021}, which do not specify what the defect is. Another example is \textit{Style guide violation} \cite{zhang_soliditycheck_2019}, which is not even clear whether it is referring to bad practice or a vulnerability.

\item Regarding vulnerability classification, current research appears to be falling far behind the state of the practice. Current vulnerability detection tools identify several vulnerabilities (e.g., Securify2 \cite{Tsankov2018}) that do not fit in relatively well-established classifications, such as DASP \cite{DASP}, or SWC \cite{swc}.

\item Current classifications do not involve active community participation, and we observed little to no participation at all in several classifications. Thus, it is fundamental that a classification can be easily maintained and evolve to integrate new vulnerabilities or even has the possibility of structurally changing (i.e., versioning is also required). This reduced community participation is the main reason why the most popular classification initiatives, like SWC \cite{swc} or DASP \cite{DASP}, are currently far behind the detection capabilities of vulnerability detection tools. 

\item Classifications originated from vulnerability detection tools sometimes use names that are biased towards the tool's capabilities, which is fully acceptable from a tool perspective, but for broader goals (e.g., tool benchmarking), a vulnerability classification must be independent of specific tools' capabilities. For instance, Osiris \cite{torres_osiris_2018} is a tool for detecting vulnerabilities related with integer values and naturally focuses on a few types of issues affecting integer manipulation. Thus, the naming used is very specific of this context and also does not capture the larger picture (e.g., issues affecting other types of numbers may be related, but are not represented).

\item The high heterogeneity of names used across various tools, community efforts, and research initiatives creates a significant obstacle to understanding which tools perform better. Although initiatives exist to assess the effectiveness of the vulnerability detection tools, they all faced difficulties in adopting a uniform, fine-grained taxonomy for defects.

\item Many times, taxonomies mix the characteristics of a certain vulnerability with the effect of exploiting it or with how it is exploited, or its impact, and use category names like \textit{Denial of Service}, which is basically a consequence of the activation of a certain vulnerability. This is not necessarily wrong, but it may contribute to a non-uniform taxonomy and possibly error-prone from the point of view of the taxonomy's user.

\item Classification structures are often constructed with different degrees of granularity. Some structures have general categories, while others have more specific categories. This inconsistent categorization of  poses difficulties and complexities for practitioners and tool developers, as they end up creating new classifications. Overall, a broader view on vulnerability detection is needed to foster the longevity of a particular taxonomy, accompanied with the possibility of evolving it. 

\end{enumerate}

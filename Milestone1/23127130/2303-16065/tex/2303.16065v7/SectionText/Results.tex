\section*{Results}
We started by assembling a dataset of hikes derived from approximately 20,000 public GPS tracks. These tracks recorded a variety of transport methods and required significant filtering. This process included iterative data cleaning to remove erroneous or non-walking data and identify/remove breaks (e.g. Fig \ref{Fig2}) to give us a final usable dataset containing 7,636 GPS tracks, with over 1.4 million individual data points and covering almost 88,000 km of travel in the U.K. Each data point represents at least 50 m of travel (with a mean distance of 60.3 m), and the breakdown of the data by slope angle and terrain type is shown in Table \ref{tab:1Terrain data distances}. Previous research has found that most walking takes place on low walking slopes \cite{Proffitt1995PerceivingSlant}, and this is evidenced by our data ($\sim$98\% of our data was from walking slopes of under 10 degrees).

\begin{table}[!ht]
\begin{adjustwidth}{-0.65in}{0in}
    \centering
    \caption{Total distance of data under different terrain conditions (km)}
    \begin{tabular}{|l+c|c|c+c|c|c|}
    \hline
    & \multicolumn{3}{|l+}{\bf Hill Slope (degrees)} & \multicolumn{3}{|l|}{$\mathbf{\vert Walking \  Slope \vert 
 \ (degrees)}$}\\
    \hline
    & 0-10 & 10-20 & \textgreater{}20 & 0-10 & 10-20 & \textgreater{}20 \\
    \thickhline
    Paved road & 62159.1 & 7841.2 & 2081.9 & 70726.5 & 1277.3 & 78.4 \\ 
    \hline
    Unpaved road & 9996.9 & 2210.3 & 700.7 & 12421.7 & 460.0 & 26.2 \\
    \hline
    Off Road (obstruction unknown) & 773.5 & 114.2 & 17.8 & 871.7 & 31.7 & 2.0 \\
    \hline
    Off Road (light obstruction) & 1282.9 & 150.1 & 23.8 & 1424.6 & 30.6 & 1.7 \\ 
    \hline
    Off Road (heavy obstruction) & 428.7 & 105.2 & 28.5 & 543.5 & 18.5 & 0.4 \\ 
    \hline
    \end{tabular}
    \label{tab:1Terrain data distances}
\end{adjustwidth}
\end{table}

Our curated hike dataset allowed us to create a data-driven model which we can directly compare with existing walking speed algorithms. The model formulation was selected using a small-scale exploratory study which considered data from Scotland (see \nameref{S3_Appendix}). In this exploratory study, multiple different model types were explored which could fit the data, and which matched existing knowledge about walking speeds. Cross-validation methods showed that there was very little difference in performance of the best models, therefore the final model was a Generalised Linear Model (GLM), which was chosen as it was the simplest of those tested (we had no evidence that a more complex model would be superior). This choice also meant that our model was both easy to interpret, and simple to apply to future work.

This final GLM model included all three of the variables suggested by Arnet \cite{Arnet2009ArithmeticalJapan}:

\begin{equation}
    v = exp(a+b\phi+c\theta+d\theta^2)
\end{equation}
where
\begin{quote}
$v = \text{walking speed (km/h)}$\\
$\phi = \text{hill slope angle (degrees)}$\\
$\theta = \text{walking slope angle (degrees)}$
\end{quote}

Terrain obstruction level was included as a factor variable, while we considered the road types as both factor variables and interaction terms. Not all terms had a significant effect on all variables; we therefore created a model with all possible terms, and removed them one at a time (in order of least significance) until all remaining terms were significant to at least 95\% confidence  level (using Wald test). The final values for a, b, c and d are given in Table \ref{tab:2ROUK model variable values} for each of the terrain obstruction levels and road types. The critical gradient for this model is between 14 -- 16 degrees when walking uphill and -16 -- -18 degrees when walking downhill (depending on road and obstruction conditions), which is in line with previous findings. 

\begin{table}[!ht]
\begin{adjustwidth}{-0.5in}{0in}
    \centering
    \caption{Final walking speed model variable coefficients}
    \begin{tabular}{|l+c|c|c|c|}
    \hline
    & $a$ & $b$ & $c$  & $d$ \\ 
    \thickhline
    Paved road & 1.580 & -0.00389 & -0.00726 & -0.00218 \\ 
    \hline
    Unpaved road & 1.580 & -0.00389 & -0.00965 & -0.00248 \\
    \hline
    Off-road (obstruction unknown) & 1.536 & -0.00731 & -0.00965 & -0.00187 \\
    \hline
    Off-road (light obstruction) & 1.580 & -0.00731 & -0.00965 & -0.00187 \\ 
    \hline
    Off-road (heavy obstruction) & 1.443 & -0.00731 & -0.00965 & -0.00187 \\ 
    \hline
    \end{tabular}
    \label{tab:2ROUK model variable values}
\end{adjustwidth}
\end{table}

Fig \ref{Fig3} shows the predicted walking speeds under different conditions. The importance of including both the hill slope and terrain obstruction variables can be clearly seen when looking at the Off Road Light Obstruction speed predictions. When directly ascending or descending a slope, the walking speed is comparable to walking on a road. However, when traversing a slope while off road, the walking speed is comparable to traversing a slope of double the gradient while on a road or path. Similarly, comparing the walking speed predictions of Off Road Light Obstruction and Off Road Heavy Obstruction reveals that just 10 cm of vegetation (our cutoff point for heavy obstruction) can reduce the walking speed by more than 0.5 km/h.

\begin{figure}[!h]
\begin{adjustwidth}{-2.25in}{0in} 
    \includegraphics[width=\linewidth]{Images/Paper/Fig3.eps}
    \captionsetup{width=1\linewidth}
    \caption[width=\textwidth]{{\bf Walking speed predictions under different terrain conditions.}  When: (A) travelling directly up or down hills of varying slope (walking slope), (B) traversing across hills of varying slope (hill slope).}
    \label{Fig3}
    \end{adjustwidth}
\end{figure}

Fig \ref{Fig4} shows the same walking speed predictions as Fig \ref{Fig3}, alongside the confidence interval for the mean walking speed for each terrain type. In the low-slope regions where most walking occurs, our model fits closely with the mean data confidence intervals. Our model does deviate from the confidence interval in some areas, particularly in high-slope and off-road regions. However, these are also the areas where we have the least amount of data (see Table \ref{tab:1Terrain data distances}). In Fig \ref{Fig4}J the confidence interval for the mean would suggest that it is faster to walk on hill slopes of 30 degrees than hill slopes of 10 degrees. We have less than 30 km of data recorded in heavy obstruction regions on hill slopes of over 20 degrees, and less than 20 km of this had a walking slope magnitude of under 5 degrees (indicating that the slope was being traversed). Further, even within this range, the data is skewed towards the lower hill slope values. This lack of data explains the widening confidence interval, and counter-intuitive observations and we suggest that a targeted study would be required to collect more data in this region.


\begin{figure}[!h]
\begin{adjustwidth}{-2.25in}{0in} 
    \includegraphics[width=\linewidth]{Images/Paper/Fig4.eps}
    \captionsetup{width=1\linewidth}
    \caption[width=\textwidth]{{\bf Walking speed predictions under different terrain conditions.}  When: (A,C,E,G,I) travelling directly up or down hills of varying slope (walking slope), (B,D,F,H,J) traversing across hills of varying slope (hill slope). Also shown in each plot is the 95\% confidence interval of the mean value of the walking speed for the terrain type, calculated at 5 degree intervals, using data bins with a width of 10 degrees. Note that the confidence intervals were calculated using only data which is within 5 degrees of directly ascending (A,C,E,G,I) or traversing (B,D,F,H,J) the slope.}
    \label{Fig4}
    \end{adjustwidth}
\end{figure}


Fig \ref{Fig5} compares the Paved Road and Off Road Heavy Obstruction speed predictions from our model against the existing functions from Naismith, Tobler and Campbell et al. When looking at the walking slope, the largest areas of deviation between our model and Naismith's rule occurs when descending a slope, as Naismith's rule does not predict a reduced speed in this scenario. For both Tobler's and Campbell et al.'s functions, the shape of the walking slope component is relatively similar to our new model, with the main distinction being the peak predicted speed on flat ground. None of the existing functions account for the hill slope, which leads to large disparities when predicting the walking speed for slope traversals. A further example of this can be seen in \nameref{S6_Appendix}, which shows the walking speeds for a simulated off-road route which encounters the full range of hill and walking slopes.

\begin{figure}[!h]
\begin{adjustwidth}{-2.25in}{0in} 
    \includegraphics[width=\linewidth]{Images/Paper/Fig5.eps}
    \captionsetup{width=1\linewidth}
    \caption[width=\textwidth]{{\bf Comparison of new model and existing hiking functions.}  Predicted walking speeds of the new model, Naismith's rule, Tobler's function and Campbell et al.'s function when: (A, C, E) travelling directly up or down hills of varying slope (walking slope), (B, D, F) traversing across hills of varying slope (hill slope).}
    \label{Fig5}
\end{adjustwidth}
\end{figure}

When comparing the performances of each of the models (Table \ref{tab:3comparison}), the predicted speeds for individual 50 m sections had a lower RMSE and percentage error, and a higher R squared value using our new model than in the existing ones. The R-squared value is still very low, however we suggest that this is due to the variability within the data. We have previously acknowledged that there are many individual effects which can impact the walking speed, and which we did not attempt to capture in our model. Instead it captures the general trend of the walking speed for an average individual under average conditions, and does this better than existing models (evidenced by the improved RMSE).

\begin{table}[!ht]
\centering
\caption{Comparison of new model against existing methods to calculate walking speeds.}
\begin{tabular}{|l|c|c|c|c|}
\hline
& New Model & Naismith & Tobler & Campbell\\
\hline
Average \% error & 23.68 & 26.36 & 26.17 & 25.33\\
\hline
MSE & 1.20 & 1.61 & 1.53 & 1.58\\
\hline
RMSE & 1.10 & 1.27 & 1.24 & 1.26\\
\hline
R\textsuperscript{2}  & 0.09 & -0.22 & -0.16 & -0.19\\
\hline
\end{tabular}
\label{tab:3comparison}  
\end{table}

To isolate the impact of each of the slope variables, we filtered the results to look at the data where a slope was being directly climbed or traversed. Figs \ref{Fig6}A, B and \ref{Fig7}A, B show the RMSE and mean residuals for each of the models, for data which was within 5 degrees of directly climbing (A) or traversing (B) hills of varying slope. From this we can clearly see that Naismith's rule consistently overestimates walking speeds when descending a slope, and underestimates speeds when climbing a slope. When ascending or descending a slope, the RMSE of our GLM is similar to that of Tobler's hiking function. However, one of the main areas where we see an improvement using our model is on slight declines. Tobler's hiking function suggests that walking speed increases on mild descents up to a maximum of 6 km/h. It is clear from Fig \ref{Fig6}A, that Tobler's function overestimates the walking speed in this region. Campbell et al.'s function has a slightly lower RMSE value than our new model on the steepest walking slopes, however it underestimates the walking speeds on flat ground and mild slopes; the regions where most walking occurs. Improved walking speed predictions in this region therefore have the greatest impact in real-world situations. Within this region our model consistently has a lower RMSE than the existing functions, and a mean residual error close to 0 km/h. 

\begin{figure}[!h]    
\begin{adjustwidth}{-2.25in}{0in} 
    \includegraphics[width=\linewidth]{Images/Paper/Fig6.eps}
    \captionsetup{width=1\linewidth}
    \caption[width=\textwidth]{{\bf Comparing RMSE values for the new model, Naismith's rule, Tobler's function and Campbell et al.'s function.} When: (A) travelling directly up or down hills of varying slope (all data, walking slope), (B) traversing across hills of varying slope (all data, hill slope), (C) travelling directly up or down hills of varying slope (off-road data only, walking slope), (D) traversing across hills of varying slope (off-road data only, hill slope). Campbell et al.'s function does not provide off-road speed estimates, so was not included in the off-road data comparisons.}
    \label{Fig6}
\end{adjustwidth}
\end{figure}

\begin{figure}[!h]
    \begin{adjustwidth}{-2.25in}{0in} 
    \includegraphics[width=\linewidth]{Images/Paper/Fig7.eps}
    \captionsetup{width=1\linewidth}
    \caption[width=\textwidth]{{\bf Comparing mean residual values for the new model, Naismith's rule, Tobler's function and Campbell et al.'s function.} When: (A) travelling directly up or down hills of varying slope (all data, walking slope), (B) traversing across hills of varying slope (all data, hill slope), (C) travelling directly up or down hills of varying slope (off-road data only, walking slope), (D) traversing across hills of varying slope (off-road data only, hill slope). Campbell et al.'s function does not provide off-road speed estimates, so was not included in the off-road data comparisons.}
    \label{Fig7}
\end{adjustwidth}
\end{figure}

 We also see an improvement in RMSE when using our model to predict speeds for hill traversals (Fig \ref{Fig6}B). We can note from Fig \ref{Fig7}B that both Naismith's rule and Tobler's hiking function consistently overestimate the walking speed when traversing a slope, as they do not take into account the impact that the hill slope has on reducing walking speeds. The performance of Campbell et al's model improves as the hill slope increases, although we suggest this is more due to it underestimating the speed on shallow slopes. We do see that the average error in our model increases as the hill slope increases, but we believe that this is due to limited volumes of data at high hill slopes ($\sim$0.5\% of our data occurs on hill slopes steeper than 40 degrees). 

As well as looking at the overall performance of our new model, we looked to explore how well our model performed in off-road conditions, compared to the off-road adjustments for the existing functions (Naismith's reduced base speed of 4 km/h, and Tobler's correction factor of 0.6). Figs \ref{Fig6}C, D and \ref{Fig7}C, D show the RMSE and mean residuals, only considering data which was recorded in off-road conditions. From Figs \ref{Fig6}C and \ref{Fig7}C it is clear that Tobler's function consistently underestimates the walking speed when off-road. The factor of 0.6 is a larger reduction in walking speed than is observed in practice. As we found when looking at our data as a whole, Naismith's rule underestimates the walking speed when climbing a slope and overestimates when descending a slope. Our new model does not suffer from these problems, with both a lower RMSE and lower absolute mean residual value across all walking slopes. Both of these existing models also consistently underestimate walking speeds when traversing a slope, unlike our new model which has a mean residual of less than 0.4 km/h on slopes of up to 35 degrees. The error in predictions of our new model does increase as the hill slope increases, though the RMSE is generally lower than seen in the existing models. On the steepest hill slopes our model appears to perform less well than the existing ones, though only 0.2\% of our off-road data occurred on a hill slope steeper than 40 degrees. 

Although we have shown an improvement in walking speed predictions over short sections of routes, this did not translate to similar results when looking at predicted walking times for routes as a whole. Our model and all of the existing models which we have explored here had an average percentage error of 13.5\% - 15.5\% when predicting the time taken for a complete route. However, based on the errors seen in Figs \ref{Fig6} and \ref{Fig7}, we believe that this is a result of errors cancelling out over the course of a hike. For example while ascending a hill, Naismith's rule will underestimate the walking speed (and thus overestimate the walking time), but it will then overestimate the walking speed on the subsequent descent, leading to a relatively accurate total time estimate. The results here suggest that Naismith's rule, and other existing functions, are still a good rule of thumb to calculate route times as a whole, but time estimates for individual sections of a route will be less accurate than when using the new model found here.



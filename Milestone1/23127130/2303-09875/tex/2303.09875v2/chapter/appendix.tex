

\begin{center}\Large{\textbf{Supplemental File to ``A Dynamic Multi-Scale Voxel Flow Network for Video Prediction''}}
\end{center}

We provide 
more details of DMVFN for video prediction.
%
Specifically, we provide
% 
\begin{itemize}
% 
\itemsep-0.03in
\item societal impact in~\S\ref{sec:impact}.

\item visualization of voxel flow~\S\ref{sec:vf};

\item more ablation studies in~\S\ref{sec:more_ab};

%
\end{itemize}

\section{Societal Impact}
\label{sec:impact}
This work potentially benefits video prediction and dynamic neural network fields.\ The authors believe that this work has small potential negative impacts.



%
\section{Visualization of Voxel Flow}
We visualize the voxel flow predicted by DMVFN in Figure~\ref{fig:vf}.
%
We use the optical flow generated by RAFT~\cite{raft} as a reference.
%
We observe that the optical flow $\textbf{f}_{t+1 \rightarrow t}$ and the map $1-\textbf{m}$ of most pixels are successfully predicted by DMVFN.
%
This demonstrates that our DMVFN can indeed accurately predict a voxel flow.
\label{sec:vf}
\begin{figure*}[h]
\vspace{4mm}
	\centering
	\includegraphics[width=\textwidth]{image/vf.png}
 \caption{\textbf{Visualization} of the map $1-\textbf{m}$, the optical flow $\textbf{f}_{t+1 \rightarrow t}$, the optical flow by RAFT~\cite{raft} $\textbf{f}^{RAFT}_{t+1 \rightarrow t}$, the predicted frame $\tilde{I}_{t+1}$ and the “ground truth” $I_{t+1}$.}
        \label{fig:vf}
	\vspace{-2mm}
\end{figure*}
%

\section{More Ablation Study Results}
\label{sec:more_ab}
%

\noindent
\textbf{5) How does $\beta$ influence the performance of DMVFN during inference?} The $\beta$ is an important factor to control the model complexity and prediction capability during inference. Here, we adjust $\beta$ during the inference phase, as shown in Table~\ref{table:beta}. DMVFN with larger $\beta$ enjoys better MS-SSIM results but suffers from higher complexity.

\begin{table}[th]
\caption{\textbf{Results of DMVFN with different $\beta$}\ evaluated on KITTI benchmark~\cite{kitti}.}
\centering
\resizebox{0.66\linewidth}{!}{
\begin{tabular}{lccccccccc}
\toprule
% 
Settings~($\beta=$)   & $0.3$ & $0.4$ & $0.5$ & $0.6$ & $0.7$ & $0.8$  \\
\midrule
GFLOPs & \textbf{2.62} & 3.88 & 5.15 & 5.94 & 6.21 & 6.40 \\
LPIPS & 16.47 & 12.91 & 10.74 & 10.26& 10.24 & \textbf{10.23} \\ 
%
MS-SSIM ($\times10^{-2}$) & 78.78 & 85.13 & 88.53 & 88.89 & 88.89 & 88.89\\
\bottomrule
\end{tabular}
}
\label{table:beta}
%
\end{table}

\begin{figure}[th]
 	\centering
 \includegraphics[width=0.55\linewidth]{image/flops-lpips.png}
 %
  	\caption{\textbf{Control the complexity of DMVFN by adjusting $\beta$}. DMVFN saves half GFLOPs of comparable performance compared to DMVFN without routing.}
 	\label{fig:flops}
 \end{figure}


\noindent
\textbf{6) How to design the loss function?} To study this problem, we train our DMVFN and DMVFN (w/o routing) only optimizing the loss on output of the last block $\tilde{I}_{t+1}$~(denoted as ``single supervision"). The results listed in Table~\ref{table:ab6} show the advantages of our loss function $L_{total}$. $L_{total}$ is calculated on all intermediate results of DMVFN.
\begin{table*}[th]
\caption{\textbf{Results of DMVFN with different loss settings}. The evaluation metric is MS-SSIM ($\times10^{-2}$).}

\centering
\resizebox{\linewidth}{!}{
\begin{tabular}{cccccccccccc}
\toprule
\multirow{2}{*}[-0.28em]{Settings} & \multicolumn{3}{c}{Cityscapes} & \multicolumn{3}{c}{KITTI} & \multicolumn{2}{c}{Davis17-Val} & \multicolumn{1}{c}{Vimeo-Test}\\
\cmidrule(l{7pt}r{7pt}){2-4} \cmidrule(l{7pt}r{7pt}){5-7} \cmidrule(l{7pt}r{7pt}){8-9} \cmidrule(l{7pt}r{7pt}){10-10} 
%
 & t+1 & t+3 & t+5  & t+1  & t+3 & t+5 & t+1 & t+3  & t+1  \\ 
\midrule
\midrule
w/o routing, single supervision  & 95.19 & 87.77 & 81.22 & 87.91 & 76.33 & 67.99 & 84.69 & 74.92 & 97.18 \\
w/o routing & 95.29 & 87.91& 81.48 & 88.06 & 76.53 & 68.29 & \textbf{84.81} & \textbf{75.05} & \textbf{97.24} \\
single supervision & 95.65 & 89.10 & 83.27 & 88.34 & 77.88 & 70.18 & 83.83 & 74.68 & 96.95 \\% 
DMVFN & \textbf{95.73}  & \textbf{89.24} & \textbf{83.45} & \textbf{88.53} & \textbf{78.01} & \textbf{70.52} & 83.97 & 74.81 & 97.01\\


\bottomrule
\end{tabular}
}
\label{table:ab6}
\end{table*}

\begin{table*}[th]
\caption{\textbf{Routing Module based on STEBS is effective}. The evaluation metric is MS-SSIM ($\times10^{-2}$).}

\centering
\resizebox{\linewidth}{!}{
\begin{tabular}{cccccccccccc}
\toprule
\multirow{2}{*}[-0.28em]{Settings} & \multicolumn{3}{c}{Cityscapes} & \multicolumn{3}{c}{KITTI} & \multicolumn{2}{c}{Davis-Val} & \multicolumn{1}{c}{Vimeo-Test}\\
\cmidrule(l{7pt}r{7pt}){2-4} \cmidrule(l{7pt}r{7pt}){5-7} \cmidrule(l{7pt}r{7pt}){8-9} \cmidrule(l{7pt}r{7pt}){10-10} 
%
 & t+1 & t+3 & t+5  & t+1  & t+3 & t+5 & t+1 & t+3  & t+1  \\ 
\midrule
\midrule
w/o routing  & 95.29 & 87.91& 81.48 & 88.06 & 76.53 & 68.29 & \textbf{84.81} & \textbf{75.05} & \textbf{97.24} \\
Random & 91.97 & 82.11 & 70.05 & 81.31 & 69.89 & 62.42 & 81.32 & 73.03 & 96.88 \\
Gumbel Softmax & 95.05 & 87.57 & 79.54 & 87.42 & 75.56& 65.83 & 83.64 & 74.43 & 96.98  \\%
STEBS & \textbf{95.73}  & \textbf{89.24} & \textbf{83.45} & \textbf{88.53} & \textbf{78.01} & \textbf{70.52} & 83.97 & 74.81 & 97.01\\


\bottomrule
\end{tabular}
}
\label{table:ab21}
\end{table*}

\noindent
\textbf{More details about our Ablation Study 2) in the main paper}.
%
In Table~\ref{table:ab21}, we summarize the quantitative results of three variants (``w/o routing'', ``Random'' and ``Gumbel Softmax'') on four datasets (i.e., Cityscapes~\cite{cityscapes}, KITTI~\cite{kitti}, Davis-Val~\cite{davis}, and Vimeo-Test~\cite{vimeo}). This demonstrates the effectiveness of our STEBS.

\noindent
\textbf{More details about our Ablation Study 3) in the main paper}.
%
In Table~\ref{table:ab31}, we summarize the quantitative results of DMVFN with different scaling factor settings, including:
\begin{itemize}
\itemsep-0.03in
\item ``[1]'': [1,1,1,1,1,1,1,1,1]
\item ``[2]'': [2,2,2,2,2,2,2,2,2]
\item ``[4]'': [4,4,4,4,4,4,4,4,4]
\item ``[1,2]'': [1,1,1,1,2,2,2,2,2]
\item ``[1,4]'': [1,1,1,1,4,4,4,4,4]
\item ``[2,1]'': [2,2,2,2,1,1,1,1,1]
\item ``[4,1]'': [4,4,4,4,1,1,1,1,1]
\item ``[1,2,4]'': [1,1,1,2,2,2,4,4,4]
\item ``[4,2,1]'': [4,4,4,2,2,2,1,1,1]
\end{itemize}
DMVFN [4,2,1] performs better than others, and the gap is more obvious for long-term future frames. 


\begin{table*}[th]
\caption{\textbf{Results of DMVFN with different scaling factor settings}. The evaluation metric is MS-SSIM ($\times10^{-2}$).}

\centering
\resizebox{\linewidth}{!}{
\begin{tabular}{cccccccccccc}
\toprule
\multirow{2}{*}[-0.28em]{Settings} & \multicolumn{3}{c}{Cityscapes} & \multicolumn{3}{c}{KITTI} & \multicolumn{2}{c}{Davis-Val} & \multicolumn{1}{c}{Vimeo-Test}\\
\cmidrule(l{7pt}r{7pt}){2-4} \cmidrule(l{7pt}r{7pt}){5-7} \cmidrule(l{7pt}r{7pt}){8-9} \cmidrule(l{7pt}r{7pt}){10-10} 
%
 & t+1 & t+3 & t+5  & t+1  & t+3 & t+5 & t+1 & t+3  & t+1  \\ 
\midrule
\midrule
DMVFN [1] & 94.70 & 87.26 & 80.93 & 87.64 & 76.71 & 68.76 & 81.75 & 71.73 & 96.04 \\
DMVFN [2] & 95.51 & 87.76 & 81.30 &  87.06 &  76.90 & 69.05  &  81.77 & 72.58  & 96.07  \\
DMVFN [4] &  94.32 & 87.50 & 81.36  &  84.35 & 75.34  & 68.67 & 81.02 & 72.16 &  95.99 \\
DMVFN [1, 2] &  94.13 & 86.58  & 80.55 &  87.85 & 76.92  &  69.36 & 82.96  & 73.55  & 96.70  \\
DMVFN [1, 4] & 94.56 & 86.50 & 80.69 & 85.46  & 76.03  &  68.99 & 81.38  & 71.98  & 96.02  \\
DMVFN [2, 1] & 95.30 & 87.93 & 82.02 & 87.97 & 77.23 & 69.58 & 83.03 & 72.54 & 96.61 \\
DMVFN [4, 1] & 95.59 & 88.41 & 83.02 & 88.16  & 77.39  & 69.95  & 83.64  &  74.35 & 96.95  \\
DMVFN [1, 2, 4] & 94.20 & 86.56 & 80.81  &  87.77 & 76.89  & 69.72  &  82.72 &  73.66 &  96.76 \\
DMVFN [4, 2, 1] & \textbf{95.73}  & \textbf{89.24} & \textbf{83.45} & \textbf{88.53} & \textbf{78.01} & \textbf{70.52} & \textbf{83.97} & \textbf{74.81} & \textbf{97.01}\\


\bottomrule
\end{tabular}
}
\label{table:ab31}
\end{table*}



\noindent
\textbf{More details about our Ablation Study 4) in the main paper}.
%
In Table~\ref{table:ab41}, we summarize the quantitative results of three variants (``w/o r, w/o path'', ``w/o r'' and ``w/o path'') on four datasets (i.e., Cityscapes~\cite{cityscapes}, KITTI~\cite{kitti}, Davis-Val~\cite{davis}, and Vimeo-Test~\cite{vimeo}).
%
\begin{table*}[th]
\caption{\textbf{Spatial path is effective in DMVFN}. The evaluation metric is MS-SSIM ($\times10^{-2}$).}

\centering
\resizebox{\linewidth}{!}{
\begin{tabular}{cccccccccccc}
\toprule
\multirow{2}{*}[-0.28em]{Settings} & \multicolumn{3}{c}{Cityscapes} & \multicolumn{3}{c}{KITTI} & \multicolumn{2}{c}{Davis-Val} & \multicolumn{1}{c}{Vimeo-Test}\\
\cmidrule(l{7pt}r{7pt}){2-4} \cmidrule(l{7pt}r{7pt}){5-7} \cmidrule(l{7pt}r{7pt}){8-9} \cmidrule(l{7pt}r{7pt}){10-10} 
%
 & t+1 & t+3 & t+5  & t+1  & t+3 & t+5 & t+1 & t+3  & t+1  \\ 
\midrule
\midrule
w/o r, w/o path & 94.99 & 87.59 & 80.98 & 87.75 & 76.22 & 67.86   &  84.45 & 74.78  & 97.05\\
w/o r & 95.29 & 87.91 & 81.48 & 88.06 & 76.53 & 68.29  & \textbf{84.81} & \textbf{75.05} & \textbf{97.24} \\
w/o path &  95.55 & 88.89 & 83.03 & 88.29 & 77.53 & 69.86  & 83.75  & 74.51  & 96.89  \\
DMVFN & \textbf{95.73}  & \textbf{89.24} & \textbf{83.45} & \textbf{88.53} & \textbf{78.01} & \textbf{70.52} & 83.97 & 74.81 & 97.01\\

\bottomrule
\end{tabular}
}
\label{table:ab41}
\end{table*}

\noindent
\textbf{More details about our Ablation Study 5) in the main paper}.
%
In Table~\ref{table:ab51}, we summarize the quantitative results of different $\beta$ during inference on four datasets (i.e., Cityscapes~\cite{cityscapes}, KITTI~\cite{kitti}, Davis-Val~\cite{davis}, and Vimeo-Test~\cite{vimeo}).
%

\begin{table*}[th]
\caption{\textbf{Results of DMVFN with different $\beta$}\ evaluated on Cityscapes benchmark~\cite{cityscapes} and Vimeo-Test benchmark~\cite{vimeo}.}
\centering
\resizebox{\linewidth}{!}{
\begin{tabular}{ccccccccccccc}
\toprule
Settings & \multicolumn{6}{c}{Cityscapes} & \multicolumn{6}{c}{Vimeo-Test}\\
\cmidrule(l{7pt}r{7pt}){2-7} \cmidrule(l{7pt}r{7pt}){8-13}
% 
$\beta=$   & $0.3$ & $0.4$ & $0.5$ & $0.6$ & $0.7$ & $0.8$ & $0.3$ & $0.4$ & $0.5$ & $0.6$ & $0.7$ & $0.8$ \\ %
\midrule
GFLOPs & \textbf{6.56} & 9.81 & 12.71 & 15.30 & 16.23 & 17.82 & \textbf{1.38} & 2.08 & 2.77 & 3.40 & 3.74 & 3.92 \\ 
LPIPS & 8.88 &  7.06 &  5.58 & 5.20 & 5.15 & \textbf{5.12} & 5.18 & 4.18 &   3.69 & 3.48 & 3.42 & \textbf{3.40} \\   
MS-SSIM ($\times10^{-2}$) &90.48  & 93.54 & 95.73 & 96.03 & 96.07 & \textbf{96.12} & 93.61 & 96.13 & 97.01 & 97.19 & \textbf{97.20} & \textbf{97.20}\\
\bottomrule
\end{tabular}
}
\label{table:ab51}
\end{table*}

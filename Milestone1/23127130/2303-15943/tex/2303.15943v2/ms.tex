\documentclass{svproc}

\usepackage[intlimits]{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\numberwithin{equation}{section}
\usepackage{bbm}

\usepackage{xcolor}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{float}
\usepackage{subcaption}

%\usepackage[backend=biber,style=numeric]{biblatex}
%\addbibresource{references.bib}

\newcommand{\ie}{i.e.\ }
\newcommand{\eg}{e.g.\ }
\newcommand{\cf}{cf.\ }
\newcommand{\wrt}{w.r.t.\ }

\newcommand{\restr}[1]{\raisebox{-.5ex}{$|$}_{#1}}
\newcommand{\norm}[1]{||#1||}
\newcommand{\diff}{\mathop{}\!\mathrm{d}}

\newcommand{\clos}{\operatorname{clos}}
\newcommand{\supp}{\operatorname{supp}}

\newcommand{\R}{\mathbb{R}}
\newcommand{\xcal}{\mathcal{X}}
\newcommand{\ycal}{\mathcal{Y}}
\newcommand{\zcal}{\mathcal{Z}}

%Annotations
\usepackage{xargs}
\usepackage[colorinlistoftodos]{todonotes}
\newcommand{\unsure}[2][1=]{\todo[linecolor=red,backgroundcolor=red!25,bordercolor=red,#1]{#2}}
\newcommand{\change}[2][1=]{\todo[linecolor=blue,backgroundcolor=blue!25,bordercolor=blue,#1]{#2}}
\newcommand{\info}[2][1=]{\todo[linecolor=OliveGreen,backgroundcolor=OliveGreen!25,bordercolor=OliveGreen,#1]{#2}}
\newcommand{\improvement}[2][1=]{\todo[linecolor=Plum,backgroundcolor=Plum!25,bordercolor=Plum,#1]{#2}}
\newcommand{\reference}{\todo[linecolor=cyan,backgroundcolor=cyan!25,bordercolor=cyan]{missing reference}}

% to typeset URLs, URIs, and DOIs
\usepackage{url}
\def\UrlFont{\rmfamily}

\begin{document}
\mainmatter              % start of a contribution
%
\title{An optimally stable approximation of\\ reactive transport using discrete test\\ and infinite trial spaces}
\titlerunning{An optimally stable approximation for reactive transport}
%
\author{Lukas Renelt\inst{1}, Mario Ohlberger\inst{1} \and
Christian Engwer\inst{1}}
%
\authorrunning{L. Renelt, M. Ohlberger, C. Engwer} % abbreviated author list (for running head)
%

\institute{Institute for Analysis and Numerics, University of Münster, Einsteinstr. 62,\\ 48149 M\"unster, Germany.
\url{https://www.uni-muenster.de/AMM} 
\email{\{lukas.renelt,mario.ohlberger,christian.engwer\}@uni-muenster.de}
}

\maketitle              % typeset the title of the contribution

\begin{abstract}
In this contribution we propose an optimally stable ultraweak Petrov-Galerkin variational formulation and subsequent discretization for stationary reactive transport problems.
The discretization is exclusively based on the choice of discrete approximate test spaces, while the trial space is a priori infinite dimensional.
The solution in the trial space or even only functional evaluations of the solution are obtained in a post-processing step.
We detail the theoretical framework and demonstrate its usage in a numerical experiment that is motivated from modeling of catalytic filters.

\keywords{optimal stability, reactive transport, ultraweak formulation}
\end{abstract}
%

\section{Introduction}
In this contribution we are considered with stationary reactive transport equations of the form\vspace*{-1em}
\begin{equation}\label{eq:transport:strongProblem}
\begin{cases}
A_\circ u := \nabla\cdot(\vec{b} u) + cu &= f_\circ \qquad  \text{in }\;\Omega,\\
\hfill u &= g_D \hfill \text{on }\Gamma_- \ .\\
\end{cases}
\end{equation}
Here,  $\Omega\subset\R^n$ denotes an open, bounded polyhedral domain with Lipschitz-boundary $\Gamma := \partial\Omega$,  $\vec{b}\in H^1(\mathop{div}, \Omega)$  a
given divergence-free\footnote{We restrict to divergence free velocities. However, non-divergence free fields may be considered as well.} transport field and $c\in L^\infty(\Omega)$ a reaction coefficient.
Moreover, $f_\circ\in L^2(\Omega)$ denotes the source term and $g_D\in L^2(\Gamma_-)$ the  boundary values at the inflow boundary,
where the  in- and outflow boundary parts are defined as 
$
\Gamma_\pm := \{ z\in\Gamma \;|\; \vec{b}(z)\cdot \nu(z) \gtrless 0\}
$
and $\nu(\cdot)$ denotes the outer unit normal. In a weak sense, we interpret $A_\circ: U \to V'$ as an operator that maps from a trial space $U$ to the dual of a test space $V$,
where $U, V$ need to be chosen appropriately.
%For continuous spaces $U=C^\infty_{\Gamma_-}(\Omega)$\footnote{This notation shall denote the $C^\infty$-functions vanishing on $\Gamma_-$.} and $V=C^\infty(\Omega)$ we obtain the strong variational formulation
%\begin{equation}
%\text{Find}\; u\in U: \qquad a(u,v) \;=\; f(v) \qquad \forall v\in V
%\end{equation}
%with 
%$a(u,v) := {(A_\circ u, v)}_{L^2(\Omega)}, \ f(v) := {(f_\circ, v)}_{L^2(\Omega)}$.


A known challenge in the numerical treatment of transport problems is the stability of the chosen variational formulation and discretization. 
A common approach for stabilization is the enrichment of the test space by supremizers leading to a Petrov-Galerkin scheme. Depending on the norms on trial and test space, determining the supremizer for a given trial function often requires solving an additional equation with complexity of the full problem.
In this contribution, we use an approach using `optimal' test spaces, \ie spaces that a-priori include all supremizers and thus are unconditionally stable (see \eg\cite{demkowiczDPG1,DahmenHuangSchwab}). However, unlike the discontinuous Petrov-Galerkin method (DPG) and the method defined in~\cite{DahmenHuangSchwab} we discretize by first choosing the discrete test space and
subsequently determine a corresponding trial space as it has been used in~\cite{BrunkenSmetanaUrban,HenningPalitta}.
The resulting approach is computationally more efficient and leads to an optimally stable formulation and discretization.
We show that it is actually not needed to construct a discrete trial space at all since all computations can be performed
using a related normal equation that is defined solely on the test space. Interpreting the solution to the normal equation as a dual variable, this is similar to a (FOS)LL* approach (see~\cite{caiFOSLL} and references therein).
We provide the theoretical framework in Section 2 and the resulting approximation scheme in Section 3.
Numerical experiments for reactive transport in catalytic filters are
given in Section 4. The experiments show %the
advantages and challenges 
of the proposed approach. Resulting perspectives for model order reduction based on the proposed framework are discussed in the conclusion.

\input{variational_formulation}

\input{discretization}

\input{numerical_experiments}

\section{Conclusion}\vspace*{-0.75em}
In this contribution we derived an ultraweak, optimally stable
formulation for reactive
transport.
% that is optimally stable.
In contrast to previous work we
did not introduce additional boundary conditions on the test space but
instead imposed them weakly by including boundary terms in the adjoint
operator. We also showed that a standard FE-discretization of the
test space is sufficient to solve the normal equations and
perform classic functional evaluations of the reconstructed solution
without discretizing the trial space explicitly.
% Further
Future
work will concern the robust solving of the normal equations,
as well as using model order reduction techniques to efficiently solve
parameter-dependent reactive transport problems.  \vspace*{-1.25em}

\subsubsection{Acknowledgements} 
The authors acknowledge funding by the BMBF under contract 05M20PMA
and by the Deutsche Forschungsgemeinschaft under Germany’s Excellence
Strategy EXC 2044 390685587, Mathematics M\"unster: Dynamics --
Geometry -- Structure.\vspace*{-1.25em}

\bibliographystyle{abbrv}
\bibliography{ms}

\end{document}

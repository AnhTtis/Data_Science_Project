\label{sec:experiments}
To evaluate our method's performance in promoting safety in autonomous driving scenarios under occlusions, in this section, we conduct 1) a 3-agent interaction experiment to evaluate our methods' estimation performance, 2) a multi-agent planning experiment to evaluate our methods' collision avoidance performance, and 3) a crossing-road experiment to evaluate our method's performance in estimation and planning in driving scenarios.
\subsection{3-Agent Interaction (Estimation)}
\label{sec:three_player_interaction}
\begin{figure*}[!t]
    \centering
    \subfloat[Ground truth]{\includegraphics[width=0.243\textwidth]{figures/ground_truth_trajectory.png}
    \label{fig:demo_gt}}
    \subfloat[Noisy Observations]{\includegraphics[width=0.243\textwidth]{figures/noisy_trajectories.png}
    \label{fig:demo_obs}}
    \subfloat[Estimation (Occlusion-aware)]{\includegraphics[width=0.243\textwidth]{figures/occlusion_aware_estimated_trajectories.png}
    \label{fig:demo_est_aware}}
    \subfloat[Estimation (Occlusion-ignorant)]{\includegraphics[width=0.243\textwidth]{figures/occlusion_ignorant_estimated_trajectories.png}
    \label{fig:demo_est_ignorant}}
    \caption{Demonstration for the 3-agent interaction scenario in Section \ref{sec:three_player_interaction}, with observation noise standard devioveration $\sigma=0.07$\si{m} across 20 different observation sequences, in which all agents apply open-loop Nash strategies. (a)  Ground truth trajectory of each agent. (b)  Observations, where the trajectories of the blue agents are corrupted by noise and the green agent is occluded. (c)  Estimated trajectories by the occlusion-aware game estimator (\textbf{ours}). (d) Estimated trajectories by the occlusion-ignorant estimator (\textbf{baseline}). Our method 1) enables estimation of the occluded agent, and 2) provides more accurate estimation of observed agents than the baseline.}
    \label{fig:demo_and_estimation}
    \vspace{-3.5ex}
\end{figure*}

\begin{figure}[!t]
\centering
\subfloat[Parameter Estimation Performance]{\includegraphics[width=0.479\textwidth]{figures/parameter_error_plot.png}
\label{fig:parameter_estimation_performance}}\vspace{-2.5ex}

\subfloat[Trajectory Estimation Performance]{\includegraphics[width=0.479\textwidth]{figures/trajectory_error_plot.png}
\label{fig:trajectory_estimation_performance}}
\caption{Estimation performance for occlusion-aware game estimator (\textbf{ours}) and the occlusion-ignorant game estimator (\textbf{baseline}). (a) Parameter estimation performance. (b) Trajectory estimation performance. Our method estimates the weighting parameters and state trajectories of both visible and occluded agents more accurately than the baseline.}
\label{fig:estimation_analysis}
\vspace{-4ex}
\end{figure}

We first evaluate the estimation performance in a 3-agent interaction scenario, where the robot observes an interaction with two visible agents and one occluded agent with the cost structure in \eqref{eqn:running cost}. While all three agents are visible to each other, the robot has noisy partial observations of only the visible agents, as depicted in Figures \ref{fig:demo_gt} and \ref{fig:demo_obs}.\\
\noindent\textbf{Baseline:} We compare our method with an occlusion-ignorant method, i.e., the robot is ignorant of the occluded agent and identifies the interaction as a 2-agent game.\\
\noindent\textbf{Evaluation Metrics}: We evaluate the estimation performance with the following metrics:\\
\textit{Weighting Parameter Estimation Precision}: We evaluate the parameter cosine dissimilarity of each agent \cite{peters2021inferring}:
\begin{equation}
    D(\textbf{w}^i_{\text{GT}},\hat{\textbf{w}}^i):=1-\frac{{\textbf{w}_{\text{GT}}^i}^\top \hat{\textbf{w}}^i}{\|\textbf{w}_{\text{GT}}^i\|_2\|\hat{\textbf{w}}^i\|_2},\ i\in[M]
    \label{eqn:parametererror}
\end{equation}
which quantifies the precision of estimated weighting parameters $\hat{\textbf{w}}$ in comparison to the ground truth $\textbf{w}_{\text{GT}}$.\\
\textit{Trajectory Estimation Accuracy}: We compute the average displacement error (ADE) between the estimated trajectories based on recovered parameters and the ground truth:
\begin{equation}
    \begin{aligned}
    \text{ADE}_{\text{visible}}&:=\frac{1}{|\mathcal{V}|\cdot T}\sum_{i\in\mathcal{V}}\sum_{k\in[T+1]}\|p_{\text{GT},k}^i-\hat{p}_{k}^i\|_2,\\
    \text{ADE}_{\text{occluded}}&:=\frac{1}{|\mathcal{O}|\cdot T}\sum_{i\in\mathcal{O}}\sum_{k\in[T+1]}\|p_{\text{GT},k}^i-\hat{p}_{k}^i\|_2,
    \end{aligned}
    \label{eqn:positionerror}
\end{equation}
where ${p_{\text{GT},k}^i}$ and ${\hat{p}_{k}^i}$ denote the ground truth and the estimated position of the $i^{\text{th}}$ agent at time step $k$, respectively.\\
\textbf{Discussion}: Monte Carlo study results of 20 observation sequences across 11 levels of observation noise reveal that our method 1) outperforms the baseline that ignores the occluded agent in estimating the parameters and trajectories of the observed agents, and 2) is able to estimate those of the occluded agent as well, as illustrated in Figure \ref{fig:estimation_analysis}. Figure \ref{fig:demo_and_estimation} visualizes the estimated trajectories for our approach and the baseline; as shown, our method reliably recovers the occluded agentâ€™s trajectory while also maintaining high accuracy for visible agents.

\subsection{Collision Avoidance Scenario (Planning)}
Next, we evaluate the performance in a collision avoidance scenario, where each agent aims to reach its target while keeping as far as possible from the other agents (using the running cost in \eqref{eqn:running cost}). Specifically, the visibility among agents is randomly generated, and each agent cannot see the occluded agents until the branching time $t_b$. In order to isolate the effects of planning, we do not include observation noise in this experiment.\\
\textbf{Baseline:} We compare our method with an occlusion-ignorant planner, i.e., before $t_b$, each agent plans based only on the agents visible to him, and after $t_b$, they plan based on all agents.\\
\noindent\textbf{Evaluation Metric:} We evaluate the collision avoidance performance with the following metric:\\
\textit{Minimum Distance}: We evaluate the minimum distance between the $i^\text{th}$ agent and all other agents over time:\\
\begin{equation}
    d_{\text{min}}:=\min_{k\in[T+1]}\min_{\substack{i,j\in[M]\\j\neq i}}\ {\|p_k^i-p_k^j\|}_2.
\label{eqn:minimumdist}
\end{equation}
\noindent\textbf{Discussion:} We compare our method (with different values of belief $b(\theta_1)$ and branching time $t_b$) to the occlusion-ignorant baseline. Monte Carlo study results of 100 samples (goals and initial positions randomly generated) in the 4, 6, and 8-agent scenarios reveal that the agents behave more conservatively before $t_b$. Consequently, a larger $t_b$ enables agents to maintain larger distances from both visible and occluded agents. With the same $t_b$, variations in $b(\theta_1)$ do not have a significant effect. Across all values of $b(\theta_1)$ and $t_b$, our method outperforms the occlusion-ignorant baseline in collision avoidance. Specifically, agents equipped with the occlusion-aware contingency game planner make more careful decisions and avoid the other agents more actively, as illustrated in Figure \ref{fig:planning_visualization}.
\begin{figure}[!t]
\centering
\includegraphics[width=0.486\textwidth]{figures/combined_closest_distance_and_occlusion_distance.png}
\caption{Bootstrapped confidence intervals of the median for $d_\mathrm{min}$ \eqref{eqn:minimumdist} 
in 4, 6, and 8-agent planning scenarios. Left: Minimum distance between all pairs of agents. Right: Minimum distance between agents that are initially occluded to each other. Our method enables the agents to keep a larger distance from both visible and occluded agents than the occlusion-ignorant baseline, and this pattern persists across multiple values of $b(\theta_1)$ and $t_b$.}
\label{fig:planning_analysis}
\vspace{-4ex}
\end{figure}
\begin{figure}[!t]
\centering
\subfloat[Contingency Game Planner]{\includegraphics[width=0.236\textwidth]{figures/0_contingency_40_belief_0_7.png}
\label{fig:contingnecy_planning}}
\subfloat[Occlusion-Ignorant Game Planner]{\includegraphics[width=0.236\textwidth]{figures/0_occlusion_ignorant_20.png}
\label{fig:occlsion_ignorant_planning}}
\caption{Trajectories of agents in an 8-agent planning scenario using (a) contingency game planner (\textbf{ours}) with belief $b(\theta_1)=0.7$ and branching time $t_b=4$\si{s}; and (b) occlusion-ignorant game planner (\textbf{baseline}) with branching time $t_b=2$\si{s}. Our method enables agents to reason proactively in order to avoid potential collisions with occluded agents.}
\label{fig:planning_visualization}
\vspace{-4ex}
\end{figure}

\subsection{Crossing-Road Scenario (Estimation and Planning)}
\begin{figure*}[!t]
    \includegraphics[width=0.98\textwidth]{figures/combined_figure.png}
    \caption{Crossing road scenario. Top: the green vehicle is equipped with the occlusion-aware game estimator and contingency game planner. When $k<t_b$, the green vehicle estimates all agents' trajectories from noisy observation of the red vehicle next to it and formulates a contingency plan which accounts for the (non)existence of the occluded vehicles on the horizontal lanes. When $k\geq t_b$, occlusions are removed and the green vehicle follows the appropriate branch of its contingency plan. %continues estimates their trajectories and plans accordingly.
    Bottom: the green vehicle is equipped with the occlusion-ignorant game estimator and planner. It ignores the occluded vehicles until $k\geq t_b$. Our method enables the green vehicle to recognize the risk posed by potentially occluded vehicles, and slow down rather than blindly entering the intersection and causing a near-accident.
    % keep a farther distance from initially occluded vehicles in comparison with the baseline.
    }
    \label{fig:traffic_plot}
    \vspace{-2ex}
\end{figure*}
In this scenario, we consider a realistic crossing-road scenario with observation noise. The running cost of each agent is formulated as follows:
\begin{equation}
    g_k^i(\textbf{x}_k,\textbf{u}_k;\textbf{w}^i)=\sum_{l=1}^4w_l^ig_{l,k}^i\left\{\begin{aligned}
    &g_{1,k}^i=\|p_k^i-p_{g}^i\|_2^2\\
    &g_{2,k}^i=\sum_{\substack{j=1\\j\neq i}}^M\frac{1}{\|p_k^i-p_k^{j}\|_2^2}\\
    &g_{3,k}^i=(d_k^i)^2\\
    &g_{4,k}^i=\|u_k^i\|_2^2
    \end{aligned}\right.,
\end{equation}
Here $d_k^i$ denotes the distance between the $i^{\text{th}}$ agent and the center line of the lane it belongs to, and the goal of each agent $x_{g,k}^i$ evolves with time. In this scenario, each agent not only tries to keep a safe distance from other agents ($g_{1,k}^i$) while moving forward ($g_{2,k}^i$) but also seeks to keep itself in the lane according to traffic rules ($g_{3,k}^i$) without heavy energy consumption ($g_{4,k}^i$).\\
\noindent\textbf{Baseline:} We compare our method with a receding horizon Nash game-theoretic planner equipped with the occlusion-ignorant estimator.\\
\noindent\textbf{Evaluation Metrics:} We evaluate the \textit{Trajectory Estimation Accuracy} \eqref{eqn:positionerror} for estimation performance, and the \textit{Minimum Mutual Distance} \eqref{eqn:minimumdist} for planning performance.\\
\noindent\textbf{Discussion:} Figure \ref{fig:traffic_plot} illustrates the difference between our method and the baseline. When $k<t_b$\footnote{We keep a constant $t_b$ for both methods for a fair comparison.}, the orange vehicles are occluded from the green vehicle. The baseline method assumes that the green vehicle only interacts with the red observed vehicle and plans in a 2-agent game. Our method, with the occlusion-aware game estimator, estimates all agents' states and plans in a 4-agent contingency game. The occlusion-aware game estimator infers the trajectories of occluded vehicles, which cause the (visible) red vehicle to decelerate; then the contingency game planner provides a more conservative strategy before the branching time $t_b$. When $k\geq t_b$, the occluded vehicles come into view. The baseline method now solves a 4-agent game, while our method chooses the strategy that assumes occluded vehicles exist. Statistical results in Table \ref{tab:trafficstats} indicate that our method provides 1) accurate estimation of occluded vehicles, 2) more accurate estimations of all vehicles, and 3) a safer collision avoidance strategy that keeps 1\si{m} farther away from initially occluded vehicles in comparison with the baseline.

\begin{table}[!t]
  \centering
  \scriptsize
  \begin{threeparttable}
  \caption{Performance in the crossing-road scenario}
    \begin{tabular}{ccc}
    \toprule
    \toprule
          & occlusion-aware estimator & occlusion-ignorant game \\ 
          & contingency game planner & estimator and planner \\
          & (\textbf{ours}) & (\textbf{baseline}) \\
    \midrule
    $\text{ADE}_\text{observed}$ [\si{m}] & \textbf{0.41} / \textbf{0.58} / 1.08 & 0.57 / 0.69 / \textbf{0.99} \\
    $\text{ADE}_\text{occluded}$ [\si{m}] & \textbf{0.51} / \textbf{0.80} / \textbf{1.18} &  - \tablefootnote{The baseline cannot estimate occluded agents' trajectories.}\\
    $d_{\text{min, observed}}$ [\si{m}] & \textbf{1.35} / \textbf{1.36} / \textbf{1.42} & 1.25 / 1.27 / 1.32 \\
   $d_{\text{min, occluded}}$ [\si{m}] & \textbf{4.61} / \textbf{4.67} / \textbf{4.68} & 3.66 / 3.70 / 4.58 \\
    \bottomrule
    \bottomrule
    \end{tabular}%
  \label{tab:trafficstats}%
  \end{threeparttable}
  \vspace{-5ex}
\end{table}%
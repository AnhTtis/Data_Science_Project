%
\section{Dynamic output feedback STC}
\label{sec_main}
In this section, we present the details of the dynamic output feedback STC approach and give stability guarantees. The proposed approach is a modified version of the dynamic STC approach that requires full state measurements from \cite{hertneck21robust_arxiv}. We will first briefly recap the main idea of the dynamic STC mechanism with full state measurements from \cite{hertneck21robust_arxiv} and then explain how it can be modified to still work with output feedback.
%
We assume throughout this section that $\xi$ is a maximal solution to \eqref{eq_sys_hyb}. 

\subsection{Recap: Dynamic STC with full state measurements}
In the case with full state measurement from \cite{hertneck21robust_arxiv}, the strategy is to choose, at a transmission time $\tvar_j$, the transmission time $\tvar_{j+1}$ such that $V(x_p(\tvar_{j+1}))$ does not exceed a discounted average of its past $m$ values for some chosen $m\in\N$, i.e., the ideal goal is to choose $s_{j+1}$
 such that 
\begin{equation}
	\label{eq_idea_window}
	V(x_p(\tvar_{j+1})) \leq \frac{1}{m} \sum_{k=j-m+1}^{j} e^{-\epsilon_\refer \left(t_{j+1} - t_k\right)} V(x_p(\tvar_k))
\end{equation}
hols for some $\epsilon_\refer > 0$.
%
%
%
%
%
%
This choice can be implemented in our hybrid system model \eqref{eq_sys_hyb} by choosing $n_\eta = m-1$ as the dimension of the dynamic variable and define the update rule of the dynamic variable as\footnote{Note that we use here abusively $S(\eta,x_p)$ and $\Gamma(x_p,\eta)$ instead of $S(\eta,x_o)$ and $\Gamma(x_o,\eta)$ since we recap dynamic STC with full state measurements in this subsection.}
\begin{equation}
	\label{eq_S_window}
	S(\eta,x_p) = \begin{pmatrix}
		e^{-\epsilon_\refer\Gamma(x_p,\eta)}\eta_2\\
		\vdots\\
		e^{-\epsilon_\refer\Gamma(x_p,\eta)}\eta_{m-1}\\
		e^{-\epsilon_\refer\Gamma(x_p,\eta)}V(x_p)
	\end{pmatrix}.
\end{equation}
 Note that  $t_{j+1}-t_{j} = \auxvar(\tvar_j^+) = \Gamma(x_p(\tvar_j),\eta(\tvar_j))$. Hence, $\eta_k(s_j) = e^{-\epsilon_\refer (t_j-t_{j-m+k})} V(x_p(s_{j-m+k}))	$ holds for this choice of $S(\eta,x)$,
%
%
%
%
 if $k > m-j$, which implies
%
$V(x_p(\tvar_j))+\sum_{k=1}^{m-1} \eta_k(\tvar_j) = \sum_{k = j-m+1}^{j} e^{\epsilon_\refer \left(t_j - t_k\right)} V(x_p(s_k))$
%
for $j > m$.  
%



%
%
%
%
%





Due to Proposition~\ref{prop_hybrid}, \eqref{eq_idea_window} is satisfied, if there is one parameter set $(\epsilon_i,\gamma_i,L_i)$ satisfying Assumption~\ref{asum_hybrid_lyap} for which 
%
%
$e^{ -\epsilon_i\auxvar(\tvar_j^+)} V(x_p(\tvar_j))
\leq e^{-\epsilon_\refer\auxvar(\tvar_j^+)} C(x_p(\tvar_j),\eta(\tvar_j)) $
%
%
and $\auxvar(\tvar_j^+) < T_{\max}(\gamma_i,\max\left\lbrace L_i+\frac{\epsilon_i}{2},1-\delta\right\rbrace)$ hold, where $	C(x_p,\eta) = V(x_p) + \sum_{k=1}^{m-1} \eta_k.$
Given $(\epsilon_i,\gamma_i,L_i)$, it can thus be ensured that \eqref{eq_idea_window} holds if the next transmission time is selected as
%
\begin{equation}
	\begin{split}
		\auxvar(\tvar_j^+)  =& \min\left\lbrace \delta T_{\max}\left(\gamma_i,\max\left\lbrace L_i+\frac{\epsilon_i}{2},1-\delta\right\rbrace\right)\vphantom{\frac{\log(C(x_p(\tvar_j),\eta(\tvar_j)))-\log(V(x_p(\tvar_j)))}{\max\left\lbrace -\epsilon_i,2(L_i-\lvar_i ) \right\rbrace + \epsilon_\refer}}\right.,\\
		&\left.\frac{\log(C(x_p(\tvar_j),\eta(\tvar_j)))-\log(V(x_p(\tvar_j)))}{ -\epsilon_i + \epsilon_\refer} \right\rbrace,
			\label{eq_trigger_t1}
	\end{split}
\end{equation}
see \cite[Section III.B]{hertneck21robust_arxiv} for a detailed derivation. The idea for the dynamic STC mechanism is now to compute offline $n_\tpar$ different parameter sets $(\epsilon_i,\gamma_i,L_i), i\in\left\lbrace 1,\dots,n_\tpar\right\rbrace$ for which Assumption~\ref{asum_hybrid_lyap} holds and to maximize $\auxvar(\tvar_j^+)$  in \eqref{eq_trigger_t1} over all parameter sets to determine the next transmission time. If this is not possible, then a fallback strategy is used, that is to choose the next transmission time sufficiently small to still guarantee a decrease of $V$, which is always possible if Assumption~\ref{asum_hybrid_lyap} holds with some $\epsilon_i > 0$. 
The complete procedure to select the next transmission time in the state-feedback case is summarized in \cite[Algorithm~2]{hertneck21robust_arxiv}.
%
%
%
%
%

%
It has been shown in \cite{hertneck21robust_arxiv} that the resulting dynamic STC mechanism guarantees UGAS and that it can significantly reduce the number of transmissions in comparison to periodic time-triggered sampling. 
%
However $V(x_p(\tvar_j))$ and its past $m-1$ values are needed to compute $\auxvar(\tvar_j^+)$ in \eqref{eq_trigger_t1}, which requires full state feedback and is not possible if only a lower dimensional output is available. We describe in the next subsection, how the observed state $x_o(\tvar_j)$ can be used instead to determine transmission times. 

\subsection{Modifications for dynamic output feedback STC and stability result}
Since neither $V(x_p(\tvar_j))$ nor its values from the past $m-1$ transmission times can be measured, we use instead $V(x_o(\tvar_j))$ and the values of the Lyapunov function from the past $m-1$ transmission times at transmission time $\tvar_j$ to determine the next transmission time $\tvar_{j+1}$. To do so, the following changes are needed in comparison to the state-feedback variant of the STC mechanism. 
First, we change the update of the dynamic variable to 
\begin{equation}
	\label{eq_S_window_2}
	S(\eta,x_o) = \begin{pmatrix}
		e^{-\epsilon_\refer\Gamma(x_o,\eta)}\eta_2\\
		\vdots\\
		e^{-\epsilon_\refer\Gamma(x_o,\eta)}\eta_{m-1}\\
		e^{-\epsilon_\refer\Gamma(x_o,\eta)}\min\left\lbrace V(x_o), V_{\max}\right\rbrace 
	\end{pmatrix},
\end{equation}
i.e., we use $V(x_o)$ instead of $V(x_p)$ and we bound each component of the dynamic variable by some chosen  $V_{\max}\in\R_{>0}$. The latter is needed in case that the plant state grows faster than the observer state decreases to limit the maximum increase of the plant state.
%
Second, we modify the procedure to determine transmission times. We replace \eqref{eq_trigger_t1} by
\begin{equation}
	\begin{split}
		\auxvar(\tvar_j^+)  =& \min\left\lbrace \delta T_{\max}\left(\gamma_i,\max\left\lbrace L_i+\frac{\epsilon_i}{2},1-\delta\right\rbrace\right)\vphantom{\frac{\log(C(x_o(\tvar_j),\eta(\tvar_j)))-\log(V(x_o(\tvar_j)))}{\max\left\lbrace -\epsilon_i,2(L_i-\lvar_i ) \right\rbrace + \epsilon_\refer}}\right.,\\
		&\left.\frac{\log(C(x_o(\tvar_j),\eta(\tvar_j)))-\log(V(x_o(\tvar_j)))}{ -\epsilon_i + \epsilon_\refer} \right\rbrace,
		\label{eq_trigger_t2}
	\end{split}
\end{equation} 
where we use 
\begin{equation}
	\label{eq_C_def}
	C(x_o,\eta) = \frac{1}{m}\left( V(x_o) + \sum_{k=1}^{m-1} \eta_k\right).
\end{equation}
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%

%
%

\input{allgo_window.tex}
The modified procedure to select transmission times is described by Algorithm~\ref{algo_trig_window}, which is a modified variant of \cite[Algorithm~2]{hertneck21robust_arxiv}. Note that an additional important modification in the algorithm, that is needed for technical reasons to obtain stability guarantees, is that the algorithm selects $\bar{h} > \delta T_{\max}\left(\gamma_\itilde,L_\itilde+\frac{\epsilon_\itilde}{2}\right)$ only if $C(x_o(\tvar_j),\eta(\tvar_j)) \leq V_{\max}$ for the chosen $V_{\max}$. This means that the algorithm resorts to the fallback strategy if the value of the observed Lyapunov function exceeds the bound $V_{\max}$. It is needed if $x_p$ and $x_o$ grow faster than $e_o$ converges to limit the maximum increase of $x_p$ and $x_o$. 
%
%
%
We obtain the following result for the proposed dynamic STC mechanism with output feedback. 
\begin{theo}
	\label{prop_fir}
	Consider the hybrid system \eqref{eq_sys_hyb} with $S(\eta,x_o)$ defined according to \eqref{eq_S_window_2} and $\Gamma(x_o,\eta)$ defined by Algorithm~\ref{algo_trig_window} with $C(x_o,\eta)$ according to \eqref{eq_C_def}, some $\delta \in 
		\left(0,1\right)$ and $V_{\max} >0$. Assume there are $n_\tpar$ different parameter sets $\epsilon_i, \gamma_i, L_i$, $i \in \left\lbrace 1,\dots,n_\tpar\right\rbrace$, for which Assumption~1 holds with the same function $V$ and let $\epsilon_1\geq\epsilon_\refer > 0$. Let Assumption~\ref{as_obs_er} hold. Then, the set $\left\lbrace \left(x_p,x_o,e,\eta,\tau,\auxvar\right): x_p = 0, x_o = 0, e= 0, \eta = 0 \right\rbrace$ is UGAS and for any maximal solution $\xi$, $\svar_{j+1}- \svar_j \geq t_{\min} \coloneqq \delta T_{\max}\left(\gamma_1,L_1+\frac{\epsilon_1}{2}\right)$ for all $j\in\change{\mathbb{N}_0}{\dom~\xi}$.
\end{theo}
\arxiv{The proof ot Theorem~\ref{prop_fir} can be found in the preprint \url{https://arxiv.org/abs/xxxx.xxxxx}.}{The proof of Theorem~\ref{prop_fir} is given in Appendix~\ref{app_a}.}

\begin{rema}
	The main difference of the proposed output feedback STC mechanism in comparison to the variant with full state measurements is that the observer state is used instead of the real plant state to determine transmission times and to compute inputs that are applied to the plant. Since the observer error is handled together with the network induced error, Assumption~\ref{asum_hybrid_lyap} is the same as for the full state-feedback case (cf. \cite[Assumption~1 for $w=0$]{hertneck21robust_arxiv}), i.e., the parameters $\epsilon_i,\gamma_i,L_i$ can be determined in the same way as for the case with full state measurements and are independent from the observer choice. Since the observer has no influence on Assumption~\ref{asum_hybrid_lyap}, the design of controller and STC mechanism can be separated from the design of the observer, and any observer that satisfies Assumption~\ref{as_obs_er} can be used.
%
%
	
%
%
\end{rema}

\begin{rema}
	There are three parameters $\epsilon_\refer, V_{\max}$ and $\delta$ for the proposed STC mechanism that can be chosen by the user. The worst case asymptotic convergence speed of the system state is determined by $\epsilon_\refer$. The bound $V_{\max}$ is needed to avoid that the Lyapunov function grows faster than the observer error converges and can be chosen arbitrarily large. The parameter $\delta$ is needed for technical reasons. For a preferably large time between transmissions, it should be chosen close to $1$, e.g., $\delta = 0.999$. 
\end{rema}

\begin{rema}
	Note that the proof of Theorem~\ref{prop_fir} can be modified if $\epsilon V(x)$ is replaced in Assumption~\ref{asum_hybrid_lyap} for $i = 1$ by $\rho(\abs{x})$ for some $\rho\in\mathcal{K}$ to still guarantee UGAS. This makes the assumption less restrictive but requires however some additional technical modifications that are omitted for simplicity. 
\end{rema}

%

%

%

\section{Basics of OFDM Radar}  \label{sec:Basics_OFDM_Radar}

\input{./fig/Fig_OFDM_Radar_sig_processing}

This section starts with a very brief textual explanation of the receiver signal processing chain of an \ac{ofdm}-based \ac{siso} radar system, which corresponds to that used for \ac{ddm} later in this work. After that, the signal model for the \ac{mimo} case is briefly described. The reader is referred to \cite{Sturm_A_novel_approach, Sturm_An_OFDM_System, Sturm_Performance_verification, Sit_Automotive_MIMO_OFDM,Braun_Parametrization, Hakobyan_Inter_Carrier_Interference, Lang_RDM_JP} for more details. 

\subsection{OFDM Waveform and Radar Signal Processing} 

\ac{ofdm} waveforms utilized in radar applications are typically based on the \ac{cp}-\ac{ofdm} waveform. \ac{cp}-\ac{ofdm} is widely adopted in wireless communications \cite{Van_Nee_OFDM} and the reader is thus expected to be familiar with it. Tab.~\ref{Tab:OFDM_paramters} lists important design parameters of the \ac{ofdm} waveform. 

\begin{table}[!t]
% increase table row spacing, adjust to taste
\renewcommand{\arraystretch}{1.3}
\caption{Parameter Definitions.}
\label{Tab:OFDM_paramters}
\centering
% Some packages, such as MDW tools, offer better commands for making tables
% than the plain LaTeX2e tabular which is used here.
\begin{tabular}{|l|l|}
\hline
 Parameter & Symbol   \\
 \hline \hline
 Carrier frequency & $f_\text{c}$ \\
 \hline
 Bandwidth &  $B$ \\
 \hline
 Number of subcarriers & $N_\text{c}$ \\
  \hline
 ADC sampling time & $T_\text{s} =  1/B$ \\
 \hline
 Subcarrier spacing & $ \Delta f = B/ N_\text{c}$ \\
 \hline
 Length of an \ac{ofdm} symbol & $T = 1 / \Delta f$ \\
 \hline
 Length of the cyclic prefix  & $T_\text{cp}$ \\
 \hline
 Number of \ac{ofdm} symbols & $N_\text{sym}$ \\
 \hline
  Number of Rx antennas &  $N_\text{Rx}$ \\
 \hline
 Number of Tx antennas &  $N_\text{Tx}$ \\
 \hline
\end{tabular}
\end{table}

Fig.~\ref{fig:SISO_processing_steps} visualizes the principle \ac{siso} \ac{ofdm} radar signal processing chain. In this figure, matrix $\m{S} \in \mathbb{C}^{N_\text{c} \times N_\text{sym}}$ contains the complex-valued amplitudes for all $N_\text{c}$ subcarriers and for all $N_\text{sym}$ \ac{ofdm} symbols. The elements of $\m{S}$ are referred to as subcarrier symbols.
% in the following, whereas specific realizations of these symbols in form of, e.g., data symbols or pilot symbols are discussed later in this work. 
The \ac{ofdm} symbols are transformed into time domain, extended by a \ac{cp} to avoid \ac{isi} \cite{Van_Nee_OFDM}, and radiated by the Tx antenna. 
%The analog front-end, the ac{adc}, and the parallel-to-serial conversion are not shown in in Fig.~\ref{fig:SISO_processing_steps} for the sake of brevity.
 
 The receiver senses signals reflected from objects and feeds them into the radar receiver signal processing chain, which consists of the following steps:
 \begin{enumerate}
 \item Removing the \ac{cp}.
 \item Applying a \ac{dft} to obtain the received frequency domain \ac{ofdm} symbols.
 \item Performing an element-wise division by the transmitted subcarrier symbols in $\m{S}$.
 \item Applying the so-called range \ac{idft} unveils the range information.
 \item Finally, the \ac{rvm} of size $N_\text{c} \times N_\text{sym}$ is obtained after the so-called Doppler \ac{dft}.
 \end{enumerate}
With $c_0$ denoting the speed of light, the final \ac{rvm} is determined by the values
\cite{Sturm_A_novel_approach, Lang_RDM_JP, Lang_Asilomar_2020}
\begin{align}
 \Delta r &= \frac{ c_0 }{2 B}    & \Delta v &= \frac{ c_0 }{2 f_\text{c} N_\text{sym} \left(T + T_{\text{cp}} \right)}   \label{equ:OFDM_001} \\
 r_\text{max} &= \Delta r  N_\text{c}   & v_\text{max} &= \pm \Delta v \frac{N_\text{sym}}{2}.  \label{equ:OFDM_004}
\end{align}
% and provides a processing gain of $G_\text{p} = N_\text{sym} N_\text{c}$.



\subsection{MIMO Signal Model}

This section briefly recaps the complex baseband representation of the \ac{mimo} signal model from \cite{Lang_RDM_JP} since it is essential for deriving the \ac{ddm} method. A detailed derivation can be found in \cite{Lang_RDM_JP}, which itself is based on a \ac{siso} signal model derived in \cite{Hakobyan_Inter_Carrier_Interference}. The derivation of the signal model considers only a single Rx antenna, while a possible extension to multiple Rx antennas can be easily adapted. At first, some definitions and assumptions are introduced. 


%Let
%\begin{equation}
%	\ve{d}_N(f) = \begin{bmatrix}
%	1 &  \text{e}^{\text{j} 2 \pi f} &  \hdots & \text{e}^{\text{j} 2 \pi f(N-1)}
%\end{bmatrix}^T \in \mathbb{C}^{N},
%\end{equation}
%denote a column vector whose elements form a complex-valued oscillation, and let $\m{D}_N(f) = \text{diag}\left( \ve{d}_N(f) \right)$.
%The frequency domain representation of the oscillation in $\ve{d}_N(f)$ is obtained $\m{F}_N \ve{d}_N(f)$. 
%This transformation can be extended to a windowed \ac{dft}. Let $\ve{w}_N \in \mathbb{R}^N$ be a vector containing the window function of length $N$, and let its $i$th element be denoted as $w_N[i]$. Furthermore, let $\m{W}_N = \text{diag}(\ve{w}_N) \in \mathbb{R}^{N \times N}$ be a diagonal matrix with the window function on its main diagonal. The windowed \ac{dft} applied on $\ve{d}_N(f)$ is given as \cite{Hakobyan_Inter_Carrier_Interference}
%\rem{ \begin{align}
%	&\ve{u}_N(f) ={} \m{F}_N \m{W}_N \ve{d}_N(f) \\
%	 &={}  \begin{bmatrix}
%	\sum_{n=0}^{N-1} w_N[n] \text{e}^{\text{j} 2 \pi (f - \frac{0}{N})n} \\
%	\vdots  \\
%	 \sum_{n=0}^{N-1} w_N[n] \text{e}^{\text{j} 2 \pi (f - \frac{N-1}{N})n}
%\end{bmatrix} \in \mathbb{C}^{N}.		\label{equ:MIMO_OFDM_008}
%\end{align} }
%\begin{align}
%	\ve{u}_N(f) ={}& \m{F}_N \m{W}_N \ve{d}_N(f)  \in \mathbb{C}^{N}.		\label{equ:MIMO_OFDM_008}
%\end{align} 

%We assume $N_\text{Tx}$ Tx antennas indexed with $k = 0, \hdots N_\text{Tx}-1$. 
Let the matrices $\m{S}_k \in \mathbb{C}^{N_\text{c} \times N_\text{sym}}$ with $k=0, 1, \hdots , N_\text{Tx}-1$ contain the transmit subcarrier symbols for all Tx antennas. Each column of $\m{S}_k$ represents one frequency domain \ac{ofdm} symbol. The transmit signals in complex baseband can be derived by transforming these \ac{ofdm} symbols into time domain and extending them with a \ac{cp}.


%Then, the transmit time domain \ac{ofdm} symbols at the $k$th Tx antenna are given by
%\begin{align}
%	\m{V}_{\text{tf,ts},k} &={} \m{F}_{N_\text{c}}^{-1} \m{S}_k \in \mathbb{C}^{N_\text{c} \times N_\text{sym}},\label{equ:MIMO_OFDM_011bbbb}
%\end{align}
%where 'tf' and 'ts' indicate the fast time and the slow time over the first and second matrix dimension, respectively. Each column of $\m{V}_{\text{tf,ts},k}$ represents one time domain \ac{ofdm} symbol. The transmit signals can be derived by extending $\m{V}_{\text{tf,ts},k}$ in  \eqref{equ:MIMO_OFDM_011bbbb} with a \ac{cp}.



The channel between transmitter and receiver assumes $N_{\text{path}}$ propagation paths between each of the $N_\text{Tx}$ Tx antennas and the Rx antenna with $r_{i,k}$ denoting the propagation distance for the $k$th Tx antenna along the $i$th path. $\tau_{i,k} = 2 r_{i,k} / c_0 $ is the corresponding round-trip delay time and can be normalized to $\bar{\tau}_{i,k} = \tau_{i,k} \Delta f$. $a_i\in \mathbb{C}$ models assumed constant amplitude and phase changes during propagation along the $i$th path \cite{Hakobyan_Inter_Carrier_Interference}. 

 At the receiver, the time domain \ac{adc} samples are stored in a matrix $\m{Y}_{\text{tf,ts}} \in \mathbb{C}^{N_\text{c} \times N_\text{sym}}$, where every column corresponds to a received \ac{ofdm} symbol in time domain and without the \ac{cp}. This matrix $\m{Y}_{\text{tf,ts}}$ is given by \cite{Lang_RDM_JP}
\begin{align}
	\m{Y}_{\text{tf,ts}} &={} \sum_{k=0}^{N_\text{Tx}-1} \sum_{i=0}^{N_\text{path}-1} \bar{a}_{i,k} \m{D}_{N_\text{c}}\left( \frac{ \bar{f}_{\text{D}_i}}{N_\text{c}} \right) \m{F}_{N_\text{c}}^{-1} \m{D}_{N_\text{c}}^*(\bar{\tau}_{i,k}) \nonumber \\
	& \hspace{4mm} \cdot \m{S}_k \m{D}_{N_\text{sym}}( \bar{f}_{\text{D}_i} \alpha ).\label{equ:MIMO_OFDM_011_2}
\end{align}
where additive measurement noise is neglected, and where 'tf' and 'ts' indicate the fast time and the slow time over the vertical and horizontal matrix dimension, respectively. Additionally, we used $\bar{a}_{i,k}  = a_i \, \text{exp}(-\text{j} 2 \pi f_\text{c} \tau_{i,k})\in \mathbb{C}$ and $\alpha = (T + T_\text{cp})/T \in \mathbb{R}$. 
The Doppler shift along the $i$th path caused by a relative velocity $v_i$ is defined as $f_{\text{D}_{i}} = -2 v_i f_\text{c} / c_0$, and it is normalized to $\bar{f}_{\text{D}_i} = f_{\text{D}_i} / \Delta f$.
The implications of the Doppler shift are considered in form of a \ac{cpe} and \ac{ici}  affecting the received \ac{ofdm} symbols. The \ac{cpe} and \ac{ici} are represented in \eqref{equ:MIMO_OFDM_011_2} in form of $\m{D}_{N_\text{sym}}( \bar{f}_{\text{D}_i} \alpha )$ and $\m{D}_{N_\text{c}}\left( \frac{ \bar{f}_{\text{D}_i}}{N_\text{c}} \right)$, respectively. 



For reasons of compactness of the subsequent mathematical derivations, we approximate the \ac{ici} term as $\m{D}_{N_\text{c}}\left( \frac{ \bar{f}_{\text{D}_i}}{N_\text{c}} \right) \approx \m{I}^{N_\text{c}}$, which is valid for moderate $v_i$ and sufficiently large $\Delta f$, leading to
\begin{align}
	\m{Y}_{\text{tf,ts}} &={} \sum_{k=0}^{N_\text{Tx}-1} \sum_{i=0}^{N_\text{path}-1} \bar{a}_{i,k} \m{F}_{N_\text{c}}^{-1} \m{D}_{N_\text{c}}^*(\bar{\tau}_{i,k})\m{S}_k \m{D}_{N_\text{sym}}( \bar{f}_{\text{D}_i} \alpha ).\label{equ:MIMO_OFDM_011}
\end{align}
However, \ac{ici} as well as additive measurement noise are fully considered for all simulations in this work unless clearly stated otherwise. 




%As stated in \cite{Hakobyan_Inter_Carrier_Interference}, the standard \ac{ofdm} radar signal processing ignores \ac{ici}. Thus, it is neglected within the mathematical derivations in this work as well to avoid a unnecessary complication. However, \ac{ici} is included in all simulations. 




In case several Rx antennas are considered, a similar matrix as in \eqref{equ:MIMO_OFDM_011} can be constructed for every Rx antenna with appropriately modified parameters $\bar{a}_{i,k}$ and $\bar{\tau}_{i,k}$ \cite{Lang_RDM_JP}. 

%\rem{In the following, we provide an interpretation and explanation of the signal model in \eqref{equ:MIMO_OFDM_011}. The frequency domain \ac{ofdm} symbol represented by the columns in $\m{S}_k$ are transformed into time domain via the \ac{idft} matrix $\m{F}_{N_\text{c}}^{-1}$. The frequency-dependent phase rotations caused by the round-trip delay times are considered via $\bar{a}_{i,k}$ for the carrier frequency and via $\m{D}_{N_\text{c}}^*(\bar{\tau}_{i,k})$ for every subcarrier in frequency domain. The \ac{ici} and the \ac{cpe} are considered by $\m{D}_{N_\text{c}}\left( \frac{ \bar{f}_{\text{D}_i}}{N_\text{c}} \right)$ and $\m{D}_{N_\text{sym}}( \bar{f}_{\text{D}_i} \alpha )$, respectively. While the \ac{ici} term is neglected within the following derivation of the proposed \ac{ddm} technique for the sake of simplicity, it is included in all simulations.  }










\section{Doppler-Division Multiplexing} \label{sec:Proposed_MIMO}

%\ac{ofdm} radar systems often feature a by far too large value for $v_\text{max}$ (see Tab.~\ref{Tab:Overview_max_vals}). Thus, large areas in the \ac{rvm} will be free of objects. \ac{ddm} exploits these empty areas by filling them with signal components transmitted by different Tx antennas\footnote{In case both, $v_\text{max}$  and $r_\text{max}$, are larger than required for the application at hand, one could think of a combination of \ac{ddm} and \ac{rdm}  \cite{Lang_RDM_JP}.}. 

The key aspect of \ac{ddm} is a modification of the individual transmit signals for every Tx antenna such that the corresponding receive signals are shifted along the velocity axis in the \ac{rvm}. These modified transmit signals as well as the resulting \ac{rvm} are derived in the following.
%, followed by a discussion of some aspects of \ac{ddm}.

%This multiplexing technique has several beneficial properties. First of all, by far too large values for $v_\text{max}$ are avoided by filling the empty regions with signals coming from different Tx antennas. Second, it will turn out that, in contrast to \ac{esi}, all subcarriers are active for all Tx antennas and for all \ac{ofdm} symbols. This fact avoids the loss in processing gain inherited by \ac{esi}. 

\input{./fig/Fig_DDM_Transmitter}


The derivation begins with the \ac{mimo} signal model in \eqref{equ:MIMO_OFDM_011}. A shift along the velocity axis in the \ac{rvm} is implemented by applying a phase shift from \ac{ofdm} symbol to \ac{ofdm} symbol. This phase shift is denoted as $\Delta \psi_k$ for $0 \leq k < N_\text{Tx}$. For instance, the first \ac{ofdm} symbol of the $k$th Tx antenna remains unchanged, while the follow-up \ac{ofdm} symbols are rotated in phase by $\Delta \psi_k$, $2\Delta \psi_k$, and so on.

Applying this phase shift in the transmitter is achieved by choosing $\m{S}_k$ in \eqref{equ:MIMO_OFDM_011} to be
\begin{align}
	\m{S}_k = \m{S}  \m{D}_{N_\text{sym}} \left( \frac{\Delta \psi_k}{2 \pi} \right), \label{equ:MIMO_OFDM_010}
\end{align}
cf. Fig.~\ref{fig:DDM_Transmitter}. Note that $\m{S}$, and thus the payload, is the same for all Tx antennas. Only the modulation by $\m{D}_{N_\text{sym}} \left( \frac{\Delta \psi_k}{2 \pi} \right)$ makes them distinguishable among each other. 

The time domain \ac{ofdm} symbols at the $k$th Tx antenna in complex baseband are obtained by transforming the \ac{ofdm} symbols in \eqref{equ:MIMO_OFDM_010} into time domain and extending them by a \ac{cp}.

%inserting \eqref{equ:MIMO_OFDM_010} into \eqref{equ:MIMO_OFDM_011bbbb}, yielding
%\begin{align}
%	\m{V}_{\text{tf,ts},k} &={} \m{F}_{N_\text{c}}^{-1} \m{S}  \m{D}_{N_\text{sym}} \left( \frac{\Delta \psi_k}{2 \pi} \right).\label{equ:MIMO_OFDM_011bbbb9}
%\end{align} 
%This expression is schematically visualized in Fig.~\ref{fig:DDM_Transmitter}, which also considers the \ac{cp} and the Tx antennas.

The receive signal in complex baseband representation and after removing the \ac{cp} is transformed into frequency domain by applying the \ac{dft} on the columns of $\m{Y}_{\text{tf,ts}}$, yielding
\begin{align}
	& \m{Y}_{\text{f,ts}} ={}  \m{F}_{N_\text{c}} \m{Y}_{\text{tf,ts}} \\
	&={} \sum_{k=0}^{N_\text{Tx}-1} \sum_{i=0}^{N_\text{path}-1} \bar{a}_{i,k} \m{D}_{N_\text{c}}^*(\bar{\tau}_{i,k})  \m{S} \m{D}_{N_\text{sym}} \left( \frac{\Delta \psi_k}{2 \pi} + \bar{f}_{\text{D}_i} \alpha \right). \label{equ:MIMO_OFDM_012}
\end{align}
The subscript 'f' indicates that the columns of $\m{Y}_{\text{f,ts}}$ represent the frequency domain \cite{Hakobyan_Inter_Carrier_Interference}. The second step is the Hadamard (element-wise) division with $\m{S}$, yielding  \cite{Lang_RDM_JP}
\begin{align}
	&\m{Z}_{\text{f,ts}} ={}  \m{Y}_{\text{f,ts}} \oslash \m{S} \\
	&={} \sum_{k=0}^{N_\text{Tx}-1} \sum_{i=0}^{N_\text{path}-1} \bar{a}_{i,k} \m{D}_{N_\text{c}}^*(\bar{\tau}_{i,k}) \ve{1}^{N_\text{c}} (\ve{1}^{N_\text{sym}})^T  \nonumber \\
	& \hspace{4mm} \cdot  \m{D}_{N_\text{sym}} \left( \frac{\Delta \psi_k}{2 \pi} + \bar{f}_{\text{D}_i} \alpha \right) \\
	&={} \sum_{k=0}^{N_\text{Tx}-1} \sum_{i=0}^{N_\text{path}-1} \bar{a}_{i,k} \ve{d}_{N_\text{c}}^*(\bar{\tau}_{i,k})  \ve{d}_{N_\text{sym}}^T \left( \frac{\Delta \psi_k}{2 \pi} + \bar{f}_{\text{D}_i} \alpha \right). \label{equ:MIMO_OFDM_013}
\end{align}
%Here, we made use of the identity $(\m{D}_a \m{M} \m{D}_b ) \oslash \m{M} = \m{D}_a \ve{1}^n (\ve{1}^m)^T \m{D}_b$, which holds for arbitrary matrices $\m{M} \in \mathbb{C}^{n \times m}$ with non-zero elements, and for arbitrary diagonal matrices $\m{D}_a \in \mathbb{C}^{n \times n}$ and $\m{D}_b  \in \mathbb{C}^{m \times m}$ \cite{Lang_RDM_JP}. 

%Next, a short discussion about the expression in  \eqref{equ:MIMO_OFDM_013} is provided. The column vectors $\ve{d}_{N_\text{c}}^*(\bar{\tau}_{i,k})$ contain complex-valued oscillations. The frequencies of these oscillations depend solely on the round-trip delay times $\bar{\tau}_{i,k}$. The row vectors $\ve{d}_{N_\text{sym}}^T \left( \frac{\Delta \psi_k}{2 \pi} + \bar{f}_{\text{D}_i} \alpha \right)$ contain complex-valued oscillations too. The frequencies of them are determined by the normalized Doppler shift $\bar{f}_{\text{D}_i}$ as well as the artificial Doppler shift $\Delta \psi_k$. The matrix $\m{Z}_{\text{f,ts}}$ contains $N_\text{Tx}$ expressions of $\ve{d}_{N_\text{sym}}^T \left( \frac{\Delta \psi_k}{2 \pi} + \bar{f}_{\text{D}_i} \alpha \right)$ for every path $i$. Due to the dependency on $\Delta \psi_k$ these expressions will appear at different velocities, as it will be shown shortly. 

The third step is applying the windowed range \ac{idft} on the columns of $\m{Z}_{\text{f,ts}}$ according to \cite{Hakobyan_Inter_Carrier_Interference}
\begin{align}
	&\m{Z}_{\text{r,ts}} ={} \m{F}_{N_\text{c}}^{-1} \m{W}_{N_\text{c}} \m{Z}_{\text{f,ts}} \\
	&={} \sum_{k=0}^{N_\text{Tx}-1} \sum_{i=0}^{N_\text{path}-1} \bar{a}_{i,k} \ve{u}_{N_\text{c}}^*(\bar{\tau}_{i,k})  \ve{d}_{N_\text{sym}}^T \left( \frac{\Delta \psi_k}{2 \pi} + \bar{f}_{\text{D}_i} \alpha \right). \label{equ:MIMO_OFDM_014}
\end{align}
The fourth processing step is applying the windowed Doppler \ac{dft} on the rows of $\m{Z}_{\text{r,ts}}$, which yields
\begin{align}
	&\m{Z}_{\text{r,v}} ={} \m{Z}_{\text{r,ts}} \m{W}_{N_\text{sym}} \m{F}_{N_\text{sym}} \\
	&={}\sum_{k=0}^{N_\text{Tx}-1} \sum_{i=0}^{N_\text{path}-1} \bar{a}_{i,k} \ve{u}_{N_\text{c}}^*(\bar{\tau}_{i,k}) \ve{u}_{N_\text{sym}}^T \left( \frac{\Delta \psi_k}{2 \pi} + \bar{f}_{\text{D}_i} \alpha \right).\label{equ:MIMO_OFDM_015}
\end{align}
This result represents the final \ac{rvm} containing $N_\text{Tx}$ peaks for every path $i$. These peaks are located at the same range but at different velocities.
%An optional \ac{dft} shift applied on the rows of $\m{Z}_{\text{r,v}}$ shifts the column representing zero relative velocity into the center of the \ac{rvm}. Doing so yields the final \ac{rvm} containing $N_\text{Tx}$ peaks for every path $i$ located at the same range but at different velocities. 
%These peaks are usually accompanied by side lobes.


\section{Discussion of DDM in Context of Radar Sensing} \label{sec.Properties_DDM}

%The following discussions clarify some properties of \ac{ddm} \ac{wrt} radar sensing.

\subsection{Choice of $\Delta \psi_k$} \label{sec.Choice_of_phi}
The shift of the signal components along the velocity axis is determined by $\Delta \psi_k$. It is recommended to choose $\Delta \psi_k=2 \pi \frac{p}{N_\text{sym}}$ for any $p \in \mathbb{Z}$, which circularly shifts the corresponding signal components by $p$ velocity bins without changing the magnitude or phase values. This statement can be proven by a straightforward modification of a related proof in \cite[Appendix A]{Lang_RDM_JP}. Since no distortions of the magnitude or phase values are induced, a utilization of the them for \ac{dbf} \cite{saponara2017radar, patole2017automotive, Gerstmair1ADAS} is easily possible. 

Furthermore, for $N_\text{Tx} = 4$, it is easy to prove that the choice $\Delta \psi_k = \{ -\frac{3 \pi}{4}, -\frac{1 \pi}{4}, \frac{1 \pi}{4}, \frac{3 \pi}{4}\}$  separates the \ac{rvm} in 4 equally sized areas, as sketched in Fig.~\ref{fig_DDM_DDM}, in which the bin representing zero relative velocity is located at the center of each area. Thus, it will be the primary choice for $\Delta \psi_k$ in this work. 

We note that employing a \ac{dft} precoding matrix of size $N_\text{Tx} \times N_\text{Tx}$ as utilized in \cite{suh2021time} may produce the same phase shift values as used in this work, however, it offers less freedom in choosing the shift along the velocity axis. 


\subsection{Maximum Unambiguous Range and Velocity}
\ac{ddm} provides the same unambiguous range $r_\text{max}$ as for a \ac{siso} \ac{ofdm} radar system in \eqref{equ:OFDM_004}. However, when dividing the velocity axis into $N_\text{Tx}$ equally sized areas as discussed in Sec.~\ref{sec.Choice_of_phi}, the maximum unambiguous velocity $v_\text{max}$ is decreased for \ac{ddm} by a factor of $N_\text{Tx}$ compared to the  \ac{siso} case (cf. Fig.~\ref{fig_DDM_DDM}). As a consequence, the number of Tx antennas supported by \ac{ddm} without further measures can be increased as long as no object violates the reduced maximum unambiguous velocity.


\subsection{Beampattern}
The beampattern is an important performance criterion for phased arrays and specifies the average signal power transmitted towards a certain direction. 
%The beampattern can be manipulated by applying a phase shift from Tx antenna to Tx antenna. A similar phase shift is applied for \ac{ddm} except for the phase shift being time-dependent in this case. However, 
Simulations confirmed that the beampattern for \ac{ddm} is almost uniform for practical values of $N_\text{sym}$. 
%Simulations not shown in this work show that this phase shift has no influence on the beampattern for reasonable values of $N_\text{c}$ and the Tx antenna spacing. Hence, the beampattern observed for \ac{rdm} is approximately uniform. 


\subsection{Computational Complexity}

The computational complexity required for adding the phase shift from \ac{ofdm} symbol to \ac{ofdm} symbol  depends on $\Delta \psi_k$. In the worst case, $N_\text{c} N_\text{sym}$  phase rotations are required to apply the phase shift on every subcarrier in every \ac{ofdm} symbol. For the special choice of $\Delta \psi_k = \{ -\frac{3 \pi}{4}, -\frac{1 \pi}{4}, \frac{1 \pi}{4}, \frac{3 \pi}{4}\} $, the phase shifts are multiples of $\frac{\pi}{4}$ and thus computational complexity may be much lower. More specifically, if the symbol alphabet is symmetric with respect to rotations of $\frac{\pi}{4}$, applying $\Delta \psi_k$ can simply be implemented by modifying the so-called mapper with a time-dependent mapping function. For symbol alphabets without this symmetry, an extension of the alphabet might be considered. 
%For example, extending the \ac{qpsk} symbol alphabet $\frac{1}{\sqrt{2}} \{ 1+j, \hspace{1mm}1-j, \hspace{1mm}-1+j, \hspace{1mm}-1-j, \hspace{1mm}  \}$ by the new symbols $\{ 1, \hspace{1mm} -1, \hspace{1mm} j, \hspace{1mm} -j  \}$ generates the mentioned symmetry. Hence, the computational complexity for implementing \ac{ddm} with the discussed choice for $\Delta \psi_k$ and \ac{qpsk} symbols can be considered to be small.


%\subsection{Comparison to competitive multiplexing techniques}

\subsection{Comparison with ESI} 

\ac{esi} has the following similarities and differences compared to \ac{ddm}. 

\emph{Processing gain}: Since \ac{ddm} activates every subcarrier on all Tx antennas, the processing gain follows as $G_\text{p} = N_\text{sym} N_\text{c}$. In contrast to that, \ac{esi} activates only every $N_\text{Tx}$th subcarrier per Tx antenna, leading to a reduced processing gain of $G_\text{p} = N_\text{sym} N_\text{c} / N_\text{Tx}$. 

\emph{Average power per active subcarrier}: Let \ac{esi} and \ac{ddm} have the same average transmit power in order to provide a fair comparison. Then, as a consequence of the fewer activated subcarriers for \ac{esi}, the average power per active subcarrier is $N_\text{Tx}$ times larger for \ac{esi} compared to \ac{ddm}. 

\emph{SNR in the RDM}: Due to the same argumentation as provided in \cite{Lang_RDM_JP}, the reduced power per active subcarrier and the increased processing gain cancel each other out. This results in approximately the same \ac{snr} in the \ac{rvm}, and as a direct consequence, also the same \ac{snr} at the output of the \ac{dbf}, for \ac{ddm} as for \ac{esi}. 
%As a consequence, also the \ac{snr} at the output of the \ac{dbf} is the same for both multiplexing methods. %Simulations carried out in the follow-up section confirm this statement.


\emph{Maximum unambiguous range and velocity}: 
%Another significant difference is given for maximum unambiguous range $r_\text{max}$ and the maximum unambiguous velocity $v_\text{max}$. 
As a consequence of the reduced number of active subcarriers per Tx antenna, \ac{esi} reduces $r_\text{max}$ by a factor of $N_\text{Tx}$ compared to a \ac{siso} \ac{ofdm} system. In contrast to that, \ac{ddm} offers the same $r_\text{max}$ as a \ac{siso} \ac{ofdm} system, but it reduces the unambiguous maximum velocity $v_\text{max}$ by a factor of $N_\text{Tx}$.
% due to dividing the velocity axis into $N_\text{Tx}$ areas. % cf. Fig.~\ref{fig_DDM_DDM}.


%\ac{esi} reduces $r_\text{max}$ by a factor of $N_\text{Tx}$ compared to a \ac{siso} \ac{ofdm} radar system, while \ac{ddm} does not alter $r_\text{max}$. 

%\ac{ddm} reduces $v_\text{max}$ by a factor of $N_\text{Tx}$ compared to \ac{siso} \ac{ofdm} radar systems due to the separation of the velocity axis into $N_\text{Tx}$ areas (cf. Fig.~\ref{fig_DDM_DDM}). In contrast to that, \ac{esi} leaves $v_\text{max}$ unaltered. 

\subsection{Comparison with RDMult}

\ac{rdm} in \cite{Lang_RDM_JP} shifts signal components along the range axis, and thus, reduces $r_\text{max}$ by a factor of $N_\text{Tx}$ compared to the \ac{siso} case. \ac{ddm} shifts signal components along the velocity axis in the \ac{rvm}, which entails a reduction of $v_\text{max}$ by a factor of $N_\text{Tx}$ compared the \ac{siso} case. Despite this difference, both multiplexing methods feature the same average power per active subcarrier, the same processing gain, and the same \ac{snr} in the \ac{rvm}.


% the same processing gain and the same average power per active subcarrier. Moreover, \ac{rdm} has approximately the same \ac{snr} in the \ac{rvm} as \ac{ddm} and thus also as \ac{esi}.


%\section{Radar Simulation Results} \label{sec:Sim_Results}
%
%This section presents simulation results and an \ac{snr} analysis for the task of radar sensing.
%
%\subsection{RDM Simulation}
%
%In the following, a conceptual comparison of the \acp{rvm} generated by a \ac{mimo} \ac{ofdm} radar system utilizing \ac{ddm} and generated by a \ac{siso} \ac{ofdm} radar system is presented. Both systems have the same parameter settings shown in Tab.~\ref{Tab:com_sys_paramters} except for $N_\text{Tx}=1$ in case of the \ac{siso} \ac{ofdm} system. \new{It is clear that the \ac{rvm} obtained for a \ac{mimo} \ac{ofdm} radar system using \ac{esi} would yield the same \ac{rvm} as observed for the \ac{siso} case except $r_\text{max}$ would be reduced.} Fig.~\ref {fig_sim} confirms that the  \ac{rvm} for the \ac{siso} \ac{ofdm} radar system is mostly empty, while the \ac{rvm} of  the \ac{mimo} \ac{ofdm} radar system utilizing \ac{ddm} contains $N_\text{Tx}=4$ replicas of the detected objects along the velocity axis.
%
%
%\begin{table}[!t]
%% increase table row spacing, adjust to taste
%\renewcommand{\arraystretch}{1.3}
%\caption{System parameters.}
%\label{Tab:com_sys_paramters}
%\centering
%% Some packages, such as MDW tools, offer better commands for making tables
%% than the plain LaTeX2e tabular which is used here.
%\begin{tabular}{|l|r|}
%\hline
% Parameter & Value  \\
% \hline \hline
% Bandwidth $B$ & $1\, \text{GHz}$ \\
% \hline
% Carrier frequency $f_\text{c}$ & $77 \, \text{GHz}$ \\
% \hline
% \ac{adc} sampling time $T_s$  &  $1\, \text{ns}$ \\
% \hline
% Number of subcarriers $N_\text{c}$ & $1024$ \\
% \hline
% Number of \ac{ofdm} symbols $N_\text{sym}$ & $512$ \\
% \hline
% Length of the cyclic prefix $T_\text{cp}$ & $1\, \mu \text{s}$ \\
% \hline
% Number of Tx antennas $N_\text{Tx}$ & $4$ \\
% \hline
% Number of Rx antennas $N_\text{Rx}$ & $1$ \\
% \hline
% Phase shift $\Delta \psi_k$ &  $\{ \frac{1 \pi}{4}, \frac{3 \pi}{4}, \frac{5 \pi}{4}, \frac{7 \pi}{4}\}$ \\
% \hline
%\end{tabular}
%\end{table}
%
%
%%\begin{figure}[!t]
%%\centering
%%\subfloat[]{\includegraphics[width = 3in]{Fig_DDM_SISO.png}}\hspace{1em}%
%%\subfloat[]{\includegraphics[width = 3in]{Fig_DDM.png}}
%%\caption{Simulation results for a SISO OFDM radar system (a) and for a MIMO OFDM radar system utilizing DDM (b). An additional DFT shift has been applied for the SISO OFDM radar system to shift the column representing zero relative velocity into the center of the RDM. The sizes of the objects have been artificially increased to improve their visibility.}
%%\label{fig_sim}
%%\end{figure}
%
%\begin{figure}[!t]
%\centering
%\includegraphics[width = 3in]{Fig_DDM.png}
%\caption{Simulation results for a MIMO OFDM radar system utilizing DDM. The sizes of the objects have been artificially increased to improve their visibility.}
%\label{fig_sim}
%\end{figure}
%
%\subsection{Beamforming Simulations}
%
%\new{
%Next, the focus lies on the object at a distance of $10\, \text{m}$ and at a relative velocity of $0\, \text{m/s}$ in Fig.~\ref {fig_sim}. For this object, the angular information is extracted by applying the \ac{fft} \ac{dbf} \cite{van2004optimum, FMCW_Radar_FFT_BF, FMCW_Beamforming}. The output of the \ac{dbf} is shown in Fig.~\ref{fig:beamformer_output} for a \ac{mimo} \ac{ofdm} radar system employing \ac{rdm}, and a \ac{mimo} \ac{ofdm} radar system using \ac{esi}. For the latter one, we applied the phase correction procedure suggested in \cite{OFDM_ESI_phase_correction} to account for the different subcarrier frequencies used by the different Tx antennas. In addition, both \ac{dbf} outputs were normalized such that the maximum value is at $0\, \text{db}$. Fig.~\ref{fig:beamformer_output} shows that the beam widths as well as the noise levels of both systems are similar.  
%}
%
%
%\subsection{SNR Simulations}
%
%\new{
%The next simulations focus on the influence of \ac{ici} on the \ac{snr}. Again, the object at a distance of $10 \, \text{m}$ serves as a reference object. The relative velocity of the reference object was varied to attain a desired value of the normalized Dopper frequency $\bar{f}_{\text{D}_i}$ according to \eqref{equ:MIMO_OFDM_002NormDopp}. Then, the \ac{snr} values were evaluated for the \ac{rvm} and for the output of the \ac{fft} \ac{dbf}. These \ac{snr} values were calculated by subtracting the median signal power of the entire \ac{rvm}/the entire \ac{dbf} output, from the signal power of the reference object. Fig.~\ref{fig:SNR_RDMult_ESI} presents the resulting \ac{snr} values for \ac{rdm} and for \ac{esi} as a function of $\bar{f}_{\text{D}_i}$. It reveals that the \ac{snr} performances of both multiplexing techniques are very similar.
%}
%\new{
%\input{./fig/Fig_beamformer_output}
%\input{./fig/Fig_SNR_DDM_ESI}
%}

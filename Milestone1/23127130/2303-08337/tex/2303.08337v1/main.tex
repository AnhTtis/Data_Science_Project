%% 
%% Copyright 2007-2020 Elsevier Ltd
%% 
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%% 

%% Template article for Elsevier's document class `elsarticle'
%% with numbered style bibliographic references
%% SP 2008/03/01
%%
%% 
%%
%% $Id: elsarticle-template-num.tex 190 2020-11-23 11:12:32Z rishi $
%%
%%
\documentclass[preprint,11pt]{elsarticle}

\usepackage[letterpaper, margin=1.in]{geometry}
\usepackage{amsmath,amsthm,amsbsy,amsfonts,amssymb}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{mathtools}
\usepackage{subfiles}
\usepackage{blindtext}
\usepackage{tikz-cd}

\usepackage{hyperref}
\hypersetup{bookmarks=true,colorlinks=true, linkcolor=blue,urlcolor=red,linktoc=all}
\usepackage{listings}

\usepackage{tcolorbox}
\usepackage{blkarray}
\usepackage{multirow}
\usepackage{numprint}
\usepackage[]{algorithm2e}
\usepackage{stmaryrd}
\usepackage{comment}
\usepackage{siunitx}

\newcommand{\vect}[1]{\textbf{#1}}
\newcommand{\lagrL}{\mathcal{L}}
\newcommand{\hamilH}{\mathcal{H}}
\newcommand{\manM}{\mathcal{M}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\pde}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}} 
\newcommand{\vA}{\vect{A}}
\newcommand{\vB}{\vect{B}}
\newcommand{\vvsp}{\vspace{.5 cm}}
\newcommand{\rhp}{\rho_\perp}
\newcommand{\rhpa}{\rho_\parallel}
\newcommand{\ddt}[1]{\frac{d #1}{dt}}
\newcommand{\Pz}{P_\zeta}
\newcommand{\Pt}{P_\theta}
\newcommand{\Pzz}{P_z}
\newcommand{\dd}[2]{\frac{\delta #1}{\delta #2}}

\usepackage[utf8x]{inputenc}
\usepackage{amsmath}
\usepackage{bbm}
\usepackage{comment}
\usepackage{color}
\usepackage{graphicx}
\graphicspath{{figs/}}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{bm}
\usepackage{cancel}

\usepackage{pgfplots}
\usepackage{pgfplotstable}
\usepackage{filecontents}
\pgfplotsset{compat=1.12}

\usetikzlibrary{shapes,arrows}
\newcommand{\QT}[1]{{\textcolor{red}{\footnotesize\sf[QT: #1]}}}
\newcommand{\ZJ}[1]{{\textcolor{blue}{\footnotesize\sf[ZJ: #1]}}}
\newcommand{\KL}[1]{{\textcolor{green}{\footnotesize\sf~[KL: #1]}}}
\newcommand{\XT}[1]{{\textcolor{purple}{\footnotesize\sf[XT: #1]}}}

\def\A{\mathbf{A}}
\def\bn{\mathbf{n}}
\def\bx{\mathbf{x}}
\def\btau{\boldsymbol{\tau}}

\def\b{\mathbf b}
\def\u{\mathbf u}
\def\v{\mathbf v}
\def\V{\mathbf V}
\def\E{\mathbf E}
\def\j{\mathbf j}
\def\B{\mathbf B}
\def\R{\mathbf R}
\def\q{\mathbf q}
\def\Q{\mathbf Q}
\def\I{\mathbf I}
\def\W{\mathbf W}
\def\A{\mathbf A}
\newcommand{\C}{\mathbf{C}}

\def\bB{\mathbf{B}}
\def\bE{\mathbf{E}}
\def\bc{\mathbf{c}}
\def\bv{\mathbf{v}}
\def\bV{\mathbf{V}}

\DeclareMathAlphabet\mathbfcal{OMS}{cmsy}{b}{n}

\newtheorem{prop}{Proposition}
\newtheorem{remark}{Remark}

\usepackage{enumitem}
\usepackage{pifont}
\usepackage{amsthm}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\tikzset{
    cross/.pic = {
    \draw[rotate = 45] (-#1,0) -- (#1,0);
    \draw[rotate = 45] (0,-#1) -- (0, #1);
    }
}
\pgfplotsset{compat=1.16}

%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}

%% For including figures, graphicx.sty has been loaded in
%% elsarticle.cls. If you prefer to use the old commands
%% please give \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
%\usepackage{amssymb}
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
%% \usepackage{lineno}

\begin{document}

\begin{frontmatter}

\title{A mimetic finite difference based quasi-static magnetohydrodynamic solver for force-free plasmas in tokamak disruptions}

\author[inst1]{Zakariae Jorti\fnref{LANLThanks}}

\affiliation[inst1]{organization={Theoretical Division, Los Alamos National Laboratory},%Department and Organization
            %addressline={}, 
            city={Los Alamos},
            postcode={87545}, 
            state={New Mexico},
            country={U.S.A.}}

\author[inst1]{Qi Tang\fnref{LANLThanks}}
\author[inst1]{Konstantin Lipnikov\fnref{LANLThanks}}
\author[inst1]{Xian-Zhu Tang\fnref{LANLThanks}}

\fntext[LANLThanks]{This work was jointly supported by the
  U.S. Department of Energy through the Fusion Theory Program of the
  Office of Fusion Energy Sciences and the SciDAC partnership on
  Tokamak Disruption Simulation between the Office of Fusion Energy
  Sciences and the Office of Advanced Scientific Computing.  
  It was also partially supported by Mathematical Multifaceted Integrated 
  Capability Center (MMICC) of Advanced Scientific Computing Research. Los
  Alamos National Laboratory is operated by Triad National Security,
  LLC, for the National Nuclear Security Administration of
  U.S. Department of Energy (Contract No. 89233218CNA000001).  
  }

\begin{abstract}
  %% Text of abstract
  Force-free plasmas are a good approximation where the plasma
  pressure is tiny compared with the magnetic pressure, which is the
  case during the cold vertical displacement event (VDE) of a major
  disruption in a tokamak.  On time scales long compared with the
  transit time of Alfv\'{e}n waves, the evolution of a force-free
  plasma is most efficiently described by the quasi-static
  magnetohydrodynamic (MHD) model, which ignores the plasma inertia.
  Here we consider a regularized quasi-static MHD model for force-free
  plasmas in tokamak disruptions and propose a mimetic finite
  difference (MFD) algorithm. The full geometry of an ITER-like
  tokamak reactor is treated, with a blanket module region, a vacuum
  vessel region, and the plasma region.  Specifically, we develop a parallel, fully
  implicit, and scalable MFD solver based on PETSc and its DMStag data
  structure for the discretization of the five-field quasi-static
  perpendicular plasma dynamics model on a 3D structured mesh. The MFD
  spatial discretization is coupled with a fully implicit DIRK
  scheme. The algorithm exactly preserves the divergence-free
  condition of the magnetic field under the resistive Ohmâ€™s law. The
  preconditioner employed is a four-level fieldsplit preconditioner,
  which is created by combining separate preconditioners for
  individual fields, that calls multigrid or direct solvers for
  sub-blocks or exact factorization on the separate fields. The
  numerical results confirm the divergence-free constraint is strongly
  satisfied and demonstrate the performance of the fieldsplit
  preconditioner and overall algorithm. The simulation of ITER VDE
  cases over the actual plasma current diffusion time is also
  presented.
\end{abstract}

%%%Research highlights
%\begin{highlights}
%\item A mimetic finite difference solver for a five-field quasi-static magnetohydrodynamic model
%\item Scalable implementation using structured staggered grids and block preconditioning
%\item Simulations of cold vertical displacement events for ITER tokamak
%\end{highlights}

\begin{keyword}
%% keywords here, in the form: keyword \sep keyword
Magnetohydrodynamics \sep Mimetic finite difference \sep Staggered structured grid \sep Fully implicit algorithms \sep JFNK
%\MSC 65N06 \sep 65N22 
\end{keyword}

\end{frontmatter}

\clearpage
\tableofcontents

%% \linenumbers

%% main text
\input texFiles/intro

\input texFiles/MHD_model

\input texFiles/mfd

\input texFiles/solver_prec

\input texFiles/num_results_1
\input texFiles/num_results_2
\input texFiles/num_results_3
\input texFiles/num_results_4
\input texFiles/num_results_5

\input texFiles/conclusions

\section*{Acknowledgement}
We would like to thank the PETSc team for a number of helpful
discussions.  In particular, we thank Patrick Sanan, the primary
developer of DMStag, for many useful discussions.  This research used
resources provided by the Los Alamos National Laboratory Institutional
Computing Program, which is supported by the U.S. Department of Energy
National Nuclear Security Administration under Contract
No.~89233218CNA000001.  This research also used resources of the
National Energy Research Scientific Computing Center, which is
supported by the Office of Science of the U.S. Department of Energy
under Contract No. DE-AC02-05CH11231.


%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
\appendix
\input texFiles/appendix

\bibliographystyle{elsarticle-num} 
\bibliography{cas-refs}

\end{document}
\endinput

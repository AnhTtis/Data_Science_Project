{
%Axis Angles
\tdplotsetmaincoords{70}{100}
%Macros
\pgfmathsetmacro{\rvec}{4}
\pgfmathsetmacro{\phivec}{45}
\pgfmathsetmacro{\zvec}{1}
\pgfmathsetmacro{\drvec}{1}
\pgfmathsetmacro{\dphivec}{20}
\pgfmathsetmacro{\dzvec}{1}
%Layers
\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background, main, foreground}

\begin{figure}[ht]
\centering
\begin{tikzpicture}[tdplot_main_coords, scale=1.5]
%Coordinates
\coordinate (O) at (0,0,0);
%%
\cylindricalcoordinate{\rvec}{\phivec}{\zvec}{A}
\cylindricalcoordinate{\rvec}{\phivec}{(\zvec+\dzvec)}{B}
\cylindricalcoordinate{\rvec}{(\phivec+\dphivec)}{\zvec}{C}
\cylindricalcoordinate{\rvec}{(\phivec+\dphivec)}{(\zvec+\dzvec)}{D}
%%
\cylindricalcoordinate{(\rvec+\drvec)}{\phivec}{\zvec}{A'}
\cylindricalcoordinate{(\rvec+\drvec)}{\phivec}{(\zvec+\dzvec)}{B'}
\cylindricalcoordinate{(\rvec+\drvec)}{(\phivec+\dphivec)}{\zvec}{C'}
\cylindricalcoordinate{(\rvec+\drvec)}{(\phivec+\dphivec)}{(\zvec+\dzvec)}{D'} 

%Axis
\begin{pgfonlayer}{background}
    \draw[thick,-latex] (0,0,0) -- (1.5,0,0) node[pos=1.1]{$x$};
    \draw[thick,-latex] (0,0,0) -- (0,1,0) node[pos=1.05]{$y$};
    \draw[thick,-latex] (0,0,0) -- (0,0,1) node[pos=1.05]{$z$};
\end{pgfonlayer}

%%Lines
\begin{pgfonlayer}{foreground}
    \draw[thick] (A) -- (B) -- (B') -- (A') -- cycle node [midway, below] {$h_R$};
    \draw[thick] (D) -- (D') -- (C') node [midway, right] {$h_Z$};
\end{pgfonlayer}
\begin{pgfonlayer}{background}
    \draw[thick, dashed] (C') -- (C) -- (D);
\end{pgfonlayer}

%%Curved
\begin{pgfonlayer}{background}
    \tdplotdrawarc[thick, dashed]{(0,0,\zvec)}{\rvec} {\phivec}{\phivec+\dphivec}{}{}
\end{pgfonlayer}
\begin{pgfonlayer}{foreground}
    \tdplotdrawarc[thick]{(0,0,\zvec+\dzvec)}{\rvec} {\phivec}{\phivec+\dphivec}{}{}
    \tdplotdrawarc[thick]{(0,0,\zvec+\dzvec)}{\rvec+\drvec} {\phivec}{\phivec+\dphivec}{}{}
    \tdplotdrawarc[thick]{(0,0,\zvec)}{\rvec+\drvec} {\phivec}{\phivec+\dphivec}{below}{$h_\phi$}
\end{pgfonlayer}
\end{tikzpicture}
\caption{A typical computational cell in the configuration space used in the current work.\label{fig:cell3D}} 
\end{figure}
}

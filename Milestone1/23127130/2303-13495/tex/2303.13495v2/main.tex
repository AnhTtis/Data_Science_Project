% \documentclass[acmtog,anonymous,review]{acmart} % submission
\documentclass[acmtog]{acmart} % final version

\usepackage{booktabs} % For formal tables

% TOG prefers author-name bib system with square brackets
\citestyle{acmauthoryear}
%\setcitestyle{nosort,square} % nosort to allow for manual chronological ordering



\usepackage[ruled]{algorithm2e} % For algorithms
\renewcommand{\algorithmcfname}{ALGORITHM}
\SetAlFnt{\small}
\SetAlCapFnt{\small}
\SetAlCapNameFnt{\small}
\SetAlCapHSkip{0pt}

% Metadata Information
\acmJournal{TOG}


%%%%%%%%% Below are added by Ziqi according to ACM License Text emailv%%%%%%%%%

\copyrightyear{2024} 
\acmYear{2024} 
\setcopyright{acmlicensed}\acmConference[SA Conference Papers '24]{SIGGRAPH Asia 2024 Conference Papers}{December 3--6, 2024}{Tokyo, Japan}
\acmBooktitle{SIGGRAPH Asia 2024 Conference Papers (SA Conference Papers '24), December 3--6, 2024, Tokyo, Japan}
\acmDOI{10.1145/3680528.3687658}
\acmISBN{979-8-4007-1131-2/24/12}

%%%%%%%%% Above are added by Ziqi according to ACM License Text emailv%%%%%%%%%

%%%%%%%%% Customized Packages and Commands %%%%%%%%%

% Repeating Terms in this Paper
\newcommand{\RI}{\textit{Relation Inversion}} % use case: \RI{} next word
\newcommand{\R}{$\langle$R$\rangle$} % use case: \R{} next word

% Additional Packages
\usepackage{caption}

% for Xhline
\usepackage{booktabs, siunitx}
\usepackage{multirow, booktabs}
\usepackage{siunitx}
\usepackage{makecell} 

% DDPM formula notations
\usepackage{mathtools}
\newcommand{\vardbtilde}[1]{\tilde{\raisebox{0pt}[0.85\height]{$\tilde{#1}$}}}
\newcommand{\defeq}{\coloneqq}
\newcommand{\grad}{\nabla}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Ea}[1]{\E\left[#1\right]}
\newcommand{\Eb}[2]{\E_{#1}\!\left[#2\right]}
\newcommand{\Vara}[1]{\Var\left[#1\right]}
\newcommand{\Varb}[2]{\Var_{#1}\left[#2\right]}
\newcommand{\kl}[2]{D_{\mathrm{KL}}\!\left(#1 ~ \| ~ #2\right)}
\newcommand{\pdata}{{p_\mathrm{data}}}
\newcommand{\bA}{\mathbf{A}}
\newcommand{\bI}{\mathbf{I}}
\newcommand{\bJ}{\mathbf{J}}
\newcommand{\bH}{\mathbf{H}}
\newcommand{\bL}{\mathbf{L}}
\newcommand{\bM}{\mathbf{M}}
\newcommand{\bQ}{\mathbf{Q}}
\newcommand{\bR}{\mathbf{R}}
\newcommand{\bzero}{\mathbf{0}}
\newcommand{\bone}{\mathbf{1}}
\newcommand{\bb}{\mathbf{b}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\bw}{\mathbf{w}}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\by}{\mathbf{y}}
\newcommand{\bz}{\mathbf{z}}
\newcommand{\bxh}{\hat{\mathbf{x}}}
\newcommand{\btheta}{{\boldsymbol{\theta}}}
\newcommand{\bphi}{{\boldsymbol{\phi}}}
\newcommand{\bepsilon}{{\boldsymbol{\epsilon}}}
\newcommand{\bmu}{{\boldsymbol{\mu}}}
\newcommand{\bnu}{{\boldsymbol{\nu}}}
\newcommand{\bSigma}{{\boldsymbol{\Sigma}}}
% \newtheorem{lemma}{Lemma}
% \newtheorem{theorem}{Theorem}

% argmin argmax
\usepackage{amsmath}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\usepackage{marvosym, ifsym}

\usepackage{multicol}


\usepackage{mainstyle}

\usepackage{subcaption} % for the command \subcaption

% \newcommand{\extension}[1]{{\color{blue}{#1}}} % for revision
\newcommand{\extension}[1]{{\color{black}{#1}}} % for final version (i.e., camera ready)


%%%%%%%%% End of Customized Packages and Comments

% Document starts
\begin{document}
% Title portion
\title{ReVersion: Diffusion-Based Relation Inversion from Images}

\author{Ziqi Huang}
\authornotemark[1]
\email{ziqi002@ntu.edu.sg}
\orcid{0000-0001-8008-5873}
\affiliation{%
\institution{S-Lab, Nanyang Technological University}
\country{Singapore}
}

\author{Tianxing Wu}
    \authornote{Equal contributions}
    \email{tianxing001@ntu.edu.sg}
    \orcid{0000-0001-7345-0254}
    \affiliation{%
    \institution{S-Lab, Nanyang Technological University}
    \country{Singapore}
}
\author{Yuming Jiang}
    \email{yuming002@ntu.edu.sg}
    \orcid{0000-0001-7653-4015}
    \affiliation{%
    \institution{S-Lab, Nanyang Technological University}
    \country{Singapore}
}
\author{Kelvin C.K. Chan}
    \email{chan0899@ntu.edu.sg}
    \orcid{0000-0002-5456-8991}
    \affiliation{%
    \institution{S-Lab, Nanyang Technological University}
    \country{Singapore}
}
\author{Ziwei Liu}
    \authornote{Corresponding author}
    \email{ziwei.liu@ntu.edu.sg}
    \orcid{0000-0002-4220-5958}
    \affiliation{%
    \institution{S-Lab, Nanyang Technological University}
    \country{Singapore}
}



\begin{abstract}
    Diffusion models gain increasing popularity for their generative capabilities. Recently, there have been surging needs to generate customized images by inverting diffusion models from exemplar images, and existing inversion methods mainly focus on capturing object \textbf{appearances} (\ie, the ``look''). However, how to invert object \textbf{relations}, another important pillar in the visual world, remains unexplored.
    %
    In this work, we propose the \textbf{\RI{}} task, which aims to learn a specific relation (represented as ``relation prompt'') from exemplar images. Specifically, we learn a relation prompt with a frozen pre-trained text-to-image diffusion model. The learned relation prompt can then be applied to generate relation-specific images with new objects, backgrounds, and styles. 
    %
    To tackle the \RI{} task, we propose the \textbf{\textit{ReVersion Framework}}.
    Specifically, we propose a novel ``relation-steering contrastive learning'' scheme to steer the relation prompt towards relation-dense regions, and disentangle it away from object appearances. 
    %
    We further devise ``relation-focal importance sampling'' to emphasize high-level interactions over low-level appearances (\eg, texture, color).
    % 
    To comprehensively evaluate this new task, we contribute the \textbf{ReVersion Benchmark}, which provides various exemplar images with diverse relations. Extensive experiments validate the superiority of our approach over existing methods across a wide range of visual relations. Our proposed task and method could be good inspirations for future research in various domains like generative inversion, few-shot learning, and visual relation detection.
    
\end{abstract}
    


\begin{CCSXML}
    <ccs2012>
       <concept>
           <concept_id>10010147.10010178.10010224</concept_id>
           <concept_desc>Computing methodologies~Computer vision</concept_desc>
           <concept_significance>500</concept_significance>
           </concept>
     </ccs2012>
\end{CCSXML}

\ccsdesc[500]{Computing methodologies~Computer vision}


\keywords{Image generation, relation modeling, diffusion model}



\begin{teaserfigure}
    \includegraphics[width=\textwidth]{figures/fig_teaser.pdf}
    \vspace{-20pt}
    \caption{
        We propose a new task, \textbf{Relation Inversion}: Given a few exemplar images, where a relation co-exists in every image, we aim to find a relation prompt \R{} to capture this interaction, and apply the relation to new entities to synthesize new scenes. The above images are generated by our \textbf{ReVersion Framework}.
    }
        \label{fig:teaser}
\end{teaserfigure}

\maketitle

\input{section/paper_1_introduction}
\input{section/paper_2_related_work}
\input{section/paper_4_method}
\input{section/paper_5_benchmark}
\input{section/paper_6_experiment}
\input{section/paper_7_social_impacts}
\input{section/paper_8_conclusion}
\balance

\vspace{20pt}
\begin{acks}
    This study is supported by the Ministry of Education, Singapore, under its MOE AcRF Tier 2 (MOET2EP20221- 0012), NTU NAP, and under the RIE2020 Industry Alignment Fund â€“ Industry Collaboration Projects (IAF-ICP) Funding Initiative, as well as cash and in-kind contribution from the industry partner(s).
\end{acks}

\clearpage
\bibliographystyle{ACM-Reference-Format}
\bibliography{main}





%%%%%%%%% Supp

\clearpage
\appendix
\section*{Supplementary}
\renewcommand\thesection{\Alph{section}}
\renewcommand\thefigure{A\arabic{figure}}
\renewcommand\thetable{A\arabic{table}}
\setlength{\parskip}{3pt}

\input{section_supp/supp_beginning}
\input{section_supp/supp_experiments}
\input{section_supp/supp_benchmark}
\input{section_supp/supp_preposition_prior}
\input{section_supp/supp_social_impacts}
\input{section_supp/supp_qualitative}

% \clearpage
% \bibliographystyle{ACM-Reference-Format}
% \bibliography{main}
    
  
  
\end{document}

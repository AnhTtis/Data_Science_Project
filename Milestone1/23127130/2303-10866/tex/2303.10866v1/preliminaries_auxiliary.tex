In this section we state some commonly used definitions, notations and useful auxiliary results. We also formalize the potential function which is integral to our algorithm and finally state and prove a few reduction rules which are used throughout the paper.\\

\noindent 
{\bf Notation:}  
For a set $S \subseteq V(D)$, $G[S]$ denotes the subgraph of $D$ induced on $S$ and $G[D-S]$ denotes the subgraph induced on $V(D)\setminus S$. A {\em path} $P_{(u,w)}$ from $u$ to $w$ of length $\ell$ is a sequence of distinct vertices $v_1,v_2,\ldots,v_{\ell}$ such that $(v_i,v_{i+1})$ is an arc, for each $i,\ i\in [\ell-1]$ and $v_1=u$, $v_\ell=w$. We define the \emph{in-reachability set} of a vertex $v$ denoted by $R^-(v)$, as the set of vertices that can reach $v$ via some directed path in $D - N^+(v)$. Notice that $v\in R^-(v)$. 
We define $R(v)=N^+(v)\cup R^-(v)$. For graph-theoretic terms and definitions not stated explicitly here, we refer to \cite{diestel-book}. 

\subsection{Auxiliary Results}
In this subsection, we first state some of the known reduction rules and some new ones that we use in our branching algorithm. 

\begin{proposition}{\rm\cite{DBLP:conf/iwpec/BessyBCPS19}\label{prop:1}}
    A digraph $D$ is knot-free if and only if for every vertex $v$ of $D$, $v$ has a path to a sink.
\end{proposition}

\begin{corollary}{\rm\cite{DBLP:conf/iwpec/BessyBCPS19}\label{cor1}}
    For any minimal solution $S\subseteq V(D)$ with the set of sink vertices $Z$ in $D-S$, we have $N^+(Z) = S$. 
\end{corollary}
  
Proposition \ref{prop:1} and Corollary \ref{cor1} imply that given a digraph $D$, the problem of finding a set of sink vertices $Z$ such that every vertex in $V(D)-N^+(Z)$ has a directed path to a vertex in $Z$ and  $|N^+(Z)|$ is minimum; this is equivalent to the \textsc{Knot-Free Vertex Deletion} ({\KFProb}) problem. Therefore, our algorithm aims to find the set of sink vertices $Z$ corresponding to an optimal solution, while minimizing $|N^+(Z)|$ instead of directly finding the deletion set. \\

\noindent
{\bf Strategy of our Algorithm.}  The algorithm expands on the ideas used in \cite{ramanujan2022exact} where the algorithm branches on the possibility that a vertex $v\in V(D)$ is either a sink or a non-sink vertex in some optimal solution. In the branch where we conclude $v$ to be a non-sink vertex there are two possibilities, $v$ is either in the deletion set or not. To track this additional information that $v$ is non-sink, we use a potential function $\phi$ for $V(D)$ defined as follows.
  
\begin{definition}[Potential function]
    Given a digraph $D=(V,E)$, we define a \emph{potential function} on $V(D)$, $\phi:V(D)\rightarrow \{0.25,1\}$ such that $\phi(v)=1$, if $v$ is a potential vertex to become a sink in an optimal solution and $\phi(v)=0.25$, if $v$ is a non-sink vertex. For any subset $V'\subseteq V(D)$, $\phi(V')=\sum_{x\in V'} \phi(x)$. We call a vertex $v$ as an \emph{undecided} vertex if $\phi(v)=1$ and a \emph{semi-decided} vertex if $\phi(v)=0.25$. 
\end{definition}

\begin{definition}[Feasible solution]
    A set $S\subseteq V(D)$ is called a feasible solution for $(D,\phi)$ if $D-S$ is knot-free and for any sink vertex $s$ in $D-S$, $\phi(s)=1$. ${\KFProb}(D,\phi)$ denotes the size of an optimal solution for $(D,\phi)$. 
\end{definition}

\noindent To solve the \textsc{Knot-Free Vertex Deletion} problem on a digraph $D$, we initialize the potential values of all vertices to $1$. As soon as we decide a vertex to be a non-sink vertex, we drop its potential by $0.75$. Any vertex whose potential is $0.25$ cannot become a sink in the final knot-free graph corresponding to an optimal feasible vertex deletion set of $(D,\phi)$.

\noindent Now we are ready to define the \emph{out-reachability set} of $v$ which is the set of \emph{undecided} vertices which are reachable from $v$ even after deleting their out-neighbours, denoted as $R^+(v)$. Note that, $u \in R^+(v)$ if and only if $v\in R^-(u)$. We shall use $S_{min}$ to denote a minimal solution for the given instance $(D,\phi)$ and $Z_{min}$ for the set of sinks in $D-S_{min}$. Similarly, we use $S_{opt}$ and $ Z_{opt}$ to refer to an optimal solution and its sink set respectively. We further define an update function to make our algorithm description concise.\\
\vspace{-20pt}
\input{update_function}\\[-37pt]

\begin{rr}{\rm\cite{ramanujan2022exact}}\label{rr1}
    If all the vertices in $D$ are semi-decided and $D$ has no source or sink vertices, then $V(D)$ is contained inside any feasible solution for $(D,\phi)$. 
\end{rr}

\begin{rr}{\rm\cite{ramanujan2022exact}}\label{rr2} 
    Let $v\in D$ be such that $N^-(v)=\emptyset$, $S$ is an optimal solution for $D$ iff $S$ is an optimal solution for $D' = D-v$.
\end{rr}

\begin{rr}{\rm\cite{ramanujan2022exact}}\label{rr3} 
    Let $v\in D$ be such that $N^+(v)=\emptyset$, $S$ is an optimal solution for $D$ iff $S$ is an optimal solution for $D' = D-R(v)$.
\end{rr}
 
\begin{proposition}\label{claim:1} 
    If  $x \in Z_{min}$, then $N^+(x) \subseteq S_{min}$, $S_{min}\cap R^-(x)=\emptyset$ and $Z_{min} \cap R^+(x) = \emptyset$.
\end{proposition}
\begin{proof}
    By the definition of a sink vertex, if $x \in Z_{min}$ then $N^+(x)$ is in $S_{min}$. Let $Y= S_{min}\cap R^-(x)$. We claim $S'=S_{min}\setminus Y$ is also a solution which will contradict the fact that $S_{min}$ is a minimal solution. Suppose $S'$ is not a solution, then there exists a vertex $v$ in $D-S'$, that does not reach a sink in $D-S'$ but $v$ reaches some sink $s$ in $D-S_{min}$. Since every vertex in $Y$ reaches sink $x$ in $D-S'$, $v\notin Y$. If $s$ is not a sink vertex in $D-S'$, then some vertex $y\in Y$ is an out-neighbor of $s$. But then $v$ can reach the sink $x$ in $D-S'$ via $y$. Hence, $S'$ is a solution of size strictly smaller than $S_{min}$, which is a contradiction. Since $S_{min}\cap R^-(x)=\emptyset$, we also have $Z_{min}\cap R^-(x)=\emptyset$. Now, let $s\in R^+(x)$. If $s\in Z_{min}$ then by definition of $R^+(x)$, $x\in Z_{min}\cap R^-(s)$ which is a contradiction. \qed
\end{proof}

\begin{proposition}\label{prop:2}
    If  $x \in Z_{min}$, then $S_{min}=N^+(x)\cup S'$, where $S'$ is a minimal feasible solution for $(D',\phi') = update(D,\phi,x,-)$. Also, if $S_{min}'$ is a minimal solution for $(D',\phi')$ then $S=N^+(x)\cup S_{min}'$ is a solution for $(D,\phi)$.
\end{proposition}
\begin{proof}
    First, assume that $S'_{min}$ is a minimal solution for $(D',\phi')$. We claim that $S=S'_{min}\cup N^+(x)$ is a solution for $(D,\phi)$. Suppose not, then there exists a vertex $v$ that does not reach a sink in $D - S$. Note that $v\notin R^-(x)$ as all vertices in $R^-(x)$ can reach sink $x$ in $D - S$. Then $v\notin R(x)\cup S$ and hence it is also in $D'-S_{min}$, where it reaches a sink $s$. Since this path is disjoint from $S'_{min}\cup R^{-}(x)$, $v$ still can reach $s$ via the same path in $D - S$. Note that $s$ is not a sink in $D - S$ only if it has an out-neighbor in $R^-(x)\setminus N^+(x)$. But then $s$ and $v$ are in $R^-(x)$ which is a contradiction. Hence, $v$ can still reach the same sink $s$ and $S=S'_{min}\cup N^+(x)$ is a solution for $D$. 
    
    Now, we prove that $S'=S_{min}\setminus  N^+(x)$ is a solution for $(D',\phi')$. 
    Since, $S_{min}$ is optimal, $S'\cap R^+(x)=\emptyset$ via Claim \ref{claim:1} and thus, $S'$ is feasible. If $S'$ is not a solution, then there has to be a vertex $v$ in $D'-S'$ that does not reach any sink. Since $S_{min}\subseteq R(x)\cup S'$, $v\notin S_{min}$. But $S_{min}$ is a solution for $(D,\phi)$ and $v$ can reach some sink $s \in Z_{min}$ in $D-S_{min}$. 
    Note that $s\neq x$, since $v$ is not in $R^-(x)$ and cannot reach $x$ in $D-S_{opt}$. Then $v$ has a path to $s$ which is disjoint from $S_{opt}\supseteq N^+(x)$. Moreover this path is also disjoint from the set $R(x)\setminus N^+(x)$, since $v\notin R(x)$. 
    Hence this path is disjoint from $R(x)$ and $S_{opt}$. Therefore, $v$ can reach $s$ via the same path in $D'-S'$. If $s$ is a sink in $D-S_{opt}$, then $s$ is also a sink in $D'-S'$. Hence, $v$ has a path to a sink in $D'-S'$, which is a contradiction. It implies that  $S'=S_{min}\setminus  N^+(x)$ is a solution for $(D',\phi')$.
    
    Finally, assume $S'=S_{min}\setminus  N^+(x)$ is not a minimal solution for $(D',\phi')$. Then there exists $S''\subset S'$ which is also a solution for $(D',\phi')$, but then $S''\cup N^+(x)$ is also a solution for $(D,\phi)$ contradicting the minimality of $S_{min}$.\qed
\end{proof}

\begin{corollary}\label{cor2}
    If  $x \in Z_{opt}$, then $|S_{opt}|=  |N^+(x)|+{\KFProb}(D',\phi')$, where $(D',\phi') = update(D,\phi,x,-)$.
\end{corollary}
\begin{proof}
    Let us assume $S_{opt}'$ to be an optimal solution to $(D',\phi')$. By Proposition \ref{prop:2}, $S = N^+(x)\cup S_{opt}'$ is a solution to $(D,\phi)$. Now, if $(D,\phi)$ has a minimal solution $\Tilde{S}$ smaller than $S$ then via Proposition \ref{prop:2}, $\Tilde{S}\setminus N^+(x)$ is a solution to $(D',\phi')$ that is smaller than $S_{opt}'$. This is a contradiction and hence the claim is true.\qed
\end{proof}

Now, we define a \emph{drop function} for every undecided vertex, denoted by $\psi(x)$ which takes the value $\psi (x) = \phi(R(x)) + 0.75*|R^+(x)\setminus R(x)|$. This function keeps track of the drop in potential when $x$ becomes a sink in some branch. Further, we define the \emph{surviving set} of vertex $x$, denoted by $\mathcal{S}_x = \{u\in N^+(x) | N^-(u)\cap \mathcal{U} = \{x\}\}$. Observe that for a given instance $(D,\phi)$, if $x\in \mathcal{U}$ has a nonempty survivor set, then the vertices of $\mathcal{S}_x$ is in a minimal solution $S_{min}$ if and only if $x$ is in $Z_{min}$ since Corollary \ref{cor1} requires $S_{min} = N^+(Z_{min})$ and $x$ is the only in-neighbour of elements of $\mathcal{S}_x$ which can be in $Z_{min}$. Finally, we have \emph{candidate sink set} of vertex $x$, denoted by $\mathcal{C}_x = \{u\in R^+(y)\ |\ y\in N^+(x)\}$. Observe that for any given instance $(D,\phi)$ if $x\notin Z_{min}$ then some out-neighbour $y$ of $x$ must satisfy $y\notin S_{min}$. This $y$ must reach some sink $s$ in the final solution, and by definition, $s$ must belong to $R^+(y)$. Thus $\mathcal{C}_x$ is the set of sinks the out neighbours of $x$ can possibly reach if $x$ is not a sink in the final solution. Also, note $\mathcal{C}_x \subseteq N^-(x)\cup R^+(x)$, since given $y\in N^+(x)$ and $s\in R^+(y)$, either $x\in N^+(s)$ or $x$ has a path to $s$ via $y$ in $D-N^+(s)$.
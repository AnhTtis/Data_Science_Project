% vim: set spell :
% vim: set spelllang=en :

\documentclass[12pt,a4paper]{article}
\input{macros}

\def\BoundaryFull#1#2#3{\ensuremath{\left(#1 \,|\, #2 \,|\, #3 \right\}}}
\def\Boundary#1#2{\ensuremath{\left( #1 \,|\, #2 \right\}}}
\def\J{\ensuremath{\mathcal J}}
\def\obj{{\rm obj}}
\def\1{{\bf 1}}
\def\Span#1{\langle #1 \rangle}
\def\rank{\operatorname{rank}}
\def\Par{\nu}
\def\kgadgets#1{{\ensuremath{\mathcal G^{#1}}}}

\def\Experiment#1{%
  \href{https://gitlab.kam.mff.cuni.cz/radek/cdc-counting/-/blob/master/experiments/#1}{%
  \nolinkurl{#1}}}

\hypersetup{pdftitle=Counting Circuit Double Covers}
\hypersetup{pdfauthor={Radek Hušek, Robert Šámal}}

\begin{document}
\title{Counting Circuit Double Covers}
\author{
Radek Hušek\thanks{
Faculty of Information Technology, Czech Technical University in Prague,
Czech Republic
}\and Robert Šámal\thanks{
Computer Science Institute of Charles University,
Faculty of Mathematics and Physics, Charles University,
Prague, Czech Republic
}
}
\date{}
\maketitle

\begin{abstract}
We study a counting version of Cycle Double Cover Conjecture. We discuss
why it is more interesting to count circuits (\ie graphs isomorphic to
$C_k$ for some $k$) instead of cycles (graphs with all degrees even).
We give an almost-exponential lower-bound for graphs with a surface
embedding of representativity at least 4.
We also prove an exponential lower-bound
for planar graphs. We conjecture that any bridgeless cubic graph
has at least $2^{n/2 - 1}$ circuit double covers and we show an infinite
class of graphs for which this bound is tight.
\end{abstract}

%We consider only cubic graphs and we allow multiple edges (note that
%loops are not interesting as they imply existence of a bridge)
%unless explicitly noted otherwise.
Several recent results and conjectures study counting versions of classical
existence statements.
Esperet et al\. \cite{EKKKN-expmatch} proved Lov\'asz--Plummer conjecture:
\begin{theorem}[Esperet et al\.~\cite{EKKKN-expmatch}]
Every bridgeless cubic graph has exponentially many perfect matchings.
\end{theorem}

A similar result for colorings of planar graphs was proven by Thomassen~\cite{Thom-exp5-col}:

\begin{theorem}[Thomassen \cite{Thom-exp5-col}]
Every planar graph has exponentially many (list) 5-vertex-colorings.
\end{theorem}

Thomassen~\cite{Thom-exp3} also conjectured existence of exponentially many 3-vertex-colorings
of triangle-free planar graphs. He gave a subexponential bound that was
later improved by Asadi et al.~\cite{ADPT-exp3}.
However, the conjecture stays open.
By duality, these results and conjecture can be equivalently stated for the
number of nowhere-zero
$\Z_5$-flows (or $\Z_3$-flows) of planar (4-edge-connected) graphs.
Dvořák, Mohar and Šámal~\cite{DMS17} extended this to non-planar graphs:

\begin{theorem}[Dvořák, Mohar and Šámal~\cite{DMS17}]
Every 3-edge-connected graph has exponentially many $\Z_3$-flows and
exponentially many $\Z_2\times\Z_2$-flows.
\end{theorem}

We ask the same question for circuit double covers of cubic graphs
(see Definitions~\ref{def:circuit} and~\ref{def:cdc} below). This is
motivated by Cycle Double Cover conjecture:

\begin{conjecture}[Szekeres '73 \cite{sze73}]\label{con:cdc}
  Every bridgeless graph has a cycle double cover.
\end{conjecture}

We give an exponential
bound for planar graphs (Theorem~\ref{thm:planar-exp-lb}),
almost exponential bound for graphs on any other
fixed surface (Corollary~\ref{cor:surface-lb}) and we present a strengthening
of Conjecture~\ref{con:cdc} which is motivated by our results in
Section~\ref{sec:lin-rep}:
\begin{conjecture}\label{con:cdc-count}
  Every bridgeless cubic graph with $n$ vertices has at least $2^{n/2 - 1}$ circuit
  double covers.
\end{conjecture}


The structure of this paper is the following: 
We first discuss why we chose circuit double covers (or CDC for short)
over cycle double covers.
Then we show a construction that gives many CDCs for graphs with a surface
embedding of represetntativity at least 4.
This gives an almost exponential bound but we observe that this
technique cannot be applied to all graph sequences -- in particular it cannot
be applied to Flower snarks.

In Section~\ref{sec:lin-rep} we present a very condensed version of the linear representation
of circuit double covers developed in the PhD thesis of the first author~\cite{radek-phd}
and prove enough about it to make this paper self-contained.
Using this framework we prove that planar graphs have exponentially many CDCs.
For other applications of our framework see our forthcoming paper~\cite{lin-rep}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Circuit vs\. Cycle}

\begin{definition}[Circuit and Cycle]\label{def:circuit}
  A {\em circuit} is a connected 2-regular subgraph
  (\ie a subgraph isomorphic to $C_k$ for some $k$).
  A {\em cycle} is a subgraph with all degrees even (\ie a union
  of edge-disjoint circuits).
\end{definition}

\begin{definition}[Double Cover]\label{def:cdc}
  Let $G$ be a graph.
  A multiset of circuits (cycles, respectively) $\mathcal C$ is
  a {\em circuit} ({\em cycle}, respectively)
  \em{double cover} if every edge of $G$ is contained in exactly two elements of
  $\mathcal C$.
  It is a $k$-cycle double cover if $\abs{\mathcal C} \leq k$.
  We denote $\nu(G)$ the number of circuit double covers of the graph $G$.
\end{definition}

The existential questions usually ask for a cycle double cover (and more
strongly for 5-CDC). The main reason
we count circuit double covers instead is that a single circuit double cover
corresponds to multiple cycle double covers and this number heavily depends on
the allowed number of cycles. This is nicely illustrated by the following
observation:

\begin{observation}\label{obs:cdc_blowup}
  The circuit double cover given by an embedding of a graph into the plane
  can be made into $2^{\Omega(n_3)}$ many 5-cycle double covers and
  $2^{\Omega(n_3 \log n_3)}$ cycle double covers just by grouping circuits into
  cycles in different ways where $n_3$ is number of vertices of degree at least 3.
\end{observation}
\begin{proof}
  Any graph with a vertex of degree 1 does not have any CDC and subdividing an edge
  (\ie addition of vertex of degree 2) does not change number of CDC so we may assume
  that the graph has minimum degree at least 3. Hence the number of faces is
  $\Omega(n)$.

  Faces of bridgeless planar graph can be 4-colored.
  Some color contains at least one quoter of the faces. Let $k$ be the number of
  faces of the larges color class. Obviously $k = \Omega(n)$.
  For a 5-CDC we split this color class into two
  cycles in $2^{k-1}$ ways (we fix one circuit to be able to distinguish
  the cycles), hence there is $2^{\Omega(n)}$ such 5-CDCs.
  %
  For a general CDC we split this color class into any number of cycles which leads
  to the Bell number\footnote{
    The Bell number $B_k$ is the number of possible partitions of a set of size
    $k$. The name was introduced by Becker and Riordan~\cite{bell-numbers}.
%    It is known that $B_k = 2^{\Theta(k \log k)}$.
  }
  $B_k$.
  As a simple lower bound we can take half of the color class to create cycles
  and divide the rest of the color class among them in an arbitrary fashion
  leading to $\Omega(n)^{\Omega(n)} = 2^{\Omega(n \log n)}$ CDCs.
  (More precise estimates of $B_k$ are known but they are not relevant here.)
\end{proof}


\begin{figure}[tb]
  \centering
  \includegraphics[width=.35\textwidth]{img/inkscape/3-vertex}
  \caption{CDC around a vertex of degree 3}
  \label{fig:cdc-3-vertex}
\end{figure}

\begin{figure}[tb]
  \centering
  \includegraphics[width=.95\textwidth]{img/cdc-triangle}
  \caption{Two possible CDCs of a triangle gadget}
  \label{fig:cdc-triangle}
\end{figure}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Representation of Circuit Double Covers}\label{sec:cdc-rep}

Circuit double covers are usually represented as (multi)sets of circuits.
Although this is a natural representation, it has several downsides.
The most important is that there is no simple way to do local modifications
in this representation. For an alternative representation we use the fact
that for cubic graphs
any CDC around any vertex looks the same (Figure~\ref{fig:cdc-3-vertex}).
Because
all the vertices look the same, the only thing that can change is how
are the walks connected to each other at the edges.

There are two ways to join the walks at each edge. To be able to distinguish
these two ways we assume that the graph is drawn into a plane, and then
the two ways correspond to crossing or not crossing the walks at the edge.
This is shown in Figure~\ref{fig:cdc-ex1}. We require that all the vertices are
distinct points, edges do not pass through the vertices and do not touch
but of course they can cross each other. This drawing serves us as a way to fix
the rotation system (the order of edges around each vertex).
(Alternatively we can view each such configuration as a {\em ribbon graph}
-- see, \eg Ellis-Monaghan and Moffatt~\cite{graphs-on-surfaces-2} section 1.1.4.)
Every CDC of a cubic graph can be represented uniquely in
this way. This leads to the following simple but important observation:

\begin{figure}[tb]
  \centering
  \includegraphics[width=.4\textwidth]{img/cdc/k4}
  \caption{A drawing of $K_4$}
  \label{fig:cdc-ex1}
\end{figure}

\begin{observation}
  A cubic graph with $n$ vertices has at most $2^{3n/2}$ circuit double covers.
\end{observation}
\begin{proof}
  A cubic graphs has $3n/2$ edges, there are two ways how to join the walks at every
  edge and every CDC can be described this way.
\end{proof}

Another consequence of this representation: when we take a closed disk for each circuit in the cover 
and identify the disk boundary with the edges of the graph, we get a closed surface. 
Thus, counting CDCs of a connected cubic graph~$G$ is the same as counting embeddings of~$G$ where every face boundary 
is a circuit. 

Some of our proofs will require cyclically 4-edge-connected graphs.
We recall the definition of cyclic connectivity and a useful lemma about it.
We sometimes omit the word ``edge'' as we do not use vertex connectivity
in this paper.

\begin{definition}[Cyclic Connectivity]\label{def:cyclic-connectivity}
  A graph is {\em cyclically $k$-edge-connected} if every circuit-separating
  edge cut has size at least $k$.
\end{definition}

\begin{observation}\label{obs:cyc-rem2}
  Let $G$ be a cyclically 4-edge-connected cubic graph. Let $G'$ be
  a graph created from $G$ by removing two non-adjacent edges.
  Then $G'$ is 2-edge-connected.
\end{observation}
\begin{proof}
  Because $G$ is cyclically 4-edge-connected it is also 3-edge-connected
  (any cut smaller than three in a cubic graph is non-trivial).
  Hence $G'$ is connected. It remains to show that it is bridgeless.

  We proceed by contradiction. Let $b$ be a bridge of $G' = G - \set{e, f}$.
  Because $b$ is a cut in $G'$, the set $C = \set{b, e, f}$
  is a 3-cut in $G$. The graph $G$ is cyclically 4-edge-connected so $C$
  must be a trivial cut (\ie edges around one vertex). This is a contradiction
  with $e$ and $f$ being non-adjacent.
\end{proof}

We observe that graphs with 2-cuts or non-trivial 3-cuts
can be reduced to smaller graphs:

\begin{observation}[2-cut]\label{obs:cdc_2cut}
  Let $G$ be a cubic graph with a cut of size 2 and denote $G_1$ and $G_2$
  graphs obtained by contracting one side of the cut and suppressing
  the new vertex of degree 2.
  Then $\Par(G) = 2 \Par(G_1) \Par(G_2)$.
\end{observation}
\begin{proof}
  Edges of a 2-cut are covered by the same circuits in any CDC.
  Let $e$ (resp\. $f$) be the edge of $G_1$ (resp\. $G_2$) created
  by contraction of the other side of the cut and suppression of
  the created 2-vertex.

  First we show the inequality $\geq$:
  Fix any CDC of $G_1$ and $G_2$.
  Denote $w_{11}$ and $w_{12}$ the circuits covering $e$
  and $w_{21}$ and $w_{22}$ the circuits covering $f$.
  We can construct $G$ from $G_1$ and $G_2$ by cutting $e$ and $f$ and
  joining each half of $e$ with a half of $f$. We can do the same
  for the CDCs. We have a choice whether to join $w_{11}$ with $w_{21}$
  or $w_{22}$. It is easy to observe that both choices give a valid
  CDC of $G$ and these CDCs are different (because two circuits in a CDC
  of a cubic graph never the same). Hence $\Par(G) \geq 2 \Par(G_1) \Par(G_2)$.

  For the opposite inequality, observe that every CDC of $G$ is uniquely described
  by CDC on $G_1$, CDC on $G_2$ and the way in which the circuits covering
  $e$ a $f$ are joined.
\end{proof}

\begin{observation}[3-cut]\label{obs:cdc_3cut}
  Let $G$ be a graph with cut of size 3 and denote $G_1$ and $G_2$
  graphs obtained by contracting one side of the cut.
  Then $\Par(G) = \Par(G_1) \Par(G_2)$.
\end{observation}
\begin{proof}
  Let $e, f, g$ be the edges of a 3-cut. In any CDC of $G$ this 3-cut is covered
  by three circuits $C_1, C_2, C_3$ such that $e$ is covered by
  $C_1, C_2$, $f$ is covered by $C_2, C_3$ and $g$ is covered by
  $C_1, C_3$. Similarly to the previous observation, a CDC of $G$ is
  uniquely determined by CDCs of $G_1$ and $G_2$. There is no choice in
  this case as circuit covering $e$ and $f$ in $G_1$ must be joined
  with the circuit covering $e$ and $f$ in $G_2$ -- all other choices
  lead to a closed walk which uses some edge twice.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{The Flower Construction}

First we present a construction which starts with a graph embedded into some surface
and creates almost exponentially many circuit double covers by doing local
changes to the CDC given by the embedding.
Despite its name, this construction is not related to Flower snarks in any way.
The basic idea is to choose a face $f$
and modify the CDC on $f$ and its neighbours (let $n_f$ denote the number of
its neighbour faces)
so we get $2^{\Omega(n_f)}$ CDC.

This is shown in Figure~\ref{fig:flower_basic} -- every
small circle there denotes a choice whether to cross the walks or not, leading to
exponentially many CDCs (most of the choices lead to 3 circuits
but some lead to one or two self-touching walks and we deal with them below).
Note that when we redo the CDC on the flower, we cover the outer edges only
once as they are once covered from the outside and we do not want to modify
that part of the CDC. We model this by taking the flower as a standalone planar
graph embedded in such a way that the rest of the original graph would be
in the outer face and counting all CDCs which fix the walk corresponding to the
outer face. We call such objects {\em outer-fixed CDCs} (but we will
sometimes omit ``outer-fixed'' as for the flowers we consider only the
outer-fixed CDCs).

\begin{definition}[Flower]\label{def:flower}
  Let $G$ be an embedding of a graph into some surface. We say that a face $f$ of size $k$
  together
  with its neighbour faces are a {\em $k$-flower with center $f$} if the following
  is satisfied:
  \begin{enumerate}[noitemsep,topsep=0pt,parsep=0pt,partopsep=0pt]
    \item $k \geq 3$,
    \item $f$ shares exactly one edge with each of its neighbour faces,
    \item consecutive neighbour faces also share exactly one edge, and
    \item non-consecutive neighbour faces do not share any edge.
  \end{enumerate}
\end{definition}

To ensure that the result is indeed a CDC with three circuits we cannot do arbitrary
choices everywhere but the case analysis in the Figure~\ref{fig:flower_finish}
shows that the last three choices are enough to ensure a correct CDC.
We number the walks on the right side 1, 2, 3. All the choices outside
of the Figure~\ref{fig:flower_finish} are already made, so the walks appear on the left
side in some order. The upper case in the Figure~\ref{fig:flower_finish} shows
what happens if the walk 1 is on top on the left -- it will go down so in the middle
we must not cross. At the left we still have arbitrary choice but the right choice
is forced -- there is exactly one correct solution (denoted by full circle in the figure).
The bottom case is similar but with walk 1 being on the lower edge.

So given three consecutive choice-points we can always make the walks into a CDC.
We also still have the original CDC which is important for the flowers of size 3
because we will need to have at least two CDCs on every flower.
We show that the exact number of outer-fixed CDCs of a $k$-flower
is $\frac{2^{k-1} + (-1)^k}{3} + 1$ in our paper~\cite{lin-rep}.
But the proof requires additional definitions
so we state a lower bound good enough for the construction instead:

\begin{figure}[b]
  \centering
  \includegraphics[scale=0.8]{img/inkscape/flower_basic}
  \Caption{The basic idea of the flower construction\ignorespaces}{.
    Circles denote the possible choices.\label{fig:flower_basic}}
\end{figure}

\begin{figure}[tb]
  \centering
  \includegraphics[scale=1]{img/inkscape/flower_finish_1}\\\vskip 4ex
  \includegraphics[scale=1]{img/inkscape/flower_finish_2}
  \caption[Finishing the flower]{Finishing the flower.
    Full circles denote forced choices.\label{fig:flower_finish}}
\end{figure}


\begin{observation}\label{obs:flower_cdc_count}
  The flower of size $k$ has at least $2^{k-3} + 1$ outer-fixed circuit double covers.
\end{observation}
\begin{proof}
The ``$+1$'' is the original CDC given by the embedding. Other CDCs are
consisting of 3 circuits following the idea in the Figure~\ref{fig:flower_basic}
which has $k$ binary choice-points. The case analysis in the
Figure~\ref{fig:flower_finish} and its description above show that
up to 3 choice-points are required
to ensure that result is a CDC and hence they cannot be chosen arbitrarily
which leads to ``$-3$'' in the exponent.
\end{proof}


Before choosing the flowers we need to ensure that every face defines
a flower.
It is easy to see that if a $k$-face is not the center of a flower then
either the graph can be reduced to smaller graph or
there must be a closed curve cutting only a few edges:
\begin{itemize}
  \item If $k = 1$, then the boundary of $f$
    is a loop which in a cubic graph
    implies existence of a bridge and as such it is not interesting
    for us. If $k = 2$ then $f$ is bounded by two parallel edges which leads
    to a 2-cut (except the trivial case of three parallel edges on two vertices)
    and we can apply Observation~\ref{obs:cdc_2cut} before proceeding further.
  \item If $f$ shares two or more edges with some face $p$ then there is
    a closed curve cutting only two of the edges shared by them.
  \item We also find a similar curve if two consecutive neighbor faces of $f$
    share more than one edge.
  \item If two nonconsecutive neighbor faces of $f$ -- denote them $p_1$ and $p_2$ --
    share an edge then there is a closed curve passing through faces $f$, $p_1$ and
    $p_2$ and cutting only the three edges that the faces share.
\end{itemize}
In the planar case
this means a small cut in the graph -- either cut of size two or non-trivial
cut of size three. On general surface such a curve does not need to be a cut
but it might prove small representativity\footnote{
  A simple closed curve which does not split the surface into two parts is
  called {\em noncontractible}. Given an embedding of a graph into a surface
  which is not a sphere, the {\em representativity} of this embedding is
  the minimal number of edges the embedding any closed noncontractible curve
  must intersect given it does not intersect vertices.
} of the
embedding instead. Note that in contrast with small cuts we do not know how
to work around small representativity.


\section{Graphs on Surfaces}

Now we use the flower construction to obtain almost exponential lower bounds
for graphs on surfaces.
To choose a suitable set of flowers we need their centers to be at distance 3 or more.
This is well modeled by the vertex coloring of the square of the dual graph.
For general surfaces we approximate $\chi(G^2) \leq \Delta^2 + 1$ but for the
plane there is much better bound:

\begin{theorem}[Molloy and Salavatipour~\cite{molloy2005bound}]\label{thm:planar_square_color}
The chromatic number of the square of a planar graph $G$ with maximum degree $\Delta$
is $\chi(G^2) \leq \ceil{\tfrac{5}{3}\Delta} + 78$.
\end{theorem}


\begin{theorem}\label{thm:flower_planar}
  Every bridgeless cubic planar graph with $n \geq 4$ vertices
  has $2^{\sqrt{n}/100}$ circuit double covers.
\end{theorem}
\begin{proof}
  If the graph $G$ is not cyclically 4-edge-connected
  we apply Observation~\ref{obs:cdc_2cut} or~\ref{obs:cdc_3cut}.
  Let $n_1$ and $n_2$ be the number of vertices of $G_1$ and $G_2$ from
  the observations.
  The application of Observation~\ref{obs:cdc_2cut} gives us:
  $$\nu(G) = 2\nu(G_1)\nu(G_2) \geq 2^{\sqrt{n_1}/100 + \sqrt{n_2}/100 + 1}
  \geq 2^{\sqrt{n_1 + n_2}/100} = 2^{\sqrt{n}/100}
  $$
  where the last inequality holds because $n_1 + n_2 = n$ and
  it holds $\sqrt{x} + \sqrt{y} \geq \sqrt{x + y}$ for all non-negative $x, y$.
  Similarly for Observation~\ref{obs:cdc_3cut} where $n_1 + n_2 = n + 1$.

  If $G$ is cyclically 4-edge-connected, we distinguish two cases depending
  on $\Delta$, the maximum size of a face:
  If $\Delta \geq \sqrt{n}$, we
  choose the largest face to be the center of a flower and this flower itself gives
  us $\max\{2^{\sqrt{n}-3}, 2\} \geq 2^{\sqrt{n}/100}$ CDCs.
  Or $\Delta \leq \sqrt{n}$ and we apply
  Theorem~\ref{thm:planar_square_color} to the dual showing that its chromatic
  number is at most $\ceil{\tfrac{5}{3}\Delta} + 78 \leq 100\Delta \leq 100\sqrt{n}$.
  We can choose flowers in such a way
  that there is at least $n/(100\sqrt{n}) = \sqrt{n}/100$ of them. Every
  flower has at least two CDCs so in total we have $2^{\sqrt{n}/100}$ CDCs.
\end{proof}

For general surfaces we have to also consider that Euler
characteristic $\chi$ influences the number of faces (note that $\chi$ is
negative except for plane, projective plane, torus and Klein bottle) but otherwise
the proof is similar:

\begin{theorem}\label{thm:flower_general}
  Every bridgeless cubic graph with $n \geq 4$ vertices and with embedding in
  a surface of Euler characteristic $\chi$
  with representativity at least 4 has $2^{\sqrt[3]{n + 2\chi}/100}$
  circuit double covers.
\end{theorem}
\begin{proof}
  The number of the faces is
  $f = \frac{1}{2}(n + 2\chi)$ due to Euler's formula.
  If the graph is not cyclically 4-edge-connected
  we apply Observation~\ref{obs:cdc_2cut} or~\ref{obs:cdc_3cut}. Note that there
  exists a closed curve on the surface which crosses the embedding of the graph
  only in the cut edges such that it is a separating curve (otherwise there is
  a face which is not a disk)
  so we obtain embeddings of the smaller graphs and we can proceed.
  For the number of the faces $f_1$, $f_2$ of the smaller graphs it holds
  $f_1 + f_2 = f + 2$ in the case of a 2-cut and Observation~\ref{obs:cdc_2cut}
  gives us:
  $$\nu(G) = 2\nu(G_1)\nu(G_2) \geq 2^{\sqrt[3]{2f_1}/100 + \sqrt[3]{2f_2}/100 + 1}
  \geq 2^{\sqrt[3]{2f_1 + 2f_2}/100} \geq 2^{\sqrt[3]{2f}/100}
  $$
  and similarly for 3-cut where $f_1 + f_2 = f+3$.
  Hence we can proceed by induction.

  Now let us assume that the graph $G$ is 4-edge-connected. 
  Because we ensured that there are no small cuts and excluded the embeddings
  with small representativity, every face is a center of a flower.
  Again we distinguish two cases depending on the maximum size of a face $\Delta$:
  If $\Delta \geq \sqrt[3]{f}$, we choose the largest face to be a center
  of a flower obtaining $\max\{2^{\sqrt[3]{f} - 3}, 2\} \geq 2^{\sqrt[3]{2f}/100}$
  CDCs.
  Otherwise we color the square of the dual
  with $(\sqrt[3]{f})^2$ colors so the largest color class has
  size $f/\sqrt[3]{f}^2 \geq \sqrt[3]{2f}/100$ and we choose it as centers
  of the flowers.
\end{proof}

There also exists an analogue of Theorem~\ref{thm:planar_square_color} for every
fixed surface so for a fixed surface we can improve the exponent:

\begin{theorem}[Amini et at\.~\cite{amini2013}]\label{thm:square_color}
Let $\sigma$ be a fixed surface. Then there exists $c \in \R$ such that
the chromatic number of the square of a graph $G$ with embedding into $\sigma$
with maximum degree $\Delta$
is $\chi(G^2) \leq c\Delta$.
\end{theorem}

\begin{corollary}\label{cor:surface-lb}
  Let $\sigma$ be a fixed surface.
  Every bridgeless cubic graph with embedding in the surface $\sigma$
  and with representativity at least 4 has $2^{\Omega(\sqrt{n})}$
  circuit double covers.
\end{corollary}

This theorem has two potential weaknesses: It might happen that the Euler
characteristic of the embeddings will decrease too fast leading to a constant
number of faces. We are currently not aware of any graph sequence for which
this happens for all the possible embeddings.

The second weakness is that all the embeddings might have small representativity.
While working on Grünbaum's conjecture, Mohar and Vodopivec~\cite{mohar2006polyhedral} 
proved that this is the case for Flower snarks (defined by Isaacs~\cite{flower-snarks},
for small examples see Figure~\ref{fig:flower-snarks}):

\begin{figure}[thb]
  \centering
  \begin{subfigure}[c]{0.3\textwidth}
    \includegraphics[width=\textwidth]{img/inkscape/j3}
  \end{subfigure}\hfil
  \begin{subfigure}[c]{0.3\textwidth}
    \includegraphics[width=\textwidth]{img/inkscape/j5}
  \end{subfigure}\hfil
  \begin{subfigure}[c]{0.3\textwidth}
    \includegraphics[width=\textwidth]{img/inkscape/j7}
  \end{subfigure}
  \caption{Flower snarks $J_3$, $J_5$ and $J_7$}
  \label{fig:flower-snarks}
\end{figure}

\begin{theorem}[Mohar and Vodopivec~\cite{mohar2006polyhedral}]
  All embeddings of a Flower snark~$J_k$ for $k \geq 5$ have representativity at most 2.
\end{theorem}

It is therefore natural to ask how many CDCs do Flower snarks have. We answer
this question in our paper~\cite{lin-rep} where we prove that
Flower snark with $n$ vertices has $\Theta(2^n)$ circuit double covers.

Also the theorems proven above give better bounds
if the graph either has a face of a linear size or has the sizes of the faces
bounded
by a constant. This leads to a question whether we do not loose too much by just
changing the strategy in the middle and whether there is some better way.

We answer this question negatively at least for the planar case.
The counterexample is an {\em antiflower} of size $k$:
\begin{itemize}
  \item Take a flower of size $k$,
  \item add another layer of faces (we call them green faces)
    around the flower so every non-central
    face (the purple faces) of the flower touches $k$ new faces,
  \item contract the outer face into a single vertex, and
  \item expand this vertex into a path so the graph is cubic and
    each of the green faces touches at most 4 other green faces.
\end{itemize}
Figure~\ref{fig:antiflower} shows
an antiflower of size 4, the outer face in the figure is the central face of the
flower used in the construction. Generally an antiflower of size $k$ has
$k$ purple faces and $k^2 - k$  green faces so each
purple face is incident with $k$ green faces.

\begin{figure}
  \centering
  \includegraphics[width=.7\textwidth]{img/inkscape/antiflower}
  \caption{Antiflower of size four}
  \label{fig:antiflower}
\end{figure}

\begin{observation}
  Using the flower construction, no matter how we choose centers of the flowers,
  we obtain at most $2^{O(\sqrt{n})}$ CDCs for the antiflower with $n$ vertices
  (the size of the antiflower is $\Theta(\sqrt{n})$).
\end{observation}
\begin{proof}
  Note that the antiflowers are 3-edge-connected so the presented embedding
  into the plane is the only possible one (modulo changing which face is the outer one),
  as proven by Whitney~\cite{Whitney}.
  We analyse the possible choices of flowers. If we choose outer face as the center
  of the flower then there is no other flower disjoint with it and it has size
  $O(\sqrt{n})$. If we choose a purple face then the outer face is part of the
  flower so we can choose at most one purple face and the flower has size
  $O(\sqrt{n})$ again.

  Only the green faces remain. But every flower with center in the green face
  has size at most 6 as it neighbours with at most 4 other green faces
  and at most 2 purple faces. And when we select a green face, we cannot select
  another green face which neighbours with the same purple face. So we
  can select at most $\Theta(\sqrt{n})$ green faces at once.
\end{proof}

We did not prove any lower bound specially for antiflowers but they are
planar graphs so the general exponential bound proved below
(Theorem~\ref{thm:planar-exp-lb}) applies. Thus, the observation above describes only 
the limitations of the flower construction. 

\section{The Linear Representation}\label{sec:lin-rep}

In this section we describe what we call a {\em linear representation} for counting circuit double covers. 
In our paper~\cite{lin-rep} we develop this idea further: we define general (non-linear) 
representations, we study their properties and we define a linear representation
for counting CDCs.
We remind that the number of CDCs in a graph~$G$ is denoted $\Par(G)$.

Linear representations operate on so called {\em gadgets}. For us a gadget
is a graph with some yet-unfinished edges called {\em half-edges}. We
allow the case where both ends of an edge are unfinished (so it
is not adjacent to any vertex yet) -- we call such an edge a {\em free edge}.
For technical reasons, we assume that the half-edges of any particular
gadget are numbered with consecutive integers starting at one
(or equivalently they are linearly ordered).
The {\em size} of a gadget is the number of its half-edges.

We denote $\kgadgets{k}$ the set of all
gadgets of size $k$ with all vertices of degree three (as we are only interested
in cubic graphs). Note that gadgets of size zero are exactly graphs.
We also introduce an operation
$\J_g$ called {\em gluing} which takes two gadgets of the same size and
joins the corresponding half-edges together creating a graph
(gluing two graphs -- \ie gadgets of size zero -- does the disjoint union
of them).
The main fact which we need below is the following:

\begin{theorem}\label{thm:lin-rep-short}
  For any $k \in \N$ there exists a constant $c \in \N$, a function
  $h_\Par : \kgadgets{k} \to \R^c$ and a bilinear function
  $(\J_g)_\Par : \R^c \times \R^c \to \R$ such that for any cubic gadgets
  $g_1$, $g_2$ of size $k$ it holds
  $$\Par(\J_g(g_1, g_2)) = (\J_g)_\Par(h_\Par(g_1), h_\Par(g_2))$$
  if the graph $\J_g(g_1, g_2)$ does not contain vertex-less loop,
  and $h_\Par(g) \geq 0$ for every gadget $g \in \kgadgets{k}$.
  Moreover for $k \in \set{0, 2, 3}$ it holds $c = 1$.
\end{theorem}

\begin{proof}
The theorem would be obvious if we allowed $c = \omega$ -- then
we could take $\R^{\kgadgets{k}}$ and define $h_\Par(g) = e_{g}$.
The hard part is coming up with a finite representation. To do this,
we observe that for each $k$ there is only finitely many ways how
a CDC can behave on the half-edges (we define CDCs of gadgets below). Then:
\begin{itemize}
  \item we set $c$ to be the number of these ways --
    we call them {\em boundaries} (and we denote the set of them $B^k$),
  \item every element of the vector $h_\Par(g) \in \R^c$ is the number
    of CDCs of $g$ with this boundary\footnote{
      Scaled down by $(1/2)^f$ where $f$ is the number of free edges in $g$
      as we will see below.
    } and
  \item the element $((\J_g)_\Par)_{i,j}$ of the matrix
    $(\J_g)_\Par \in \R^{c \times c}$ is the number of CDCs created by
    joining one CDC with the $i$-th boundary with one CDC with $j$-th
    boundary.
\end{itemize}
Below we describe how to obtain these boundaries. Our approach leads
to $2^{\Theta(k^2)}$ boundaries of size $k$. (We prove  in \cite{lin-rep}
that no linear representation counting CDCs can have less than
$2^{\Omega(k \log k)}$ boundaries of size $k$.)

The CDC on a gadget is a (multi)set of circuits and
paths which covers every edge of the gadget twice (including the half-edges).
Both ends of each path must be half-edges and no edge or vertex can appear twice in
one path.
Hence when we glue two gadgets of size $k$, we get $k$ binary choices
how to join the paths on the newly created edges. The question is what
we need to know about CDCs inside the gadgets to determine whether a particular
choice leads to a valid CDC or not.
Because we are interested in cubic graphs, we can assume that no two paths
in a CDC are identical (we ignore free edges for now).

To simplify the reasoning we proceed joining two half-edges at time.
So to be able to join the two half-edges we need to remember for every path 
which half-edges are its end points and which other paths it shares an edge
with. We will record this in the following way: The paths will be labeled
consecutively, starting at one. For each half-edge we record the labels of the
two paths incident with it, \eg the only possible configuration on boundary
has the first half-edge with paths 1 and 2, the second one with paths 1 and 3
and the last half-edge with paths 2 and 3.
We write this boundary $\Boundary{(1,2), (1,3), (2,3)}{}$.

Then for every two paths that share an edge and
it is not yet known from the description of the half-edges, we record a tuple
containing the numbers of these two paths. We write this after $|$ sign,
\eg if paths 5 and 6 are incident only inside the gadget, we would
write $\Boundary{\dots}{(6,5)}$.

The same boundary can obviously be written in many ways -- the operations
that preserve the same structure are renaming the paths,
swapping the order of the numbers in each tuple, and permuting
the tuples describing incidences inside the gadget.
To get rid of this non-uniqueness we just take the equivalence classes
under all these operations. In the implementation we represent
each class by its lexicographically minimal element.
Note that:
\begin{itemize}
  \item The gadgets of size zero -- \ie graphs -- have exactly one boundary
    written $\Boundary{}{}$.
  \item There is no boundary of size one because a graph with a bridge cannot
    have a CDC.
  \item There is one boundary of size two written $\Boundary{(1,2), (1,2)}{}$.
  \item There is one boundary of size three, namely
    $\Boundary{(1,2), (1,3), (2,3)}{}$.
\end{itemize}

Thus we verified the ``moreover'' part of the theorem.
We prove in~\cite{lin-rep} that the described representation
has 33 boundaries of size four. We also prove that there exists
a better representation with only 21 boundaries.

The value $h_\Par(g)$ for gadget $g$ -- called {\em multiplicity vector} -- describes
how many CDCs with each boundary $g$ has. The value $(h_\Par(g))_i$ is $x / 2^f$ 
where $x$ is the number of CDCs of $g$ with the $i$-th boundary
and $f$ is the number of free edges in $g$.
Why is the scaling by $f$ needed?

We have defined $((\J_g)_\Par)_{i,j}$ as the number of choices 
(up to $2^k$) that join a CDC with the $i$-th boundary with a CDC with $j$-th boundary
and the result is a CDC. However, each free edge in any of the gadgets causes two 
of these choices to produce the same CDC: for any free edge~$e$ 
changing the way we glue the CDCs of~$g_1$ and of~$g_2$ at the both ends of~$e$ 
(which are different two of the $k$ half-edges) leaves us with the same 
set of circuits. 

A free edge has two paths spanning the same half-edge which breaks our assumption:
There is only one option when joining any half-edge to a free edge
but our representation would count two and both would always produce a valid CDC.
To compensate for this we need to scale the value $h_\Par(g)$ by
$(1/2)^f$ where $f$ is the number of free edges in the gadget $g$.
It is easy to see that this works out well in all the cases except
when the graph contains a vertex-less loop (note that a loop with a vertex can
never have a CDC in a cubic graph as the remaining edge is a bridge).
Hence we just exclude graphs with vertex-less loops as they are not of interest
anyway.
\end{proof}

An easy exercise is to apply this theorem to replacement of a cubic vertex
with a triangle:

\begin{observation}\label{obs:triange_to_vertex}
  Replacing a vertex with a triangle in a cubic graphs doubles number of circuit
  double covers.
\end{observation}
\begin{proof}
  The dimension of the multiplicity vector of a 3-vertex is one
  (Theorem~\ref{thm:lin-rep-short}).
  The graph $K_4$ is obtained from three parallel edges (denoted $K_2^3$)
  by replacing a vertex by a triangle, and $\Par(K_4) = 2$ while $\Par(K_2^3) = 1$.
  Hence the multiplicity vector of triangle is twice the multiplicity vector
  of a 3-vertex.
  (See Figures~\ref{fig:cdc-3-vertex} and~\ref{fig:cdc-triangle}.)
\end{proof}

Although a very simple observation, it gives us an infinite class of graphs
with exactly $2^{n/2 - 1}$ CDCs.

\begin{corollary}\label{cor:triangle}
  An $n$-vertex graph created from three parallel edges by repeatedly expanding
  vertices to triangles has exactly $2^{n/2 - 1}$ circuit double covers.
\end{corollary}

Note that Corollary~\ref{cor:triangle} shows that Conjecture~\ref{con:cdc-count}
cannot be any
stronger as there is an infinite family of graphs for which this conjecture is
tight. On the other hand a stronger version might hold for triangle-free
or more cyclically connected graphs.
We conclude this section with a result
we obtained in \cite{lin-rep} where we tested all $\set{C_3, C_4}$-free
cubic biconnected graphs on 20 or less vertices.\footnote{
  We excluded $C_3$ and $C_4$ due to Corollary~\ref{cor:fin} below.
}
We discovered the graph closest to the bound of Conjecture~\ref{con:cdc-count}
is Petersen graph with ratio $3.25$. Two more tested graphs had the ratio
$\nu(G)/2^{\abs{V(G)}/2 - 1}$ less than 10, all other had higher ratios.
For details see Figure~\ref{fig:cdc-plot}. The blue points represent tested
graphs and the purple line is the lower bound of Conjecture~\ref{con:cdc-count}.
The data were obtained by experiment\footnote{
  The experiments together with other code can be found in our gitlab repo
  \url{https://gitlab.kam.mff.cuni.cz/radek/cdc-counting}.
} \Experiment{test_exp_cdc.sh}.

\begin{figure}[tbh]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
        width=0.85\textwidth,
        height=8cm,
        ymode=log,
        xmin=9,
        xmax=21,
        xtickmin=10,
        xtickmax=20,
        xlabel={The number of vertices},
        ylabel={The number of CDCs (log scale)},
        legend style={ legend pos=north west },
      ]
      \addplot [blue, only marks] table [header=false, col sep=comma] {img/num-cdc-data.csv};
      \addplot [purple, domain=9.5:20.5] {2^(x/2 - 1)};
      \legend {Tested graphs, Conjecture~\ref{con:cdc-count}};
    \end{axis}
  \end{tikzpicture}
  \caption{The number of CDCs of $\set{C_3, C_4}$-free cubic biconnected graphs}
  \label{fig:cdc-plot}
\end{figure}


\section{Reducing Cycles}

In this section we combine the framework with linear programming
to obtain a better bound on the number of CDCs of planar graphs.
First we describe the method in general and then we apply it to
the number of CDCs of planar graphs. It is also straightforward to use
this method for other linear representations.

\subsection{General Method}

We want to show that graphs in some class $\mathcal C$ have many CDCs and
we know that there is a small set of gadgets $\mathcal S$ such that every graph
in $\mathcal C$ either has some gadget of $\mathcal S$ as an induced subgraph
or it is trivial in some sense. We denote the class of the trivial cases
$\mathcal B \subset \mathcal C$. The usual reasons for a graph to be considered
trivial are a small number of vertices and existence of small cuts.

We can for every gadget $s \in \mathcal S$ choose a set of gadgets
with fewer vertices
$\mathcal R_s$ and try to prove that the number of CDCs of a graph $G$
containing $s$ can be bounded from below by the number of CDCs of $G$ with $s$
replaced by elements of $\mathcal R_s$ and that these graphs also belong
to $\mathcal C$. This allows us to proceed by induction on the number of
vertices.

A bit more formally (for an application see the proof of
Theorem~\ref{thm:planar-exp-lb}):
Suppose we are proving a lower bound of a form $c^{n(G) - d}$
where $c > 1$, $d \in \R$. Then we want to show the inequality
$$\Par(\J_g(g, s)) \geq
    \min_{r \in \mathcal R_s} c^{n(s) - n(r)} \Par(\J_g(g, r))$$
where $n(g)$ is the number of vertices\footnote{
  Do not confuse with $|g|$ which denotes the size of the gadget, \ie
  the number of its half-edges.
} of a gadget $g$.
Suppose this is true for all $\J_g(g, s) \in \mathcal C$, all the graphs
$\J_g(g, r)$ also belong to $\mathcal C$ and we have other means to prove
the bound for graphs in $\mathcal B$. Then we can prove the desired
lower bound $c^{n(G) - d}$ for every $G \in \mathcal C$ by induction
on the number of vertices
using this formula as the induction step for the non-trivial graphs.

Proving this formula for each $s$ is where the linear programming
comes into play. We saw a special case of this approach before in
Observation~\ref{obs:triange_to_vertex}. But in that case there was
only one boundary and one substitution gadget, so no linear program
was needed.
The idea of the program is similar to the LP relaxation of integer programs, 
except now the ``real'' program is restricted not to integer vectors 
but to representations of gadgets. 

%fix the value of the right-hand side and search for as small left-hand side
%as possible. Because we cannot search all gadgets, we search all possible
%multiplicity vectors instead.

\begin{theorem}\label{thm:lp}
  Let $c > 1$, $s$, $\mathcal R_s$ be defined as above
  and to simplify the notation put $\J = \J_g$.
  If the objective value of the linear program $P$ (described below)
  is at least~1 then
  the following holds for all gadgets $g$:
  \begin{equation}\label{eq:wanted}
    \Par(\J(g, s)) \geq
      \min_{r \in \mathcal R_s} c^{n(s) - n(r)} \Par(\J(g, r))
  \end{equation}
  where $n(g)$ is the number of vertices of gadget $g$ and
  the linear program $P$ is:
  \begin{align*}
    \min_{m \in \R^{B^{|s|}}} \J_\Par(m, h_\Par(s))& \\
    c^{n(s) - n(r)} \J_\Par(m, h_\Par(r)) &\geq 1 \quad \forall r \in \mathcal R_s\\
    m &\geq 0 
  \end{align*}
\end{theorem}

\begin{proof}
  Consider a particular gadget~$g$. 
  Recall (Theorem~\ref{thm:lin-rep-short} and its proof) that $\J_\Par$ is a bilinear function and $h_\Par(g) \ge 0$. 
  To show~\eqref{eq:wanted}, let $\alpha$ be the right-hand side of this inequality. 
  This means that 
      $$
        \alpha = \min_{r \in \mathcal R_s} c^{n(s) - n(r)} \J_\Par(h_\Par(g), h_\Par(r)). 
      $$
  If $\alpha = 0$ then~\eqref{eq:wanted} is trivially true. Otherwise, put $m = h_\Par(g)/\alpha$. 
  Due to the bilinearity of~$J_\Par$, vector $m$ is a feasible solution to~$P$. 
  If the objective value of~$P$ is at least~1, then (again by bilinearity) we have in particular
  $\J_\Par(h_\Par(g)/\alpha, h_\Par(s)) \ge 1$. This implies $\J_\Par(h_\Par(g), h_\Par(s)) \ge \alpha$ which
  is equivalent to~\eqref{eq:wanted}. 
\end{proof}

Note that if the objective value of the linear program is less than one
but still more than zero then exponential bound for a smaller
$c$ might hold. This theorem also holds for any other
linear representation which maps gadgets to non-negative vectors.

The downside of a linear program is that it is usually solved by a numerical
method which is not suitable for a theoretical proof. We circumvent this
by solving the dual problem. Note that any solution of the dual
gives us a lower bound but of course suboptimal solutions will give
weaker bounds. So for a given solution of the dual we only need to certify
that it is indeed a solution which is easy and we do not need to prove
optimality.

\subsection{Application to Planar Graphs}

We are interested in bridgeless cubic planar
graphs. We know that every such simple graph contains a cycle of size at most five
because its dual is also a planar graph and so it contains a vertex of degree
at most five (due to Euler's formula). (And multigraph contains a small cut.)
Moreover, for $c \leq \sqrt{2}$ and $d \leq 2$
we may reduce the cuts of size two and three
due to Observations~\ref{obs:cdc_2cut} and~\ref{obs:cdc_3cut}.
So we take all bridgeless planar cubic graphs
as the class $\mathcal C$ and we define $\mathcal B$ to be
all graphs in $\mathcal C$ which are not cyclically 4-edge-connected.

We need to be able to replace 4-cycles and 5-cycles. The important
observation is that if the graph is 3-edge-connected then all the 4-cycles
and 5-cycles are faces. What can we replace them with?
We need the replacements to be smaller. 
Ignoring the labeling of the half-edges we have the following options:
one tree and one free edge for the 4-cycle and one possible tree
and a combination of a cubic vertex and a free edge for the 5-cycle.

We tested all of them and the trees were never required to get
the best results.
Hence we will replace the 4-cycles with the two possible
non-crossing choices of two free edges and the 5-cycles with a cubic vertex
and free edge (again drawn in a non-crossing way) in all the 5 possible rotations.
The following theorems show the results of this replacements:

\begin{theorem}\label{thm:4cyc}
  Let $G$ be a cyclically 4-edge-connected cubic graph with a 4-cycle.
  Let $G_1$ and $G_2$ be the two possible graphs obtained from $G$ by deleting
  two opposite edges of the 4-cycle and suppressing vertices of degree 2.
  Then $\Par(G) \geq 4 \min\set{\Par(G_1), \Par(G_2)}$.
\end{theorem}
\begin{proof}
  Because the graph is cyclically 4-edge-connected and we are deleting
  non-adjacent edges, the resulting graph is still 2-edge-connected
  due to Observation~\ref{obs:cyc-rem2}.
  We apply Theorem~\ref{thm:lp} with $c = \sqrt{2}$, 4-cycle as $s$ and
  the two non-crossing choices of two free edges $\mathcal R_s$. We obtain the
  following linear program:
  \begin{align*}
    \max \sum_{i=0}^{32} o_i m_i& \\
    \sqrt{2}^{4} \sum_{i=0}^{32} a_i m_i &\geq 1\\
    \sqrt{2}^{4} \sum_{i=0}^{32} b_i m_i &\geq 1
  \end{align*}
  where $m_i$ are the variables and $o_i$, $a_i$ and $b_i$ are constants
  computed by experiment \Experiment{reduce-cycle.py}
  (although they might be computed by hand in
  this case). Each variable corresponds to a boundary and
  there is 33 boundaries of the size four hence
  there is 33 variables. Each inequality corresponds to an element of
  $\mathcal R_s$. Plugging in the values, taking dual and removing
  31 conditions obviously implied by other conditions, we get:
  \begin{align*}
    \max \frac{1}{4}x_0 + \frac{1}{4}x_1& \\
    x_0 &\leq 2\\
    x_1 &\leq 2 \\
    x_i &\geq 0 \quad \forall i \in \set{0, 1}
  \end{align*}
  The objective value of this linear program is 1. This satisfies the conditions of the
  theorem so we obtain:
  \begin{gather*}
    \Par(G) = \Par(\J(g, s)) \geq
    \min_{r \in \mathcal R_s} \sqrt{2}^{4} \Par(\J(g, r)) =
    4 \min\set{\Par(G_1), \Par(G_2)}. \qedhere
  \end{gather*}
\end{proof}

\begin{theorem}\label{thm:5cyc}
  Let $G$ be a cyclically 4-edge-connected cubic graph with a 5-cycle
  and no 4-cycle.
  Let $G_1, G_2, \dots, G_5$ be the 5 possible graphs obtained from $G$ by
  replacing the 5-cycle by a cubic vertex and an edge in non-crossing way
  (assuming the 5-cycle is a face).
  Then $\Par(G) \geq 5/2 \min_i \Par(G_i)$. If we replace the 5-cycle by
  a cubic vertex and an edge in all possible ways (\ie breaking planarity)
  we get $\Par(G) \geq 3.75 \min_i \Par(G_i)$.
\end{theorem}
\begin{proof}
  We can simulate this replacement by removal of the two edges adjacent with
  the 5-cycle and the two vertices which should be connected by an edge in
  the result, contracting 5-cycle into a vertex and adding an edge to
  join the two vertices of degree two. These two vertices are distinct
  otherwise there would be a 4-cycle in the graph. So the deleted
  edges were not adjacent and the resulting graph is 2-edge-connected
  due to Observation~\ref{obs:cyc-rem2}.

  The rest of the proof is analogous to the proof of the previous theorem
  and the computer aided part is also a part of experiment
  \Experiment{reduce-cycle.py}.
  The (simplified) dual program for non-crossing case with $c = \sqrt[4]{5/2}$ is:
  \begin{align*}
     \max 0.4x_0 + 0.4x_1 + 0.4x_2 + 0.4x_3 + 0.4x_4& \\
    x_i &\leq 1 \quad \forall i \in \set{0, 1, 2, 3, 4} \\
    x_2 + x_4 &\leq 1 \\
    x_1 + x_4 &\leq 1 \\
    x_1 + x_3 &\leq 1 \\
    x_0 + x_3 &\leq 1 \\
    x_0 + x_2 &\leq 1 \\
    x_i &\geq 0 \quad \forall i \in \set{0, 1, 2, 3, 4} \\
  \end{align*}
  The solutions is $x_i = 0.5$ and the objective value is 1.
  The crossing case with $c = \sqrt[4]{3.75}$ and all the 10 possible
  replacement gadgets (5 non-crossing plus 5 crossing) leads to
  a larger linear program so we omit it. But again the objective
  value is one, so we can apply the Theorem~\ref{thm:lp}.
\end{proof}

In both theorems the modified graphs have four vertices less than the original
ones so the best we can prove is that the number of CDCs increases by the factor
2.5 (due to 5-cycles)
with addition of four vertices.
So we obtain:

\begin{theorem}\label{thm:planar-exp-lb}
  Every bridgeless cubic planar (multi)graph
  has at least $(5/2)^{n/4 - 1/2}$ circuit double covers.
\end{theorem}
\begin{proof}
  By induction on $n$, the number of vertices of the graph $G$.
  The base cases are three parallel edges and $K_4$
  because these are the only planar cubic graphs without a non-trivial cut.
  The three parallel edges graph has only one CDC which exactly matches
  the bound. The $K_4$ has two CDCs and the bound requires only approximately
  $1.58$.

  Suppose $n \geq 6$. If $G$ has non-trivial cut
  of size two, we apply Observation~\ref{obs:cdc_2cut} and we obtain
  \begin{align*}
    \Par(G) &\geq 2\Par(G_1)\Par(G_2)
    \geq 2 (5/2)^{|V(G_1)|/4 - 1/2} (5/2)^{|V(G_2)|/4 - 1/2} \\
    & = 2  (5/2)^{n/4 - 1/2} \sqrt{2/5} \geq (5/2)^{n/4 - 1/2}
  \end{align*}
  which we needed.
  Similarly for a non-trivial 3-cut we use Observation~\ref{obs:cdc_3cut}:
  \begin{align*}
    \Par(G) &\geq \Par(G_1)\Par(G_2)
    \geq (5/2)^{|V(G_1)|/4 - 1/2} (5/2)^{|V(G_2)|/4 - 1/2} \\
    & =  (5/2)^{(n + 2)/4 - 1}  = (5/2)^{n/4 - 1/2}.
  \end{align*}

  So $G$ is cyclically 4-edge-connected. It is 3-edge-connected
  so each facial walk in its planar embedding is a circuit.
  Due to Euler's formula, the planar dual of $G$ must have a vertex of
  degree at most five. Hence $G$ has a face of size at most five.
  We already excluded 3-faces because the cut around
  a triangle is a non-trivial cut of size three. If $G$ has a 4-face,
  we apply Theorem~\ref{thm:4cyc}:
  \begin{gather*}
    \Par(G) \geq 4 (5/2)^{(n - 4)/4 - 1/2} =
    \frac{4 \cdot 2}{5} (5/2)^{n/4 - 1/2} \geq (5/2)^{n/4 - 1/2}.
  \end{gather*}
  Otherwise $G$ has a 5-face and we apply Theorem~\ref{thm:5cyc}:
  \begin{gather*}
    \Par(G) \geq (5/2) (5/2)^{(n - 4)/4 - 1/2} = (5/2)^{n/4 - 1/2}.
    \qedhere
  \end{gather*}
\end{proof}

To compare this with Conjecture~\ref{con:cdc-count}, $(5/2)^{n/4} = 2^{cn}$
for $c$ approximately $0.33$ so this is still a weaker
bound than Conjecture~\ref{con:cdc-count} asks for.
We also tried to apply Theorem~\ref{thm:lp} to 6-cycles but we did not have
found a suitable set $\mathcal R$ -- neither free edges nor trees worked.
We conclude this section with a summary of what we know about hypothetical
counterexample to Conjecture~\ref{con:cdc-count}:

\begin{corollary}\label{cor:fin}
  A minimal counterexample (the one with the smallest number of vertices) to
  Conjecture~\ref{con:cdc-count}:
  \begin{enumerate}
    \item does not have 2-edge-cut,
    \item does not have non-trivial 3-edge-cut,
    \item does not contain triangle,
    \item does not contain 4-cycle, and
    \item has at least 22 vertices.
  \end{enumerate}
\end{corollary}

The first three points are due to Observations~\ref{obs:cdc_2cut}
and~\ref{obs:cdc_3cut}, the fourth one due to Theorem~\ref{thm:4cyc}
and the last one was verified by a computation on all 3-edge-connected
cubic graphs up to 20 vertices (see \Experiment{test_exp_cdc.sh} experiment).
Note that we cannot exclude 5-cycles
as the bound provided by the second part of Theorem~\ref{thm:5cyc} is too weak.



\section*{Acknowledgements}

Large part the work was done during first author's Ph.D. study at
Computer Science Institute of Charles University.
The first author was supported by Institutional support
of research organization development (RVO18000).
The second author was supported by grant 22-17398S of the Czech Science Foundation. 

% Institutional support of research organization development - ID: 40683 - National/external code: RVO18000 - Researcher: doc. Ing. Štěpán Starosta,

\bibliographystyle{amsplain}
\bibliography{bibliography}

\listoftodos

\end{document}


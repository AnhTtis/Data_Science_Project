\documentclass{article}
\usepackage{arxiv}
\usepackage[utf8]{inputenc} 

\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs}
\usepackage{hyperref}
% \newcommand{\theHalgorithm}{\arabic{algorithm}}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}

% \usepackage[capitalize,noabbrev]{cleveref}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\usepackage[textsize=tiny]{todonotes}


\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts     
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}         % colors
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs}
% \newcommand{\theHalgorithm}{\arabic{algorithm}}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm,bm}
\usepackage{url}
% \usepackage[english]{babel}
\usepackage{mathrsfs}
\usepackage{times}

\usepackage{wrapfig}
% \usepackage{latexsym}
% \usepackage{natbib}
\usepackage{hyperref}
\def\given{\,|\,}
\def\biggiven{\,\big{|}\,}
\def\Biggiven{\,\Big{|}\,}
\def\bigggiven{\,\bigg{|}\,}
\def\tr{\mathop{\text{tr}}\kern.2ex}
\def\tZ{{\tilde Z}}
\def\tX{{\tilde X}}
\def\tR{{\tilde r}}
\def\tU{{\tilde U}}
\def\P{{\mathbb P}}
\def\E{{\mathbb E}}
\def\B{{\mathbb B}}
\def\nD{{\mathcal{\widetilde{D}}}}
\def\sign{\mathop{\text{sign}}}
\def\supp{\mathop{\text{supp}}}
\def\card{\mathop{\text{card}}}
\def\rank{\mathrm{rank}}
\long\def\comment#1{}
\def\skeptic{{\sc skeptic}}
\def\NPN{\bPiox{\it NPN}}
\def\vec{\mathop{\text{vec}}}
\def\tr{\mathop{\text{Tr}}}
\def\trc{\mathop{\text{TRC}}}
\def\cS{{\mathcal{S}}}
\def\dr{\displaystyle \rm}
\def\skeptic{{\sc skeptic}}
\providecommand{\bnorm}[1]{\Big\vvvert#1\Big\vvvert}
\providecommand{\norm}[1]{\vvvert#1\vvvert}

\usepackage{multirow}
\usepackage{xcolor}
\newsavebox\MBox
\newcommand\Cline[2][red]{{\sbox\MBox{$#2$}%
  \rlap{\usebox\MBox}\color{#1}\rule[-1.2\dp\MBox]{\wd\MBox}{0.5pt}}}
\newcommand{\bel}{\begin{eqnarray}\label}
\newcommand{\eel}{\end{eqnarray}}
\newcommand{\bes}{\begin{eqnarray*}}
\newcommand{\ees}{\end{eqnarray*}}
\def\bess{\bes\small }
\def\Shat{{\widehat S}}
\def\lam{\rho}
\def\real{{\mathbb{R}}}
\def\R{{\real}}
\def\Ti{T_{\rm init}}
\def\Tm{T_{\rm main}}
\def\bcdot{{\bm \cdot}}
\def\ud{\, \text{d}}
\newcommand{\red}{\color{red}}
\newcommand{\blue}{\color{blue}}
\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}
\newcommand{\cIs}{\cI_{\hat{s}}}
\newcommand{\F}{{\rm F}}
\newcommand{\iip}{I_{\text{i}}^+}
\newcommand{\iim}{I_{\text{i}}^-}
\newcommand{\zip}{z_{\text{i}}^+}
\newcommand{\zim}{z_{\text{i}}^-}
\newcommand{\Zip}{Z_{\text{i}}^+}
\newcommand{\Zim}{Z_{\text{i}}^-}
\newcommand{\Xxi}{X_{\text{I}}}
\newcommand{\hth}{\hat{\theta}_{\text{H}}}
\newcommand{\htt}{\hat{\theta}_{\text{T}}}
\newcommand{\rh}{r_{\text{H}}}
\newcommand{\rt}{r_{\text{T}}}
\newcommand{\Rp}{r_+}
\newcommand{\Rm}{r_-}
\newcommand{\nS}{\widetilde{S}}
\newcommand{\Xip}{X_{\text{I}}^+}
\newcommand{\Xim}{X_{\text{I}}^-}
\newcommand{\nSib}{\nS_{\text{I}}^{\pm}}
\newcommand{\nSip}{\nS_{\text{I}}^+}
\newcommand{\Sip}{S_{\text{I}}^+}
\newcommand{\nSim}{\nS_{\text{I}}^-}
\newcommand{\Sim}{S_{\text{I}}^-}
\newcommand{\Xhb}{X_{\text{H}}^{\pm}}
\newcommand{\Xhp}{X_{\text{H}}^+}
\newcommand{\Xhm}{X_{\text{H}}^-}
\newcommand{\Xtb}{X_{\text{T}}^{\pm}}
\newcommand{\Xtp}{X_{\text{T}}^+}
\newcommand{\Xtm}{X_{\text{T}}^-}
\newcommand{\nShb}{\nS_{\text{H}}^{\pm}}
\newcommand{\Shb}{S_{\text{H}}^{\pm}}
\newcommand{\nShp}{\nS_{\text{H}}^+}
\newcommand{\Shp}{S_{\text{H}}^+}
\newcommand{\nShm}{\nS_{\text{H}}^-}
\newcommand{\Shm}{S_{\text{H}}^-}
\newcommand{\nStb}{\nS_{\text{T}}^{\pm}}
\newcommand{\Stb}{S_{\text{T}}^{\pm}}
\newcommand{\nStp}{\nS_{\text{T}}^+}
\newcommand{\Stp}{S_{\text{T}}^+}
\newcommand{\nStm}{\nS_{\text{T}}^-}
\newcommand{\Stm}{S_{\text{T}}^-}
\newcommand{\ebt}{\rho^{\pm}_{\text{T}}}
\newcommand{\ept}{\rho^+_{\text{T}}}
\newcommand{\emt}{\rho^-_{\text{T}}}
\newcommand{\ebh}{\rho^{\pm}_{\text{H}}}
\newcommand{\eph}{\rho^+_{\text{H}}}
\newcommand{\emh}{\rho^-_{\text{H}}}
\newcommand{\tran}{{t}}
\let\oldemptyset\emptyset
\let\emptyset\varnothing


\newcommand{\op}{o_{\raisemath{-1.5pt}\PP}}
\newcommand{\Op}{O_{\raisemath{-1.5pt}\PP}}


\newcommand{\dist}{\textsf{Dist}}


% \usepackage[]{mathtools} % loads amsmath as well
\def\##1\#{\begin{align}#1\end{align}}
\def\$#1\${\begin{align*}#1\end{align*}}
\usepackage{enumitem}
% https://www.overleaf.com/learn/latex/Theorems_and_proofs
% \usepackage[]{amsthm} % provides proof, theorem, lemma, etc. environments
% \usepackage[]{amssymb}
\usepackage{bbm}
\usepackage{xcolor}
\usepackage{tcolorbox}
\newtcolorbox{mybox}{colback=gray!10!white,colframe=gray!10!white,left=1mm,top=1mm,right=1mm,boxsep=0mm,width=15cm,before=\par\smallskip\centering,after=\par,
height=1cm}

\newtcolorbox{mybox2}{colback=gray!10!white,colframe=gray!10!white,left=1mm,top=1mm,right=1mm,boxsep=0mm,width=15cm,before=\par\smallskip\centering,after=\par,
height=1cm}

\newtcolorbox{mybox1}{colback=pink!30!white,colframe=pink!30!white,left=0mm,top=0mm,right=0mm,boxsep=0mm,width=13cm,before=\par\smallskip\centering,after=\par,
height=1.6cm}


\newtcolorbox{mybox3}{colback=pink!30!white,colframe=pink!30!white,left=0.5mm,top=0mm,right=0.5mm,boxsep=0mm,width=11cm,before=\par\smallskip\centering,after=\par,
height=1cm}

\newtheorem{observation}[theorem]{Observation}
\newcommand{\squishlist}{
\begin{list}{{{\small{$\bullet$}}}}
{\setlength{\itemsep}{3pt}      \setlength{\parsep}{1pt}
\setlength{\topsep}{1pt}       \setlength{\partopsep}{0pt}
\setlength{\leftmargin}{1em} \setlength{\labelwidth}{1em}
\setlength{\labelsep}{0.5em} } }
\newcommand{\squishend}{  \end{list}  }
\usepackage{xcolor}
\usepackage{colortbl}
\definecolor{best}{HTML}{BAFFCD}
\definecolor{issue}{HTML}{FFC8BA}
\definecolor{bad}{HTML}{FFC87C}
\newcommand{\good}[1]{\cellcolor{best}#1} 
\newcommand{\bad}[1]{\cellcolor{issue}#1} 
\newcommand{\better}[1]{\cellcolor{issue}#1} 
\usepackage[textsize=tiny]{todonotes}

\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}

\usepackage[capitalize,noabbrev]{cleveref}
\newcommand{\BR}{\mathbbm{1}}
% \newcommand{\bias}{\text{Bias}}
\newcommand{\bias}{\mathrm{Bias}}
% \newcommand{\E}{\mathbb E}
\newcommand{\PP}{\mathbb P}
\newcommand{\QQ}{\mathbb Q}
\newcommand{\RR}{\mathbb R}
\newcommand{\Hy}{\mathcal{H}}
\newcommand{\A}{\textsf{A}}
\newcommand{\FNR}{\textsf{FNR}}
\newcommand{\FPR}{\textsf{FPR}}
\newcommand{\TPR}{\textsf{TPR}}
\newcommand{\f}{f^*}
\newcommand{\rf}{\hat{f}}
\newcommand{\D}{\mathcal D}

\newcommand{\p}{\mathbb P}
\newcommand{\x}{\mathbf{x}}
\newcommand{\ny}{\tilde{y}}
\newcommand{\nY}{\widetilde{Y}}

\newcommand{\aph}{A^+_{\text{H}}}
\newcommand{\apt}{A^+_{\text{T}}}
\newcommand{\amh}{A^-_{\text{H}}}
\newcommand{\amt}{A^-_{\text{T}}}
\newcommand{\fr}{\textbf{FR}}

\newcommand{\wjh}[1]{\textbf{\color{blue}(Jiaheng: #1)}}


\ifodd 1
\newcommand{\rev}[1]{{\color{black}#1}}
\newcommand{\com}[1]{\textbf{\color{red}(YANG: #1)}}
\newcommand{\yl}[1]{\textbf{\color{red}(YANG: #1)}}
\newcommand{\clar}[1]{\textbf{\color{green}(NEED CLARIFICATION: #1)}}
\newcommand{\response}[1]{\textbf{\color{magenta}(RESPONSE: #1)}}
\newcommand{\zzw}[2]{\textbf{\color{blue}(Zhaowei: #1)}{\color{blue}~#2}}
\else
\newcommand{\rev}[1]{#1}
\newcommand{\com}[1]{}
\newcommand{\clar}[1]{}
\newcommand{\response}[1]{}
\newcommand{\yl}[1]{}
\newcommand{\zzw}[2]{}
\fi
\newcommand{\RNum}[1]{\uppercase\expandafter{\romannumeral #1\relax}}
\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}

\title{Fairness Improves Learning from \\Noisily Labeled Long-Tailed Data}


\author{Jiaheng Wei \\
UC Santa Cruz 
\And
Zhaowei Zhu\\
UC Santa Cruz \\
\And
Gang Niu\\
Riken \\
\And
Tongliang Liu \\
University of Sydney
\And
Sijia Liu\\
Michigan State University \\
\And 
Masashi Sugiyama\\
Riken \& University of Tokyo\\
\And
Yang Liu \thanks{Correspondence to yang.liu01@bytedance.com. (Paper under review)}\\
UC Santa Cruz \& ByteDance Research\\
}


\begin{document}


\maketitle


\begin{abstract}
Both long-tailed and noisily labeled data frequently appear in real-world applications and impose significant challenges for learning. Most prior works treat either problem in an isolated way and do not explicitly consider the coupling effects of the two. Our empirical observation reveals that such solutions fail to consistently improve the learning when the dataset is long-tailed with label noise. Moreover, with the presence of label noise, existing methods do not observe universal improvements across different sub-populations; in other words, some sub-populations enjoyed the benefits of improved accuracy at the cost of hurting others. Based on these observations, we introduce the \textbf{F}airness \textbf{R}egularizer (\fr), inspired by regularizing the performance gap between any two sub-populations. We show that the introduced fairness regularizer improves the performances of sub-populations on the tail and the overall learning performance. Extensive experiments demonstrate the effectiveness of the proposed solution when complemented with certain existing popular robust or class-balanced methods.
\end{abstract}


\input{src/introduction}
\input{src/longtail_model}

\input{src/memorize}

\input{src/theory}

\input{src/exp.tex}

\section{Conclusions}
In this paper, we qualitatively and quantitatively analyzed the influence of sub-populations under various metrics, where we observed disparate impacts incurred by sub-populations,
especially when the label noise presents. What is more, our experiment results also reveal that existing robust solutions improve the performance of certain sub-populations at
the cost of hurting others, hence leading to unfair performances among sub-populations. We then propose \textbf{F}airness \textbf{R}egularizer (\fr), which encourages the learned classifier to achieve fair performances across sub-populations. Extensive experiment results demonstrate the effectiveness of \fr, indicating that fairness constraints improve the learning from noisily labeled long-tailed data. 

\section*{Acknowledgement}
This work is partially supported by the National Science Foundation (NSF) under grants IIS-2007951, IIS-2143895, and IIS-2040800 (FAI program in collaboration with Amazon).


\newpage

\bibliography{library, myref, noise_learning, longtail}
\bibliographystyle{plain}


\newpage
\appendix
\onecolumn
\input{src/backup}



\end{document}

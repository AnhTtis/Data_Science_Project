\section{Introduction}
Graph spanners are sparse subgraphs that approximately preserve pairwise shortest-path distances. Let $G = (V, E)$ be an undirected unweighted graph on $n$ vertices and let $f:\mathbb{R}_+\rightarrow\mathbb{R}_+$ be a function. We say that a subgraph $H\subseteq G$ is a spanner with \emph{stretch function} $f$ if for every pair $s, t\in V$, $\dist_H(s, t)\leq f(\dist_G(s, t))$. The research on spanners focuses on the optimal trade-offs between the stretch function $f$ and the sparsity (the number of edges) of the spanner $H$.

One typical case is that we allow $f(d)$ to be significantly greater than $d$, and such spanners are known as \emph{multiplicative} spanners. It was shown that for every integer $k\ge 1$, there always exists a subgraph $H$ with $O(n^{1+1/k})$ edges and stretch function $f(d) = (2k-1)d$ \cite{althofer1993sparse}. Furthermore, this sparsity bound is tight under the Girth Conjecture of Erd{\"o}s \cite{erdos1963extremal}.

Another typical case is that we restrict $f$ to be very close to $d$. In particular, $f(d) = d + O(1)$. There has been a line of previous work studying the sparsity of spanners with such stretch functions. When $f(d) = d+2$, it was shown that graph $G$ always has a spanner with $O(n^{3/2})$ edges \cite{aingworth1999fast}; when $f(d) = d+4$, a construction of spanner with $\tilde O(n^{7/5})$ edges was proposed in \cite{chechik2013new}; when $f(d) = d+6$, spanners with $O(n^{4/3})$ edges were known to exist by \cite{baswana2010additive}. For the lower bound side, in a recent breakthrough \cite{abboud20174}, it was proved that, for any constant $\epsilon>0$, there are graphs such that any spanner with $O(n^{4/3-\eps})$ edges has stretch $n^{\Omega(1)}$. Hence, we already have an almost complete understanding of the spanner sparsity when $f(d) = d + O(1)$.

Besides the two typical cases mentioned above, much less is known when $f$ lies in intermediate regimes. Two notable regimes studied in previous works are the \emph{sublinear additive} regime where $f(d) = d + o(d)$, and the \emph{additive} regime where $f(d) = d + o(n)$.

As for sublinear additive spanners, Thorup and Zwick  \cite{thorup2006spanners,huang2019thorup} were the first to design a nontrivial construction of sublinear additive spanners when $f(d) = d + O(d^{1-1/k})$ where $k\geq 2$ is a constant integer, and the number of edges in the spanner is bounded by $O(n^{1 + 1/k})$. This sparsity bound was later improved to $O\bigg(n^{1+\frac{(3/4)^{k-2}}{7-2\cdot(3/4)^{k-2}}}\bigg)$ in \cite{pettie2009low}. The sparsity bound for the special case where $k=2$ was subsequently improved to $\tilde O(n^{20/17})$ by \cite{chechik2013new}. These algorithms also work for a non-constant $k$, but here we only focus on the case where $k$ is a constant, as we are mainly interested in the stretch/size dependency on $d$ and $n$. On the lower bound side, Abboud, Bodwin, and Pettie \cite{abboud2018hierarchy} proved that any distance-reporting data structure (including spanners, emulators) achieving stretch $f(d) = d + O(d^{1-1/k})$ must have size at least $\Omega\bigg(n^{1+\frac{1}{2^{k+1}-1}-o(1)}\bigg)$ for each constant $k\ge 2$, which is also the best known lower bound for spanners. Thus, there still exists a large gap between sparsity upper and lower bounds for sublinear additive spanners.

For the additive regime where $f(d) = d + o(n)$, the tail term $f(d) - d$ is usually called the \emph{additive stretch}. A natural question is to study the best additive stretch that can be achieved by spanners with $\tilde{O}(n)$ edges. The first nontrivial construction was given by \cite{pettie2009low} with an additive stretch of $O(n^{9/16})$, which was improved subsequently by \cite{bodwin2015very, bodwin2021better} to $O(n^{3/7+\eps})$ for any constant $\epsilon>0$. On the negative side, the first stretch lower bound of $\Omega(n^{1/22})$ was proved in \cite{abboud20174}, and later on raised to $\Omega(n^{1/7})$ by a sequence of works \cite{huang2021lower,lu2022better,bodwin2022new}.

\subsection{Our results}
\paragraph{Sublinear additive spanners.} Our primary result is the following almost optimal bound on sublinear additive spanners.

\begin{theorem}\label{sublinear}
For any undirected unweighted graph $G = (V, E)$ on $n$ vertices, given any constant $\delta>0$ and any constant integer $k\ge 2$, there exists a sufficiently large constant $C = C(k, \delta)$, such that
every undirected unweighted graph $G$ on $n$ vertices admits a spanner $H\subseteq G$ with stretch function $f(d)=d+C\cdot d^{1-1/k}$ and  $O\bigg(n^{1+\frac{1+\delta}{2^{k+1}-1}}\bigg)$ edges.
%\footnote{$O_{\delta, k}(\cdot)$ hides factors only dependent on constants $\delta, k$.}.
\end{theorem}

% \paragraph{Connection to $(1+\epsilon,\beta)$-spanners.} Elkin and Peleg \cite{elkin20041eps} studied a type of spanners considered called $(1+\epsilon,\beta)$-spanners, which are spanners with stretch function $f(d)=(1+\eps)\cdot d+\beta$. They showed that for every integer $\kappa$ and $\epsilon>0$, every $n$-vertex graph admits a $(1+\epsilon,O(\epsilon^{-1}\log \kappa)^{\log \kappa})$-spanner of size $O(n^{1+1/\kappa}\cdot O(\epsilon^{-1}\log \kappa)^{\log \kappa}))$. Thorup and Zwick \cite{thorup2006spanners} constructed $\brac{1+\epsilon,O(k/\eps)^{k-1}}$-spanner of size $O\brac{\kappa\cdot n^{1+\frac{1}{2^{k+1}-1}}}$ for any integer $k$. Pettie \cite{pettie2009low} showed the construction of $(1+\epsilon,O(\log\log n/\eps)^{\log\log n})$-spanner of size $O(n\log\log (\eps^{-1}\log\log n))$. As for the connection between sublinear additive stretch and $(1+\epsilon, \beta)$-stretch, our construction in \Cref{sublinear} are also $(1+\epsilon,\beta)$-spanners simultaneously for all choices of parameters $\epsilon,\beta$ when $\beta =\frac{(k-1)^{k-1}C^k}{k^k\epsilon^{k-1}}$ by AM-GM inequality.

This sparsity upper bound almost matches the previous lower bound of $\Omega\brac{n^{1+\frac{1}{2^{k+1}-1}-o(1)}}$ proved in \cite{abboud2018hierarchy}. Formally, the authors of \cite{abboud2018hierarchy} showed that there exists a constant $c = \Theta\brac{\frac{1}{k+1}}$, such that in some hard examples of input graph $G$, any spanner with stretch $f(d)=d+c\cdot d^{1-1/(k+1)}$ must have $\Omega\bigg(n^{1+\frac{1}{2^{k+1}-1}-o(1)}\bigg)$ edges. When the distance value $d$ is larger than $\brac{C/c}^{k(k+1)}$ which is a constant only dependent on $k$, the stretch function $f(d) = d + C\cdot d^{1-1/k}$ of our spanner construction is always better than the stretch $d + c\cdot d^{1 - 1/(k+1)}$ in the lower bound construction of \cite{abboud2018hierarchy}. Since our sparsity upper bound almost matches the lower bound of $\Omega\brac{n^{1+\frac{1}{2^{k+1}-1}-o(1)}}$, our construction is almost optimal.

The same lower bound in \cite{abboud2018hierarchy} also extends to the more relaxed notion of emulators which are graphs defined on the vertex set $V$ but not required to be a subgraph of $G$. For the sublinear additive stretch function $f(d) = d + O(d^{1-1/k})$, there are known emulator constructions of size $O\brac{kn^{1+\frac{1}{2^{k+1}-1}}}$ by \cite{thorup2006spanners,huang2019thorup} which matches the lower bound in \cite{abboud2018hierarchy} and ties our new bound for spanners. In fact, the emulator lower bound in \cite{abboud2018hierarchy} holds for any form of graph metric compression schemes, in the sense that any data structure that answers approximate distance queries (regardless of query time) with stretch $f(d) = d + c\cdot d^{1-1/(k+1)}$ for some constant $c < 2k^{1-1/(k+1)}$ must occupy at least $n^{1 + \frac{1}{2^{k+1}-1}-o(1)}$ bits of space. Therefore, since our spanner construction matches the lower bound against any graph metric compression scheme, as our take-home message, it means that although spanners are the most restrictive form of compression compared to emulators and distance oracles, they are already the most powerful ones.

Our construction also directly translates to $(1+\epsilon, \beta)$-mixed spanners with stretch function $f(d) = (1+\epsilon)d + \beta$ when $\beta =\frac{(k-1)^{k-1}C^k}{k^k\epsilon^{k-1}}$ by AM-GM inequality. Previous works on mixed spanners include \cite{elkin20041eps} where the authors showed that for every integer $\kappa$ and $\epsilon>0$, every $n$-vertex graph admits a $(1+\epsilon,O(\epsilon^{-1}\log \kappa)^{\log \kappa})$-spanner of size $O(n^{1+1/\kappa}\cdot O(\epsilon^{-1}\log \kappa)^{\log \kappa})$, and \cite{thorup2006spanners} where the authors constructed $\brac{1+\epsilon,O(k/\eps)^{k-1}}$-spanner of size $O\brac{k\cdot n^{1+\frac{1}{2^{k+1}-1}}}$ for any integer $k$, and \cite{pettie2009low} where the author showed the construction of $(1+\epsilon,O(\log\log n/\eps)^{\log\log n})$-spanner of size $O(n\log\log (\eps^{-1}\log\log n))$. Among these previous results, the result by \cite{thorup2006spanners} and ours provide the same form of stretch $\brac{1+\epsilon, O(1 / \epsilon^{k-1})}$ and sparsity $n^{1 + \frac{1+\delta}{2^{k+1}-1}}$ when $k$ is a constant integer, which is proved to be almost optimal by \cite{abboud2018hierarchy}.


%This upper bound almost matches the previous construction of sublinear additive emulators (where $H$ can be any graph on $V(G)$, not necessarily a subgraph of $G$) achieving the same stretch in \cite{thorup2006spanners} (see also \cite{huang2019thorup}), and also almost matches the lower bound from \cite{abboud2018hierarchy} for all compression schemes achieving stretch $f(d)=d+O(d^{1-1/k})$ Conceptually, \Cref{sublinear} shows that, although restricted to be subgraphs, spanners are as powerful as any form of graph metric compression scheme (including emulators and distance oracles) in the sublinear additive stretch regime.

%In other words, the correct constant $c$ for exponential base is $2$. Our bound significantly improves upon the previous bounds \cite{pettie2009low,chechik2013new}, and almost matches the lower bound proved in \cite{abboud2018hierarchy}\footnote{We note that our upper bound does not contradict the lower bound $\Omega\bigg(n^{1+\frac{1}{2^k-1}-o(1)}\bigg)$ proved in \cite{abboud2018hierarchy}, since the lower bounds are for stretch with small factors hidden in $O_{k,\delta}(\cdot)$. In fact, our bound should be compared with their lower bound for $d^{1-\frac{1}{k+1}}$ spanners, which is $\Omega\bigg(n^{1+\frac{1}{2^{k+1}-1}-o(1)}\bigg)$, and is almost optimal.}.

%Note that, for any parameter $\delta>0$, if we let $\eps=\frac{\delta}{10k(2^{k+1}-1)}$, then \Cref{sublinear} gives a sublinear spanner with stretch function $f(d)=d+2^{O(k^2 2^k/\delta)}\cdot d^{1-1/k}$ on $O(n^{1+\frac{1+\delta}{2^{k+1}-1}})$ edges. In other words, for any constant $\delta>0$, there is a sublinear additive spanner of stretch function $f(d)=d+O_{\delta,k}(d^{1-1/k})$ and size $O(n^{1+\frac{1+\delta}{2^{k+1}-1}})$.


%Next, we study fast algorithms for constructing additive spanners. Suppose now we want to find a sparse subgraph $H\subseteq G$ such that $\dist_H(s, t)\leq \dist_G(s, t) + \err(n)$ for some small error term $e$. It is known that when $|E(H)| = 2^{O(1/\epsilon)}n$, $\err(n)$ can be made $O(n^{3/7+\epsilon})$ \cite{bodwin2021better}. However, its construction time is $\tilde{O}(mn)$ since it requires computing all-pairs shortest paths which is at least quadratic. As our secondary result, we show a subquadratic time construction algorithm.

\paragraph{Additive spanners.} Our second result is a slightly improved bound on near-linear size additive spanners upon the bound $O(n^{3/7+\eps})$ of \cite{bodwin2021better}. In addition, we show that such a spanner can be computed in subquadratic time, while previous constructions in \cite{bodwin2021better,bodwin2015very} need the computation of all-pairs shortest paths in $G$ which takes time $O(\min\{mn, n^{2.373} \})$.

\begin{theorem}\label{subquad}
For any undirected unweighted graph $G = (V, E)$ on $n$ vertices and $m$ egdges, there exists a spanner with $O(n^{0.403})$ additive stretch and $\tilde{O}(n)$ edges. Moreover, such a spanner can be computed in sub-quadratic time $\tilde{O}\big(m + n^{13/7}\big)$.
\end{theorem}
\begin{remark}
	In the above theorem, if we could tolerate an $O(mn)$ construction time of the additive spanner, then the size can be made purely linear $O(n)$ with the same additive stretch $O(n^{0.403})$.
\end{remark}

\input{overview}

\subsection{Organization}
We start with preliminaries in \Cref{sec: prelim}. We provide a construction for pairwise additive spanners in \Cref{sec: pairwise}, which will be a building block in the proof of \Cref{sublinear} which appears in \Cref{sec: sublinear spanner}.
Next, we show the construction of subset spanners in \Cref{sec: subset}, which will be a crucial subroutine used in the algorithm of \Cref{subquad}. Lastly, we provide the proof of \Cref{subquad} in \Cref{sec: subq}.






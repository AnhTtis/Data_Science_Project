
\documentclass[10pt,twocolumn,letterpaper]{article}

\usepackage[pagenumbers]{cvpr}              %

\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{booktabs}
\usepackage{pifont}
\usepackage{caption}
\usepackage{subcaption}


\makeatletter
\@namedef{ver@everyshi.sty}{}
\makeatother
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{wrapfig}

\usepackage[accsupp]{axessibility}

\usepackage{algorithm}
\usepackage{algcompatible}
\usepackage{algorithmicx}
\usepackage{algpseudocode}


\usepackage{mathtools, cuted}
\usepackage{resizegather}

\usepackage{widetext}







\usepackage{rotating}
\usepackage{xr}







\usepackage[pagebackref,breaklinks,colorlinks]{hyperref}

\usepackage[capitalize]{cleveref}
\crefname{section}{Sec.}{Secs.}
\Crefname{section}{Section}{Sections}
\Crefname{table}{Table}{Tables}
\crefname{table}{Tab.}{Tabs.}


\usepackage{color} 
\definecolor{darkorange}{rgb}{1.0, 0.55, 0.0} 
\definecolor{darkgreen}{rgb}{0.0, 0.55, 0.0} 

\newcommand{\exy}[1]{\textcolor{darkorange}{#1}} 
\newcommand{\exz}[1]{\textcolor{darkgreen}{#1}} 
\newcommand{\eyz}[1]{\textcolor{blue}{#1}} 

\DeclareMathOperator*{\argmin}{arg\,min}


\begin{document}

\title{CCuantuMM: Cycle-Consistent Quantum-Hybrid Matching of Multiple Shapes} 

\author{Harshil Bhatia$^{1,2}$~~~Edith Tretschk$^2$~~~Zorah Lähner$^3$~~~Marcel Seelbach Benkner$^3$\\
Michael Moeller$^3$~~~Christian Theobalt$^2$~~~Vladislav Golyanik$^2$\\
$^1$Indian Institute of Technology, Jodhpur~~~~$^2$MPI for Informatics, SIC~~~~$^3$Universität Siegen
}
\maketitle

\begin{abstract}
   \input{sections/0_abstract}
\end{abstract}







\input{sections/1_introduction}
\input{sections/2_related_work}
\input{sections/3_background}
\input{sections/4_method}
\input{sections/5_experiments}
\input{sections/6_discussion_conclusion}

{\small
\bibliographystyle{ieee_fullname}
\bibliography{main}
}

~
\newpage
~
\newpage

\appendix

\begin{center}
\textbf{\Large Supplementary Material} 
\end{center} 

This supplementary material contains additional results.
We present them in the order they are mentioned in the main paper. 
First, Sec.~\ref{sec:notation} provides an overview of our notation. 
Sec.~\ref{sec:nshapealg} formally states the $N$-shape algorithm. 
Sec.~\ref{sec:100shapes} contains large-scale figures showing the $100$ matched FAUST shapes. 
Sec.~\ref{sec:higherorder} describes the elimination of higher-order terms in detail. 
Sec.~\ref{sec:Wtilde} states the weight matrix $\Tilde{W}$ of the final QUBO. 
Sec.~\ref{sec:evolution} shows that the total energy almost never decreases in practice. 
Sec.~\ref{sec:anchorchoice} compares our anchor scheme to using random triplets. 
Sec.~\ref{sec:timecomplexity} discusses the time complexity of our proposed method. 
Sec.~\ref{sec:implementationdetails} provides more implementation details on  initialisation and deciding trivial cycles. 
Sec.~\ref{sec:qpu} discusses the minor embeddings on real quantum hardware and contains further QPU experiments. 
Sec.~\ref{sec:ablations_and_analysis} presents more results, including more ablation experiments. 
Finally, Sec.~\ref{sec:related_work_appendix} compares existing quantum computer vision works for alignment tasks. 

In addition, the supplementary material contains a video showing the evolution of the matchings of a ten-shape FAUST instance over the course of the optimisation. 
We visualise the matchings by fixing the colouring of the top-left shape and transferring this colouring to all other shapes according to the estimated correspondences. 


\section{Notations}\label{sec:notation}

Tab.~\ref{tab:notation} summarises the notation we use. 

\begin{table}[h]
    \centering
    \resizebox{\linewidth}{!}{
    \begin{tabular}{l|l}
    \hline
    Notation     &  Meaning \\ \hline \hline
    $\mathcal{I}$, $\mathcal{J}$, $\mathcal{X}$, $\mathcal{Y}$, $\cal Z$ & shapes (represented as meshes) \\ 
    $P_\mathcal{IJ}$ & permutation matrix from shape $\mathcal{I}$ to $\mathcal{J}$ \\ 
    $x$, $y$, $u$, $v$ & vertices of a shape\\
    $\mathcal{P}$ & set of permutations \\ 
    $\mathcal{S}$ & set of shapes  \\
    $W$ & energy matrix \\
    $N$ & number of shapes \\ 
    $I$ & identity matrix \\
    $E_{\cal I J}(P,Q)$ & $\textit{vec}(P)^\top W_{\cal I J} \textit{vec}(Q)$ \\
    $E_{\cal I J}(P)$ & $E_{\cal I J}(P,P)$ \\
    $F_{\cal I J}(A,B) $ & $E_{\cal I J}(A,B) + E_{\cal I J}(B,A)$ \\ 
    $\alpha, \beta$ & decision variables \\ 
    $k$ & size of decision variables $\alpha$,$\beta$ \\
    $m$ & number of worst vertices \\
    $I_{\cal X Y}(x)$ & relative inconsistency of vertex $x$ for $P_{\cal X Y}$ \\ 
    $V_{\cal X}$ & set of worst vertices for shape $\cal X$ \\
    $\mathcal{C_X}$ & set of cycles for shape $\cal X$\\ 
    $A$ & anchor shape \\ 
    $C_i $ &  $(c_i - I) P_{\cal X Y}$; single-cycle update of $P_{\cal X Y} $ \\
    $\tilde{C}_j $ & $(c_j - I)P_{\cal Y Z}$; single-cycle update of $P_{\cal Y Z} $\\
    $K_{ij}$ & $C_i \tilde{C}_j$ \\
    \hline
    \end{tabular}
    }
    \caption{Notation used in this work.}
    \label{tab:notation}
\end{table}

\section{$N$-Shape Algorithm}\label{sec:nshapealg}
We provide the formal $N$-shape algorithm as Alg.~\ref{Alg:nshape}. 
\begin{algorithm}
\def\NoNumber#1{{\def\alglinenumber##1{}\State #1}\addtocounter{ALG@line}{-1}}
\caption{CCuantuMM (Matching $N$ Shapes; Sec. 4.2)}
\label{Alg:nshape}
\textbf{Input:} $\mathcal{S},T$ \\ 
\textbf{Output:} $\mathcal{P}$
\begin{algorithmic}[1]
\State {initialise $\mathcal{P}^{\mathit{init}}$ from HKS descriptors}
\State {determine anchor $A\in\mathcal{S}$}  
\State {$\mathcal{P}^0\gets \{P^\mathit{init}_{\mathcal{I} A}\}_{\mathcal{I} \in \mathcal{S}, \mathcal{I} \neq A} $ } 
\State {randomly pick $\mathcal{X}^{-1}\in\mathcal{S}$}\hfill\Comment{technicality for $\mathcal{Z}^0$}
\For{$i=0$ to $2T(\lvert \mathcal{S} \rvert-1)$ } \hfill \Comment{iterations}
    \If{$i \mod (\lvert \mathcal{S} \rvert-1) == 0$}
        \State {$\mathcal{S}' \gets \mathcal{S}\setminus\{A\}$}\hfill\Comment{for stratified sampling}
    \EndIf
    \State {randomly pick $\mathcal{X}^i\in\mathcal{S}'$}
    \State {$\mathcal{S}' \gets \mathcal{S}' \setminus \{\mathcal{X}^i\}$}
    \State {$\mathcal{Y}^{i} \gets A$}
    \State {$\mathcal{Z}^{i} \gets \mathcal{X}^{i-1}$ } 
    \State {get $P^i_{\mathcal{X}^i A}, P^i_{\mathcal{Z}^i A}$ from $\mathcal{P}^i$}
    \State {$P^i_{\mathcal{X}^i \mathcal{Y}^i} \gets P^i_{\mathcal{X}^i A}$}
    \State {$P^i_{\mathcal{Y}^i \mathcal{Z}^i} \gets (P^i_{\mathcal{Z}^i A})^{-1}$}
    \State {$ P^i_{\mathcal{X}^i \mathcal{Z}^i} \gets P^i_{\mathcal{X}^i A}(P^i_{\mathcal{Z}^i A})^{-1}$}
    \State {$\operatorname{mode} \gets \operatorname{geodesic}$ \textbf{if} $i< T(\lvert \mathcal{S} \rvert-1) $ \textbf{else} $\operatorname{Gaussian}$ }
    \State {$\{P^{i+1}_{\mathcal{X}^i \mathcal{Y}^i},P^{i+1}_{\mathcal{Y}^i \mathcal{Z}^i},P^{i+1}_{\mathcal{X}^i \mathcal{Z}^i}\} \gets$ run Alg.~1 with $\operatorname{mode}$} 
    \NoNumber{on $(\{P^i_{\mathcal{X}^i \mathcal{Y}^i},P^i_{\mathcal{Y}^i \mathcal{Z}^i},P^i_{\mathcal{X}^i \mathcal{Z}^i}\}$, $\{\mathcal{X}^{i},\mathcal{Y}^{i},\mathcal{Z}^{i}\})$}
    \State {$P^{i+1}_{\mathcal{X}^i A} \gets P^{i+1}_{\mathcal{X}^i \mathcal{Y}^i}$}
    \State {$P^{i+1}_{\mathcal{Z}^i A} \gets (P^{i+1}_{\mathcal{Y}^i \mathcal{Z}^i})^{-1}$}
    \State {$\mathcal{P}^{i+1}\gets (\mathcal{P}^i \setminus \{P^i_{\mathcal{X}^i A}, P^i_{\mathcal{Z}^i A}\}) \cup \{P^{i+1}_{\mathcal{X}^i A},P^{i+1}_{\mathcal{Z}^i A}\} $}
\EndFor
\State\Return {$\mathcal{P}=\mathcal{P}^{2T(\lvert \mathcal{S} \rvert-1)}$}
\end{algorithmic}
\end{algorithm}



\section{Matching $\boldsymbol{100}$  Shapes}\label{sec:100shapes} 

\begin{figure*}
    \centering
    \includegraphics[width=\linewidth]{figures/render_teaser_full.png}
    \caption{\textbf{Extended version of Fig.~1 in the main paper.} We visualise the matchings between all $100$ FAUST shapes via texture transfer. All correspondences are cycle-consistent by design.}
    \label{fig:teaser_full}
\end{figure*}

Fig.~\ref{fig:teaser_full} shows qualitative results of all $100$ matched FAUST shapes. 



    
\section{Higher-Order Terms}\label{sec:higherorder}

In this section, we give the expansions for the third term of (7), namely $E_{\cal X Z} (P_{ \cal X Z}(\alpha,\beta))$, as it contains higher-order terms. 
Fig.~\ref{fig:higher_order_terms} shows the equations. 
The terms in red are cubic or bi-quadratic and we hence assume them to be 0, except for the summands that simplify to quadratic terms. 
For example, $\alpha_i \beta_j \alpha_i \beta_j  E_{\cal X Z}(C_i \tilde{C}_j, C_i \tilde{C}_j)$ simplifies to the linear summand $\alpha_i \beta_j E_{\cal X Z}(C_i \tilde{C}_j, C_i \tilde{C}_j)$. 
This then yields (8) from the main paper. 



\section{Final QUBO}\label{sec:Wtilde}

Fig.~\ref{fig:WTilde} shows the weight matrix $\Tilde{W}\in\mathbb{R}^{2k \times 2k}$ that is used for the final QUBO. 




\begin{figure*}
\begin{equation} 
\resizebox{\linewidth}{!}{
$
\tilde{W}_{ij} = \begin{cases}
E_{\cal YZ} (C_i,C_i) +E_{\cal XY}(P_{\cal XY},C_i) 
+ E_{\cal XY}(C_i, P_{\cal XY})
+ E_{ \cal XZ}(P_{\mathcal{XY}} P_{\mathcal{YZ}}, C_i P_{\mathcal{YZ}})
+ E_{ \cal XZ}(C_iP_{\mathcal{YZ}},P_{\mathcal{XY}} P_{\mathcal{YZ}}) 
+ E_{ \cal XZ}(C_i P_{\mathcal{YZ}}  , C_i P_{\mathcal{YZ}} )
 & \text{if } i = j  \leq  k \\
E_{\cal XY}(\tilde{C_j},\tilde{C_j})  +  E_{\cal YZ}(P_{\cal YZ}, \tilde{C}_j) 
+ E_{\cal YZ}(\tilde{C}_j,P_{\cal YZ})
+ E_{ \cal XZ}(P_{\mathcal{XY}} P_{\mathcal{YZ}}, P_{\mathcal{XY}} \tilde{C_j}) 
+ E_{ \cal XZ}(P_{\mathcal{XY}} \tilde{C_j},P_{\mathcal{XY}} P_{\mathcal{YZ}}) 
+ E_{ \cal XZ}(P_{\mathcal{XY}} \tilde{C_j}, P_{\mathcal{XY}} \tilde{C_j})
 & \text{if } i = j > k \\ 
E_{\cal YZ} (C_i,C_j) +  E_{ \cal XZ}(C_i P_{\mathcal{YZ}}, C_j P_{\mathcal{YZ}}) & \text{if } i \neq j ,i \leq k,j \leq k \\ 
E_{\cal XY}(\tilde{C_i},\tilde{C_j})  + E_{ \cal XZ}(P_{\mathcal{XY}} \tilde{ C_i}, P_{\mathcal{XY}} \tilde{ C_j} ) & \text{if } i \neq j , i >k , j > k \\
E_{\cal X Z}(P_{\cal X Y} P_{\cal Y Z},  C_i \tilde{C}_j )
+E_{ \cal XZ}(P_{\mathcal{XY}} \tilde{C_j},C_i P_{\mathcal{YZ}}) 
+E_{\cal X Z}( P_{\cal X Y}  \tilde{C}_j, C_i \tilde{C}_j)
+ E_{ \cal XZ}(C_i P_{\mathcal{YZ}}, P_{\mathcal{XY}} \tilde{ C_j}) \\
+ E_{\cal X Z}(C_i P_{\cal YZ}, C_i \tilde{C}_j)
+ E_{\cal X Z}(C_i \tilde{C}_j, P_{\cal X Y} P_{\cal Y Z})
+ E_{ \cal XZ}(C_i \tilde{C}_j, P_{ \cal XY} \tilde{C}_j) &\\
+ E_{ \cal XZ}(C_i \tilde{C}_j,C_i P_{ \cal YZ}) 
+ E_{ \cal XZ}(C_i \tilde{C}_j,C_i \tilde{C}_j) 
& \text{if } i \neq j , i \leq k ,  j>k  \\
0 & \text{otherwise}   
\end{cases}$
}
\end{equation} 
\caption{ The final QUBO weight matrix $\Tilde{W}$. For indices $i>k$, we define 
$\Tilde{C}_i=\Tilde{C}_{i-k}$. %
}
\label{fig:WTilde}
\end{figure*}



\section{Evolution During Optimisation}\label{sec:evolution}
Fig.~\ref{fig:Improvement} depicts how the total energy (11) and PCK evolve during optimisation. %
Importantly, the energy almost never increases in practice. 
Furthermore, our algorithm converges close to the ground truth.   
A sudden and significant improvement occurs as soon as the schedule switches from geodesics to Gaussians. 
We note that although the objective uses Gaussians in the second half of the schedule, both the total energy plotted here and the PCK are based on the (unfiltered) geodesic distances. 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
            \resizebox{0.49\linewidth}{!}{
    \input{SupplimentFigures/PCK_Evolution}}
    \resizebox{0.49\linewidth}{!}{
    \input{SupplimentFigures/Energy_Change}}
        \caption{FAUST}
    \end{subfigure}

        \begin{subfigure}[b]{\linewidth}
    \resizebox{0.49\linewidth}{!}{
    \input{SupplimentFigures/PCK_Evolution_TOSCA.tex}}
    \resizebox{0.46\linewidth}{!}{
    \input{SupplimentFigures/EnergyTOSCA.tex}}
        \caption{TOSCA}
    \end{subfigure}

        \begin{subfigure}[b]{\linewidth}
    \resizebox{0.49\linewidth}{!}{
    \input{SupplimentFigures/PCK_Evolution_SMAL.tex}}
    \resizebox{0.463\linewidth}{!}{
    \input{SupplimentFigures/EnergySMAL.tex}}
        \caption{SMAL}
    \end{subfigure}

    \caption{Evolution during the optimisation (left) of the PCK, depicted with a colour bar gradient, and (right) of the total  energy. 
    The horizontal red-dashed line is the energy of the ground-truth solution. 
    The results are on (a)  a class of FAUST containing ten shapes, (b) the cat class of TOSCA containing eleven shapes, and (c) the cat class of SMAL containing nine shapes. 
    }
    \label{fig:Improvement}
\end{figure}



\section{Fixed Anchor vs. Random Triplets}\label{sec:anchorchoice}

Fig.~\ref{fig:AnchorAblation} compares our anchor-based scheme with using random triplets. 
We see a small improvement with our scheme. 

\begin{figure}%
    \centering
    \resizebox{0.59 \linewidth}{!}{
    \input{SupplimentFigures/PCK_vm}}
    \caption{PCK when using a fixed anchor (as our method does) and when using random triplets.  
    We average across all classes of FAUST. 
    }
    \label{fig:AnchorAblation}
\end{figure} 





\section{Time Complexity}\label{sec:timecomplexity}
Our method mainly consists of constructing and solving the QUBO matrix $\tilde{W}$, which is based on $W$. 
However, standard meshes contain thousands of vertices, which makes na\"ively calculating the full $W \in \mathbb{R}^{n^2 \times n^2}$ not feasible due to the memory restrictions. 
Fortunately, we do not need to compute the full $W$ but only a small set of its entries. 
This is due to the extreme sparsity of the $c_i{-}I$ matrix (only four non-zero elements) since we only consider 2-cycles. 
Using $k$ 2-cycles leads to a worst-case time complexity of $\mathcal{O}(n k^2)$ for the three-shape Alg. 1 from the main paper (\textit{i.e.}, one sub-sub-iteration). %
For the sub-sub-iterations of a sub-iteration, $\tilde{W}$ is constant and we thus need to compute $\tilde{W}$ only once for each sub-iteration. 
In addition, each iteration has $k{-}1$ sub-iterations, resulting in a time complexity of $\mathcal{O}(n k^3)$ for each iteration. 
Furthermore, our implementation for computing $\tilde{W}$ is significantly faster in practice than the sub-sampling technique proposed in Q-Match. 





\section{Implementation Details}\label{sec:implementationdetails} 



\subsection{Initialisation}
The initial set of permutations $\mathcal{P}^\mathit{init}$ is computed using a descriptor-based similarity $\mathit{DS}_{\cal I J} \in \mathbb{R}^{n \times n }$ between all $n$ vertices of shape pairs $\cal I, J \in \mathcal{S}$. 
Specifically, $\mathit{DS}_{\cal I J}(u,v)$ contains the similarity (inner product) of the normalised heat-kernel-signatures (HKS)~\cite{bronstein2010scale} descriptors (which we extend by an additional dimension indicating whether a vertex lies on the left or right side of a shape) of vertex $u$ of $\cal I$ and vertex $v$ of $\cal J$. 
The left-right descriptors reduce left-right flips in the solution since the shape classes we consider are globally symmetric, which is not captured by the local HKS descriptors. 
This is standard practice in the shape-matching literature~\cite{Gao2021}. 
The solution of a linear assignment problem on $\mathit{DS}_{\cal I J}$ is then the initial $P^\mathit{init}_{\cal I J}$.

\subsection{Pre-Computing Trivial Cycles} \label{sec:kernelization} 
The matrix $\Tilde{W}$ consists of couplings (quadratic terms) and linear terms. 
Numerical experiments show that there often exist cycles with linear terms that dominate the corresponding coupling terms.  
This happens when a cycle is largely uncorrelated to the rest of the cycles in the current set of cycles. 
In this case, the decision for such a cycle can be made trivially. 

We now derive an inequality for how large the linear term has to be such that the couplings can be neglected in the optimisation problem. 
Consider the QUBO problem:
\begin{gather}
    \min_{\alpha \in\{0,1\}^k}  \alpha^T W \alpha+ b^T \alpha,
\end{gather}
where $\alpha$ are the decision variables, $b\in\mathbb{R}^k$ is a vector, and $W$ is a symmetric matrix with zeros on the diagonal representing the couplings. 
We can look at the terms that depend on $\alpha_q$ for fixed $q$ separately:
\begin{gather*}
    \alpha^T W \alpha = \alpha_q\sum_{i\neq q}W_{q,i} \alpha_i +  \alpha_q \sum_{i\neq q} \alpha_i W_{i,q}  \\ \nonumber + \sum_{j\neq q}(\sum_{i \neq q} \alpha_j  W_{j,i} \alpha_i + \alpha_j b_j) + \alpha_q b_q.
\end{gather*}
As $W$ is symmetric, $W_{i,q} = W_{q,i}$ holds and we can write
\begin{gather*}
    \alpha^T W \alpha = \alpha_q \left(b_q+ 2\sum_{i\neq q}W_{q,i} \alpha_i \right)  \\ \nonumber + \sum_{j\neq q}(\sum_{i \neq q} \alpha_j  W_{j,i} \alpha_i + \alpha_j b_j).
\end{gather*}
It follows that if:
\begin{equation}
    |b_q|\geq  \sum_{i\neq q} 2 |W_{q,i}|,
\end{equation}
then we can make the decision based on the sign of $b_q$: If $b_q$ is positive we do not choose the cycle as doing so would increase the energy.
This reduces the number of physical qubits required for the embedding. 











\section{Minor Embeddings and Other QPU Experiments}\label{sec:qpu}





\subsection{QPU Processing and Annealing Time}


Optimising a single QUBO uses ${\sim}40 ms$ of total QPU processing time for 200 anneals. 
This is also called the \emph{QPU access time} \cite{Timing}. 
However, there are also several overheads that occur when solving QUBOs by accessing a D-Wave annealer via the cloud. 
For example, a latency when connecting to the D-Wave annealer and a post processing time. The QPU access time also includes a programming time.



These overheads can be orders of magnitude greater than the time taken by the actual annealing, which is very short since we use the default annealing schedule and the default annealing time of 20 $\mu s$. %



\subsection{Minor Embeddings}

As explained in the main paper, not all physical qubits on a real quantum processing unit (QPU) can be connected (coupled) with each other. 
Thus, a minor embedding of the logical-qubit graph (defined by non-zero entries of the QUBO matrix) into the physical-qubit graph (defined by the hardware) is required. 
This can lead to a chain of multiple physical qubits representing a single logical qubit. 

Our logical input graph is a clique. 
Due to the limited connectivity of current hardware, a clique cannot be directly embedded onto the physical annealer. 
We thus require a minor embedding, which is commonly computed using Cai \textit{et al.}'s method~\cite{cai2014practical}. 
Fig.~\ref{fig:qpuembedding} visualises an example minor embedding.
We note that, since our input graphs are cliques, a generalised embedding can be pre-computed and reused, not impacting the time complexity. 


\begin{figure}
    \centering
    \resizebox{0.48\linewidth}{!}{
    \input{SupplimentFigures/PCK_Zephyr}}
    \resizebox{0.48\linewidth}{!}{
    \input{SupplimentFigures/PCK_10_Shapes_Zephyr}} 
    \caption{ 
    PCK curves for (left) a three-shape and (right) a ten-shape inter-class FAUST instance on both QPU architectures. %
    } 
    \label{fig:InterClassQPU} 
\end{figure} 

\begin{figure}
    \centering
    \resizebox{0.49\linewidth}{!}{
    \input{SupplimentFigures/qpuworstvertices}}
    \resizebox{0.49\linewidth}{!}{
    \input{SupplimentFigures/PCK_worst_vertices}}
    \caption{Quantitative results when using (solid) 20 and (dashed) 40 worst vertices on a three-shape FAUST instance. 
    We show (left) the energy evolution during optimisation and (right) the final PCK curves. 
    }
    \label{fig:Energy40}
\end{figure}

\begin{figure}[th]
    \centering
    \resizebox{0.48\linewidth}{!}{
    \input{SupplimentFigures/qubits}}
    \resizebox{0.48\linewidth}{!}{
    \input{SupplimentFigures/chains}}
    \caption{Structural changes of the minor embeddings when using more worst vertices. 
    We show (left) the number of physical qubits and (right) the average chain length, for both QPU topologies. %
    The number of \emph{logical} qubits equals the number of worst vertices. %
    }
    \label{fig:qubits_and_chains}
\end{figure}



\subsection{Minor Embeddings in Practice}


In this section, we investigate the empirical impact of minor embeddings on the solutions. 
The minor embeddings depend on the qubit topology, \textit{i.e.} the physical qubit connectivity pattern. 
Here, we show results on the D-Wave Advantage 4.1 with its Pegasus topology (used in the main paper) and also first results on a D-Wave Advantage2 prototype of the next-generation Zephyr topology, which has a higher connectivity than Pegasus. 

Fig.~\ref{fig:InterClassQPU} shows PCK curves on both topologies when using $m{=}2k{=}20$ worst vertices. 
Both architectures obtain similar results, although they are very slightly worse than SA. 
However, as discussed in the main paper, we find that the performance of CCuantuMM degrades significantly when using more than $20$ worst vertices with QA. 
Specifically, Fig.~\ref{fig:Energy40} shows that the quality of the matchings worsens when using $40$ worst vertices on both topologies, with Zephyr obtaining slightly better results. 
Still, in both cases, the quality is worse than the matching quality obtained by SA. 
Only SA shows the desired behaviour of improving when more worst vertices are used. 

The cause for these results lies with the structure of the minor embeddings and not the plain number of physical qubits. 
Fig.~\ref{fig:qubits_and_chains} shows how the structural properties of the minor embeddings evolve as the number of worst vertices increases. 
For $20$ worst vertices, they are similar. 
However, for $40$ worst vertices, Zephyr uses fewer physical qubits and smaller chains, which explains the very slight performance advantage in Fig.~\ref{fig:Energy40}. %
Physical qubits in a chain representing a single logical qubit are less likely to all anneal to the same value the longer the chain is. 
Longer chains become unstable and hence inconsistent, leading to inferior solution quality. 












\section{Further Results and Ablations}\label{sec:ablations_and_analysis}

\subsection{Additional Qualitative Results} \label{sec:qualitative}

Fig.~\ref{fig:tosca_centaur}, Fig.~\ref{fig:tosca_david}, and Fig.~\ref{fig:smal_dog} provide additional qualitative examples of matchings on TOSCA and SMAL calculated with our method and the competitors. %



\subsection{Variation Within a Dataset}

Within a dataset, some instances have more difficult deformations and are inherently harder to match than easier instances, independent of the method employed. 
We investigate the extent of this variation by taking a closer look at TOSCA. 
We observe a significant variation of PCK curves across different classes in Fig.~\ref{fig:SMAL_Variation} and of AUC in Tab.~\ref{Table:SMAL_variation}.


\begin{figure}[!h]%
    \centering
    \resizebox{\linewidth}{!}{
    \input{SupplimentFigures/PCK_TOSCA_class.tex}}
    \caption{PCK for seven different classes of TOSCA.
    We plot our method with solid lines and IsoMuSh~\cite{Gao2021} with dashed lines. 
    }
    \label{fig:SMAL_Variation}
\end{figure}

\begin{table}[h]
    \centering
    \resizebox{\linewidth}{!}{
    \begin{tabular}{|c|ccccccc|}
    \hline 
    & Dog & Cat & Horse & Michael & Victoria & David & Centaur \\ \hline
    Ours    & 0.957 & 0.917          & \textbf{0.990} & \textbf{0.992} & 0.912 & 0.989 & 0.983 \\ 
    IsoMush & \textbf{0.959} & \textbf{0.959} & 0.981         & 0.939 & \textbf{0.991} & \textbf{0.996} & \textbf{0.984} \\ \hline
\end{tabular}
}
    \caption{AUC across seven different classes of TOSCA. 
    }
    \label{Table:SMAL_variation}
\end{table}




















\subsection{Influence of Descriptors}


We ablate the need for left-right indicators when using HKS descriptors for initialisation. %
Fig.~\ref{fig:noLR} contains results on the cat class of TOSCA.
Without left-right indicators, we observe flips in the matchings on TOSCA and partial flips on FAUST for inter-class instances. %
This is expected since both our method and IsoMuSh exploit intrinsic properties of the shapes, which are invariant to such symmetric flips. 

\begin{figure}[h]
    \centering
    \resizebox{0.5\linewidth}{!}{
    \input{SupplimentFigures/LRdesc.tex}
    }
    \caption{PCK with and without left-right descriptors.
    We plot our method with solid lines and IsoMuSh~\cite{Gao2021} with dashed lines. }
    \label{fig:noLR}
\end{figure}



\subsection{Noise Perturbation} 


We investigate the robustness of our approach to noise. 
To that end, we analyse the effect of adding synthetic perturbations to the shapes. 
Specifically, for each FAUST mesh, we add a Gaussian-distributed offset along the vertex normal to each vertex position.
This ensures the meshed structure of the shape does not change. 
Fig.~\ref{fig:noisy} visualises the amount of noise we experiment with.
Fig.~\ref{fig:NoiseVariation} shows that our method is significantly more robust to noise than IsoMuSh. 

\begin{figure}[h]
    \centering
    \includegraphics[width=.3\linewidth]{SupplimentFigures/noisy/shape_001.png}
    \quad
    \includegraphics[width=.3\linewidth]{SupplimentFigures/noisy/shape_002.png}
    \caption{Example of perturbing the geometry on FAUST, with the noise variance set to $0.01$ (left) and $0.02$ (right).}
    \label{fig:noisy}
\end{figure}

\begin{figure}[h]%
    \centering
    \resizebox{0.5\linewidth}{!}{
    \input{SupplimentFigures/pckNoise}}
    \caption{PCK for different amounts of perturbation (Gaussian noise with variance $\sigma^2$).  
    We plot our method with solid lines and IsoMuSh~\cite{Gao2021} with dashed lines. 
    We report results on a class of FAUST. 
    }
    \label{fig:NoiseVariation}
\end{figure}





\section{Related Quantum Computer Vision  Works}\label{sec:related_work_appendix} 
Several quantum methods tackle alignment tasks, as  Tab.~\ref{tab:related_work} shows. 
However, only Q-Match is relevant for comparisons. 
Several works only consider two point clouds and cannot handle the multi-matching setting of our work, do not consider fully non-rigid transformations, or only operate on point clouds, not meshes. %
QGM~\cite{SeelbachBenkner2020} only considers two graphs with at most four vertices. 
Q-Sync~\cite{QuantumSync2021} similarly only works on at most five vertices, far fewer than what our method can handle. 





\begin{sidewaysfigure*}[b]
\begin{equation} \label{eq:fullPXZ}
\resizebox{\linewidth}{!}{$
\begin{split} 
    E_{\cal X Z} (P_{ \cal X Z}(\alpha,\beta)) &= E_{\cal X Z}\left( %
    (P_{\cal XY} + \sum_{i=1}^k \alpha_i C_i) \cdot (P_{\cal YZ}+\sum_{j=1}^k \beta_j \tilde{C}_j),%
    (P_{\cal XY} + \sum_{q=1}^k \alpha_q C_q) \cdot (P_{\cal YZ} + \sum_{l=1}^k \beta_l\tilde{C}_l) %
    \right) \\ \\ 
    &= E_{\cal X Z} \left(P_{\cal X Y} P_{\cal Y Z}, (P_{\cal XY} + \sum_{q=1}^k \alpha_q C_q) \cdot (P_{\cal YZ} + \sum_{l=1}^k \beta_l \tilde{C}_l\right) %
    + E_{\cal X Z} \left(\sum_{j=1}^k \beta_j P_{\cal X Y}  \tilde{C} _j  ),(P_{\cal XY} + \sum_{q=1}^k \alpha_q C_q) \cdot (P_{\cal YZ} + \sum_{l=1}^k \beta_l \tilde{C}_l)\right) 
    \\ 
    &+ E_{\cal X Z} \left( \sum_{i=1}^k \alpha_i C_i P_{\cal YZ}, (P_{\cal XY} + \sum_{q=1}^k \alpha_q C_q) \cdot (P_{\cal YZ} + \sum_{l=1}^k \beta_l \tilde{C}_l)\right) %
    + E_{\cal X Z} \left(\sum_{i=1}^k \sum_{j=1}^k \alpha_i \beta_j C_i  \tilde{C}_j,(P_{\cal XY} + \sum_{q=1}^k \alpha_q C_q) \cdot (P_{\cal YZ} + \sum_{l=1}^k \beta_l \tilde{C}_l)\right)
    \\  \\ 
    &= E_{\cal X Z}(P_{\cal X Y} P_{\cal Y Z},P_{\cal X Y} P_{\cal Y Z}) %
    + \sum_{l=1}^k \beta_l E_{\cal X Z}(P_{\cal X Y} P_{\cal Y Z}, P_{\cal X Y} \tilde{C}_l )%
    + \sum_{q=1}^k \alpha_q E_{\cal X Z}(P_{\cal X Y} P_{\cal Y Z},  C_q P_{\cal YZ} )%
    \\
    & + \sum_{q=1}^k \sum_{l=1}^k \alpha_q  \beta_l E_{\cal X Z}(P_{\cal X Y} P_{\cal Y Z},  C_q \tilde{C}_l )%
    + \sum_{j=1}^k \beta_j E_{\cal X Z}( P_{\cal X Y} \tilde{C}_j, P_{\cal X Y} P_{\cal Y Z}) %
    + \sum_{j=1}^k \sum_{l=1}^k \beta_j \beta_l E_{\cal X Z}(P_{\cal X Y}   \tilde{C}_j, P_{\cal X Y} \tilde{C}_l) %
    \\
    &+ \sum_{j=1}^k \sum_{q=1}^k \beta_j \alpha_q E_{\cal X Z}(P_{\cal X Y} \tilde{C}_j,  C_q P_{\cal YZ}) %
    + \sum_{j=1}^k \sum_{q=1}^k \sum_{l=1}^k \beta_j \alpha_q \beta_l  E_{\cal X Z}( P_{\cal X Y}  \tilde{C}_j, C_q \tilde{C}_l)
    + \sum_{i=1}^k \alpha_i E_{\cal X Z}(C_i P_{\cal YZ}, P_{\cal X Y} P_{\cal Y Z}) %
    \\  %
    &+ \sum_{i=1}^k \sum_{l=1}^k \alpha_i \beta_l E_{\cal X Z}(C_i P_{\cal YZ}, P_{\cal X Y} \tilde{C}_l) %
    + \sum_{i=1}^k \sum_{q=1}^k \alpha_i \alpha_q E_{\cal X Z}(C_i P_{\cal YZ},  C_q P_{\cal YZ}) %
    + \sum_{i=1}^k \sum_{q=1}^k \sum_{l=1}^k \alpha_i \alpha_q \beta_l  E_{\cal X Z}(C_i P_{\cal YZ}, C_q \tilde{C}_l)
    \\  %
    &
    + \sum_{i=1}^k \sum_{j=1}^k \alpha_i \beta_j E_{\cal X Z}(C_i \tilde{C}_j, P_{\cal X Y} P_{\cal Y Z}) %
    + \sum_{i=1}^k \sum_{j=1}^k \sum_{l=1}^k \alpha_i \beta_j \beta_l E_{\cal X Z}(C_i \tilde{C}_j, P_{\cal X Y} \tilde{C}_l)%
    + \sum_{i=1}^k \sum_{j=1}^k \sum_{q=1}^k \alpha_i \beta_j \alpha_q E_{\cal X Z}(C_i\tilde{C}_j,  C_q P_{\cal YZ}) %
    \\
    & + \sum_{i=1}^k \sum_{j=1}^k \sum_{q=1}^k \sum_{l=1}^k \alpha_i \beta_j \alpha_q \beta_l  E_{\cal X Z}(C_i \tilde{C}_j, C_q \tilde{C}_l)%
    \end{split}
$}
\end{equation}
\caption{We expand the third term of (7) from the main paper, which yields higher-order terms (highlighted in red). 
When the summands constituting these terms are truly cubic or bi-quadratic, we assume them to be 0, which results in the QUBO (8). 
} 
\label{fig:higher_order_terms} 
\end{sidewaysfigure*} 


\begin{figure*}
    \centering
    \begin{subfigure}[b]{0.48\textwidth}
    \includegraphics[width = \textwidth]{SupplimentFigures/nrworst20.png}
    \end{subfigure}
    \begin{subfigure}[b]{0.48\textwidth}
    \includegraphics[width = \textwidth]{SupplimentFigures/nrworst30.png}
    \end{subfigure}
    
    \begin{subfigure}[b]{0.48\textwidth}
    \includegraphics[width = \textwidth]{SupplimentFigures/nrworst40.png}
    \end{subfigure}
    \begin{subfigure}[b]{0.48\textwidth}
    \includegraphics[width = \textwidth]{SupplimentFigures/nrworst50.png}
    \end{subfigure}
    \caption{Visualisation of an example minor embedding on Pegasus (which we use in the main paper). %
    The visualisation is obtained via D-Wave Leap 2's problem inspector~\cite{DWave_Leap} for (upper left) 20, (upper right) 30, (lower left) 40, and (lower right) 50 worst vertices. 
    Each node depicts a physical qubit and the edges depict the chains of the minor embeddings.  
    }
    \label{fig:qpuembedding}
\end{figure*}


\begin{figure*}[!ht]
   \centering
    \resizebox{\linewidth}{!}{
    \begin{tabular}{c|cccccc}
    
    \raisebox{-0.5\height}{\includegraphics[width=.18\linewidth]{SupplimentFigures/tosca/ours/auto_centaur0.png}}
     &
    \raisebox{-0.5\height}{\includegraphics[width=.11\linewidth]{SupplimentFigures/tosca/ours/auto_centaur1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/ours/auto_centaur2.png}} & 
    \raisebox{-0.5\height}{\includegraphics[width=.14\linewidth]{SupplimentFigures/tosca/ours/auto_centaur3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/ours/auto_centaur4.png}} & 
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/ours/auto_centaur5.png}} &
    \rotatebox[origin=c]{270}{Ours} \\

    \raisebox{\height}{Source}
    &
    \raisebox{-0.5\height}{\includegraphics[width=.11\linewidth]{SupplimentFigures/tosca/isomush/auto_centaur1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/isomush/auto_centaur2.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.14\linewidth]{SupplimentFigures/tosca/isomush/auto_centaur3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/isomush/auto_centaur4.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/isomush/auto_centaur5.png}} &
    \rotatebox[origin=c]{270}{IsoMuSh} \\
    
    \ 
    &
    \raisebox{-0.5\height}{\includegraphics[width=.11\linewidth]{SupplimentFigures/tosca/zoomout/auto_centaur1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/zoomout/auto_centaur2.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.14\linewidth]{SupplimentFigures/tosca/zoomout/auto_centaur3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/zoomout/auto_centaur4.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/zoomout/auto_centaur5.png}} &
    \rotatebox[origin=c]{270}{ZoomOut} \\
    
    \ 
    &
    \raisebox{-0.5\height}{\includegraphics[width=.11\linewidth]{SupplimentFigures/tosca/qmatchnc/auto_centaur1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/qmatchnc/auto_centaur2.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.14\linewidth]{SupplimentFigures/tosca/qmatchnc/auto_centaur3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/qmatchnc/auto_centaur4.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/qmatchnc/auto_centaur5.png}} &
    \rotatebox[origin=c]{270}{Q-MatchV2-nc} \\
    
    \ 
    &
    \raisebox{-0.5\height}{\includegraphics[width=.11\linewidth]{SupplimentFigures/tosca/qmatchcc/auto_centaur1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/qmatchcc/auto_centaur2.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.14\linewidth]{SupplimentFigures/tosca/qmatchcc/auto_centaur3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/qmatchcc/auto_centaur4.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.13\linewidth]{SupplimentFigures/tosca/qmatchcc/auto_centaur5.png}} &
    \rotatebox[origin=c]{270}{Q-MatchV2-cc} \\
    
    \end{tabular}
    }


    \caption{Qualitative results on the TOSCA  \cite{bronstein2008numerical} centaur class. 
    We colour a source shape %
    and transfer this colouring to target shapes via the matches estimated by our method and competitors.%
    } 
    \label{fig:tosca_centaur} 
\end{figure*} 

\begin{figure*}[!ht]
   \centering
    \resizebox{\linewidth}{!}{
    \begin{tabular}{c|ccccccc}
    
    \raisebox{-0.5\height}{\includegraphics[width=.17\linewidth]{SupplimentFigures/tosca/ours/auto_david0.png}}
     &
    \raisebox{-0.5\height}{\includegraphics[width=.06\linewidth]{SupplimentFigures/tosca/ours/auto_david1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.11\linewidth]{SupplimentFigures/tosca/ours/auto_david2.png}} & 
    \raisebox{-0.5\height}{\includegraphics[width=.09\linewidth]{SupplimentFigures/tosca/ours/auto_david3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.06\linewidth]{SupplimentFigures/tosca/ours/auto_david4.png}} & 
    \raisebox{-0.5\height}{\includegraphics[width=.15\linewidth]{SupplimentFigures/tosca/ours/auto_david5.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.15\linewidth]{SupplimentFigures/tosca/ours/auto_david6.png}} &
    \rotatebox[origin=c]{270}{Ours} \\

    \raisebox{\height}{Source}
    &
    \raisebox{-0.5\height}{\includegraphics[width=.06\linewidth]{SupplimentFigures/tosca/isomush/auto_david1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.11\linewidth]{SupplimentFigures/tosca/isomush/auto_david2.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.09\linewidth]{SupplimentFigures/tosca/isomush/auto_david3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.06\linewidth]{SupplimentFigures/tosca/isomush/auto_david4.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.15\linewidth]{SupplimentFigures/tosca/isomush/auto_david5.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.15\linewidth]{SupplimentFigures/tosca/isomush/auto_david6.png}} &
    \rotatebox[origin=c]{270}{IsoMuSh} \\
    
    \ 
    &
    \raisebox{-0.5\height}{\includegraphics[width=.06\linewidth]{SupplimentFigures/tosca/zoomout/auto_david1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.11\linewidth]{SupplimentFigures/tosca/zoomout/auto_david2.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.09\linewidth]{SupplimentFigures/tosca/zoomout/auto_david3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.06\linewidth]{SupplimentFigures/tosca/zoomout/auto_david4.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.15\linewidth]{SupplimentFigures/tosca/zoomout/auto_david5.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.15\linewidth]{SupplimentFigures/tosca/zoomout/auto_david6.png}} &
    \rotatebox[origin=c]{270}{ZoomOut} \\
    
    \ 
    &
    \raisebox{-0.5\height}{\includegraphics[width=.06\linewidth]{SupplimentFigures/tosca/qmatchnc/auto_david1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.11\linewidth]{SupplimentFigures/tosca/qmatchnc/auto_david2.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.09\linewidth]{SupplimentFigures/tosca/qmatchnc/auto_david3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.06\linewidth]{SupplimentFigures/tosca/qmatchnc/auto_david4.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.15\linewidth]{SupplimentFigures/tosca/qmatchnc/auto_david5.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.15\linewidth]{SupplimentFigures/tosca/qmatchnc/auto_david6.png}} &
    \rotatebox[origin=c]{270}{Q-MatchV2-nc} \\
    
    \ 
    &
    \raisebox{-0.5\height}{\includegraphics[width=.06\linewidth]{SupplimentFigures/tosca/qmatchcc/auto_david1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.11\linewidth]{SupplimentFigures/tosca/qmatchcc/auto_david2.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.09\linewidth]{SupplimentFigures/tosca/qmatchcc/auto_david3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.06\linewidth]{SupplimentFigures/tosca/qmatchcc/auto_david4.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.15\linewidth]{SupplimentFigures/tosca/qmatchcc/auto_david5.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.15\linewidth]{SupplimentFigures/tosca/qmatchcc/auto_david6.png}} &
    \rotatebox[origin=c]{270}{Q-MatchV2-cc} \\
    
    \end{tabular}
    }


    \caption{Qualitative results on the TOSCA  \cite{bronstein2008numerical} David class. 
    We colour a source shape %
    and transfer this colouring to target shapes via the matches estimated by our method and competitors. %
    } 
    \label{fig:tosca_david} 
\end{figure*} 

\begin{figure*}[!ht]
   \centering
    \resizebox{\linewidth}{!}{
    \begin{tabular}{c|cccccc}
    
    \raisebox{-0.5\height}{\includegraphics[width=.1\linewidth]{SupplimentFigures/smal/ours/auto_dog2.png}}
     &
    \raisebox{-0.5\height}{\includegraphics[width=.09\linewidth]{SupplimentFigures/smal/ours/auto_dog1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.12\linewidth]{SupplimentFigures/smal/ours/auto_dog3.png}} & 
    \raisebox{-0.5\height}{\includegraphics[width=.14\linewidth]{SupplimentFigures/smal/ours/auto_dog7.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.1\linewidth]{SupplimentFigures/smal/ours/auto_dog8.png}} & 
    \raisebox{-0.5\height}{\includegraphics[width=.1\linewidth]{SupplimentFigures/smal/ours/auto_dog9.png}} &
    \rotatebox[origin=c]{270}{Ours} \\

    \raisebox{\height}{Source}
    &
    \raisebox{-0.5\height}{\includegraphics[width=.09\linewidth]{SupplimentFigures/smal/isomush/auto_dog1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.12\linewidth]{SupplimentFigures/smal/isomush/auto_dog3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.14\linewidth]{SupplimentFigures/smal/isomush/auto_dog7.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.1\linewidth]{SupplimentFigures/smal/isomush/auto_dog8.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.1\linewidth]{SupplimentFigures/smal/isomush/auto_dog9.png}} &
    \rotatebox[origin=c]{270}{IsoMuSh} \\
    
    \ 
    &
    \raisebox{-0.5\height}{\includegraphics[width=.09\linewidth]{SupplimentFigures/smal/zoomout/auto_dog1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.12\linewidth]{SupplimentFigures/smal/zoomout/auto_dog3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.14\linewidth]{SupplimentFigures/smal/zoomout/auto_dog7.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.1\linewidth]{SupplimentFigures/smal/zoomout/auto_dog8.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.1\linewidth]{SupplimentFigures/smal/zoomout/auto_dog9.png}} &
    \rotatebox[origin=c]{270}{ZoomOut} \\
    
    \ 
    &
    \raisebox{-0.5\height}{\includegraphics[width=.09\linewidth]{SupplimentFigures/smal/qmatchnc/auto_dog1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.12\linewidth]{SupplimentFigures/smal/qmatchnc/auto_dog3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.14\linewidth]{SupplimentFigures/smal/qmatchnc/auto_dog7.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.1\linewidth]{SupplimentFigures/smal/qmatchnc/auto_dog8.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.1\linewidth]{SupplimentFigures/smal/qmatchnc/auto_dog9.png}} &
    \rotatebox[origin=c]{270}{Q-MatchV2-nc} \\
    \ 
    &
    \raisebox{-0.5\height}{\includegraphics[width=.09\linewidth]{SupplimentFigures/smal/qmatchcc/auto_dog1.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.12\linewidth]{SupplimentFigures/smal/qmatchcc/auto_dog3.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.14\linewidth]{SupplimentFigures/smal/qmatchcc/auto_dog7.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.1\linewidth]{SupplimentFigures/smal/qmatchcc/auto_dog8.png}} &
    \raisebox{-0.5\height}{\includegraphics[width=.1\linewidth]{SupplimentFigures/smal/qmatchcc/auto_dog9.png}} &
    \rotatebox[origin=c]{270}{Q-MatchV2-cc} \\
    
    \end{tabular}
    }


    \caption{Qualitative results on a subset of the SMAL dog class.
    We colour a source shape %
    and transfer this colouring to target shapes via the matches estimated by our method and competitors. %
    } 
    \label{fig:smal_dog} 
\end{figure*} 



\begin{sidewaystable*}[!htbp]
    \centering
    \resizebox{\textwidth}{!}{ 
    \begin{tabular}{ccccccccc}\hline  Method & Problem & Transformation & Input Type  & \# Inputs  & \# Points  & \begin{tabular}{@{}c@{}}\# Qubits\\(per sweep)\end{tabular} & QPU & Iterative \\\hline\hline
    QA, CVPR 2020 \cite{golyanik2020quantum}        &  TE, PSR  & A/R    & point clouds          & $2$               & ${\leq}5k^{\star}$      & ${\leq}140$     & 2000Q &                \\\hline
    IQT, CVPR 2022 \cite{Meli_2022_CVPR}            & TE  & R          & point clouds          & $2$               & ${\leq}1.5k^{\star}$      & ${\leq}10$     & 2000Q &   \checkmark  \\\hline
    qKC, ICASSP 2022 \cite{NoormandipourWang2022}  & PSR   & R         & point clouds          & $2$               & ${\leq}2k^{\star}$      & $4${-}$6$       & Rigetti \cite{Rigetti} &   \checkmark  \\\hline
    QGM, 3DV 2020 \cite{SeelbachBenkner2020}        & GM   & F         & graphs                & $2$               & ${\leq}4$               & ${\leq}50$               & 2000Q &               \\\hline
    QSync, CVPR 2021 \cite{QuantumSync2021}         & PS, GM & F       & perm.~matrices  & ${\leq}5$         & ${\leq}5$               & $\leq1.5k$      & Adv1.1&               \\\hline
    QuMoSeg, ECCV 2022 \cite{Arrigoni2022}         & MS & F       & segm.~matrices  & ${\leq}9$         & ${\leq}200$               & $\leq250$      & Adv\{1.1;4.1\}&               \\\hline
    Q-Match, ICCV 2021 \cite{SeelbachBenkner2021}   & MA  & R/NR          & meshes                & $2$               & ${\leq}500$             & ${\leq}200$                & Adv4.1 &   \checkmark  \\\hline
    CCuantuMM (Ours)                                   & MA & R/NR           & meshes                & ${\leq}100$        & ${\leq}1k$           &     ${\leq}50$        & \begin{tabular}{@{}c@{}}Adv4.1,\\Adv2 prototype\end{tabular}  &   \checkmark  \\\hline
    \end{tabular}
    }
    \caption{Overview of related quantum methods for alignment tasks on point sets, graphs and meshes. ``$^\star$'': according to the experiments reported in the paper; the methods can also process larger point clouds. Key: ``TE'': transformation estimation; ``PSR'': point set alignment; ``GM'': graph matching; ``PS'': permutation synchronisation; ``MS'': motion segmentation; ``MA'': mesh alignment; ``A'': affine transformation; ``R'': rigid transformation; ``NR'': non-rigid deformations; ``F'': the method operates on features extracted in a pre-processing step (and can support both rigid and non-rigid transformations). 
    Note that only Q-Match \cite{SeelbachBenkner2021} can be extended and applied to our data. 
    } 
    \label{tab:related_work} 
\end{sidewaystable*}





\end{document}

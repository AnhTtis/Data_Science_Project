\begin{tikzpicture}[>=latex',line join=bevel,every node/.style={scale=0.5},scale=0.75,shading=coolwarm]
    \def\xshift{3.5}
    
    \tikzset{
    ultra thick/.style={line width=6pt}
    }

    % labels
    \node[anchor=south] (X) at (-2*\xshift+1,2.5) {\LARGE$X$};
    \node[anchor=south] (Y) at (-\xshift+1.25,2.5) {\LARGE$Y$};
    \node[anchor=south] (Z) at (\xshift+1,2.5) {\LARGE$Z=X\times Y$};

    % nodes
    \node[fill=white] (01) at (-2*\xshift,0) [draw,circle] {1};
    \node[fill=white] (02) at (-2*\xshift+0.5,2) [draw,circle] {2};
    \node[fill=white] (03) at (-2*\xshift+2,1) [draw,circle] {3};
    \node[fill=white] (04) at (-2*\xshift+1.5,-1) [draw,circle] {4};

    \foreach \t/\label in {1/a,2/b,3/c} {
        \begin{pgfonlayer}{ffg}
            \node[fill=white] (\t1) at (\t*\xshift-\xshift,0) [draw,circle] {1\label};
        \end{pgfonlayer}
        
        \begin{pgfonlayer}{fg}
            \node[fill=white] (\t2) at (\t*\xshift-\xshift+0.5,2) [draw,circle] {2\label};
            \node[fill=white] (\t4) at (\t*\xshift-\xshift+1.5,-1) [draw,circle] {4\label};
        \end{pgfonlayer}
        
        \begin{pgfonlayer}{background}
            \node[fill=white] (\t3) at (\t*\xshift-\xshift+2,1) [draw,circle] {3\label};
        \end{pgfonlayer}
    }
    
    \node[fill=white] (p1) at (-\xshift+0.25,2) [draw,circle] {a};
    \node[fill=white] (p2) at (-\xshift+1.25,0.5) [draw,circle] {b};
    \node[fill=white] (p3) at (-\xshift+2.25,-1) [draw,circle] {c};
    
    % path edges
    \draw [blue] (p1) -- (p2) -- (p3);

    % connecting edges
    \foreach \n/\layer in {1/main,2/main,3/background,4/main} {
        \foreach \t/\nextt in {1/2,2/3} {
            \begin{pgfonlayer}{\layer}
                \draw [white, ultra thick] (\t\n) edge (\nextt\n);
                \draw [blue] (\t\n) edge (\nextt\n);
            \end{pgfonlayer}
        }
    }
    
    % root edges
    \foreach \t in {0,1,2,3} {
        \foreach \ni/\nt/\layer in {1/2/main,1/3/main,1/4/main,3/4/background} {
            \begin{pgfonlayer}{\layer}
                \draw [white, ultra thick] (\t\ni) edge (\t\nt);
                \draw [red] (\t\ni) edge (\t\nt);
            \end{pgfonlayer}
        }
    }
    
    % https://tex.stackexchange.com/questions/82821/how-can-i-shrink-a-path-to-the-center
    % i have looked the devil in the eyes
    \foreach \t/\nextt in {1/2,2/3} {
        \foreach \ni/\nt/\offset in {1/2/8pt,1/3/6pt,4/1/5pt,4/3/8pt} {
            \def\prev{\t\ni}
            \def\this{\nextt\ni}
            
            \foreach \next in {\nextt\nt,\t\nt,\t\ni,\nextt\ni} {
                \path[name path=first] ($(\prev)!\offset!90:(\this)$) --
                    ($(\this)!\offset!-90:(\prev)$);
                    
                \path[name path=second] ($(\this)!\offset!90:(\next)$) --
                    ($(\next)!\offset!-90:(\this)$);
                    
                \path[name intersections={of=first and second}] coordinate
                    (\prev-\this-\next) at (intersection-1);
                    
                \global\let\prev=\this
                \global\let\this=\next
            }
            
            \begin{pgfonlayer}{fg}
                \fill [fill=gray, fill opacity=0.2, rounded corners]
                    (\nextt\nt-\t\nt-\t\ni.center) -- (\t\nt-\t\ni-\nextt\ni.center) -- 
                    (\t\ni-\nextt\ni-\nextt\nt.center) -- (\nextt\ni-\nextt\nt-\t\nt.center) -- 
                    cycle;
            \end{pgfonlayer}
        }
    }
\end{tikzpicture}

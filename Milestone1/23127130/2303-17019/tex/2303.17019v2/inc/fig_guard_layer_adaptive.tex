\def\colorCellBndr{jr@blue}
\def\colorCellFill{jr@pink!45}
\def\colorCellNode{black}
\def\colorGuardBndr{jr@brown}
\def\colorGuardFill{jr@orange!45}
\def\colorGuardNode{jr@brown}
\def\tikzscale{1.0}
\tikzset{
  cellSty/.style={thick},
  gridSty/.style={thin, dashed},
  nodeSty/.style={thick},
  axisSty/.style={->, gray},
  labelSty/.style={black, font=\footnotesize, align=left},
  titleSty/.style={black, font=\footnotesize\bfseries, align=center},
}
\begin{tikzpicture}[scale=\tikzscale]
  %
  % axis
  %
  \begin{scope}[shift={(-3.5,0)}]
  \draw[axisSty] (0,0) -- (0.5, 0) node[labelSty, anchor=west ] {$p$};
  \draw[axisSty] (0,0) -- (0, 0.5) node[labelSty, anchor=south] {$\xi$};
  \end{scope}

  %
  % coarse to fine
  %
  \begin{scope}
  % title
  \node[titleSty] at (-0.5,2.4) {Filling a guard layer with\\coarse-to-fine interpolation};

  % guard, left
  \draw[fill=\colorGuardFill            ] (-2,0) rectangle +(2,2);
  \draw[gridSty, \colorGuardBndr, step=1] (-2,0) grid      +(2,2);
  \draw[cellSty, \colorGuardBndr        ] (-2,0) rectangle +(2,2);
    % nodes
    \draw[nodeSty, \colorGuardNode, fill=\colorGuardNode] (-1.5,0.5) circle [radius=0.1];
    \draw[nodeSty, \colorGuardNode, fill=\colorGuardNode] (-0.5,0.5) circle [radius=0.1];
    \draw[nodeSty, \colorGuardNode, fill=\colorGuardNode] (-1.5,1.5) circle [radius=0.1];
    \draw[nodeSty, \colorGuardNode, fill=\colorGuardNode] (-0.5,1.5) circle [radius=0.1];
    % guard nodes
    \draw[nodeSty, \colorCellNode,                      ] (-1.5,0.25) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode,                      ] (-0.5,0.25) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode,                      ] (-1.5,0.75) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode,                      ] (-0.5,0.75) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode,                      ] (-1.5,1.25) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode,                      ] (-0.5,1.25) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode,                      ] (-1.5,1.75) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode,                      ] (-0.5,1.75) circle [radius=0.05];

  % fine cell, top
  \draw[fill=\colorCellFill              ] (0,0) rectangle +(1,1);
  \draw[gridSty, \colorCellBndr, step=0.5] (0,0) grid      +(1,1);
  \draw[cellSty, \colorCellBndr          ] (0,0) rectangle +(1,1);
    % nodes
    \draw[nodeSty, \colorCellNode, fill=\colorCellNode] (0.25,0.25) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode, fill=\colorCellNode] (0.75,0.25) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode, fill=\colorCellNode] (0.25,0.75) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode, fill=\colorCellNode] (0.75,0.75) circle [radius=0.05];
  % fine cell, bottom
  \draw[fill=\colorCellFill              ] (0,1) rectangle +(1,1);
  \draw[gridSty, \colorCellBndr, step=0.5] (0,1) grid      +(1,1);
  \draw[cellSty, \colorCellBndr          ] (0,1) rectangle +(1,1);
    % nodes
    \draw[nodeSty, \colorCellNode, fill=\colorCellNode] (0.25,1.25) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode, fill=\colorCellNode] (0.75,1.25) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode, fill=\colorCellNode] (0.25,1.75) circle [radius=0.05];
    \draw[nodeSty, \colorCellNode, fill=\colorCellNode] (0.75,1.75) circle [radius=0.05];
  \end{scope}

  %
  % fine to coarse
  %
  \begin{scope}[shift={(4,0)}]
  % title
  \node[titleSty] at (+0.5,2.4) {Filling a guard layer with\\fine-to-coarse interpolation};

  % guard, left, top
  \draw[fill=\colorGuardFill              ] (-1,0) rectangle +(1,1);
  \draw[gridSty, \colorGuardBndr, step=0.5] (-1,0) grid      +(1,1);
  \draw[cellSty, \colorGuardBndr          ] (-1,0) rectangle +(1,1);
    % nodes
    \draw[nodeSty, \colorGuardNode, fill=\colorGuardNode] (-0.75,0.25) circle [radius=0.05];
    \draw[nodeSty, \colorGuardNode, fill=\colorGuardNode] (-0.25,0.25) circle [radius=0.05];
    \draw[nodeSty, \colorGuardNode, fill=\colorGuardNode] (-0.75,0.75) circle [radius=0.05];
    \draw[nodeSty, \colorGuardNode, fill=\colorGuardNode] (-0.25,0.75) circle [radius=0.05];
  % guard, left, bottom
  \draw[fill=\colorGuardFill              ] (-1,1) rectangle +(1,1);
  \draw[gridSty, \colorGuardBndr, step=0.5] (-1,1) grid      +(1,1);
  \draw[cellSty, \colorGuardBndr          ] (-1,1) rectangle +(1,1);
    % nodes
    \draw[nodeSty, \colorGuardNode, fill=\colorGuardNode] (-0.75,1.25) circle [radius=0.05];
    \draw[nodeSty, \colorGuardNode, fill=\colorGuardNode] (-0.25,1.25) circle [radius=0.05];
    \draw[nodeSty, \colorGuardNode, fill=\colorGuardNode] (-0.75,1.75) circle [radius=0.05];
    \draw[nodeSty, \colorGuardNode, fill=\colorGuardNode] (-0.25,1.75) circle [radius=0.05];

  % guard nodes
  \draw[nodeSty, \colorCellNode,                      ] (-0.75,0.5) circle [radius=0.1];
  \draw[nodeSty, \colorCellNode,                      ] (-0.25,0.5) circle [radius=0.1];
  \draw[nodeSty, \colorCellNode,                      ] (-0.75,1.5) circle [radius=0.1];
  \draw[nodeSty, \colorCellNode,                      ] (-0.25,1.5) circle [radius=0.1];

  % cell
  \draw[fill=\colorCellFill            ] (0,0) rectangle +(2,2);
  \draw[gridSty, \colorCellBndr, step=1] (0,0) grid      +(2,2);
  \draw[cellSty, \colorCellBndr        ] (0,0) rectangle +(2,2);
    % nodes
    \draw[nodeSty, \colorCellNode, fill=\colorCellNode] ( 0.5,0.5) circle [radius=0.1];
    \draw[nodeSty, \colorCellNode, fill=\colorCellNode] ( 1.5,0.5) circle [radius=0.1];
    \draw[nodeSty, \colorCellNode, fill=\colorCellNode] ( 0.5,1.5) circle [radius=0.1];
    \draw[nodeSty, \colorCellNode, fill=\colorCellNode] ( 1.5,1.5) circle [radius=0.1];
  \end{scope}

\end{tikzpicture}

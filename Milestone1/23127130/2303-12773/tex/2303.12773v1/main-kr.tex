\documentclass{article}
\pdfpagewidth=8.5in
\pdfpageheight=11in

\usepackage{kr}

\usepackage{times}
\usepackage{soul}
\usepackage{url}
\usepackage[hidelinks]{hyperref}
\usepackage[utf8]{inputenc}
\usepackage[small]{caption}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{booktabs}
\usepackage{algorithm}
\usepackage{algorithmic}
\urlstyle{same}
\usepackage{comment}
\usepackage{amssymb}

% the following package is optional:
%\usepackage{latexsym}

\input{macros.tex}

\newtheorem{example}{Example}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{definitionAux}[theorem]{Definition}
\newenvironment{definition}{\begin{definitionAux}
	}{\end{definitionAux}}


\pdfinfo{
/TemplateVersion (KR.2022.0, KR.2023.0)
}


\title{The Complexity of Why-Provenance for Datalog Queries}

\author{
	Marco Calautti$^1$\and
	Ester Livshits$^2$\and
	Andreas Pieris$^{2,3}$\and
	Markus Schneider$^2$\\
	\affiliations
	$^1$Department of Computer Science, University of Milan\\
	$^2$School of Informatics, University of Edinburgh\\
	$^3$Department of Computer Science, University of Cyprus\\[1mm]
	\emails 
	marco.calautti{@}unimi.it, ester.livshits{@}ed.ac.uk,
	apieris{@}inf.ed.ac.uk, m.schneider{@}ed.ac.uk
}

\begin{document}

\maketitle

%\begin{comment}
\begin{abstract}
Explaining why a database query result is obtained is an essential task towards the goal of Explainable AI, especially nowadays where expressive database query languages such as Datalog play a critical role in the development of ontology-based applications. A standard way of explaining a query result is the so-called why-provenance, which essentially provides information about the witnesses to a query result in the form of subsets of the input database that are sufficient to derive that result. To our surprise, despite the fact that the notion of why-provenance for Datalog queries has been around for decades and intensively studied, its computational complexity remains unexplored. The goal of this work is to fill this apparent gap in the why-provenance literature. Towards this end, we pinpoint the data complexity of why-provenance for Datalog queries and key subclasses thereof. The takeaway of our work is that why-provenance for recursive queries, even if the recursion is limited to be linear, is an intractable problem, whereas for non-recursive queries is highly tractable. Having said that, we experimentally confirm, by exploiting SAT solvers, that making why-provenance for (recursive) Datalog queries work in practice is not an unrealistic goal.
\end{abstract}
%\end{comment}

\input{introduction.tex}
\input{preliminaries.tex}
\input{why-provenance.tex}
\input{complexity.tex}
%\input{refined-trees.tex}
\input{unambiguous-trees.tex}
\input{conclusions.tex}

\bibliographystyle{kr}
%\bibliography{references}

\begin{thebibliography}{}
	\bibitem[\protect\citeauthoryear{Abiteboul, Hull, and Vianu}{1995}]{AbHV95}
	Abiteboul, S.; Hull, R.; and Vianu, V.
	\newblock 1995.
	\newblock {\em Foundations of Databases}.
	\newblock Addison-Wesley.
	
	\bibitem[\protect\citeauthoryear{Adrian \bgroup et al\mbox.\egroup
	}{2018}]{AACC+18}
	Adrian, W.~T.; Alviano, M.; Calimeri, F.; Cuteri, B.; Dodaro, C.; Faber, W.;
	Fusc{\`{a}}, D.; Leone, N.; Manna, M.; Perri, S.; Ricca, F.; Veltri, P.; and
	Zangari, J.
	\newblock 2018.
	\newblock The {ASP} system {DLV:} advancements and applications.
	\newblock {\em K{\"{u}}nstliche Intell.} 32(2-3):177--179.
	
	\bibitem[\protect\citeauthoryear{Audemard and Simon}{2018}]{Audemard18}
	Audemard, G., and Simon, L.
	\newblock 2018.
	\newblock On the glucose {SAT} solver.
	\newblock {\em Int. J. Artif. Intell. Tools} 27(1):1840001:1--1840001:25.
	
	\bibitem[\protect\citeauthoryear{Benedikt \bgroup et al\mbox.\egroup
	}{2022}]{BBGKM22}
	Benedikt, M.; Buron, M.; Germano, S.; Kappelmann, K.; and Motik, B.
	\newblock 2022.
	\newblock Rewriting the infinite chase.
	\newblock {\em PVLDB} 15(11):3045--3057.
	
	\bibitem[\protect\citeauthoryear{Bourgaux \bgroup et al\mbox.\egroup
	}{2022}]{BBPT22}
	Bourgaux, C.; Bourhis, P.; Peterfreund, L.; and Thomazo, M.
	\newblock 2022.
	\newblock Revisiting semiring provenance for datalog.
	\newblock In {\em KR}.
	
	\bibitem[\protect\citeauthoryear{Buneman, Khanna, and Tan}{2001}]{BuKT01}
	Buneman, P.; Khanna, S.; and Tan, W.~C.
	\newblock 2001.
	\newblock Why and where: {A} characterization of data provenance.
	\newblock In {\em ICDT},  316--330.
	
	\bibitem[\protect\citeauthoryear{Cook}{1974}]{Cook74}
	Cook, S.~A.
	\newblock 1974.
	\newblock An observation on time-storage trade off.
	\newblock {\em J. Comput. Syst. Sci.} 9(3):308--316.
	
	\bibitem[\protect\citeauthoryear{Dam{\'{a}}sio, Analyti, and
		Antoniou}{2013}]{DaAA13}
	Dam{\'{a}}sio, C.~V.; Analyti, A.; and Antoniou, G.
	\newblock 2013.
	\newblock Justifications for logic programming.
	\newblock In {\em LPNMR},  530--542.
	
	\bibitem[\protect\citeauthoryear{Dantsin \bgroup et al\mbox.\egroup
	}{2001}]{DEGV01}
	Dantsin, E.; Eiter, T.; Gottlob, G.; and Voronkov, A.
	\newblock 2001.
	\newblock Complexity and expressive power of logic programming.
	\newblock {\em {ACM} Comput. Surv.} 33(3):374--425.
	
	\bibitem[\protect\citeauthoryear{Deutch \bgroup et al\mbox.\egroup
	}{2014}]{DMRT14}
	Deutch, D.; Milo, T.; Roy, S.; and Tannen, V.
	\newblock 2014.
	\newblock Circuits for datalog provenance.
	\newblock In {\em ICDT},  201--212.
	
	\bibitem[\protect\citeauthoryear{Eiter \bgroup et al\mbox.\egroup
	}{2012}]{EOSTX12}
	Eiter, T.; Ortiz, M.; Simkus, M.; Tran, T.; and Xiao, G.
	\newblock 2012.
	\newblock Query rewriting for horn-shiq plus rules.
	\newblock In {\em AAAI}.
	
	\bibitem[\protect\citeauthoryear{Elhalawati, Kr{\"{o}}tzsch, and
		Mennicke}{2022}]{ElKM22}
	Elhalawati, A.; Kr{\"{o}}tzsch, M.; and Mennicke, S.
	\newblock 2022.
	\newblock An existential rule framework for computing why-provenance on-demand
	for datalog.
	\newblock In {\em RuleML+RR}.
	
	\bibitem[\protect\citeauthoryear{Esparza, Luttenberger, and
		Schlund}{2014}]{EsLS14}
	Esparza, J.; Luttenberger, M.; and Schlund, M.
	\newblock 2014.
	\newblock Fpsolve: {A} generic solver for fixpoint equations over semirings.
	\newblock In {\em CIAA},  1--15.
	
	\bibitem[\protect\citeauthoryear{Fan, Mallireddy, and Koutris}{2022}]{FanMK22}
	Fan, Z.; Mallireddy, S.; and Koutris, P.
	\newblock 2022.
	\newblock Towards better understanding of the performance and design of datalog
	systems.
	\newblock In {\em Datalog 2.0},  166--180.
	
	\bibitem[\protect\citeauthoryear{Gebser \bgroup et al\mbox.\egroup
	}{2016}]{GKKOSW16}
	Gebser, M.; Kaminski, R.; Kaufmann, B.; Ostrowski, M.; Schaub, T.; and Wanko,
	P.
	\newblock 2016.
	\newblock Theory solving made easy with clingo 5.
	\newblock In {\em ICLP},  2:1--2:15.
	
	\bibitem[\protect\citeauthoryear{Kazakov, Kr{\"{o}}tzsch, and
		Simancik}{2014}]{KazakovKS14}
	Kazakov, Y.; Kr{\"{o}}tzsch, M.; and Simancik, F.
	\newblock 2014.
	\newblock The incredible {ELK} - from polynomial procedures to efficient
	reasoning with {EL} ontologies.
	\newblock {\em J. Autom. Reason.} 53(1):1--61.
	
	\bibitem[\protect\citeauthoryear{Lee, Lud{\"{a}}scher, and
		Glavic}{2019}]{LeLG19}
	Lee, S.; Lud{\"{a}}scher, B.; and Glavic, B.
	\newblock 2019.
	\newblock {PUG:} a framework and practical implementation for why and why-not
	provenance.
	\newblock {\em {VLDB} J.} 28(1):47--71.
	
	\bibitem[\protect\citeauthoryear{Leone \bgroup et al\mbox.\egroup
	}{2006}]{LPFEGPS06}
	Leone, N.; Pfeifer, G.; Faber, W.; Eiter, T.; Gottlob, G.; Perri, S.; and
	Scarcello, F.
	\newblock 2006.
	\newblock The {DLV} system for knowledge representation and reasoning.
	\newblock {\em {ACM} Trans. Comput. Log.} 7(3):499--562.
	
	\bibitem[\protect\citeauthoryear{Leone \bgroup et al\mbox.\egroup
	}{2019}]{LAAC+19}
	Leone, N.; Allocca, C.; Alviano, M.; Calimeri, F.; Civili, C.; Costabile, R.;
	Fiorentino, A.; Fusc{\`{a}}, D.; Germano, S.; Laboccetta, G.; Cuteri, B.;
	Manna, M.; Perri, S.; Reale, K.; Ricca, F.; Veltri, P.; and Zangari, J.
	\newblock 2019.
	\newblock Enhancing {DLV} for large-scale reasoning.
	\newblock In {\em {LPNMR}},  312--325.
	
	\bibitem[\protect\citeauthoryear{McAuley and Leskovec}{2012}]{McAuley12}
	McAuley, J., and Leskovec, J.
	\newblock 2012.
	\newblock Learning to discover social circles in ego networks.
	\newblock In {\em {NIPS}},  539â€“547.
	
	\bibitem[\protect\citeauthoryear{Rankooh and Rintanen}{2022}]{RankoohR22}
	Rankooh, M.~F., and Rintanen, J.
	\newblock 2022.
	\newblock Propositional encodings of acyclicity and reachability by using
	vertex elimination.
	\newblock In {\em {AAAI}},  5861--5868.
	
	\bibitem[\protect\citeauthoryear{{The Oxford Library}}{2007}]{Galen}
	{The Oxford Library}.
	\newblock 2007.
	\newblock Galen ontology.
	
	\bibitem[\protect\citeauthoryear{Vardi}{1995}]{Vardi95}
	Vardi, M.~Y.
	\newblock 1995.
	\newblock On the complexity of bounded-variable queries.
	\newblock In {\em PODS},  266--276.
	
	\bibitem[\protect\citeauthoryear{Weber \bgroup et al\mbox.\egroup
	}{2019}]{Weber19}
	Weber, M.; Domeniconi, G.; Chen, J.; Weidele, D. K.~I.; Bellei, C.; Robinson,
	T.; and Leiserson, C.~E.
	\newblock 2019.
	\newblock Anti-money laundering in bitcoin: Experimenting with graph
	convolutional networks for financial forensics.
	\newblock {\em CoRR} abs/1908.02591.
	
	\bibitem[\protect\citeauthoryear{Zhao, Subotic, and Scholz}{2020}]{ZhSS20}
	Zhao, D.; Subotic, P.; and Scholz, B.
	\newblock 2020.
	\newblock Debugging large-scale datalog: {A} scalable provenance evaluation
	strategy.
	\newblock {\em {ACM} Trans. Program. Lang. Syst.} 42(2):7:1--7:35.
\end{thebibliography}

\newpage
\appendix

\input{app-all-trees.tex}
\input{app-refined-trees.tex}
\input{app-unambiguous-trees.tex}
\end{document}


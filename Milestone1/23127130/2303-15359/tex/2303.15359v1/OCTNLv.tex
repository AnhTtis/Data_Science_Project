%\pdfoutput=1
\documentclass[%
reprint,
superscriptaddress,
%groupedaddress,
%unsortedaddress,
%runinaddress,
%frontmatterverbose,
%preprint,
%nofootinbib,
%nobibnotes,
%bibnotes,
amsmath,amssymb,
aps,
pra,
%prb,
%rmp,
%prstab,
%prstper,x
%floatfix,
]{revtex4-1}

%\usepackage{acrofont}%NOTE: Comment out this line for the release version!
\newcommand{\revtex}{REV\TeX\ }
\newcommand{\classoption}[1]{\texttt{#1}}
\newcommand{\macro}[1]{\texttt{\textbackslash#1}}
\newcommand{\m}[1]{\macro{#1}}
\newcommand{\env}[1]{\texttt{#1}}
\setlength{\textheight}{9.5in}

%\usepackage{array}
\usepackage{graphicx}% Include figure files
\usepackage{subfigure}
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{braket}
\usepackage{xcolor}
\usepackage[colorlinks, linkcolor=red, anchorcolor=blue,urlcolor=blue, citecolor=blue]{hyperref}% add hypertext capabilities
\usepackage{amsmath}
\usepackage{academicons}
%\newcommand{\ket}[1]{\vert{#1}\rangle}
\newcommand{\unit}{1\hspace{-0.24em}\mathrm{l}}
%\newcommand{\orcid}[1]{\href{https://orcid.org/#1}{\textcolor[HTML]{A6CE39}{\aiOrcid}}}
%\newcommand{\dert}{\frac{d}{dt}}
\newcommand{\XC}{\color{red}}


\begin{document}

	%\title{Robust control to adiabatic passage in nonlinear two- and three-level systems}
	\title{Optimal control and ultimate bounds of 1:2 nonlinear quantum systems}
	
\author{Jing-jun Zhu
\href{https://orcid.org/0000-0002-4277-1730}{\includegraphics[scale=0.05]{ORCIDiD.eps}}}
\affiliation{Laboratoire Interdisciplinaire Carnot de Bourgogne, CNRS UMR 6303, Universit\'e de Bourgogne,
	BP 47870, 21078 Dijon, France}
\affiliation{International Center of Quantum Artificial Intelligence for Science and Technology (QuArtist) and Department of Physics, Shanghai University, Shanghai 200444, China}
\author{Kaipeng Liu
\href{https://orcid.org/000-0002-5642-8458}{\includegraphics[scale=0.05]{ORCIDiD.eps}}}
\affiliation{International Center of Quantum Artificial Intelligence for Science and Technology (QuArtist) and Department of Physics, Shanghai University, Shanghai 200444, China}

\author{Xi Chen
\href{https://orcid.org/0000-0003-4221-4288}{\includegraphics[scale=0.05]{ORCIDiD.eps}}}
\affiliation{Department of Physical Chemistry, University of the Basque Country UPV/EHU, Apartado 644, 48080 Bilbao, Spain}
\affiliation{EHU Quantum Center, University of the Basque Country UPV/EHU, Barrio Sarriena, s/n, 48940 Leioa, Spain}


\author{St\'ephane Gu\'erin \href{https://orcid.org/0000-0002-9826-95988}{\includegraphics[scale=0.05]{ORCIDiD.eps}}}
\email{sguerin@u-bourgogne.fr}
\affiliation{Laboratoire Interdisciplinaire Carnot de Bourgogne, CNRS UMR 6303, Universit\'e de Bourgogne,
	BP 47870, 21078 Dijon, France}
\date{\today}
	\begin{abstract}	
Using optimal control, we establish and link the ultimate bounds in time (referred to as quantum speed limit) and energy of two- and three-level quantum nonlinear systems which feature 1:2 resonance. Despite the unreachable complete inversion, by using the Pontryagin maximum principle, we determine the optimal time, pulse area, or energy, for a given arbitrary accuracy. We show that the third-order Kerr terms can be absorbed in the detuning in order to lock the dynamics to the resonance.
In the two-level problem, we determine the non-linear counterpart of the optimal $\pi$-pulse inversion for a given accuracy.
In the three-level problem, we obtain an intuitive pulse sequence similar to the linear counterpart but with different shapes. We prove the (slow) logarithmic increasing of the optimal time as a function of the accuracy. 
	\end{abstract}

\maketitle
	
\section{Introduction}
The accurate control of quantum dynamics is at the core of the quantum world. Quantum control protocols have been developed in order to design specific shaped pulses  including composite \cite{CPlevitt,Wimperis,CPprl106,Jones,CPprl129,CPnjp24}, adiabatic \cite{STIRAP,STIRAP2,UltrafastSTIRAP}, shortcut to adiabatic \cite{STA,robustNJP,STA2,pra103} and single-shot shaped pulse \cite{SSprl111,Hybrid,Laforgue} techniques.
%with applications in various systems such as neutral atoms in optical traps \cite{Henriet2020QuantumCW}, trapped ions \cite{ions},
%%\cite{atom_pra}, 
%%quantum dot \cite{qdots_chen}, semiconductors \cite{semiconduc_nature},
%solid-state spins \cite{Mintert},
%superconducting devices \cite{superconduc_nature,SPQ} and Bose-Einstein condensates (BEC) \cite{BEC}.  Quantum control protocols have been developed in order to design specific shaped pulses resistant against fluctuations including composite \cite{CPlevitt,Wimperis,CPprl106,Jones,CPprl129,CPnjp24}, adiabatic \cite{STIRAP,STIRAP2,UltrafastSTIRAP}, shortcut to adiabatic \cite{STA,robustNJP,STA2,pra103} and single-shot shaped pulse \cite{SSprl111,Hybrid,Laforgue} techniques. 
However, these protocols, even when accelerated compared to standard adiabatic passage, 
do not specifically control the time of operation, 
%require relatively long time operations to achieve high-precision efficiency 
which can lead to severe obstructions to experimental implementation. 
%\cite{warrenz_science,rabitz_science,nielsen_quantuminfor}.
In this context, optimal control theory (OCT)  \cite{OCT} has emerged as a powerful tool to mitigate intensities of pulses 
%and speed up the evolution with a controlled time. It 
allowing one to attain the ultimate time bound in the system, which is also interpreted as quantum speed limit (QSL) \cite{prl103_Tomaso,prl111,Frey,pra98}. 
%Linear two- and three- have been widely explored to pursue the accuracy and speed in the quantum control process . 
Besides numerical implementation of OCT, such as monotonically convergent iteration algorithm \cite{OPalgorRuths134,OPalgorzhu108,OPalgorzhu110,nonOppra78}, global Krotov method \cite{Krotov}, gradient ascent algorithms (GRAPE) \cite{GRAPE}, 
%shooting method \cite{shooting}, 
one can highlight
%Techniques that implement OCT include 
%such as Lyapunov quantum control \cite{LyapunovcontrolXXY,Lyapunov}, 
%geometric control theory \cite{geometrcontrol}, 
Pontryagin maximum principle (PMP) \cite{PMP,Boscain,Extended,PMPprx}, which, transforming the initial infinite-dimension control problem into a finite dimension problem, allows analytic derivation of the optimal controls (typically with respect to time or energy). One can also mention recent geometric approaches \cite{Barnes,Dridi,Dridi2} treating simultaneously robust and optimal control. 

%A majority of works based on PMP have been established about linear interaction between various quantum platforms and electric-magnetic field, e.g., optimal control of 
%qubit gate in the view of geometric principles \cite{OPprl125}. 
The extension of quantum control techniques to non-linear quantum systems relevant to describe BEC, e.g. when one considers the conversion from atomic to molecular BEC leading to a so-called 1:2 Fermi resonance \cite{pra65_Drummond}, is a non-trivial issue. The system has to be reinterpreted and analyzed with tools from classical mechanics, where the concept of integrability,  without counterpart in the standard linear quantum physics, plays an important role \cite{classical_H,Henrard}. When the system is integrable, adiabatic passage techniques can be formulated with trajectories formed by the instantaneous (stable) elliptic fixed points defined at each value of the adiabatic parameters and continuously connected to the initial condition. Obstructions to classical adiabatic passage are given by the crossing of a separatrix \cite{prl99_Itin,pra_SG,epl_stephane}. In addition, for a two-level problem with a 1:2 resonance, the north pole of the generalized Bloch sphere (associated to the upper state and thus corresponding to a complete population transfer from the ground state) is unstable since it is associated to an hyperbolic fixed point in the classical phase space representation \cite{pra102_Jingjun}. This prevents adiabatic passage to be robust when it approaches the north pole. The system is not controllable at this point in the sense that the nonlinearity prevents reaching the upper state exactly \cite{pra_SG}. However, one can approach it as closely as required, and inverse-engineering techniques \cite{prl119_Stephane,STAOPnon} have been developed for that purpose.

Ultimate bounds, e.g. quantum speed limit \cite{prl111}, can be defined via the minimization of a given cost (such as time, pulse area or energy) determined from optimal control; their extension to nonlinear systems is an open question. The purpose of this work is to establish and link these ultimate bounds in terms of time and energy using optimal control. We present a complete study of optimal control via the PMP for the two- and three-level systems featuring a 1:2 resonance, considering the cost as time or energy. Since the complete inversion from the ground state is unreachable, we define the target with a given (arbitrary) accuracy. This work completes the analysis made in \cite{pra94xc} for the nonlinear two-level system. 
%and we determine optimum time, area and energy.
Among the results, we extend the notion of (optimal) $\pi$-pulse \cite{Boscain} to nonlinear systems (for a given accuracy) and show the asymptotic logarithmic increasing of the optimal time as a function of the accuracy instead of Rabi oscillations.
We also show the similarity with the linear case: the nonlinear dynamics is shown to be identical for time or energy optimum with a constant pulse (or constant generalized pulse in the case of the three-level system). 

%Some progress has been achieved, e.g., based on the generalized Ermakov equation for the expansion (compression) of Bose-Einstein condensate in harmonic trap \cite{STAOPnon}, PMP applied to non-linear two-level systems \cite{pra94xc}, and the loading of a Bose-Einstein condensate onto an optical lattice \cite{nonOppra66}. 
%time-optimal control of dissipative spin $\frac{1}{2}$ particles \cite{PMPprl104} and optimal coherent control in dissipative $N$-level system\cite{Opdissipative} to name a few. 
%however, whererin always carry too much computation and increase the complexity of understanding for non-expert readers.
%{\color{red}to connect with quantum speed limit? How to know the optimal time is equivalent to quantum speed limit. Compare with two-level system, the coincidence of numeric and analytic proves the numerical method is efficient. Different initial boundary values correspond to same control function!!}

% When the pulse area is smaller than the analytic, population can not be reached. If still increase the pulse area, there are many control functions can realize the goal. What's more, if the time approaches to the adiabatic limit, the numeric gives out the same function as initial guess? How to prove our numeric is providing non-local minima (quantum speed limit)?

%{\color{blue}In Laudau-Zener model, it is known that the excitation transition probability in the adiabatic limit $t\to\infty$ is $1-F=\exp{\frac{-2\pi\Omega^{2}}{\alpha}}=1-\epsilon$. By assuming the same final population in OC protocol, we can not construct the relationship between optimal time and error $\epsilon$?
%}

Section \ref{model-1} and \ref{model} are devoted to two- and three-states problems, respectively. We conclude in Section \ref{conclusion}. 


%{\color{red}Optimal control in nonlinear two-level system characters one square pulse by analytic when one only consider an upper bound of the external field which leads to the zero detuning at all the time}. For more complicated nonlinear three-level system, we tackle the problem of boundary conditions of states with the numerical treatment bases on the Nelder-Mead simplex algorithm as described in \cite{NMSM_matlab}. Specifically, rather than starting with some initial guess of control function as in the Krotov algorithm, we intend to determine optimal control with an initial guess of costate. To always begin with a good initial guess, we present a large systematic landscape of initial values solved by the reliable Runge-Kutta scheme with the transfer duration $T_{t}\in[0, T^{\textbf{max}}_{t}]$. And it turns out that instead of analyzing the infinite parameter landscape for initial guess, it reduces to finite with respect to one particular inversion. Then one can determine the initial values accurately after $N$ iterations via Nelder-Mead simplex method to tailor the external fields for one preferable transfer and minimize the cost functionals. {\color{red}Different from previous works, the connection between OCT and QSL emerges when OCT fails to converge to target state for a given transfer duration in nonlinear systems where the conception of QSL in the linear system can not apply. 
%%due to the lack of completed orthogonal eigen-basis in nonlinear systems, we can not apply conventional way and determine the QSL with the average energy $\Delta H$ directly.
%}

%we starts with some initial guess  all the ad-joint state are and 
% it indicates non-local minimals in nonlinear systems since the demanding dynamics merely occurs in specific zone. 



%we intend to determine local optimal initial conditions with the given primary initial conditions and tailor the external fields for one preferable transfer which minimize the cost functionals.

%It is worthy to mention that numerical results proves that instead of analysing the infinite parameter landscape for initial values, %\cite{OPLscapeRabitz,OPLscapenjp}, it reduces to finite. 

\section{1:2 nonlinear two-level model}
\label{model-1}
\subsection{The model}
The two-level model including second-order (with a 1:2 resonance) and third-order Kerr nonlinearities is characterized by following equations of motion  \cite{pra_SG}
\begin{subequations}
\label{motiontwolevel}
\begin{align}
	&i\dot{\psi}_{1}=\left[-\frac{\Delta}{3}+\Lambda_{11}|\psi_{1}|^{2}+\Lambda_{12}|\psi_{2}|^{2}\right]\psi_{1}+\frac{\Omega}{\sqrt{2}}{\psi}^{*}_{1}\psi_{2},\\
	&i\dot{\psi}_{2}=\left[\frac{\Delta}{3}+\Lambda_{21}|\psi_{1}|^{2}+\Lambda_{22}|\psi_{2}|^{2}\right]\psi_{2}+\frac{\Omega}{2\sqrt{2}}{\psi}^{2}_{1},
\end{align}
\end{subequations}
where $\psi_{1}$ and $\psi_{2}$ are the state probability amplitude, satisfying $|\psi_{1}|^{2}+2|\psi_{2}|^{2}=1$ that can vary in the respective ranges $|\psi_{1}|^{2}\in[0,1]$, $|\psi_{2}|^{2}\in[0,1/2]$.  The controls are time-dependent: $\Delta\equiv\Delta(t)$ and $\Omega\equiv\Omega(t)$, representing the detuning and Rabi-frequency, respectively. Here $\Lambda_{ij} (i,j=1,2)$ denote the third-order nonlinearities (in units of angular frequency) and $\Lambda_{21}=\Lambda_{12}$. Second-order nonlinearities appear in the form of the coupling. 
We will use units such that $\hbar=1$.
% In this letter, we only consider the effect of second-order as $\Lambda_{ij}$ can be trivially compensated by static and time-dependent detunings. 

We can describe the dynamics on a generalized nonlinear Bloch sphere (see, e.g., \cite{pra102_Jingjun,Efstathiou}) by introducing the nonlinear coherences and the population inversion, respectively:
\begin{subequations}
\begin{align}
\eta_{1}&=\sqrt{2}\,\text{Re}\bigl(\psi^{2}_{1}\bar{\psi}_{2}\bigr),\quad \eta_{2}=\sqrt{2}\,\text{Im}\bigl(\psi^{2}_{1}\bar{\psi_{2}}\bigr),\\
\eta_{3}&=|\psi_{2}|^{2}-\frac{1}{2}|\psi_{1}|^{2}, \quad \eta_{3}\in\Bigl[-\frac{1}{2},\frac{1}{2}\Bigr],
\end{align}
\end{subequations}
 leading to 
 \begin{align}
 |\psi_{1}|^{2}=\frac{1}{2}(1-2\eta_{3}),\quad |\psi_{2}|^{2}=\frac{1}{4}(1+2\eta_{3}).
 \end{align}
 The generalized 1:2 nonlinear Bloch sphere is characterized by the following surface equation
\begin{align}
	\label{surface}
	\eta^{2}_{1}+\eta^{2}_{2}-\Bigl(\frac{1}{2}-\eta_{3}\Bigr)^{2}\Bigl(\frac{1}{2}+\eta_{3}\Bigr)=0.
\end{align}
The south and north poles correspond to $|\psi_{1}|^{2}=1$, $|\psi_{2}|^{2}=0$, i.e. $\eta_3=-1/2$ and $|\psi_{1}|^{2}=0$, $|\psi_{2}|^{2}=1/2$, i.e. $\eta_3=1/2$, respectively. It has been proved that $\eta_3=1/2$ is an unreachable (unstable) target with or without Kerr terms  in \cite{pra_SG,epl_stephane}. Using Eq. \eqref{motiontwolevel}, we have
%\begin{subequations}
%	\begin{align}
%		&\dot{\eta_{1}}=\sqrt{2}(2\dot{c}_{1}c_{1}c^{*}_{2}+\dot{c}^{*}_{2}c^{2}_{1}+2\dot{c}^{*}_{1}c^{*}_{1}c_{2}+\dot{c}_{2}c^{*2}_{1}),\\ &\dot{\eta}_{2}=-\sqrt{2}i(2\dot{c}_{1}c_{1}c^{*}_{2}+\dot{c}^{*}_{2}c^{2}_{1}-2\dot{c}^{*}_{1}c^{*}_{1}c_{2}-\dot{c}_{2}c^{*2}_{1}),\\ &\dot{\eta}_{3}=\frac{1}{2}\left(\dot{c}_{1}c^{*}_{1}+\dot{c}^{*}_{1}c_{1}-2\dot{c}_{2}c^{*}_{2}-2\dot{c}^{*}_{2}c_{2}\right),
%	\end{align}
%\end{subequations}
\begin{subequations}
\label{etad}
\begin{align}
	\label{eta1}
		&\dot{\eta}_{1}=\bigl(-\Delta+\Lambda_a -2\Lambda_s|\psi_{2}|^2 \bigr)\eta_{2},\\
		\label{eta2}
		&\dot{\eta}_{2}=\frac{\Omega}{2}\Bigl(3\eta^{2}_{3}-\eta_{3}-\frac{1}{4}\Bigr)+\bigl(\Delta- \Lambda_a +2 \Lambda_s |\psi_{2}|^2\bigr)\eta_{1},\\
		&\dot{\eta}_{3}=\Omega\eta_{2}
		\label{eta3}
\end{align}
\end{subequations}
with the effective third-order nonlinearities 
 \begin{equation}
\Lambda_s= 2\Lambda_{11} +\Lambda_{22}/2 -2\Lambda_{12}, \quad \Lambda_a=2\Lambda_{11}-\Lambda_{21}.
 \end{equation} 
 It can be seen that $\Lambda_a$ can be trivially compensated by a static shift of the detuning, while the term proportional to $\Lambda_s$ depends on the dynamical variable $|\psi_{2}|^2$. However it has been shown in \cite{prl119_Stephane} that one can lock the resonance using the freedom in the choice of the time-dependance of $\Delta$ by incorporating the term $2 \Lambda_s |\psi_{2}|^2$.
Hence, we define the effective detuning (which includes a change of sign of $\Delta$ for convenience):
 \begin{equation}
 \label{DefTD}
 \tilde{\Delta}=-\Delta+\Lambda_a -2\Lambda_s|\psi_{2}|^2=-\Delta+\Lambda_a -\Lambda_s \Bigl(\frac{1}{2}+\eta_{3}\Bigr),
 \end{equation} 
 %which includes all the third-order nonlinearities, 
 such that the set \eqref{etad} of differential equations only features the second-oder nonlinearity:
 \begin{subequations}
\label{etad_}
\begin{align}
	\label{eta1_}
		&\dot{\eta}_{1}=\tilde\Delta\eta_{2},\\
		\label{eta2_}
		&\dot{\eta}_{2}=\frac{\Omega}{2}\Bigl(3\eta^{2}_{3}-\eta_{3}-\frac{1}{4}\Bigr)-\tilde\Delta\eta_{1},\\
		&\dot{\eta}_{3}=\Omega\eta_{2}.
		\label{eta3_}
\end{align}
\end{subequations}
This generalizes the standard Bloch equations to the 1:2 nonlinear system with the detuning  $\tilde{\Delta}$ \eqref{DefTD} featuring an explicit (linear) dependance on $\eta_3$ via the effective third-order nonlinear term $\Lambda_s$.
To determine the expression of optimal trajectories in this system, we apply the PMP taking for the cost the time (time optimal control) or the energy (energy optimal control). The 1:2 nonlinear two-state time optimal control has been solved in  \cite{pra94xc}, and we closely follow its derivation in order to apply it for the energy optimal control and in next section for the three-level problem.

To achieve a given transfer from a population $\eta_{\text{3i}}\equiv\eta_3(t_i)$ at the initial time $t_i$, we define the targeted final population $\eta_{\text{3f}}\equiv\eta_3(t_f)=\frac{1}{2}-\epsilon$ at the final time $t_f$, i.e. $|\psi_{2}(t_f)|^{2}=\frac{1}{2}(1-\epsilon)$. When one targets the upper state, the deviation $\epsilon$ will be taken small but different from zero since the second-order nonlinearity prevents to reach it exactly. 

\subsection{Time and area optimal control}
Various situations have been considered in \cite{pra94xc}. Here, we particularly focus on the (almost) complete transfer from the ground state as a function of $\epsilon$, and will show that the minimum time (or pulse area) increases in a (slow) logarithmic way with respect to small deviations $\epsilon$, or reciprocally that the deviation $\epsilon$ decreases exponentially with respect to the minimum time (or pulse area).

We consider the time minimizing functional 
\begin{align}
\label{MinTimeCost}
	J=\int_{t_i}^{t_f}dt.
\end{align}
The corresponding control (or pseudo) Hamiltonian from the set \eqref{etad_} of differential equations is (where we have added a constant $p_{0}$):
\begin{equation}
\label{Def_Hc}
	\begin{split}
		&h_{c}=\tilde{\Delta}(\lambda_{1}\eta_{2}-\lambda_{2}\eta_{1})+\Omega\Bigl[\frac{\lambda_{2}}{2}\Bigl(3\eta^{2}_{3}-\eta_{3}-\frac{1}{4}\Bigr)+\lambda_{3}\eta_{2}\Bigr]
	\end{split}
\end{equation}
with Hamiltonian's equation for the (dimensionless) costate $\Lambda=[\lambda_1,\lambda_2,\lambda_3]^{\mathsf{T}}$ gathering the conjugate momenta of $\eta_1$, $\eta_2$, and $\eta_3$, respectively:
\begin{subequations}
\begin{align}
	&\dot{\lambda}_{1}=-\frac{\partial h_{c}}{\partial\eta_{1}}=\lambda_{2}\tilde{\Delta},\\
	&\dot{\lambda}_{2}=-\frac{\partial h_{c}}{\partial\eta_{2}}=-\lambda_{1}\tilde{\Delta}-\lambda_{3}\Omega,\\
	&\dot{\lambda}_{3}=-\frac{\partial h_{c}}{\partial\eta_{3}}=-\frac{ \lambda_{2}}{2}\Omega(6\eta_{3}-1)-\frac{\partial\tilde{\Delta}}{\partial\eta_{3}}(\lambda_{1}\eta_{2}-\lambda_{2}\eta_{1}).
	\label{dlamb3}
\end{align}
\end{subequations}
In order to prevent arbitrary large field amplitude detrimental for experimental implementation, we impose a boundary on the field $\Omega\le\Omega_{0}$ as a constraint. 
The maximization of $h_c$  according to the PMP corresponds thus to the necessary condition
\begin{align}
	\frac{\partial h_{c}}{\partial\tilde{\Delta}}&=0,
\end{align}
i. e. 
\begin{equation}
	\lambda_{1}\eta_{2}-\lambda_{2}\eta_{1}=0.
	\label{p1}
\end{equation}
This leads to the shape of the external field $\Omega$:
%or $h_{c}=0$ with a proper choice of $p_{0}$, giving
%\begin{equation}
%	\frac{\lambda_{2}}{2}\left(3\eta^{2}_{3}-\eta_{3}-\frac{1}{4}\right)+\lambda_{3}\eta_{2}=\frac{h}{\Omega},
%	\label{p2}
%\end{equation}
\begin{equation}
	\Omega=\frac{2}{\lambda_{2}\left(3\eta^{2}_{3}-\eta_{3}-\frac{1}{4}\right)+2\lambda_{3}\eta_{2}}
	\label{Omega}
\end{equation}
from (\ref{Def_Hc},\ref{p1}) and the fact that the system \eqref{Def_Hc} is autonomous, i.e. $h_{c}=const.$ In Eq. \eqref{Omega}, we have renormalized $\lambda_2/h_c\to\lambda_2$ and $\lambda_3/h_c\to\lambda_3$ without loss of generality. 
%and the costate components have time unit.
Differentiating Eqs. \eqref{p1} and \eqref{Omega} gives
\begin{align}
	\label{p3}
	&\frac{\lambda_{1}}{2}\left(3\eta^{2}_{3}-\eta_{3}-\frac{1}{4}\right)+\lambda_{3}\eta_{1}=0,\\
	&\dot{\Omega}=0,
\end{align}
from which we conclude that $\Omega$ is constant, taken at its maximum $\Omega=\Omega_0$. 
%Substituting the term in $\eta_3$ of \eqref{p3} in \eqref{Omega} and using \eqref{p1} show that $\eta_2=0$.
Multiplying Eq. \eqref{Omega} by $\eta_{1}$ and Eq. \eqref{p3} by $\eta_{2}$ also using \eqref{p1}, we obtain a linear system of equations for the variables $\lambda_{2}$ and $\lambda_{3}$:
\begin{subequations}
	\label{p4}
	\begin{align}
		&\lambda_{2} \frac{\eta_{1}}{2}\Bigl(3\eta^{2}_{3}-\eta_{3}-\frac{1}{4}\Bigr)+\lambda_{3}\eta_{1}\eta_{2}=\frac{\eta_{1}}{\Omega},\\
		&\lambda_{2}  \frac{\eta_{1}}{2}\Bigl(3\eta^{2}_{3}-\eta_{3}-\frac{1}{4}\Bigr)+\lambda_{3}\eta_{1}\eta_{2}=0
	\end{align}
\end{subequations}
of determinant zero, which can give a solution when the inhomogeneous terms are zero, i.e. $\eta_1=0$. This implies $\lambda_{1}=0$ from Eq. \eqref{p3} (for a non-constant $\eta_3$) and $\dot{\eta}_{1}=0$ in Eq. \eqref{eta1_} gives $\tilde{\Delta}=0$, i.e. for the original detuning $\Delta$ from \eqref{DefTD}:
 \begin{equation}
 \label{TDshape}
 \Delta= \Lambda_a - \Lambda_s \Bigl(\frac{1}{2}+\eta_{3}\Bigr).
 \end{equation} 
This leads to an optimal trajectory along the meridian connecting the south to the target near the north pole (of distance $\epsilon$ from it) in the $(\eta_{2}, \eta_{3})$ plane. The dynamics can be solved exactly from \eqref{etad_}. 
For instance, when we consider a population transfer from the ground state (south pole), i.e.  $\eta_{\text{3i}}=-1/2$, we obtain (taking $t_i=0$)
 \begin{equation}
 \label{soleta3Tmin}
 \eta_3(t)=\tanh^{2}\Bigl(\frac{1}{2}\Omega_0 t\Bigr)-\frac{1}{2}.
\end{equation} 
\begin{figure}
		\includegraphics[scale=0.75]{fig1.eps}
		\caption{Populations (lower frame), coherence and population inversion (upper frame) history, given by \eqref{soleta3Tmin} and integration of \eqref{eta2_}, governed by the time optimal (constant) pulse $\Omega_0$ for $\epsilon=0.002$, giving $\mathcal{A}\approx7.60$, i.e. $T_{\text{min}}\approx7.60/\Omega_{0}$. }
		\label{fig11}	
\end{figure}
From Eq. \eqref{Omega}, taken at initial time, we obtain
$\Omega_{0}=2/\lambda_{2\text{i}}$ (independently of the initial value of $\lambda_{3,\text{i}}$). 
%some algebras yield the exact population 
%\begin{align}
%	p(t)=2|\psi_{2}(t)|^{2}=\frac{1}{2}-\eta_{3}=\tanh^{2}\int_{t_{i}}^{t}\frac{\Omega dt}{2},
%	\label{pt1}
%\end{align}
%this further confirms the complete population cannot  occur for a finite pump field area. 
To obtain the explicit expression of the minimum time $T_{\min}=\min (t_f-t_i)$ for a given $\Omega_0$, we calculate the corresponding minimum pulse area by integrating \eqref{eta3_} using \eqref{surface}, which is fully determined by the (given) initial and final boundaries of $\eta_{3}$,
\begin{equation}
	\label{T}
		\mathcal{A}_{\min}\equiv \Omega_{0} T_{\min}=\pm\int_{\eta_{\text{3i}}}^{\eta_{\text{3f}}}\frac{d\eta_{3}}{\sqrt{\left(\frac{1}{2}-\eta_{3}\right)^{2}\left(\frac{1}{2}+\eta_{3}\right)}}.
\end{equation}
%We notice that the area is minimum for a given $\Omega_0$.
The $\pm$ sign ensures a non-negative pulse area, i.e. the sign $+$ ($-$) corresponds to $\eta_{\text{3i}}<\eta_{\text{3f}}$ ($\eta_{\text{3i}}>\eta_{\text{3f}}$). Hereby, we consider $\eta_{3\text{i}}<\eta_{3\text{f}}=\frac{1}{2}-\epsilon$ and finally get the minimum time for given $\epsilon$ and $\Omega_{0}$,
\begin{align}
T_{\text{min}}=\frac{2}{\Omega_{0}}\left|\text{atanh}\sqrt{\frac{1}{2}+\eta_{\text{3f}}}-\text{atanh}\sqrt{\frac{1}{2}+\eta_{\text{3i}}}\right|.
\label{Tmin}
\end{align}
This gives for the non-linear final transfer probability from the ground state in optimal time $T_{\min}$:
	\begin{equation}
	\label{NonlinearProba}
	p=2\vert\psi_2(T_{\min})\vert^2=\tanh^{2}\Bigl(\frac{1}{2}\Omega_0 T_{\min}\Bigr)=1-\epsilon.
		\end{equation}
We notice in the limit case of unbounded pulse amplitude a Dirac $\delta$ pulse, i.e. of infinite amplitude and zero duration with a finite area $\Omega_0T_{\text{min}}$ given by \eqref{Tmin}.
The dynamics from the ground state is shown in Fig. \ref{fig11} for $\epsilon=0.002$.

The minimum time $T_{\text{min}}$ can be used as the definition of the so-called quantum speed limit in this system as suggested in \cite{Frey}.
In linear systems, the mimum time is given by $T_{\min,\text{lin.}}$:  $\cos\bigl(\Omega_0T_{\min,\text{lin.}}/2\bigr)=\frac{1}{2}\sqrt{1-\eta_{3\text{i}}}\sqrt{1-\eta_{3\text{f}}} + \frac{1}{2}\sqrt{1+\eta_{3\text{i}}}\sqrt{1+\eta_{3\text{f}}}$ \cite{Boscain,Frey} with $\eta_{3\text{i}}=-1$ for the ground state and $\eta_{3\text{f}}=1$ for the excited state. In the non-linear case we obtain $\tanh(\Omega_{0} T_{\text{min}}/2)=\sqrt{\frac{1}{2}+\eta_{\text{3f}}}$ for $\eta_{3\text{i}}=-1/2$ from Eq. \eqref{Tmin}. 
%where $\psi_{\text{f}}$, $\psi_{\text{f}'}$  are the ideal target state and the actual final state, respectively \fbox{?}

We consider $\eta_{\text{3i}}=-1/2$ (south pole). The pulse area $\mathcal{A}_{\min}=\Omega_{0}T_{\min}$ is given from Eq. \eqref{Tmin} with its leading order for $\epsilon\to0$:
\begin{equation}
	\label{exponent}
	\mathcal{A}_{\min}=2\, \text{atanh} \sqrt{1-\epsilon}\sim-\ln\Bigl(\frac{\epsilon}{4}\Bigr),\text{ i.e. } \epsilon\sim4e^{-\mathcal{A}_{\min}}.
	\end{equation}
We conclude that the minimum time (or pulse area) for the (almost complete) inversion increases in a (slow) logarithmic way with respect to small deviations $\epsilon$, or reciprocally that the deviation $\epsilon$ decreases exponentially with respect to the minimum time (or pulse area).
Figure \ref{figrobust} compares the pulse area cost between the linear, $p_{\text{lin}}=\sin^{2}\left(\Omega_{0}T_{\min}/2\right)$, and the non-linear probability \eqref{NonlinearProba}. One can observe that the non-linearity affects weakly the transfer for small transfers ($\epsilon\to1$).
%As expected, the population in nonlinear system can not be completely transferred to the north pole. Equation. \eqref{exponent} can characterize the population as 
%function of pulse area for $\epsilon$. Therefore, one can estimate optimal time (QSL) as a function of deviation $\epsilon$,
%\begin{align}
%	\mathcal{A}\sim-\frac{\mathbf{log_{10}}\epsilon}{\mathbf{log_{10}}\text{e}}+\text{ln}4.
%	\label{analytictime}
%\end{align}



%\begin{figure}
%	\begin{center}
%		\includegraphics[scale=0.75]{epsilontmintwolevel.eps}
%		\caption{Pulse area in terms of $\epsilon$ in the logarithm coordinate. The numerical result (blue solid line) is indistinguishable with the analytical solution given by Eq. \eqref{analytictime} (red dashed line).}
%		\label{fig12}
%	\end{center}
%\end{figure}
%The exponential connection between pulse area and $\epsilon$ is approved by numeric in Fig. \ref{fig12}. 
\begin{figure}
	\begin{center}
		\includegraphics[scale=0.75]{fig2.eps}
		\caption{Population transfer probability $1-\epsilon$ as a function of the optimal pulse area for the linear $p_{\text{lin}}=\sin^{2}\left(\Omega_{0}T_{\min}/2\right)$ (green dotted-dashed line) and nonlinear (red full line) two-level models, respectively. Asymptotics \eqref{exponent} of the probability (blue dashed line) shows its accuracy when $\epsilon\to0$. 
		%The inset shows the asymptotic feature of the probability for the nonlinear case.
		}
		\label{figrobust}
	\end{center}
\end{figure}


\subsection{Energy optimal control}
We consider the cost functional for the energy optimal control 
\begin{equation}
	\label{energycost}
%	J\equiv E=\int^{t_{f}}_{t_{i}}(\tilde{\Delta}^{2}+\Omega^{2})dt.
J\equiv E=\hbar\int^{t_{f}}_{t_{i}}\Omega^{2}(t)dt.
\end{equation}
In this case, we can rewrite the control Hamiltonian (in units such that $\hbar=1$)
\begin{align}
		h_{c}&=\tilde{\Delta}(\lambda_{1}\eta_{2}-\lambda_{2}\eta_{1})\nonumber\\
		& +\Omega\Bigl[\frac{\lambda_{2}}{2}\Bigl(3\eta^{2}_{3}-\eta_{3}-\frac{1}{4}\Bigr)+\lambda_{3}\eta_{2}\Bigr] -p_{0}\Omega^{2}
\end{align}
with the standard choice $p_0=1/2$. In this case, the costate has the angular frequency unit.
After applying the PMP, 
\begin{align}
\frac{\partial h_{c}}{\partial\tilde{\Delta}}=0,\quad \frac{\partial h_{c}}{\partial\Omega}=0,
\label{energypmptwo}
\end{align}
we obtain $\lambda_{1}\eta_{2}-\lambda_{2}\eta_{1}=0$ and
\begin{align}
	\label{Omegaenergy}
%	&\tilde{\Delta}=\lambda_{1}\eta_{2}-\lambda_{2}\eta_{1},\\
	&\Omega=\frac{\lambda_{2}}{2}\Bigl(3\eta^{2}_{3}-\eta_{3}-\frac{1}{4}\Bigr)+\lambda_{3}\eta_{2}.
\end{align}
The control Hamiltonian can be rewritten as 
\begin{align}
	h_{c}=\frac{1}{2}\Omega^{2},
\end{align}
%Differentiating Eq. \eqref{Omegaenergy}, we obtain again $\dot{\Omega}=0$, thus
leading to a constant coupling $\Omega=\Omega_0=\sqrt{2h_c}$. 
Similarly as for the time-optimum case, we obtain $\eta_1=0$, $\lambda_1=0$, $\tilde{\Delta}=0$, and thus the same dynamics as in Fig. 1. We also derive Eq. \eqref{Tmin} but interpreted differently, i.e. for a given time of interaction $T=t_{f}-t_{i}$, we determine the minimum $\Omega_0$:
\begin{align}
\Omega_{0,\min}=\frac{2}{T}\left|\text{atanh}\sqrt{\frac{1}{2}+\eta_{\text{3f}}}-\text{atanh}\sqrt{\frac{1}{2}+\eta_{\text{3i}}}\right|
\label{Omega0}
\end{align}
%The condition at initial time implies
%\begin{align}
%\Omega_0=\frac{\lambda_{2\text{i}}}{2}.
%\end{align}
%From Eq. \eqref{energypmptwo}, one can conclude $\tilde{\Delta}=0$ and recover Eq. \eqref{Tmin}. 
leading to the minimum energy 
\begin{align}
E_{\min}=\hbar\Omega_{0,\min}^{2}T=\hbar\mathcal{A}_{\min}^{2}/T
\end{align}
corresponding to the minimum area given by \eqref{Omega0}: $\mathcal{A}_{\min}=\Omega_{0,\min} T=2\left|\text{atanh}\sqrt{\frac{1}{2}+\eta_{\text{3f}}}-\text{atanh}\sqrt{\frac{1}{2}+\eta_{\text{3i}}}\right|$.
%(noting that we assume $\Lambda_{ij}=0$).


%\section{Numerical results}

%\begin{figure}
%	\begin{center}
%		\includegraphics[scale=0.32]{countertime_threeparameter_time_0.eps}
%		\includegraphics[scale=0.32]{countertime_threeparameter_energy_0.eps}\\
%		\includegraphics[scale=0.32]{countertime_threeparameter_time_1.eps}
%		\includegraphics[scale=0.32]{countertime_threeparameter_energy_1.eps}\\
%		\includegraphics[scale=0.32]{countertime_threeparameter_time_2.eps}
%		\includegraphics[scale=0.32]{countertime_threeparameter_energy_2.eps}
%		\caption{Contour plot for transfer time $T_{t}$ (left row panels)  and energy (right row panels) as function of $\lambda_{2,0}$ and $\lambda_{3,0}$ when the dynamics reaches to the desired transfer with $\epsilon=0.002$. Noting that there is no solutions in the red areas. From top to bottom, $\lambda_{1,0}=0, 0.5, 1$ respectively. The negative $\lambda_{1,0}$ does not show here since it is symmetric.} 
%		\label{fig01}
%	\end{center}
%\end{figure}

%\begin{figure}
%	\begin{center}
%		\includegraphics[scale=0.75]{dynamicstwolevelenergy.eps}
%		\caption{Population probability governed by energy optimal pulses for $\epsilon=0.002$, $\lambda^{N}_{2}(0)=1.013330078124999$ and $\lambda_{3}(0)=5$. Here pulse area $\mathcal{A}=\Omega T\simeq7.60$ and $E_{\text{min}}=\mathcal{A}^{2}/T=3.850604507821612$ {\color{purple}where $T\in[0, T^{\text{max}}_{t}]$ with $T^{\text{max}}_{t}=15/\Omega_{0}$? I find it is a bit confusing with the unit $\Omega_{0}$ and the pulse intensity $\Omega$. Maybe it is better we state we scale the pulse intensity with $\Omega_{0}$, thus $T$ and $\Omega$ are in the unit of $\Omega_{0}$}. {\color{blue} what's the unit of $E$ (is that $\Omega_{0}$)? here we have to set a limit of the transfer time $T$ (e.g.$T\in[0, T^{\text{max}}_{t}]$) since the duration can not be infinitely large or the pulse area can not be infinitely small.}}
%		\label{fig13}
%	\end{center}
%\end{figure}

\section{1:2 nonlinear three-level $\Lambda$ model}
\label{model}

\subsection{The model}
%Here we present optimal trajectories with respect to time and energy in Bloch coordinate given by optimal control theory.  
The equations of motion for the three-level Raman model (forming a $\Lambda$ system), including the second- and third-order nonlinearities, read 
%after neglecting the three-order read
\begin{subequations}
	\label{H_}
	\begin{align}
		&i \dot{\psi}_{1}=K_1\psi_1+\Omega_{p}\psi^{*}_{1}\psi_{2},\\
		&i\dot{\psi}_{2}=K_2\psi_2+ \Delta_P\psi_{2}+\frac{\Omega_{p}}{2}\psi_{1}^{2}+\frac{\Omega_{s}}{2}\psi_{3},\\
		&i\dot{\psi}_{3}= K_3\psi_3+  \frac{\Omega_{s}}{2}\psi_{2} + (\Delta_P-\Delta_S)\psi_{3},
	\end{align}
\end{subequations}
where $\Omega_{p}$ and $\Omega_{s}$ are the time-dependent pump and Stokes fields, respectively,
%i. e. for two color photoassication process 
$\Delta_P$ is the one-photon detuning associated to the pump coupling, and $\Delta_P-\Delta_S$ is the two-photon detuning associated to the Raman process.  The second-order 1:2 nonlinearity appears here through the pump coupling. This is typically the situation for the two-color photoassociation process \cite{pra65_Drummond}. The third-order nonlinearities $K_j$, $j=1,2,3$, can be absorbed in the definition of the detunings and the change of phases $\psi_{1}\to\psi_1e^{-i\gamma}$, $\psi_{2,3}\to\psi_{2,3}e^{-2i\gamma}$: $\dot\gamma=K_1$, $\Delta_P=2K_1-K_2$, $\Delta_S=K_3-K_2$, in order to lock the (one- and two-photon) resonances  \cite{prl119_Stephane}:
\begin{subequations}
	\label{H}
	\begin{align}
		&i \dot{\psi}_{1}=\Omega_{p}\psi^{*}_{1}\psi_{2},\\
		&i\dot{\psi}_{2}= \frac{\Omega_{p}}{2}\psi_{1}^{2}+\frac{\Omega_{s}}{2}\psi_{3},\\
		&i\dot{\psi}_{3}=  \frac{\Omega_{s}}{2}\psi_{2}.
	\end{align}
\end{subequations}
The amplitude probabilities satisfy $|\psi_{1}|^{2}+2(|\psi_{2}|^{2}+|\psi_{3}|^{2})=1$.
%Since we can use the resonance-locking condition, $\Delta_{p}=2K_{1}-K_{2}$ and $\Delta_{s}=K_{3}-K_{2}$\cite{prl119_stephane}, we can simply obtain the motion equations within the on-resonance condition,
%\begin{subequations}
%	\begin{align}
	%	&i \dot{\psi}_{1}=\Omega_{p}\bar{\psi}_{1}\psi_{2},\\
	%	&i\dot{\psi}_{2}=\Omega_{p}\psi_{1}^{2}+\Omega_{s}\psi_{3},\\
	%	&i\dot{\psi}_{3}=\Omega_{s}\psi_{2},
	%	\end{align}
%	\label{H2}
%\end{subequations}
%%{\color{red} As the wavefunction can be complex, we find a way to determine nonzero values during the evolution precisely.}
%We can recast Eqs. \eqref{H} into a complex Hamilton equation $i\partial{\psi_{i}}/\partial t=\partial H_{\text{cl.}}/\partial{\psi^{*}_{i}}$ with a classical Hamiltonian 
%%and apply the classical adiabatic theory available in 
%\cite{classical_H,prl99_Itin,pra65_Drummond}:
%%The effective classical Hamiltonian on the resonance $\Delta=0$ obtained by inversing the varation of classic Hamiltonian 
%\begin{equation}
%	H_{\text{cl.}}=\frac{\Omega_{p}}{2}\bigl(\psi^{*}_{1}\bigr)^2\psi_{2}+\frac{\Omega_{s}}{2}\psi_{2}\psi^{*}_{3}+\frac{\Omega_{p}}{2}\psi^{*}_{2}\psi^{2}_{1}+\frac{\Omega_{s}}{2}\psi^{*}_{2}\psi_{3}.
%	\label{Hc1}
%\end{equation}
We decompose the components into real and imaginary parts, $\psi_{i}=x_{i}+iy_{i}$ $(i=1, 2, 3)$, and assume real Rabi frequencies, which allows one to separate the original problem into two disjoint dynamics that emerge according to the real and imaginary parts of the initial state, respectively.
%where $x_{i}$ and $y_{i}$ are time dependent canonical variables represents momenta and coordinates respectively. The total probability $x^{2}_{1}+y^{2}_{1}+2(x^{2}_{2}+y^{2}_{2}+x^{2}_{3}+y^{2}_{3})=1$ is conserved. Hence, we can obtain
%\begin{equation}
%	H_{\text{cl.}}=2\Omega_{p}[x_{2}\frac{y^{2}_{1}-x^{2}_{1}}{2}-x_{1}y_{2}y_{1}]-\Omega_{s}(x_{2}x_{3}+y_{2}y_{3}),
%	\label{Hc2}
%\end{equation}
We consider the initial state $\psi_{1}$ being real, $x_{1}(t_{i})=1$, and we get the equations of motion from \eqref{H}:
%we hence get $x_{1}$, $x_{3}$, $y_{2}$ are nonzero during the evolution preciesly. 
%Noting that $H=\text{const}\equiv0$. 
%{\color{red}but why H should be euqal to some costant \cite{prl99_Itin}}. 
%The equations of motion can be obtained by the Hamilton equations:
% $i\partial{\psi_{i}}/\partial t=\partial H_{\text{classic}}/\partial{\psi^{*}_{i}}$,
%$\partial{x_{i}}/\partial t=-\partial H_{\text{cl.}}/\partial y_{i}$, $\partial{y_{i}}/\partial t=\partial H_{\text{cl.}}/\partial x_{i}$, i.e.
\begin{subequations}
	\label{xcoordinate}
	\begin{align}
		&\dot{x}_{1}=\Omega_{p}x_{1}y_{2},\\
		&\dot{y}_{2}=-\frac{\Omega_{s}}{2}x_{3}-\frac{\Omega_{p}}{2}x^{2}_{1},\\
		&\dot{x}_{3}=\frac{\Omega_{s}}{2}y_{2}.
	\end{align}
\end{subequations}
%{\color{red} why here we introduce the Bloch coordinate? It reduces the number of paramters inside?} Generally, there are two main approaches for solving optimal control problems \cite{methodPMP}, indirect method based on PMP to construct the Hamiltonian with adjoint states then slove the boundary values for an imposed optimal control problem to determine optimal control field during the time interval $[0, T]$, direct method to parameterize in a lower dimensional space and slove the equations directly. It is known that in nonlinear systems, it is relatively hard to decide the boundary values, the latter approach hence become the main subject of this paper. 
%For the sake of convenience, we hereby 
This system of equations can be analyzed using an isomorphism with the non-linear two-level problem, similarly to the linear problem \cite{ShoreVitanov} (see Appendix A). One can also show the incomplete transfer between the two ground states for finite pulse areas. We however prefer to keep the original coordinates for solving the problem.

Without loss of generality, we can parameterize the dynamics with the two dynamical angles $\theta(t)\in[0, \pi]$ and $\phi(t)\in[0, 2\pi[$:
\begin{subequations}
	\label{pangle}
	\begin{align}
		&x_{1}=\cos\phi\cos\theta,\\
		&y_{2}=-\frac{1}{\sqrt{2}}\sin\phi,\\
		&x_{3}=-\frac{\cos\phi\sin\theta}{\sqrt{2}},
	\end{align}
\end{subequations}
%with $\Upsilon_{1}\equiv\Upsilon_{1}(t)= x_{1}(t)$, $\Upsilon_{2}\equiv\Upsilon_{2}(t)= y_{2}(t)$, $\Upsilon_{3}\equiv\Upsilon_{3}(t)= x_{3}(t)$,
which satisfies the normalization condition $x_{1}^{2}+2(y_{2}^2+x_{3}^2)=1$. Inserting the definition \eqref{pangle} into Eqs. \eqref{xcoordinate} leads to
\begin{subequations}
	\label{angles}
	\begin{align}
		&\dot{\phi}=\frac{\Omega_{p}\cos\phi\cos^{2}\theta}{\sqrt{2}}-\frac{\Omega_{s}\sin\theta}{2},\\
		&\dot{\theta}=\frac{\sin\phi\sin\theta}{\cos\phi\cos\theta}\left(\frac{\Omega_{s}}{2\sin\theta}+\frac{\Omega_{p}\cos\phi\cos^{2}\theta}{\sqrt{2}}-\frac{\Omega_{s}\sin\theta}{2}\right),
	\end{align}
\end{subequations}
which by inversion provide the shape of the fields as functions of the angles:
\begin{subequations}
\label{pulsesPS}
	\begin{align}
		&\Omega_{s}=2\left(\dot{\theta}\cot\phi\cos\theta-\dot{\phi}\sin\theta\right),\\
		&\Omega_{p}=\sqrt{2}\left(\frac{\dot{\phi}}{\cos\phi}+\frac{\dot{\theta}\tan\theta}{\sin\phi}\right).
	\end{align}
\end{subequations}
We define the target state in the vicinity of the state 3:
	\begin{align}
	|x_{3}(t_{f})|^{2}=\frac{1}{2}(1-\epsilon),
		\end{align}
		where $\epsilon$ is, as in the two-level case, a small deviation due to the incomplete population transfer in such nonlinear system \cite{prl119_Stephane}.
To determine the expression of the optimal trajectories from the ground state to the target state (for a given $\epsilon$), we apply the PMP taking for the cost the time or the energy.

\subsection{Time optimal control}
\subsubsection{Definition}
We consider the time minimizing cost functional \eqref{MinTimeCost}
%\begin{equation}
%	J=\int^{t_f}_{t_i}dt.
%\end{equation}
and impose similarly to the two-level case the constraint of bounded pulses amplitudes:
\begin{equation}
	\Omega^{2}_{p}+\Omega^{2}_{s}\le\Omega^{2}_{0}.
	\label{u1}
\end{equation}
%where $\Omega_{0}$ is the maximum field intensity. 
%Whereas there is no restriction on external fields if the cost minimizes the energy. 
The control Hamiltonian reads (where we have added a constant $p_{0}$)
\begin{align}
	\label{Htcontrol}
		H_{c}&=\lambda_{\phi}\dot{\phi}+\lambda_{\theta}\dot{\theta},\\
		&=\lambda_{\phi}\left(\frac{\Omega_{p}\cos\phi\cos^{2}\theta}{\sqrt{2}}-\frac{\Omega_{s}\sin\theta}{2}\right)\nonumber\\ 
		&+\lambda_{\theta}\left(\frac{\Omega_{s}\cos\theta\tan\phi}{2}+\frac{\Omega_{p}\cos\theta\sin\theta\sin\phi}{\sqrt{2}}\right),
\end{align}
where $\lambda_{\phi,\theta}$ are the component of the (dimensionless) costate $\Lambda=[\lambda_{\phi},\lambda_{\theta}]^{\mathsf{T}}$ of dynamics 
\begin{subequations}
	\label{adjoint}
\begin{align}
	&\dot\lambda_{\phi}=-\frac{\partial H_{c}}{\partial\phi}\nonumber\\
	&=\frac{\lambda_{\phi}{\Omega}_{p}\sin\phi\cos^{2}\theta}{\sqrt{2}}-\lambda_{\theta}\left(\frac{{\Omega}_{s}\cos\theta}{2\cos^{2}\phi}+\frac{{\Omega}_{p}\sin2\theta\cos\phi}{2\sqrt{2}}\right),\\
	&\dot{\lambda_{\theta}}=-\frac{\partial H_{c}}{\partial\theta}\nonumber\\
	&=\lambda_{\phi}\left(\frac{{\Omega}_{p}\cos\phi\sin2\theta}{\sqrt{2}}+\frac{\Omega_{s}\cos\theta}{2}\right)\nonumber\\
	&+\lambda_{\theta}\left(\frac{{\Omega}_{s}\sin\theta\tan\phi}{2}-\frac{{\Omega}_{p}\cos2\theta\sin\phi}{\sqrt{2}}\right).
\end{align}
\end{subequations}
Without loss of the generality, we can consider the control functions satisfying the contraint \eqref{u1} as follows:
%\begin{subequations}
	\begin{align}
	\label{controlf}
		\Omega_{p}=\Omega_m(t)\cos\beta(t),\quad
		\Omega_{s}=\Omega_m(t)\sin\beta(t)
	\end{align}
%\end{subequations}
with the condition
\begin{equation}
	\Omega^{2}_{s}+\Omega^{2}_{p}=\Omega_m^2\le\Omega_0^2.
	\label{u2}
\end{equation}
The constraint \eqref{u1} is thus transferred to the condition \eqref{u2} (which is independent on $\beta$). The PMP maximization of $H_{c}$ is thus reduced to the necessary condition
\begin{equation}
	\frac{\partial H_{c}}{\partial \beta}=0,
\end{equation}
which gives
\begin{equation}
	\frac{\partial H_{c}}{\partial\beta}=\frac{\partial \Omega_{p}}{\partial\beta}H_{1}+\frac{\partial \Omega_{s}}{\partial\beta}H_{2}=-H_{1}\sin\beta+H_{2}\cos\beta=0,
\end{equation}
where
\begin{subequations}
\label{H1H2}
\begin{align} 
&H_{1}=\frac{\lambda_{\phi}\cos\phi\cos^{2}\theta}{\sqrt{2}}+\frac{\lambda_{\theta}\sin2\theta\sin\phi}{2\sqrt{2}},\\ &H_{2}=\frac{\lambda_{\theta}\cos\theta\tan\phi}{2}-\frac{\lambda_{\phi}\sin\theta}{2}.  
\end{align}
\end{subequations}
We then deduce
%\begin{subequations}
	\begin{align}
	\label{theta}
		\cos\beta=\frac{H_{1}}{\sqrt{H^{2}_{1}+H^{2}_{2}}},\quad \sin\beta=\frac{H_{2}}{\sqrt{H^{2}_{1}+H^{2}_{2}}}.
	\end{align}
%\end{subequations}
Substituting Eq. \eqref{theta} in Eq. \eqref{Htcontrol}, we obtain
\begin{equation}
	H_{c}=\Omega_m\sqrt{H^{2}_{1}+H^{2}_{2}}.
\end{equation}
from which we conclude that the control Hamiltonian is maximum for $\Omega_m=\Omega_0$, i.e. when the maximum of \eqref{u1} is reached at all times.
%with $\tilde{H}_{c}=H_{c}+1$ and
%\begin{equation}
%	\label{pulses}
%	\Omega_{p}=\frac{H_{1}}{R},\quad \Omega_{s}=\frac{H_{2}}{R},
%\end{equation}
%where $R=\sqrt{H^{2}_{1}+H^{2}_{2}}$. 
%The prescription of the numerical treatment comes as follows: one selects an initial conditions for adjoint states $\lambda_{\phi,\theta}$ from contour plot in terms of available cost when only $\textbf{ode45}$ is used and compute exact optimal control fields by solving $\textbf{ode45}$ in matlab optimizer $\textbf{fminsearch}$ with desired transfer efficiency.

\begin{figure}
	\centering
\begin{center}
	\includegraphics[scale=0.78]{fig3.eps}\\
		\includegraphics[scale=0.78]{fig31.eps}
		\caption{Contour plot for $\log_{10}(T-T_{\min})$ as a function of dimensionless $\lambda_{\phi,\text{i}}$ and $\lambda_{\theta,\text{i}}$ when the dynamics reaches the targeted transfer, for a given $\epsilon$. The transfer time is determined in a given range $T\in[0, \hat T]$ (taken here as $\hat T=15/\Omega_{0}$). The white areas mean that there is no transfer time found in the prescribed interval. We obtain $T_{\min}\approx7.40/\Omega_{0}$ for $\epsilon=0.002$ (upper frame), $T_{\min}\approx6.78/\Omega_{0}$ for $\epsilon=0.005$ (lower frame) along the dark straight lines, respectively.}
		\label{fig3}
	\end{center}
\end{figure}



\subsubsection{Numerics}
We first determine the systematic landscape of the time $T$ to reach the target (for a given $\epsilon$) by solving the set of equations (\ref{angles},\ref{adjoint}) with the controls \eqref{controlf} and $\Omega_m=\Omega_0$ rewritten as functions of the angles and the costate components via (\ref{theta},\ref{H1H2}), as a function of the two parameters $\lambda_{\phi,\text{i}}$ and $\lambda_{\theta,\text{i}}$, which with $\theta_{\text{i}}=0$, $\phi_{\text{i}}=0$ form the set of initial conditions.
The landscape is shown in Fig. \ref{fig3}, where the white areas corresponds to the absence of solution reaching the given target in the prescribed interval.
Figure \ref{fig3} shows an infinite set of initial $\lambda_{\phi\text{i}}$, $\lambda_{\theta\text{i}}$ forming two straight (symmetric) lines that lead to the same minimum $T_{\min}\approx7.4/\Omega_{0}$. 

The four quadrants give all the possible respective signs of the controls. The controls are both positive when the initial values $\lambda_{\phi\text{i}}$, $\lambda_{\theta\text{i}}$ are taken positive.
In order to determine a more accurate value of the optimum, we choose a certain value $\lambda_{\phi\text{i}}$ (\textit{e.g.} $\lambda_{\phi\text{i}}=1.85$) and run an optimal procedure leading to the (positive) value $\lambda_{\theta\text{i}}\approx0.45266$ corresponding to the minimum time (using a Nelder-Mead simplex algorithm as described in \cite{NMSM_matlab}).

\begin{figure}
	\begin{center}
		\includegraphics[scale=0.7]{fig4.eps}
		\caption{Optimal pulse area (blue full line) as a function of $\epsilon$ (in a logarithmic scale) for $\lambda_{\phi\text{i}}=1.85$ and the resulting optimum $\lambda_{\theta\text{i}}$
		and the logarithmic fit of the asymptotics for small $\epsilon$:  ${\cal A}_{\min}=\Omega_{0}T_{\min}\sim-(\ln\epsilon)/\sqrt{2}+3$ (red dashed line). 
		%with $a=0.69$ and $b=3.11$.
		}
		\label{fig4}
	\end{center}
\end{figure}
\begin{figure}
		\begin{center}
			\includegraphics[scale=0.7]{fig5.eps}
%		    \includegraphics[scale=0.7]{phasediagramT.eps}
			\caption{Optimal pulse shapes \eqref{pulsesPS} in units of $\Omega_0$ with $\epsilon=0.002$, $\lambda_{\phi\text{i}}=1.85$ and $\lambda_{\theta\text{i}}\approx0.45266$ operating in minimum time $T_{\min}\approx7.40/\Omega_{0}$ (upper frame), and the resulting population history and the ansatz \eqref{p10} (lower frame). }
			\label{fig5}
		\end{center}
\end{figure}

Figure. \ref{fig4} shows as a function of $\epsilon$ the minimum time, via the minimum generalized pulse area 
defined as
%the generalized pulse area, whose minimum, for given $\Omega_0$ and $\epsilon$, is determined by 
${\cal A}_{\min}=\int_{0}^{T_{\min}}dt \sqrt{\Omega_p^2+\Omega_s^2}=T_{\min}\Omega_0$. 
%with $T_{\min}$ obtained from Fig. \ref{fig4}.
It exhibits a logarithmic decreasing behavior similar to the two-level case. 
%{\color{red}To explain it, we start from Eq. \eqref{T}. Regarding the $tangent$ hyperbolic population function in terms of pulse area, we obtain the optimal time decreases exponentially as function of population deviation $\epsilon$ in nonlinear two-level system. This shows an analog to nonlinear three-level system. {\color{purple}Noting that to have desired final state indicates $|\Upsilon_{3}|^{2}=1-\epsilon$, $|\Upsilon_{2}|^{2}\simeq0$ and $|\Upsilon_{1}|^{2}\simeq\epsilon$. Thus, we assume final population $p=|\Upsilon_{2}|^{2}+|\Upsilon_{3}|^{2}$}} which is also in the form of $tangent$ hyperbolic \cite{prl119_Stephane}.
% it mentions $\tan(\theta(t)/2)=\frac{1}{\sqrt{2}}\tanh\left(\frac{1}{2}\int_{t_{i}}^{t}ds\Omega_{p}(s)\sin\phi(s)\sin\alpha(s)\right)$ by parameterization.
%We fit it with the function
%\begin{align}
%\mathcal{A}=\Omega_{0}T_{\text{min}}=a\ln\epsilon+b, 
%\label{areathree}
%\end{align} 
%according to the information given by Fig. \ref{fig4}, we have $a=-0.694227613645023$, $b=3.106967637476480$. It is seen they are almost indistinguishable. 
This suggests the following ansatz for the population inspired by the two-level problem and the behavior of the optimal pulse area in Fig. \ref{fig4} (taking $t_i=0$):
%\begin{align}
%y_2^2+x_3^2=\frac{1}{2}\tanh^{2}\left[\frac{\Omega_{0}t+B(t)}{-2a}\right], 
%\end{align}
%at $t=t_{f}$, 
% $p(t_{f})=\tanh^{2}\left[\frac{\mathcal{A'}+B}{-2a}\right]=1-\epsilon$,
%\begin{align}
%&\tanh\left[\frac{\mathcal{A'}+B}{-2a}\right]=\sqrt{1-\epsilon}\sim1-\frac{\epsilon}{2},\\
%&1-2\exp^{\frac{\mathcal{A'}+B}{a}}\sim 1-\frac{1}{2}\epsilon,\\
%&\exp^{\frac{\mathcal{A'}+B}{a}}\sim\frac{\epsilon}{4},\\
%&(\mathcal{A'}+B)=a(\log_{10}/\log(e)-\ln4),\\
%\end{align}
%we obtain $B(t_f)=-a\ln4-b= -2.144563811346667$.  Due to the feature of $\tanh$ function,  $\tanh^{2}(\frac{\mathcal{A'}}{-2a})\simeq\tanh^{2}(\frac{\mathcal{A'}+B(t_f)}{-2a})$ for small $\epsilon$,
%\begin{align}
%p(t)=\tanh^{2}(\frac{1.440449760777344}{2}(\int_{t_{i}}^{t}\Omega_{0}dt-2.144563811346667)),
%\label{p10}
%\end{align}
%At initial time, $p(0)=0$, we have $B(0)=0$. It leads to
\begin{align}
%	p(t)=\tanh^{2}\left[\frac{1.440449760777344\mathcal{A'}}{2}\right],
	y_2^2+x_3^2\approx\frac{1}{2}\tanh^{2}\Big(\frac{\Omega_{0}}{\sqrt{2}}t\Bigr),
	\label{p10}
\end{align}
which fits well the numerics of the dynamics shown in Fig. \ref{fig5}, but slightly overestimates the accuracy (of the order of $\epsilon$).
%of order $\epsilon$.
The boundary at $t_f=T_{\min}$ gives the asymptotic expansion for small $\epsilon$ (with $y_{2\text{f}}^2\ll x_{3\text{f}}^2$):
\begin{align}
%	p(t)=\tanh^{2}\left[\frac{1.440449760777344\mathcal{A'}}{2}\right],
	y_{2\text{f}}^2+x_{3\text{f}}^2 \approx \frac{1}{2}(1-\epsilon) \sim \frac{1}{2}\bigl(1-4e^{-\sqrt{2}{\cal A}_{\min}} \bigr),
\end{align}
i.e.
\begin{align}
	{\cal A}_{\min} \sim  -\frac{1}{\sqrt{2}}(\ln\epsilon-\ln4). 
\end{align}
We notice that the resulting logarithmic scaling with respect to $\epsilon$ is the same as the scaling of the fit determined from Fig. \ref{fig4}. The absolute value is different due to the systematic error of \eqref{p10} mentioned above.

%i.e. assuming $ y_{2\text{f}}^2=\alpha \epsilon$ \fbox{to be checked}:
%\begin{align}
%	{\cal A}_{\min} \approx  -a\ln\epsilon + \ln\Bigl( \frac{1-2\alpha}{4}\Bigr), 
%\end{align}
%\begin{align}
%	{\cal A} \approx -\frac{1}{\sqrt{2}}   \ln\Bigl(-\frac{1}{2} y_{2\text{f}}^2\Bigr) + \frac{\epsilon}{2\sqrt{2}y_{2\text{f}}^2} .
%\end{align}
%\begin{align}
%	\sqrt{2} {\cal A}\approx -\ln(\epsilon) + \ln(4)+\frac{y_{2\text{f}}^2}{2e^{-\sqrt{2} {\cal A}}}.
%\end{align}
%According to the fit in Fig. \ref{fig4}, we obtain $\ln( \frac{1-2\alpha}{4})=b$...\\
%\fbox{not correct since we get $\alpha<0$}.
%From Fig. \ref{fig5}, we observe the ansatz coincides with the numeric. 
%In the following, we show the pulses, population and parameterized angle $\phi$, $\theta$ determined by optimal control theory respectively in Fig. \ref{fig5} when $\epsilon=0.002$ with optimal initial conditions $\lambda_{\phi}(0)=1.85$, $\lambda^{N}_{\theta}(0)=0.452656250000001$. The pulses shape from $\lambda^{N}_{\phi}(0)=2.87$, $\lambda^{N}_{\theta}(0)=0.703234359715134$ is compared as well (not shown in the Fig. \ref{fig6} but the pulses and dynamics are indistinguishable). 
%{\color{purple}Noting that the time optimal control in three-level system indicates two intuitive pulses, meaning $\Omega_{p}(0)\ne1$ and $\Omega_{s}(0)=0$ at initial time plus $\theta_{0},\phi_{0}=0$ so that $\lambda_{\phi}(0)\ne0$. 
%The dimensionless minimal time $s\in[0,\tau_{\text{min}}]$ and $T_{\text{min}}=\tau_{\text{min}}/\Omega_{0}$. For convenience, we set $\Omega_{0}=1$.}
The dynamics and the controls of Fig. \ref{fig5} show an intuitive sequence of pulses with a large transient population in the upper state, similarly to the linear case which features pulses of explicit form $\cos -\sin$ \cite{Boscain,TNXu}. Figure  \ref{fig5_} shows the trajectory in the angles $\phi,\theta$ space corresponding to the optimal non-linear solution for $\epsilon=0.002$, it is compared to the optimal solution of the linear problem. 

\begin{figure}
		\begin{center}
			\includegraphics[scale=0.7]{fig6.eps}
%		    \includegraphics[scale=0.7]{phasediagramT.eps}
			\caption{Trajectories in the $\phi,\theta$ space of the optimal non-linear solution corresponding to the dynamics shown in Fig. \ref{fig5} (full line) and the optimal solution of the linear model (dotted line).}
			\label{fig5_}
		\end{center}
\end{figure}

\subsection{Energy optimal control}
%\subsubsection{Definition}
For the energy optimization, we use the cost functional
\begin{equation}
	\label{energycost1}
	J\equiv E=\hbar\int^{t_{f}}_{t_{i}}(\Omega^{2}_{p}+\Omega^{2}_{s})dt.
\end{equation}
%We turn to the sphere coordinate with 
%\begin{subequations}
%	\label{pangleenergy}
%	\begin{align}
%		&\Upsilon_{1}=\cos\phi\cos\theta,\\
%		&\Upsilon_{2}=-\frac{1}{\sqrt{2}}\sin\phi,\\
%		&\Upsilon_{3}=-\frac{\cos\phi\sin\theta}{\sqrt{2}},
%	\end{align}
%\end{subequations}
%and based on Eq. \eqref{angles}, 
We derive the control Hamiltonian (using the standard value $p_0=1/2$):
\begin{align}
	H_{c}&=\lambda_{\phi}\dot{\phi}+\lambda_{\theta}\dot{\theta}-p_{0}(\Omega_{p}^{2}+\Omega_{s}^{2}),
	\nonumber\\
		&=\lambda_{\phi}\left(\frac{\Omega_{p}\cos\phi\cos^{2}\theta}{\sqrt{2}}-\frac{\Omega_{s}\sin\theta}{2}\right)\nonumber\\ 
		&+\lambda_{\theta}\left(\frac{\Omega_{s}\cos\theta\tan\phi}{2}+\frac{\Omega_{p}\cos\theta\sin\theta\sin\phi}{\sqrt{2}}\right)\nonumber\\
	    &-\frac{1}{2}(\Omega_{p}^{2}+\Omega_{s}^{2}).
\end{align}
The PMP $\frac{\partial H_{c}}{\partial\Omega_p}=0$, $\frac{\partial H_{c}}{\partial\Omega_s}=0$ leads to the pulse shape:
\begin{subequations}
	\label{pulses1}
	\begin{align}
		&\Omega_{p}=\frac{\lambda_{\phi}\cos\phi\cos^{2}\theta}{\sqrt{2}}+\frac{\lambda_{\theta}\sin2\theta\sin\phi}{2\sqrt{2}},\\
		&\Omega_{s}=\frac{\lambda_{\theta}\cos\theta\tan\phi}{2}-\frac{\lambda_{\phi}\sin\theta}{2},
	\end{align}
\end{subequations}
and 
\begin{equation}
	H_{c}=\frac{1}{2}({\Omega^{2}_{p}+\Omega^{2}_{s}}),
\end{equation}
which is constant as before, i.e. $\Omega^{2}_{p}+\Omega^{2}_{s}=\Omega_0^2$.
The dynamics of the components of the (angular frequency unit) costate $\Lambda=[\lambda_{\phi},\lambda_{\theta}]^{\mathsf{T}}$ is still given by \eqref{adjoint}.
We thus obtain the same dynamics shown in Fig. \ref{fig5} as in the time-optimal control but for a given time of interaction $T=t_{f}-t_{i}$ (instead of $T_{\min}$). The corresponding optimal generalized pulse area ${\cal A}_{\min}$ is determined from Fig. \ref{fig4} for a given $\epsilon$: ${\cal A}_{\min}\approx-\ln(\epsilon)/\sqrt{2}+3$, and we deduce the corresponding $\Omega_{0,\min}={\cal A}_{\min}/T$. The minimum energy 
is then
%{\color{red}We also scale it with $\Omega_{0}$, right?
%Based on the previous conclusion, pulse area is provided by Eq. \eqref{areathree} once $\epsilon$ is fixed in which $T=t_{f}-t_{i}$. One can rewrite the cost functional:
\begin{align}
E_{\min}=\hbar\Omega_{0,\min}^2T=\hbar\mathcal{A}_{\min}^{2}/T.
\end{align}

%\section{Reformulate for linear three-level system}
%In linear regime, two-state system characterized by eigenvector $\bf{\psi}=[c_{1}, c_{2}]$ can be recast as three coupled equation for real-valued variables. The resulting optical Bloch equation without dissipation for a coherently driven two-level system under RWA writes
%\begin{equation}
%	\frac{d}{d t}\left(\begin{array}{c}u\\v\\w\end{array}\right)=\left[
%	\begin{array}{ccc}
%		0 & -\Delta & 0\\
%		\Delta & 0 & -\Omega\\ 
%		0 & \Omega & 0
%	\end{array}
%	\right]\left(\begin{array}{c}u\\v\\w\end{array}\right),
%\end{equation}
%where $u=c_{1}c^{*}_{2}+c^{*}_{1}c_{2}$, $v=-i(c_{1}c^{*}_{2}-c^{*}_{1}c_{2})$ and $w=|c_{1}|^{2}-|c_{2}|^{2}$. $\Delta$ and $\Omega$ denote detuning and Rabi frequency in two-level system. The Schr\"{o}dinger equation for a resonantly coupled three-state system in RWA, 
%\begin{equation}
%	i\frac{d}{d t}\left(\begin{array}{c}C_{1}\\C_{2}\\C_{3}\end{array}\right)=\left[
%	\begin{array}{ccc}
%		0 & \Omega_{p} & 0\\
%		\Omega_{p} & 0 & \Omega_{s}\\ 
%		0 & \Omega_{s} & 0
%	\end{array}
%	\right]\left(\begin{array}{c}C_{1}\\C_{2}\\C_{3}\end{array}\right),
%\end{equation}
%where $\Omega_{p,s}$ are Rabi frequencies quantify the energy of pump and Stokes fields in three-state system. By comparing $u=C_{1}$, $v=-iC_{2}$ and $w=-C_{3}$ and exchange the position of $u$ and $w$, we can tell two-state Bloch equation is completely equivalent to the three-state system. Based on this correspondence, we inversely assume the optimal pulses in linear three-level taking the forms of "$\text{cosine}$" and "$\text{sine}$". After replacing them back to the effective two-state Hamiltonian results in
%\begin{equation}
%H=\frac{\hbar}{2}\left[
%	\begin{array}{cc}
%		 0 & \Omega_{p}e^{i\int\Omega_{s}dt}\\
%	\Omega_{p}e^{-i\int\Omega_{s}dt} & 0
%	\end{array}
%	\right],
%	\label{twostateH}
%\end{equation}

%where $\Omega_{s}=\sin\beta$ and $\Omega_{p}=\cos\beta$ ( all real) indicating the intuitive sequences. By unitary transformation, it can be rewritten 
%\begin{equation}
%	H=\frac{\hbar}{2}\left[
%	\begin{array}{cc}
%	\Omega_{s} & \Omega_{p}\\
%		\Omega_{p}& -\Omega_{s}
%	\end{array}
%	\right],
%	\label{coupleH}
%\end{equation}
%We can obtain its eigenstate are
%\begin{align}
%	|\psi_{+}\rangle=\sin\frac{\beta}{2}|1\rangle-\cos\frac{\beta}{2}|2\rangle,\\
%	|\psi_{-}\rangle=\cos\frac{\beta}{2}|1\rangle+\sin\frac{\beta}{2}|2\rangle,
%\end{align}
%where $|1\rangle$, $|2\rangle$ are bare states and obviously can be written as coherent superposition of the two eigenstates of coupled Hamiltonian \eqref{coupleH}, 
%\begin{align}
%	&|1\rangle=\frac{1}{\sqrt{2}}[|\psi_{+}\rangle+|\psi_{-}\rangle],\\
%	&|2\rangle=\frac{1}{\sqrt{2}}[|\psi_{-}\rangle-|\psi_{+}\rangle],
%\end{align}the external fields drive the three-state system population transfer between state $|1\rangle$ and state $|3\rangle$, namely $|C_{1}(t=0)|^{2}=1$, $|C_{3}(t=t_{f})|^{2}=1$. Analogically, we obtain $|c_{1}(t=0)|^{2}=1$ and $|c_{1,2}(t=t_{f})|^{2}=1/2$ for two-state Bloch equations. Initially, we set our eigenstates with equal amplitude 
%\begin{align}
%	&|\psi_{+}(t=0)\rangle=\frac{1}{\sqrt{2}}\left(\begin{array}{c}
%	1 \\1
%	\end{array}\right),\\
%    &|\psi_{-}(t=0)\rangle=\frac{1}{\sqrt{2}}\left(\begin{array}{c}
%    	1 \\-1
%    \end{array}
%    	\right),
%\end{align} 
%then it goes to 
%\begin{align}
%	&|\psi_{+}(t=t_{f})\rangle=\left(\begin{array}{c}
%		1 \\0
%	\end{array}\right),\\
%	&|\psi_{-}(t=t_{f})\rangle=\left(\begin{array}{c}
%		0 \\ 1
%	\end{array}
%	\right),
%\end{align}
%By diagonalizing the Hamiltonian \eqref{coupleH} provides the non-adiabatic transition $-i\dot{\beta}$, 
%\begin{align}
%\dot{\beta}=\frac{\dot{\Omega}_{s}\Omega_{p}-{\dot{\Omega}_{p}\Omega_{s}}}{\Omega^{2}_{0}}=\frac{1}{T},
%\end{align}
%The adiabatic approximation is given by $\dot{\beta}\ll\Omega_{p,s}$ which indicates $T$ should be large enough to meet the adiabatic condition. And the diagonalized Hamiltonian is written, 
%\begin{align}
%H_{ad}=\frac{\hbar}{2}\left[
%\begin{array}{cc}
%\Omega_{0} & i\frac{1}{T}\\
%	-i\frac{1}{T}& -\Omega_{0}
%\end{array}
%\right],
%\end{align}
%It reveals the relation between final population and population deviation $\epsilon$,
%\begin{align}
%	1-\frac{1}{\Omega^{2}_{0}T^{2}}=1-\epsilon,
%\end{align}
%it turns out there is non-exponential decreasing with respect to $\epsilon$ in linear system under time-optimal control protocol.

%{\color{red}To compare with the pulse area the systems costs to go to target state, we plot the population as function of pulse area. Concerning the linear two-level mode under resonance, the population is in the form of $sine$ function.
%\begin{align}
%p(t)=1-\epsilon=\sin^{2}\left(\int_{t_i}^{t_f}\frac{\Omega_{0}t}{2T}\right),
%\end{align}
%}


%\begin{figure}
%		\begin{center}
%%			\includegraphics[scale=0.7]{contourlamE2.eps}
%			\includegraphics[scale=0.7]{contourlamE1.eps}
%			\caption{Contour plot for $\log_{10}(E-E_{\text{min}})$ as a function of the initial conditions $\lambda_{\phi}(0)$ and $\lambda_{\theta}(0)$ for $\epsilon=0.002$. We obtain $E_{\text{min}}\approx3.665\Omega_{0}$. The transfer energy is given by  Eq. \eqref{energycost1} and the transfer time $T_{t}\in[0, T^{\textbf{max}}_{t}]$ with $T^{\textbf{max}}_{t}=15/\Omega_{0}$. Noting that there is no solutions in the white areas when $T_{t}>T^{\textbf{max}}_{t}$. The blue stars mark the minimal value. It shows the symmetry.}
%			\label{fig6}
%		\end{center}
%\end{figure}
%

%\subsubsection{Numerics}
%Figure. \ref{fig6} shows the transfer energy obtained as a function of initial conditions $\lambda_{\phi}(0),\lambda_{\theta}(0)$ in the system of Eq. \eqref{angles} and Eq. \eqref{adjoint} plus $\theta_{0}=0$, $\phi_{0}=0$ regarding $\epsilon=0.002$. It is worthy to mention that the existed numerical method based on Runge-Kutta (4,5) formula is reliable and transfer energy in the finite time becomes localized. 
%%Optimal conditions $\lambda^{N}_{\phi0}$, $\lambda^{N}_{\theta0}$ and optimal energy are given by Nelder-Mead simplex algorithm after $N$ interaction. The details are illustrated in Table.\ref{table2}.  As seen in Fig. \ref{fig5}, the minimal energy is bounded around 5.4751.
%
%Figure. \ref{fig7} characterizes the pulses shapes and its population in energy optimization when $\lambda^{N}_{\phi0}=0.7 $, $\lambda^{N}_{\theta0}=0.17$ concerning $\epsilon=0.002$. The minimal energy $E\simeq3.7\Omega_{0}$ is computed when $\text{T}\sqrt{\Omega^{2}_{s}+\Omega^{2}_{p}} \simeq7.4$.
%
%\section{quantum speed limit}
%It is always interesting to determine the precision minimal evolution time of quantum process and connect it to optimal control theory. This section, we explore the quantum speed limit (QSL) in second order nonlinear three-level system. In an isolated system, the lower bound for a given initial state to a target state can be by the Mandelstam-Tamm type QSL\cite{jpa16},
%\begin{align}
%\tau\ge\hbar\mathcal{L}(\psi(t_{0}), \psi(\tau))/\langle E\rangle_{\tau}
%\end{align}
%where $\mathcal{L}$ is the Bures distance between the initial state $\psi(t_{0})$ and final state $\psi(\tau)$, $\mathcal{L}=\text{arccos}|\langle \psi(t_{0})|\psi(\tau)\rangle|$ and $\langle E\rangle_{\tau}=1/\tau\int_{0}^{\tau}(\langle H^{2}\rangle-\langle H\rangle ^{2})^{1/2}d\tau$ denotes the energy variance of system \cite{QSLprl65,MTbound}. We set initial state $\psi(t_{0})=[1, 0, 0]^{T}$ and target state $\psi(\tau)=[\cos\phi(\tau)\cos\theta(\tau), -\sin\phi(\tau)/\sqrt{2}, -\cos\phi(\tau)\sin\theta(\tau)/\sqrt{2}]^{T}$, $\hbar=1$ throughout all the context. By some linear algebra, we can derive 
%\begin{subequations}
%\begin{align}
%	&\langle H^{2} \rangle=\frac{u^{2}_{p}}{2}\psi^{*}_{1}\psi_{1}\psi^{*}_{1}\psi_{1}+\frac{u_{s}u_{p}}{4}\psi_{1}\psi_{1}\psi^{*}_{3}\\ \nonumber
%	&+\frac{u^{2}_{p}}{2}\psi^{*}_{1}\psi_{1}\psi_{2}\psi^{*}_{2}+\frac{u^{2}_{s}}{4}\psi_{2}\psi^{*}_{2}+\frac{u_{s}u_{p}}{2}\psi^{*}_{1}\psi^{*}_{1}\psi^{*}_{3}+\frac{u^{2}_{s}}{4}\psi^{*}_{3}\psi^{*}_{3},\\
%	&\langle H\rangle=\frac{u_{p}}{2}\psi_{1}\psi^{*}_{2}\psi_{1}+u_{p}\psi^{*}_{1}\psi^{*}_{1}\psi_{2}+\frac{u_{s}}{2}\psi^{*}_{3}\psi_{2}+\frac{u_{s}}{2}\psi^{*}_{2}\psi_{3},
%\end{align}
%\end{subequations}




%\begin{figure}
%	\begin{center}
%		\includegraphics[scale=0.7]{lambmin.eps}
%		\caption{Optimal time $T_{min}$ in terms of initial condition $\lambda_{\theta,0}$ while $\lambda_{\phi,0}=1.2$ and $\epsilon=0.002$. The minimal time is sensitive to the initial conditions. The bound of minimal cost is around 7.39938.}
%		\label{fig21}
%	\end{center}
%\end{figure}

%\vspace{2cm} 

%\begin{figure}
%	\begin{center}
%		\includegraphics[scale=0.7]{lambminE.eps}
%		\caption{Optimal energy $E_{min}$ in terms of initial conditions $\lambda_{\theta,0}$ when we consider $\lambda_{\phi,0}=1.2$ and $\epsilon=0.002$. The limit of minimal cost is around 5.4751.}
%		\label{fig5}
%	\end{center}
%\end{figure}

%\begin{figure}
%	\begin{center}
%		\includegraphics[scale=0.7]{dynamicsE.eps}
%		%\includegraphics[scale=0.7]{phasediagramE.eps}
%		\caption{Upper: pulses shapes from Eq. \eqref{pulses1} for energy optimization with $\lambda^{N}_{\phi}(0)=0.70$ and $\lambda^{N}_{\theta}(0)=0.17$ when $\epsilon=0.002$. The pulse area $T\sqrt{\Omega_{s}^2+\Omega_{p}^2} \simeq7.40$ with $T\in[0, T^{\text{max}}_{t}]$ and and energy cost $E_{\text{min}}\simeq3.67\Omega_{0}$. Below: population transfer. }
%		\label{fig7}
%	\end{center}
%\end{figure}

%\section{Optimal control on the Isomorphic non-linear three-level model}
%One can show that the three-level problem \eqref{xcoordinate} rewritten as
%\begin{subequations}
%	\begin{align}
%		&\dot{x}_{1}=Px_{1}z_{2},\\
%		& \dot{z}_{2}=-Sz_{3}-Px^{2}_{1},\\
%		&\dot{z}_{3}=Sz_{2}.
%	\end{align}
%\end{subequations}
%with $z_2=y_2\sqrt{2}$, $z_3=x_3\sqrt{2}$, $P=\Omega_{p}/\sqrt{2}$, $S=\Omega_{s}/\sqrt{2}$, is isomorphic to the non-linear two-level problem:
% \begin{subequations}
%\begin{align}
%	\label{eta1_}
%		&\dot{\eta}_{1}=\tilde\Delta\eta_{2},\\
%		\label{eta2_}
%		&\dot{\eta}_{2}=\frac{\Omega}{2}\Bigl(3\eta^{2}_{3}-\eta_{3}-\frac{1}{4}\Bigr)-\tilde\Delta\eta_{1},\\
%		&\dot{\eta}_{3}=\Omega\eta_{2}.
%		\label{eta3_}
%\end{align}
%\end{subequations}
%


\section{Conclusion}
\label{conclusion}
%\begin{table}[h]
%	\centering
%	\caption{$\lambda_{\phi,0},\lambda_{\theta_{0}}$, $\lambda^{N}_{\phi0},\lambda^{N}_{\theta0}$, $E_{min}$ ($\epsilon=0.002$)}
%	\begin{tabular}{|c|c|c|c|c|}
%		\hline
%		$\lambda_{\phi,0}$ & $\lambda_{\theta,0}$ & $\lambda^{N}_{\phi0}$ & $\lambda^{N}_{\theta0}$ & $E_{min}$ \\\hline
%		1.2 & 0.2 & 1.046449099817478 & 0.255995653637074& 5.47518317783416 \\\hline
%		1.2 & 0.3 & 1.04643608278819 & 0.25609604703481& 5.47512979465814 \\\hline
%		2 & 0.2 & 1.046432764268323 & 0.256038665864677& 5.475094134602612 \\\hline
%		2 & 0.5 & 1.046436116121648 & 0.255991559772844& 5.475115462540581 \\\hline
%		3 & 1.5 & 1.867041159585381 & 1.943018831466039& 17.429213051626313 \\\hline
%		3 & 1 & 1.855166318301331& 1.805616267751381  & 17.208210255909371 \\\hline
%		3 & 0.5 & 1.0464464556869906 & 0.255980892962681 & 5.475173267715993\\\hline
%	\end{tabular}
%	\label{table2}
%\end{table}


In this paper, we have determined the ultimate bounds in terms of optimal time and optimal energy for the two- and Raman three-level problems featuring a 1:2 non-linear resonance when an accurate (but not strictly complete) population transfer is targeted.
In both cases, we have incorporated the third-order Kerr terms in the detuning locking the dynamics to the resonance at all times.
In the two-level system, we have shown the equivalence of the dynamics for the optimal time or energy, given by a resonant and constant pulse, as it the case for the linear problem. The behavior of the resonant nonlinear dynamics is qualitatively different with the linear one: the complete inversion in only (exponentially) asymptotic instead of the Rabi oscillations of the linear problem (see Fig. \ref{figrobust}). The optimal time features an asymptotic logarithmic increasing as a function of the accuracy.
For the three-level problem, the optimal solution can be obtained only numerically. However, we have fitted it using the resembling results of the two-level problem. In this case, the generalized pulse area is constant. We have determined the shape of the individual pulses featuring an intuitive pump-Stokes sequence, as in the linear case but with different shapes.
We have also obtained an asymptotic logarithmic increasing of the optimal time as a function of the accuracy.

The finding of the ultimate bounds (time or energy) for nonlinear systems provide an important benchmark.
The issue of robustness of the process will have to be considered in future analysis involving optimal inverse engineering \cite{Dridi}, since the (almost) complete transfer is very unstable when the resonance is not perfectly satisfied (see Fig. 1 of Ref. \cite{pra_SG}). This is also the case for two-level adiabatic transfer \cite{pra102_Jingjun}. We notice that this instability does not exist when only third-order nonlinearities apply, neither for the usual nonlinear Raman three-level processes, where the target state is linked with the Stokes coupling which is linear.


\begin{acknowledgments}
We acknowledge support from the EUR-EIPHI Graduate School (17-EURE-0002) and from the European Union's Horizon 2020 research and innovation program under the Marie Sklodowska-Curie Grant No. 765075 (LIMQUET).  
X.C. acknowledges  EU FET Open Grant EPIQUS (Grant No. 899368), the
Basque Government through Grant No. IT1470-22,
the project grant PID2021-126273NB-I00 funded by
MCIN/AEI/10.13039/501100011033 and by ERDF A way
of making Europe and ERDF Invest in your Future and ayudas para contratos Ramon y Cajal2015-2020 (RYC-2017-22482).



\end{acknowledgments}

	
\appendix
\section{Isomorphism between non-linear three-level and two-level models}
The three-level problem \eqref{xcoordinate} can be rewritten as
\begin{subequations}
\label{motion3level}
	\begin{align}
		&\dot{x}_{1}=-Px_{1}z_{2},\\
		& \dot{z}_{2}=Sz_{3}+Px^{2}_{1},\\
		&\dot{z}_{3}=-Sz_{2},
	\end{align}
\end{subequations}
with $z_2=-y_2\sqrt{2}$, $z_3=x_3\sqrt{2}$, $P=\Omega_{p}/\sqrt{2}$, $S=\Omega_{s}/\sqrt{2}$, and the normalization condition $x_{1}^{2}+z_{2}^2+z_{3}^2=1$.
We assume that $P$ and $S$ are real and that $x_1(t_i)=1$. It can be reinterpreted as a density ``matrix'' formulation on the Bloch sphere:
\begin{equation}
\frac{d}{dt}\left[\begin{array}{ccc} \rho_z \\ \rho_y \\ \rho_x \end{array}\right]=
\left[\begin{array}{ccc} 0 & -P \rho_z & 0 \\ P \rho_z
& 0 & S \\
0 & -S & 0 \end{array}\right]\left[\begin{array}{ccc} \rho_z \\ \rho_y \\ \rho_x \end{array}\right]
\end{equation}
with $\rho_z=x_1=\rho_{11}-\rho_{22}=\vert a_1\vert^2-\vert a_2\vert^2$, $\rho_y=z_2=i(\rho_{21}-\rho_{12})=2 \Im(a_1\bar a_2)$, $\rho_x=z_3=\rho_{21}+\rho_{12}=2 \Re(a_1\bar a_2)$, $\rho_{ij}=a_i \bar a_j$ of a non-linear two-level problem
\begin{equation}
\label{H2}
H_{2,n\ell}=\frac{1}{2}\left[\begin{array}{cc}-S & P(|a_1|^2-|a_2|^2)\\
P(|a_1|^2-|a_2|^2) & S\end{array}\right]
%\psi_2=\left[\begin{array}{cc}a_1=\cos\frac{\theta}{2}e^{-i\eta}
%\\ a_2=e^{-i\varphi}\sin\frac{\theta}{2}e^{-i\eta}\end{array}\right].
\end{equation}
with $i\frac{d}{dt} \left[a_1\ a_2\right]^t =H_{2,n\ell} \left[a_1\ a_2\right]^t $ and the normalization $|a_1|^2+|a_2|^2=1$.
As a consequence, the non-linear three-level problem \eqref{motion3level} is isomorphic to the above non-linear two-state problem \eqref{H2}.
The non-linearity which appears here is not the one usually encountered \eqref{motiontwolevel}. We obtain a similar isomorphic relation for linear problems \cite{ShoreVitanov}.

% in the Bose-Einstein condensation or in non-linear optics.
%This isomorphism is well-known for the linear problem.
As a consequence, the transfer is, at the final time $t_f$, complete, $|z_3(t_f)|=1$, i.e. $\rho_x(t_f)=\pm1$, when, in the counterpart two-state problem, from the initial state $\rho_{11}(t_i)=1$, the superposition of state of maximal coherence is produced: $\rho_{12}(t_f)=\rho_{21}(t_f)=\pm1/2$.  This shows a similar qualitative behavior than for its linear analog.

The general solution of the two-state problem \eqref{H2} can be parametrized by three angles in general:
\begin{equation}
\label{solgen}
\left[\begin{array}{cc}a_1\\a_2\end{array}\right]
=\left[\begin{array}{cc}\cos(\theta/2)\\
\sin(\theta/2)e^{-i\varphi}\end{array}\right]e^{-i\gamma},
\end{equation}
and the Schr\"odinger equation leads to the set of equations
%\begin{subequations}
%\label{Modelangles}
%\begin{align}
%\label{ModelanglesI}
%&\dot \theta=2P\cos\theta\sin\varphi,\\
%\label{Modelanglesal}
%&\dot\varphi=2S+2P\frac{\cos^2\theta}{\sin\theta}\cos\varphi,\\
%\label{Modelanglesgam}
%&\dot\gamma=-S+P\cos\theta\tan(\theta/2)\cos\varphi.
%\end{align}
%\end{subequations}

\begin{subequations}
	\label{Modelangles1}
	\begin{align}
		\label{ModelanglesI}
		&\dot \theta=P\cos\theta\sin\varphi,\\
		\label{Modelanglesal}
		&\dot\varphi=S+P\frac{\cos^2\theta}{\sin\theta}\cos\varphi,\\
		\label{Modelanglesgam}
		&\dot\gamma=-\frac{S}{2}+\frac{P\cos\theta\tan(\theta/2)\cos\varphi}{2}.
	\end{align}
\end{subequations}


One can solve Eq. \eqref{ModelanglesI} exactly [for any $P(t)$ and $S(t)$]:
%\begin{equation}
%\label{solth}
%\tan(\theta/2)=\tanh\left[2\int_{t_i}^tP(s)\sin\varphi(s)ds \right].
%\end{equation}


\begin{equation}
		\label{solth}
		\tan(\theta/2)=\tanh\left[\frac{1}{2}\int_{t_i}^tP(s)\sin\varphi(s)ds \right].
\end{equation}

This shows that, in order to have a complete transfer from state 1 to state 3 in the original model, i.e. $\theta(t_i)=0$ and $\theta(t_f)=\pi/4$, one needs an infinite pulse area of $P(t)$. This contrasts with the linear model where a complete population transfer is possible for finite pulse areas \cite{Boscain}.


	
	
	\begin{thebibliography}{29}
%		\bibitem{warrenz_science}
%		W. Warren, H. Rabitz, and M. Dahleb, Coherent Control of Quantum Dynamics: The Dream Is Alive, Science \textbf{259}, 1581 (1993).
%		\bibitem{rabitz_science}
%		 H. Rabitz, R. de Vivie-Riedle, M. Motzkus, and K. Kompa, Whither the Future of Controlling Quantum Phenomena, Science, \textbf{288}, 824, (2000).
%		\bibitem{nielsen_quantuminfor}
%	     M. A. Nielsen and I. L. Chuang, Quantum Computation and Quantum Information (Cambridge University Press, Cam- bridge, U.K., 2000).
	   % \bibitem{atom_pra}
	   % H.L. Haroutyunyan and G. Nienhuis, Coherent control of atom dynamics in an optical lattice, Phys. Rev. A \textbf{64}, 033424 (2001).
%	   \bibitem{Henriet2020QuantumCW} L. Henriet, L. B{\'e}guin, A. Signoles, T. Lahaye, A. Browaeys, G. Reymond and C. Jurczak, Quantum computing with neutral atoms, Quantum \textbf{4}, 327 (2020).
%	   \bibitem{ions} B.P. Lanyon, C. Hempel, D. Nigg, M. M\"uller, R. Gerritsma, F. Z\"ahringer, P. Schindler, J.T. Barreiro, M. Rambach, G. Kirchmair, M. Hennrich, P. Zoller, R. Blatt, and C.F. Roos, Universal digital quantum simulation with trapped ions, Science \textbf{334}, 57 (2011).
%%	    \bibitem{qdots_chen}
%%	    P. Chen, C. Piermarocchi, and L.J. Sham, Control of Exciton Dynamics in Nanodots for Quantum Operations, Phys. Rev. Lett. \textbf{87}, 067401 (2001).
%%	    \bibitem{semiconduc_nature}
%%	    B.E. Cole et al., Coherent manipulation of semiconductor quantum bits with terahertz radiation, Nature (London) \textbf{410}, 60 (2001).
%          \bibitem{Mintert} T. N\"obauer, A. Angerer, B. Bartels, M. Trupke, S. Rotter, J. Schmiedmayer, F. Mintert, and J. Majer, Smooth Optimal Quantum Control for Robust 
%          Solid-State Spin Magnetometry, Phys Rev. Lett. \textbf{115}, 190801 (2015).
%	    \bibitem{superconduc_nature}
%	    Y. Nakamura, Yu. A. Pashkin, and J.S. Tsai, Coherent control of macroscopic quantum states in a single-Cooper-pair box, Nature
%	    (London) \textbf{398}, 786 (1999).
%	    \bibitem{SPQ} P. Krantz,  M. Kjaergaard, F. Yan, T.P. Orlando, S. Gustavsson, and  W.D. Oliver, A quantum engineer's guide to superconducting qubits, App. Phys. Rev. \textbf{6}, 021318 (2019).
%	    %\bibitem{BEC_nature}
%	    %E. A. Donley, N. R. Claussen, S. T. Thompson, C. E. Wieman, Atommolecule coherence in a BoseEinstein condensate, Nature, \textbf{417}, 529 (2002).
%	     \bibitem{BEC} N. Dupont, G. Chatelain, L. Gabardos, M. Arnal, J. Billy, B. Peaudecerf, D. Sugny and D. Gu\'ery-Odelin, Quantum State Control of a Bose-Einstein Condensate in an Optical Lattice, PRX Quantum \textbf{2}, 040303 (2021).
	    \bibitem{CPlevitt}
	    M.H. Levitt, Composite pulses, Prog. Nucl. Magn. Reson. Spectrosc. \textbf{18}, 61 (1986).
         \bibitem{Wimperis} S. Wimperis, Broadband, Narrowband, and Passband Composite Pulses for Use in Advanced NMR Experiments, J. Magn. Reson. \textbf{109}, 221 (1994).
%	    \bibitem{DDnature461}
%	    J. Du, X. Rong, N. Zhao, Y. Wang, J. Yang and R.B. Liu, Preserving electron spin coherence in solids by optimal dynamical decoupling, Nature, \textbf{461}, 1265 (2009).
	    \bibitem{CPprl106}
	    B.T. Torosov, S. Gu\'{e}rin, and N.V. Vitanov, High-Fidelity Adiabatic Passage by Composite Sequences of Chirped Pulses, Phys. Rev. Lett. \textbf{106}, 233001 (2011).	  
	    	       \bibitem{Jones} J.A. Jones, Designing short robust NOT gates for quantum computation, Phys. Rev. A \textbf{87}, 052317 (2013).  
	    \bibitem{CPprl129} S.S. Ivanov, B.T. Torosov, and N.V. Vitanov, High-Fidelity Quantum Control by Polychromatic Pulse Trains, Phys. Rev. Lett. \textbf{129}, 240505 (2022).
	    \bibitem{CPnjp24}
	    Z. Shi, C. Zhang, D. Ran, Y. Xia, R. Ianconescu, A. Friedman, X.X. Yi, and S. Zheng, Composite pulses for high fidelity population transfer in three-level systems, New J. Phys. \textbf{24}, 023014 (2022).

	    %\bibitem{CPprl113}
	    %G. T. Genov, D. Schraft, T. Halfmann, and N. V. Vitanov, Correction of Arbitrary Field Errors in Population Inversion of Quantum Systems by Universal Composite Pulses, Phys. Rev. Lett. \textbf{113}, 043001 (2014)
	   % \bibitem{CPnaturec6}
	   %X. Rong, J. Geng, F. Shi, Y. Liu, K. Xu, W. Ma, F. Kong, Z.
	   % Jiang, Y. Wu, and J. Du, Experimental fault-tolerant universal quantum gates with solid-state spins under ambient conditions, Nat. Commun. 6, 8748 (2015).
\bibitem{STIRAP} N.V. Vitanov, A.A. Rangelov, B.W. Shore, and K. Bergmann, Stimulated Raman adiabatic passage in physics, chemistry, and beyond, Rev. Mod. Phys. \textbf{89}, 015006 (2017).
\bibitem{STIRAP2} K. Bergmann et al., Roadmap on STIRAP applications, J. Phys. B \textbf{52}, 202001 (2019).
\bibitem{UltrafastSTIRAP} G. Dridi, S. Gu\'erin, V. Hakobyan, H.R. Jauslin, and H. Eleuch, Ultrafast stimulated Raman parallel adiabatic passage by shaped pulses, Phys. Rev. A \textbf{80}, 043408 (2009). 
	    \bibitem{STA}
	    X. Chen, I. Lizuain, A. Ruschhaupt, D. Gu{\'e}ry-Odelin, and J.G. Muga, Shortcut to Adiabatic Passage in Two- and Three-Level Atoms, Phys. Rev. Lett. \textbf{105}, 123003 (2010).
	    	    \bibitem{robustNJP} A Ruschhaupt, X. Chen, D. Alonso and J. G Muga, N. J. Phys. \textbf{14}, 093040 (2012).
	    \bibitem{STA2} D. Gu\'{e}ry-Odelin, A. Ruschhaupt, A. Kiely, E. Torrontegui, S. Mart\'{i}nez-Garaot, J.G. Muga, Shortcuts to adiabaticity: Concepts, methods, and applications, Rev. Mod. Phys. \textbf{91}, 045001 (2019).
		\bibitem{pra103}
        J. Zhu and X. Chen, Fast-forward scaling of atom-molecule conversion in Bose-Einstein condensates, Phys. Rev. A. \textbf{103}, 023307 (2021).
	    \bibitem{SSprl111}
	    D. Daems, A. Ruschhaupt, D. Sugny, and S. Gu{\'e}rin, Robust Quantum Control by a Single-Shot Shaped Pulse, Phys. Rev. Lett. \textbf{111}, 050404 (2013).
	    \bibitem{Hybrid} L. Van-Damme, D. Schraft, G.T. Genov, D. Sugny, T. Halfmann, and S. Gu\'erin, Robust not gate by single-shot-shaped pulses, Phys. Rev. A \textbf{96}, 022309 (2017).
	    \bibitem{Laforgue} X. Laforgue, Xi Chen, and S. Gu\'erin,  Robust stimulated Raman exact passage using shaped pulses,  Phys. Rev. A. \textbf{100}, 023415 (2019).
%	    \bibitem{adiabatic}
%	    N.V. Vitanov, T. Halfmann, B.W. Shore, and K. Bergmann, Laser-induced population transfer by adiabatic passage techniques, 
%	    Annu. Rev. Phys. Chem. \textbf{52}, 763 (2001).
\bibitem{OCT} C.P. Koch, U. Boscain, T. Calarco, G. Dirr, S. Filipp, S.J. Glaser, R. Kosloff, S. Montangero, T. Schulte-Herbr\"uggen, D. Sugny, F.K. Wilhelm, Quantum optimal control in quantum technologies. Strategic report on current status, visions and goals for research in Europe, EPJ Quantum Technol. \textbf{9}, 19 (2022).
	    \bibitem{prl103_Tomaso}
	    T. Caneva, M. Murphy, T. Calarco, R. Fazio, S. Montangero, V. Giovannetti, and G. E. Santoro, Optimal Control at the Quantum Speed Limit, Phys. Rev. Lett. \textbf{103}, 240501 (2009).
	    \bibitem{prl111}
	    G.C. Hegerfeldt, Driving at the Quantum Speed Limit: Optimal Control of a Two-Level System, Phys. Rev. Lett. \textbf{111}, 260501 (2013).
	     \bibitem{Frey}
           M.R. Frey, Quantum speed limits - primer, perspectives, and potential future directions, Quantum Inf Process \textbf{15}, 3919 (2016).
	    \bibitem{pra98}
	    F-Q. Dou, J. Liu, and L-B. Fu, Fast quantum driving in two-level systems with interaction and nonlinear sweep, Phys. Rev. A\textbf{ 98}, 022102 (2018).
%	    \bibitem{Lyapunov}
%	    M. Mirrahimi, P. Rouchon, and G. Turinici, Lyapunov control of bilinear Schr\"odinger equations, Automatica \textbf{41}, 1987
%	    (2005).
%	    \bibitem{LyapunovcontrolXXY}
%	    S.C. Hou, M. A. Khan, and X.X. Yi, Optimal Lyapunov-based quantum control for quantum systems, Phys. Rev. A \textbf{86}, 022321 (2012).
%	    \bibitem{geometrcontrol}
%	    V. Jurdjevic, Geometric Control Theory, Cambridge Studies in Advanced Mathematics (Cambridge University Press, Cambridge, 1996).
%	    \bibitem{OPalgorzhu109}
%	    W. Zhu and H. Rabitz, A rapid monotonically convergent iteration algorithm for quantum optimal control over the expectation value of a positive definite operator,  J. Chem. Phys. \textbf{109}, 385 (1998).
	    \bibitem{OPalgorzhu108}
	    W. Zhu, J. Botina, and H. Rabitz, Rapidly convergent iteration methods for quantum optimal control of population, J. Chem. Phys. \textbf{108}, 1953 (1998).
	    \bibitem{OPalgorzhu110}
	    W. Zhu and H. Rabitz, Noniterative algorithms for finding quantum optimal controls, J. Chem. Phys. \textbf{110}, 7142 (1999).
	    \bibitem{OPalgorRuths134}
	    J. Ruths and J. Lia, A multidimensional pseudospectral method for optimal control of quantum ensembles, J. Chem. Phys. \textbf{134}, 044128 (2011).
	    \bibitem{nonOppra78}
	    M. Lapert, R. Tehini, G. Turinici, and D. Sugny, Monotonically convergent optimal control theory of quantum systems under a nonlinear interaction with the control field, Phys. Rev. A \textbf{78}, 02340 (2008).
	    \bibitem{Krotov}
	    A.I. Konnov and V.A. Krotov, Automation and Remote Control \textbf{60}, 1427 (1999).
	   \bibitem{GRAPE}
	    N. Khaneja, T. Reiss, C. Kehlet, T. Schulte-Herbrueggen, and S.J. Glaser, Optimal control of coupled spin dynamics: Design of NMR pulse sequences by gradient ascent algorithms, Journal of Magnetic Resonance \textbf{172}, 296 (2005).
%	    \bibitem{shooting}	    O.V. Vasiliev, Optimization Methods (World Federation Publishers Company INC, Atlanta, GA, USA, 1996).
\bibitem{PMP} L.S. Pontryagin, V.G. Boltyanskii, R.V. Gamkrelidze, E.F. Mischenko, The Mathematical Theory of Optimal Processes (Wiley, New York, 1962).
\bibitem{Boscain} U. Boscain, G. Charlot, J.-P. Gauthier, S. Gu\'erin, and H. R. Jauslin, Optimal control in laser-induced population transfer for two- and three-level quantum systems, J. Math. Phys. \textbf{43}, 2107 (2002).
\bibitem{Extended} L. Van Damme, Q. Ansel, S.J. Glaser, and D. Sugny, Robust optimal control of two-level quantum systems, Phys. Rev. A \textbf{95}, 063403 (2017).
	    \bibitem{PMPprx}
	    U. Boscain, M. Sigalotti , and D. Sugny, Introduction to the Pontryagin Maximum Principle for Quantum Optimal Control, PRX Quantum \textbf{2}, 030203 (2021).
	  %  \bibitem{PMP}
	  %  D.V. Zhdanov and T. Seideman, Structure of optimal policies in quantum control, arXiv:1709.09423 (2018).
%	    \bibitem{methodPMP}
%	    J.T. Betts, Practical methods for Optimal Control using Nonlinear Programming SIAM, Philadelphia (2001).
	   %\bibitem{robustOPpra95}
	   %L. Van Damme, Q. Ansel, S. J. Glaser, and D. Sugny, Robust optimal control of two-level quantum systems, Phys. Rev. A \textbf{95}, 063403 (2017).
%	    \bibitem{PMPpra88}
%	    A. Garon, S.J. Glaser, and D. Sugny, Time-optimal control of SU(2) quantum operations, Phys. Rev. A \textbf{88}, 043422
%	    (2013).
%	   % \bibitem{PMPpra63}
	   % N. Khaneja, R. Brockett, and S. J. Glaser, Time optimal control in spin systems, Phys. Rev. A 63, 032308 (2001).
%	    \bibitem{PMPpra77}
%	    D. Sugny and C. Kontz, Optimal control of a three-level quantum system by laser fields plus von Neumann measurements, Phys. Rev. A \textbf{77}, 063420 (2008).
	   % \bibitem{tOppla384}
	   % M.A. Jafarizadeh, F. Naghdi, M.R. Bazrafkan, Time optimal control of two-level quantum systems, Phys. Lett. A, \textbf{384}, 29 (2020).
	  \bibitem{Barnes} J. Zeng, C.H. Yang, A. S. Dzurak, and E. Barnes, Geometric formalism for constructing arbitrary single-qubit dynamically corrected gates, Phys. Rev. A \textbf{99}, 052321 (2019).
\bibitem{Dridi} G. Dridi, K. Liu, and S. Gu\'erin,  Optimal robust quantum control by inverse geometric optimization, Phys. Rev. Lett. \textbf{125}, 250403 (2020).
\bibitem{Dridi2} X. Laforgue, G. Dridi, and S. Gu\'erin,  Optimal robust quantum control against pulse inhonomogeneities: Analytic solutions, Phys. Rev. A \textbf{106}, 052608 (2022).
%  \bibitem{OPprl125}
%	    G. Dridi, K. Liu, and S. Gu{\'e}rin, Optimal Robust Quantum Control by Inverse Geometric Optimization, Phys. Rev. Lett. \textbf{125}, 250403 (2020).
	    %\bibitem{PMPprl104}
	    %M. Lapert, Y. Zhang, M. Braun, S.J. Glaser, and D. Sugny, Singular Extremals for the Time-Optimal Control of Dissipative Spin 
	     %$\frac{1}{2}$ Particles, Phys. Rev. Lett. \textbf{104}, 083001 (2010).
	%    \bibitem{Opdissipative}
	%    H. Jirari and W. Po\"{o}tz, Optimal coherent control of dissipative N-level systems, Phys. Rev. A \textbf{72}, 013409 (2005).
	    %Vasiliev O., Optimization Methods (World Federation Publishers Company INC, Atlanta, GA, USA, 1996).
	   % \bibitem{OPLscapenjp}
	    %Constantin Brif, Raj Chakrabarti and Herschel Rabitz, Control of quantum phenomena: past, present and future, New J. Phys. \textbf{12}, 075008 (2010).
	   % \bibitem{OPLscapeRabitz}
	    %Raj Chakrabarti and Herschel Rabitz, Quantum control landscapes, Int. Rev. Phys. Chem. \textbf{26}, 671 (2007).
	    %\bibitem{GRAPE}  N. Khaneja, T. Reiss, C. Kehlet, T. Schulte-Herbrueggen, and S.J. Glaser, Optimal control of coupled spin dynamics: Design of NMR pulse sequences by gradient ascent algorithms, Journal of Magnetic Resonance \textbf{172}, 296 (2005).
		\bibitem{pra65_Drummond}
		P.D. Drummond and K.V. Kheruntsyan, Stimulated Raman adiabatic passage from an atomic to a molecular Bose-Einstein condensate, Phys. Rev. A. \textbf{65}, 063619 (2002).
		\bibitem{classical_H}
		V.I. Arnold, V.V. Kozlov, and A.I. Neishtadt, Mathematical Aspects of Classical and Celestial Mechanics (Springer, Berlin, 2006), 3rd ed.
			\bibitem{Henrard}
			J. Henrard, The Adiabatic Invariant Theory and Applications, in Hamiltonian Dynamics - Theory and Applications, Lecture Notes in Mathematics, edited by G.Benettin, J. Henrard, S.B. Kuksin, A. Giorgilli (Springer-Verlag, Berlin, Heidelberg, 2005), Vol. 1861.
		\bibitem{prl99_Itin}
		A.P. Itin and S. Watanabe, Integrability, Stability, and Adiabaticity in Nonlinear Stimulated Raman Adiabatic Passage, Phys. Rev. Lett \textbf{99}, 223903 (2007).
		\bibitem{pra_SG} S. Gu{\'e}rin, M. Gevorgyan, C. Leroy, H. R. Jauslin, and A. Ishkhanyan, Efficient adiabatic tracking of driven quantum nonlinear systems, Phys. Rev. A \textbf{88}, 063622 (2013).
	    \bibitem{epl_stephane}
	    M. Gevorgyan, S. Gu\'{e}rin, C. Leroy,  A. Ishkhanyan, and H.R. Jauslin, Adiabatic tracking for photo- and magneto-association of Bose-Einstein condensates with Kerr nonlinearities, Eur. Phys. J. D  \textbf{70}, 253 (2016).
		\bibitem{pra102_Jingjun}
		J.J. Zhu, X. Chen, H.R. Jauslin, and S. Gu\'erin, Robust control of unstable nonlinear quantum systems, Phys. Rev. A \textbf{102}, 052203 (2020).
		\bibitem{prl119_Stephane}
		V. Dorier, M. Gevorgyan, A. Ishkhanyan, C. Leroy, H.R. Jauslin, and S. Gu\'erin, Nonlinear Stimulated Raman Exact Passage by Resonance-Locked Inverse Engineering, Phys. Rev. Lett. \textbf{119}, 243902 (2017).
	    \bibitem{STAOPnon}
	    T. Huang, B.A. Malomed, and X. Chen, Shortcuts to adiabaticity for an interacting Bose-Einstein condensate via exact solutions of the generalized Ermakov equation, Chaos \textbf{30}, 053131  (2020).
	    \bibitem{pra94xc}
	    X. Chen, Y. Ban, and G.C. Hegerfeldt, Time-optimal quantum control of nonlinear two-level systems, Phys. Rev. A \textbf{94}, 023624 (2016).
	%    \bibitem{nonOppra66}
	   % S.E. Sklarz and D.J. Tannor, Loading a Bose-Einstein condensate onto an optical lattice: An application of optimal control
	    %theory to the nonlinear Schro\"{o}inger equation, Phys. Rev. A \textbf{66}, 053619 (2002).
	      \bibitem{Efstathiou} K. Efstathiou, Metamorphoses of Hamiltonian Systems with Symmetries, Lecture Notes in Mathematics (Springer-Verlag, Berlin, Heidelberg, 2005), Vol. 1864.
	      \bibitem{ShoreVitanov}
	      N.V. Vitanov and B.W. Shore, Stimulated Raman adiabatic passage in a two-state system, Phys. Rev. A \textbf{73}, 053402 (2006).
        \bibitem{NMSM_matlab}
        J.C. Lagarias, J.A. Reeds, M.H. Wright, and P.E. Wright, Convergence Properties of the Nelder-Mead Simplex Method in Low Dimensions, SIAM Journal of Optimization, \textbf{19}, 112 (1998).
	      \bibitem{TNXu}  T.-N. Xu, K. Liu, X. Chen, and S. Gu\'erin, Invariant-based optimal composite stimulated Raman exact passage, J. Phys. B \textbf{52}, 235501 (2019).



	\end{thebibliography}
	
	
	
	
	
	
	
	
	
	
	
	
\end{document}
% This must be in the first 5 lines to tell arXiv to use pdfLaTeX, which is strongly recommended.
\pdfoutput=1
% In particular, the hyperref package requires pdfLaTeX in order to break URLs across lines.

\documentclass[11pt]{article}

% Remove the "review" option to generate the final version.
\usepackage{acl}
%[review]

% Standard package includes
\usepackage{times}
\usepackage{latexsym}

% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
\usepackage[T1]{fontenc}
% For Vietnamese characters
% \usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets


\usepackage{graphicx}
\usepackage{csquotes}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{microtype}
\usepackage{colortbl}
\usepackage{subcaption}
%\usepackage[table,x11names,dvipsnames]{xcolor}
\usepackage{twemojis}
\usepackage{tikz}
\usepackage{threeparttable}
\usepackage{ragged2e}

%\usepackage[margin=20mm]{geometry}
\usepackage{enumitem}
\usepackage{etoolbox}
\AtBeginEnvironment{tcolorbox}{%
\setlist[itemize]{nosep,
                 leftmargin=*,
                 label=\textbullet,
                 before=\begin{minipage}[t]{\linewidth}, % <---
                 after=\end{minipage}\medskip}                   % <---
                            }

\usepackage[most]{tcolorbox}
\tcbuselibrary{raster}

\usepackage{lipsum}
\urlstyle{same}

\interfootnotelinepenalty=10000

% This assumes your files are encoded as UTF8
\usepackage[utf8]{inputenc}

% This is not strictly necessary, and may be commented out,
% but it will improve the layout of the manuscript,
% and will typically save some space.
\usepackage{microtype}

% If the title and author information does not fit in the area allocated, uncomment the following
%
%\setlength\titlebox{<dim>}
%
% and set <dim> to something 5cm or larger.

\newcommand{\bug}{\scalebox{1.75}{\twemoji{beetle}}}
\newcommand{\bugone}{\scalebox{1.25}{\twemoji{beetle}}\textsubscript{1}}
\newcommand{\bugtwo}{\scalebox{1.25}{\twemoji{beetle}}\textsubscript{2}}
\newcommand{\bugthree}{\scalebox{1.25}{\twemoji{beetle}}\textsubscript{3}}
\newcommand{\bugall}{\scalebox{1.25}{\twemoji{beetle}}\textsubscript{1,2,3}}
\newcommand{\smallbug}{\scalebox{1.25}{\twemoji{beetle}}}
\newcommand{\correct}{\scalebox{1.75}{\twemoji{check mark button}}}
\newcommand{\smallcorrect}{\scalebox{1.25}{\twemoji{check mark button}}}
\newcommand{\wrong}{\scalebox{1.75}{\twemoji{cross mark}}}
\newcommand{\smallwrong}{\scalebox{1.25}{\twemoji{cross mark}}}
\newcommand{\checkinbox}{\scalebox{1}{\twemoji{black square button}}}
\newcommand{\idea}{\scalebox{1.25}{\twemoji{light bulb}}}
\newcommand{\code}{\scalebox{1.25}{\twemoji{laptop}}}
\newcommand{\results}{\scalebox{1.25}{\twemoji{bar chart}}}
\newcommand{\school}{\scalebox{1.25}{\twemoji{school}}}
% \newcommand{\torchimpl}{PyTorch}
\newcommand{\torchimpl}{TorchAudio}

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

%\newcommand{\mg}{\textcolor{olive}}
%\newcommand{\sara}{\textcolor{blue}}
%\newcommand{\mn}{\textcolor{red}}

\newcommand{\mg}{\textcolor{black}}
\newcommand{\sara}{\textcolor{black}}
\newcommand{\mn}{\textcolor{black}}


\title{Reproducibility is Nothing without Code Correctness:\\Conformer Bugs, }

\title{Reproducibility is Nothing without Code Correctness:\\Debugging Incorrect findings and Pushing for Best Practices}

\title{Reproducibility is Nothing without  Correctness:\\Conformer Bugs, Incorrect }


\title{Secure the Science:\\ A Push for Proper Code Verification in NLP}


%%%% debugging, debunking
%%% debugging conformer, debunking findings
%%% debug and debunk: how errors in 
%%% debug and debunk: conformer errors, misleading results 
%%% Reproducibility is Nothing without Correctness:\\A Case Study  with Conformer, a Few Bugs
%%% Reproducibility is Nothing without Code Correctness:\\A Short Story of Three Bugs
%%% Reproducibility is Nothing without Code Correctness:\\Short Story of Three Bugs and Wrong Conclusions
%%% Reproducibility is Nothing without Code Correctness:\\Short Stories of Three Bugs and Wrong Happy Ends 
%%% Reproducibility is Nothing without Code Correctness:\\Three Conformer Bugs, Wrong Happy Ends and a Call to Action


\title{Reproducibility is Nothing without Correctness:\\The Importance of Testing Code in NLP}
%\title{Reproducibility is Nothing without Correctness:\\\sara{The Importance of Code Correctness in NLP}}

%\title{\mn{Reproducibility is Nothing without  Correctness:\\A Call to Action Towards Code Verification in NLP}}


% Open and Reproducible is not Enough: Best Practices to avoid m


% Author information can be set in various styles:
% For several authors from the same institution:
% \author{Author 1 \and ... \and Author n \\
%         Address line \\ ... \\ Address line}
% if the names do not fit well on one line use
%         Author 1 \\ {\bf Author 2} \\ ... \\ {\bf Author n} \\
% For authors from different institutions:
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \And  ... \And
%         Author n \\ Address line \\ ... \\ Address line}
% To start a seperate ``row'' of authors use \AND, as in
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \AND
%         Author 2 \\ Address line \\ ... \\ Address line \And
%         Author 3 \\ Address line \\ ... \\ Address line}

\author{Sara Papi\textsuperscript{\idea\results\school}, Marco Gaido\textsuperscript{\idea\results\school}, Matteo Negri\textsuperscript{\results}, Andrea Pilzer\textsuperscript{\code} \\
  \results Fondazione Bruno Kessler \\
  \school University of Trento \\
  \code NVIDIA \\
  \texttt{\{spapi,mgaido,negri\}@fbk.eu,apilzer@nvidia.com}
}

\begin{document}
\maketitle


\begin{abstract} 
\input{sections/abstract3.tex}
\end{abstract}

\blfootnote{\idea The authors contributed equally.}

\section{Introduction}
\input{sections/intro_v4.tex}




\section{Correctness is not Evaluated}
\label{sec:core-idea}
\input{sections/core_idea2.tex}

\section{The Case Study}%: Conformer}
%\section{\mn{Case Study: Using Conformer for Speech Processing Tasks}}
\label{sec:case-study}
\input{sections/case_study5.tex}

\section{Correctness Checklist}
\label{sec:checklist}
\input{sections/checklist2.tex}

\section{Conclusions}
\input{sections/conclusions2.tex}


\section*{Limitations}



% \sara{Our case study focused on the use of the Conformer architecture 
% %for the two most popular speech processing tasks: 
% \mn{in the two most popular speech processing tasks in which it is used:}
% speech recognition and translation.} 
To back up our call to action toward the adoption of coding best practices aimed at fostering correctness and improving the quality of the developed software, we presented a case study involving the use of the Conformer architecture in the two most popular speech processing tasks\sara{:}
%in which it is used: 
speech recognition and translation.
Although the effects of the presence of bugs might be found also in other 
%\mn{speech-related} 
scenarios, such as 
%\mn{like}
text-to-speech, speech emotion recognition, spoken language understanding, and speech separation, we did not cover them in this paper. 
%\mn{Although this was out of the scope of our study, its natural extension is to explore the undesired impact of the bug we isolated on these tasks.}
While the undesired effect of the 
%bug
bugs
we isolated (and corrected) was 
%sufficiently 
empirically
demonstrated, extending the analysis to 
%more tasks
other research areas
%is
would be
a natural extension of our study,
%\sara{
which could provide a more comprehensive understanding of the impact of
%code correctness
the identified bugs
on the broader NLP community working on speech-related tasks.
%}
%with a high potential impact on the broader community working on speech-related tasks.

Moreover, in our case study, we examined the open-source implementations of Conformer,
%Our case study focused on the open-source implementations of the Conformer architecture, 
%from 
in which we identified three types of bugs related to the Convolution Module, Initial Subsampling, and Positional Encodings.
While we found efficient solutions for the first two bugs, 
%in the last case 
for the last one
our fix introduces a significant overhead. As a result, the implementation
%In correcting the bugs, we found efficient solutions for the first two types of bugs but fail for the last one. Currently, the implementation that
we release, although correct,
%is slower compared to the implementation with bugs of about XXXX.
increases the training time of the models.
%We also hope that, as we release open-source our code, other members of the research community can optimize our solution, overcoming this limitation.
We are confident that, by open-sourcing our code, the community will soon find a way to optimize it and overcome this limitation, capitalizing on our findings and spreading the use of more reliable versions of a state-of-the-art architecture.



%Nonetheless, we believe that the importance of building on correct code far outweighs the additional computational cost and, in addition, we cannot exclude that the implementation can be improved through a software engineering process.

%% TTS, Speech emotion recognition, spoken language understanding, speech separation



% Entries for the entire Anthology, followed by custom entries
\bibliography{custom}
\bibliographystyle{acl_natbib}


\appendix

\input{sections/exp_sett.tex}


\end{document}

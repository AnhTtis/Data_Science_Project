\definecolor{myblue}{rgb}{0.20, 0.6, 0.78}
\definecolor{mygreen}{rgb}{0.2,0.8,0.2}
\definecolor{myred}{rgb}{0.5,0,0}
\definecolor{myorange}{rgb}{1,0.6,0.07}
\definecolor{mygrey}{rgb}{0.5,0.5,0.5}

 \begin{figure}[htb!]
    \centering
    \begin{tikzpicture}
    \begin{groupplot}[
        legend columns=3,
        legend style={
    	font=\tiny},
        group style=
            {rows=2, horizontal sep=1.3cm}
        ]
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%% ----------------------- 1
    \nextgroupplot[
    title style={yshift=-3.9cm},
    title=(a),
    xmin= 0, xmax = 50,
    ymin= 14.5, ymax = 23,
    ytick distance = 2,
    enlargelimits=false,
    clip=true,
    grid=major,
    mark size=0.5pt,
    width=.9\linewidth,
    height=0.5\linewidth,
    ylabel = {Indoor temperature},
    xlabel={Time step $t$},
    ylabel style={at={(axis description cs:-0.05,0.5)}},
    xlabel style={at={(axis description cs:0.5,-0.05)}},
    legend columns=2,
    label style={font=\scriptsize}, %\tiny
    ticklabel style = {font=\tiny},
    legend style={
    	font=\scriptsize, %\tiny,
    	draw=none,
		at={(0.5,1.03)},
        anchor=south
    }    
    ]
    \pgfplotstableread[col sep = comma]{figs/DR_y1_205_y2_225.dat}{\dat}
    % Indoor temperature
    \addplot+ [thick,mark=none,myred,mark options={solid, myred, scale=1}] table [x={t}, y={y1f}] {\dat}; 
    \addlegendentry{Output ($\left [19, 20.5\right ]$)}
    % legend: Solar input
    \addlegendimage{thick,mark=none,myblue,mark options={solid, myblue, scale=1}}
    \addlegendentry{Input ($\left [19, 20.5\right ]$)}  
     % Reference
    \addplot+ [thick,mark=none,myred, dashed, mark options={solid, myred, scale=1}] table [x={t}, y={y2f}] {\dat}; 
    \addlegendentry{Output ($\left [19, 22.5\right ]$)}   
    % legend: u max
    \addlegendimage{thick,mark=none,myblue, dashed, mark options={solid, myblue, scale=1}}
    \addlegendentry{Input ($\left [19, 22.5\right ]$)}
    

    %%% ----------------------- 2
    \nextgroupplot[
    title style={yshift=-3.9cm},
    title=(b),
    xmin= 0, xmax = 50,
    ymin= 14.5, ymax = 23,
    enlargelimits=false,
    clip=true,
    grid=major,
    mark size=0.5pt,
    width=.9\linewidth,
    height=0.5\linewidth,
    ylabel = {Indoor temperature},
    xlabel={Time step $t$},
    ylabel style={at={(axis description cs:-0.05,0.5)}},
    xlabel style={at={(axis description cs:0.5,-0.05)}},
    legend columns=2,
    label style={font=\scriptsize}, %\tiny
    ticklabel style = {font=\tiny},
    legend style={
    	font=\footnotesize, %\tiny,
    	draw=none,
		at={(0.5,1.03)},
        anchor=south
    }    
    ]
    \pgfplotstableread[col sep = comma]{figs/DR_y1_205_y2_225.dat}{\dat}
    % Indoor temperature
    \addplot+ [thick,mark=none,myred,mark options={solid, myred, scale=1}] table [x={t}, y={y1}] {\dat}; 
    % \addlegendentry{Output }
    % legend: Solar input
    \addlegendimage{thick,mark=none,myblue,mark options={solid, myblue, scale=1}}
    % \addlegendentry{Input}  
    %  % Reference
    \addplot+ [thick,mark=none,myred, dashed, mark options={solid, myred, scale=1}] table [x={t}, y={y2}] {\dat}; 
    % \addlegendentry{Output}   
    % % legend: u max
    % \addlegendimage{thick,mark=none,myblue, dashed, mark options={solid, myblue, scale=1}}
    % \addlegendentry{Input}
    
    \end{groupplot}
    
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 % right y axis
    \begin{groupplot}[
        legend columns=3,
        legend style={
    	font=\tiny},
        group style=
            {rows=2, horizontal sep=1.3cm}
        ]
 %%% ----------------------- 1
    \nextgroupplot[
    axis y line*=right,
    axis x line=none,
    xmin= 0, xmax = 50,
    ymin= -1, ymax = 16,  
    ytick distance = 6,
    ylabel = {Electrical power },
    ylabel style={at={(axis description cs:1.05,0.5)}},      
    enlargelimits=false,
    clip=true,
    mark size=0.5pt,
    width=.9\linewidth,
    height=0.5\linewidth,
    legend columns=2,
    label style={font=\scriptsize}, %\tiny
    ticklabel style = {font=\tiny},
    legend style={
    	font=\footnotesize, %\tiny,
    	draw=none,
		at={(0.5,1.03)},
        anchor=south
    }    
    ]  
    \pgfplotstableread[col sep = comma]{figs/DR_y1_205_y2_225.dat}{\dat}
    % Input
    \addplot+ [thick,mark=none,myblue,mark options={solid, myblue, scale=1}] table [x={t}, y={u1f}] {\dat};   
    
    \addplot+ [thick,mark=none,myblue,dashed,mark options={solid, myblue, scale=1}] table [x={t}, y={u2f} ] {\dat};        
    
     %%% ----------------------- 2
    \nextgroupplot[
    axis y line*=right,
    axis x line=none,
    xmin= 0, xmax = 50,
    ymin= -1, ymax = 16,  
    ytick distance = 6,
    ylabel = {Electrical power },
    ylabel style={at={(axis description cs:1.05,0.5)}},      
    enlargelimits=false,
    clip=true,
    mark size=0.5pt,
    width=.9\linewidth,
    height=0.5\linewidth,
    legend columns=2,
    label style={font=\scriptsize}, %\tiny
    ticklabel style = {font=\tiny},
    legend style={
    	font=\tiny, %\tiny,
    	draw=none,
		at={(0.5,1.03)},
        anchor=south
    }    
    ]  
    \pgfplotstableread[col sep = comma]{figs/DR_y1_205_y2_225.dat}{\dat}
    % Input
    \addplot+ [thick,mark=none,myblue,mark options={solid, myblue, scale=1}] table [x={t}, y={u1}] {\dat};   
    
    \addplot+ [thick,mark=none,myblue,dashed,mark options={solid, myblue, scale=1}] table [x={t}, y={u2} ] {\dat}; 
    
    
    \end{groupplot}
    \end{tikzpicture}
    \caption{Solution of the demand response problem (a)  Filtered data, split; (b) Raw data, split}%$du_i := u_i - \hat{u}_i$
    \label{fig:DR_compare}  
 \end{figure}
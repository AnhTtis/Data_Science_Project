%!TEX root = ../main.tex

\section{In-Car Service Security and Related Work}%
\label{sec:background_and_related_work}
Modern cars have a wide range of heterogeneous services as analyzed in our previous work~\cite{chrmk-qosso-19}.
Among them are \ac{ADAS}, which improve road safety and driving experience, and multimedia applications for infotainment.
Traditionally, \ac{E/E} architectures are rigidly integrated at design time and tightly couple software components to their \acp{ECU}.
As the number of services increases, \acs{E/E} architectures become more complex.
Orchestrating software applications across hardware resources in a dynamic \ac{SOA} allows for a more flexible software architecture~\cite{kakww-dsosa-19}.
This enables shorter innovation cycles, frequent updates, and on-demand installation of services.

Current vehicles are vulnerable to networked attacks via various interfaces including \ac{V2X} communication~\cite{mv-sraas-14,mv-reupv-15}.
In an unprotected network of services, a malicious participant can compromise the communication across the entire network.
This could disrupt the function of safety-related services.

Current automotive systems and protocols were often designed for closed environments~\cite{mrfmsvcJR21} and lack a robust security layer.
The AUTOSAR platform~\cite{rgksoasJR20} advises two major \ac{SOA} solutions for the automotive domain, \ac{SOME/IP} and \ac{DDS}~\cite{omg-dds-15}.
\ac{DDS} supports basic service authenticity~\cite{omg-dds-security-18}, while \ac{SOME/IP}, the most widely deployed protocol in the automotive domain, is tailored to a closely protected automotive environment.
\ac{SOME/IP} \ac{SD} lacks security means~\cite{irrsvssvJR20} including data confidentiality, protection against replay attacks, service authorization and authentication.
We focus on securing \ac{SOME/IP} through service authentication using the established Internet standards \ac{DNSSEC} and \ac{DANE} combined with common authenticity standards.


\subsection{Common Standards for Authentication}
Service authentication mechanisms generate trust by attesting the identity of a service  provider.
The certificate-based X.509 \ac{PKI}~\cite{RFC-5280} uses asymmetric cryptography and a trust anchor.
Certificates contain the public key that proves the identity of an entity, such as a service, and a signed reference to the trusted entity.
A client application requests this certificate and authenticates it using the public key of the trusted instance.
Subsequently, the client verifies the endpoint authenticity via a challenge-response protocol ensuring the entity possesses the private key.

The public \ac{CA} model uses the X.509 \ac{PKI} to attest certificate authenticity of Internet applications.
The \ac{TLS} handshake protocol, for example, verifies the endpoint authenticity of entities.
The main problem with the public \ac{CA} model is that any trusted \ac{CA} can issue a certificate for any domain name~\cite{RFC-6698}. 
Multiple signing \acp{CA} can generate attestation collisions.

\ac{DNSSEC}~\cite{RFC-2535} is a well-established infrastructure to secure the \ac{DNS} against unauthorized modifications of its records.
It adds signature records to the \ac{DNS} that ensure integrity and authenticity of the data stored in plain text records.
Asymmetric cryptography establishes a chain of trust from the root zone to any delegated zone. 
This chain of trust is built along the name hierarchy, though, and remains resistant against attestation collisions, which the Web PKI generates if multiple CAs sign the same resource name.

A robust and mature ecosystem developed during more than 15 years of \ac{DNSSEC} deployment.
This includes not only software and tooling but also a professional practice and thorough analyses of credential maintenance~\cite{otsw-fbtfy-22} including the roll-over of the \ac{DNSSEC} root keys~\cite{mtwhc-rrryr-19}. 
It is noteworthy that \ac{DNSSEC} can also be deployed for private namespace management independent of the global Internet naming hierarchy.

\ac{DANE} enables the binding of certificates to names in the \ac{DNS}.
It uses TLSA records to store certificate data tied to domain names.
The certificate presented by a server must then match against the certificate associated with DNS data to determine the integrity and authenticity of the server.
The security of \ac{DANE} is bound to \ac{DNSSEC} and thus benefits from the inherent chain of trust, which ensures the integrity and authenticity of the TLSA records.

In this work, we modify the \ac{SOME/IP} \ac{SD} to query \ac{DNSSEC}-verified service parameters and connection information stored in the \ac{DNS}.
Further, we bind certificates to services using TLSA records.
We sign all records to obtain signature records and achieve authenticity and integrity of the service parameters and certificates.
The benefit from this approach is a collision-free publisher authenticity that is protected by the well-established DNSSEC infrastructure.


\subsection{\ac{SOME/IP} \acl{SD}}
\ac{SOME/IP} is widely used in automotive networks and is capable of communicating via UDP and TCP transport.
Its design goals include scalability and low resource consumption.
\ac{SOME/IP} uses a publish-subscribe model.
Publishers can notify subscribers about an update or an event that has occurred.
\ac{SOME/IP} \ac{SD} announces and discovers services via multicast.
It also performs the session establishment between publishers and subscribers after a successful subscription.
\ac{SOME/IP} provides no means for service authenticity. 

Figure~\ref{fig:someipsd} shows the \ac{SOME/IP} \ac{SD} sequence for service announcements, discovery,
and subscription.
The \ac{SOME/IP} \ac{SD} uses multicast \codeword{find} and \codeword{offer} messages to request and announce services,
which are described by their ID, instance ID, major and minor version.
An \codeword{offer} entry uses so-called endpoint options to describe how to contact a service.
There are two concepts of discovering a service.
(1)~A publisher periodically updates an \codeword{offer} message, as an \codeword{offer} has a limited lifetime.
(2)~A subscriber requests a service via a \codeword{find} message, whereupon corresponding publisher instances
announce it via an \codeword{offer} message.
After the subscriber receives the \codeword{offer} message, it subscribes to the service via unicast specifying its receiving endpoint description and the desired Eventgroup.
If the publisher can provide this service, it acknowledges the subscription, after which the transmission of the requested data begins.

\input{tex/tikz-drawings/someipsd-sequence}

\subsection{In-Vehicle Service Authenticity and Confidentiality}
Secure discovery mechanisms are essential to prevent attackers from infiltrating automotive networks and eavesdropping on in-vehicle communication.
Challenge-response schemes can authenticate nodes to control service access.
Message encryption keeps unauthorized participants from eavesdropping on network communication.
In this work, we focus on publisher authenticity using a challenge-response scheme based on the public credentials obtained from DNSSEC.

Common standards for authentication have been applied to in-vehicle networks.
Challenge-response mechanisms require cryptographic keys that are commonly pre-deployed on the vehicle \acp{ECU} and can be both symmetric secret keys~\cite{kucaeJR22} or asymmetric key pairs~\cite{fizjspsJR17}.
Further, a \ac{PKI} uses a trust anchor to enable the authenticity and integrity of certificates with keys that can be revoked when they are no longer secure~\cite{aahmsapJR21,adpsepJR18}.
In this work, we use asymmetric cryptography for a challenge-response mechanism and \ac{DNSSEC} with its inherent chain of trust to ensure certificate authenticity.

Prior research proposed methods for securing \ac{SOME/IP}, including message encryption and service authentication~\cite{irrsvssvJR20,zlkkassJR21,myzzcascJR22}.
Iorio et al.~\cite{irrsvssvJR20} follow the public \ac{CA} model and a challenge-response scheme using asymmetric cryptography.
Each vehicle has a different trusted root certificate, used to sign the certificates of the \ac{ECU} and the services, creating a simplified chain of trust.
They also bind access control policies to the signed certificates.
We use a similar challenge-response scheme based on asymmetric cryptography to authenticate publishers.
Ma et al.~\cite{myzzcascJR22} use \acp{MAC} against message forgery, and a key management center that derives temporary session keys from encrypted received nonces.
Zelle et al.~\cite{zlkkassJR21} propose two solutions for \ac{SOME/IP} message authentication, one that authenticates services on the \acp{ECU} themselves, and another introducing an authorization server to authenticate messages. 
These solutions, however, require pre-deployed keys and certificates on every \ac{ECU}, which generates the challenge of credential management in practice.
In contrast, we use the \ac{DNS} recursive resolver infrastructure for managing certificate provisioning and \ac{DNSSEC} and \ac{DANE} for ensuring certificate authenticity, reducing the load on the \ac{ECU}.
Our approach only requires signature validation on the \ac{ECU}.

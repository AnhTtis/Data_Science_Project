%\begin{figure}[H]
\begin{figure}
	\centering
	\begin{tikzpicture}[font=\sffamily,line width=0.03cm, scale=0.9,every node/.style={scale=0.9}]
	    \node[mybox,minimum width=6.4cm] (chk_hsh){ Checking the hash};
	    \node[mybox,below=0.0cm of chk_hsh,yshift=\pgflinewidth,minimum width=6.4cm] (chk_valid){Checking vector update validity};
	    \node[mybox,below=0cm of chk_valid,yshift=\pgflinewidth,minimum width=6.4cm] (chk_auth){ Authorization};
	    \node[below=0.075cm of chk_auth,xshift=2cm] (c_text){\large{zkWF program}};
		\node[
		rectangle,
		draw,
		minimum width= 7.5cm,
		minimum height=3.5cm,
		fit=(chk_hsh) (chk_valid) (chk_auth)] (comp) {};
		\node [above=1.5cm of comp,xshift=-1.0cm] (inputcenter) {};
		\node [left=0.75cm of inputcenter] (public) {Public inputs};
		\node [right=0.75cm of inputcenter] (private) {Private inputs};
		%Public Inputs
		\node [yshift=2.5cm,xshift=1.4cm] at (comp -| public)  (publiccenter){};
		\node [left=of publiccenter] (hcurr) {$\hcurr$};
		\node [right=of hcurr,xshift=-1.15cm] (Scurr){$\Snew$};
		\draw[<-] (comp.north -| Scurr) -- (Scurr);
		\draw[<-] (comp.north -| hcurr) -- (hcurr);
		\node[draw,dotted,fit=(Scurr) (hcurr) (public)] {};
		% Private inputs
		\node [yshift=2.5cm,,xshift=-0.4cm] at (comp -| private)  (privatecenter) {};
		 \node [left=of privatecenter] (scurr) {$\scurr$};
		 \node [right=of scurr,xshift=-1.15cm] (rcurr) {$\rcurr$};
		 \node [right=of rcurr,xshift=-1.15cm] (snew) {$\snew$};
		 \node [right=of snew,xshift=-1.15cm] (rnew) {$\rnew$};
		 \node [right=of rnew,xshift=-1.15cm] (pk) {$\pk$};
		 \node [right=of pk,xshift=-1cm] (sk) {$\sk$};
		 \draw[<-] (comp.north -| scurr) -- (scurr);
		 \draw[<-] (comp.north -| rcurr) -- (rcurr);
		 \draw[<-] (comp.north -| snew) -- (snew);
		 \draw[<-] (comp.north -| rnew) -- (rnew);
		 \draw[<-] (comp.north -| pk) -- (pk);
		 \draw[<-] (comp.north -| sk) -- (sk);
		\node[draw,dotted,fit=(pk) (sk) (rnew) (scurr) (private),minimum width=5.85cm] {};
		 % Output
		 \node [below=of comp,yshift=0.5cm] (hnew) {$\hnew=\textit{hash}(\snew|| \rnew )$};
		 \node [below=0.5cm of hnew,yshift=0.7cm] (outputs) {Outputs};
		 \draw[->] (comp.south -| hnew) -- (hnew);
		 \node[draw,dotted,fit=(outputs) (hnew),minimum width=4.5cm] {};
	\end{tikzpicture}
	\caption{The basic computation model of zkWF programs}
	\label{fig:zkwfProgram}
\end{figure}
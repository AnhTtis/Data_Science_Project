\documentclass[journal,twoside,web]{ieeeconf}
\usepackage[utf8]{inputenc}
\usepackage{tikz}
\usepackage{circuitikz}
\usepackage{amsmath,amssymb,euscript ,yfonts,psfrag,latexsym,dsfont,graphicx,bbm,color,amstext,wasysym,subfig,flushend,parskip}
\usepackage{times,mathptmx,epsfig,graphicx,lineno,color, balance}




\usepackage{caption}
%\usepackage{subcaption}
\definecolor{grey}{rgb}{0.6,0.6,0.6}
\definecolor{lightgray}{rgb}{0.97,.99,0.99}
 \newcommand{\dbar}{d\hspace*{-0.1em}\bar{}\hspace*{0.2em}}
\definecolor{llgrey}{rgb}{0.9,0.9,0.9}
\definecolor{lgrey}{rgb}{0.6,0.6,0.6}
\definecolor{lred}{rgb}{0.9,0.7,0.7}
\newcommand{\blue}{\color{blue}}
\newcommand{\black}{\color{black}}
\definecolor{dblue}{rgb}{0,0.5,.7}
\newcommand{\dblue}{\color{dblue}}

\usepackage{xcolor}
\modulolinenumbers[5]

\newtheorem{theorem}{Theorem}
\newtheorem{prop}{Proposition}
\newtheorem{definition}{Definition}
\newtheorem{example}{Example}
\newtheorem{remark}{Remark}

%\newcommand{\trace}{{\rm trace\,}}
\newcommand{\cQ}{Q}
\newcommand{\cW}{W}
\newcommand{\trace}{{\rm Tr\,}}

\def\spacingset#1{\def\baselinestretch{#1}\small\normalsize}
\setlength{\parskip}{5pt}
\setlength{\parindent}{15pt}
\spacingset{1}
%\topmargin=-.5in
%\textheight=9in
%\textwidth=6.5in
%\oddsidemargin=.0in\evensidemargin=.0in
\usepackage{amsmath}
\newcommand{\Area}{\mathcal A}
\newcommand{\const}{l^4}
\newcommand{\Expect}{\mathbb{E}}
\newcommand{\ud}{d}
\newcommand{\one}{\mathbf{1}}
\newcommand{\zero}{\mathbf{0}}
\newcommand{\I}{{\mathcal I}}
\newcommand{\op}[1]{\operatorname{#1}}
\newcommand{\norm}[1]{\|#1\|}
\newcommand{\Tan}{\op{Tan}}
\renewcommand{\tilde}{\widetilde}
\newcommand{\F}{{\mathcal F} }
\newcommand{\real}{\mathbb{R}}
\newcommand{\argmax}{\mathop{\operatorname{argmax}}}
\newcommand{\argmin}{\mathop{\operatorname{argmin}}}
\newcommand{\mR}{\mathbb{R}}
\newcommand{\calC}{\mathcal{C}}
\newcommand{\calD}{\mathcal{D}}
\newcommand{\calF}{\mathcal{F}}
\newcommand{\calG}{\mathcal{G}}
\newcommand{\calK}{\mathcal{K}}
\newcommand{\calP}{\mathcal{P}}
\newcommand{\Q}{\mathcal{Q}}
\newcommand{\calX}{\mathcal{X}}
\newcommand{\calY}{\mathcal{Y}}
\newcommand{\newP}[1]{\medskip\noindent{\bf #1}}
\newcommand{\etaU}{\eta}
\newcommand{\etaQ}{\eta_{\hspace*{-2pt}\;_\mathcal{Q}}}


\newcommand{\lam}{{\ell_r}}
\newcommand{\Lyap}{\mathcal{L}}
\newcommand{\nablax}{{\partial_x}}
\newcommand{\nablay}{{\partial_y}}

	\newcommand{\supu}{{\rm \bf u}}
\newcommand{\supo}{{\rm \bf o}}


\newcommand{\W}{{\rm W}}
\newcommand{\mZ}{{\mathbb Z}}
\newcommand{\Prob}{{\rm Pr}}
\newcommand{\D}{{\mathbb D}}
\newcommand{\cX}{{\mathcal X}}
\newcommand{\cT}{{\mathcal T}}
\newcommand{\cS}{{\mathcal S}}
\newcommand{\E}{{\mathbb E}}
\newcommand{\mcN}{{\mathcal N}}
\newcommand{\mcR}{{\mathcal R}}
\newcommand{\diag}{\operatorname{diag}}
\newcommand{\opt}{{\rm opt}}
\newcommand{\tr}{\operatorname{trace}}


\begin{document}
\title
%{Power transfer in Stochastic Thermodynamics}
{A matching principle for power transfer\\ in Stochastic Thermodynamics}
%Impedance matching in Stochastic Thermodynamics}

\author{Olga Movilla Miangolarra$^\star$, Amirhossein Taghvaei$^\dagger$, and Tryphon T. Georgiou$^\star$
\thanks{$^\star$Mechanical and Aerospace Engineering, University of California, Irvine, CA 92697, USA;
omovilla@uci.edu, tryphon@uci.edu}
\thanks{$^\dagger$Aeronautics and Astronautics Department, University of Washington, Seattle, Washington 98195, USA; amirtag@uw.edu}}

\maketitle

\begin{abstract}
Gradients in temperature and particle concentration fuel many processes in the physical and biological world. In the present work we study a thermodynamic engine powered by anisotropic thermal excitation (that may be due to e.g., a temperature gradient), and draw parallels with the well-known principle of impedance matching in circuit theory, where for maximal power transfer, the load voltage needs to be half of that of the supplying power source. We maximize power output of the thermodynamic engine at steady-state and show that the optimal reactive force is precise half of that supplied by the anisotropy.
\end{abstract}


\section{Introduction}
Imagine a wind mill, with blades at an angle with respect to wind velocity, and the wind coming straight at it.
The windmill draws power for rotational speeds $\omega\in(0,
\omega_{\rm max})$; clearly, if it is not rotating no power is drawn, and if it rotates too fast in the direction of the wind, power is delivered instead of drawn.
At what angular velocity is the power drawn maximal? This depends on the geometry of the blades and is not the subject of our paper. However, it is intuitively clear that the ``sweet spot'' is somewhere in the middle, where the product of torque applied by the wind times the angular velocity, hence power, is maximal. This helps highlight a general principle.



In some detail, and in order to draw parallels later on, assume a first-order approximation for the supplied torque by the wind $\tau_S-\omega R$. The dynamics of the angular velocity of the windmill obey 
$J\dot \omega = \tau_S-\omega R-\tau_L$,
where $\tau_L$ represents the torque of the load. At steady-state, 
\begin{equation}\label{eq:matching}
    \omega=(\tau_S-\tau_L)/R
\end{equation}
and the power drawn is $P=\omega\tau_L$. Clearly, the power is positive for $\omega\in(0,\omega_{\max}=\tau_S/R)$, and is maximal  for $\omega^*=\omega_{\max}/2$ with an optimal load torque
\[
\tau^*_L=\tau_S/2.
\]
Thus, as expected, the ``sweet spot''  is in the middle.


% {\blue
% Imagine a wind mill, with blades at an angle with respect to wind velocity, and the wind coming straight at it.
% The windmill draws power for rotational speeds $\omega\in(0,
% \omega_{\rm max})$; clearly, if it is not rotating no power is drawn, and if it rotates too fast in the direction of the wind, power is delivered instead of being drawn.
% At what angular velocity is the power drawn maximal? 
% This depends on the geometry of the blades, but assuming a first-order approximation, the torque from the wind at steady-state is $\tau=\tau_0-\alpha\omega$. Then, the power drawn is $\tau\omega$, which vanishes for $\omega=0$ or $\omega_{\max}=\frac{\tau_0}{\alpha}$, and is maximal for $\omega^*=\frac{\tau_0}{2\alpha}$ and $\tau^*=\tau_0/2$.
% Thus, as expected, the ``sweet spot'' for maximal power is in the middle. This helps highlight a general principle.
% }


This same principle is often referred to as impedance matching in circuit theory. We briefly point to a textbook example. Consider a voltage source $V_S$ with internal resistance $R_S$ (that includes that of the transmission line) and a load with resistance $R_L$ as in Figure~\ref{fig:electricalcircuit}.
Then, the current is 
\[
i=(V_S-V_L)/R_S,
\]
where $V_L=i R_L$, and the power drawn is $P=i V_L$.
The power is maximal when the load resistance matches that of the source, $R_L=R_S$, equivalently, it is half of the total $R_L=(R_S+R_L)/2$.
Viewing the load as reacting by producing voltage $V_L$, the power is maximal (irrespective of $R_S$) when 
\[
V_L^*=V_S/2.
\]


The purpose of the present work is to point to a similar principle in
nonequilibrium thermodynamics. We consider 
a thermodynamic ensemble of particles subject to anisotropic fluctuations along different degrees of freedom, and we study the problem of maximizing power output at a {\em nonequilibrium steady-state} (NESS). The NESS can be pictured as a whirlwind, with the thermal anisotropy constituting the power source that sustains the circulatory steady-state current. The optimal load, effected by 
externally actuated non-conservative forces,  turns out to be half of that supplied by the anisotropy (cf.\ \eqref{eq:mainresult}).




% {\blue Above... first attempt.}


% Voltage matching blablabla 
% The problem that we will consider shortly is analogous to that of finding the optimal voltage load to maximize power output though it. Namely, we consider the circuit in Fig.\ref{fig:voltage}.
% The power input at the load is given by $$
% P_L=iV_L=V_L(V_S+V_L)/R_S,
% $$
% where we have used  the fact that $i=(V_S+V_L)/R_S$. Note that this is analogous to the expression of differential of work \eqref{eq:workrateNC}, with $V_L$ being analogous to $F$ and $V_S$ being analogous to the divergence-free part of $-k_B T\nabla\log\rho_{ss}$. It's minimum (maximum power output) is attained at
% $$
% (V_S+2V_L)/R_S=0 \ \implies \ V^*_L=-\frac{1}{2}V_S,
% $$
% while the maximum power is given by 
% $$
% P_L^*=-\frac{1}{4}V_S^2R_S.
% $$

In Section \ref{sec:BrownianGyrator} we present a canonical example of a system subject to anisotropic temperatures. Then, Sections \ref{sec:Gaussian} and \ref{sec:general}  develop the matching principle in the case where the control potential is quadratic, and in general, respectively.

\begin{figure}
    \centering
\begin{circuitikz} \draw
(0,2) to[battery] (0,0) to (4,0) to[R=$R_L$] (4,2) to [R=$R_S$] (0,2);
\node (A) at  (0.3,1.7) {$V_S$};
\node (B) at  (4.3,1.7) {$V_L$};
\node (C) at  (-0.3,1.7) {$+$};
\node (D) at  (3.7,1.7) {$+$};
\draw (2,0) to (2,-.3);
\draw (1.8,-.3) to (2.2,-.3);
\draw (1.9,-.4) to (2.1,-.4);
\node (G) at  (3.2,2.3) {$i$};
\node (E) at  (3,2) {};
\node (F) at  (3.5,2) {};
\draw [->] (E) edge (F);
\end{circuitikz}
    \caption{Impedance matching example.}
\label{fig:electricalcircuit}
\end{figure}




\section{The Brownian Gyrator}\label{sec:BrownianGyrator}
We consider overdamped Brownian particles with two degrees of freedom in an anisotropic heat bath, and subject to a time-varying  quadratic potential. The location $X_t\in \mathbb R^2$ of the particles obeys
the Langevin dynamics
\begin{align}\label{eq:2dlangevin}
	d X_t &= \frac{1}{\gamma}\left(f(t,X_t)-\nabla U(t,X_t)\right) d t + \sqrt{\frac{2k_BT}{\gamma}} d B_t,
\end{align}
with the force term consisting of a non-conservative component 
$f(t,X_t)$ and the gradient of a potential 
\begin{equation*}
    U(t,X_t)=\frac{1}{2} X_t^\prime K(t)X_t,
\end{equation*}
with $K(t)$ a symmetric $2\times 2$ matrix. Throughout, $k_B$ denotes the Boltzmann constant,
$\gamma$ the friction coefficient, $\{B_t\}_{t\geq 0}$ denotes a $2$-dimensional standard Brownian motion (with mean zero and covariance the identity) and
$T={\rm diag}(T_1,\;T_2)$ a diagonal matrix with entries 
the temperature of thermal excitation along each of the two degrees of freedom.

The probability density function  of the state $X_t$ in \eqref{eq:2dlangevin}, denoted by\footnote{We use the notation $x$ for a vector in $\mathbb R^2$, and $X_t$ for the vector-valued stochastic process of position.} $\rho(t,x)$, with $x\in\mathbb R^2$,
% $p(x)\in P_2(\mR^n)$ 
constitutes the {\em state of the thermodynamic system} and represents the ensemble of particles; it satisfies the 
Fokker-Planck 
equation
\begin{align}\label{eq:fokker}
\partial_t\rho  + \nabla \cdot\left(\rho v\right)=0,
\end{align}
with
$$v=(\mathbf f_S-\mathbf f_L) /\gamma,$$
for the {\em source force} $\mathbf f_S:=-\nabla U  - k_B T \nabla \log (\rho)$ and the {\em load force} $\mathbf f_L:=-f$.
The non-conservative term $\mathbf f_L=-f$, when present, is divergence-free with respect to $\rho$, in that $\nabla \cdot (\mathbf f_L\rho)=0$.

When the initial state is Gaussian with mean zero and covariance $\Sigma_0$, denoted $\mathcal N(0,\Sigma_0)$, and $f$ is a linear function of $X_t$, then $\rho$ remains Gaussian over time with  mean zero and
covariance that satisfies the Lyapunov equation 
\begin{equation}\label{eq:Lyapunov}
    \gamma \dot\Sigma(t)=-K(t)\Sigma(t)-\Sigma(t) K(t)+2k_BT,
\end{equation}
that in this case consitutes the system dynamics.
The non-conservative force  is of the form
$f=\Omega\Sigma^{-1}(t)X_t$, with $\Omega$ a skew-symmetric matrix; it plays no role in \eqref{eq:Lyapunov} (i.e., it cancels out) due to the skew symmetry $\Omega+\Omega^\prime=0$.

At any point in time, the total energy of the system is $E=\int U \rho \, dx dy$. The system exchanges energy with the environment either through the external  forcing (work differential in \eqref{eq:work-p}), or through heat transfer to and from the two thermal baths (heat differential in \eqref{eq:heat-p}). Specifically, the first of these contributions has two terms, one due to changes in the potential and another due to the non-conservative force,
\begin{equation}\label{eq:work-p}
    \dbar W = \int \frac{\partial U}{\partial t} \rho\, dx dydt-\Expect[\mathbf{f}_L' \circ dX_t],
\end{equation}
and represents work\footnote{Here, $\dbar$ indicates an imperfect differential, where its integral depends on the chosen path and not only on the end points.}.
On the other hand, the heat uptake from the thermal baths is
\begin{equation}\label{eq:heat-p}
    \dbar Q =\dbar Q_1+\dbar Q_2=- \iint  U \nabla\cdot (v\rho) \,dx dydt+\Expect[\mathbf{f}_L' \circ dX_t],
\end{equation}
which can be split into the contributions coming from the different heat baths, $\dbar Q_1$ and $\dbar Q_2$.
Combining \eqref{eq:work-p} and \eqref{eq:heat-p} we have the first law of thermodynamics,
\begin{equation}\label{eq:1st}
    dE=\dbar W+\dbar Q,
\end{equation}
where the differential of internal energy is the sum of the two contributions.

\subsection*{Steady-state analysis}

Let us assume momentarily that $\mathbf{f}_L=-f=0$ and that the potential remains constant, with $K(t)=K_c$ symmetric and positive definite. Then, the system reaches a steady-state distribution; this is Gaussian $\mathcal N(0,\Sigma_{ss})$ with (steady-state) covariance satisfying the algebraic Lyapunov equation
\begin{equation}\label{eq:ARE}
K_c\Sigma_{ss}+\Sigma_{ss} K_c=2k_BT.  
\end{equation}
The solution to \eqref{eq:ARE} is unique and can be expressed in integral form as
\begin{equation}\label{eq:ARE-sol}
\Sigma_{ss} = 2k_B\int_0^\infty e^{-\tau K_c} Te^{-\tau K_c}d\tau
 =2k_B \mathcal L_{K_c}(T),   
\end{equation}
%{\color{red}Is this operator full range? can we attain any positive definite $\Sigma$ from some positive def $K$?}
where, for future reference, we define the linear operator
\[
X \mapsto \mathcal L_{A}(X) :=  \int_0^\infty   e^{-\tau {A}} Xe^{-\tau {A}}d\tau
\]
that depends on the positive definite matrix ${A}$.


The source force becomes $\mathbf{f}_S=-K_cx+k_BT\Sigma^{-1}_{ss}x$, and hence the velocity field can be expressed as
\begin{equation}\label{eq:vel-gaussian}
    v(x)=\frac{\mathbf{f}_S}{\gamma}=-\frac{1}{2\gamma}(K_c\Sigma_{ss}-\Sigma_{ss}K_c)\Sigma_{ss}^{-1}x,
\end{equation}
where we have used the algebraic Lyapunov equation \eqref{eq:ARE}.
Even if the system is at steady-state, the probability current $v\rho$ does not need to vanish, in general. A non-vanishing probability current induces a heat flow between the thermal baths, with $\dbar Q_1=-\dbar Q_2$.
When it vanishes ($v\rho=0$), a condition known as {\em detailed balance} in the physics literature, the steady-state is an {\em equilibrium state}.

It is seen that in order to ensure detailed balance, $K_c$ and $\Sigma_{ss}$ must commute.
In view of \eqref{eq:ARE}, also \eqref{eq:ARE-sol}, this only happens when $T$ and $K_c$ commute; i.e., this happens when $K_c$ is diagonal, since $T$ is already diagonal. In that case, $\Sigma_{ss} = k_BTK_c^{-1}$ is also diagonal and results in zero probability current according to~\eqref{eq:vel-gaussian}. Moreover, in that case, heat cannot transfer between the degrees of freedom.
On the other hand, when $K_c$ and $T$ do not commute, detailed balance breaks down and a non-vanishing (stationary) probability current materializes leading to a NESS with non-vanishing heat transfer between the heat baths. 

The system described here is known as the Brownian Gyrator. Since its conception by Filliger and Reimann in 2007 \cite{BGyrator2007first}, it has been thoroughly studied, mostly at steady-state. Several works focused on the curl-carrying probability current that mediates a heat transfer between heat baths and the torque that it generates \cite{BGyrator2007first,BGyrator2013CilibertoExperim,BGyrator2013dotsenko,BGyrator2017electrical,BGyrator2017experimental}. Other works have studied optimal transitioning between states  \cite{baldassarri2020engineered}, maximum work extraction through periodic variation of the potential function \cite{EnergyHarvesting2021}, the role of information flow  \cite{BGinfo,Loos_2020nonreciprocal}, the effect of external forces \cite{constantforceBG},  strong coupling limits \cite{Imparato2017BG}, the control relevance of anharmonic potentials \cite{gyratingcharacnonharmonic}, gyration for underdamped mesoscopic systems \cite{inertiaBG}, the relevance of non-Markovian noise \cite{NonmarkovianBG} and the use of active reservoirs \cite{activereservoirBG}. 


Experimental realizations of \eqref{eq:2dlangevin} have been based on several different physical embodiments \cite{BGyrator2017experimental,BGyrator2017electrical,BGyrator2013CilibertoExperim,Bgyrator2013ciliberto, abdoli2022tunable}. In particular, \cite{BGyrator2017experimental,abdoli2022tunable} are based on colloidal particles suspended in a viscous medium while the
anisotropy in stochastic excitation is induced through an electromagnetic field.
Another embodiment is based on the electric circuit of 
Figure \ref{fig:circuit}.
Here, the two degrees of freedom are the charges in the capacitors $C_1$ and $C_2$, and the two resistors, in contact with heat baths of different temperatures, generate Johnson-Nyquist fluctuating currents \cite{Bgyrator2013ciliberto,BGyrator2013CilibertoExperim,BGyrator2017electrical}.

Specifically, the equations of motion of the system in Figure \ref{fig:circuit} can be written as
$$
C dV_t=-\frac{1}{R}V_tdt+\sqrt{\frac{2 k_B T}{R}}dB_t,
$$
where $V_t=[V_1(t),\ V_2(t)]'$ are voltages across the two capacitors, $C$ is the matrix of capacitances
\begin{align*}
 &C=\left[\begin{array}{cc}
    C_1+C_c &-C_c  \\
    -C_c & C_2+C_c
\end{array}\right],
\end{align*}
and $\sqrt{2k_BT/R}\,dB_t$ models the
 Johnson-Nyquist noise \cite{nyquist} at the two resistors for temperatures $T_1$ and $T_2$ ($T={\rm diag}(T_1,T_2)$, as before).
The state of this electrical-thermal system can alternatively be described in terms of the charges $q_1(t)$ and $q_2(t)$ at capacitances $C_1$ and $C_2$, since the vector of charges is $q_t=C V_t$. 
Then, the changes satisfy
\begin{equation}\label{eq:langevin-electric}
\ud q_t=-\frac{1}{R}C^{-1} q_t\ud t+\sqrt{\frac{2 k_B T}{R}}dB_t.
\end{equation}

Let $U(q)=\frac{1}{2}q'C^{-1}q$  be the 
(potential) energy stored in the system of capacitances ($C_1,C_2,C_c$). The first term in the right-hand-side of \eqref{eq:langevin-electric} is precisely the negative gradient $-\nabla U(q_t)/R\ud t$. Hence, equation \eqref{eq:langevin-electric} 
represents a two-dimensional overdamped Langevin system \eqref{eq:2dlangevin} with non-conservative forces absent, and $R$ playing the role of the friction coefficient.
It follows that the distribution of charges $\rho(t,q_t)$ satisfies a Fokker-Planck equation \eqref{eq:fokker}, with velocity field $v$ being replaced by a corresponding current field (see equation \eqref{eq:boldi}).

\begin{figure}
    \centering
\includegraphics[width=0.45\textwidth,trim={0cm 1.5cm 0cm 1cm},clip]{circuitwithoutwheel_adtermatlab.pdf}
    \caption{Electrical emboddiment of the Brownian gyrator.}
    \label{fig:circuit}
\end{figure}



\section{Maximum power extraction from the Brownian Gyrator}\label{sec:Gaussian}

In the present section, we take the next natural step and consider work extraction from the resulting circulating current. 
We explore
the coupling of the natural gyrating motion with an external non-conservative actuation, for the purpose of extracting
work that can be supplied by the anisotropy of the temperature field. Earlier studies on maximizing work output  \cite{pietzonka2018BGeffic,abdoli2022tunable,NCbrownianG2022} were particular to linear two-dimensional systems.
Our contribution lies in a general approach that applies to higher dimensions and nonlinear forces (see Section \ref{sec:general}), while bringing to light the aforementioned matching principle, that the velocity ensuring maximal power transfer is precisely at the midpoint of the power producing range of velocity values.
% \black


Let us picture the steady-state of the Brownian gyrator (the system described by \eqref{eq:2dlangevin} subject to a fixed quadratic potential with $f=0$) as a vortex of swirling particles around the origin, which originates from the non-zero probability current at steady-state. Now imagine yourself sailing around the origin, propelled by the wind of particles, going in circles at some velocity slower than the particles, yet non-zero, slowed-down by external forces applied to the boat for the purpose of extracting work. The work extracted would correspond to the force applied on the sails times the displaced distance, in a way that is analogous to the windmill example discussed in the introduction.

Indeed, one can use non-conservative actuation to implement such an interaction. Let $K(t)=K_c$ be a constant positive definite matrix. Then, the system reaches a steady-state with covariance $\Sigma_{ss}$, that together with $K_c$ satisfies \eqref{eq:ARE}. Let us consider 
$
f=\Omega\Sigma_{ss}^{-1}\,X_t,%=f_c\, \Omega\Sigma_{ss}^{-1}X_t, \ \mbox{ where } \ f_c\in \mathbb R \ \mbox{ and } \ \Omega=\left[\begin{array}{cc}
 %  0  & 1 \\
  % -1  &  0
%\end{array}\right].
$
 which represents the force on the sail that, due to it's skew-symmetry, does not alter the stationary distribution of the state of the system, but does affect the mean velocity $
    v=(\mathbf{f}_S-\textbf{f}_L)/\gamma
$.
Here, the source and load forces are given by 
\begin{subequations}\label{eq:forces}
\begin{align}\label{eq:fs}
    \mathbf{f}_S&=-K_cX_t+ k_BT \Sigma_{ss}^{-1}X_t\\\label{eq:fl}
    \mathbf{f}_L&=-\Omega\Sigma_{ss}^{-1}X_t.
\end{align}
\end{subequations}
 
The work output is then
\begin{subequations}
\begin{align}\nonumber
    -\dbar W &= \Expect[\mathbf{f}_L' \circ dX_t]\\\label{eq:workrateNC} &=-\Expect\big[X_t'\Sigma_{ss}^{-1}\Omega' dX_t+k_B{\rm Tr}[\Omega\Sigma_{ss}^{-1}T]dt/\gamma\big]\\\nonumber &=\frac{1}{\gamma}\Expect\big[-X_t'\Sigma_{ss}^{-1}\Omega'(-K_c+\Omega\Sigma_{ss}^{-1}+k_BT\Sigma_{ss}^{-1})X_t]\big]dt\\&=\Expect\big[\mathbf{f}_L'(\mathbf f_S-\textbf{f}_L)/\gamma\big]dt,\label{eq:workrateNC2}
\end{align}
\end{subequations}
where for the second equality we have changed from the Stratonovich integral to It$\rm \hat o$ by adding the It$\rm \hat o$ term $k_B\trace[\Omega\Sigma_{ss}^{-1}T]dt/\gamma$ (with $\trace$ denoting the trace), and for the third line we have used \eqref{eq:2dlangevin} and the fact that ${\rm Tr}[\Omega\Sigma_{ss}^{-1}T]=\Expect\big[\trace[\Omega\Sigma_{ss}^{-1}X_tX_t'\Sigma_{ss}^{-1}T]\big]$.
Continuing on, from \eqref{eq:workrateNC} we obtain that
$$
P=-\dbar W/dt=-\frac{1}{\gamma}\trace[\Omega\Sigma^{-1}_{ss}\Omega'+k_B\Omega\Sigma^{-1}_{ss}T],
$$
where we have used \eqref{eq:2dlangevin} and the fact that the trace of the product of symmetric and skew-symmetric matrices is zero.

Thus, the problem to maximize power $P$ is equivalent to the static problem
\begin{align*}
   \min \trace[\Omega\Sigma^{-1}_{ss}\Omega'+k_B\Omega\Sigma^{-1}_{ss}T],
\end{align*}
where the minimum is taken over skew-symmetric $\Omega$'s. The first-order necessary condition for optimality is found by computing the first order variation of the cost and setting it to zero, this is,
\begin{equation}\label{eq:NCFONC}
  \trace[\Delta_\Omega M]=0,\ \mbox{ with } \ M=2\Omega\Sigma^{-1}_{ss}+k_BT\Sigma^{-1}_{ss},
\end{equation}
where $\Delta_\Omega$ is any skew-symmetric matrix. Therefore, the first-order necessary condition for optimality \eqref{eq:NCFONC} implies that $M$ must be symmetric. It follows that an optimal choice\footnote{Throughout, we superscribe $*$ to denote an optimal solution.} $\Omega^*$ must satisfy
\begin{equation}
\label{eq:Msym}
\Sigma^{-1}_{ss}\Omega^*+\Omega^*\Sigma^{-1}_{ss}=\frac{k_B}{2}\left(\Sigma^{-1}_{ss}T-T\Sigma^{-1}_{ss}\right).
\end{equation}
This equation has a unique solution which is skew-symmetric and can be written as
$$
\Omega^*=\frac{k_B}{2} {\mathcal L}_{\Sigma_{ss}^{-1}}
(\Sigma^{-1}_{ss}T-T\Sigma^{-1}_{ss}).
% \int_0^\infty e^{-\Sigma_{ss}^{-1}\tau}
% \left(\Sigma^{-1}_{ss}T-T\Sigma^{-1}_{ss}\right)
% e^{-\Sigma_{ss}^{-1}\tau}d\tau.
$$
Note that when $\Sigma_{ss}$ and $T$ commute, no work can be extracted (as one would expect), since in this case $\Omega^*=0$.


A way to interpret this solution is by looking back at the Fokker-Planck equation \eqref{eq:fokker}. 
Clearly, at steady state, where $\nabla \cdot \rho v=0$,
$v=(\mathbf{f}_S-\textbf{f}_L)/\gamma$ is divergence-free, and since $\mathbf{f}_L$ is divergence-free, so is $\mathbf{f}_S$. From \eqref{eq:fs} and \eqref{eq:NCFONC} we have that
\[
\mathbf{f}_S=-(K_c-M)X_t -2\Omega^*\Sigma^{-1}X_t,
\]
and since it is divergence-free, $K_c-M=0$. Therefore, $\mathbf{f}_S=-2\Omega^*\Sigma^{-1}X_t$, and in view of \eqref{eq:fl} we have the following proposition.

% Clearly,  steady state ($\nabla\cdot(v\rho)=0)$
%  implies $\mathbf f_S$ is divergence-free, with its divergence-free component coming from the $k_BT\Sigma^{-1}_{ss}X_t$ term. Thus, we can interpret the condition of $M$ being symmetric as the fact that the load force must half the source force, in analogy to the impedance matching problem. These results are summarized in the following proposition.
\begin{prop}
The maximum steady-state power output through non-conservative forcing for the linear system in \eqref{eq:2dlangevin},
\begin{equation}
    \max_{\mathbf{f}_L} \,\Expect[\mathbf{f}_L'(\mathbf{f}_S-\mathbf{f}_L)/\gamma],
\end{equation}
is obtained for 
\begin{equation}\label{eq:mainresult}
    \mathbf f_L^{\,*}=\mathbf f_S/2.
\end{equation}
\end{prop}
% \begin{prop}
% The maximum steady-state power output through non-conservative forcing for the system in \eqref{eq:2dlangevin},
% \begin{equation}
%     \max_{\mathbf{f}_L} \,\Expect[\mathbf{f}_L'(\mathbf{f}_S-\mathbf{f}_L)/\gamma],
% \end{equation}
% is obtained by 
% \begin{equation*}
%     \mathbf f_L^{\,*}=\mathbf f_S/2.
% \end{equation*}
% \end{prop}





\begin{remark}
The maximum power output can be computed as follows, 
\begin{align*}
 P^*&=-\frac{1}{\gamma}\trace[\Omega^*\Sigma^{-1}_{ss}\Omega^{*'}+k_B\Omega^*\Sigma^{-1}_{ss}T]\\&=-\frac{1}{2\gamma}\trace[\Omega^{*'}(\Omega^*\Sigma^{-1}_{ss}+\Sigma^{-1}_{ss}\Omega^*)+2k_B\Omega^*\Sigma^{-1}_{ss}T] \\&=\frac{k_B}{4\gamma}\trace[(T\Sigma_{ss}^{-1}-\Sigma_{ss}^{-1}T)\Omega^*]\\%=& -\frac{k_B}{2\gamma}\trace[\Omega^*\Sigma_{ss}^{-1}T] \\
 & %=\frac{k_B}{4\gamma}\trace[(\Sigma_{ss}^{-1}\Omega^*-\Omega^*\Sigma_{ss}^{-1})T]
 = \frac{k_B}{2\gamma}\trace[T\Sigma_{ss}^{-1}\Omega^*],
\end{align*}
where for the third equality we have used \eqref{eq:Msym}. It is seen that the maximal power is proportional to the %trace of the temperature times the
% symmetric part of $\Omega^*\Sigma_{ss}^{-1}$, and also, to the trace of $\Omega^*$ times the {\color{magenta}anti-symmetric part of $T\Sigma_{ss}^{-1}$}.{\color{magenta} [Is this the best way or writting this or should we write it in terms of commutators?]} 
anti-symmetric part of $T\Sigma_{ss}^{-1}$, which constitutes our power source.
Moreover, this expression for $P^*$ can be written explicitly in terms of the parameters of our system: first solve for the steady-state covariance $\Sigma_{ss}$ in \eqref{eq:ARE} (which is fairly simple for a two-dimensional problem), then use it to find $\Omega^*$ and finally to write $P^*$. Explicit derivations in a particular two-dimensional case can be found in \cite{pietzonka2018BGeffic,NCbrownianG2022}.
\end{remark}



\begin{figure}
    \centering   \includegraphics[width=0.49\textwidth,trim={0cm 11cm 0cm 6.5cm},clip]{circuit-nc.pdf}
    \caption{Circuit realization of a steady-state Brownian gyrator engine.}
    \label{fig:nc}
\end{figure}



Let us now return to a circuit theoretic embodiment. 
In order to generate a non-conservative force, a non-reciprocal capacitance is needed. To this end, we consider the circuit depicted in
%Envisioning an embodiment such as the one depicted in 
Figure \ref{fig:nc}, where we have introduced such a general (two-port) capacitance, with law
$$
i_{\rm nr}=\left[\begin{matrix}i_{{\rm nr},1} \\ i_{{\rm nr},2}\end{matrix}\right]=-C_{\rm nr} \frac{dV_t}{dt},
$$
and a capacitance matrix $C_{\rm nr}$ that is not necessarily symmetric (i.e., possibly non-reciprocal \cite{virtualpot2021Chang}).
The state of the system is the vector of charges $q_t$, as before, and satisfies \eqref{eq:langevin-electric} with $\hat C= C+C_{\rm nr}$ replacing  $C$. The ``force'' $-\hat C ^{-1}q_t$ can be split into conservative and non-conservative components,
$$
-\hat C^{-1}q_t=-(\hat C^{-1})^\prime C\hat C^{-1}q_t-(\hat C^{-1})^\prime C_{\rm nr}^\prime \hat C^{-1}q_t,
$$
with the non-conservative part $(\hat C^{-1})^\prime C_{\rm nr}^\prime \hat C^{-1}q_t=\Omega\Sigma_{ss}^{-1}q_t$. 


As noted, the probability density of the system of charges follows the Fokker-Planck equation \eqref{eq:fokker}, with velocity field $v$ replaced by a current field (function of a vector\footnote{Following our earlier convention, $q_t$ represents the vector-valued stochastic process of charges, whereas $q$ represents a vector in $\mathbb R^2$.} $q$),
\begin{equation}\label{eq:boldi}
\mathbf i=(\mathbf{V}_S-\mathbf V_{L})/R,
\end{equation}
with
\begin{align*}
    \mathbf{V}_S&=-(\hat C^{-1})^\prime C\hat C^{-1}q+k_BT\Sigma^{-1}_{ss}q,\\
    \mathbf V_{L}&=-(\hat C^{-1})^\prime C_{\rm nr}^\prime \hat C^{-1}q,
\end{align*} 
and $q\in\mathbb R^2$.
% Here, we have split the voltage $\hat C^{-1}q$ into conservative and non-conservative components 
% $$
% \hat C^{-1}q=\hat C^{-1}C\hat C^{-1}q+\hat C^{-1}C_{\rm nr}\hat C^{-1}q,
% $$
% for some non-conservative capacitance-like voltage of the form $\hat C^{-1}C_{\rm nr}^{-1}\hat C^{-1}q=\Omega\Sigma_{ss}^{-1}q$. 

The thermodynamic definition of power is consistent with the circuit theoretic viewpoint where $P=\Expect[V_t'\circ i_{\rm nr}],$ for $V_t=[V_1(t) \ V_2(t)]'=\hat C^{-1}q_t$. Specifically,
\begin{align*}
 Pdt&=\Expect[V_t'\circ i_{\rm nr} \, dt ]=-\Expect [V_t'\circ C_{\rm nr}dV_t]\\
 %
 &=-\Expect [q_t'(\hat C^{-1})^\prime \circ C_{\rm nr} \hat C^{-1}dq_t]\\
 %
 &= \Expect [\mathbf{V}_L' \circ dq_t],
\end{align*}
which, in analogy with \eqref{eq:workrateNC2}, gives \[
-\dbar W=\Expect [\mathbf V_L'(\mathbf V_S-\mathbf V_L)/R]dt.
\]
Thus, maximum power is similarly obtained by a load voltage that halves the source voltage fueled by the anisotropy in temperature of the two Johnson-Nyquist resistors, i.e.  
$$
\mathbf V_L^*=\mathbf V_S/2,
$$ 
akin to the standard impedence matching problem.

%{\color{magenta}Unclear whether this is necessary (because of our notation it is very obvious, but to me it wasn't obvious  at all, $i_{\rm nr}'\circ dV$ and $\mathbf V_L(\mathbf V_S-\mathbf V_L)/R$ seem very different... )}

\begin{remark} A circuit such as the one depicted in Figure \ref{fig:nc} can be realized through controlled feedback \cite{virtualpot2021Chang}. However, this requires external energy input which is unaccounted for, constituting the main disadvantage when attempting to extract work from a system through non-conservative forcing.
\end{remark}




\section{A general setting}\label{sec:general}

The previous results apply more generally to a linear system with $n$-degrees of freedom. We can do even better and consider an $n$-dimensional general case where equation  \eqref{eq:2dlangevin} holds  
with $X_t\in \mR^n$, $T$ a diagonal $n\times n$ matrix with the temperatures of the ambient heat baths as entries, 
 $B_t$ an $n$-dimensional standard Brownian motion, and each degree of freedom subjected to a general non-linear force $f_i-\partial_{x_i} U$.
The probability density function  $\rho(t,x)$ of the process $X_t$ satisfies the Fokker-Planck equation \eqref{eq:fokker}, with
 \begin{align*}
    \mathbf f_S&=-\nabla U  - k_B T \nabla \log (\rho)\\\mathbf f_L&=-f,
\end{align*}
where the latter is divergence-free with respect to $\rho$ as before, i.e., $\nabla \cdot (\mathbf f_L\rho)=0$.




Let $\rho_{ss}$ be an admissible steady-state, i.e. such that  
there exists a unique time-independent potential $U_c$
that renders $\rho_{ss}$ stationary. Specifically, the potential and $\rho_{ss}$ must satisfy
\begin{equation}\label{eq:ss}
    \nabla\cdot((\mathbf f_S-\mathbf f_L) \rho_{ss}/\gamma)=0,
\end{equation}
with
$$
\mathbf f_S=-\nabla U_c  - k_B T \nabla \log (\rho_{ss}).
$$
This is equivalent to imposing
\begin{equation}\label{eq:poisson}
\nabla\cdot(\rho_{ss}\nabla U_c)=-\nabla\cdot(\rho_{ss}k_BT\nabla\log(\rho_{ss})).
\end{equation}
It is seen that $U_c$ is specified by the gradient part of $k_BT\nabla\log(\rho_{ss})$, in that $U_c$ must satisfy the Poisson equation \eqref{eq:poisson}. It is assumed that \eqref{eq:poisson} has a unique solution\footnote{ See \cite{miangolarra2023minimal} for sufficient conditions on $\rho_{ss}$ for uniqueness of solution.} for all admissible $\rho_{ss}$.



% {\color{magenta}
% possibly delete:
% Let $\rho_{ss}$ be such that 
% \begin{align*}
%     {\rm i)}\;\; & \|\nabla^2 \log \rho_{ss}\|_\infty < \infty\\
%     {\rm ii)}\;\; & \|\nabla \log \rho_{ss}(x)\| \to \infty \mbox{ as }\|x\| \to \infty.
% \end{align*}
% We would like to first find a time-independent potential $U_c$
% that makes $\rho_{ss}$ a steady-state. The potential must satisfy
% $$
% \nabla\cdot(v\rho_{ss})=0,
% $$
% with
% $$
% v=-\frac{1}{\gamma}(\nabla U_c-f+k_BT\nabla\log\rho_{ss}).
% $$
% This is equivalent to imposing
% $$
% \nabla\cdot(\rho_{ss}\nabla U_c)=-\nabla\cdot(\rho_{ss}k_BT\nabla\log(\rho_{ss})),
% $$
% that is, $U_c$ is fixed by the gradient part of $k_BT\nabla\log(\rho_{ss})$. This is nothing but a Poisson equation for $U_c$ which, under our assumptions on $\rho_{ss}$,  has a unique solution as long as $\int(\frac{1}{\rho_{ss}}\nabla\cdot(\rho_{ss}k_BT\nabla\log(\rho_{ss})))^2\rho_{ss} dx$ is finite.}



If the potential is fixed, the work output due to the non-conservative forcing is given by
\begin{align*}
    -\dbar W =& \Expect[\mathbf f_L'\circ dX_t]\\=&\frac{1}{\gamma}\int \Big(\mathbf f_L'(-\nabla U_c+f)+k_B\trace[{\rm Jac}(\mathbf f_L)T]\Big)\rho_{ss} dxdt\\=& 
\Expect[ \mathbf{f}_L'(\mathbf f_S-\mathbf f_L)/\gamma]dt,
\end{align*}
where we used the It$\rm\hat{o}$ rule for the second equality, and denoted by ${\rm Jac}(\mathbf f_L)$ the Jacobian of $\mathbf f_L$. For the third equality we used integration by parts.

The optimal  $\mathbf f_L$ that maximizes the power output must be such that the first order variation of $P$,
\begin{align*}
\int (\delta_{ \, \mathbf f_L})'(\mathbf f_S-2\mathbf f_L)\rho_{ss} dx/\gamma,
\end{align*}
vanishes for all admissible $\delta_{ \, \mathbf f_L}$. 
Given that $\delta_{ \, \mathbf f_L}$ must be a divergence-free field with respect to $\rho_{ss}$, we obtain that 
$\mathbf{f}_S-2\mathbf{f}_L$
must be of gradient form, from orthogonality.
Since both $\mathbf{f}_L$ and $\mathbf{f}_S$ must be divergence-free, the first by construction and the second  due to steady-state \eqref{eq:ss}, we obtain that 
the optimal $\mathbf f_L$ must reduce the divergence-free swirling motion of the particles (induced by $\mathbf{f}_S$) by half, as is stated in the following proposition.
\begin{prop}
The maximum steady-state power output through non-conservative forcing for the (non-linear) system \eqref{eq:2dlangevin} with $X_t\in\mathbb R^n$,
\begin{equation}
    \max_{\mathbf{f}_L} \,\Expect[\mathbf{f}_L'(\mathbf{f}_S-\mathbf{f}_L)/\gamma],
\end{equation}
is obtained by 
\begin{equation}
    \mathbf f_L^{\,*}=\mathbf f_S/2.
\end{equation}
\end{prop}




\begin{remark}
    The optimal mean velocity field is  then
 $$
v^*=\mathbf f_L^*/\gamma.
$$
Upon using the orthogonality between $\nabla U_c$ and $\mathbf f_L^*$, the maximum power can be written as
\begin{align*}
    P^*=&-
\gamma\int (v^*)'v^*\rho _{ss}dx-k_B\int (v^*)'T\nabla \log(\rho_{ss})\rho_{ss} dx.
\end{align*}
 Note that this expression is nothing but the heat rate (decomposed into dissipative and quasi-static heat rates)  of the system with mean velocity $v^*$ \cite{miangolarra2022geometry}, as one would expect from the first law \eqref{eq:1st}, since $dE=0$ implies $-\dbar W=\dbar Q$.
\end{remark}
 


\section{Conclusions}
The purpose of this work has been to present a matching principle for maximal power extraction in diverse systems, ranging from microscopic thermodynamic heat engines to windmills and electric circuits.
This principle holds in general under the assumption that the source has a linear response (e.g., voltage-current, force-velocity, etc.).
%and the existence of a steady-state (c.f. \eqref{eq:matching}).
This is precisely the case underlying the well-known impedance matching principle for power transfer in circuits, and the same principle is extrapolated % translated
to stochastic systems where the anisotropy in thermal fluctuations
constitutes the source of energy, as explained in the body of the paper. Interest in this principle stems from the significance of power harvesting mechanisms in the physical and biological world. Thus, it appears of great importance to investigate whether naturally occurring analogues, such as those driving bacterial flagella \cite{blair1995bacteria,wadhwa2022bacterial}, have evolved to display some form of optimality that reminisces the matching principle that we discussed herein. 

We would like to remark that impedance matching in classical network theory extends to dynamical loads \cite{anderson2013network,belevitch1968classical}.
Similarly, instances where the power source may not be Markov and where the power generated is consumed by a higher-order dynamical component, are relevant in the context of thermodynamics. Finally, a thermodynamic counterpart of maximal power transfer \cite{youla1967interpolation,helton1980distance}  is of interest, where suitably designed coupling may facilitate impedance matching between given thermodynamic components.

% required the full power of analytic function theory for its resolution \cite{youla1967interpolation,helton1980distance}, akin to the theory of modern robust control \cite{doyle2013feedback}. It is thus of interest to contemplate an analogous line of inquiry, where the power source consists of a stochastic process that is not necessarily Markov, and where the power generated is to be consumed by a similarly higher-order dynamical component.



% Finally, we would like to remark that impedance matching in classical circuit theory, but for higher order dynamics,
% required the full power of analytic function theory for its resolution \cite{youla1967interpolation,helton1980distance}, akin to the theory of modern robust control \cite{doyle2013feedback}. It is thus of interest to contemplate an analogous line of inquiry, where the power source consists of a stochastic process that is not necessarily Markov, and where the power generated is to be consumed by a similarly higher-order dynamical component.







\appendices

\section*{Acknowledgments}
The research was supported in part by the AFOSR under grant FA9550-20-1-0029, and ARO under W911NF-22-1-0292. O.M.M was supported by ”la Caixa” Foundation (ID 100010434) with code LCF/BQ/AA20/11820047.

\bibliography{thesis}
\bibliographystyle{IEEEtran}

\end{document}
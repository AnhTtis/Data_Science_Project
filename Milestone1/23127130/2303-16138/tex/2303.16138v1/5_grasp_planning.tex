\section{Grasp Planning}\label{sec:grasp-planning}
We demonstrate DefGraspNets as a grasp planner, where both gradient-free (i.e., evaluation of sampled grasps) and gradient-based refinement methods can be used to find an optimal grasp. We define $Q$ as the optimization objective, which is any backwards pass-differentiable measure of the predicted deformation and/or stress fields (e.g., mean deformation, smooth differentiable approximation of maximum stress implemented in modern deep learning libraries).

\subsection{Evaluation of sampled grasps}
First, DefGraspNets supports online sampling-based grasp planning. For an unseen object, forward passes of DefGraspNets can be used to evaluate $Q$ for 100 random antipodal grasps with parallel batches of size 5 in 7.3 seconds. In comparison, DefGraspSim requires approximately 3 hours to evaluate 100 grasps, which is ${\sim}1500$x slower. 

The best grasp pose is identified as $T^* = \arg\min_{T \in T_s} Q(T; M_o)$, where $T$ is a 6D rigid transformation applied to a constant initial state of the gripper $M_g^{0}$ wherein both fingers are maximally open. Any valid $M_g$ can be fully defined by $T$ and joint states $\vec{p}_g \in \mathbb{R}^2$ that determine how much each finger closes in order to contact $M_o$. These joint states $\vec{p}_g$ are calculated analytically by projecting the vertices of $M_o$ onto the gripper faces, backprojecting the vertices within each face, and computing the minimum perpendicular distance over these vertices (i.e., the minimum contact distance) per finger.


\subsection{Grasp refinement}
Unlike existing deformable object planners, DefGraspNets' differentiability enables gradient-based refinement of a grasp pose to optimize $Q$. Starting from an initial grasp pose $T_{init}$, we perform gradient updates in the direction of $\sfrac{\partial{Q}}{\partial T}$ to achieve a refined $T$ using backtracking line search \cite{NoceWrig06} and simulated annealing \cite{Laarhoven87}. With 12 refinement steps per grasp, refining 100 initial grasps requires approximately $8$ minutes. A comparable time does not exist for DefGraspSim, as it is not differentiable.


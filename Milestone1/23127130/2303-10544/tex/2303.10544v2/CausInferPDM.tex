\documentclass[prx,prl,a4paper,aps,twocolumn,superscriptaddress,longbibliography]{revtex4-2}
\usepackage{amssymb,amsmath,amsfonts,bm, bbm}
%\usepackage{epsfig,graphicx}
%\usepackage{graphicx}
\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage{times}
\usepackage{float}
\usepackage{lipsum}
\usepackage{color}
\usepackage{dcolumn}% Align table columns on decimal
\usepackage{bm}% bold math
\usepackage{subfigure}
\usepackage[colorlinks,linkcolor=blue,anchorcolor=blue,urlcolor=blue,citecolor=blue]{hyperref}
\usepackage{verbatim} 
\usepackage{amsmath} 
\usepackage{tikz}
\usetikzlibrary{quantikz}
\usepackage{braket}
\usepackage{bbold}
\usepackage{xypic}
\usepackage{amsthm}
\usepackage[most]{tcolorbox}


\theoremstyle{plain}
\newtheorem{thm}{\protect\theoremname}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{rem}[thm]{Remark}
\newtheorem{lem}{Lemma}
\newtheorem{cor}{Corollary}

\providecommand{\theoremname}{Theorem}
\newcommand*{\myproofname}{Proof}
\newenvironment{mproof}[1][\myproofname]{\begin{proof}[#1]\renewcommand*{\qedsymbol}{\(\square\)}}{\end{proof}}


\newtheorem{Def}{Definition}

\newcommand*{\id}{\mathbbm{1}}
\newcommand*{\Tr}{\textrm{Tr}}



\usepackage{hyperref}
\hypersetup{colorlinks=true, linkcolor=blue, citecolor=red, urlcolor=blue  }

\usepackage{physics}



\begin{document}

%\preprint{APS/123-QED}
\title{Quantum Causal Inference with Extremely Light Touch}


\author{Xiangjing Liu }
\email{liuxj@mail.bnu.edu.cn}
\affiliation{Department of Physics, Southern University of Science and Technology, Shenzhen 518055, China}
\affiliation{Department of Physics, City University of Hong Kong, 83 Tat Chee Avenue, Kowloon, Hong Kong}


\author{Yixian Qiu}
\affiliation{Centre for Quantum Technologies, National University of Singapore, Singapore 117543, Singapore}

\author{ Oscar Dahlsten}
\email{oscar.dahlsten@cityu.edu.hk}
\affiliation{Department of Physics, City University of Hong Kong, 83 Tat Chee Avenue, Kowloon, Hong Kong}
\affiliation{Department of Physics, Southern University of Science and Technology, Shenzhen 518055, China}
\affiliation{Shenzhen Institute for Quantum Science and Engineering, Southern University of Science and Technology, Shenzhen 518055, China}
\affiliation{Institute of Nanoscience and Applications, Southern University of Science and Technology, Shenzhen 518055, China}

\author{Vlatko Vedral}
\affiliation{Clarendon Laboratory, University of Oxford, Parks Road, Oxford OX1 3PU, United Kingdom}



%\date{\today}




\begin{abstract}  
We consider the quantum version of inferring the causal relation between events. There has been recent progress towards identifying minimal interventions and observations needed. We here show, by means of constructing an explicit scheme, that quantum observations alone are sufficient for quantum causal inference for the case of a bipartite quantum system with measurements at two times. A key technical contribution is the derivation of a closed-form expression for the space-time pseudo-density matrix associated with many times and qubits. This matrix can be determined by coarse-grained quantum observations alone. We show that from this matrix one can infer the causal structure via the sign of a particular function called a causal monotone. Our results show that for quantum processes one can infer the causal structure solely from correlations between observations at different times.
\end{abstract}



%\smallskip
\maketitle







%In general, there are two types of quantum correlations among variables, one is spatial correlations, including entanglement and quantum discord~\cite{modi2012classical,henderson2001classical}, the other is temporal correlations if the time is involved~\cite{leggett1985quantum}. 

% Explain individual words in title and why the topic in general is important.(1-2 paragraphs) E.g. if title is X implies Y, explain what X and Y are and why people study them.

Identifying cause-effect relations from observed correlations is at the core of a wide variety of empirical science~\cite{reichenbach1956direction, pearl2009causality}. Determining the causal structure, i.e.\  which variables influence others, is known as causal inference.  Causal inference is well-known to be important in understanding medical trials~\cite{balke1997bounds, prosperi2020causal}, and also appears in a range of machine learning applications~\cite{peters2017elements}. For example, in natural language processing, causal inference can be used to identify the causal relationships between words or phrases and their semantic meanings. By understanding the causal factors that give rise to different linguistic patterns, machine learning models can be trained to generate more accurate and meaningful text~\cite{feder2022causal}. 



Causal inference can in principle be undertaken via {\em intervening} in the system~\cite{pearl2009causality,balke1997bounds}. Intervening to set a random variable to particular values in a controlled manner can be used to determine what other random variables that random variable influences. At the same time, e.g.\ in medical contexts~\cite{prosperi2020causal}, interventions may be costly or infeasible, motivating investigations into partial causal inference from {\em observations}~\cite{pearl2009causality,angrist1996identification,greenland2000introduction}. 

Similar questions have recently emerged concerning causal relations in quantum processes~\cite{leggett1985quantum, oreshkov2012quantum,brukner2014quantum,fitzsimons2015quantum,barrett2021cyclic,barrett2019quantum,hardy2005probability,chiribella2009theoretical,Milz2022resourcetheoryof,costa2016quantum,allen2017quantum,PhysRevA.79.052110,liu2022thermodynamics,parzygnat2022time,wolfe2021quantum,wolfe2020quantifying}. Interventions, like resetting the state of quantum systems, have been considered~\cite{ried2015quantum,bai2022quantum,chiribella2019quantum,maclean2017quantum,chaves2018quantum,agresti2022experimental, gachechiladze2020quantifying,nery2018quantum,agresti2020experimental}. It is known that in the classical case, observations alone are in general not sufficient to perform causal inference, which is connected to the famous phrase `correlation does not imply causation'. A natural question is therefore to identify minimal interventions and observations needed to determine causal relations in the quantum case~\cite{ried2015quantum}. It remains an open question to what extent observations (measurements) in the quantum case, which come together with an inescapable small disturbance, are sufficient for causal inference.   How `light-touch' can quantum causal inference be? 


\begin{figure}
  \centering
  \includegraphics[scale=0.35]{fig1.pdf}
  \caption{{\bf Quantum causal inference problem.} The observer gains data from observing two quantum systems $A$ (white ball) and $B$ (red ball) which may be correlated. In line with Reichenbach's principle, we allow for five possible causal structures: 1) $A$ has direct influence on $B$; 2) $B$ has a direct influence on $A$; 3) there is a common cause (dashed ball) acting on $A$ and $B$, meaning correlations in the initial state; 4) a combination of cases 1 and 3; 5) a combination of cases 2 and 3. The observer wants to determine which of those possible causal structures is the case. 
 }
  \label{fig:qsetup}
\end{figure}

We here address and resolve this question for the case of bipartite quantum systems of arbitrary finite dimension and measurements at two times. To be precise, we formulate the quantum causal inference problem as follows.  As shown in FIG.~\ref{fig:qsetup}, the observer has data from observing two quantum systems $A$ and $B$ which may be correlated. The observer wants to know the causal structure of the process of generating the data. In line with Reichenbach's principle~\cite{reichenbach1956direction} we allow for five causal structures that are to be distinguished (see FIG.~\ref{fig:qsetup}). We exclude the case of causal influence in both directions (loops), such that there is a well-defined causal direction~\cite{pearl2009causality}.  We devise an explicit scheme for determining which causal structure is indeed the case. The scheme only employs coarse-grained projective measurements. The scheme is derived via the pseudo-density matrix (PDM) formalism, which assigns a PDM to the full data table of experiments involving measurements on systems at several times~\cite{fitzsimons2015quantum}. 



This work is organized as follows. First, we introduce the PDM formalism. Second, we present the main results, the closed-form of the $m$-time $n$-qubit PDM and our scheme for quantum causal inference. The detailed mathematical derivations are given in the Appendix. Third, we present two examples to demonstrate our scheme. Finally, we discuss the opportunities engendered by this work. 

    

\noindent {\bf {\em PDM formalism for measurements at multiple times, systems.}}
The pseudo-density matrix (PDM) formalism, developed to treat space and time equally~\cite{fitzsimons2015quantum}, provides a general framework for dealing with spatial and causal (temporal) correlations. Research on single-qubit PDMs has yielded fruitful results~\cite{horsman2017can,fullwood2022quantum, jia2023quantum,marletto2021temporal, zhao2018geometry, marletto2019theoretical,zhang2020different,zhang2020quantum,pisarczyk2019causal}. For example, recent studies have utilized quantum causal correlations to set limits on quantum communication~\cite{pisarczyk2019causal} and to understand how dynamics emerge from temporal entanglement~\cite{marletto2021temporal}. Furthermore, the PDM approach has been used to resolve causality paradoxes associated with closed time-like curves~\cite{marletto2019theoretical}.

The PDM generalises the standard quantum $n$-qubit density matrix to the case of multiple times. The PDM is defined as 
\begin{align}\label{eq: defPDM}
R_{1...m}=\frac{1}{2^{mn}} \sum^{4^n-1}_{i_1=0}...\sum^{4^n-1}_{i_m=0}  \langle  \{ \tilde{\sigma}_{i_{\alpha}} \}^m_{\alpha=1} \rangle   \bigotimes^m_{\alpha=1} \tilde{\sigma}_{i_{\alpha}},
\end{align}
where $  \tilde{\sigma}_{i_\alpha}\in \{ \sigma_0,\sigma_1,\sigma_2, \sigma_3\}^{\otimes n} $ is an $n$-qubit Pauli matrix at time $t_\alpha$. $\tilde{\sigma}_{i_\alpha}$ is extended to an observable associated with $m$ times, $\bigotimes^m_{\alpha=1} \tilde{\sigma}_{i_{\alpha}}$ that has expectation value  $\langle  \{ \tilde{\sigma}_{i_\alpha} \}^m_{\alpha=1} \rangle $. We shall return later to what measurement this expectation value corresponds to. The standard quantum density matrix is recovered if the Hilbert spaces for all but one time, say $t_{\alpha'}$ are traced out, i.e.,\ $\rho_{\alpha'}=\Tr_{\alpha \neq \alpha'}R_{1...m}$. The PDM is Hermitian with unit trace but may have negative eigenvalues. 



The negative eigenvalues of the PDM appear in a measure of temporal entanglement known as a causal monotone $f(R)$~\cite{fitzsimons2015quantum}. Analogously to the case of entanglement monotones~\cite{vidal2000entanglement}, in general $f(R)$ is required to satisfy the following criteria: (I) $f(R) \geq 0$, (II) $f(R)$ is invariant under local change of basis, (III)  $f(R)$ is non-increasing under local operations, and (IV) $ \sum_i p_i f(R_i) \geq f(\sum p_i R_i)$.
Those criteria are satisfied by~\cite{fitzsimons2015quantum}
\begin{align}\label{eq: causmono}
f(R) :=||R||_{tr}-1 = \Tr \sqrt{ R R^\dag}-1.
\end{align} If $R$ has negativity, $f(R)>0$.  An intuition for why $f(R)$ serves as a sign of causal influence is that negative eigenvalues tell you that the PDM is associated with measurements at multiple times; in the case of a single time, there would be a standard density matrix with no negativity.

The PDM negativity $f(R)$ can thus be used to distinguish, at least in some cases, whether the PDM 
corresponds to two qubits at one time or one qubit at two times. This can be viewed as a simple form of causal inference, raising the question of whether the inference involving two parties (of multiple qubits) at multiple times depicted in FIG.~\ref{fig:qsetup} can be undertaken in a similar manner. A key challenge in this direction is to find a closed-form expression for the PDM $R$, from which one can see whether $f(R)>0$. 

\noindent {\bf {\em Closed form for m-time n-qubit PDMs.}} We derive a closed-form expression for the PDM for $n$ qubits and $2$ times, before generalising the expression to $m$ times. 

Consider the PDM of $n$ qubits undergoing a channel $\mathcal{M}_{2|1}$ between times $t_1$ and $t_2$. In order to fully define the PDM of Eq.~\eqref{eq: defPDM} it is necessary to further define how the Pauli expectation values  $\langle  \{ \tilde{\sigma}_{i_{\alpha}} \}^m_{\alpha=1} \rangle$ are measured, since that choice impacts the states in between the measurements. We, importantly, choose {\em coarse-grained} projectors
\begin{align}
\label{eq:coarseP}
\Bigl\{& P^{\alpha}_+= \frac{ \mathbbm{1}  + \tilde{\sigma}_{i_\alpha}}{2} , 
P^{\alpha}_-= \frac{\mathbbm{1}  - \tilde{ \sigma}_{i_\alpha}}{2} \Bigl\},
\end{align} 
where $\alpha$ in $i_\alpha$ labels the time of the measurement. The coarse-grained projectors, by inspection, correspond to a minimally invasive measurement for determining the expectation values $\langle  \{ \tilde{\sigma}_{i_{\alpha}} \}^m_{\alpha=1} \rangle$. 

 
The closed form of the PDM that we shall derive employs the Choi-Jamio{\l}kowski (CJ) matrix of the quantum channel $\mathcal{M}_{2|1}$, defined as~\cite{choi1975completely,jamiolkowski1972linear}
\begin{equation} \label{eq: CHOI}
M_{12}:= \sum^{2^n-1}_{i ,j=0}\ket{i}\bra{j}^T \otimes  \mathcal{M}_{2|1} \left( \ket{i}\bra{j}  \right),
\end{equation}
where the superscript $T$ denotes the transpose.
We show (see the Appendix) that the 2-time $n$-qubit PDM, under coarse-grained measurements, can be written in a surprisingly neat form in terms of $M_{12}$.
\begin{thm}
\label{thm: 2timesPDM}
Consider a system consisting of $n$ qubits with the initial state $\rho_1$.  The coarse-grained measurements of Eq.~\eqref{eq:coarseP} are applied at times $t_1$ and $t_2$.  The channel $\mathcal{M}_{2|1}$ with CJ matrix $M_{12}$ is applied in-between the measurements. The $n$-qubit PDM can then be written as
\begin{align} \label{eq:2timenqubit}
R_{12} = \frac{1}{2}( M_{12} \, \rho  +\rho  \, M_{12}  ) ,
\end{align}
where $\rho :=\rho_1 \otimes \mathbbm{1}_2$.
\end{thm}
This extends an earlier known form for the single qubit case~\cite{horsman2017can, zhao2018geometry}.

We next stretch the argument to multiple times. Consider initially an $n$-qubit state $\rho_1$ measured at time $t_1$, undergoing the channel $\mathcal{M}_{2|1}$, measured at time $ t_2$, undergoing $\mathcal{M}_{3|2}$ and measured at time $t_3$. The central objects to determine are the joint expectation values of the observables at three times. These can be written as 
\begin{align}
\label{eq:3timeexpectation}
 & \langle  \tilde{\sigma}_{i_1} , \tilde{ \sigma}_{i_2} , \tilde{\sigma}_{i_3} \rangle \nonumber\\
 =&\Tr_{23}  [ M_{23} \Bigl(  P^{2}_{ +} \rho_2^{(\tilde{\sigma}_{i_1})}  P^{2}_{ +} -  P^{2}_{ -} \rho_2^{(\tilde{\sigma}_{i_1})}  P^{2}_{ -}  \Bigl) \otimes \tilde{\sigma}_{i_3} ] ,
\end{align}
where we denote the CJ matrices for channels $\mathcal{M}_{2|1}, \mathcal{M}_{3|2}$ by $M_{12},M_{23} $ respectively, and (see the Appendix)
\begin{align}
\label{eq:rho2}
\rho_2^{(\tilde{\sigma}_{i_1})}  =\Tr_1[  R_{12} \, \tilde{\sigma}_{i_1} \otimes \mathbbm{1}_2 ] .
\end{align}

Eqs.~\eqref{eq:3timeexpectation} and \eqref{eq:rho2} then together imply
\begin{align}
\label{eq:3timeexpectationR}
  &\langle  \tilde{\sigma}_{i_1} ,\tilde{ \sigma}_{i_2} , \tilde{\sigma}_{i_3} \rangle \nonumber\\
 = &\frac{1}{2} \Tr  [ ( M_{23}  R_{12}   +    R_{12}  M_{23}  )  \tilde{\sigma}_{i_1} \otimes \tilde{\sigma}_{i_2}  \otimes \tilde{\sigma}_{i_3} ] .
\end{align} 

From Eq.\eqref{eq:3timeexpectationR}, demanding that
\begin{align}
\label{eq:R123}
R_{123}=\frac{1}{2}  ( R_{12}   M_{23} +   M_{23} R_{12} ),
\end{align}
gives expectation values consistent with the PDM definition of Eq.~\eqref{eq: defPDM}. Then, since the expectation values 
{\em uniquely} determine the PDM, Eq.~\eqref{eq:R123} must be the correct expression. 

The above derivation can be directly generalized (see the Appendix) to the $m$-time $n$-qubit case.
\begin{thm}
The $n$-qubit PDM across $m$ times is given by the following iterative expression
\begin{align}
R_{12...m}= \frac{1}{2} (R_{12...m-1} M_{m-1,m}+  M_{m-1,m} R_{12...m-1}  )
\end{align}
with the initial condition $R_{12}= \frac{1}{2}( \rho \, M_{12} +M_{12} \, \rho ) $ where $M_{m-1,m}$ denotes the CJ matrix of the $(m-1)$-th channel.
\end{thm}

This iterative expression can be written in a (possibly long) closed form sum in a natural manner. We have thus extended a key tool in the PDM formalism from the cases of single qubits, two times or two qubits single time to the case of $n$ qubits at $m$ times for any $n$ and $m$.


\noindent {\bf {\em Relating PDM negativity to causal inference.}} 
We will now consider how the negativity or positivity of reduced (partially traced) PDMs relates to the causal structure. 

There are several reduced PDMs to consider. The total PDM here is associated with a bipartite system $AB$ consisting of $n$ qubits across two times $t_1, t_2$, as depicted in FIG.~\ref{fig:qsetup}. The main reduced PDMs we shall employ to infer causation are $ R_{A_1B_2}, R_{B_1A_2}, $ where the letters denote the party and the subscripts the time.  One can show (see the Appendix) $R_{A_1B_2} = \Tr_{A_2B_1}R_{A_1B_1A_2B_2}, R_{B_1A_2} = \Tr_{B_2A_1}R_{A_1B_1A_2B_2} $ . 

 
Our approach to quantum causal inference is based on analyzing the causal strength measure $f$ of Eq.~\eqref{eq: causmono}, which measures the negativity of the PDM. The PDM is positive if there is no causal influence between the two parties~\cite{fitzsimons2015quantum}. However, for channels that permit causal influence, the PDM can still be positive, for properly chosen initial states (see the examples later). 


We shall use certain definitions and results concerning quantum evolutions (channels) that help us distinguish whether causal influence is permitted. Those results concern so-called \textit{semicausal} channels and special cases of semicausal channels. In stating these results, we will borrow some of the terminologies from Refs.~\cite{beckman2001causal, eggeling2002semicausal}. \textit{Semicausal channels} are those bipartite completely positive trace-preserving (CPTP) maps that do not allow one party to signal or influence the other. It was proved in Ref.~\cite{eggeling2002semicausal} that semicausal channels are equivalent to \textit{semilocalizable} channels. 
 A bipartite channel $\mathcal{P} $ is semilocalizable if and only if there exist channels $\mathcal{M}_{BC}, \mathcal{N}_{AC} $ such that $ \mathcal{P} =\Tr_C \mathcal{M}_{BC} \circ  \mathcal{N}_{AC} $ or $ \mathcal{P}=\Tr_C \mathcal{N}_{AC} \circ  \mathcal{M}_{BC} $. The circuit representation of $ \mathcal{P} =\Tr_C \mathcal{M}_{BC} \circ  \mathcal{N}_{AC} $ is depicted in FIG.~\ref{fig:semicausal}.  A bipartite channel is called \textit{causal} if it does not allow influences or signaling in either direction. A class of such channels is called \textit{localizable} channels, which take the form $\mathcal{P} = \sum_i p_i \mathcal{P} _{A,i} \otimes \mathcal{P} _{B,i}. $ 

In our causal inference scheme to distinguish between the causal structures of FIG.~\ref{fig:qsetup} one of the causal structures allowed is semicausal channels between $A$ and $B$~\cite{eggeling2002semicausal}. For example, as shown in FIG.~\ref{fig:semicausal}, there may be a physical process $\mathcal{P}$ on $A$ and $B$ across two times $t_1, t_2$ that can be decomposed into $\mathcal{M}_{BC} \circ \mathcal{ \mathcal{N}}_{AC}$ where $A$ can influence $B$ and the inverse is not true.

%One significant challenge in using causal strength to determine causal structures is the potential interference from common-cause relations~\cite{janzing2013quantifying}. 



The following theorem plays a crucial role in the causal inference scheme we shall propose. The theorem concerns the case of semi-causal channels, i.e. of signalling in one direction only. It shows that, for semi-causal channels, a particular PDM will have no negativity regardless of the bipartite input state to the process. 

\begin{thm}[null PDM negativity for semicausal channels] \label{thm:nullneg}
If a quantum channel $\mathcal{P}$ does not allow signaling from $B$ to $A$, i.e.,  semicausal, then, for any state $\rho_{A_1B_1}$ at time $t_1$,  the PDM $R_{B_1A_2} $ is positive semidefinite and the PDM negativity $f(R_{B_1A_2} )=0$.
\end{thm}

This theorem is quite remarkable. It shows that if there is no causation from $B_1$ to $A_2$, any initial correlations between $A_1$ and $B_1$ cannot make the PDM negativity $f(R_{B_1A_2})>0$. In contrast, other measures `without intervention'  are impacted by initial correlations~\cite{janzing2013quantifying}. Moreover, the theorem implies that {\em only} the existence of causal influence between $B$ and $A$ allows for  $f(R_{B_1A_2} )>0$. Finally, constructing $R_{B_1A_2}$ and $R_{B_2A_1}$ only requires restricted statistics, and not full knowledge of the channel.



The following Corollary follows immediately from Theorem~\ref{thm:nullneg}.
\begin{cor}
If a quantum channel $\mathcal{P}$ does not allow signaling in both directions, i.e., is causal, then, for any state $\rho_{A_1B_1}$ at time $t_1$, the two PDMs $R_{B_1A_2}$, $R_{A_1B_2} $ are positive semidefinite and the PDM negativities $f(R_{B_1A_2} )=f(R_{A_1B_2} )=0$.
\end{cor}

If one is free to choose input states as part of characterising solely the channel, like in Refs.~\cite{beckman2001causal, eggeling2002semicausal}, using pure input states can be seen to be optimal. From property IV of $f(.)$, with a given $R=\sum_ip_iR_i$, the most negative pure state $R_{i*}:=\mathrm{argmax}\, f(R_i)$ respects $f(R_{i*})\geq f(R)$. We conjecture that there is always a family of pure input states such that the sign of $f$ determines whether a channel is signalling in a given direction--see the Appendix for a proof of this for the case of 2-qubit unitary evolution.


%
\begin{figure}
  \centering
  \includegraphics[scale=0.65]{semicausal.pdf}
  \caption{ {\bf{ Semicausal channel.}} Semicausal channels are equivalent to semilocalizable channels~\cite{eggeling2002semicausal}.  A channel acting on two parties $A$ and $B$ is called semilocalized if  it can be decomposed into either $ \mathcal{M}_{BC} \circ \mathcal{ \mathcal{N}}_{AC} $ or $\mathcal{N}_{AC} \circ \mathcal{ \mathcal{M}}_{BC} $ where $C$ is an ancilla, as in the above circuit. %The above circuit represents a semi causal channel which has the decomposition $ \mathcal{M}_{BC} \circ \mathcal{ \mathcal{N}}_{AC} $. 
  One sees that in this example $A$ can causally influence $B$ while the inverse is not true.   }  
  \label{fig:semicausal}
\end{figure}
%



\noindent {\bf {\em Protocol for Quantum causal inference via measurements alone.}}
Our approach to quantum causal inference from the PDM $R_{A_1B_1A_2B_2}$ involves two tasks, with the protocol for the second task making direct use of Theorem~\ref{thm:nullneg}.
\begin{itemize}
\item[Task 1.] Identify whether there is a common cause of $\rho_{A_2B_2}=R_{A_2B_2}$ (the possible presence of which is depicted via dashed ball in FIG.\ref{fig:qsetup}). This means determining whether there are correlations in $\rho_{A_1B_1}=R_{A_1B_1}$, as can be done by standard methods once $\rho_{A_1B_1}$ is known. $\rho_{A_1B_1}$, in turn, can be deduced from the total PDM $R$ via $\rho_{A_1B_1}= \Tr_2 R_{A_1B_1A_2B_2}$.

\item[Task 2.]  Identify the cause-effect direction (the direction of the arrow between the white and red ball in FIG.~\ref{fig:qsetup}). Once we have constructed the PDMs $R_{A_1B_2},R_{B_1A_2}$, we calculate the PDM negativities $f(R_{A_1B_2}), f(R_{B_1A_2}).$  Given Theorem~\ref{thm:nullneg} we can infer the cause-effect relation from these causal strengths. More specifically, there are three cases:
%
\begin{itemize}

\item[case 1),] $f(R_{A_1B_2}) > 0 , f(R_{B_1A_2})=0$. Then the causal direction is $A \rightarrow B$;

\item[case 2),] $f(R_{A_1B_2}) = 0 , f(R_{B_1A_2})>0$. Then the causal direction is $A \leftarrow B$;

\item[case 3),] $f(R_{A_1B_2}) = 0 , f(R_{B_1A_2})=0$. Then we are not sure about the causal direction. Either there is no causal influence between the two parties, as demonstrated by the corollary to Theorem~\ref{thm:nullneg}, or the channel permits causal influence, but the initial states are chosen in such a way that the PDMs $R_{A_1B_2}, R_{B_1A_2}$ are positive.

\end{itemize}

\end{itemize}

\noindent {\bf {\em Example: consecutive swaps with initial correlation.}} We firstly illustrate the causal inference protocol with an example that is straightforward to calculate analytically. Suppose that the initial state $\rho_1=\ket{\Psi}_{ABC} \bra{\Psi} $ where $\ket{\Psi}_{ABC} = \frac{1}{ \sqrt{2} } ( \ket{000} + \ket{111})$. This state, as shown in FIG.~\ref{fig:semicausal}, undergoes swap channels $ \mathcal{N}_{AC} = \text{swap}(A,C)$ and $\mathcal{M}_{BC} = \text{swap}(B,C)$. In the Pauli basis , the CJ matrix of the channel $ \mathcal{M}_{BC} \circ \mathcal{N}_{AC} $ (Eq.~\eqref{eq: CHOI}) can be written as 
\begin{align}
 M=  \frac{1}{2^3}\sum^3_{ijk=0} \sigma_i \sigma_j\sigma_k \ \mathcal{M}_{BC} \circ \mathcal{N}_{AC} (\sigma_i \sigma_j\sigma_k),
 % &\sum^{2^3-1}_{i ,j=0}\ket{i} \bra{j}^T \otimes  \mathcal{M}_{BC} \circ \mathcal{N}_{AC} \left( \ket{i}\bra{j}  \right) \nonumber\\
%=&\mathbbm{1} \otimes  \mathcal{M}_{BC} \circ \mathcal{N}_{AC} (   \text{SWAP}) .
 \end{align}
 where the tensor products `$\otimes$' are implicit.

%The following illustrates the quantum causal inference approach. Denote swap and SWAP  by the single qubit and three-qubit swap operator, respectively.  As shown in Figure~\ref{fig:semicausal}, suppose that the initial state $\rho_1=\ket{\Psi}_{ABC} \bra{\Psi} $ where $\ket{\Psi}_{ABC} = \frac{1}{ \sqrt{2} } ( \ket{000} + \ket{111}) $ and the channels $ \mathcal{N}_{AC} = \text{swap}(A,C),  \mathcal{M}_{BC} = \text{swap}(B,C)$.  The Choi matrix of the channel $ \mathcal{M}_{BC} \circ \mathcal{N}_{AC}  $ is $ M=  \mathbb{I} \otimes  \mathcal{M}_{BC} \circ \mathcal{N}_{AC} (   \text{SWAP}) $.
%=& \sum^3_{ \substack{i,j,k,m,n,\\ p,q=0 } } \sigma^A_i \sigma^B_j \sigma^C_k  \sigma^A_m   \sigma^A_i  \sigma^A_n  \sigma^B_p \sigma^B_j   \sigma^B_q \sigma^C_p \sigma^C_m \sigma^C_k  \sigma^C_n \sigma^C_q
%\end{align}
We assume the experimenter has undertaken measurements determining the PDM $R_{A_1B_1C_1A_2B_2C_2}$. Given Eq.~\eqref{eq:2timenqubit}, the PDM for the three systems is in fact
\begin{align}
R_{A_1B_1C_1A_2B_2C_2} = \frac{1}{2} ( M \rho +\rho M). 
\end{align}
Recall that $R_{A_1B_2} =\Tr_{B_1C_1A_2C_2}  R_{A_1B_1C_1A_2B_2C_2}$ and $R_{B_1A_2} =\Tr_{A_1C_1B_2C_2}  R_{A_1B_1C_1A_2B_2C_2}$. We obtain $
 R_{A_1B_2} = \frac{1}{4} \sum^3_{i=0} \sigma_i \otimes \sigma_i \,
$
 with eigenvalues $\{ -\frac{1}{2} ,\frac{1}{2},\frac{1}{2},\frac{1}{2}  \}$. Moreover, 
$
R_{B_1A_2} = \frac{1}{4} \left( \sigma_0 \otimes \sigma_0+ \sigma_3 \otimes \sigma_3   \right) \, 
$ 
with eigenvalues $\{ \frac{1}{2} ,\frac{1}{2},0,0  \}$.  The PDM negativities  $f(R_{A_1B_2}) =1 > 0, f(R_{B_1A_2 })=0.$ Therefore, $A$ has causal influence on $B$. Moreover, we saw that the initial state has correlation. Thus we have, from the total $R$, inferred that the causal structure is of type 5 in FIG.~\ref{fig:qsetup}.

The example also illustrates how the protocol allows one to infer the causal relationship solely from correlations of coarse-grained quantum measurements. The protocol only requires $R$ which is determined via correlations of quantum measurements that we chose to be coarse-grained. This contrasts with the reset interventions which are commonly employed in classical causal inference problems~\cite{pearl2009causality}. Quantum measurements do in general disturb the system, but much less so than resets, and moreover, our protocol only requires coarse-grained measurements.

\noindent {\bf {\em Example: measure-and-prepare channel with or without initial correlation.}}  We now consider an example, related to Ref.~\cite{ried2015quantum}, that shows how our light-touch protocol can resolve the causal structure even for channels that do not preserve quantum coherence. Let systems $A$ and $B$ be single qubit systems and the end effect of the compound channel $ \mathcal{M}_{BC} \circ \mathcal{N}_{AC } $ on the compound system $AB$ be the channel that measures the system $A$ and then prepares a state on system $B$. Denote the effective channel on $AB$ by $\mathcal{L}_{A \rightarrow B}$. We demand that the action of $\mathcal{L}_{A \rightarrow B}$ on the state is $\mathcal{L}_{A \rightarrow B} (\rho_{A}) = \bra{0} \rho_{A} \ket{0}  \ket{0}_{B}  \bra{0} +\bra{1} \rho_{A} \ket{1}  \ket{1}_{B} \bra{1}$. Therefore, the CJ matrix of $\mathcal{L}$ in the Pauli basis is 
 \begin{align}\label{eq: MPchoi}
M_{A_1B_2}= \frac{1}{2} \sum^3_{i=0}   \sigma_i \otimes  \mathcal{L}( \sigma_i ) = \frac{1}{2} ( \sigma_0 \otimes  \sigma_0  + \sigma_3 \otimes \sigma_3). 
\end{align}
 Substituting Eq.~\eqref{eq: MPchoi} into Eq.~\eqref{eq:2timenqubit}, the PDM 
\begin{align}
R_{A_1B_2} 
%= \frac{1}{2} (M_{A_1B_2}  \rho + \rho M_{A_1B_2} ) \nonumber\\
 %=&  \frac{1}{4} ( 2\rho \otimes \mathbbm{1} + \rho \sigma_3 \otimes \sigma_3 +  \sigma_3 \rho \otimes \sigma_3 ) \nonumber\\
 =&   \left(\frac{1}{2} \rho_{A_1}    +\frac{1}{4} \sigma_3  +  \frac{z}{4} \sigma_0  \right) \otimes \ket{0}\bra{0}  \nonumber\\
 &+  \left(\frac{1}{2} \rho_{A_1} - \frac{1}{4} \sigma_3 - \frac{z}{4} \sigma_0 \right) \otimes \ket{1}\bra{1}, 
\end{align}
where $z:= \Tr (\rho_{A_1} \sigma_3) $. The eigenvalues of $ \rho_{A_1}  +\frac{1}{2} \sigma_3 +  \frac{z}{2} \mathbbm{1}$ are $ \frac{1}{2}(1+z\pm \sqrt{(1+z)^2+x^2+y^2})$ with $x:=  \Tr( \rho_{A_1} \sigma_1), y:=  \Tr( \rho_{A_1} \sigma_2)$. Thus, the PDM is negative exactly when $ x^2 +y^2>0$, i.e., when the initial state $\rho_{A_1}$ is coherent in the Pauli-$z$ basis. Then, for example, when the PDM  $R_{A_1B_2}$ is negative, the causal direction is from $A$ to $B$ (case 1 or 5 in FIG.~\ref{fig:qsetup}). The initial state would determine the exact causal relation. 

The above example highlights how our scheme can resolve the causal structure solely from observational data in a decoherent channel. This goes beyond the observational scheme in Ref.~\cite{ried2015quantum} and shows that coherence in the channel is not required here for the apparent quantum advantage in resolving causal relations, but rather coherence in the initial state.

\vspace{0.5cm}
\noindent {\bf {\em Summary and outlook.}} We showed that quantum observations alone are sufficient to resolve causal relations for the case of bipartite quantum systems with measurements at two times. We showed this by, firstly, deriving as a key technical contribution a closed-form expression for the space-time pseudo-density matrix associated with many times and qubits. We show that this matrix can be determined by coarse-grained quantum observations alone and that given the matrix one can infer the causal structure via the sign of a causal monotone function. The scheme thus amounts to an extremely light-touch quantum causal inference protocol. The protocol shows how in the quantum case, for any bipartite system, one can in fact, in opposition to the slogan `correlation does not imply causation' infer causal relationships from correlations between measurement outcomes, provided these are at several times. We  showed that here, the quantum advantage in inferring causal structures lies in the coherence present in the initial state.

The results naturally point towards several developments:(i) While the derivation of Leggett-Garg type inequalities typically assumes no evolution between measurements~\cite{leggett1985quantum, VitaglianoB23}, our closed-form expression enables deriving inequalities for arbitrary evolutions, (ii) The causality monotone might be possible to witness via observables, taking inspiration from~\cite{araujo2015witnessing}, (iii) These results could perhaps have been derived in other formalisms based around the CJ isomorphism~\cite{liu2023unification, oreshkov2012quantum,costa2016quantum, chiribella2009theoretical,allen2017quantum,ried2015quantum}, (iv) Our scheme can be used to determine {\em classical} causal structures without interventions provided that these can be probed in quantum superposition, e.g.\ as in the case of typical optical table equipment, (v) What does it tell us about quantum theory that such light-touch interventions are sufficient to determine the causal structure, apparently in sharp contrast to the classical case? 


\noindent {\bf {\em Acknowledgements.}} 
We thank Dong Yang, Daniel Ebler, Caslav Brukner, Giulio Chiribella and James Fullwood for discussions. XL and OD acknowledge support from the NSFC (Grants No. 12050410246, No. 1200509, No. 12050410245) and City University of Hong Kong (Project No. 9610623). YQ is supported by the NRF, Singapore and A*STAR. This publication was made possible in part through the support of the ID 61466 grant from the John Templeton Foundation, as part of the The Quantum Information Structure of Spacetime (QISS) Project (qiss.fr). The opinions expressed in this publication are those of the authors and do not necessarily reflect the views of the John Templeton Foundation. This research is also funded in part by the Gordon and Betty Moore Foundation through Grant GBMF10604 to VV. 


  
  
  \bibliography{ref}
  \newpage 
%\include{Appendix} 


\onecolumngrid

\cleardoublepage
\setcounter{page}{1}
%\setcounter{equation}{0}
\setcounter{footnote}{0}
\thispagestyle{empty}
\begin{center}
	\textbf{\large Appendix for Quantum Causal Inference with Extremely Light Touch}\\
	 \vspace{2ex}
	\text{Xiangjing Liu$^{1,2}$, Yixian Qiu$^{3}$, Oscar Dahlsten$^{2,1,4,5}$ and Vlatko Vedral$^{6}$ }\\
		 \vspace{1ex}
	\textit{ $^1$  Department of Physics, Southern University of Science and Technology, Shenzhen 518055, China}\\
\textit{ $^2$ Department of Physics, City University of Hong Kong, 83 Tat Chee Avenue, Kowloon, Hong Kong}\\
\textit{$^3$ Centre for Quantum Technologies, National University of Singapore, Singapore 117543, Singapore}\\
\textit{$^4$ Shenzhen Institute for Quantum Science and Engineering, Southern University of Science and Technology, Shenzhen 518055, China}\\
\textit{$^5$ Institute of Nanoscience and Applications, Southern University of Science and Technology, Shenzhen 518055, China}\\
\textit{$^6$Clarendon Laboratory, University of Oxford, Parks Road, Oxford OX1 3PU, United Kingdom}



\end{center}

\noindent {\bf {Measurement scheme.}} Let us take a two-qubit system to illustrate our design of measurement events.
At initial time $t_1$, we implement the observable $  \sigma_{i}^{A} \otimes \sigma_{j}^{B} $. This observable can be decomposed into linear combinations of projectors in several ways. For example, 
\begin{align}\label{eq: statistics}
 \sigma_{i} \otimes \sigma_{j}  &=   P_1   +   P_2   -    P_3   -    P_4  =   (P_1+P_2 ) -  (P_3+P_4) ,
\end{align}
where 
\begin{align}
&P_1 := \frac{1}{4} (\mathbbm{1} + \sigma_{i}) \otimes (\mathbbm{1} +\sigma_j ), \, P_2 := \frac{1}{4} (\mathbbm{1} - \sigma_i) \otimes (\mathbbm{1} - \sigma_j), \, \nonumber\\
&  P_3 := \frac{1}{4} (\mathbbm{1} + \sigma_i) \otimes (\mathbbm{1} - \sigma_j), \,P_4 :=\frac{1}{4} (\mathbbm{1} - \sigma_i) ,\otimes (\mathbbm{1} + \sigma_j),
\end{align}
are the elements of the projective measurement. It can also be decomposed in terms of the Bell basis
\begin{align}\label{eq: statistics2}
 \sigma_i \otimes \sigma_j  &=   \tilde{P}_1   +    \tilde{P}_2  -     \tilde{P}_3  -  \tilde{P}_4  =   (\tilde{P}_1+\tilde{P}_2 ) -  (\tilde{P}_3 +\tilde{P}_4 )  ,
\end{align}
where 
\begin{align}
  \tilde{P}_1 & := \frac{1}{4}  U (\mathbbm{1}  \otimes \mathbbm{1} + \sigma_1 \otimes \sigma_1 - \sigma_2 \otimes \sigma_2+ \sigma_3 \otimes \sigma_3)  U^\dag ,  
  \tilde{P}_2 := \frac{1}{4}U (\mathbbm{1}  \otimes \mathbbm{1} + \sigma_1 \otimes \sigma_1 + \sigma_2 \otimes \sigma_2- \sigma_3 \otimes \sigma_3)  U^\dag , \nonumber\\
   \tilde{P}_3 & := \frac{1}{4} U(\mathbbm{1}  \otimes \mathbbm{1} - \sigma_1 \otimes \sigma_1 + \sigma_2 \otimes \sigma_2+ \sigma_3 \otimes \sigma_3)  U^\dag , 
  \tilde{P}_4  :=\frac{1}{4}U (\mathbbm{1}  \otimes \mathbbm{1} - \sigma_1 \otimes \sigma_1 - \sigma_2 \otimes \sigma_2- \sigma_3 \otimes \sigma_3)  U^\dag ,
\end{align}
are elements of the Bell measurement with the unitary $U$ satisfying $ U \sigma_1 \otimes \sigma_1 U^\dag =  \sigma_i \otimes \sigma_j.$

One can show
\begin{align}\label{eq:P+}
  P_1   +   P_2   =   \tilde{P}_1+\tilde{P}_2=: P_+,
\end{align}
and 
\begin{align}\label{eq:P-}
  P_3   +   P_4   =   \tilde{P}_3+\tilde{P}_4=: P_-.
\end{align}


%The second equalities in Eq.~\eqref{eq: statistics} and Eq.~\eqref{eq: statistics2} imply a measurement scheme while the third equalities indicate a coarse-grained version of that. 
 
We shall define the PDM in terms of the corresponding coarse-grained measurement
 $$ \Bigl\{P_+:=   \frac{  \mathbbm{1} \otimes \mathbbm{1} + \sigma_i \otimes \sigma_j  }{2}  ,  P_- :=    \frac{  \mathbbm{1} \otimes \mathbbm{1} - \sigma_i \otimes \sigma_j  }{2} \Bigl  \}.$$
 
\noindent {\bf {The 2-time $n$-qubit PDM.}} Having the quantum state $\rho_{1}$ at time $t_1$,  the measurement $\{ P^{\alpha}_+, P^{\alpha}_-\}$ at each time $t_\alpha, \alpha=1,2,$ and the quantum channel $\mathcal{M}_{2|1}$ with its CJ matrix $M_{12}$, we are in a good position to obtain the 2-time $n$-qubit PDM. Recall that the general form of $n$-qubit PDM across two times $ [t_1, t_2] $ is given by 
\begin{align}
R_{12}=\frac{1}{2^{2n}} \sum^{4^n-1}_{i_1=0} \sum^{4^n-1}_{i_2=0}  \langle  \tilde{\sigma}_{i_{1}} ,  \tilde{\sigma}_{i_{2}} \rangle \,  \tilde{\sigma}_{i_1} \otimes  \tilde{\sigma}_{i_2} .
\end{align}
Therefore, in order to construct the PDM, it is necessary to calculate the expectation values of the product of the result of the measurements, i.e., $ \langle  \tilde{\sigma}_{i_{1}} ,  \tilde{\sigma}_{i_2} \rangle$. According to the definition of the PDM, the initial state collapse to the eigenstates of the $n$-qubit Pauli matrix $\tilde{\sigma}_{i_{1}}$ after the measurement at time $t_1$. Then the post-measurement states go through the channel followed by a measurement at time $t_2$. Denote $\{ P^{\alpha}_{+}=  (  \mathbbm{1} + \tilde{ \sigma}_{i_\alpha } )/2, P^{\alpha}_{-}= (  \mathbbm{1} - \tilde{ \sigma}_{i_\alpha} )/2   \}$ by the coarse-grained measurement scheme at time $t_\alpha, \alpha=1,2$,  the product of expectation values can be expressed by
\begin{align}\label{eq: expectations}
& \langle  \tilde{\sigma}_{i_{1}} ,  \tilde{\sigma}_{i_2} \rangle  = \Tr[M_{12}  (P^1_+ \rho_1 P^1_+ \otimes  \tilde{\sigma}_{i_2})  ] -\Tr[M_{12}  (P^1_- \rho_1 P^1_- \otimes  \tilde{\sigma}_{i_2})  ], 
\end{align}
It is straightforward to calculate that 
 \begin{align}\label{eq: poststates}
  P^1_+ \rho_1 P^1_+ - P^1_- \rho_1 P^1_-
   =   \frac{  \mathbbm{1} + \tilde{ \sigma}_{i_1}  }{2}  \rho_1 \frac{  \mathbbm{1} + \tilde{ \sigma}_{i_1}  }{2}   -  \frac{  \mathbbm{1} -  \tilde{ \sigma}_{i_1}  }{2}   \rho_1 \frac{  \mathbbm{1} - \tilde{ \sigma}_{i_1}  }{2} 
 = \frac{1}{2} ( \rho_1  \tilde{ \sigma}_{i_1}  +\tilde{ \sigma}_{i_1} \rho_1  ).
 \end{align}
Substituting Eq~\eqref{eq: poststates} into Eq~\eqref{eq: expectations} leads to
\begin{align} \label{eq: ExpValue}
  \langle  \tilde{\sigma}_{i_{1}} ,  \tilde{\sigma}_{i_2} \rangle  
= &\Tr [ \frac{1}{2} M_{12} (\rho_1  \tilde{ \sigma}_{i_1}  +\tilde{ \sigma}_{i_1} \rho_1 ) \otimes  \tilde{\sigma}_{i_2} ]\nonumber\\
=&\Tr [ \frac{1}{2} (M_{12} \, \rho_1 \otimes \mathbbm{1}_2  +  \rho_1 \otimes \mathbbm{1}_2 \, M_{12} )  \tilde{\sigma}_{i_{1}} \otimes  \tilde{\sigma}_{i_2} ] \nonumber\\
 \equiv & \Tr [ R_{12} \tilde{\sigma}_{i_{1}}  \otimes \tilde{\sigma}_{i_2} ].
\end{align} 
where the cyclic property of the trace is used in the second equality. Finally, the two-qubit PDM is expressed by 
\begin{align}\label{eq: two-qPDM}
R_{12} = \frac{1}{2}( M \rho +\rho M  ) .
\end{align}
where $\rho := \rho_1 \otimes \mathbbm{1}_2 $.

In the following, we verify that the PDM given by Eq.~\eqref{eq: two-qPDM} returns to the normal density matrix when there is one time point left.
\begin{itemize}

\item[1)] Tracing out the final time $t_2$, the PDM returns to the initial state,
 \begin{align}
\Tr_2 R_{12} = \frac{1}{2} \Tr_2  ( M_{12} \, \rho +\rho \, M_{12}  ) = \rho_{1},
\end{align} where $\Tr_2 M_{12}= \mathbbm{1} _1$ is used in the second equality,

\item[2)] Tracing out the initial time $t_1$, the PDM returns to the output state,
\begin{align} \label{eq: finalstate}
 \Tr_1 R_{12} = \frac{1}{2} \Tr_1  ( M_{12} \, \rho +\rho \, M_{12}  ) = \Tr_1  M_{12} \, \rho_{1} \otimes \mathbbm{1}_2 = \mathcal{M}_{2|1}(\rho_{1}) ,
 \end{align}
 where the cyclic property of the trace is used in the second equality.

\end{itemize}

\noindent {\bf {\em The $m$-time $n$-qubit PDM.}} In this section, we extend the $n$-qubit PDM formalism to across $m$ times. To do that we first consider an $n$-qubit state $\rho$ at time $t_1$ that undergoes the channel $\mathcal{M}_{2|1}$,  arrives at time $ t_2$, then experiences channel $\mathcal{M}_{3|2}$ and arrives at time $t_3$. Denote the CJ matrices for channels $\mathcal{M}_{2|1}, \mathcal{M}_{3|2}$ by $M_{12}, M_{23}$ respectively. The tensor product `$ \otimes$' is sometimes omitted when there is no confusion. 

We first recall that the two-time $n$-qubit PDM takes the form
\begin{align}
R_{12}= \frac{1}{2} (M_{12} \rho + \rho M_{12} ).
\end{align}

We now proceed to derive a closed form of the 3-time $n$-qubit PDM. To do that,  it is sufficient to calculate the expectation values of measurement events. Consider measurement events at time $t_1,t_2, t_3$ are $ \{ \tilde{\sigma}_{i_1}\}, \{ \tilde{\sigma}_{i_2} \}, \{ \tilde{\sigma}_{i_3} \}$, respectively. The initial state $\rho_1$ first collapses to the eigenstates of operator $ \tilde{\sigma}_{i_1}$ then goes into the channel $\mathcal{M}_{2|1}$. The central quantity we wish to evaluate is $\langle  \tilde{\sigma}_{i_1} , \tilde{ \sigma}_{i_2} ,\tilde{ \sigma}_{i_3} \rangle$.

Our expression for $\langle  \tilde{\sigma}_{i_1} , \tilde{ \sigma}_{i_2} ,\tilde{ \sigma}_{i_3} \rangle$ will turn out to involve a matrix $\rho_2^{( \tilde{\sigma}_{i_1}) }$. We now derive a simplified expression for $\rho_2^{( \tilde{\sigma}_{i_1}) }$, which we shall use later.
\begin{align}\label{eq: rho2}
\rho_2^{( \tilde{\sigma}_{i_1}) } :=& \Tr_1 [ \frac{1}{2} (M_{12} P^{1}_{ +} \rho_1 P^{1}_{ +}  +   P^{1}_{ +}  \rho_1   P^{1}_{ +}  M_{12} ) ]- \Tr_1 [ \frac{1}{2} (M_{12}  P^{1}_-  \rho_1   P^{1}_{ -}  +   P^{1}_{ -}  \rho_1   P^{1}_-  M_{12} )  ]\nonumber\\
=&  \Tr_1 [ \frac{1}{2} M_{12} ( P^{1}_{ +} \rho_1 P^{1}_{ +}  -  P^{1}_-  \rho_1   P^{1}_{ -}   ) ]+ \Tr_1 [ \frac{1}{2} ( P^{1}_+  \rho_1   P^{1}_{ +}  -   P^{1}_{ -}  \rho_1   P^{1}_- ) M_{12} ]  \nonumber\\
=&  \Tr_1 [ \frac{1}{4} M_{12}  ( \rho_1  \tilde{ \sigma}_{i_1}  +\tilde{ \sigma}_{i_1} \rho_1  )]
 + \Tr_1 [ \frac{1}{4}  ( \rho_1  \tilde{ \sigma}_{i_1}  +\tilde{ \sigma}_{i_1} \rho_1  ) M_{12}  ] \nonumber\\
 =&  \Tr_1 [ \frac{1}{2}   ( M_{12} \rho_1    + \rho_1 M_{12} )\tilde{ \sigma}_{i_1} ]  \nonumber\\
 =&\Tr_1 [ R_{12} \tilde{\sigma}_{i_1} ],
\end{align}
where the identity operators $\mathbbm{1}_2$ at time $t_2$ are ignored throughout the calculation, Eq.~\eqref{eq: poststates} is used in the third equality and the cyclic property of the trace is used in the fourth equality. Then, the expectation value of the product of measurement outcomes at three time points is given by
\begin{align}
 & \langle  \tilde{\sigma}_{i_1} , \tilde{ \sigma}_{i_2} ,\tilde{ \sigma}_{i_3} \rangle \nonumber\\
 =&\Tr_{23}  [ M_{23} \Bigl( P^{2}_{ +} \rho^{ (\tilde{\sigma}_{i_1}) }_2 P^{2}_{+} - P^{2}_{-}\rho^{ (\tilde{\sigma}_{i_1}) }_2 P^{2}_{ -}  \Bigl) \otimes \tilde{ \sigma}_{i_3} ] \nonumber\\
 =& \frac{1}{2} \Tr_{23}  [ M_{23} \Bigl(  ( \Tr_{1}  R_{12} \tilde{\sigma}_{i_1}  ) \sigma_{i_2}+ \tilde{\sigma}_{i_2} ( \Tr_{1}  R_{12} \tilde{ \sigma}_{i_1} )   \Bigl) \otimes \tilde{\sigma}_{i_3} ] \nonumber\\
 =& \frac{1}{2} \Tr_{123}  [ M_{23} (  R_{12} \tilde{ \sigma}_{i_1} ) \tilde{\sigma}_{i_2} +  (  R_{12} \tilde{\sigma}_{i_1} M_{23}  ) \tilde{ \sigma}_{i_2}    \Bigl) \otimes \tilde{\sigma}_{i_3} ] \nonumber\\
 =& \frac{1}{2} \Tr   [ ( M_{23}  R_{12}   +    R_{12}  M_{23}  ) \tilde{ \sigma}_{i_1} \otimes \tilde{ \sigma}_{i_2}  \otimes \tilde{\sigma}_{i_3} ] ,
\end{align} 
where Eq.~\eqref{eq: poststates} and Eq.~\eqref{eq: rho2} are used in the second equality and the cyclic property of the trace is used in the third equality.
Thus, we have the $n$-qubit PDM across 3 times as 
\begin{align}
R_{123}=\frac{1}{2}  ( R_{12}   M_{23} +   M_{23} R_{12} ).
\end{align}

Let us assume that we have the  $(m-1)$-time $n$-qubit PDM $R_{12,...,m-1}$. We then consider $m$ events $\{ \tilde{\sigma}_{i_1} , \tilde{\sigma}_{i_2}, ..., \tilde{\sigma}_{i_{m}}    \}$ and the channel $\mathcal{M}_{i+1|i}$ between time interval $[t_{i}, t_{i+1}], i\in \{1,2,3 ,...,m-1\}$ with the corresponding CJ matrix $M_{i,i+1}$. Similarly, the matrix $\rho^{(\vec{ \tilde{\sigma} }_{} )}_{m-1}$  just before measurement made at time $t_{m-1}$ can be written as 
\begin{align}
\rho^{(\vec{ \tilde{\sigma} }_{} )}_{m-1}= \Tr_{12..,m-2} [ R_{12,...,m-1} \tilde{\sigma}_{i_1} \tilde{\sigma}_{i_2}...\tilde{\sigma}_{i_{m-2}} ].
\end{align}
The expectation value of the product of measurement outcomes at those time points is given by
\begin{align}
 & \langle  \tilde{\sigma}_{i_1} , \tilde{ \sigma}_{i_2} ,...,\tilde{ \sigma}_{i_{m}} \rangle \nonumber\\
 =&\Tr_{m-1,m}  \Bigl( M_{m-1,m} \Bigl( P^{m-1}_{ +} \rho^{(\vec{ \tilde{\sigma} }_{} )}_{m-1} P^{m-1}_{+} - P^{m-1}_{-}\rho^{(\vec{ \tilde{\sigma} }_{} )}_{m-1} P^{m-1}_{ -}  \Bigl)  \tilde{ \sigma}_{i_m} \Bigl) \nonumber\\
 =& \frac{1}{2} \Tr_{m-1,m}  \Bigl( M_{m-1,m} \Bigl(  ( \Tr_{12,...,m-2}  R_{12,...,m-1}  \tilde{\sigma}_{i_1} \tilde{\sigma}_{i_2} ,...,\tilde{\sigma}_{i_{m-2}}  ) \tilde{\sigma}_{i_{m-1}}+ \tilde{\sigma}_{i_{m-1}}( \Tr_{12,...,m-2}  R_{12,...,m-1}  \tilde{\sigma}_{i_1} \tilde{\sigma}_{i_2} ,...,\tilde{\sigma}_{i_{m-2}}  )   \Bigl)  \tilde{\sigma}_{i_m} \Bigl) \nonumber\\
 =& \frac{1}{2} \Tr_{12,...,m}  \Bigl( M_{m-1,m} ( R_{12,...,m-1}  \tilde{\sigma}_{i_1} \tilde{\sigma}_{i_2} ,...,\tilde{\sigma}_{i_{m-2}}   ) \tilde{\sigma}_{i_{m-1}} +  ( R_{12,...,m-1}  \tilde{\sigma}_{i_1} \tilde{\sigma}_{i_2} ,...,\tilde{\sigma}_{i_{m-2}}  ) M_{m-1,m}   \tilde{ \sigma}_{i_{m-1}}    \Bigl) \tilde{\sigma}_{i_m} \Bigl) \nonumber\\
 =& \frac{1}{2} \Tr_{12,...,m}   \Bigl( ( M_{m-1,m}  R_{12,...,m-1}   +    R_{12,...,m-1}  M_{m-1,m}  ) \tilde{ \sigma}_{i_1} \tilde{ \sigma}_{i_2} ... \tilde{\sigma}_{i_m} \Bigl) ,
\end{align} 
Thus, we have $R_{12...m}= \frac{1}{2} (R_{12...m-1} M_{m-1,m}+  M_{m-1,m} R_{12...m-1}  ) $.

In summary,
the $n$-qubit PDM across $m$ times is given by the following iterative expression
\begin{align}
R_{12...m}= \frac{1}{2} (R_{12...m-1} M_{m-1,m}+  M_{m-1,m} R_{12...m-1}  )
\end{align}
with the initial condition $R_{12}= \frac{1}{2}( \rho  M_{12} +M_{12} \rho  ) $, $M_{m-1,m}$ denotes the CJ matrix of the $(m-1)$th channel.


 \noindent {\bf {\em Partial trace.}} Given a pseudo-density matrix $R_{A_1B_1A_2B_2}$ defined over two sets of events $A_1B_1$ and $A_2B_2$ and a pseudo-density matrix $R_{A_1B_2}$ contructed from the sets of events $A_1$ and $B_2$,  one can show that the latter can be obtained from $R_{A_1B_1A_2B_2}$ by tracing over the subsystem corresponding to $B_1A_2$, i.e., $ R_{A_1B_2} = \Tr_{A_2B_1}R_{A_1B_1A_2B_2} $. 
  \begin{proof}
   For the simplicity of the notations, we give a proof to the two-time two-qubit PDM case, it can be directly generalized to the $m$-time $n$-qubit PDM case.  In the following calculation, the tensor product `$ \otimes$' is omitted when there is no confusion.
  
    From the definition of pseudo-density matrix, we have
  \begin{align}
  R_{A_1B_2}= \frac{1}{4 } \sum^3_{i=0} \sum^3_{j=0} \langle \sigma^{A_1}_i , \sigma^{B_2}_j  \rangle \sigma^{A_1}_i  \sigma^{B_2}_j ,
    \end{align}
  and 
  \begin{align}
  R_{A_1B_1A_2B_2}= \frac{1}{2^4} \sum^3_{i,j,k,l=0} \langle \sigma^{A_1}_i \sigma^{B_1}_j, \sigma^{A_2}_k \sigma^{B_2}_l  \rangle \sigma^{A_1}_i \sigma^{B_1}_j \sigma^{A_2}_k \sigma^{B_2}_l.
    \end{align}
It is then straightforward to calculate 
\begin{align}
& \Tr_{B_1A_2}   R_{A_1B_1A_2B_2} \nonumber\\
=&  \Tr_{B_1A_2} [ \frac{1}{2^4} \sum^3_{i,j,k,l=0} \langle \sigma^{A_1}_i \sigma^{B_1}_j, \sigma^{A_2}_k \sigma^{B_2}_l  \rangle \sigma^{A_1}_i \sigma^{B_1}_j \sigma^{A_2}_k \sigma^{B_2}_l ] \nonumber\\
=&  \frac{1}{2^4} \sum^3_{i,j,k,l=0}  \Tr_{B_1A_2}(\sigma^{B_1}_j   \sigma^{A_2}_k)   \langle \sigma^{A_1}_i \sigma^{B_1}_j, \sigma^{A_2}_k \sigma^{B_2}_l  \rangle \sigma^{A_1}_i \sigma^{B_2}_l  \nonumber\\
=&  \frac{1}{2^2} \sum^3_{i,j=0}    \langle \sigma^{A_1}_i \sigma^{B_1}_0, \sigma^{A_2}_0 \sigma^{B_2}_j  \rangle \sigma^{A_1}_i \sigma^{B_2}_l  \nonumber\\
=&R_{A_1B_2}.
\end{align}
This completes the proof.
\end{proof}

\noindent {\bf {Proof of Therem~\ref{thm:nullneg}.}}

Theorem~\ref{thm:nullneg}.\textit{
If a quantum channel $\mathcal{P}$ does not allow signaling from $B$ to $A$, i.e.,  semicausal, then, for any state $\rho_{A_1B_1}$ at time $t_1$,  the PDM $R_{B_1A_2} $ is positive semidefinite and the PDM negativity $f(R_{B_1A_2} )=0$.
 }

\begin{proof} 

A channel $\mathcal{P}: \mathcal{B}(\mathcal{H}_{A_1B_1}) \rightarrow   \mathcal{B}(\mathcal{H}_{A_2B_2}) $ is called semicausal~\cite{eggeling2002semicausal}, if, 
\begin{align} \label{eq: semicausal}
\Tr_{B_2} \mathcal{P}(\rho_{A_1B_1}) = \mathcal{T}  (\rho_{A_1}),
\end{align}
for all input states $\rho_{A_1B_1}$ and for some completely positive maps $ \mathcal{T}: \mathcal{B}(\mathcal{H}_{A_1}) \rightarrow   \mathcal{B}(\mathcal{H}_{A_2}) $. 

   For the simplicity of the notations, we give a proof to the two-qubit PDM case, it can be directly generalized to the $n$-qubit PDM case. In the Pauli basis, the CJ matrix of channel $\mathcal{P}$ is 
   \begin{align} \label{eq: pChoi}
 M= &\sum^{2^2-1}_{i ,j=0}\ket{i} \bra{j}^T \otimes  \mathcal{P} \left( \ket{i}\bra{j}  \right) = \frac{1}{2^2} \sum^3_{i,j=0} \sigma^{A_1}_i \sigma^{B_1}_j \mathcal{P} ( \sigma^{A_1}_i \sigma^{B_1}_j     ) .
 \end{align}
 where the tensor products `$\otimes$' are omitted.
   The PDM can be calculated as 
\begin{align}
  R_{B_1A_2}  =& \Tr_{A_1B_2} R_{A_1B_1A_2B_2}  \nonumber\\
  =& \frac{1}{2}  \Tr_{A_1B_2} [ M  \rho_{A_1B_1} +\rho_{A_1B_1} M  ] \nonumber\\
  =&  \frac{1}{8}  \Tr_{A_1B_2} \sum^3_{i,j=0} \{ \rho_{A_1B_1}, \sigma^{A_1}_i \sigma^{B_1}_j \} \mathcal{P} ( \sigma^{A_1}_i \sigma^{B_1}_j     )  \nonumber\\
  =&   \frac{1}{8} \Tr_{A_1}\sum^3_{i=0} \{ \rho_{A_1B_1}, \sigma^{A_1}_i  \sigma^{B_1}_0 \}   \mathcal{T}_{A}( \sigma^{A_1}_{i} )  \nonumber\\
  =&  \frac{1}{4}  \sum^3_{i,l=0} \langle \sigma^{A_1}_i  \sigma^{B_1}_l \rangle \sigma^{B_1}_l   \mathcal{T}_{A}( \sigma^{A_1}_{i} )  \nonumber\\
  =& \mathcal{T}_{A} \otimes \id_{ B} (\rho_{A_1B_1}), 
\end{align}
where $\{ \,,\}$ denotes the anticommutator,  Eq.~\eqref{eq: pChoi} is used in the third equality and Eq.~\eqref{eq: semicausal} is used in the fourth equality.
Since $\mathcal{T}$ is completely positive, it is straightforward to see that $ R_{B_1A_2}$ is positive semidefinite. Finally, $f(R_{B_1A_2})=0$ since the causal monotone $f$ measures the negativity of PDMs. This completes the proof.
\end{proof}

\noindent {\bf {Determining causal influence of channel by optimizing the input state. } } We conjecture that, for the case where the input state is free because one is solely interested in whether the channel is signaling, there is always a family of states such that $f >0$ provides a necessary and sufficient condition for the channel to allow causal influence in a given direction. We here show the conjecture to hold for any two-qubit unitary channel. 

Any two-qubit unitary $U_{AB}$ has the following decomposition~\cite{kraus2001optimal}
\begin{align}
U_{AB}=U_A \otimes U_B \, e^{i\theta S_{AB}} \,V_A \otimes V_B,
\end{align}
where $S$ denotes the swap operator, and  the operator $e^{i\theta S_{AB}}$ is the reason for causal influence from both sides.  Since the property (II) the PDM negativity $f(R)$ is invariant under local change of basis, one can ignore the two factors $U_A \otimes U_B$ and $V_A \otimes V_B$ in $U_{AB}$ when analysis causal influence via $f$. 
Below we provide an example to illustrate that an input state can be found to witness causal influence of the unitary operator $e^{i\theta S_{AB}}$. 

Consider the state of the compound system $\rho_{A_1B_1}= \ket{0}_{A}\bra{0} \otimes \ket{0}_B\bra{0}$ undergoing a unitary evolution, 
$$
U_{AB}(\theta)=e^{i \theta S}= \cos(\theta) \,  \id + i  \sin(\theta) \, S := c \id + i s S.
$$
Under this evolution $U_{AB}(\theta)$, the initial state $\rho_{A_1}$ of the system cannot influence its final state $\rho_{A_2}$ when $c=0$, i.e., no causal influence from $A_1$ to $A_2$. Moreover, there is causal influence from $A_1$ to  $A_2$ when $c>0$. Next, we show that $f(R_{A_1A_2}  ) =c$ and therefore, under the choice of the initial state $\rho_{A_1B_1}$,  $f(R_{A_1A_2}  ) >0$ provides a necessary and sufficient condition for the parameterized channel to allow causal influence from $A_1$ to $A_2$.    Similar analyses are also applicable to examining causal influences from   $A_1$ to $B_2$, $B_1$ to $B_2$, and $B_1$ to $A_2$.

The effective dynamics of the system $A$ can be modeled as a quantum channel $N$ with the set of Kraus operators given by 
$ \{K_1 = c \id + i  s \ket{0} \bra{0}, K_2= is \ket{0}\bra{1}  \} $ ~\cite{liu2022thermodynamics}.
The corresponding 2-time PDM of the system $A$ is given by 
\begin{align}
R_{A_1A_2} = \ket{00}\bra{00}+  \frac{c(c + i s)}{2} \ket{01}\bra{10} +  \frac{c(c - i s)}{2} \ket{10}\bra{01}.
\end{align}
The eigenvalues of $R_{A_1A_2}$ are $\{ 1, - \frac{c}{2},\frac{c}{2} , 0\}$.  Therefore, $f(R_{A_1A_2}  ) =c $. 


\end{document}
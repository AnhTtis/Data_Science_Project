\begin{algorithm}[H]
    \centering
    \caption{Forward process of diffusion-based purification}\label{alg:forward_process}
    \begin{algorithmic}[1]
        \State \textbf{Input}: image $\mathbf{x}_0$, maximum timestep $t^*$
        \State $\boldsymbol{\epsilon} \sim \mathcal{N}(\boldsymbol{0}, \mathbf{I})$
        \State $\mathbf{x}_{t^*} = \sqrt{\alpha_{t^*}}\mathbf{x}_0 + \sqrt{1 - \alpha_{t^*}}\boldsymbol{\epsilon}$
        \State \textbf{Return} $\mathbf{x}_{t^*}$
    \end{algorithmic}
\end{algorithm}
\begin{algorithm}[H]
    \centering
    \caption{Denoising process of diffusion-based purification}\label{alg:denoising_process}
    \begin{algorithmic}[1]
        \State \textbf{Input}: noisy image $\mathbf{x}_{t^*}$, timestep schedule $\{\tau_0, \tau_1, \dotsc, \tau_s\}$
        \For{$i = s, \dotsc, 1$}
        \State $\boldsymbol{\epsilon} \sim \mathcal{N}(\boldsymbol{0}, \mathbf{I})$
        \State $\mathbf{x}_{\tau_{i-1}} = \sqrt{\alpha_{\tau_{i-1}}}\bigg(
        {\mathbf{x}_{\tau_{i}} - \sqrt{1 - \alpha_{\tau_{i}}}\mathbf{\epsilon}_\theta (\mathbf{x}_{\tau_{i}}) \over \sqrt{\alpha_{\tau_{i}}}}\bigg) + \sqrt{1 - \alpha_{\tau_{i-1}} - \sigma^2_{\tau_{i}}} \cdot \epsilon_\theta (\mathbf{x}_{\tau_{i}}) + \sigma_{\tau_{i}} \boldsymbol{\epsilon}$
        \EndFor
        \State \textbf{Return}  $\mathbf{x}_{0}$
    \end{algorithmic}
\end{algorithm}
\newcommand{\sepModeScaleX}{1}
\newcommand{\sepModeScaleY}{1}

\tikzstyle{sepEdge}=[gray,thin]
\tikzstyle{sepNode}=[minimum size=1.5em,inner sep=0em]
\tikzstyle{sR}=[highlightedSimplexVertexR,sepNode]
\tikzstyle{sG}=[highlightedSimplexVertexG,sepNode]
\tikzstyle{sB}=[highlightedSimplexVertexB,sepNode]
\tikzstyle{sO}=[highlightedSimplexVertexY,sepNode]
\tikzstyle{sYG}=[highlightedSimplexVertexYG,sepNode]
\tikzstyle{sYB}=[highlightedSimplexVertexYB,sepNode]
\tikzstyle{sRG}=[highlightedSimplexVertexRG,sepNode]
\tikzstyle{sRB}=[highlightedSimplexVertexRB,sepNode]
\tikzstyle{sX}=[highlightedSimplexVertexGray,sepNode]

%if( (coordsX<=1&coordsY<=1)|(coordsX>=2&coordsY>=2&(coordsX!=2&coordsY!=2)),1, if((coordsX==0&coordsY==3)|(coordsX==3&coordsY==0),-1,0) )

\newcommand{\sepModeNodes}[2]{
    \foreach \a/\b/\c/\d/\e/\f/\g/\h/\i/\j/\k/\l/\m/\n/\o/\p in {#1}{
        \foreach \ac/\bc/\cc/\dc/\ec/\fc/\gc/\hc/\ic/\jc/\kc/\lc/\mc/\nc/\oc/\pc in {#2}{
            
            \node[\ac] at (0.0,0.0) {\a};
            \node[\bc] at (1.0,0.0) {\b};
            \node[\cc] at (2.0,0.0) {\c};
            \node[\dc] at (3.0,0.0) {\d};
            
            \node[\ec] at (0.0,1.0) {\e};
            \node[\fc] at (1.0,1.0) {\f};
            \node[\gc] at (2.0,1.0) {\g};
            \node[\hc] at (3.0,1.0) {\h};
            
            \node[\ic] at (0.0,2.0) {\i};
            \node[\jc] at (1.0,2.0) {\j};
            \node[\kc] at (2.0,2.0) {\k};
            \node[\lc] at (3.0,2.0) {\l};
            
            \node[\mc] at (0.0,3.0) {\m};
            \node[\nc] at (1.0,3.0) {\n};
            \node[\oc] at (2.0,3.0) {\o};
            \node[\pc] at (3.0,3.0) {\p};
        }
    }
}

\newcommand{\sepModeGrid}{
    % \edef\myx{0}
        % \pgfmathparse{\myx+1.0}
        % \xdef\mya{\pgfmathresult}
    \foreach \x in {0,...,3} {
        \draw[sepEdge] (\x,0)--(\x,3);
        \draw[sepEdge] (0,\x)--(3,\x);
    }
    \draw[sepEdge] (0,0)--(3,3);
    \draw[sepEdge] (0,1)--(2,3);
    \draw[sepEdge] (0,2)--(1,3);
    \draw[sepEdge] (1,0)--(3,2);
    \draw[sepEdge] (2,0)--(3,1);
}

\newcommand{\drawSepNodes}[1]{
    \foreach \x/\y in {#1}{
        \node[simplexVertex] at (\x,\y) {};
    }
}

\newcommand{\sepCapY}{-0.65}

\begin{tikzpicture}[xscale=\sepModeScaleX,yscale=\sepModeScaleY]
    \begin{scope}[xshift=0em,yshift=0em]
        \sepModeGrid
        \sepModeNodes
            {14/12/2 /0 /13/11/3 /4 /5 /6 /7 /8 /1 /9 /10/15}%
            {sB/sX/sX/sR/sX/sX/sX/sX/sX/sX/sX/sX/sO/sX/sX/sG}
        \node at (1.5,\sepCapY) {a) Input Scalar Field};
    \end{scope}
    
    \begin{scope}[xshift=-6.5em,yshift=-14em]
        \sepModeGrid
        \sepModeNodes
            {14/12/2 /0 /13/11/3 /4 /5 /6 /7 /8 /1 /9 /10/15}%
            {sB/sB/sB/sG/sB/sB/sB/sG/sB/sB/sG/sG/sG/sG/sG/sG}
            
        \draw[thick] (0,2.5)--(1.5,2.5)--(1.5,1.5)--(2.5,1.5)--(2.5,0);
        \drawSepNodes{0.0/2.5, 0.5/2.5, 1.0/2.5, 1.5/2.5, 1.5/2.0, 1.5/1.5, 2.0/1.5, 2.5/1.5, 2.5/1.0, 2.5/0.5, 2.5/0.0}
        
        \node at (0,\sepCapY-0.2) {b)};
        \node at (1.7,\sepCapY) {Descending Seg.};
        \node at (1.7,\sepCapY-0.4) {+ Region Separators};
    \end{scope}
    
    \begin{scope}[xshift=6.5em,yshift=-14em]

        \draw[fill=highlight0_gray] (0,0)--(3,3)--(2,3)--(0,1)--cycle;
        \sepModeGrid
        \draw[line width=0.2em] (0,0)--(3,3);
        \draw[line width=0.2em] (0,1)--(2,3);
        
        \sepModeNodes
            {14/12/2 /0 /13/11/3 /4 /5 /6 /7 /8 /1 /9 /10/15}%
            {sR/sR/sR/sR/sO/sR/sR/sR/sO/sO/sR/sR/sO/sO/sO/sR}
            
        % \draw[thick] (0,0.5)--(2.5,3.0);
        % \drawSepNodes{0.0/0.5, 0.5/1.0, 1.0/1.5, 1.5/2.0, 2.0/2.5, 2.5/3.0}
        
        \node at (0,\sepCapY-0.2) {c)};
        \node at (1.7,\sepCapY) {Ascending Seg.};
        \node at (1.7,\sepCapY-0.4) {+ Region Boundaries};
    \end{scope}
    
    \begin{scope}[xshift=-6.5em,yshift=-29em]
        \sepModeGrid
        \sepModeNodes
            {14/12/2 /0 /13/11/3 /4 /5 /6 /7 /8 /1 /9 /10/15}%
            {sRB/sRB/sRB/sRG/sYB/sRB/sRB/sRG/sYB/sYB/sRG/sRG/sYG/sYG/sYG/sRG}
            
        \draw[thick] (0,2.5)--(1.5,2.5)--(1.66,2.33)--(1.33,1.66)--(1.5,1.5)--(2.5,1.5)--(2.5,0.0);
        \draw[thick] (0,0.5)--(1,1.5)--(1.33,1.66);
        \draw[thick] (1.66,2.33)--(2.0,2.5)--(2.5,3.0);
        \drawSepNodes{0/2.5,1.5/2.5,1.66/2.33,1.33/1.66,1.5/1.5,2.5/1.5,2.5/0.0}
        \drawSepNodes{0/0.5,0.5/1.0,1.0/1.5,0.5/2.5,1.0/2.5,2.0/1.5,2.5/1.0,2.5/0.5,2.0/2.5,2.5/3.0,1.5/2.0}
        
        \node at (0,\sepCapY-0.2) {d)};
        \node at (1.7,\sepCapY) {Morse-Smale Seg.};
        \node at (1.7,\sepCapY-0.4) {+ Region Separators};
    \end{scope}
    
    \begin{scope}[xshift=6.5em,yshift=-29em]
        \draw[fill=highlight0_gray] (0,2)--(0,3)--(3,3)--(2,2)--(3,2)--(3,0)--(2,0)--(2,1)--(1,1)--(0,0)--(0,1)--(1,2)--cycle;
        \sepModeGrid
            
        \draw[line width=0.2em] (0,3)--(2,3);
        \draw[line width=0.2em] (0,2)--(1,2)--(0,1);
        \draw[line width=0.2em] (0,0)--(1,1)--(2,1)--(2,0);
        \draw[line width=0.2em] (3,0)--(3,2)--(2,2)--(3,3);
        
        \sepModeNodes
            {14/12/2 /0 /13/11/3 /4 /5 /6 /7 /8 /1 /9 /10/15}%
            {sRB/sRB/sRB/sRG/sYB/sRB/sRB/sRG/sYB/sYB/sRG/sRG/sYG/sYG/sYG/sRG}
        
        \node at (0,\sepCapY-0.2) {e)};
        \node at (1.7,\sepCapY) {Morse-Smale Seg.};
        \node at (1.7,\sepCapY-0.4) {+ Region Boundaries};
    \end{scope}   
\end{tikzpicture}
\vspace{10pt}
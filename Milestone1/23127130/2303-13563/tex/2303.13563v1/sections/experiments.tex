
\begin{table*}[ht!]
\centering
\caption{Comparison results on CIFAR-10, CIFAR-10-DVS, and DVS128 Gesture.}
\begin{tabular}{l|l|c|c|c|c|c}
\hline
dataset                         & model       & \multicolumn{1}{l|}{\begin{tabular}[c]{@{}l@{}}ANN \\ accuracy (\%)\end{tabular}} & \multicolumn{1}{l|}{\begin{tabular}[c]{@{}l@{}}SNN \\ accuracy (\%)\end{tabular}} & \multicolumn{1}{l|}{\begin{tabular}[c]{@{}l@{}}Our Optimized \\ SNN Accuracy (\%)\end{tabular}} & \multicolumn{1}{l|}{\begin{tabular}[c]{@{}l@{}}SNN avg \\ firing rate\end{tabular}} & \multicolumn{1}{l}{\begin{tabular}[c]{@{}l@{}}Optimized avg \\ firing rate\end{tabular}} \\ \hline
\multirow{3}{*}{CIFAR-10}       & resnet18    & 93.02 (+/- 1.1\%)                                                                 & 81.3 (+/- 1.4\%)                                                                  & \textbf{90.34 (+/- 0.2\%)}                                                                      & 15.6\%                                                                              & \textbf{22.3\%}                                                                           \\ \cline{2-7} 
                                & densenet121 & 95.03 (+/- 0.3\%)                                                                 & 89.23 (+/- 2.1\%)                                                                 & \textbf{95.45 (+/- 0.05\%)}                                                                     & 17.4\%                                                                              & \textbf{21\%}                                                                             \\ \cline{2-7} 
                                & mobilenetv2 & 94.43 (+/- 0.8\%)                                                                 & 73.14 (+/- 1.3\%)                                                                 & \textbf{92.31 (+/- 0.1\%)}                                                                      & 7.5\%                                                                               & \textbf{16.83\%}                                                                          \\ \hline\hline
\multirow{3}{*}{CIFAR-10-DVS}   & resnet18    & -                                                                                 & 60.43 (+/- 1.5\%)                                                                 & \textbf{65.23 (+/- 0.1 \%)}                                                                     & 11.2\%                                                                              & \textbf{17.32\%}                                                                          \\ \cline{2-7} 
                                & densenet121 & -                                                                                 & 64.34 (+/- 1.2\%)                                                                 & \textbf{75.34 (+/- 0.14\%)}                                                                     & 14.23\%                                                                             & \textbf{15.3\%}                                                                           \\ \cline{2-7} 
                                & mobilenetv2 & -                                                                                 & 62.7 (+/- 2.3\%)                                                                  & \textbf{74.32 (+/- 0.2\%)}                                                                      & 8.67\%                                                                              & \textbf{16.43\%}                                                                          \\ \hline\hline
\multirow{3}{*}{DVS128 Gesture} & resnet18    & -                                                                                 & 90.91 (+/- 0.6\%)                                                                 & \textbf{95.43 (+/- 0.15\%)}                                                                     & 10.32\%                                                                             & \textbf{13.7\%}                                                                           \\ \cline{2-7} 
                                & densenet121 & -                                                                                 & 91.2 (+/- 1.3\%)                                                                  & \textbf{93.21 (+/- 0.03\%)}                                                                     & 9.6\%                                                                               & \textbf{15.4\%}                                                                           \\ \cline{2-7} 
                                & mobilenetv2 & -                                                                                 & 70.32 (+/- 1.12\%)                                                                & \textbf{94.5 (+/- 0.11\%)}                                                                      & 6.4\%                                                                               & \textbf{11.5\%}                                                                           \\ \hline
\end{tabular}

\label{tab:results}
\end{table*}

\section{Experiments}
\label{sec:setup}
In this section, we present the results of the effects of skip connections on the performance of SNN.
%%
The experiments were conducted using the snnTorch library~\cite{eshraghian2021training}. We evaluated the optimization on three datasets: CIFAR-10~\cite{krizhevsky2009learning}, CIFAR-10-DVS~\cite{Li2017}, and DVS128 Gesture~\cite{DVS_gesture_8100264}. %using the optimization method introduced in subsection \cref{sec:skip_connections_optimization}. % for the skip connections.
\par
For CIFAR-10, we trained the model on 50k images split into 10 classes, with 5k each for validation and testing. We used an SGD optimizer with a learning rate of 0.01 and a momentum of 0.9. The employed number of steps is equal to 25 and the maximum number of epochs is equal to 200.
%%
For CIFAR-10-DVS, the dataset contains 10k images recorded by a DVS128 sensor, split into 90\% training and 10\% test, with the training further divided into 80\% new training and 20\% validation. We train the models for 100 epochs with a learning rate set to 0.025, SGD optimizer, and momentum to 0.9.
%%
For DVS128 Gesture, event data was recorded from 29 subjects performing 11 hand gestures and preprocessed into 4k sequences for training, 500 for validation, and 500 for testing. The training was performed for 200 epochs with a learning rate of 0.01 and Adam optimizer.

\subsection{Overall results}
Table~\ref{tab:results} shows the overall results of optimizing the skip connections on three state-of-the-art architectures resnet18~\cite{HeZRS15}, densenet121~\cite{HuangLW16a}, and mobilenetv2~\cite{mobilenet-v2}. 
%%
Our optimized architectures consistently perform better than the original SNN version. On average, we achieve 
+11.3\%, +9.3\%, and +10.2\% accuracy on CIFAR-10, CIFAR-10-DVS, and DVS128 Gesture respectively. Note that given the non-static images in CIFAR-10-DVS and DVS128 Gesture, conventional ANN is omitted for such type of data. 

\subsection{Comparison with random Search}
The efficacy of our hyperparameter optimization is compared to random search in figure~\ref{fig:rs}. We implement a random search (RS) over the constructed search space of adjacency matrices. The search builds the architecture based on a randomly sampled adjacency matrix without replacement. Then RS trains the architecture from scratch which requires a massive computing budget. With fewer iterations, our method achieves better performance for optimizing multiple models with fewer iterations. Besides, our hyperparameter optimization is more stable and consistently provides closer solutions, which ensures finding the right architectures within a single run of search.


\begin{figure}
    \centering
    \includegraphics[width=0.45\textwidth]{figures/comp_rs.pdf}
    \caption{Comparison with random search. The shaded area provides the standard deviation obtained after 5 runs.}
    \vspace{-0.5cm}
    \label{fig:rs}
\end{figure}
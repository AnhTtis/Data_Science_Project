	\begin{tikzpicture}
		\coordinate (L1) at (0,0);
		\node at ($(L1)+(-3,1)$) {(a)};
		
		\draw[line width=1pt] (L1)--++(0,.5);
		\draw[line width=1pt] ($(L1)+(.75,0)$)--++(0,.5);
		\draw[line width=1pt] ($(L1)+(1.5,0)$)--++(0,.5);
		\draw[line width=1pt] ($(L1)+(2.25,0)$)--++(0,.5);
		\draw[line width=1pt] ($(L1)+(3,0)$)--++(0,.5);
		\draw[line width=1pt] ($(L1)+(3.75,0)$)--++(0,1.5)node[right]{$l$};
		
		\draw[rounded corners=.25cm,fill=lblue,line width=1pt]  ($(L1)+(-.25,.5)$)rectangle++(4.25,.5);
		
		\TNode{}{L1}{yellow!50!red}{};
		\TNode{}{$(L1)+(.75,0)$}{yellow!50!red}{};
		\TNode{}{$(L1)+(1.5,0)$}{yellow!50!red}{};
		\TNode{}{$(L1)+(2.25,0)$}{yellow!50!red}{};
		\TNode{}{$(L1)+(3,0)$}{yellow!50!red}{};
		\TNode{}{$(L1)+(3.75,0)$}{yellow!50!red}{};
		
		\node at ($(L1)+(4.5,0)$) {$\Phi(x)$};
		\node at ($(L1)+(4.5,.75)$) {$W^l$};
		\node at ($(L1)+(-1,.75)$) {$=$};
		\node at ($(L1)+(5.5,.75)$) {$\approx$};
		
		\coordinate (L2) at ($(L1)+(-2,.75)$);
		
		\draw[line width=1pt] (L2)--++(0,.75)node[right]{$l$};
		\TNode{}{L2}{lblue}{};
		\node at ($(L2)+(-.5,-.5)$) {$f^l(x)$};
		
		\coordinate (L3) at ($(L1)+(6.5,0)$);
		
		\draw[line width=1pt] (L3)--++(0,.75)--++(3.75,0);
		\draw[line width=1pt] ($(L3)+(.75,0)$)--++(0,.5);
		\draw[line width=1pt] ($(L3)+(1.5,0)$)--++(0,.5);
		\draw[line width=1pt] ($(L3)+(2.25,0)$)--++(0,.5);
		\draw[line width=1pt] ($(L3)+(3,0)$)--++(0,.5);
		\draw[line width=1pt] ($(L3)+(3.75,0)$)--++(0,1.5)node[right]{$l$};
		
		\TNode{-1}{$(L3)+(0,.75)$}{lblue}{};
		\TNode{-1}{$(L3)+(.75,.75)$}{lblue}{};
		\TNode{-1}{$(L3)+(1.5,.75)$}{lblue}{};
		\TNode{-1}{$(L3)+(2.25,.75)$}{lblue}{};
		\TNode{-1}{$(L3)+(3,.75)$}{lblue}{};
		\TNode{-1}{$(L3)+(3.75,.75)$}{lblue}{};
		
		\TNode{}{L3}{yellow!50!red}{};
		\TNode{}{$(L3)+(.75,0)$}{yellow!50!red}{};
		\TNode{}{$(L3)+(1.5,0)$}{yellow!50!red}{};
		\TNode{}{$(L3)+(2.25,0)$}{yellow!50!red}{};
		\TNode{}{$(L3)+(3,0)$}{yellow!50!red}{};
		\TNode{}{$(L3)+(3.75,0)$}{yellow!50!red}{};
		
		\coordinate (L4) at ($(L1)+(0,-3)$);
		\node at ($(L4)+(-3,1.5)$) {(b)};
		
		\draw[line width=1pt] (L4)--++(0,.5);
		\draw[line width=1pt] ($(L4)+(.75,0)$)--++(0,.5);
		\draw[line width=1pt] ($(L4)+(1.5,0)$)--++(0,.5);
		\draw[line width=1pt] ($(L4)+(2.25,0)$)--++(0,.5);
		\draw[line width=1pt] ($(L4)+(3,0)$)--++(0,.5);
		\draw[line width=1pt] ($(L4)+(3.75,0)$)--++(0,1.5)node[right]{$l$};
		
		\draw[line width=1pt] ($(L4)-(0,.75)$)--++(0,-.5);
		\draw[line width=1pt] ($(L4)+(.75,-.75)$)--++(0,-.5);
		\draw[line width=1pt] ($(L4)+(1.5,-.75)$)--++(0,-.5);
		\draw[line width=1pt] ($(L4)+(2.25,-.75)$)--++(0,-.5);
		\draw[line width=1pt] ($(L4)+(3,-.75)$)--++(0,-.5);
		\draw[line width=1pt] ($(L4)+(3.75,-.75)$)--++(0,-1.5)node[right]{$l'$};
		
		\draw[rounded corners=.25cm,fill=lblue,line width=1pt]  ($(L4)+(-.25,.5)$)rectangle++(4.25,.5);
		\draw[rounded corners=.25cm,fill=lblue,line width=1pt]  ($(L4)+(-.25,-1.25)$)rectangle++(4.25,-.5);
		
		\TNode{}{L4}{yellow!50!red}{};
		\TNode{}{$(L4)+(.75,0)$}{yellow!50!red}{};
		\TNode{}{$(L4)+(1.5,0)$}{yellow!50!red}{};
		\TNode{}{$(L4)+(2.25,0)$}{yellow!50!red}{};
		\TNode{}{$(L4)+(3,0)$}{yellow!50!red}{};
		\TNode{}{$(L4)+(3.75,0)$}{yellow!50!red}{};
		
		\TNode{}{$(L4)+(0,-.75)$}{yellow!50!red}{};
		\TNode{}{$(L4)+(.75,-.75)$}{yellow!50!red}{};
		\TNode{}{$(L4)+(1.5,-.75)$}{yellow!50!red}{};
		\TNode{}{$(L4)+(2.25,-.75)$}{yellow!50!red}{};
		\TNode{}{$(L4)+(3,-.75)$}{yellow!50!red}{};
		\TNode{}{$(L4)+(3.75,-.75)$}{yellow!50!red}{};
		
		\node[right,align=left] at ($(L4)+(4.5,-.5)$) {$\rho(x)=|\Phi(x)\rangle\langle \Phi(x)|$};
		\node[right] at ($(L4)+(4.5,.75)$) {$W^l$};
		\node[right] at ($(L4)+(4.5,-1.5)$) {$(W^l)^\dag$};
		\node at ($(L4)+(-1,-.5)$) {$=$};
		
		\coordinate (L5) at ($(L4)+(-2,-.5)$);
		
		\draw[line width=1pt] ($(L5)-(0,.75)$)node[right]{$l'$}--++(0,1.5)node[right]{$l$};
		\TNode{}{L5}{lblue}{};
		\node at ($(L5)+(-.5,1.25)$) {$P^l(x)$};
		
	\end{tikzpicture}

	
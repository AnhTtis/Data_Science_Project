\section{Related Work}
There are many choices for accelerating (full-space) elastodynamic simulation, such as Position Based Dynamics \cite{MullerPBD2007}, Projective Dynamics \cite{Bouaziz:2014:Projective}, or Mixed FEM \cite{MixedFEMTrusty2022}. Elastodynamic simulations usually require the solution to a linear system of equations. A simple method of accelerating them is to just use a faster solver such as Multigrid methods \cite{LiuMultigrid2021}, Newton and Quasi-Newton methods \cite{QuasiNewtonLiu2017} and matrix pre-factorizations such as Cholesky decomposition.
Yet another option is to reformulate the constitutive equations to allow for a efficient boundary-only discretization
\cite{artDefoJames1999, Sugimoto:2022:BEM}.
All these methods scale in complexity with the final mesh resolution and scale \emph{at best} linearly with the complexity of the mesh. This puts an unnecessary burden on the user, forcing them to choose between fast elastodynamics with coarse meshes, or slow elastodynamics with fine meshes.
To obtain sub-linear rates the simulation needs to be carried out in a low-dimensional representative subspace.

\subsection{Subspace Simulation}


The most popular subspace for most graphics tasks is the one composed of the first few eigenvectors of the energy Hessian \cite{PentlandWilliams1989}, which we call displacement modes. 

Unfortunately, displacement modes are not well suited for large displacements, and in particular they struggle to capture rotational motion \cite{DyRT, BarbicJames:RealTimeSTVK} . Much work over the last two decades aims at remedying this short-coming for subspace simulation, a goal we share. On top of this however, we also expose another desired property that displacement modes do not generally satisfy: they lead to simulations that are not \textit{rotation equivariant}. 

 \citet{BarbicJames:RealTimeSTVK} introduce modal derivatives, later extended to geometric modelling \cite{Hildebrandt2011} and structural analysis \cite{nonlinearCompliantDuenser2022}. This methodology provides extra derivative modes, whose goal is to correct the primary subspace as it falls out of date with large deformations. While these methods provide vast improvements over traditional displacement modes, the added derivative modes do not represent rotational motion, nor do they ensure rotation equivariance in the resulting simulation.


 \begin{figure}[h]
\includegraphics[width=\linewidth]{images/dead_tree_local_rot_eq.pdf}
\caption{Using a vanilla rig-complementary displacement subspace (red) can lead to kinks and local minima when a user rotates the rig. Our rig-complementary skinning eigenmodes (cyan) are rotation equivariant and are much better suited for accomodating this type of motion.
 \label{fig:dead-tree-local-rotation-equivariance}} 
\end{figure}


 To accommodate rotational motion, modes can be warped with best fit aggregate rotational motion \cite{ModalWarping} or skinning motion \cite{EigenSkinKry2022}.
In a similar vein, sub-structuring (also called domain decomposition) \cite{Barbic:2011:RealTimeLargeDefoSubstructuring, KimJamesMultiDomainStitching}, separates a shape into independent regions, each with their own local linear subspace. The rotational motion is tracked externally and is used to update the subspace for each region. 
Instead of updating the quality of the linear basis, Rotation Strain coordinates \cite{RScoords} attempt to \emph{fix} the rotation-lacking motion of the subspace simulation at the end of each time-step via a non-linear projection step. Unfortunately all these methods require per timestep "fixes", which result in a costly simulation step that limits the richness of the dynamics available for real-time interaction.
% coordinates generate jarring artifacts under inputs commonly encountered in our use case (see \reffig{spoon-modal-fitting-comparison}).

The data driven neural subspaces of \citet{zheng2021deep} show promise for real-time applications, but suffer from artifacts when applied on meshes they are not trained on. They also provide no guarantee of any energy conserving properties desired of an elasticity subspace.

% https://english.stackexchange.com/a/463567/42413
Von Tycowicz \shortcite{Tycowicz2013} expand traditional displacement modes with each of the $d \times d$ entries of a linear map. Their result also leads to a rotation spanning subspace that guarantees simulation rotation equivariance. However, their subspace cannot be trivially made to accommodate homogeneous linear equality constraints, such as the one needed to impose rig-complementarity. As a result, this subspace is inefficient for real-time complementary dynamics. 

\subsection{Subspace Simulation via Skinning Modes}
%The foundation of our technique lies in using Linear Blend Skinning as a subspace for secondary motion. 
Linear blend skinning is a popular rigging method used to easily pose characters. \edit{ It has also widely been used as a subspace for deformation,  with prior works varying in how they compute their skinning weights. While prior methods acknowledge that skinning subspaces produce high quality rotational deformation, we further 
 motivate our use of this subspace by identifying that it \emph{guarantees} rotation equivariance, a key invariant for elastica that pure displacement subspaces break. 
} 
%

\edit{\citet{rohmer2021velocity} propose a method that prescribes secondary motion directly on the user-provided primary rig. They derive physics-like behavior that aims to mimic common squash and stretch motions. 
For more physically motivated inverse kinematics, 
\citet{Jacobson-12-FAST} use the user provided skinning rig as a subspace for minimizing an elasto-static energy. Rig-Space Physics \cite{RSPHahn} aim to add secondary motion in a rig subspace, a similar goal to ours. These works all rely on an artist to specify the rig subspace for secondary motion themselves. \citet{hahn2013efficient} mitigates this by fitting the rig subspace to a target simulation using a least-squares solve. However, this still requires a previously constructed rig animation as input.  In contrast, we propose a method that derives skinning weights entirely from the rest-pose geometry of our shape.
}

One way to achieve such weights is by requiring them to be smooth. To this end,
\citet{1Gilles2011, Wang:2015:LinearSubspaceDesign} derive skinning weights as a solution to a Laplace and bi-Laplace equation respectively. \edit{Similarly,  \citet{Lan2020, Lan2021} use bounded bi-harmonic weights \cite{JacobsonBPS11} to create smooth, non-negative skinning weights. Instead, \citet{Brandt2018HyperReducedPD, brandt2019}
 compute weights with simple truncated radial basis functions to obtain similarly smooth and locally supported bases.} While smoothness is an attractive quality for deformation, it is ill suited to represent motions for more complex materials with large heterogeneities. 
\citet{Faure2011} address this by sampling source points for their weight computation via a \emph{compliance} (inverse stiffness) weighed sampling of their shape, for which they rely on a Voronoi tessellation of their shape. \edit{Additionally, just like \citet{Tycowicz2013}, it is unclear how to enforce the complementarity constraint on the construction of these skinning weights.
 In contrast, our weights are derived from a generalized eigenvalue problem on a weight-space Hessian, which allows them to reflect material properties and accommodate the rig-complementarity constraint without requiring additional discretization. }

\begin{figure}[!t]
\includegraphics[width=\linewidth]{images/moray_rot_eq.pdf}\timestamp[-0.125cm]{\tsMorayModalDerivs}
%\caption{Modal derivatives are not closed under rotations, leading to subspace simulations that are not rotation equivariant. A user experiences different dynamics depending on the orientation their rig places the mesh. Our skinning eigenmodes guarantee rotation equivariance, leading to a more intuitive interaction.
 \caption{Our skinning eigenmodes' closure under rotations ensures that our subspace complementary dynamics simulations are rotation equivariant. A user experiences the same dynamics independent of the rig orientation. The same cannot be said for a \edit{complementary} subspace built from displacement modes + modal derivatives (see Section \ref{sec:rotating_frames}).
  \label{fig:moray-rotation-equivariance}} 
\end{figure}

\subsection{Simulations Embedded in Rotating Frames}
\label{sec:rotating_frames}
\edit{
A common solution for fixing some of the global rotational artifacts that occur in free-flying elastodynamic simulation, (as shown in \reffig{subspace-comparisons} or \reffig{random-init-linear-subspace}) is to embed the elastodynamic simulation in a rotating frame \cite{Terzopoulos1988}. Here, the elastic response is computed in a rest frame, while the rotation is tracked explicitly via a rigid body simulator \cite{Terzopoulos1988}. The two simulations are then coupled with forces that arise out of angular momentum \cite{DyRT}, and the rotation is then used to transform the deformed rest state every time-step.
Unfortunately, this approach doesn't easily generalize for complementary dynamics since the rigid motions are not orthogonal to the rig, which is why the artifacts present in \reffig{moray-rotation-equivariance} would remain. For rigs that have a global rotation, one could use that as the rotational degree of freedom \cite{DyRT}, unfortunately most rigs do not directly have such a global rotation.} 



% \paragraph{Model Reduction}
% To obtain simulations whose complexity is not limited by the full resolution of the mesh, some form of Model Reduction must be used. 
% Linear Model Reduction \cite{PentlandWilliams1989} approximates the solution to lie in a low dimensional \emph{linear} subspace. This subspace is obtained through an eigen-decomposition of the energy Hessian. 
% \cite{BarbicJames:RealTimeSTVK} introduce to the graphics community a \emph{quadratic} subspace, composed of both the primary eigen-modes. 

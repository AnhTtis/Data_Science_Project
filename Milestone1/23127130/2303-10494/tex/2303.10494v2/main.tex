\documentclass[sigconf]{acmart}

\AtBeginDocument{%
  \providecommand\BibTeX{{%
    Bib\TeX}}}



\setcopyright{none}




\settopmatter{printacmref=false}

\usepackage{booktabs}   %
\usepackage{subcaption} %
\usepackage{xspace}
\usepackage{makecell}
\usepackage{algorithm}
\usepackage[noend]{algorithmic}
\usepackage{tikz}
\usepackage{enumitem}
\input{macro}
\begin{document}

\title{Revisiting the Plastic Surgery Hypothesis \\ via Large Language Models}


\author{Chunqiu Steven Xia}
    \affiliation{\institution{University of Illinois Urbana-Champaign}\country{}}
    \email{chunqiu2@illinois.edu}
\author{Yifeng Ding}
    \affiliation{\institution{University of Illinois Urbana-Champaign}\country{}}
    \email{yifeng6@illinois.edu}
\author{Lingming Zhang}
    \affiliation{\institution{University of Illinois Urbana-Champaign}\country{}}
    \email{lingming@illinois.edu}




\begin{abstract}
\aprfull (\apr) aspires to automatically generate patches for an input buggy program. Traditional \apr tools typically focus on  specific bug types and fixes through the use of templates, heuristics, and formal specifications. However, these techniques are limited in terms of the bug types and patch variety they can produce. As such, researchers have designed various \learning \apr tools with recent work focused on directly using \plmfull{s} (\plm{s}) for \apr. While \llm-based \apr tools are able to achieve state-of-the-art performance on many repair datasets, the \plm{s} used for direct repair are not fully aware of the project-specific information such as unique variable or method names. 




The \emph{plastic surgery hypothesis} is a well-known insight for \apr, which states that the code ingredients to fix the bug usually already exist within the same project. Traditional \apr tools have largely leveraged the plastic surgery hypothesis by designing manual or heuristic-based approaches to exploit such existing code ingredients. However, as recent \apr research starts focusing on \llm-based approaches, the plastic surgery hypothesis has been largely ignored. In this paper, we ask the following question: \emph{How useful is the plastic surgery hypothesis in the era of \plm{s}?}
Interestingly, \llm-based \apr presents a unique opportunity to fully automate the plastic surgery hypothesis via fine-tuning (training on the buggy project) and prompting (directly providing valuable code ingredients as hints to the \llm). To this end, we propose \ourtech, which combines the direct usage of \plm{s} with two domain-specific fine-tuning strategies and one prompting strategy (via information retrieval and static analysis) for more powerful \apr.%
While traditional \apr techniques require intensive manual efforts in both generating patches based on the plastic surgery hypothesis and guaranteeing patch validity, our approach is fully automated and general.% 
Moreover, while it is very challenging to manually design heuristics/patterns for effectively leveraging the hypothesis, due to the power of \llm{s} in code vectorization/understanding, even partial/imprecise project-specific information can still guide \plm{s} in generating correct patches!
Our experiments on the widely studied \dfj 1.2 and 2.0 datasets show that \ourtech fixes 89 and 44 bugs (substantially outperforming the best-performing baseline by 15 and 8), respectively, demonstrating a promising future of the plastic surgery hypothesis in the era of \llm{s}.

%






\end{abstract}



\maketitle


\input{intro}
\input{background}
\input{approach}
\input{methodology}
\input{results}
\input{threat_to_validity}
\input{conclusion}


\bibliographystyle{ACM-Reference-Format}
\bibliography{reference.bib}



\end{document}

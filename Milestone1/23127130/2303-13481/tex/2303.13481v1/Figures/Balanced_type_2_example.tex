\begin{figure}[h]
    \centering
  \begin{tikzpicture}
      \begin{scope}[scale=0.5, >=Stealth]

%begin first row
      \begin{scope}

%begin diagram 
      \begin{scope}[rotate=-90]

       \node (a) at (-4,2){};
       \node (b) at (-4,3){};
       \node (c) at (-3,3) {};
       \node (d) at (-2,3){};
       \node (e) at (-1,3) {};
       \node (f) at (0,3){};
       \node (g) at (1,3) {};
       \node (h) at (2,3){};
       \node (i) at (2,2) {};
       \node (j) at (2,-1){};
       \node (k) at (1,-1) {};
       \node (l) at (0,-1){};
       \node (m) at (-1,-1) {};
       \node (n) at (-2,-1){};
       \node (o) at (-3,-1) {};
       \node (p) at (-4,-1){};

       %extras
       \node (p1) at (-4, 0){};
       \node (p2) at (-4, 1){};
        \node (i1) at (2, 1){};
        \node (i2) at (2,0){};
        

        %extra extras
        \node (mt) at (0, 2){};
        \node (mm) at (0, 1) {};
        \node (mb) at (0, 0) {};

        %extra extra extras
        \node (km) at (1,1) {};
        \node (right) at (3, 1) {};
        \node (outright) at (4,1) {};

       %OUTER ONES-----------------------

       %top row
       \draw [out=45, in=135, relative, decoration={markings, mark=at position 0.15 with {\arrow{>}}}, postaction={decorate}] 
       (b.center) to (c);
       \draw [out=60, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (c.center) to (d);
       \draw [decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}] 
       (d.center) ..controls (2,5) and (5,3).. (outright.center);

      

       %bottom row
       \draw [out=100, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}] 
       (outright) to (n);
       \draw [out=35, in=105, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (n.center) to (o);
       \draw [out=45, in=145, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (o.center) to (p.center);

       %left side
       \draw [ out=45, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (p.center) to (p1);
       \draw [out=80, in=100, relative, decoration={markings, mark=at position 0.55 with {\arrow{<}}}, postaction={decorate}] 
       (p1.center) to (a);
       \draw [out=60, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (a.center) to (b.center);
  

    %END OUTER ----
    % INNER ONES---------------------------

        %left side
        \draw [out = -30, in =-150, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (o) to (p1.center);
       \draw [out = -45, in =-135, relative, decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}]
       (p1) to (a.center);
       \draw [out = -30, in =-150, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (a) to (c.center);

       % top row ------    
       \draw [out = -45, in =-160, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (c) to (d.center);
       \draw [out =0, in =180, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (d) to (mm);
    %interrupted
        \draw [out = 35, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (mm.center) to (km);
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (km.center) to (right);
       \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (right.center) to (outright);

  
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (outright.center) to (right);
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (right.center) to (km);
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (km.center) to (mm);
       \draw [out = 0, in =180, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (mm.center) to (n.center);

       % bottom row
       \draw [out = -45, in =-145, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (n) to (o.center);

       %END INNNERS --------
              
      \end{scope}
      %end diagram

%begin A-circles
      \begin{scope}[xshift=7cm, rotate=-90]

       \node (a) at (-4,2){};
       \node (b) at (-4,3){};
       \node (c) at (-3,3) {};
       \node (d) at (-2,3){};
       \node (e) at (-1,3) {};
       \node (f) at (0,3){};
       \node (g) at (1,3) {};
       \node (h) at (2,3){};
       \node (i) at (2,2) {};
       \node (j) at (2,-1){};
       \node (k) at (1,-1) {};
       \node (l) at (0,-1){};
       \node (m) at (-1,-1) {};
       \node (n) at (-2,-1){};
       \node (o) at (-3,-1) {};
       \node (p) at (-4,-1){};

       %extras
       \node (p1) at (-4, 0){};
       \node (p2) at (-4, 1){};
        \node (i1) at (2, 1){};
        \node (i2) at (2,0){};
        

        %extra extras
        \node (mt) at (0, 2){};
        \node (mm) at (0, 1) {};
        \node (mb) at (0, 0) {};

        %extra extra extras
        \node (km) at (1,1) {};
        \node (right) at (3, 1) {};
        \node (outright) at (4,1) {};

       %OUTER ONES-----------------------

       %top row
       \draw [blue, thick, out=45, in=155, relative, decoration={markings, mark=at position 0.15 with {\arrow{}}}, postaction={decorate}] 
       (b.center) to (c);
       \draw [magenta,thick, out=60, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (c.center) to (d);
       \draw [cyan, thick, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (d.center) ..controls (2,5) and (5,3).. (outright.center);

      

       %bottom row
       \draw [cyan,thick, out=100, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (outright) to (n);
       \draw [orange,thick, out=35, in=105, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (n.center) to (o);
       \draw [green,thick, out=45, in=145, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (o.center) to (p.center);

       %left side
       \draw [green,thick, out=45, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (p.center) to (p1);
       \draw [red,thick, out=80, in=100, relative, decoration={markings, mark=at position 0.55 with {\arrow{}}}, postaction={decorate}] 
       (p1.center) to (a);
       \draw [blue,thick, out=60, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (a.center) to (b.center);
  

    %END OUTER ----
    % INNER ONES---------------------------

        %left side
        \draw [green,thick, out = -30, in =-150, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (o) to (p1.center);
       \draw [red, thick, out = -45, in =-135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (p1) to (a.center);
       \draw [blue,thick,  out = -30, in =-150, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (a) to (c.center);

       % top row ------    
       \draw [magenta,thick,  out = -45, in =-160, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (c) to (d.center);
       \draw [cyan, thick, out =0, in =180, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (d) to (mm);
    %interrupted
        \draw [purp, thick, out = 35, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (mm.center) to (km);
        \draw [Emerald,thick, out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (km.center) to (right);
       \draw [gray,thick, out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (right.center) to (outright);

  
        \draw [gray, thick, out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (outright.center) to (right);
        \draw [Emerald, thick, out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (right.center) to (km);
        \draw [purp, thick, out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (km.center) to (mm);
       \draw [cyan,thick, out = 0, in =180, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (mm.center) to (n.center);

       % bottom row
       \draw [orange, thick, out = -45, in =-145, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (n) to (o.center);

       %END INNNERS --------
              
      \end{scope}
    %end A-circles

%A-state graph
  \begin{scope}[scale = 1, xshift=12cm, yshift= -0.5cm, rotate = -90]

        \node (a) at (-3,1.5){};
       \node (b) at (-3,3){};
       %\node (c) at (-3,3) {};
       \node (d) at (-2,3){};
       \node (e) at (-1,3) {};
       \node (f) at (0,3){};
       %\node (g) at (1,3) {};
       \node (h) at (1,3){};
       \node (i) at (1,1.5) {};
       \node (j) at (1,0){};
       %\node (k) at (1,0) {};
       \node (l) at (0,0){};
       \node (m) at (-1,0) {};
       \node (n) at (-2,0){};
       %\node (o) at (-3,0) {};
       \node (p) at (-3,0){};

       %extras
       %\node (p1) at (-3, 0){};
       \node (p2) at (-3, 1.5){};
        \node (i1) at (1, 1.5){};
        %\node (i2) at (1,0){};

        %extra extras
        \node (mt) at (0, 1.5){};
        \node (mm) at (0, 1) {};
        \node (mb) at (0, 0) {};

        %------edges
        \draw[]
        % (b) -- (h)
        % (h) -- (j)
        % (j) -- (p)
        % (p) -- (b)
        % (f) -- (l);
        (b) -- (e)
        (e) -- (mt) 
        (mt) -- (h)
        (h) -- (j)
        (j) -- (mt)
        (mt) -- (m)
        (m) -- (p) 
        (p) -- (b)
        node[right, text centered, text width = 1cm, midway, xshift=0.25cm]{}  ;
        

        %---------circles
        \filldraw[color=blue, fill=blue!8] 
        (b) circle (1/3);
\filldraw[color=magenta, fill=magenta!8]     
        (e) circle (1/3);
\filldraw[color=purp, fill=purp!8] 
        (h) circle (1/3);
\filldraw[color=Emerald, fill=Emerald!8] 
        (i1) circle (1/3);
        \filldraw[color=red, fill=red!8] 
        (p2) circle (1/3);
        \filldraw[color=gray, fill=gray!8] 
        (j) circle (1/3);
  \filldraw[color=orange, fill=orange!8] 
        (m) circle (1/3);
\filldraw[color=green, fill=green!8] 
        (p) circle (1/3);
\filldraw[color=cyan, fill=cyan!8] 
         (mt) circle (1/3);
        % (mm) circle (1/3)
       \end{scope}

%reduced A-state graph
  \begin{scope}[scale = 1, xshift=17cm, yshift= -0.5cm, rotate = -90]

        \node (a) at (-3,1.5){};
       \node (b) at (-3,3){};
       %\node (c) at (-3,3) {};
       \node (d) at (-2,3){};
       \node (e) at (-1,3) {};
       \node (f) at (0,3){};
       %\node (g) at (1,3) {};
       \node (h) at (1,3){};
       \node (i) at (1,1.5) {};
       \node (j) at (1,0){};
       %\node (k) at (1,0) {};
       \node (l) at (0,0){};
       \node (m) at (-1,0) {};
       \node (n) at (-2,0){};
       %\node (o) at (-3,0) {};
       \node (p) at (-3,0){};

       %extras
       %\node (p1) at (-3, 0){};
       \node (p2) at (-3, 1.5){};
        \node (i1) at (1, 1.5){};
        %\node (i2) at (1,0){};

        %extra extras
        \node (mt) at (0, 1.5){};
        \node (mm) at (0, 1) {};
        \node (mb) at (0, 0) {};

        %------edges
        \draw[]
        % (b) -- (h)
        % (h) -- (j)
        % (j) -- (p)
        % (p) -- (b)
        % (f) -- (l);
        (b) -- (e)
        (e) -- (mt) 
        (mt) -- (h)
        (h) -- (j)
        (j) -- (mt)
        (mt) -- (m)
        (m) -- (p) 
        (p) -- (b)
        node[right, text centered, text width = 1cm, midway, xshift=0.25cm]{}  ;
        

        %---------circles
        \filldraw[color=blue, fill=blue!8] 
        (b) circle (1/3);
\filldraw[color=magenta, fill=magenta!8]     
        (e) circle (1/3);
\filldraw[color=purp, fill=purp!8] 
        (h) circle (1/3);
\filldraw[color=Emerald, fill=Emerald!8] 
        (i1) circle (1/3);
        \filldraw[color=red, fill=red!8] 
        (p2) circle (1/3);
        \filldraw[color=gray, fill=gray!8] 
        (j) circle (1/3);
  \filldraw[color=orange, fill=orange!8] 
        (m) circle (1/3);
\filldraw[color=green, fill=green!8] 
        (p) circle (1/3);
\filldraw[color=cyan, fill=cyan!8] 
         (mt) circle (1/3);
        % (mm) circle (1/3)
       \end{scope}

       
          \end{scope}
    % end first row 
       
       \end{scope}
       %end whole thing 
  \end{tikzpicture}
  \vspace{-10pt}
    \caption{A Balanced diagram of type $2$, its $A$-circles, its $A$-state graph, and its reduced $A$-state graph}
    \label{fig:Balanced type 2 example}
\end{figure}


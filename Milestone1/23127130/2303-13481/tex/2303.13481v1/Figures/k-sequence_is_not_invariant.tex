\begin{figure}[h]
    \centering
  \begin{tikzpicture}
      \begin{scope}[scale=0.55, >=Stealth]

      \begin{scope}
       \node (a) at (-4,2){};
       \node (b) at (-4,3){};
       \node (c) at (-3,3) {};
       \node (d) at (-2,3){};
       \node (e) at (-1,3) {};
       \node (f) at (0,3){};
       \node (g) at (1,3) {};
       \node (h) at (2,3){};
       \node (i) at (2,2) {};
       \node (j) at (2,-1){};
       \node (k) at (1,-1) {};
       \node (l) at (0,-1){};
       \node (m) at (-1,-1) {};
       \node (n) at (-2,-1){};
       \node (o) at (-3,-1) {};
       \node (p) at (-4,-1){};

       %extras
       \node (p1) at (-4, 0){};
       \node (p2) at (-4, 1){};
        \node (i1) at (2, 1){};
        \node (i2) at (2,0){};
        

        %extra extras
        \node (mt) at (0, 2){};
        \node (mm) at (0, 1) {};
        \node (mb) at (0, 0) {};

        %extra extra extras
        \node (km) at (1,1) {};
        \node (right) at (3, 1) {};
        \node (outright) at (4,1) {};

       %OUTER ONES-----------------------

       %top row
       \draw [out=35, in=135, relative, decoration={markings, mark=at position 0.35 with {\arrow{>}}}, postaction={decorate}] 
       (b.center) to (c);
       \draw [out=60, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (c.center) to (d);
       \draw [ decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}] 
       (d.center) ..controls (2,5) and (5,3).. (outright.center);

      

       %bottom row
       \draw [out=100, in=135, relative, decoration={markings, mark=at position 0.75 with {\arrow{>}}}, postaction={decorate}] 
       (outright) to (n);
       \draw [out=35, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (n.center) to (o);
       \draw [out=55, in=155, relative, decoration={markings, mark=at position 0.9 with {\arrow{>}}}, postaction={decorate}] 
       (o.center) to (p.center);

       %left side
       \draw [out=45, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (p.center) to (p1);
       \draw [out=70, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}] 
       (p1.center) to (a);
       \draw [out=60, in=155, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (a.center) to (b.center);
  

    %END OUTER ----
    % INNER ONES---------------------------

        %left side
        \draw [out = -30, in =-150, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (o) to (p1.center);
       \draw [out = -45, in =-135, relative, decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}]
       (p1) to (a.center);
       \draw [out = -30, in =-150, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (a) to (c.center);

       % top row ------    
       \draw [out = -45, in =-170, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (c) to (d.center);
       \draw [out =0, in =180, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (d) to (mm);
    %interrupted
        \draw [out = 35, in =135, relative, decoration={markings, mark=at position 0.7 with {\arrow{}}}, postaction={decorate}]
       (mm.center) to (km);
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (km.center) to (right);
       \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (right.center) to (outright);

  
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (outright.center) to (right);
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (right.center) to (km);
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (km.center) to (mm);
       \draw [out = 0, in =180, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (mm.center) to (n.center);

       % bottom row
       \draw [out = -45, in =-135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (n) to (o.center);

       %END INNNERS --------

       %GENERALIZING

  \begin{scope}[scale = 1, xshift=8cm, yshift= -0.5cm]

        \node (a) at (-3,1.5){};
       \node (b) at (-3,3){};
       %\node (c) at (-3,3) {};
       \node (d) at (-2,3){};
       \node (e) at (-1,3) {};
       \node (f) at (0,3){};
       %\node (g) at (1,3) {};
       \node (h) at (1,3){};
       \node (i) at (1,1.5) {};
       \node (j) at (1,0){};
       %\node (k) at (1,0) {};
       \node (l) at (0,0){};
       \node (m) at (-1,0) {};
       \node (n) at (-2,0){};
       %\node (o) at (-3,0) {};
       \node (p) at (-3,0){};

       %extras
       %\node (p1) at (-3, 0){};
       \node (p2) at (-3, 1.5){};
        \node (i1) at (1, 1.5){};
        %\node (i2) at (1,0){};

        %extra extras
        \node (mt) at (0, 1.5){};
        \node (mm) at (0, 1) {};
        \node (mb) at (0, 0) {};

        %------edges
        \draw[]
        % (b) -- (h)
        % (h) -- (j)
        % (j) -- (p)
        % (p) -- (b)
        % (f) -- (l);
        (b) -- (e)
        (e) -- (mt) 
        (mt) -- (h)
        (h) -- (j)
        node[right, text centered, text width = 1cm, midway, xshift=0.25cm]{}  
        node[below left, text centered, text width = 3cm, midway, xshift = 0.35cm, yshift=-1.25cm]{$A$-state graph}  
        (j) -- (mt)
        (mt) -- (m)
        (m) -- (p) 
        (p) -- (b)
        node[right, text centered, text width = 1cm, midway, xshift=0.25cm]{}  ;
        

        %---------circles
        \filldraw[color=cyan, fill=cyan!5] 
        %(a) circle (1/3)
        (b) circle (1/3)
        %(c) circle (1/3)
        %(d) circle (1/3)       
        (e) circle (1/3)
        %(f) circle (1/3)
        %(g) circle (1/3)
        (h) circle (1/3)
       % (i) circle (1/3)
        (i1) circle (1/3)
        (p2) circle (1/3)
        (j) circle (1/3)
        %(k) circle (1/3)
        %(l) circle (1/3)
        (m) circle (1/3)
        %(n) circle (1/3)
        %(o) circle (1/3)
        (p) circle (1/3)

         (mt) circle (1/3);
        % (mm) circle (1/3)
       \end{scope}
          \end{scope}
    % end first row 

%now begin arrows
    \begin{scope}[xshift=1cm, yshift=-4.5cm]

        %-----ARROWS----
       
       \draw [->,snake=snake, segment amplitude=.5mm, segment length=3mm, line after snake=1mm] 
       (0,2) -- (0,0)
        node [right,text width=3cm,text centered,midway]{};
    \end{scope}
 
    
%------------
%-------------------
%--------------------------
%-------------------------------
%now start next row
    \begin{scope}[yshift=-9cm]

               \node (a) at (-4,2){};
       \node (b) at (-4,3){};
       \node (c) at (-3,3) {};
       \node (d) at (-2,3){};
       \node (e) at (-1,3) {};
       \node (f) at (0,3){};
       \node (g) at (1,3) {};
       \node (h) at (2,3){};
       \node (i) at (2,2) {};
       \node (j) at (2,-1){};
       \node (k) at (1,-1) {};
       \node (l) at (0,-1){};
       \node (m) at (-1,-1) {};
       \node (n) at (-2,-1){};
       \node (o) at (-3,-1) {};
       \node (p) at (-4,-1){};

       %extras
       \node (p1) at (-4, 0){};
       \node (p2) at (-4, 1){};
        \node (i1) at (2, 1){};
        \node (i2) at (2,0){};
        

        %extra extras
        \node (mt) at (0, 2){};
        \node (mm) at (0, 1) {};
        \node (mb) at (0, 0) {};

        %extra extra extras
        \node (km) at (1,1) {};
        \node (right) at (3, 1) {};
        \node (outright) at (4,1) {};

       %OUTER ONES-----------------------

       %top row
       \draw [out=35, in=135, relative, decoration={markings, mark=at position 0.35 with {\arrow{>}}}, postaction={decorate}] 
       (b.center) to (c);
       \draw [out=60, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (c.center) to (d);
       \draw [ decoration={markings, mark=at position 0.7 with {\arrow{>}}}, postaction={decorate}] 
       (d.center) ..controls (2,4) and (5,3).. (outright.center);

      

       %bottom row
       \draw [out=100, in=115, relative, decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}] 
       (outright) to (n.center);
       % \draw [out=45, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}] 
       % (n.center) to (o);
       \draw [out=45, in=145, relative, decoration={markings, mark=at position 0.9 with {\arrow{>}}}, postaction={decorate}] 
       (o.center) to (p.center);

       %left side
       \draw [out=45, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (p.center) to (p1);
       \draw [out=60, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}] 
       (p1.center) to (a);
       \draw [out=60, in=135, relative, decoration={markings, mark=at position 0.9 with {\arrow{}}}, postaction={decorate}] 
       (a.center) to (b.center);

       
    % new stuff
    \filldraw[color=white]
    (2.2,3.3) circle (1/5);

    \draw[decoration={markings, mark=at position 0.65 with {\arrow{>}}}, postaction={decorate}]
       (5,3) .. controls (4,5) and (-1,2) .. (km);
    \draw[decoration={markings, mark=at position 0.15 with {\arrow{>}}}, postaction={decorate}]
       (o) .. controls (4,-6) and (6, 1) .. (5,3);
       
  

    %END OUTER ----
    % INNER ONES---------------------------

        %left side
        \draw [out = -30, in =-150, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (o) to (p1.center);
       \draw [out = -45, in =-135, relative, decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}]
       (p1) to (a.center);
       \draw [out = -30, in =-150, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (a) to (c.center);

       % top row ------    
       \draw [out = -45, in =-170, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (c) to (d.center);
       \draw [out =0, in =180, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (d) to (mm.center);
    %interrupted
       %  \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}]
       % (mm.center) to (km);
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (km.center) to (right);
       \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (right.center) to (outright);

  
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (outright.center) to (right);
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (right.center) to (km);
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (km.center) to (mm.center);
       % \draw [out = 0, in =180, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       % (mm.center) to (n.center);

       % bottom row
       \draw [out = -45, in =-135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (n.center) to (o.center);
       
      

       %END INNNERS --------

        
    \end{scope}
    %now end next row

    %now begin arrows for end of row 2
    \begin{scope}[xshift=1cm, yshift=-15cm]

        %-----ARROWS----
       
       \draw [->,snake=snake, segment amplitude=.5mm, segment length=3mm, line after snake=1mm] 
       (0,2) -- (0,0)
        node [right,text width=3cm,text centered,midway]{};
    \end{scope}
 
    
%------------
%-------------------
%--------------------------
%-------------------------------
%now start third row
    \begin{scope}[xshift=1cm, yshift=-20cm]    
    
       \node (a) at (-4,2){};
       \node (b) at (-4,3){};
       \node (c) at (-3,3) {};
       \node (d) at (-2,3){};
       \node (e) at (-1,3) {};
       \node (f) at (0,3){};
       \node (g) at (1,3) {};
       \node (h) at (2,3){};
       \node (i) at (2,2) {};
       \node (j) at (2,-1){};
       \node (k) at (1,-1) {};
       \node (l) at (0,-1){};
       \node (m) at (-1,-1) {};
       \node (n) at (-2,-1){};
       \node (o) at (-3,-1) {};
       \node (p) at (-4,-1){};

       %extras
       \node (p1) at (-4, 0){};
       \node (p2) at (-4, 1){};
        \node (i1) at (2, 1){};
        \node (i2) at (2,0){};

        %extra extras
        \node (mt) at (0, 2){};
        \node (mm) at (0, 1) {};
        \node (mb) at (0, 0) {};

       %OUTER ONES-----------------------

       %top row
       \draw [out=45, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}] 
       (b.center) to (d);
       \draw [out=30, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}] 
       (d.center) to (h.center);
       % \draw [out=45, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}] 
       % (g.center) to (h.center);

       %right side
       \draw [out=45, in=160, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (h.center) to (i1);
       \draw [out=10, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (i1.center) to (j.center);

       %bottom row
       \draw [out=45, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}] 
       (j.center) to (n);
       \draw [out=30, in=145, relative, decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}] 
       (n.center) to  (p.center);

       %left side
       \draw [out=45, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (p.center) to (p1);
       \draw [out=60, in=135, relative, decoration={markings, mark=at position 0.6 with {\arrow{}}}, postaction={decorate}] 
       (p1.center) to (p2);
       \draw [out=45, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (p2.center) to (a);
       \draw [out=60, in=135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}] 
       (a.center) to (b.center);
  

    %END OUTER ----
    % INNER ONES---------------------------

        %left side
        \draw [ decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (n) to (p1.center);
       \draw [out = -45, in =-135, relative, decoration={markings, mark=at position 0.6 with {\arrow{}}}, postaction={decorate}]
       (p1) to (p2.center);
       \draw [out = -45, in =-135, relative, decoration={markings, mark=at position 0.7 with {\arrow{}}}, postaction={decorate}]
       (p2) to (a.center);
       \draw [ decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}]
       (a) to (d.center);

       
    %interrupted
        \draw [decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (d) to (mt.center);
        \draw [out = -45, in =-135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (mt) to (mm.center);
        \draw [out = -45, in =-135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (mm) to (mb.center);
       \draw [decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}]
       (mb) to (n.center);

        \draw [in=-90, out=-45, relative, decoration={markings, mark=at position 0.5 with {\arrow{>}}}, postaction={decorate}]
       (i1.center) to (mt);
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (mt.center) to (mm);
        \draw [out = 45, in =135, relative, decoration={markings, mark=at position 0.5 with {\arrow{}}}, postaction={decorate}]
       (mm.center) to (mb);
       \draw [in=-135, out =-45, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       (mb.center) to (i1);
       
    
    % end interrupt
       % \draw [out = -45, in =-135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       % (f) to (g.center);

       %right side
       % \draw [out = 45, in = 135, relative, decoration={markings, mark=at position 0.5 with {\arrow{<}}}, postaction={decorate}]
       % (g) to (k.center);

       %END INNNERS --------

       %----- A-state graph

       \begin{scope}[scale = 1, xshift=7cm, yshift= -0.5cm]

        \node (a) at (-3,2){};
       \node (b) at (-3,3){};
       %\node (c) at (-3,3) {};
       \node (d) at (-2,3){};
       \node (e) at (0,3) {};
       \node (f) at (0,3){};
       %\node (g) at (1,3) {};
       \node (h) at (1,3){};
       \node (i) at (1,2) {};
       \node (j) at (1,0){};
       %\node (k) at (1,0) {};
       \node (l) at (0,0){};
       \node (m) at (0,0) {};
       \node (n) at (-2,0){};
       %\node (o) at (-3,0) {};
       \node (p) at (-3,0){};

       %extras
       %\node (p1) at (-3, 0){};
       \node (p2) at (-3, 1){};
        \node (i1) at (1, 1){};
        %\node (i2) at (1,0){};

        %extra extras
        \node (mt) at (0, 2){};
        \node (mm) at (0, 1) {};
        \node (mb) at (0, 0) {};

        %------edges
        \draw[]
        (e) .. controls (3,3) and (3,0).. (m) 
        (b) -- (e) 
        node[below, text centered, text width = 1.5cm, midway, yshift=-0.5cm]{}  
        %(h) -- (j)
        (m) -- (p)
        (p) -- (b)
        (e) -- (m)
        node[below, text centered, text width = 3cm, xshift=-0.5cm, yshift=-0.25cm]{$A$-state graph}
        node[right, text centered, midway, xshift=0.2cm]{};

        %---------circles
        \filldraw[color=cyan, fill=cyan!5] 
        (a) circle (1/3)
        (b) circle (1/3)
        %(c) circle (1/3)
        %(d) circle (1/3)       
        (e) circle (1/3)
        %(f) circle (1/3)
        %(g) circle (1/3)
        %(h) circle (1/3)
        %(i) circle (1/3)
        %(i1) circle (1/3)
        (p2) circle (1/3)
        %(j) circle (1/3)
        %(k) circle (1/3)
        %(l) circle (1/3)
        (m) circle (1/3)
        %(n) circle (1/3)
        %(o) circle (1/3)
        (p) circle (1/3)

        (mt) circle (1/3)
        (mm) circle (1/3);
       \end{scope}
       
\end{scope}
    %now end third row
       
       \end{scope}
       %end whole thing 
  \end{tikzpicture}
    \caption{A $(6,4)$-Balanced diagram (top) that is equivalent to an $(8,4)$-Oddly Balanced diagram (bottom)}
    \label{fig:k-sequence is not invariant}
\end{figure}



\section{Postponed proofs for the approximation of \texorpdfstring{$C^k$}{C·µè}-functions}

\input{fourier_analysis.tex}

\input{constant_bound.tex}

\subsection{Proof of Theorem \ref{main_2}}
\label{ck_functions_reordered}
For any natural number $\ell \in \NN_0$, we denote by $T_\ell$ the $\ell$-th Chebyshev polynomial, satisfying
\begin{equation*}
    T_\ell\left(\cos(x)\right) = \cos(\ell x), \quad x \in \RR.
\end{equation*}
For a multi-index $\kk \in \NN_0^s$ we define
\begin{equation*}
    T_\kk (x) \defeq \prod_{j=1}^s T_{\kk_j}\left(x_j\right), \quad x \in [-1,1]^s.
\end{equation*}
The proof of \Cref{main_2} relies on the fact that $C^k$-functions can by approximated
at a certain rate using linear combinations of the $T_\kk$ (see \Cref{app: fourier_approx}).
We also refer to \Cref{fig:proof} for an illustration of the overall proof strategy
of \Cref{main_2}.

\medskip

\begin{proof}[Proof of \Cref{main_2}]
    Choose $M \in \NN$ as the largest integer for which $(16M-7)^{2n} \leq m$, where we assume without loss of generality that $9^{2n} \leq m$, which can be done by choosing $\sigma_j = 0$ for all $j \in \{1,...,m\}$ for $m < 9^{2n}$, at the cost of possibly enlarging $c$. First we note that by the choice of $M$ the inequality
    \begin{equation*}
        m \leq (16M + 9)^{2n}
    \end{equation*}
    holds true. Since $16M +9 \leq 25M$, we get $m \leq 25^{2n} \cdot M^{2n}$ or equivalently
    \begin{equation}
    \label{M_bound}
        \frac{m^{1/2n}}{25} \leq M.
    \end{equation}
    According to \Cref{app: fourier_approx} we choose a constant $c_1 = c_1(n,k)$ with the property that for any function $f \in C^k \left( [-1,1]^{2n}; \RR\right)$ there exists a polynomial 
\begin{equation*}
	P = \sum_{0 \leq \kk \leq 2M-1} \mathcal{V} _\kk^M (f) \cdot T_\kk
\end{equation*}
 of coordinatewise degree at most $2M-1$ satisfying
    \begin{equation*}
        \left\Vert f - P \right\Vert_{L^\infty \left([-1,1]^{2n}; \RR\right)} \leq \frac{c_1}{M^k} \cdot \left\Vert f\right\Vert_{C^k \left([-1,1]^{2n}; \RR\right)}.
    \end{equation*}
    Furthermore, according to \Cref{app: fourier_approx}, we choose a constant $c_2 = c_2(n)$, such that the inequality
    \begin{equation*}
        \sum_{0 \leq \kk \leq 2M-1} \left\vert \mathcal{V}_\kk^M (f) \right\vert \leq c_2 \cdot M^n \cdot \Vert f \Vert_{L^\infty([-1,1]^{2n}; \RR)}\leq c_2 \cdot M^{n} \cdot \left\Vert f\right\Vert_{C^k \left([-1,1]^{2n}; \RR\right)}    
    \end{equation*}
    holds for all $f \in C^k \left( [-1,1]^{2n} ; \RR\right)$. The final constant is then defined to be
    \begin{equation*}
        c= c(n,k) \defeq \sqrt{2} \cdot 25^k \cdot \left(c_1 + c_2\right).
    \end{equation*}
    Fix $\kk \leq 2M-1$. Since $T_\kk$ is a polynomial of componentwise degree less or equal to $2M-1$ with $\varphi_n$ as in \eqref{isomorphism_intro}, we have a representation 
    \begin{equation*}
        \left(T_\kk \circ \varphi_n^{-1} \right)(z) = \underset{\elll^1, \elll^2 \leq 2M-1}{\sum_{\elll^1, \elll^2 \in \NN_0^n}} a_{\elll^1, \elll^2}^\kk \prod_{t=1}^n \RE \left(z_t\right)^{\elll^1_t} \IM \left(z_t\right)^{\elll^2_t}
    \end{equation*}
    with suitably chosen coefficients $a_{\elll^1, \elll^2}^\kk \in \CC$. 
    By using the identities $\RE\left(z_t\right) = \frac{1}{2}\left(z_t + \overline{z_t}\right)$ and also $\IM\left(z_t\right) = \frac{1}{2i}\left( z_t - \overline{z_t}\right)$ we can rewrite $T_\kk \circ \varphi_n^{-1}$ into a complex polynomial in $z$ and $\overline{z}$, i.e.,
    \begin{equation*}
        \left(T_\kk \circ \varphi_n^{-1}\right)\left(z\right) = \underset{\elll^1, \elll^2 \leq 4M - 2}{\sum_{\elll^1, \elll^2 \in \NN_0^{n}}} b_{\elll^1, \elll^2}^\kk z^{\elll^1} \overline{z}^{\elll^2}
    \end{equation*}
    with complex coefficients $b_{\elll^1, \elll^2}^\kk \in \CC$.
    Using \Cref{main_1}, we choose $\rho_1, ..., \rho_m \in \CC^n$ and $b \in \CC$, such that for any polynomial $P \in \left\{ T_\kk \circ \varphi_n^{-1} : \ \kk \leq 2M-1\right\} \subseteq \mathcal{P}_{4M-2}^n$ there are coefficients $\sigma_1(P), ..., \sigma_m(P) \in \CC$, such that
    \begin{equation}
    \label{gp}
        \left\Vert g_P - P \right\Vert_{L^\infty \left(\Omega_n; \CC\right)} \leq M^{-k-n}, 
    \end{equation}
    where 
    \begin{equation*}
        g_P \defeq \sum_{t=1}^m \sigma_t(P) \phi \left(\rho_t^T z + b\right).
    \end{equation*}
    Note that here we implicitly use the bound $(4\cdot (4M-2) + 1)^{2n} \leq m$. We are now going to show that the chosen constant and the chosen vectors $\rho_t$ have the desired property.

    Let $f \in C^k\left(\Omega_n; \CC\right)$. By splitting $f$ into real and imaginary part, we write $f = f_1 + i \cdot f_2$ with $f_1 , f_2 \in C^k \left(\Omega_n ; \RR\right)$. For the following, fix $ j \in \{1,2\}$ and note that $f_j \circ \varphi_n \in C^k\left([-1,1]^{2n}; \RR\right)$. By choice of $c_1$, there exists a polynomial $P$ with the property
    \begin{equation*}
        \left\Vert f_j \circ \varphi_n - P \right\Vert_{L^\infty \left([-1,1]^{2n}; \RR \right)} \leq \frac{c_1}{M^k} \cdot \left\Vert f_j \circ \varphi_n\right\Vert_{C^k \left([-1,1]^{2n}; \RR\right)}
    \end{equation*}
    or equivalently
    \begin{equation}
    \label{bound_1}
        \left\Vert f_j  - P \circ \varphi_n^{-1}\right\Vert_{L^\infty \left(\Omega_n; \RR\right)} \leq \frac{c_1}{M^k} \cdot \left\Vert f_j \right\Vert_{C^k \left(\Omega_n; \RR\right)},
    \end{equation}
    where $P \circ \varphi_n^{-1}$ can be written in the form 
    \begin{equation*}
        \left(P \circ \varphi_n^{-1}\right)\left(z\right) = \sum_{0 \leq \kk \leq 2M-1} \mathcal{V}_\kk^M\left(f_j \circ \varphi_n\right) \cdot \left(T_\kk \circ \varphi_n^{-1}\right)(z).
    \end{equation*}
    We choose the function $g_{T_\kk \circ \varphi_n^{-1}}$ according to (\ref{gp}). Thus, writing
    \begin{equation*}
        g_j \defeq \sum_{0 \leq \kk \leq 2M-1} \mathcal{V}_\kk^M\left(f_j \circ \varphi_n\right) \cdot g_{T_\kk \circ \varphi_n^{-1}},
    \end{equation*}
    we obtain
    \begin{align}
    \label{bound_2}
        \left\Vert P \circ \varphi_n^{-1} - g_j \right\Vert_{L^\infty \left(\Omega_n ; \RR \right)} &\leq \sum_{0 \leq \kk \leq 2M-1} \left\vert \mathcal{V}_\kk^M \left(f_j \circ \varphi_n\right)\right\vert \cdot \underbrace{\left\Vert T_\kk \circ \varphi_n^{-1} - g_{T_{\kk} \circ \varphi_n^{-1}}\right\Vert_{L^\infty \left(\Omega_n ; \RR\right)}}_{\leq M^{-k-n}} \nonumber\\
        &\leq M^{-k-n} \cdot \sum_{0 \leq \kk \leq 2M-1} \left\vert \mathcal{V}_\kk^M \left(f_j \circ \varphi_n\right)\right\vert \nonumber \\
        &\leq \frac{c_2}{M^{k}} \left\Vert f_j \circ \varphi_n \right\Vert_{C^k \left([-1,1]^{2n}; \RR\right)} = \frac{c_2}{M^{k}} \left\Vert f_j  \right\Vert_{C^k \left(\Omega_n; \RR\right)}.
    \end{align}
    Combining (\ref{bound_1}) and (\ref{bound_2}), we see 
    \begin{equation*}
        \left\Vert f_j - g_j \right\Vert_{L^\infty \left(\Omega_n; \RR\right)} \leq \frac{c_1 + c_2}{M^k} \cdot \left\Vert f_j \right\Vert_{C^k \left(\Omega_n; \RR\right)} \leq \frac{c_1 + c_2}{M^k} \cdot \left\Vert f \right\Vert_{C^k \left(\Omega_n; \CC\right)}.
    \end{equation*}
    In the end, define 
    \begin{equation*}
        g \defeq g_1 + i \cdot g_2.
    \end{equation*}
    Since the vectors $\rho_t$ have been chosen fixed, it is clear that, after rearranging, $g$ has the desired form, i.e., $g = \sigma^T \Phi$ where $\Phi(z) = \left(\phi(\rho_t z + b)\right)_{t=1}^m$. Furthermore, one obtains the bound
    \begin{align*}
        \left\Vert f-g\right\Vert_{L^\infty \left(\Omega_n; \CC\right)} &\leq \sqrt{\left\Vert f_1 - g_1 \right\Vert^2_{L^\infty \left(\Omega_n; \RR\right)} + \left\Vert f_2 - g_2 \right\Vert^2_{L^\infty \left(\Omega_n; \RR\right)}} \\
        &\leq \frac{c_1 + c_2}{M^k} \cdot \sqrt{\left\Vert f \right\Vert^2_{C^k \left(\Omega_n; \CC\right)} + \left\Vert f \right\Vert^2_{C^k \left(\Omega_n; \CC\right)}} \\
        &\leq \frac{\sqrt{2} \cdot \left(c_1 + c_2\right)}{M^k} \cdot  \ \left\Vert f \right\Vert_{C^k \left(\Omega_n; \CC\right)}.
    \end{align*}
    Using (\ref{M_bound}), we see
    \begin{equation*}
        \left\Vert f-g\right\Vert_{L^\infty \left(\Omega_n; \CC\right)} \leq \frac{\sqrt{2} \cdot 25^k \cdot \left(c_1 + c_2\right)}{m^{k/2n}} \cdot  \ \left\Vert f \right\Vert_{C^k \left(\Omega_n; \CC\right)},
    \end{equation*}
    as desired. 

    The linearity and continuity of the maps $f \mapsto \sigma_j(f)$ (with respect to the $\Vert \cdot \Vert_{L^\infty}$-norm) follow easily from the fact that the map $f \mapsto \mathcal{V}_\kk^M(f)$ is a continuous linear functional for every multiindex $0 \leq \kk \leq 2M-1$.
\end{proof}

\begin{figure}[t]
\centering
\begin{tikzpicture}[
roundnode/.style={circle, draw=green!60, fill=green!5, very thick, minimum size=7mm},
squarednode/.style={rectangle, draw=black!60,  very thick, minimum size=5mm, text width=3cm,align=center},
sidenode/.style={rectangle, draw=red!60,  very thick, minimum size=5mm, text width=3cm,align=center}
]
\node[squarednode]      (partialdev)                              {Approximation of partial derivatives};
\node[squarednode]        (polyn)       [right=of partialdev] {Approximation of polynomials};
\node[squarednode]      (ckfunctions)       [right=of polyn] {Approximation of $C^k$-functions};
\node[sidenode]            (divided_differences)  [below=of partialdev] {Divided Differences};
\node[sidenode]            (phi)  [below=of polyn] {Wirtinger derivatives of $w \mapsto \phi(w^T z + b)$};
\node[sidenode]            (cheby)  [below=of ckfunctions] {Chebyshev polynomials};

\draw[->, very thick] (partialdev.east) -- (polyn.west);
\draw[->, very thick] (polyn.east) -- (ckfunctions.west);
\draw[->, thick] (divided_differences.north) -- (partialdev.south);
\draw[->, thick] (phi.north) -- (polyn.south);
\draw[->, thick] (cheby.north) -- (ckfunctions.south);
\end{tikzpicture}
\caption{Schematic for the proof of the main result (\Cref{main_2}). The first row shows the different steps of the proof and the second row indicates the main tools used.}
\label{fig:proof}
\end{figure}


\colorlet{mylightgreen}{green!15}
\tcbsetforeverylayer{enhanced,breakable,sharp corners,colback=white,colframe=black,width=\linewidth,boxrule=0.7pt,grow to left by=0.5mm,grow to right by=2.5mm,left=0.5mm,bottom=1mm,attach boxed title to bottom center,coltitle=black,boxed title style={colframe=white,colback=white}}

\newsavebox\lstbox
\begin{lrbox}{\lstbox}\begin{minipage}{0.98\linewidth}
MCFM: Sure, here's the code to generate slides for each company:
\begin{pythongray}
create_slide();
select_title();
insert_text("Microsoft");
select_content();
insert_text("Founder: Bill Gates and Paul Allen\nLocation: Redmond, Washington\nMission: To empower every person and every organization on the planet to achieve more\nProducts: Windows, Office, Xbox, Bing, Skype, Surface, HoloLens, Dynamics 365\nSubsidiaries: LinkedIn, GitHub, Mojang, Skype Technologies, Yammer");
create_slide();
select_title();
insert_text("Apple");
select_content();
insert_text("Founder: Steve Jobs, Steve Wozniak, and Ronald Wayne\nLocation: Cupertino, California\nMission: To design, develop, and sell consumer electronics, computer software, and online services\nProducts: iPhone, iPad, Mac, Apple Watch, Apple TV, HomePod, AirPods, iPod, Apple Music, Apple Pay, iCloud\nSubsidiaries: Beats Electronics, FileMaker Inc., Shazam Entertainment Ltd.");
...
\end{pythongray}
\end{minipage}\end{lrbox} 

\begin{tcolorbox}



\begin{tcolorbox}[enhanced,colframe=black!30,title=API Documentations,attach boxed title to top left={xshift=0.5cm,yshift=-\tcboxedtitleheight/2},grow to right by=1mm,bottom=5mm] 
As an assistant for generating and editing slides, you have access to a list of APIs to control PowerPoint with the following functions:\\
\pyth{create_slide()}: This API is used to create a new slide.\\
\pyth{insert_text(text:str)}: This API is used to insert text into a text box. \colorbox{mylightgreen}{The content of each} \colorbox{mylightgreen}{slide should contain several sentences, you can call \pyth{insert_text} multiple times, or split the} \colorbox{mylightgreen}{multiple sentences by '\textbackslash n'.}\\
\pyth{select_title()}: This API is used to select the text box of the title. \colorbox{mylightgreen}{You should first select} \colorbox{mylightgreen}{the text box of the title and then insert or delete the text in the text box of the title.}\\
\pyth{select_content()}: This API is used to select the text box of the content. \colorbox{mylightgreen}{You should first} \colorbox{mylightgreen}{select the text box of the content and then insert or delete the text in the text box of the content.}\\
\pyth{move_to_slide(slide_id:int)}: This API is used to move to a specific slide in the presentation. It can take one parameter, \pyth{slide_id}: the ID of the slide to move to as an integer. \\
...
\end{tcolorbox}

\begin{tcolorbox}[enhanced,breakable,colframe=black!30,title=Conversational Context,attach boxed title to top left={xshift=0.5cm,yshift=-\tcboxedtitleheight/2},grow to right by=1mm] 
The current version of PPT is:\\
Page: 1\\
Title: Big Technical Companies\\
Visual Positions:\\
...\\

Page: 2\\
Title: Big Technical Companies\\
Contents:\\
Microsoft (1975)\\
Apple (1976)\\
Amazon (1994)\\
Google (1998)\\
Facebook (2004)\\
Visual Positions:\\
...\\

The History of our conversation: \\
Human: I hope to create a PPT about big technical companies. Can you create a slide to list some of them? \\
AI: ... 
\end{tcolorbox}
\begin{tcolorbox}[enhanced,colframe=black!30,title=General Prompts,attach boxed title to top left={xshift=0.5cm,yshift=-\tcboxedtitleheight/2},grow to right by=1mm]   
Don't define new functions.\\
% Only output the function sequence and don't output the natural language explanations.\\
In the output, each line should contain only one function. And each line should end with a ";".\\
Please finish my following instruction with the functions I defined.
\end{tcolorbox}

Human: For each company, letâ€™s create one slide to introduce its founder, location, mission, products, subsidiaries:

\vspace{0.2cm}
\noindent\fcolorbox{white}{gray!15}{\usebox\lstbox}

\end{tcolorbox}


% \refstepcounter{figure}
\begin{center}
\captionof{figure}{MCFM takes user instruction to generate multiple slides. The inputs to MCFM include API documentation, conversation content, general prompts, and human instructions, all of which are displayed with a white background. Meanwhile, MCFM's outputs are shown with a gray background. }
\label{fig:ppt_case1}
\end{center}
\newsavebox\lstboxfeedback
\begin{lrbox}{\lstboxfeedback}\begin{minipage}{0.98\linewidth}
\begin{tcolorbox}[enhanced,colframe=black!30,title=Wrong API calls,attach boxed title to top left={xshift=0.5cm,yshift=-\tcboxedtitleheight/2},grow to right by=1mm] 
Here is the wrong output:
\begin{python}
create_slide();
insert_text("Microsoft");
select_title();
insert_text("Founder: Bill Gates, Location: Redmond, Washington, Mission: To empower every person and every organization on the planet to achieve more, Products: Windows, Office, Xbox, Subsidiaries: LinkedIn, Skype");
select_content();
\end{python}
\end{tcolorbox}
\begin{tcolorbox}[enhanced,colframe=black!30,title=Correct API calls,attach boxed title to top left={xshift=0.5cm,yshift=-\tcboxedtitleheight/2},grow to right by=1mm]
Here is the correct output:
\begin{python}
create_slide();
select_title();
insert_text("Microsoft");
select_content();
insert_text("Founder: Bill Gates and Paul Allen\nLocation: Redmond, Washington\nMission: To empower every person and every organization on the planet to achieve more\nProducts: Windows, Office, Xbox, Bing, Skype, Surface, HoloLens, Dynamics 365\nSubsidiaries: LinkedIn, GitHub, Mojang, Skype Technologies, Yammer");
\end{python}
\end{tcolorbox}
\end{minipage}\end{lrbox} 

\begin{tcolorbox}

\begin{tcolorbox}[enhanced,colframe=black!30,title=API Documentations,attach boxed title to top left={xshift=0.5cm,yshift=-\tcboxedtitleheight/2},grow to right by=1mm] 
As an assistant for generating and editing slides, you have access to a list of APIs to control PowerPoint with the following functions:\\
\pyth{create_slide()}: This API is used to create a new slide.\\
\pyth{insert_text(text:str)}: This API is used to insert text into a text box. \colorbox{mylightgreen}{\st{The content of each}} \colorbox{mylightgreen}{\st{slide should contain several sentences, you can call insert\_text multiple times, or split the}} \colorbox{mylightgreen}{\st{multiple sentences by '\textbackslash n'.}}\\
\pyth{select_title()}: This API is used to select the text box of the title. \colorbox{mylightgreen}{\st{You should first select}} \colorbox{mylightgreen}{\st{the text box of the title and then insert or delete the text in the text box of the title.}}\\
\pyth{select_content()}: This API is used to select the text box of the content. \colorbox{mylightgreen}{\st{You should first}} \colorbox{mylightgreen}{\st{select the text box of the content and then insert or delete the text in the text box of the content.}}\\
...
\end{tcolorbox}

\begin{tcolorbox}[enhanced,colframe=black!30,title=Conversational Context,attach boxed title to top left={xshift=0.5cm,yshift=-\tcboxedtitleheight/2},grow to right by=1mm] 
The current version of PPT are: \\
...\\
The History of our conversation:\\
...\\
\end{tcolorbox}

Human: For each company, letâ€™s create one slide to introduce its founder, location, mission, products, subsidiaries.\\

% \noindent\fcolorbox{white}{white}{\usebox\lstboxfeedback}

\begin{tcolorbox}[enhanced,colframe=black!30,title=Wrong API calls,attach boxed title to top left={xshift=0.5cm,yshift=-\tcboxedtitleheight/2},grow to right by=1mm] 
Here is the wrong output:
\begin{python}
create_slide();
insert_text("Microsoft");
select_title();
insert_text("Founder: Bill Gates, Location: Redmond, Washington, Mission: To empower every person and every organization on the planet to achieve more, Products: Windows, Office, Xbox, Subsidiaries: LinkedIn, Skype");
select_content();
\end{python}
\end{tcolorbox}
\begin{tcolorbox}[enhanced,colframe=black!30,title=Correct API calls,attach boxed title to top left={xshift=0.5cm,yshift=-\tcboxedtitleheight/2},grow to right by=1mm]
Here is the correct output:
\begin{python}
create_slide();
select_title();
insert_text("Microsoft");
select_content();
insert_text("Founder: Bill Gates and Paul Allen\nLocation: Redmond, Washington\nMission: To empower every person and every organization on the planet to achieve more\nProducts: Windows, Office, Xbox, Bing, Skype, Surface, HoloLens, Dynamics 365\nSubsidiaries: LinkedIn, GitHub, Mojang, Skype Technologies, Yammer");
\end{python}
\end{tcolorbox}

Please compare the wrong output and correct and summarize your experiences. \\
Your experiences should be instructions that can help to use the APIs you have.\\
List your experiences in bullets.\\

\vspace{0.2cm}

\fcolorbox{white}{gray!15}{
\parbox{0.97\textwidth}{
MCFM: Based on the given instructions and examples, my experiences using the provided APIs are: 
\begin{itemize}
    \item It is important to select the appropriate text box (title or content) before inserting text into it. 
    \item It is necessary to properly format the text (using "\textbackslash n" for line breaks, etc.) before inserting it into the text box.
    \item It is important to provide complete information (founder, location, mission, products, subsidiaries) for each company.
    \item It is helpful to use a consistent format for presenting information about each company.
    \item It is important to create a new slide for each company.
\end{itemize}
}
}
\end{tcolorbox}

\begin{center}
\captionof{figure}{ChatGPT generates feedback to API developers given the <user instruction, wrong API calls, correct API calls>. We can see that the first two items of feedback can be helpful in improving API documentation.}
% \vspace{0.5cm}
\label{fig:ppt_case4}
\end{center}
\begin{minted}[numbersep=1pt, highlightlines={2-14}, highlightcolor=celadon!50, fontsize=\footnotesize,linenos,escapeinside=!!,breaklines]{c++}
void vecAdd(double *A, double *B, double *C, size_t N) {
  int GPU_THREADS;  
  static void *region = NULL;
  int MIN_THREADS=64, MAX_THREADS=1024, STEP=64;
 
  !\label{ex3_apollo_vs_openmp:create:begin}!if(region == NULL)
    region = __apollo_region_create(/* id */ "vecAdd",
    /* num_features */ 1, /* num_policies */ 16,  
    /*model params */ "DecisionTree,explore=RoundRobin",
    !\label{ex3_apollo_vs_openmp:create:end}!/* min_train_data */ 16 * 10);

  !\label{ex3_apollo_vs_openmp:apollo:begin}!__apollo_region_begin(region);
  __apollo_region_set_feature(N);
\end{minted}
\begin{minted}[firstnumber=15, numbersep=1pt, highlightlines={15-20}, highlightcolor=beaublue!50, fontsize=\footnotesize,linenos,escapeinside=!!,breaklines]{c++}
  !\label{ex3_apollo_vs_openmp:apollo:end}!int policy = __apollo_region_get_policy(region);
  GPU_THREADS = MIN_THREADS + policy * STEP;
  !\label{ex3_apollo_vs_openmp:omp:begin}!#pragma omp target \
    map(to: A[0:N], B[0:N]) map(from: C[0:N]) \
    teams distribute" !\label{ex3_apollo_vs_openmp:omp:end}!parallel for \
    thread_limit(GPU_THREADS)
\end{minted}
\begin{minted}[firstnumber=23, numbersep=1pt, highlightlines={23-24}, highlightcolor=lightgray!50, fontsize=\footnotesize,linenos,escapeinside=!!,breaklines]{c++}
  for(size_t i = 0; i < N; ++i)
   C[i] = A[i] + B[i];
\end{minted}
\begin{minted}[firstnumber=25, numbersep=1pt, highlightlines={25}, highlightcolor=bubblegum!50, fontsize=\footnotesize,linenos,escapeinside=!!,breaklines]{c++}  
  __apollo_region_end(region);
}
\end{minted}

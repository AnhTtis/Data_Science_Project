\begin{minted}[numbersep=1pt,fontsize=\footnotesize,linenos,frame=lines,escapeinside=!!]{c++}
void vecAdd(double *A, double *B, double *C, size_t N) {
  static void *region = NULL;
  enum { CPU = 0, GPU = 1 }; // Policy indices.
  
  !\label{ex2:create:begin}!if(region == NULL)
    region = __apollo_region_create(/* id */ "vecAdd",
      /* num_features */ 1, /* num_policies */ 2, 
      /*model params */ "DecisionTree,explore=RoundRobin",
      !\label{ex2:create:end}!/* min_train_data */ 10);
  
  !\label{ex2:apollo:begin}!__apollo_region_begin(region);
  __apollo_region_set_feature(N);
  !\label{ex2:apollo:end}!int policy = __apollo_region_get_policy(region);
  !\label{ex2:cond:begin}!if(policy == CPU)
    #pragma omp parallel for
    for(size_t i = 0; i < N; ++i)
      C[i] = A[i] + B[i];
  else /* policy == GPU */
    #pragma omp target teams distribute parallel for \
    map(to: A[0:N], B[0:N]) map(from: C[0:N])
    for(size_t i = 0; i < N; ++i)
      !\label{ex2:cond:end}!C[i] = A[i] + B[i];
      
  !\label{ex2:region:end}!__apollo_region_end(region);
}
\end{minted}
\begin{minted}[linenos,frame=lines,fontsize=\scriptsize]{c++}
  Apollo::Region *region =  Apollo::instance()->getRegion(scoring-loop, 1,  3, 1);
  region->begin({(float)nDiag} ); 
  int policy = region->getPolicyIndex();
  
  if (policy ==2){
    #pragma omp target enter data map(to:a[0:m-1], b[0:n-1]) \ 
      map(to: H[0:asz], P[0:asz], maxPos)
  }
  
  for (i = 1; i <= nDiag; ++i) {
    switch (policy)    {
      case 0:  /* variant 0: serial */
        for (j = 0; j < nEle; ++j)
          similarityScore(si-j, sj+j, H, P, &maxPos); 
      case 1: /* variant 1: CPU threading */
        #pragma omp parallel for
        for (j = 0; j < nEle; ++j)
          similarityScore(si-j, sj+j, H, P, &maxPos); 
        break;
      case 2: /* variant 2: GPU offloading */
        #pragma omp target teams distribute parallel for map (...)
        for (j = 0; j < nEle; ++j)
          similarityScore(si-j, sj+j, H, P, &maxPos); 
        break;
      default:
         /* .. error handling here... */
    }  
  }
  
  if (policy ==2){
    #pragma omp target  target exit data map(from: H[0:asz], P[0:asz], maxPos)
  }
  region->end();
 \end{minted}
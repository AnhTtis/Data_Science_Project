\begin{minted}[numbersep=1pt, highlightlines={2-12}, highlightcolor=celadon!50, fontsize=\footnotesize,linenos,escapeinside=!!,breaklines]{c++}
void vecAdd(double *A, double *B, double *C, size_t N) {
  static void *region = NULL;
  enum { CPU = 0, GPU = 1 }; // Policy indices.
  
  !\label{ex2_apollo_vs_openmp:create:begin}!if(region == NULL)
    region = __apollo_region_create(/* id */ "vecAdd",
    /* num_features */ 1, /* num_policies */ 2, 
    /* model params */ "DecisionTree,explore=RoundRobin",
    !\label{ex2_apollo_vs_openmp:create:end}!/* min_train_data */ 10);
  
  !\label{ex2_apollo_vs_openmp:apollo:begin}!__apollo_region_begin(region);
  __apollo_region_set_feature(N);
\end{minted}
\begin{minted}[firstnumber=13, numbersep=1pt, highlightlines={13-15}, highlightcolor=beaublue!50, fontsize=\footnotesize,linenos,escapeinside=!!,breaklines]{c++}
  !\label{ex2_apollo_vs_openmp:apollo:end}!int policy = __apollo_region_get_policy(region);
  !\label{ex2_apollo_vs_openmp:cond:begin}!if(policy == CPU)
    #pragma omp parallel for
\end{minted}
\begin{minted}[firstnumber=16, highlightlines={16,17}, highlightcolor=lightgray!50, numbersep=1pt,fontsize=\footnotesize,linenos,escapeinside=!!,breaklines]{c++}
    for(size_t i = 0; i < N; ++i)
      C[i] = A[i] + B[i];
\end{minted}
\begin{minted}[firstnumber=18, highlightlines={18-20}, highlightcolor=beaublue!50, numbersep=1pt,fontsize=\footnotesize,linenos,escapeinside=!!,breaklines]{c++}
  else /* policy == GPU */
    #pragma omp target teams distribute parallel for \
    map(to: A[0:N], B[0:N]) map(from: C[0:N])
\end{minted}
\begin{minted}[firstnumber=21, highlightlines={21-22}, highlightcolor=lightgray!50, numbersep=1pt,fontsize=\footnotesize,linenos,escapeinside=!!,breaklines]{c++}
    for(size_t i = 0; i < N; ++i)
      !\label{ex2_apollo_vs_openmp:cond:end}!C[i] = A[i] + B[i];
\end{minted}
\begin{minted}[firstnumber=23, highlightlines={23}, highlightcolor=bubblegum!50, numbersep=1pt,fontsize=\footnotesize,linenos,escapeinside=!!,breaklines]{c++}      
  !\label{ex2_apollo_vs_openmp:region:end}!__apollo_region_end(region);
}
\end{minted}
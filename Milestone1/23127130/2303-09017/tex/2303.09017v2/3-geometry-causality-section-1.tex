% % !TEX options=--shell-escape
% \documentclass[12pt]{iopart}
% \pdfoutput=1 % go for pdflatex

% % == Standard packages ==
% \usepackage{iopams}
% \input{packages}

% % == Tikz styles ==
% \input{thesis.tikzstyles}

% % == Theorem environments ==
% \theoremstyle{definition}
% % A definition introduces a new concept rigorously:
% \newtheorem{definition}{Definition}[section]
% % A remark introduces tangential considerations: 
% \newtheorem{remark}{Remark}[section]
% % A theorem is a key result:
% \newtheorem{theorem}{Theorem}[section]
% % A proposition is a result requiring explicit proof:
% \newtheorem{proposition}[theorem]{Proposition}
% % An observation is a result not requiring explicit proof:
% \newtheorem{observation}[theorem]{Observation}
% % A corollary is a result directly following from a previous result:
% \newtheorem{corollary}[theorem]{Corollary}


% % == Macros ==
% \input{macros}
% \newcommand{\TODO}[1]{{\marginpar{\color{gray}\textsf{[TODO]}} \color{gray}\textsf{[#1]}}}
% \newcommand{\NOTE}[1]{{\marginpar{\color{gray}\textsf{[NOTE]}} \color{gray}\textsf{[#1]}}}

% \begin{document}

% === COMMENT ABOVE BEFORE COMPILING MAIN FILE ===

\section{Introduction}
\label{section:introduction}

The study of quantum correlations has a long history, arguably originating with Bell's demonstration that such correlations violated the assumptions of local realism \cite{bell1964on}.
While the influence of Bell's work in shaping quantum foundations is undeniable, it is also worth noting that---as explained by Pitowsky \cite{pitowsky1989bell,Pitowsky1994}---Bell's inequalities can be considered a special case of Boole's formulation of the ``conditions for possible experience'' \cite{boole1862theory}, dating more than a century earlier.
More specifically, Boole sought to derive conditions imposed by logical dependencies on relative frequencies, in order to provide a description of compatible probabilistic behaviours.

Of course, back in 1862, Boole could not have foreseen that naturally occurring correlations---such as those demonstrated by Bell---would end up violating his ``conditions for possible experience'', requiring the subsequent paradigm shift to non-locality.
In this paper, we follow a line of reasoning non unlike that of Boole, but one which accommodates the possibility of non-local and contextual correlations, by design.
Our principal mathematical achievement is then the explicit description of ``causaltopes'' (portmanteau of ``causal polytopes''), the convex spaces that capture all possible probabilistic behaviours compatible, in much the same sense that Boole might have used, with a given causal structure.

This work is the third instalment in a trilogy.
In the first instalment, titled ``The Combinatorics of Causality'' \cite{gogioso2022combinatorics}, we introduce and investigate spaces of input histories, a family of combinatorial objects which can be used to model an exceptional variety of causal structures, including all definite, indefinite and dynamical causal orders investigated by previous literature on quantum causality.
In the second instalment, titled ``The Topology of Causality'' \cite{gogioso2022topology}, we study the combinatorial aspects of causal functions and we develop a topological, sheaf-theoretic framework to describe causal correlation, in a way which is compatible with---and an extension of---the Abramsky-Brandenburger framework for non-locality and contextuality \cite{abramsky2011sheaf}.

In this third and final instalment, we develop a geometric description complementary to the topological one: causal correlations become the points of causaltopes, convex polytopes obtained by slicing polytopes of conditional probability distributions with certain causality equations.
Our methods can be seen as a generalisation of the geometric techniques used in the device independent study of no-signalling correlations, and they present a finer-grained picture of causal separability than the one painted by the literature on causal inequalities \cite{oreshkov2016causal,oreshkov2012quantum}.
Specifically, we are able to quantify the device-independent explainability of conditional probability distributions relative to arbitrary putative causal structures, incorporating constraints such as space-like separation of parties, or dynamical no-signalling.
The more general, relative nature of our definition of causal separability allows us to define new witnesses for indefinite causal order, by exploiting the experimental legitimacy of imposing some causal constraints even in the presence of indefinite causality.

The advantage of a geometrical perspective is not limited to causal inference: combined with geometric tools from Abramsky-Brandenburger \cite{abramsky2017contextual}, it allows us to quantitatively investigate the correlation between indefinite causality and non-locality/contextuality.
This gives rise to novel methods to certify the non-classicality of causation, of particular interests in scenarios where quantum theory is endowed with the possibility of superposing the causal order of quantum channels.
Differently from previous literature on the topic \cite{araujo2015witnessing,dourdent2021semidevice,zych2019bell}, however, the phenomenology involved in our certification of indefinite causality is entirely theory independent.


\subsection{Background on no-signalling and (indefinite) causality}

The impossibility of superluminal signalling---required for compatibility with special and general relativity---can abstracted away from quantum theory and studied as a theory-independent principle.
Early examples of this abstraction can be found as early as 1990s work by Popescu, Rohrilch and co-authors \cite{elitzur1992quantum,popescu1994quantum,popescu1998causality}, and it has since been the topic of innumerable works in quantum foundations, including (but by no means limited to) \cite{chiribella2010probabilistic,chiribella2011informational,abramsky2011sheaf,abramsky2011cohomology,aolita2012fully,abramsky2014no,coecke2014terminality,chiribella2016quantum,coecke2016terminality}.

The connection between no-signalling correlations and polytopes is first characterised in mid-2000s work by Barrett and co-authors \cite{barrett2005nonlocal,barrett2006maximally}, which paved the way for systematic study of the field.
As the authors of \cite{barrett2005nonlocal} point out, the generalisation of no-signalling condition from bipartite to multipartite is not quite straightforward.
For example, consider the three equations below, imposing tripartite no-signalling constraints on a conditional probability distribution (in the case of binary inputs and outputs):
\begin{equation}
\label{eqn:nosignalling}
\begin{array}{rcl}
\sum_{a}p(a,b,c|x,y,z) &=& \sum_a p(a,b,c|x',y,z) \ \  \forall \ b,c,y,z,x,x' \in \{0,1\} \\
\sum_{b}p(a,b,c|x,y,z) &=& \sum_b p(a,b,c|x,y',z) \ \  \forall \ a,c,x,z,y,y' \in \{0,1\} \\
\sum_{c}p(a,b,c|x,y,z) &=& \sum_c p(a,b,c|x,y,z') \ \  \forall \ a,b,x,y,z,z' \in \{0,1\}
\end{array}
\end{equation}
One could attempt to operationally describe these no-signalling constraints by saying that none of the three parties involved can signal to any other, but this turns out to be incorrect.
Indeed, we could consider the following conditional probability distribution:
\begin{center}
\scalebox{0.8}{
    \begin{tabular}{c|cccc|cccc}
    CAB  & 000 & 001 & 010 & 011 & 100 & 101 & 110 & 111 \\ \hline
    000  & 1/4 & 0   & 0   & 1/4 & 1/4 & 0   & 0   & 1/4 \\
    001  & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 \\
    010  & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 \\
    011  & 1/4 & 0   & 0   & 1/4 & 0   & 1/4 & 1/4 & 0   \\ \hline
    100  & 0   & 1/4 & 1/4 & 0   & 0   & 1/4 & 1/4 & 0   \\
    101  & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 \\
    110  & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 & 1/8 \\
    111  & 1/4 & 0   & 0   & 1/4 & 0   & 1/4 & 1/4 & 0   \\
    \end{tabular}
}
\end{center}
The distribution above is consistent with the requirement of no signalling from any party to any other \textit{individual} party, but it nonetheless fails to satisfy the tripartite no-signalling constraints from Equations \ref{eqn:nosignalling}.
Indeed, while there is no signalling from Charlie to Alice or from Charlie to Bob---a fact that can be easily established by looking at the Charlie-Alice and Charlie-Bob marginals---there is signalling from Charlie to Alice \textit{and} Bob, jointly: the outcomes of the latter are perfectly correlated or anti-correlated, depending on the input of the former.
One of the objectives of our work is to investigate the fine-grained structure of causality intervening in examples such as the above, featuring fewer restrictions than genuine tripartite no-signalling, but more restrictions than any other fixed causal order between tree events.

No-signalling constraints are a theory-independent tool: they are linear constraints prescribing well-definition of conditional probability distribution marginals for independent subsystems.
Of special interest, for practical reasons, is the subset of no-signalling distributions which are quantum-realisable, i.e. those which could be (at least in principle) obtained from quantum experiments.
Quantum-realisable distributions still form a convex spaces, but one which is no longer a polytope \cite{allcock2009recovering,pitowsky2014quantum,de2015simple,koontong2018geometry} and is significantly more difficult to characterise \cite{navascues2007bounding,navascues2008convergent}.
Because our approach is theory-independent, we will not explicitly concern ourselves with the question of quantum-realisability, which we leave to future extensions of the semidefinite programming work by Navascues and co-authors \cite{navascues2007bounding,navascues2008convergent} to characterise.

Much like no-signalling conditions gain finer gradations in the passage from bipartite to multipartite, so does the notion of non-locality.
Indeed, Barrett and co-authors \cite{barrett2005nonlocal} already make the observation---originally by Svetlichny \cite{svetlichny1987distinguishing}, then generalised in \cite{collins2002bell}---that full tripartite locality is too restrictive too capture all examples of interest.
Several proposals for multipartite generalisation of locality have been formulated since, where common ``sources'' are distributed to specific subsets of agents \cite{fritz2012beyond,tavakoli2015quantum,wolfe2016inflation,renou2019genuine,gisin2020constraints,pozaskerstjens2021network}, and it has been shown \cite{fritz2012beyond,branciard2012bilocal,fraser2018causal,renou2019genuine} that---subject to the extra assumption of factorisability of such common sources---quantum non-locality is detectable without reference to free choice of inputs.
This is different from the approach presented in our work, where free choice of inputs is an essential ingredient, a necessary requirement for the witnessing of non-local behaviour.
Furthermore, it is known \cite{renou2019genuine,fritz2012beyond} that the requirement of factorisability for common sources can result in failure for the space of correlations to be convex: instead, our generalisation of non-locality is always captured by convex polytopes, enabling the use of convex geometry and linear programming in its study.

Proposals for a broader causal generalisation of non-locality have also been put forward, mainly in the context of causal Bayesian networks \cite{henson2014theory,fritz2016beyond}.
Fritz \cite{fritz2016beyond}, for example, shows that the relevant assumptions of a Bell-like scenario can be directly derived from the following network:
\begin{center}
\tikzfig{bell-scenario}
\end{center}
In this particular case, an assignment of value distributions to each vertex factors over subsets with disjoint causal past if and only if it satisfies the traditional no-signalling conditions.
We don't use causal Bayesian networks in our work, instead relying on a combinatorial generalisation of causal orders known as ``spaces of input histories'', introduced in \cite{gogioso2022combinatorics}.

Our generalisation of causality, non-locality and contextuality is not limited to definite causal order, but instead extends to indefinite causal order and dynamical causal constraints.
The theory-independent and device-independent certification of indefinite causal order is the subject of \textit{causal inequalities}, originally developed in the study of process matrices \cite{oreshkov2012quantum}.
Causal inequalities are linear bounds obeyed by distributed protocol supported by a single definite causal order, or more generally by a probabilistic mixture thereof, and several process matrices violating them have been documented in the literature \cite{oreshkov2012quantum,baumeler2014perfect,baumeler2016the}.
For example, the GYNI (Guess Your Neighbour's input) causal inequality \cite{oreshkov2012quantum} can be derived in the context of a bipartite game, where Bob is tasked to either communicate a bit to Alice, or to guess Alice's bit, depending on the value of a classical random variable $\lambda \in \{0,1\}$.
If we assume that Alice causally precedes Bob, or that Bob causally precedes Alice, it can be shown that the probability of success for this game is always bounded by $3/4$.
A recipe to violate this bound is given by the following OCB protocol \cite{oreshkov2012quantum}:
\begin{itemize}
    \item Alice measures the qubit she receives in the Z basis, using the measurement outcome as her classical output $o_\ev{A} \in \{0,1\}$. She then encodes her (freely chosen) classical input $i_\ev{A} \in \{0,1\}$ into the Z basis of a qubit as $i_\ev{A} \mapsto |i_\ev{A}\rangle$, a qubit which she then forwards.
    \item If $\lambda = 0$, Bob measures the qubit he receives in the X basis, using the measurement outcome as his classical output $o_\ev{B} \in \{0,1\}$ (mapping $\langle\!+\!| \mapsto 0$ and $\langle\!-\!| \mapsto 1$). He then encodes his (freely chosen) classical input $i_\ev{B} \in \{0,1\}$ into the Z basis of a qubit as $i_\ev{B} \mapsto |i_\ev{B}\oplus o_\ev{B}\rangle$, a qubit which he then forwards.
    \item If $\lambda = 1$, Bob measures the qubit he receives in the Z basis, using the measurement outcome as his classical output $o_\ev{B} \in \{0,1\}$. He prepares a qubit in the state $|0\rangle$, independently of his classical input, and forward the qubit.
\end{itemize}
This recipe above is turned into a pair of quantum instruments, which are then fed into the following process matrix:
\begin{equation}
W^{A_1 A_2 B_1 B_2} = 1/4 \left[ 1^{A_1 A_2 B_1 B_2} + 1/\sqrt{2}\left(\sigma_z^{A_2}\sigma_z^{B_1} +  \sigma_z^{A_1}\sigma_x^{B_1}\sigma_z^{B_2}\right) \right]
\end{equation}
The probability of success for the GINY game using the setup above is $\left(2+ \sqrt{2}\right)/4 > 3/4$, proving violation of the GINY causal inequality.

Aside from a brief foray into the OCB process discussed above and the BFW empirical model from \cite{baumeler2016the}, the examples presented in this work are all quantum-realisable (at least in the sense of quantum indefinite causality).
More specifically, the examples used to demonstrate the phenomenon of ``contextual causality'' are all based on quantum switches \cite{oreshkov2012quantum,chiribella2013quantum}, with either entangled control or contextual control.
A version of the single switch with entangled control (cf. Subsubsection \ref{subsubsection:ghzswitch-2-1}, p.\pageref{subsubsection:ghzswitch-2-1}) was also recently investigated in \cite{tein2022device}, where a CHSH-like argument is used---in conjunction with the software PANDA \cite{mckinney2010data}---to derive an explicit characterisation for some of the faces of the corresponding causaltope.
Indefinite causality is certified via the inequalities associated to the causaltope faces: this differs from our equation-based approach, and is instead analogous to previous literature on causal inequalities and non-locality.


% === COMMENT BELOW BEFORE COMPILING MAIN FILE ===

% \section*{Bibliography}

% \bibliographystyle{unsrt}
% \bibliography{biblio}

% \end{document}


This section discusses the application of the developed concepts to numerical test cases.
To investigate the influence on
the computational cost,
each test case is run multiple times with varying maximum
numbers of \subproblemIter s per solver call.

\subsection{Setup of cases}

Two different cases are studied, both well-known benchmarks for FSI.
They are simulated in the FE-FE as well as the FV-FE framework.

\subsubsection{Lid-driven cavity case}
The first case considers a two-dimensional (2D) cavity with flexible bottom, excited by an oscillatory incoming flow and lid motion \cite{Mok2001a,Valdes2007}. % or use more recent papaer? 10.1016/j.cma.2020.113179
The geometry of the cavity and the flexible bottom is detailed in \Fig{CavityGeometry} and \Tab{TubeCavityParameters} contains the structural density $\rho^s$, modulus of elasticity $E^s$, and Poisson ratio $\nu^s$ of the lid, as well as the density $\rho^f$ and dynamic viscosity $\mu^f$ of the liquid.
\begin{comment}
The cavity itself has a height and width of \qty{1}{\metre}.
The flexible bottom has a thickness of \qty{0.002}{\metre} and is fixed a both ends.
Its density $\rho^s$, modulus of elasticity $E^s$, and Poisson ratio $\nu^s$ are given in \Tab{TubeCavityParameters}.
Furthermore, the table also contains the density $\rho^f$ and dynamic viscosity $\mu^f$ of the liquid inside the cavity.
\end{comment}
Both ends of the flexible bottom are fixed.
Further, on the top boundary of the cavity, a horizontal velocity $\bar{v}(t)$ is applied, which is expressed (in \qty{}{\metre\per\second}) as a function of time $t$ by
\begin{equation}
    \label{equ:CavityVelocity}
    \bar{v}=1-\cos\left(\frac{2\pi t}{5}\right).
\end{equation}
On the upper part of the left boundary, the same velocity is applied, but increasing linearly from zero to $\bar{v}(t)$ at the top, as indicated in \Fig{CavityGeometry}.
On the corresponding region of the right boundary, a pressure of \qty{0}{\pascal} is imposed.
The simulation runs 700 time steps of \qty{0.1}{\second},
adding up to the total time \qty{70}{\second}.
\Fig{CavityIllustration} illustrates the deformation of the flexible bottom.
\begin{figure}[ht]
    \centering
    \begin{subfigure}[t]{.49\textwidth}
        \input{Figure_CavityGeometry}
    	\caption{Sketch of the geometry and boundary conditions.}
    	\label{fig:CavityGeometry}
    \end{subfigure}
    \begin{subfigure}[t]{.49\textwidth}
        \centering
        \includegraphics[width=0.65\textwidth,trim={0 0 0 0}]{CavityIllustration}%0.346
    	\caption{Deformation of the flexible bottom and corresponding velocity field in \qty{}{\metre\per\second} at $t=\qty{40}{\second}$ simulated in the FV-FE framework.}
    	\label{fig:CavityIllustration}
    \end{subfigure}
	\caption{Visualisations of the lid-driven cavity case.}
	\label{fig:CavityCase}
\end{figure} 

The results obtained with the two frameworks are compared with each other as well as with data from literature in \Fig{CavityComparison}, showing that the period of the oscillation matches well.
Although there is some variation in the amplitude, the differences between the two frameworks are in line with the ones observed in literature.
\begin{figure}
    \centering
    \input{Figure_CavityDisplacement.tex}
	\caption{Vertical displacement of the top center point of the flexible bottom wall as a function of time. The results of both frameworks are compared with each other as well as the results obtained by Mok \cite{Mok2001a} and Valdes \cite{Valdes2007}.}
	\label{fig:CavityComparison}
\end{figure}

\subsubsection{Flexible tube case}
The second case is the simulation of a pressure pulse travelling through a flexible tube \cite{Degroote2009}.
In contrast to the lid-driven cavity case, this simulation is performed in three dimensions (3D).
The tube has a length of \qty{0.05}{\metre}, a radius of \qty{0.005}{\metre}, and a wall thickness of \qty{0.001}{\metre}.
The material parameters are given in \Tab{TubeCavityParameters}.

\input{Tables/Table_MaterialParameters}

Both ends of the tube wall are clamped.
At the inlet, a pressure value of \qty{1333.2}{\pascal} is applied during the first \qty{0.003}{\second}, thereafter the pressure is \qty{0}{\pascal}.
At the outlet, the pressure is fixed to \qty{0}{\pascal}.
The total simulated time is \qty{0.01}{\second}, divided into 100 time steps of \qty{0.0001}{\second}.
\Fig{TubeIllustration} illustrates the pressure pulse travelling through the tube.
\begin{figure}[ht]
	\centering
    \includegraphics[width=0.9\textwidth,trim={200 120 200 450},clip]{TubeIllustration}
	\caption{Flexible tube at $t=\qty{0.004}{\second}$ simulated in the FE-FE framework. The upper half shows the fluid pressure field in \qty{}{\pascal} and the lower part illustrates the IGA shell structure.}
	\label{fig:TubeIllustration}
\end{figure}


As the purpose of this study is to investigate similar effects in both software frameworks rather than a quantitative comparison of the two,
matching results are not strictly required.
% Although matching results are not strictly required for this study
% % 
% as its purpose is to investigate similar effects in both software frameworks,
% %]
Nevertheless,
\Fig{TubeComparison} compares the data obtained for both frameworks.
% for both frameworks with each other.
%as well as with results found in literature.
% \todo{Do we have values from literature? You mentioned you might have some data from a previous work of Joris if I remember correctly? A: I don't think there is literature with plots like this on unfortunately, so I would just compare between us two.}
Despite small quantitative differences, the two graphs are very similar.
\begin{figure}[ht]
    \input{Figure_TubeDisplacement.tex}
\end{figure}

\subsubsection{Settings of coupling and solvers}

The FSI problems detailed above are solved with the quasi-Newton algorithm IQN-ILS \cite{Degroote2009}.
For each problem, the reuse parameter $q$ is detailed in \Tab{CouplingSummary}.
Before constructing the approximate Jacobian, the linear dependencies in the stored residual data are removed by filtering \cite{Degroote2013b}. % Or review paper under submission
\Tab{CouplingSummary} also contains the used filtering tolerances $\varepsilon^{fil}$, as well as the subproblem tolerances for the flow and solid solvers, $\varepsilon^f$ and $\varepsilon^s$, confer the discussion in \Sec{subproblems}.
\Tab{DiscretizationSummary} shows that similar edge lengths have been aspired for both frameworks.

\input{Tables/Table_SolverSettings}

\input{Tables/Table_Discretization}

\subsection{Cost factors and regression}
\label{sec:regression}
As explained in \Sec{convergence} the cost of a partitioned simulation is not determined by the number of coupling iterations alone, 
but instead also depends on the number of {\subproblemIter s}.
That is why the cost measure in \Equ{equivalentTime} was introduced
as a weighted sum of the iteration counts $\totalCoupleIter$, $\totalProblemIter^f$, and $\totalProblemIter^s$.
% 
The weights are given by a set of cost coefficients accounting for the data transfer as well as both a fixed and an iteration-dependent
contribution of each solver call.
% 
While the values of these five cost factors are impossible to determine in general,
they can be approximated for a specific case and framework using linear regression.

To do so,
the total run time of each simulation 
% of a specific case and framework combination
% within the parameter study
is split into three parts: the time spent in the flow solver or flow time $\timing^f$, the time spent in the solid solver or solid time $\timing^s$, and finally the remainder,
% which is the difference between the total run time and sum of flow and structure time.
which will be called coupling time $\timing^c$.
% 
For each parameter study, i.e., a specific case and framework combination,
the regression then uses the timings and iteration counts of all conducted runs as data set.

In the following, the calculations for the flexible tube case with FV-FE are used as example for the regression. The results themselves will be described in more detail in \Sec{parameterStudy}.

For the flow and solid time a multivariate linear regression is applied with two independent variables: the number of coupling iterations $\totalCoupleIter$ and the number of {\subproblemIter s} $\totalProblemIter^f$ or $\totalProblemIter^s$.
% 
Neglecting any cost that occurs only once per simulation,
a zero intercept is considered, such that the result of the regression is effectively a plane through the origin.
% 
As an example,
\Fig{RegressionTubeFVFlow3D} shows this plane for the flow time of the tube case solved with the FV-FE framework, 
while
\Fig{RegressionTubeFVFlowProjection} projects the same data into a plot over the flow solver iterations. 
% Convergence is triggered solely via the subproblem residuals.

\begin{figure}[ht]
    \centering
    \begin{subfigure}{.49\textwidth}
    	\includegraphics[width=\linewidth,trim={60 0 30 35},clip]{RegressionTubeFVFlow3D}
        \caption{Plane obtained with multivariate regression.}
    	\label{fig:RegressionTubeFVFlow3D}
    \end{subfigure}
    \begin{subfigure}{.49\textwidth}
        \centering
        \input{Figure_RegressionTubeFVFlowProjection}
    	\caption{Projection onto the flow time and $N_f$ plane.}
    	\label{fig:RegressionTubeFVFlowProjection}
    \end{subfigure}
    \caption{Multi-variate linear regression of $\timing^f$ in function of $\totalProblemIter^c$ and $\totalProblemIter^f$ for the tube case with the FV-FE framework.}
    \label{fig:RegressionFlow}
\end{figure}

The accuracy of the fit is assessed by the relative root mean square error (RRMSE), which is calculated for the flow time as
\begin{equation}
    \mathrm{RRMSE} = \sqrt{\frac{\sum^\numCalc\abs{
    \timing^f-(\totalProblemIter^c \cdot \costFix^f + \totalProblemIter^f \cdot \costIter^f)
    %\sum^{\totalProblemIter^c}_{k=1}\costSolver^f(k)
    }^2}{\sum^m\abs{\timing^f}^2}},
    \label{equ:RRMSE}
\end{equation}
where $\numCalc$ is the number of calculations considered.
For the flexible tube with FV-FE the RRMSE of the flow time regression is 7.43 \%. This value shows that the regression is reasonably accurate.
The remaining difference is caused by natural variation in run time due to the varying loading and clock speed of the processors
as well as minor effects not considered in the model, like varying cost of solving the assembled matrix-vector system.
Also, optimization actions taken by a solver behind the scenes such as load balancing or optimization of certain solver parameters, e.g., relaxation factors, contribute to the variations in run time. 
This is especially the case for the commercial FV solver in the FV-FE framework\footnote{Accordingly, the RRMSE of the FE-FE framework, which uses only scientific code, is much lower for both test cases, see \Tab{RRMSE_Measures}.}.
For completeness, the RRMSE of the solid time regression is 3.44 \%.

For the coupling time a linear regression analysis is performed with only one independent variable: the total number of coupling steps $\totalCoupleIter$.
Again, a zero intercept is assumed, such that the result is a line through the origin.
\Fig{RegressionTubeFVCoupling} shows the line for the tube case solved with the FV-FE framework.
The RRMSE value is 2.65 \%, which is again low, indicating that the assumed 
proportionality between coupling iterations and coupling cost is accurate.
% linear growth of the coupling cost is accurate.
\begin{figure}
	\centering
	\input{Figure_RegressionTubeFVCoupling}
	\caption{Linear regression of $\timing^c$ in function of $\totalProblemIter^c$ for the tube case with the FV-FE framework.}
	\label{fig:RegressionTubeFVCoupling}
\end{figure}

As discussed in \Sec{convergence}, all cost coefficients scaling with the number of coupling iterations can be combined into $\costCoupleSum$.
Plugging these coefficients into \Equ{equivalentTime} gives a cost measure for the run time, which will be called the \textit{equivalent time}.
% 
For the flexible tube case with FV-FE, the absolute value of the relative difference between the actual run time and the equivalent time is on average 3.80 \% and never higher than 14.62 \%. The first measure is referred to as the mean absolute percentage error (MAPE) and, analogously, the second is called the maximum absolute percentage error (maxAPE). These are defined as
\begin{equation}
    \mathrm{MAPE} = \frac{1}{\numCalc}\sum^\numCalc\abs{\frac{\timeSimulation-\costSimulation}{\timeSimulation}}
    \quad\mathrm{and}\quad
    \mathrm{maxAPE} = \max_\numCalc\left(\abs{\frac{\timeSimulation-\costSimulation}{\timeSimulation}}\right).
    \label{equ:MAPEmaxAPE}
\end{equation}

For comparison, assuming that the total cost scales only with the coupling iterations as common in literature,
i.e., setting $\costFac{iteration}^{f,s}=0$,
the deviation increases to an average of 13.58 \% and a maximum of 52.96 \%.
\Fig{EquivalentTime} illustrates the difference between these measures and their error with respect to the actual cost of the simulation.
Hence, the measure proposed in this work is not perfect, but definitely 
an improvement over the one predominant in literature.
% more accurate than that in the literature.
\begin{figure}
	\centering
	\input{Figure_RegressionTubeFVEquivalentTime}
	\caption{Difference between the actual time, the equivalent time used here, and the cost measure considering a constant cost per coupling iteration for the flexible tube case with the FV-FE framework. Note that the equivalent time with constant cost per coupling iteration forms a line through the origin.}
	\label{fig:EquivalentTime}
\end{figure}

An additional benefit of this equivalent time is that it is not affected by the occurring variations in run time, as the random variations present in the actual run time are filtered out.
For this reason, the equivalent time will be used as cost measure instead of the actual time from here on.
\Tab{RegressionSummary} gives a summary of the cost factors and the differences between the actual and equivalent run time for the lid-driven cavity and flexible tube case with both frameworks
\footnote{
At first, it might seem strange that, for the lid-driven cavity case in \Tab{RegressionSummary}, a fixed-point iteration in the FV flow solver is
more expensive than a Newton step in the flow solver of its FE-FE counterpart.
% 
However,
the two frameworks did not only use different software, but were also run on different hardware infrastructure,
prohibiting a direct comparison.}
% 
%Relative to the corresponding solid iteration,
%the fixed-point iteration is indeed less expensive.
% In fact, comparing the two values of $\costIter^f$ to
% the cost of one solid Newton iteration,
% shows that the fixed-point iteration to be less expensive.

\input{Tables/Table_CostFactors}


The methodology explained in this section was illustrated by the flexible tube simulations with the FV-FE framework. Quality measures of the regression for other combinations of problems and frameworks are given in \App{fullRegression}. 

% \begin{comment}
% \begin{figure}
% %	\resizebox{0.41\textwidth}{!}
% 	{\input{Tikz_RegressionFlow}} \qquad
% 	{\input{Tikz_RegressionStruct}}
% 	\vspace{0.5cm} \\
% 	{\input{Tikz_RegressionCouple}}
% 	\caption{Linear regression graphs of the run time spent for (1) the flow solver, (2) the solid solver, and (3) the data transfer over the corresponding iteration count. For a cleaner illustration, both run times and iteration counts are normalized by dividing through the maixum value.}
% \end{figure}
% \end{comment}


% \subsection{Results}
\subsection{Results of parameter study}
\label{sec:parameterStudy}


The primary research question of this work is how the overall performance of the partitioned FSI algorithm is influenced by limiting the number of \subproblemIter s per solver call.
% 
% To study this influence,
Towards this goal,
simulations were run multiple times with varying values for $\iterPerCall^f$ and $\iterPerCall^s$. 
% 
By virtue of the new convergence criterion, each of these runs solves the coupled problem up to the same tolerance.
% 
Two test cases investigated by two FSI software frameworks led to a total of four parameter studies.
The following subsections present their results, focusing
on how varying $\iterPerCall^f$ and $\iterPerCall^s$ influences different quantities and measures.

\subsubsection{Iteration counts} \label{sec:Results_IterCounts}

One central aspect is the impact of the \subproblemIter s per solver call on the three global iteration counts, i.e., 
the total number of coupling iterations $\totalCoupleIter$ as well as
the total number of \subproblemIter s of the flow and solid solver, $\totalProblemIter^f$ and $\totalProblemIter^s$, respectively.
% Picking the lid-driven cavity case simulated with the FV-FE framework as a representative example, \Fig{ContourPlots_FV_Cavity} illustrates their dependence on $\iterPerCall^f$ and $\iterPerCall^s$ in three contour plots.
Therefore, \Fig{ContourPlots_FV_Cavity} and \Fig{ContourPlots_FE_Tube} illustrate their dependence on $\iterPerCall^f$ and $\iterPerCall^s$ in three contour plots each.
% 
To increase the representativity of the examples,
\Fig{ContourPlots_FV_Cavity} is based on the lid-driven cavity case simulated with the FV-FE framework,
while \Fig{ContourPlots_FE_Tube} visualizes the tube case for the FE-FE framework.

The overall trends observed for these two examples are in very good agreement. The biggest difference is that the
plots obtained for the FV flow solver are more 'fine-grained',
since it relies on fixed-point rather than Newton steps, requiring more but typically less expensive iterations.
The key findings of the three subplots are:
\begin{enumerate}[(a)]
\item The number of \textit{coupling iterations} clearly decreases when running more \subproblemIter s per solver call, so that iterating to full convergence in every call yields the smallest $\totalCoupleIter$.
% 
% 
This observation, in line with the reasoning of \Sec{IterationsPerCall}, is expected
since the interface data fed back by the subproblem into the coupling loop is ensured to be as accurate as possible given the input data.
% 
The other way around, reducing $\iterPerCall^f$ and/or $\iterPerCall^s$ deteriorates the quality of the exchanged data fields, leading to more coupling iterations.
This effect can even be severe enough to cause divergence of the coupling, as observed for the FV-FE framework in \Fig{ContourPlots_FV_Cavity} if $\iterPerCall^f<6$.
% 
%
\item The main influence on the \textit{flow iterations} is that the total number $\totalProblemIter^f$ grows with $\iterPerCall^f$. 
This indicates that for increasing $\iterPerCall^f$, the increase in $\totalProblemIter^f$ resulting from the additional \subproblemIter s performed within each coupling step outweighs those saved due to the reduced number of coupling iterations, discussed in (a).
% 
Keeping $\iterPerCall^f$ fixed reveals a secondary trend:
running more solid iterations per solver call decreases
the total number of flow iterations. Again, this is explicable by the improved quality of the interface data that is passed back by the solid solver and serves as the fluid's boundary condition.
% 
\item The contour plot of the \textit{solid iterations} and its characteristics are principally the transpose of those discussed for the flow iterations in (b):
$\totalProblemIter^s$ primarily depends on $\iterPerCall^s$, but is influenced by $\iterPerCall^f$ as well.
\end{enumerate}

The contour plots of the two missing combinations, i.e., the lid-driven cavity with the FE-FE setup and  the tube case simulated with the FV-FE solver framework, 
are omitted for the sake of conciseness.
They show the same trends,
% 
which suggest the discussion above is to some extent general, in that the underlying effects are not very problem-dependent, or at least observable for typical FSI simulations.
%
\begin{figure}[ht]
    \centering
    \begin{subfigure}{.33\textwidth}
    	\includegraphics[width=\textwidth,trim={0 55 0 5},clip]{ContourPlots/FV_Cavity_Couple}
        \caption{Coupling iterations $\totalCoupleIter$.}
    \end{subfigure}
    \begin{subfigure}{.33\textwidth}
        \includegraphics[width=\textwidth,trim={0 55 -14 5},clip]{ContourPlots/FV_Cavity_Fluid}
    	\caption{Flow \subproblemIter s $\totalProblemIter^f$.}
    \end{subfigure}
    \begin{subfigure}{.33\textwidth}
        \includegraphics[width=\textwidth,trim={0 55 -14 5},clip]{ContourPlots/FV_Cavity_Solid}
    	\caption{Solid \subproblemIter s $\totalProblemIter^s$.}
    \end{subfigure}
    \caption{Different iteration counts plotted over $\iterPerCall^f$ and $\iterPerCall^s$ for the lid-driven cavity case simulated with the FV-FE framework.}
    \label{fig:ContourPlots_FV_Cavity}
\end{figure}
%
\begin{figure}[ht]
    \centering
    \begin{subfigure}{.33\textwidth}
    	\includegraphics[width=\textwidth,trim={0 55 -14 5},clip]{ContourPlots/FE_Tube_Couple} 
        \caption{Coupling iterations $\totalCoupleIter$.}
    \end{subfigure}
    \begin{subfigure}{.33\textwidth}
        \includegraphics[width=\textwidth,trim={0 55 0 5},clip]{ContourPlots/FE_Tube_Fluid}
    	\caption{Flow \subproblemIter s $\totalProblemIter^f$.}
    \end{subfigure}
    \begin{subfigure}{.33\textwidth}
        \includegraphics[width=\textwidth,trim={0 55 0 5},clip]{ContourPlots/FE_Tube_Solid}
    	\caption{Solid \subproblemIter s $\totalProblemIter^s$.}
    \end{subfigure}
    \caption{Different iteration counts plotted over $\iterPerCall^f$ and $\iterPerCall^s$ for the tube case simulated with the FE-FE framework.}
    \label{fig:ContourPlots_FE_Tube}
\end{figure}

\subsubsection{Computational cost}

Investigating the iteration counts $\totalCoupleIter$, $\totalProblemIter^f$, $\totalProblemIter^s$ is certainly of scientific interest,
% 
but in practice
the most important quantity to consider is
the simulation's total run time,
in this work represented by the equivalent time measure 
defined in \Equ{equivalentTime}.
% 
Since it is computed as a weighted sum of $\totalCoupleIter$, $\totalProblemIter^f$, and $\totalProblemIter^s$,
all effects discussed in the previous section affect
the equivalent time measure too.
% 
Their significance, however, is determined by the 
weighting factors, i.e., the cost of one coupling, flow, or solid iteration approximated by the regression model.
% 
Unlike the more general dependencies illustrated in \Fig{ContourPlots_FV_Cavity} and \Fig{ContourPlots_FE_Tube},
% 
the equivalent time measure therefore strongly depends on other aspects such as the problem itself, the solver framework, the HPC architecture, and so on.
% 


For the lid-driven cavity case, the parameter study of the two solver frameworks results in the contour plots
depicted in \Fig{ContourPlots_EqvCavity_Time}. To make them more comparable, the
values are normalized by dividing through the equivalent time obtained for iterating each solver call to full convergence.
%
\begin{figure}[ht]
    \centering
    \begin{subfigure}{.49\textwidth}
    	\includegraphics[width=\textwidth,trim={0 55 0 0}, clip]{ContourPlots/FV_Cavity_EqvTime} 
        \caption{FV-FE framework.}
    \end{subfigure}
    \begin{subfigure}{.49\textwidth}
        \includegraphics[width=\textwidth,trim={0 44 0 0},clip]{ContourPlots/FE_Cavity_EqvTime}
    	\caption{FE-FE framework.}
    \end{subfigure}
	\caption{Contour plots of the equivalent time measure for the lid-driven cavity case, normalized with respect to the value obtained for full convergence.} \label{fig:ContourPlots_EqvCavity_Time}
\end{figure}
% 
The most striking observation is that,
despite resulting from different solver frameworks run on different computer systems,
the overall characteristics of the plots are very similar.
% 
The only major difference is found for the top part, i.e., for small values of $\iterPerCall^f$.
% 
While the FV-FE framework diverged for $\iterPerCall^f<6$ as discussed in the previous section,
no lower bound is apparent for the FE-FE setup,
as performing a single Newton iteration per flow solver call is already sufficient to ensure convergence. Nevertheless, the negative impact of $\iterPerCall^f=1$ on the stability leads to
more coupling iterations and therefore higher computational cost.
%

Apart from this,
the trends apparent in the two plots are in good agreement.
% 
They clearly show that the total run time is not minimized by iterating to full convergence in every solver call.
Accordingly, the optima of the run time and the number of coupling iterations $\totalCoupleIter$ do not match.
Moreover, the least efficient choice in both cases is to set $\iterPerCall^s=1$
and $\iterPerCall^f=\infty$.
% , while running the flow solver to full convergence in every call.
% 
The area of lowest computational cost,
on the other hand,
is found for some mid-range values for both parameters, like $\iterPerCall^f=\iterPerCall^s=2$ for FE-FE
or $\iterPerCall^f \approx 12$ and $\iterPerCall^s=2$ for the FV-FE framework.
% 
While further increasing $\iterPerCall^f$ reduces the efficiency significantly, adding more solid iterations in this case does not have a big impact, since solving the solid problem is much cheaper for both setups.
% Note that the optima of the run time and the number of coupling iterations $\totalCoupleIter$ do not match.
% 


Although the most significant speed up with respect to full convergence in every solver call, i.e., $\iterPerCall^f=\iterPerCall^s=\infty$,
is only about $22 \%$,
% 
the parameter study of the lid-driven cavity case clearly shows that the number of \subproblemIter s per solver call
has a significant influence on the computational cost.
% and should therefore be taken into account
In order to be efficient, an FSI solver framework should therefore take
this impact into account. \\
% 

Analogously to the discussion of the lid-driven cavity, \Fig{ContourPlots_Tube_EqvTime} illustrates the computational cost as a function of $\iterPerCall^f$ and $\iterPerCall^s$ for the flexible tube case.
% 
Undoubtedly, the difference between the two solver frameworks is more pronounced than in the previous figure.
% 
Nonetheless, the biggest difference is again observed for very small values of $\iterPerCall^f$.
Like in the previous case, the FV flow solver requires a certain minimum number of \subproblemIter s, here $\iterPerCall^f\gtrsim8$, to prevent divergence.
For the FE-FE framework, on the other hand, one Newton iteration per call is not only enough to converge,
but in this case even results in the lowest computational cost.
% 
A likely explanation is that one Newton iteration is already accurate enough to yield similar results as in the green region observed in the FV-FE framework around 
$\iterPerCall^f \approx 12$, so that the part above with slightly slower convergence is
never reached for the FE-FE setup.
% 
This reasoning is supported by the observation that for all FE flow solver calls of the parameter study, a maximum of three Newton iterations was enough to converge, 
indicating that Newton steps are a very effective method of handling the flow problem's nonlinearity for this test case.
% hinting at each Newton iteration bringing a significant reduction of the residual.
% 

In both plots,
increasing the number of flow iterations per solver call leads to a smooth yet significant growth in computational cost, while the solid iterations have a far lower impact.
% 
Furthermore, setting $\iterPerCall^s=1$ and $\iterPerCall^f=\infty$ is the most expensive choice for both frameworks.
% 
In that regard, the two plots are similar. 
% 
However, this maximum is much more distinct in the FV-FE case than for FE-FE.
%
% 
Given the three contour plots in \Fig{ContourPlots_FE_Tube},
it is clear that the peak in the lower left corner stems from 
the flow solver's cost.
% 
As the cost factors listed in \Tab{RegressionSummary}
do not reveal the flow solver to be more expensive in the FV-FE framework
relative to the other costs than for FE-FE,
% 
the difference is likely to be caused by a locally higher 
increase of the number of flow iterations $\totalProblemIter^f$.
% 
This hypothesis is supported by the tables presented in \App{fullResults}.


\begin{figure}[ht]
    \centering
    \begin{subfigure}{.49\textwidth}
    	\includegraphics[width=\textwidth,trim={0 55 0 0}, clip]{ContourPlots/FV_Tube_EqvTime} 
        \caption{FV-FE framework.}
    \end{subfigure}
    \begin{subfigure}{.49\textwidth}
        \includegraphics[width=\textwidth,trim={0 44 0 0},clip]{ContourPlots/FE_Tube_EqvTime}
    	\caption{FE-FE framework.}
    \end{subfigure}
	\caption{Contour plots of the equivalent time measure for the flexible tube case, normalized with respect to the value obtained for full convergence.}
    \label{fig:ContourPlots_Tube_EqvTime}
\end{figure}

\subsubsection{Further remarks}
% \subsubsection{Complete Results}

The contour plots discussed so far illustrated the most important trends and findings of the parameter studies.
%
Further, \App{fullResults} contains four tables,
% The complete results are condensed in Tables TODO
% 
each corresponding to a particular parameter study, i.e., one test case and framework.
They list the coupling, flow, and solid iterations as well
as the relative equivalent times obtained for all runs belonging to that particular parameter study.
% 
% Except for the trends already discussed
% In addition to the remarks of the previous sections,
The following additional observations and remarks are noteworthy:
% 
% 
\begin{itemize}
    \item For both test cases, the FE-FE framework requires slightly fewer coupling iterations. 
    This effect is caused by the different types of \subproblemIter s.
    % 
    As the residual reduction is much more significant for a Newton step than it is for a fixed-point iteration,
    the first subproblem residual satisfying the convergence tolerance 
    will typically be considerably lower for the FE solver than for its FV counterpart.
    Consequently, even for the same residual tolerance the FE results fed back into the coupling loop are on average more accurate.
    % 
    In line with the reasoning in \Sec{IterationsPerCall} and \Sec{Results_IterCounts}, this leads to a lower $\totalCoupleIter$.
    % 
    The effect is further amplified since each solver call includes at least one {\subproblemIter}, i.e., a Newton step for FE or a fixed-point iteration for FV, even if the subproblem has already converged.
    % 
    While the higher number of coupling iterations is not problematic in itself, it results in a higher number of modes in the quasi-Newton coupling technique which risk to be (almost) linear dependent. This requires an efficient filtering technique, especially when the reuse parameter is high.
    %
    
    Numerical experiments showed, however, that the higher number of coupling iterations observed for the FV solver can be countered by performing batches of fixed-point \subproblemIter s, e.g., groups of ten, and checking convergence of the flow solver only after each batch.
    %Additionally, this approach for FV leads to a cost reduction, as it is no longer necessary to calculate the residual after every fixed-point iteration.\todo{@Nicolas: Personally, I would remove this last sentence ("Additionally...") as I would expect the cost of computing the residual to be by all means negligible.}

    % In case the FV flow solver first reaches the state for which the first subproblem residual has converged, it will perform one fixed-point iteration per coupling iteration until also the solid solver converges in the first subproblem iteration.
    % Experiments showed that this leads to a high amount of coupling iterations, requiring an efficient filtering technique, especially when the reuse parameter is high.
    % Performing batches of fixed point iterations, e.g., groups of ten, and checking convergence only after each batch, is observed to be a possible approach to counter this behavior.
    
    \item In literature,
    it is common to monitor the coupling's convergence via the fixed-point residual of the interface displacement $\Rk{k}$, defining either an absolute or relative tolerance.
    % 
    To give an idea of how strict the convergence criteria were chosen for the parameter study, \Tab{RkDx} lists for all four studies both the average and maximum value of $\normE{\Rk{k}}$ and $\frac{\normE{\Rk{k}}}{\normE{\vect{d}^k}}$, determined upon convergence for each time step. 
    % The highest values are $TODO$ for the absolute norm
    % and $TODO$ for the relative residual, so that 
    % Based on the maximum values,
    % an absolute convergence bound of $\varepsilon^{C}_{abs} \approx TODO$ or analogously a relative bound of $\varepsilon^{C}_{rel} \approx TODO$ are expected to be most comparable.
    % 
    \item As explained in \Rem{Increment}, the convergence criterion is only exact if the IQN update increment vanishes. Therefore, \Tab{RkDx} provides the average and maximum norm of the IQN increment norm at the end of a time step for all studies,
    confirming this minor aspect can safely be ignored in practice.
    % 
    \item By virtue of the new convergence criterion, all runs within a parameter study are converged up to the same tolerance. In this way, their results are virtually the same.
% 
    % To confirm this, the last value listed in \Tab{RkDx} quanti
    % is the  deviation from the interface displacement obtained for iterating to full convergence in every call \vect{d}^{ref}}. 
    To quantify the deviation, after each time step of each run in the parameter study, the computed interface displacement field $\vect{d}^k$ is compared to
    that obtained for iterating to full convergence in every call $\vect{d}^k_{ref}$, by evaluating 
    \begin{align}
        \frac{\normE{\vect{d}^k-\vect{d}^k_{ref}}}{\sqrt{\nInterfaceDofs}} ~,
    \end{align}
    where $\nInterfaceDofs$ is the number of displacement degrees of freedom at the FSI interface.
    % 
    In its last two columns, \Tab{RkDx} list the average and maximum values of this deviation for each study.
    % 
\end{itemize}

\input{Tables/Table_Residuals_Increments.tex}

The tables in \App{fullResults} show that the gain in computational efficiency and the location of the optimum depend on the specific problem and the selected solvers.
However, also the coupling technique and settings have a significant influence.
To illustrate this, 
% \Tab{FETubeNoReuse} and \Tab{FVTubeNoReuse} present 
\App{noReuse} presents
two additional parameter studies
% (FE-FE and FV-FE) 
for the flexible tube case with identical settings, but without reuse of data from past time steps in the IQN Jacobian approximation ($q$=0).
%
For both tables, fully converging the subproblems in every call leads to the worst performance.
The optimum is found by performing 1 Newton iteration in FE and around 8 fixed-point iterations in FV.
Note that for these choices the computational time is approximately halved with respect to the reference.
% confirming that significant speed ups can be achieved by beneficial choices
% of $\iterPerCall^f$ and $\iterPerCall^s$.

\subsubsection{Impact of cost factors}

The parameter studies demonstrate that limiting the number of \subproblemIter s per solver call has a significant influence on the computational cost of the partitioned simulation,
and that this cost is accurately represented by the new equivalent time measure, which relies on a weighted sum
of the
iteration counts $\totalCoupleIter$, $\totalProblemIter^f$, and $\totalProblemIter^s$.
% 
% While, unfortunately, 
% both the iterations counts and the weighting factors are case-specific,
% the iterations counts 
% 
Unfortunately, however, both weighting factors and iteration counts
are case-specific:
while the weighting factors refer to the cost of one iteration and hence in particular depend on the software framework and computer architecture,
%
the iteration counts are influenced for example by the chosen solver tolerances and convergence criteria.

Nevertheless, \Sec{Results_IterCounts} showed that these 
% Nevertheless, \Fig{ContourPlots_FV_Cavity} and \Fig{ContourPlots_FE_Tube} show the 
iteration counts follow rather general trends.
% 
% As a consequence, 
Taking the iteration counts obtained in the parameter studies
% by keeping the iteration counts fixed 
and artificially setting the cost factors $\costCoupleSum$, $\costIter^f$, and $\costIter^s$,
therefore allows to approximate the computational costs of different cost scenarios.

As an illustrative example,
\Fig{ContourPlots_Varying} uses the iteration counts obtained for the cavity case simulated in the FV-FE framework
% 
to plot the computational cost resulting from different, artificially chosen cost factors, 
exemplarily imitating the effect of a cost-efficient flow solver (\Fig{ContourPlots_Varying}b) or a very expensive data exchange (\Fig{ContourPlots_Varying}c).


% % 
% and visualize the estimated results in contour plots as in \Fig{ContourPlots_Varying}.

% \subfigcapmargin
\begin{figure}[ht]
    \centering
    \captionsetup[subfigure]{,slc=off,margin={5pt,5pt}}
    \begin{subfigure}[t]{.33\textwidth}
        \includegraphics[width=\textwidth,trim={0 50 10 5},clip]{ContourPlots/VaryFactors/CaseA} 
        \caption{$\costCoupleSum=\costIter^f=\costIter^s=1$: running only a few \subproblemIter s per call reduces the sum of iterations $\totalCoupleIter+\totalProblemIter^f+\totalProblemIter^s$, which is proportional to the overall cost for this scenario.}
    \end{subfigure}
    \begin{subfigure}[t]{.33\textwidth}
        \includegraphics[width=\textwidth,trim={0 50 10 5},clip]{ContourPlots/VaryFactors/CaseB}
    	\caption{$\costCoupleSum=\costIter^s=1$, $\costIter^f=0.01$: in this scenario the flow iterations are very inexpensive, so that a high $\iterPerCall^f$ and a small $\iterPerCall^s$ are most efficient.}
    \end{subfigure}
    \begin{subfigure}[t]{.33\textwidth}
        \includegraphics[width=\textwidth,trim={0 50 10 5},clip]{ContourPlots/VaryFactors/CaseC}
    	\caption{$\costCoupleSum=120$, $\costIter^f=\costIter^s=1$: if the cost per coupling step becomes dominant, 
        it is best to run more \subproblemIter s per call since it reduces $\totalCoupleIter$. Thus the potential speed-up decreases.}
    \end{subfigure}
    \caption{Contour plots of different cost distributions for the cavity case. The underlying approximate data is created by using the iteration counts obtained for the FV-FE framework and artificially setting the cost per coupling and \subproblemIter.
    % Although based on a specific example, the plots demonstrate some general trends.
    }
    \label{fig:ContourPlots_Varying}
\end{figure}
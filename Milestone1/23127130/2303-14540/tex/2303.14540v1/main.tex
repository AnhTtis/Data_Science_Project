\documentclass[lettersize,journal]{IEEEtran}

%\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.\
\usepackage{newtxmath}
\usepackage{cite}
\usepackage{algorithm}

\newcommand{\diag}[1]{\operatorname{diag}\left({#1}\right)}

\usepackage{dblfloatfix}
\usepackage{balance}
\usepackage[caption=false,font=footnotesize]{subfig}

\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage[short,c2,nocomma]{optidef}

\usepackage{acronym}
\input{acros}
\usepackage{textcomp}

\usepackage{siunitx}
\DeclareSIUnit{\belmilliwatt}{Bm}
\DeclareSIUnit{\dBm}{\deci\belmilliwatt}
\DeclareSIQualifier{\isotropic}{i}
\DeclareSIQualifier{\carrier}{c}

\makeatother

\usepackage{listings}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
		T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}	
	\title{Multicarrier Rate-Splitting Multiple Access: Superiority of OFDM-RSMA over OFDMA and OFDM-NOMA}
        
	\author{Mehmet Mert \c{S}ahin\IEEEmembership{, Graduate Student Member IEEE}, Onur Dizdar\IEEEmembership{, Member, IEEE}, Bruno Clerckx\IEEEmembership{, Fellow, IEEE}, Huseyin Arslan\IEEEmembership{, Fellow, IEEE}

    \thanks{
    M.M. \c{S}ahin is with the Department of Electrical Engineering, University of South Florida, Tampa, FL, 33620 (e-mail: mehmetmert@usf.edu). 

    O. Dizdar was with Imperial College of London. He is now with Viavi Solutions Inc (e-mail: onur.dizdar@viavisolutions.com).
    
    B. Clerckx is with Department of Electrical and Electronic Engineering, Imperial College London, London, SW7 2AZ, UK and with Silicon Austria Labs (SAL), Graz A-8010, Austria (e-mail: b.clerckx@imperial.ac.uk; bruno.clerckx@silicon-austria.com)

    H. Arslan is with School of Engineering and Natural Science, Istanbul Medipol University, Beykoz, 34810 Istanbul, Turkey (e-mail: huseyinarslan@medipol.edu.tr).
    } 
    }
    
\maketitle
\thispagestyle{plain}
\pagestyle{plain}

\begin{abstract}
\Ac{RSMA} is a multiple access technique generalizing conventional techniques, such as, \ac{SDMA}, \ac{NOMA}, and physical layer multi-casting, which aims to address  \ac{MUI} in \ac{MIMO} systems. In this study, we leverage the interference management capabilities of \ac{RSMA} to tackle the issue of \ac{ICI} in \ac{OFDM} waveform. We formulate a problem to find the optimal subcarrier and power allocation for downlink transmission in a two-user system using \ac{RSMA} and \ac{OFDM} and propose a weighted minimum mean-square error (WMMSE)-based algorithm to obtain a solution. The sum-rate performance of the proposed \ac{OFDM}-\ac{RSMA} scheme is compared with that of conventional \ac{OFDMA} and \ac{OFDM}-\ac{NOMA} by numerical results. It is shown that the proposed \ac{OFDM}-\ac{RSMA} outperforms \ac{OFDM}-\ac{NOMA} and \ac{OFDMA} under \ac{ICI} in diverse propagation channel conditions owing to its flexible structure and robust interference management capabilities.              
    \acresetall
\end{abstract}

\begin{IEEEkeywords}
    Rate-splitting multiple access (RSMA), OFDM, inter-carrier interference (ICI)
\end{IEEEkeywords}


\section{Introduction} \label{sec:Introduction}

% ILK PARAGRAFTA, MULTICARRIER WAVEFORM VE PROBLEMLERI ANLATMAMIZ VE RSMA KULLANMA MOTIVASYONUNU VERMEMIZ GEREKIYOR. 
%Innovative applications like \ac{AR}, holographic communication, digital replica require significant capacity and traffic growth. 
%Dedicated multiple access schemes such as \ac{NOMA} and \ac{RSMA} are proposed recently to cater for these immersive needs. In single-antenna systems, e.g. \ac{SISO} \ac{BC}, \ac{PD-NOMA} has been shown to achieve higher \ac{SE} than \ac{OMA} and simultaneously serves a higher number of users at an additional cost of increased complexity \cite{Dai2018NomaSurvey}. 
\Ac{OFDM} waveform has been widely studied and deployed in wireless communication standards such as 4G-LTE, 5G-NR and Wi-Fi due to its low-complexity implementation and robustness against frequency selective channel models \cite{ankarali2017waveform}. However, 'sinc' shaped subcarriers of OFDM makes it vulnerable to sources of \ac{ICI} such as Doppler spread, phase noise, mismatch in local oscillators of receiver and transmitter ends, etc. In fact, \ac{ICI} destroys the orthogonality of subcarriers in \ac{OFDM} and causes saturation in the data rate and error floor region in the \ac{BER} analysis even though the overall transmit power of the system increases \cite{tiejun2006OFDMuDopp}. This issue needs to be addressed in order to meet demanding requirements of next generation communication standards.

\Ac{RSMA} has been shown to achieve the largest upper bound for the achievable rate in the interference channel which makes it promising to address the \ac{ICI} related problems of the \ac{OFDM} waveform \cite{rsmaSurvey_2022}. Moreover, \ac{RSMA} has been shown to encapsulate and surpass the performance of \ac{SDMA}, \ac{NOMA}, \ac{OMA}, multicasting in multiple antenna networks in terms of  spectral and energy efficiency, latency, and resilience to mixed-critical quality of service  \cite{mao_clerckx_li_2018}. 

Analysis of \ac{RSMA} in multi-antenna multicarrier systems has been studied by several papers  \cite{Li2020_rsmaMultiCarrier,Chen2021_rsmaMultiCarrier,dizdar2022ComJamRS}. A three step resource allocation scheme is proposed in \cite{Li2020_rsmaMultiCarrier} where power allocation on a single subcarrier, matching between user and subcarrier and power allocation among different subcarriers are solved in steps to maximize the sum-rate. In \cite{Chen2021_rsmaMultiCarrier}, \ac{RSMA} is studied in the overloaded multicarrier multi-group multicast downlink scenario by formulating a joint max-min fairness and sum-rate problem. \ac{RSMA} for joint communications and jamming with a multi-carrier waveform in \ac{MISO} \ac{BC} is studied in \cite{dizdar2022ComJamRS}, where optimal precoder and power allocation is investigated for simultaneous communications and jamming in cognitive radio networks. 

The abovementioned works consider \ac{RSMA} to address the problems of various systems employing multi-carrier waveforms, %but not the problems of the multi-carrier waveform itself when it interacts with the wireless channel 
however, the problems of the waveform itself, such as \ac{ICI} due to Doppler under mobility, are not addressed.
%the problems of \ac{ICI} under high mobility and constraint on decoding order to be done at subcarrier level impeding efficiency and feasibility of multicarrier waveforms are not addressed. 
In this study, we employ \ac{RSMA} to solve the challenging problems that \ac{OFDM} waveform faces under practical channel conditions for the first time. Owing to the flexibility granted by the use of message-spliting and \ac{SIC}, we show that \ac{OFDM}-\ac{RSMA} outperforms \ac{OFDMA} and \ac{OFDM}-\ac{NOMA} in terms of sum-rate under frequency-selective channels and high mobility.
%Also, the presence of the common stream in \ac{OFDM}-\ac{RSMA} overcomes the inefficient use of \ac{SIC} in \ac{OFDM}-\ac{NOMA} by fixing the decoding order. The advantage of \ac{RSMA} even in \ac{SISO}-\ac{BC} is demonstrated numerically thanks to flexible power allocation over \ac{OFDM} subcarriers and robust interference management under high mobility scenario compared to conventional \ac{OFDM}-\ac{NOMA} and \ac{OFDMA}.  

\textit{Notation:} Lower-case bold face variables indicate vectors, and upper-case bold face variables indicate matrices, $\diag{\mathbf{M}}$ returns the elements on the main diagonal of matrix $\mathbf{M}$ in a vector, $\mathcal{C}\mathcal{N}(\mu,\sigma^2)$ represents complex Gaussian random vectors with mean $\mu$ and variance $\sigma^2$. The $\ell_2$-norm of a vector and Frobenius norm of a matrix are denoted as $\Vert \cdot \Vert$ and $\Vert A \Vert_F$, respectively. The notation $m_{ij}$ is the value located in $i$th row and $j$th column of matrix $\mathbf{M}$ and $\mathbf{e}_i$ denotes the $i$th standard unit basis vector of for $\mathbb{R}^N$.

\section{System Model} \label{sec:SystemModel}

We consider a system model, where a transmitter with a single antenna serves $K$ single-antenna users. The transmitter uses \ac{OFDM} to serve users in the same time slot. 
As shown in Fig. \ref{fig:MAschemes} for a two-user case, three different \ac{MA} schemes are considered for transmission {\sl i.e.,} \ac{OFDMA}, \ac{OFDM}-\ac{NOMA} and \ac{OFDM}-\ac{RSMA}. 


\subsection{\ac{OFDM} Transmission for $K$ users}

Let $\mathbf{x}_k$ denote the time domain signal of the $k$-th user expressed as  
\begin{IEEEeqnarray}{rCl}
    \mathbf{x}_k &=& \mathbf{A} \mathbf{F}^H \diag{\mathbf{p}_k}\mathbf{d}_k, \quad k \in \mathcal{K} = \{ 1,2,\ldots,K\}, 
    \label{eq:OFDMsignal}
\end{IEEEeqnarray}
where $\mathbf{F} \in \mathbb{C}^{N \times N}$ is the $N$-point \ac{FFT} matrix, $\mathbf{d}_k$ is the data symbols carrying information of $k$-th user, and $\mathbf{p}_k \in \mathbb{C}^{N \times 1}$ is the precoding vector that captures the power allocated to \ac{OFDM} subcarriers. The \ac{CP}-addition matrix $\mathbf{A} \in \mathbb{N}^{(N+C) \times N}$, and the \ac{CP}-removal matrix $\mathbf{B} \in \mathbb{N}^{N \times (N+C)}$ can be expressed as follows:
\begin{IEEEeqnarray}{rCl} 
	\mathbf{A} &=& \begin{bmatrix}
	\mathbf{0}_{C \times (N-C)} & \mathbf{I}_{C} \\
	\multicolumn{2}{c}{\mathbf{I}_N} 
	\end{bmatrix}, \;\;\; \mathbf{B} = \begin{bmatrix}
	\mathbf{0}_{N \times C} & \mathbf{I}_N 
	\end{bmatrix}.
	\IEEEyesnumber
	\label{eq:cpAdditionMatrixGeneral} 
	\IEEEeqnarraynumspace
\end{IEEEeqnarray}
The time-domain signal $\mathbf{y}_k \in \mathbb{C}^{(N + C) \times 1}$ received through the $k$-th user channel   $\mathbf{H}_k$ can be written as 
\begin{IEEEeqnarray}{rCl} 
    \mathbf{y}_{k} &=& \mathbf{H}_{k} \sum_{k=1}^K \mathbf{x}_{k} + \mathbf{n}_k,
    \label{eq:transmittedSignalAfterChannel}
\end{IEEEeqnarray}
where the vector $\mathbf{n}_k \in \mathbb{C}^{(N + C) \times 1}$ is the \ac{AWGN} with $n_{k,i} \sim \mathcal{CN}(0,\sigma^2)$ where $n_{k,i} \in \mathbf{n}_k$ and $\sigma^2$ is the power of \ac{AWGN}.
\begin{figure}[t]
    \centering
    \subfloat[]{
    \includegraphics[width=1\linewidth]{figures/differentMAschemesNewLetterOMA.pdf}
    \label{fig:OFDMAschemes}} \hfill 
    \subfloat[]{
    \includegraphics[width=1\linewidth]{figures/differentMAschemesNewLetterNOMA.pdf}
    \label{fig:NOMAschemes}}\hfill 
    \subfloat[]{
    \includegraphics[width=1\linewidth]{figures/differentMAschemesNewLetterRSMA.pdf}\label{fig:RSMAschemes}} 
    \caption{OFDM based multiple accessing with two users showing channel power of users (dashed line) and power allocation (solid box), (a) conventional OFDMA, (b) \ac{OFDM}-\ac{NOMA}, (c) \ac{OFDM}-\ac{RSMA}.}
    \label{fig:MAschemes} 
\end{figure}

\subsection{Channel Model}

The \ac{LTV} channel model includes multipath propagation and Doppler effect leading to time and frequency shifts on the transmitted signal. The channel model includes complex channel gain, Doppler shift and delay for every path. Therefore, the \ac{LTV} channel in the time-delay domain, $c(t,\tau)$, can be modeled as follows \cite{hlawatsch_matz_2011}:
\begin{IEEEeqnarray}{rCl}
  c(t,\tau)  &=& \sum_{l=1}^L \alpha_l e^{j2\pi\nu_l t}  \delta(\tau-\tau_l),
\label{eq:channelModel}   
\end{IEEEeqnarray}
where $\alpha_l$, $\tau_l$, and $\nu_l$ denote the complex attenuation factor, time delay, and Doppler frequency shift associated with the $l^{\text{th}}$ discrete propagation path where $l \in \left \lbrace 1,2,\ldots, L \right \rbrace$. Let $N$ and $C$ be the total subcarrier number with the set of $\mathcal{N} = \{ 1, 2, \ldots, N\}$ and \ac{CP} length of the \ac{OFDM} waveform, respectively. It is assumed that \ac{CP} length is larger than the maximum delay spread to ensure \ac{ISI} free transmission. The relation of (\ref{eq:channelModel}) with the $k$-th user's time domain channel matrix $\mathbf{H}_k \in \mathbb{C}^{(N + C) \times (N + C)}$ can be represented as follows: 
\begin{IEEEeqnarray}{rCl}
\mathbf{H}_k  &=& \sum_{l=1}^L \alpha_l \mathbf{\Pi}^{n_{\tau_l}}  \mathbf{\Delta}(\nu_l),
\label{eq:channelModelMatrix} 
\end{IEEEeqnarray} 
where the delay matrix $\mathbf{\Pi}^{n_{\tau_p}} \in \mathbb{C}^{(N+C) \times (N+C)}$ is the forward cyclic shifted permutation matrix according to the delay of the $l$th path. The Doppler shift matrix for the $l$th path, $\mathbf{\Delta}(\nu_l) \in \mathbb{C}^{(N+C) \times (N+C)}$, is defined as $ \mathbf{\Delta}(\nu_l) = \diag{\left[e^{\frac{j2\pi\nu_l}{F_s}}, e^{\frac{j2\pi\nu_l 2}{F_s}}, \cdots, e^{\frac{j2\pi\nu_l (N+C)}{F_s}}\right]}$, where $F_s$ is the sampling frequency in the system model.


\begin{figure*}[t]
    \centering
\includegraphics[width=1\linewidth]{figures/ofdmRSMAtransceiver.pdf}
    \caption{Proposed OFDM-RSMA scheme.} \label{fig:ofdmRSMAtransceiver}
\end{figure*}

\section{Proposed \ac{OFDM}-\ac{RSMA} Scheme}

In this section, we describe the proposed \ac{OFDM}-\ac{RSMA} scheme and formulate a sum-rate maximization problem to obtain the optimal common rate, subcarrier, and power allocation for the proposed scheme. Fig. \ref{fig:ofdmRSMAtransceiver} demonstrates proposed scheme for a two-user scenario. At the transmitter, the message intended for user-$k$, $W_k$, is split into common and private parts, which are denoted as $W_{c,k}$ and $W_{p,k}$, $\forall k \in \mathcal{K}$. The common parts of messages for all users are combined into a single common message $W_{c}$. The common and private messages are independently encoded into the common and private streams, $\mathbf{d}_c$ and $\mathbf{d}_{k}, \forall k \in \mathcal{K}$, respectively. The encoded symbols $\mathbf{d}_c$ and $\mathbf{d}_{k}$ are chosen from a Gaussian alphabet for theoretical analysis. We assume that the streams have unit power, {\sl i.e.,} $\mathbb{E} \{ \tilde{\mathbf{d}}\tilde{\mathbf{d}}^H\} = \mathbf{I}$, where $\tilde{\mathbf{d}} = [\mathbf{d}_c^T, \mathbf{d}_1^T, \ldots, \mathbf{d}_K^T]^T $. 

For a $K$-user \ac{OFDM}-\ac{RSMA} system, the transmitted common stream $\mathbf{x}_c \in \mathbb{C}^{(N + C)\times 1}$, is expressed as follows:
\begin{IEEEeqnarray}{rCl} 
    \mathbf{x}_{c} &=& \mathbf{A}  \mathbf{F}^H \diag{\mathbf{p}_c} \mathbf{d}_c,  \label{eq:commonStream}
\end{IEEEeqnarray}
where $\mathbf{p}_{c} \in \mathbb{C}^{N \times 1}$ is the power allocation precoding vector for the common stream over the \ac{OFDM} subcarriers. The private stream for user-$k$, $\mathbf{x}_k \in \mathbb{C}^{(N + C)\times 1}$, is expressed as in (\ref{eq:OFDMsignal}).
The matrix $\mathbf{P} = [\mathbf{p}_1,\ldots,\mathbf{p}_K]$ is defined as the collection of all precoding vectors of private streams, $\mathbf{p}_k, \forall k \in \mathcal{K}$. Vectors $\bar{\mathbf{p}}_{k,n}$ and $\bar{\mathbf{p}}_{c,n}$ denote that $n$-th subcarrier is forced not to carry any energy for private and common streams, i.e., $\bar{\mathbf{p}}_{k,n} = \left[ p_{k,1}, \ldots, p_{k,n-1}, 0, p_{k,n+1}, \ldots, p_{k,N} \right]$ and $\bar{\mathbf{p}}_{c,n} = \left[ p_{c,1}, \ldots, p_{c,n-1}, 0, p_{c,n+1}, \ldots, p_{c,N} \right]$. Accordingly, the time-domain received signal (\ref{eq:transmittedSignalAfterChannel}) can be re-written as follows:
\begin{IEEEeqnarray}{rCl} 
    \mathbf{y}_{k} &=& \mathbf{H}_{k} \left( \mathbf{x}_{c} + \sum_{k=1}^K \mathbf{x}_{k} \right) + \mathbf{n}_k.	\label{eq:transmittedAfterChannel}
\end{IEEEeqnarray}

At the receiver side, we first process the common stream. CP removal matrix and FFT operation are applied to the superimposed signal $\mathbf{y}_k$ to convert it into frequency domain for equalization and demodulation of the common stream. The received frequency domain signal at user-$k$, $\mathbf{r}_{c,k}$ is expressed as follows: 
\begin{IEEEeqnarray}{rCl} 
    \mathbf{r}_{c,k} &=& \mathbf{F} \mathbf{B}\mathbf{y}_{k}.	\label{eq:commonSequence_received}
\end{IEEEeqnarray}
The average received power at the $n$-th subcarrier of $\mathbf{r}_{c,k}$, $T_{c,k,n} \triangleq \mathsf{E} \left\{ \vert {(\mathbf{r}_{c,k})}_n \vert^2 \right\}$, is written as:
\begin{IEEEeqnarray}{rCl}
    T_{c,k,n} & = &  \left \vert s^{c,k,n}_{n,n} \right \vert^2 + \underbrace{ \sum_{j=1}^{N} \left \vert \bar{s}^{c,k,n}_{n,j} \right \vert^2 + \sum_{u = 1}^K \sum_{j=1}^{N} \left \vert s^u_{n,j} \right \vert^2 + \sigma^2}_{I_{c,k,n}}, \IEEEeqnarraynumspace \label{eq:power_common} 
\end{IEEEeqnarray}
with  
\begin{IEEEeqnarray}{rCl} 	
    \mathbf{S}^{c,k,n} &=& \mathbf{F}\mathbf{B} \mathbf{H}_k \mathbf{A} \mathbf{F}^H \diag{p_{c,n}\mathbf{e}_n}, \; \forall k \in \mathcal{K}, \; \forall n \in \mathcal{N},   \IEEEyesnumber \label{eq:signalMatrices} \IEEEyessubnumber \label{eq:intendedCommonSignal} \IEEEeqnarraynumspace \\ 
    \bar{\mathbf{S}}^{c,k,n} &=& \mathbf{F}\mathbf{B} \mathbf{H}_k \mathbf{A} \mathbf{F}^H \diag{\bar{\mathbf{p}}_{c,n}}, \; \forall k \in \mathcal{K}, \; \forall n \in \mathcal{N},   \IEEEyessubnumber \label{eq:ICISignal} \IEEEeqnarraynumspace \\
    \mathbf{S}^{u} &=& \mathbf{F}\mathbf{B} \mathbf{H}_k \mathbf{A} \mathbf{F}^H \diag{\mathbf{p}_{u}}, \quad \forall u \in \mathcal{K}, \IEEEyessubnumber \label{eq:MUISignal} \IEEEeqnarraynumspace
\end{IEEEeqnarray}
where the matrix in (\ref{eq:intendedCommonSignal}) denotes the energy leaking from the $n$-th subcarrier of the common stream to the other \ac{OFDM} subcarriers after passing through the \ac{LTV} channel. The \ac{ICI} on the $n$-th subcarrier caused by the energy leakage from the common stream on all subcarriers except the $n$-th subcarrier is written in (\ref{eq:ICISignal}). Lastly, interference due to all private streams is expressed in (\ref{eq:MUISignal}). After the common stream is demodulated at user-$k$, it is reconstructed and subtracted from the received signal. Then, \ac{FFT} matrix succeeding \ac{CP} removal matrix is applied to the remaining signal in order to demodulate the intended private stream for user-$k$ as follows:
\begin{IEEEeqnarray}{rCl} 
    \mathbf{r}_{k} &=& \mathbf{F} \mathbf{B}\left(\mathbf{y}_k - \mathbf{H}_k \mathbf{A}\mathbf{F}^H \diag{\mathbf{p}_c} \mathbf{d}_{c}\right) \nonumber \\ &=& \mathbf{F} \mathbf{B} \left( \mathbf{H}_k \sum^K_{k=1} \mathbf{x}_k + \mathbf{n}_k\right), \IEEEeqnarraynumspace	\label{eq:privateSequence_received}
\end{IEEEeqnarray}
The average received power at the $n$-th subcarrier of $\mathbf{r}_{k}$, $T_{k,n} \triangleq \mathsf{E} \left\{ \left\vert {(\mathbf{r}_{k})}_n \right \vert^2 \right\}$, can be written as:
\begin{IEEEeqnarray}{rCl} 
    T_{k,n} & = & \left \vert v^{k,n}_{n,n} \right \vert^2 + \underbrace{ \sum_{j=1}^{N} \left \vert \bar{v}^{k,n}_{n,j} \right \vert^2 + \sum_{\substack{i=1 \\ i \neq k}}^{K} \sum_{j=1}^{N} \left \vert w^i_{n,j}  \right \vert^2 + \sigma^2}_{I_{k,n}}, \IEEEeqnarraynumspace \label{eq:power_private} 
\end{IEEEeqnarray}	
with
\begin{IEEEeqnarray}{rCl} 	
    \mathbf{V}^{k,n} &=& \mathbf{F} \mathbf{B} \mathbf{H}_k \mathbf{A} \mathbf{F}^H \diag{p_{k,n}\mathbf{e}_n}, \; \forall k \in \mathcal{K}, \; \forall n \in \mathcal{N}, \IEEEyesnumber \label{eq:powersPrivate} \IEEEyessubnumber \label{eq:intendedPrivate} \IEEEeqnarraynumspace \\
    \bar{\mathbf{V}}^{k,n} &=& \mathbf{F} \mathbf{B} \mathbf{H}_k \mathbf{A} \mathbf{F}^H \diag{\bar{\mathbf{p}}_{k,n}}, \; \forall k \in \mathcal{K}, \; \forall n \in \mathcal{N}, \IEEEyessubnumber \label{eq:ICIprivate} \\
    \mathbf{W}^{i} &=& \mathbf{F} \mathbf{B} \mathbf{H}_k \mathbf{A} \mathbf{F}^H \diag{\mathbf{p}_i}, \; \forall i \in {\mathcal{K} \backslash k}, \IEEEyessubnumber \label{eq:MUIprivate} \IEEEeqnarraynumspace
\end{IEEEeqnarray}
where (\ref{eq:intendedPrivate}) denotes the energy of the $n$-th subcarrier of the private stream of user-$k$  spread over all subcarriers due to channel effects. The expressions (\ref{eq:ICIprivate}) and (\ref{eq:MUIprivate}) denote the \ac{ICI} and \ac{MUI} due to the private stream of user-$k$ and other users' private streams, respectively. By using (\ref{eq:power_common}) and (\ref{eq:power_private}), \acp{SINR} of the common and private streams for a given channel state can be stated as follows: 
\begin{IEEEeqnarray}{rCl}
   \gamma_{c,k,n} &\triangleq& \left \vert s^{c,k,n}_{n,n} \right \vert^2 I^{-1}_{c,k,n} \quad \text{and} \quad \gamma_{k,n} \triangleq \left \vert v^{k,n}_{n,n} \right \vert^2  I^{-1}_{k,n}. \label{eq:SINRs}
\end{IEEEeqnarray}
The achievable rates for common stream and private streams corresponding to user-$k$ in the corresponding subcarriers can be written as follows: 
\begin{IEEEeqnarray}{rCl}
   R_{c,k,n} &=& \log_2(1+\gamma_{c,k,n}) \quad \text{and} \quad R_{k,n} = \log_2(1+\gamma_{k,n}), \IEEEeqnarraynumspace \label{eq:achievableRates}
\end{IEEEeqnarray}
and the achievable rates for an \ac{OFDM} symbol can be written as follows: 
\begin{IEEEeqnarray}{rCl}
   R_{c,k} &=& \sum_{n=1}^{N} R_{c,k,n}  \; \text{bit/s/Hz} \; \text{and} \; R_{k} = \sum_{n=1}^{N} R_{k,n} \; \text{bit/s/Hz}.  \label{eq:achievableRatesOFDM} \IEEEeqnarraynumspace
\end{IEEEeqnarray}
The sum-rate maximization problem for the proposed \ac{OFDM}-\ac{RSMA} can be formulated as follows:
\begin{maxi}
{\mathbf{R}_c,\mathbf{p}_c,\mathbf{P}}{\sum_{n=1}^{N} R_{c,k,n} + \sum^K_{k=1} \sum_{n=1}^{N} R_{k,n}}
{\label{eq:optProblem}}{}
\addConstraint{\sum_{n=1}^{N} R_{c,k,n}}{\geq \sum_{n=1}^{N} R_{c,n}},
\addConstraint{R_{k} + C_{k}}{\geq R_k^{\text{min}}}
\addConstraint{\Vert \mathbf{P} \Vert_F^2 + \Vert \mathbf{p}_c \Vert^2}{\leq P_t},
\end{maxi}
where the common rate at the $n$th subcarrier $R_{c,n}$ is shared among users such that $C_{k,n}$ is the $k$-th user's portion of the common rate with $R_{c,n} = \sum_{k=1}^K C_{k,n}$, and $R_k^{\text{min}}$ is the minimum data rate constraint for the $k$-th user. The weighted minimum mean-square error (WMMSE) based precoding optimization framework studied in \cite{joudeh_2016_SRmax_RSMA} is adopted to solve the optimization problem (\ref{eq:optProblem}). 

\section{\ac{OFDM}-\ac{NOMA} transmission}

In a $K$-user \ac{OFDM}-\ac{NOMA} system, $k$-th user message is decoded after $k-1$ users' signals are successively canceled. \ac{SIC} order is not alternated at subcarrier level but kept fixed throughout one \ac{OFDM} symbol as done in practical systems. The received frequency domain signal at the $k$-th user, $\mathbf{r}_{k}$ in (\ref{eq:privateSequence_received}), is modified as follows:
\begin{IEEEeqnarray}{rCl} 
\mathbf{r}_{k} &=& \mathbf{F} \mathbf{B}\left(\mathbf{y}_{k} - \mathbf{H}_k \mathbf{A} \mathbf{F}^H \left(\sum_{l=1}^{k-1}  \diag{\mathbf{p}_l}\mathbf{d}_l \right)\right).	\label{eq:nomaReceived}
\end{IEEEeqnarray}
The received power, $T_{k,n} \triangleq \mathsf{E} \left\{ \left\vert {(\mathbf{r}_{k})}_n \right \vert^2 \right\}$, at the $n$th subcarrier of $\mathbf{r}_{k}$ can be written as follows:
\begin{IEEEeqnarray}{rCl} 
    T_{k,n} & = & \left \vert v^{k,n}_{n,n} \right \vert^2 + \underbrace{ \sum_{j=1}^{N} \left \vert \bar{v}^{k,n}_{n,j} \right \vert^2 + \sum_{\substack{i=k+1}}^{K} \sum_{j=1}^{N} \left \vert w^i_{n,j}  \right \vert^2 + \sigma^2}_{I_{k,n}}, \IEEEeqnarraynumspace \label{eq:NOMApower} 
\end{IEEEeqnarray}	
where
\begin{IEEEeqnarray}{rCl} 	
    \mathbf{V}^{k,n} &=& \mathbf{F} \mathbf{B} \mathbf{H}_k \mathbf{A} \mathbf{F}^H \diag{p_{k,n}\mathbf{e}_n}, \; \forall k \in \mathcal{K}, \; \forall n \in \mathcal{N},  \nonumber  \IEEEeqnarraynumspace \\
    \bar{\mathbf{V}}^{k,n} &=& \mathbf{F} \mathbf{B} \mathbf{H}_k \mathbf{A} \mathbf{F}^H \diag{\bar{\mathbf{p}}_{k,n}}, \; \forall k \in \mathcal{K}, \; \forall n \in \mathcal{N}, \nonumber \IEEEeqnarraynumspace \\
    \mathbf{W}^{i} &=& \mathbf{F} \mathbf{B} \mathbf{H}_k \mathbf{A} \mathbf{F}^H \diag{\mathbf{p}_i}, \; \forall i \in \{k+1, \ldots, K\}. \nonumber \IEEEeqnarraynumspace
\end{IEEEeqnarray}
Then, the optimization problem for achievable rate maximization using \ac{OFDM}-\ac{NOMA} is formulated as follows:
\begin{maxi}
{\mathbf{P}}{ \sum^K_{k=1} \sum_{n=1}^{N} R_{k,n}}
{\label{eq:NOMAoptProblem}}{}
\addConstraint{\Vert \mathbf{P} \Vert_F^2}{\leq P_t},
\addConstraint{R_k}{\geq R_k^{\text{min}}},
\end{maxi}
where the matrix $\mathbf{P} = [\mathbf{p}_1,\ldots,\mathbf{p}_K]$ is defined as the collection of all users' precoding vector, $\mathbf{p}_k, \forall k \in \mathcal{K}$.
The formulated problem can be solved using the WMMSE-based approach as described in the previous section.

\section{Simulation Results}

In this section, we demonstrate the performance gain of the proposed \ac{OFDM}-\ac{RSMA} scheme over \ac{OFDMA} and \ac{OFDM}-\ac{NOMA} under different channel conditions including flat fading, frequency and time selectivity. For simplicity, we study the scenarios where $K=2$. For  \ac{OFDM}-\ac{NOMA}, it is assumed that user-$1$ is the weak user having a smaller overall channel gain than user-$2$ (strong user), so that, the signal of user-$1$ is decoded first in the \ac{SIC} process \cite{maraqa2020NOMAsurvey}. Throughout the simulations, the \ac{OFDM} waveform has $35$ subcarriers with a \ac{SCS} of \SI{60}{\kilo\hertz}.


Fig. \ref{fig:flatFading} illustrates the performance of the considered \ac{MA} schemes under flat-fading channel without Doppler. Here, the sum-rate performance of the proposed \ac{OFDM}-\ac{RSMA} method is compared to \ac{OFDM} with a single user utilizing the whole bandwidth, \ac{OFDMA} with two users where the whole bandwidth is divided into two equal parts, and \ac{OFDM}-\ac{NOMA}. Since flat fading channel with \ac{OFDM} waveform can be seen as single pipeline SISO-BC scenario, maximizing the sum-rate in \ac{OFDM}-\ac{NOMA} and \ac{OFDM}-\ac{RSMA} results in allocating power to the strongest user, and hence, performing single user \ac{OFDM} \cite{clerckx_2020_MAcomparison}. The gain of \ac{OFDM}-\ac{RSMA} and \ac{OFDM}-\ac{NOMA} over \ac{OFDMA} emanates from the bandwidth division among users, which makes  \ac{OFDMA} a suboptimal transmission strategy from information-theoretic perspective \cite{Liu2022_NGMAnoma}.

\begin{figure}[t]
    \centering\includegraphics[width=0.78\columnwidth]{figures/flatFadingLetter.pdf} 
    \caption{Performance comparison of OFDMA, OFDM-NOMA, OFDM-RSMA and one user OFDM under flat fading channel.} 
    \label{fig:flatFading}
\end{figure}

Fig. \ref{fig:doublySelectiveLetter} demonstrates the sum-rate performance of \ac{OFDMA}, \ac{OFDM}-\ac{NOMA}, and \ac{OFDM}-\ac{RSMA} under the both frequency selective and doubly dispersive channels with varying $\Delta d = \frac{f_d}{\Delta f}$, where $f_d$ is the maximum Doppler spread and $\Delta f$ is the subcarrier spacing. When $\Delta d=0$, the channel becomes a frequency selective channel without Doppler, and the proposed \ac{OFDM}-\ac{RSMA} scheme provides more than 5\% sum-rate gain compared to the \ac{OFDM}-\ac{NOMA}. Such a gain is achieved owing to the message-splitting and the deterministic decoding order in \ac{SIC} for \ac{OFDM}-\ac{RSMA}, enabling it to overcome the power variations over subcarriers as opposed to \ac{OFDM}-\ac{NOMA}, which requires switching decoding order at each subcarrier for optimal performance. 
Furthermore, \ac{OFDM}-\ac{RSMA} achieves the same performance with waterfilling based \ac{OFDMA}, which is known to be capacity achieving in frequency selective channels without Doppler \cite{Tse_fundamentalsOfWirelessComm_2005}. As \ac{ICI} increases in doubly selective channels, the sum-rate of \ac{OFDMA} drops sharply and saturates at the high SNR regime when interference becomes more dominant than the noise level. It can be seen that \ac{OFDM}-\ac{RSMA} and \ac{OFDM}-\ac{NOMA} achieve higher data rate than \ac{OFDMA} in this case due to the \ac{SIC} process. At high SNR regime, the proposed \ac{OFDM}-\ac{RSMA} achieves a higher sum-rate due to its performance gain under frequency selectivity compared to \ac{OFDM}-\ac{NOMA}.  
%One can also conclude that the gain over \ac{OFDM}-\ac{NOMA} depends on the total subcarrier number in an \ac{OFDM} symbol, and the maximum Delay spread of the channel.
\begin{figure}[t]
    \centering
    \includegraphics[width=0.78\columnwidth]{figures/doublySelectiveLetter.pdf} 
    \caption{Sum-rate comparison of OFDMA, OFDM-NOMA, and OFDM-RSMA under the frequency selective and doubly selective channels.} \label{fig:doublySelectiveLetter}
\end{figure}


\section{Conclusions} \label{sec:Conclusion}

In this letter, we consider \ac{RSMA} to address the problems of \ac{OFDM} waveform under LTV channels. The proposed \ac{OFDM}-\ac{RSMA} scheme is robust against \ac{ICI} stemming from time variations and outperforms \ac{OFDMA}. Additionally, it is shown that inefficient use of \ac{SIC} in the \ac{OFDM}-\ac{NOMA} scheme limits the exploitation of power variation over subcarriers, a problem which \ac{OFDM}-\ac{RSMA} tackles owing to its message-splitting framework. The results show that \ac{OFDM}-\ac{RSMA} can provide robustness against performance-limiting challenges of wireless propagation channel, such as, \ac{ISI}, \ac{MUI}, \ac{ICI}, and \ac{INI}.   

\bibliographystyle{IEEEtran}
\bibliography{main}
	
\end{document}

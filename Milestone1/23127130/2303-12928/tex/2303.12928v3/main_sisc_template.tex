\documentclass[review,hidelinks,onefignum,onetabnum]{siamart220329}

\usepackage{amssymb}
\usepackage{latexsym}
%%%%%%%%%%%%%%%%%%
\usepackage{amstext,bbm,amsbsy} %amsthm
\usepackage{mathtools}
\usepackage{comment}
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{url}

\usepackage{subcaption}

\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows}
\usepackage{adjustbox}
\usepackage{siunitx}


\input{ex_shared}

% Optional PDF information
\ifpdf
\hypersetup{
  pdftitle={Generalized Hopf Formula, Learning, and Optimal Control - LQR direction},
  pdfauthor={todo}
}
\fi


\definecolor{myorange}{rgb}{0.883, 0.473, 0.180}
\definecolor{myblue}{rgb}{0.277, 0.621, 0.969}
\definecolor{mygreen}{rgb}{0.324, 0.680, 0.230}

\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\benn}{\begin{equation*}}
\newcommand{\eenn}{\end{equation*}}

\newtheorem{prop}{Proposition}[section]
\newtheorem{lem}{Lemma}[section]
\newtheorem{rem}{Remark}[section]
\newtheorem{cor}{Corollary}[section]
\newtheorem{thm}{Theorem}[section]
\newtheorem{defn}{Definition}
\newtheorem{example}{Example}[section]
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

\def\bx {\boldsymbol{x}}
\def\by {\boldsymbol{y}}
\def\bv {\boldsymbol{v}}
\def\bu {\boldsymbol{u}}
\def\bd {\boldsymbol{d}}
\def\bp {\boldsymbol{p}}
\def\bq {\boldsymbol{q}}
\def\bb {\boldsymbol{b}}
\def\ba {\boldsymbol{a}}
\def\bz {\boldsymbol{z}}
\def\bc {\boldsymbol{c}}
\def\R {\mathbb{R}}
\def\N {\mathbb{N}}
\def\E {\mathbb{E}}
\def\dom {\mathrm{dom~}}
\def\prox {\mathrm{prox}}
\def\inter {\mathrm{int~}}
\def\epi {\mathrm{epi~}}
\def\ri {\mathrm{ri~}}
\def\conv {\mathrm{conv}~}
\def\cone {\mathrm{cone}~}
\def\cobar {\overline{\mathrm{co}}~}
\def\co {\mathrm{co~}}
\def\L {\mathcal{L}}
\def\cl {\mathrm{cl~}}
\def\gr {\mathrm{gr~}}
\def\unitsim {\Lambda}
\def\Rn {\R^n}
\def\gmRn {\Gamma_0(\R^n)}
\def\Laplacian{\Delta_{\boldsymbol x}}
\def\ext{V}
\def\indexRiccati{j}
\def\pdhgdual{\boldsymbol{w}}
\def\pdhgdualscal{w}
\def\HHJ {H}
\def\JHJ {J}
\def\LNN {L}
\def\JNN {\tilde{J}}
\def\SLO {S_{LO}}
\def\ind {I}
\def\proj{\Pi}


%%%%%%% macro for LQR %%%%%%%%
\newcommand{\Cpp}{C_{pp}} % p^2 term in H
\newcommand{\Cxp}{C_{xp}} % xp term in H
\newcommand{\Cxx}{C_{xx}} % x^2 term in H
\newcommand{\Sxx}{P} % x^2 term in S
\newcommand{\Sx}{\mathbf{q}} % x term in S
\newcommand{\Sc}{r} % const term in S

\newcommand{\update}[1]{\textcolor{red}{#1}} 

%%% USE THESE MACROS FOR REVISIONS %%%%
\newcommand{\updateone}[1]{\textcolor{black}{#1}}  % reviewer 1
\newcommand{\updatetwo}[1]{\textcolor{black}{#1}} % reviewer 2
\newcommand{\updatethree}[1]{\textcolor{black}{#1}} % reviewer 3
\newcommand{\updateeditor}[1]{\textcolor{black}{#1}} % editor

%%%%%%%%%%%%%%%%%%%%%%%%%%

% MACROS
\def\lossfunc{\mathcal{L}}
\def\NNfunc{f}
\def\weight{\theta}
\def\weightvec{{\boldsymbol{\weight}}}
\def\NNinput{\mathbf{z}}
\def\NNoutput{\mathbf{y}}
\def\regfunc{R}
\def\param{\lambda}
\def\HJmom{\mathbf{p}}
\def\HJx{\mathbf{x}}
\def\HJt{t}
\def\HJu{\mathbf{u}}
\def\Hamiltonian{\HHJ}
\def\HJIC{\JHJ}
\def\LPinspace{\R^M}
\def\LPoutspace{\R^m}
\def\weightspace{\Rn}
\def\HJstatespace{\weightspace}
\def\numt{N}
\def\LQRxx{\mathcal{Q}}
\def\LQRuu{\mathcal{R}}
\def\LQRxu{\mathcal{N}}
\def\LQRTC{\mathcal{Q}_f}
\def\LQRA{A} % linear dynamics
\def\LQRB{B}
% MACROS FOR LEARNING PROBLEMS
\def\MLregmat{\Gamma}
\def\MLreg{\gamma}    
\def\MLbasismat{\Phi}
\def\MLbasis{\phi}
\def\MLcentervec{\weightvec^0}
\def\MLcenter{\weight^0}
\def\MLcenternewvec{\tilde\weightvec^0}
\def\MLcenternew{\tilde\weight^0}
\def\MLy{\by}

\begin{document}
\nolinenumbers
\renewcommand{\thefootnote}{\fnsymbol{footnote}}

\footnotetext[1]{Division of Applied Mathematics, Brown University, Providence, RI 02912, USA (paula\_chen@alumni.brown.edu, zongren\_zou@brown.edu, jerome\_darbon@brown.edu, george\_karniadakis@brown.edu).}
\footnotetext[2]{Department of Mathematics, UCLA, Los Angeles, CA 90025, USA (\email{tingwei@math.ucla.edu}).}
\footnotetext[3]{Pacific Northwest National Laboratory, Richland, WA 99354, USA}
\footnotetext[4]{Paula Chen, Tingwei Meng, and Zongren Zou contributed equally to this work.}
\footnotetext[5]{Corresponding author.}
\renewcommand{\thefootnote}{\arabic{footnote}}


\maketitle %modify in ex_shared.tex

% REQUIRED
\begin{abstract}
Hamilton-Jacobi partial differential equations (HJ PDEs) have deep connections with a wide range of fields, including optimal control, differential games, and imaging sciences. By considering the time variable to be a higher dimensional quantity, HJ PDEs can be extended to the multi-time case. In this paper, we establish a novel theoretical connection between specific optimization problems arising in machine learning and the multi-time Hopf formula, which corresponds to a representation of the solution to certain multi-time HJ PDEs. Through this connection, we increase the interpretability of the training process of certain machine learning applications by showing that when we solve these learning problems, we also solve a multi-time HJ PDE and, by extension, its corresponding optimal control problem. As a first exploration of this connection, we develop the relation between the regularized linear regression problem and the Linear Quadratic Regulator (LQR). We then leverage our theoretical connection to adapt standard LQR solvers (namely, those based on the Riccati ordinary differential equations) to design new training approaches for machine learning. Finally, we provide some numerical examples that demonstrate the versatility and possible computational advantages of our Riccati-based approach in the context of continual learning, post-training calibration, transfer learning, and sparse dynamics identification. 
\end{abstract}

% REQUIRED
\begin{keywords}
Multi-time Hamilton-Jacobi PDEs; Hopf formula; machine learning; linear quadratic regulator; linear regression; Riccati equation
\end{keywords}

% REQUIRED
\begin{MSCcodes}
35F21, 49N05, 49N10, 68T05, 35B37
\end{MSCcodes}


% for tikz figures
\tikzstyle{box} = [rectangle, rounded corners, minimum width=0cm, minimum height=1cm,text centered, draw=black, fill=none]
\tikzstyle{boxsmall} = [rectangle, rounded corners, minimum width=0cm, minimum height=0cm,text centered, draw=black, fill=none]
\tikzstyle{nobox} = [rectangle, rounded corners, minimum width=0cm, minimum height=1cm,text centered, draw=none, fill=none]
\tikzstyle{doublearrow} = [thick,<->,>=stealth]
\tikzstyle{dottedarrow} = [thick,<->,>=stealth,dotted]



\input{introduction}
\input{Hopf}

\input{LQR}
\input{methodology}

\section{Numerical examples}\label{sec:numerics}
\input{numerics}
\input{example_continual}
\input{example_calibration}
\input{example_poisson}
\input{example_sindy}

\input{conclusion}


\section*{Acknowledgments}
P.C. is supported by the SMART Scholarship, which is funded by the Under Secretary of Defense/Research and Engineering (USD/R\&E), National Defense Education Program (NDEP) / BA-1, Basic Research. J.D., G.E.K., and Z.Z. are supported by the MURI/AFOSR FA9550-20-1-0358 project. We also acknowledge the support by award DOE-MMICS SEA-CROGS DE-SC0023191.


\bibliographystyle{siamplain}
\bibliography{references}

\appendix
\input{appendix_short}
\end{document}

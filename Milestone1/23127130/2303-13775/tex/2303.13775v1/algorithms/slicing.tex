
\begin{algorithm}[t]
\caption{graphSlicingPerGPU(ComputeGraph:cg, WorkloadMapOfGPU:W, StorageMapOFGPU:sf, gpuId:i)}
\begin{algorithmic}[1]
  \State $g = []$
  \For{$l_{id}  \in range(0,cg.layers())$}
    \State $u,v = cg[l_{id}].edges()$
    \State $lg = empty\_graph()$
    \If {$(l_{id} < c.layers()-1)$}
        \State {$ e_{id} = where(W[v]== i)$}
        \State {$lg.add((u[e_{id}],v[e_{id}]))$}
    \Else
        \State {$ missing = where(~sf[v,W[u]]) $}
        \State {$ extra = where(W[missing] == i)$}
        \State {$ lg.add(extra[u],extra[v])$}
        \State {$ natural = where(W[u] == i)$}
        \State {$ lg.add(nautral[u],natural[v]) $}
    \EndIf
    \State $layer_u = unique(u)$
    \For{$ j \in [0,4]$}
      \State{$nds = W[where(W[layer_u] == j)]$}
      \State{$lg.shuffle[j] = nds$}
    \EndFor
    \State $g.append(lg)$
  \EndFor
  \State $return (g)$
\end{algorithmic}
\end{algorithm}

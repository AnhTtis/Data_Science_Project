\begin{algorithm}[t]
\caption{SAGE for distributed graphs}
\begin{algorithmic}[1]
  \Function{push\_to\_owner}{$g:device$, $G^l_g$, $H_g$}
    \For{ $ i \neq g \land i \in [0,4]$}
        \State $ send(H^{g}[G^l_g.to[i]], dest = i)$
    \EndFor
    \For{$ i  \neq g \land i \in [0,4]$}
       \State $ H^{g}[G^l_g.from[i]] += recv(src = i)$
    \EndFor
    \Return $H^{g}[O^l_g]$
  \EndFunction
  \Function{push\_from\_owner}{$g:device$, $G^l_g$, $H_g$}
    \For  {$ i  \neq g \land i \in [0,4]$}
       \State $ send(H^{g}[G^l_g.from[i]], dest = i)$
    \EndFor
    \For  {$ i  \neq g \land i \in [0,4]$}
       \State $ H^{g}[G^l_g.to[i]]  = recv(src = i)$
    \EndFor
  \EndFunction
  \Function{GatherLayer}{}
    \Function{forward}{$H,G^l_g,g:device$}
        \State $H1 \gets gather(H,G^l_g)$
        \State $H2 \gets push\_to\_owner(H1, G^l_g)$
        \State \S\Return $H2[G[O^l_g]]$
    \EndFunction
    \Function{backward}{$H_g,G^l_g,g:device$}
        \State $H \gets empty $
        \State $H[G[O^l_g] \gets H_g $
        \State $H[G[R^l_g] \gets push\_from\_owner(H) $    
        \State $H1 \gets gather\_backward(H,G^l_g)$
        \State \Return $H1$
    \EndFunction
  \EndFunction
  \Function{ScatterLayer}{}
   \Function{forward}{$H,G^l_g,g:device$}
        \State $H1 \gets pull\_from\_self(H,G^l_g) $
        \State $H2 \gets push\_from\_owner(H1 $
        \State \Return $H2$
    \EndFunction
    \Function{backward}{$H_g,G^l_g,g:device$}
        \State $H2 \gets pull\_from\_owner $
        \State $H1 \gets (H,G^l_g) $
        \State \Return $ H2[G[O^l_g]] $
    \EndFunction
  \EndFunction
\end{algorithmic}
\end{algorithm}
\begin{algorithm}[t]
    \caption{Forward pass of split-parallel training.}
    \label{algo:sp-forward}
    \let\textnormal\ttfamily
    \footnotesize
    \DontPrintSemicolon
    \SetStartEndCondition{ }{}{}%
    \SetKwProg{Fn}{def}{\string:}{}
    \SetKwFunction{Range}{range}%%
    \SetKw{KwTo}{in}\SetKwFor{For}{for}{\string:}{}% \SetKwIF{If}{ElseIf}{Else}{if}{:}{elif}{else:}{}% \SetKwFor{While}{while}{:}{fintq}%
    \newcommand{\forcond}{\em l \KwTo [0, L-1]}
\AlgoDontDisplayBlockMarkers\SetAlgoNoEnd\SetAlgoNoLine%
    \SetKwFunction{dpfwpass}{dp\_forward}
    \SetKwFunction{splitfwpass}{sp\_forward}
    \SetKwFunction{local}{local\_unique}
    \SetKwFunction{csplit}{create\_upper\_split}
    \SetKwFunction{split}{{\color{turquoise} split}}
    \SetKwFunction{dst}{dst}
    \SetKwFunction{src}{src}
    \SetKwFunction{add}{add}
    \SetKwFunction{remap}{remap}    
    \SetKwFunction{getall}{getAll}    
    \SetKwFunction{shuffle}{\textbf{\color{purple}shuffle}}
    \SetKwFunction{splitidx}{shuffle\_idx}

    % \Fn{\dpfwpass{\em model, in\_feat, edges}}{
    %     hidden = in\_feat \;
    %     \For{\forcond}{
    %         gnn\_layer = model.layer[l]\;
    %         hidden = gnn\_layer(edges[l], hidden)\;
    %     }
    %     \Return hidden\;
    % }    
    % \;
    \Fn{\splitfwpass{\em model, feat, edges, \splitidx}}{
        hidden = feat\; \label{ln:input}
        \For{\forcond}{
            \textbf{\color{teal} gnn\_layer} = model.layer(l)\;
            mixed\_hidden = \shuffle{\splitidx[l], local\_hidden} \label{ln:shuffle}\;
            local\_hidden = \textbf{\color{teal} gnn\_layer}(edges[l], mixed\_hidden)\label{ln:layer}\;
        }
        \Return hidden;
    }    
\end{algorithm}

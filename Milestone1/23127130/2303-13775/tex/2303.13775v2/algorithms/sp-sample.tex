\begin{algorithm}[t]
    \caption{Split-parallel sampling.}
    \label{algo:sp-sample}
    \let\textnormal\ttfamily
    \footnotesize

    \DontPrintSemicolon
    \SetStartEndCondition{ }{}{}%
    \SetKwProg{Fn}{def}{\string:}{}
    \SetKwFunction{Range}{range}%%
    \SetKw{KwTo}{in}\SetKwFor{For}{for}{\string:}{}% \SetKwIF{If}{ElseIf}{Else}{if}{:}{elif}{else:}{}% \SetKwFor{While}{while}{:}{fintq}%
    \newcommand{\forcond}{\em l \KwTo [L-1, 0]}
\AlgoDontDisplayBlockMarkers\SetAlgoNoEnd\SetAlgoNoLine%
    \SetKwFunction{dpsample}{dp\_sample}
    \SetKwFunction{splitsample}{sp\_sample}
    \SetKwFunction{sneigh}{\textbf{\color{teal}sample\_layer}}
    \SetKwFunction{unique}{unique}
    \SetKwFunction{union}{union}
    \SetKwFunction{local}{local\_unique}
    \SetKwFunction{concat}{concat}
    \SetKwFunction{csplit}{\textbf{\color{purple} add}}
    \SetKwFunction{split}{\textbf{\color{purple} split}}
    \SetKwFunction{localfrontier}{local\_frontier}
    \SetKwFunction{dst}{dst}
    \SetKwFunction{src}{src}
    \SetKwFunction{add}{add}
    \SetKwFunction{remap}{remap}    
    \SetKwFunction{getall}{getAll}    
    \SetKwFunction{bsplit}{\textbf{create\_sp\_frontier}}
    \SetKwFunction{shuffleidx}{shuffle\_idx}


    % \Fn{\dpsample{\em local\_targets}}{
    %     front[L] = local\_targets\;
    %     local\_ids.\add{front[L]}\;
    %     \For{\forcond}{
    %         samp\_edges[l] = \\ $\quad$ \sneigh{front[l+1]}\;
    %         local\_ids.\add{\em samp\_edges[l].\dst{}}\;
    %         front[l] = local\_ids.\getall{}\;
    %         edges[l] = \\ $\quad$ local\_ids.\remap{samp\_edges[l]}\;
    %     }
    %     \Return front, edges\;
    % }    
    % \;
    \Fn{\splitsample{\em local\_targets}}{
        local\_front[L] = local\_targets\;
        \For{\forcond}{
            mixed\_front, edges[l] = \sneigh{local\_front[l+1]}\label{ln:sample}\;
            local\_front[l], edges[l], shuffle\_idx[l] = \split{mixed\_front, edges[l]}\label{ln:split}\;
        }
        \Return edges, \shuffleidx\;
    }    
\end{algorithm}

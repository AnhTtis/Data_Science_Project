\usepackage{hyperref,graphicx, amsmath,amssymb, amsthm, color, bm, bbm,dsfont,floatrow,enumerate,media9}
%\tcbuselibrary{theorems}
\usepackage[capitalise]{cleveref}
\usepackage[most]{tcolorbox}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{array}
\usepackage{calc}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
%\usepackage{subcaption} %Compatibility issue with subfigure
\usepackage{siunitx}
\usepackage{cancel}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
\usepackage{thmtools}
\usepackage{enumitem}
\usepackage{blindtext}
\declaretheoremstyle[
notefont=\bfseries, notebraces={}{},
bodyfont=\normalfont,
headformat=\NAME~\NUMBER:\NOTE
%,\nobreak=true
]{nopar}


% BOXED environments such as THMs, etc
% ====================================================================


\newtcbtheorem{boxthm}{Theorem}{
	enhanced,
	sharp corners,
	attach boxed title to top left={yshift=-\tcboxedtitleheight/2, xshift=3mm,yshifttext=-\tcboxedtitleheight/2},
	colback=white,
	colframe=red!20,
	coltitle=black,
	boxrule=0.7mm,
	fonttitle=\bfseries,
	boxed title style={
		sharp corners,
		size=small,
		colback=red!20,
		colframe=red!20,
	} 
}{thm}
\crefname{tcb@cnt@boxthm}{theorem}{theorems}

\newtcbtheorem{boxlem}{Lemma}{
	enhanced,
	sharp corners,
	attach boxed title to top left={yshift=-\tcboxedtitleheight/2, xshift=3mm,yshifttext=-\tcboxedtitleheight/2},
	colback=white,
	colframe=blue!20,
	coltitle=black,
	boxrule=0.7mm,
	fonttitle=\bfseries,
	boxed title style={
		sharp corners,
		size=small,
		colback=blue!20,
		colframe=blue!20,
	} 
}{lem}
\crefname{tcb@cnt@boxlem}{lemma}{lemmas}


\newtcbtheorem{boxprop}{Proposition}{
	enhanced,
	sharp corners,
	attach boxed title to top left={yshift=-\tcboxedtitleheight/2, xshift=3mm,yshifttext=-\tcboxedtitleheight/2},
	colback=white,
	colframe=blue!20,
	coltitle=black,
	boxrule=0.7mm,
	fonttitle=\bfseries,
	boxed title style={
		sharp corners,
		size=small,
		colback=blue!20,
		colframe=blue!20,
	} 
}{prop}
\crefname{tcb@cnt@boxprop}{proposition}{propositions}

\newtcbtheorem{boxdefn}{Definition}{
	enhanced,
	sharp corners,
	attach boxed title to top left={yshift=-\tcboxedtitleheight/2, xshift=3mm,yshifttext=-\tcboxedtitleheight/2},
	colback=white,
	colframe=green!55!black!15,
	coltitle=black,
	boxrule=0.7mm,
	fonttitle=\bfseries,
	boxed title style={
		sharp corners,
		size=small,
		colback=green!55!black!15,
		colframe=green!55!black!15,
	} 
}{defn}
\crefname{tcb@cnt@boxdefn}{definition}{definitions}

\newtcbtheorem{boxconj}{Conjecture}{
	enhanced,
	sharp corners,
	attach boxed title to top left={yshift=-\tcboxedtitleheight/2, xshift=3mm,yshifttext=-\tcboxedtitleheight/2},
	colback=white,
	colframe=yellow!20,
	coltitle=black,
	boxrule=0.7mm,
	fonttitle=\bfseries,
	boxed title style={
		sharp corners,
		size=small,
		colback=yellow!20,
		colframe=yellow!20,
	} 
}{conj}
\crefname{tcb@cnt@boxconj}{conjecture}{conjectures}

\newtcbtheorem{boxcoro}{Corollary}{
	enhanced,
	sharp corners,
	attach boxed title to top left={yshift=-\tcboxedtitleheight/2, xshift=3mm,yshifttext=-\tcboxedtitleheight/2},
	colback=white,
	colframe=red!20,
	coltitle=black,
	boxrule=0.7mm,
	fonttitle=\bfseries,
	boxed title style={
		sharp corners,
		size=small,
		colback=red!20,
		colframe=red!20,
	} 
}{coro}
\crefname{tcb@cnt@boxcoro}{corollary}{corollaries}

\newcounter{theo}
\newenvironment{theo}[1][]{%
	\refstepcounter{theo}%
	\ifstrempty{#1}%
	{\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=red!20]
				{\strut Theorem~\thetheo};}}
	}%
	{\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=red!20]
				{\strut Theorem~\thetheo:~#1};}}%
	}%
	\mdfsetup{innertopmargin=10pt,linecolor=red!20,%
		linewidth=2pt,topline=true,%
		frametitleaboveskip=\dimexpr-\ht\strutbox\relax
	}
	\begin{mdframed}[]\relax%
	}
	{\vspace{0.mm}\end{mdframed}
	}
\crefname{theo}{theorem}{theorems}

\newcounter{lembx}
\newenvironment{lembx}[1][]{%
	\refstepcounter{lembx}%
	\ifstrempty{#1}%
	{\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=blue!20]
				{\strut Lemma~\thelembx};}}
	}%
	{\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=blue!20]
				{\strut Lemma~\thelembx:~#1};}}%
	}%
	\mdfsetup{innertopmargin=10pt,linecolor=blue!20,%
		linewidth=2pt,topline=true,%
		frametitleaboveskip=\dimexpr-\ht\strutbox\relax
	}
	\begin{mdframed}[]\relax%
	}{
	\vspace{0.mm}\end{mdframed} 
}
\crefname{lembx}{lemma}{lemmas}


\newcounter{defbx}
\newenvironment{defbx}[1][]
{%
	\refstepcounter{defbx}%
	\nobreak
	\ifstrempty{#1}%
	{\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=green!20]
				{\strut Definition~\thedefbx};}}
	}%
	{\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=green!20]
				{\strut Definition~\thedefbx:~#1};}}%
	}%
	\mdfsetup{innertopmargin=10pt,linecolor=green!20,%
		linewidth=2pt,topline=true,%
		frametitleaboveskip=\dimexpr-\ht\strutbox\relax
	}
	\begin{mdframed}[]\relax%
	}{
	\end{mdframed} 
}
\crefname{defbx}{definition}{definitions}
\usepackage[framemethod=TikZ]{mdframed}
\usepackage[most]{tcolorbox}
\theoremstyle{plain}% default
\newtheorem{thm}{Theorem}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}
\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{rules}{Rules}
\newtheorem{conj}[thm]{Conjecture}
\newtheorem{exmp}{Example}
\crefname{thm}{theorem}{theorems}
%\declaretheorem[style=nopar]{protocol}
\newtheorem{protocol}{Protocol}
\newtheorem{subroutine}{Subroutine}
\crefname{subroutine}{subroutine}{subroutines}
\crefname{protocol}{protocol}{protocols}

% ===============================================================


\definecolor{nblue}{rgb}{0.2,0.2,0.7}
\definecolor{ngreen}{rgb}{0.1,0.5,0.1}%272
\definecolor{nred}{rgb}{0.8,0.2,0.2}%711
\definecolor{nblack}{rgb}{0,0,0}
\newcommand{\red}{\color{nred}}
\newcommand{\blu}{\color{nblue}}
\newcommand{\grn}{\color{ngreen}}
\newcommand{\blk}{\color{nblack}}

\DeclareMathOperator{\tr}{\mathrm{Tr}}
\DeclareMathOperator{\pr}{\mathrm{Pr}}
\usepackage{scalerel}
\usepackage{stackengine,wasysym}
\usepackage{pgf}
\newcommand\wtilde[1]{\ThisStyle{%
		\setbox0=\hbox{$\SavedStyle#1$}%
		\stackengine{-.1\LMpt}{$\SavedStyle#1$}{%
			\stretchto{\scaleto{\SavedStyle\mkern.2mu\AC}{.5150\wd0}}{.6\ht0}%
		}{O}{c}{F}{T}{S}%
}}
%\newcommand{\bs}[1]{\boldsymbol{#1}}
\newcommand{\hard}{{\rm hard}}
\newcommand{\echo}{{\rm echo}}
\newcommand{\ds}[1]{\mathds{#1}}
\newcommand{\dbar}[1]{\overline{\overline{#1}}}
\providecommand{\bra}[1]{\langle #1 |}
\providecommand{\ket}[1]{|#1 \rangle}
\providecommand{\col}[1]{\text{col}(#1)}
\providecommand{\kket}[1]{|#1 \rangle \rangle}
\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\bc}[1]{\bm{\mathcal{#1}}}
\newcommand{\bmc}[1]{\bm{\mathcal{#1}}}
\newcommand{\mbb}[1]{\mathbb{#1}}
\newcommand{\mbf}[1]{\mathbf{#1}}
\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}
\newcommand{\lv}{\lvert}
\newcommand{\inner}[2]{\left\langle#1,#2\right\rangle}
\newcommand{\abs}[1]{\left| #1 \right|}
\newcommand{\nlz}[1]{\underbar{$#1$}}
\newcommand{\rv}{\rvert}
\newcommand{\lV}{\lVert}
\newcommand{\rV}{\rVert}
\newcommand{\dla}{\langle\!\langle}
\newcommand{\dra}{\rangle\!\rangle}
%\newcommand{\unit}{\mathbb{I}}
\newcommand{\density}[1]{|#1\rangle\langle #1|}
\newcommand{\outpr}[2]{|#1\rangle\langle #2|}
\newcommand{\inpr}[1]{\langle #1 \rangle}
\newcommand{\braket}[2]{\langle #1 |#2\rangle}
\newcommand{\sgn}{\mathrm{sgn}}
\newcommand{\tn}[1]{^{\otimes #1}}
\newcommand{\ct}{^{\dagger}}
\newcommand{\infid}[2]{r(#1,#2)}
\newcommand{\pinfid}[2]{\delta F_{\rm proc}\left(#1,#2\right)}
\newcommand{\fid}[2]{F_{\rm avg}\left(#1,#2\right)}
\newcommand{\punit}[1]{u_{\rm P}\left(#1\right)}
\newcommand{\pfid}[2]{F_{\rm P}\left(#1, #2\right)}
\newcommand{\suprate}[1]{\gamma_{#1}}
\newcommand{\nsuprate}[1]{\tilde{\gamma}_{#1}}
\newcommand{\av}[1]{\left\lvert #1\right\rvert}
\newcommand{\gp}[1]{{\mathbb{#1}}} % Group notation
\newcommand{\set}[1]{\mathbb{#1}} % set notation
\newcommand{\ensavg}[1]{\left\langle #1 \right\rangle}
\newcommand{\ch}[1]{#1} % Channel notation
\newcommand{\ncore}[1]{\tilde{L}^{({\rm core})}(#1)} % Channel notation
\newcommand{\nprep}[1]{\tilde{L}^{({\rm prep})}(#1)}
\newcommand{\nmeas}[2]{\tilde{L}^{({\rm meas})}_{#2}(#1)}
\newcommand{\nch}[1]{\tilde{#1}} % Noisy Channel notation
\newcommand{\vardbtilde}[1]{\tilde{\raisebox{0pt}[0.85\height]{$\tilde{#1}$}}}
\newcommand{\mmch}[1]{\vardbtilde{#1}}
\newcommand{\probdrb}[1]{\Omega({#1})}
\newcommand{\nshot}[0]{N_{\rm shots}}
\newcommand{\error}[1]{\mc E_{#1}}
\newcommand{\avg}[1]{\left\langle {#1} \right \rangle}
\newcommand{\state}[1]{| #1 \dra}
\newcommand{\povm}[1]{\dla #1 |}
\newcommand{\qinner}[2]{\dla #1| #2 \dra}
\newcommand{\depol}[1]{{{\text{Depol}}({#1})}}
\newcommand{\mm}[1]{\textbf{MM}(#1)}

\newcommand{\twirlmat}[3]{{#1}_{#2}} % twirl matrix notation
\newcommand{\xtwirlmat}[3]{{\rm{x}}{#1}_{#2}} % x-twirl matrix notation
\newcommand{\xtwirl}[3]{{\rm{x}}{#1}_{#2}} % x-twirl  notation
\newcommand{\twirl}[3]{{#1}_{#2}} % twirl notation
\newcommand{\ntwirl}[3]{\tilde{#1}_{#2}} % noisy twirl notation
\newcommand{\nxtwirl}[3]{{\rm{x}}\tilde{#1}_{#2}} % noisy x-twirl notation
\renewcommand{\vec}[1]{\text{vec}\left(#1\right)} % vec notation
\newcommand{\sector}[3]{#1_{(#2,#3)}}
\newcommand{\trans}[2]{t_{#1 \rightarrow #2}}
\newcommand{\inhomo}[2]{m_{#1 \rightarrow #2}}

\definecolor{qbblue}{RGB}{38,151,208} %glaucous, 97,130,181, #6182B5 rgba(38,151,208,255)
\definecolor{darkblue}{RGB}{17, 42, 60} % 112A3C
\definecolor{red}{RGB}{175, 49, 39} % AF3127

\definecolor{orange}{RGB}{217, 156, 55} % D99C37
\definecolor{qbgreen}{RGB}{66,184,99} % 90A954
\definecolor{palegreen}{RGB}{197, 184, 104} 
\definecolor{marigold}{RGB}{239,160,11}% C5B868
\definecolor{ored}{RGB}{254,95,85}

\definecolor{yellow}{RGB}{250, 199, 100} % FAC764
\definecolor{brokenwhite}{RGB}{218, 192, 166} % DAC0A6
\definecolor{brokengrey}{rgb}{0.77, 0.76, 0.82} % {196,194,209}, C4C2D1


\newcommand{\mat}[2]{\left(\begin{array}{#1} #2\end{array}\right)}

\newcommand{\hidden}[1]{}
\newcommand{\flag}[1]{\textbf{\red(#1)\blk}}
\newcommand{\cn}{$^{[{\blu citation\ needed}]}$}
\newcommand{\real}[0]{\set{R}\text{eal}}

\newcommand{\arnaud}[1]{\textcolor{blue}{#1}}
\newcommand{\shashank}[1]{\textcolor{red}{#1}}
\newcommand{\patrick}[1]{\textcolor{violet}{#1}}

\newcommand{\fontten}{\fontsize{10pt}{12pt}\selectfont}
\newcommand{\fonteleven}{\fontsize{11pt}{11pt}\selectfont}
\newcommand\scalemath[2]{\scalebox{#1}{\mbox{\ensuremath{\displaystyle #2}}}}
\newcommand{\aoe}[1]{A\left(  #1 \right)}

% MACRO for citation bundles:
\newcommand{\dd}[0]{{CarrPurcell1954,MG1958,Viola1998,Viola1999,VLK1999,Viola2003,KL2005,Uhrig2007,West2010,Yang2011}} %Dynamical decoupling

\newcommand{\mitigation}[0]{{LiBenjamin2017,Temme2017,Dumitrescu2018,Endo2018,GT2020,He2020,Cai_2021a,Cai_2021b,Cai_2021d,Strickis2021,Huggins_2021,Koczor_2021a,Koczor_2021b,Obrien2021,Ferracin2022,HuoLi2022,cai_2022,Kurita2022}} %Mitigation

\newcommand{\calibration}[0]{{Kelly2018,Klimov2020}} %Calibration
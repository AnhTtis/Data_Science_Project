% !TEX root = ./../paper.tex
%
%
%
\section{Text-to-Image Generative Models}
\label{sub:training_t2i}
After training the first stage of VDL, we leverage the approximate posterior distribution of text features,  $q_{\phi^{\bzt}}( \bzt | \bzi)$, for the unsupervised training of T2I models.
For a T2I generation model with trainable parameters $\theta^{\bxi}$, we maximize \eqref{eq:vi_detail} with respect to $\theta^{\bxi}$, which is equivalent to solve the following problem:
%
\begin{align}
\max_{\theta^{\bxi}} \mathbb{E}_{q_{\phi^{\bzt}}( \bzt | \bzi)} [ \log p_{\theta^{\bxi}}(\bxi | \bzi, \bzt)], 
\end{align}
%
where $p_{\theta^{\bxi}}(\bxi | \bzi, \bzt)$ is a T2I generative model. 
Figure~\ref{fig:framework_b} and \ref{fig:framework_c} illustrate the inference procedures for training and testing, respectively.




Contrary to the existing methods such as CLIP-GEN~\cite{wang2022clip} and LAFITE~\cite{zhou2022towards}, which rely only on $\bzt$ for conditional image generation, our approach utilizes $\bzi$ as well as $\bzt$ for conditioning, resulting in better generalization performance thanks to the additional information for the image.
In our framework, $\bzih$ is reconstructed by the learned model, $p_{\theta^{\bzi}}(\bzi | \bzt)$, during inference, and then an image $\bxi$ is finally obtained from the optimized generator, $p_{\theta^{\bxi}}(\bxi | \bzih, \bzt)$.


For a T2I model, we employ StyleGAN2~\cite{karras2020analyzing} while Latent Diffusion Model (LDM)~\cite{LDM} is also adopted, where the experimental results of LDM are provided in the supplementary material. 
When the StyleGAN2 synthesizes images conditioned on text, we replace each style vector $\mathbf{s}^u$ with its conditional counterpart $\mathbf{s}^c$ following~\cite{zhou2022towards}, which is formally given by
%
\begin{equation}
\mathbf{s}^c = h([\mathbf{s}^u ; g([\bzt;\bzi])]),
\end{equation}
%
where $h(\cdot)$ denotes an affine transform, $g(\cdot)$ is a neural network with two fully-connected layers, and $[\cdot;\cdot]$ is the concatenation operator.

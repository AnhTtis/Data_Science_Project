\documentclass[fleqn, preprint,review,11pt]{elsarticle}

\input{preamble}

\begin{document}

\begin{frontmatter}

\title{Non-intrusive Hybrid Scheme for Multiscale Heat Transfer: Thermal Runaway in a Battery Pack}                      

\author[1]{Yinuo Noah Yao\corref{contrib}}
\cortext[cor1]{Corresponding author}
\cortext[contrib]{Current address: Department of Civil and Environmental Engineering, Texas A\&M University, College Station, TX 77840, USA}
\author[2]{Perry Harabin}
\author[2]{Morad Behandish} 
\author[1]{Ilenia Battiato\corref{cor1}}

\address[1]{Department of Energy Science and Engineering, Stanford University, Stanford, CA 94305, USA}
\address[2]{Palo Alto Research Center (PARC), Palo Alto, CA 94305, USA}
% \address[3]{Department of Civil and Environmental Engineering, Texas A\&M University, College Station, TX 77840, USA}
\input{abstract}

\end{frontmatter}

\input{intro}
\input{metrics} % Morad is working on this
\input{equations}
\input{thermal}
\input{conclusion}

\section*{Acknowledgments}
This material is based upon work supported by the Defense Advanced Research Projects Agency (DARPA) under Agreement No. HR00112090061. The views, opinions and/or findings expressed are those of the authors and should not be interpreted as representing the official views or policies of the Department of Defense or U.S. Government. We also would like to thank Kyle Pietrzyk for the valuable inputs and feedbacks provided throughout all the stages of this work.

\newpage
\appendix

\input{BCs_pack_temp}
\input{BCs_cell_temp}
\input{closure}
\input{accuracy}
\input{coupling}

\newpage
\bibliographystyle{elsarticle-num}
%\bibliography{library_new}
\begin{thebibliography}{10}
\expandafter\ifx\csname url\endcsname\relax
  \def\url#1{\texttt{#1}}\fi
\expandafter\ifx\csname urlprefix\endcsname\relax\def\urlprefix{URL }\fi
\expandafter\ifx\csname href\endcsname\relax
  \def\href#1#2{#2} \def\path#1{#1}\fi

\bibitem{Langlo1994-wq}
P.~Langlo, M.~S. Espedal, {Macrodispersion for two-phase, immiscible flow in
  porous media}, Adv. Water Resour. 17~(5) (1994) 297--316.
\newblock \href {https://doi.org/10.1016/0309-1708(94)90033-7}
  {\path{doi:10.1016/0309-1708(94)90033-7}}.

\bibitem{Vasilyeva2019-wh}
M.~Vasilyeva, E.~T. Chung, S.~W. Cheung, Y.~Wang, G.~Prokopev, {Nonlocal
  multicontinua upscaling for multicontinua flow problems in fractured porous
  media}, J. Comput. Appl. Math. 355 (2019) 258--267.
\newblock \href {https://doi.org/10.1016/j.cam.2019.01.024}
  {\path{doi:10.1016/j.cam.2019.01.024}}.

\bibitem{Das2005-gm}
D.~B. Das, S.~M. Hassanizadeh (Eds.), {Upscaling Multiphase Flow in Porous
  Media: From Pore to Core and Beyond}, Springer, Dordrecht, 2005.
\newblock \href {https://doi.org/10.1007/1-4020-3604-3}
  {\path{doi:10.1007/1-4020-3604-3}}.

\bibitem{Frippiat2008-cl}
C.~C. Frippiat, A.~E. Holeyman, {A comparative review of upscaling methods for
  solute transport in heterogeneous porous media}, J. Hydrol. 362~(1) (2008)
  150--176.
\newblock \href {https://doi.org/10.1016/j.jhydrol.2008.08.015}
  {\path{doi:10.1016/j.jhydrol.2008.08.015}}.

\bibitem{Battiato2019-xk}
I.~Battiato, P.~T. Ferrero, V, D.~O'~Malley, C.~T. Miller, P.~S. Takhar, F.~J.
  Vald{\'e}s-Parada, B.~D. Wood, {Theory and applications of macroscale models
  in porous media}, Transp. Porous Media 130~(1) (2019) 5--76.
\newblock \href {https://doi.org/10.1007/s11242-019-01282-2}
  {\path{doi:10.1007/s11242-019-01282-2}}.

\bibitem{Battiato2011-ad}
I.~Battiato, D.~M. Tartakovsky, {Applicability regimes for macroscopic models
  of reactive transport in porous media}, J. Contam. Hydrol. 120-121 (2011)
  18--26.
\newblock \href {https://doi.org/10.1016/j.jconhyd.2010.05.005}
  {\path{doi:10.1016/j.jconhyd.2010.05.005}}.

\bibitem{Pietrzyk2021-lu}
K.~Pietrzyk, S.~Korneev, M.~Behandish, I.~Battiato, {Upscaling and Automation:
  Pushing the Boundaries of Multiscale Modeling through Symbolic Computing},
  Transp. Porous Media (Aug. 2021).
\newblock \href {https://doi.org/10.1007/s11242-021-01628-9}
  {\path{doi:10.1007/s11242-021-01628-9}}.

\bibitem{Boso2013-ag}
F.~Boso, I.~Battiato, {Homogenizability conditions for multicomponent reactive
  transport}, Adv. Water Resour. 62 (2013) 254--265.
\newblock \href {https://doi.org/10.1016/j.advwatres.2013.07.014}
  {\path{doi:10.1016/j.advwatres.2013.07.014}}.

\bibitem{Battiato2011-zo}
I.~Battiato, D.~M. Tartakovsky, A.~M. Tartakovsky, T.~D. Scheibe, {Hybrid
  models of reactive transport in porous and fractured media}, Adv. Water
  Resour. 34~(9) (2011) 1140--1150.
\newblock \href {https://doi.org/10.1016/j.advwatres.2011.01.012}
  {\path{doi:10.1016/j.advwatres.2011.01.012}}.

\bibitem{Yousefzadeh2017-yc}
M.~Yousefzadeh, I.~Battiato, {Physics-based hybrid method for multiscale
  transport in porous media}, J. Comput. Phys. 344 (2017) 320--338.
\newblock \href {https://doi.org/10.1016/j.jcp.2017.04.055}
  {\path{doi:10.1016/j.jcp.2017.04.055}}.

\bibitem{Roubinet2013-fg}
D.~Roubinet, D.~M. Tartakovsky, {Hybrid modeling of heterogeneous geochemical
  reactions in fractured porous media}, Water Resour. Res. 49~(12) (2013)
  7945--7956.
\newblock \href {https://doi.org/10.1002/2013wr013999}
  {\path{doi:10.1002/2013wr013999}}.

\bibitem{Pettersson2013-ou}
P.~Pettersson, G.~Iaccarino, J.~Nordstr{\"o}m, {An intrusive hybrid method for
  discontinuous two-phase flow under uncertainty}, Comput. Fluids 86 (2013)
  228--239.
\newblock \href {https://doi.org/10.1016/j.compfluid.2013.07.009}
  {\path{doi:10.1016/j.compfluid.2013.07.009}}.

\bibitem{Kadeethum2022-ag}
T.~Kadeethum, F.~Ballarin, Y.~Choi, D.~O'Malley, H.~Yoon, N.~Bouklas,
  {Non-intrusive reduced order modeling of natural convection in porous media
  using convolutional autoencoders: Comparison with linear subspace
  techniques}, Adv. Water Resour. 160 (2022) 104098.
\newblock \href {https://doi.org/10.1016/j.advwatres.2021.104098}
  {\path{doi:10.1016/j.advwatres.2021.104098}}.

\bibitem{DARPACOMPMods}
DARPA, \href{https://www.darpa.mil/program/computable-models}{Computable models
  (comp mods) (archived)}, https://www.darpa.mil/program/computable-models
  [cited 25.2.2023].
\newline\urlprefix\url{https://www.darpa.mil/program/computable-models}

\bibitem{Feng2018-ix}
X.~Feng, M.~Ouyang, X.~Liu, L.~Lu, Y.~Xia, X.~He, {Thermal runaway mechanism of
  lithium ion battery for electric vehicles: A review}, Energy Storage
  Materials 10 (2018) 246--267.
\newblock \href {https://doi.org/10.1016/j.ensm.2017.05.013}
  {\path{doi:10.1016/j.ensm.2017.05.013}}.

\bibitem{Ren2018-zj}
D.~Ren, X.~Liu, X.~Feng, L.~Lu, M.~Ouyang, J.~Li, X.~He, {Model-based thermal
  runaway prediction of lithium-ion batteries from kinetics analysis of cell
  components}, Appl. Energy 228 (2018) 633--644.
\newblock \href {https://doi.org/10.1016/j.apenergy.2018.06.126}
  {\path{doi:10.1016/j.apenergy.2018.06.126}}.

\bibitem{Kong2021-sb}
D.~Kong, G.~Wang, P.~Ping, J.~Wen, {Numerical investigation of thermal runaway
  behavior of lithium-ion batteries with different battery materials and
  heating conditions}, Appl. Therm. Eng. 189 (2021) 116661.
\newblock \href {https://doi.org/10.1016/j.applthermaleng.2021.116661}
  {\path{doi:10.1016/j.applthermaleng.2021.116661}}.

\bibitem{Guo2019-td}
Z.~Guo, Z.~Sun, N.~Zhang, M.~Ding, S.~Shi, {CFD analysis of fluid flow and
  particle-to-fluid heat transfer in packed bed with radial layered
  configuration}, Chem. Eng. Sci. 197 (2019) 357--370.
\newblock \href {https://doi.org/10.1016/j.ces.2018.12.034}
  {\path{doi:10.1016/j.ces.2018.12.034}}.

\bibitem{Yousefzadeh2023-rg}
M.~Yousefzadeh, Y.~Yao, I.~Battiato, {A level-set immersed boundary method for
  reactive transport in complex topologies with moving interfaces}, J. Comput.
  Phys. 478~(111958) (2023) 111958,
\newblock \href {https://doi.org/10.1016/j.jcp.2023.111958}
  {\path{doi:10.1016/j.jcp.2023.111958}}.

\bibitem{Pietrzyk2023-ou}
K.~Pietrzyk, G.~Bucci, M.~Behandish, I.~Battiato, {Automated Upscaling via
  Symbolic Computing for Thermal Runaway Analysis in Li-ion Battery Modules}, J. Comput. Sci. (2023), Accepted.

\bibitem{Alnaes2009-ty}
M.~S. Alnaes, A.~Logg, K.~A. Mardal, O.~Skavhaug, H.~P. Langtangen, {Unified
  framework for finite element assembly}, Int. J. Comput. Sci. Eng. 4~(4)
  (2009) 231.
\newblock \href {https://doi.org/10.1504/ijcse.2009.029160}
  {\path{doi:10.1504/ijcse.2009.029160}}.

\bibitem{Alnaes2014-kl}
M.~S. Alnaes, A.~Logg, K.~B. {\O}lgaard, M.~E. Rognes, G.~N. Wells, {Unified
  form language: A domain-specific language for weak formulations of partial
  differential equations}, ACM Trans. Math. Softw. 40~(2) (2014) 1--37.
\newblock \href {https://doi.org/10.1145/2566630} {\path{doi:10.1145/2566630}}.

\bibitem{Alnaes2015-hx}
M.~Aln{\ae}s, J.~Blechta, J.~Hake, A.~Johansson, B.~Kehlet, A.~Logg,
  C.~Richardson, J.~Ring, M.~E. Rognes, G.~N. Wells, {The FEniCS Project
  Version 1.5}, Anschnitt 3~(100) (Dec. 2015).
\newblock \href {https://doi.org/10.11588/ans.2015.100.20553}
  {\path{doi:10.11588/ans.2015.100.20553}}.

\bibitem{Kirby2004-xd}
R.~C. Kirby, {Algorithm 839: FIAT, a new paradigm for computing finite element
  basis functions}, ACM Trans. Math. Softw. 30~(4) (2004) 502--516.
\newblock \href {https://doi.org/10.1145/1039813.1039820}
  {\path{doi:10.1145/1039813.1039820}}.

\bibitem{Kirby2006-el}
R.~C. Kirby, A.~Logg, {A compiler for variational forms}, ACM Trans. Math.
  Softw. 32~(3) (2006) 417--444.
\newblock \href {https://doi.org/10.1145/1163641.1163644}
  {\path{doi:10.1145/1163641.1163644}}.

\bibitem{Olgaard2010-pd}
K.~B. {\O}lgaard, G.~N. Wells, {Optimizations for quadrature representations of
  finite element tensors through automated code generation}, ACM Trans. Math.
  Softw. 37~(1) (2010) 1--23.
\newblock \href {https://doi.org/10.1145/1644001.1644009}
  {\path{doi:10.1145/1644001.1644009}}.

\bibitem{Logg2010-mw}
A.~Logg, G.~N. Wells, {DOLFIN: Automated finite element computing}, ACM Trans.
  Math. Softw. 37~(2) (2010) 1--28.
\newblock \href {https://doi.org/10.1145/1731022.1731030}
  {\path{doi:10.1145/1731022.1731030}}.

\bibitem{Logg2012-ul}
A.~Logg, K.-A. Mardal, G.~Wells, {Automated Solution of Differential Equations
  by the Finite Element Method: The FEniCS Book}, Springer Berlin Heidelberg,
  2012.
\newblock \href {https://doi.org/10.1007/978-3-642-23099-8}
  {\path{doi:10.1007/978-3-642-23099-8}}.

\bibitem{Howes1985-nr}
F.~A. Howes, S.~Whitaker, {The spatial averaging theorem revisited}, Chem. Eng.
  Sci. 40~(8) (1985) 1387--1392.
\newblock \href {https://doi.org/10.1016/0009-2509(85)80078-6}
  {\path{doi:10.1016/0009-2509(85)80078-6}}.

\bibitem{Arnold1982-pq}
D.~N. Arnold, {An Interior Penalty Finite Element Method with Discontinuous
  Elements}, SIAM J. Numer. Anal. 19~(4) (1982) 742--760.
\newblock \href {https://doi.org/10.1137/0719052} {\path{doi:10.1137/0719052}}.

\end{thebibliography}

\end{document}

This section describes the modeling of the power system dynamics and the implementation of the different elements of the simulator.

\subsection{Power system modeling}
As an example for a dynamic component, we consider a two-axis generator model as modeled in \cite{sauer_power_1998}
\begin{subequations}\label{eq:generator_model}
\begin{align}
     \begin{bmatrix} \scriptstyle T'_{do} \\ \scriptstyle T'_{qo} \\ \scriptstyle 1 \\ \scriptstyle 2H \end{bmatrix} \frac{d}{dt}& \begin{bmatrix} \scriptstyle E'_q \\ \scriptstyle E'_d\\ \scriptstyle \delta \\ \scriptstyle \Delta \omega \end{bmatrix} =\begin{bmatrix} \scriptstyle -E'_q - (X_d - X'_d) I_d + E_{fd} \\ \scriptstyle -E'_d + (X_q - X'_q) I_q \\ \scriptstyle \omega_s \Delta \omega \\ \scriptstyle P_m - E'_d I_d - E'_q I_q - (X'_q - X'_d) I_d I_q - D \Delta \omega \end{bmatrix}\label{eq:generator_model_f}\\
    \begin{bmatrix}
        I_d \\ I_q
    \end{bmatrix} &= \begin{bmatrix}
        R_s & -X'_q \\
        X'_d & R_s
    \end{bmatrix}^{-1} \begin{bmatrix}
        E'_d - V \sin{(\delta - \theta)}\\
        E'_q - V \cos{(\delta - \theta)}
    \end{bmatrix}\label{eq:generator_model_h1}\\
    \Bar{I} &= (I_D + j I_Q) = (I_d + j I_q) e^{j(\delta - \pi/2)}\label{eq:generator_model_h2}.
\end{align}
\end{subequations}
\labelcref{eq:generator_model_f} corresponds to \labelcref{eq:DE_power_f} and \labelcref{eq:generator_model_h1,eq:generator_model_h2} to \labelcref{eq:DE_power_h} For this study, we simplify above model to a classical model by setting the reactances to $X'_q = X'_d$ and $X_q = X'_d$ and then finding the integral manifold such that the internal voltages $E'_q$ and $E'_d$ remain constant at $E'_{q0}$ and $E'_{d0}=0$. For more details we refer to \cite{sauer_power_1998}. Now, the rotor angle $\delta$ and the frequency deviation $\Delta \omega$ form the state $\bm{x}_i$, the magnitude $V$ and angle $\theta$ of the terminal voltage form $\bm{y}_i$, and the mechanical power $P_m$ and the excitation voltage $E_{fd}$ form the control input $\bm{u}_i$. More detailed models could include higher order electro-mechanical modes, governor dynamics for $P_m$ and exciter dynamics $E_{fd}$. Similarly, inverter-based resources or voltage dependent loads could be included. The results presented in \cref{subsec:results_predictors} are based on the parameters of generator 1 in \cref{tbl:generator_parameters}. 
\input{tables/generator_parameters.tex}
To illustrate the full multi-step simulator, we consider the IEEE 9-bus system described in \cite[pp.~164--167]{sauer_power_1998} with three generators (all modeled as classical model as above) with parameters from \cref{tbl:generator_parameters}. The initial conditions $\bm{x}_0$ and control inputs $\bm{u}$ are determined from assuming an equilibrium state for the used load flow case. To perturb the system, we reduce the mechanical power $P_m$ of generator 2 to 80\% of its initial value and then observe the trajectory for \SI{2.5}{\second} as shown in \cref{fig:ieee9_prediction}.

\subsection{State predictors}
We test three state predictors, namely a \gls{NN} with 3 layers and 32 neurons per layer, and two \gls{RK}-based predictors. They are the \gls{FE}, and \gls{RK4} schemes. In all cases the complex voltage is approximated by linear functions, i.e., $r=1$ in \labelcref{eq:voltage_parametrisation} resulting in $|\yparams{}| = 4$.

\subsection{Implementation and NN training}
A central functionality we use is \gls{AD}, therefore, the entire simulator is implemented in PyTorch \cite{paszke_pytorch_2019}. It furthermore provides the \gls{ML} framework to train the \gls{NN} models. For each generator we used 2500 simulated points, that we split into training (64\%), validation (16\%) and testing (20\%) datasets. Each generator surrogate model is trained for a range of possible linear voltage parametrizations, initial conditions, and prediction time-steps, which results in a seven dimensional input space. The training function includes a physics regularization term with evaluates how well the prediction aligns with the governing equations \labelcref{eq:DE_power_f}, known as \glspl{PINN}. We train, using a L-BFGS optimizer, for 2000 epochs in about 10 minutes. The published code base \cite{stiasny_publicly_2022} provides a detailed overview of the dataset creation setup and the training procedure. The timing of the simulations is conducted on a AMD Ryzen 7 PRO (1.9 GHz, 8 cores) and 16GB RAM. The numerical simulations of the system of \glspl{DAE} are implemented using Assimulo \cite{andersson_assimulo_2015}.

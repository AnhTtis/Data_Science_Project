\begin{algorithm}
\caption{Multi-step simulator}

{\small \textbf{Require:}
$\bm{x}_0$, $t_0$, $t_{\max}$, $\Delta t$\\
\textbf{Initialize:} $\bm{x}'_0 = \bm{x}_0$, $t' = t_0$, $T_{\text{eval}}$
\begin{algorithmic}[1]\label{algo:simulator}
\While{$t' \leq t_{\max}$}
\State Define collocation points $\bm{T}(t',\Delta t)$
\State Calculate voltage parametrization $\yparams{}(\bm{T}, \bm{x}'_0) $
\State Store trajectory $[T_{\text{eval}}, \xhat{}(\bm{x}'_0, T_{\text{eval}}, \yparams)]$
\State Update $\bm{x}'_0 \leftarrow \xhat{}(\bm{x}'_0, \Delta t, \yparams)$ and $t' \leftarrow t' + \Delta t$
\EndWhile {\bf end}

\State \Return Trajectory

\end{algorithmic}}
\end{algorithm}

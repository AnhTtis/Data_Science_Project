\begin{algorithm}
\caption{PINNSim - single time step}

{\small \textbf{Require:}
$\bm{x}_0$, $t_0$, $t_{\max}$, $\Delta t$, $s$, $r$, $\Delta \Vparams^{\max}$, $k^{\max}$\\
\textbf{Initialise:} $k = 0, \Vparamsiter{0}, \Delta \Vparamsiter{0}$
\begin{algorithmic}[1]\label{algo:simulator}
\While{$\Delta \Vparamsiter{k} > \Delta \Vparams^{\max}$ and $k < k^{\max}$}
\For{component $i = 1,\dots, m$ \& query points $j = 1, .., s$}
% \For{query points $j = 1, \dots, s$}
\State Predict state with PINN $\xstatehati{i}(t_j, \xinitiali{i}, \Vparamsiteri{k}{i})$
\State Calculate component injections $\IcomplexComponentHati{i} = h_i(t_j, \xstatehati{i}, \Vparamsiteri{k}{i})$
\State Calculate contribution of $\IcomplexComponentHati{i}$ to \Jacobian{}
% \EndFor {\bf end}
\EndFor {\bf end}
\For{query points $j = 1, \dots, s$}
\State Calculate network injections $\IcomplexNetworkHat(t_j, \Vparamsiter{k})$
\State Calculate contribution of $\IcomplexNetworkHat$ to \Jacobian{} 
\EndFor {\bf end}
\State Assemble \Jacobian{} and solve $\left(\bm{J}^\top \bm{J}\right) \Delta \Vparamsiter{k+1} = - \bm{J} \residualError$
\State Update iteration $\Vparamsiter{k+1}=\Vparamsiter{k} + \Delta \Vparamsiter{k}$, $k = k + 1$
\EndWhile {\bf end}
\State \Return Trajectory across time step $t, \xstatehat{}(t), \Vcomplexhat{}(t)$ with \Vparamsiter{\text{final}}
% \State Update $\bm{x}'_0 \leftarrow \xstatehat{}(\bm{x}'_0, \Delta t, \Vparams)$ and $t' \leftarrow t' + \Delta t$
% \EndWhile {\bf end}

% \State \Return Trajectory

\end{algorithmic}}
\end{algorithm}

\section{Case study}\label{sec:case_study}

This section describes the modelling of the power system dynamics and the implementation of PINNSim.

\subsection{Power system modelling}
As an example for a dynamic component, we consider a two-axis generator model as modelled in \cite{sauer_power_1998}.
\begin{subequations}\label{eq:generator_model}
\begin{align}
     \begin{bmatrix} \scriptstyle T'_{do} \\ \scriptstyle T'_{qo} \\ \scriptstyle 1 \\ \scriptstyle 2H \end{bmatrix} \frac{d}{dt}& \begin{bmatrix} \scriptstyle E'_q \\ \scriptstyle E'_d\\ \scriptstyle \delta \\ \scriptstyle \Delta \omega \end{bmatrix} =\begin{bmatrix} \scriptstyle -E'_q - (X_d - X'_d) I_d + E_{fd} \\ \scriptstyle -E'_d + (X_q - X'_q) I_q \\ \scriptstyle \omega_s \Delta \omega \\ \scriptstyle P_m - E'_d I_d - E'_q I_q - (X'_q - X'_d) I_d I_q - D \Delta \omega \end{bmatrix}\label{eq:generator_model_f}\\
    \begin{bmatrix}
        I_d \\ I_q
    \end{bmatrix} &= \begin{bmatrix}
        R_s & -X'_q \\
        X'_d & R_s
    \end{bmatrix}^{-1} \begin{bmatrix}
        E'_d - V \sin{(\delta - \theta)}\\
        E'_q - V \cos{(\delta - \theta)}
    \end{bmatrix}\label{eq:generator_model_h1}\\
    \Bar{i}^C &= (I_D + j I_Q) = (I_d + j I_q) e^{j(\delta - \pi/2)}\label{eq:generator_model_h2}.
\end{align}
\end{subequations}
\labelcref{eq:generator_model_f} corresponds to \labelcref{eq:f_update_power_system} and \labelcref{eq:generator_model_h1,eq:generator_model_h2} to \labelcref{eq:h_update_power_system}. For this study, we simplify the model above to a classical machine model by setting the reactances to $X'_q = X'_d$ and $X_q = X'_d$ and then finding the integral manifold such that the internal voltages $E'_q$ and $E'_d$ remain constant at $E'_{q0}$ and $E'_{d0}=0$. For more details we refer to \cite{sauer_power_1998}. Now, the rotor angle $\delta$ and the frequency deviation $\Delta \omega$ form the state \xstatei{i}, the magnitude $V$ and angle $\theta$ of the terminal voltage form \Vcomplexi{i}, and the mechanical power $P_m$ and the excitation voltage $E_{fd}$ form the control input \ustatei{i}. More detailed models could include higher order electro-mechanical modes, governor dynamics for $P_m$ and exciter dynamics $E_{fd}$. Similarly, inverter-based resources or voltage dependent loads could be included.

To illustrate PINNSim, we consider the IEEE 9-bus system described in \cite[pp.~164--167]{sauer_power_1998} with three generators (all modelled as classical machines as above) with parameters from \cref{tbl:generator_parameters}. The initial conditions \xinitiali{i} and control inputs \ustatei{} are determined from assuming an equilibrium state for the load flow case in \cite{sauer_power_1998}. To perturb the system, we reduce the mechanical power $P_m$ of generator 1 to 50\% of its initial value and then observe the resulting trajectory.
\input{tables/generator_parameters.tex}

\subsection{Implementation and NN training}
The entire simulator is implemented in PyTorch \cite{paszke_pytorch_2019} as we utilise \gls{AD} for the computation of the Jacobian \Jacobian{} and it enables the training of the \gls{PINN} models. For each generator we used 2500 simulated points in the training dataset $\mathcal{D}$ and 5000 collocation points. Each \gls{PINN} consists of 2 hidden layers with 32 neurons, uses a $\tanh{}$ activation function, and is trained for a range of possible voltage parametrisations \Vparamsi{i} with $r=2$, initial conditions \xinitiali{i}, and prediction time steps $\Delta t \in [0, 0.3] \si{\second}$, which results in a nine-dimensional input space. We train, using a L-BFGS optimiser, for 2000 epochs. The published code base \cite{stiasny_publicly_2022} provides a detailed overview of the dataset creation setup and the training procedure.
% The timing of the simulations is conducted on a AMD Ryzen 7 PRO (1.9 GHz, 8 cores) and 16GB RAM. 
The numerical simulations of the system of \glspl{DAE} that serve as ground truth are implemented using Assimulo \cite{andersson_assimulo_2015}. As a comparison to PINNSim, we implement a trapezoidal integration scheme, see \cite{milano_power_2010}.

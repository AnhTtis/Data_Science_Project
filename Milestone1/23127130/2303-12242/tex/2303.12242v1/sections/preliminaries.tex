\section{Preliminaries}
\label{sec:preliminaries}

% \subsection{Acronyms/Initialisms}
\input{sections/acronym}

\subsection{Notation}
% \urg{Fill in the notation}

The $n$-dimensional Euclidean vector space is $\R^n$. Its nonnegative orthant will be written as $\R^n_{\geq 0}$ and its positive orthant will be denoted as $\R^n_{> 0}$. The set of $n \times m$ matrices will be $\R^{n \times m}$. The transpose of a matrix $M \in \R^{n \times m}$ is $M^T \in \R^{m \times n}$.

The $n$-dimensional identity matrix is $I_n$. The vector of all ones is $\1_n \in \R^n$. The $n \times m$ matrix of all zeros is $\0_{n \times m} \in \R^{n \times m}$.
The matrix with $v \in \R^n$ appearing on its main diagonal and zeros elsewhere is $\diag{v} \in \R^{n \times n}$.
The Kronecker product of matrices $A$ and $B$ is $A \otimes B$. The column-wise vectorization of a matrix $M$ is $\vvec{M}$.  The elementwise division between $a, b \in \R^n$ is $a./b$.

The symbol $\delta x$ will refer to $x^+$ (next state) in discrete-time or $\dot{x}$ in continuous-time.
The symbols $(\circledast, \oplus, \ominus, \odot)$ correspond to an unrestricted (real-valued), a nonnegative, a nonpositive, and a zero-valued element respectively.

\subsection{Positive Systems}


A controlled \ac{LTI} system with states $x \in \R^n$, inputs $u \in \R^m$, and outputs $y\in\R^p$ has the form
\begin{align}
\label{eq:sys}
    \delta x &= A x + B u & y&=C x + D u.
\end{align}

\subsubsection{Positive System Descriptors}

\begin{defn}
The system \eqref{eq:sys} is \textit{internally positive} iff for any initial condition $x(0) \in \R^n_{\geq 0}$ and input $u(t) \in \R^m_{\geq 0}$, the state and output responses remain in the positive orthant ($x(t) \in \R^n_{\geq 0}, \ y(t) \in \R^p_{\geq 0} \ \forall t \geq 0$) \cite{farina2000positive}.
\end{defn}

Internal positivity requires that $(B, C, D)$ are all nonnegative, along with the property that $A$ is Metzler (off-diagonals are nonnegative) for \iac{CTS} or that $A$ is  nonnegative for \iac{DTS}. The system is positive-stable if $A$ is Hurwitz and Metzler (\ac{CTS}), or Schur and Nonnegative (\ac{DTS}).
For the remainder of this paper, we will assume that $C = I_n$ and $D = \0_{n \times m}$.

% for every trajectory $x(t)$, $x(t) \geq 0$ implies that $x(t') \geq 0$ for all times $t' \geq t$ when $u(t)=0$. The system \eqref{eq:sys} is \textit{internally positive} if $x(t) \geq 0$  implies that $x(t') \geq 0$ for all $t' \geq t$ and all applied inputs $u(\cdot) \geq 0$ 

% In continuous time, $A$ is positive if and only if it is \textit{Metzler} (off-diagonal elements are nonnegative). It is additionally positive-stable if $A$ is both Metzler and Hurwitz (all poles have a negative real part). 
%A necessary condition for positive-stability of $A$ in continuous-time is that all diagonal elements are negative.
% In discrete time, $A$ is positive if it has nonnegative entries, and $A$ is positive-stable if it is nonnegative and Schur (all poles are inside unit the  disk).

% Positivity requires that $A$ is  in continuous time or that $A$ is nonnegative in discrete-time.
% Internal positivity additionally imposes that $B$ is nonnegative in both the continuous-time and discrete-time cases.

The state-feedback control $u= K x$ with $K \in \R^{m \times n}$ positively-stabilizes \eqref{eq:sys} if the closed-loop matrix $A+BK$ is Metzler-Hurwitz or Nonnegative-Schur (as appropriate).

% The matrix $A$ is positive-stable

% In continuous-time, necessary and sufficient conditions for system \eqref{eq:sys} to be positive-stable with no input are that $A$ is \textit{Metzler} (off-diagonal elements)


\subsubsection{Copositive Functions}


\begin{defn}
    A function $f: \R^n \rightarrow \R$ is \textit{copositive} (with respect to the positive orthant) if $\forall x \in \R^n_{> 0}: f(x) > 0$. 
    \end{defn}
    
    Copositivity of the linear function $V(x)=v^T x$ and the dual-linear function  $V(x) = \max(x./v)$ may be checked by verifying that $v > 0$, but copositivity of a matrix function such as $x^T M x$ for some $M \in \R^{n \times n}$ is generically NP-hard \cite{murty1987some}.

\subsubsection{Stability of Positive Systems}
\begin{thm}
\label{thm:stability_pos}
    Let the system \eqref{eq:sys} be internally positive. Then it is asymptotically stable (positive-stable) iff one of the following equivalent conditions is satisfied \cite{rantzer2018tutorial}:
    \begin{enumerate}
        \item[C1)] The matrices $-A$ (\ac{CTS}) or $I_n - A$ (\ac{DTS}) have positive principal minors.
        \item[C2)] There exists a $p \in \R^n_{>0}$ with $P=\diag{p}$ such that $A^T P + P A \prec 0$ (\ac{CTS}) or $A^T P A - P \prec 0$  (\ac{DTS}).
        \item[C3)] There exists a positive vector $v \in \R^n_{>0}$ with \iac{LCLF} $v^T x$ such that $A^T v  < 0$ (\ac{CTS}) or $A^T v  < v_1$ (\ac{DTS}).        
        \item[C4)] There exists a positive vector $v_\infty \in \R^n_{>0}$ with \iac{DLCLF} $\max(x./v_\infty)$ such that $A v_\infty  < 0$ (\ac{CTS}) or $A v_\infty  < v_\infty$ (\ac{DTS}).
    \end{enumerate}
\end{thm}

In this paper we will exclusively use Condition C4 of Theorem \ref{thm:stability_pos} with \iac{DLCLF} $\max(x./v_\infty)$. We note that the conditions in Theorem \ref{thm:stability_pos} strictly treat the case of (dual) \acp{LCLF}. Proposition 3.3 of \cite{blanchini2015switched} states that every uniformly exponentially stable positive linear system admits a polyhedral Lyapunov function with an undecidable number of facets.


% Propositions 1 and 2 of  \cite{rantzer2015scalable} note the following lemma,
% \begin{lem}[Theorem 6.2.3  and Lemma 6.2.1 of \cite{berman1994nonnegative}]
% A function $V(x) = \max(x./v)$ is \iac{DLCLF} for $\delta x = A x$ if and only if it satisfies the condition %\cite{farina2000positive}
% \begin{subequations}
% \begin{align}
%     -A v & \in \R^n_{>0} && \text{Continuous-Time} \\
%     v-A v & \in \R^n_{>0} && \text{Discrete-Time.}
% \end{align}
% \end{subequations}

% The existence of \iac{DLCLF} is necessary and sufficient for the system $\delta x = A x$ to be positive-stable.
% \end{lem}
\subsubsection{Positive System Stabilization}

\acp{DLCLF} may be employed to find positive-stabilizing controllers $K \in \R^{m \times n}$. 
\begin{thm}[\cite{rami2007controller}]
\label{thm:stab_control}
The closed-loop system $\delta x = (A + BK) x$ from \eqref{eq:sys}, given a control $u=Kx$, is positive and asymptotically stable if there exists a vector $v \in \R^n_{>0}$ with a diagonal matrix $X = \diag{v}$, and a matrix $Y \in \R^{m \times n}$ such that the gain $K$ satisfies $K X = Y $ and
\begin{subequations}
\label{eq:stab_clean}
\begin{align}
    -(A X + B Y) \1_n & \in \R^n_{>0}  & &AX+BY  \text{ is Metzler (\ac{CTS})} \label{eq:stab_clean_c}\\
    v-(A X + B Y) \1_n & \in \R^n_{>0}  & & AX+BY \in \R^{n \times n}_{\geq 0} \ \text{(\ac{DTS})}. \label{eq:stab_clean_d}
\end{align}
\end{subequations}
\end{thm}

% the state-feedback controller $K$ may be synthesized if the following equations have a solution,
% \begin{subequations}
% \label{eq:stab_clean}
% \begin{align}
%     -(A X + B Y) \1_n & \in \R^n_{>0}  & & \text{Continuous-Time} \label{eq:stab_clean_c} \\
%     v-(A X + B Y) \1_n & \in \R^n_{>0} & & \text{Discrete-Time} \label{eq:stab_clean_d},
% \end{align}
% \end{subequations}
% and $AX + BY$ is Metzler/Nonnegative as appropriate.

% \urg{The work in \cite{rantzer2018tutorial} has \eqref{eq:stab_clean_c} for continuous-time but not discrete-time.}

Finding a controller through \eqref{eq:stab_clean} requires solving \iac{LP} with both strict and nonstrict inequality constraints.

\subsubsection{Structured Control}

The stabilization task in \eqref{eq:stab_clean} may be restricted to a set of controllers that obey sign patterns and sparsity structures. Such sparsity might arise from network information constraints.

Let $\scr$ be an $m \times n$ matrix filled with the symbols $(\circledast, \oplus, \ominus, \odot)$. A controller with the structure $K \in \scr$ may be constructed by solving \eqref{eq:stab_clean} under the constraint that $Y \in \scr$, given that multiplication by the matrix $X$ with $v \in \R_{>0}^n$ does not change the sign pattern. An unstable internally positive system cannot be positive-stabilized by a nonnegative state feedback controller $K \in \R^{m \times n}_{\geq 0}$.

\subsection{Extended Farkas Lemma}

This work will find a state-feedback controller $u=Kx$ such that the set of all $K$-stabilized systems contains the set of systems consistent with observed data. The method used to enforce this containment is the Extended Farkas Lemma: 

\begin{lem}[Extended Farkas Lemma \cite{hennet1989farkas, henrion1999control}]
\label{lem:ext_farkas}
Let $P_1 = \{x \mid G_1 x \leq h_1\}$ and $P_2 = \{x \mid G_2 x \leq h_2\}$ be a pair of polytopes. Then $P_1 \subseteq P_2$ if and only if there exists a nonnegative matrix $Z$ of compatible dimensions such that,
\begin{align}
    Z G_1 &= G_2, & Z h_1 \leq h_2.
\end{align}
\end{lem}

% \urg{Positive systems definition.


% Stability, (continuous: Metzler/Hurwitz, discrete:Nonnegative Schur)

% % \ac{CPCLF} for stabilization, \ac{LP} to enforce this. Recovery of controller given the LP.
% }

% \subsection{Robust Prog}
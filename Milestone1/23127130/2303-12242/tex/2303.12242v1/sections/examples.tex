\section{Numerical Examples}

\label{sec:examples}


All experiments are written in MATLAB 2021a with Mosek \cite{mosek92} and YALMIP \cite{lofberg2004yalmip} dependencies. The code is available at 
 \url{https://github.com/jarmill/data_driven_pos}. All experiments use a noise level of $\epsilon = 0.1$ for the $L_\infty$-norm bound and a tolerance of $\eta = 10^{-3}$ for the strict inequality constraints.
% MATLAB (2021a) code to generate the below examples is publicly available at
% . 
% Dependencies include Mosek  

 
\subsection{Continuous-Time Stabilization}

The ground-truth continuous-time system in this example has $n=3$ inputs and $m=2$ outputs:
\begin{align}
\label{eq:cont_stab_sys_true}
    A &= \begin{bmatrix} -0.55 & 0.3 & 0.65\\ 0.06 & -1.35 & 0.25 \\ 0.1 & 0.15 & 0.4   \end{bmatrix}& B = \begin{bmatrix} 0.18 & 0.08 \\ 0.47 & 0.25 \\0.07 & 0.95 \end{bmatrix}.
\end{align}

System \eqref{eq:cont_stab_sys_true} is internally positive but is open-loop unstable (poles of $0.4907, -0.6055, -1.3851$). The stabilization task in \eqref{eq:lp_stab} with $T=5$ and an additional normalization constraint that $\1_n^T v = 1$ results in,
\begin{subequations}
 \begin{align}
     v &= \begin{bmatrix}0.5570 & 0.1401& 0.3029\end{bmatrix}^T \label{eq:example_cont_stab_v}\\
    K &= \begin{bmatrix} 0.0279 &    -0.2660 &  0.5041 \\
    0.0107  &  -0.0222 & -0.8650\end{bmatrix}. \label{eq:example_cont_stab_K}
 \end{align}
\end{subequations}
%      Y &=  \begin{bmatrix} 0.0155  &  -0.0373  &  0.1527 \\
    %  0.0060  & -0.0031 & -0.2620 \end{bmatrix}\\

Figure \ref{fig:cont_stab} visualizes 100 controlled trajectories (red curves) starting from $x(0)=[1;1;1]$ (black circle). Each trajectory follows $\dot{x}(t) = (A+ BK)x(t)$ in the times $t \in [0, 20],$ where the plants $(A, B)$ are randomly sampled from $\Sigma_D$, and $K$ is the controller in \eqref{eq:example_cont_stab_K}.

\begin{figure}[h]
    \centering
    \includegraphics[width=\linewidth]{img/sys_3_2_cont_T5.png}
    \caption{Application of the controller $u=Kx$ from \eqref{eq:example_cont_stab_K} to positively-stabilize $100$ consistent systems in $\Sigma_D$.}
    \label{fig:cont_stab}
\end{figure}

Figure \ref{fig:cont_max_lyap} plots values of the Lyapunov function $\max(x./v)$ (for the $v$ in \eqref{eq:example_cont_stab_v}) along the 100 systems in \ref{fig:cont_stab}.
\begin{figure}[h]
    \centering
    \includegraphics[width=\linewidth]{img/Lyap_max.pdf}
    \caption{\ac{DLCLF} along the 100 trajectories.}
    \label{fig:cont_max_lyap}
\end{figure}

\subsection{Discrete-Time Stabilization}

This example involves a discrete-time system with $n=5$ states and $m=3$ inputs. The ground-truth system is internally positive, and is unstable with poles of $1.3094, \ -0.1218 \pm 0.0992 \mathbf{j}, \-0.1201 \pm 0.1108 \mathbf{j}$.  With $T=60$ observations the following \ac{DLCLF} and stabilizing controller is recovered:
\begin{align}
v &= \begin{bmatrix}0.2076& 0.1212&   0.2651&   0.2516 & 0\end{bmatrix}^T     \\
K &= \begin{bmatrix}0.0483 &   0.0088  & -0.1326  & -0.0188  & -0.4273\\
   -0.3243  &  0.0115  &  0.0299 &  -0.2980 &   0.0337\\
    0.1601 &   0.0749  & -0.5962 &  -0.3537 &  -0.2194 \end{bmatrix}. \nonumber
\end{align}
 
 
%  \urg{Add an experiment with sign patterns}
 
% A stabilizing controller for all consistent plants that obeys the sign pattern
It is now desired to obtain a stabilizing controller for all consistent plants that obeys the sign pattern
\begin{subequations}
\begin{align}
    \scr &=  \begin{bmatrix}\odot &   \odot  & \odot  & \odot  & \ominus\\
   \odot  &  \odot  &  \circledast & \odot &   \oplus\\
    \odot &   \odot  & \odot &  \circledast &  \circledast \end{bmatrix}
\intertext{Such  \iac{DLCLF} certificate  and controller is}
v &= \begin{bmatrix} 0.2147&   0.1259&    0.2448&     0.2516&     0.1630\end{bmatrix}^T\\
K &= \begin{bmatrix}0&   0  & 0  & 0  & -0.6853\\
   0  &  0  &  -0.3206 & 0 &   0.1206\\
    0 &   0  & 0 &  -0.5604 &  -0.3317 \end{bmatrix}.
\end{align}

\end{subequations}
\subsection{Continuous-Time Peak-to-Peak}

The following ground-truth positive-stable continuous-time system has $n=3$ inputs and $m=2$ outputs
\begin{align}
\label{eq:p2p_sys_true}
    A &= \begin{bmatrix} -0.2 & 0.2 & 0.2\\ 0.4 & -0.7 & 0.2 \\ 0 & 0.8 & -3   \end{bmatrix}& B = \begin{bmatrix} -0.4 & 0.5 \\ 0.2 & -0.8 \\ -1 & 2 \end{bmatrix}.
\end{align}

This system has  $e=2$ external input channels and $p=5$ controlled outputs with
\begin{align}
\label{eq:p2p_param}
    C &= \begin{bmatrix} I_3 \\ \0_{2 \times 3}
    \end{bmatrix}, & D &= \begin{bmatrix} \0_{3 \times 2} \\ I_2
    \end{bmatrix}, & E  &= \begin{bmatrix} I_2 \\ \0_{1 \times 2}
    \end{bmatrix}, & F  &= \0_{5 \times 2}.
\end{align}
 
The peak-to-peak gain of the ground-truth \eqref{eq:p2p_sys_true} under the parameters in \eqref{eq:p2p_param} when uncontrolled $(K=\0_{2 \times 3})$ is $\gamma^* = 32.178$. Lemma \ref{lem:p2p_clean} synthesizes a controller for the ground-truth system resulting in a gain of $\gamma^* = 3.742$. The constraint $CX + DY \in \R^{q \times n}_{\geq0}$ with the values in \eqref{eq:p2p_param} imposes that all elements of $Y$ and $K$ are nonnegative $(\oplus)$.

Table \ref{tab:p2p_result} collects the worst-case peak-to-peak gains obtained by \eqref{eq:p2p} as a function of the number of samples $T$. These gains decrease as $T$ increases and the consistency set $\Sigma_\dc$ shrinks. The top row of \eqref{tab:p2p_result} incorporates the prior knowledge that the ground-truth $A$ from \eqref{eq:p2p_sys_true} is Metzler when constructing the polytope $\Sigma_D$. The bottom row does not impose this positivity (Metzler) prior on $A$, and therefore yields peak to peak bounds that are always greater than or equal to the Metzler-imposed bounds.
 
 
 \begin{table}[h]
     \centering 
     \caption{Worst-case peak-to-peak gain $\gamma^*$ computed by \eqref{eq:p2p} decreases as the number of samples $T$ increases}
     \begin{tabular}{rccccc}
     $T$& 20 & 30 & 50 & 80 & 120 \\ \hline
          $A$ Metzler & 6.4539 & 5.0182 & 4.4967 & 4.0619 & 4.0028 \\
          No Prior& 6.4823 & 5.0719 & 4.5292 & 4.0659 & 4.0029
     \end{tabular}
     \label{tab:p2p_result}
 \end{table}
 
The system with $T=50$ and a Metzler-prior on $A$ has a worst-case peak-to-peak gain of $\gamma^*=4.4967$ and solution outputs of
\begin{subequations}
 \begin{align}
     v &= \begin{bmatrix}4.4967 &4.2021 & 0.4303\end{bmatrix}^T \\
    K &= \begin{bmatrix} 0.5095 &    0.4765  &  0.4727 \\
    0.2587  &  0 & 0\end{bmatrix}.
 \end{align}
\end{subequations}
    %  Y &=  \begin{bmatrix} 2.2910  &  2.0023  &  0.2034 \\
    % 1.1634  & 0 & 0 \end{bmatrix}\\
 
The polytope $\Sigma_D$ under the Metzler-prior has $2nT + (n^2-n) = 300 + 6 = 306$ faces and 308,672 vertices, of which 62 faces are nonredundant (see Remark \ref{rmk:nonredundant_face}). The nonnegative Farkas matrix is $Z \in \R^{9 \times 62}_{\geq 0}$.
% \subsection{Continuous-Time}


% \subsection{Discrete-Time}
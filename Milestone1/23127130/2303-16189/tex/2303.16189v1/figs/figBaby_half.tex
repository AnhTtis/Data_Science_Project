\begin{wrapfigure}{r}{0.5\textwidth}
  \vspace*{-0.4in}
  \centering
  \scalebox{0.97}{
    \begin{tikzpicture}
     \node[anchor=north west](graph) at (0in,0in)
      {{\includegraphics[width=0.5\textwidth,trim={0in
      4.6in 2.5in 0.0in}, clip=true]{figs/baby.pdf}}};
     % time axis
    \draw[->, thick] ($ (graph.north) - (2.2, 0) $)-- ($ (graph.north) + (2., 0) $) node[midway, above]{\small \bf time};
    % Commands
     \node[anchor=north] at ($ (graph.north) + (-0.2, -2.25) $) {\em \footnotesize Go to the blue ball};
     \node[anchor=north] at ($ (graph.north) + (-0.2, -4.8) $) {\em \footnotesize Go to the blue key};
     \node[anchor=north] at ($ (graph.north) + (-0.2, -7.35) $) {\em \footnotesize Go to the green key, then go to the green box};
    % colorbar
     \node[anchor=west] at ($ (graph.east) + (0.0, 0.0) $) {\bf \small Energy};
     \node[anchor=south] at ($ (graph.east) + (-0.2, 2.32) $) {\bf \footnotesize Low};
     \node[anchor=north] at ($ (graph.east) + (-0.2, -2.6) $) {\bf \footnotesize High};
    % environment label
    \node[anchor=east] at ($ (graph.west) + (0.25, 2.55) $) {\bf \small (a)};
    \node[anchor=east] at ($ (graph.west) + (0.25, 0.0) $) {\bf \small (b)};
    \node[anchor=east] at ($ (graph.west) + (0.25, -2.55) $) {\bf \small (c)};
    \end{tikzpicture}
  }
  \vspace*{-0.3in}
  \caption{
  Plan by energy minimization.
  The trajectories planned in BabyAI environments.
  \textbf{(a)} \textit{GoToLocalS8N7}.
  \textbf{(b)} \textit{GoToObjMazeS4}.
  \textbf{(c)} \textit{GoTOSeqS5R2}.
  The target location at each timestamp is highlighted with \protect{\raisebox{-.05cm}{\includegraphics[height=.30cm]{figs/target_highlight.png}}}
  }
 \label{fig:3by3}
 \vspace{-0.in}
\end{wrapfigure}

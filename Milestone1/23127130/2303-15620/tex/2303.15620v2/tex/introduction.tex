
\section{Introduction}\label{sec:introduction}
\subsection{Motivation}
For legged robots to successfully navigate in the real world, it's imperative to employ methods to predict the potential occurrence of a fall and, if possible, execute reflexive motions to either prevent the fall from happening or to make the ``landing'' less dangerous, to the robot or its surroundings. The infeasibility of accounting for all potential perturbations and uncertainties while operating autonomously in dynamic environments makes falling almost inevitable. Here, we focus on bipedal robots.

Fall detection and recovery algorithms often consist of two parts: fall detection and reflexive motions. The focus of this paper, however, is solely on fall detection. The objective is to reliably predict potential falls of bipedal robots with sufficient time to deploy a recovery strategy. Bipedal robots are chosen because their smaller support polygon causes them to be inherently less stable in comparison to robots with more legs. To simplify the fall detection problem while providing a pathway to scale up to more complex dynamic motions and robots, the task of standing with a planar four-link biped is chosen. As our task of interest is standing, we define a ``fall' as any link other than the feet coming in contact with the ground  \cite{ref:pratt2006velocity} or if the feet are off the ground. 

\subsection{Background}
In the following, the term falls will be associated with the term faults, which are defined as unacceptable deviations from expected behavior in at least one variable \cite{ref:ISERMANN19827}. Faults can be classified based on their time dependency, location, and underlying causal factors. Temporally, faults can either be abrupt (step-like or rapidly varying), incipient (drift-like or slowly varying), or intermittent (non-continuous). Faults can be caused by either internal or external disturbances and uncertainties \cite{ref:ISERMANN19827,ref:safaeipour2021survey,ref:renner2006instability}. Incipient faults arise from a gradual deviation from the robot's nominal states or assumed environment, while, as the name suggests, abrupt faults typically arise from shoves or unexpected impacts with the environment. Intermittent faults are non-continuous faults. We do not address intermittent faults in this paper.


In general, the states of the robot can be divided into three classes: safe/balanced, falling, and fallen \cite{ref:kalyanakrishnan2011learning}. The safe/balanced states are states where it is possible for the robot to avoid falling while under the influence of its nominal feedback controller. These states are therefore contained in a subset of the viability kernel \cite{ref:wieber2002stability,ref:hohn2009probabilistic,ref:wu2021falling}.

\subsection{Literature Review} 
A fall detection algorithm has been implemented in the commercial bipedal robot, Digit \cite{ref:ar_digit}. However, this does not appear to be the norm. The objective of most bipedal fall detection algorithms found in literature is to reliably and promptly detect all abrupt faults. Incipient faults are not considered.

Fault detection reliability has been determined using a combination of evaluation terms from the confusion matrix, such as false positive and negative rates \cite{ref:renner2006instability, ref:kalyanakrishnan2011learning,  ref:wu2021falling, ref:subburaman, ref:kim, ref:hohn2009probabilistic, ref:gallego2010continuous,ref:marcolino2013detecting, ref:ruiz2010fall, ref:karssen2009fall}. Thresholds, based on factors such as center of mass height, have been proposed to minimize the percentage of false negative fault declarations in \cite{ref:kalyanakrishnan2011learning}, while the output of the fall detection algorithm is monitored for a certain number of windows ($N_{monitor}$) to reduce the false positive rate in \cite{ref:kalyanakrishnan2011learning,ref:subburaman,ref:khalastchi2015online}. Lead time, defined as the difference between the time of the actual fall and the predicted fall, is used to inform whether or not sufficient time is left for the implementation of recovery/reflexive motions. It is desirable to have a large lead time, however, maximizing lead time can increase false positive rates. The minimum amount of lead time needed depends on the chosen recovery algorithm and the robot's dynamics, as discussed in \cite{ref:renner2006instability,ref:kalyanakrishnan2011learning,ref:wu2021falling,ref:suetani2011nonlinear} 


Fall detection algorithms can either rely on physics-based \cite{ref:amri2018improved,ref:muender,ref:xinjilefu}  or data-based models \cite{ref:kalyanakrishnan2011learning, ref:wu2021falling, ref:subburaman, ref:hohn2009probabilistic, ref:ruiz2010fall,ref:karssen2009fall, ref:marcolino2013detecting}. Physics-based models can suffer from model inaccuracies while data-based models are limited by the amount of data available. For both physics-based and data-based models, the objective is to obtain either a model of the nominal (safe) states and/or of the faulty (unsafe) states. However, this is not simple. In practice, it is infeasible to quantify all faults that can lead to a fall, and the faulty states in any given trajectory are irregular and rare. Both of these conditions make it nearly impossible to obtain an accurate model of the anomalies. It is also challenging to obtain a model that accounts for all the safe states of the robot. However, due to advances in the machine learning community, data-based algorithms are becoming more common.

Data-driven detection algorithms can be divided into two subsequent parts, feature engineering and the method used for detection. Feature engineering consists of selecting and transforming raw data into features that can differentiate between faulty and normal states.  Even though stability metrics are used to increase the robustness of controllers, they individually are not a sufficient condition for falling \cite{ref:subburaman}. A combination of stability metrics from bipedal control theory, such as the angular momentum about the center of mass ($L_{com}$), and kinematic functions, such as the center of mass position ($p_{com}$), are typically chosen as features \cite{ref:kalyanakrishnan2011learning, ref:wu2021falling, ref:subburaman, ref:hohn2009probabilistic, ref:ruiz2010fall, ref:karssen2009fall, ref:marcolino2013detecting}.

Classification algorithms, such as that used by \cite{ref:kalyanakrishnan2011learning}, attempt to learn a model from labeled training data and then classify a data point into one of the classes based on the learned model. A disadvantage of classification algorithms is that they can output incorrect predictions if the input data is outside the training data parameters (outside distribution). Nearest-neighbor-based algorithms, such as \cite{ref:khalastchi2015online}, assume that normal data exist in highly dense spaces whereas the neighborhood of anomalous data is sparse. However, these algorithms can have high false positives if the normal instances do not exist in sufficiently dense neighborhoods. Threshold-based algorithms, such as \cite{ref:subburaman}, attempt to use a combination of features to derive a threshold that can be used to separate faulty and normal states.



\subsection{Objective of the Paper}

\textbf{For the task of standing} and for given \textbf{upper bounds on the false positive and false negative rates}, our objective is to detect potential falls caused by either \textbf{incipient or abrupt faults} while \textbf{maximizing the lead time}, that is, the time from fault declaration to the robot entering a fallen state. The objective is challenging due to the crowding phenomenon \cite{ref:safaeipour2021survey,ref:Chen2020}, masking effects of the controller as it tries to mitigate deviations from steady state \cite{ref:ISERMANN19827}, and the direct relationship between lead time and false positive rate. The crowding phenomenon is the similarity between the normal and incipient faulty data which makes it difficult to separate normal data from faulty data \cite{ref:safaeipour2021survey,ref:Chen2020}.


To achieve this objective, we design a nearest-neighbor detection algorithm and compare its performance to an existing classification-based detection algorithm. A threshold-based method was not chosen for comparison because it is difficult to find simple thresholds for systems as complex as bipedal robots.  


\subsection{Contributions} 
The major contributions of the paper are as follows:
\begin{itemize}
    \item An algorithm that maximizes lead time subject to bounds on false positive and negative rates;
    \item A method of identifying trajectories associated with incipient or abrupt faults;
    \item A way to label the data based on lead time is proposed;
    \item A nearest-neighbor classification-based fall detection algorithm that can detect both incipient and abrupt faults; and    
        \item A comparison of the proposed nearest-neighbor classification algorithm and an existing classification algorithm.
\end{itemize}



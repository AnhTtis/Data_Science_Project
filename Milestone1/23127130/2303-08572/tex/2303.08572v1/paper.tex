%\documentclass[anon,12pt]{clear2023}% Anonymized submission
\documentclass[final,12pt]{clear2023} % Include author names
%\usepackage[nonatbib]{neurips_2022}

% The following packages will be automatically loaded:
% amsmath, amssymb, natbib, graphicx, url, algorithm2e

\title[Distinguishing Cause from Effect on Categorical Data]{Distinguishing Cause from Effect on Categorical Data: \\
The Uniform Channel Model}

\usepackage{times}

\usepackage{graphicx} % Enhanced LaTeX Graphics
\usepackage{siunitx}
\usepackage{comment}
\usepackage[american]{babel}
\usepackage{enumitem}
%\usepackage{wasysym}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}         % colors

\usepackage{array}
%\usepackage{amsmath}
%\usepackage{amsfonts}
%\usepackage{amsthm}
%\usepackage{amssymb}
%\usepackage{fancybox,framed}
\usepackage{enumitem}

%\usepackage{natbib} % has a nice set of citation styles and commands%5  
%\bibliographystyle{abbrvnat}
%    \renewcommand{\bibsection}{\subsubsection*{References}}
\usepackage{mathtools} % amsmath with fixes and additions
% \usepackage{siunitx} % for proper typesetting of numbers and units
%\usepackage{booktabs} % commands to create good-looking tables
\usepackage{tikz} % nice language for creating drawings and diagrams


%\newtheorem{theorem}{Theoremm}
%\newtheorem{theoremm}[theorem]{Theorem}
%\newtheorem{corollary}{Corollary}[theorem]
%\newtheorem{lemma}[theorem]{Lemma}
%\newtheorem{definition}[theorem]{Definition}
%\newtheorem{proposition}[theorem]{Proposition}
%\newtheorem{example}[theorem]{Example}
%\newtheorem{remark}{Remark}

% Use \Name{Author Name} to specify the name.
% If the surname contains spaces, enclose the surname
% in braces, e.g. \Name{John {Smith Jones}} similarly
% if the name has a "von" part, e.g \Name{Jane {de Winter}}.
% If the first letter in the forenames is a diacritic
% enclose the diacritic in braces, e.g. \Name{{\'E}louise Smith}

% Two authors with the same address
\clearauthor{\Name{Mário A. T. Figueiredo,} \Email{mario.figueiredo@tecnico.ulisboa.pt} \\
  \Name{Catarina Oliveira} \Email{catarina.a.oliveira@tecnico.ulisboa.pt}\\
  \addr Instituto de Telecomunicações and LUMLIS (Lisbon ELLIS Unit), \\
  Instituto Superior Técnico, Universidade de Lisboa, Portugal}

%Three or more authors with the same address:
% \author[1]{\href{mailto:<jj@example.edu>?Subject=Your UAI 2022 paper}{Jane~J.~von~O'L\'opez}{}}
% \clearauthor{\Name{Catarina A.  Oliveira} \Email{catarina.a.oliveira@tecnico.ulisboa.pt}\\
% \Name{Alexandra M. Carvalho} \Email{alexandra.carvalho@tecnico.ulisboa.pt}\\
%  \Name{M\'{a}rio A. T. Figueiredo} \Email{mario.figueiredo@tecnico.ulisboa.pt}\\
%  \addr Instituto de Telecomunicações, Instituto Superior Técnico, Lisboa Portugal\\
%  Lisbon (ELLIS) Unit for Learning and Intelligent Systems (LUMLIS)}

% Authors with different addresses:
%\clearauthor{%
% \Name{Author Name1} \Email{abc@sample.com}\\
% \addr Address 1
% \AND
% \Name{Author Name2} \Email{xyz@sample.com}\\
% \addr Address 2%
%}

%\author{%
%  M\'{a}rio A. T. Figueiredo\thanks{Use footnote for providing further information
%    about author (webpage, alternative address)---\emph{not} %for acknowledging
%    funding agencies.} \\
%  Instituto de Telecomunicações, Instituto Superior Técnico, Lisboa Portugal \\
%  \texttt{mario.figueiredo@tecnico.ulisboa.pt} \\
  % examples of more authors
  % \And
  % Coauthor \\
  % Affiliation \\
  % Address \\
  % \texttt{email} \\
  % \AND
  % Coauthor \\
  % Affiliation \\
  % Address \\
  % \texttt{email} \\
  % \And
  % Coauthor \\
  % Affiliation \\
  % Address \\
  % \texttt{email} \\
  % \And
  % Coauthor \\
  % Affiliation \\
  % Address \\
  % \texttt{email} \\
%}


%\usepackage[ruled,vlined]{algorithm2e}


%\newtheorem{theorem}{Theorem}
%\newtheorem{theorem}[theorem]{Theorem}
%\newtheorem{corollary}{Corollary}[theorem]
%\newtheorem{lemma}[theorem]{Lemma}
%\newtheorem{definition}[theorem]{Definition}
%\newtheorem{proposition}[theorem]{Proposition}
%\newtheorem{example}[theorem]{Example}
%\newtheorem{remark}{Remark}

%%
%% The amsthm package provides extended theorem environments
%% http://www.ctan.org/tex-archive/help/Catalogue/entries/amsthm.html
%\usepackage{float}
\usepackage[normalem]{ulem} 
%\usepackage[hang,small,bf,tight]{subfigure}
%\usepackage[ruled,vlined,norelsize]{algorithm2e}

\begin{document}

\maketitle

\begin{abstract}%
Distinguishing cause from effect using observations of a pair of random variables is a core problem in causal discovery. Most approaches proposed for this task, namely \textit{additive noise models} (ANM), are only adequate for quantitative data. We propose a criterion to address the cause-effect problem with categorical variables (living in sets with no meaningful order), inspired by seeing a conditional \textit{probability mass function} (pmf) as a discrete memoryless channel. We select as the most likely causal direction the one which the conditional pmf is closer to a \textit{uniform channel} (UC). The rationale is that, in a UC, as in an ANM, the conditional entropy (of the effect given the cause) is independent of the cause distribution, in agreement with the principle of \textit{independence of cause and mechanism}. Our approach, which we call the \textit{uniform channel model} (UCM), thus extends the ANM rationale to categorical variables. To assess how \textit{close} a conditional pmf (estimated from data) is to a UC, we use statistical testing, supported by a closed-form estimate of a UC channel. On the theoretical front, we prove identifiability of the UCM and show its equivalence with a structural causal model with a low-cardinality exogenous variable. Finally, the proposed method compares favorably with recent state-of-the-art alternatives in experiments on synthetic, benchmark, and real data.

\end{abstract}

%\begin{keywords}%
%Causal discovery, categorical data, cause-effect pairs, communication channels, additive noise models; independence of cause and mechanism.
%\end{keywords}


\input{intro}
%%\input{02_backg}
\input{method}
\input{channel}
\input{criterion}
\input{resul}
\input{concl}


% Acknowledgments---Will not appear in anonymized version
%\acks{We thank a bunch of people and funding agency.}

%\bibliographystyle{abbrv}
%\bibliographystyle{abbrvnat}

\clearpage
\bibliography{references}

\clearpage
\appendix
\input{appendix_a}
\input{appendix_b}

\section{Detailed Description of the Datasets Used in Section \ref{sec:real_data}}
\label{app_data}
\textbf{Adult} - This dataset consists of 48832 records from the census database of the US in 1994. We consider the following pairs: \textit{(occupation, income)} and \textit{(work class,income)}. The variable \textit{occupation} takes values in the set $\{$\textit{admin, armed-force, blue-collar, white-collar, service, sales, professional}, \textit{other-occupation}$\}$. The variable \textit{work class} takes categories in $\{$\textit{private, self-employed, public servant, unemployed}$\}$. Finally, \textit{income} is a binary variable taking value in $\{ >50,\, \leq 50\}$. Following \citet{paper_stochastic}, we assume that the ground truth is \textit{occupation} $\rightarrow$ \textit{income} and \textit{work class} $\rightarrow$ \textit{income}.

\textbf{Pittsburgh Bridges} - This dataset contains records about 108 bridges and some of their characteristics. We consider the  pairs (\textit{purpose}, \textit{type}) and (\textit{material},\textit{lanes}). The variable \textit{purpose} takes values in $\{$\textit{Walk, Aqueduct, RR, Highway}$\}$; variable \textit{type} takes values in $\{$\textit{Wood, Suspen, Simple-T, Arch, Cantilev, CONT-T}$\}$; variable \textit{material} takes values in $\{$\textit{Steel, Iron, Wood}$\}$; variable \textit{lanes} takes values in $ \{1,2,4,6\}$. Following \citet{hcr}, the ground truths assumed are \textit{material} $\rightarrow$ \textit{lanes} and \textit{purpose} $\rightarrow$ \textit{type}. 

\textbf{Acute Inflammations} - This dataset consists of 120 patients and whether each patient is experiencing a specific symptom, the temperature, and whether he/she suffers from acute inflammations of the urinary bladder and/or acute nephritis. We consider the binary variables \textit{ocurrence of nausea} $(Y_1)$, \textit{lumbar pain} $(Y_2)$, and \textit{burning of urethra} $(Y_3)$ (naturally, taking value 1 if the patient has that symptom, and 0 otherwise). Moreover, $X$ represent the diagnosis \textit{inflammation of urinary bladder}. Following \citet{anm2011}, the goal is to model the diagnosis process, thus we expect $Y_j \rightarrow X$, for $j = 1,...,3$. Notice that the variables $X_i$ only correspond to the diagnosis, not necessarily the truth, otherwise they would be considered the cause, rather than the effect.  

The $\chi^2$ test did not reject the null hypothesis of independence (at a significance level of 5\%) for the following pairs of variables in this dataset: (\textit{Inflammation of urinary bladder}, \textit{Occurrence of nausea}); (\textit{Inflammation of urinary bladder}, \textit{Burning of urethra}); (\textit{Nephritis}, \textit{Micturition pains}). Although, intuitively, we would expected a causal relation between those, the statistical evidence is not strong enough in favour of their mutual dependency (according to the $\chi^2$ test), therefore, these pairs were discarded from the experiments. 

\textbf{Temperature} - This dataset consists of 9162 daily values of temperature measured in Furtwangen (Germany), with the variable \textit{day of the year} taking integer values from 1 to 365 (or 366 for leap years) and \textit{temperature} in $^{\circ} C$. Here, we aggregate days associated with each month and take \textit{month} $\rightarrow$ \textit{temperature} as the ground truth, as \citet{anm2011}. Notice that \textit{month} assumes a cyclic structure.

\textbf{Horse Colic} - This dataset contains 368 medical records of horses. We study the causal relationship between the variable \textit{abdomen status}, which takes the values in $\{$\textit{Normal, Other, Firm feces in the large intestine, Distended small intestine, Distended large intestine}$\}$, and the binary variable \textit{surgical lesion}, indicating whether the lesion was surgical or not. As \citet{horsedata}, we regard \textit{abdomen status} $\rightarrow$ \textit{surgical lesion} as ground truth.

%This is a boring technical proof.

%\section{My Proof of Theorem 2}

%This is a complete version of a proof sketched in the main text.

\end{document}

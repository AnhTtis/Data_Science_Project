%\documentclass[journal,draftclsnofoot,onecolumn,12pt]{IEEEtran}
\documentclass[lettersize]{IEEEtran}
%\documentclass[final]{IEEEtran}
%\documentclass[sigconf,10pt]{acmart}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{multirow}
\usepackage{array}
\usepackage{caption}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{M}[1]{>{\centering\arraybackslash}m{#1}}
\usepackage{graphicx}
\usepackage{subfigure}


\let\Bbbk\relax\usepackage{amsthm,amssymb,amsmath,multirow,color,amsfonts}%
\usepackage[update,prepend]{epstopdf}
\usepackage{multirow}
\usepackage[latin1]{inputenc}
\usepackage{tikz}
\usepackage{bbm} % for \mathbbm{1}
\usepackage{pdfpages}
\usepackage{multirow}
\usepackage{subfig}
\usepackage{comment}
\setlength{\textheight}{9.2in}
\def\chr#1{{\color{black}#1}}
\def\chb#1{{\color{blue} #1}}
\captionsetup{font=small}
%\allowdisplaybreaks % Allows breaking of eqnarray over multiple pages (avoids unnecessary blanks in the document before eqnarray)

%\usepackage{setspace}	% Remove in double column version. Also search for \setstretch in the body of the paper and comment these commands for double column
\usepackage{multicol}
\usepackage{cite}

\usepackage[justification=centering]{caption}
\usepackage{textcomp}
\usepackage{psfrag}
\usepackage{arydshln}
\usepackage{url}
\usepackage{soul}
\usepackage{graphicx,color}
%\usepackage{subfigure}
\usepackage[nolist]{acronym}
\usepackage{algorithm,algorithmic} %algorithm
%\usepackage{subcaption}
% correct bad hyphenation here

\usepackage{mathtools,lipsum}
\usepackage{cuted}
\setlength\stripsep{3pt plus 1pt minus 1pt}
%\usepackage{flushend} balance the last page

\usepackage{amsmath}
\newtheorem{proposition}{Proposition} 
\usepackage{mathrsfs}
%\usepackage[linesnumbered, ruled]{algorithm2e}
%\SetKwRepeat{Do}{do}{while}%
\usepackage{color}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[capitalise]{cleveref}
\Crefname{equation}{Eq.\!}{Eqs.\!}
\Crefname{figure}{Fig.\!}{Figs.\!}
\Crefname{tabular}{Tab.\!}{Tabs.\!}
\Crefname{section}{Section\!}{Sections.\!}

%\settopmatter{printacmref=false} % Removes citation information below abstract
%\renewcommand\footnotetextcopyrightpermission[1]{} % removes footnote with conference information in first column
%\pagestyle{plain} % removes running headers
\usepackage{graphicx}
\graphicspath{ {images/} }

\newenvironment{sequation}{
 \begin{equation}\small } { \end{equation}
}
\include{notation}
\begin{document}
%\pagenumbering{gobble}
\graphicspath{{./Figures/}}
\input{Elzanaty_Acronyms.tex}	
	\input{Definitions}

\title{
\vspace{-11mm}
Coverage Analysis of Hybrid RF/THz Networks With
Best Relay Selection
}
\vspace{-4mm}
\author{
Zhengying Lou, Baha Eddine Youcef Belmekki, and Mohamed-Slim Alouini, {\em Fellow, IEEE}
\thanks{The authors are with King Abdullah University of Science and Technology (KAUST), CEMSE division, Thuwal 23955-6900, Saudi Arabia (e-mail: zhengying.lou@kaust.edu.sa;  bahaeddine.belmekki@kaust.edu.sa;  slim.alouini@kaust.edu.sa).}
\vspace{-12mm}
}
\maketitle


\begin{abstract}
Utilizing terahertz (THz) transmission to enhance coverage has proven various benefits compared to traditional radio frequency (RF) counterparts. This letter proposes a dual-hop decode-and-forward (DF) routing protocol in a hybrid RF and THz relay network named hybrid relay selection (HRS). The coverage probability of the HRS protocol is derived. The HRS protocol prioritizes THz relays for higher data rates or short source-destination distances; and RF relays for lower data rates or large source-destination distances. The proposed HRS protocol offers nearly the same performance as the optimal selection protocol, which requires complete instantaneous channel state information (CSI) of all the nodes. 
% Utilizing terahertz (THz) transmission to enhance coverage has proven various benefits compared to traditional radio frequency (RF) counterparts. This letter proposes a dual-hop decode-and-forward (DF) routing protocol in a hybrid RF and THz relay network named hybrid relay selection (HRS). The coverage probability of HRS protocol is derived.
% The HRS protocol selects mainly THz relays for higher data rates or short source-destination distances; and selects mainly RF relays for lower data rates or large source-destination distances. 
% The proposed HRS protocol is compared with the optimal selection protocol, which requires a full and perfect instantaneous channel state information (CSI) of all the nodes. HRS protocol offers nearly the same performance as the optimal selection protocol for lower data rates. For higher data rates, the HRS protocol offers the same performance as the optimal selection protocol.

\end{abstract}

\begin{IEEEkeywords}
Stochastic geometry, hybrid RF and THz relay network, relay selection, coverage probability.
\end{IEEEkeywords}
\vspace{-0.3cm}
\section{Introduction}
With the upcoming bandwidth-hungry applications of the sixth generation (6G) networks such as virtual reality (VR) and holographic communications, ubiquitous and ultra-high-speed access are required \cite{wang2022ultra}. Utilizing the terahertz (THz) band will increase channel bandwidth and transmission capacity as it is considered one of the key enablers of 6G networks \cite{sarieddeen2020next}.
Compared to traditional radio frequency (RF) networks, dense THz networks have lower power consumption, smaller time delay, weaker radiation, better beam directivity, and higher interference immunity \cite{rappaport2013millimeter}. However, THz signals suffer from deep fading due to large free space path-loss and water molecule absorption, which significantly limit the effective communication distance \cite{chattopadhyay2015compact}. Hence, relay communications are used to cope with this limitation.

\par
Most of the literature focuses on coverage performance for a given relay link \cite{boulogeorgos2020outage,farrag2021outage,li2021performance}. {\color{black} The works in \cite{boulogeorgos2020outage,farrag2021outage} studied the outage probability, which is the complementary cumulative distribution function of the coverage probability, of dual-hop THz-THz links, and \cite{farrag2021outage} further optimized the transmission power.} In \cite{li2021performance}, the authors derived the outage probability and the ergodic capacity of dual-hop THz-RF links, respectively. However, the above distance-fixed three-point (source-relay-destination) model is simplified for a dense DF THz network.  {\color{black} The authors in \cite{sayehvand2020interference} analyzed the downlink coverage probability of the hybrid RF and THz network, but relay communication is not considered.}

Against this background, THz relay selection strategies are lacking in the literature. Moreover, since THz base stations are expected to coexist with RF base stations, a relay selection mechanism involving both THz and RF relays is necessary especially for ultra-dense networks (UDNs) and integrated access and backhaul (IAB) deployments. In this treatise, we propose a hybrid relay selection (HRS) protocol with RF and THz relays. 
Furthermore, the mathematical derivations are based on a realistic THz channel model that follows $\alpha-\mu$ which is an experimentally validated model \cite{papasotiriou2021experimentally}, and the relays are randomly located following a Poisson point process (PPP). The aim of this letter is to investigate the performance of the proposed protocol and how the relay selection is carried out when both RF and THz relays are involved in the selection process. Our proposed HRS protocol is compared with the optimal relay selection that requires a full and perfect instantaneous channel state information (CSI) of all nodes in the networks which is impractical to estimate. We also show when to use RF relays and/or THz relays. Finally, for the sake of completeness, we compare our protocol with RF and THz direct transmissions.

% This letter considers a more general relay scenario where both RF and THz transmissions are available. A device in an HRTRN acts as a relay between the source node (S) and the destination node (D). To our best knowledge, this is the first study on routing in HRTRNs. The detailed communication mode is given as follows.
% \begin{itemize}
%     \item We assume that the locations (of S, D, and the relays) and the frequency band usage of relays are shared, so the beams have been trained, and the communication targets are always within the main lobe of beams. 
%     %What's more, we assume that channel state information (CSI) is available at S, D and relays.
%     \item Assume the relays use mutually orthogonal sub-bands, so there is no co-frequency interference. This assumption is reasonable because narrow-beam transmission is available after beam-forming training. 
%     \item Due to the limitation of the available frequency band, the channel capacity of the relay is tight. Therefore, only the device $x_{\rm{RF},i} \in \widetilde{\Phi}_{\rm{RF}}$ or $x_{\rm{THz},i} \in \widetilde{\Phi}_{\rm{THz}}$ that provides the maximum average rate for D is selected as an associated relay (A) \cite{sayehvand2020interference}. $\widetilde{\Phi}_Q$ is the set of relays that can maintain reliable communication with S, where $Q = \{ \rm{RF}, \rm{THz} \}$. The formulaic expression of $\widetilde{\Phi}_Q$ is given at the end of section~\ref{section2}.
%     %\item  Due to the limitation of the available frequency band, the channel capacity of the relay is tight. Therefore, only the device $x_{\rm{RF},i} \in \widetilde{\Phi}_{\rm{RF}}$ or $x_{\rm{THz},i} \in \widetilde{\Phi}_{\rm{THz}}$ that provides the maximum average received power for D is selected as an associated relay (A) \cite{belbase2018coverage}. $\widetilde{\Phi}_Q$ is the set of relays that can maintain reliable communication with S, where $Q = \{ \rm{RF}, \rm{THz} \}$. The formulaic expression of $\widetilde{\Phi}_Q$ is given at the end of section~\ref{section2}.
%     \item Suppose the decoded-and-forward relay mode is adopted. For a $Q$-type associated relay A, both S-A and A-D links follow the $Q$ channel model, and the fading of the S-A link is independent of the fading of A-D link, where $Q = \{ \rm{RF}, \rm{THz} \}$.
% \end{itemize}


\vspace{-0.3cm}
\section{System Model}\label{section2}

\begin{figure}[t]
	\centering
	\includegraphics[width=0.75\linewidth]{all.png}
	\caption{System model.}
	\label{fig:sys}
	\vspace{-6mm}
\end{figure}

\vspace{-0.1cm}
\subsection{Network Model}
We consider the system model depicted in Fig.~\ref{fig:sys}. Without loss of generality, we set the position of a destination ($D$) at the origin for tractability since the same performance is obtained for any other
$D$ locations due to Slivnyak's Theorem. Also, the direction from a source ($S$) to $D$ is the positive x-axis. In polar coordinate $\left(\rho, \theta \right)$, the positions of $S$ and $D$ can be denoted as $x_S(R_{SD},0)$ and $x_D(0,0)$, respectively, where $R_{SD}$ is the distance between $S$ and $D$. {\color{black} The locations of $Q$ relays form a homogeneous PPP denoted by $\Phi_Q=\{x_{Q,1},x_{Q,2},...\}$ and with density $\lambda_Q$, where $Q$ is replaced by RF in RF networks, and by THz in THz networks. } We assume $\Phi_{\rm{RF}}$ and $\Phi_{\rm{THz}}$ are independent. {\color{black}  All RF and THz relays, referred to as all nodes, are located on a two-dimensional circular disc $\mathcal{C}(x_D, R_C)$ centered at the origin with radius $R_C$. Note that the relays outside $\mathcal{C}(x_D, R_C)$ are not considered since they are far from $D$ and suffer a large signal attenuation.  }Hence, $\mathcal{C}(x_D, R_C)$ is equivalent to the entire ${\R}^{2}$. 
We assume that the locations of $S$, $D$, and the relays and the frequency band of the relays are shared, so the beams have been trained, and the communication targets are always within the main lobe of beams. {\color{black} Owing to the utilization of orthogonal sub-bands and narrow-beam transmission, it is extremely uncommon that the interference signal in the same sub-band is placed in the main lobe of the receiving device, hence the interference is minor compared to noise.}

\par
%\emph{(\uppercase\expandafter{\romannumeral2}) Communication Mode}: In such a static routing scenario, the communication bases on the following assumptions:
\par
\vspace{-0.3cm}
\subsection{Channel Model}
\subsubsection{RF Channel Model}
%\emph{(\uppercase\expandafter{\romannumeral2}) RF Channel Model}: 
RF channels experience path-loss and small-scale fading; therefore, the corresponding received power can be expressed as, $h_{\rm{RF}}\left( R_X \right) = \varepsilon_{{\rm{RF}}}\,G_{{\rm{RF}}}\,\gamma_{\rm{RF}}\,R_X^{-\beta_{\rm{RF}}} \, \mathcal{X}_{\rm{RF}}$,
% \begin{equation}
%     h_{\rm{RF},Q} \left( R_{{\rm{RF}},Q} \right) = \varepsilon_{{\rm{RF}}, Q} \, \gamma_{\rm{RF}} \, R_{{\rm{RF}},Q}^{-\beta_{\rm{RF}}} \, \mathcal{X}_{\rm{RF}}, \ Q = \{ S, D \},
% \end{equation}
%where $R_{{\rm{RF}},S}$ is the distance between S and the relay (not only the associated relay), and $R_{{\rm{RF}},D}$ is the distance between the relay and D, $\varepsilon_{{\rm{RF}},S}$ and $\varepsilon_{{\rm{RF}},D}$ are the transmission powers of S and the relay respectively. 
where $X = \{ S, D \}$, $R_X$ is the distance between a relay and $X$, $\varepsilon_{{\rm{RF}}}$ is the transmitting power, and $G_{{\rm{RF}}}$ is total antenna gain. 
The path-loss is modeled as $\gamma_{\rm{RF}} R_X^{-\beta_{\rm{RF}}}$, where $\beta_{\rm{RF}}$ is the path-loss exponent, $\gamma_{\rm{RF}}=\left({c}/{4 \pi \nu_{\rm{RF}} }\right)^2$, $c=3 \times 10^8$~m/s is the speed of light, and $\nu_{\rm{RF}}$ is the RF carrier frequency.
%The path-loss is modeled as $\gamma_{\rm{RF}} R_{{\rm{RF}},Q}^{-\beta_{\rm{RF}}}$, where $\beta_{\rm{RF}}$ is the path-loss exponent, $\gamma_{\rm{RF}}=\left(\frac{c}{4 \pi \nu_{\rm{RF}} }\right)^2$, $c=3 \times 10^8$m/s is the speed of light, $\nu_{\rm{RF}}$ is the RF carrier frequency in GHz.
The small-scale fading $\mathcal{X}_{\rm{RF}}$ is subject to an exponential distribution with unit mean. The \ac{SNR} of the RF channel is given by
\vspace{-1mm}
\begin{sequation}
    {\rm{SNR}}_{{\rm{RF}},X} = \frac{\varepsilon_{{\rm{RF}}} \,G_{\rm{RF}} \gamma_{\rm{RF}} \, R_X^{-\beta_{\rm{RF}}} \, \mathcal{X}_{\rm{RF}}}{\sigma_{\rm{RF}}^2},
\vspace{-1mm}
\end{sequation}where $\sigma_{\rm{RF}}^2$ is the thermal noise. We note that $\sigma_{\rm{RF}}^2$ is a function of the transmission bandwidth $B_{\rm{RF}}$.
% \begin{equation}
%     {\rm{SNR}}_{{\rm{RF}}} = \frac{\varepsilon_{{\rm{RF}}} \,G_{\rm{RF}} \gamma_{\rm{RF}} \, R^{-\beta_{\rm{RF}}} \, \mathcal{X}_{\rm{RF}}}{\sigma_{\rm{RF}}^2},
% \end{equation}
% \begin{equation}
%     {\rm{SNR}}_{{\rm{RF}},Q} = \frac{\varepsilon_{{\rm{RF}}, Q} \, \gamma_{\rm{RF}} \, R_{{\rm{RF}},Q}^{-\beta_{\rm{RF}}} \, \mathcal{X}_{\rm{RF}}}{\sigma_{\rm{RF}}^2}, \ Q = \{ S, D \},
% \end{equation}
% where $\sigma_{\rm{RF}}^2$ is the thermal noise. We note that $\sigma_{\rm{RF}}^2$ is a function of the transmission bandwidth $B_{\rm{RF}}$.
%where $N_{\rm{RF}}$ is modeled as a zero-mean additive white Gaussian process with variance  $\sigma_{\rm{RF}}^2$.
%where $\sigma_{\rm{RF}}^2$ is the thermal noise of RF relay, ${\rm{SNR}}_{{\rm{RF}},S}$ is the SNR of S-relay link, and ${\rm{SNR}}_{{\rm{RF}}, D}$ is the SNR of relay-D link. 

\par
\subsubsection{THz Channel Model}
%\emph{(\uppercase\expandafter{\romannumeral3}) THz Channel Model}: 
%According to \cite{mumtaz2017terahertz,sayehvand2020interference,chaccour2019reliability},
According to \cite{sayehvand2020interference}, the received power in THz transmission is modeled as, $h_{\rm{THz}} \left( R_X \right) = \varepsilon_{{\rm{THz}}} \, G_{{\rm{THz}}}\, \gamma_{{\rm{THz}}} \, \mathcal{X}_{\rm{THz}}\, {\exp\left({-\beta_{\rm{THz}} R_X}\right)}/{R_X^2} $,
% \begin{sequation}
% \begin{split} 
%     &h_{\rm{THz},Q} \left( R_{{\rm{THz}},Q} \right) \\
%     &= \varepsilon_{{\rm{THz}}, Q} \, \gamma_{{\rm{THz}},Q} \, \mathcal{X}_{\rm{THz}} \frac{\exp\left({-\beta_{\rm{THz}} R_{{\rm{THz}},Q}}\right)}{R_{{\rm{THz}},Q}^2},
%     \ Q = \{ S, D \},
% \end{split}
% \end{sequation}
%where $R_{{\rm{THz}},S}$ and $R_{{\rm{THz}},D}$ are the distance of S-relay and relay-D respectively, $\varepsilon_{{\rm{THz}},S}$ and $\varepsilon_{{\rm{THz}},D}$ are the transmission powers of S and the THz relay. 
where $X = \{ S, D \}$, $R_X$ is the distance between a relay and $X$,  $\varepsilon_{{\rm{THz}}}$ is the transmitting power, and $G_{{\rm{THz}}}$ is the total antenna gain.
The path-loss is modeled as $\gamma_{{\rm{THz}}} {\exp\left({-\beta_{\rm{THz}} R_X}\right)}/{R_X^2}$, where $\gamma_{{\rm{THz}}}=\left({c}/{4 \pi \nu_{\rm{THz}} }\right)^2$ , $\nu_{\rm{THz}}$ is the THz carrier frequency in GHz,  and $\beta_{\rm{THz}}$ is the molecular absorption coefficient related to $\nu_{\rm{THz}}$. The small-scale fading $\mathcal{X}_{\rm{THz}}$ is modeled as $\alpha-\mu$ distribution which is an experimentally validated fading
model for THz frequencies \cite{papasotiriou2021experimentally}. 
%\cite{xie2020reliable,lei2017secrecy}. 
%The path-loss is modeled as $\gamma_{{\rm{THz}},Q} \frac{\exp\left({-\beta_{\rm{THz}} R_{{\rm{THz}},Q}}\right)}{R_{{\rm{THz}},Q}^2}$, where $\gamma_{{\rm{THz}},Q}=G_{{\rm{THz}},Q}\left(\frac{c}{4 \pi \nu_{\rm{THz}} }\right)^2$, $\nu_{\rm{THz}}$ is the RF carrier frequency in GHz, $G_{{\rm{THz}},Q}$ is antenna gain, and $\beta_{\rm{THz}}$ is the molecular absorption coefficient related to $\nu_{\rm{THz}}$. The small scale fading $\mathcal{X}_{\rm{THz}}$ is modeled as $\alpha-\mu$ distribution \cite{xie2020reliable,lei2017secrecy}. 
Moreover, $\alpha$ denotes the fading parameter and $\mu$ denotes the normalized variance of the channel fading.
The \ac{CCDF} of $\mathcal{X}_{\rm{THz}}$ is given by $\bar{F}_{\mathcal{X}_{\rm{THz}}}(m) = {\Gamma(\mu,\mu m^{\frac{\alpha}{2}})}/{\Gamma(\mu)}$, where ${\Gamma(\mu,\mu m^{\frac{\alpha}{2}})}$ and ${\Gamma(\mu)}$ are the upper incomplete Gamma function and the Gamma function, respectively \cite{lei2017secrecy}. The \ac{SNR} of the THz channel is given by
\vspace{-1mm}
\begin{equation}
   {\rm{SNR}}_{{\rm{THz}},X}  = \frac{\varepsilon_{{\rm{THz}}} \,G_{{\rm{THz}}} \gamma_{{\rm{THz}}} \, \exp\left({-\beta_{\rm{THz}} R_X}\right) \, \mathcal{X}_{\rm{THz}}}{\sigma_{\rm{THz}}^2\, R_X^2},
\vspace{-1mm}
\end{equation}
% \begin{equation}
%     {\rm{SNR}}_{{\rm{THz}}}  = \frac{\varepsilon_{{\rm{THz}}} \,G_{{\rm{THz}}} \gamma_{{\rm{THz}}} \, \exp\left({-\beta_{\rm{THz}} R}\right) \, \mathcal{X}_{\rm{THz}}}{\sigma_{\rm{THz}}^2\, R^2},
% \end{equation}
% \begin{sequation}
% \begin{split}
%     &{\rm{SNR}}_{{\rm{THz}},Q} \\   
%     & = \frac{\varepsilon_{{\rm{THz}}, Q} \, \gamma_{{\rm{THz}},Q} \, \exp\left({-\beta_{\rm{THz}} R_{{\rm{THz}},Q}}\right) \, \mathcal{X}_{\rm{THz}}}{\sigma_{\rm{THz}}^2 R_{{\rm{THz}},Q}^2}, \, Q = \{ S, D \},
% \end{split}
% \end{sequation}
where $\sigma_{\rm{THz}}^2$ is the thermal noise, which is a function of the
transmission bandwidth  $B_{\rm{THz}}$. 

\vspace{-0.3cm}
\subsection{Relay Selection Strategy}
%Due to excessive path loss and blockage, DF relay protocol is adopted. For a $Q$-type associated relay ($A$), both $S-A$ and $A-D$ links follow the $Q$ channel model, and the fading of the $S-A$ link is independent of the fading of $A-D$ link. As for selection strategy, we first select two sets of relays $\widetilde{\Phi}_Q$ that can meet the attempted rate $y_{th}$ for $S-A$ link. From these set, only the device $x_{\rm{RF},i} \in \widetilde{\Phi}_{\rm{RF}}$ or $x_{\rm{THz},i} \in \widetilde{\Phi}_{\rm{THz}}$ that provides the maximum average rate for D is selected \cite{sayehvand2020interference}. 

%
Due to excessive path-loss and blockage, a half-duplex DF relay protocol is adopted since the direct link may be blocked.
In fixed topology DF networks, the optimal relay selection relies on the maximization of end-to-end ${\rm{SNR}}_{Q,X}$ or the maximization of the minimum ${\rm{SNR}}_{Q,X}$ of $S-x_{Q,i}$ and $x_{Q,i}-D$ links. However, this protocol requires a full and perfect instantaneous CSI of all the nodes in the networks, that is, CSI between $S$ and all relays, and between all relays and $D$. In addition, due to the randomness of the relay locations, analysis is intractable \cite{wang2022stochastic}. 
% Therefore, we proposed a protocol that does not require instantaneous CSI of all nodes while still being mathematically tractable. 
      {\color {black} 
      Therefore, we proposed a slightly suboptimal protocol that only requires instantaneous CSI between $S$ and all nodes while still being mathematically tractable. } 
The protocol has the following selection strategy:
we first select two sets of relays $\widetilde{\Phi}_Q$ that can meet the attempted rate $y_{th}$ of $S$. Among these sets, only the relay $x_{\rm{RF},i} \in \widetilde{\Phi}_{\rm{RF}}$ or $x_{\rm{THz},i} \in \widetilde{\Phi}_{\rm{THz}}$ that has the
best link to $D$, that is, provides the maximum average rate with $D$ is selected \cite{sayehvand2020interference}. The set of relays that can establish reliable communication with $S$ can be expressed as
%where $\sigma_{\rm{THz}}^2$ is the thermal noise of THz relay, ${\rm{SNR}}_{{\rm{THz}},S}$ and ${\rm{SNR}}_{{\rm{THz}},D}$ are the SNRs of S-relay and relay-D links. 
\vspace{-1mm}
\begin{equation}
    \widetilde{\Phi}_Q=\{x_{Q,i} \in \Phi_Q, \, {\rm{SNR}}_{Q,S} \geq \tau_Q \}, \ Q = \{ \rm{RF}, \rm{THz} \},
\vspace{-1mm}
\end{equation}
where $\tau_Q$ is a predefined threshold, ${\rm{SNR}}_{Q,S}$ is the SNR of S-relay link.  Subsequently, the relation between achievable rate $y_{Q,X}$ and ${\rm{SNR}}_{Q,X}$  is given by
\vspace{-1mm}
\begin{equation}
  y_{Q,X} = \frac{B_{Q}}{2} \log_{2}\left(1+{\rm{SNR}}_{Q,X}\right), \vspace{-1mm}  
\end{equation}
where $B_{Q}$ is the transmission bandwidth of $Q$ link and the factor 1/2 is used because two time slots are required to
transmit data via the relay node. 
%In Section \ref{Num}, we will compare direct transmissions with relay associated communications. 
    {\color{black} The rate coverage probability is defined as the probability of achieving the desired rate $y_{th}$, i.e.,   ${\textrm{SNR}}_{Q,X}>\tau_Q = 2^{\left(2y_{th}/B_Q\right)}-1$.}



%we select one relay that has maximum achievable rate in A-D link.   

% %Therefore, the detailed selection strategy is given as follows:
% \begin{itemize}
%     \item We select a set of relays $\widetilde{\Phi}_Q$ can meet the attempted rate $y_{th}$ in S-A link. 
%     \item 
% \end{itemize}


% \begin{itemize}
%     \item Due to the limitation of the available frequency band, the channel capacity of the relay is tight. Therefore, only the device $x_{\rm{RF},i} \in \widetilde{\Phi}_{\rm{RF}}$ or $x_{\rm{THz},i} \in \widetilde{\Phi}_{\rm{THz}}$ that provides the maximum average rate for D is selected as an associated relay (A) \cite{sayehvand2020interference}. 
%     \item Suppose the decoded-and-forward relay mode is adopted. For a $Q$-type associated relay A, both S-A and A-D links follow the $Q$ channel model, and the fading of the S-A link is independent of the fading of A-D link, where $Q = \{ \rm{RF}, \rm{THz} \}$.
% \end{itemize}
%where $\tau_Q$ is a predefined threshold. 


\vspace{-0.2cm}
\section{{\color{black}Coverage Probability of HRS Protocol}}
In this section, we derive the coverage probability, the intermediate distance distributions, and the association probabilities of the HRS protocol.  Note that the nearest relay provides the largest average rate for $D$ in our model, so the distance distributions are given in Lemmas. 
\vspace{-1mm}
{\color{black}
\begin{lemma}\label{lemma1}
The complementary cumulative distribution function (\ac{CCDF}) of the distance between D and its nearest RF relay is given by
\vspace{-1mm}
\begin{sequation}\label{eq.ccdf.rf}
\begin{split}
    \overline{F}_{R_D,{\rm{RF}}} (r) = \exp \bigg( - \int_0^r \int_0^{2\pi} \lambda_{\rm{RF}} \exp \Big( -\tau_{\rm{RF}} \varepsilon_{{\rm{RF}}}^{-1} \\
    \times G_{{\rm{RF}}}^{-1} \gamma_{{\rm{RF}}}^{-1} \!\left( \rho^2 \!+ \!R_{SD}^2 \!-\! 2\rho R_{SD} \cos\theta \right)^{\frac{\beta_{\rm{RF}}}{2}} \sigma_{\rm{RF}}^2 \Big) \bigg) \rho \, \mathrm{d}\theta \mathrm{d} \rho.
\end{split}
\vspace{-1mm}
\end{sequation}
% \begin{equation}
% \begin{split}
%     \overline{F}_{R_D,{\rm{RF}}} (r) = \exp \bigg( - \int_0^r \int_0^{2\pi} \lambda_{\rm{RF}} \exp \Big( -\tau_{\rm{RF}} \varepsilon_{{\rm{RF}},S}^{-1} \\
%     \times \gamma_{{\rm{RF}}}^{-1} \left( \rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta \right)^{\frac{\beta_{\rm{RF}}}{2}} \sigma_{\rm{RF}}^2 \Big) \bigg) \rho \, \mathrm{d}\theta \mathrm{d} \rho.
% \end{split}
% \end{equation}
where $0 < r \leq R_C$.

Then, the \ac{PDF} of the distance between D and its nearest RF relay is given by,
\vspace{-1mm}
\begin{sequation}\label{PDF of RF}
\begin{split}
    & f_{R_D,{\rm{RF}}}  (r) = r \lambda_{\rm{RF}} \int_0^{2\pi} \exp \Big( -\tau_{\rm{RF}} \varepsilon_{{\rm{RF}}}^{-1}G_{{\rm{RF}}}^{-1}  \gamma_{{\rm{RF}}}^{-1} \\
    &\times \left( \rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta \right)^{\frac{\beta_{\rm{RF}}}{2}} \sigma_{\rm{RF}}^2 \Big) \mathrm{d}\theta \\
    &\times \exp \bigg( - \int_0^r \int_0^{2\pi} \lambda_{\rm{RF}} \exp \Big( -\tau_{\rm{RF}} \varepsilon_{{\rm{RF}}}^{-1}G_{{\rm{RF}}}^{-1}  \gamma_{{\rm{RF}}}^{-1} \\
    &\times \left( \rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta \right)^{\frac{\beta_{\rm{RF}}}{2}} \sigma_{\rm{RF}}^2 \Big) \bigg) \rho \, \mathrm{d}\theta \mathrm{d} \rho.\\
\end{split}
\vspace{-1mm}
\end{sequation}
%and \textcolor{black}{$R_D$ is the distance between $D$ and relay}.
\begin{proof}
The CCDF of the distance can be derived by using the void probability of a homogeneous PPP \cite{haenggi2012stochastic}
% \begin{sequation}\label{app1_1}
% \begin{split}
%     \overline{F}_{R_D,{\rm{RF}}} (r)  = \mathbb{P} \left[ \mathcal{N}\left( \mathcal{C}(x_D,r) \right)=0 \right] = \exp\left( - \Lambda_{\rm{RF}}\left( r \right) \right),
%     \end{split}
% \end{sequation}
\begin{sequation}\label{app1_1}
\begin{split}
    \overline{F}_{R_D,{\rm{RF}}} (r)  =  \mathbb{P} \left[{\rm No\,relays\,in\,} \mathcal{C}(x_D,r)  \right] = \exp\left( - \Lambda_{\rm{RF}}\left( r \right) \right),
    \end{split}
\end{sequation}where $\mathcal{C}(x_D,r)$ is the disk centered at the origin ($x_D$) with radius $r$.
%\textcolor{black}{$\mathcal{N}\left( \mathcal{C}(x_D,r) \right)$} is the number of the RF relays $x_{\rm{RF},i} \in \widetilde{\Phi}_{\rm{RF}}$ in the circular disc $\mathcal{C}(x_D,r)$ centered at the origin ($x_D$) with radius $r$. 
The mean number of RF relays $x_{\rm{RF},i} \in \widetilde{\Phi}_{\rm{RF}}$ in the circular disc $\mathcal{C}(x_D,r)$, denoted by $\Lambda_{\rm{RF}}\left( r \right)$, can be written as
\vspace{-1mm}
\begin{equation}\label{app1_2}
    \Lambda_{\rm{RF}}\left( r \right) = \int_0^r \int_0^{2\pi} \widehat{\lambda}_{\rm{RF}}(\rho,\theta) \rho \, \mathrm{d}\theta \mathrm{d} \rho,
\vspace{-1mm}
\end{equation}where $\rho$ and $\theta$ are the radial distance and polar angle in the polar coordinate system respectively, and $\widehat{\lambda}_{\rm{RF}}(\rho,\theta)$ is the density of $\widetilde{\Phi}_{\rm{RF}}$. The set $\widetilde{\Phi}_{\rm{RF}}$ can be regarded as a dependent-thinning of $\Phi_{\rm{RF}}$, and only the relays that have an ${\rm{SNR}}_{{\rm{RF}},S}$ greater than the threshold $\tau_{\rm{RF}}$ are retained. Hence, the set $\widetilde{\Phi}_{\rm{RF}}$ is a inhomogeneous PPP of
density $\widehat{\lambda}_{\rm{RF}}(\rho,\theta)$. The density $\widehat{\lambda}_{\rm{RF}}(\rho,\theta)$ can be derived as follows
\vspace{-1mm}
\begin{sequation}\label{app1_3}
\begin{split}
\widehat{\lambda}_{\rm{RF}}(\rho,\theta) &= \lambda_{\rm{RF}} \, \mathbb{P} \left[\frac{\varepsilon_{{\rm{RF}}} \, G_{\rm{RF}} \gamma_{\rm{RF}} \, R_{S}^{-\beta_{\rm{RF}}} \, \mathcal{X}_{\rm{RF}}}{\sigma_{\rm{RF}}^2} > \tau_{\rm{RF}}\right] \\
    &= \lambda_{\rm{RF}} \, \mathbb{P} \left[ \mathcal{X}_{\rm{RF}} > \tau_{\rm{RF}} \varepsilon_{{\rm{RF}}}^{-1} G_{{\rm{RF}}}^{-1} \gamma_{{\rm{RF}}}^{-1} R_{S} ^{\beta_{\rm{RF}}} \sigma_{\rm{RF}}^2 \right] \\
    &= \lambda_{\rm{RF}} \exp\left( -\tau_{\rm{RF}} \varepsilon_{{\rm{RF}}}^{-1} G_{{\rm{RF}}}^{-1} \gamma_{{\rm{RF}}}^{-1} R_{S} ^{\beta_{\rm{RF}}} \sigma_{\rm{RF}}^2 \right),
\end{split}
\vspace{-2mm}
\end{sequation}where $R_S$ is the distance between $S$ and relay and can expressed as
\vspace{-2mm}
\begin{equation}\label{app1_4}
    R_{S}^2 = \rho^2 + R_{SD}^2 - 2\rho \, R_{SD} \cos\theta.
\vspace{-1mm}
\end{equation}
% \begin{equation}\label{app1_4}
%     R_{{\rm{RF}},S}^2 = \rho^2 + R_{SD}^2 - 2\rho \, R_{SD} \cos\theta.
% \end{equation}

By substituting (\ref{app1_2}), (\ref{app1_3}), and (\ref{app1_4}) into (\ref{app1_1}), we obtain (\ref{eq.ccdf.rf}). Then, using $f_{R_D,{\rm{RF}}}(r) = -\frac{\mathrm{d}}{\mathrm{d}r}\overline{F}_{R_D,{\rm{RF}}} (r)$ and Leibniz integral rule, (\ref{PDF of RF}) is derived straightforwardly.

\end{proof}
\end{lemma}
% \begin{equation}\label{app1_3}
% \begin{split}
%     \widehat{\lambda}_{\rm{RF}}(\rho,\theta) &= \lambda_{\rm{RF}} \, \mathbb{P} \left[\frac{\varepsilon_{{\rm{RF}}, S} \, \gamma_{\rm{RF}} \, R_{{\rm{RF}},S}^{-\beta_{\rm{RF}}} \, \mathcal{X}_{\rm{RF}}}{\sigma_{\rm{RF}}^2} > \tau_{\rm{RF}}\right] \\
%     &= \lambda_{\rm{RF}} \, \mathbb{P} \left[ \mathcal{X}_{\rm{RF}} > \tau_{\rm{RF}} \varepsilon_{{\rm{RF}},S}^{-1} \gamma_{{\rm{RF}}}^{-1} R_{{\rm{RF}},S} ^{\beta_{\rm{RF}}} \sigma_{\rm{RF}}^2 \right] \\
%     &= \lambda_{\rm{RF}} \exp\left( -\tau_{\rm{RF}} \varepsilon_{{\rm{RF}},S}^{-1} \gamma_{{\rm{RF}}}^{-1} R_{{\rm{RF}},S} ^{\beta_{\rm{RF}}} \sigma_{\rm{RF}}^2 \right).
% \end{split}
% \end{equation}

% \begin{lemma}\label{lemma2}
% The \ac{PDF} of the distance between D and its nearest RF relay is given by,
% \begin{equation}\label{PDF of RF}
% \begin{split}
%     & f_{R_D,{\rm{RF}}}  (r) = r \lambda_{\rm{RF}} \int_0^{2\pi} \exp \Big( -\tau_{\rm{RF}} \varepsilon_{{\rm{RF}}}^{-1}G_{{\rm{RF}}}^{-1}  \gamma_{{\rm{RF}}}^{-1} \\
%     &\times \left( \rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta \right)^{\frac{\beta_{\rm{RF}}}{2}} \sigma_{\rm{RF}}^2 \Big) \mathrm{d}\theta \\
%     &\times \exp \bigg( - \int_0^r \int_0^{2\pi} \lambda_{\rm{RF}} \exp \Big( -\tau_{\rm{RF}} \varepsilon_{{\rm{RF}}}^{-1}G_{{\rm{RF}}}^{-1}  \gamma_{{\rm{RF}}}^{-1} \\
%     &\times \left( \rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta \right)^{\frac{\beta_{\rm{RF}}}{2}} \sigma_{\rm{RF}}^2 \Big) \bigg) \rho \, \mathrm{d}\theta \mathrm{d} \rho.\\
% \end{split}
% \end{equation}
% \begin{equation}\label{PDF of RF}
% \begin{split}
%     f_{R_D,{\rm{RF}}} & (r) = r \lambda_{\rm{RF}} \int_0^{2\pi} \exp \Big( -\tau_{\rm{RF}} \varepsilon_{{\rm{RF}},S}^{-1} \gamma_{{\rm{RF}}}^{-1} \\
%     &\times \left( \rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta \right)^{\frac{\beta_{\rm{RF}}}{2}} \sigma_{\rm{RF}}^2 \Big) \mathrm{d}\theta \\
%     &\times \exp \bigg( - \int_0^r \int_0^{2\pi} \lambda_{\rm{RF}} \exp \Big( -\tau_{\rm{RF}} \varepsilon_{{\rm{RF}},S}^{-1} \gamma_{{\rm{RF}}}^{-1} \\
%     &\times \left( \rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta \right)^{\frac{\beta_{\rm{RF}}}{2}} \sigma_{\rm{RF}}^2 \Big) \bigg) \rho \, \mathrm{d}\theta \mathrm{d} \rho \\
% \end{split}
% \end{equation}
% \begin{proof}
% Using $f_{R_D,{\rm{RF}}}(r) = -\frac{\mathrm{d}}{\mathrm{d}r}\overline{F}_{R_D,{\rm{RF}}} (r)$ and Leibniz integral rule, Lemma~\ref{lemma2} is derived straightforwardly.
% %, thus the detailed steps are omitted.
% \end{proof}
% \end{lemma}
\vspace{-1mm}
\begin{lemma}\label{lemma3}
The \ac{CCDF} and PDF of the distance between D and its nearest THz relay are given by (\ref{CCDF of THz}) and (\ref{PDF of THz}), respectively, shown at the top of the next page.

\begin{table*}
\vspace{-6mm}
\begin{sequation}\label{CCDF of THz}
\begin{split}
    \overline{F}_{R_D,{\rm{THz}}} (r) = \exp \left( - \frac{\lambda_{\rm{THz}}}{\Gamma\left(\mu\right)} \int_0^r \int_0^{2\pi} {\Gamma \left(\mu, \mu \, \left(  \frac{\tau_{\rm{THz}} \left(\rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta\right) \sigma_{\rm{THz}}^2 } {\varepsilon_{{\rm{THz}}}G_{{\rm{THz}}} \gamma_{{\rm{THz}}} \exp\left(-\beta_{\rm{THz}} \left( \rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta \right)^{\frac{1}{2}} \right)} \right)^{\frac{\alpha}{2}} \right)} \rho \, \mathrm{d}\theta \mathrm{d} \rho \right).
\end{split}
\end{sequation}
\vspace{-0.3cm}
\begin{sequation}\label{PDF of THz}
\begin{split}
   f_{R_D,{\rm{THz}}} (r) &= r \, \frac{\lambda_{\rm{THz}}}{\Gamma\left(\mu\right)}  \int_0^{2\pi} {\Gamma \left(\mu, \mu \, \left(  \frac{\tau_{\rm{THz}} \left(r^2 + R_{SD}^2 - 2r R_{SD} \cos\theta\right) \sigma_{\rm{THz}}^2 } {\varepsilon_{{\rm{THz}}}G_{{\rm{THz}}} \gamma_{{\rm{THz}}} \exp\left(-\beta_{\rm{THz}} \left( r^2 + R_{SD}^2 - 2r R_{SD} \cos\theta \right)^{\frac{1}{2}} \right)} \right)^{\frac{\alpha}{2}} \right)} \, \mathrm{d}\theta \\ 
   \vspace{-1mm}
   &\times \exp \left( - \frac{\lambda_{\rm{THz}}}{\Gamma\left(\mu\right)} \int_0^r \int_0^{2\pi} {\Gamma \left(\mu, \mu \, \left(  \frac{\tau_{\rm{THz}} \left(\rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta\right) \sigma_{\rm{THz}}^2 } {\varepsilon_{{\rm{THz}}}G_{{\rm{THz}}} \gamma_{{\rm{THz}}} \exp\left(-\beta_{\rm{THz}} \left( \rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta \right)^{\frac{1}{2}} \right)} \right)^{\frac{\alpha}{2}} \right)} \rho \, \mathrm{d}\theta \mathrm{d} \rho \right).
\end{split}
\vspace{-0.2cm}
\end{sequation}
\vspace{-0.1cm}
\noindent\rule{\linewidth}{0.2mm}
\vspace{-0.4cm}
\end{table*}

\begin{proof}
Following the same steps as in Lemma~\ref{lemma1}, we obtain
%The first several steps of the proof of Lemma~\ref{lemma3} are similar to that of Lemma~\ref{lemma1}, so we skip the derivation of these steps and directly provide the following result,
\vspace{-1mm}
\begin{sequation}\label{app2_1}
    \overline{F}_{R_D,{\rm{THz}}} (r) = \exp \left( {-\int_0^r \int_0^{2\pi} \widehat{\lambda}_{\rm{THz}}(\rho,\theta) \rho \, \mathrm{d}\theta \mathrm{d} \rho} \right),
\vspace{-1mm}
\end{sequation}where $\widehat{\lambda}_{\rm{THz}}(\rho,\theta)$ is the density of $\widetilde{\Phi}_{\rm{THz}}$, which is given by
\vspace{-1mm}
\begin{sequation}\label{app2_2}
\begin{split}
    &\widehat{\lambda}_{\rm{THz}}(\rho,\theta)  
    = \lambda_{\rm{THz}} \, \mathbb{P} \left[ \frac{\varepsilon_{{\rm{THz}}} \,G_{{\rm{THz}}} \gamma_{{\rm{THz}}} \, \, \mathcal{X}_{\rm{THz}}}{\sigma_{\rm{THz}}^2\,\exp\left({\beta_{\rm{THz}} R_S}\right)\, R_S^2}> \tau_{\rm{THz}}\right] \\
    &= \lambda_{\rm{THz}} \, \mathbb{P} \bigg[ \mathcal{X}_{\rm{THz}} > \frac{\tau_{\rm{THz}} R_{S}^2 \exp \left( \beta_{\rm{THz}} R_{S} \right) \sigma_{\rm{THz}}^2}{\varepsilon_{{\rm{THz}}}G_{{\rm{THz}}} \gamma_{{\rm{THz}}}}  \bigg] \\
    &\overset{(a)}{=} \frac{\lambda_{\rm{THz}}}{\Gamma\left(\mu\right)} \Gamma \left(\mu, \mu \, \left(  \frac{\tau_{\rm{THz}} R_{S}^2 \exp\left(\beta_{\rm{THz}} R_{S} \right) \sigma_{\rm{THz}}^2 }  {\varepsilon_{{\rm{THz}}}G_{{\rm{THz}}} \gamma_{{\rm{THz}}}} \right)^{\frac{\alpha}{2}} \right),
\end{split}
\vspace{-1mm}
\end{sequation}where (a) follows the definition of the \ac{CCDF} of $\mathcal{X}_{\rm{THz}}$. Substituting (\ref{app2_2}) and (\ref{app1_4}) into (\ref{app2_1}) concludes the proof of (\ref{CCDF of THz}). Similar to the proof of (\ref{PDF of RF}) in Lemma~\ref{lemma1}, (\ref{CCDF of THz}) is given by $f_{R_D,{\rm{THz}}}(r) = -\frac{\mathrm{d}}{\mathrm{d}r}\overline{F}_{R_D,{\rm{THz}}} (r)$.
\end{proof}
\end{lemma}}
% \begin{sequation}\label{app2_2}
% \begin{split}
%     &\widehat{\lambda}_{\rm{THz}}(\rho,\theta) \\
%     &= \lambda_{\rm{THz}} \, \mathbb{P} \bigg[ \mathcal{X}_{\rm{THz}} > \frac{\tau_{\rm{THz}} R_{{\rm{THz}},D}^2 \sigma_{\rm{THz}}^2}{\varepsilon_{{\rm{THz}},D} \gamma_{{\rm{THz}},D} \exp \left( -\beta_{\rm{THz}} R_{{\rm{THz}},D} \right)}  \bigg] \\
%     &\overset{(a)}{=} \frac{\lambda_{\rm{THz}}}{\Gamma\left(\mu\right)} \Gamma \left(\mu, \mu \, \left(  \frac{\tau_{\rm{THz}} R_{{\rm{THz}},D}^2 \sigma_{\rm{THz}}^2 } {\gamma_{{\rm{THz}},D} \varepsilon_{{\rm{THz}},D} \exp\left(-\beta_{\rm{THz}} R_{{\rm{THz}},D} \right)} \right)^{\frac{\alpha}{2}} \right),
% \end{split}
% \end{sequation}

% \begin{lemma}\label{lemma4}
% The expression of the \ac{PDF} of the distance between D and its nearest THz relay is given by
% $f_{R_D,{\rm{THz}}}(r) = -\frac{\mathrm{d}}{\mathrm{d}r}\overline{F}_{R_D,{\rm{THz}}} (r)$.  
% \begin{proof}
% The proof of Lemma~\ref{lemma4} is similar to that of Lemma~\ref{lemma2}, therefore it is omitted here.
% \end{proof}

%The \ac{PDF} of the distance between D and the nearest THz relay to D is given by (\ref{PDF of THz}), which is shown at the top of the next page.

%\begin{table*}
%\vspace{-6mm}
%\begin{sequation}\label{PDF of THz}
%\begin{split}
%    f_{R_D,{\rm{THz}}} (r) &= r \, \frac{\lambda_{\rm{THz}}}{\Gamma\left(\mu\right)}  \int_0^{2\pi} {\Gamma \left(\mu, \mu \, \left(  \frac{\tau_{\rm{THz}} \left(r^2 + R_{SD}^2 - 2r R_{SD} \cos\theta\right) \sigma_{\rm{THz}}^2 } {\varepsilon_{{\rm{THz}}}G_{{\rm{THz}}} \gamma_{{\rm{THz}}} \exp\left(-\beta_{\rm{THz}} \left( r^2 + R_{SD}^2 - 2r R_{SD} \cos\theta \right)^{\frac{1}{2}} \right)} \right)^{\frac{\alpha}{2}} \right)} \, \mathrm{d}\theta \\ 
%    &\times \exp \left( - \frac{\lambda_{\rm{THz}}}{\Gamma\left(\mu\right)} \int_0^r \int_0^{2\pi} {\Gamma \left(\mu, \mu \, \left(  \frac{\tau_{\rm{THz}} \left(\rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta\right) \sigma_{\rm{THz}}^2 } {\varepsilon_{{\rm{THz}}}G_{{\rm{THz}}} \gamma_{{\rm{THz}}} \exp\left(-\beta_{\rm{THz}} \left( \rho^2 + R_{SD}^2 - 2\rho R_{SD} \cos\theta \right)^{\frac{1}{2}} \right)} \right)^{\frac{\alpha}{2}} \right)} \rho \, \mathrm{d}\theta \mathrm{d} \rho \right).
%\end{split}
%\end{sequation}
%\noindent\rule{\linewidth}{0.2mm}
%\vspace{-5mm}
%\end{table*}
%\begin{proof}

%The proof of Lemma~\ref{lemma4} is similar to that of Lemma~\ref{lemma2}, therefore omit here.
%\end{proof}
% \end{lemma}

Using the above Lemmas, we derive the distribution of RF and THz relays that are closest to $D$. However, for the nearest RF relay to be selected, it is necessary to ensure that the achievable rate of THz transmission is less than that of RF transmission, and vice versa. Therefore, we calculate the (\textbf{selection}) association probabilities in the following two Lemmas.

%Through the above Lemmas, we derive the distribution of RF and THz relays, which are closest to D. However, for the nearest RF relay to be associated, it is necessary to ensure that the received power of THz transmission is weaker than that of RF transmission. Therefore, we introduce the association probabilities and formulate them in the following two Lemmas.

\vspace{-1mm}
\begin{lemma}\label{lemma5}
Given that the distance between $D$ and its nearest RF relay is $r$, the probability that $D$ \textbf{selects}/associates with this RF relay is given by
\vspace{-1mm}
\begin{equation}\label{association of RF}
    P_{\rm{RF}}^A (r) = 1 - \int_0^{R_{\rm{R2T}}(r)} f_{R_D,{\rm{THz}}}(\rho) \mathrm{d} \rho,
\vspace{-1mm}
\end{equation}
%where $f_{R_D,{\rm{THz}}}(r)$ is defined in (\ref{PDF of THz}), and $R_{\rm{R2T}}$ is given by,
where $R_{\rm{R2T}}$ is given by
\vspace{-1mm}
\begin{sequation}\label{R2T}
\begin{split}
   & R_{\rm{R2T}}(r) = \frac{2}{\beta_{\rm{THz}}} \times \\
   & \mathcal{W}\!\!\left(\!\!\frac{\beta_{\rm{THz}}}{2}\! \!\left(\!\!\!\left(\!\!\left(\! 1\!\!+\! \frac{\varepsilon_{{\rm{RF}}} G_{{\rm{RF}}}\gamma_{{\rm{RF}}} }{r^{\beta_{\rm{RF}}}\sigma_{{\rm{RF}}}^2}\! \right)^{\!\!\frac{B_{{\rm{RF}}}}{B_{{\rm{THz}}}}}\!\!\!\!\!-\!1\!\!\right)\!\! \frac{\sigma_{{\rm{THz}}}^2}{\varepsilon_{{\rm{THz}}} G_{{\rm{THz}}}\gamma_{{\rm{THz}}}}\!\!\right)^{\!\!\!-\!\frac{1}{2}}\!\right)\!.
\end{split}
\vspace{-1mm}
\end{sequation}
% \begin{equation}\label{R2T}
%     R_{\rm{R2T}}(r) = \frac{2}{\beta_{\rm{THz}}}\mathcal{W}\left(\frac{\beta_{\rm{THz}}}{2} \left( \frac{\varepsilon_{{\rm{THz}},D} \gamma_{{\rm{THz}},D} r^{\beta_{\rm{RF}}} }{\varepsilon_{{\rm{RF}},D} \gamma_{\rm{RF}} } \right)^{\frac{1}{2}}\right),
% \end{equation}
We note that $\mathcal{W}\left( \cdot \right)$ is the Lambert $\mathcal{W}$-function defined as the inverse of the function $f_{\mathcal{W}}(m)=m e^m$. 
\begin{proof}
%We start the proof with the distance of nearest THz relay, denoted as $R_{\rm{R2T}}$ \cite{UAV_SG}. $R_{\rm{R2T}}$ can be solved by making the average achievable rate of RF relay with distance $r$ to $D$ equal to that of THz relays with distance $R_{\rm{R2T}}$ to $D$

The distance of the nearest THz relay, denoted by $R_{\rm{R2T}}$, can be solved by setting the average achievable rate of the RF relay with distance $r$ to $D$ equals to that of the THz relay with distance $R_{\rm{R2T}}$ to $D$ \cite{UAV_SG}
\vspace{-1mm}
\begin{equation}
\begin{split}
    \mathbb{E}_{\mathcal{X}_{\rm{RF}}} & \left[{\rm{SNR}}_{{\rm{RF}},D}|R_{{\rm{RF}},D}=r\right] \\
    &=\mathbb{E}_{\mathcal{X}_{\rm{THz}}}  \left[{\rm{SNR}}_{{\rm{THz}},D}|R_{{\rm{THz}},D}=R_{\rm{R2T}}\right].
\end{split}
\vspace{-1mm}
\end{equation}
%We start the proof with the distance of nearest interfering THz relay, denoted as $R_{\rm{R2T}}$ \cite{UAV_SG}. $R_{\rm{R2T}}$ can be solved by making the average received power of RF relay with distance $r$ to D equal to the average received power of THz relays with distance $R_{\rm{R2T}}$ to D,
% \begin{equation}
% \begin{split}
%     \mathbb{E}_{\mathcal{X}_{\rm{RF}}} & \left[h_{{\rm{RF}},D}|R_{{\rm{RF}},D}=r\right] \\
%     &=\mathbb{E}_{\mathcal{X}_{\rm{THz}}}  \left[h_{{\rm{THz}},D}|R_{{\rm{THz}},D}=R_{\rm{R2T}}\right].
% \end{split}
% \end{equation}

From the above equation, the relationship between $R_{\rm{R2T}}$ and $r$ is given by (\ref{R2T}). By the definition of association probability $P_{\rm{RF}}^A (r)$ in Lemma~\ref{lemma5} and the maximum average received power associated strategy, the following result is given
\vspace{-1mm}
\begin{equation}
\begin{split}
    P_{\rm{RF}}^A (r) &=\mathbb{P} \left[{\rm No\,relays\,in\,} \mathcal{C}(x_D,R_{\rm{R2T}})  \right] =
    \\
    &= 1 - \int_0^{R_{\rm{R2T}}(r)} f_{R_D,{\rm{THz}}}(\rho) \mathrm{d} \rho.
\end{split}
\vspace{-1mm}
\end{equation}
This concludes the proof of Lemma~\ref{lemma5}.
\end{proof}
\end{lemma}


\vspace{-1mm}
\begin{lemma}\label{lemma6}
Given that the distance between $D$ and its nearest THz relay is $r$, the probability that $D$ \textbf{selects}/associates with this THz relay is given by
\vspace{-1mm}
\begin{equation}\label{association of THz}
    P_{\rm{THz}}^A (r) = 1 - \int_0^{R_{\rm{T2R}}(r)} f_{R_D,{\rm{RF}}}(\rho) \mathrm{d} \rho,
\vspace{-1mm}
\end{equation}
where $f_{R_D,{\rm{RF}}}(r)$ is defined in (\ref{PDF of RF}) and $R_{\rm{T2R}}(r)$ is given by
\vspace{-1mm}
\begin{sequation}
\begin{split}
   & R_{\rm{T2R}}(r) = \\
   &\left(\!\!\!\left(\!\!\!\left(\!\!1\!\!+\!\! \frac{\varepsilon_{{\rm{THz}}}G_{\rm{THz}} \gamma_{\rm{THz}}}{r^2 \exp\left(\beta_{\rm{THz}}r \right) \sigma_{\rm{THz}}^2}\!\right)^\frac{{B_{\rm{THz}}}}{{B_{\rm{RF}}}}\!\!\!\!\!-\!1\!\!\right)\!\frac{\sigma_{\rm{RF}}^2}{\varepsilon_{{\rm{RF}}}G_{\rm{RF}} \gamma_{\rm{RF}}} \!\!\right)^{-\frac{1}{\beta_{\rm{RF}}}}\!.
\end{split}
\vspace{-1mm}
\end{sequation}
% \begin{equation}
%     R_{\rm{T2R}}(r) = \left( \frac{\varepsilon_{{\rm{RF}},D} \gamma_{\rm{RF}} r^2}{\varepsilon_{{\rm{THz}},D} \gamma_{{\rm{THz}},D} \exp\left(-\beta_{\rm{THz}}r \right)} \right)^{\frac{1}{\beta_{\rm{RF}}}}.
% \end{equation}
\begin{proof}
The proof of Lemma~\ref{lemma6} is similar to that of Lemma~\ref{lemma5} and therefore, omitted here.
\end{proof}
\end{lemma}

\begin{figure*}[htbp]
\vspace{-0.2cm}
\begin{minipage}[t]{0.32\linewidth}
\centering
\includegraphics[width=0.82\linewidth]{figure1.pdf}
\vspace{-0.1cm}
\caption{Density of RF and THz relays under the same coverage probability of HRS.}
\label{fig1}
\end{minipage}
\hfill
\begin{minipage}[t]{0.32\linewidth}
\centering
\includegraphics[width=0.82\linewidth]{figure2.pdf}
\vspace{-0.1cm}
\caption{Impact of transmission power and desired rate threshold on HRS.}
\label{fig2}
\end{minipage}
\hfill
\begin{minipage}[t]{0.32\linewidth}
\centering
\includegraphics[width=0.82\linewidth]{figure3.pdf}
%\vspace{-0.7cm}
\vspace{-0.1cm}
\caption{Impact of relay density and source-destination distance on HRS.}
\label{fig3}
\end{minipage}
\vspace{-0.6cm}
\end{figure*}

Based on the distance distributions and association probabilities, the main result of this letter is given by the following theorem.
\vspace{-1mm}
\begin{theorem}\label{theorem}
The coverage probability at $D$ using the HRS protocol is given by
\vspace{-1mm}
\begin{sequation}\label{coverage probability}
\begin{split}
    P^C =& \int_0^{R_C} f_{R_D,{\rm{RF}}}(\rho) \exp\left( - \frac{\tau_{\rm{RF}} \rho^{\beta_{\rm{RF}}} \sigma_{\rm{RF}}^2}{\varepsilon_{{\rm{RF}}}G_{{\rm{RF}}}\gamma_{{\rm{RF}}}} \right) P_{\rm{RF}}^A\left(\rho\right) \, \mathrm{d}\rho \\
    &+ \int_0^{R_C} f_{R_D,{\rm{THz}}}(\rho) P_{\rm{THz}}^A\left(\rho\right) \frac{1}{\Gamma \left(\mu\right)} \\
    &\times {\Gamma \! \left(\!\mu, \mu \, \left(  \frac{\tau_{\rm{THz}} \rho^2 \sigma_{\rm{THz}}^2 } {\varepsilon_{{\rm{THz}}}G_{{\rm{THz}}}  \gamma_{{\rm{THz}}}  \exp\left(-\beta_{\rm{THz}} \rho \right)} \right)^{\frac{\alpha}{2}} \right)}  \, \mathrm{d} \rho.
\end{split}
\vspace{-1mm}
\end{sequation}%\textcolor{black}{where $P_{\rm{RF}}^A (r)$ and $P_{\rm{THz}}^A (r)$ are defined by (\ref{association of RF}) and (\ref{association of THz}), respectively.}

\begin{proof}
{\color{black}  The coverage probability $P^C$ is defined as the probability that the received ${\rm{SNR}}_{Q,D}$ at the receiver $D$ from the selected $Q$ relay is above the predefined threshold $\tau_Q$, i.e., $P^C = \mathbb{P}\left[{\rm{SNR}}_{Q,D}>\tau_Q\right]$.} We divide the overall coverage probability $P^C$ into coverage probability associated with RF relay $P_{\rm{RF}}^C$ and coverage probability associated with THz relay $P_{\rm{THz}}^C$, i.e., $P^C=P_{\rm{RF}}^C+P_{\rm{THz}}^C$. Furthermore, $P_{\rm{RF}}^C$ can be obtained by (\romannumeral1) solving the coverage probability given that the distance of $S-x_{\rm{RF},i}$ is $R_{{\rm{RF}},D}=\rho$; (\romannumeral2) multiplying the coverage probability with the association probability given that the distance of $S-x_{\rm{RF},i}$ is $R_{{\rm{RF}},D}=\rho$ (which is denoted as $P_{\rm{RF}}^A\left(\rho\right)$); (\romannumeral3) compute the expectation $\mathbb{E}_{\rho}$. Hence, $P_{\rm{RF}}^C$ is calculated as follows
\begin{sequation}
\begin{split}
    P_{\rm{RF}}^C &= \mathbb{E}_{\rho}\left[  \mathbb{P}\left[ {\rm{SNR}}_{{\rm{RF}},D}>\tau_{\rm{RF}} | R_{{\rm{RF}},D}=\rho \right] P_{\rm{RF}}^A\left(\rho\right) \right] \\
    &=  \mathbb{E}_{\rho}\left[ \exp\left( - \frac{\tau_{\rm{RF}} \rho^{\beta_{\rm{RF}}} \sigma_{\rm{RF}}^2}{\varepsilon_{{\rm{RF}}}G_{{\rm{RF}}}\gamma_{{\rm{RF}}}} \right) P_{\rm{RF}}^A\left(\rho\right) \right] \\
    &= \int_0^{R_C} \!\!\!f_{R_D,{\rm{RF}}}(\rho) \exp\left( - \frac{\tau_{\rm{RF}} \rho^{\beta_{\rm{RF}}} \sigma_{\rm{RF}}^2}{\varepsilon_{{\rm{RF}}}G_{{\rm{RF}}}\gamma_{{\rm{RF}}}} \right) P_{\rm{RF}}^A\left(\rho\right) \, \mathrm{d}\rho. 
\end{split}
\end{sequation}The proof of $P_{\rm{THz}}^C$ is similar to the proof of $P_{\rm{RF}}^C$, therefore, it is omitted here.
{\color{black} We note that the association probability $P_{Q}^A$ is contained in the coverage probability associated with $Q$ relay $P_{Q}^C$.}
By using $P^C=P_{\rm{RF}}^C+P_{\rm{THz}}^C$, the overall coverage probability is derived.
\end{proof}
\end{theorem}


\vspace{-5mm}
\section{Numerical Results} \label{Num}
In this section, we provide selected simulation results to demonstrate the performance of the proposed HRS protocol. The simulations coincide perfectly with the theoretical analysis, and 
 each simulation is performed over $10^6$ independent network realizations within a circular disc of radius $R_C = 200$~m.
%The antenna gains of \acp{RF} $G_{\rm{RF}}$ and \acp{THz} $G_{\rm{THz}}$ are set as 20~dB and 40~dB, respectively. 
We consider the THz link with an antenna gain $G_{\rm{THz}} =40$~dBi and a carrier frequency $\nu_{\rm{THz}} = 1.8$~THz. The corresponding absorption value $\beta_{\rm{THz}}$ is chosen from the realistic database, which is $0.2$~m$^{-1}$ \cite{GORDON20173}. To simulate the $\alpha - \mu$ channel, we set $\alpha = 2$ and $\mu = 4$ for the THz link. The carrier frequency $\nu_{\rm{RF}}$ of the RF link is $2.1$~GHz. The antenna gain $G_{\rm{RF}}$ is $20$~dBi and path-loss exponent $\beta_{\rm{RF}} = 2.5$. {\color{black} We set the noise power to $-174$~dBm/Hz for both links such as $\sigma^{2}_{Q}=-174+10\log_{10} B_Q$ \rm{dBm} %$\sigma^{2}_{Q}=-174~\rm{dBm} B_{Q}$}
, while the transmission bandwidths $B_{\rm{RF}} = 40$~MHz and $B_{\rm{THz}} = 0.5$~GHz, by calculation $\sigma^{2}_{\rm{RF}} = -98$~dBm and $\sigma^{2}_{\rm{THz}} = -87$~dBm. }
%In all figures, the curves represent the numerical analysis and the triangles denote simulations. 
%\textcolor{blue}{It can be seen that the results of Monte-Carlo simulations (triangles) coincide perfectly with the theoretical analysis (curves), hence, confirming the correctness of our analysis.}  

% \begin{figure}[t]
% 	\centering
% 	\includegraphics[width=0.75\linewidth]{figure1.pdf}
% 	\caption{Density complementarity of RF and THz relays under the same coverage probabilities.}
% 	\label{fig1}
% 	\vspace{-0.4cm}
% \end{figure}

{\color{black} Fig.~\ref{fig1} shows the density of RF and THz relays in the HRS protocol required to achieve a given coverage probability when $\varepsilon_{{Q}}=$ $1$~W, $R_{SD} = 50$~m, and $y_{th}= 420$~Mbps. For a given coverage probability, when $\lambda_{\rm{THz}}$ increases linearly, $\lambda_{\rm{RF}}$ decreases roughly linearly. Moreover, when the coverage probability grows from $0.7$ to $0.9$, the slopes of the three curves increase consecutively, but the amplitude of the increase is quite small. Specifically,  approximately $20$ additional THz relays are required for $1$ RF relay reduced to maintain the same coverage probability for an area of $2 \times 10^4$ m$^2$. }
%From the figure we conclude that RF $\approx$ 15.6 THz  for $P^C=0.9$,  
%1 RF $\approx$ 18.5 THz for $P^C=0.8$, and
%1 RF $\approx$ 22.2 THz for $P^C=0.7$.
%Hence, for lower coverage probability values, a higher number of THz relays are needed to replace an RF relay, and inversely.






%Fig.~\ref{fig1} shows the density of RF and THz relays required to achieve a given coverage probability when the transmitting power of all relays is set to 1~W and when $R_{SD} = 50$~m. The desired rate threshold $y_{th}$ is set to 420~Mbps. With a fixed coverage probability, as $\lambda_{\rm{THz}}$ increases linearly, $\lambda_{\rm{RF}}$ decreases linearly. Approximately 4.9 additional THz relays are required for each RF relay reduced to maintain the same coverage probability. We can notice that the line segments in Fig.~\ref{fig1} have the same slope, therefore, the above observation is not affected by the value of coverage probability.

% \begin{figure}[t]
% 	\centering
% 	\includegraphics[width=0.75\linewidth]{figure2.pdf}
% 	\caption{Influences of transmission power and desired rate threshold on coverage probability.}
% 	\label{fig2}
% 	\vspace{-0.4cm}
% \end{figure}

% \begin{figure*}[htbp]
% \begin{minipage}[t]{0.32\linewidth}
% \centering
% \includegraphics[width=0.8\linewidth]{figure1.pdf}
% \caption{Density complementary of RF and THz relays under the same coverage probabilities.}
% \label{fig1}
% \end{minipage}
% \hfill
% \begin{minipage}[t]{0.32\linewidth}
% \centering
% \includegraphics[width=0.8\linewidth]{figure5.pdf}
% \caption{Influences of scenarios and desired rate threshold on coverage probability.}
% \label{fig2}
% \end{minipage}
% \hfill
% \begin{minipage}[t]{0.32\linewidth}
% \centering
% \includegraphics[width=0.8\linewidth]{figure3.pdf}
% %\vspace{-0.7cm}
% \caption{Influences of relay density and distance from the source to destination on coverage probability.}
% \label{fig3}
% \end{minipage}
% \end{figure*}


%\vspace{-0.3cm}

\begin{figure*}
    \centering
    \vspace{-0.9cm}
    \subfigure[$R_{SD} = 20$~m] {\includegraphics[width=0.27\textwidth]{figure4.pdf}} 
    \hspace{0.4cm}
    \subfigure[$R_{SD} = 50$~m]{\includegraphics[width=0.27\textwidth]{figure5.pdf}} 
    \hspace{0.4cm}
    \subfigure[$R_{SD} = 80$~m]{\includegraphics[width=0.27\textwidth]{figure6.pdf}}
    \vspace{-0.3cm}
    \caption{Impact of different transmissions, the source-destination distance ($R_{SD}$), and desired data rate on coverage probability.}
    \label{fig7}
    \vspace{-0.6cm}
\end{figure*}




{\color{black}  In Fig.~\ref{fig2}, we keep $R_{SD} = 50$~m and select a set of densities with coverage of 90\% as shown in Fig.~\ref{fig1}, i.e., $\lambda_{\rm{RF}} = 5\times10^{-4}$~m$^{-2}$ and  $\lambda_{\rm{THz}} = 4\times10^{-3}$~m$^{-2}$ in HRS protocol. As shown in Fig.~\ref{fig2}, the coverage probability drops dramatically as the desired rate threshold $y_{th}$ increases from $400$~Mbps to $800$~Mbps. Moreover, comparing the blue and purple curves reveals that raising the transmission power of RF relays only improves performance when the data rate is below $500$~Mbps, but has essentially no effect when it surpasses $500$~Mbps. In general, increasing the transmission power of THz relays has a greater impact on performance than raising that of RF relays, particularly when the data rate is high.}



%\textcolor{black}{As shown in Fig.~\ref{fig2}, the coverage probability when the transmission power of RF relays is higher than THz relays equals the HRS coverage probability when the transmission power of THz relays is a higher power than RF relays for lower data rates (300 - 450~Mbps).(confusing, not clear)} However, for an RF relay-dominated network (high RF transmission power \textcolor{black}{or high densities ?}), the coverage probability drops dramatically as the desired rate threshold $y_{th}$ increases from 400~Mbps to 800~Mbps. Therefore, for large data rates, increasing the transmission power of the THz relay yields better performance. \textcolor{black}{(Long story short, is it because we are increasing the THz power, or we are increasing the ratio between RF and THz ?).}




%Fig.~\ref{fig2} compares the performance of different scenarios with two direct transmissions and four relay-associated communications. Random selection means that we select a relay within a circle centered at the midpoint of S and D and having radius $R_{SD}/2$. In Fig.~\ref{fig2}, we keep $R_{SD} = 50$~m and select a set of densities with coverage of 90\% as shown in Fig.~\ref{fig1}, i.e., $\lambda_{\rm{RF}} = 5\times10^{-4}$~m$^{-2}$ and  $\lambda_{\rm{THz}} = 4\times10^{-3}$~m$^{-2}$.  For an RF relay dominated-network (the green and black curves), the coverage probability drops dramatically as the desired rate threshold $y_{th}$ increases from 400~Mbps to 500~Mbps. Hybrid network outperforms all networks.

%As can be seen in Fig.~\ref{fig2} and Fig.~\ref{fig3}, HRTRN becomes a THz relay-dominated network (associated with THz relays in most cases) by increasing the density or transmitting power of THz relays (reducing the density and power of RF relays at the same time). Vice versa for RF relays. In Fig.~\ref{fig2}, we keep $R_{SD} = 50$~m and select a set of densities with coverage of 90\% as shown in Fig.~\ref{fig1}, i.e., $\lambda_{\rm{RF}} = 5\times10^{-4}$~m$^{-2}$ and  $\lambda_{\rm{THz}} = 4\times10^{-3}$~m$^{-2}$. As is shown in Fig.~\ref{fig2}, the rate of RF relay is mainly concentrated in 400 - 500~Mbps, and that of THz is relatively uniformly distributed between 300 - 800~Mbps. For an RF relay dominated-network (the solid green line), the coverage probability drops dramatically as the desired rate threshold $y_{th}$ increases from 400~Mbps to 500~Mbps. Therefore, for a large $y_{th}$, increasing the transmission power of the THz relay is more effective.

% \begin{figure}[t]
% 	\centering
% 	\includegraphics[width=0.75\linewidth]{figure3.pdf}
% 	\caption{Influences of relay density and distance from the source to destination on coverage probability.}
% 	\label{fig3}
% 	\vspace{-0.4cm}
% \end{figure}

%PC=0.710.750m 
In Fig.~\ref{fig3}, we set $\varepsilon_{{Q}}=$~1~W and select three sets of densities with 70\% coverage as shown in Fig.~\ref{fig1}, i.e., $\lambda_{\rm{RF}}~=~\{0.45,\:1.28, \:2.27\}\times10^{-4}$~m$^{-2}$,   and  $\lambda_{\rm{THz}}~=~\{5,\;3,\;1\}\times10^{-3}$~m$^{-2}$, respectively. 
As is shown in Fig.~\ref{fig3}, the HRS coverage probability of THz relay dominated-network ($\lambda_{\rm{THz}} = 5 \times 10^{-3}$~m$^{-2}$) is strongly influenced by the distance between source and destination $R_{SD}$, especially when $40\rm{m} \leq R_{SD} \leq 60\rm{m}$. The coverage probability of THz relay-dominated network decreases drastically as $R_{SD}$ increases compared to RF relay-dominated network.


%The performance of different scenarios with two direct transmissions and four relay-associated communications is depicted in Fig.~\ref{fig7}. Random selection means that we select a relay within a circle centered at the midpoint of S and D and having radius $R_{SD}/2$.  The density of RF and/or THz relays are same as that of Fig.~\ref{fig2}, while all devices have same transmit power 1~W. Fig.~\ref{figa} shows that over short-distance transmission, the direct networks perform slightly better than relay-associated networks due to the time slot taken by the former being half as long as the latter. From Fig.~\ref{figb}, it is clear that over middle-distance transmission, the result of a hybrid network with the proposed relay selection strategy is quite close to that instantaneous optimal and outperforms that of all other networks. In Fig.~\ref{figc}, for long-distance communication,  RF relays dominate the overall performance, while THz relays are helpless. 

%In Fig.~\ref{fig7} compares the performance of different scenarios with two direct transmissions and four relay-associated communications. Random selection means that we select a relay within a circle centered at the midpoint of S and D and having radius $R_{SD}/2$. In Fig.~\ref{fig2}, we keep $R_{SD} = 50$~m and select a set of densities with coverage of 90\% as shown in Fig.~\ref{fig1}, i.e., $\lambda_{\rm{RF}} = 5\times10^{-4}$~m$^{-2}$ and  $\lambda_{\rm{THz}} = 4\times10^{-3}$~m$^{-2}$.  For an RF relay dominated-network (the green and black curves), the coverage probability drops dramatically as the desired rate threshold $y_{th}$ increases from 400~Mbps to 500~Mbps. Hybrid network outperforms all networks.

In Fig.~\ref{fig7}, we compare the proposed HRS protocol with the optimal relay selection strategy according to the \textit{max-min} selection scheme. We also compare the proposed protocol with RF-only relay selection and THz-only relay selection. {\color{black}  For the sake of fairness, we compare the HRS protocol with RF and THz direct transmissions, which use the same channel model as the relay link. Notably, direct transmission takes only one time slot, whereas relay transmission requires two \cite{belbase2018coverage}. } 
{\color{black} We set $\varepsilon_{{Q}}= 1$~W and the density of RF and THz relays  are $\lambda_{\rm{RF}} = 5\times10^{-4}$~m$^{-2}$ and  $\lambda_{\rm{THz}} = 4\times10^{-3}$~m$^{-2}$.} 
We can notice in Fig.~\ref{fig7}(a) that for short distances ($R_{SD}=20$~m), RF relay selection and RF direct transmission have lower coverage probability and it starts decreasing drastically for higher data rates ($500$~Mbps), while $P^C \approx 1$ for other four transmission schemes. Hence, we conclude from Fig.~\ref{fig7}(a) that for short distances: (1) it is better to use THz direct transmission when available than relay transmission; (2) the HRS protocol offers the same performance as the optimal protocol without requiring full and perfect CSI.
In Fig.\ref{fig7}(b), we can notice that for $R_{SD}=50$~m, the THz direct transmission has zero coverage probability. 
% We can also notice that for lower data rates (300--450~Mbps), RF relay and RF direct transmission offer better performance than THz relay, whereas for higher data rates (500~Mbps), then THz relay offer better performance since RF relay and RF direct transmission have a zero coverage probability. Consequently, the HRS protocol will select only THz relays.
{\color{black} We can also notice that for lower data rates ($300-450$~Mbps), RF relay and RF direct transmission offer better performance than THz relay. In contrast, for higher data rates ($500$~Mbps),  the HRS protocol will select only THz relays since THz relay offers better performance since RF relay and RF direct transmission have a zero coverage probability.}
Finally, we notice that the proposed HRS protocol and the optimal protocol have nearly the same performance; and they both offer better performance than all the aforementioned schemes.
In Fig.\ref{fig7}(c), we can see that for large distances $R_{SD}=80$~m, THz communications (direct and relay) have $P^C=0$, and the HRS protocol will select only RF relays.

%In summary, we can conclude from Fig.~\ref{fig2}, Fig.~\ref{fig3}, and Fig.~\ref{fig7} that HRS becomes a THz relay-dominated network (associated with THz relays in most cases) by increasing the density or transmit power of THz relays, increasing the desired rate, or reducing the distance between $S$ and $D$. Inversely, HRS becomes an RF relay-dominated network by increasing the density of RF relays, decreasing the desired rate, or increasing $R_{SD}$.

\vspace{-5mm}
\section{Conclusion}
\vspace{-1mm}

%In this letter, a closed-form coverage probability expression of a proposed hybrid RF and THz relay selection protocol is derived. Compared to RF relay-dominated network, the coverage probability of the THz relay-dominated network is negatively affected by source-destination distance. However, the coverage probability of the THz relay-dominated network offers superior performance for higher data rates. The superiority of the hybrid proposed protocol is shown by comparing it with different strategies. In addition, the proposed HRS protocol is compared with the optimal selection protocol and offers nearly the same performance for lower data rates. For higher data rates, HRS protocol offers the same performance as the optimal selection protocol (without CSI).

{\color{black} In this letter, the coverage probability expression of a proposed hybrid RF and THz relay selection protocol had been derived. The HRS protocol had mainly selected THz relays (associated with THz relays) for higher data rates or short source-destination distances, while it had mainly selected RF relays for lower data rates or large source-destination distances. The superiority of the HRS protocol had been demonstrated by comparing it with different strategies. In addition, the proposed HRS protocol had been compared with the optimal selection protocol, which requires a full and perfect instantaneous CSI of all the nodes in the networks. The HRS protocol had offered nearly the same performance as the optimal selection protocol for lower data rates, and the same performance for higher data rates.}




\par
%For future work, how to extend the dual-hop routing into a multi-hop routing is worth discussing. Comparing long-hop (RF transmission) and short-hop (THz transmission) strategies in heterogeneous networks with limited total power is an interesting topic. What is more, allocating more energy to RF or THz relays and allocating energy according to distance from S or D will affect the coverage probability. Therefore, energy allocation is a challenging but meaningful research content. 




\vspace{-0.3cm}
\bibliographystyle{IEEEtran}
%\bibliographystyle{ACM-Reference-Format}
\bibliography{references}

\end{document}
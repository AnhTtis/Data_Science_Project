\section{Existence and approximation of the optimal density}


We start by setting a theoretical framework which makes problem \eqref{density_problem} well-posed. The results follows using the same ideas as in \cite{BMO_2022}. For this reason, we shall not enter too much in the details.

A natural question that directly arises is the one of the existence of an optimal density. In the Euclidian case $\R^n$, we had to rely on some concentration-compactness result to obtain the existence of some \textit{collection} of densities. Here the fact that the sphere has finite measure allows us to give a complete existence result easily :

\begin{theorem}[Existence of an optimal density] \label{th:existence}
  Let $0 \leq m \leq |\S^n|$. Then problem (\ref{density_problem}) has a solution.
\end{theorem}

\begin{proof} We actually prove the upper-semicontinuity of the eigenvalues with respect to the weak-* convergence. Let $k \in \N$ and $\rho, (\rho_n)_{n \in \N} \in \L^1(\S^n, [0,1])$ be functions such that $\rho_n \rau \rho$. Let $\eps > 0$ and $V = \Span\{v_0 \1_{\{\rho>0\}},...,v_k \1_{\{\rho>0\}} \}$ be such that
\[
\mu_k(\rho) \geq \max_{u\in V\setminus \{0\}} \frac{\int_{\S^n} \rho|\nabla u|^2 }{\int_{\S^n} \rho u^2} - \eps.
\]

Let us consider $V_n = < v_0 \1_{\{\rho_n>0\}},...,v_k \1_{\{\rho_n>0\}}>$ and $u_n = \sum_{i=0}^k \alpha_i^n v_i$ a maximizing sequence in
\[
\max_{u\in V_n\setminus \{0\}} \frac{\int_{\S^n} \rho_n |\nabla u|^2}{\int_{\S^n} \rho_n u^2}.
\]

For $n$ large enough, $V_n$ is of dimension $k+1$ hence

\[
\mu_k(\rho_n) \leq \frac{\int_{\S^n} \rho_n|\nabla u_n|^2}{\int_{\S^n} \rho_n u_n^2}.
\]

Note that we can suppose by homogeneity that $\sum_{i=0}^k (\alpha_i^n)^2=1$ for all $n$. Up to a subsequence, we get that $\alpha_i^n \rightarrow \alpha_i \in \R$ for all $i$. By putting $\tilde v = \sum_{i=0}^k \alpha_i v_i$ we get that
\[
\int_{\S^n} \rho_n |\nabla u_n|^2 \rightarrow \int_{\S^n} \rho |\nabla \tilde v|^2
\]
and
\[
\int_{\S^n} \rho_n u_n^2 \rightarrow \int_{\S^n} \rho \tilde v^2.
\]
Thus
\[ \mu_k(\rho) \geq \limsup_{\nif} \mu_k(\rho_n) - \eps.\]
This relation being valid for all $\eps$, we get
\[ \mu_k(\rho) \geq \limsup_{\nif} \mu_k(\rho_n).\]

Now let $(\rho_n)_{n\in\N}$ be some maximizing sequence of the problem (\ref{density_problem}). There exists a $\rho \in \L^1(\S^n, [0,1])$ such that up to a subsequence, $\rho_n \rau \rho$ weakly. By upper-semicontinuity, we get that $\mu_k(\rho) \geq \limsup_{\nif} \mu_k(\rho_n)$ and the fact that $1 \in \L^1(\S^n, \R)$ ensure that the condition $\int_{\S^n} \rho_n = m$ is satisfied at the limit.
\end{proof}


From a numerical point of view, computing the generalized eigenvalue \textit{via} finite element method is not possible in general due to the potential vanishing of $\rho$ on some non-negligible parts of $\S^n$. It is possible to approximate our generalized eigenvalues by well-defined ones of non-zero densities :

\begin{theorem}[Approximation]
  \label{th:approximation}
  Let $\rho \in \L^1(\S^n,[0,1])$ , $\int_{\S^n} \rho = m > 0$. We introduce the following quantity :
  \[
  \mu_k^\eps(\rho) := \min_{V\in{\mathcal V}_{k+1}} \max_{u \in V \sm \{0\}} \frac{\int_{\S^n} (\rho+ \eps) |\nabla u|^2}{\int_{\S^n} (\rho+\eps^2) u^2}
  \]
  where ${\mathcal V}_{k+1}$ is the family of subspace of dimension $k+1$ in $\H^1(\S^n)$.

  Then :
  \[
  \mu_k^\eps(\rho) \xrightarrow[\eps \to 0]{} \mu_k(\rho).
  \]
\end{theorem}

For the proof in the Euclidian case, we refer to \cite[Lemma 14]{BMO_2022}.

\begin{remark}
$\mu_k^\eps(\rho)$ is the $k$-th non-trivial eigenvalue of the well posed elliptic problem
$$
 -\div[(\rho+\eps)\nabla u] = \mu_k^\eps(\rho) (\rho+\eps^2) u
$$
on $\S^n$.
\end{remark}

\begin{proof}
The proof decomposes into proving both the limsup and the liminf. The limsup is proven in the same way as in previous theorem; let us focus on the liminf.

Let $u_0^\eps,...,u_k^\eps \in \H^1(\S^n)$ be the eigenfunctions associated to the eigenvalues $\mu_0^\eps,...,\mu_k^\eps$, orthogonal and normalized in the sense that
\begin{equation}
\label{eqn:orthogonality}
\int_{\S^n} (\rho+\eps^2)u_i^\eps u_j^\eps = \delta_{i,j}.
\end{equation}
This implies that
\begin{equation}
\label{eqn:bounded_grad}\int_{\S^n} (\rho+\eps) |\nabla u_i^\eps|^2 = \mu_i^\eps(\rho)
\end{equation}
and this quantity can be considered bounded independently of $i$ and $\eps$ by some bound M. If not, the limsup would be infinite and the previous case would allow us to conclude. From equation \ref{eqn:orthogonality} we deduce that $(\eps u_i^\eps)_\eps$ is bounded in $\L^2(\S^n)$ for all $i$. Hence we can find a subsequence such that for all $0 \leq i \leq k$, the sequence $(\eps u_i^\eps)$ converges weakly in $\L^2(\S^n)$ to some function $g_i$. Denoting $\bar{v} = \frac{1}{|\S^n|}\int_{\S^n} v$, we get  $\eps \bar{u_i^\eps} \lra \bar{g_i}$ for all $i$, the constant function $1$ being in $\L^2$. Moreover, the sequence $(\sqrt{\eps}\nabla u_i^\eps)_\eps$ is bounded in $\L^2(\S^n)$ hence by  we get by the PoincarÃ©-Wirtinger inequality :
\[
\| \eps u_i^\eps - \eps \bar{u_i^\eps} \|_{\L^2} \leq C \|\eps \nabla u_i^\eps \|_{\L^2} \lra 0.
\]
We deduce that $\eps u_i^\eps \lra \bar{g_i}$ strongly in $\L^2$. We can then conclude that $\bar{g_i} = 0$ by noticing that
\[
0 = \lim_{\eps\to 0} \eps^2 \int_{\S^n} \rho (u_i^\eps)^2 = \int_{\S^n} \rho \bar{g_i}^2 = \bar{g_i}^2 m.
\]
By Cauchy-Schwarz inequality, this implies that $\int_{\S^n} u_i^\eps u_j^\eps \lra 0$ which in turn results in $\int_{\S^n} \eps^2 (v^\eps)^2 \dd x \lra 0$ for all $v^\eps \in \Span\{u_0^\eps, ..., u_k^\eps\}$. Using this last limit and the fact that $\Span\{u_0^\eps 1_{\{\rho>0\}}, ...,u_k^\eps 1_{\{\rho>0\}} \}$ is of dimension $k+1$ for $\eps$ small enough we finally get
\[
\mu_k(\rho)
= \inf_{V\in{\mathcal V}^\rho_{k+1}} \max_{u \in V \sm \{0\}} \frac{\int_{\S^n} \rho|\nabla u|^2}{\int_{\S^n} \rho u^2}
\leq \liminf_{\eps \to 0} \max_{v \in \Span\{u_0^\eps, ..., u_k^\eps \}}  \frac{\int_{\S^n} (\rho+ \eps) |\nabla u|^2}{\int_{\S^n} (\rho+\eps^2) u^2}
= \liminf_{\eps \to 0} \mu_k^\eps(\rho)
\]
which concludes the proof.
\end{proof}


\begin{theorem}[Approximation of maxima]Let $0 < m \leq  |\S^n|$. Then
\begin{equation}
    \max\limits_{\|\rho\|_{\L^1}=m} \mu_k^\eps(\rho) = \max\limits_{\|\rho\|_{\L^1}=m} \mu_k(\rho).
\end{equation}
\end{theorem}

\begin{proof}Let $(\rho^\eps)_\eps$ be such that $\mu_k^\eps(\rho^\eps) = \max\limits_{\|\rho\|_{\L^1}=m} \mu_k^\eps(\rho) $ and $\rho^*$ be such that $\mu_k(\rho^*) = \max\limits_{\|\rho\|_{\L^1}=m} \mu_k(\rho)$. In the same way than the upper semicontinuity in theorem ~\ref{th:existence}, we have that \[
\limsup_{\eps \lra 0} \mu_k^\eps(\rho^\eps) \leq \mu_k(\tilde \rho) < \max_{\|\rho\|_{\L^1}=m} \mu_k(\rho) < +\infty
\]
whenever $\rho^\eps \rightharpoonup \tilde \rho$ weakly in $\L^\infty$. Hence the sequence $(\mu_k^\eps(\rho^\eps))_\eps$ is bounded. Then the previous lower-semicontinuity result implies that
\[
\max\limits_{\|\rho\|_{\L^1}=m} \mu_k(\rho)
= \mu_k(\rho^*)
\leq \liminf_{\eps \to 0} \mu_k^\eps(\rho^\eps)
=  \liminf_{\eps \to 0} \max\limits_{\|\rho\|_{\L^1}=m} \mu_k^\eps(\rho^\eps)
\]
which concludes the proof.
\end{proof}

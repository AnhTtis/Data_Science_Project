\begin{algorithm*}
\caption{Python implementation of perturbation}\label{alg1} 
\vspace{2mm}

\lstset{language=Python}
\lstset{label={lst:code_direct}}
\lstset{basicstyle=\footnotesize}
\begin{lstlisting}
def rep_rem_mask(caption_list): # Repetition, Removal, and Masking
    caption_rp = []
    caption_rm = []
    caption_rm_mask = []

    for i in range(len(caption_list)):
        words = caption_list[i].split()
        substitued_rp = []
        substitued_rm = []
        substitued_rm_mask = []
        substitued_rmrp = []
        for j in range(len(words)):
            substitued_rp.append(words[j])
            substitued_rm_mask.append(words[j])
            if random.random() > threshold:
                substitued_rp.append(words[j])
                substitued_rm.append(words[j])
                substitued_rm_mask[-1] = '[MASK]'
            elif random.random() > threshold:
                substitued_rmrp.append(words[j])  
        caption_rp.append(" ".join(substitued_rp))
        caption_rm.append(" ".join(substitued_rm))
        caption_rm_mask.append(" ".join(substitued_rm_mask))
        
    return caption_rp, caption_rm, caption_rm_mask

def jumble(caption_list): # Jumble
    caption_jumble = []
    for i in range(len(caption_list)):
        words = caption_list[i].split()
        random.shuffle(words)
        caption_jumble.append(" ".join(words))
    return caption_jumble
    
def sub_in_sent(caption_list, critical_obj_list): # In-sentence substitution
    caption_sub_in = []
    for i in range(len(caption_list)):
        current_caption = caption_list[i]
        current_critical_obj_list = critical_obj_list[i]
        shuffled = current_critical_obj_list.copy()
        words = caption_list[i].split()
        
        if len(current_critical_obj_list) < 2:
            caption_sub_in.append(" ".join(words))
        else :
            while current_critical_obj_list == shuffled:
                random.shuffle(shuffled)
            
            target = current_caption
            for j in range(len(shuffled)):
                target = shuffled[j].join(target.rsplit(current_critical_obj_list[j],1))
            caption_sub_in.append(target)
            
    return caption_sub_in

\end{lstlisting}




\end{algorithm*}

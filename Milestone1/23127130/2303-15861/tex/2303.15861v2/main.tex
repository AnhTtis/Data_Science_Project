\documentclass[a4paper,11pt]{article}

%% Packages %%
\usepackage{fullpage}
\usepackage{graphicx,xcolor}
\usepackage{amsmath,amsfonts,amsthm,amssymb}
\usepackage{float}

\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\usetikzlibrary{plotmarks}
\usetikzlibrary{arrows.meta}
\usepgfplotslibrary{patchplots}
\usepgfplotslibrary{fillbetween}
\usepackage{grffile}
\usepackage{hhline}

%% Commands %%
\newcommand{\ee}{\mathrm{e}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\bb}{\boldsymbol}
\newcommand{\bx}{\bb x}

\newtheorem{remark}{Remark}[section]
\newtheorem{theorem}{Theorem}[section]

%% Macros %%
\newcommand{\keywords}[1]{\noindent \textbf{\textit{Keywords:}} #1}
\newcommand{\msccodes}[1]{\noindent \textbf{\textit{MSC codes (2020):}} #1}
\usepackage{hyperref}

\title{Accelerating exponential integrators to efficiently solve\\
  {\color{black}semilinear} advection-diffusion-reaction equations}
\author{Marco Caliari\footnote{\noindent Department of Computer Science, University of
        Verona, Verona, Italy.\newline
        \textit{E-mail address}: \texttt{marco.caliari@univr.it}}
        \and Fabio Cassini\footnote{Department of Computer Science, University of
        Verona, Verona, Italy.\newline
        \textit{E-mail address}: \texttt{fabio.cassini@univr.it}}
        \and Lukas Einkemmer\footnote{Department of Mathematics, University of
        Innsbruck, Innsbruck, Austria.\newline
        \textit{E-mail address}: \texttt{lukas.einkemmer@uibk.ac.at}}
        \and Alexander Ostermann\footnote{Department of Mathematics, University of
        Innsbruck, Innsbruck, Austria.\newline
        \textit{E-mail address}: \texttt{alexander.ostermann@uibk.ac.at}}
}

\begin{document}
  \maketitle
%%%
\begin{abstract}
%%%
In this paper we consider an approach to improve the performance of exponential
{\color{black}Runge--Kutta integrators and Lawson schemes} in cases where the 
solution of a related, but
usually much simpler, problem can be computed efficiently. While for implicit
methods such an approach is common (e.g.~by
using preconditioners), for exponential integrators this has proven more
challenging. Here we propose to extract a constant coefficient differential
operator from the {\color{black}semilinear} advection-diffusion-reaction equation
for which, {\color{black}in many situations, efficient methods are known
  to compute the required matrix functions.} Both a
linear stability analysis and {\color{black} extensive} numerical experiments 
show that the resulting
schemes can be unconditionally stable. In fact, we find that exponential
integrators {\color{black}of Runge--Kutta type} and Lawson schemes can 
have better stability properties than
similarly constructed implicit-explicit schemes. We also {\color{black} derive two}
new Lawson type integrators that further improve on these stability properties.
The {\color{black} overall} effectiveness of the approach is highlighted by a 
number of {\color{black} performance comparisons on} examples in two and 
three space dimensions.
\end{abstract}

\keywords{Exponential integrators, stiff problems, evolutionary PDEs,
  {\color{black}semilinear} advection-diffusion-reaction equations, fast Fourier
  transform based solvers, $\mu$-mode integrator.}

\medskip
\msccodes{65L05, 65M06, 65M20, 65M70}
%%%
\section{Introduction}
%%%

Solving time dependent Partial Differential Equations (PDEs) efficiently is
important for better understanding many phenomena in science and engineering. In
most cases, in particular for problems which are diffusion dominated,
discretizing such PDEs in space results in a very stiff set of Ordinary
Differential Equations (ODEs) for which explicit integrators have to take
extremely small time steps.

The standard approach to reduce the computational effort for such problems is
to use implicit methods. {\color{black}These kinds} of methods, from a theoretical point of
view, can have very attractive properties. In particular, many implicit methods
are \emph{unconditionally stable}. {\color{black}Since in this paper
we are mostly interested in diffusion dominated problems}, we consider methods that are
unconditionally stable in the sense that they do not have a time step
restriction when applied to the linear problem
\begin{equation*}
  u'(t)=Au(t),
\end{equation*}
where $A$ is a matrix with negative eigenvalues.
That is, the time step size is only dictated by the
prescribed tolerance (i.e., accuracy), but not by stability considerations.
However, implicit methods in general require the solution of a nonlinear set
of equations at each time step. This is usually done either by performing Newton
iteration in combination with some linear solver
or by directly using an IMplicit-EXplicit (IMEX) scheme, which treats
implicitly only the linear part of the system.
Thus, using implicit methods shifts all the difficulty into finding an
efficient way to solve dense linear systems of
moderate size (such as those coming from pseudospectral techniques)
or large and sparse ones
(such as those stemming from finite differences or finite elements spatial
discretizations).
When the arising linear
system is solved by a direct method such as LU decomposition
the computational complexity
of the obtained algorithm is usually worse than that of an explicit
integrator. Otherwise, Krylov subspace based iterative methods are used,
such as the
Conjugate Gradient (CG) method or the Generalized Minimal RESidual method
(GMRES)~\cite{saad2003iterative}. For diffusion dominated problems Krylov
methods already significantly reduce the computational effort needed. However,
for a number of problems preconditioners can be constructed that further
reduce {\color{black}it}. Preconditioners transform the linear system
in such a way that the solution of the resulting linear system requires fewer
iterations. While there are preconditioners that, at least in principle, can
be applied generically (e.g.~ILU or the celebrated algebraic multi-grid
approach~\cite{xu2017algebraic}), for many challenging problems purpose-built
preconditioners have to be constructed. Often such preconditioners use the
solution of a related, but simpler, problem that can be solved efficiently
(see, e.g., physics based preconditioners~\cite{Chacon2002,Reynolds2010} or
block preconditioners~\cite{badia2014block,cyr2016teko}).

Exponentials integrators (see reference~\cite{HO10} for a review) are
another way to
solve in time stiff differential equations
{\color{black}in which} a linear part of the problem is
treated \emph{exactly}, while the nonlinear remainder is treated in an
explicit manner. 
{\color{black} In this work, we focus on exponential integrators of Runge--Kutta
type~\cite{HO05} and on Lawson schemes~\cite{lawson} (i.e., methods that 
just involve matrix exponentials but not related functions)}.
For example, to solve the equation
\[ \partial_t u(t) = A u(t) + g(t, u(t)) \]
it is possible to use the exponential Euler method
\begin{equation*}
u^{n+1}=u^{n}+\tau\varphi_{1}(\tau A)(A u^{n} + g(t_n, u^n))
\end{equation*}
{\color{black} or the Lawson--Euler scheme
\begin{equation*}
u^{n+1}=\ee^{\tau A}(u^{n}+\tau g(t_n, u^n)).
\end{equation*}
}%
Here $A$ is a linear operator/matrix, $\tau$ is the time step size, and
$\varphi_1(z) = (\ee^z - 1)/z$ is an entire function (the singularity at $0$ is
removable). Even for nonlinear problems,
exponential integrators require no Newton iteration, but rather
 the computation of the action of matrix functions related to the
exponential (such as the $\varphi_1$ function above) at each time step.
The main difficulty for exponential integrators is the evaluation of
{\color{black}such} exponential-like matrix
functions. For that purpose Krylov subspace methods~\cite{hochbruck1997krylov},
schemes based on Leja interpolation~\cite{CKOR16,caliari2004}, and Taylor
methods~\cite{al2011computing} are commonly used.
It has been shown in a number of studies that Krylov or Leja based
exponential integrators can be superior to implicit schemes for realistic
problems, see, e.g., references~\cite{clancy2013use,deka2022exponential,einkemmer2017performance,loffeld2013comparative}.
Unfortunately, however, the aforementioned technique of preconditioning
to further improve
performance does not apply to exponential integrators.

Thus, a natural question that arises is whether the solution of a related, but
simpler, problem for which an efficient solution is known can be used in the
framework of exponential integrators in order to improve the performance of
the scheme. The idea that we pursue in this paper is to choose the linear
operator $A$ in such a
way that the corresponding matrix functions can be computed efficiently.
In particular, {\color{black} we are interested in
(diffusion dominated) variable coefficients semilinear advection-diffusion-reaction
equations in the following form}
\begin{equation*}
  \partial_tu(t,\bx)=\nabla\cdot\left(a(\bx)\nabla u(t,\bx)\right)+
  \nabla\cdot\left(\bb b(\bb x)u(t,\bb x)\right)+
  r(t,\bx,u(t,\bx)),
    \quad  t\in[0,T],\quad \boldsymbol{x}\in\Omega\subset\RR^d,
\end{equation*}
equipped with appropriate initial and boundary conditions.  If we use
\begin{equation*}
  Au = \nabla \cdot \left(a(\bx) \nabla u\right)+
  \nabla\cdot\left(\bb b(\bb x)u\right)
\end{equation*}
  then we
have to resort to
general purpose Krylov or Leja based schemes, for instance,
to compute the actions of {\color{black}$\ee^{\tau A}$ and}
$\varphi_1(\tau A)$.
However, for constant diffusion tensor and velocity
field (i.e., if $a$ and $\bb b$ are independent of
$\bx$) we can use a fast Poisson solver, e.g.~Fast Fourier Transform (FFT)
based methods. This scales linearly
(up to a logarithm) in the number of unknowns. The idea is then to consider
the following \emph{equivalent} formulation of the equation
\begin{equation*}
    \partial_tu(t,\bx)=A u(t,\bx)
    +\underbrace{\nabla\cdot(a(\bx)\nabla u(t,\bx))
+  \nabla\cdot\left(\bb b(\bb x)u(t,\bb x)\right)
      -A u(t,\bx)+r(t,\bx,u(t,\bx))}_{g(t,\bx,u(t,\bx))},
\end{equation*}
where now $A$ is a constant coefficient approximation to the original
advection-diffusion operator. The hope is that
the actions of {\color{black}$\ee^{\tau A}$ and} $\varphi_1(\tau A)$ can
stabilize the nonlinear term $g(t,\bx,u(t,\bx))$ of the
exponential integrator. The choice of $A$ is clearly not uniquely determined
and we will consider how to choose it later in the paper. {\color{black} We remark,
  however, that $A$ has to be chosen in such a way that we can efficiently
  compute the corresponding matrix functions.}%

{\color{black}Let us note that a related approach to what we pursue in this paper
leads to split or partitioned exponential
integrators~\cite{NS21,NTST19,RT14}, which has also been
applied to non-diffusive
equations~\cite{BM22}. The idea of employing a constant coefficient operator can
be considered in the context of implicit methods as well. In particular,} an
IMEX scheme can be used. The
approximation operator is treated implicitly (which can be done efficiently
using, e.g., Fourier methods), while the nonlinear term
is treated explicitly.
Such schemes, known in the literature as explicit-implicit-null,
were considered for instance in reference~\cite{WZWS20}.
Clearly,
the class of operators for which efficient linear solvers are known is
not equivalent to the class of operators for which the matrix exponential
(and related matrix functions) can be computed efficiently.
{\color{black}For example, it is quite involved to build a linear solver if a
matrix has $d$-dimensional Kronecker sum form~\cite{CK20}. Instead, 
this structure can be more easily exploited for the matrix exponential
case~\cite{CCEOZ22,CCZ22b}.
Indeed, thanks to the equivalence
\begin{equation*}
  \ee^{A_d\oplus A_{d-1}\oplus\cdots\oplus A_1}\bb v =
  \mathrm{vec}\left(\bb V \times_1 \ee^{A_1} \times_2 \cdots \times_d \ee^{A_d}\right),
  \quad
  \bb V \in \CC^{N_{x_1}\times \cdots \times N_{x_d}}, \quad \bb v = \mathrm{vec}(\bb V),
\end{equation*}
we are able to compute the action of the exponential of a matrix in Kronecker sum form just
in terms of the small sized matrix exponentials $\ee^{A_\mu}$ and
tensor-matrix $\mu$-mode products (here denoted with the symbol $\times_\mu$) using
$d$ calls to level 3 BLAS. This idea leads to the so-called
$\mu$-mode integrator, with dramatic improvements in terms of efficiency
of computation.}
On the other hand, if for a specific operator a good preconditioner is known,
an efficient linear solver can be constructed, while the same is not
necessarily true for computing the corresponding matrix functions.

Let us also mention some related work in the context of computing matrix
functions. In reference~\cite{CS98} the fact that the matrix exponential
can be written
as the solution of a linear differential equation is used to decompose the
problem into a ``preconditioner'' and a correction. An exponential integrator is
then used to approximate the resulting system. The preconditioners chosen are
all purely algebraic in nature (diagonal, block diagonal, etc.) and are not
specifically adapted to the underlying PDE.
In reference~\cite{van2006preconditioning}
a rational Krylov subspace is constructed. That is, the inverse of the
preconditioner is directly built into the Krylov subspace in order to obtain
an approximation space that is well behaved. This approach was later extended
to trigonometric operators \cite{grimm2008rational}.

In this paper we will first perform a linear stability analysis of the
proposed approach. In particular, this will show that exponential integrators
can have better stability properties than their corresponding IMEX
counterparts. We will also propose a class of methods (called stabilized
Lawson schemes) that improve on the stability properties of the classic
Lawson schemes. We investigate the choice of {\color{black}the operator} $A$ and show that this can have a
drastic influence on performance. We note that in reference~\cite{WZWS20},
in the context
of IMEX schemes, the authors employ the
smallest amount of
diffusion in $A$ that is necessary to guarantee stability. We do observe
a similar behavior for some test examples. However, for different two-
and three-dimensional {\color{black}semilinear} advection-diffusion-reaction equations that we investigate
this is not the case. In this context we {\color{black} state our proposal,
also based on strong numerical evidence,} to select $A$ in a good way.
We then perform a number of numerical investigations
with appropriate techniques for evaluating the
matrix functions in order to highlight the efficiency of the proposed approach.
Finally, we show that {\color{black}the investigated accelerated exponential methods} can
outperform their IMEX counterparts in a number of situations.
%%%
\section{Linear stability analysis}\label{sec:linstaban}
%%%
As mentioned in the introduction, we investigate here how
to determine the approximation operator $A$ {\color{black}for exponential 
Runge--Kutta and Lawson methods} by studying a model equation.
In particular, we consider the constant coefficient heat equation
\begin{equation*}
\partial_tu=\Delta u
\end{equation*}
on the domain $\Omega=(-\pi,\pi)^{d}$ with periodic boundary conditions, and we
equivalently write
\begin{equation}\label{eq:modeleqstab}
\partial_tu=\lambda\Delta u + (1-\lambda)\Delta u,
\end{equation}
with $\lambda\in[0,1]$.
Note that in this case the approximation operator is simply
\begin{equation*}
A=\lambda\Delta.
\end{equation*}
We note that a similar analysis can be performed for more general operators as
long as the eigenvalues lie on the negative real axis.
Then, in order to determine the parameter $\lambda$ we perform a linear
stability analysis of the temporal exponential integrator in Fourier space,
{\color{black} which appears to be novel in the literature (see
reference~\cite[Sec. 4.1]{DASS20} for a similar investigation, in a different
context, for the exponential Euler method only)}.
For the convenience of the reader, all the schemes mentioned and studied in
this section are collected in the appendix (formulated for a generic abstract
semilinear ODE).

Let us first consider the well-known exponential Euler method, which integrates
equation~\eqref{eq:modeleqstab}
in time as follows
\begin{equation}\label{eq:expeulerstab}
u^{n+1}=u^{n}+\tau\varphi_{1}(\tau\lambda\Delta)\Delta u^{n},
\end{equation}
where $u^n$ is the numerical solution at time $t_n$, $\tau$ is the time
step size and $\varphi_1(z)=(\ee^z-1)/z$. Here and throughout the paper we
assume without loss of generality
that $\tau$ is constant. Then we have the following result.
\begin{theorem}\label{thm:expeuler}
The exponential Euler scheme~\eqref{eq:expeulerstab}
is unconditionally stable for $\lambda\geq\lambda^{\textsc{ee}}=1/2$.
\end{theorem}

\begin{proof}
  Let us denote $\bb k = (k_1,\ldots,k_d)\in\ZZ^d$,
  $k^2=\sum_\mu k_\mu^2$, and let
$\hat{u}_{\bb k}^n$ be the $\bb k$th Fourier mode of $u^n$. Then, in Fourier
space we have
\begin{equation*}
\Phi(z, \lambda):=\frac{\hat{u}_{\bb k}^{n+1}}{\hat{u}_{\bb k}^{n}}=
1-\varphi_{1}(-\lambda\tau k^{2})\tau k^{2}=
1-\frac{1}{\lambda}+\frac{\ee^{z\lambda}}{\lambda},
\end{equation*}
where $z = -\tau k^2$.
Thus, we have unconditional stability if the stability function
$\Phi(z, \lambda) $ satisfies
\[ \vert \Phi(z,\lambda) \vert \leq 1 \quad \text{for all} \quad z \in (-\infty,0]. \]
Since $\lambda \in [0,1]$ this implies $\lambda\geq1/2$,
as desired.
\end{proof}
What Theorem~\ref{thm:expeuler} tells us is that we still get an
unconditionally stable scheme for the heat equation even if we only put
half of the Laplacian into $A$.
This is the key observation for the
numerical methods that we propose in this paper.

Let us now turn our attention to the Lawson--Euler scheme
\begin{equation}\label{eq:lawsoneulerstab}
u^{n+1}=\ee^{\tau\lambda\Delta}(u^{n}+\tau(1-\lambda)\Delta u^{n}),
\end{equation}
which can alternatively be seen as a Lie splitting where we approximate
the second subflow by explicit Euler, that is
\begin{equation*}
\ee^{\tau\lambda \Delta}\ee^{\tau(1-\lambda)\Delta}u^{n}
\approx \ee^{\tau\lambda\Delta}(u^{n}+\tau(1-\lambda)\Delta u^{n}) = u^{n+1}.
\end{equation*}
For this method we obtain the following result.
\begin{theorem}\label{thm:lawsoneuler}
The Lawson--Euler scheme~\eqref{eq:lawsoneulerstab}
is unconditionally stable for $\lambda\geq\lambda^{\textsc{le}}=0.218$.
\end{theorem}
\begin{proof}
The stability function satisfies
\begin{equation*}
\Phi(z, \lambda) =
\ee^{\lambda z}(1+(1-\lambda)z).
\end{equation*}
Taking the minimum with respect to $z$ we get
\[ z = \frac{1}{\lambda(\lambda-1)}. \]
Plugging this into the stability function we obtain
\begin{equation*}
  1-\frac{1}{\lambda} +\ee^{\frac{1}{1-\lambda}} \geq 0.
\end{equation*}
The result then simply follows by computing the zero of the left-hand side.
\end{proof}

This shows that there exist methods which are unconditionally stable
for values of $\lambda$ smaller than $\lambda^{\textsc{ee}}=1/2$.
This is of interest because it is often the case that the accuracy of the
method increases as $\lambda$
decreases (see the experiments in sections~\ref{sec:validation}
and~\ref{sec:numexpstab}).
In addition, as mentioned in the introduction,
the advantage of using schemes
that just employ the exponential function is the following:
in certain situations
it can be more efficient to compute the exponential than the $\varphi$ functions
(e.g., for exploiting the Kronecker structure or if a semi-Lagrangian
scheme is used).

A natural question to ask is if it is possible to construct a numerical method
for which the constraint on $\lambda$ is further reduced.
We propose then the following scheme
\begin{equation}\label{eq:stabilizedlawsoneulerstab}
u^{n+1}=u^{n}+\tau \ee^{\tau\lambda\Delta}\Delta u^{n}.
\end{equation}
We call this first order method the \emph{stabilized Lawson--Euler} scheme,
for which we obtain the following result.
\begin{theorem}\label{thm:stabilizedlawsoneuler}
  The stabilized Lawson--Euler scheme~\eqref{eq:stabilizedlawsoneulerstab} is
  unconditionally stable
for $\lambda\geq\lambda^{\textsc{sle}}=1/(2\ee)\approx0.184$.
\end{theorem}
\begin{proof}
In this case, the stability function is given by
\begin{equation*}
\Phi(z, \lambda) = 1 + z \ee^{\lambda z}.
\end{equation*}
The stated result then follows immediately.
\end{proof}

\begin{remark}\label{rem:imex} \rm
A similar analysis can be performed also for other classes of schemes.
For example, in reference~\cite{WZWS20} some IMEX schemes have been analyzed in
a fully discretized context. In particular, for the well known
backward-forward Euler method
\begin{equation*}
(I-\tau\lambda\Delta)u^{n+1}=(I+\tau(1-\lambda)\Delta)u^{n}
\end{equation*}
the authors obtain the bound
$\lambda\geq\lambda^{\textsc{bfe}}=1/2$ for unconditional stability.
Moreover, they propose the second order
method
\begin{equation*}
\begin{aligned}
  \left(I-\frac{\tau}{2}\lambda\Delta \right)U&=\left(I+
   \frac{\tau}{2}(1-\lambda)\Delta \right)u^n, \\
  \left(I-\frac{\tau}{2}\lambda\Delta\right)u^{n+1}&=
   \left(I+\frac{\tau}{2}\lambda\Delta\right)u^n + \tau(1-\lambda)\Delta U
\end{aligned}
\end{equation*}
which has the same stability bound $\lambda\geq\lambda^{\textsc{imex2}}=1/2$.
\end{remark}

Let us now consider some examples of second order exponential integrators.
In particular, we start with the following
exponential Runge--Kutta type scheme
for equation~\eqref{eq:modeleqstab}
\begin{equation}\label{eq:exprk2phi2stab}
\begin{aligned}
U &= u^n + c_2\tau\varphi_1(c_2\tau\lambda\Delta)\Delta u^n, \\
u^{n+1} &= u^n + \tau\varphi_1(\tau\lambda\Delta)\Delta u^n +
\frac{\tau}{c_2}\varphi_2(\tau\lambda\Delta)(1-\lambda)\Delta(U-u^n),
\end{aligned}
\end{equation}
where $0<c_2\leq 1$ is a free parameter and $\varphi_2(z) = (\varphi_1(z)-1)/z$.
For this scheme we have the following result.
\begin{theorem}\label{thm:exprk2phi2}
  The exponential Runge--Kutta scheme~\eqref{eq:exprk2phi2stab} is
  unconditionally stable for $\lambda\geq 1/(1+c_2)$.
\end{theorem}
\begin{proof}
The stability function is given by
\begin{equation*}
\Phi(z, \lambda) = 1 +  z\varphi_1(\lambda z) +
z^2(1-\lambda)\varphi_2(\lambda z)\varphi_1 (c_2 \lambda z).
\end{equation*}
Then, by imposing
$\lvert \Phi(z, \lambda) \rvert \leq 1$ for all $z\in(-\infty,0]$ we have
\begin{equation*}
 \frac{1-\lambda}{c_2\lambda}- 1 \leq 0
\end{equation*}
from which we obtain $\lambda \geq 1/(1+c_2)$ as desired.
\end{proof}
The smallest result, in terms of unconditional stability, is obtained by
setting the free parameter $c_2=1$, which yields $\lambda \geq
\lambda^{\textsc{erk2p2}}=1/2$.

Let us consider now another second order exponential Runge--Kutta
integrator, which requires just the $\varphi_1$ function. For the model
equation~\eqref{eq:modeleqstab} this yields
\begin{equation}\label{eq:exprk2phi1stab}
\begin{aligned}
U &= u^n + c_2\tau\varphi_1(c_2\tau\lambda\Delta)\Delta u^n, \\
u^{n+1} &= u^n + \tau\varphi_1(\tau\lambda\Delta)\Delta u^n +
\frac{\tau}{2c_2}\varphi_1(\tau\lambda\Delta)(1-\lambda)\Delta(U-u^n).
\end{aligned}
\end{equation}
We  obtain the following unconditional stability result.
\begin{theorem}\label{thm:exprk2phi1}
  The exponential Runge--Kutta scheme~\eqref{eq:exprk2phi1stab} is
  unconditionally stable
for $\lambda\geq1/(1+2c_2)$.
\end{theorem}
\begin{proof}
  The stability function is given by
\begin{equation*}
\Phi(z, \lambda) = 1 + z\varphi_1(\lambda z) +
\frac{z^2}{2}(1-\lambda)\varphi_1(\lambda z)\varphi_1 (c_2 \lambda z)
\end{equation*}
for which we obtain $\lambda \geq 1/(1+2c_2)$ as desired.
\end{proof}
The choice $c_2=1$ yields the bound
$\lambda \geq \lambda^{\textsc{erk2p1}}=1/3$,
which is smaller than the bound obtained for the previous
method.

Concerning the second order Lawson type schemes, we consider the
Lawson2a and the Lawson2b integrators, which integrate
equation~\eqref{eq:modeleqstab} as follows
\begin{equation}
    \begin{aligned}\label{eq:lawson2astab}
      U &= \ee^{\frac{\tau}{2}\lambda\Delta}\left(u^n +
      \tfrac{\tau}{2}(1-\lambda)\Delta u^n\right), \\
      u^{n+1} &= \ee^{\tau\lambda\Delta}u^n +
      \tau\ee^{\frac{\tau}{2}\lambda\Delta}(1-\lambda)\Delta U,
    \end{aligned}
  \end{equation}
and
  \begin{equation}\label{eq:lawson2bstab}
    \begin{aligned}
      U &= \ee^{\tau\lambda\Delta}\left(u^n + \tau(1-\lambda)\Delta u^n\right), \\
      u^{n+1} &= \ee^{\tau\lambda\Delta}u^n + \frac{\tau}{2}\ee^{\tau\lambda\Delta}(1-\lambda)\Delta u^n + \frac{\tau}{2}(1-\lambda)\Delta U,
    \end{aligned}
  \end{equation}
respectively. In terms of unconditional stability, we have the following result.
\begin{theorem}\label{thm:lawson2ab}
  The Lawson2a scheme~\eqref{eq:lawson2astab} and the Lawson2b
  scheme~\eqref{eq:lawson2bstab} are unconditionally stable
for $\lambda\geq\lambda^{\textsc{l2a}}=\lambda^{\textsc{l2b}}=0.301$.
\end{theorem}
\begin{proof}
  The stability functions are given by
\begin{equation*}
  \Phi(z, \lambda) =\ee^{\lambda z}\left(
   1+ z(1-\lambda)\left(1+\frac{z(1-\lambda)}{2}\right)\right)
\end{equation*}
and
\begin{equation*}
  \Phi(z, \lambda) =  \ee^{\lambda z}\left(1+\frac{z}{2}(1-\lambda)+\frac{z}{2}(1-\lambda)(1+z(1-\lambda))\right)
\end{equation*}
for Lawson2a and Lawson2b, respectively. In both cases, a numerical calculation
leads to the restriction $\lambda \geq 0.301$ for unconditional stability.
\end{proof}

We now propose a second order variant of the stabilized Lawson--Euler scheme.
Letting $0<\alpha\leq 1$ be a free parameter, we obtain for the model
equation~\eqref{eq:modeleqstab} the following method
\begin{equation}\label{eq:stablawson2stab}
\begin{aligned}
U &= u^n + \alpha\tau\ee^{\alpha\tau\lambda\Delta}\Delta u^n, \\
u^{n+1} &= u^n + \tau\ee^{\frac{\tau}{2}\lambda\Delta}\Delta u^n +
\frac{\tau}{2\alpha}\ee^{\tau\lambda\Delta}(1-\lambda)\Delta(U-u^n).
\end{aligned}
\end{equation}
We call this second order integrator the \textit{stabilized Lawson2} scheme, for
which we have the following result.
\begin{theorem}\label{thm:stablawson2}
  The stabilized Lawson2 scheme~\eqref{eq:stablawson2stab} with
  $\alpha=\alpha^{\textsc{sl2}}=0.327$
is unconditionally stable
for $\lambda\geq\lambda^{\textsc{sl2}}=0.183$.
\end{theorem}
\begin{proof}
The stability function is given by
\begin{equation*}
  \Phi(z, \lambda) = 1 + z\ee^{\frac{\lambda z}{2}} +
  \frac{z^2}{2}(1-\lambda)\ee^{(1+\alpha)\lambda z}.
\end{equation*}
Then, setting $\alpha=\alpha^{\textsc{sl2}}=0.327$, a numerical calculation
leads to the
restriction $\lambda \geq 0.183$ for unconditional stability.
\end{proof}
Note that the value $\alpha^{\textsc{sl2}}=0.327$ is chosen such that the
corresponding parameter $\lambda^{\textsc{sl2}}$ is as small as possible.

In Table~\ref{tab:stab} we have collected, in descending order,
the stability lower bounds of all the methods considered in this section,
together with the labels that we will use throughout the paper.
To summarize, we find that the stabilized Lawson schemes can be
operated with the smallest values of $\lambda$, followed by the Lawson
schemes. Exponential integrators and IMEX schemes require a larger
value of $\lambda$ to be unconditionally stable.
\begin{table}[htb!]
  \centering
  \begin{tabular}{c|c|c|c}
method & label   & order & stab. lower bound\\
  \hline
  \rule{0pt}{12pt}
  backward--forward Euler & \textsc{bfe} & 1 & $\lambda^{\textsc{bfe}}= 1/2$ \\
  implicit--explicit2 & \textsc{imex2} & 2 & $\lambda^{\textsc{imex2}}= 1/2$ \\
  exponential Euler & \textsc{ee} & 1 & $\lambda^{\textsc{ee}}= 1/2$ \\
  exponential RK2 with $\varphi_2$ ($c_2=1$) & \textsc{erk2p2} & 2 & $\lambda^{\textsc{erk2p2}}=1/2$ \\
  exponential RK2 with $\varphi_1$ ($c_2=1$) & \textsc{erk2p1} & 2 & $\lambda^{\textsc{erk2p1}}= 1/3$ \\
  Lawson2a & \textsc{l2a} & 2 & $\lambda^{\textsc{l2a}}= 0.301$ \\
  Lawson2b & \textsc{l2b} & 2 & $\lambda^{\textsc{l2b}}= 0.301$ \\
  Lawson--Euler & \textsc{le} & 1 & $\lambda^{\textsc{le}}= 0.218$ \\
  stabilized Lawson--Euler & \textsc{sle} & 1 & $\lambda^{\textsc{sle}}= 1/(2\ee)\approx 0.184$\\
  stabilized Lawson2 ($\alpha^{\textsc{sl2}}=0.327$) & \textsc{sl2} & 2 & $\lambda^{\textsc{sl2}}= 0.183$
  \end{tabular}
  \caption{Collection of methods, in descending order in terms of unconditional
  stability. Floating point notation means obtained by numerical approximations.}
  \label{tab:stab}
\end{table}


\begin{remark} \rm
The stabilized Lawson--Euler and the stabilized Lawson2 schemes are
\emph{not} exact for linear problems, as opposed to the other exponential
integrators. Moreover, it is straightforward to see that
they are not A-stable (see Figure~\ref{fig:astab} for a plot of the A-stability
regions). Nevertheless, the stability regions contain the whole negative
real axis. Therefore, with both schemes we can treat the Laplacian
operator {\color{black}and small perturbations of it} without incurring a time step size restriction.
\begin{figure}[htb!]
  \centering
  \input{img/plot_astab.tex}
  \caption{A-stability regions (green) of the \textsc{sle} method
    (left) and of the \textsc{sl2} scheme
    (right).}
  \label{fig:astab}
\end{figure}
\end{remark}

%%%
\section{Accelerated exponential methods}\label{sec:methods}
%%%
In this section we use the above analysis to
propose a choice for the approximation operator $A$
in a more general context. We
consider in fact the following {\color{black}semilinear} advection-diffusion-reaction equation
\begin{equation} \label{eq:adr}
  \partial_t u(t,\bb x) = \nabla\cdot(a(\bb x) \nabla u(t,\bb x)) +
  \nabla\cdot(\bb b(\bb x) u(t, \bb x)) + r(t, \bx,u(t,\bb x)),
\end{equation}
where $a(\bb x)\in \RR^{d\times d}$ is the diffusion
tensor and $\bb b(\bb x)=(b_\mu(\bb x))_\mu$, for $\mu=1,\ldots,d$,
is a velocity vector field,
with appropriate boundary and initial conditions on the domain
$\Omega\subset\RR^d$. We now rewrite equation~\eqref{eq:adr}
in the following equivalent form
\begin{subequations}\label{eq:fullstab}
\begin{equation} \label{eq:adr_equiv}
    \partial_t u(t,\bb x) = Au(t,\bb x)+g(t,\bb x,u(t,\bb x)),
\end{equation}
where
\begin{equation}\label{eq:linop}
Au(t,\bb x) = \lambda \sum_{\mu=1}^da_{\mu\mu}^{\text{max}} \partial_{x_\mu x_\mu} u(t, \bb x)
+ \bb \beta \cdot \nabla u(t, \bb x)
\end{equation}
and
\begin{equation}\label{eq:nonlin}
g(t, \bx,u(t, \bb x)) =
\nabla\cdot \big((a(\bb x) - \lambda a^{\text{max}}) \nabla u(t,\bb x)\big)
+\nabla\cdot\left((\bb b(\bb x) - \bb \beta)u(t, \bb x)\right)\\
+ r(t, \bx,u(t,\bb x)).
\end{equation}
Here $\lambda\in[0,1]$,
while $a^\text{max}$ and $\bb\beta$ are the diagonal matrix
and the vector with components
\begin{equation}\label{eq:amaxbeta}
a_{\mu \mu}^{\text{max}} = \max_{\bb x} a_{\mu\mu}(\bb x),\quad
  \beta_\mu = \frac{1}{\vert \Omega \vert}\int_{\Omega} \big(b_\mu(\bb x) +
\partial_{x_\mu}a_{\mu\mu}(\bb x) \big) \,d\bb x,  \quad \mu=1,\ldots,d,
\end{equation}
\end{subequations}
respectively.
The idea here is that we extract $\lambda a^{\text{max}}$ from the diffusion
part of the equation as described in the previous section.
In addition, we move into the linear operator also a constant part from
the advection term, which is in general beneficial for exponential integrators.
We have chosen here to use the average
velocity as this physically represents a good constant coefficient
approximation of the advection operator. Moreover,
note that we have to take into
account not only the advection given by $\bb b(\bb x)$ but also the advection
that is implicitly contained in the diffusion operator.

It is possible now to apply to equation~\eqref{eq:adr_equiv}
the methods analysed in section~\ref{sec:linstaban}
for the linear homogeneous diffusion case and formulated
in the appendix for the general case.
The required matrix functions/linear solves for $A$ can be efficiently
computed in a variety of ways (e.g.~using FFT or $\mu$-mode techniques).
More details and an investigation of the performance of these schemes will be
considered in section \ref{sec:numexpstab}.



Note that in order to obtain an efficient scheme the choice of
the parameter $\lambda$ is crucial. In
reference~\cite{WZWS20}, in the
context of IMEX schemes, the authors obtained satisfactory performances
choosing $\lambda$ as small as the stability
condition permits. By following this approach, we also observed
good results in the numerical validation performed in
section~\ref{sec:validation}.
However, additional numerical experiments presented in
section~\ref{sec:numexpstab} show that this
is not necessarily always the best choice. {\color{black}Thus, we wish
to determine $\lambda$ in such a way that the error
of the numerical approximation is as small as possible, while still retaining
efficiency.
Based on numerical evidence of many examples conducted,}
we suggest the following approach. First, we perform a simulation where only a
\textit{small} number of degrees of freedom is used for the space 
discretization {\color{black}(while still capturing the overall physical dynamics
of the equation)}.
Using this simulation we perform a parameter scan for the admissible
values of $\lambda$ in order to determine the one that gives the
smallest error. Only this $\lambda$ is then used in the simulation of the
advection-diffusion-reaction equation. Note that this procedure has
negligible computational cost, since it is performed only for a small-sized
problem. Nevertheless, numerical experiments show that the obtained values
for $\lambda$ still give good approximations to the optimal
ones which correspond to the highest accuracy of the methods
(see, for instance, Figure~\ref{fig:adr2d_diffl}).




%%%
\section{Numerical validation of the stability
  constraints}\label{sec:validation}
%%%
In this section we show that the stability bounds derived for the model
equation in section~\ref{sec:linstaban} do also apply to more complicated
equations. In particular, we will consider a linear and a nonlinear
one-dimensional diffusion(-reaction) equation with variable coefficients.
\subsection{Linear diffusion}
We start by considering the following one-dimensional linear diffusion
  equation with space dependent coefficients
  \begin{equation}\label{eq:adlinearzero}
    \left\{
    \begin{aligned}
      \partial_t u(t,x)&=a(x)\partial_{xx}u(t,x),&x\in(-\pi,\pi),\ t\in[0,T],\\
      u(0,x)&=\sin x ,
    \end{aligned}\right.
  \end{equation}
  subject to periodic boundary conditions.
  In the experiments we use $a(x)=1+10\sin^2 x $.
As described above, we then rewrite equation~\eqref{eq:adlinearzero} as
\begin{equation} \label{eq:ex0stab}
  \partial_tu(t,x)=\underbrace{\lambda a^{\mathrm{max}}\partial_{xx} u(t,x)}_{A u(t,x)}+
  \underbrace{(a(x)-\lambda a^{\mathrm{max}})\partial_{xx}u(t,x)}_{g(x,u(t,x))},
\end{equation}
with $\lambda\in[0,1]$.

The structure of the equation allows for an effective discretization in
space by means of a Fourier spectral technique. In particular, we denote with
$N$ the number of Fourier modes.
Then, the temporal schemes studied in section~\ref{sec:linstaban} and resumed
in the appendix can be applied in a straightforward manner,
with the computation of derivatives and matrix functions
by pointwise operations on Fourier coefficients.

Here, we verify that the theoretical lower bounds for $\lambda$ found in
section~\ref{sec:linstaban} also
apply to this space dependent coefficients diffusion equation.
The actual simulations have been carried out with $N=2^{12}$ and $T=1/40$, and
the achieved errors for different $\lambda$ and varying number of time steps
$m=2^\ell$, with $\ell=4,6,8,\ldots,14$,
have been measured at the final time $T$ in the infinity norm,
relatively with respect to the exact solution of
equation~\eqref{eq:adlinearzero}.
The results are collected in {\color{black}Figures~\ref{fig:ad1dex0_diffdeltaa} 
and~\ref{fig:ad1dex0_diffdeltab}}. First of all,
we observe that all the considered exponential methods show the expected order
of convergence (in particular also the newly derived stabilized Lawson
schemes).
Then, we also clearly see that, as $\lambda$ decreases, some
methods fail to be unconditionally stable,
{\color{black} producing large errors when decreasing the time step size
  (for visualization reasons, we restrict the plot
  to values below $10^{-1}$)}.
In particular, if we compare with
the bounds resumed in Table~\ref{tab:stab}, we observe that the values found
can be applied sharply also to the case of equation~\eqref{eq:adlinearzero}.
Indeed, up to $\lambda=1/2$ all the methods are stable. Then,
if we further decrease $\lambda$, some methods start to blow up when
incrementing the number of time steps, in accordance to what presented in
Table~\ref{tab:stab}
({\color{black}for instance, at $\lambda=1/3$ we clearly see that the exponential
Euler scheme and the \textsc{erk2p2} method are not unconditionally stable}).
Finally, as predicted by the linear analysis, for $\lambda<\lambda^{\textsc{sl2}}$
all the schemes {\color{black}lose the unconditional stability property}.

\begin{figure}[!hp]
  \centering
  \input{img/plot_err_ex0_1.tex}
  \input{img/plot_err_ex0_2.tex}
  \input{img/plot_err_ex0_3.tex}
  \input{img/plot_err_ex0_4.tex}
  \caption{Solution of problem~\eqref{eq:adlinearzero} rewritten as
           equation~\eqref{eq:ex0stab},
           with different schemes, decreasing $\lambda$ and varying number of
           time steps $m$. 
            {\color{black}The common legend is displayed in the bottom right
              plot. Missing marks mean that the error is larger than
               $10^{-1}$, i.e., the method fails to be unconditionally
            stable.}}
  \label{fig:ad1dex0_diffdeltaa}
\end{figure}
\begin{figure}[!hp]
  \centering
  \input{img/plot_err_ex0_5.tex}
  \input{img/plot_err_ex0_6.tex}
  \input{img/plot_err_ex0_7.tex}
  \input{img/plot_err_ex0_8.tex}
  \caption{Solution of problem~\eqref{eq:adlinearzero} rewritten as
           equation~\eqref{eq:ex0stab},
           with different schemes, decreasing $\lambda$ and varying number of
           time steps $m$. 
            {\color{black}The common legend is displayed in the bottom right
            plot. Missing marks mean that the error is larger than
            $10^{-1}$, i.e., the method fails to be unconditionally
            stable.}}
  \label{fig:ad1dex0_diffdeltab}
\end{figure}

\subsection{Nonlinear diffusion-reaction}
  We now turn our attention to the following one-dimensional nonlinear
  diffusion-reaction equation
  \begin{equation}\label{eq:adnonlinear}
    \left\{
    \begin{aligned}
      \partial_t u(t,x)&=\partial_x(a(x)\partial_x u(t,x))+r(u(t,x)),&x\in(-\pi,\pi),\ t\in[0,T],\\
      u(0,x)&=\sin x,
    \end{aligned}\right.
  \end{equation}
  in an inhomogeneous medium with periodic boundary conditions, see
  reference~\cite{PX91}.
  Here we select $a(x)=1+10\sin^2 x$ as {\color{black}the} space
  dependent diffusion coefficient, and the reaction is of quadratic type
  $r(u)= u(1-u)$.
  Similarly to the previous example, we rewrite equation~\eqref{eq:adnonlinear}
  as
\begin{equation}\label{eq:ex1stab}
  \partial_tu(t,x)=\underbrace{\lambda a^{\mathrm{max}} \partial_{xx} u(t,x)}_{A u(t,x)}+
  \underbrace{\partial_x\left((a(x)-\lambda a^{\mathrm{max}})\partial_{x}u(t,x)\right)
  +r(u(t,x))}_{g(x,u(t,x))}.
\end{equation}
  We first discretize in space with a Fourier spectral
  method employing $N=2^{10}$ modes. Then, as for the previous example, the
  temporal schemes can be applied straightforwardly with pointwise operations
  on Fourier coefficients. We simulate until the final time $T=1/10$ with a
  number of time steps equal to $m=2^{12}$ for all the methods. We choose
  different values
  of $\lambda$ and we measure
  the relative errors in the infinity norm with respect to a reference solution
  computed with \textsc{erk2p2}
  as time integrator (applied to original equation~\eqref{eq:adnonlinear}
  semidiscretized in space with spectral finite differences, and with a sufficiently
  large number of time steps). We collect the results in
  Figure~\ref{fig:ad1dpx91_diffdelta}.
\begin{figure}[htb!]
  \centering
  \input{img/plot_err_ex1_vardelta.tex}
  \caption{Solution of problem~\eqref{eq:adnonlinear} rewritten as
           equation~\eqref{eq:ex1stab},
           with different schemes of first order (left), of second order (right),
           and varying value $\lambda$. The number of
           time steps
           is fixed to $m=2^{12}$ for each method. Missing marks mean that
           the error is {\color{black}larger than} $10^{-2}$.}
  \label{fig:ad1dpx91_diffdelta}
\end{figure}

Also in this nonlinear case, we observe that the linear analysis predicts
very sharply the amount of diffusion that we can consider in the operator
$A$ while keeping unconditional stability.
Moreover, it is also clear that each method becomes more precise as the value
$\lambda$ decreases, with in general a greater gain for second order methods
than the first order ones.
For completeness, we added also the results obtained with the IMEX schemes
mentioned in Remark~\ref{rem:imex}. Overall, in terms of achieved accuracy,
we observe that the stabilized
Lawson--Euler and the stabilized Lawson2 schemes perform best
among the methods of first and second order, respectively.



%%%
\section{Performance comparison}\label{sec:numexpstab}
%%%
In this section, we present performance results on two- and three-dimensional
{\color{black}semilinear} advec\-tion-diffusion-reaction equations. All the experiments have been performed
on an Intel Core i7-10750H CPU with six physical cores and 16GB of RAM,
using Matlab R2022a. Moreover, the errors showed in the plots are always
computed in the infinity norm at the final time relatively to a reference
solution computed with the Lawson2b integrator and sufficiently small time
step size.

For comparison, we perform a
  ``standard''
integration of the problem, i.e., we employ the time integrators summarized
in the appendix putting the entire diffusion and advection operators in the
linear part. The remainder $g$ is then equal to the reaction.
{\color{black}For computing the required actions of $\varphi$ functions,
we use} the general purpose \texttt{kiops} method~\cite{GRT18}, whose
Matlab implementation is available
at \url{https://gitlab.com/stephane.gaudreault/kiops/-/tree/master/}.
While there are many techniques available to compute the {\color{black}relevant} matrix
functions~\cite{al2011computing,CCZ20,CCZ22,LPR19,NW12},
\texttt{kiops}
is generally recognized to be among those {\color{black}that} perform best.
This routine requires an input tolerance, which we set as $\tau^{p+1}/100$,
where $\tau$ is the time step size and $p$ is the order of the time
integrator. For the IMEX schemes the linear systems are solved with the
biconjugate gradient stabilized iterative method
(implemented in the internal Matlab function \texttt{bicgstab}). Also for this
routine we set the input tolerance as $\tau^{p+1}/100$.

\subsection{Two-dimensional advection-diffusion-reaction}\label{sec:dr2d}
We start by considering the following two-dimensional
advection-diffusion-reaction
equation
  \begin{equation}\label{eq:ad2d}
    \left\{
    \begin{aligned}
      \partial_t u(t,x_1,x_2)&=\nabla\cdot(a(x_1,x_2)\nabla u(t,x_1,x_2))+
      \nabla\cdot\left(\bb b(x_1,x_2)u(t,x_1,x_2)\right)+r(u(t,x_1,x_2)),\\
      u(0,x_1,x_2)&=\exp(-(x_1^2+x_2^2))
    \end{aligned}\right.
  \end{equation}
  in an inhomogeneous and anisotropic medium with periodic boundary conditions.
  Here $(x_1,x_2)\in(-3\pi,3\pi)^2$, $t\in[0,T]$, the diffusion
  tensor is given by
\begin{equation*}
  a(x_1,x_2) =
  \begin{pmatrix}
    a_{11}(x_1,x_2) & 0 \\
    0 & a_{22}(x_1,x_2)
  \end{pmatrix}
  =
  \begin{pmatrix}
    \frac{1}{2}+\frac{1}{6}\sin^2(x_1)\sin^2(x_2) & 0 \\
    0 & \frac{1}{2}+\frac{1}{6}\cos^2(x_1)\cos^2(x_2)
  \end{pmatrix},
\end{equation*}
the velocity field is given by
\begin{equation*}
  b_1(x_1,x_2)=\frac{1}{5}\sin^2(x_1),\quad
  b_2(x_1,x_2)=\frac{1}{5}\sin^2(x_2),
\end{equation*}
  and the reaction is of quadratic type
  $r(u)= \frac{1}{4}u(1-u)$.
  For the proposed approach we then rewrite equation~\eqref{eq:ad2d} as
\begin{equation}\label{eq:ad2dstab}
    \partial_tu(t,x_1,x_2)=A u(t,x_1,x_2)+g(x_1,x_2,u(t,x_1,x_2)),
\end{equation}
see formulas~\eqref{eq:fullstab}.
The structure of the equation allows for an effective discretization
in space using a Fourier pseudospectral approach. In particular, we consider
$N=N_{x_1}=N_{x_2}$ Fourier modes per direction, and we employ the internal
Matlab functions \texttt{fft2} and
\texttt{ifft2} to perform the direct and inverse transforms, respectively, which
are based on the highly efficient FFTW algorithm~\cite{FJ98}. Note that,
once in Fourier space, the application of the relevant matrix functions is
simply performed by pointwise operations on the Fourier coefficients.

In order to determine the free parameter $\lambda$ in the operator $A$, we
follow the approach described in section~\ref{sec:methods}. In fact, we take
$N=2^6$ Fourier modes,  $m=2^8$ time steps and as final simulation time $T=4$.
The results are presented in Figure~\ref{fig:adr2d_diffl}. For comparison,
we plot also the results obtained with $N=2^8$. As we can observe the two plots
are very similar, but the upper ones have been obtained with a negligible
computational time, still guaranteeing a very good guess for the
optimal $\lambda$.
\begin{figure}[htb!]
  \centering
  \input{img/adr2d_diffl_fo_small.tex}\hspace{10pt}
  \input{img/adr2d_diffl_so_small.tex} \\
  \input{img/adr2d_diffl_fo_big.tex}\hspace{10pt}
  \input{img/adr2d_diffl_so_big.tex}
  \caption{Solution of problem~\eqref{eq:ad2d} rewritten as
           equation~\eqref{eq:ad2dstab},
           with different first order schemes (left) and second order schemes
           (right), for varying value $\lambda$.
           The number of time steps
           is fixed to $m=2^8$ for each method, while the number of degrees of
           freedom for each spatial variable is $N=2^6$ (top) and $N=2^8$
           (bottom). }
  \label{fig:adr2d_diffl}
\end{figure}

A summary of the values of $\lambda$ obtained in this way for all the
integrators
under consideration is given in Table~\ref{tab:adr2d_lambdaopt}. Remark that,
in this example, it is not always the case that the lower bounds stemming from
the linear stability analysis correspond to the lowest errors, both for the
exponential and for the IMEX schemes (cf. Table~\ref{tab:stab}).
\begin{table}[htb!]
  \centering
  \begin{tabular}{c||cccc|cccc}
    method & \textsc{bfe} & \textsc{ee} & \textsc{le} & \textsc{sle} &
    \textsc{erk2p1} & \textsc{imex2} & \textsc{l2a} & \textsc{sl2}\\
\hline
  \rule{0pt}{12pt} value of $\lambda$ & 0.50 & 0.50 & 0.22 & 0.23 & 0.33 & 0.57 & 0.53 & 0.57
  \end{tabular}
  \caption{Values of $\lambda$,
    for the different schemes that are employed to integrate
    problem~\eqref{eq:ad2d} rewritten as equation~\eqref{eq:ad2dstab}
    (see also Figure~\ref{fig:adr2d_diffl}).}
  \label{tab:adr2d_lambdaopt}
\end{table}


Now, employing for each integrator the corresponding value of $\lambda$ found,
we present the actual performance results using $N=2^8$ degrees of freedom for
every spatial variable.
As a comparison, we consider the original equation~\eqref{eq:ad2d} {\color{black}
semidiscretized in space with spectral finite differences} and
solved numerically with the same temporal integrators. {\color{black} In
addition, we also perform the time evolution with the exponential
Rosenbrock--Euler 
scheme (see the appendix), that we label \textsc{erbe}.
This method is of second order, requires the action of a single $\varphi_1$ 
function and employs as linear operator the Jacobian of the right-hand side of the
equation (i.e., it exploits in the linear part also information coming from the 
reaction term, which may be beneficial)}.

The number of time steps is set to $2^{\ell_1}$, with
$\ell_1=9,\ldots,12$, for the first order integrators, while $2^{\ell_2}$, with
$\ell_2=8,\ldots,11$, for the second order methods. The final simulation time
is again $T=4$.
The results are collected in the CPU diagrams of Figure~\ref{fig:cpudiag2d}.
\begin{figure}[htb!]
  \centering
  \input{img/plot_cpudiag_ex2_ord1.tex}
  \input{img/plot_cpudiag_ex2_ord2.tex}
  \caption{Results for the simulations of problem~\eqref{eq:ad2d}
  (dashed lines), rewritten as equation~\eqref{eq:ad2dstab}
  (solid lines), with different integrators of first order (left, number of time
  steps $m=2^{\ell_1}$ with $\ell_1=9,\ldots,12$) and of second order (right,
  number of time steps $m=2^{\ell_2}$ with $\ell_2=8,\ldots,11$).}
  \label{fig:cpudiag2d}
\end{figure}
As we can see, overall the proposed approach allows to obtain 
slightly better errors with respect to the results in the original formulation,
{\color{black}with the exception of the Lawson2a scheme.
Indeed, the choice of the parameter $\lambda$ in the 
acceleration technique is determined by stability considerations
only, and not by 
accuracy ones. Hence, a decrease in error is not to be expected, in general}.
The computational
time of the proposed approach is less than the corresponding integration in the
original formulation. Among the first order schemes the exponential
 methods perform equally well, while for
 the second order methods the implicit-explicit2 scheme is the one that
 shows slightly better results. Note also that, when integrating
 equation~\eqref{eq:ad2dstab}
with the proposed approach, the wall-clock time is basically independent of the
chosen time integrators, both for first and second order methods.
This is expected, as the most costly operations in this case are the Fourier
and inverse Fourier transforms. {\color{black}In fact each scheme of order one 
requires 7 transforms per time step, while we need 13 for the second order
methods.
Finally, note that as expected the \textsc{erbe} method requires
less wall-clock time than the \textsc{l2a} and the \textsc{erk2p1} scheme (since
it requires just a single action of $\varphi$ function).
However, overall the computational gain of the proposed approach is still superior.}

\subsection{Three-dimensional advection-diffusion-reaction}\label{sec:adr3d}
We now consider the following three-dimensional
advection-diffusion-reaction equation
  \begin{equation}\label{eq:adr3d}
    \left\{
    \begin{aligned}
      \partial_t u(t,x_1,x_2,x_3)&=a(x_1,x_2,x_3)\Delta u(t,x_1,x_2,x_3)+
      b \sum_{\mu=1}^3 \partial_{x_\mu} u(t,x_1,x_2,x_3) +r(u(t,x_1,x_2,x_3)),\\
      u(0,x_1,x_2,x_3)&=\left(\frac{27}{4}\right)^3x_1x_2x_3(1-x_1)^2(1-x_2)^2(1-x_3)^2,
    \end{aligned}\right.
  \end{equation}
  in the spatial domain $\Omega = (0,1)^3$ and $t\in[0,T]$.
  We equip the problem with homogeneous Dirichlet boundary conditions on the
  set $\{(x_1,x_2,x_3)\in\partial\Omega: x_1x_2x_3=0\}$ and with homogeneous
  Neumann
  boundary conditions elsewhere.
  We set the diffusion coefficient to
  \begin{equation*}
    a(x_1,x_2,x_3) = \frac{1}{10}\ee^{-(x_1-1/2)^2-(x_2-1/2)^2-(x_3-1/2)^2},
  \end{equation*}
  while the reaction is of cubic type $r(u)=u(1+u^2)$.

  For the proposed approach we rewrite equation~\eqref{eq:adr3d} as
\begin{equation}\label{eq:adr3dstab}
\begin{split}
  \partial_t u(t,x_1,x_2,x_3)&=
  \underbrace{(\lambda a^{\mathrm{max}}\Delta +
    b(\partial_{x_1} +\partial_{x_2}+\partial_{x_3}))
    u(t,x_1,x_2,x_3)}_{A u(t,x_1,x_2,x_3)}\\
  &+ \underbrace{(a(x_1,x_2,x_3)-\lambda a^{\mathrm{max}})\Delta u(t,x_1,x_2,x_3) +
    r(u(t,x_1,x_2,x_3))}_{g(x_1,x_2,x_3,u(t,x_1,x_2,x_3))},
\end{split}
\end{equation}
{\color{black}
where
\begin{equation*}
  a^{\mathrm{max}}=\max_{x_1, x_2, x_3}a(x_1,x_2,x_3).
\end{equation*}
}%
We discretize this equation in space  with standard second order centered finite
differences, using $N=N_{x_1}=N_{x_2}=N_{x_3}$ discretization points for each
direction.
By doing so, the linear operator $A$ in equation~\eqref{eq:adr3dstab}
is approximated by a matrix with Kronecker sum structure
$A_3 \oplus A_2 \oplus A_1$,
where $A_\mu\in\RR^{N_{x_\mu} \times N_{x_\mu}}$ is the discretization matrix
of the operator $\lambda a^{\mathrm{max}}\partial_{x_\mu x_\mu}
+ b \partial_{x_\mu}$.
Hence, for those exponential integrators that just require the exponential
function (i.e., the ones of Lawson type), it is possible to employ $\mu$-mode
based techniques in order to efficiently compute the needed actions of the
matrix exponential via Tucker operators 
{\color{black}
exploiting the equivalence
\begin{equation*}
  \ee^{A_3 \oplus A_2 \oplus A_1}\bb v =
  \mathrm{vec}\left(\bb V \times_1 \ee^{A_1} \times_2 \ee^{A_2} \times_3 \ee^{A_3}\right),
  \quad \bb V \in \RR^{N\times N \times N},
  \quad \bb v = \mathrm{vec}(\bb V),
\end{equation*}
see references~\cite{CCEOZ22,CCZ22b} for more details}.

Similarly to the previous example, in order to determine the free parameter
$\lambda$ in $A$, we use the technique described in section~\ref{sec:methods}.
We set $N=2^4$ and perform a simulation
with $m=2^8$ time steps and final simulation time $T=1/4$. The outcome,
for two different choices
of advection parameter ($b=-0.01$ and $b=-1$), is summarized in
Figure~\ref{fig:adr3d_diffl}, and the resulting values of $\lambda$ actually
employed in the experiments are given in
Table~\ref{tab:adr3d_lambdaopt}.
\begin{figure}[htb!]
  \centering
  \input{img/adr3d_diffl_ord1.tex}
  \input{img/adr3d_diffl_ord2.tex} \\
  \input{img/adr3d_adv_diffl_ord1.tex}
  \input{img/adr3d_adv_diffl_ord2.tex}
  \caption{Solution of problem~\eqref{eq:adr3d} rewritten as
           equation~\eqref{eq:adr3dstab},
           with various first order schemes (left) and second order schemes
           (right), for different values of $\lambda$. The number of time steps
           is fixed to $m=2^8$ for each method, while the number of degrees of
           freedom for each spatial variable is $N=2^4$. The advection
           parameter is either $b=-0.01$ (top) or  $b=-1$ (bottom).}
  \label{fig:adr3d_diffl}
\end{figure}

\begin{table}[htb!]
  \centering
  \begin{tabular}{c||cc|cc|cc|cc}
    & \multicolumn{4}{c|}{$b=-0.01$} & \multicolumn{4}{c}{$b=-1$}\\
    & \textsc{le} & \textsc{sle} & \textsc{l2a} & \textsc{sl2}&
    \textsc{le} & \textsc{sle} & \textsc{l2a} & \textsc{sl2}\\
    \hline
    \rule{0pt}{12pt} value of $\lambda$    &  0.36 & 0.27 & 0.62 & 0.53 &
 0.60 & 0.50 & 0.50 & 0.57
  \end{tabular}
  \caption{Values of $\lambda$ for the different schemes
  that are employed to integrate problem~\eqref{eq:adr3d} rewritten as
  equation~\eqref{eq:adr3dstab} (see also Figure~\ref{fig:adr3d_diffl}).}
  \label{tab:adr3d_lambdaopt}
\end{table}


For the performance results, we set the number of uni-directional degrees of
freedom to $N=60$. As term of comparison, we consider here the same time
integrators but applied to the original equation~\eqref{eq:adr3d}
spatially discretized with second order centered finite differences.
In addition, in this formulation, we also present the results obtained
with the exponential Euler scheme, with {\color{black}the second order 
  exponential Runge--Kutta integrator \textsc{erk2p1}, with the exponential
  Rosenbrock--Euler method \textsc{erbe} and with the two IMEX 
schemes \textsc{bfe} and \textsc{imex2}}.
We perform the simulations with a number of time integration steps equal
to $2^{\ell_1}$, with $\ell_1=9,\ldots,12$, for the first order methods, while
we consider $2^{\ell_2}$, with $\ell_2=5,\ldots,8$, for the second order
schemes.
Again, the final simulation time is set to $T=1/4$.
The outcome of the experiments with advection parameter $b=-0.01$
is collected in a CPU diagram in Figure~\ref{fig:cpudiagadr3d}.
\begin{figure}[htb!]
  \centering
  \input{img/adr3d_cpudiag_ord1.tex}
  \input{img/adr3d_cpudiag_ord2.tex}
  \caption{Results for the simulations of problem~\eqref{eq:adr3d}
  (dashed lines), rewritten as equation~\eqref{eq:adr3dstab}
    (solid lines), with $b=-0.01$ and different integrators of first order
    schemes (left, number of time
    steps $m=2^{\ell_1}$ with $\ell_1=9,\ldots,12$) and second order schemes
    (right, number of time steps
  $m=2^{\ell_2}$ with $\ell_2=5,\ldots,8$).}
  \label{fig:cpudiagadr3d}
\end{figure}

First of all, concerning the schemes of first order, we observe that in the
original formulation (i.e., the dashed lines in the plot)
the Lawson--Euler scheme is the one which performs best. Indeed,
comparing it with the other exponential methods, it is the one which reaches
the smallest error, with basically the same computational time.
The backward-forward Euler method performs slightly better in terms of
wall-clock
time, but the error is larger than both the exponential Euler method and
the Lawson--Euler scheme. Hence, overall, it is not the preferred method.
In any case, we observe that the proposed approach, i.e., solving instead
equation~\eqref{eq:adr3dstab} with $\mu$-mode techniques (solid lines) is
effective. Indeed, in this formulation both the Lawson--Euler and the stabilized
Lawson--Euler methods perform better than the corresponding counterparts,
both in terms of error and of wall-clock time, with a slight
advantage for the former.
Similar considerations can be drawn for the second order schemes. In fact,
using the proposed approach, the Lawson2a
scheme performs best, with a considerable advantage in performance
in the $\mu$-mode realization.

We then repeat the experiment by increasing the magnitude of advection parameter, i.e.,
setting it to $b=-1$. The results are collected in
Figure~\ref{fig:cpudiagadr3dadv}.
\begin{figure}[htb!]
  \centering
  \input{img/adr3d_adv_cpudiag_ord1.tex}
  \input{img/adr3d_adv_cpudiag_ord2.tex}
  \caption{Results for the simulations of problem~\eqref{eq:adr3d}
  (dashed lines), eventually rewritten as equation~\eqref{eq:adr3dstab}
    (solid lines), with $b=-1$ and different integrators  of first order
    (left, number of time
  steps $m=2^{\ell_1}$ with $\ell_1=9,\ldots,12$) and
  second order (right, number of time steps
  $m=2^{\ell_2}$ with $\ell_2=5,\ldots,8$).}
  \label{fig:cpudiagadr3dadv}
\end{figure}
In this case, we first of all note that the stabilized
schemes applied to equation~\eqref{eq:adr3dstab} show errors which are either
comparable (stabilized Lawson--Euler) or
even lower (stabilized Lawson2) with respect to their counterparts
in the original formulation. This is not true for the Lawson--Euler and the
Lawson2a schemes, which in fact increase the errors when employing the proposed
approach.
Nevertheless, the gain in computational time is so considerable that
overall the $\mu$-mode implementation is the preferred one.
In particular, the methods which perform best are the Lawson--Euler scheme
and the Lawson2a method for first and second order, respectively.

%%%
\section{Conclusion}\label{sec:concstab}
%%%
{\color{black}In this manuscript, we presented an effective acceleration 
approach to numerically solve semilinear advection-diffusion-reaction equations
in the framework of exponential integrators.
The technique is based on a reformulation of the original equation, driven by a
linear stability analysis of a simpler model, and
allows for the employment of ad-hoc efficient methods for the time integration
(FFT or $\mu$-mode based, for instance).
In this context, we also presented two new schemes of Lawson type which have 
improved unconditional stability bounds compared to methods already available
in the literature, and which appear to perform comparably with respect to well-known
integrators in most of the situations.

We conducted numerical examples and performance comparisons on several
semilinear ad\-vection-diffusion-reaction equations in one, two, and 
three space dimensions. The outcomes show the superiority of 
the proposed technique for exponential integrators, always outperforming
straightforward implementations (up to a factor of roughly 15 in the 
three dimensional case) 
and often obtaining better results with respect to popular IMEX schemes.

As further developments, we plan to deeply investigate alternative
choices for the approximation operator $A$ (making it vary
according to the time evolution of the solution by relating it to
the Jacobian of the equation, for instance) as well as to consider nonlinear
diffusion terms, both from a
theoretical and a practical point of view. Also, we intend
to apply the proposed approach to different classes of PDEs arising from science
and engineering problems.}

\section*{Acknowledgments}
M.~C.~and F.~C.~acknowledge partial support from the Program Ricerca di Base
2019 No.~RBVR199YFL
of the University of Verona entitled ``Geometric Evolution of Multi Agent
Systems''.
L.~E.~acknowledges support from the Austrian Science Fund (FWF) --- project id:
P32143-N32.

%%%
\section*{Appendix}
%%%
  For the convenience of the reader, we list here the integrators that
  have been mentioned and studied in the paper.
  We suppose that the equation under study is given in the following
  abstract form
  \begin{equation*}
    u'(t) = Au(t) + g(t,u(t)) = F(t,u(t)),
  \end{equation*}
  where $A$ is a generic linear operator and $g$ is a nonlinear function.

  \bigskip
  \noindent\textbf{Lawson type exponential integrators}

  \bigskip
  \noindent The \emph{Lawson--Euler} scheme is given by
  \begin{equation*}
    u^{n+1}=\ee^{\tau A}(u^n + \tau g(t_n,u^n)).
  \end{equation*}
  The \emph{stabilized Lawson--Euler} scheme is given by
  \begin{equation*}
    u^{n+1}=u^n+\tau\ee^{\tau A}F(t_n,u^n).
  \end{equation*}
  The \emph{Lawson2a} scheme is given by
  \begin{equation*}
      U = \ee^{\frac{\tau}{2}A}\left(u^n +
           \frac{\tau}{2}g(t_n,u^n)\right), \quad
      u^{n+1} = \ee^{\tau A}u^n +
                 \tau\ee^{\frac{\tau}{2}A}g\left(t_n+\frac{\tau}{2},U\right).
  \end{equation*}
  The \emph{Lawson2b} scheme is given by
  \begin{equation*}
      U = \ee^{\tau A}\left(u^n + \tau g(t_n,u^n)\right), \quad
      u^{n+1} = \ee^{\tau A}\left(u^n + \frac{\tau}{2}g(t_n,u^n)\right)
      + \frac{\tau}{2}g(t_n+\tau,U).
  \end{equation*}
  The \emph{stabilized Lawson2} scheme is given by
  \begin{equation*}
      U = u^n + \alpha\tau\ee^{\alpha\tau A}F(t_n,u^n), \quad
      u^{n+1} = u^n + \tau\ee^{\frac{\tau}{2} A}F(t_n,u^n) +
                 \frac{\tau}{2\alpha}\ee^{\tau A}
                 (g(t_n+\alpha\tau,U)-g(t_n,u^n)).
  \end{equation*}

  \bigskip
  \noindent\textbf{Classical exponential integrators}

  \bigskip
  \noindent The \emph{exponential Euler} scheme is given by
  \begin{equation*}
    u^{n+1} = u^n + \tau \varphi_1(\tau A)F(t_n,u^n).
  \end{equation*}
  The \emph{exponential Runge--Kutta} scheme of second order involving
  the $\varphi_2$ function is given by
  \begin{equation*}
    \begin{aligned}
      U &= u^n + c_2\tau \varphi_1(c_2\tau A)F(t_n,u^n), \\
      u^{n+1} &= u^n + \tau \varphi_1(\tau A)F(t_n,u^n) +
                 \frac{\tau}{c_2}\varphi_2(\tau A)(g(t_n+c_2\tau,U)-g(t_n,u^n)).
    \end{aligned}
  \end{equation*}
  The \emph{exponential Runge--Kutta} scheme of second order involving the
  $\varphi_1$ function is given by
  \begin{equation*}
    \begin{aligned}
      U &= u^n + c_2\tau \varphi_1(c_2\tau A)F(t_n,u^n), \\
      u^{n+1} &= u^n + \tau \varphi_1(\tau A)F(t_n,u^n) +
                 \frac{\tau}{2c_2}\varphi_1(\tau A)(g(t_n+c_2\tau,U)-g(t_n,u^n)).
    \end{aligned}
  \end{equation*}
      {\color{black}The \emph{exponential Rosenbrock--Euler} scheme
        for autonomous problems with $F(u(t))=Au(t)+g(u(t))$ is given by
  \begin{equation*}
    u^{n+1}=u^n+\tau\varphi_1(\tau J_n)F(u^n), \quad J_n = A+\frac{\partial g}{\partial u}(u^n) .
  \end{equation*}
  }

  \bigskip
  \noindent\textbf{IMEX schemes}

  \bigskip
  \noindent The \emph{backward-forward Euler} scheme is given by
  \begin{equation*}
    (I-\tau A )u^{n+1} = u^n + \tau g(t_n,u^n).
  \end{equation*}
  The second order \emph{implicit-explicit2} scheme proposed
  in reference~\cite{WZWS20} is given by
  \begin{equation*}
      \left(I-\frac{\tau}{2} A\right)U = u^n + \frac{\tau}{2} g(t_n,u^n), \quad
      \left(I-\frac{\tau}{2} A\right)u^{n+1} = u^n + \frac{\tau}{2}A u^n +\tau g\left(t_n+\frac{\tau}{2},U\right).
  \end{equation*}

\bibliographystyle{plain}
\bibliography{bibliostab}
\end{document}

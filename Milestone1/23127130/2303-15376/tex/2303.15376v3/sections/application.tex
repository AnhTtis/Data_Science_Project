
\section{Application}
\label{Section7}

We explain our methodology in detail based on real-world data that describes the expenditure habits of Philippines residents. The Philippine Statistics Authority conducts a nationwide survey of Family Income and Expenditure \citep{psa_fies} every three years. 
The dataset (taken from \cite{FamilyIncomeExpenditure}) contains over 40,000 observations primarily comprising the household income and expenditures of each household. To reduce the size and add homogeneity to the data, we consider only families of size $1$ (people living alone) above the poverty line (top 90\%, with an income of at least $80,000\,\, pesos\approx 4000\,\,dollars $ per year). We end up with $n=1417$ observations. 

We focus on the following variables: Total income ($X_1$), Food expenditure ($X_2$), and Alcohol expenditure ($X_3$). Our objective is to identify the causal relationships among these variables. Intuition gives us that $Income\to Food$. However, the relationships between alcohol and other variables is not trivial. Drinking habits can impact income and food habits, although income can change the quality of the purchased alcohol. Histograms and pairwise plots of the variables are presented in Appendix~\ref{Appendix_simulations}. 

\subsection{Pairwise discovery}

First, we focus on the causal relationship between $X_1$ and $X_2$ (between $Income$ and $Food$). We apply our $CPCM(F_1, F_2)$ methodology following the algorithm presented in Section \ref{Section_Algorithm}. With regard to the choice of $F_1$ and $F_2$, we select the \textit{Gamma} distribution for both  $F_1,F_2$ (model described in Consequence \ref{consequenceprva}).  We explain our choice: both marginals of  $X_1$ and $X_2$ are Gamma-shaped (see the histograms in Figure  \ref{Just_histograms}) and the Gamma is a common choice for this type of data. One may argue that the Pareto distribution is more suitable since the tails of  $X_1$ and $X_2$ are heavy-tailed and  $X_1$ and $X_2$ are dependent in extremes. 
One may compare AIC scores in regression with the Gamma and Pareto distributions. The AIC is equal to $31 308$ ($31449$)  for the Gamma (Pareto) distribution in the direction $X_1\to X_2$ and $36089$ ($37171$)  for the Gamma (Pareto) distribution in the direction $X_2\to X_1$. In this case, the Gamma distribution appears to be a better fit in both directions. However, selecting $F$ based on AIC is not appropriate; we must be careful when comparing several choices of $F$ (see the discussion in Section \ref{Section5Model_choice}). 

Further, applying the CPCM algorithm yields the following estimation: $X_1\to X_2$. The p-values of the independence tests were $0.2$ and $0.02$ corresponding to the directions $X_1\to X_2$ and $X_2\to X_1$, respectively.  Selecting the Pareto distribution function or even the Gaussian distribution function yields similar results. 

Second, we focus on a causal relationship between $X_1$ and $X_3$ (between $Income$ and $Alcohol$). As for the choice of $F_3$, the Pareto distribution appears more reasonable since it appears heavy-tailed with a large mass between 0 and 1000 pesos. However, selecting $F_1=Gamma$ and $F_3 = Pareto$ can potentially lead to an ``unfair game'' bias (see Section \ref{Section5Model_choice}).  

Applying the CPCM algorithm suggests that both directions are unplausible. The p-values of the independence tests were $\approx 10^{-9}$ and $0.003$ corresponded to the directions $X_1\to X_3$ and $X_3\to X_1$, respectively. We note that for any pair of Gamma, Gaussian, or Pareto distribution functions, the p-values are always below $0.003$. This suggests that some assumptions remain unfulfilled. In this case, we believe that causal sufficiency is violated; there is a strong unobserved common cause between these variables. 
Note that even if both causal graphs were unplausible, direction  $X_3\to X_1$ appeared to be the most probable direction ($0.003>10^{-9}$ for the choice of Gamma distribution). 

Finally, we focus on the causal relationship between $X_2$ and $X_3$ (between $Food$ and $Alcohol$). Using the same principle as that for previous pairs, we obtain an estimation $X_3\to X_2$. The p-values of the independence tests were $2\cdot10^{-9}$ and $0.46$, which corresponded to the directions $X_2\to X_3$ and $X_3\to X_2$, respectively. We note that selecting the Pareto distribution function or the Gaussian distribution function yields similar results. This result suggests that drinking habits affect food habits. 

\subsection{Multivariate score-based discovery and results}
We apply the score-based algorithm presented in Section \ref{Section_score_based_algorithm} using the Gamma distribution function $F$. The graph with the best score is the one presented in Figure \ref{Just_graph}. However, this graph is not plausible, as the test of independence between $\hat{\varepsilon}_1,\hat{\varepsilon}_2, \hat{\varepsilon}_3$ yields a p-value of $0.02$. The graphs where $alcohol$ and $income$ are neighbours had slightly worse scores and a p-value of $0.03$. 

\begin{figure}[t]
\centering
\includegraphics[scale=0.4]{figures/only_graph.png}
\caption{ Final estimate of the causal graph in the application using a score-based algorithm and pairwise discovery. The relationship between $Alcohol$  and $Income$ is inconclusive and differs with different choices of $F$. The score-based algorithm with Gamma distribution $F$ suggests no causal relationship, with Pareto $F$ suggesting $Income\to Alcohol$ and the bivariate algorithm suggesting $Alcohol\to Income$.}
\label{Just_graph}
\end{figure}



Possible feedback loops and common causes are the main reasons why we do not obtain clear independence between the estimated noise variables. Deviations from the assumed model conditions are often observed in real-world scenarios. Despite this, acceptable estimates of the causal relationships can still be derived if the deviations are not excessive.






























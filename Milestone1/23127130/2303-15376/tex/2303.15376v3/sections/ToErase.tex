\begin{customlem}{\ref{thmMultivairateIdentifiability}}
Let $F_{\textbf{X}}$ be generated by the $CPCM(F_1, \dots, F_d)$ with DAG $\mathcal{G}$ and with density $p_\textbf{X}$. Assume that for all $ i,j\in\mathcal{G}$, $ S\subseteq V$ such that $i\in pa_j$ and  $pa_j\setminus \{i\}\subseteq S \subseteq nd_j\setminus\{i,j\}$, there exist $\textbf{x}_{S}: p_S(\textbf{x}_S)>0$ satisfying that a bivariate model defined as $X=\tilde{\varepsilon}_X, Y = F^{-1}_j\big(\tilde{\varepsilon}_Y, \tilde{\theta}(X)\big)$ is identifiable (in the sense of Definition \ref{DEFidentifiability}), where  $F_{\tilde{\varepsilon}_X} = F_{X_i\mid \textbf{X}_{S} =\textbf{ x}_S}    $ and $\tilde{\theta}(x) = \theta_j(\textbf{x}_{pa_j\setminus\{i\}}, x)$,  $x\in supp(X)$.

Then,  $\mathcal{G}$ is identifiable from the joint distribution. 
 \end{customlem}
 
 \begin{proof}
 \label{Proof of thmMultivairateIdentifiability}
Let there be two $CPCM(F_1, \dots, F_d)$ models with causal graphs $\mathcal{G}\neq \mathcal{G}'$ that both generate $F_\textbf{X}$.   From Proposition 29 in \cite{Peters2014} (recall that we assume causal minimality of $CPCM(F_1, \dots, F_d)$), there exists variables $L,Y\in \{X_1, \dots, X_d\}$ such that 
\begin{itemize}
\item $Y\to L$ in $\mathcal{G}$ and $L\to Y$ in $\mathcal{G}'$,
\item $S:=\underbrace{\big\{pa_L(\mathcal{G})\setminus\{Y\}\big\}}_\text{\textbf{Q}}\cup\underbrace{\big\{pa_Y(\mathcal{G}')\setminus\{L\}\big\}}_\text{\textbf{R}}\subseteq \big\{nd_L(\mathcal{G}) \cap nd_Y(\mathcal{G}')\setminus\{Y,L\}\big\} $. 
\end{itemize}
For this $S$, choose $\textbf{x}_S$ according to the condition in the theorem. In the following, we use the notation $\textbf{x}_S=(\textbf{x}_q, \textbf{x}_r)$ where $q\in \textbf{Q}, r\in \textbf{R}$. Now we use Lemma 36 and Lemma 37 from \citep{Peters2014}.  Since $Y\to L$ in $\mathcal{G}$, we define a bivariate SCM  \footnote{Informally, we consider  $Y^\star := Y\mid \{\textbf{X}_S=\textbf{x}_S\}$ and $L^\star := L\mid \{\textbf{X}_S=\textbf{x}_S\}$.} $$Y^\star=\tilde{\varepsilon}_{Y^\star},\,\,\,\,\,\,\,\,\,\, L^\star = F^{-1}_{L}\big(\varepsilon_L; \theta_L(Y^\star)\big),$$ 
where $\tilde{\varepsilon}_{Y^\star} \overset{D}{=} Y\mid \{\textbf{X}_S=\textbf{x}_S\}$ and $\varepsilon_L\indep Y^\star, \varepsilon_L\sim U(0,1)$. This is a bivariate CPCM with $Y^\star\to L^\star$. However, the same holds for the other direction: Since $L\to Y$ in $\mathcal{G}'$, we can also define a bivariate SCM $$L^\star=\tilde{\varepsilon}_{L^\star},\,\,\,\,\,\,\,\,\,\, Y^\star = F^{-1}_{Y}\big(\varepsilon_Y; \theta_Y(L^\star)\big),$$ 
 where $\tilde{\varepsilon}_{L^\star} \overset{D}{=}L\mid \{\textbf{X}_S=\textbf{x}_S\}$ and $\varepsilon_Y\indep L^\star, \varepsilon_Y\sim U(0,1)$. We obtained a bivariate CPCM with $L^\star\to Y^\star$, which is a contradiction with the pairwise identifiability. Hence,  $\mathcal{G}= \mathcal{G}'$.  
 \end{proof}
\begin{figure}[H]
    \begin{minipage}[c]{\linewidth}
        \sethlcolor{lightblueshade}
        \hl{\textbf{Environment: }You are in the middle of a room. Looking quickly
        around you, you see a bed 1, a desk 2, a desk 1, a drawer 6, a drawer 5, a
        drawer 4, a drawer 3, a drawer 2, a drawer 1, a garbagecan 1, a laundryhamper
        1, a safe 1, a shelf 6, a shelf 5, a shelf 4, a shelf 3, a shelf 2, and a
        shelf 1.\\
        \textbf{Task: }examine the mug with the desklamp.}
    \end{minipage}
    \begin{minipage}[c]{\linewidth}
        \textbf{Trial \#1}\\
        $>$ think: To solve the task, I need to find and take a mug, then find
        and use a desklamp.\\
        $>$ think: First I need to find a mug. A mug is more likely to appear in
            drawer (1-6), desk (1-2), shelf (1-6), garbagecan (1), laundryhamper (1).
            I can check one by one, starting with drawer 1.\\
        $>$ go to drawer 1\\
        The drawer 1 is closed.\\
        \dots\\
        $>$ open drawer 6\\
        You open the drawer 6. The drawer 6 is open. In it, you see a keychain 2.\\
        \sethlcolor{lightgreenshade}
        \hl{$>$ go to desk 1\\
        On the desk 1, you see a creditcard 3, a desklamp 1, a laptop 2, a mug 1, a
            pen 1, and a pencil 1.\\
        $>$ think: Now I find a mug (1). Next, I need to take it.\\
        $>$ take mug 1 from desk 1\\
        You pick up the mug 1 from the desk 1.}\\
        $>$ think: Now I take a mug (1). Next, I need to find a desklamp. A desklamp
            is more likely to appear in desk (1-2), sidetable (1-2), shelf (1-6),
            bed (1), drawer (1-6). I can check one by one, starting with desk 1.\\
        $>$ go to desk 1\\
        Nothing happens.\\
        $>$ go to desk 2\\
        On the desk 2, you see a alarmclock 1, a bowl 1, a mug 3, a pencil 3,
            and a pencil 2.\\
        $>$ think: Now I find a desklamp (1). Next, I need to use it.\\
        \sethlcolor{lightredshade}
        \hl{$>$ use desklamp 1\\
        Nothing happens.\\
        $>$ use desklamp 1\\
        Nothing happens.\\
        Status: Fail}
        \label{appendix:decisionmaking:trial1}
    \end{minipage}
    
    \begin{minipage}[c]{\linewidth}
        \sethlcolor{lightblueshade}
        \hl{\textbf{Reflection:} In this environment, my plan was to find a mug then
        find and use a desklamp. However, the task says to examine the mug with the
        desklamp. I should have looked for the desklamp first, then looked for the
        mug. I noticed that the desklamp was found on desk 1. In the next trial, I
        will go to desk 1, find the lamp, then look for the mug and examine it with
        the desklamp.}
        \label{appendix:decisionmaking:reflection}
    \end{minipage}
    
    \begin{minipage}[c]{\linewidth}
        \textbf{Trial \#2}\\
        \sethlcolor{lightgreenshade}
        \hl{$>$ go to desk 1\\
        On the desk 1, you see a creditcard 3, a desklamp 1, a laptop 2, a mug 1,
            a pen 1, and a pencil 1.\\
        $>$ think: To solve the task, I need to find and take a mug, then find
            and use a desklamp.\\
        $>$ take mug 1 from desk 1\\
        You pick up the mug 1 from the desk 1.}\\
        $>$ think: To solve the task, I need to find and take a mug, then find
            and use a desklamp.\\
        \sethlcolor{lightgreenshade}
        \hl{$>$ use desklamp 1\\
        You turn on the desklamp 1.\\
        Status: Success}
        \label{appendix:decisionmaking:trial2}
    \end{minipage}
    \caption{[Top] An AlfWorld trajectory in which the agent failed due to
        inefficient planning. In the reflection, the agent recognizes that it
        should have looked for the desklamp then the mug, not the mug then the
        desklamp. [Bottom] The agent is able to correct its reasoning trace and
        execute a sequence of actions in a concise manner.}
    \label{appendix:decisionmaking:success}
\end{figure}

\subsection{WebShop Limitation}

In \ref{sec:limitations}, we briefly state that Reflexion struggles to overcome
local minima choices that require extremely creative behavior to escape. We observe this
shortcoming in an experiment on WebShop \citep{yao2022webshop}. WebShop is a web-based
problem-solving benchmark that tests agents to navigate
an e-commerce website to locate and purchase products given requests from clients.
We test a two-shot ReAct + Reflexion agent in 100 environments. However, after only
four trials, we terminate the runs as the agent does not show signs of improvement
\ref{fig:additional_information:webshop}. Further, the agent does not generate helpful,
intuitive self-reflections after failed attempts. We conclude that Reflexion is
unable to solve tasks that require a significant amount of diversity and
exploration. In AlfWorld, the agent is able to adequately explore new environments
because the permissible actions can be seen in the observations. In HotPotQA,
the agent faces a similar WebShop search query task but is more successful
as the search space for Wikipedia articles is more diverse and requires less
precise search queries. A common problem for e-commerce search engines is
properly handling ambiguity in natural language search interpretations.
Thus, WebShop presents a task that requires very diverse and unique behavior
from a Reflexion agent.

\begin{figure}[htbp] 
    \centering
    \includegraphics[scale=0.40]{figures/webshop_success.pdf}
    \caption{Reflexion vs React performance on WebShop across 100 customer
        shopping requests. ReAct + Reflexion fails to significantly outperform
        ReAct.}
    \label{fig:additional_information:webshop}
\end{figure}



\section{Application to Linear MRAC}
\label{sec:apl:LMRAC}

In Chapter 12 of \cite{lavretsky2013robust} an extension to the general linear MRAC setup is 
introduced which allows for nonlinearities $f:\R^n\to\R^\ell$ as
$
f(x) \ = \ \Theta^\top\!\Psi(x) + \epsilon_f(x)
$
such that the plant is given by
\begin{align}\nonumber
\dot{x}_t \ &= \ A\,x_t + B\big(u_t + f(x)) \\\label{eq:apl:plant}
&= \ A\,x_t + B\big(u_t + \Theta^\top\!\Psi(x_t) + \epsilon_f(x)\big) \ \ ,
\end{align}
where $A$ is a known $n\times n$ state matrix for the plant state $x_t\in\R^n$, $B$ is a known
$n\times\ell$ input matrix for the input $u_t\in\R^\ell$, and $\Theta$ is an \underline{unknown}
$N\times\ell$ matrix which linearly parameterizes the known vector function $\Psi:\R^n\to\R^N$.
We assume $(A,B)$ is controllable. The general setup also includes an unknown diagonal scaling 
matrix $\Lambda$, such that the overall input matrix is $B\Lambda$, and assumes that $A$ is 
unknown. For simplicity, we assume $A$ is known and omit $\Lambda$.

Again it is assumed that there exists an $n\times\ell$ matrix of feedback gains $K_x$ and an
$\ell\times\ell$ matrix of feedforward gains $K_r$ satisfying the \textit{matching conditions}
\begin{align*}\nonumber
A + BK_x^\top = A_r \\
BK_r^\top = B_r
\end{align*}
to a controllable, linear reference model
\begin{equation*}
\dot{x}_t^r = A_r\,x_t^r + B_r\,r_t \ \ ,
\end{equation*}
where $A_r$ is a known Hurwitz $n\times n$ reference state matrix for the reference state
$x^r_t\in\R^n$, $B_r$ is a known $n\times\ell$ reference input matrix, and $r_t\in\R^\ell$ is a
bounded reference input. Here again, we assume that $K_x$ and $K_r$ can be directly calculated 
from known $A$ and $B$, and used directly in the control law.

It is required that the nonlinearity satisfy the bound
\begin{equation}\label{eq:apl:epsf}
\norm{\epsilon_f(x)}_2 \ \leq \ \bar\varepsilon
\end{equation}
for some constant $\bar\varepsilon>0$ and for all $x\in B_0(r)$ with some radius $r>0$. Then,
the adaptive control law
$$
u_t \ = \ K_x^\top x_t - \Thetah_t^\top\!\Psi(x_t) + \left(1-\mu(x)\right)K_r^\top r_t + 
\mu(x)\uw(x_t)
$$
is shown to stabilize the state tracking error $e_t = x_t-x_t^r$ down to a compact set about the 
origin, where the $N\times\ell$ matrix of parameter estimates $\Thetah_t$ is dynamically updated 
with the usual law
\begin{equation*}
\dot{\Thetah}_t = \Gamma\,\Psi(x_t)\,e_t^\top P_xB \ .
\end{equation*}
The scalar function $\mu:\R^n\to[0,1]$
transitions the control law from tracking the reference input to simply returning the plant 
state $x_t$ to the bounded region $B_0(r)$ within which \eqref{eq:apl:epsf} is valid, using an 
appropriately defined $\uw(x_t)$ based on assumptions about the growth of $\epsilon_f(x)$ 
outside of $B_0(r)$. (See Chapter~12 of \cite{lavretsky2013robust} for details.)

And so, if the vector function $\Psi(x)$ is constructed with an 
activation 
function $\sigma$ satisfying the Lipschitz condition of Assumption~\ref{sigAsmpt} with constant 
$\Lsig$, then the above setup is valid for any nonlinearity $f = [f_1\ \cdots\ f_\ell]$ where we 
can show that
$$
\sup_{x\in\Kc}\abs{f_i(x)-\Theta_i^\top\Psi(x)} \ \leq \ \bar\varepsilon_i
$$
holds for some constants $\bar\varepsilon_1,\dots,\bar\varepsilon_\ell>0$. Here, 
$f_1,\dots,f_\ell:\R^n\to\R$ and each $\Theta_i^\top\in\R^N$ is the corresponding row of the 
true parameters $\Theta^\top$.
% !TEX root = 00-wollic.tex

\subsection{Belief states as objects}
Together, a logical theory and its interpretation constitute a \emph{state of belief}. They can be presented in the standard Tarskian format, where a theory is a quadruple of sorts, operations, predicates, and axioms, and its  interpretation is an inductively defined model  \cite{Chang-Keisler}. To streamline further constructions, we assume that each theory is presented as a categorical \emph{sketch}\/ and that its models are presented in extended functorial semantics 
\cite{AdamekJ:locpac,Ehresmann-Bastiani:sketches,MakkaiM:acccfc}. %A popular overview is \cite{BarrM:ttt}, where sketches are called \emph{theories}.

\begin{definition}\label{def:state}
A \emph{clone} $\Sigma$ is a cartesian category\footnote{We stick with the traditional terminology where a category is cartesian when it has cartesian products.} freely generated by sorts, operations, and equational axioms of a logical theory. A \emph{theory}\/ is a pair $\Theta=<\Sigma,\Gamma>$, where $\Sigma$ is a clone and $\Gamma$ is a set of cones and cocones in $\Sigma$, capturing the general axioms\footnote{The equational axioms can also be subsumed as cones or cocones, in which case they could be omitted from $\Sigma$ and it would boil down to the free category generated by sorts and operations.} of the logical theory. A \emph{model}\/ of $\Theta$ is a cartesian functor $\MMM\colon \Sigma \tto\Gamma \Set$ mapping the $\Gamma$-cones into limit cones and the $\Gamma$-cocones into colimit cocones. A \emph{state of belief} (or \emph{belief state}) is a triple 
\bear
A & = & \left<\Sigma_{A},\Gamma_{A}, \MMM_{A}\right> 
\eear
where $\Theta_{A} = \left<\Sigma_{A},\Gamma_{A}\right>$ is a theory and $\MMM_{A}$ its model in a category $\Set$ of sets and functions. An\/ element of the model $\MMM_{A}$ is called an \emph{observable} of the state $A$.
\end{definition}

\paragraph{Comment.} A belief state $A$ should not be thought of as a particular model $\MMM_A$ of the theory $\Theta_A$, but rather as the (accessible) category of all models of $\Theta_A$ consistent with $\MMM_A$. The model thus expresses the properties that may not be stated effectively\footnote{E.g., the set of all true statements of Peano arithmetic is expressed by its standard model, but most of them cannot be stated effectively.}. The described structure of the belief states can be refined to capture other features of theories in science and engineering, including statistical and  complexity-theoretic valuations \cite{RissanenJ:MDL,WallaceCS:MML}. While such refinements would have no real impact on our considerations, they signal that we are in the realm of \emph{inductive}\/ inference, which may feel unusual for the Tarskian formalism, usually concerned with the deductive aspects only. The fact that the theory $\Theta_{A}$ has a model $\MMM_{A}$ implies that the state of belief $A$ is logically consistent but it does not imply that it is true within an external frame of reference, a \emph{``reality''}\/ that may drive the state changes, i.e. the processes of extending and reinterpreting theories. A possible intuition is that observable elements of the model $\MMM_{A}$ may not be observed, or may be found to be incompatible with actual observations.

\paragraph{Examples.} Logical theories and their models, in any of the familiar formats, Tarskian, categorical, or statistical,  are obvious examples of belief states. They arise not only in natural sciences but also in social systems, e.g. as policy formalizations. Software specifications are formalized as logical theories even more often, and their implementations can then be presented as models. The functorial semantics view was spelled out in \cite{PavlovicD:FOPS}, used in a software synthesis tool \cite{PavlovicD:ASE01,PavlovicD:SDR,PavlovicD:AMAST08}, and applied in algorithm design \cite{PavlovicD:ManaFest,PavlovicD:MPC10}. The evolution of software components can thus be formalized in terms of evolving belief states.

\subsection{Belief transitions as morphisms}
Intuitively, a transition $f$ from a state $A$ to a state $B$ is a process transforming  $A$-observables to $B$-observables. We first consider \emph{state reinterpretations}\/ as transitions and then expand the perspective to \emph{state explanations}\/ as transitions.

\begin{definition}\label{Def:interpretable}
An \emph{interpretable belief transition}\/  $f\colon A\to B$ is a cartesian functor $f\colon \Sigma_{A}\ooot{\Gamma_{A}}{\Gamma_{B}} \Sigma_{A}$ mapping $\Gamma_{B}$-(co)cones to $\Gamma_{A}$-(co)cones and moreover making the following diagram compute
\beq\label{eq:def-intepretable}
\begin{tikzar}{}
\Sigma_{A}\ar{dr}[description]{\MMM_{A}} \&\& \Sigma_{B}\ar{dl}[description]{\MMM_{B}} \ar[bend right]{ll}[swap]{f}\\
\& \Set
\end{tikzar}
\eeq
where the models $\MMM_A$ and $\MMM_B$ also preserve, respectively, the $\Gamma_A$ and $\Gamma_B$ (co)cones. \end{definition}

\paragraph{\em Interpretations as assignment commands.} The structure of interpretable transitions between software specifications and the colimits of their diagrams were spelled out in  \cite{PavlovicD:FOPS,PavlovicD:ASE01}. Since the software specifications are finite, an interpretation $f\colon \Sigma_{A}\ot \Sigma_{B}$ boils down to a tuple of assignments 
\[x_{1}:=t_{1}\ ;\  x_{2}:=t_{2}\ ;\ldots;\  x_{n}:=t_{n}\]
of terms $\vec t=<t_{1}, t_{2},\ldots, t_{n}>$ from $\Sigma_{A}$ to variables $\vec x=<x_{1}, x_{2},\ldots, x_{n}>$ from $ \Sigma_{B}$ in such a way that, for each axiom $\gamma\in \Gamma_{B}$, the interpretation 
\bear
f(\gamma) &= & [\vec{x}:=\vec {t}]\gamma
\eear  
is a theorem derivable from the axioms in $\Gamma_{A}$. In terms of Hoare logic \cite{Hoare-logic}, an interpretable state transition $f\colon \Sigma_{A}\ot \Sigma_{B}$ is just a Hoare triple $\Theta_{A}\uev{\vec{x}:=\vec {t}} \Theta_{B}$. This triple was defined to be valid if and only if $\Theta_{A}\vdash [\vec{x}:=\vec {t}]\Theta_{B}$ holds, where $[\vec{x}:=\vec {t}]\Theta_{B}$ is the result substituting the $\Theta_{A}$-terms $\vec t$ for $\Theta_{B}$-variables $\vec x$ in all axioms $\gamma\in \Gamma_{B}$. The triple thus says that this substitution instance of $\Theta_{B}$ should be derivable in $\Theta_{A}$. Condition \eqref{eq:def-intepretable} moreover requires that this theory  reinterpretation recovers the model $\MMM_{B}$ from the model $\MMM_{A}$.

But the computational states required at the annotated program points cannot in general be transformed into one another by mere substitutions even in Hoare logic. The desired transitions from state to state are implemented by programs.

\paragraph{Updates, explanations, predictions.} Updating scientific theories, social policies, or general claims usually  transforms the current belief states in ways that do not boil down variable substitutions. A process that maps the observables from one belief state to another belief state may not even be observable. Computational processes use internal variables, intermediary types, and many computational operations besides the value assignments to  transform observable inputs of type $A$ into observable outputs of type $B$. An economic process may be claimed to increase employment rates in the general population by cutting taxes on the rich. Such causal links between two types of observables are explained by unobservable mental processes in two social groups and by hidden variables connecting them. A physical theory may transform observable classical measurements as inputs into observable  classical predictions as outputs using an internal model of unobservable quantum interactions. 

Intuitively, an explanation is not just a hypothesis that some observables cause some observed effects but also a model of an internal, possibly unobservable causal mechanism that leads from one to the other. The mechanism may be complex and the causal relations may be partial or nondeterministic. However, once some observed effects are explained by some observable causes, the observations of the causes can be used to predict the effects. The explanations input effects and output causes, whereas the predictions go the other way around. The explanations can then be tested by validating the predictions. If the explanations are specified effectively, the induced predictions are computable. Belief transitions provide a high-level view of both.


\begin{definition}\label{Def:explainable}
An \emph{explainable belief transition}\/  $f\colon A\to B$ is a cartesian functor  $f\colon \Theta_{A}\ooot{\Gamma_{A}}{\Gamma_{B}} \Theta_{B}$ mapping $\Gamma_{B}$-(co)cones to $\Gamma_{A}$-(co)cones and moreover making the following diagram commutes
\beq\label{eq:def-explainable}
\begin{tikzar}{}
\Theta_{A}\ar{dr}[description]{\overline\MMM_{A}} \&\& \Theta_{B}\ar{dl}[description]{\overline\MMM_{B}} \ar[bend right]{ll}[swap]{f}\\
\& \Set
\end{tikzar}
\eeq
where $\overline\MMM_A$ is the extension of $\MMM_A$ along the completion $\Sigma_A\inclusion \Theta_A$ along all limits and colimits generated by $\Gamma_A$; and ditto for $\overline\MMM_B$.
\end{definition}

\paragraph{Comment.} In Def.~\ref{Def:interpretable}, theories were presented as pairs $\Theta = <\Sigma,\Gamma>$, where the category $\Sigma$ presents sorts, operations, and equations of the theory, whereas $\Gamma$ presents predicates and imposes the axioms of the theory. In Def.~\ref{Def:explainable}, a theory $\Theta$ is presented as the category obtained by completing $\Sigma$ under the limits and colimits derived from $\Gamma$. This category with the distinguished family of cones and cocones generated from $\Gamma$ is now denoted $\Theta$, by abuse of notation. A detailed construction of this category, forming a canonical sketch with its distinguished cones and cocones, can be found in \cite[\S4.2--3]{MakkaiM:acccfc}. This category represents the set of all theorems derivable in the signature $\Sigma$ from the axioms $\Gamma$. Since $\Sigma \inclusion \Theta$ is the $\Gamma$-completion of $\Sigma$, any functor $\MMM:\Sigma\to\Set$ mapping the $\Gamma$-(co)cones in $\Sigma$ to (co)cones in $\Set$ has a unique $\Gamma$-preserving extension $\overline \MMM\colon \Theta\to \Set$. These extensions are displayed in \eqref{eq:def-intepretable}. The upshot of saturating the theory presentations in the form $\Theta=<\Sigma,\Gamma>$ used in Def.~\ref{Def:interpretable} to the categories that they generated, denoted again $\Theta$, is that the general explainable transitions are now expressed in terms of functors between such saturated categories, as displayed in \eqref{eq:def-intepretable}. 

\paragraph{\em Explanations as programs.} A theory $\Theta$ is derived from the signature or clone $\Sigma$ inductively, by applying the axioms or (co)cones $\Gamma$. If $\Sigma$ and $\Gamma$ are effectively given, then $\Theta$ can be effectively computed. The fact that the functor $f\colon \Theta_A\ot \Theta_B$ underlying a belief transition $f\colon A\to B$ maps $\Gamma_{B}$-(co)limits to $\Gamma_{A}$-(co)limits means that it is also built inductively and thus effectively from its restriction $\hat f\colon \Theta_{A}\ot \Sigma_{B}$ along $\Sigma_{B}\inclusion \Theta_{B}$. However, since there may be \emph{many different ways}\/ to map $\Gamma_{B}$-(co)limits to $\Gamma_{A}$-(co)limits, the functor $f\colon \Theta_A\ot \Theta_B$ is \emph{\textbf{not} uniquely determined}\/ by its restriction $\hat f\colon \Theta_{A}\ot \Sigma_{B}$. The logical intuition is that there may be many different ways to prove the axioms $\Gamma_{B}$ as theorems in $\Theta_{A}$ and many different logical justifications of a belief transition from $A$ to $B$. In summary, a explainable transition $f\colon A\to B$ is effective as long as $A$ and $B$ are effectively given, and its predictions are computable. \emph{The explanations that actually an explainable transition can be formalized as programs that compute its predictions.} If the semantics of a programming language $\EEE$ used for computing the predictions is expressed in terms of a dynamic logic assignment $\TTT^o\times \EEE\times \TTT\to \OOO$, where $\TTT$ is a suitable posetal collapse of the universe of theories, then the sketch morphism or theory mapping $f\colon \Theta_A\ot \Theta_B$ corresponds to a Hoare triple $\Theta_A\uev F\Theta_B$, where $F$ is a program for the computation $f$. 

\subsection{Monoidal category of belief states and transitions}
The belief states from Def.~\ref{def:state} and the belief transitions from Def.~\ref{Def:explainable} clearly form a category, which we will call $\UUU$. The monoidal structure is induced by the disjoint unions of theories:
\bea
A\otimes B & = & \Big<\Sigma_{A}+\Sigma_{B}\, ,\,  \Gamma_{A}+\Gamma_{B}\, ,\,  [\MMM_{A}+\MMM_{B}]
\Big>
\eea
where $\MMM_{A\otimes B} = [\MMM_{A}+\MMM_{B}]\colon \Sigma_{A}+\Sigma_{B} \tto{\Gamma_{A\otimes B}}\Set$ maps $\Sigma_{A}$ like $\MMM_{A}$ and $\Sigma_{B}$ like $\MMM_{B}$. The tensor unit is $I = \left<\bot, \bot, \emptyset\right>$, where the truth value $\bot$ denotes the inconsistent theory or sketch, its only axiom, and $\emptyset$ is its empty model. It obviously satisfies $I\otimes A = A = A\otimes I$. The associativity of the tensor $\otimes$ follows from the associativity of the disjoint union $+$. The arrow part of $\otimes$ is induced by the disjoint unions as coproducts. The coproduct structure equips every belief state $A$ with a cartesian comonoid structure
\begin{gather}\label{eq:dataserv-text}
 \ \ A\otimes A\  \oot{\ \ \ \ \Delta\ \  \ \ } A \tto{\ \  \ \scun\ \ \ } I\\
\Sigma_{A}+\Sigma_{A}\tto{\ [\id,\id]\ } \Sigma_{A}\oot{\ \ \bot\ \ } \bot\notag
\end{gather}
The observables can thus be cloned and erased, and the observations are repeatable and deletable, as required in science. However, $\UUU$ is not a cartesian category, and $\otimes$ is not a cartesian product, because the explainable belief transitions $f:A\to B$ are not always interpretable, and do not boil down to the functors $\Sigma_{A}\ot \Sigma_{B}$. This captures the unclonable and undeletable states that arise in explanations of unobservable causations, e.g. in quantum physics and computation, or in economic and political theory and practice. Those that do form the cartesian subcategory $\tot\UUU\inclusion\UUU$, for which $\otimes$ is a cartesian product. The category $\tot\UUU$ consists of belief states from Def.~\ref{def:state} and the interpretable belief transitions from Def.~\ref{Def:interpretable}. If the elements $\alpha \in \UUU(I,A)$ are thought of as observables of type $A$, then the elements $a\in \tot \UUU(I,A)$ are actual observations, disproving some statements in $A$.


 


\subsection{String diagrams}
Commutative diagrams like \eqref{eq:def-intepretable} display composite morphisms and abbreviate their equations. String diagrams display the \emph{de}\/compositions of morphisms in monoidal categories. The two composition operations presented by monoidal categories are displayed along the two dimensions: the categorical composition is constrained by the strings and goes bottom-up, whereas the monoidal composition goes left-right, unconstrained by the strings. A morphism $A\tto f B$ is presented as a box $f$ with a string $A$ coming in at the bottom and a string $B$ coming out at the top. The identities are presented as invisible boxes and the identity on $A$ is just the string $A$. The unit type $I$ is presented as an invisible string, so there are boxes with no strings attached. The categorical composition $g\circ f =(A\tto f B\tto g C)$ is drawn by hanging the box $f$ on the string $B$ under the box $g$. The monoidal composition $(g\circ f)\otimes (s\circ t)$ is drawn by placing the boxes $g\circ f$ next to the boxes for $s\circ t$:
\beq\label{eq:godement}
\newcommand{\machine}{$f$}
\newcommand{\gee}{$g$}
\newcommand{\kee}{$s$}
\newcommand{\hee}{t}
\newcommand{\nameslang}{\scriptstyle B}
\newcommand{\seqcompp}{\scriptstyle {\color{red}g\circ f}}
\newcommand{\parcompp}{\scriptstyle {\color{blue}f\otimes t}}
\newcommand{\inputt}{\scriptstyle A} 
\newcommand{\outpt}{$\scriptstyle C$}
\newcommand{\otherinputt}{\scriptstyle U}
\newcommand{\otheroutpt}{\scriptstyle V} 
\newcommand{\outpttt}{$\scriptstyle W$}
\def\JPicScale{.3}
\input{PICS/godement.tex}
\eeq


The middle-two-interchange law $(g\circ f)\otimes(s\circ t) =  (g\otimes s)\circ(f\otimes t)$ corresponds to the two ways of reading the diagram: vertical-first and horizontal-first, marked by the red and the blue rectangle respectively. The cartesian comonoids \eqref{eq:dataserv-text} are drawn
\beq\label{eq:dataserv}
\begin{split}
%\begin{figure}[!ht]
%\begin{center}
\newcommand{\AAh}{\scriptstyle A}
\newcommand{\ccopy}{\cmn}
\newcommand{\delete}{\scun}
\def\JPicScale{.26} 
\input{PICS/dataserv-1.tex}
\end{split}
\eeq
and the equations that make them into commutative comonoids look like this:
\begin{alignat}{11}
%\comp {\cmn}{(\cmn \ttimes \id)}  &\ \ =\ \   \comp{\cmn}{(\id \ttimes \cmn)} &\quad&\quad&\quad&\quad&
%\comp{\cmn}{(\cun \ttimes\, \id)}  &\ \  =\ \  &\   \id  &\ \   =\ \  &\ \  \comp{\cmn}{(\id \, \ttimes \cun)}\notag
%\\[1ex]
\def\JPicScale{.65} \input{PICS/cmn-left-1.tex}\   &\ \ =\ \   \def\JPicScale{.65} \input{PICS/cmn-right-1.tex} &&\qquad\qquad&&& 
\def\JPicScale{.65} 
\input{PICS/cun-left-1.tex}  & \ = \ &\ \, \def\JPicScale{.65} \input{PICS/cun-id.tex} &\ \, = \ \ &  \def\JPicScale{.65} \input{PICS/cun-right-1.tex}&&\qquad\qquad&&&
\def\JPicScale{.65} \input{PICS/cmn.tex} &\   = \   \def\JPicScale{.65} \input{PICS/cmn-sym.tex} \hspace{2em}
\label{eq:comonoid}%\\%[1ex]
\notag
\end{alignat}
\smallskip

\paragraph{Paremetrized and updating transitions.} As usual, a product $A\otimes B$ denotes a situation where $A$ and $B$ occur together but remain separated and do not influence each other. In a diagram, they are just parallel strings. A transition $g\colon X\otimes A\to B$ depends on $X$ and $A$ separately whereas $q\colon X\otimes A\to X\otimes B$ moreover updates $X$ and outputs $B$ separately.
\beq\label{eq:gq}
\begin{split}
\newcommand{\fee}{g}
\newcommand{\qee}{q}
\newcommand{\Aee}{\scriptstyle X}
\newcommand{\Bee}{\scriptstyle A}
\newcommand{\Cee}{\scriptstyle B}
\def\JPicScale{.15}
\input{PICS/gq.tex} 
\end{split}
\eeq
Since its arguments are mutually independent, $g\colon X\otimes A\to B$ can be thought of as, say, an $X$-parametrized family of transitions $g_{x}\colon A\to B$. Since the output pairs can also be separated, $q\colon X\otimes A\to X\otimes B$ is often viewed as the pair
\beq
\sta q = \left(X\times A\tto q X\times B\tto{\id\times \scun} X\right)\quad \out q = \left(X\times A\tto q X\times B\tto{\scun\times \id} B\right)
\eeq
although they generally cannot be paired back together, since their sharing of side-effects is lost.
 

\documentclass{amsart} 
\input{preamble.tex}


\title[The Fundamental theorem of tropical differential algebra over nontrivially valued fields]{The Fundamental theorem of tropical differential algebra over nontrivially valued fields and the radius of convergence of nonarchimedean differential equations}

\author{Stefano Mereta}
\email{Stefano.Mereta@mis.mpg.de}
\address{Max Planck Institute for Mathematics in the Sciences, Inselstraße 22, 04103 Leipzig, Germany}
%\affiliation{Swansea University and Université Grenoble Alpes}

\date{\today}

\subjclass[2010]{Primary 14A20;
	Secondary 12H99, 12H25, 13N99, 14T05, 14T99}
\keywords{tropical geometry; algebraic differential equations; tropical differential equations; $p$-adic differential equations, idempotent semirings, fundamental theorem}

\begin{document}
	\begin{abstract}
		We prove a fundamental theorem for tropical differential equations analogue of the fundamental theorem of tropical geometry in this context. We extend results from Aroca et al. and from Fink and Toghani, working only in the case of trivial valuation as introduced by Grigoriev, to differential equations with power series coefficients over any valued field. To do so, a crucial ingredient is the framework for tropical differential equations introduced by Giansiracusa and Mereta. As a corollary of the fundamental theorem, the radius of convergence of solutions of a differential equation over a nontrivially valued field can be computed tropically.
	\end{abstract}
	\maketitle
	% \tableofcontents
	
	
	\section{Introduction}

 Differential equations are ubiquitous in the sciences from theoretical physics to ecology. While a great number of analytical and numerical methods to compute their solutions have been developed since Newton, purely algebraic methods are more recent and generally less developed. The last decade have seen a resurgence of interest in this topic. The theory is based mostly on the pioneering work of Ritt \cite{ritt} and Kolchin \cite{kolchin} on the development of differential algebra, that allows to study system of algebraic ordinary (and partial) differential equations by mean of algebraic tools, such as Gröbner bases, and the works of Macaulay and later Gröbner \cite{grobmac} on the use of differential operators in commutative algebra. This led to the implementation of software routines computing the symbolic solutions of system of linear PDEs (see for example \cite{ridamarc}, \cite{YaironMac}).
 
 Algebraic ODEs are differential equations formed from polynomial expressions in an
indeterminate function $f$ and its derivatives. This smaller class of equations has important applications in the natural sciences, such as
chemical reaction networks, and in pure mathematics where they appear in many parts of geometry. 

Tropical geometry is a fairly new area of algebraic geometry that started developing from the early 2000's and allows to move problems of algebro-geometric nature to a piecewise linear setting  via a valuation. Here methods from combinatorics and polyhedral geometry can be applied to study properties of the initial object. A comprehensive reference for tropical geometry is \cite{macsturm}. 





Tropical methods for algebraic differential equations were introduced for the first time in \cite{grig}. Here, the author defined tropical differential equations, their solutions, and a framework for tropicalizing algebraic ODEs over a ring of formal power series $\pk$ and their solutions. The field $K$ is endowed with the trivial valuation. Here one tropicalizes differential equations by recording the $t$-adic valuation
in each coefficient, and the tropicalization of power series solutions is performed by applying the trivial valuation of $K$ coefficientwise, i.e. recording their support. The same can also be adapted to the case of PDEs. 
Note that, when $K$ can be endowed with a nontrivial non-archimedean valuation, Grigoriev's tropicalization does not record any information about the valuation of the coefficients in a differential equation or a power series solution.  Thus all the information about convergence of power series solutions is lost.

In order to remedy this flaw and preserve finer information about the coefficients, in \cite{gianmereta} the authors abstracted the main features of Grigoriev's setting and introduced a framework that extends and refines it. This allows to perform a tropicalization that, in case the field $K$ has a non-trivial valuation (for example $K$ being the field of Puiseaux series or that of $p$-adic numbers) preserves the valuation of the coefficients of the solutions and of the equations. While in the aformentioned paper only results for ODEs are presented, a general framework for PDEs can also be developed, see \cite{tesimereta}.

Analogously to the fundamental theorem of tropical geometry \cite[Theorem 3.2.3]{macsturm} (also called Kapranov's theorem in the case of hypersurfaces, see \cite{kapranov}), one can ask if solutions to a differential equation tropicalize to solutions of its tropicalization, and if all the tropical solutions can be lifted back. For Grigoriev's setting this question has  been positively answered in the case of ODEs by Aroca et
al.~in \cite{aroca} (assuming $R$ is an uncountable algebraically closed field of
characteristic 0). These ideas have also been extended to the case of algebraic PDEs in \cite{sebastian}.

Furthermore, paralleling the role of Gr{\"o}bner theory in the non-differential setting, where a tropical variety is the set of weight vectors whose initial ideal does not contain any monomial, the authors of \cite{FT20} and \cite{hugao} define initial forms and develop a Gr{\"o}bner-theoretic approach to Grigoriev's framework. 

The main aim of the present work is twofold: develop a Gröbner theory analogous to the aformentioned in the general framework of \cite{gianmereta} and prove, by using the flexibility of this new environment, the following generalization to the nontrivially valued case of the fundamental theorem proven in \cite{aroca}:
\begin{thmA} [Fundamental theorem of tropical differential algebra]\label{theorem:fundamental-introduction}
		Let $K$ be an uncountable algebraically closed field of characteristic 0 and $v_K : K \rightarrow \T$ a valuation. Consider the differentially enhanced valuation $\mathbf{v}=(v,\widetilde{v})\co (\pk,d/dt) \to \mathbf{S}$.
		Let $I$ be a differential ideal in $\diff \pk n$, then the following sets are equal:
        \begin{enumerate}
        \item the tropicalization with respect to $\widetilde v$ of the set of solutions to $I$ in $\pk$;
        \item the solutions to the tropicalization with respect to $v$ of the differential ideal $I$;
        \item the set of tropical power series $S$ such that the initial ideal $In_S(I)$ of $I$ with respect to $S$ does not contain monomials.
        \end{enumerate}
	\end{thmA}
 All the objects appearing in the statement above will be introduced in the following. Theorem \ref{theorem:fundamental-introduction} will be proven in two parts, in Section \ref{section:theorem} and Section \ref{section:grobner}. The proof of the result above makes use of the fundamental theorem of tropical geometry and is a conceptual improvement of the proof of the fundamental theorem presented in \cite{aroca}.

Finally, we introduce a notion of radius of convergence for tropical solutions. We recall that the convergence of a power series with coefficients in a non-archimedean valued field is equivalent to the limit of the norms of the coefficients being 0. As the coefficients of a tropical solutions are tropical numbers, we can define a notion of convergence for such a tropical power series. Since the fundamental theorem above states the equality between the tropicalized solutions and the tropical ones, the following corollary follows:
\begin{corA}\label{corolla:intro}
The radius of convergence of the tropical solutions is equal to the radius of convergence of the classical solutions.
\end{corA}

The final goal that this paper aims to is to move the first steps towards the introduction of tropical techniques for the computation of the radius of convergence function of the solutions to differential equations over the $p$-adics (and in general over a nonarchimedean field), one of the central problems in the theory of $p$-adic differential equations. Indeed, an interesting feature of $p$-adic differential equations is that, in contrast to the complex case, the radius of convergence of their solutions is not controlled by some "visible" object, such as, in the complex case, the poles of the coefficients of the equation: in the $p$-adic world even equations as easy as that of the exponential give solutions with finite radius of convergence at any point. The topology of the space itself is an obstacle to the convergence. 
The language of Berkovich geometry, introduced in \cite{ber}, has proven to be the right one to describe phenomena related to this radii of convergence. The radius of convergence of the solutions of a $p$-adic differential equation on a Berkovich curve as a function of the expansion point has been proven to be a continuous piecewise linear function (see \cite{ christol1994modules, baldassarri2010continuity, baldassarri2007continuity, kedlaya}) with finitely many changes of slope \cite{christol2011radius, pulita2015convergence, pulita2015continuity,pulita2015convergence2, poineau2013convergence}, whose behaviour is actually controlled by a finite skeleton on which the curve retracts on. In general, although an explicit iterative formula to compute the radius of converge exists (see \cite{christol2011radius}), it is difficult to calculate it. A comprehensive reference for the subject is \cite{kedlaya}, see also \cite{librodwork, librorobba}.

 
\subsection*{Organisation of the paper} In Section \ref{section:tropdiffeq} we recall definitions and results of the theory of tropical differential equations, mainly in the language of \cite{gianmereta}, encompassing the theory of Grigoriev. In Section \ref{section:preliminaries} we introduce the objects we will need to prove the Fundamental theorem and give a proof of some preliminary results we will use later on. In Section \ref{section:theorem} we state and give a proof for the first equality of the theorem, i.e. that the set of solutions to the tropicalization of a differential equation and the set of tropicalizations of the classical solutions coincide. In Section \ref{section:raggi} we introduce the radius of convergence of a tropical power series and discuss Corollary \ref{corolla:intro}, giving an example of computation of tropical solutions to a differential equation. In Section \ref{section:grobner} we extend Gröbner theory to the differential nontrivially valued case and we conclude adding the second equality to the fundamental theorem, stating that the two sets above coincide with the set of weight vector whose initial ideals does not contain monomials. 

\subsection*{Acknowledgements}
The author would like to thank Jeff Giansiracusa for many helpful discussions and comments and Ángel David Ríos Ortiz for useful discussion on Section \ref{section:preliminaries}.
Finally, many thanks to MPI MiS Leipzig for the excellent working conditions and the stimulating mathematical environment.

	\section{Tropical differential equations} \label{section:tropdiffeq}

In this section we will give a short presentation of the framework in which tropical ordinary differential equations (also shortened as TDEs in the following) are considered and how tropicalization is defined for algebraic ODEs with coefficients in a differential ring $R$ and for their solutions. 

A \emph{differential ring} $(R,d_R)$ is a ring equipped with an additive map $d_R \co R \rightarrow R$ that satisfied the Leibniz rule. A \emph{differential algebra} $(A,d_A)$ over $R$ is a differential ring with a homomorphism $R \rightarrow A$ commuting with the differentials. For us, the main example of differential algebra over $R$ will be the differential ring of \emph{differential polynomials} in $n$ variables over the differential ring $(R,d_R)$, as introduced by Ritt in \cite{ritt}. It is defined as follows:
\[
\diff R n := (R[x_i^{(j)} \mid i=1, \dots, n ; j \in \N], d)
\]
where the differential $d$ extends $d_R$ and acts by sending $x_i^{(j)}$ to $x_i^{(j+1)}$. We will often write $x_i$ for $x_i^{(0)}$. When considering $R[x_i^{(j)} \mid i=1, \dots, n ; j \in \N]$ just as an $R$-algebra forgetting about its differential structure, we will denote it as  $\basic R n$: the reason for introducing this notation will be clear later, when we will introduce Ritt algebras over differential semirings.
An ideal $I$ of a differential ring is said to be a differential ideal if it is  closed with respect to the differential $d_R$.
Given a differential algebra $A$ over $R$, a solution in $A$ to the differential equation $f \in \diff R n$ is a $n$-tuple $a=(a_1, \dots, a_n) \in A^n$ such that plugging in $d_A^j(a_i)$ for $x_i^{(j)}$ in $f$ the result is $0$. We will denote as $\textup{Sol}_A(E)$ the set of solutions to a system of ODEs $E$ in $A$.



Let us now introduce the main objects in the theory of TDEs, in order to state their rigorous definition and make clear how to tropicalize an algebraic ODE to get a tropical one.
Among the several algebraic foundations for tropical geometry, such as  hyperfields
\cite{Viro, Baker-Bowler,Lorscheid-hyperfield,Jun-hyperfields, james}, Lorscheid's blueprints
\cite{Lorscheid-blueprints1,Lorscheid-scheme-theoretic}, and idempotent semirings
\cite{eqtrop,univtrop,GG3,Maclagan-Rincon-1,Maclagan-Rincon-2,Maclagan-Rincon-3,Mincheva-Joo-1,Betram-Easton,Yaghmayi,Noah-module-theoretic}, following the presentation developed in \cite{gianmereta} and \cite{tesimereta}, we will use the language of (differential) idempotent semirings. 

Let us recap the definition of semiring and of valuation and give some relevant examples: a \emph{semiring} $(S, \oplus, \odot)$ is an algebraic structure satisfying the same axioms as a ring, but the request of additive inverses. A semiring is \emph{idempotent} if $a \oplus a = a$ for all elements $a \in S$. The $\oplus $ operation on $S$ induces a
canonical partial order defined by $a \preceq b$ if $a \oplus b = b$. We will say that a sum in an idempotent semiring \emph{tropically vanishes} if the result of the sum after removing any one of the addends does not change.
\begin{ex}
\begin{enumerate}
\item The set $\B = \{0,\infty\}$ equipped with operations $\oplus := \min$ and $\odot := +$ is an idempotent semiring, called the idempotent semiring of Boolean numbers;
\item The set $\T = \R \cup \{\infty\}$ equipped with operations $\oplus := \min$ and $\odot: = +$ is an idempotent semiring, called the idempotent semiring of tropical numbers. It contains $\B$ as a subsemiring;
\item For every $n \ge 1$ let $\T_n = \R^n \cup \{\infty\}$ with $\oplus$ given by lexicographic minimum and $\odot := +$. It is an idempotent semiring.
\end{enumerate}
\end{ex}
\begin{oss}
    Notice that the partial order $\preceq$ induced by $\oplus := \min$ in the examples above is the opposite of the order $\le$ with respect to which we take the minimum.
\end{oss}
We adopt the following generalised definition of valuation, as introduced in \cite{eqtrop} and used in \cite{gianmereta}: a \emph{valuation} on a ring $R$ is an idempotent semiring $S$ and a map $v\co R \to S$ satisfying
\begin{enumerate}
\item	$v(0)  = 0_S$,
\item	$v(1) = v(-1) = 1_S$,
\item	$v(ab) = v(a) \odot v(b)$,
\item	$v(a+b) \oplus v(a) \oplus v(b)$ tropically vanishes (i.e. $v(a+b) \preceq v(a) \oplus v(b)$).
\end{enumerate}
Notice that a rank 1 valuation $v\co R \rightarrow \mathbb{T}$ can be extended to a rank 2 valuation on the the ring $R\{\!\{t\}\!\}$ of Puiseux series
(or the subrings of formal Laurent series, power series or polynomials) by the formula
\begin{equation}\label{eq:rank2valuation}
	a_0 t^{n_0} + \cdots \mapsto (n_0, v(a_0)) \in \mathbb{T}_2.
\end{equation}


Central to our treatement will be the notion of differential idempotent semiring.
Given an idempotent semiring $S$, an
additive map $d\co S \to S$ is said to be a \emph{tropical differential} if it satisfies the tropical Leibniz relations:  for any two elements  $x,y \in S$ the expression
\[
d(xy) \oplus xd(y) \oplus yd(x)
\]
tropically vanishes. Note that we can view the tropical Leibniz relations as the tropicalization of the usual Leibniz relations. Furthermore, as $S$ is an idempotent semiring, if $d\co S \to S$ satisfies the usual Leibniz rule, it is a tropical differential. In this case we will say that $d$ is a \emph{strict} tropical differential.


\begin{defin}
A \emph{differential (idempotent) semiring} is an idempotent semiring equipped with a tropical differential. We will say that a differential semiring is strict if its tropical differential is strict. A homomorphism of differential semiring is a homomorphism of semiring commuting with the differentials.
\end{defin}

The two main examples of differential semiring we will work with are the following:
\begin{ex}\label{ex:diffsemirings}
\begin{enumerate}
\item Consider the idempotent semiring $\pb$ of formal power series with boolean coefficients. Endowing it with the map $d$ defined by
\[
d_v(t^n) = \begin{cases} 
t^{n-1} & n \geq 1\\
\infty & n=0
\end{cases}
\]
we obtain a strict differential semiring. 
\item Consider the idempotent semiring of formal tropical power series $\pt$. Given a valuation $v\co \mathbb{N} \to \mathbb{T}$, there is a tropical differential $d_v$
defined by
\[
d_v(t^n) = \begin{cases} 
v(n)t^{n-1} & n \geq 1\\
\infty & n=0.
\end{cases}
\]
We will denote the differential semiring $(\pt, d_v)$ as $\pt_v$.
\end{enumerate}
\end{ex}

 As proved in \cite[Proposition 3.2.3]{gianmereta}, given a non-strict differential semiring $(S, d_S)$, there is no tropical differential $d$ on $\basic S n$ extending $d_S$ such that $(\basic S n, d)$ is the free differential algebra over  $S$ on $n$ generators. The definition of the differential semiring $(\diff S n , d)$ of differential polynomials over $(S,d_S)$ is quite convoluted and we are not going to recall it here, but  all the details can be found in \cite[Section 3.4]{gianmereta}. Furthermore, $\diff S n$ satisfies the desirable universal property, i.e.\ given a differential algebra $S'$ over $S$, the following bijection holds: 
\[
	\mathrm{Hom}_{S\textup{-Alg}}(S\{x_1, \ldots, x_n\}, S') \cong (S')^n.
\]
It is important to notice that this construction gives back Ritt's contruction when $d_S$ is a strict differential, so in particular for differential rings and $\pb$ the two definitions coincide. In general there is only an inclusion of algebras over $S$:
\[
    \basic S n \subset \diff S n .
\]
The central objects in the theory of TDEs are the so-called tropical pairs, playing in this theory an analogous role to that of rings and algebras in the theory of polynomial equations: 
\begin{defin}
A \emph{tropical pair} $\mathbf{S}$ is a homomorphism of idempotent semirings $\pi\co (S_1,d) \to S_0$, where $(S_1,d)$ is a differential semiring. We will say that $\mathbf S$ is strict if $S_1$ is a strict differential semiring. A morphism of pairs $\sigma$ from $(S_1\to S_0)$ to $(T_1
\to T_0)$ is a commutative diagram of idempotent semirings
\[
\begin{tikzcd}
S_1 \arrow[d] \arrow[r, "\sigma_1"] & T_1 \arrow[d] \\
S_0 \arrow[r, swap, "\sigma_0"]           & T_0          
\end{tikzcd}
\]
in which the upper horizontal arrow $\sigma_1$ is a morphism of differential idempotent semirings.
\end{defin}

The idea is that the domain $S_1$ of a pair represents a space of tropical functions, while the target $S_0$ is a space of leading coefficients for these functions. The map can be thought as sending elements of $S_1$ to their leading order. This will actually be the case for the instances considered in the following of this work. We introduce them in the following example:

\begin{ex}\label{ex:pairs}
\begin{enumerate}
    \item Consider $(\pb, d)$ as in point (1) of Example \ref{ex:diffsemirings}. The homomorphism $\Phi \co \pb \to \mathbb{T}$ defined by $t^n \mapsto n$ is a tropical pair. We will denote this pair by $\mathbf T$.

\item Consider $ \Phi\co \pt_v\to \mathbb{T}_2$, where the source has any of the differentials from point (2) of Example \ref{ex:diffsemirings} and the morphism $\Phi$ is given by
\[
	(a_{n_0} t^{n_0} + a_{n_1} t^{n_1} + \cdots) \mapsto (n_0, a_{n_0}).
\] 
It is a tropical pair that we will denote as $\mathbf S$.
\end{enumerate}
\end{ex}

Both the pairs considered in the example above are \emph{reduced}, following the terminology developed in \cite{gianmereta, tesimereta}. Here, we will not recall details about reduced pairs and the reduction functor. As all the pairs we will deal with are reduced, from now on, every instance of the word ``pair'' has to be intended as ``\emph{reduced} pair''. 

Given a pair $\mathbf{S}$, the category of $\mathbf{S}$-algebras is the category of pairs $\mathbf{T}$ under $\mathbf{S}$. A typical example of an $\mathbf S$-algebra is $\diff {\mathbf S} n$, the algebra of differential polynomials in $n$ variables over $\mathbf S$. It satisfies a universal property similar to that of Ritt's polynomials, see \cite[Proposition 4.1.4]{gianmereta}. This is the pair obtained as the reduction of the right vertical arrow of the following pushout diagram:
\begin{center}
\begin{tikzcd}
S_1 \arrow[r] \arrow[d] & S_1\{x_1, \ldots, x_n\} \arrow[d, dotted]\\
S_0 \arrow[r,dotted] & (S_0 | S_1)\{x_1, \ldots, x_n\}
\end{tikzcd}
\end{center}
As for the definition of $\diff S n$, we will not get in the detail of a concrete  realisation of the $S_0$-algebra $(S_0 | S_1)\{x_1, \ldots, x_n\}$: for our scope, it is enough to say that we have the following inclusion of $S_0$-algebras:
\[
    \basic {S_0} {n} \subseteq (S_0 | S_1)\{x_1, \ldots, x_n\}.
\]
which is an equality if and only if $S_1$ is a strict differential semiring. We can finally state formally the definition of tropical differential equation that we will use, and how solutions to such an equation look like:
\begin{defin}\label{defin:tropical-solutions}
    A tropical differential equation over the pair $\mathbf S = (S_1 \stackrel{\Phi}{\to} S_0)$ is an element of $f \in \basic {S_0} {n}$. A solution to $f$ in an $\mathbf S$-algebra $\mathbf T = (T_1 \stackrel{\Phi}{\to} T_0)$ is an element $\tau \in T_1^n$ such that by plugging in $\Phi(d^j (\tau_i))$ for $x_i^{(j)}$ in $f$ the result tropically vanishes. We will denote by $\textup{Sol}_{\mathbf T}(E)$ the set of solutions to a system $E$ in $\mathbf T$.
\end{defin}
Solutions to tropical differential equations can be seen as morphisms of quotient of pairs by bend congruences, as introduced in \cite{eqtrop}. For a precise statement see \cite[Proposition 4.5.1]{gianmereta} or \cite[Theorem 6.3.5 and Theorem 8.3.5]{tesimereta}.

Lastly, we describe how to tropicalize a system of ODEs with coefficients in a valued ring $v \co R \rightarrow \T$ to obtain the associated system of TDEs, and how to tropicalize its solutions. For systems of polynomial equations this is done via the valuation $v$, while here we need the more refined datum of a differential enhancement of a valuation. 

\begin{defin}
    Let $R$ be a ring and $S$ be an idempotent semiring. We say that a map $ \widetilde v \co R \rightarrow S$ is a \emph{submultiplicative seminorm} if:
    \begin{enumerate}
        \item $\widetilde v(0_R) = 0_S$ and $\widetilde v(1_R) = 1_S$;
        \item $\widetilde v(a+b) \preceq \widetilde v(a) \oplus \widetilde v(b)$;
        \item $\widetilde v(ab) \preceq \widetilde v(a) \odot \widetilde v(b)$.
    \end{enumerate}
\end{defin}

\begin{defin}
Given a differential ring $R$ and a valuation $v\co R \to S_0$ to an idempotent semiring $S_0$, a \emph{differential enhancement of $v$} is a reduced pair $\mathbf{S} = (S_1\to S_0)$ and a submultiplicative seminorm $\widetilde{v}\co R \to S_1$ such that:
\begin{enumerate}
\item for any $x\in R$, $d_{S_1} \widetilde{v}(x) = \widetilde{v}(d_R x)$;
\item the following diagram commutes:
\begin{center}
\begin{tikzcd}
& S_1 \arrow[d]  \\
R \arrow[ur, "\widetilde{v}"] \arrow[r, swap, "v"] & S_0 .
\end{tikzcd}
\end{center}
\end{enumerate}

We will use the term \emph{differentially enhanced valuation} $\mathbf{v}=(v,\widetilde{v})\co R \to \mathbf{S}$ to mean a seminorm $v$ together with a differential enhancement $\widetilde{v}$. 
\end{defin}

\begin{oss}
    The submultiplicative seminorm $\widetilde v$ restricts to a valuation on the subring of constants of the ring $R$, i.e.\ the subring of elements whose derivative is $0_R$. See \cite[Proposition 4.7.4]{gianmereta}. 
\end{oss}

The two examples of differential enhancement we will be focusing on in this paper are the following:
\begin{ex}\label{ex:diff-enhancements}
\begin{enumerate}
\item Let $v_{\text{triv}} \co K \rightarrow \B$ be a trivially valued field. The valuation obtained by extending the trivial valuation as in \ref{eq:rank2valuation} is the $t$-adic valuation $w \co \pk \to \T$. It admits a differential enhancement on the pair of point (1) of Example \ref{ex:pairs}:
\begin{center}
\begin{tikzcd}
& \pb \arrow[d] \\
\pk \arrow[ur, "\widetilde{w}"] \arrow[r, swap, "w"] & \mathbb{T} 
\end{tikzcd}
\end{center}
in which the map $\widetilde w$ sends a power series over $K$ to its coefficientwise trivial valuation.  This is the differentially enhanced valuation used by Grigoriev \cite{grig} in his framework and subsequent works
\cite{aroca,cotterill,sebastian,FT20}.
\item Let $v_K \co K \rightarrow \T$ be a nontrivially valued field and let $v \co \pk \rightarrow \T_2$ the extension of $v_K$ to $\pk$ as in \ref{eq:rank2valuation}. The valuation $v$ admits a differential enhancement
\begin{center}
\begin{tikzcd}
& \pt_{v_K} \arrow[d] \\
\pk \arrow[ur, "\widetilde{v}"] \arrow[r, swap, "v"] & \mathbb{T}_2 
\end{tikzcd}
\end{center}
to the pair of point (2) of Example \ref{ex:pairs}. Analogously as above, the map $\widetilde v$ is defined by coefficientwise application of $v_K$.
\end{enumerate}
\end{ex}
The second differential enhancement of the example above, allows us to keep track of the valuation of the coefficients of a power series in $\pk$. Notice that, for any valuation $v \co \N \rightarrow \T$, there is a morphism $\sigma$ of reduced pairs between the two pairs of Example \ref{ex:pairs}:
\begin{equation} \label{diagram:refined-to-grig}
\begin{tikzcd}
\pt_v \arrow[d] \arrow[r,"\sigma_1"] & \pb \arrow[d]\\
\mathbb{T}_2 \arrow[r, swap,"\sigma_0"] & \mathbb{T}
\end{tikzcd}
\end{equation}
given on the top by the sending all non-infinite coefficients to 0, and on the bottom by projection onto the first component. With notation as in Example \ref{ex:pairs}, this  makes the pair $\mathbf T$ into an $\mathbf S$-algebra. 
Furthermore, $\sigma$ sends the differentially enhanced valuation $\mathbf{v}$ to the $\mathbf{w}$ of Example \ref{ex:diff-enhancements}. Thus it is the link between the framework for TDEs as developed by Grigoriev in \cite{grig} and that of \cite{gianmereta}: the new framework refines Grigoriev's one and includes it as a special case, thus solutions for a differential equations in the refined setting are also solutions in Grigoriev's sense. 

Fixing a differentially enhanced valuation $\mathbf{v}=(v,\widetilde{v})\co (R,d) \to \mathbf{S}$ we are finally ready to define the differential tropicalization of a system of ODEs with coefficients in $R$ and its solutions:
\begin{enumerate}
\item We tropicalize points $r \in R^n$ via the map $\trop_{\widetilde v}\co R^n \to S_1^n$ defined by applying
$\widetilde{v}$ componentwise.
\item We tropicalize differential equations by applying $v$ coefficientwise to define a map 
\[
\trop_v\co \diff R n \to \basic {S_0} n.
\]
\end{enumerate}

In this context, given a differential ideal $I \subset \diff R n$, the statement of a fundamental theorem is the equality 
\[
	\textup{Sol}_{\mathbf S}(\trop_{v} (I)) = \trop_{\widetilde v}(\textup{Sol}_{R}(I)). 
\]
In case the differentially enhanced valuation considered is $\mathbf w$ of point (1) of Example \ref{ex:diff-enhancements}, i.e. that of Grigoriev's setting, this is the main result of \cite{aroca}. In general, the inclusion $\textup{Sol}_{\mathbf S}(\trop_{v} (I)) \subset \trop_{\tilde v}(\textup{Sol}_{R}(I))$ is known, as proven in \cite[Proposition 5.2.2]{gianmereta} (see also \cite[Proposition 7.1.5]{tesimereta} for a proof of this result in a more general formulation).

The main aim of the present work is to prove a fundamental theorem for the differential enhancement $\mathbf v$ of point (2) of Example \ref{ex:diff-enhancements}, and to develop a Gröbner theory for rank 2 valuation that allows us to extend and incorporate in the present theory the results of \cite{FT20} and \cite{hugao}.

\begin{oss}
    Notice that, using the notation of Example \ref{ex:diff-enhancements} and diagram \ref{diagram:refined-to-grig},  the following inclusion holds:
    \[
           \sigma_1 \left ( \textup{Sol}_{\mathbf S}(\trop_{v} (I))  \right)
           \subset 
            \textup{Sol}_{\mathbf T}(\trop_{w} (I))  
    \]
    and in general it is strict, as showed in \cite[Example 4.2.2]{gianmereta}. This is an evidence that the general framework developed in \cite{gianmereta} refines the previous one of Grigoriev.
\end{oss}
	









 

\section{Preliminary results}\label{section:preliminaries}\
Let us fix here the notation for the following. Let $K$ be an algebraically closed field of characteristic 0 endowed with a nontrivial valuation  $v_K \co K \rightarrow \T$, and let $v \co \pk \rightarrow \T$ be the valuation constructed from $v_K$ as in \ref{eq:rank2valuation}.
Fix the differentially enhanced valuation $\mathbf{v}=(v,\widetilde{v})\co (\pk,d/dt) \to \mathbf{S}$ of point (2) of Example \ref{ex:diff-enhancements}. Let $v_{\text{triv}} \co K \rightarrow \B\ \subset \T$ be the trivial valuation on $K$. Applying \ref{eq:rank2valuation} to this valuation we obtain the $t$-adic valuation $w \co \pk \rightarrow \T$. Fix the differentially enhanced valuation $\mathbf{w}=(w,\widetilde{w})\co (\pk,d/dt) \to \mathbf{T}$ of point (1) of Example \ref{ex:diff-enhancements}: this is the differential enhancement considered in Grigoriev's framework. Via the morphism $\sigma$ of diagram \ref{diagram:refined-to-grig} we endow $\mathbf S$ with the structure of a $\mathbf T$-algebra and we relate the two differential enhancements $\mathbf{w}$ and $\mathbf{v}$. We start by recalling some notation and objects from \cite{aroca} and extend their definition to the nontrivally valued case.

Let $I \subset \diff \pk n$ be a differential ideal. Considering $I$ as an infinite system of differential polynomials in $\diff {K(\!(t)\!)} n$, by \cite[page 21]{ritt}, there exist finitely many differential polynomials $f_1, \dots , f_s \in I$ such that the set of solutions to $I$ is equal to the set of solutions of $f_1, \dots , f_s$.

For $1 \le l \le s$ and $r \in \N$, set:
\[
        F_{l,r} :=(d^r f_l) \rvert _{t=0} \in 
        K[x_i^{(j)} \mid i=1, \dots, n ; j \in \N]
\]
and 
\[
    A_\infty := V \left (
    \{F_{l,r}\}_{\substack{1\le l \le s\\ r \in \N}} \right ) \subset \left ( K^\N \right )^n
\]
The map $\Psi \co \left ( K^\N \right )^n \rightarrow \pk^n$ defined as
\[
    a := \left ( (a_{1,j})_{j \in \N}, \dots , (a_{n,j})_{j \in \N} \right ) \mapsto
     \left ( \sum_{j =0}^\infty \frac{1}{j!} a_{1,j} t^j, \dots ,\sum_{j =0}^\infty \frac{1}{j!} a_{n,j} t^j\right )
\]
is a bijection. Furthermore, as proven in \cite[Lemma 6.1]{aroca}, given a differential polynomial $f \in \diff \pk n$ and $a \in \left ( K^\N \right )^n $ the following equality holds:
\[
        f \left (\Psi(a) \right ) = \sum_{r=0}^\infty \left ( \frac{1}{r!}\left (d^r(f) \right ) \rvert _{t=0}(a) \right) t^r .
\]
Thus we obtain:
\[\textup{Sol}_{\pk}(I) = \Psi(A_\infty).\]

For $m \in \N$, let $N_m$ be the smallest natural number such that 
\[
         F_{l,r} \in 
        K[x_i^{(j)} \mid i=1, \dots, n ; j \le N_m] \quad \text{ for all } 1 \le l \le s , \, 0\le r \le m
\]
and let
\[
        A_m:= V \left ( \{F_{l,r}\}_{\substack{1\le l \le s\\ 0\le r \le m} } \right ) \subset \left ( K^{N_m +1 } \right )^n.
\]
For $m \ge m' \ge 0$, let $\pi_{(m,m')} \co \left ( K^{N_m +1 } \right )^n \rightarrow \left ( K^{N_{m'} +1 } \right )^n$ be the projection morphism forgetting the last $N_m - N_{m'}$ entries of every vector.
We have
\[
    \pi_{(m,m')}(A_m) \subset A_{m'}
\]
and $A_\infty$ is the inverse limit of the system given by the sets $A_m$ and the maps $\pi_{(m,m')}$:
\[
    A_\infty = \varprojlim A_m.
\]

	\begin{defin}
		Let  $m\in \N$ and $S := (S_1, \dots , S_n) \in \pt^n$, where we write $S_i$ as $\sum{c_{i,j}} t^j $ for every $i = 1, \dots , n$. With this notation, we define: 
		\[
			(\mathbb{V}_\infty)_S^{v_{\triv}} := \left  \{(x_{i,j})_{\substack{i = 1, \dots, n \\ j \in \N}} \in \left ( K^{\N } \right )^n \bigmid v_{\triv}(x_{i,j}) = \sigma_1(c_{i,j}) \text{ for all } i,j \right   \}
		\]
		\[
			(\mathbb{V}_\infty)_S^{v_K}:= \left  \{
            (x_{i,j})_{\substack{i = 1, \dots, n \\ j \in \N}} \in \left ( K^{\N} \right )^n  \bigmid  v_K(x_{i,j}) = c_{i,j} + v_K(j!) \text{ for all } i,j \right \}
		\]
  and 
        \[
			(\mathbb{V}_m)_S^{v_{\triv}} := \left  \{(x_{i,j})_{\substack{i = 1, \dots, n \\ 0 \le j \le N_m}} \in \left ( K^{N_m +1 } \right )^n \bigmid v_{\triv}(x_{i,j}) = \sigma_1(c_{i,j}) \text{ for all } i,j \right   \}
		\]
		\[
			(\mathbb{V}_m)_S^{v_K} := \left  \{(x_{i,j})_{\substack{i = 1, \dots, n \\ 0 \le j \le N_m}} \in \left ( K^{N_m +1 } \right )^n  \bigmid  v_K(x_{i,j}) = c_{i,j} + v_K(j!) \text{ for all } i,j \right \}
         \]
    Furthermore, let 
    \[
    \left ( A_\infty \right )^{v_\triv}_S := A_\infty \cap (\mathbb{V}_\infty)_S^{v_{\triv}}
    \quad \quad 
    \left ( A_\infty \right )^{v_K}_S := A_\infty \cap (\mathbb{V}_\infty)_S^{v_K}
    \]
    and, for every $m \in \N$
    \[
    \left ( A_m \right )^{v_\triv}_S := A_m \cap (\mathbb{V}_m)_S^{v_\triv}  
    \quad \quad 
    \left ( A_m \right )^{v_K}_S := A_m \cap (\mathbb{V}_m)_S^{v_K}. 
    \]
	\end{defin}
 
	\begin{oss} \label{remark:trop-fibers-contained}
    The sets $(\mathbb{V}_m)_S^{v_{\triv}}$ and $(\mathbb{V}_m)_S^{v_K}$ are the fibers of the tropicalization with respect to $v_\text{triv}$ and $v_K$, respectively.
	Furthermore, for every $m \in \N$ the following inclusion holds:
	\[
			(\mathbb{V}_m)_S^{v_K}  \subseteq (\mathbb{V}_m)_S^{v_\text{triv}}  
	\] 
	and $(\mathbb{V}_m)_S^{v_\text{triv}} $ is a torus of dimension $L_m$ inside $ K^{(N_m +1) }$, with
	\[
		L_m := |\{ (i,j) \mid c_{i,j} \neq \infty \text{ and } j \le N_m +1\}|.
	\]
 \end{oss}

\begin{oss} \label{oss:solutions-A}
 In the case of trivial valuation, an element $S=(S_1, \dots , S_n) \in \pb^n$ is in  $\trop_{\widetilde w}(\textup{Sol}_{\pk}(I))$ if and only if there exists $a \in A_\infty$ such that $\trop_{\widetilde w}(\Psi(a)) = S$, i.e. if the set $\left ( A_\infty \right )^{v_\triv}_S $ is non-empty. 
 Analogously, in the nontrivially valued case, $S=(S_1, \dots , S_n) \in \pt^n_{v_K}$ is in  $\trop_{\widetilde v}(\textup{Sol}_{\pk}(I))$ if and only if the set $\left ( A_\infty \right )^{v_K}_S $ is non-empty. 
\end{oss}


For $m \ge m' \ge 0$, the following inclusions hold:
\[
    \pi_{(m,m')} \left ( (\mathbb{V}_m)_S^{v_{\triv}} \right ) \subset (\mathbb{V}_{m'})_S^{v_{\triv}} 
    \quad \quad 
    \pi_{(m,m')} \left ( (\mathbb{V}_m)_S^{v_K} \right ) \subset (\mathbb{V}_{m'})_S^{v_K} 
\]
and 
\[
    \pi_{(m,m')} \left ( \left ( A_m \right )^{v_\triv}_S \right ) \subset \left ( A_{m'} \right )^{v_\triv}_S
    \quad \quad 
    \pi_{(m,m')} \left ( \left ( A_m \right )^{v_K}_S \right ) \subset \left ( A_{m'} \right )^{v_K}_S
\]
The set $(A_\infty)_S^{v_K}$ (resp. $(A_\infty)_S^{v_\triv}$) is the inverse limit of the system given by the sets $(A_m)_S^{v_K}$ (resp. $(A_m)_S^{v_\triv}$) and the maps $\pi_{(m,m')}$. 

    \begin{lem}\label{Lemma:chevalley-norm}
        Let $S := (S_1, \dots , S_n) \in \pt^n_{v_K}$. For every $m \ge m' \ge 0$ the following equalities hold:
        \begin{equation}
            \pi_{(m,m')}((A_m)_S^{v_\triv}) = \pi_{(m,m')}(A_m) \cap  (\mathbb{V}_{m'})_S^{v_\triv}
        \end{equation}
        \begin{equation}
            \pi_{(m,m')}((A_m)_S^{v_K}) = \pi_{(m,m')}(A_m) \cap  (\mathbb{V}_{m'})_S^{v_K} = \pi_{(m,m')}((A_m)_S^{v_\triv}) \cap  (\mathbb{V}_{m'})_S^{v_K}.
        \end{equation}
        From this equalities and the fact that $ \pi_{(m,m')}((A_m)_S^{v_\triv})$ is Zariski constructible (thanks to Chevalley's theorem, see \cite{aroca}), it follows that $ \pi_{(m,m')}((A_m)_S^{v_K})$ is constructible with respect to the induced Zariski topology on $(\mathbb{V}_{m'})_S^{v_K}$.
    \end{lem}
    \begin{proof}
    Let $x = (x_{i,j}) \in (A_m)_S^{v_\triv}$ (resp. $x \in (A_m)_S^{v_K}$), then  $ \pi_{(m,m')}(x) \in A_{m'}$. As tropicalization commutes with projections, we obtain the desired equalities.
    \end{proof}
    
	

	The following Proposition will be an essential ingredient in the proof of the Fundamental Theorem:
	\begin{prop} \label{Prop:limit-empty-iff-some-empty}
		The set $(A_\infty)^{v_K}_S$ is nonempty if and only if $(A_m)^{v_K}_S$ is nonempty for all $m \in \N$.
	\end{prop}
    \begin{proof}
		Thanks to Lemma \ref{Lemma:chevalley-norm} the following is a nested sequence of Zariski constructible sets of $(\mathbb{V}_0)_S^{v_K}$:
	\[
    (\mathbb{V}_0)_S^{v_K} \supseteq (A_0)^{v_K}_S \supseteq \pi_{(1,0)} \left ((A_1)^{v_K}_S \right ) \supseteq \pi_{(2,0)} \left ((A_2)^{v_K}_S \right ) \supseteq \dots
	\]
	As the class of constructible sets form a Boolean algebra, taking the complement we get the following increasing sequence of Zariski constructible sets of $(\mathbb{V}_0)_S^{v_K}$:
	\[
		\emptyset \subseteq (\mathbb{V}_0)_S^{v_K}  \setminus (A_0)^{v_K}_S  \subseteq  (\mathbb{V}_0)_S^{v_K}  \setminus \pi_{(1,0)} \left ((A_1)^{v_K}_S \right ) \subseteq   (\mathbb{V}_0)_S^{v_K}  \setminus \pi_{(2,0)} \left ((A_2)^{v_K}_S \right ) \subseteq \dots
	\]

 
    Here we prove the opposite of the statement of the present Proposition, i.e.\ that $(A_\infty)^{v_K}_S$ is empty if and only if there exists and $m$ such that $(A_m)^{v_K}_S$ is empty. If there exists $m$ such that $(A_m)_S^{v_K}$ is empty, then clearly $(A_\infty)_S^{v_k}$ is empty.
    For the other implication, as in \cite[Remark 7.1]{aroca}, thanks to \cite[Proposition 5, page 198]{bourbaki} the set $(A_\infty)^{v_K}_S$ is empty if and only if $\cap_{i=0}^\infty \pi_{(i,0)} \left( (A_i)_S^{v_K} \right)$ is empty. This holds if and only if
    \[ \label{equation:empty}
    (\mathbb{V}_0)_S^{v_K}  
    = (\mathbb{V}_0)_S^{v_K}  \setminus \bigcap_{i=0}^\infty \pi_{(i,0)} \left( (A_i)_S^{v_K} \right)
    = (\mathbb{V}_0)_S^{v_K}  \setminus \left ( \bigcap_{i=0}^\infty \pi_{(i,0)}((A_i)_S^{v_\text{triv}}) \cap  (\mathbb{V}_{0})_S^{v_K} \right )
    \]
    where for the second equality we use Lemma \ref{Lemma:chevalley-norm}. The statement above is equivalent to
    \[
	(\mathbb{V}_0)_S^{v_K} = 
   \bigcup_{i=0}^\infty  (\mathbb{V}_0)_S^{v_K} \setminus \pi_{(i,0)}((A_i)_S^{v_\text{K}})   
        =
   \bigcup_{i=0}^\infty     (\mathbb{V}_0)_S^{v_K} \setminus
        \left( \pi_{(i,0)}((A_i)_S^{v_\text{triv}})  \cap  (\mathbb{V}_{0})_S^{v_K} \right )
	\]
    From the proof of \cite[Proposition 7.3]{aroca}, the above equality implies that there exists $m$ such that $(A_m)_S^{v_\text{triv}}$ is empty, which implies that $(A_m)_S^{v_K}$ is empty. 
    
    Thus, we have that the set $(A_\infty)^{v_K}_S$ is nonempty if and only if $(A_m)^{v_K}_S$ is nonempty for all $m \in \N$.
	\end{proof}	
	\section{Statement and proof of the first part of the fundamental theorem}\label{section:theorem}
	In this section we prove the equality between the first two sets in the statement of Theorem \ref{theorem:fundamental-introduction}:
		\begin{teorema} [Fundamental theorem of tropical differential algebra]\label{theorem:fundamental}
		Let $K$ be an uncountable algebraically closed field of characteristic 0 and $v_K : K \rightarrow \T$ a nontrivial valuation. Consider the differentially enhanced valuation $\mathbf{v}=(v,\widetilde{v})\co (\pk,d/dt) \to \mathbf{S}$, as above.
		Let $I$ be a differential ideal in $\diff \pk n$, then the following equality holds:
		\[
		\textup{Sol}_{\mathbf S}(\trop_{v} (I)) = \trop_{\tilde v}(\textup{Sol}_{\pk}(I)).
		\]
	\end{teorema}
	We introduce here the tropical counterpart to the map $\Psi$ defined above. It will be useful in the proof of the Fundamental theorem.
	\begin{defin}
	Let $\Psi_{\trop} : \T^\N \rightarrow \pt _{v_K}$ be the map defined by:
	\[
	\Psi_{\trop}((b_{j})_{j \in \N} ) = \sum_{j=0}^\infty (b_j - v_K(j!)) t^j.
	\]
	It is bijective with inverse defined as follows: 
	\[
		\Psi_{\trop}^{-1} (S) = \left ((d^j_{v_K} S)|_{t=\infty} \right )_{j\in \N}.
	\]
        We denote again by $\Psi_{\trop}$ the map $(\T^\N)^n \rightarrow \pt _{v_K}^n$ obtained by applying $\Psi$ coordinatewise.
    \end{defin}
	\begin{oss}
	    The map $\Psi_{\trop}$ makes the following diagram commute: 
	\begin{center}
		\begin{tikzcd}
			K^\N \arrow[r, "\Psi"] \arrow[d,  swap, "v_K"]& \pk \arrow[d, "\tilde v"] \\
			\T^\N \arrow[r, swap, "\Psi_\trop"] & \pt_{v_K}.
		\end{tikzcd}
	\end{center}
	\end{oss}
Let us set some notation for the following. Given a differential polynomial $f \in \diff {\pk}{n}$ of order less than or equal to $r \in \N$, let us write it as $f(x) = \sum_{\lambda \in \Lambda} A_\lambda x^\lambda$ where $\Lambda$ is a finite set of matrices in $\text{Mat}_{r \times n}(\N)$, $A_\lambda$ is an element of $\pk$ for every $\lambda$ and $x^\lambda$ is the differential monomial defined as $ \prod_{i,j}  ( x_i^{(j)}  ) ^{\lambda_{i,j}}$. 
Analogously, the tropicalization of $f$ with respect to $v$ can be written as 
\[
			\sum_{\lambda \in \Lambda} (\alpha_{\lambda} \text{, } \beta_{\lambda}) M_\lambda
            \in \basic {\T_2} n
\] 
for the same $\Lambda$ and for $(\alpha_{\lambda} \text{, } \beta_{\lambda}) \in \R^2$ for every $\lambda$.

Given a differential monomial $M_\lambda$ of order $\le r$, we will denote as $M_\lambda(S)$ its evaluation at an element $S \in \pt_{v_K}$, as in Definition \ref{defin:tropical-solutions} when we see $M_\lambda$ as an element of $\basic {\T_2} n$. Given instead an element $B \in (\T^r)^n$, the notation $M_\lambda(B)$ will denote the usual evaluation of $M_\lambda$ at $B$, seeing $M_\lambda$ as an element of $\T[x_i^{(j)} \mid i= 1, \dots , n; j \le r]$, where we forget about the differential relations between the variables. We extend this notation to polynomials in $\basic {\T_2} n$ and $\T[x_i^{(j)} \mid i= 1, \dots , n; j \le r]$, respectively.  To make this clearer, we give an example here:
\begin{ex}
    Let $M = xx^{(3)}$, $S = 0t + 1t^3 \in \pt_{v_3}$. Taking the projection on the first four coordinates of $\Psi_\trop(S) = (\infty, 0, \infty, 2, \infty, \dots) \in \T^\N$ we obtain the vector $B = (\infty, 0, \infty, 2) \in \T^4$. Using Definition \ref{defin:tropical-solutions}, we obtain:
    \[
        M(S) = \Phi(S) \odot \Phi(d^3(S)) = (1,0)\odot(0,2) = (1,2) \in \T_2.
    \]
    Evaluating $M$ at $B$ we obtain instead:
    \[
        M(B) = B_0 \odot B_3 = \infty \odot 2 = \infty \in \T.
    \]
\end{ex}

The following Lemma is the core of the proof of Theorem \ref{theorem:fundamental}:
\begin{lem}
\label{Lemma:truncation-is-solution}
		For every $m \in \N$, let $\pi_m: (\T^\N)^n  \rightarrow (\T^{N_m +1})^n$ be the projection sending every entry to its first $N_m +1$ coordinates. The following inclusion holds for every $m \in \N$: 
		\[
		 \pi_m \circ \Psi_\trop^{-1} \left (   \textup{Sol}_{\mathbf S}(\trop_{v} (I)) \right ) \subseteq  V^{\trop} \left ( \left \{\trop_{v_K}(F_{l,r}) \right \}_{\substack{l=1, \dots , s \\ 0 \le r \le m}} \right ).
		\]
	\end{lem}
	\begin{proof}
		Let $S = (S_1, \dots , S_n) \in  \text{Sol}_{\mathbf S}(\trop_{v} (I))$ and write $S_i$ as $\sum_{j=0}^\infty c_{i,j} t^j$ for all $i = 1, \dots , n$.  Let 
		\[
		B_m = (B_{m,1}, \dots, B_{m,n})  :=	\pi_m \circ \Psi_\trop^{-1} (S)  \in (\T^{N_m+1})^n
		\]
		 where $B_{m,i} = (b_{i,j})_{0 \le j \le N_m }$ with $ b_{i,j}:=c_{i,j} + v_K(j!)$.
		
		As $S \in  \text{Sol}_{\mathbf S}(\trop_{v} (I))$, in particular $S \in  \text{Sol}_{\mathbf S} (   \{ \trop_{v}(d^r f_l) \}_{\substack{l=1, \dots , s \\ 0 \le r \le m}} )$ and every $\trop_{v}(d^r f_l)$ is an element of $\basic {\T_2} n$ where only the variables  $x_i^{(j)}$ for  $j \le N_m$ appear.
		For every $r$ and $l$, let us write $\trop_{v}(d^r f_l)$ as
		\[
			\sum_{\lambda \in \Lambda_{l,r}} (\alpha_{l,r,\lambda} \text{, } \beta_{l,r,\lambda}) M_\lambda
		\] 
		for some finite set $\Lambda_{l,r} \subset \text{Mat}_{N_m \times n}(\N)$ and differential monomials $M_\lambda$. Let $\Lambda_{l,r}^{0} :=\{\lambda \in \Lambda_{l,r} \mid  \alpha_{l,r,\lambda} = 0\}$.
		The tropicalization $\trop_{v_K}(F_{l,r})$ of the polynomial $F_{l,r}$ with respect to $v_K$, for every $r$ and $l$, is equal to
		\[
			\sum_{\lambda \in \Lambda_{l,r}^0} \beta_{l,r,\lambda} M_\lambda.
		\]
		Let us prove now that $B_m$ is a solution for $\trop_{v_K}(F_{l,r})$ for every $l = 1, \dots ,s$ and $0 \le r \le m$. 
		If the set $\Lambda_{l,r}^{0}$ is empty, the polynomial $F_{l,r}$ is identically 0 and $B _m$ is a solution for its tropicalization. So we can assume $\Lambda_{l,r}^{0}$ to be nonempty. Furthermore, notice that if for some $\lambda$ we have $M_\lambda(S) = (\alpha, \beta)$ with $\alpha > 0$ then $M_\lambda(B_m) = \infty$. Indeed, if $M_\lambda(S) = (\alpha, \beta)$ with $\alpha > 0$ then at least one of the variables appearing in $M_\lambda$, say $x_i^{(j)}$, when evaluated at $S$, assumes a value in $\T_2$ whose first coordinate is strictly positive. This means that the leading term of $d^j(S_i)$ is not the 0-th one or, equivalently, that the $j$-th coefficient of $S_i$ (i.e. $c_{i,j}$) is $\infty$. Thus, the evaluation of $M_\lambda$ at $B_m$ is equal to $\infty$.

        Let $\mathcal M :=\{\lambda \in \Lambda_{l,r} \mid M_\lambda (S) = (0 \text{, }\beta_\lambda) \text { for some } \beta_\lambda \in \R\}$. From the discussion above we can assume without loss of generality that the intersection $\Lambda_{l,r}^{0} \cap \mathcal M$ is not empty, as otherwise $B_m$ is trivally a solution for $\trop_{v_K}(F_{l,r})$ . This implies that 
		\[
 			\trop_{v}(d^r f_l)(S) = \bigoplus_{\lambda \in \Lambda_{l,r}^{0} \cap \mathcal M} (0 \text{, } \beta_{l,r,\lambda}) M_\lambda (S) = (0 \text{, } \beta)
		\]
        for some $\beta \in \R$. For every $\lambda \in \Lambda_{k,l}^{0} \cap \mathcal M$ we have
        \begin{align*}
				M_{\lambda}(S) &=  \bigodot_{\substack{i=1, \dots , n \\ 0 \le j \le N_m}}  \left ( \Phi(d^j(S_i)) \right ) ^{\odot \lambda_{i,j}} = 
				\bigodot_{\substack{i=1, \dots , n \\ 0 \le j \le N_m}} \left ( (0 \text{, } c_{i,j} \odot v_K(j!))  \right )^{\odot \lambda_{i,j}} = \\
				&
                = \bigodot_{\substack{i=1, \dots , n \\ 0 \le j \le N_m}} \left ( (0 \text{, }b_{i,j})  \right )^{\odot \lambda_{i,j}} =
                \left ( 0 \text{, } \bigodot_{\substack{i=1, \dots , n \\ 0 \le j \le N_m}} b_{i,j}^{ \odot \lambda_{i,j}} \right ) 
                = \left ( 0 \text{, } 
                M_{\lambda}(B_m)
                \right ) .
		\end{align*}
        As $S$ is a solution for $\trop_{v}(d^r f_l)$, the value $(0, \beta)$ is attained at least twice, i.e. there exist two matrices of exponents $\mu, \nu \in \Lambda_{k,l}^{0} \cap \mathcal M$ such that 
        \[
            (0,\beta) = \left ( 0 \text{, } 
                \beta_{l,r,\mu} \odot M_{\mu}(B_m)
                \right ) 
                =
                \left ( 0 \text{, } 
                \beta_{l,r,\nu} \odot M_{\nu}(B_m)
                \right ) .
        \]
        This implies that for every $m \in \N$, $l = 1, \dots , s$ and $0 \le r \le m$, the element $B_m$ is a solution for $\trop_{v_K}(F_{l,r})$, proving the desired statement.
        \end{proof}

	
	 We are now ready to prove the fundamental theorem:

	\begin{proof}[Proof of Theorem \ref{theorem:fundamental}]
		The inclusion $	\text{Sol}_{\mathbf S}(\trop_{v} (I)) \supseteq \trop_{\tilde v}(\text{Sol}_{\pk}(I))$ holds by \cite[Proposition 5.2.2]{gianmereta} (or more generally by \cite[Proposition 7.1.5]{tesimereta}), thus we are left to prove the other inclusion. 
		
		
		
		For every $m \in \N$ by the Fundamental Theorem of Tropical Geometry \cite[Theorem 3.2.5]{macsturm}, the following equality holds: 
		\[
			\trop_{v_K}(A_m) = V^{\trop} \left ( \left \{\trop_{v_K}(F_{l,r}) \right \}_{\substack{l=1, \dots , s \\ 0 \le r \le m}} \right ).
		\]
		Let $S \in 	\text{Sol}_{\mathbf S}(\trop_{v} (I))$. From Lemma \ref{Lemma:truncation-is-solution}, we have, for all $m \in \N$:
		 \[
		 \pi_m \circ \Psi_\trop^{-1}(S) \in V^{\trop} \left ( \left \{\trop_{v_K}(F_{l,r}) \right \}_{\substack{l=1, \dots , n \\ 0 \le r \le m}} \right ) = \trop_{v_K}(A_m) 
		 \]
		which implies that for every $m \in \N$ there exists an element $x \in A_m$ whose tropicalization is $ \pi_m \circ \Psi_\trop^{-1}(S)$, i.e. $x \in (A_m)_S$. Finally, thanks to Proposition \ref{Prop:limit-empty-iff-some-empty} and Remark \ref{oss:solutions-A}, the set $(A_m)_S$ being nonempty for all $m\in \N$ is equivalent to $S \in  \trop_{\tilde v}(\text{Sol}_{\pk}(I))$.
	\end{proof}

\section{The radius of convergence of solutions to a nonarchimedean differential equation}\label{section:raggi}

In this section we introduce a notion of radius of convergence for elements of $\pt$. Then, given a nontrivially valued field
$K$, we state a corollary of Theorem \ref{theorem:fundamental} relating this tropical notion of radius of convergence to the classical one for solutions of a differential equation over $\pk$.

\begin{defin}\label{definition:conv-radius}
    Given $A = \sum_{i=0}^n a_i t^i \in \pt$, we define its radius of convergence with respect to the real number $c > 1$ as:
    \[
        r_c(A):= \sup \{r \in [0,\infty) \mid \lim_{i \to +\infty} c^{-a_i} r^i = 0\} \in [0,\infty]
    \]
    with the convention that $c^{- \infty} = 0$ for any $c > 1$.
\end{defin}

\begin{oss}
    Notice that choosing any other real number $c'$ in the definition above gives the following relation between the radii of convergence of a tropical power series $A$:
    \[
        r_c(A) = r_{c'}(A) ^{\frac{1}{\log_c(c')}}.
    \]
\end{oss}
Let us consider now a field $K$ equipped with a nontrivial valuation $v_K \co K \rightarrow \T$, and assume the valuation $v$ has a section. For every $x \in K$, the norm on $K$ associated to $v_K$ is defined as $|x|_{K}:=c ^{-v_K(x)}$ for some $c > 1$. Canonical choices for $c$ are $c:=p$ when $v$ is the $p$-adic valuation for some prime number $p$ and $c:=e$ when $v$ is the $t$-adic valuation. 

Given a power series $A = \sum_{i=0}^n a_i t^i  \in \pk$ its radius of convergence is defined as follows: 
\[
        r(A):= \sup \{r \in [0,\infty) \mid \lim_{i \to +\infty} |a_i|_{K} r^i = 0\} \in [0,\infty].
\]
It is clear that, endowing $\pk$ with the differentially enhanced valuation $\mathbf{v}$, for every $A \in \pk$ we have the equality:
\[
    r(A) = r_{c}(\trop_{\widetilde v}(A)).
\]
where $c$ is chosen to be the same of the definition of $| \! -  \! |_{K}$. 
Thus the following corollary of the Fundamental Theorem follows directly:

\begin{cor}
    Let $I \in \pk\{x\}$. Then:
    \[
        \{r(A) \mid A \in \textup{Sol}_{\pk}(I)\} = \{r_{c}(S)  \mid S \in \textup{Sol}_{\mathbf{S}}(\trop_v(I))\}.
    \]
\end{cor}
We give here an example of computation of the solutions of the tropicalization of a linear $p$-adic differential equation.
\begin{ex}\label{ex:p-adic-diffeq}
Let $p$ a prime number and consider the differential enhancement $\mathbf v$ as above for $K=\C_p$ endowed with the $p$-adic valuation. Let $\zeta \in \C_p$ such that $\zeta^{p-1} = -p$, and consider the equation $f = x' - p \zeta t^{p-1} x  \in \C_p\{x\}$. $p$-adic solutions at the origin to this equations are $p$-adic multiples of $\exp( \zeta t^p) = \sum_{n =0}^\infty (1/n!) (\zeta t^p)^n \in \C_p[\![t]\!]$. The interest of this $p$-adic differential equation lies in the fact that it is somehow the easiest example for which we can observe the piecewise linear behaviour of the radius of convergence as a function of the distance of the expansion point from the origin. In particular, $\exp( \zeta t^p)$ has radius of convergence 1 but there exists an $r > 1$ such that for solutions at $|x|_p > r$ the radius of convergence decreases. Let us see a concrete example of a computation of the solutions to a linear tropical differential equation, by computing the set of solutions to the tropicalization of the generators (as an ideal) of the differential ideal generated by $f$. 

One can prove by induction that $n$-th derivative of $f$ can be expressed as: 
\begin{equation*}
d^n f =
\begin{cases*}
x^{(n+1)} - \sum_{i=0}^n  \binom{n}{i} \zeta \prod_{k=0}^{n-i} (p-k) t^{p-1-n+i} x^{(i)} & if $n < p$ \\
x^{(n+1)} - \sum_{i=0}^{p-1} \binom{n}{p-1-i} \zeta \prod_{k=0}^{p-1-i} (p-k) t^{p-1-i} x^{(i+n-p+1)}  & if $n \ge p$
\end{cases*}
\end{equation*}
which implies: 
\begin{equation*}
\trop_v(d^n f ) =
\begin{cases*}
x^{(n+1)} + \sum_{i=0}^n (p-1-n+i, v_p( \binom{n}{i}) + \frac{p}{p-1})  x^{(i)}& if $n < p$ \\
x^{(n+1)} + \sum_{i=0}^{p-1}  (i, v_p( \binom{n}{p-1-i}) + \frac{p}{p-1})  x^{(i+n-p+1)}    & if $n \ge p$
\end{cases*}
\end{equation*}
We prove that a solution $S= \sum_{k=0}^\infty s_k t^k$ to the tropical system $\{\trop_v(d^n f)\}_{n \in N}$ is of the form $cA$, where $c \in \T$ and $A = \sum_{k=0}^\infty a_k t^k \in \pt_{v_p}$ for:
\begin{equation*}
a_k =
\begin{cases*}
\infty & if $p \ndiv k$ \\
\frac{m}{p-1} - v_p(m!)  & if $k = mp$
\end{cases*}
\end{equation*}
i.e. that $A$ is the tropicalization of $\exp (\zeta t^p)$ and the set of solutions to $\trop_v(I)$ is a tropical linear space as expected. We prove this by induction on $k$. For $k=0$ this is trivially satisfied as $p \mid 0$ and $0 = \frac{0}{p-1} - v_p(0!)$. For $0 < k \le p$, consider $\textup{trop}(f) = x' + (p-1, \frac{p}{p-1})x$ and 
\[
\textup{trop}_v(f)(A) = (0, a_1) \oplus \left (p-1, \frac{p}{p-1} \right) .
\]
As $A$ a solution, $a_k$ has to be equal to $\infty$ for every $0 < k < p$, thus we obtain: 
\[
\textup{trop}_v(f)(A) = (p-1, a_p +1) \oplus \left ( p-1, \frac{p}{p-1} \right )
\]
which gives $a_p = \frac{1}{p-1} = \frac{1}{p-1} - v_p(1!) $.


In general, let  $Mp < k \le (M+1)p$ for some $M \in \N$ and assume the inductive hypothesis holds for $Mp$. Notice that $v_p \left ( \binom{Mp}{p-1-i} \right )= 1$ for all $M \in \N$ and for all $i \in \{0, \dots , p-2\}$, thus:
\[
\trop_v(d^{Mp}f) = x^{(Mp+1)} + \left ( p-1, \frac{p}{p-1} \right ) x^{(Mp)} +  \sum_{j=1}^{p-1}  \left ( p-1-j, \frac{p}{p-1} +1 \right )  x^{(Mp- j)}
\] 
where $j:=i-p+1$.  We obtain that $\trop_v(d^{Mp}f) (A)$ is equal to:
\begin{equation*}
\begin{split}
& \left ( 0, a_{Mp+1} + \sum_{m=1}^M v_p(mp) \right ) \oplus   \left ( p-1, \frac{p}{p-1} \right ) \odot \left  ( 0, \frac{M}{p-1} - v_p(M!) +  \sum_{m=1}^M v_p(mp) \right )  \oplus \\
&  \bigoplus_{j=1}^{p-1}  \left ( p-1-j, \frac{p}{p-1} +1 \right ) \odot \left (j  ,   \frac{M}{p-1} - v_p(M!) + \sum_{m=1}^{M} v_p(mp)  \right )\\
\end{split}
\end{equation*}
As the first coordinate of every addendum of the sum above, except for the first one, is equal to $p-1$ and $A$ is a solution, we have as before that $a_k$ has to be equal to $\infty$ for $Mp < k < (M+1)p$. For $k=(M+1)p$, since the following holds:
\[
\sum_{m=1}^M v_p(mp) = \sum_{m=1}^M ( 1+ v_p(m) ) = M + v_p(M!)
\]
we have:
\begin{equation*}
\begin{split}
\trop_v(d^{Mp}f) (A) = & \left ( p-1, a_{(M+1)p} + M+1 +v_p((M+1)!) \right ) \oplus    \left  ( p-1 , \frac{M +p}{p-1} + M  \right )  \oplus \\
&  \oplus \left ( p-1 , \frac{M +p}{p-1}   + M +1 \right )\\
\end{split}
\end{equation*}
which gives:
\[
a_{(M+1)p} +1 +v_p((M+1)!) = \frac{M +p}{p-1} .
\]
The last equality implies $a_{(M+1)p}= \frac{M +1}{p-1} - v_p((M+1)!)$. Lastly, it is easy to check that every tropical multiple of $A$ is again a solution to the tropical system $\{\trop_v(d^n f)\}_{n \in N}$, as these are linear equations.
\end{ex}
    \begin{oss}
    Notice that in Example \ref{ex:p-adic-diffeq} above we also proved that $\{f\} \subset I$ is a \emph{tropical differential basis} for $I$, in the sense of \cite[Definition 4.1]{FT20}, i.e. a set $G \subset I$ such that 
    \[
        \textup{Sol}_{\mathbf{S}}(\trop_v(I)) = \bigcap_{g \in G} \bigcap_{k \in \N}\textup{Sol}_{\mathbf{S}}(\trop_v(d^k g)).
    \]
    In the same paper the authors, working in Grigoriev's setting, give an example of a differential ideal $I$ generated by linear forms such that its tropical differential basis is not finite, in contrast with the analogous notion for systems of polynomial equations (see \cite[Theorem 2.6.6]{macsturm}).
    \end{oss}
    This work moves the first steps towards the development of methods using tropical techniques to compute the radius of convergence function, without a priori knowing the solutions to the differential equation. To this aim, it is necessary to introduce a notion of tropical differential basis satisfying a finiteness condition as in the classical case, or at least find criteria for finiteness of basis as above to hold and methods to identify such collections. This, at least in the linear case, would make similar computation as above possible, without knowing how the solutions over $\pk$ look like.
    Furthermore, the methods we explain here are only useful to compute single values of the radius of convergence function, thus a way to tropically move the point of expansion has to be developed in order to capture the global behaviour of this function.
    The author intends to pursue both these direction of research in the near future.
 \section{Initial forms with respect to tropical power series weight vectors} \label{section:grobner}

In this section we introduce the definition of initial form of an element of $\diff {K(\!(t)\!)}{n}$ with respect to a vector of tropical power series $S \in \pt^n_{v_K}$. This will be a generalization of the notions introduced in \cite{FT20} (and, slightly differently, in \cite{hugao}) to the nontrivially valued case. This theory is the differential counterpart to the theory of Gröbner basis over a nontrivially valued field as explained for example in \cite{macsturm}. We will prove the second equality of Theorem \ref{theorem:fundamental-introduction}. 

We observe that if the valuation $v_K \co K \rightarrow \T$ has a section then the corresponding extended valuation $v \co K(\!(t)\!) \rightarrow \T_2$ has a section as well. Indeed, denoting as $\pi_K$ the uniformizer for $v_K$, the map $\varphi \co \T_2 \rightarrow K(\!(t)\!)$ sending $(\alpha, \beta)$ to $\pi_K^\beta t^\alpha \in K(\!(t)\!)$ for every $(\alpha, \beta) \in \R^2$ and $\infty$ to $0$ is a section for the valuation $v$. Furthermore let $R := \{x \in K(\!(t)\!) \mid v(x) \ge (0,0)\}$ and $\mathfrak m :=\{x \in K(\!(t)\!) \mid v(x) > (0,0)\} = \langle t, \pi_K \rangle$, they are respectively a ring and the maximal ideal of this ring. Let $k$ denote the residue field $R/\mathfrak m$: it is isomorphic to the residue field of $K$ with respect to $v_K$. We will write $\overline x \in k$ for the residue class of an element $x \in R$. 
\begin{oss}
Notice that, by contrast to the trivially valued case, the ideal generated by $t$ in $\pk$ is not maximal, in fact $R/\langle t \rangle$ is isomorphic to the ring of integers $R_K := \{x \in K \mid v_K(x) \ge 0\}$ of the valued field $K$. 
\end{oss}
If $f \in \diff {K(\!(t)\!)}{n}$ has coefficients in $R$, let $\overline f \in \diff k n$ be the differential polynomial obtained by taking the residue class of the coefficients of $f$.
Given $S := (S_1, \dots , S_n) \in \pt^n_{v_K}$, for $\Phi(d^j S_i)\neq \infty$ let $(\alpha_{i,j}, \beta_{i,j}) := \Phi(d^j S_i)$ for every $j \in \N$. Accordingly, for $\trop_v(f)(S) \neq \infty$, let $(\alpha, \beta) := \trop_v(f)(S)$. 

We are now ready to give the definition of initial form of $f$ with respect to $S$.

\begin{defin} \label{definition:initial}
    Let $S \in \pt^n_{v_K}$ and $f \in \diff {K(\!(t)\!)}{n}$ as above. Writing $f = \sum_{\lambda \in \Lambda} A_\lambda \prod_{i,j}(x_i^{(j)})^{\lambda_{i,j}}$, we define:
    \[
    h_S := \varphi  \left ( (-\alpha, - \beta)  \right ) \sum_{\lambda \in \Lambda} A_\lambda \prod_{i,j} \left ( \varphi  \left ( (\alpha_{i,j}, \beta_{i,j})  \right )  x_i^{(j)} \right) ^{\lambda_{i,j}} \in \diff R n.
    \] 
    The initial form $in_S(f) \in \diff k n$ of $f$ with respect to $S$ is defined as follows:
    \[
    in_S(f) :=
        \begin{cases}
            \overline {h_S}   & \text{if $\trop_v(f)(S) \neq \infty$} \\
            & \\
            0 & \text{if $\trop_v(f)(S) = \infty$}
        \end{cases}
    \]
\end{defin}

\begin{oss}\label{oss:initial}
    It is easy to verify that there is at least one coefficient in the differential polynomial $h_S$ above with valuation $(0,0)$, thus $in_S(f) = 0$ if and only if $\trop_v(f)(S) = \infty$. Indeed
    \begin{align*}
				h_S & :=  \varphi  \left ( (-\alpha, - \beta)  \right ) \sum_{\lambda \in \Lambda} A_\lambda \prod_{i,j} \left ( \varphi  \left ( (\alpha_{i,j}, \beta_{i,j})  \right )  x_i^{(j)} \right) ^{\lambda_{i,j}} = \\
                & = \varphi  \left ( (-\alpha, - \beta)  \right ) \sum_{\lambda \in \Lambda} A_\lambda \prod_{i,j}  \varphi  \left ( (\alpha_{i,j}, \beta_{i,j})  \right )   ^{\lambda_{i,j}}  x^\lambda
	\end{align*}
    thus the valuation of the coefficient of $x^\lambda$ in $h_S$ is
    \[
    (-\alpha, -\beta) \odot v(A_\lambda) \odot \bigodot_{i,j} (\alpha_{i,j}, \beta_{i,j})^{\odot \lambda_{i,j}}. 
    \]
    As $(\alpha, \beta) = \trop_v(f)(S)$ is the minimum among the evaluation in $S$ of the monomials of $f$, i.e. the minimum among the elements $v(A_\lambda) \odot \bigodot_{i,j} (\alpha_{i,j}, \beta_{i,j})^{\odot \lambda_{i,j}}$, this proves that the coefficients of the polynomial $h_S$ are elements of $R$. In particular, the only coefficients with valuation $(0,0)$ are those of the monomials where $\trop_v(f)(S)$ is attained.
\end{oss}

\begin{defin}
    Let $I \subseteq \diff \pk n$ be a differential ideal, then the initial ideal of $I$ with respect to $S$ is the (algebraic) ideal: 
    \[
        In_S(I):=\langle in_S(f) \mid f \in I \rangle \subseteq \diff k n
    \]
\end{defin}

\begin{oss}
As already noticed in \cite[Example 3.5]{FT20}, given $f \in I$ in general we have 
\[d(in_S(f)) \neq in_S(df).\]
\end{oss}
We now generalize \cite[Lemma 2.6]{hugao} and \cite[Lemma 3.8]{FT20} to the non-trivially valued setting:
\begin{lem} \label{lemma:initial}
    Let $I \subseteq \diff \pk n$ be a differential ideal, for every $F \in In_S(I)$ there exists $f \in I$ such that $ F = in_S(f)$. 
\end{lem}
\begin{proof}
    As in Definition \ref{definition:initial}, for all $j \in \N$ such that $\Phi(d^j S_i)\neq \infty$, let $(\alpha_{i,j}, \beta_{i,j}) := \Phi(d^j S_i)$.
    Given $F \in In_S(I)$, we can write it as  $\sum_{\lambda \in \Lambda} a_\lambda x^\lambda in_S(f_\lambda)$ for some $a_\lambda \in k$ and $f_\lambda \in I$. Let 
    \[
        (\alpha_\lambda, \beta_\lambda):=\trop_v(f_\lambda)(S) \quad \quad 
        (\alpha'_\lambda, \beta'_\lambda):= (\alpha_\lambda, \beta_\lambda) + \sum_{i,j}\lambda_{i,j}  (\alpha_{i,j}, \beta_{i,j})
    \]
    and 
    \[
        f := \sum_{\lambda \in \Lambda} A_\lambda \varphi \left ((-\alpha_\lambda, -\beta_\lambda) \right ) x^\lambda f_\lambda
    \]
    for elements $A_\lambda \in \pk$ such that $v(A_\lambda) = (0,0)$ and $\overline {A_\lambda} = a_\lambda$. Notice that $\trop_{v}(f)(S) = (0,0)$.
    
    We claim that the initial form of $f$ with respect to $S$ is $F$. Let us compute $in_S(f)$:
    \begin{align*}
    in_S(f) = \overline {h_S} &  
    = \overline {\varphi  \left ( (0,0) \right ) \sum_{\lambda \in \Lambda} A_\lambda \varphi \left ((-\alpha'_\lambda, -\beta'_\lambda) \right ) \prod_{i,j} \left ( \varphi  \left ( (\alpha_{i,j}, \beta_{i,j})  \right )  x_i^{(j)} \right) ^{\lambda_{i,j}} f_\lambda \left ( \varphi \left ( (\alpha_{i,j}, \beta_{i,j})  \right )  x_i^{(j)} \right)} = \\
    & =  \overline{ \sum_{\lambda \in \Lambda} A_\lambda \varphi \left ((-\alpha'_\lambda, -\beta'_\lambda) \right ) \prod_{i,j} \left ( \varphi  \left ( (\alpha_{i,j}, \beta_{i,j})  \right )  \right ) ^{\lambda_{i,j}}  x^\lambda f_\lambda \left ( \varphi \left ( (\alpha_{i,j}, \beta_{i,j})  \right )  x_i^{(j)} \right ) }= \\
    & = \sum_{\lambda \in \Lambda} \overline{A_\lambda  \varphi \left ((-\alpha_\lambda, -\beta_\lambda) \right )  f_\lambda \left ( \varphi \left ((\alpha_{i,j}, \beta_{i,j})  \right )  x_i^{(j)} \right)  x^\lambda }   .\\
    \end{align*}
    As $\overline{A_\lambda} = a_\lambda$ by definition and $\overline{ \varphi \left ((-\alpha_\lambda, -\beta_\lambda) \right ) f_\lambda \left ( \varphi \left ((\alpha_{i,j}, \beta_{i,j})  \right )  x_i^{(j)} \right) }$ is the initial form of $f_\lambda$ with respect to $S$, we have
    \[
        in_S(f) = \sum_{\lambda \in \Lambda} a_\lambda x^\lambda in_S(f_\lambda) = F
    \]
    that proves the claim.
\end{proof}

We can now add the set $\{S \in \pt^n \mid In_S(I) \text{ does not contain a monomial}\}$ to the equality of Theorem \ref{theorem:fundamental} to complete the proof of Theorem \ref{theorem:fundamental-introduction}:

\begin{teorema}\label{theorem:fundamental-initial}
Under the same hypothesis of Theorem \ref{theorem:fundamental}, the following equalities hold:
\[
         \trop_{\tilde v}(\textup{Sol}_{\pk}(I)) =
         \textup{Sol}_{\mathbf S}(\trop_{v} (I)) =
        \{S \in \pt^n \mid In_S(I) \text{ does not contain a monomial}\}
\]
\end{teorema}

\begin{proof}
        We will prove the equality  $\textup{Sol}_{\mathbf S}(\trop_{v} (I)) =
        \{S \in \pt^n \mid In_S(I) \text{ does not contain a monomial}\}$. Let us start from the "$\subseteq$" inclusion. Given $S \in \textup{Sol}_{\mathbf S}(\trop_{v} (I))$, by definition, for every $f \in I$, the value $\trop_v(f)(S)$ is equal to $\infty$ or it is attained at least at two monomials. From Remark \ref{oss:initial} we know that, in either case, $in_S(f)$ is not a monomial, for every $f \in I$. The ideal $In_S(I)$ cannot contain any monomial: indeed if $F \in In_S(I)$ is a monomial, then from Lemma \ref{lemma:initial}, there exists $f \in I$ such that $in_S(f) = F$ is a monomial, and that contradicts the fact that $S$ is a solution for $\trop_{v} (I)$.
        
        For what concerns the opposite inclusion, assume by contradiction that there exists $S$ such that $In_S(I)$ contains no monomial, but $S$ is not a solution for $\trop_{v} (I)$. Then there would exist a polynomial $f \in I$ such that the minimum in $\trop_v(f)(S)$ is attained at a single monomial. Thus, again, thanks to the discussion of Remark \ref{oss:initial}, $in_S(f)$ is a monomial, which is a contradiction as $In_S(I)$ contains no monomials. This concludes the proof.
\end{proof}
\begin{ex}
Fix a prime number $p$ and consider again the equation $f = x' - p \pi t^{p-1} x  \in \C_p\{x\}$ of Example \ref{ex:p-adic-diffeq} and let $S = \sum_{n=0}^\infty a_n t^n \in \pt_{v_p}$ be the tropical power series with coefficients
\begin{equation*}
a_n =
\begin{cases*}
\infty & if $p \ndiv n$ \\
\frac{m}{p-1} - v_p(m!)  & if $n = mp$.
\end{cases*}
\end{equation*}
As proven in the aformentioned example, $S$ is a solution for the tropicalization of the differential ideal $I$ generated by $f$. Thus the initial ideal $In_S((f))$ does not contain monomials. Let us compute the initial of $f$ with respect to $S$. The tropicalization of $f$ is $\trop_v(f) = x' + (p-1 \text{, } p/(p-1))x$. The evaluation of $\trop_v(f)$ in $S$ gives  $(p-1 \text{, } p/(p-1))$ attained at both monomials. Thus:
\[
    in_S(f) = x' + x \in \diff k n.
\]
\end{ex}
	
\newcommand{\etalchar}[1]{$^{#1}$}
	\begin{thebibliography}{CCRH{\etalchar{+}}21}
		
		\bibitem[AGT16]{aroca}
		Fuensanta {Aroca}, Cristhian {Garay}, and Zeinab {Toghani}.
		\newblock {The fundamental theorem of tropical differential algebraic
			geometry}.
		\newblock {\em {Pac. J. Math.}}, 283(2):257--270, 2016.
		
		\bibitem[Bal10]{baldassarri2010continuity}
		Francesco Baldassarri.
		\newblock Continuity of the radius of convergence of differential equations on
		p-adic analytic curves.
		\newblock {\em Inventiones mathematicae}, 182(3):513--584, 2010.
		
		\bibitem[BB19]{Baker-Bowler}
		Matthew Baker and Nathan Bowler.
		\newblock Matroids over partial hyperstructures.
		\newblock {\em Adv. Math.}, 343:821--863, 2019.
		
		\bibitem[BDV07]{baldassarri2007continuity}
		Francesco Baldassarri and Lucia Di~Vizio.
		\newblock Continuity of the radius of convergence of p-adic differential
		equations on berkovich analytic spaces.
		\newblock {\em arXiv preprint arXiv:0709.2008}, 2007.
		
		\bibitem[BE17]{Betram-Easton}
		Aaron {Bertram} and Robert {Easton}.
		\newblock {The tropical Nullstellensatz for congruences}.
		\newblock {\em {Adv. Math.}}, 308:36--82, 2017.
		
		\bibitem[Ber90]{ber}
		Vladimir~G. Berkovich.
		\newblock {\em Spectral theory and analytic geometry over non-Archimedean
			fields}.
		\newblock American Mathematical Soc., 1990.
		
		\bibitem[Bou04]{bourbaki}
		Nicolas Bourbaki.
		\newblock Theory of sets.
		\newblock In {\em Theory of Sets}, pages 65--129. Springer, 2004.
		
		\bibitem[CCRH{\etalchar{+}}21]{YaironMac}
		Justin Chen, Yairon Cid-Ruiz, Marc H{\"a}rk{\"o}nen, Robert Krone, and Anton
		Leykin.
		\newblock Noetherian operators in macaulay2.
		\newblock {\em arXiv preprint arXiv:2101.01002}, 2021.
		
		\bibitem[CD94]{christol1994modules}
		Gilles Christol and Bernard Dwork.
		\newblock Modules diff{\'e}rentiels sur les couronnes.
		\newblock In {\em Annales de l'institut Fourier}, volume~44, pages 663--701,
		1994.
		
		\bibitem[CGL20]{cotterill}
		Ethan Cotterill, Cristhian Garay, and Johana Luviano.
		\newblock Exploring tropical differential equations.
		\newblock arXiv:2012.14067, 2020.
		
		\bibitem[CGM20]{Noah-module-theoretic}
		Colin {Crowley}, Noah {Giansiracusa}, and Joshua {Mundinger}.
		\newblock {A module-theoretic approach to matroids}.
		\newblock {\em {J. Pure Appl. Algebra}}, 224(2):894--916, 2020.
		
		\bibitem[Chr11]{christol2011radius}
		Gilles Christol.
		\newblock The radius of convergence function for first order differential
		equations.
		\newblock {\em Advances in non-Archimedean analysis}, 551:71--89, 2011.
		
		\bibitem[CR94]{librorobba}
		Gilles Christol and Philippe Robba.
		\newblock {\em Equations différentielles p-adiques}.
		\newblock Hermann, 1994.
		
		\bibitem[DGS16]{librodwork}
		Bernard Dwork, Giovanni Gerotto, and Francis~J Sullivan.
		\newblock {\em An Introduction to G-Functions.(AM-133), Volume 133}, volume
		133.
		\newblock Princeton University Press, 2016.
		
		\bibitem[EKL06]{kapranov}
		Manfred Einsiedler, Mikhail Kapranov, and Douglas Lind.
		\newblock Non-archimedean amoebas and tropical varieties.
		\newblock {\em J. Reine Angew. Math.}, 2006.
		
		\bibitem[EMHS22]{ridamarc}
		Rida~Ait El~Manssour, Marc H{\"a}rk{\"o}nen, and Bernd Sturmfels.
		\newblock Linear pde with constant coefficients.
		\newblock {\em Glasgow Mathematical Journal}, pages 1--26, 2022.
		
		\bibitem[FGH{\etalchar{+}}20]{sebastian}
		Sebastian {Falkensteiner}, Cristhian {Garay}, Mercedes {Haiech}, Marc~Paul
		{Noordman}, Zeinab {Toghani}, and Fran\c{c}ois {Boulier}.
		\newblock {The fundamental theorem of tropical partial differential algebraic
			geometry}.
		\newblock In {\em {Proceedings of the 45th international symposium on symbolic
				and algebraic computation, ISSAC '20, Kalamata, Greece, July 20--23, 2020}},
		pages 178--185. ACM, 2020.
		
		\bibitem[FT20]{FT20}
		Alex Fink and Zeinab Toghani
		\newblock Initial forms and a notion of basis for tropical differential
		equations.
		\newblock arXiv:2004.08258, 2020.
		
		\bibitem[GG14]{univtrop}
		Jeffrey Giansiracusa and Noah Giansiracusa.
		\newblock The universal tropicalization and the berkovich analytification.
		\newblock {\em arXiv preprint arXiv:1410.4348}, 2014.
		
		\bibitem[GG16]{eqtrop}
		Jeffrey Giansiracusa and Noah Giansiracusa.
		\newblock Equations of tropical varieties.
		\newblock {\em Duke Math. J.}, 165(18):3379--3433, 2016.
		
		\bibitem[GG18]{GG3}
		Jeffrey Giansiracusa and Noah Giansiracusa.
		\newblock A {G}rassmann algebra for matroids.
		\newblock {\em Manuscripta Math.}, 156(1-2):187--213, 2018.
		
		\bibitem[GM21]{gianmereta}
		Jeffrey Giansiracusa and Stefano Mereta.
		\newblock A general framework for tropical differential equations.
		\newblock {\em arXiv preprint arXiv:2111.03925}, 2021.
		
		\bibitem[Gol13]{golan}
		Jonathan~S Golan.
		\newblock {\em Semirings and their Applications}.
		\newblock Springer Science \& Business Media, 2013.
		
		\bibitem[{Gri}17]{grig}
		Dima {Grigoriev}.
		\newblock {Tropical differential equations}.
		\newblock {\em {Adv. Appl. Math.}}, 82:120--128, 2017.
		
		\bibitem[Gr{\"o}10]{grobmac}
		Wolfgang Gr{\"o}bner.
		\newblock On the macaulay inverse system and its importance for the theory of
		linear differential equations with constant coefficients.
		\newblock {\em ACM Communications in Computer Algebra}, 44(1/2):20--23, 2010.
		
		\bibitem[HG21]{hugao}
		Youren Hu and Xiao-Shan Gao.
		\newblock Tropical differential gr{\"o}bner bases.
		\newblock {\em Mathematics in Computer Science}, 15(2):255--269, 2021.
	
		\bibitem[JM18]{Mincheva-Joo-1}
		D\'aniel {Jo\'o} and Kalina {Mincheva}.
		\newblock {Prime congruences of additively idempotent semirings and a Nullstellensatz for tropical polynomials}.
		\newblock {\em {Selecta Mathematica}}, 24:2207--2233, 2018.
		
		\bibitem[{Jun}21]{Jun-hyperfields}
		Jaiung {Jun}.
		\newblock {Geometry of hyperfields}.
		\newblock {\em {J. Algebra}}, 569:220--257, 2021.
		
		\bibitem[Ked10]{kedlaya}
		Kiran~S Kedlaya.
		\newblock {\em p-adic Differential Equations}, volume 125.
		\newblock Cambridge University Press, 2010.
		
		\bibitem[Kol73]{kolchin}
		Ellis~Robert Kolchin.
		\newblock {\em Differential algebra \& algebraic groups}.
		\newblock Academic press, 1973.
		
		\bibitem[Lor12]{Lorscheid-blueprints1}
		Oliver Lorscheid.
		\newblock The geometry of blueprints: {P}art {I}: {A}lgebraic background and
		scheme theory.
		\newblock {\em Adv. Math.}, 229(3):1804--1846, 2012.
		
		\bibitem[Lor15]{Lorscheid-scheme-theoretic}
		Oliver Lorscheid.
		\newblock Scheme-theoretic tropicalization.
		\newblock arXiv:1508.07949, 2015.
		
		\bibitem[Lor19]{Lorscheid-hyperfield}
		Oliver Lorscheid.
		\newblock Tropical geometry over the tropical hyperfield.
		\newblock arXiv:1907.01037, 2019.
		
		\bibitem[Max21]{james}
		James Maxwell.
		\newblock Generalising kapranov's theorem for tropical geometry over
		hyperfields.
		\newblock {\em arXiv preprint arXiv:2108.01524}, 2021.
		
		\bibitem[Mer22]{tesimereta}
		Stefano Mereta.
		\newblock A general framework for tropical differential equations.
		\newblock {\em https://cronfa.swan.ac.uk/Record/cronfa61189}, PhD thesis,
		Swansea University and Université Grenoble Alpes, 2022.
		
		\bibitem[MR18]{Maclagan-Rincon-2}
		D.~Maclagan and F.~Rinc\'on.
		\newblock Tropical ideals.
		\newblock {\em Compos. Math.}, 154(3):640--670, 2018.
		
		\bibitem[MR20a]{Maclagan-Rincon-1}
		D.~Maclagan and F.~{Rinc\'on}.
		\newblock {Tropical schemes, tropical cycles, and valuated matroids}.
		\newblock {\em {J. Eur. Math. Soc. (JEMS)}}, 22(3):777--796, 2020.
		
		\bibitem[MR20b]{Maclagan-Rincon-3}
		D.~{Maclagan} and F.~{Rinc{\'o}n}.
		\newblock Varieties of tropical ideals are balanced.
		\newblock arXiv:2009.14557, 2020.
		
		\bibitem[MS21]{macsturm}
		Diane Maclagan and Bernd Sturmfels.
		\newblock {\em Introduction to tropical geometry}, volume 161.
		\newblock American Mathematical Society, 2021.
		
		\bibitem[Pay08]{payneanal}
		Sam Payne.
		\newblock Analytification is the limit of all tropicalizations.
		\newblock {\em arXiv preprint arXiv:0805.1916}, 2008.
		
		\bibitem[PP13]{poineau2013convergence}
		J{\'e}r{\^o}me Poineau and Andrea Pulita.
		\newblock The convergence newton polygon of a $ p $-adic differential equation
		iii: global decomposition and controlling graphs.
		\newblock {\em arXiv preprint arXiv:1308.0859}, 2013.
		
		\bibitem[PP15a]{pulita2015continuity}
		J{\'e}r{\^o}me Poineau and Andrea Pulita.
		\newblock Continuity and finiteness of the radius of convergence of a p-adic
		differential equation via potential theory.
		\newblock {\em Journal f{\"u}r die reine und angewandte Mathematik (Crelles
			Journal)}, 2015(707):125--147, 2015.
		
		\bibitem[PP15b]{pulita2015convergence}
		J{\'e}r{\^o}me Poineau and Andrea Pulita.
		\newblock The convergence newton polygon of a p-adic differential equation ii:
		Continuity and finiteness on berkovich curves.
		\newblock {\em Acta Mathematica}, 214(2):357--393, 2015.
		
		\bibitem[Pul15]{pulita2015convergence2}
		Andrea Pulita.
		\newblock The convergence newton polygon of a p-adic differential equation i:
		Affinoid domains of the berkovich affine line.
		\newblock {\em Acta Mathematica}, 214(2):307--355, 2015.
		
		\bibitem[{Rit}55]{ritt}
		Joseph~Fels {Ritt}.
		\newblock {\em {Differential algebra}}.
		\newblock Dover Publications, New York, 1955.
		
		\bibitem[Vir11]{Viro}
		Oleg Viro.
		\newblock On basic concepts of tropical geometry.
		\newblock {\em {Proc. Steklov Inst. Math.}}, 273:252--282, 2011.
		
		\bibitem[Yag16]{Yaghmayi}
		Keyvan Yaghmayi.
		\newblock Geometry over the tropical dual numbers.
		\newblock {\em arXiv:1611.05508}, 2016.
		
	\end{thebibliography}
\end{document}
\section{Fourier Restriction}\label{Reduction}
In this section we prove Theorem \ref{MainRestrictionTheorem} using the techniques of Stovall from Section 4 in \cite{Stovall}. As is customary in the theory of Fourier restriction, we will consider the dual formulation. For a curve $\g:I\to\mathbb{R}^d$ we define the weighed and unweighted extension operators $\E_\g$ and $\mathcal{F}_\g$ to be defined as
\[
\E_\g f(x)=\int_I f(t)e^{2\pi i x\cdot \g(t)}\lambda_\g dt,\quad \F_\g f(x)=\int_I f(t)e^{2\pi i x\cdot \g(t)}dt.
\]
Theorem \ref{MainRestrictionTheorem} is equivalent to showing that the operator norm of the weighed extension operator is bounded, 
\[
\|\E_\g f\|_{L^{p'}(\R^d)}\leq C\|f\|_{L^{q'}(I;\lambda_\g dt)},
\]
where $\lambda_\g=|L_\g(t)|^\frac{2}{d^2+d}$, and where $C$ is uniform over the class $\mathcal{A}_0^{d-1}(I,N,R)$. For the proof of Theorem \ref{MainRestrictionTheorem}, we need the following uniform restriction lemma for the unweighted extension operator.
\begin{lemma}[Lemma $1$ in \cite{Chen}]\label{Restriction-Chen}
Let $d\geq 3$ and let $\gamma$ be a simple curve with $\varphi\in C^d(I)$ which satisfies
\[
\frac{1}{2}\leq |\varphi^{(d)}(t)|\leq 1,
\]
for all $t\in I$. Then
\[
\|\F_\g f\|_{L^{p'}(\R^d)}\leq C\|f\|_{L^{q'}(I)},
\]
holds for all $p$ and $q$ in the range
\[
1\leq p< \frac{d^2+d+2}{d^2+d},\quad q=\frac{2}{d^2+d}p',
\]
and the constant $C$ depends only on $p$ and $d$.
\end{lemma}
There is an immediate corollary of Lemma \ref{Restriction-Chen} using the affine invariance of the weighted extension operator on the critical line due to the affine arc length measure.
\begin{corollary}\label{Restriction-Chen-Cor}
Let $d\geq 3$, $M>0$, and let $\gamma$ be a simple curve with $\varphi\in C^d(I)$ which satisfies
\begin{equation}\label{assumptionsResCor}
  \frac{M}{2}\leq |\varphi^{(d)}(t)|\leq M,
\end{equation}
for all $t\in I$. Then
\[
\|\E_\g f\|_{L^{p'}(\R^d)}\leq C\|f\|_{L^{q'}(I; \lambda_\g dt)},
\]
holds for all $p$ and $q$ in the range
\[
1\leq p< \frac{d^2+d+2}{d^2+d},\quad q=\frac{2}{d^2+d}p',
\]
and the constant $C$ depends only on $p$ and $d$.
\end{corollary}
\begin{proof}
Consider the scaled simple curve
\[
\g_M(t)=(t,t^2,\ldots, t^{d-1}, M^{-1}\varphi(t)).
\]
Then the assumptions of Lemma \ref{Restriction-Chen} are satisfied for $\g_M$. Moreover, through a change of variables argument we have
\[
M^{\frac{1}{p'}}\|\F_\g f\|_{L^{p'}(\R^d)}=\|\F_{\g_M}f\|_{L^{p'}(\R^d)}\leq C\|f\|_{L^{q'}(I)}.
\]


From \eqref{assumptionsResCor} we have
\[
\left(\frac{M}{2}\right)^\frac{2}{d^2+d}\leq \lambda_\g(t)\leq M^{\frac{2}{d^2+d}},
\]
as $\lambda_\g(t)=|\varphi^{(d)}(t)|^{\frac{2}{d^2+d}}$. In particular, we can bound the weighed extension operator point-wise by the unweighted, since
\[
\E_\g f(x)=\int_I e^{2\pi i x\cdot \g(t)}f(t)\lambda(t)dt\leq M^{\frac{2}{d^2+d}}\int_I e^{2\pi i x\cdot \g(t)}f(t)dt=M^{\frac{2}{d^2+d}}\F_\g f(x).
\]
Therefore, using the fact that $q/p'=2/(d^2+d)$, we have
\[
\|\E_\g f\|_{L^{p'}(\R^d)}\leq M^{\frac{q}{p'}}\|\F_\g f\|_{L^{p'}(\R^d)}=M^{\frac{q-1}{p'}}\|\F_{\g_M}f\|_{L^{p'}(\R^d)}\leq C M^{\frac{q}{q'p'}}\|f\|_{L^{q'}(I)}\leq C\|f\|_{L^{q'}(I;\lambda_\g dt)},
\]
where we used that $q-1=q/q'$ and $(M/2)^{q/p'}\leq \lambda_\g(t)$.
\end{proof}


The following proposition is proven in Section $3$ in \cite{Stovall}, and follows from the theory of Littlewood-Paley square-function estimates, see for instance chapter $7$ of \cite{Muscalu}.
\begin{prop}[Proposition $3.2$ in \cite{Stovall}]\label{SqFuncEst}
Let $\varphi\in \mathcal{A}_0^{d-1}(I,N,R)$ and let $I_j$ be the intervals from Theorem \ref{MainDecompTheorem}. For $n\in\mathbb{Z}$, define
\begin{equation}\label{SubCollectionInt}
    I_{j,n}:=\{t\in I_j: 2^{n-1}<|t-a_j|\leq 2^n\}.
\end{equation}
Then for each $(p,q)$ satisfying $(d^2+d)q=2p'$ and $p'>(d^2+d+2)/2$, and for any $f\in L^p$ and any fixed $j$,
\[
\|\mathcal{E}_\g(\chi_{I_j}f)\|_{L^{p'}(\R^d)}\leq C\left\|\left(\sum_{n\in\mathbb{Z}}|\mathcal{E}_\g(\chi_{I_{j,n}}f)|^2\right)^\frac{1}{2}\right\|_{L^{p'}(\R^d)},
\]
where the constant $C$ depends only on $N$, $d$ and $p$.
\end{prop}




The remaining part of this section is more or less due to Stovall as we will closely follow the ideas of Section $4$ in \cite{Stovall}. For completeness, we have decided to include the full proofs as some
minor changes were needed.
The next lemma is a key component in the proof of Theorem \ref{MainRestrictionTheorem}, and is a modified version of Lemma $4.1$ in \cite{Stovall}.
\begin{lemma}\label{MultiLem}
Let $I$ be an interval. Assume that there exists $C_1,C_2>0$, $\kappa\in\mathbb{N}$ and $a\in\mathbb{R}$ such that $C_1|t-a|^{\kappa}\leq|L_\g(t)|\leq C_2|t-a|^{\kappa}$ for each $t\in I$. Let $n_1\leq\ldots \leq n_D$ be a finite sequence of integers, and assume that for each $1\leq j\leq D$ the function $f_j\in L^{q}(I;\lambda_\g dt)$ is supported on $I_{n_j}:=\{t\in I: 2^{n_j-1}<|t-a|\leq 2^{n_j}\}$. Then there exist constants $K=K_{d}>0$ and $C=C_{d,N,p,q}>0$ such that
\[
\left\|\prod_{l=1}^D\mathcal{E}_\g f_l\right\|_{L^{\frac{p'}{D}}(\R^d)}\leq C2^{-K(n_D-n_1)}\prod_{l=1}^D\|f_l\|_{L^{q'}(I;\lambda_\g dt)}.
\]
\end{lemma}
\begin{proof}
By the generalized H\"{o}lder's inequality it follows for any $\sigma\in S_D$, where $S_D$ denotes the group of permutations on $\{1,\ldots,D\}$, and any integer $1\leq M\leq D-1$, that
\[
\left\|\prod_{l=1}^D\mathcal{E}_\g f_l\right\|_{L^{\frac{p'}{D}}(\R^d)}\leq \prod_{l=N+1}^D\left\|\mathcal{E}_\g f_{\sigma(l)}\right\|_{L^{p'}(\R^d)}\left\|\prod_{j=1}^M\mathcal{E}_\g f_{\sigma(j)}\right\|_{L^{\frac{p'}{M}}(\R^d)}.
\]
Thus, it is enough to show that
\begin{equation}\label{Reduced multi-est}
\left\|\prod_{j=1}^d\mathcal{E}_\g f_{\sigma(j)}\right\|_{L^{\frac{p'}{D}}(\R^d)}\leq C2^{-K\left(n_{\sigma(d)}-n_{\sigma(1)}\right)}\prod_{l=1}^d\|f_l\|_{L^{q'}(I;\lambda_\g dt)},
\end{equation}
holds for any choice of permutation $\sigma\in S_D$ by choosing $M=d$, and for the remaining terms using that
\begin{equation}\label{trivialMulti}
  \left\|\prod_{l=1}^D\mathcal{E}_\g f_l\right\|_{L^{\frac{p'}{D}}(\R^d)}\leq \prod_{l=1}^D\left\|\mathcal{E}_\g f_{\sigma(l)}\right\|_{L^{p'}(\R^d)}\leq C\prod_{l=1}^D\|f_l\|_{L^{q'}(I; \lambda_\g dt)},
\end{equation}
by corollary \ref{Restriction-Chen-Cor} as each $f_j$ is supported on $I_{n_j}$. 

Assume \eqref{Reduced multi-est} holds for the case $q_0=2$, which is also the case $p_0'=d^2+d$ as we are on the scaling line. Then, for any $p'=Dq$, and $\theta\in(0,1)$,
\begin{equation*}
    \frac{1}{q_\theta}=\frac{\theta}{q}+\frac{1-\theta}{2}=D\left(\frac{\theta}{p'}+\frac{1-\theta}{d^2+d}\right)=D\frac{1}{p_\theta'},
\end{equation*}
where $p_\theta$ is given by
\[
\frac{1}{p_\theta}=\frac{\theta}{p}+\frac{1-\theta}{p_0}.
\]
This means that interpolation between points on the scaling line $p'=Dq$ keeps us on the scaling line.
So for any $(p,q)$ satisfying
\[
p<\frac{d^2+d+2}{d^2+d},\quad p'=Dq,
\]
we can find $\varepsilon=\varepsilon(p)>0$ such that $p_\varepsilon=p+\varepsilon<(d^2+d+2)/(d^2+d)$, and $q_\varepsilon=p_\varepsilon'/D$. Applying \eqref{trivialMulti} with $D$ replaced by $d$ for the pair $(p_\varepsilon,q_\varepsilon)$, it follows by Riesz-Thorin's interpolation theorem that
\begin{equation*}
    \left\|\prod_{j=1}^d\mathcal{E}_\g f_{\sigma(j)}\right\|_{L^{\frac{p'}{D}}(\R^d)}\leq C2^{-K\left(n_{\sigma(d)}-n_{\sigma(1)}\right)}\prod_{l=1}^d\|f_l\|_{L^{q'}(I;\lambda_\g dt)}.
\end{equation*}
It is therefore enough to consider the case $q=2$ and $p'=d^2+d$.

Without loss of generality we may assume that $\sigma(j)=j$ in \eqref{Reduced multi-est} for all $1\leq j\leq d$. Two cases will be considered separately. The first case is $n_d-n_1\leq d$. Then, by \eqref{trivialMulti} it follows that
\begin{equation}\label{FirstCase}
    \left\|\prod_{l=1}^D\mathcal{E}_\g f_l\right\|_{L^{\frac{p'}{D}}(\R^d)}\leq  C\prod_{l=1}^D\|f_l\|_{L^{q'}(I; \lambda_\g dt)}\leq C_12^d2^{-(n_d-n_1)}\prod_{l=1}^D\|f_l\|_{L^{q'}(I;\lambda_\g dt)}.
\end{equation}
which is \eqref{Reduced multi-est}.

Assume $n_d-n_1>d$, and define for each $j$ the measure $\mu_j$ ,which acts as a linear functional on $C_0(\R^d)$ through
\[\mu_j(\phi)=\int_{\R^d}\phi d\mu_j=\int_{I_{n_j}}\phi(\g(t))f_j(t)\lambda_\g(t)dt,\]
for each $\phi\in C_0(\R^d)$, and
where $\lambda_\g(t)=|L_\g(t)|^{\frac{2}{d(d+1)}}$.
The measure $\mu_j$ is defined such that $\E_\g f_j=\widehat{\mu}_j$. In particular, Hausdorff-Young's inequality gives
\begin{align}\label{Hausdorff-Young}\left\|\prod_{j=1}^d \mathcal{E}_\g f_{j}\right\|_{L^{d+1}(\R^d)}=\left\|\prod_{j=1}^d \widehat{\mu}_{j}\right\|_{L^{d+1}(\R^d)}
=&\left\|\left({\mu}_{j}*\ldots*\mu_d\right)^\wedge\right\|_{L^{d+1}(\R^d)}\nonumber\\
\leq& \|\mu_i*\ldots*\mu_d\|_{L^{\frac{d+1}{d}}(\R^d)}.\end{align}
Computing the $d$-fold convolution of the measure acting on a fixed $\phi\in C_0(\R)$ results in
\begin{align*}
\mu_1*\ldots*\mu_d(\phi)=&\int_{I_{n_1}}\ldots\int_{I_{n_d}}\phi\left(\sum_{j=1}^d \g(t_j)\right) \prod_{l=1}^d f_l(t_l)\lambda_\g(t_l)dt_l\\
=& \sum_{\sigma\in S_d}\int_{P_\sigma}\phi\left(\sum_{j=1}^d \g(t_j)\right) \prod_{l=1}^d f_l(t_l)\lambda_\g(t_l)dt,
\end{align*}
where $S_d$ is the group of permutations on $\{1,\ldots,d\}$, and where
\[P_\sigma=\left\{(t_1,\ldots,t_d)\in I_{n_1}\times\ldots\times I_{n_d}:t_{\sigma(1)}<\ldots<t_{\sigma(d)}\right\},\]
for each $\sigma\in S_d$. The map $(t_1,\ldots,t_d)\mapsto \sum_{j=1}^d\g(t_j)$ is injective on $P_\sigma$. Denote this map by $\Gamma$, namely\[
\Gamma(t)=\sum_{j=1}^d\g(t_j).
\]
Through a change of variables $y:=\Gamma(t)$ it is possible to write the Radon-Nikodym derivative of the $d$-fold convolution measure as
\begin{equation}\label{Radon-Nikodym-Derivative}\frac{d(\mu_1*\ldots*\mu_d)}{dt}=\sum_{\sigma\in S_d}F_\sigma,\end{equation}
where the functions $F_\sigma$ are given by
\begin{align*}
F_\sigma(y)=&\chi_{P_\sigma}(t)\left(\prod_{l=1}^d f_l(t_l)\lambda_\g(t_l)|J_\Gamma(t)|^{-1}\right)\Big|_{t=\left(\Gamma|_{P_\sigma}\right)^{-1}(y)}\\=&\chi_{P_\sigma}(\Gamma^{-1}(y))\left(\bigotimes_{l=1}^d f_l\lambda_\g\right)(\Gamma^{-1}(y))|J_\Gamma(\Gamma^{-1}(y))|^{-1}\\
=&\left(\chi_{P_\sigma}|J_\Gamma|^{-1}\left(\bigotimes_{l=1}^d f_l\lambda_\g\right)\right)(\Gamma^{-1}(y)).
\end{align*}
Here $f\otimes g(t_1,t_2)=f(t_1)g(t_2)$. Fix $\sigma\in S_d$. Then by reversing the change of variables $y=\Gamma(t)$, one sees that
\begin{align*}
\|F_\sigma\|^{\frac{d+1}{d}}_{L^{\frac{d+1}{d}}(\R^d)}=&\int_{\R^d}|F_\sigma(y)|^{\frac{d+1}{d}}dy\\
=&\int_{\R^d}\left|\left(\chi_{P_\sigma}|J_\Gamma|^{-1}\left(\bigotimes_{l=1}^d f_l\lambda_\g\right)\right)(\Gamma^{-1}(y))\right|^{\frac{d+1}{d}}dy\\
=&\int_{\R^d}\left|\left(\chi_{P_\sigma}\left(\bigotimes_{l=1}^d f_l\lambda_\g\right)\right)(t)\right|^{\frac{d+1}{d}}|J_\Gamma(t)|^{-\frac{1}{d}}dt\\
=&\left\|\left(\chi_{P_\sigma}\left(\bigotimes_{l=1}^d f_l\lambda_\g\right)\right)|J_\Gamma|^{-\frac{1}{d+1}}\right\|^{\frac{d+1}{d}}_{L^{\frac{d+1}{d}}(\R^d)}.
\end{align*}
By the geometric inequality \eqref{GeometricInequality}, and the fact that $\lambda_\g(t)=|\varphi^{(d)}(t)|^\frac{2}{d^2+d}$, it follows that,
\begin{align*}
\|F_\sigma\|^{\frac{d+1}{d}}_{L^{\frac{d+1}{d}}(\R^d)}
=&\int_{P_\sigma}\prod_{l=1}^d |f_l\lambda_\g(t_l)|^{\frac{d+1}{d}}|J_\Gamma(t_1,\ldots,t_d)|^{-\frac{1}{d}}dt_1\ldots dt_d\\
\leq& C\int_{P_\sigma}\prod_{l=1}^d |f_l\lambda_\g(t_l)|^{\frac{d+1}{d}}\prod_{k=1}^d\lambda_\g(t_k)^{-\frac{d+1}{2d}}\prod_{1\leq i<j\leq d}|t_j-t_i|^{-\frac{1}{d}}dt_1\ldots dt_d\\
=& C\int_{P_\sigma}\prod_{l=1}^d |f_l(t_l)|^{\frac{d+1}{d}}|\lambda_\g(t_l)|^{\frac{d+1}{2d}}\prod_{1\leq i<j\leq d}|t_j-t_i|^{-\frac1d}dt_1\ldots dt_d.
\end{align*}

Since there are only $d$ choices of $n_j$, there necessarily has to exist some $1\leq k<d$, such that $n_{k+1}-n_k\geq (n_d-n_1)/d>1$. This implies that $n_{k+1}-n_k\geq 2$ as all $n_j$ are integers. Thus, given $(t_1,\ldots,t_d)\in I_{n_1}\times\ldots\times I_{n_d}$, it follows that
\begin{align*}
\prod_{1\leq i<j\leq d}|t_j-t_i|=&\prod_{i\leq k, k+1\leq j}|t_j-t_i|\prod_{1\leq i<j\leq k}|t_j-t_i|\prod_{k+1\leq i<j\leq d}|t_j-t_i|.
\end{align*}
From the definition of $I_{n_j}$, we have that $|a-t_{j}|> 2^{n_{j}-1}$, while $|a-t_i|\leq 2^{n_i}$. Whence it follows by the reverse triangle inequality that for any $j\geq k+1$ and $i\leq k$,
\begin{equation*}
|t_j-t_i|\geq |t_{j}-a+a-t_i|\geq 2^{n_{j}-1}-2^{n_i}\geq 2^{n_j}(2^{-1}-2^{n_k-n_j})\geq2^{n_j-2},
\end{equation*}
since $n_j\geq n_{k+1}\geq n_k+2\geq n_i+2$. Thus, for each fixed $j\geq k$,
\[\prod_{i\leq k}|t_j-t_i|\geq \prod_{i\leq k}2^{n_k-2}=\frac{2^{kn_j}}{4^k}\geq\frac{2^{kn_j}}{4^d}=C_d2^{kn_j}.\]
Considering all $j\geq k+1$, yields
\[\prod_{i\leq k,k+1\leq j}|t_j-t_i|\geq C_d2^{k\sum_{j=k+1}^d n_j}.\]
Thus, returning to the estimate of the function $F_\sigma$, it can be bounded by
\begin{align}\label{FsigmaBound}
&\|F_\sigma\|^{\frac{d+1}{d}}_{L^{\frac{d+1}{d}}(\R^d)}\nonumber 
\\
&\leq C 2^{-\frac{k}{d}\sum_{j=k+1}^dn_{j}}\int_{P_\sigma}\prod_{l=1}^d |f_l\lambda^{\frac{1}{2}}_\g(t_j)|^{\frac{d+1}{d}}\prod_{1\leq i<j\leq k}|t_j-t_i|^{-\frac1d}\prod_{k+1\leq i<j\leq d}|t_j-t_i|^{-\frac1d}dt_1\ldots dt_d \notag \\
&=C 2^{-\frac{k}{d}\sum_{j=k+1}^dn_{j}}T_k(f_1,\ldots,f_k)T_{d-k}(f_{k+1},\ldots, f_d),
\end{align}
where the map $T_\eta$ is defined by
\begin{equation*}
T_\eta(\psi_1,\ldots,\psi_\eta):=\int_{P_\sigma}\prod_{l=1}^\eta |\psi_l(t_l)|^{\frac{d+1}{d}}|\lambda_\g(t_l)|^{\frac{d+1}{2d}}\prod_{1\leq i<j\leq \eta}|t_j-t_i|^{-\frac1d}dt_1\ldots dt_\eta.
\end{equation*}
By multilinear interpolation, see the proof of Proposition 2.2 in \cite{Christ}, Christ shows that if $1\leq p<l$ and $p^{-1}+q^{-1}(l-1)/2=1$, then there exists a constant $C>0$ such that
\[\int_{\R^\eta}\prod_{i=1}^\eta \psi_i(t_i)\prod_{1\leq i<j\leq \eta}g_{ij}(t_i-t_j)dt_1\ldots dt_\eta\leq C \prod_{i=1}^\eta \|\psi_i\|_{L^p{(\R)}}\prod_{1\leq i<j\leq \eta}\|g_{ij}\|_{L^{q,\infty}(\R)}.\]
If we apply this result to $T_k$ with $q=d$ and $p=2d/(2d-k+1)$ we see that
\[|T_k(f_1,\ldots,f_k)|\leq C \prod_{j=1}^k\|(f_j\lambda_\g^{\frac{1}{2}})^{\frac{d+1}{d}}\|_{L^{\frac{2d}{2d-k+1}}(\R)}=C\prod_{j=1}^k\|f_j\lambda_\g^{\frac{1}{2}}\|_{L^{\frac{2(d+1)}{2d-k+1}}(\R)}^{\frac{d+1}{d}},\]
as the Vandermonde determinant is weakly integrable.
Since $k< d$, it follows that
\[\frac{2d+2}{2d-k+1}<\frac{2(d+1)}{d+1}= 2.\]
As $\text{supp } f_j\subset I_{n_j}$ and $|I_{n_j}|\leq 2^{n_j}$, it follows by HÃ¶lder's inequality that for each $j$,
\begin{align*}
\|f_j\lambda_\g^{\frac{1}{2}}\|_{L^{\frac{2(d+1)}{2d-k+1}}(\R)}^{\frac{2d+2}{2d-k+1}}=&\int_\R |f_j(t)\lambda_\g^{\frac{1}{2}}(t)|^{\frac{2d+2}{2d-k+1}}dt\\
\leq& |I_{n_j}|^{\frac{1}{r'}}\left\||f_j(t)\lambda_\g^{\frac{1}{2}}(t)|^{\frac{2d+2}{2d-k+1}}\right\|_{L^r(\R)}\\
=&2^{\frac{n_j(d-k)}{2d-k+1}}\|f_j\lambda_\g^{\frac{1}{2}}\|_{L^2(\R)}^{\frac{2d+2}{2d-k+1}},
\end{align*}
where
\[r=\frac{4d-2k+2}{2d+2}.\]
This is necessarily the same as
\[\|f_j\lambda_\g^{\frac{1}{2}}\|_{L^{\frac{2(d+1)}{2d-k+1}}(\R)}^{\frac{d+1}{d}}
\leq C2^{\frac{n_j(d-k)}{2d}}\|f_j\lambda_\g^{\frac12}\|_{L^2(\R)}^{\frac{d+1}{d}}
=C2^{\frac{ n_j}{d}\frac{d-k}{2}}\|f_j\|_{L^2(I;\lambda_\g dt)}^{\frac{d+1}{d}}.\]
Thus an upper bound on $T_k$ is given by
\begin{equation}\label{TkBound}|T_k(f_1,\ldots,f_k)|\leq C \prod_{j=1}^k2^{\frac{n_j}{d}\frac{d-k}{2}}\|f_j\|_{L^2(I;\lambda_\g dt)}^{\frac{d+1}{d}}.\end{equation}
Replacing $k\mapsto d-k$, a similar bound for $T_{d-k}$ is given by
\begin{equation}\label{TdkBound}|T_{d-k}(f_{k+1},\ldots,f_{d})|\leq C \prod_{j=k+1}^d2^{\frac{n_j}{d}\frac{k}{2}}\|f_j\|_{L^2(I;\lambda_\g dt)}^{\frac{d+1}{d}}.\end{equation}
Combining \eqref{FsigmaBound}, \eqref{TkBound}, \eqref{TdkBound}, and that $kd\geq 2$ results in
\begin{align*}
\|F_\sigma\|_{L^{\frac{d+1}{d}}(\R^d)}^{\frac{d+1}{d}}\leq&C 2^{\frac{1}{2d^2}\left((d^2-kd)\sum_{l=1}^kn_l+(kd-2kd)\sum_{l=k+1}^dn_l\right)}\prod_{j=1}^d\|f_j\|_{L^2(I;\lambda_\g dt)}^{\frac{d+1}{d}}\\
\leq &C 2^{\frac{1}{2d^2}(kd(d-k))(n_k-n_{k+1})}\prod_{j=1}^d\|f_j\|_{L^2(I;\lambda_\g dt)}^{\frac{d+1}{d}}.
\end{align*}
Here the fact that $n_l\leq n_{k}$ for $l\leq k$, and $n_l\geq n_{k+1}$ for $l\geq k+1$ was used. Applying that $n_{k+1}-n_k\geq (n_d-n_1)/d$ yields
\begin{equation}\label{FsigmaDiadicBound}\|F_\sigma\|_{L^{\frac{d+1}{d}}(\R^d)}\leq C 2^{-\frac{k(d-k)}{2d(d+1)}(n_{d}-n_{1})}\prod_{j=1}^d\|f_j\|_{L^2(I;\lambda_\g dt)}.\end{equation}
Combining \eqref{Hausdorff-Young}, \eqref{Radon-Nikodym-Derivative}, \eqref{FsigmaDiadicBound} and the triangle inequality we end up with
\begin{align*}
    \left\|\prod_{j=1}^d \mathcal{E}_\g f_{j}\right\|_{L^{d+1}(\R^d)}
    \leq \left\|\sum_{\sigma \in S_d}F_\sigma\right\|_{L^{\frac{d+1}{d}}(\R^d)}
    \leq C_2 2^{-K_{d,k}(n_{d}-n_{1})}\prod_{j=1}^d\|f_j\|_{L^2(I;\lambda_\g dt)},
\end{align*}
where the constant $K_{d,k}$ is given by
\[K_{d,k}=\frac{k(d-k)}{2d(d+1)}\geq \frac{d-1}{2d(d-1)}=\frac{1}{2d}>0,\]
as the quadratic form $kd-k^2$ obtains its minimum at the boundary, which is given by $k=1$, or $k=d-1$.

The proof is concluded by combining the case $n_d-n_1\leq d$ with the case $n_d-n_1>d$ by choosing
\[C=\max\{2^dC_1,C_2\},\quad 
K=\min\left\{1, K_{d,1},\ldots,K_{d,d-1}\right\}=\frac{1}{2d}.
\]
\end{proof}


%%%%%%%% Proof of main Theorem %%%%%%%%%%%%%


\begin{proof}[Proof of Theorem \ref{MainRestrictionTheorem}]
Let 
\[
p'=\frac{d^2+d}{2}q,\quad D=\frac{d^2+d}{2}\in\mathbb{N}.
\]
Note that $p'=Dq$, and assume $p'\leq d^2+d$.
By the finite decomposition of Theorem \ref{MainDecompTheorem} and the triangle inequality, it is sufficient to consider one interval. The interval $I_j$ will remain fixed for the rest of the proof. By Proposition \ref{SqFuncEst}, followed by Minkowski's inequality, we see that
\begin{align*}
    \|\E_\g (\chi_{I_j}f)\|_{L^{p'}(\R^d)}^{p'}\leq& C\left\|\left(\sum_{n\in\mathbb{Z}}|\mathcal{E}_\g(\chi_{I_{j,n}}f)|^2\right)^\frac{1}{2}\right\|_{L^{p'}(\R^d)}^{p'}\\
    =&C\int_{\R^d}\left(\sum_{n\in\mathbb{Z}}|\mathcal{E}_\g(\chi_{I_{j,n}}f)(x)|^2\right)^\frac{p'}{2}dx\\
    =&C\int_{\R^d}\prod_{l=1}^D\left(\sum_{n_l\in\mathbb{Z}}|\mathcal{E}_\g(\chi_{I_{j,n_l}}f)(x)|^2\right)^\frac{p'}{2D}dx\\
    \leq& \int_{\R^d}\prod_{l=1}^D\sum_{n_l\in\mathbb{Z}}|\E_\g (\chi_{I_{j,n_l}}f)(x)|^{\frac{p'}{D}}dx\\
    =&D!\sum_{n_1\leq \ldots \leq n_D}\int_{\R^d}\prod_{l=1}^D|\E_\g (\chi_{I_{j,n_l}}f)(x)|^{\frac{p'}{D}}dx,
\end{align*}
and applying Lemma \ref{MultiLem} we get that
\begin{equation*}
    \|\E_\g (\chi_{I_j}f)\|_{L^{p'}(\R^d)}^{p'}\leq C_{d,N,p,q}\sum_{n_1\leq \ldots \leq n_D}2^{-K(n_D-n_1)}\prod_{l=1}^D\|\chi_{I_{j,n_{l}}}f\|_{L^{q'}(I;\lambda_\g dt)}^\frac{p'}{D}.
\end{equation*}
Define the set \[J_{j,n_1,n_D}=[a_j+2^{n_1-1},a_j+2^{n_D}]\cup [a_j-2^{n_D},a_j-2^{n_1-1}].\] Since $n_1\leq\ldots\leq n_D$, it follows that for any
\[
x\in I_{j,n_l}:=\{t\in I_j: 2^{n_l-1}<|t-a_j|\leq 2^{n_l}\},
\]
we must have $a_j+2^{{n_l-1}}<x\leq a_j+2^{n_l}$ or $a_j-2^{n_l}\leq x<a_j-2^{n_l-1}$. In particular, this implies that
$x\in J_{j,n_1,n_D}$.
Moreover, for fixed $n_1$ and $n_D$ there cannot exist more than $(n_D-n_1+1)^{D-2}$
different ways to assign the integers $n_2,\ldots n_{D-1}$ such that $n_1\leq n_2\leq\ldots \leq n_{D-1}\leq n_{D}$. 
As such, let $m=n_D-n_1+1$, so that
\begin{equation}\label{DobbelSumEst}
    \|\E_\g (\chi_{I_j}f)\|_{L^{p'}(\R^d)}^{p'}\leq C\sum_{m=1}^\infty\sum_{n\in\mathbb{Z}}2^{-Km}m^{D-2}\|\chi_{J_{j,n,n+m}}f\|_{L^{q'}(I;\lambda_\g dt)}^{p'}.
\end{equation}
Fix $m$ and assume $l\leq n$. Then by comparing the endpoints, we see that the two sets $J_{j,l,l+m}$ and $J_{j,n,n+m}$ have a non-empty intersection if and only if,
\begin{equation*}
    2^{n-1}\leq 2^{l+m},
\end{equation*}
which means that $n-l\leq m+1$. Thus, for each point $x\in I$, there are at most $m+1$ intervals $I_{j,n,n+m}$ which contain $x$, and so
\begin{equation*}
    \sum_{n\in\mathbb{Z}}|\chi_{J_{j,n,n+m}}f(x)|^{q'}\leq (m+1)|f(x)|^{q'}.
\end{equation*}
Using the trivial bound, one can estimate the sum over $n$ by,
\begin{align*}
    \sum_{n\in\mathbb{Z}}\|\chi_{J_{j,n,n+m}}f\|_{L^{q'}(I;\lambda_\g dt)}^{p'}
    \leq& \left(\sup_{n\in\mathbb{Z}}\|\chi_{J_{j,n,n+m}}f\|_{L^p(I;\lambda_\g dt)}\right)^{p'-q'}\sum_{n\in\mathbb{Z}}\|\chi_{J_{j,n,n+m}}f\|_{L^{q'}(I;\lambda_\g dt)}^{q'}\\
    \leq& \|f\|_{L^{q'}(I;\lambda_\g dt)}^{q'-p'}\sum_{n\in\mathbb{Z}}\|\chi_{J_{j,n,n+m}}f\|_{L^{q'}(I;\lambda_\g dt)}^{q'}\\
    =&\|f\|_{L^p(\lambda_\g)}^{q'-p'}\sum_{n\in\mathbb{Z}}\int_{I}|\chi_{J_{j,n,n+m}}f(t)|^{q'}\lambda_\g(t)dt\\
    \leq& (m+1)\|f\|^{p'}_{L^{q'}(I;\lambda_\g dt)}.
\end{align*}
Combined with \eqref{DobbelSumEst} this yields
\[
\|\E_\g (\chi_{I_j}f)\|_{L^{p'}(\R^d)}^{p'}\leq C\sum_{m=1}^\infty2^{-Km}(m+1)^{D-1}\|f\|_{L^{q'}(I;\lambda_\g dt)}^{p'}\leq C_{d,N,p,q}\|f\|_{L^{q'}(I;\lambda_\g dt)}^{p'},
\]
which completes the proof.
\end{proof}
In this section, we denote by $F$ a cyclic quartic field defined by $(a,b,c,d)$ as in Section \ref{sec:quarticfields}. We fix these notations where $d= b^2+c^2, \gcd(a,d)=1$ and $a,d$ are squarefree. Let $d= p_1 \cdots p_r$ and $a = sign(a)q_1 \cdots q_s$ be the factorizations of $d$ and $a$ where $sign(a)=1$ if $a>0$ and $sign(a)=-1$ otherwise. Note that all $p_i$ and $q_j$ are distinct since $a$ and $d$ are squarefree and $\gcd(a,d)=1$. For each subset $I$ of $\{1,\cdots,r\}$, let $p_I = \prod_{i\in I}$ and $P_I=\prod_{i\in I}P_I$ where $P_i$ is the unique prime ideal of $\mathcal{O}_F$ above $p_i$ by Lemma \ref{lem:quart_int_bas}, \ref{idealPi0quartic} for all $i \in I$. In the case $I = \emptyset$, we define $p_I = 1$ and  $P_I = \mathcal{O}_K$. If $J$ is a subset of $\{1,\cdots ,s\}$, we denote $q_J =  \prod_{j\in J}q_j$. Let $J $ be any subset of $\{1, \hdots, s\}$ such that for each $j \in J$, there is a unique prime ideal $Q_j$ above $q_j$. In that case, we denote by $Q_J = \prod_{j\in J}Q_j$.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Prime decomposition of $p\mathcal{O}_F$ and integral bases of ideals of $F$}\label{sec:int_basis_ideal}


In this subsection, we provide a number of results concerning the prime factorization of the ideal  $p\mathcal{O}_F$ for an arbitrary prime number $p$. Especially, we aim to classify an odd prime $p$ based on the decomposition of $p\mathcal{O}_F$ (see Theorem \ref{theo:class_p}).  In addition, we construct integral bases for certain ideals of $O_F$ which can be used to prove the well-roundness of ideals in Section \ref{sec:wr-ideals-quartic}.


By \cite[Theorem 1.3]{conraddiscriminants}, a prime $p$ ramifies in $F$ if and only if $p\mid \Delta_F$. In this case, by Lemmata \ref{lem:quart_int_bas} and \ref{lem:quartic_int_basis_divisor_index}, the decomposition of $p\mathcal{O}_F$ is given as below.
\begin{itemize}
	\item If $p\mid d$, then $p\mathcal{O}_F=  P^4$ where $P $ is a unique prime ideal of $\mathcal{O}_F$ above $p$.
	\item If $p\mid a$ and $d $  is a quadratic non-residue $\pmod p$, then  $p\mathcal{O}_F=  P^2$ where $P $ is a unique prime ideal of $\mathcal{O}_F$ above $p$. 
	\item If $p\mid a$ and $d $  is a quadratic residue $\pmod p$, then  $p\mathcal{O}_F=  P_1^2P_2^2$ where $P_1,P_2 $ are two distinct prime ideals of $\mathcal{O}_F$ above $p$. 
\end{itemize}

Lemmata  \ref{lem:quart_int_bas} and \ref{lem:quartic_int_basis_divisor_index} show the prime decomposition of $p\mathcal{O}_F$ where $p\mid ac$. Furthermore, if $p\nmid abcd$, then the composition of $p\mathcal{O}_F$ is given as in \ref{lem:quart_int_bas},\ref{lem:quart_int_bas_iii}. Eventually, to classify all odd primes $p$, we consider an odd prime divisor $p$ of $b$ such that $p\nmid a$. Lemma \ref{lem:prime_decompose_divisor_b}  is the key component that completes the classification of all odd prime numbers $p$. 

By Lemmata \ref{lem:quart_int_bas}, \ref{idealPi0quartic} and \ref{lem:quartic_int_basis_divisor_index}, there is a unique prime ideal $P_i$ above a prime $p_i$ for all $p_i\mid d$ and there exists a unique prime ideal $Q_i$ above $q_i$ for all $q_i\mid a$ if $d$ is not a quadratic residue $\pmod{q_i}$. We will identify the necessary and sufficient conditions for a prime $p$ such that $\mathcal{O}_F$ has a unique prime ideal above $p$ (see Theorem \ref{thm:main6}). 




\begin{remark}\label{rem:belong_PIQJ}
 	Let $\delta \in O_F$. Since $P_i$ is the unique prime ideal above $p_i$, to show that $\delta \in P_I$ it is sufficient to show that $\delta \in P_i$ for all $i \in I$. By Lemma \ref{lem:quartic_int_basis_divisor_index}, $Q_j$ is the unique prime ideal above $q_j$ for all $j\in J$. As consequence, to show $\delta\in Q_J$, it is sufficient to show that $\delta\in Q_j$ for all $j\in J$. Moreover, to claim $\delta\in P_IQ_J$, it is sufficient to show that $\delta\in P_i$ and $\delta\in Q_j$ for all $i\in I, j\in J.$
 \end{remark}






 
 When ($p\mid d$ or $p\mid a$) and $d$ is a quadratic non-residue $\pmod p$, an integral basis of the unique prime ideal above $p$ is obtained as a consequence of Lemmata \ref{lem:d_even}, \ref{lem:d_odd_b_odd}, \ref{lem:d_odd_b_even_aplusb3}, \ref{lem:d_odd_b_even_ab1_1} and \ref{lem:d_odd_b_even_ab1_2}.
 \begin{lemma}
 	\label{lem:d_even} Let $d\equiv 2 \pmod 4$. Then $P_IQ_J = \ZZ p_Iq_J\oplus \ZZ q_J\sqrt{d}\oplus \ZZ \beta \oplus \ZZ \sigma(\beta)$.
 \end{lemma}
 \begin{proof}
 	For each $i\in I$ and $j\in J$, since $P_i$ is the unique prime ideal above $p_i$ and $Q_j$ is the unique prime ideal above $q_j$ and by Lemma \ref{lem:norm_some_ele}, $\beta,\sigma(\beta)\in P_i$ and $\beta,\sigma(\beta)\in Q_j$. By Remark \ref{rem:belong_PIQJ}, one has $\beta,\sigma(\beta)\in P_IQ_J$. It is obvious to see that $p_Iq_J\in P_IQ_J$ and $q_J\sqrt{d}\in Q_J$. Since $p_I\mid d^2 =\N(\sqrt{d})$ and $P_i$ is the unique prime ideal above $p_i$, $\sqrt{d}\in P_i$ for all $i\in I$ and thus $q_J\sqrt{d}\in P_I$ by Remark \ref{rem:belong_PIQJ}. It means $q_J\sqrt{d}\in P_IQ_J$. It implies that $L_{IJ} =  \ZZ p_Iq_J\oplus \ZZ q_J\sqrt{d}\oplus \ZZ \beta \oplus \ZZ \sigma(\beta)$ is a sublattice of $P_IQ_J$. However, two lattices $P_IQ_J$ and $L_{IJ}$ have the same indices in $\mathcal{O}_F$. Therefore $P_IQ_J=L_{IJ}$ by Lemma \ref{sublatticeequal}.
 \end{proof}








 
\begin{lemma}\label{lem:d_odd_b_odd}
	If $d\equiv 1\pmod 4$ and $b$ is odd, then $P_IQ_J = \ZZ p_Iq_J \oplus \ZZ \dfrac{q_I\tron{p_I+\sqrt{d}}}{2}\oplus \ZZ \beta \oplus \ZZ\sigma(\beta)$.
\end{lemma}
\begin{proof}
	By Remark \ref{rem:integralbasis}, $\dfrac{1+\sqrt{d}}{2}\in \mathcal{O}_F$ and thus $\dfrac{p_I+\sqrt{d}}{2}=\dfrac{p_I-1}{2}+\dfrac{1+\sqrt{d}}{2}\in \mathcal{O}_F$. Since $p_i\mid \tron{\dfrac{p_I^2-d}{4}}^2=\N\tron{\dfrac{p_I+\sqrt{d}}{2}}$ and $P_i$ the unique prime ideal above $p_i$ for all $i\in I$, we have  $\dfrac{q_J\tron{p_I+\sqrt{d}}}{2}\in P_IQ_J$. By Lemma \ref{lem:norm_some_ele}, $\beta,\sigma(\beta)\in P_i, Q_j$ for all $i\in I$ and $j\in J$. By Remark \ref{rem:belong_PIQJ}, we obtain $\beta,\sigma(\beta)\in P_IQ_J$. One can prove the result using a similar argument as in the proof of Lemma \ref{lem:d_even}.
\end{proof}






\begin{lemma}
	\label{lem:d_odd_b_even_aplusb3}Let $d\equiv 1 \pmod 4$, $b$ be even and $a+b\equiv 3\pmod 4$. Then $P_IQ_J = \ZZ p_Iq_J\oplus \ZZ \dfrac{q_J\tron{p_I+\sqrt{d}}}{2}\oplus \ZZ \dfrac{\beta+\sigma(\beta)}{2}\oplus \ZZ\dfrac{-\beta+\sigma(\beta)}{2}.$
\end{lemma}
Next, we consider the case $d\equiv 1 \pmod 4,b \equiv 0\pmod 2, a+b\equiv 1 \pmod 4$ and $a\equiv-c\pmod 4$. Let $\gamma'_1, \gamma'_2, \gamma'_3,\gamma'_4$ be a integral basis of $\mathcal{O}_F$ as in Remark \ref{rem:integralbasis},iv. We define \begin{align}\label{eq:basis_aplusb1_1}
\gamma_1= \gamma_1', \gamma_2= \gamma_2', \gamma_3 = -\gamma_4', \gamma_4 = \gamma_2'-\gamma_3'.
\end{align} It is obvious to see that $\{\gamma_1,\gamma_2,\gamma_3,\gamma_4\}$ is a basis of $\mathcal{O}_F$ by \ref{rem:integralbasis}, iv. One has the following result.
\begin{lemma}
	\label{lem:d_odd_b_even_ab1_1}Let $d\equiv 1 \pmod 4, b$ be even, $a+b\equiv 1\pmod 4$ and $a\equiv -c\pmod 4$. Then $P_IQ_J = \ZZ \rho_{IJ}\oplus \ZZ \sigma\tron{\rho_{IJ}}\oplus \ZZ\sigma^2\tron{\rho_{IJ}}\ZZ\sigma^3\tron{\rho_{IJ}} $ where $\rho_{IJ}= \dfrac{-p_Iq_J+q_J\sqrt{d}-\beta-\sigma(\beta)}{4}.$
\end{lemma}

\begin{proof}
	By Remark \ref{rem:belong_PIQJ}, it is sufficient to prove $\rho_{IJ}\in P_i,Q_J$ for all $i\in I$ and $j\in J$. Let $\gamma_1,\gamma_2,\gamma_3,\gamma_4$ as in \eqref{eq:basis_aplusb1_1}. Then $\rho_{IJ}=  \dfrac{-p_Iq_J-q_J+2}{4}\gamma_1+\dfrac{q_J-1}{2}\gamma_2+\gamma_4$ and thus $\rho_{IJ}\in \mathcal{O}_F$. Moreover, $\N\tron{\rho_{IJ}} = \dfrac{\tron{p_Iq_J^2+q_I^2d-2ad}^2-2d\tron{p_Iq_J^2+|a|c}^2}{256}$ an thus $\rho_{IJ}\in P_i,Q_j$ for all $i\in I$ and $j\in J$. As a result $\rho_{IJ},\sigma\tron{\rho_{IJ}},\sigma\tron{\rho_{IJ}},\sigma^3\tron{\rho_{IJ}}\in P_IQ_J$. Hence $L_{IJ}= \ZZ \rho_{IJ}\oplus \ZZ \sigma\tron{\rho_{IJ}}\oplus \ZZ\sigma^2\tron{\rho_{IJ}}\ZZ\sigma^3\tron{\rho_{IJ}}$ is a sublattice of $P_IQ_J$. Two lattices $P_IQ_J$ and $L_{IJ}$ have the same indices $p_Iq_J^2$ in $\mathcal{O}_F$. Therefore $P_IQ_J=L_{IJ}$.
\end{proof}
In the remaining case $d \equiv 1 \pmod 4,b\equiv 0\pmod 2, a+b\equiv 1 \pmod 4$ and $a\equiv c\pmod 4$, using a similar technique to the one in the proof of Lemma \ref{lem:d_odd_b_even_ab1_1}, one obtains the result as below.
\begin{lemma}
	\label{lem:d_odd_b_even_ab1_2}Let $d \equiv 1 \pmod 4,b\equiv 0\pmod 2, a+b\equiv 1 \pmod 4$ and $a\equiv c\pmod 4$. Then $P_IQ_J = \ZZ \rho_{IJ}\oplus \ZZ \sigma\tron{\rho_{IJ}}\oplus \ZZ\sigma^2\tron{\rho_{IJ}}\ZZ\sigma^3\tron{\rho_{IJ}} $ where $\rho_{IJ} =  \dfrac{p_Iq_J-q_J\sqrt{d}-\beta+\sigma(\beta)}{4}.$
\end{lemma}

Next, we will describe a prime ideal above $q_i$ where $q_i\mid a$ and $d$ is a quadratic residue $\pmod{q_i}$. By Lemma \ref{lem:quartic_int_basis_divisor_index}, there exist exactly two prime ideals above $q_i$. Let $z_1,z_2$ be two positive integers such that $z_i^2\equiv d\pmod {q_j}$. By the result on the decomposition of primes \cite[Theorem 4.8.13]{cohen1993course}, one has $q_j\mathcal{O}_K =  \mathfrak{q}_{1j}\mathfrak{q}_{2j}.$ 


Before proceeding, we will outline a strategy to prove that a certain lattice is an ideal in Lemmata \ref{lem:q_i_d_even}, \ref{lem:q_i_db_odd}, \ref{lem:q_i_d_odd_b_even_ab3}, \ref{lem:qnotquadratic_ab_1_mod_4_1},\ref{lem:qnotquadratic_ab_1_mod_4_2},\ref{lem:prime_decompose_divisor_b}, \ref{lem:ideal_above_2_bodd} and \ref{lem:prideals_above_2_2}. The proofs of these lemmata can be seen in the Appendix \ref{appendix_B}.

\begin{remark}\label{stra:strategy_to_prove_ideal}
Let $\mathcal{O}_F = \ZZ \gamma_1'\oplus \ZZ \gamma_2'\oplus\ZZ \gamma_3'\oplus \ZZ\gamma_4'$ as in Remark \ref{rem:integralbasis} and let $L = \ZZ \delta_1\oplus \ZZ \delta_2 \oplus  \ZZ \delta_3\oplus \ZZ\delta_4$ where $\delta_i \in \mathcal{O}_F$. To prove $L$ is an ideal of $\mathcal{O}_F$, we will show that $\delta_i\gamma_j' \in L$ for all $i, j$. In other words,  we perform the following steps for all $ 1 \le i, j  \le 4$.
	\begin{enumerate}[(1)]
		\item Compute $\delta_i\gamma_j'$.
		\item Express $\delta_i\gamma_j' = z_1\delta_1'+z_2\delta_2' +z_3 \delta_3'+z_4\delta_4'$.
		\item Prove that all numbers  $z_1,z_2,z_3,z_4$ are integers.
	\end{enumerate}
\end{remark}




When $d$ is even, $df_K(x) = x^2-d$ is a defining polynomial of $K=\QQ(\sqrt{d})$.  Then \begin{align}\label{eq:z_1_z_2}
    df_K(x) = \tron{x-z_i}\tron{x-z_2}\pmod {p_j}.
\end{align} By using the result on the  decomposition of primes  \cite[Theorem 4.8.13]{cohen1993course}, one has $\mathfrak{q}_{kj}=  \ZZ q_j\oplus \ZZ\tron{z_i+\sqrt{d}}$. With  $z_1,z_2$ as in \eqref{eq:z_1_z_2}, one has the result as follows. \begin{lemma}
	\label{lem:q_i_d_even} If $d$ is even and $q_i\mid a$ such that $d$ is a quadratic residue $\pmod {q_j}$, then there exist exactly two prime ideals $Q_{1j},Q_{2j}$ above $q_j$ where \begin{align*}
	Q_{kj}&= \ZZ q_j\oplus \ZZ \tron{z_k+\sqrt{d}}\oplus \ZZ \beta\oplus \ZZ \sigma(\beta).
	\end{align*}
\end{lemma}

When $d$ is odd, $df_K(x)=  x^2-x+\dfrac{1-d}{4}$ is a defining polynomial of $K$. One has \begin{align*}
4df_K(x)\pmod {q_j}=  (2x-1)^2-d \pmod {q_j}= \tron{2x-1-z_1}\tron{2x-1-z_2}\pmod {q_j}.
\end{align*} As $q\equiv 1 \pmod 4$, there exist integers $t_1,t_2$ such that $z_k = 4t_k-1\pmod{ q_j}$ for $k=1,2,$  and thus $df_K(x) = \tron{x-t_1}\tron{x-t_2}\pmod {q_j}$.


\begin{lemma}\label{lem:q_i_db_odd} 
If $d\equiv 1\pmod 4, b\equiv 1\pmod 2$ and $q_i\mid a$ such that $d$ is a quadratic residue $\pmod {q_j}$, then there exist exactly two prime ideals $Q_{1i},Q_{2i}$ above $q_i$ where $k=1,2$ and 
\begin{align*}
	Q_{kj}&= \ZZ q_j\oplus \ZZ \tron{\dfrac{4t_k-1+\sqrt{d}}{2}}\oplus \ZZ \beta\oplus \ZZ \sigma(\beta).
	\end{align*}
\end{lemma}




\begin{lemma}	\label{lem:q_i_d_odd_b_even_ab3} If $d\equiv 1\pmod 4, b\equiv 0\pmod 2, a+b\equiv 3\pmod 4$ and $q_i\mid a$ such that $d$ is a quadratic residue $\pmod {q_j}$, then there exist exactly two prime ideals $Q_{1i},Q_{2i}$ above $q_i$ where $k=1,2$ and 
\begin{align*}
Q_{kj}&= \ZZ q_j\oplus \ZZ \tron{\dfrac{4t_k-1+\sqrt{d}}{2}}\oplus \ZZ \dfrac{\beta+\sigma(\beta)}{2}\oplus \ZZ \dfrac{\beta-\sigma(\beta)}{2}.
\end{align*}
\end{lemma}



\begin{lemma}\label{lem:qnotquadratic_ab_1_mod_4_1}
	If $d\equiv 1\pmod 4, b\equiv   0 \pmod 2, a +b \equiv 1 \pmod 4$ and $a\equiv -c\pmod 4$ and $p_j\mid a$ such that $d$ is a quadratic residue $\pmod {q_j}$, then there are exactly two prime ideals $Q_{1j}, Q_{2j}$ above $q_j$ such that \begin{align*}
	Q_{kj}= \ZZ q_j\oplus \ZZ \dfrac{4t_k-1+\sqrt{d}}{2}\oplus \ZZ \dfrac{4t_k-1 +\sqrt{d}-\beta- \sigma(\beta)}{4}\oplus \ZZ \dfrac{2q_j+4t_k-1+\sqrt{d} +\beta-\sigma(\beta)}{4}.
	\end{align*}
\end{lemma}

\begin{lemma}\label{lem:qnotquadratic_ab_1_mod_4_2}
	If $d\equiv 1\pmod 4, b\equiv   0 \pmod 2, a +b \equiv 1 \pmod 4$ and $a\equiv c\pmod 4$ and $p_j\mid a$ such that $d$ is a quadratic residue $\pmod {q_j}$, then there exist integers $t_1,t_2$ and exactly two prime ideals $Q_{1j}, Q_{2j}$ above $q_j$ such that $q_j\nmid t_1-t_2$, $d = (4t_i-1)^2\pmod {q_j}$ and \begin{align*}
	Q_{ij}= \ZZ q_j\oplus \ZZ \dfrac{4t_i-1+\sqrt{d}}{2}\oplus \ZZ \dfrac{4t_i-1+2q_j +\sqrt{d}-\beta- \sigma(\beta)}{4}\oplus \ZZ \dfrac{4t_i-1+\sqrt{d} +\beta-\sigma(\beta)}{4}.
	\end{align*}
	
\end{lemma}

Now, consider a prime $p$ such that $p\mid b$ and $p\nmid a$, Lemma \ref{lem:quartic_int_basis_divisor_b} does not provide us the exact prime decomposition of $p\mathcal{O}_F$. To see this decomposition, it is sufficient to show that $\mathcal{O}_F$ has either a prime ideal of norm $p^2$ or a prime ideal of norm $p.$

%According to Lemma \ref{lem:quartic_int_basis_divisor_b}, the ideal $p\mathcal{O}_F$ is the product of at most two prime ideals when $a$ is a quadratic non-residue modulo $p$, and is the product of at least two prime ideals when $a$ is a quadratic residue
% Therefore, in order to precisely determine the factorization of $p\mathcal{O}_F$, we will demonstrate that $\mathcal{O}_F$ has either two or four prime ideals above $p$, depending on whether $a$ is a quadratic residue or non-residue modulo $p$. In the case where $a$ is a quadratic residue modulo $p$, it suffices to point out two distinct lattices with index $p^2$ in $\mathcal{O}_F$, and to employ Remark \ref{stra:strategy_to_prove_ideal} to prove that these sequences are ideals, and thus prime ideals. In the remaining case, we will demonstrate the existence of lattice with index $p$ that are also prime ideals.
\begin{lemma}	\label{lem:prime_decompose_divisor_b}
Let $p\mid b$ and $p\nmid a$. One has the following statement.
	\begin{enumerate}[i)]
		\item Assume $2 \mid d$. If $a$ is a quadratic non-residue $\pmod p$, then $p\mathcal{O}_F= P_1P_2$ where \begin{align*}
		P_1 &= \ZZ  p \oplus \ZZ \tron{c+\sqrt{d}}\oplus \ZZ p\sigma(\beta)\oplus \ZZ\tron{\beta+\sigma(\beta)}, \text{ and} \\
		P_2&= \ZZ  p \oplus \ZZ \tron{-c+\sqrt{d}}\oplus \ZZ p\sigma(\beta)\oplus \ZZ\tron{\beta-\sigma(\beta)}
		\end{align*}
  are all prime ideals of $\mathcal{O}_F$ above $p$. If $a$ is a quadratic residue $\pmod p$ and we write $a = l^2 \pmod p$, then $p\mathcal{O}_F =P_1P_2P_3P_4$ where \begin{align*}
		P_1& =  \ZZ p \oplus \ZZ \tron{c+\sqrt{d}}\oplus \ZZ  \tron{lc-\sigma(\beta)}\oplus \ZZ \tron{lc+\beta}, \\
				P_2& =  \ZZ p \oplus \ZZ \tron{c+\sqrt{d}}\oplus \ZZ  \tron{lc+\sigma(\beta)}\oplus \ZZ \tron{-lc+\beta}, \\
				P_3& = \ZZ p \oplus\ZZ \tron{-c+\sqrt{d}}\oplus \ZZ \tron{lc-\sigma(\beta)}\oplus \ZZ \tron{lc-\beta}, \text{ and}\\
    P_4 & =\ZZ p \oplus\ZZ \tron{-c+\sqrt{d}}\oplus \ZZ \tron{lc+\sigma(\beta)}\oplus \ZZ \tron{lc+\beta} 
		\end{align*} 
		are all prime ideals  of $\mathcal{O}_F$ above $p$.
  
		\item  Assume $d\equiv 1\pmod 4$ and $b\equiv 1 \pmod 2$. If $ a$ is a quadratic non-residue $\pmod p$, then $p\mathcal{O}_F= P_1P_2$ where 
  \begin{align*}
		P_1 = \ZZ p \oplus \ZZ \dfrac{p+c+\sqrt{d}}{2} \oplus \ZZ p\sigma\tron{\beta}\oplus\ZZ \tron{\beta+\sigma(\beta)}, \text{ and}\\
		P_2 = \ZZ p \oplus \ZZ \dfrac{p-c+\sqrt{d}}{2} \oplus \ZZ p\sigma\tron{\beta}\oplus\ZZ \tron{\beta-\sigma(\beta)} 
\end{align*} 
are all prime ideals of $\mathcal{O}_F$ above $p$.  If $a$ is a quadratic residue $\pmod p$ and we write $a = l^2 \pmod p$, then $p\mathcal{O}_F =P_1P_2P_3P_4$ where\begin{align*}
		P_1& =  \ZZ p \oplus \ZZ \dfrac{p-c+\sqrt{d}}{2}\oplus \ZZ  \tron{lc-\sigma(\beta)}\oplus \ZZ \tron{lc+\beta}, \\
		P_2& =  \ZZ p \oplus \ZZ \dfrac{p-c+\sqrt{d}}{2}\oplus \ZZ  \tron{lc+\sigma(\beta)}\oplus \ZZ \tron{-lc+\beta}, \\
		P_3& = \ZZ p \oplus\ZZ \dfrac{p+c+\sqrt{d}}{2}\oplus \ZZ \tron{lc-\sigma(\beta)}\oplus \ZZ \tron{lc-\beta}, \text{ and}\\
  P_4 & =\ZZ p \oplus\ZZ \dfrac{p+c+\sqrt{d}}{2}\oplus \ZZ \tron{lc+\sigma(\beta)}\oplus \ZZ \tron{lc+\beta} 
		\end{align*}
are all prime ideals of $\mathcal{O}_F$ above $p$.
				
    \item Assume $d \equiv 1 \pmod 4, b\equiv 0\pmod 2$ and $a+b\equiv 3\pmod 4$. If $a$ is a quadratic non-residue $\pmod p$, then $p\mathcal{O}_F = P_1P_2$ where \begin{align*}
	P_1 &=\ZZ p\oplus \ZZ\dfrac{-c+\sqrt{d}}{2}\oplus \ZZ \dfrac{\sigma(\beta)-\beta}{2}\oplus \ZZ p\dfrac{\beta+\sigma(\beta)}{2}, \text{ and}\\
	P_2 &=\ZZ p\oplus \ZZ\dfrac{c+\sqrt{d}}{2}\oplus \ZZ p\dfrac{\sigma(\beta)-\beta}{2}\oplus \ZZ \dfrac{\beta+\sigma(\beta)}{2}
\end{align*} 
are all prime ideals above $p$. If $a$ is a quadratic residue $\pmod p$ and we write $a = l^2 \pmod p$, then $p\mathcal{O}_F =P_1P_2P_3P_4$ where 
\begin{align*}
P_1 & = \ZZ p\oplus\ZZ \dfrac{-c+\sqrt{d}}{2}\oplus \ZZ \dfrac{\sigma(\beta)-\beta}{2}\oplus \ZZ\tron{lc-\dfrac{\beta+\sigma(\beta)}{2}}, \\
P_2 & = \ZZ p\oplus\ZZ \dfrac{-c+\sqrt{d}}{2}\oplus \ZZ \dfrac{\sigma(\beta)-\beta}{2}\oplus \ZZ\tron{lc+\dfrac{\beta+\sigma(\beta)}{2}}, \\
P_3 & = \ZZ p\oplus\ZZ \dfrac{c+\sqrt{d}}{2}\oplus \ZZ \tron{lc+\dfrac{\sigma(\beta)-\beta}{2}}\oplus \ZZ\dfrac{\beta+\sigma(\beta)}{2}, \text{ and}\\
P_4 & = \ZZ p\oplus\ZZ \dfrac{c+\sqrt{d}}{2}\oplus \ZZ \tron{lc-\dfrac{\sigma(\beta)-\beta}{2}}\oplus \ZZ\dfrac{\beta+\sigma(\beta)}{2}				
\end{align*}
are all primes ideals of $\mathcal{O}_F$ above $p$.
				
\item Assume $d\equiv 1 \pmod 4, b \equiv 2\pmod 4, a+b\equiv 1\pmod 4$ and $a\equiv -c \pmod 4$. If $a$ is a quadratic non-residue $\pmod p$, then $p\mathcal{O}_F=P_1P_2$ where 
\begin{align*}
P_1 &=  \ZZ p\oplus \ZZ \dfrac{-c+\sqrt{d}}{2}\oplus \ZZ \dfrac{b-c+\sqrt{d}-\beta+\sigma(\beta)}{4}\oplus \ZZ\dfrac{-p+p\sqrt{d}+p\beta+p\sigma(\beta)}{4}, \text{ and}\\
	P_2 &=  \ZZ p\oplus \ZZ \dfrac{c+\sqrt{d}}{2}\oplus \ZZ \dfrac{p+p\sqrt{d}-p\beta+p\sigma(\beta)}{4}\oplus \ZZ\dfrac{b-c-\sqrt{d}-\beta-\sigma(\beta)}{4}
	\end{align*} 
 are all prime ideals of $\mathcal{O}_F$  above $p$.  If $a$ is a quadratic residue $\pmod p$ and we write $a = l^2\pmod p$, then $p\mathcal{O}_F =  P_1P_2P_3P_4$ where 
 \begin{align*}
P_1 & =  \ZZ p \oplus \ZZ \dfrac{c+\sqrt{d}}{2}\oplus\ZZ \dfrac{\tron{-2l+1}c+\sqrt{d}-\beta+\sigma(\beta)}{4}\oplus \ZZ\dfrac{b-c-\sqrt{d}-\beta-\sigma(\beta)}{4}, \\
	P_2 & = \ZZ p \oplus \ZZ \dfrac{-c+\sqrt{d}}{2}\oplus\ZZ\dfrac{b-c+\sqrt{d}-\beta+\sigma(\beta)}{4}\oplus \ZZ\dfrac{\tron{2l+1}c-\sqrt{d}-\beta-\sigma(\beta)}{4}, \\
	P_3 & = \ZZ p \oplus \ZZ \dfrac{c+\sqrt{d}}{2}\oplus\ZZ\dfrac{\tron{2l+1}c+\sqrt{d}-\beta+\sigma(\beta)}{4}\oplus \ZZ\dfrac{b-c-\sqrt{d}-\beta-\sigma(\beta)}{4}, \text{ and}\\
P_4 & = \ZZ p \oplus \ZZ \dfrac{-c+\sqrt{d}}{2}\oplus\ZZ\dfrac{b-c+\sqrt{d}-\beta+\sigma(\beta)}{4}\oplus \ZZ\dfrac{\tron{-2l+1}c-\sqrt{d}-\beta-\sigma(\beta)}{4}
\end{align*}
 are all prime ideals of $\mathcal{O}_F$ above $p$.
		
  \item Assume $d\equiv 1 \pmod 4, b \equiv 2\pmod 4, a+b\equiv 1\pmod 4$ and $a\equiv c \pmod 4$. If $a$ is a quadratic non-residue $\pmod p$, then $p\mathcal{O}_F=P_1P_2$ where 
  \begin{align*}
	P_1 &=  \ZZ p\oplus \ZZ \dfrac{-c+\sqrt{d}}{2}\oplus \ZZ \dfrac{b-c+\sqrt{d}-\beta+\sigma(\beta)}{4}\oplus \ZZ\dfrac{p+p\sqrt{d}+p\beta+p\sigma(\beta)}{4}, \text{ and}\\
	P_2 &=  \ZZ p\oplus \ZZ \dfrac{c+\sqrt{d}}{2}\oplus \ZZ \dfrac{-p+p\sqrt{d}-p\beta+p\sigma(\beta)}{4}\oplus \ZZ\dfrac{b-c-\sqrt{d}-\beta-\sigma(\beta)}{4}
\end{align*} 
are all prime ideals of $\mathcal{O}_F$  above $p$.  If $a$ is a quadratic residue $\pmod p$ and we write $a = l^2\pmod p$, then $p\mathcal{O}_F =  P_1P_2P_3P_4$ where 
\begin{align*}
P_1 & =  \ZZ p \oplus \ZZ \dfrac{c+\sqrt{d}}{2}\oplus\ZZ \dfrac{\tron{2l+1}c+\sqrt{d}-\beta+\sigma(\beta)}{4}\oplus \ZZ\dfrac{b-c-\sqrt{d}-\beta-\sigma(\beta)}{4}, \\
P_2 & = \ZZ p \oplus \ZZ \dfrac{-c+\sqrt{d}}{2}\oplus\ZZ\dfrac{b-c+\sqrt{d}-\beta+\sigma(\beta)}{4}\oplus \ZZ\dfrac{\tron{2l+1}c-\sqrt{d}-\beta-\sigma(\beta)}{4}, \\
P_3 & = \ZZ p \oplus \ZZ \dfrac{c+\sqrt{d}}{2}\oplus\ZZ\dfrac{\tron{-2l+1}c+\sqrt{d}-\beta+\sigma(\beta)}{4}\oplus \ZZ\dfrac{b-c-\sqrt{d}-\beta-\sigma(\beta)}{4}, \text{ and}\\
	P_4 & = \ZZ p \oplus \ZZ \dfrac{-c+\sqrt{d}}{2}\oplus\ZZ\dfrac{b-c+\sqrt{d}-\beta+\sigma(\beta)}{4}\oplus \ZZ\dfrac{\tron{-2l+1}c-\sqrt{d}-\beta-\sigma(\beta)}{4}
\end{align*}
are all prime ideals of $\mathcal{O}_F$ above $p$.
\end{enumerate}
\end{lemma} 

 \begin{proof}
 	The given lattices are completely distinct, and we can prove that they are ideals by following the steps in Remark \ref{stra:strategy_to_prove_ideal}.
 \end{proof}
Finally, we  consider prime ideals above $2$ when $\Delta_F$ is even. The following result is obtained from Lemma \ref{lem:quart_int_bas},i.

\begin{lemma}\label{lem:ideal_above_2_dodd}
	Let $d$ be even. Then there exists a unique prime ideal $P_0$ above $p_0=2$. Moreover, $P_0 = \langle 2, \beta \rangle$ and $\N\tron{P_0}=2$.
\end{lemma}

\begin{lemma}\label{lem:ideal_above_2_bodd}
	Let $d\equiv 1 \pmod 4$ and $b$ be odd.
	\begin{enumerate}[(i)]
		\item If $d\equiv 5\pmod 8$, then there is a unique prime ideal $P_0$ above $p_0=2$ where $\N(P_0)=4$ and \begin{align*}
		P_0 = \ZZ 2\oplus \ZZ(1+\sqrt{d})\oplus \ZZ\beta \oplus \ZZ \sigma(\beta).
		\end{align*}
  
		\item If $d\equiv 1 \pmod 8$, then there are exactly two distinct prime ideals $P_{01}, P_{02}$ above $p_0=2$ where $\N(P_{01})=  \N\tron{P_{02}}=2$ and \begin{align*}
		P_{01}= \ZZ 2\oplus \ZZ\tron{\dfrac{-1+\sqrt{d}}{2}}\oplus \ZZ \beta \oplus \ZZ\sigma(\beta), \text{ and }\\  
		P_{02}= \ZZ 2\oplus \ZZ\tron{\dfrac{1+\sqrt{d}}{2}}\oplus \ZZ \beta \oplus \ZZ\sigma(\beta).
	\end{align*}
	\end{enumerate}
\end{lemma} 

\begin{lemma}\label{lem:prideals_above_2_2}
	Let $d\equiv 1 \pmod 4$ and $b\equiv 0 \pmod 2$ and $a+b\equiv 3 \pmod 4$.\begin{enumerate}[(i)]
		\item If $d\equiv 5\pmod 8$ , then there is a unique prime ideal $P_0$ above $p_0=2$ where $\N(P_0)=4$ and \begin{align*}
		P_0 = \ZZ 2\oplus \ZZ(1+\sqrt{d})\oplus \ZZ\dfrac{-1+\sqrt{d}-\beta-\sigma(\beta)}{2} \oplus \ZZ \dfrac{1+\sqrt{d}+\beta-\sigma(\beta)}{2}.
		\end{align*}
		\item If $d\equiv 1 \pmod 8$, then there are exactly two prime ideals $P_{01}, P_{02}$ above $p_0=2$ where $\N(P_{01})=  \N\tron{P_{02}}=2$ and \begin{align*}
		P_{01}= \ZZ 2\oplus \ZZ\tron{\dfrac{-1+\sqrt{d}}{2}}\oplus \ZZ \dfrac{2-\beta-\sigma(\beta)}{2} \oplus \ZZ\dfrac{\beta-\sigma(\beta)}{2}, \text{ and }\\  
		P_{02}= \ZZ 2\oplus \ZZ\tron{\dfrac{1+\sqrt{d}}{2}}\oplus \ZZ \dfrac{\beta +\sigma(\beta)}{2} \oplus \ZZ\dfrac{2+\beta -\sigma(\beta)}{2}.
		\end{align*}
	\end{enumerate}
\end{lemma} 
For the case of $p=2$ and $\Delta_F$ odd, we have the following result.

\begin{lemma}	\label{lem:p2_delta_odd}
 Assume that $d\equiv 1 \pmod 4$ and $a+b\equiv 1 \pmod 4$. 
\begin{enumerate}[i)]
	\item If $d \equiv 1\pmod 8$, then $2\mathcal{O}_F$ can be factored as one of the forms $ P_1P_2$, and $P_1P_2P_3P_4$ where $P_1,P_2,P_3,P_4$ are  prime ideals of $\mathcal{O}_F$ above $2$.
	\item If $d\equiv 5 \pmod 8$, then $2\mathcal{O}_F$ is prime.  
\end{enumerate}
\end{lemma}
\begin{proof}
	\begin{enumerate}[i)]
		\item It implies directly from the fact that $p\mathcal{O}_K$ splits totally in $\mathcal{O}_K$ where $\mathcal{O}_K$ as in \eqref{eq:exten_tower}.
		\item See Appendix \ref{proof_lem_p2}.
	\end{enumerate}
\end{proof}
The below theorem follows directly from the combination of Lemmata \ref{lem:quart_int_bas}, \ref{lem:quartic_int_basis_divisor_index},\ref{lem:quartic_int_basis_divisor_b} and \ref{lem:prime_decompose_divisor_b}. 




\begin{theorem}\label{theo:class_p}
	Let $F$ be a cyclic quartic field defined by $a,b,c,d$ as in \eqref{df-polynomial-cubic} and $p$ be an odd prime. One has the following statements.
	\begin{enumerate}[i)]
		\item The prime $p$ is totally ramified if and only if $p\mid d$.
		\item (The ideal $p\mathcal{O}_F = P^2$ where $P$ is a unique prime ideal of $\mathcal{O}_F$ above $p$) if and only if $p\mid a$ and $d$ is a quadratic non-residue $\pmod p$.
         \item (The ideal $p\mathcal{O}_F = P_1^2P_2^2$ where $P_1,P_2$ are exactly two prime ideals of $\mathcal{O}_F$ above $p$) if and only if $p\mid a$ and $d$ is a quadratic residue $\pmod p$.
		\item The prime $p$ is inert  if and only if $p\nmid abcd$ and $d$ is a quadratic non-residue $\pmod p$.
		
		\item The prime $p$ totally splits if and only if $p$ satisfies one of the conditions listed below.
		\begin{itemize}
			\item The prime $p\mid b$ and $a$ is a quadratic residue $\pmod p$.
			\item The prime $p\mid c$ and $2a$ is a quadratic residue $\pmod p$.
			\item The prime $p\nmid abcd$, $d$ is a quadratic residue $\pmod p$, and if $d= z^2 \pmod p$ then $ad+abz$ and $ad-abz$ are also quadratic residues $\pmod p$.	\end{itemize}
		
		\item The ideal $p\mathcal{O}_F$ is the product of two distinct prime ideals in all the remaining cases.
	\end{enumerate}
\end{theorem}





From Theorem \ref{theo:class_p} and Lemmata \ref{lem:ideal_above_2_dodd}, \ref{lem:ideal_above_2_bodd}, and \ref{lem:prideals_above_2_2}, we obtain the necessary and sufficient conditions for a prime $p$ for which  $\mathcal{O}_F$ has a unique prime ideal $P$ over $p$. In the next subsection, we will investigate the conditions for the unique prime ideals $P$ mentioned above to be WR.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\vspace*{0.5cm}
\subsection{Well-rounded ideals of cyclic quartic fields}\label{sec:wr-ideals-quartic}


According to the first part of Theorem \ref{thm:main6}, there are three cases in which   $\mathcal{O}_F$ has a unique prime ideal $P$ over a prime number $p$. However, in the last case of the theorem, $P=p\mathcal{O}_F$ and it is not primitive. Therefore, we only investigate prime ideals $P$ belonging to the first two cases of the theorem. In general, we will prove the necessary and sufficient conditions for an ideal of the form $P_IQ_J$ to be WR, where $I$ is a subset of $\{1,\cdots,r\}$ and $J$ is a subset of $\{1,\cdots, s\}$ such that $d$ is a non-quadratic residue modulo $q_j$ for all $j\in J$.
\begin{proposition}
	\label{prop:PIQ_J_d_even_notWR} Let $d\equiv 2 \pmod 4$. Then $P_IQ_J$ is not WR.
\end{proposition}
\begin{proof}
	Let $\delta\in P_IQ_J$ be a nonzero vector of $P_IQ_J$. By Lemma \ref{lem:d_even}, there exist integers $x_1,x_2,x_3,x_4$ such that $\delta  = x_1 p_Iq_J+x_2q_J\sqrt{d}+x_3 \beta+x_4\sigma(\beta)$ and by \eqref{length}, one obtains
	\begin{align*}
		\|\delta \|^2 = 4\tron{x_1^2p_I^2q_J^2 +x_2^2q_J^2d+|a|d\tron{x_3^2+x_4^2}}.
	\end{align*}
	It is easy to verify that $\min_{\delta\ne 0}\|\delta\|^2\in \min \mathcal{S}$ where $\mathcal{S} =\set{4p_I^2q_J^2, 4q_J^2d, 4|a|d}.$ Each value in $\mathcal{S}$ is only correspondent to the squared length of at most two independent vectors. Thus $P_IQ_J$ is not WR.
\end{proof}
%Second, we consider the case $d\equiv 1 \pmod 4$ and $ b$ is odd.
\begin{proposition}
	\label{prop:bd_odd_notWR} Let $d\equiv 1\pmod 4$ and $b$ be odd. Then $P_IQ_J$ is not WR.
\end{proposition}
\begin{proof}
	Let $\delta\in P_IQ_J$ be a nonzero vector of $P_IQ_J$. By Lemma \ref{lem:d_even}, there exist integers $x_1,x_2,x_3,x_4$ such that $\delta  = x_1 p_Iq_J+x_2q_J\dfrac{p_I+\sqrt{d}}{2}+x_3 \beta+x_4\sigma(\beta)$ and by \eqref{length}, one obtains
	\begin{align*}
		\|\delta \|^2 = \tron{2x_1+x_2}^2p_I^2q_J^2 +x_2^2q_J^2d+4|a|d\tron{x_3^2+x_4^2}.
	\end{align*}
	Since $2x_1+x_2$ and $x_2$ have the same parity, it is easy to verify that $\min_{\delta\ne 0}\|\delta\|^2\in \min \mathcal{S}$ where $\mathcal{S} =\set{p_I^2q_J^2+q_J^2d, 4|a|d}.$ Each value in $\mathcal{S}$ is only correspondent to the squared length of at most two independent vectors. Thus $P_IQ_J$ is not WR.
\end{proof}
%Third, we consider $d\equiv 1\pmod 4, b$ is even and $a+b\equiv 3 \pmod4$. By a similar argument to the proof of Lemma \ref{lem:d_even} in the case $d$ even and Lemma \ref{lem:d_odd_b_odd} in the case $d\equiv 1\pmod 4, b\equiv 1\pmod 2$, one has the following lemma. 

\begin{proposition}\label{prop:dodd_b_ven_aplusb3_mod4}
	Let $d\equiv 1 \pmod 4$, $b$ be even and $a+b\equiv 3\pmod 4$. Then $P_IQ_J $ is not WR. 
\end{proposition}
\begin{proof}
	Let $\delta\in P_IQ_J$ be a nonzero vector of $P_IQ_J$. By Lemma \ref{lem:d_even}, there exist integers $x_1,x_2,x_3,x_4$ such that $\delta  = x_1 p_Iq_J+x_2q_J\dfrac{p_I+\sqrt{d}}{2}+x_3 \dfrac{\beta+\sigma(\beta)}{2}+x_4\dfrac{-\beta+\sigma(\beta)}{2}$ and by \eqref{length}, one obtains
	\begin{align*}
		\|\delta \|^2 = \tron{2x_1+x_2}^2p_I^2q_J^2 +x_2^2q_J^2d+2|a|d\tron{x_3^2+x_4^2}.
	\end{align*}
The result is then followed using the same argument in the proof of Proposition \ref{prop:bd_odd_notWR}.
%Since $2x_1+x_2$ and $x_2$ have the same parity, it is easy to verify that $\min_{\delta\ne 0}\|\delta\|^2\in \min \mathcal{S}$ where $\mathcal{S} =\set{p_I^2q_J^2+q_J^2d, 2|a|d}.$ Each value in $\mathcal{S}$ is only correspondent to the squared length of at most two independent vectors. Thus $P_IQ_J$ is not WR.
\end{proof}


\begin{proposition}\label{lem:WR_aplusb1_1} Let $d\equiv 1 \pmod 4, b\equiv 0\pmod 2, a+b\equiv1\pmod 4$ and $a\equiv -c\pmod 4$. Then $P_IQ_J$ is WR if and only if $p_I^2q_J^2+q_J^2d+2|a|d\le \min \mathcal{M}$ where $$\mathcal{M}=\set{ 16q_J^2d, 8|a|d,  4q_I^2d+4|a|d, 16p_I^2q_J^2,4p_I^2q_J^2+4|a|d,4p_I^2q_J^2+4q_J^2d}.$$	 
\end{proposition}
\begin{proof}
	Let $\rho_{IJ}$ be in Lemma \ref{lem:d_odd_b_even_ab1_1} and $\delta $ be a nonzero vector of $P_IQ_J$. By Lemma \ref{lem:d_odd_b_even_ab1_1}, there exist integers $x_1,x_2,x_3,x_4$ such that $4\delta =  S_1p_Iq_J+S_2q_J\sqrt{d}+S_3\beta +S_4\sigma(\beta)$ where $S_1= -x_1-x_2-x_3-x_4,S_2 = x_1-x_2+x_3-x_4,S_3 = -x_1+x_2+x_3-x_4, S_4 =  -x_1-x_2+x_3+x_4$. By \eqref{length}, one has \begin{align*}
		4\|\delta\|^2 =  S_1^2 p_I^2q_J^2 +S_2^2q_J^2d+|a|d\tron{S_3^2+S_4^2}. 
	\end{align*} 
 % \HT{$S_1^2$?}
	It is easy to prove that $\min_{\delta\ne 0}\|4\delta\|^2 =\min \mathcal{S}$ where \\$$\mathcal{S} = \set{p_I^2q_J^2+q_I^2d+2|a|d,  16q_J^2d,  8|a|d, 4q_I^2d+4|a|d,  16p_I^2q_J^2, 4p_I^2q_J^2+4|a|d, 4p_I^2q_J^2+4q_I^2d}.$$
 Among seven numbers in $\mathcal{S}$, the only one that is correspondent to the squared length of four linearly independent vectors in $P_I$ is $ p_I^2q_J^2+q_J^2d+2|a|d$. Therefore, the lattice $P_IQ_J$ is WR if and only if $\min_{\delta \ne 0}4\|\delta\|^2 = p_I^2q_J^2+q_J^2d+2|a|d$.
\end{proof}
%Finally, we consider the case $d \equiv 1 \pmod 4,b\equiv 0\pmod 2, a+b\equiv 1 \pmod 4$ and $a\equiv c\pmod 4$. Using a similar technique with the proof of Lemma \ref{lem:d_odd_b_even_ab1_1}, one obtains a result as below.

\begin{proposition}	\label{lem:WR_aplusb1_2} Let $d\equiv 1 \pmod 4, b\equiv 0\pmod 2, a+b\equiv1\pmod 4$ and $a\equiv c\pmod 4$. Then $P_IQ_J$ is WR if and only if $p_I^2q_J^2+q_J^2d+2|a|d\le \min \mathcal{M}$ where $$\mathcal{M}=\set{ 16q_J^2d,  8|a|d,  4q_J^2d+4|a|d, 16p_I^2q_J^2, 4p_I^2q_J^2+4|a|d, 4p_I^2q_J^2+4q_J^2d}.$$	 
\end{proposition}
\begin{proof}
	Let $\rho_{IJ}$ be in Lemma \ref{lem:d_odd_b_even_ab1_2} and $\delta $ be a nonzero vector of $P_IQ_J$. By Lemma \ref{lem:d_odd_b_even_ab1_2}, there exist integers $x_1,x_2,x_3,x_4$ such that $4\delta =  S_1p_Iq_J+S_2q_J\sqrt{d}+S_3\beta +S_4\sigma(\beta)$ where $S_1= x_1+x_2+x_3+x_4,S_2 = -x_1+x_2-x_3+x_4,S_3 = -x_1-x_2+x_3+x_4, S_4 =  x_1-x_2-x_3+x_4$. By \eqref{length}, one has \begin{align*}
		4\|\delta\|^2 =  S_1^2 p_I^2q_J^2 +S_2^2q_J^2d+|a|d\tron{S_3^2+S_4^2}. 
	\end{align*} 
 % \HT{$S_1^2$?}
	It is not hard to verify that $\min_{\delta\ne 0}\|4\delta\|^2 =\min \mathcal{S}$ where $$\mathcal{S} = \set{p_I^2q_J^2+q_I^2d+2|a|d,  16q_J^2d,  8|a|d,  4q_I^2d+4|a|d, 16p_I^2q_J^2, 4p_I^2q_J^2+4|a|d, 4p_I^2q_J^2+4q_I^2d}.$$
 Among seven numbers in $\mathcal{S}$, the only one that is correspondent to the squared length of four linearly independent vectors in $P_I$ is $ p_I^2q_J^2+q_J^2d+2|a|d$. Therefore, the lattice $P_IQ_J$ is WR if and only if $\min_{\delta \ne 0}4\|\delta\|^2 = p_I^2q_J^2+q_J^2d+2|a|d$.
\end{proof}



\vspace*{0.5cm}
 We now prove Theorem \ref{thm:main_5}.

\begin{proof}[ Proof of Theorem \ref{thm:main_5}]
\begin{enumerate}[i)]
    \item 	By Propositions \ref{prop:PIQ_J_d_even_notWR}, \ref{prop:bd_odd_notWR}, \ref{prop:dodd_b_ven_aplusb3_mod4},\ref{lem:WR_aplusb1_1} and \ref{lem:WR_aplusb1_2}, the ideal $P_I$ is WR if and only if  $d\equiv 1\pmod 4,p\equiv 0\pmod 2, a+b\equiv 1\pmod 4$ and $p_I^2+\tron{2|a|+1}d\le \min \mathcal{S}$ where $$\mathcal{S} = \set{16d, 8|a|d, 4d+4|a|d, 16p_I^2, 4p_I^2+4|a|d,4p_I^2+4d}.$$ The last inequality is equivalent to the statement $p_I^2+\tron{2|a|+1}d\le 16d, p_I^2+\tron{2|a|+1}d\le 4d+4|a|d, p_I^2+\tron{2|a|+1}d\le 16p_I^2,p_I^2+\tron{2|a|+1}d\le 4p_I^2+4d$. It means \begin{align}
		\label{eq:ineq_WR_PI}\max \left\{\dfrac{(2|a|-3)d}{3},\dfrac{(2|a|+1)d}{15}\right\}\le p_I^2\le \min\left\{ \tron{15-2|a|}d,\tron{2|a|+3}d\right\}.
	\end{align} 
	The inequalities in \eqref{eq:ineq_WR_PI} occur only if $2|a|\le 15$ and thus $|a|\in \{1,3,5,7\}$. \begin{itemize}
		\item If $|a|=1$, the inequalities in \eqref{eq:ineq_WR_PI} become $\dfrac{d}{5}\le p_I^2\le 5d$.
		\item If $|a|=3$, the inequalities in \eqref{eq:ineq_WR_PI} become $d\le p_I^2\le 9d$.
		\item If $|a|=5$, the inequalities in \eqref{eq:ineq_WR_PI} become $\dfrac{7d}{3}\le p_I^2\le 5d$.
		\item If $|a|=7$, the inequalities in \eqref{eq:ineq_WR_PI} lead to $\dfrac{11d}{3}\le p_I^2\le d$, which is impossible.
	\end{itemize} 
 \item By Propositions \ref{prop:PIQ_J_d_even_notWR}, \ref{prop:bd_odd_notWR}, \ref{prop:dodd_b_ven_aplusb3_mod4},\ref{lem:WR_aplusb1_1} and \ref{lem:WR_aplusb1_2}, one can show that $Q_J$ is WR if and only if $d\equiv 1\pmod 4,p\equiv 0\pmod 2, a+b\equiv 1\pmod 4$ and $q_J^2(d+1)+2|a|d\le \min \mathcal{S}$ where $$\mathcal{S} = \set{ 16q_J^2d, 8|a|d, 4q_J^2d+4|a|d,16q_J^2,4q_J^2+4|a|d,4q_J^2+4q_J^2d}.$$
 The last inequality is equivalent to $$q_J^2(d+1)+2|a|d\le 16q_J^2, q_J^2(d+1)+2|a|d\le 8|a|d, q_J^2(d+1)+2|a|d\le 16q_J^2,q_J^2(d+1)+2|a|d\le 4q_J^2+4d.$$ 
 It means $d<15$ and \begin{align}
		\label{eq:ineq_WR_QJ} \max\set{\dfrac{2|a|d}{15-d},\dfrac{2|a|d}{3\tron{d+1}}}\le q_J^2\le \min\left\{ \dfrac{6|a|d}{d+1},\dfrac{2|a|d}{d-3}\right\}.
	\end{align} Since $d$ is odd and squarefree, and $d<15$, one must have $d\in\{5,13\}.$ If $d=13$ then \eqref{eq:ineq_WR_QJ} becomes $13|a|\le q_J^2\le\dfrac{13|a|}{5} $, which is impossible. Thus $d$ must be $5$ and the inequalities in \eqref{eq:ineq_WR_QJ} become 
		$|a|\le q_J^2\le 5|a|$.
\end{enumerate}

\end{proof}


% By Theorem \ref{thm:main_5} i., and by using a similar argument to the one in the proof of Corollary \ref{cor:density-cubic},   one can obtain the following result. 
% \begin{corollary}\label{cor:density-quartic}
%   There are at least $60.9\%$ of cyclic quartic fields with $|a|\in \{1, 3\}$ that have WR ideals.
% \end{corollary}


Now we consider prime ideals above $2$.
\begin{lemma}\label{lem:pideal_above_2_not_WR}
	Let $\left(\text{$d$ be even}\right)$ or $\left(\text{$d$ be odd and $b\equiv 1\pmod 2$}\right)$. Then all prime ideals above $2$ are not WR. 
\end{lemma}
\begin{proof}
	When $d$ is even, the result is directly implied from Proposition \ref{prop:PIQ_J_d_even_notWR}. The result in the remaining case can be obtained by using a similar argument to  the proof of Propositions \ref{prop:PIQ_J_d_even_notWR} and \ref{prop:bd_odd_notWR}.
\end{proof}
By employing the same methodology used to prove Propositions \ref{prop:PIQ_J_d_even_notWR} and \ref{prop:bd_odd_notWR}, we can establish the result of Lemma \ref{lem:2_ab3_not_WR}.

\begin{lemma}\label{lem:2_ab3_not_WR}
	Let $d\equiv 1 \pmod 8, b\equiv 0\pmod 2$ and $a+b\equiv 3\pmod 4$. Then all prime ideals above $2$ are not WR.
\end{lemma}
\begin{lemma}\label{lem:ideal_2_WR}
	Let $d\equiv 5 \pmod 8, b\equiv 0\pmod 2$ and $a+b\equiv 3\pmod 4$. Then $\mathcal{O}_F$ has a unique prime ideal $P_0$ above $2$. Moreover, $P_0$ is WR if and only if $a =1,b=2,c=1,d=5$.
\end{lemma}
\begin{proof}
	By Lemma \ref{lem:prideals_above_2_2}, there is a unique prime ideal $P_0$ above $2$ and an integral basis of $P_0$ is given as in this lemma. Let $0\ne \delta\in P_0$, there are integers $z_1,z_2,z_3,z_4$ such that $\delta =2z_1+z_2\tron{1+\sqrt{d}}+z_3 \dfrac{-1+\sqrt{d}-\beta-\sigma(\beta)}{2}+z_4 \dfrac{1+\sqrt{d}+\beta-\sigma(\beta)}{2}$ and by \eqref{length}, one obtains $\|\delta\|^2 = S_1 ^2 +S_2^2d+|a|d\tron{S_3^2+S_4^2},$
 where $S_1=  4x_1+2z_2-z_3+z_4,S_2= 2z_2+z_3+z_4,S_3= -z_3+z_4,S_4= -z_3-z_4$. It is easy to prove that $\min_{\delta \ne 0}\|\delta\|^2 =\min\set{16,1+d\tron{2|a|+1}}$ and $P_0$ is WR if and only if $16\ge 1+\tron{2|a|+1}$. It occurs only if $a=1,b=2,c=1$.   
\end{proof}

\begin{remark}\label{rem:el_WR}
	If $P$ is a ideal above $2$, then $2\in P$. Thus, if $P$ is WR, then there exists $\delta \in P\setminus \QQ(\sqrt{d})$ such that $\|\delta\|^2\le 16$.
\end{remark}

% In the case $d\equiv 1 \pmod 4, b\equiv 0\pmod 2$ and $a+b\equiv 1\pmod 4$, we now prove there is no prime ideal $P$ above $2$ such that $P$ is WR.
\begin{lemma}\label{lem:ideal_2_notWR}
Let	$d\equiv 1 \pmod 4, b\equiv 0\pmod 2$ and $a+b\equiv 1\pmod 4$. Then all prime ideals above $2$ are not WR.
\end{lemma} 
\begin{proof}
	If $d\equiv 5 \pmod 8$, then $2\mathcal{O}_F$ is prime (see Lemma \ref{lem:p2_delta_odd}). We now consider the case $d\equiv 1 \pmod 8$ here. Note that $d\ge 17 $ as $d\equiv 1 \pmod 4$ and $d$ is squarefree. We divide into two cases: $a\equiv -c\pmod 4$ and $a\equiv c\pmod 4$. Since the techniques used in the proofs of two cases are similar, we only  consider the case $a\equiv -c \pmod 4$. In this case, suppose that there exists a prime ideal $P$ above $2$ such that $P$ is WR. Hence, by Remark \ref{rem:el_WR},iv, there exists $\delta \in P\setminus \QQ(\sqrt{d})$ such that $\|\delta\|^2\le 16$. Let $\gamma_1',\gamma_2',\gamma_3',\gamma_4'$ as in Remark \ref{rem:integralbasis}. There exist integers $z_1,z_2,z_3,z_4$ such that $\delta =  z_1\gamma_1'+z_2\gamma_2'+z_3\gamma_3'+z_4\gamma_4'$ and thus \begin{align*}
	\|\delta\|^2=\dfrac{1}{4}\tron{\tron{4z_1+2z_2+z_3+z_4}^2+d\tron{2z_2+z_3-z_4}+2|a|d\tron{z_3^2+z_4^2}}.
	\end{align*}
 
	Since $\delta\notin \QQ(\sqrt{d})$, one has $z_3^2+z_4^2\ge 1$. Hence $|a|d \le \|\delta\|^2 \le 32 $ which occurs only if $|a|=1$ and $d\le 32$. It means $(a,d)\in \set{(1,17),(-1,17)}$ as $d\equiv 1 \pmod 8$ and $d$ is squarefree. In both cases of $(a,d)$, there are two prime ideals above $2$ and we can verify that these prime ideals are not WR by using Pari/GP. Hence, all prime ideals above $2$ is not WR when $d\equiv 1 \pmod 4, b\equiv 0\pmod 2$ and $a+b\equiv 1\pmod 4$.  
\end{proof}
Combining Lemmata \ref{lem:pideal_above_2_not_WR}, \ref{lem:2_ab3_not_WR},\ref{lem:ideal_2_WR} and \ref{lem:ideal_2_notWR}, we imply Proposition \ref{prop:ideal_2_WR}.



\begin{proposition}	\label{prop:ideal_2_WR}Let $F,a,b,c,d$ as in 
 Section \ref{sec:quarticfields}. Then a prime ideal above $2$ of $\mathcal{O}_F$ is WR if and only if $a=1,b=2,c=1,d=5$. In this case, $\mathcal{O}_F$ has a unique prime ideal above $2$.
\end{proposition} 
% Let $I,J,L$ be pairwise disjoint subsets of $\{1,\cdots ,r\}$. Now we will consider the ideal lattice $P_IP_J^2P_L^3$. First, one has a lemma as follows.

% \begin{lemma}
% 	\label{lem:integer_y}Let $J,L$ be two disjoint subsets of $\{1,\cdots ,r\}$. There exists an integer $y$ such that \begin{align}\label{eq:y}
% 		\tron{y^2-1}|a|c-2yab \equiv 0\pmod{p_Ip_J}	\end{align} 
% \end{lemma}
% \begin{proof}
% 	When $a>0$, the equation in \eqref{eq:y} is can be written as  $(b-cy)^2\equiv b^2+c^2\equiv 0 \mod p_Jp_K$   as $\gcd\tron{a,p_J p_L}=\gcd\tron{c,p_J p_L}=1$.  For all $i\in J\cup K$, the equation $(b-cy)^2 \equiv 0\mod p_i$ has solutions. By Chinese remainder theorem, $(b+cy)^2\equiv b^2+c^2\equiv 0 \mod p_Jp_K$  has solutions. When $a<0$, \eqref{eq:y} can be rewritten as $\tron{b+cy}^2 \equiv b^2+c^2 \equiv 0\pmod {p_Jp_L}$.
% 	By a similar argument as the one given in the proof in the case $a>0$, one obtains \eqref{eq:y} has solutions. As a consequence, there exits $y\in \ZZ$ which satisfies \eqref{eq:y}.
% \end{proof}
% \begin{lemma}\label{lem:especial_ele}Let $J,L$ be two disjoint subsets of $\{1,\cdots ,r\}$.
% 	\begin{enumerate}[i)]
% 		\item If $d$ is even or $d\equiv 1 \pmod 4$ and $b\equiv 1 \pmod 2$, then there exist $y$ such that $y\beta+\sigma(\beta)\in \tron{P_JP_L}^3$.
% 		\item If $d\equiv 1 \pmod 4, d\equiv 0\pmod 2$ and $a+b\equiv 3\pmod 4$, there exists $y$ such that $y\dfrac{\sigma(\beta)+\beta}{2}+\dfrac{\sigma(\beta)-\beta}{2}\in \tron{P_JP_L}^3.$
% 		\item If $d\equiv 1\pmod 4$, $b\equiv 0\pmod 2, a+b\equiv 1 \pmod 4$ and $a\equiv -c\pmod 4$, there exist $t,y$ such that $t+y\dfrac{1+\sqrt{d}-\beta-\sigma(\beta)}{4}+\dfrac{-1+\sqrt{d}+\beta-\sigma(\beta)}{4}\in \tron{P_JP_L}^2.$
% 		\item  If $d\equiv 1\pmod 4$, $b\equiv 0\pmod 2, a+b\equiv 1 \pmod 4$ and $a\equiv c\pmod 4$, there exist $t,y$ such that $t+y\dfrac{-1+\sqrt{d}-\beta-\sigma(\beta)}{4}+\dfrac{1+\sqrt{d}+\beta-\sigma(\beta)}{4}\in \tron{P_JP_L}^2.$
% 	\end{enumerate}
% \end{lemma}
% \begin{proof}
% 	Let $y$ be an integer given in Lemma \ref{lem:integer_y}. Remark that all elements mentioned in Lemma \ref{lem:el_PJPKsq} belong to $\mathcal{O}_K$. \begin{enumerate}[i)]
% 		\item One has $\N\tron{y\beta+\sigma(\beta)}= d\tron{(y^2-1)|a|c-2yab}^2$ and it is a multiple of $\tron{p_i}^3$ for all $i\in J\cup K$. Thus $y\beta+\sigma(\beta)\in P_i^3$ for all $i\in J\cup K$. Hence $y\beta+\sigma(\beta)\in \tron{P_JP_K}^3$.
% 		\item The element $y\dfrac{\sigma(\beta)+\beta}{2}+\dfrac{\sigma(\beta)-\beta}{2}\in \tron{P_JP_K}^3$ since it is in $\mathcal{O}_F$ (by Remark \ref{rem:integralbasis},iii), $P_i$ is the unique prime ideal of $\mathcal{O}_F$ above $p_i$ (by Lemma 
% 		\ref{idealPi0quartic}) for each $i\in J\cup K$  and
% 		$$p_J^3,p_K^3\mid \N\tron{y\dfrac{\sigma(\beta)+\beta}{2}+\dfrac{\sigma(\beta)-\beta}{2}}2=  \dfrac{1}{16}d\tron{|ac|\tron{y^2-1}-2yac}.$$
% 		\item Let $t$ be an integer such that $4t+y-1\equiv 0\pmod{ p_Ip_J}$ and $\rho_{JK}= t+y\dfrac{1+\sqrt{d}-\beta-\sigma(\beta)}{4}+\dfrac{-1+\sqrt{d}+\beta-\sigma(\beta)}{4}\in \tron{P_JP_K}^2  $. One has \begin{align*}
% 			\N\tron{\rho_{JK}} = \dfrac{\left[\tron{4t+y-1}^2+\tron{y+1}^2d+2ad\tron{1+y^2}\right]^2-4d\left[(4t+y-1)(y+1)-2aby+|a|c\tron{1-y^2}\right]^2}{4^4}.
% 		\end{align*}
% 		It implies $p_J^2,p_K^2\N\tron{\rho_{IJ}}$ and one obtain the result.
% 		\item By using the same technique with proof of iii).
% 	\end{enumerate}
% \end{proof}


% \begin{lemma}\label{lem:PIPJsqPKcub} With the integer $y$ as in Lemma \ref{lem:especial_ele}
% 	\begin{enumerate}[(i)]  
% 		\item \label{i)} If $d\equiv 2\pmod 4$, then $P_IP_J^2P_K^3= \ZZ p_Ip_Jp_K\oplus\ZZ p_K\sqrt{d}\oplus p_Jp_K\beta\oplus \ZZ \tron{y\beta+\sigma(\beta)}$.
% 		\item \label{ii)}If  $b=d=1\pmod 2$, then $P_IP_J^2P_K^3 = \ZZ p_Jp_Jp_K\oplus \ZZ \tron{\dfrac{p_Ip_Jp_K+p_K\sqrt{d}}{2}}\oplus p_Jp_K\beta \oplus \ZZ \tron{y\beta+\sigma(\beta)}$.
% 		\item \label{iii)} If $d\equiv 1\pmod 4,b\equiv 0\pmod 2,a+b\equiv 3 \pmod 4$, then $P_IP_J^2P_K^3 = \ZZ p_Ip_Jp_K\oplus \ZZ \dfrac{p_Ip_Jp_K+p_K\sqrt{d}}{2}\oplus \ZZ p_Jp_K\dfrac{\sigma(\beta)+\beta}{2}\oplus \ZZ \tron{y\dfrac{\sigma(\beta)+\beta}{2}+\dfrac{\sigma(\beta)-\beta}{2}}$.
% 	\end{enumerate}
% \end{lemma}
% \begin{proof}
% 	In the first case \ref{i)}, one has $p_K\sqrt{d},p_Jp_K \beta, y\beta+\sigma(\beta)$ belong to $P_IP_J^2P_K^3$ since $\beta \in P_I$ (see Lemma \ref{idealPi0quartic}) and by Lemma \ref{lem:especial_ele}. It means the lattice $L$ on the right-hand side is a sublattice of $P_IP_J^2P_K^3$. Hence, these two lattices are equal since they have the same index $p_Ip_J^2p_K^3$ in $\mathcal{O}_F$.
	
% 	In the remaining cases, using a similar argument as case \ref{i)}), it is sufficient to prove $\dfrac{p_Ip_Jp_K+p_K\sqrt{d}}{2}\in P_IP_J^2P_K^3.$ By Remark \ref{rem:integralbasis},ii) and iii), $\gamma_1'=1, \gamma_2'=\dfrac{1+\sqrt{d}}{2}\in \mathcal{O}_F$. One has $\dfrac{p_Ip_Jp_K+p_K\sqrt{d}}{2}= \dfrac{p_Ip_Jp_K-p_K}{2}\gamma_1' +p_K\gamma_2'\in\mathcal{O}_F$. Moreover, this element has a norm divisible by $p_I,p_J^2,p_K^3$. Hence $\dfrac{p_Ip_Jp_K+p_K\sqrt{d}}{2}\in P_IP_J^2P_K^3.$
% \end{proof}










% \begin{proposition}
% 	Let $I,J$ be disjoint subsets of $\{1,\cdots,r\}$. If $J$ is nonempty and  $s,b,d$ satisfy one of the following conditions:
% 	\begin{enumerate}[i)]
% 		\item $d\equiv 2 \pmod 4$, or
% 		\item $b\equiv d\equiv 1\pmod 2$,or
% 		\item $d\equiv 1\pmod 4, b\equiv 0\pmod 2$ and $a+b\equiv 3 \pmod 4$.
% 	\end{enumerate} 
% 	Then $P_IP_J^2$ is not WR.
% \end{proposition}

% \begin{proof}
% 	The proofs for the three cases are similar and thus it is sufficient to prove this proposition for the case $d \equiv 2 \pmod 4$. In this case, let $\delta\in P_IP_J^2$ be a nonzero vector. By Lemma \ref{lem:PIPJsqPKcub}, there exist integers $z_1,z_2,z_3,z_3$ such that $\delta = x_1p_Ip_J+x_2\sqrt{d}+x_3p_J\beta +x_4 \tron{y\beta+\sigma(\beta)}$. 
%  %\begin{align*}
% %		\delta &= x_1p_Ip_J+x_2\sqrt{d}+x_3p_J\beta +x_4 \tron{y\beta+\sigma(\beta)}
%   %\\
% 	%	& =x_1p_Ip_J+x_2\sqrt{d}+\tron{x_3p_J+x_4y}\beta +x_4\sigma(\beta). 
% %	\end{align*}
% 	By \eqref{length}, one obtains \begin{align*}
% 		\|\delta\|^2 = 4\tron{x_1^2p_I^2p_J^2+x_2^2d+\tron{x_3p_J+x_4y}^2|a|d+|a|dx_4^2}.
% 	\end{align*}
	
% 	We will claim that $\|\delta\|^2\ge \min \mathcal{S}$ where $\mathcal{S}=\{4p_I^2p_J^2,4 d\}$. It is clear if $x_1^2+x_2^2\ne 0$. Now we consider the case $x_1=x_2=0$. If $\tron{x_3p_J+x_4y}\cdot x_4\ne 0$ then $\|\delta\|^2 \ge 8\|a\|d> \min \mathcal{S}.$  If $x_3p_J +x_4y=0$ and $x_4 \ne 0$, then $p_J\mid x_4 y$ and from $\gcd\tron{x,p_J}=1$ (see Lemma \ref{lem:especial_ele}), one obtains $p_J\mid x_4\ne 0$. Hence $\|\delta\|^2 =4|a|d x_4^2 = 4p_J^2|a|d>\min \mathcal{S}$. If $x_4 = 0$ and $x_3p_J +x_4y \ne 0$ then $\|\delta\|^2 =4|a|d\tron{x_3p_J}^2\ge 4p_J^2|a|d>\min \mathcal{S}$. Therefore, $\|\delta\|^2 \ge \min \mathcal{S}.$ 
% 	Each value in the set $\mathcal{S}$ is only correspondent to the squared length of at most two independent vectors. Thus $P_IP_J^2$ is not WR. \end{proof}



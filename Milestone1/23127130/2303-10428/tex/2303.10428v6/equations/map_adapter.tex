\begin{align}
&\boldsymbol{z'}_{l}={\text{Softmax}}\left(\frac{\boldsymbol{Q}\boldsymbol{K}^{T} + {\color{purple}\boldsymbol{\widehat{Q}}\boldsymbol{\widehat{K}}^{T}}}{{\sqrt{D}}}
\right)\boldsymbol{V},\label{eq:map_adapt_1}\\
&{\color{purple}\boldsymbol{\widehat{Q}}, \boldsymbol{\widehat{K}}}~= \boldsymbol{z}_{l-1} \times {\color{purple}\boldsymbol{\widehat{W}}_q, \boldsymbol{\widehat{W}}_k},~~~{\color{purple}\widehat{\boldsymbol{W}}_{q,k}}\in \mathbb{R}^{D\times d} \label{eq:map_adapt_3}\\
&\boldsymbol{Q}, \boldsymbol{K}, \boldsymbol{V} = \boldsymbol{z}_{l-1} \times \boldsymbol{W}_q, \boldsymbol{W}_k, \boldsymbol{W}_v, \boldsymbol{W}_{q,k,v}\in \mathbb{R}^{D\times D} \label{eq:map_adapt_2}
\end{align}
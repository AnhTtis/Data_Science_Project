%%%%%%%%%%%%%%%%%%%%%%%%%% algorithm %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{algorithm}[t]
\caption{TPGM}\label{alg:alg1}
\KwData {$\mathcal{D}_{tr}$,$\mathcal{D}_{val}$}
\KwResult {$\Tilde{\theta}_{t+1}$}
Initialize $\Tilde{\theta}_0=\theta_0,\gamma_0=\epsilon$ \\
\For{$t=\{0,...,T-1\}$}{
    $\theta_{t+1} =\theta_{t} - \eta_t\nabla_\theta \mathcal{L}(x,y;\Tilde{\theta_{t}})\quad x,y\in\mathcal{D}_{tr}$\\
    \If{$t$ \text{mod} $f_{proj}$  $== 0$}{
    $\gamma_{t+1} =\text{ProjectionUpdate}(\mathcal{D}_{val},\theta_0,\theta_{t+1},\gamma_t)$\\
    $\Tilde{\theta}_{t+1} =\Pi(\theta_0,\theta_{t+1},\gamma_{t+1})$}
}
\end{algorithm}

\begin{algorithm}[t]

\caption{ProjectionUpdate}\label{alg:alg2}
\KwData {$\mathcal{D}_{val}$}
\KwResult {$\gamma_{t+1}$}
\For{$\tau=\{0,...,T_{proj}-1\}$}{
    $\Tilde{\theta} = \Pi(\theta_0,\theta_{t+1},\gamma_\tau)$\\
    $\gamma_{\tau+1} = \gamma_\tau - \zeta\nabla_\gamma \mathcal{L}(x,y;\Tilde{\theta}) \quad x,y\in\mathcal{D}_{val}$
}

\end{algorithm}
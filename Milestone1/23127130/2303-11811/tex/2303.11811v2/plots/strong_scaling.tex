\begin{tikzpicture}[scale=0.9]
    \begin{semilogxaxis}[
        xlabel=CPU-GPU pairs,
        ylabel=Time per time step (ms),
        log basis x={2},
        xmin=1,
        xmax=1024,
        ymode=log,
        log basis y={2},
        ymin=2^1,
        ymax=2^8,
        legend style={at={(1.03,0.5)},anchor=west},
        legend cell align={left},
        width=0.9*\textwidth,
        height=0.4*\textheight,
        grid
        ]
    \addplot[mark=*, mark size=2pt, ultra thick, matplotlibBlue] plot coordinates {
      (1,39.7032)
      (2,23.6182)
      (4,14.9395)
      (8,8.31498)
      (16,5.9862)
    };
    \addplot[mark=diamond*, mark size=2pt, ultra thick, matplotlibOrange] plot coordinates {
      (1,112.8384)
      (2,68.0132)
      (4,44.7182)
      (8,25.0752)
      (16,16.3686)
    };

    \addplot[mark=|, mark size=3pt, ultra thick, matplotlibBlue] plot coordinates {
      (8,45.791)
      (16,28.851)
      (32,18.39274)
      (64,11.43116)
      (128,8.03226)
    };
    \addplot[mark=star, mark size=3pt, ultra thick, matplotlibOrange] plot coordinates {
      (8,153.0142)
      (16,98.5738)
      (32,58.6966)
      (64,35.2456)
      (128,24.5442)
    };

    \addplot[mark=square*, mark size=2pt, ultra thick, matplotlibBlue] plot coordinates {
      (64,50.7164)
      (128,33.309)
      (256,21.5926)
      (512,12.40308)
      (1024,8.56194)
    };
    \addplot[mark=pentagon*, mark size=2pt, ultra thick, matplotlibOrange] plot coordinates {
      (64,188.972)
      (128,103.6524)
      (256,71.5496)
      (512,38.8016)
      (1024,27.6876)
    };

    \addplot[blue, ultra thick, dashed] coordinates { (1,39.7032) (16,39.7032/16) };
    \addplot[blue, ultra thick, dashed] coordinates { (1,112.8384) (16,112.8384/16) };

    \addplot[blue, ultra thick, dashed] coordinates { (8,45.791) (128,45.791/16) };
    \addplot[blue, ultra thick, dashed] coordinates { (8,153.0142) (128,153.0142/16) };

    \addplot[blue, ultra thick, dashed] coordinates { (64,50.7164) (1024,50.7164/16) };
    \addplot[blue, ultra thick, dashed] coordinates { (64,188.972) (1024,188.972/16) };
    \addlegendentry{Dilute case (small)}
    \addlegendentry{Dense case (small)}
    \addlegendentry{Dilute case (medium)}
    \addlegendentry{Dense case (medium)}
    \addlegendentry{Dilute case (large)}
    \addlegendentry{Dense case (large)}
    \addlegendentry{Ideal}
    \end{semilogxaxis}
\end{tikzpicture}

\pdfoutput=1
%
%
\documentclass[sigconf]{acmart}
%
%
%
%
%
%
\settopmatter{printacmref=true}
%
%
%
%
%
%
%


%
\newif\ifshortVersion
\shortVersionfalse %
%

\usepackage{xr}

%
\ifshortVersion
    \externaldocument{appendices}
\fi

\newcommand{\appendixRef}[1]{%
  \hspace{1sp}%
  \ifshortVersion%
    \cite[#1]{full-version}%
  \else%
    {#1}%
  \fi%
}

%
%
%
%
%
%
%
%

%
%
%
%
%


\copyrightyear{2024}
\acmYear{2024}
\setcopyright{acmlicensed}\acmConference[CCS '24]{Proceedings of the 2024 ACM SIGSAC Conference on Computer and Communications Security}{October 14--18, 2024}{Salt Lake City, UT, USA}
\acmBooktitle{Proceedings of the 2024 ACM SIGSAC Conference on Computer and Communications Security (CCS '24), October 14--18, 2024, Salt Lake City, UT, USA}
\acmDOI{10.1145/3658644.3670347}
\acmISBN{979-8-4007-0636-3/24/10}



\begin{CCSXML}
<ccs2012>
   <concept>
       <concept_id>10002978.10003006.10003013</concept_id>
       <concept_desc>Security and privacy~Distributed systems security</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
 </ccs2012>
\end{CCSXML}

\ccsdesc[500]{Security and privacy~Distributed systems security}


\usepackage{import}
\import{./lib/}{boilerplate_pdflatex.tex}
\import{./lib/}{colors.tex}
\import{./lib/}{tikzpgfplot.tex}
\import{./lib/}{tikzpgfplot_parulalinestyles.tex}
\import{./lib/}{tikzpgfplot_plotstyles.tex}
\import{./lib/}{tikzpgfplot_blockchainstructures.tex}
\import{./lib/}{tables.tex}
\import{./lib/}{algorithms.tex}
%
\import{./lib/}{lateplate_pdflatex.tex}

\usepackage{color}
\renewcommand\UrlFont{\color{blue}\rmfamily}

\input{custom_commands}



%

%
%
%
%
%





%
%
%
%
%
%
%


%
%
%
%
%
%
%
%
%
%
%
%
%
%


%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
\title[Nakamoto Consensus under Bounded Processing Capacity]{Nakamoto Consensus under Bounded Processing Capacity}
%



%
%

%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%



\author{Lucianna Kiffer}
\orcid{0000-0003-2022-7993}
\affiliation{%
    \institution{ETH Z\"urich}%
    \city{Zurich}%
    \country{Switzerland}%
}
\email{lkiffer@ethz.ch}
%
\author{Joachim Neu}
\orcid{0000-0002-9777-6168}
\affiliation{%
    \institution{Stanford University}%
    \city{Stanford}%
    \state{CA}%
    \country{USA}%
}
\email{jneu@stanford.edu}
%
\author{Srivatsan Sridhar}
\orcid{0000-0002-1880-570X}
\affiliation{%
    \institution{Stanford University}%
    \city{Stanford}%
    \state{CA}%
    \country{USA}%
}
\email{svatsan@stanford.edu}
%
\author{Aviv Zohar}
\orcid{0000-0001-8539-9222}
\affiliation{%
    \institution{The Hebrew University}%
    \city{Jerusalem}%
    \country{Israel}%
}
\email{avivz@cs.huji.ac.il}
%
\author{David Tse}
\orcid{0000-0003-1460-5900}
\affiliation{%
    \institution{Stanford University}%
    \city{Stanford}%
    \state{CA}%
    \country{USA}%
}
\email{dntse@stanford.edu}

\thanks{LK, JN, SS and AZ are listed alphabetically.
\ifshortVersion%
    Full version with appendices: \cite{full-version}%
\fi}


%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%


%
\newcommand{\gitSourceUrl}[0]{\url{https://github.com/avivz/finitebwlc}}
%

%
%

%


%
\makeatletter
\def\ps@headings{%
\def\@oddhead{\mbox{}\scriptsize\rightmark \hfil \thepage}%
\def\@evenhead{\scriptsize\thepage \hfil \leftmark\mbox{}}}
\makeatother
\pagestyle{headings}



%
%
%
%

%
%

%
%
%
%

%
%
%

%
%
%
%
%


%
%

%
\setcounter{secnumdepth}{3}
\renewcommand\thesubsubsection{\thesubsection.\arabic{subsubsection}}
\crefname{section}{Sec.}{Secs.}
\Crefname{section}{Sec.}{Secs.}
\crefname{appendix}{App.}{Apps.}
\Crefname{appendix}{App.}{Apps.}
\crefname{subsection}{Sec.}{Secs.}
\Crefname{subsection}{Sec.}{Secs.}
\crefname{subappendix}{App.}{Apps.}
\Crefname{subappendix}{App.}{Apps.}
\crefname{subsubsection}{Sec.}{Secs.}
\Crefname{subsubsection}{Sec.}{Secs.}
\crefname{subsubappendix}{App.}{Apps.}
\Crefname{subsubappendix}{App.}{Apps.}
\crefname{subsubsubsection}{Sec.}{Secs.}
\Crefname{subsubsubsection}{Sec.}{Secs.}
\crefname{subsubsubappendix}{App.}{Apps.}
\Crefname{subsubsubappendix}{App.}{Apps.}

%
\newcommand{\myparagraph}[1]{\smallskip\noindent\textbf{#1.}~~}

%
%
%
%
%
%
%
%
%
%
%
%
%
%
%

%
%
%
%
%

%
%
%

%
\setcounter{tocdepth}{4}

%
\usepackage{thmtools}

%
\newcommand\blfootnote[1]{%
  \begingroup%
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup%
}




\begin{document}
%
\begin{abstract}
    For Nakamoto's longest-chain consensus protocol, whose proof-of-work (PoW) and proof-of-stake (PoS) variants power major blockchains such as Bitcoin and Cardano, we revisit the classic problem of the security--performance tradeoff:
    Given a network of nodes with finite 
    communication- and computation-resources, against what fraction of adversary power is Nakamoto consensus (NC) secure for a given block production rate?
    %
    State-of-the-art analyses of NC fail to answer this question, because their \emph{bounded-delay} model does not capture the rate limits to nodes' processing of blocks, which cause congestion when blocks are released in quick succession.
    %
    We develop a new analysis technique to prove a refined security--performance tradeoff for PoW NC in a \emph{bounded-capacity} model.
    In this model, we show that, in contrast to the classic bounded-delay model, Nakamoto's private attack is no longer the worst attack, and a new attack we call the \emph{\teaserattack}, that exploits congestion, is strictly worse.
    %
    In PoS, equivocating blocks can exacerbate congestion, making  traditional PoS NC insecure except at very low block production rates.
    To counter such equivocation spamming, we present a variant of PoS NC we call \emph{\ProtMid} (\emph{\ProtShort}), which achieves the \emph{same resilience} as PoW NC.
\end{abstract}
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%



\keywords{Nakamoto; consensus; blockchain; capacity; bandwidth; spamming.}


\maketitle
%
%
%
%
%

\input{01_introduction.tex}
\input{02_attacks.tex}
\input{03_modelprotocol.tex}
\input{04_analysis_00.tex}
\input{05_pos_blanc.tex}
\input{05b_pos_predictable_validity.tex}
\input{06_outlook.tex}


\section*{Acknowledgment}
%
We thank
%
Lei Yang, Mohammad Alizadeh,
Sundararajan Renganathan, David Mazi√®res,
Ertem Nusret Tas,
Ghassan Karame,
Florian Tschorsch,
and
George Danezis
for fruitful discussions.
The work of LK, JN, and AZ
was conducted in part
during Dagstuhl Seminar \#22421.
LK is supported by the
armasuisse Science and Technology CYD Distinguished Postdoctoral Fellowship.
JN is supported by the Protocol Labs PhD Fellowship.
JN and SS are supported by a gift from
the Ethereum Foundation and by a research hub funded by Input Output Global Inc.
SS is suported by NSF grant CCF-1563098.
AZ is supported by grant \#1443/21 from the Israel Science Foundation.
%


%
%
%

%
%

%
%
\bibliographystyle{ACM-Reference-Format}
\bibliography{references}

\ifshortVersion
    \appendix
    
    \section*{Appendices}
    Full version with appendices: \cite{full-version}.

    \nocite{doi:10.1080/01621459.1963.10500830,duchi-hoeffding,stackexchange-math-rwreturnto0,poisson_tail}
\else
    \nocite{full-version}
    \input{appendices.tex}
\fi

%
%
%


%
%
%
%



%

%
%
%
%
%
%
%
%
%


\end{document}

\begin{figure}[tb]
    \centering
    \begin{tikzpicture}[blockchain]
        %
        \scriptsize
        \begin{scope} [xshift=-1cm]

            \node at (-1.5,0) {(a)};

            \node [block] (G) at (0,0) {G};

            \node [block-hon] (h1) at (0,-1) {1};
            \draw [link-hon] (h1) -- (G);

            %
            %

            
            \node [block-blank,opacity=1] (hNEW1) at (-0,-2) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW2) at (-0,-2.2) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW3) at (-0,-1.8) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW4) at (-0,-2.4) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW5) at (-0.2,-1.9) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW6) at (-0.2,-2.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW7) at (-0.2,-2.3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW8) at (0.2,-1.9) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW9) at (0.2,-2.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW10) at (0.2,-2.3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW1) -- (h1);

            \node [block-adv,dashed,opacity=0.3] (a1) at (1,-1) {1};
            \draw [link-adv,dashed,opacity=0.3] (a1.north) -- (G);
            \node [block-adv,dashed,opacity=0.3] (a2) at (1,-2) {2};
            \draw [link-adv,opacity=0.3,dashed] (a2.north) -- (a1);
            \node [block-adv,dashed,opacity=0.3] (a3) at (1,-3) {3};
            \draw [link-adv,opacity=0.3,dashed] (a3.north) -- (a2);
        \end{scope} 
        
        \begin{scope}[xshift=2cm]

            \node at (-1.5,0) {(b)};


            \node [block] (G) at (0,0) {G};

            \node [block-hon] (h1) at (0,-1) {1};
            \draw [link-hon] (h1) -- (G);

            \node [block-hon,opacity=0.3] (h2) at (0,-2) {2};
            \draw [link-hon,opacity=0.3] (h2) -- (h1);

            
            \node [block-blank,opacity=1] (hNEW1) at (-1,-2) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW2) at (-1,-2.2) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW3) at (-1,-1.8) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW5) at (-1.2,-1.9) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW6) at (-1.2,-2.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW7) at (-1.2,-2.3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW8) at (-0.8,-1.9) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW9) at (-0.8,-2.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW10) at (-0.8,-2.3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW1) -- (h1);
            \node [block-blank,opacity=1] (hNEW4) at (0,-3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW4) -- (h2);
            
            \node [block-adv,dashed,opacity=0.3] (a1) at (1,-1) {1};
            \draw [link-adv,dashed,opacity=0.3] (a1.north) -- (G);
            \node [block-adv,dashed,opacity=0.3] (a2) at (1,-2) {2};
            \draw [link-adv,opacity=0.3,dashed] (a2.north) -- (a1);
            \node [block-adv,dashed,opacity=0.3] (a3) at (1,-3) {3};
            \draw [link-adv,opacity=0.3,dashed] (a3.north) -- (a2);
        \end{scope}

        \begin{scope}[xshift=5cm]

            \node at (-1.5,0) {(c)};


            \node [block] (G) at (0,0) {G};

            \node [block-hon] (h1) at (0,-1) {1};
            \draw [link-hon] (h1) -- (G);

            \node [block-hon,opacity=0.3] (h2) at (0,-2) {2};
            \draw [link-hon,opacity=0.3] (h2) -- (h1);

            
            \node [block-blank,opacity=1] (hNEW1) at (-1,-2) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW2) at (-1,-2.2) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW3) at (-1,-1.8) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW5) at (-1.2,-1.9) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW6) at (-1.2,-2.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW7) at (-1.2,-2.3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW8) at (-0.8,-1.9) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW9) at (-0.8,-2.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW10) at (-0.8,-2.3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW1) -- (h1);
            \node [block-blank,opacity=1] (hNEW4) at (0,-3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW4) -- (h2);
            
            \node [block-adv,opacity=0.3] (a1) at (1,-1) {1};
            \draw [link-adv,opacity=0.3] (a1.north) -- (G);
            \node [block-adv,opacity=0.3] (a2) at (1,-2) {2};
            \draw [link-adv,opacity=0.3] (a2.north) -- (a1);
            \node [block-adv,opacity=0.3] (a3) at (1,-3) {3};
            \draw [link-adv,opacity=0.3] (a3.north) -- (a2);
        \end{scope}
        
        \begin{scope}[xshift=-1cm,yshift=-2.5cm]%

            \node at (-1.5,0) {(d)};

            \node [block] (G) at (0,0) {G};

            \node [block-hon] (h1) at (0,-1) {1};
            \draw [link-hon] (h1) -- (G);

            \node [block-hon,opacity=0.3] (h2) at (0,-2) {2};
            \draw [link-hon,opacity=0.3] (h2) -- (h1);

            
            \node [block-blank,opacity=1] (hNEW1) at (-1,-2) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW2) at (-1,-2.2) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW3) at (-1,-1.8) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW5) at (-1.2,-1.9) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW6) at (-1.2,-2.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW7) at (-1.2,-2.3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW8) at (-0.8,-1.9) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW9) at (-0.8,-2.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW10) at (-0.8,-2.3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW1) -- (h1);
            \node [block-blank,opacity=1] (hNEW4) at (0,-3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW4) -- (h2);
            
            \node [block-adv,opacity=1] (a1) at (1,-1) {1};
            \draw [link-adv,opacity=1] (a1.north) -- (G);
            \node [block-adv,opacity=0.3] (a2) at (1,-2) {2};
            \node [block-blank] (a2q) at (1.6,-2) {\textcolor{myParula07Red}{?}};
            \draw [link-adv,opacity=0.3] (a2.north) -- (a1);
            \node [block-adv,opacity=0.3] (a3) at (1,-3) {3};
            \node [block-blank] (a3q) at (1.6,-3) {\textcolor{myParula07Red}{?}};
            \draw [link-adv,opacity=0.3] (a3.north) -- (a2);
        \end{scope}

        \begin{scope}[xshift=2cm,yshift=-2.5cm]%

            \node at (-1.5,0) {(e)};

            \node [block] (G) at (0,0) {G};

            \node [block-hon] (h1) at (0,-1) {1};
            \draw [link-hon] (h1) -- (G);

            \node [block-hon, opacity=1] (h2) at (0,-2) {2};
            \draw [link-hon] (h2) -- (h1);
            \node [block-hon, opacity=1] (h2-2) at (-1,-2) {2};
            \draw [link-hon] (h2-2) -- (h1);

            
            \node [block-blank,opacity=1] (hNEW1) at (-0,-3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW2) at (-0,-3.2) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW3) at (-0,-2.8) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW5) at (-0.2,-2.9) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW6) at (-0.2,-3.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW7) at (-0.2,-3.3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW8) at (0.2,-2.9) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW9) at (0.2,-3.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW10) at (0.2,-3.3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW1) -- (h2);
            \node [block-blank,opacity=1] (hNEW4) at (0,-3.4) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            %
            
            \node [block-adv,opacity=1] (a1) at (1,-1) {1};
            \node [block-adv,opacity=0.3] (a2) at (1,-2) {2};
            \node [block-blank] (a2q) at (1.6,-2) {\textcolor{myParula07Red}{?}};
            \node [block-adv,opacity=0.3] (a3) at (1,-3) {3};
            \node [block-blank] (a3q) at (1.6,-3) {\textcolor{myParula07Red}{?}};
            \node [block-adv,dashed,opacity=0.3] (a4) at (1,-4) {4};

            \draw [link-adv,opacity=1] (a1.north) -- (G);
            \draw [link-adv,opacity=1] (a2.north) -- (a1);
            \draw [link-adv,opacity=0.3] (a3.north) -- (a2);
            \draw [link-adv,dashed,opacity=0.3] (a4.north) -- (a3);

        \end{scope}

        \begin{scope}[xshift=5cm,yshift=-2.5cm]%

            \node at (-1.5,0) {(f)};

            \node [block] (G) at (0,0) {G};

            \node [block-hon] (h1) at (0,-1) {1};
            \draw [link-hon] (h1) -- (G);

            \node [block-hon, opacity=1] (h2) at (0,-2) {2};
            \draw [link-hon] (h2) -- (h1);
            \node [block-hon, opacity=1] (h2-2) at (-1,-2) {2};
            \draw [link-hon] (h2-2) -- (h1);
            \node [block-hon, opacity=0.3] (h3) at (0,-3) {3};
            \draw [link-hon, opacity=0.3] (h3) -- (h2);

            
            \node [block-blank,opacity=1] (hNEW1) at (-1,-3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW2) at (-1,-3.2) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW3) at (-1,-2.8) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW5) at (-1.2,-2.9) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW6) at (-1.2,-3.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW7) at (-1.2,-3.3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW8) at (-0.8,-2.9) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW9) at (-0.8,-3.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW10) at (-0.8,-3.3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW1) -- (h2);
            \node [block-blank,opacity=1] (hNEW4) at (-0,-4) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW4) -- (h3);
            %
            
            \node [block-adv,opacity=1] (a1) at (1,-1) {1};
            \node [block-adv,opacity=1] (a2) at (1,-2) {2};
            \node [block-adv,opacity=0.3] (a3) at (1,-3) {3};
            \node [block-blank] (a3q) at (1.6,-3) {\textcolor{myParula07Red}{?}};
            \node [block-adv,opacity=0.3] (a4) at (1,-4) {4};
            \node [block-blank] (a4q) at (1.6,-4) {\textcolor{myParula07Red}{?}};


            \draw [link-adv,opacity=1] (a1.north) -- (G);
            \draw [link-adv,opacity=1] (a2.north) -- (a1);
            \draw [link-adv,opacity=0.3] (a3.north) -- (a2);
            \draw [link-adv,opacity=0.3] (a4.north) -- (a3);

        \end{scope}


    \end{tikzpicture}%
    \vspace{-0.5em}%
    \caption{
        %
        \textbf{\Teaserattack:}
        %
        \textcolor{myParula05Green}{Green}/\textcolor{myParula07Red}{red} are honest/adversary blocks, 
        %
        and 
        %
        numbers on blocks indicate 
        %
        height in the blockchain. Semi-transparent blocks have been announced (\ie, headers released) but were not yet downloaded by honest nodes.
        Blocks with a dashed outline are mined privately by the adversary but not announced.
        %
        %
        (a) The adversary begins with a short private lead, while honest nodes attempt to extend the honest block $1$. 
        %
        %
        %
        %
        %
        %
        %
        %
        (b) An honest node mines a block at height $h=2$, and announces it. Until this block is downloaded, all honest nodes (except the one who mined block $h$) continue to mine on top of the block at height $h-1$. %
        %
        (c) 
        %
        The adversary announces %
        %
        its chain with height $h+1$, and the
        %
        %
        %
        honest nodes prioritize its download beginning with %
        block $1$.
        %
        (d) Honest nodes keep mining as before while requesting the content of the longest chain (the adversary's chain).
        %
        %
        When honest nodes request the adversary's block of height $h=2$, they find it to be unavailable (`\textcolor{myParula07Red}{?}'), \ie, the adversary did not release its content.
        %
        Honest nodes then resume downloading the honest block of height $h=2$.
        %
        (e) Eventually, all honest nodes download some %
        block at height $2$. The delay in this download means new blocks by honest nodes could have been mined at height $2$, thereby not growing the chain.
        %
        Meanwhile, if the adversary mined another block, then they are back to %
        step (a), \ie, the adversary has a $2$ block lead and %
        can repeat steps (b)--(e) at the next height $h+1$, 
        as shown in step (f).
        %
        %
        %
        %
        %
        %
        %
    }
    \label{fig:attack-teaser}%
\end{figure}
\begin{figure}
    \centering
    \begin{tikzpicture}[blockchain]
        \small
        \begin{scope}[xshift=0cm]

            \node at (-1.5,0) {(c)};


            \node [block] (G) at (0,0) {G};

            \node [block-hon] (h1) at (0,-1) {1};
            \draw [link-hon] (h1) -- (G);

            \node [block-hon] (h2) at (0,-2) {2};
            \node [block-hon, opacity=0.3] (h3) at (0,-3) {3};
            \draw [link-hon] (h2) -- (h1);
            \draw [link-hon, opacity=0.3] (h3) -- (h2);

            
            \node [block-blank,opacity=1] (hNEW1) at (-1,-3) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW2) at (-1.2,-3.1) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank,opacity=1] (hNEW3) at (-1,-3.2) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW1) -- (h2);
            \node [block-blank, opacity=1] (hNEW4) at (-0,-4) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW4) -- (h3);
            
            \node [block-adv,opacity=1] (a1) at (1,-1) {1};
            \node [block-adv,opacity=0.3] (a2) at (1,-2) {2};
            \node [block-adv,opacity=0.3] (a3) at (1,-3) {3};
            \node [block-adv,opacity=0.3] (a4) at (1,-4) {4};

            \draw [link-adv,opacity=1] (a1.north) -- (G);
            \draw [link-adv,opacity=0.3] (a2.north) -- (a1);
            \draw [link-adv,opacity=0.3] (a3.north) -- (a2);
            \draw [link-adv,opacity=0.3] (a4.north) -- (a3);
        \end{scope}
        
        \begin{scope}[xshift=3cm]

            \node at (-1.5,0) {(f)};

            \node [block] (G) at (0,0) {G};

            \node [block-hon] (h1) at (0,-1) {1};
            \draw [link-hon] (h1) -- (G);

            \node [block-hon] (h2) at (0,-2) {2};
            \draw [link-hon] (h2) -- (h1);
            \node [block-hon, opacity=1] (h3) at (0,-3) {3};
            \draw [link-hon] (h3) -- (h2);
            \node [block-hon, opacity=1] (h3-2) at (-1,-3) {3};
            \draw [link-hon] (h3-2) -- (h2);
            \node [block-hon, opacity=0.3] (h4-2) at (-1,-4) {4};
            \draw [link-hon, opacity=0.3] (h4-2) -- (h3-2);

            
            \node [block-blank,opacity=1] (hNEW1) at (-1,-5) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW1) -- (h4-2);
            \node [block-blank,opacity=1] (hNEW2) at (-2,-4) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW2) -- (h3-2);
            \node [block-blank,opacity=1] (hNEW3) at (-2,-3.8) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \node [block-blank, opacity=1] (hNEW4) at (-0,-4) {\includegraphics[width=0.6em]{figures/icon-pick-emoji_u26cf.png}};
            \draw [link-hon,opacity=1] (hNEW4) -- (h3);
            
            \node [block-adv,opacity=1] (a1) at (1,-1) {1};
            \node [block-adv,opacity=1] (a2) at (1,-2) {2};
            \node [block-adv,opacity=0.3] (a3) at (1,-3) {3};
            \node [block-blank] (a3q) at (1.6,-3) {\textcolor{myParula07Red}{?}};
            \node [block-adv,opacity=0.3] (a4) at (1,-4) {4};
            \node [block-blank] (a4q) at (1.6,-4) {\textcolor{myParula07Red}{?}};

            \draw [link-adv,opacity=1] (a1.north) -- (G);
            \draw [link-adv,opacity=1] (a2.north) -- (a1);
            \draw [link-adv,opacity=0.3] (a3.north) -- (a2);
            \draw [link-adv,opacity=0.3] (a4.north) -- (a3);

            \node [block-adv,opacity=0.3] (a1p) at (2.6,-1) {1'};
            \node [block-adv,opacity=0.3] (a2p) at (2.6,-2) {2'};
            \node [block-adv,opacity=0.3] (a3p) at (2.6,-3) {3'};
            \node [block-adv,opacity=0.3] (a4p) at (2.6,-4) {4'};
            \node [block-blank] (a4pq) at (3.2,-4) {\textcolor{myParula07Red}{?}};
            \node [block-adv,opacity=0.3] (a5p) at (2.6,-5) {5'};
            \node [block-blank] (a5pq) at (3.2,-5) {\textcolor{myParula07Red}{?}};

            \draw [link-adv,opacity=0.3] (a1p.north) -- (G);
            \draw [link-adv,opacity=0.3] (a2p.north) -- (a1p);
            \draw [link-adv,opacity=0.3] (a3p.north) -- (a2p);
            \draw [link-adv,opacity=0.3] (a4p.north) -- (a3p);
            \draw [link-adv,opacity=0.3] (a5p.north) -- (a4p);

        \end{scope}

        %

        %

        %

        %
        %

        %
        %
        %
        %
        %
        %
        %
        %
        %
        %

            
        %
        %
        %
        %
        %
        %
            
        %
        %
        %
        %

        %
        %
        %
        %

        %
        %
        %
        %
        %

        %
        %
        %
        %
        %

        %
        %
        %
        %
        %
        %

        %
        %
        %
        %
        %
        %

        %


    \end{tikzpicture}%
    \vspace{-0.5em}%
    \caption{
        \textbf{\PoSTeaserattack:}
        Steps (a)-(e) are the same as in the \teaserattack (\cref{fig:attack-teaser}). Recall that in (c), to delay the download of the honest block at height $h=3$, the adversary announces a block at height $h+1$ which it was withholding. Since this is the longest announced chain, honest nodes prioritize downloading block $2$ on this chain.
        %
        New steps: (f) Once an honest node produces a block at height $4$, the adversary announces equivocations $1',2',...$ of its withheld chain of length $5$ instead of announcing one new block extending the chain $1,2,...$ Therefore, honest nodes have to process blocks $1',2'$ even though they processed $1,2$ earlier. The adversary makes content available for only $1',2',3'$.
        As the attack goes on, the adversary's announced chain gets longer, and it consumes even more of the honest node's processing capacity.
        %
        }
    \label{fig:attack-pos-teaser}
\end{figure}
\begin{figure}[tb]
    \centering
    %
    %
    \begin{tikzpicture}[blockchainold,x=0.8cm,y=0.4cm]
        \footnotesize

        \coordinate (G) at (-0.75,0) {};

        \node [block-gray] (bi) at (0,0) {};
        \node [yshift=1.5em] (bli) at (bi) {$b$};
        \node [block-gray] (bj) at (1,0) {};
        \node [yshift=1.5em] (blj) at (bj) {$b_j$};
        \node [block-gray] (bk) at (2.5,0) {};
        \node [yshift=1.5em] (blk) at (bk) {$b_k$};
        \node [block-gray] (bl) at (4,0) {};
        \node [yshift=1.5em] (bll) at (bl) {$b_l$};

        \node [block-gray] (B1) at (5,0) {};
        
        \node [block-gray] (B21) at (5.5,-1) {};
        \node [block-gray] (B22) at (5.5,1) {};
        
        %
        \node [block-gray] (B32) at (6.2,1) {};
        
        %

        \node [align=left,anchor=west] (dCq) at (7,-1) {$\dC_q(t')$};
        \node [align=left,anchor=west] (dCp) at (7,1) {$\dC_p(t)$};

        \draw [->,dashed,shorten >=1em] (dCp) -- (B32);
        \draw [->,dashed,shorten >=1em] (dCq) -- (B21);

        %
        \draw [link] (B32) -- (B22);
        \draw [link] (B22) -- (B1);

        %
        \draw [link] (B21) -- (B1);

        \node [inner sep=0pt] (dots1) at (0.5,0) {...};
        \node [inner sep=0pt] (dots2) at (1.75,0) {......};
        \node [inner sep=0pt] (dots3) at (3.25,0) {......};
        \node [inner sep=0pt] (dots4) at (4.5,0) {...};
        \coordinate (dots4repl) at (4.5,0);

        \draw [link] (bi) -- (G);
        \draw [link] (dots1) -- (bi);
        \draw [link,-] (bj) -- (dots1);
        \draw [link] (dots2) -- (bj);
        \draw [link,-] (bk) -- (dots2);
        \draw [link] (dots3) -- (bk);
        \draw [link,-] (bl) -- (dots3);
        \draw [link] (dots4) -- (bl);
        \draw [link,-] (B1) -- (dots4);

        \coordinate (bot) at (-1,0);
        %
        %

        %
        %
        %
        %
        %
        %
        %
        %

        %
        %
        %

        %
        %

        %

        \coordinate (a) at (bi |- bot);
        \coordinate (b) at (dots3 |- bot);
        \draw [|-|] ([yshift=-1.5em]a) -- ([yshift=-1.5em]b) node [pos=0.5,below] {$\keqproof = 4\Kcp$ blocks};
        \coordinate (a) at (bi |- bot);
        \coordinate (b) at (dots4repl |- bot);
        \draw [|-|] ([yshift=-3.5em]a) -- ([yshift=-3.5em]b) node [pos=0.5,below] {$\confDepth = 6\Kcp+1$ blocks};

        \draw [<-,dashed] (bll.north) -- ([yshift=0.4cm]bll.north) node [anchor=south west,align=left,xshift=-3.5em] {Latest possible equivocation proof against $b$ stabilizes};
        \draw [<-,dashed] (blk.north) -- ([yshift=0.8cm]blk.north) node [anchor=south west,align=left,xshift=-3.5em] {Includes equivocation proof against $b$ (if any)};
        \draw [<-,dashed] (blj.north) -- ([yshift=1.2cm]blj.north) node [anchor=south west,align=left,xshift=-3.5em] {All honest nodes have downloaded $b$ or seen an equivocation};


        %

        %
        %

        %
        %
        %
        %
        %
        %
        %
        %
        %
        %
        %

        %
        %
        %
        %
        %
        %
        %
        %
        %
        %
        %
        %

        %
        %


        %
        %
        %

        %
        %
        %
        %
        %

        %
        %
        %
        %

        %
        %
        %

        %
        %
        %
        %

        %
        %
        %

        %
        %
        %
        %
        %
        %
        %
        %
        %

    \end{tikzpicture}%
    \vspace{-1em}%
    \caption{%
        Illustration for the security proof of \ProtShort (\cref{thm:safety-and-liveness-pos}).
        %
        Consider a block $b$ that is $\confDepth$-deep in the longest downloaded chain of a node.
        %
        %
        \Iindices $j,k,l$ are \sltcps.
        Since \sltcps stabilize (\cref{lem:cps-stabilize-informal}), the corresponding blocks $b_j, b_k, b_l$ are in all honest nodes' downloaded longest chains.
        At \sltcp $j$, we know for sure that all honest nodes 
        %
        either downloaded $b$'s content or saw an equivocation for it, because they have downloaded $b_j$'s content.
        At \sltcp $k$, we know for sure that if $b$ had an equivocation, preventing download of its content, then an equivocation proof against $b$ must have entered the chain.
        At \sltcp $l$, we know for sure that the last block that can add an equivocation proof against $b$ has stabilized (as the deadline of $\keqproof$ blocks has passed).
        Thus, a ledger formed from $\confDepth$-deep blocks (sufficient to obtain three \sltcps) will remain safe.
    }
    %
    \label{fig:pos-safety-proof}
\end{figure}


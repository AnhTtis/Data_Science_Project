\pdfoutput=1
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts


\ifCLASSOPTIONcompsoc
    %
    %
    \usepackage[nocompress]{cite}
\else
    %
    \usepackage{cite}
\fi

\ifCLASSOPTIONcompsoc
    \usepackage[caption=false,font=footnotesize,labelfont=sf,textfont=sf]{subfig}
\else
    \usepackage[caption=false,font=footnotesize]{subfig}
\fi



\usepackage{import}
\import{./lib/}{boilerplate_pdflatex.tex}
\import{./lib/}{colors.tex}
\import{./lib/}{tikzpgfplot.tex}
\import{./lib/}{tikzpgfplot_parulalinestyles.tex}
\import{./lib/}{tikzpgfplot_plotstyles.tex}
\import{./lib/}{tikzpgfplot_blockchainstructures.tex}
\import{./lib/}{tables.tex}
\import{./lib/}{algorithms.tex}
%
\import{./lib/}{lateplate_pdflatex.tex}

\input{custom_commands}

%
%
%
%
%
%
%


%
%
%
%
%
%
%
%
%
%
%
%
%
%

%
\title{Security of Nakamoto Consensus under Congestion}


%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%

%


\author{%
\IEEEauthorblockN{Lucianna Kiffer}%
\IEEEauthorblockA{lkiffer@ethz.ch}%
\and%
\IEEEauthorblockN{Joachim Neu}%
\IEEEauthorblockA{jneu@stanford.edu}%
\and%
\IEEEauthorblockN{Srivatsan Sridhar}%
\IEEEauthorblockA{svatsan@stanford.edu}%
\and%
\IEEEauthorblockN{Aviv Zohar}%
\IEEEauthorblockA{avivz@cs.huji.ac.il}%
\and%
\IEEEauthorblockN{David Tse}%
\IEEEauthorblockA{dntse@stanford.edu}%
%
\thanks{LK, JN, SS and AZ are listed alphabetically.}%
}


%
%
\newcommand{\gitSourceUrl}[0]{\url{https://github.com/avivz/finitebwlc/tree/stable}}

\newcommand{\fullVersionRef}[1]{#1}
%


%
\makeatletter
\def\ps@headings{%
\def\@oddhead{\mbox{}\scriptsize\rightmark \hfil \thepage}%
\def\@evenhead{\scriptsize\thepage \hfil \leftmark\mbox{}}}
\makeatother
\pagestyle{headings}



%
%
%
%


\begin{document}
\maketitle
\begin{abstract}
    Nakamoto consensus (NC) powers major proof-of-work (PoW) and proof-of-stake (PoS) blockchains such as Bitcoin or Cardano.
    Given a network of nodes with certain communication and computation capacities,
    against what fraction of adversarial power (the resilience) is Nakamoto consensus secure for a given block production rate?
    Prior security analyses of NC used a \emph{bounded delay} model which does not capture network congestion resulting from high block production rates, bursty release of adversarial blocks, and in PoS, spamming due to equivocations.
    For PoW, we find a new attack, called \emph{teasing attack}, that exploits congestion to increase the time taken to download and verify blocks, thereby succeeding at lower adversarial power than the \emph{private attack} which was deemed to be the worst-case attack in prior analysis.
    By adopting a \emph{bounded bandwidth} model to capture congestion, and through an improved analysis method,
    we identify the resilience of PoW NC for a given block production rate.
    In PoS, we augment our attack with equivocations to further increase congestion, making the vanilla PoS NC protocol insecure against \emph{any} adversarial power except at very low block production rates.
    To counter equivocation spamming in PoS, we present a new NC-style protocol \emph{\SanitizingPoS} (\sapos)
    %
    which achieves the same resilience as PoW NC.
%
%
    %
    %
    %
    %
    %
    %
    %
%
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
\end{abstract}


\input{01_introduction.tex}
\input{01b_attacks.tex}
\input{02_modelprotocol.tex}
\input{03_analysis.tex}
\input{04_pow.tex}
\input{05_pos.tex}
\input{06_throughputloss.tex}
\input{08_outlook.tex}


\section*{Acknowledgment}
%
We thank
%
Lei Yang, Mohammad Alizadeh,
Sundararajan Renganathan, David Mazi√®res,
Ertem Nusret Tas,
Ghassan Karame,
Florian Tschorsch,
and
George Danezis
for fruitful discussions.
The work of LK, JN, and AZ
was conducted in part
during Dagstuhl Seminar \#22421.
JN is supported by the Protocol Labs PhD Fellowship.
JN and SS are supported by a gift from
the Ethereum Foundation.
LK is supported by the
armasuisse Science and Technology CYD Distinguished Postdoctoral Fellowship.
AZ is supported by grant \#1443/21 from the Israel Science Foundation.
%


%
%
%

%
%

\bibliographystyle{IEEEtran}
\bibliography{references}


\appendices
\crefalias{section}{appendix}
\crefalias{subsection}{subappendix}
\crefalias{subsubsection}{subsubappendix}

%
\input{A03_experiment_details.tex}
\input{A05_security_proof_details.tex}
\input{A06_pow_proofs.tex}
\input{A07_pos_proofs.tex}
%
%
%
%
\input{A08_full_version_proofs.tex}
\input{A04_proof_details.tex}
\input{A01_pseudocode_helpers.tex}
\input{A02_pos_attack.tex}
%
%



%
%
%


%
%
%
%


\end{document}
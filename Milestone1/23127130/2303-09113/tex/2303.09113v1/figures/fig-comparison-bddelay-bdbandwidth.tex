\begin{figure}[tb]%
    \centering%
    \begin{tikzpicture}[]%
        \node [xshift=-1.2cm,yshift=2.4cm,align=left,anchor=south west] at (0,0) {\small\textbf{(a)\ \ PoW/PoS LC assuming bounded delay~\cite[eqn.~(2)]{dem20}, \cite{tight_bitcoin}:}};
        \begin{axis}[
                mysimpleresilienceplot01,
                name=plot1,
                xmode=log,
                xlabel={Relative block production rate $\lambda\Delta$},
            ]

            \addplot [draw=none,name path=xaxis,domain={1e-8:1e8}] {0};
            \addplot [draw=none,name path=xaxisplus1,domain={1e-8:1e8}] {1};

            \addplot [black,no marks,name path=resilience] table [x=relblockfrequency,y=beta] {figures/fig-comparison-bddelay-bdbandwidth-bddelay.txt};

            \addplot [myparula51,fill opacity=0.45] fill between [of=resilience and xaxis];
            \addplot [myparula71,fill opacity=0.45] fill between [of=resilience and xaxisplus1];

            \node [at={(current axis.south west)},anchor=south west,yshift=2pt,color=white] {\footnotesize $\leftarrow$ High bandwidth};
            \node [at={(current axis.north east)},anchor=north east,yshift=-2pt,color=white] {\footnotesize Low bandwidth $\rightarrow$};

        \end{axis}
    \end{tikzpicture}%
    \\[0.5em]%
    \begin{tikzpicture}[]%
        \node [xshift=-1.2cm,yshift=2.4cm,align=left,anchor=south west] at (0,0) {%
            \small\textbf{%
                (b)\ \ PoS LC without \equivocationremoval in bounded%
            }\\
            \small\textbf{%
                \phantom{(b)\ \ }bandwidth networks
                (\tikz[x=0.75em,y=0.75em]{ \draw [draw=myParula05Green,thick,fill=myParula05Green,fill opacity=0.3] (0,0) rectangle (1,1); }
                \cite{bwlimitedposlc},
                \tikz[x=0.75em,y=0.75em]{ \draw [draw=myParula07Red,thick,fill=myParula07Red,fill opacity=0.3] (0,0) rectangle (1,1); }
                this work (\lemref{tp-attack-never-terminates})):%
            }};
        \begin{axis}[
                mysimpleresilienceplot01,
                name=plot1,
                xmode=log,
                xlabel={Relative block production rate $\lambda/\bwtime$},
            ]

            \addplot [draw=none,name path=xaxis,domain={1e-8:1e8}] {0};
            \addplot [draw=none,name path=xaxisplus1,domain={1e-8:1e8}] {1};


            \addplot [myparula71,no marks,name path=posattack10] table [x=lbyC,y=beta] {figures/fig-comparison-bddelay-bdbandwidth-bdbandwidth-newresult-posattack-kappa10.txt};
            \addplot [myparula73,no marks,name path=posattack100] table [x=lbyC,y=beta] {figures/fig-comparison-bddelay-bdbandwidth-bdbandwidth-newresult-posattack-kappa100.txt};
            \addplot [myparula72,no marks,name path=posattack1000] table [x=lbyC,y=beta] {figures/fig-comparison-bddelay-bdbandwidth-bdbandwidth-newresult-posattack-kappa1000.txt};

            \addplot [myparula71,fill opacity=0.2] fill between [of=posattack10 and xaxisplus1];
            \addplot [myparula71,fill opacity=0.2] fill between [of=posattack100 and xaxisplus1];
            \addplot [myparula71,fill opacity=0.2] fill between [of=posattack1000 and xaxisplus1];


            \addplot [myparula51,no marks,name path=resilience10] table [x=lbyC,y=beta] {figures/fig-comparison-bddelay-bdbandwidth-bdbandwidth-oldresult-kappa10.txt};
            \addplot [myparula53,no marks,name path=resilience100] table [x=lbyC,y=beta] {figures/fig-comparison-bddelay-bdbandwidth-bdbandwidth-oldresult-kappa100.txt};
            \addplot [myparula52,no marks,name path=resilience1000] table [x=lbyC,y=beta] {figures/fig-comparison-bddelay-bdbandwidth-bdbandwidth-oldresult-kappa1000.txt};

            \addplot [myparula51,fill opacity=0.2] fill between [of=resilience10 and xaxis];
            \addplot [myparula51,fill opacity=0.2] fill between [of=resilience100 and xaxis];
            \addplot [myparula51,fill opacity=0.2] fill between [of=resilience1000 and xaxis];


            \node (kappa10) at (axis cs:1e-2,0.20) {\footnotesize $10$ bit security};
            \node (kappa100) at (axis cs:1e-2,0.13) {\footnotesize $100$ bit security};
            \node (kappa1000) at (axis cs:1e-2,0.06) {\footnotesize $1000$ bit security};
            %
            %
            %

            \draw [-latex] (kappa10) -- (axis cs:3.7e-4,0.20);
            \draw [-latex] (kappa10) -- (axis cs:5.5e-1,0.20);
            \draw [-latex] (kappa100) -- (axis cs:7.5e-5,0.13);
            \draw [-latex] (kappa100) -- (axis cs:3.75e-1,0.13);
            \draw [-latex] (kappa1000) -- (axis cs:1.4e-5,0.06);
            \draw [-latex] (kappa1000) -- (axis cs:3.5e-1,0.06);

        \end{axis}
    \end{tikzpicture}%
    \\[0.5em]%
    \begin{tikzpicture}[]%
        \node [xshift=-1.2cm,yshift=2.4cm,align=left,anchor=south west] at (0,0) {\small\textbf{(c)\ \ PoW/PoS LC in bounded bandwidth networks (this work):}};
        \begin{axis}[
                mysimpleresilienceplot01,
                name=plot1,
                xmode=log,
                xlabel={Relative block production rate $\lambda/\bwtime$},
            ]

            \addplot [draw=none,name path=xaxis,domain={1e-8:1e8}] {0};
            \addplot [draw=none,name path=xaxisplus1,domain={1e-8:1e8}] {1};


            \addplot [myparula51,no marks,name path=resilience] table [x=lbyC,y=beta] {figures/fig-comparison-bddelay-bdbandwidth-bdbandwidth-newresult.txt};

            \addplot [myparula51,fill opacity=0.45] fill between [of=resilience and xaxis];


            \addplot [myparula72,thick,no marks,name path=teaserattack] table [x=lbyC,y=beta] {figures/fig-comparison-bddelay-bdbandwidth-exp_teaser-attack.txt};

            \path[name path=teaserattack_pareto] (axis cs:0.7512295,1) -- (axis cs:1e10,1) -- (axis cs:1e10,0.03711442450736367);
            \addplot [myparula72,fill opacity=0.3] fill between [of=teaserattack and teaserattack_pareto];


            %
            \addplot[myparula71,thick,no marks,name path=greedyattack]  coordinates {(2,+1) (2,-1)};

            \path[name path=greedyattack_pareto] (axis cs:1e10,10) -- (axis cs:1e10,-10);
            \addplot [myparula71,fill opacity=0.3] fill between [of=greedyattack and greedyattack_pareto];


            \node (attack1) at (axis cs:4.5e-2,0.3) {\footnotesize \Teaserattack (\secref{teaser-attack})};
            \node (attack2) at (axis cs:4.5e-2,0.23) {\footnotesize \Greedyattack (\secref{greedy-attack})};
            \node (security) at (axis cs:1e-1,0.16) {\footnotesize \thmref{safety-and-liveness-pow,safety-and-liveness-pos}};

            \draw [-latex,shorten >=1pt] (attack1) -- (axis cs:4e-1,0.4);
            \draw [-latex,shorten >=1pt] ([xshift=-2pt,yshift=2pt]attack2.south east) -- (axis cs:2,0.1);
            \draw [-latex] (security) -- (axis cs:7e-3,0.06);

        \end{axis}
    \end{tikzpicture}%
    \vspace{-0.5em}%
    \caption[]{%
        Regions of
        fraction $\beta$ of adversarial nodes,
        block production rate $\lambda$,
        and network model parameters
        delay bound $\Delta$ or bandwidth $\bwtime$,
        with
        security proofs
        (\tikz[x=0.75em,y=0.75em]{ \draw [draw=myParula05Green,thick,fill=myParula05Green,fill opacity=0.3] (0,0) rectangle (1,1); })
        and attacks
        (\tikz[x=0.75em,y=0.75em]{ \draw [draw=myParula07Red,thick,fill=myParula07Red,fill opacity=0.3] (0,0) rectangle (1,1); })
        for Nakamoto consensus.
        (a) In the bounded delay model,
        the tradeoff is fully characterized by $\beta = \frac{1-\beta}{1+(1-\beta)\blkratetime\Delta}$.
        (b)
        In \cite{bwlimitedposlc},
        $\blkratetime/\bwtime$ decreases with
        the 
        %
        security parameter $\kappa$.
        One of our attacks (\secref{pos-attack})
        shows that \emph{some} dependency of $\blkratetime/\bwtime$ on $\kappa$
        is unavoidable
        for the protocols studied in~\cite{bwlimitedposlc}.
        (c) In this work,
        our attacks show that
        resilience $\beta$ has a sharp cutoff at large $\blkratetime/\bwtime$,
        rather than an asymptotic decay suggested by
        the bounded delay analysis.
        Our security proof shows that $\blkratetime/\bwtime$ 
        %
        independent of
        $\kappa$
        suffices for secure
        PoW, and PoS LC with a protocol modification \emph{\equivocationremoval}.
    }%
    \label{fig:comparison-bddelay-bdbandwidth}%
\end{figure}%
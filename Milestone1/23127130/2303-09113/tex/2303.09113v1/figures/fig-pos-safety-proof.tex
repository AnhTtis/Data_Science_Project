\begin{figure}
    \centering
    %
    %
    \begin{tikzpicture}[blockchainold,x=0.8cm,y=0.4cm]
        \footnotesize

        \coordinate (G) at (-0.75,0) {};

        \node [block-gray] (bi) at (0,0) {};
        \node [yshift=1.5em] (bli) at (bi) {$b_i$};
        \node [block-gray] (bj) at (1,0) {};
        \node [yshift=1.5em] (blj) at (bj) {$b_j$};
        \node [block-gray] (bk) at (3,0) {};
        \node [yshift=1.5em] (blk) at (bk) {$b_k$};
        \node [block-gray] (bl) at (5,0) {};
        \node [yshift=1.5em] (bll) at (bl) {$b_l$};

        \node [block-gray] (B1) at (6.5,0) {};
        \node [block-gray] (B21) at (7,-1) {};
        \node [block-gray] (B22) at (7,1) {};
        \node [block-gray] (B31) at (7.6,-1) {};
        \node [block-gray] (B32) at (7.8,1) {};
        \node [block-gray] (B42) at (8.4,1) {};

        \draw [link] (B42) -- (B32);
        \draw [link] (B32) -- (B22);
        \draw [link] (B22) -- (B1);

        \draw [link] (B31) -- (B21);
        \draw [link] (B21) -- (B1);

        \node [inner sep=0pt] (dots1) at (0.5,0) {...};
        \node [inner sep=0pt] (dots2) at (2,0) {......};
        \node [inner sep=0pt] (dots3) at (4,0) {......};
        \node [inner sep=0pt] (dots4) at (5.75,0) {...};
        \coordinate (dots4repl) at (6,0);

        \draw [link] (bi) -- (G);
        \draw [link] (dots1) -- (bi);
        \draw [link,-] (bj) -- (dots1);
        \draw [link] (dots2) -- (bj);
        \draw [link,-] (bk) -- (dots2);
        \draw [link] (dots3) -- (bk);
        \draw [link,-] (bl) -- (dots3);
        \draw [link] (dots4) -- (bl);
        \draw [link,-] (B1) -- (dots4);

        \coordinate (bot) at (-1,0);
        %
        %

        %
        %
        %
        %
        %
        %
        %
        %

        %
        %
        %

        %
        %

        %

        \coordinate (a) at (bi |- bot);
        \coordinate (b) at (dots3 |- bot);
        \draw [|-|] ([yshift=-3em]a) -- ([yshift=-3em]b) node [pos=0.5,below] {$\keqproof$ blocks};
        \coordinate (a) at (bi |- bot);
        \coordinate (b) at (dots4repl |- bot);
        \draw [|-|] ([yshift=-5em]a) -- ([yshift=-5em]b) node [pos=0.5,below] {$\confDepth$ blocks};

        \draw [Latex-,dashed] (bll.north) -- ([yshift=0.5cm]bll.north) node [anchor=south west,align=left,xshift=-1em] {Latest possible equivocation\\proof against $b_i$ stabilizes};
        \draw [Latex-,dashed] (blk.north) -- ([yshift=1.25cm]blk.north) node [anchor=south west,align=left,xshift=-1em] {Includes equivocation proof against $b_i$};
        \draw [Latex-,dashed] (blj.north) -- ([yshift=1.7cm]blj.north) node [anchor=south west,align=left,xshift=-1em] {Header of $b_i$ seen by all honest nodes};


        %

        %
        %

        %
        %
        %
        %
        %
        %
        %
        %
        %
        %
        %

        %
        %
        %
        %
        %
        %
        %
        %
        %
        %
        %
        %

        %
        %


        %
        %
        %

        %
        %
        %
        %
        %

        %
        %
        %
        %

        %
        %
        %

        %
        %
        %
        %

        %
        %
        %

        %
        %
        %
        %
        %
        %
        %
        %
        %

    \end{tikzpicture}%
    \vspace{-1em}%
    \caption{%
        Illustration for the proof of \lemref{safety-and-liveness-comb-pos}.
        %
        Consider an arbitrary block $b_i$ that is $\confDepth$-deep in the longest chain of a node.
        %
        %
        \Iindices $j,k,l$ are \sltcps.
        Since \sltcps stabilize, the corresponding blocks $b_j, b_k, b_l$ are in all honest nodes' longest chains.
        At \sltcp $j$, we know for sure that all honest nodes saw the header of $b_i$ because they saw the header for $b_j$.
        At \sltcp $k$, we know for sure that if $b_i$ had an equivocation, then an equivocation proof against $b_i$ must have entered the chain.
        At \sltcp $l$, we know for sure that the last block that can add an equivocation proof against $b_i$ has stabilized (as the deadline of $\keqproof$ blocks has passed).
        Thus, a ledger formed from $\confDepth$-deep blocks (sufficient to obtain three \sltcps) will remain safe.
    }
    \label{fig:pos-safety-proof}
\end{figure}


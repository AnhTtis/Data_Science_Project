%
\section{Partial Product Update and Task Solvability} \label{sec:PPU}
%

%

In \cite{Inf:2021:GoubaultLedentRajsbaum}, 
product update is used to define distributed tasks and protocols. 
A product update model $\Prod{\cplI}{\actMf{A}}$ 
is an epistemic model where each possible world
is a pair $(X,t)$ of a facet $X$ of the complex $\cplI$
and an action $t$ of the action model $\actMf{A}$ 
such that the action $t$ stands for a possible output for 
the input $X$. Task solvability is then 
defined by the existence of a morphism from 
the product update model of the protocol to that of the task. 

We introduce a generalized construction called \keywd{partial product update}, 
which applies to partial epistemic models, and thereby 
refine the logical method so that it can be applied to a larger class of
task solvability problem in which agents may die. 

%
%
%
%
%
%
%
%

%
%

\subsection{Partial product update}
\label{subsec:PPUbyAction}

\begin{definition}[action model]
    An \keywd{action model} $\Action=\langle T, \sim, \PreOp \rangle$ is
    a triple consisting of: 
    \begin{itemize}
        \item A partial epistemic frame $\langle T, \sim \rangle$, 
        where each $t\in T$ is called an \keywd{action};
        \item A function $\PreOp: T \zto \ModLangK$ that assigns
        an epistemic formula $\PreOp(t)$, called the \keywd{precondition},
        to each action $t\in T$.  
    \end{itemize}

    

    %
    %

    %
    %
    %
    %
    %
    %
\end{definition}

%
%

%
%
%
%
%
%


%

%
%

The precondition $\PreOp(t)$ describes the condition 
for the action $t$ to occur. 

%
%

%

\begin{definition}[partial product update]
    \label{def:partialProductUpdate}
    Let $\Mepistemic = \KripkeTuple{\Mepistemic}$ be a partial epistemic model
    and $\Action = \ActionTuple{\Action}$ be an action model,
    both having a proper partial epistemic frame. 
    A \keywd{partial product update} of $\Mepistemic$ by $\Action$, 
    written $\ImProd{\Mepistemic}{\Action}$, 
    is a partial epistemic model $\KripkeTuple{}$ defined by:
    \begin{itemize}
        \item $W = \{
                  (\PreEquiv{t}{X}, t)
                  \mid
                  X \in W^{\Mepistemic},\:
                  t \in W^{\Action},\:
                  \AliveSet{t}\subseteq \AliveSet{X}, \text{ and }
                  \Mepistemic, X \models \Pre{t}
                  \}$, 
        %

        \item $
                  (\PreEquiv{t}{X}, t) \sim_a (\PreEquiv{s}{Y}, s)$ iff
                  $X \sim^{\Mepistemic}_a Y$ and $t \sim^{\Action}_a s
              $, and 

        \item $
                  L\bigl((\PreEquiv{t}{X}, t)\bigr) =
                  \displaystyle\bigcap_{X' \in \PreEquiv{t}{X}} L^{\Mepistemic}(X')
              $, 
    \end{itemize}
    where $\PreEquiv{t}{X}$ is the set of facets defined by 
    $\PreEquiv{t}{X} = \{
        Y \in W^{\Mepistemic}
        \mid
        %
        X \sim^{\Mepistemic}_{\Alives{t}} Y
        \text{ and }
        \Mepistemic, Y \models \Pre{t}
        \}$.

    %
    %


    %
\end{definition}

%
%
%
%

%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%

%
%
%
%

%
%
%
%
%

%
%
%

%
%
%
%
%
%

%
%
%

%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
    

%
%

%
%
%
%
%

%
%
%


    
    %
    %
    %

%
%
%

%
%
%
%
%
%
%
%
%
%

%
%
%
%
%

%
%
%

%
%
%
%
%

%
%
%
%

\begin{proposition}
    The partial product update 
    $\ImProd{\Mepistemic}{\Action}$ is a partial epistemic model.
    In particular, if both  $\Mepistemic$ and $\Action$ are proper, 
    so is $\ImProd{\Mepistemic}{\Action}$.
\end{proposition}

%
%
%

\begin{proof}  
    Let $\ImProd{\Mepistemic}{\Action}=\KripkeTuple{}$ be a triple, 
    which is constructed from a partial epistemic model
    $\Mepistemic = \KripkeTuple{\Mepistemic}$ 
    and an action model $\Action = \ActionTuple{\Action}$, 
    as in Definition~\ref{def:partialProductUpdate}.

    Let us first show that the relation $\sim_a$ is well-defined,
    that is, the choice of facet $X$ in $(\PreEquiv{t}{X}, t)$ 
    does not affect the relation.  
    %
    Suppose $(\PreEquiv{t}{X}, t) \sim_a (\PreEquiv{s}{Y}, s)$,
    $\PreEquiv{t}{X} = \PreEquiv{t}{X'}$, and
    $\PreEquiv{s}{Y} = \PreEquiv{s}{Y'}$. 
    By the definition, $X \sim^{\Mepistemic}_a Y$, 
    $\Mepistemic, X\models \PreOp(t)$, $\Mepistemic, X'\models \PreOp(t)$, 
    $\Mepistemic, Y\models \PreOp(s)$, $\Mepistemic, Y'\models \PreOp(s)$,    
    and $t \sim^{\Action}_a s$.
    Since $X' \in \PreEquiv{t}{X'} = \PreEquiv{t}{X}$, we have 
    $X \sim^{\Mepistemic}_a X'$ for all $a\in\Alives{t}$. Similarly, 
    $Y \sim^{\Mepistemic}_a Y'$ for all $a\in\Alives{t}$. 
    Hence $X' \sim^{\Mepistemic}_a X \sim^{\Mepistemic}_a Y \sim^{\Mepistemic}_a Y'$
    and therefore $(\PreEquiv{t}{X'}, t) \sim_a (\PreEquiv{s}{Y'}, s)$.

    We show that $\ImProd{\Mepistemic}{\Action}$ is a partial epistemic model.
    It suffices to show that every $\sim_a$ is a PER. 
    This follows immediately from the symmetry and transitivity 
    of $\sim^{\Mepistemic}_a$ and $\sim^{\Action}_a$. 

    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %

    %
    %
    %
    %
    %
    %
    %
    %
    %
    %
    %

    Suppose $\Mepistemic$ and $\Action$ are both proper models. 
    We show that  $\ImProd{\Mepistemic}{\Action}=\KripkeTuple{}$ is a proper model.
    Assume $(\PreEquiv{t}{X}, t), (\PreEquiv{s}{Y}, s) \in W$
    are possible worlds such that $(\PreEquiv{t}{X}, t) \neq (\PreEquiv{s}{Y}, s)$, 
    which implies $\PreEquiv{t}{X} \neq \PreEquiv{s}{Y}$ or $t \neq s$. 
    It suffices to show that there exists an agent $a \in \Ag$
    such that $(\PreEquiv{t}{X}, t) \not\sim_a (\PreEquiv{s}{Y}, s)$.
    %
    If $t \neq s$, since $\Action$ is proper, 
    $t \not\sim^{\Action}_a s$ for some $a \in \Ag$. Thus, 
    $(\PreEquiv{t}{X}, t) \not\sim_a (\PreEquiv{s}{Y}, s)$.
    %
    Suppose otherwise, i.e., $\PreEquiv{t}{X} \neq \PreEquiv{s}{Y}$.
    We may assume, without loss of generality, that 
    $X' \not\in \PreEquiv{t}{Y}$ for some $X' \in \PreEquiv{t}{X}$.
    This implies $\PreEquiv{t}{X} = \PreEquiv{t}{X'}$ and $\Mepistemic, X' \models \Pre{t}$.
    Hence, $X' \not\in \PreEquiv{t}{Y}$ implies
    $X' \not\sim^{\Mepistemic}_a Y$ for some agent $a \in \Alives{t}$.
    Therefore we have $(\PreEquiv{t}{X}, t) = (\PreEquiv{t}{X'}, t) \not\sim_a (\PreEquiv{t}{Y}, t) = (\PreEquiv{s}{Y}, s)$.
\end{proof}
    

       

%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%

%
%
%
%
%
%

%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%

%
%
%
%
%
%
%
%
%
%
%
%
%
%
%

%
%
%
%
%

%
%
%
%
%
%
%
%
%

%
%
%

%
%
%
%
%
%

%
%
%
%
%
%

%
%
%
%
%
%
%
%
%

%

%

%
%
%
%
%

%
%
%
%
%
%

%
%
%
%

%
%
%
%
%
%
%
%
%
%
%

%
%
%
%
%
%

%
%
%
%

%
%
%
%
%
%
%
%
%
%

The original product update $\Prod{\Mepistemic}{\actMf{A}}$ \cite{Inf:2021:GoubaultLedentRajsbaum}
is an instance of the partial product update $\ImProd{\Mepistemic}{\actMf{A}}$.
When the indistinguishability relations of both $\Mepistemic$ and $\actMf{A}$ are equivalence relations, 
rather than partial equivalence relations, and $\Mepistemic$ is proper, 
every possible world $(\PreEquiv{t}{X},t)$ in $\ImProd{\Mepistemic}{\actMf{A}}$ 
can be identified with $(X,t)$ in $\Prod{\Mepistemic}{\actMf{A}}$.
This is because $\PreEquiv{t}{X}=\{ X \}$, since 
$\Alives{t} = \Ag$ for all $t \in \Action$ and $\Mepistemic$ is proper.  



%
%
%
%
%
%
%
%
%

%
%
%

%

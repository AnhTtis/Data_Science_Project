\documentclass[10pt]{amsart}
\usepackage{amsmath}
\usepackage{amssymb,amscd}
\usepackage{graphicx}
\usepackage{mathdots}
\usepackage{mathrsfs}       % for the script X used by \XXS
%\usepackage{srcltx}
%%%%%%%%%%%%%%%%
%\usepackage[curve]{xypic}
\usepackage{graphicx}
\usepackage{bbm} % for mathbbm
%\usepackage{fullpage} % for reducing margins
\usepackage{microtype} % to adjust spacing between characters to reduce the number of bad line breaks.

\usepackage{colonequals} %\colonequal
\usepackage{mathtools}% \vcentcolon=

\usepackage{tikz,tkz-euclide}
\usepackage{tikz-cd}
\usetikzlibrary{arrows}
\usepackage{tikz-3dplot}


%\usetikzlibrary{knots,arrows.meta}


\usepackage{subcaption} %Subfigure



%Hyperref package
\usepackage{color}\definecolor{darkblue}{rgb}{0,0.1,.5}
\usepackage[colorlinks=true,linkcolor=darkblue, urlcolor=darkblue, citecolor=darkblue]{hyperref}
\usepackage{cleveref}


\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{question}[theorem]{Question}


\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{construction}[theorem]{Construction}

\theoremstyle{remark}
\newtheorem*{remark}{Remark}

\numberwithin{equation}{section}


\def \begineq{\begin{equation}}
\def \endeq{\end{equation}}

\def \bb{\mathbb}
\def \mb{\mathbf}
\def \mc{\mathcal}
\def \mf{\mathfrak}
\def \ms{\mathscr}

\def \CC{{\bb{C}}}
\def \CP{\bb{C}{\rm P}}

\def \NN{{\bb{N}}}
\def \PP{{\bb{P}}}
\def \QQ{{\bb{Q}}}
\def \RR{{\bb{R}}}
\def \ZZ{{\bb{Z}}}


\def \ad{{\rm ad}}
\def \Ann{\mathop{\mathrm{Ann}}}
\def \Aut{\mathop{\mathrm{Aut}}}
\def \bideg{\mathop{\mathrm{bideg}}}
\def \Diff{\mathop{\mathrm{Diff}}}
\def \End{\mathop{\mathrm{End}}}
\def \Hom{\mathop{\mathrm{Hom}}}
\def \Span{\mathop{\mathrm{Span}}}
\def \rank{\mathop{\mathrm{rank}}}
\def \Tor{\mathop{\mathrm{Tor}}\nolimits}

\def \im{\mathop{\mathrm{im}}}

\def\IL{\mathit{IL}}
\def\CH{\mathit{CH}}
\def\HH{\mathit{HH}}
\def\PH{\mathcal{PH}}
\def\PHZ{\mathcal{PHZ}}
\def\PHHZ{\mathcal{PHHZ}}
\def\BB{\mathit{BB}}
\def\BDB{\mathbb{BB}}
\def\dgh{\mathop{d_{\mathit{GH}}}}
\def\dpgh{\mathop{d'_{\mathit{GH}}}}



\def\zk{\mathcal Z_K}

\DeclareMathAlphabet{\mathbbmsl}{U}{bbm}{m}{sl}


%\def \qed{\hfill $\squ
\def\red#1{\textcolor{red}{#1}}
\def\blue#1{\textcolor{blue}{#1}}

\newcommand{\ts}{\textsc}


%\renewcommand{\1}{1\!\!1}

\makeatletter
\@namedef{subjclassname@2020}{%
  \textup{2020} Mathematics Subject Classification}
\makeatother





\begin{document}

\title[Stability theorem for bigraded barcodes]
{A stability theorem for bigraded persistence 
barcodes}

\author[Bahri]{Anthony Bahri}
\address{Department of Mathematics, Rider University, Lawrenceville, NJ 08648, USA}
\email{bahri@rider.edu}

\author[Limonchenko]{Ivan Limonchenko}
\address{Mathematical Institute of the Serbian Academy of Sciences and Arts (SASA),
Belgrade, Serbia}
% \address{National Research University Higher School of Economics, Moscow, Russia}
\email{ilimonchenko@gmail.com}

\author[Panov]{Taras Panov}
\address{Department of Mathematics and Mechanics, Moscow
State University, Russia;\newline
Institute for Information Transmission Problems, Russian Academy of Sciences, Moscow, Russia;\newline
National Research University Higher School of Economics, Moscow, Russia}
%;\newline Institute of Theoretical and Experimental Physics, Moscow}
\email{tpanov@mech.math.msu.su}

\author[Song]{Jongbaek Song}
\address{Department of Mathematics Education, Pusan National University, Pusan, Republic of Korea}
\email{jongbaek.song@pusan.ac.kr}

\author[Stanley]{Donald Stanley}
\address{Department of Mathematics and Statistics, University of Regina, Regina, Saskatchewan, Canada}
\email{Donald.Stanley@uregina.ca}




% \date{\today}

\subjclass[2020]{Primary 57S12, 55N31, 57Z25; Secondary 13F55, 55U10}

\keywords{Persistence module, persistent homology, barcode, moment-angle complex, polyhedral product, Stanley-Reisner ring, double homology}

\begin{abstract} 
We define bigraded persistent homology modules and bigraded barcodes of a finite pseudo-metric space $X$ using the ordinary and double homology of the moment-angle complex associated with the Vietoris--Rips filtration of~$X$. We prove a stability theorem for the bigraded persistent double homology modules and barcodes. 
\end{abstract}

\maketitle

\section{Introduction}\label{intro}
Given a finite pseudo-metric space $(X,d_X)$, the Vietoris--Rips filtration is a sequence $\{R(X,t)\}_{t\ge0}$ of filtered flag simplicial complexes  associated with~$X$. The simplicial homology of $R(X,t)$ is used to define the most basic persistence modules in data science, the persistent homology of~$X$.

In toric topology, a finer homological invariant of a simplicial complex $K$ is considered, the bigraded homology of the moment-angle complex $\mathcal Z_K$ associated with~$K$. The moment-angle complex $\mathcal Z_K$ is a toric space patched from products of discs and circles parametrised by simplices in a simplicial complex~$K$. It has a bigraded cell decomposition and the corresponding bigraded homology groups $H_{-i,2j}(\mathcal Z_K)$ contain the simplicial homology groups $H_k(K)$ as a direct summand. Algebraically, the bigraded homology modules $H_{-i,2j}(\mathcal Z_K)$ are the bigraded components of the $\Tor$-modules of the Stanley--Reisner ring $\mathbf k[K]$ and can be expressed via the Hochster decomposition as the sum of the reduced simplicial homology groups of all full subcomplexes $K_I$ of~$K$.

The bigraded homology of the moment-angle complexes $\mathcal Z_{R(X,t)}$ associated with the Vietoris--Rips filtration $\{R(X,t)\}_{t\ge0}$ can be used to define bigraded persistent homology modules and bigraded barcodes of a point cloud (data set)~$X$, as observed in~\cite{l-p-s-s}. Similar ideas have been pursued in~\cite{l-f-l-x23, li-xi22}. Simple examples show that bigraded persistent homology can distinguish between points clouds that are indistinguishable by the ordinary persistent homology (see Example~\ref{2sets}).

However, the approach to define bigraded persistence via the homology of moment-angle complexes has two fundamental drawbacks. First, calculating simplicial homology groups of all full subcomplexes (or samples) in $R(X,t)$ is much resource-consuming from the computational viewpoint. Second, bigraded persistent homology lacks a stability property, which is important for applications of persistent homology in data science~\cite{c-e-h07}. 

Bigraded double homology of moment-angle complexes was introduced and studied in~\cite{l-p-s-s}. Besides theoretical interest in toric topology and polyhedral products theory, bigraded double homology fixes both drawbacks of ordinary bigraded homology mentioned above, therefore opening a way for a more efficient application in data analysis. 

Double homology $\HH_*(\mathcal Z_K)$ is the homology of the chain complex $\CH_*(\mathcal Z_K)=(H_*(\mathcal Z_K),\partial')$ obtained by endowing the bigraded homology of~$\mathcal Z_K$ with the second differential~$\partial'$. 
The bigraded double homology modules are smaller than the bigraded homology modules, and therefore might be more accessible from a computational viewpoint. More importantly, persistent homology modules defined from the bigraded double homology of the Vietoris--Rips filtration have a stability property, which roughly says that the bigraded barcode is robust to changes in the input data. 

In Section~\ref{sec-prelim} we review persistence modules, standard persistent homology and barcodes. 

In Section~\ref{macbbn} we define the bigraded persistent homology and persistent double homology modules and the corresponding bigraded barcodes.

The Stability Theorem for persistent homology says that the Gromov--Hausdorff distance between two finite pseudo-metric spaces (data sets) is bounded from below by the interleaving distance between their persistent homology modules. The interleaving distance between persistent homology modules can be identified, via the Isometry Theorem, with the $\infty$-Wasserstein (bottleneck) distance between the corresponding barcodes. 

In Section~\ref{sec_stability_HZK} we prove a Stability Theorem for bigraded persistent double homology (Theorem~\ref{thm_BB_HH_stable}). This is done in two stages. First, we prove that bigraded persistent homology satisfies a stability property with respect to a modified Gromov--Hausdorff distance, in which the infimum is taken over bijective correspondences only (Theorem~\ref{thm_BB_stable}). Second, a stability for bigraded persistent double homology is established using the invariance of double homology with respect to the doubling operation on simplicial complexes.


\subsection*{Acknowledgements}
Research of Limonchenko and Panov is funded within the framework of the HSE University Basic Research Program. 
% Limonchenko is also a Young Russian Mathematics award winner and would like to thank its sponsors and jury.
Limonchenko was supported by the Serbian Ministry of Science, Innovations and Technological Development through the Mathematical Institute of the Serbian Academy of Sciences and Arts. 
Song is supported by a New Faculty Research Grant of Pusan National University, 2023. He was also supported by a KIAS Individual Grant (SP076101) at Korea Institute for Advanced Study. Stanley is supported by NSERC. 
The authors are grateful to Daniela Egas Santander for helpful conversations at the Fields Institute. This work began at the Fields Institute during the Thematic Program on Toric Topology and Polyhedral Products.



\section{Preliminaries}\label{sec-prelim}

\subsection{Persistence modules and barcodes}\label{sec_persistent_module}

Consider the set $\RR_{\geq 0}$ of nonnegative real numbers, which we regard as a poset category with respect to the standard inequality $\leq$. 
% Let $(S, \prec)$ be a totally ordered set and $\mathbf{S}$ the associated category, namely objects are elements in $S$ and for $s_1, s_2 \in S$ there exists a morphism from $s_1$ to $s_2$ whenever $s_1\prec s_2$. We denote the morphism between $s_1$ and $s_2$ by $s_1\prec s_2$ to avoid extra notation. 
A \emph{persistence module} is a (covariant) functor 
\begin{equation}\label{eq_persistent_module}
    \mathcal{M} \colon \mathbb{R}_{\geq 0} \to \mathbf{k}\ts{-mod}
\end{equation}
where $\mathbf{k}\ts{-mod}$ denotes the category of modules over a principal ideal domain $\mathbf{k}$. A persistence module can be thought of as a family of $\mathbf{k}$-modules $\{M_s\}_{s\in \RR_{\geq 0}}$ together with morphisms $\{\phi_{s_1,s_2} \colon M_{s_1} \to M_{s_2} \}_{s_1\leq  s_2}$ such that $\phi_{s,s}$ is the identity on $M_s$ and $\phi_{s_2,s_3}\circ \phi_{s_1,s_2} = \phi_{s_1,s_3}$ whenever $s_1\leq  s_2\leq  s_3$ in $\RR_{\geq 0}$. 
%We also consider contravariant persistence modules occasionally, which are functors $(\mathbb{R}_{\geq 0})^{\mathrm{op}} \to \mathbf{k}\ts{-mod}$ from the opposite poset category.

In a more general version of persistence modules, the domain category $\mathbb{R}_{\geq 0}$ can be replaced by any small category and the codomain $\mathbf{k}\ts{-mod}$ by any Grothendieck category. See for example \cite{b-s-s}. 

\begin{example}\label{ex_interval_module}
An \emph{interval} is a subset $I\subset\mathbb R_{\geq0}$ such that if $r\in I$ and $t\in I$ and $r<s<t$, then $s\in I$ (such an interval may be closed or open from each side, and may have infinite length).
Given an interval $I$, we define 
\[
% \mathbf{k}(I)_s 
\mathbf{k}^I_s
\colonequals \begin{cases} \mathbf{k} & \text{if } s\in I;\\
  \mathbf{0} & \text{otherwise}.
  \end{cases}
\]
Then, the family $\{ \mathbf{k}^I_s \}_{s\in \RR_{\geq 0}}$ together with the family $\{\phi_{s_1, s_2}\colon \mathbf{k}^I_{s_1} \to \mathbf{k}^I_{s_2}\}_{s_1 \leq s_2}$ of morphisms, where $\phi_{s_1, s_2}$ is the identity if $s_1, s_2\in I$ and the zero map otherwise, forms a persistence module. We denote it by $\mathbf{k}(I)$  and refer to as the \emph{interval module} corresponding to $I$. 
\end{example}

The direct sum $\mathcal{M}\oplus \mathcal{N}$ of two persistence modules $\mathcal{M}=\{M_s\}_{s\in \RR_{\geq 0}}$ and $\mathcal{N}=\{N_s\}_{s\in \RR_{\geq 0}}$ is defined pointwise as the family of $\mathbf{k}$-modules $\{M_s\oplus N_s\}_{s\in \RR_{\geq 0}}$. The following decomposition theorem for a persistence module is originally due to Zomorodian and Carlsson~\cite[Theorem~2.1]{CZ05} for the case where the domain category is $\ZZ_{\geq 0}$ and $\mathbf{k}$ is a field. It is generalized to the case where the domain category is~$\RR_{\geq 0}$ or $\mathbb{R}$ by Crawley-Boevey \cite[Theorem 1.1]{Cr}. We also refer to \cite[Theorem~1.2]{BoCr} for a simpler proof. 

\begin{theorem}\label{prop_decomp_persitent_module}
Let $\mathcal{M}=\{M_s\}_{s\in \RR_{\geq 0}}$ be a persistence module as in \eqref{eq_persistent_module}. If  $\mathbf{k}$ is a field and all $M_s$ are finite dimensional $\mathbf{k}$-vector spaces, then 
\begin{equation}\label{eq_decomp_persistent_module}
\mathcal{M}=\bigoplus_{I\in B(\mathcal{M})} \mathbf{k}(I)
\end{equation}
for some multiset $B(\mathcal{M})$ of intervals in $\RR_{\geq 0}$, where $\mathbf{k}(I)$ is the interval module defined in Example \ref{ex_interval_module}.
\end{theorem}
The above result gives us a discrete invariant of a persistence module $\mathcal{M}$, namely the multiset $B(\mathcal{M})$  of \eqref{eq_decomp_persistent_module}, which is called  the \emph{barcode} of $\mathcal{M}$.



\subsection{The Vietoris--Rips filtration and persistent homology}\label{sec_persistent_homology}
A typical example which fits into Theorem~\ref{prop_decomp_persitent_module} is the persistent homology of filtered simplicial complexes. 

A \emph{finite pseudo-metric space} is a nonempty finite set $X$ together with a function 
\[
d_X\colon X\times X \to \RR_{\geq 0}
\]
satisfying  $d_X(x,x)=0$, $d_X(x,y)=d_X(y,x)$ and $d_X(x,z)\leq d_X(x,y)+d_X(y,z)$ for every $x,y,z\in X$. Note that two distinct points may have distance $0$ in~$X$. We can think of a finite pseudo-metric space $(X, d_X)$ as a point cloud. 

The \emph{Vietoris--Rips filtration} $\{R(X,t)\}_{t\geq 0}$ associated with $(X,d_X)$ consists of the Vietoris--Rips simplicial complexes~$R(X,t)$. The latter is defined as the clique complex of the graph whose vertex set is $X$ and two vertices $x$ and $y$ are connected by an edge if $d_X(x,y)\leq t$. We have a simplicial inclusion 
\begin{equation}\label{eq_inclusion_Rips_complex}
R(X,t_1) \hookrightarrow  R(X, t_2) 
\end{equation}
whenever $t_1 \leq t_2$. 
% Although $\{R(X,t)\}_{t\geq 0}$ is a continuous family of simplicial complexes, there are discrete values $\{t_i\in \RR_{\geq 0} \mid i\in \ZZ_{\geq 0}\}$ such that $R(X,s)\subsetneq R(X,t_i)$ for all $t_{i-1}\leq s < t_i$. Hence, we obtain a filtration
% \begin{equation}\label{eq_VR_complex}
% R(X,t_0) \hookrightarrow R(X,t_1) \hookrightarrow \cdots \hookrightarrow R(X,t_i) \hookrightarrow \cdots,
% \end{equation}
% with $R(X,t_0)=X$. 
See Figure \ref{fig_barcode_example} for an example of  Vietoris--Rips complexes.   
\begin{figure}
\begin{tikzpicture}[scale=0.6]
\coordinate (v1) at (9.74,7.01); 
\coordinate (v2) at (9.33,7.10);

\coordinate (v19) at (9.4,7.48);

\coordinate (v3) at (9.06,7.96);
\coordinate (v4) at (9.11,8.37);

\coordinate (v18) at (9.5,8.48);
\coordinate (v20) at (9.05,8.71);

\coordinate (v5) at (9.41,8.83);
\coordinate (v6) at (9.73,9.13);
\coordinate (v7) at (10.22,9.31);
\coordinate (v8) at (10.83,9.37);
\coordinate (v9) at (11.27,9.09);
\coordinate (v10) at (11.98,8.57);
\coordinate (v11) at (11.63,8.23);
\coordinate (v12) at (12.03,7.98);
\coordinate (v13) at (11.90,7.09);
\coordinate (v14) at (11.99,6.87);
\coordinate (v15) at (11.68,6.77);
\coordinate (v16) at (11.22,6.55);
\coordinate (v17) at (10.42,6.68);

\node at (11, 5) {\footnotesize$X=R(X,0)  \hookrightarrow  $};
\node at (13.5, 5) {$\cdots$};

\foreach \x in {1,2,...,20} {
%\draw[fill=red!15, red!15] (v\x) circle (0.1);
%\node[left] at (v\x) {\tiny\x};
\filldraw (v\x) circle (1pt);
%    \node[left] at (v\x) {\tiny\x};
}

\begin{scope}[xshift=140]
\coordinate (v1) at (9.74,7.01); 
\coordinate (v2) at (9.33,7.10);

\coordinate (v19) at (9.4,7.48);

\coordinate (v3) at (9.06,7.96);
\coordinate (v4) at (9.11,8.37);

\coordinate (v18) at (9.5,8.48);
\coordinate (v20) at (9.05,8.71);

\coordinate (v5) at (9.41,8.83);
\coordinate (v6) at (9.73,9.13);
\coordinate (v7) at (10.22,9.31);
\coordinate (v8) at (10.83,9.37);
\coordinate (v9) at (11.27,9.09);
\coordinate (v10) at (11.98,8.57);
\coordinate (v11) at (11.63,8.23);
\coordinate (v12) at (12.03,7.98);
\coordinate (v13) at (11.90,7.09);
\coordinate (v14) at (11.99,6.87);
\coordinate (v15) at (11.68,6.77);
\coordinate (v16) at (11.22,6.55);
\coordinate (v17) at (10.42,6.68);

\node at (10.9, 5) {\footnotesize$\hookrightarrow  R(X,t_1)  \hookrightarrow$};
\node at (13.5, 5) {$\cdots$};

\foreach \x in {1,2,...,20} {
\draw[fill=red!15, red!15] (v\x) circle (0.2);
%\node[left] at (v\x) {\tiny\x};
}

\foreach \x in {1,2,...,20} {
%\node[left] at (v\x) {\tiny\x};
\filldraw (v\x) circle (1pt);
}

\draw (v1)--(v2)--(v19);
\draw (v3)--(v4)--(v18)--(v5)--(v20)--(v4);
\draw[fill=blue!30] (v13)--(v14)--(v15)--cycle;
\end{scope}

\begin{scope}[xshift=280]
\coordinate (v1) at (9.74,7.01); 
\coordinate (v2) at (9.33,7.10);

\coordinate (v19) at (9.4,7.48);

\coordinate (v3) at (9.06,7.96);
\coordinate (v4) at (9.11,8.37);

\coordinate (v18) at (9.5,8.48);
\coordinate (v20) at (9.05,8.71);

\coordinate (v5) at (9.41,8.83);
\coordinate (v6) at (9.73,9.13);
\coordinate (v7) at (10.22,9.31);
\coordinate (v8) at (10.83,9.37);
\coordinate (v9) at (11.27,9.09);
\coordinate (v10) at (11.98,8.57);
\coordinate (v11) at (11.63,8.23);
\coordinate (v12) at (12.03,7.98);
\coordinate (v13) at (11.90,7.09);
\coordinate (v14) at (11.99,6.87);
\coordinate (v15) at (11.68,6.77);
\coordinate (v16) at (11.22,6.55);
\coordinate (v17) at (10.42,6.68);

\node at (10.9, 5) {\footnotesize$\hookrightarrow  R(X,t_2)  \hookrightarrow$};
\node at (13.5, 5) {$\cdots$};

\foreach \x in {1,2,...,20} {
\draw[red!15, fill=red!15] (v\x) circle (0.33);
%\node[left] at (v\x) {\tiny\x};
}

\foreach \x in {1,2,...,20} {
%\node[left] at (v\x) {\tiny\x};
\filldraw (v\x) circle (1pt);
}

\draw[fill=blue!30] (v1)--(v2)--(v19)--cycle;
\draw (v19)--(v3)--(v4);
\draw (v4)--(v5);
\draw[fill=orange, opacity=0.8] (v4)--(v18)--(v5)--(v20)--cycle;
\draw (v20)--(v18);
\draw (v5)--(v6)--(v7)--(v8)--(v9);
\draw[fill=blue!30] (v10)--(v11)--(v12)--cycle;

\draw[fill=blue!30] (v13)--(v14)--(v15)--cycle;
\draw (v15)--(v16);
\end{scope}

\begin{scope}[xshift=420]
\coordinate (v1) at (9.74,7.01); 
\coordinate (v2) at (9.33,7.10);

\coordinate (v19) at (9.4,7.48);

\coordinate (v3) at (9.06,7.96);
\coordinate (v4) at (9.11,8.37);

\coordinate (v18) at (9.5,8.48);
\coordinate (v20) at (9.05,8.71);

\coordinate (v5) at (9.41,8.83);
\coordinate (v6) at (9.73,9.13);
\coordinate (v7) at (10.22,9.31);
\coordinate (v8) at (10.83,9.37);
\coordinate (v9) at (11.27,9.09);
\coordinate (v10) at (11.98,8.57);
\coordinate (v11) at (11.63,8.23);
\coordinate (v12) at (12.03,7.98);
\coordinate (v13) at (11.90,7.09);
\coordinate (v14) at (11.99,6.87);
\coordinate (v15) at (11.68,6.77);
\coordinate (v16) at (11.22,6.55);
\coordinate (v17) at (10.42,6.68);

\node at (10.9, 5) {\footnotesize$\hookrightarrow  R(X,t_3)  \hookrightarrow$};
\node at (13.5, 5) {$\cdots$};

\foreach \x in {1,2,...,20} {
\draw[red!15, fill=red!15] (v\x) circle (0.5);
%\node[left] at (v\x) {\tiny\x};
}

\foreach \x in {1,2,...,20} {
%\node[left] at (v\x) {\tiny\x};
\filldraw (v\x) circle (1pt);
}

\draw[fill=blue!30] (v1)--(v2)--(v19)--cycle;
\draw (v3)--(v18);
\draw[fill=orange, opacity=0.8] (v19)--(v3)--(v4)--(v18)--cycle;
\draw (v19)--(v4);

\draw (v4)--(v5);
\draw[fill=orange, opacity=0.8] (v4)--(v18)--(v5)--(v20)--cycle;
\draw (v20)--(v18);
\draw (v5)--(v6)--(v7)--(v8)--(v9)--(v10);
\draw[fill=blue!30] (v10)--(v11)--(v12)--cycle;

\draw[fill=blue!30] (v13)--(v14)--(v15)--cycle;
\draw (v15)--(v16)--(v17)--(v1);
\draw (v12)--(v13);
\end{scope}

\end{tikzpicture}
    \caption{A point cloud and the corresponding Vietoris--Rips filtration.}
    \label{fig_barcode_example}
\end{figure}

The $n$-dimensional \emph{persistent homology} module 
\[
  \mathcal{PH}_n(X) \colon \RR_{\geq 0} \to \mathbf{k}\ts{-mod},\quad
  t\mapsto \widetilde{H}_n(R(X,t)),
\]
maps $t\in \RR_{\geq0}$ to the reduced simplicial homology group $\widetilde{H}_n(R(X,t))$ with coefficients in $\mathbf k$ and maps a morphism $t_1\leq t_2$ to the homomorphism $\widetilde{H}_n(R(X, t_1))\to \widetilde{H}_n(R(X, t_2))$ induced by~\eqref{eq_inclusion_Rips_complex}. We also define the graded persistent homology module
\begin{equation}\label{eq_PH}
 \mathcal{PH}(X)=\bigoplus_{n\ge0}\mathcal{PH}_n(X).
\end{equation}

Applying Theorem~\ref{prop_decomp_persitent_module} to the graded persistence module~\eqref{eq_PH}, we obtain the barcode of $\mathcal{PH}(X)$, which we denote simply by~$B(X)$. In this case, $B(X)$ can be described more explicitly as follows.

A homology class $\alpha\in\widetilde H_n(R(X,t))$ is said to
\begin{itemize}
\item[(1)] \emph{be born} at $r$ if
\begin{itemize}
    \item[(i)] $\alpha\in\mathop\mathrm{im}\bigl(\widetilde H_n(R(X,r))\to \widetilde H_n(R(X,t))\bigr)$;
    \item[(ii)] $\alpha\notin\mathop\mathrm{im}\bigl(\widetilde H_n(R(X,p))\to \widetilde H_n(R(X,t))\bigr)$ for $p<r$,
\end{itemize}
\item[(2)] \emph{die} at $s$ if 
\begin{itemize}
    \item[(i)] $\alpha\in\ker\bigl(\widetilde H_n(R(X,t))\to \widetilde H_n(R(X,s))\bigr)$;
    \item[(ii)] $\alpha\notin\ker\bigl(\widetilde H_n(R(X,t))\to \widetilde H_n(R(X,q))\bigr)$ for $q<s$.
\end{itemize} 
We set $s=\infty$ if $\alpha\notin\ker\bigl(\widetilde H_n(R(X,t))\to \widetilde H_n(R(X,q))\bigr)$ for any~$q$.
\end{itemize}

If $\alpha\in\widetilde H_n(R(X,t))$ is born at $r$ and dies at $s$, then $[r,s)$ is called the \emph{persistence interval} of~$\alpha$. Then, the barcode $B(X)$ is the collection of persistence intervals of generators of the homology groups $\widetilde H_*(R(X,t))$. For each $t\in\mathbb R_{\geq 0}
$, the dimension of
$\widetilde H_n(R(X,t))$ is equal to the number of $n$-dimensional persistence intervals containing~$t$.

\begin{figure}
  \centering
    \includegraphics[width=0.9\linewidth]{barcode.png}
    \caption{The barcode corresponding to the Vietoris--Rips complex in Figure \ref{fig_barcode_example}. The image is generated by Ripser for Python.}
    \label{fig_barcode}
\end{figure}

Since $(X, d_X)$ is a finite pseudo-metric space, it follows that $R(X,t)$ is contractible when $t$ is large enough.  
Therefore, the corresponding barcode $B(X)$ is a finite collection of half-open persistence intervals with finite lengths. If we use the unreduced simplicial homology in the definition of persistent homology, then the barcode would contain a single infinite interval $[0,\infty)$ in dimension~$0$. Figure~\ref{fig_barcode} displays the unreduced barcode corresponding to the Vietoris--Rips filtration in Figure~\ref{fig_barcode_example}. 


\section{Moment-angle complexes and bigraded Betti numbers}\label{macbbn}


\subsection{Cohomology of moment angle complexes}\label{subsec_HZK}
Let $K$ be a simplicial complex on the set $[m]=\{1,2,\ldots,m\}$. We refer to a subset $I=(i_1,\ldots,i_k)\subset[m]$ that is contained in $K$ as a \emph{simplex}. A one-element simplex $\{i\}\in K$ is a \emph{vertex}. We also assume that $\varnothing\in K$ and, unless explicitly stated otherwise, that $K$ contains all one-element subsets $\{i\}\in[m]$ (that is, $K$ is a simplicial complex without \emph{ghost vertices}). 

Let $D^2$ be the unit disc in $\mathbb R^2$, and let $S^1$ be its boundary circle.
For each simplex $I\in K$, consider the topological space  
\begin{equation*}
  (D^2, S^1)^I \colonequals \{(z_1, \dots, z_m)\in (D^2)^m \colon |z_j|=1 \text{ if } j\notin I\}\subset (D^2)^m.
\end{equation*}
Note that $(D^2, S^1)^I$ is a natural subspace of  $(D^2, S^1)^J$ whenever $I\subset J$. The \emph{moment-angle complex} corresponding to $K$ is 
\[
  \zk\colonequals\bigcup_{I\in K}(D^2,S^1)^I\subset(D^2)^m. 
\]
We refer to \cite[Chapter~4]{BP-book} for more details and examples. 

Let $\mathbf k$ be a coefficient ring, which we assume to be a principal ideal domain. The \emph{face ring} (the \emph{Stanley--Reisner ring}) of a simplicial complex $K$ is
\[
  \mathbf k[K]\colonequals \mathbf k[v_1, \dots, v_m]/\mathcal{I}_K, 
\]
where $\mathcal{I}_K$ is the ideal generated by square-free monomials $\prod_{i\in I} v_i$ for which $I\subset[m]$ is not a simplex of~$K$. 

The following theorem summarizes several presentations of the cohomology ring~$H^\ast(\zk)$.

\begin{theorem}[{\cite[Section 4.5]{BP-book}}]\label{BPtheorem}
There
are isomorphisms of bigraded commutative algebras
\begin{align}
  H^*(\zk)&\cong\Tor_{\mathbf k[v_1,\ldots,v_m]}\bigl(\mathbf k,\mathbf k[K]\bigr) \nonumber  \\
  &\cong H\bigl(\Lambda[u_1,\ldots,u_m]\otimes
  \mathbf k[K],d\bigr) \label{eq_Koszul_cohom}\\
  &\cong \bigoplus_{I\subset[m]}\widetilde H^*(K_I). \label{eq_Hochster_decomp}
\end{align}
Here, \eqref{eq_Koszul_cohom} is cohomology of the
bigraded algebra with bidegrees $\bideg u_i=(-1,2)$, $\bideg v_i=(0,2)$ and differential $d=\sum_{i=1}^mv_i\frac{\partial}{\partial u_i}$ of bidegree $(1,0)$ (the Koszul complex). In \eqref{eq_Hochster_decomp}, each component $\widetilde H^*(K_I)$ denotes the reduced simplicial cohomology
of the full subcomplex $K_I\subset K$ (the restriction of $K$
to $I\subset[m]$). The last isomorphism is the sum of isomorphisms
\[
  H^p(\zk)\cong
  \sum_{I\subset[m]}\widetilde H^{p-|I|-1}(K_I),
\]
and the ring structure is given by the maps
\[
  H^{p-|I|-1}(K_I)\otimes H^{q-|J|-1}(K_J)\to
  H^{p+q-|I|-|J|-1}(K_{I\cup J})
\]
which are induced by the canonical simplicial maps $K_{I\cup
J}\to K_I\mathbin{*} K_J$ for $I\cap J=\varnothing$ and zero otherwise.
\end{theorem}

Isomorphism~\eqref{eq_Hochster_decomp} is often referred to as the \emph{Hochster decomposition}, as it comes from Hochster's theorem describing $\Tor_{\mathbf k[v_1,\ldots,v_m]}(\mathbf k,\mathbf k[K])$ as a sum of cohomology of full subcomplexes~$K_I$.

The bigraded components of cohomology of $\zk$ are given by
\[
  H^{-i,2j}(\zk)\cong H^{-i,2j}\bigl(\Lambda[u_1,\ldots,u_m]\otimes
  \mathbf k[K],d\bigr)
  \cong\bigoplus_{J\subset[m]\colon |J|=j}\widetilde H^{j-i-1}(K_J),\quad
\]
so that
\[
  H^p (\mathcal{Z}_K) = \bigoplus_{-i+2j=p}H^{-i,2j} (\mathcal{Z}_K)\cong \bigoplus_{J\subset[m]}\widetilde{H}^{p-|J|-1}(K_J),
\]
There is a similar description of bigraded homology of $\zk$:
\begin{equation*}
  H_p (\mathcal{Z}_K) = \bigoplus_{-i+2j=p}H_{-i,2j} (\mathcal{Z}_K)\cong \bigoplus_{J\subset[m]}\widetilde{H}_{p-|J|-1}(K_J).
\end{equation*}

The construction of moment-angle complex and its bigraded homology is functorial with respect to inclusion of simplicial complexes:

\begin{proposition}\label{funin}
An inclusion of subcomplex $K\subset L$ induces an inclusion $\mathcal Z_K\subset\mathcal Z_L$ and a homomorphism $H_{-i,2j}(\mathcal Z_K)\to H_{-i,2j}(\mathcal Z_L)$ of bigraded homology modules.
\end{proposition}

When $\mathbf k$ is a field, the \emph{bigraded Betti numbers} %$\beta^{-i,2j}(K)$ 
of $K$ (with coefficients in~$\mathbf k$) are defined by
\[
  \beta_{-i,2j}(K)\colonequals \dim H_{-i, 2j}(\mathcal{Z}_K)=\sum_{J\subset[m]\colon |J|=j} \dim \widetilde{H}_{j-i-1}(K_J).
\]  
In particular, when $j=m$, we obtain $\beta_{-i,2m}(K)=\dim\widetilde{H}_{m-i-1}(K)$.
Moreover, $\dim \widetilde{H}^{j-i-1}(K_J)$ agrees with $\dim \widetilde{H}_{j-i-1}(K_J)$ obviously. 

Dimensional considerations imply that possible locations of nonzero bigraded Betti numbers form a trapezoid in the table, see Figure~\ref{fig_bi_Betti}. We refer to \cite[Section 4.5]{BP-book} for more details. 
\begin{figure}
\begin{tikzpicture}
\draw[fill=yellow] (0.5,4.5)--(0.5,5)--(2.5,5)--(2.5,4.5)--cycle;
\draw (0,0) grid[step=.5cm] (5,5);
\draw[stealth-] (-0.5,0)--(5,0);
\draw[-stealth] (5,0)--(5,5.5);
\node[right] at (5,5.5) {\footnotesize$2j$};
\node[left] at (-0.5,0) {\footnotesize$-i$};
\node[below] at (4.75,0) {\scriptsize$0$};
\node[below] at (4.25,0) {\scriptsize$-1$};
\node[right] at (5,0.25) {\scriptsize$0$};
\node[right] at (5,0.75) {\scriptsize$2$};
\node[right] at (5,1.25) {\scriptsize$4$};

\node at (4.75, 0.25) {\scriptsize$1$};
\foreach \x in {1,2,...,8}
	{\node at (4.75-.5*\x,0.75+.5*\x) {\scriptsize$\ast$};}
\foreach \x in {1,2,...,7}
	{\node at (4.75-.5*\x,1.25+.5*\x) {\scriptsize$\ast$};}
\foreach \x in {1,2,...,6}
	{\node at (4.75-.5*\x,1.75+.5*\x) {\scriptsize$\ast$};}
\foreach \x in {1,2,...,5}
	{\node at (4.75-.5*\x,2.25+.5*\x) {\scriptsize$\ast$};}
%\foreach \x in {1,2,...,4}
%	{\node at (4.75-.5*\x,2.75+.5*\x) {\scriptsize$\ast$};}

\foreach \x in {1,2,...,8}
	{\draw[red, very thick] (.5*\x, 5.5-.5*\x)--(.5*\x, 5-.5*\x)--(.5*\x+0.5, 5-.5*\x)  ;}
\foreach \x in {1,2,3,4}
	{\draw[red, very thick] (2+0.5*\x, 5.5-.5*\x)--(2+0.5*\x, 5-.5*\x)--(2.5+.5*\x, 5-.5*\x)  ;}
\draw[red, very thick] (0.5,5)--(2.5,5);
\draw[red, very thick] (4.5,1)--(4.5,3);

\node[right] at (5, 4.75) {\scriptsize$2m$};

\draw[<-] (0.75, 4.85)--(0.5, 5.25); \node[above] at (0.5, 5.25) {\scriptsize$\widetilde{H}_0(K)$};
\draw[<-] (2.25, 4.85)--(2.5, 5.25); \node[above] at (2.5, 5.25) {\scriptsize$\widetilde{H}_{n-1}(K)$};
\node[above] at (1.5, 5.25) {\scriptsize$\cdots$};

\draw[<-] (0.75, -0.1)--(0.75, -0.5);
\node[below] at (0.75, -0.5) {\scriptsize$-(m-1)$};
\draw[<-] (2.25, -0.1)--(2.25, -0.5);
\node[below] at (2.25, -0.5) {\scriptsize$-(m-n)$};
\end{tikzpicture}
\caption{Table of bigraded Betti numbers.}
\label{fig_bi_Betti}
\end{figure}


\subsection{Bigraded persistence and barcodes}\label{subsec_Bigraded_barcode}

\begin{definition}\label{bgph}
Let $(X,d_X)$ be a finite pseudo-metric space and $(X, d_X)$ and $\{R(X,t)\}_{t\geq 0}$ its associated Vietoris--Rips filtration.
We define the \emph{persistent homology} module of bidegree $(-i,2j)$ as 
\[
  \mathcal{PHZ}_{-i,2j}(X) \colon \RR_{\geq 0} \to \mathbf{k}\ts{-mod},\quad
  t\mapsto H_{-i,2j}(\mathcal Z_{R(X,t)}).
\]
It maps $t\in \RR_{\geq0}$ to the bigraded homology module  $H_{-i,2j}(\mathcal Z_{R(X,t)})$ and maps a morphism $t_1\leq t_2$ to the homomorphism $H_{-i,2j}(\mathcal Z_{R(X,t_1)})\to H_{-i,2j}(\mathcal Z_{R(X,t_2)})$, see Proposition~\ref{funin}. We also define the bigraded persistent homology module
\begin{equation}\label{eq_PHZ}
 \mathcal{PHZ}(X)=
 \bigoplus_{\substack{0\leq i\leq m-1; \\ 0\leq j \leq m}}\mathcal{PHZ}_{-i,2j}(X).
\end{equation}

For any subset $J\subset X$, the Vietoris--Rips complex $R(J,t)$ is the full subcomplex $R(X,t)_J$. Hence,
the Hochster decomposition \eqref{eq_Hochster_decomp} yields the decomposition of the persistence modules:
\begin{equation}\label{hoch-pers}
  \mathcal{PHZ}(X)=\bigoplus_{J \subset X} \mathcal{PH}(J).
\end{equation}

The \emph{bigraded barcode} $\BB(X)$ is the collection of persistence intervals of generators of the bigraded homology groups $H_{-i,2j}(\mathcal Z_{R(X,t)})$. We note that bigraded persistence intervals are defined in the same way as for ordinary persistent homology, see Theorem \ref{prop_decomp_persitent_module} and Subsection~\ref{sec_persistent_homology}. For each $t\in\mathbb R_{\geq 0}$, the dimension of $H_{-i,2j}(\mathcal Z_{R(X,t)})$
is equal to the number of persistence intervals of bidegree $(-i,2j)$ containing~$t$.
\end{definition}


We note that the bigraded persistent homology module  $\mathcal{PHZ}(X)$ defined in~\eqref{eq_PHZ} is related to subsampling from data sets
%studied for instance in 
\cite{GM-arXiv, CFLMRW}. Studying the set of all subsamples of size $k$ gives what is called the \emph{distributed persistence} in \cite{SWB22}. Indeed, the $k$-distributed Vietoris--Rips persistences agrees with the persistence module $\bigoplus_{0\leq i \leq m-1}\mathcal{PHZ}_{-i, 2k}(X)$. Here, we emphasize that the module $\mathcal{PHZ}(X)$ has richer algebraic structures such as cohomology products summarized in Theorem~\ref{BPtheorem}. We also refer to \cite{BBC} for abundant algebraic structures other than cohomology products. 



The bigraded barcode of $X$ is drawn as a diagram in $3$-dimensional space, which contains the original barcode of $X$ in its top level. See Figure~\ref{fig_bigr_barcode}. 
\begin{figure}
\begin{tikzpicture}[scale=0.5, yscale=0.7]
\draw[-stealth] (xyz cs:x=0) -- (xyz cs:x=15) node[below] {\footnotesize{persistence intervals}};
\draw[-stealth] (xyz cs:y=0) -- (xyz cs:y=11) node[right] {\footnotesize$2j$};
\draw[-stealth] (xyz cs:z=0) -- (xyz cs:z=11) node[left] {\footnotesize$-i$};

\node[right] at (0,9.5,0) {\scriptsize$2m$};
\node[right] at (0,.5,0) {\scriptsize$0$};
\node[right] at (0,1.5,0) {\scriptsize$2$};
\node[right] at (0,2.5,0) {\scriptsize$4$};

\node[below] at (0,0,0.2) {\scriptsize$0$};
\node[below] at (0,0,1.5) {\scriptsize$-1$};

\draw[yellow, very thick, dashed] (0,9,5)--(14.5,9,5);

\begin{scope}
\foreach \coo in {1,2,...,10}
	{\draw[dotted] (0,\coo,0)--(0,\coo,10);
	\draw[dotted] (0,0,\coo)--(0,10,\coo);
	}

\draw[red, thick] (0,0,0)--(0,1,0)--(0,1,1)--(0,0,1)--cycle;
\foreach \bd in {1,2,...,8}
	{\draw[red, thick] (0,11-\bd,10-\bd)--(0,10-\bd,10-\bd)--(0,10-\bd,9-\bd);
	}
\foreach \bd in {1,2,3,4}
	{\draw[red, thick] (0,11-\bd, 6-\bd)--(0,10-\bd, 6-\bd)--(0,10-\bd, 5-\bd);
	}
\draw[red, thick] (0,10,5)--(0,10,9);
\draw[red, thick] (0,2,1)--(0,6,1);
\end{scope}

\begin{scope}[xshift=150]
\foreach \bd in {1,2,3,4}
	{\draw[red, thick] (0,11-\bd, 6-\bd)--(0,10-\bd, 6-\bd)--(0,10-\bd, 5-\bd);
	}
\draw[red, thick] (0,2,1)--(0,6,1);
\end{scope}

\begin{scope}[xshift=300]
\foreach \bd in {1,2,3,4}
	{\draw[red, thick] (0,11-\bd, 6-\bd)--(0,10-\bd, 6-\bd)--(0,10-\bd, 5-\bd);
	}
\draw[red, thick] (0,2,1)--(0,6,1);
\end{scope}


%Barcodes (x-coordinate=length of barcode)

%\node at (5.3,0,0) {$\bullet$};

\draw[blue, thick] (0,9.6, 8.5)--(3,9.6, 8.5);
\draw[blue, thick] (0,9.4, 8.5)--(8,9.4, 8.5);
\draw[blue, thick] (0,9.2, 8.5)--(13,9.2, 8.5);
\draw[blue, thick] (0,9.5, 5.5)--(3,9.5, 5.5);
\draw[blue, thick] (0,9.3, 5.5)--(5,9.3, 5.5);
\draw[blue, thick] (0,9.4, 6.5)--(11,9.4, 6.5);

\draw[blue, thick] (0,2.5,1.5)--(9,2.5, 1.5);
\draw[blue, thick] (0,2.5,1.5)--(9,2.5, 1.5);
\draw[blue, thick] (0,2.5,1.5)--(9,2.5, 1.5);

\draw[blue, thick] (0,5.7,4.5)--(12,5.7,4.5);
\draw[blue, thick] (0,5.3,4.5)--(2,5.3,4.5);


\draw[blue, thick] (5.3,4.7,3.5)--(8,4.7, 3.5);
\draw[blue, thick] (5.3,4.3,3.5)--(11,4.3, 3.5);

\draw[blue, thick] (5.3,5.7,2.5)--(6,5.7,2.5);
\draw[blue, thick] (5.3,5.4,2.5)--(12,5.4,2.5);


\begin{scope}[xshift=150]
\foreach \coo in {0,1,2,...,10}
	{\draw[dotted] (0,\coo,0)--(0,\coo,10);
	\draw[dotted] (0,0,\coo)--(0,10,\coo);
	}

\draw[red, thick] (0,0,0)--(0,1,0)--(0,1,1)--(0,0,1)--cycle;
\foreach \bd in {1,2,...,8}
	{\draw[red, thick] (0,11-\bd,10-\bd)--(0,10-\bd,10-\bd)--(0,10-\bd,9-\bd);
	}
\draw[red, thick] (0,10,5)--(0,10,9);
\end{scope}


\begin{scope}[xshift=300]
\foreach \coo in {0,1,2,...,10}
	{\draw[dotted] (0,\coo,0)--(0,\coo,10);
	\draw[dotted] (0,0,\coo)--(0,10,\coo);
	}

\draw[red, thick] (0,0,0)--(0,1,0)--(0,1,1)--(0,0,1)--cycle;
\foreach \bd in {1,2,...,8}
	{\draw[red, thick] (0,11-\bd,10-\bd)--(0,10-\bd,10-\bd)--(0,10-\bd,9-\bd);
	}
\draw[red, thick] (0,10,5)--(0,10,9);
\end{scope}

\draw[fill=yellow, yellow, opacity=0.5] (0,10,9)--(0,10,5)--(14.5,10,5)--(14.5,9,5)--(14.5,9,9)--(0,9,9)--cycle;
\draw[yellow, very thick] (0,10,5)--(14.5,10,5);
\draw[yellow, very thick] (0,10,9)--(14.5, 10,9);
\draw[yellow, very thick] (0,9,9)--(14.5, 9,9);

%\draw[dotted] (0,10,10)--(14, 10,10);
\draw[dotted] (0,0,10)--(14, 0,10);
\draw[dotted] (0,10,0)--(14, 10,0);

\end{tikzpicture}
\caption{A bigraded barcode.}
\label{fig_bigr_barcode}
\end{figure}
%An alternative definition of the bigraded barcode for a filtered complex $\mathcal K$ can be given as follows. 
%As in the case of ordinary persistence, the action of $y_*$ makes the bigraded persistent homology $\PH_{*,*}(\mathcal{K})=\bigoplus_{r < s }\PH_{*,*}^{r\to s}(\mathcal{K})$ into a module over the polynomial ring $\mathbf k[y]$. Applying the structure theorem for modules over PIDs, we obtain:
%\[
%  \PH_{*,*}(\mathcal{K})\cong\biggl( \bigoplus_A t^{A} \cdot \mathbf{k}[t]\biggr) \oplus \biggl(\bigoplus_{B,C} t^{B}\cdot  \left( \mathbf{k}[t] / t^{C}\mathbf{k}[t]\right)\biggr).
%\]
%Then the bigraded barcode of $\mathcal K$ is the set of intervals $[A,\infty]$ and $[B,C)$ for all $A,B,C$ as above.
Here is a simple example of two sequences of point clouds with the same barcodes, but different bigraded barcodes. 

\begin{example}\label{2sets}
Let $X_1$ and $X_2$ consist of three points $(0,0), (2,0), (0,4)$ and $(0,0), (2,0), (1, \sqrt{15})$ in~$\RR^3$, respectively. The Vietoris--Rips filtration $\{R(X_1,t)\}_{t\geq 0}$ at $t=0,2,4,2\sqrt5$ is shown in Figure~\ref{fig_VR_cplxes_of_3_pts}, top, and the Vietoris--Rips filtration $\{R(X_2,t)\}_{t\geq 0}$ at $t=0,2,4$ is shown in Figure~\ref{fig_VR_cplxes_of_3_pts}, bottom. The corresponding bigraded barcodes are shown in Figure~\ref{fig_big_barcode_for_3_pts}.  We notice that the two bars in the top levels of the bigraded barcodes are identical. These two bars represent the ordinary (single graded) barcodes of $X_1$ and $X_2$, respectively. The two data sets $X_1$ and $X_2$ are distinguished by their bigraded barcodes. 

\begin{figure}[ht]
\begin{tikzpicture}
\begin{scope}[scale=0.5]
\node at (-1.5, 1) {$X_1$};
\draw[-stealth] (-0.5,0)--(2.5,0);
\draw[-stealth] (0,-0.5)--(0,2.5);
\draw[fill=blue, blue] (0,0) circle (3pt);
\draw[fill=blue, blue] (1,0) circle (3pt);
\draw[fill=blue, blue] (0,2) circle (3pt);

\begin{scope}[xshift=110]
\draw[-stealth] (-0.5,0)--(2.5,0);
\draw[-stealth] (0,-0.5)--(0,2.5);
\draw[fill=blue, blue] (0,0) circle (3pt);
\draw[fill=blue, blue] (1,0) circle (3pt);
\draw[fill=blue, blue] (0,2) circle (3pt);
\draw[very thick, blue] (0,0)--(1,0);
\end{scope}

\begin{scope}[xshift=220]
\draw[-stealth] (-0.5,0)--(2.5,0);
\draw[-stealth] (0,-0.5)--(0,2.5);
\draw[fill=blue, blue] (0,0) circle (3pt);
\draw[fill=blue, blue] (1,0) circle (3pt);
\draw[fill=blue, blue] (0,2) circle (3pt);
\draw[very thick, blue] (0,0)--(1,0);
\draw[very thick, blue] (0,0)--(0,2);
\end{scope}

\begin{scope}[xshift=330]
\draw[-stealth] (-0.5,0)--(2.5,0);
\draw[-stealth] (0,-0.5)--(0,2.5);
\draw[fill=blue, blue] (0,0) circle (3pt);
\draw[fill=blue, blue] (1,0) circle (3pt);
\draw[fill=blue, blue] (0,2) circle (3pt);
\draw[very thick, blue, fill=blue!30] (0,0)--(1,0)--(0,2)--cycle;
\end{scope}

\begin{scope}[yshift=-120]
\node at (-1.5, 1) {$X_2$};
\draw[-stealth] (-0.5,0)--(2.5,0);
\draw[-stealth] (0,-0.5)--(0,2.5);
\draw[fill=red, red] (0,0) circle (3pt);
\draw[fill=red, red] (1,0) circle (3pt);
\draw[fill=red, red] (1/2,1.7320508076) circle (3pt);

\begin{scope}[xshift=110]
\draw[-stealth] (-0.5,0)--(2.5,0);
\draw[-stealth] (0,-0.5)--(0,2.5);
\draw[fill=red, red] (0,0) circle (3pt);
\draw[fill=red, red] (1,0) circle (3pt);
\draw[fill=red, red] (1/2,1.7320508076) circle (3pt);
\draw[very thick, red] (0,0)--(1,0);
\end{scope}

\begin{scope}[xshift=220]
\draw[-stealth] (-0.5,0)--(2.5,0);
\draw[-stealth] (0,-0.5)--(0,2.5);
\draw[fill=red, red] (0,0) circle (3pt);
\draw[fill=red, red] (1,0) circle (3pt);
\draw[fill=red, red] (1/2,1.7320508076) circle (3pt);
\draw[very thick, red, fill=red!20] (0,0)--(1/2,1.7320508076)--(1,0)--cycle;
\end{scope}
\end{scope}
\end{scope}
\end{tikzpicture}
\caption{Two sequences of Vietoris--Rips complexes.}
\label{fig_VR_cplxes_of_3_pts}
\end{figure}


\begin{figure}[ht]
\begin{tikzpicture}[yscale=0.7]
\draw[-stealth] (xyz cs:x=0) -- (xyz cs:x=7) node[right] {\scriptsize$t$};
\draw[-stealth] (xyz cs:y=0) -- (xyz cs:y=4.5) node[right] {\scriptsize$2j$};
\draw[-stealth] (xyz cs:z=0) -- (xyz cs:z=4.5) node[left] {\scriptsize$-i$};

\node[below] at (2.2,0,0) {\scriptsize$2$};
\node[below] at (4.4,0,0) {\scriptsize$4$};
\node[below] at (6.6,0,0) {\scriptsize$2\sqrt{5}$};

%\node[right] at (0,1/2,0) {\scriptsize$0$};
%\node[right] at (0,3/2,0) {\scriptsize$2$};
%\node[right] at (0,5/2,0) {\scriptsize$4$};
%\node[right] at (0,7/2,0) {\scriptsize$6$};

\draw[blue, thick] (0,3.4,2.5)--(4.2,3.4,2.5); 
\draw[fill=blue, blue] (0,3.4,2.5) circle (1.5pt); 
\draw[fill=blue, blue] (2.1,3.4,2.5) circle (1.5pt);
%\draw[fill=blue, blue] (4.2,3.3,2.5) circle (1.5pt);

\draw[blue, thick] (0,3.6,2.5)--(2.1,3.6,2.5);
\draw[fill=blue, blue] (0,3.6,2.5) circle (1.5pt); 
%\draw[fill=blue, blue] (2.1,3.7,2.5) circle (1.5pt);

\draw[blue, thick] (0,2.7,1.5)--(2.1,2.7,1.5);
\draw[fill=blue, blue] (0,2.7,1.5) circle (1.5pt);
%\draw[fill=blue, blue] (2.1,2.7,1.5) circle (1.5pt);

\draw[blue, thick] (0,2.5,1.5)--(4.2,2.5,1.5);
\draw[fill=blue, blue] (0,2.5,1.5) circle (1.5pt);
\draw[fill=blue, blue] (2.1,2.5,1.5) circle (1.5pt);
%\draw[fill=blue, blue] (4.2,2.5,1.5) circle (1.5pt);

\draw[blue, thick] (0,2.3,1.5)--(6.3,2.3,1.5);
\draw[fill=blue, blue] (0,2.3,1.5) circle (1.5pt);
\draw[fill=blue, blue] (2.1,2.3,1.5) circle (1.5pt);
\draw[fill=blue, blue] (4.2,2.3,1.5) circle (1.5pt);

\draw[blue, thick] (0,0.5,0.5)--(7,0.5,0.5);
\draw[fill=blue, blue] (0,0.5,0.5) circle (1.5pt);
\draw[fill=blue, blue] (2.1,0.5,0.5) circle (1.5pt);
\draw[fill=blue, blue] (4.2,0.5,0.5) circle (1.5pt);
\draw[fill=blue, blue] (6.3,0.5,0.5) circle (1.5pt);

\foreach \coo in {1,2,3,4}
	{\draw[dotted] (0,\coo,0)--(0,\coo,4);
	\draw[dotted] (0,0,\coo)--(0,4,\coo);
	}
	
\begin{scope}[xshift=60]	
\foreach \coo in {0,1,2,3,4}
	{\draw[dotted] (0,\coo,0)--(0,\coo,4);
	\draw[dotted] (0,0,\coo)--(0,4,\coo);
	}
\end{scope}

\begin{scope}[xshift=120]	
\foreach \coo in {0,1,2,3,4}
	{\draw[dotted] (0,\coo,0)--(0,\coo,4);
	\draw[dotted] (0,0,\coo)--(0,4,\coo);
	}
\end{scope}

\begin{scope}[xshift=180]	
\foreach \coo in {0,1,2,3,4}
	{\draw[dotted] (0,\coo,0)--(0,\coo,4);
	\draw[dotted] (0,0,\coo)--(0,4,\coo);
	}
\end{scope}

%\draw[fill=yellow, yellow, opacity=0.5] (0,3.8,2.5)--(4.5,3.8,2.5)--(4.5,3.3,2.5)--(0,3.3,2.5)--cycle;

\begin{scope}[yshift=-200]
\draw[-stealth] (xyz cs:x=0) -- (xyz cs:x=7) node[right] {\scriptsize$t$};
\draw[-stealth] (xyz cs:y=0) -- (xyz cs:y=4.5) node[right] {\scriptsize$2j$};
\draw[-stealth] (xyz cs:z=0) -- (xyz cs:z=4.5) node[left] {\scriptsize$-i$};

\node[below] at (2.2,0,0) {\scriptsize$2$};
\node[below] at (4.4,0,0) {\scriptsize$4$};
%\node[below] at (6.6,0,0) {\scriptsize$\frac{\sqrt{5}}{2}$};

%\node[right] at (0,1/2,0) {\scriptsize$0$};
%\node[right] at (0,3/2,0) {\scriptsize$2$};
%\node[right] at (0,5/2,0) {\scriptsize$4$};
%\node[right] at (0,7/2,0) {\scriptsize$6$};

\draw[red, thick] (0,3.4,2.5)--(4.2,3.4,2.5); 
\draw[fill=red, red] (0,3.4,2.5) circle (1.5pt); 
\draw[fill=red, red] (2.1,3.4,2.5) circle (1.5pt);
%\draw[fill=blue, blue] (4.2,3.3,2.5) circle (1.5pt);

\draw[red, thick] (0,3.6,2.5)--(2.1,3.6,2.5);
\draw[fill=red, red] (0,3.6,2.5) circle (1.5pt); 
%\draw[fill=blue, blue] (2.1,3.7,2.5) circle (1.5pt);

\draw[red, thick] (0,2.7,1.5)--(2.1,2.7,1.5);
\draw[fill=red, red] (0,2.7,1.5) circle (1.5pt);
%\draw[fill=blue, blue] (2.1,2.7,1.5) circle (1.5pt);

\draw[red, thick] (0,2.5,1.5)--(4.2,2.5,1.5);
\draw[fill=red, red] (0,2.5,1.5) circle (1.5pt);
\draw[fill=red, red] (2.1,2.5,1.5) circle (1.5pt);
%\draw[fill=blue, blue] (4.2,2.5,1.5) circle (1.5pt);

\draw[red, thick] (0,2.3,1.5)--(4.2,2.3,1.5);
\draw[fill=red, red] (0,2.3,1.5) circle (1.5pt);
\draw[fill=red, red] (2.1,2.3,1.5) circle (1.5pt);
%\draw[fill=blue, blue] (4.2,2.3,1.5) circle (1.5pt);

\draw[red, thick] (0,0.5,0.5)--(7,0.5,0.5);
\draw[fill=red, red] (0,0.5,0.5) circle (1.5pt);
\draw[fill=red, red] (2.1,0.5,0.5) circle (1.5pt);
\draw[fill=red, red] (4.2,0.5,0.5) circle (1.5pt);
%\draw[fill=blue, blue] (6.3,0.5,0.5) circle (1.5pt);

\foreach \coo in {1,2,3,4}
	{\draw[dotted] (0,\coo,0)--(0,\coo,4);
	\draw[dotted] (0,0,\coo)--(0,4,\coo);
	}
	
\begin{scope}[xshift=60]	
\foreach \coo in {0,1,2,3,4}
	{\draw[dotted] (0,\coo,0)--(0,\coo,4);
	\draw[dotted] (0,0,\coo)--(0,4,\coo);
	}
\end{scope}

\begin{scope}[xshift=120]	
\foreach \coo in {0,1,2,3,4}
	{\draw[dotted] (0,\coo,0)--(0,\coo,4);
	\draw[dotted] (0,0,\coo)--(0,4,\coo);
	}
\end{scope}

%\begin{scope}[xshift=180]	
%\foreach \coo in {0,1,2,3,4}
%	{\draw[dotted] (0,\coo,0)--(0,\coo,4);
%	\draw[dotted] (0,0,\coo)--(0,4,\coo);
%	}
%\end{scope}
\end{scope}
\end{tikzpicture}
\caption{The bigraded barcode for 3 points in $\RR^2$.}
\label{fig_big_barcode_for_3_pts}
\end{figure}
\end{example}

\subsection{Double cohomology of moment angle complexes}\label{subsec_hhzk}
In~\cite{l-p-s-s}, the homology of the moment-angle complex $H_*(\mathcal Z_K)=\bigoplus_{I\subset[m]}\widetilde H_*(K_I)$ was endowed with the second differential~$\partial'$. The 
homology of the resulting chain complex $\CH_*(\zk)=(H_*(\zk),\partial')$ was called the double homology of~$\zk$. We use this construction to define a new bigraded persistence module $\mathcal{PHHZ}(X)$.

Given $j\in[m]\setminus I$, consider the homomorphism
\[
  \phi_{p;I,j}\colon\widetilde H_p(K_I)\to \widetilde H_p(K_{I\sqcup\{j\}})
\]
induced by the inclusion $K_I\hookrightarrow K_{I\cup\{j\}}$. Then define
\[
  \partial'_p=(-1)^{p+1}\bigoplus_{I\subset[m],\,j\in[m]\setminus I}\varepsilon(j,I)\,\phi_{p;I,j},
\]
where 
\[
  \varepsilon(j,I)=(-1)^{\#\{i\in I\colon i<j\}}.
\]

The homomorphism $\partial'_p\colon\bigoplus_{I\subset[m]}\widetilde H_p(K_I)\to\bigoplus_{I\subset[m]}\widetilde H_p(K_I)$ satisfies $(\partial'_p)^2=0$. 
We therefore have a chain complex 
\begin{equation}\label{CH}
  \CH_\ast(\zk)\colonequals (H_\ast(\zk), \partial'),\quad
  \partial' \colon \widetilde{H}_{-i, 2j}(\zk) \to \widetilde{H}_{-i-1, 2j+2}(\zk),
\end{equation}
and bigraded \emph{double homology} of $\zk$:
\[
  \HH_\ast(\zk)=H(H_\ast(\zk), \partial').
\]

\emph{Double cohomology} of $\zk$ is defined similarly:
\[
  \HH^\ast(\zk)=H(H^\ast(\zk), d'),\quad
  d'\colon \widetilde{H}^{-i, 2j}(\zk) \to \widetilde{H}^{-i+1, 2j-2}(\zk)
\]
Double cohomology $\HH^\ast(\zk)$ can also be defined as the first double cohomology of the bicomplex
$\bigl(\Lambda[u_1,\ldots,u_m]\otimes
\mathbf k[K],d,d'\bigr)$ with $d=\sum_{i=1}^mv_i\frac\partial{\partial u_i}$, $d'=\sum_{i=1}^m\frac\partial{\partial u_i}$ and $dd'=-d'd$:
\[
  \HH^*(\zk)\cong H\bigl(H\bigl(\Lambda[u_1,\ldots,u_m]\otimes
  \mathbf k[K],d\bigr),d'\bigr),
\]
see~\cite[Theorem~4.3]{l-p-s-s}.

If $K=\Delta^{m-1}$, the full simplex on~$[m]$, then double homology is trivial:
\[
  \HH_*(\zk)=\mathbf k_{(0,0)}
\]
(the latter means that $\HH_{0,0}(\zk)\cong\mathbf k$ and $\HH_{-i,2j}(\zk)=0$ if $(-i,2j)\ne(0,0)$).

An important property of double homology is that attaching a simplex to $K$ along a face (in particular, adding a disjoint simplex) destroys most of $\HH_*(\zk)$, as described next:

\begin{theorem}[{\cite[Theorem~6.7]{l-p-s-s}}]\label{surgery}
Let $K=K' \cup_I  \Delta^n$ be a simplicial complex obtained from a nonempty simplicial complex $K'$ by gluing an $n$-simplex, $n\ge0$, along a proper, possibly empty, face $I \in K'$. Then either $K$ is a simplex, or 
\[
  \HH_*(\zk)=\mathbf k_{(0,0)}\oplus\mathbf k_{(-1,4)}.
\]
\end{theorem}


\begin{definition}\label{def_outlier}
Let $(X, d_X)$ be a finite metric space. A point $x\in X$ is a \emph{strong outlier} if for any $y\ne x$ holds the inequality
\[
  d_X(x,y)\geq \max_{y'\neq x} d_X(y, y'). 
\]
\end{definition}


\begin{proposition}\label{HHout}
Suppose a finite metric space $(X, d_X)$ has a strong outlier. Let $D$ be the diameter of $(X, d_X)$, and let $R(X,t)$ be the Vietoris--Rips complex associated with $(X, d_X)$. Then, 
\[
\HH_\ast(\mathcal{Z}_{R(X,t)})=\begin{cases}
\mathbf k_{(0,0)} & t\geq D;\\
\mathbf k_{(0,0)}\oplus \mathbf k_{(-1,4)} & t<D
\end{cases}
\]
with all maps $\HH_\ast(\mathcal{Z}_{R(X,t)})\to \HH_\ast(\mathcal{Z}_{R(X,t')})$ being the identity if %$t, t' <0$ or 
$D\leq t\leq t'$, and the projection if $t<D\leq t'$.
\end{proposition}
\begin{proof}
The definition of an outlier $x$ implies that the Vietoris--Rips complex $R(X,t)$ is obtained from the Vietoris--Rips complex $R(X\setminus x,t)$ by attaching a simplex (with vertices $x$ and $\{y\colon d(x,y)\le t\}$) along its facet (with vertices $\{y\colon d(x,y)\le t\}$). The complex $R(X,t)$ is a simplex for $t\ge D$, and $R(X,t)$ is a simplicial complex obtained by gluing a $0$-simplex along an empty face of another simplicial complex for $t<D$. Then the result follows from Theorem~\ref{surgery}.
\end{proof}

We define the bigraded persistent double homology and the corresponding barcodes by analogy with Definition~\ref{bgph}:

\begin{definition}
Let $(X,d_X)$ be a finite pseudo-metric space and $\{R(X,t)\}_{t\geq 0}$ its associated Vietoris--Rips filtration.
The \emph{persistent double homology} module of bidegree $(-i,2j)$ is 
\[
  \mathcal{PHHZ}_{-i,2j}(X) \colon \RR_{\geq 0} \to \mathbf{k}\ts{-mod},\quad
  t\mapsto \HH_{-i,2j}(\mathcal Z_{R(X,t)}).
\]
It maps $t\in \RR_{\geq0}$ to the bigraded module  $\HH_{-i,2j}(\mathcal Z_{R(X,t)})$ and maps a morphism $t_1\leq t_2$ to the homomorphism $\HH_{-i,2j}(\mathcal Z_{R(X,t_1)})\to\HH_{-i,2j}(\mathcal Z_{R(X,t_2)})$ induced by the inclusion $\mathcal Z_{R(X,t_1)}\to \mathcal Z_{R(X,t_2)}$ (see~\cite[Proposition~4.8]{l-p-s-s}). We also define the bigraded persistent homology module
\begin{equation}\label{eq_PHHZ}
 \mathcal{PHHZ}(X)=
 \bigoplus_{\substack{0\leq i\leq m-1; \\ 0\leq j \leq m}}\mathcal{PHHZ}_{-i,2j}(X).
\end{equation}

One can view the bigraded persistent homology module~\eqref{eq_PHZ} as a functor to differential bigraded $\mathbf{k}$-modules,
\[
  \mathcal{PHZ}(X)\colon\RR_{\geq0}\to
  \ts{dg}(\mathbf k\ts{-mod}), \quad
  t\mapsto (H_{*,*}(\mathcal Z_{R(X,t)}),\partial').
\]
Then we have
\begin{equation}\label{phhcomposite}
  \mathcal{PHHZ}(X)=\mathcal H\circ\mathcal{PHZ}(X),
\end{equation}
where $\mathcal H\colon\ts{dg}(\mathbf k\ts{-mod}) \to\mathbf k\ts{-mod}$ is the homology functor. This will be convenient when we compare interleaving distances.
We denote by $\BDB(X)$ the barcode corresponding to the bigraded persistence module $\mathcal{PHHZ}(X)$.
\end{definition}

\begin{example}
Suppose $(X,d_X)$ has a strong outlier as in Definition \ref{def_outlier}. Then $\BDB(X)$ consists of an infinite bar $[0,\infty)$ at bidegree $(0,0)$ and a bar $[0,D)$ at bidegree $(-1,4)$, by Proposition~\ref{HHout}.
\end{example}

\begin{example}\label{ex_wedge_of_squares}
Let $G$ be the graph described below. 
\[
\begin{tikzpicture}[scale=0.8]
    \draw[fill] (0,0) circle (2pt);
    \draw[fill] (2,0) circle (2pt);
    \draw[fill] (1,1) circle (2pt);
    \draw[fill] (1,-1) circle (2pt);
    \draw[fill] (-2,0) circle (2pt);
    \draw[fill] (-1,1) circle (2pt);
    \draw[fill] (-1,-1) circle (2pt);
    \draw[thick] (0,0)--(1,1)--(2,0)--(1,-1)--(-1,1)--(-2,0)--(-1,-1)--(0,0);
    \node[above] at (-1,1) {$2$};
    \node[left] at (-2,0) {$1$};
    \node[below] at (-1,-1) {$3$};
    \node[above] at (0,0) {$4$};
    \node[above] at (1,1) {$5$};
    \node[right] at (2,0) {$7$};
    \node[below] at (1,-1) {$6$};
\end{tikzpicture}
\]
The associated finite pseudo-metric space $(X,d_X)$ is the set of vertices of $G$ with the geodesic distance, namely the distance between two vertices is the number of edges in a shortest path. For a subset $A \subset [7]$, we denote by $\Delta_A$ the simplex over the vertex set  $A$. Then, the Vietoris--Rips simplicial complex $R(X, t)$ associated with $(X, d_X)$ is given by 
\[
R(X,t)=\begin{cases}
X & 0\leq t < 1;\\
G & 1\leq t < 2;\\
\Delta_{\{1,2,3,4\}}\cup_{\Delta_{\{2,3,4\}}} \Delta_{\{2,3,4,5,6\}} \cup_{\Delta_{\{4,5,6\}}} \Delta_{\{4,5,6,7\}} & 2\leq t<3; \\
\Delta_{\{1,2,3,4,5,6\}} \cup_{\Delta_{\{2,3,4,5,6\}}} \Delta_{\{2,3,4,5,6,7\}} & 3\leq t < 4;\\
\Delta_{[7]} & 4\leq t.
\end{cases}
\]
In this case, the first four simplicial complexes have double homology $\HH_\ast(\mathcal{Z}_{R(X,t)})$ isomorphic to $\mathbf{k}_{(0,0)}\oplus \mathbf{k}_{(-1,4)}$ by Theorem \ref{surgery} and the main result of \cite{SV-arXiv}. Hence, $\mathbb{BB}(X)$ consists of an infinite bar $[0, \infty)$ at bidegree $(0,0)$ and a bar $[0,4)$ at bidegree $(-1,4)$. 
\end{example}

In Example \ref{ex_wedge_of_squares}, if we only consider the subset $S=\{1,2,3,4\}$ of $X$, we get more interesting bigraded barcode $\mathbb{BB}(S)$ with $[0, \infty)$ in bidegree $(0,0)$, $[0,2)\oplus [1,2)$ in bidegree $(-1,4)$ and $[1,2)$ in bidegree $(-2, 8)$. Essentially after removing the points $\{5,6,7\}$, we can see the circle, but with all of $X$ we only see two points $\{1,7\}$. Similarly if we have a strong outlier, we only see two points, but removing it could give interesting bigraded barcode of $\mathcal{PHHZ}$. Perhaps, the bigraded barcode of $\mathcal{PHHZ}$ is sensitive to detecting minimal subcomplexes that carry persistent homology classes.  


The following example shows that the persistent double homology module might detect different local structure of a given filtration. 

\begin{example}
Consider two filtrations of graphs shown in Figure \ref{fig_two_filtrations}. Starting with the 5 distinct points, each of the second term is homotopy equivalent to the disjoint union of a circle and a point. The third terms are homotopy equivalent to a wedge of two circles. Hence, the usual persistent homology module $\mathcal{PH}$ does not distinguish between these filtrations. However, the bigraded persistent double homology module $\mathcal{PHHZ}$ gives different signals in its bigraded barcode. 

Indeed, in the first filtration, each of the simplicial complex has the double homology isomorphic to $\mathbb{Z}_{(0,0)}\oplus \mathbb{Z}_{(-1,4)}$ by Theorem \ref{surgery} and \cite[Example 8.7]{l-p-s-s}. Hence, the corresponding bigraded barcodes begins with two bars and persist up to the parameter corresponding to the third term. 

In the second filtration, the second term has the double homology isomorphic to $\mathbb{Z}_{(0,0)}\oplus \mathbb{Z}_{(-1,4)}$ by Theorem \ref{surgery}. However, the third term, say $K$, is the join of two disjoint points and three disjoint points. Therefore $\zk$ is homotopy equivalent to 
\[S^3\times (S^3\vee S^3\vee S^3\vee S^4\vee S^4).\] 
Moreover, $\HH^*(\zk)$ is isomorphic to $\mathbb{Z}_{(0,0)}\oplus \mathbb{Z}^2_{(-1,4)}\oplus \mathbb{Z}_{(-2,8)}$ by Theorem \ref{surgery} together with \cite[Theorem 6.3]{l-p-s-s}. Hence, the corresponding bigraded barcode begins with two bars and  extra two bars are born from the parameter for the thrid term. 
\end{example}

\begin{figure}
\begin{tikzpicture}[scale=0.8]
\draw[fill=red, red] (1,0) circle (2pt);
\draw[fill=red, red] (-1,0) circle (2pt);
\draw[fill=red, red] (0,1/2) circle (2pt);
\draw[fill=red, red] (0,-1/2) circle (2pt);
\draw[fill=red, red] (0,0) circle (2pt);
\node at (2,0) {$\hookrightarrow$};
\begin{scope}[xshift=120]
\draw[thick] (0,0)--(-1,0)--(0,1/2)--cycle;
\draw[thick] (0,-1/2)--(1,0);
\draw[fill=red, red] (1,0) circle (2pt);
\draw[fill=red, red] (-1,0) circle (2pt);
\draw[fill=red, red] (0,1/2) circle (2pt);
\draw[fill=red, red] (0,-1/2) circle (2pt);
\draw[fill=red, red] (0,0) circle (2pt);
\node at (2,0) {$\hookrightarrow$};
\end{scope}
\begin{scope}[xshift=240]
\draw[thick] (-1,0)--(0,1/2)--(0,0)--cycle;
\draw[thick] (0,0)--(1,0)--(0,-1/2)--cycle;
\draw[fill=red, red] (1,0) circle (2pt);
\draw[fill=red, red] (-1,0) circle (2pt);
\draw[fill=red, red] (0,1/2) circle (2pt);
\draw[fill=red, red] (0,-1/2) circle (2pt);
\draw[fill=red, red] (0,0) circle (2pt);
\node at (2,0) {$\hookrightarrow$};
\node at (3,0) {$\cdots$};
\end{scope}

\begin{scope}[yshift=-60]
\draw[fill=blue, blue] (1,0) circle (2pt);
\draw[fill=blue, blue] (-1,0) circle (2pt);
\draw[fill=blue, blue] (0,1/2) circle (2pt);
\draw[fill=blue, blue] (0,-1/2) circle (2pt);
\draw[fill=blue, blue] (0,0) circle (2pt);
\node at (2,0) {$\hookrightarrow$};
\begin{scope}[xshift=120]
\draw[thick] (-1,0)--(0,1/2)--(0,-1/2)--cycle;
\draw[fill=blue, blue] (1,0) circle (2pt);
\draw[fill=blue, blue] (-1,0) circle (2pt);
\draw[fill=blue, blue] (0,1/2) circle (2pt);
\draw[fill=blue, blue] (0,-1/2) circle (2pt);
\draw[fill=blue, blue] (0,0) circle (2pt);
\node at (2,0) {$\hookrightarrow$};
\end{scope}
\begin{scope}[xshift=240]
\draw[thick] (1,0)--(0,1/2)--(-1,0)--(0,-1/2)--cycle;
\draw[thick] (0,1/2)--(0,-1/2);
\draw[fill=blue, blue] (1,0) circle (2pt);
\draw[fill=blue, blue] (-1,0) circle (2pt);
\draw[fill=blue, blue] (0,1/2) circle (2pt);
\draw[fill=blue, blue] (0,-1/2) circle (2pt);
\draw[fill=blue, blue] (0,0) circle (2pt);
\node at (2,0) {$\hookrightarrow$};
\node at (3,0) {$\cdots$};
\end{scope}
\end{scope}
\end{tikzpicture}
\caption{Two filtrations of graphs.}
\label{fig_two_filtrations}
\end{figure}


\section{Stability}\label{sec_stability_HZK}
In this section, we establish stability properties of the bigraded persistence modules $\mathcal{PHZ}(X)$ and $\mathcal{PHHZ}(X)$, see  Theorems \ref{thm_BB_stable} and \ref{thm_BB_HH_stable}. 



\subsection{Distance functions}
We first summarize several distance functions defined on the categories of finite pseudo-metric spaces and  persistence modules. 

\begin{definition}\label{def_GH_distance}
The \emph{Hausdorff distance} between two nonempty subsets $A$ and $B$ in a finite pseudo-metric space $(Z,d)$ is 
\[
  d_H(A,B)\vcentcolon= \max\bigl\{\sup_{a\in A}d(a,B),\,\sup_{b\in B}d(A,b)\bigr\}.
\]
The \emph{Gromov--Hausdorff distance} between two finite pseudo-metric spaces $X$ and $Y$ is 
\[
  \dgh(X,Y)\vcentcolon= \inf_{Z, f, g}
  d_H(f(X), g(Y)),
\]
where the infimum is taken over all isometric embeddings $f\colon X\to Z$ and $g \colon Y \to Z$ into a pseudo-metric space~$Z$.  
\end{definition}

Using the notion of a correspondence between two sets, one can give an alternative definition of the Gromov--Hausdorff distance, which is often convenient for computational purposes. 

\begin{definition}\label{def_correspondence}
Given two sets $X$ and $Y$ and a subset $C$ of $X\times Y$, define $D_{C}(x)$ as the number of $y\in Y$ for which $(x,y)\in C$. Similarly, define $D_C(y)$ as the number of $x\in X$ for which $(x,y)\in C$.
A \emph{correspondence} between two sets $X$ and $Y$ is a subset $C$ of $X\times Y$ such that both $D_{C}(x)$ and $D_C(y)$ are nonzero.
\end{definition}

Note that the condition $D_{C}(x)\geq 1$ for all $x\in C$ is equivalent to saying that $C$ is a (multi-valued) mapping with domain $X$ and range~$Y$. Furthermore, the condition $D_{C}(y)\geq 1$ is equivalent to saying that $C$ is surjective. 

\begin{proposition}[{\cite[Theorem 7.3.25]{BBI}}]
For two finite pseudo-metric spaces $(X, d_X)$ and $(Y, d_Y)$, 
\begin{equation}\label{eq_GH_distance_corresp}
\dgh(X,Y)=\frac{1}{2}\min\limits_{C}\max\limits_{(x_{1},y_{1}),(x_{2},y_{2})\in C}|d_{X}(x_{1},x_{2})-d_{Y}(y_{1},y_{2})|.
\end{equation}
\end{proposition}

We have the following modification of the Gromov--Hausdorff distance~\eqref{eq_GH_distance_corresp}, to be used below.

\begin{definition}\label{d'gh}
For two finite pseudo-metric spaces $(X, d_X)$ and $(Y, d_Y)$ of the same cardinality, define $\dpgh(X,Y)$ by formula~\eqref{eq_GH_distance_corresp} in which the infimum is taken over bijective correspondences $C$ only.
\end{definition}

Obviously, $\dpgh(X,Y)\geq \dgh(X,Y)$ for any pair of pseudo-metric spaces of the same cardinality. The next example shows that for two pseudo-metric spaces $X$ and $Y$ of the same cardinality, the difference between $\dgh(X,Y)$ and $\dpgh(X,Y)$ can be arbitrary large.

\begin{example}
Fix $n>2$. Let $X$ consist of four vertices of a rectangle in $\mathbb R^2$ with two edges of length~$1$ and diagonals of length~$n$. Let $Y$ consist of four vertices of a tetrahedron in $\mathbb R^3$ with the base an equilateral triangle with edges of length~1 and the other three edges of length~$n$. See Figure~\ref{fig_dgh_neq_d_prime_GH}. It is easy to see that $\dpgh(X,Y)=\frac{1}{2}(n-1)$, while $\dgh(X,Y)=\frac{1}{2}$.     
\end{example}

\begin{figure}
\begin{tikzpicture}[scale=0.6]
    \draw[dotted] (0,0)--(0,2)--(8,2)--(8,0)--cycle;
    \draw[dotted] (0,0)--(8,2);
    \draw[dotted] (0,2)--(8,0);
    \draw[fill] (0,2) circle (3pt);
    \draw[fill] (8,2) circle (3pt);
    \draw[fill] (8,0) circle (3pt);
    \draw[fill] (0,0) circle (3pt);
    \node[left] at (0,1) {\footnotesize$1$};
    \node[right] at (8,1) {\footnotesize$1$};
    \node[below] at (1.3,1.7) {\footnotesize$n$};
    \node[below] at (6.7,1.7) {\footnotesize$n$};
    \node at (4,-1) {$X$};
\begin{scope}[xshift=320]
    \draw[dotted] (0,0)--(1,1)--(0,2)--cycle;
    \draw[dotted] (8,1)--(0,0);
    \draw[dotted] (8,1)--(0,2);
    \draw[dotted] (8,1)--(1,1);

    \draw[fill] (0,0) circle (3pt);
    \draw[fill] (0,2) circle (3pt);
    \draw[fill] (1,1) circle (3pt);
    \draw[fill] (8,1) circle (3pt);

    \node[left] at (0,1) {\footnotesize$1$};
    \node at (0.7, 1.6) {\footnotesize$1$};
    \node at (0.7,0.4) {\footnotesize$1$};

    \node at (2.5,2) {\footnotesize$n$};
    \node at (3.5,1) {\footnotesize$n$};
    \node at (2.5,0) {\footnotesize$n$};

    \node at (4,-1) {$Y$};

\end{scope}
\end{tikzpicture}
\caption{Pseudo-metric spaces $X$ and $Y$ with $d_{GH}(X,Y)\neq d'_{GH}(X, Y).$}
\label{fig_dgh_neq_d_prime_GH}
\end{figure}

Next, we introduce a distance function for persistence modules. 

Given a persistence module $\mathcal{M}$ as in \eqref{eq_persistent_module}  and an arbitrary $\epsilon\in \RR_{\geq 0}$, we define  
\[
\mathcal{M}^\epsilon\colon \RR_{\geq 0} \to \mathbf{k}\ts{-mod}
\]
by $\mathcal{M}^\epsilon(s)=\mathcal{M}(s+\epsilon)$ and $\mathcal{M}^\epsilon(\phi_{s_1,s_2})=
\phi_{s_1+\epsilon, s_2+\epsilon}$. There is a natural transformation 
\[
\eta^\epsilon_\mathcal{M} \colon \mathcal{M} \to \mathcal{M}^\epsilon
\]
defined by the family of morphisms $\{ M_{s} \to M_{s+\epsilon} \mid s\in \mathbb{R}_{\geq 0}\}$. 

Given two persistence modules $\mathcal{M}$ and $\mathcal{N}$, we say that $\mathcal{M}$ and $\mathcal{N}$ are \emph{$\epsilon$-interleaved} if there exist natural transformations  
\[
\beta \colon \mathcal{M} \to \mathcal{N}^\epsilon\quad \text{ and }\quad \gamma \colon \mathcal{N} \to \mathcal{M}^\epsilon
\]
such that $\beta^\epsilon \circ \gamma = \eta_\mathcal{N}^{2\epsilon}$ and $\gamma^\epsilon \circ \beta = \eta_\mathcal{M}^{2\epsilon}$, 
where $\beta^\epsilon \colon \mathcal{M}^\epsilon \to \mathcal{N}^{2\epsilon}$ and $\gamma^\epsilon \colon \mathcal{N}^\epsilon \to \mathcal{M}^{2\epsilon}$ denote the $\epsilon$-shifts of $\beta$ and $\gamma$, respectively.

\begin{definition}
The \emph{interleaving distance} between two persistence modules $\mathcal{M}$ and $\mathcal{N}$ is% the infimum
\[
d_{\IL}(\mathcal{M}, \mathcal{N})\colonequals \inf \{\epsilon \in \RR_{\geq 0} \mid \mathcal{M} \text{ and } \mathcal{N} \text{ are $\epsilon$-interleaved}\}.
\]
\end{definition}

\begin{example}\label{ex-ild}
The interleaving distance between two interval modules $\mathbf{k}\left([a,b)\right)$ and $\mathbf{k}\left([a',b')\right)$ (see Example \ref{ex_interval_module}) is  given by 
\[
d_{\IL} \big(\mathbf{k}\left([a,b)\right), \mathbf{k}\left([a',b')\right) \big) = \min \left\{ \max \left\{ \frac{b-a}{2}, \frac{b'-a'}{2}\right\}, \max\{|a'-a|, |b'-b|\}\right\}.
\]
This formula has the following meaning. If the intervals are close to each other (the closure of each interval contains the midpoint of the other), then the distance is the maximum of the distances between their endpoints, i.\,e. $\max\{|a'-a|, |b'-b|\}$, which is the standard $l^\infty$-distance between the two intervals. If the intervals are far apart, then the distance is $\max \left\{ \frac{b-a}{2}, \frac{b'-a'}{2}\right\}$, where $\frac{b-a}{2}$ is the $l^\infty$-distance between $[a,b)$ and a `zero length interval' at the midpoint of~$[a,b)$.

The zero persistence module can be thought of as the interval module $\mathbf{k}(\varnothing)$ of an empty interval. In this case, the interleaving distance is given by
\[
  d_{\IL}\big(\mathbf{k}\left([a,b)\right), \mathbf{k}(\varnothing) \big) =\frac{b-a}2.
\]
\end{example}

Below, we record the following properties of $d_{\IL}$ for future use.

\begin{proposition}[{see~\cite[Proposition~5.5]{CSGO}}]
\label{oplus}
Let $\mathcal M_1$, $\mathcal M_2$, $\mathcal N_1$ and $\mathcal N_2$ be persistence modules. Then
\[
  d_{\IL}(\mathcal M_1\oplus\mathcal M_2,
  \mathcal N_1\oplus\mathcal N_2)\le
  \max\bigl(d_{\IL}(\mathcal M_1,\mathcal N_1), d_{\IL}(\mathcal M_2,\mathcal N_2)\bigr).
\]
\end{proposition}

More generally, the interleaving distance can be defined for persistence modules $\mathcal M\colon\RR_{\geq0}\to\ts{c}$ taking values in any Grothendieck category $\ts{c}$ instead of $\mathbf{k}\ts{-mod}$, see~\cite{b-s-s}. The following result is clear from the definition.

\begin{proposition}\label{prop_d_IL_composition}
Given two functors $\mathcal{M}$ and $\mathcal{N}$ from $\RR_{\geq 0}$ to $\ts{c}$, and a functor $\mathcal{F}\colon \ts{c} \to \ts{d}$, we have:
\begin{equation*}
d_{\IL}(\mathcal{F}\circ \mathcal{M}, \mathcal{F}\circ \mathcal{N}) \leq d_{\IL}(\mathcal{M}, \mathcal{N}).
\end{equation*}
\end{proposition}

Next, we introduce the bottleneck distance between multisets of intervals (or barcodes). It is defined in the standard way as the infimum over matchings between them, in which some of the intervals can be matched to zero length intervals at their midpoints.

Let $B$ and $B'$ be finite multisets of intervals of the form $[a,b)$ with $a\in\RR_{\ge0}$ and $b\in\RR_{\geq 0} \cup \{\infty\}$. Define the multiset $\overline{B}=B\cup\varnothing^{|B'|}$, obtained by adding to $B$ the multiset containing the empty interval $\varnothing$ with cardinality~$|B'|$. Similarly, define $\overline{B'}=B'\cup\varnothing^{|B|}$. Note that $\overline{B}$ and $\overline{B'}$ have the same cardinality. We define the distance function 
\[
\pi \colon \overline{B}\times \overline{B'} \to \RR_{\geq 0}\cup \{\infty\}
\]
by the formulae:
\begin{gather*}
  \pi\left( [a, b), [a', b')\right)= \max\{|a'-a|, |b'-b| \},\quad \pi([a,\infty),[a',\infty))=|a'-a|,\\
  \pi([a,b),\varnothing)=\frac{b-a}2,\quad
  \pi(\varnothing,[a',b'))=\frac{b'-a'}2,\quad
  \pi(\varnothing,\varnothing)=0,\\
  \pi([a,\infty),[a',b'))=\pi([a,b),[a',\infty))=
  \pi([a,\infty),\varnothing)=\pi(\varnothing,[a',\infty))=\infty
\end{gather*}
for finite $a,b,a',b'$. 

\begin{definition}\label{def_Wasserstein}
Denote by $\mathcal{D}\left(\overline{B}, \overline{B'}\right)$ the set of all bijections $\theta \colon \overline{B} \to  \overline{B'}$. %such that $\pi(I, \theta(I))\neq 0$ for only finitely many intervals $I$ in $\overline{B}$. 
Then the \emph{$\infty$-Wasserstein distance}, also called the \emph{bottleneck distance}, is defined as follows:
\[
  W_\infty(B, B')=\min_{\theta \in \mathcal{D}(\overline{B}, \overline{B'})} \max_{ I \in \overline{B}} \, \pi(I, \theta(I)).
\]
%Let
%\[
%  \overline{\mathcal B}=
%  \bigoplus_{I\in B}\mathbf k(I)\oplus\bigoplus_{I\in B'}\mathbf k(\varnothing)\quad\text{and}\quad
%  \overline{\mathcal B'}=
%  \bigoplus_{I\in B'}\mathbf k(I)\oplus\bigoplus_{I\in B}\mathbf k(\varnothing)
%\]
%be the persistence modules corresponding to the multisets $\overline{B}$ and $\overline{B'}$. 
It can be shown~\cite[Definition~4.11]{BuSc} that
\[
  W_\infty(B, B')=\min_{\theta \in \mathcal{D}(\overline{B}, \overline{B'})} \max_{ I \in \overline{B}} \, d_{\IL}\bigl(\mathbf k(I),\mathbf 
  k( \theta(I))\bigr),
\]
where the interleaving distance between interval modules can be expressed via the $l^\infty$-distance as in Example~\ref{ex-ild}.
%The \emph{$p$-Wasserstein distance} between two sets of intervals $B$ and $B'$ is defined by 
%\[
%W_p(B, B')=\inf_{\theta \in \mathcal{D}(\overline{B}, \overline{B'})} \biggl(\sum_{I\in \mathcal{\overline{B}}} \pi(I, %\theta(I))^p \biggr)^\frac{1}{p},
%\]
\end{definition}

\begin{example}\ \
%\begin{enumerate}
%\item 

\noindent\textbf{1.} Let $B=\{[0,5)\}$ and $B'=\{[1,7)\}$. Then $\overline B=\{[0,5),\varnothing\}$ and $\overline {B'}=\{[1,7),\varnothing\}$. There are two bijections between $\overline B$ and $\overline{B'}$:
\[
\theta_1\colon[0,5)\mapsto[1,7),\,\varnothing\mapsto\varnothing,\quad\text{and}\quad\theta_2\colon[0,5)\mapsto\varnothing,\,\varnothing\mapsto[1,7).
\]
The minimum of $\max_{ I \in \overline{B}} \, \pi(I, \theta(I))$ is achieved at $\theta_1$, which reflects the fact that the two intervals overlap sufficiently. We have $W_\infty(B, B')=\pi([0,5),[1,7))=7-5=2$.

\smallskip

%\item 
\noindent\textbf{2.} Let $B=\{[0,5)\}$ and $B'=\{[3,9)\}$. These two intervals are `far apart', so the minimum of $\max_{ I \in \overline{B}} \, \pi(I, \theta(I))$ is achieved when both $[0,5)$ and $[3,9)$ are matched to an empty interval. We have $W_\infty(B, B')=\pi(\varnothing,[3,9))=3$.
%\end{enumerate}
\end{example}

In the literature, the following result is often referred to as the \emph{isometry theorem}, see \cite[Theorem 3.4]{Les}. We also refer to \cite[Theorem 4.16]{BuSc} and \cite[Theorem 5.14]{CSGO} for different versions of this result:

\begin{theorem}\label{prop_isometry}
Let $\mathcal{M}$ and $\mathcal{N}$ be persistence modules satisfying the hypothesis of~Theorem~\ref{prop_decomp_persitent_module}. Then, 
\[
d_{\IL}(\mathcal{M}, \mathcal{N})=W_\infty(B(\mathcal{M}), B(\mathcal{N})),
\]
where $B(\mathcal{M})$ and $B(\mathcal{N})$ are the barcodes corresponding to $\mathcal{M}$ and $\mathcal{N}$, respectively. 
\end{theorem}

The \emph{stability theorem} asserts that the persistent homology barcodes are stable under perturbations of the data sets in the Gromov--Hausdorff metric. It is a key result justifying the use of persistent homology in data science. We refer to~\cite[Theorem~3.1]{Ch} and~\cite[Lemma~4.3, Theorem~5.2]{c-d-o14} for the proof:

\begin{theorem}\label{stabph}
Let $(X,d_X)$ and $(Y,d_Y)$ be two finite pseudo-metric spaces, and let $B(X)$ and $B(Y)$ be the barcodes corresponding to the persistence modules $\PH(X)$ and $\PH(Y)$. Then,
\[
  d_{\IL}(\PH(X),\PH(Y))\le 2d_{GH}(X,Y),
\]
and when working over a field, 
\[
  W_\infty(B(X),B(Y))\le 2d_{GH}(X,Y).
\]
\end{theorem}
   




\subsection{The doubling operation}
The following construction plays a key role in proving a stability property of persistent double homology.

\begin{definition}\label{def_doubling_metric_sp}
Given a pseudo-metric space $(X, d_X)$ and a point $x\in X$, we refer to the pseudo-metric space $X^{\prime}=X\sqcup\{x^{\prime}\}$ with  $d_{X^{\prime}}(x,x^{\prime})=0$ as the \emph{doubling} of $X$ at~$x$.

Given a simplicial complex $K$ on $[m]$ and a vertex $\{i\}$ of $K$, the \emph{doubling} of $K$ at~$\{i\}$ is the minimal simplicial complex $K'$ on the set $[m]\sqcup\{i'\}$ which contains~$K$ and all subsets $I\sqcup \{i'\}$, where $i\in I\in K$. There is a deformation retraction $K'\to K$ sending $\{i'\}$ to $\{i\}$ and identity on other vertices. See Figure~\ref{fig_doubl}.
\begin{figure}[h]
\begin{tikzpicture}[scale=0.5]
\draw[very thick, fill=gray!50] (0,1)--(3,2)--(3,0)--cycle;
\draw[very thick] (3,2)--(6,1)--(3,0);
\draw[fill] (0,1) circle (3pt);
\draw[fill] (3,2) circle (3pt);
\draw[fill] (6,1) circle (3pt) 
node[anchor=west]{\ $i$};
\draw[fill] (3,0) circle (3pt);
\node at (2.9,-1) {$K$};
%
\draw[very thick, fill=gray!50] (11,1)--(14,2)--(14,0)--cycle;
\draw[very thick, fill=gray!50] (14,2)--(17,3)--(17,1)--cycle;
\draw[very thick, fill=gray!50] (14,0)--(17,3)--(17,1)--cycle;
\draw[thick, dashed] (15.5,1.5)--(17,1);
\draw[fill] (11,1) circle (3pt);
\draw[fill] (14,2) circle (3pt);
\draw[fill] (17,1) circle (3pt) 
node[anchor=west]{\ $i$};
\draw[fill] (17,3) circle (3pt) 
node[anchor=west]{\ $i'$};
\draw[fill] (14,0) circle (3pt);
\node at (13.9,-1) {$K'$};
\end{tikzpicture}
\caption{Doubling at a vertex.}
\label{fig_doubl}
\end{figure}

The doubling at a vertex is a particular case of the following operation introduced in~\cite{ab-pa19}.
Let $K$ be a simplicial complex on the set~$[m]$, and let $K_1, \ldots, K_m$ be simplicial complexes. The \emph{substitution} of $K_1, \ldots, K_m$ into $K$ is the simplicial complex
\[
  K(K_1, \ldots, K_m) = \{I_{j_1}\sqcup\dots\sqcup I_{j_k}\colon I_{j_l}\in K_{j_l},\; l = 1,\dots, k \quad\text{and}\quad \{j_1, \dots, j_k\}\in K\}.
\]
The doubling of $K$ at $\{i\}$ is the substitution complex $K(1,\ldots,\Delta[i,i'],\ldots,m)$, where~$\Delta[i,i']$ denotes the 1-simplex on $i$ and $i'$.

Observe that if $X'$ is the doubling of a pseudo-metric space $X$ at a point, then the Vietoris--Rips complex $R(X',t)$ is the doubling of $R(X,t)$ at a vertex, i.\,e. $R(X',t)=R(X,t)'$.
\end{definition}

\begin{proposition}\label{prop_d_GH_X_X'=0}
Suppose $\widehat{X}$ is obtained from $X$ by an arbitrary number of doubling operations performed at arbitrary points on the way. Then $d_{GH}(X,\widehat{X})=0$.
\end{proposition}

\begin{proof}
Using the triangle inequality, we reduce the claim to the case when $\widehat X$ is obtained from $X$ by a single doubling operation, i.\,e. $\widehat X=X'=X\sqcup \{x_0'\}$ is a doubling at $x_0\in X$. 

We use~\eqref{eq_GH_distance_corresp} and consider the following correspondence $C$ between $X$ and $X^{\prime}$:
\[
C \colonequals \{(x,x)\in  X\times X' \mid x\in X\}\sqcup \{(x_0,x_0')\}.
\]
Note that for any $s\in X$ with $ s\neq x_{0}$, the number $D_{C}(s)$ of $x
\in X'$ for which $(s,x)\in C$ is $1$. Similarly, $D_{C}(x_{0})=2$ and $D_{C}(t)=1$ for all $t\in X^{\prime}$. See Definition \ref{def_correspondence}. The triangle inequality together with $d_{X'}(x_0,x_0')=0$ implies $d_{X}(x_{1},x_{2})=d_{X^{\prime}}(y_{1},y_{2})$ for any $(x_{1},y_{1}),(x_{2},y_{2})\in C$, hence $d_{GH}(X,X^{\prime})=0$.
\end{proof}

\begin{proposition}\label{prop_dGH_d_prime_GH}
Given two finite pseudo-metric spaces $X$ and $Y$, 
there exist two finite pseudo-metric spaces $\widehat{X}$ and $\widehat{Y}$ such that $|\widehat X|=|\widehat Y|$ and 
\[
d_{GH}(X,Y)=d^{\prime}_{GH}(\widehat{X},\widehat{Y}),
\]
where $d_{GH}^{\prime}$ is the modified Gromov--Hausdorff distance, see Definition \ref{d'gh}.
\end{proposition}
\begin{proof}
For two finite pseudo-metric spaces $S$ and $T$ of the same cardinality, we have 
\begin{equation}\label{eq_d_GH_leq_d'_GH}
d_{GH}(S,T)\leq d^{\prime}_{GH}(S,T),
\end{equation}
because any bijection is a correspondence between $S$ and~$T$. 

Now let $\widehat{X}$ and $\widehat{Y}$ be pseudo-metric spaces obtained by iterated doublings of $X$ and $Y$, respectively, so that $\widehat{X}$ and $\widehat{Y}$ have the same cardinality. The triangle inequality together with Proposition~\ref{prop_d_GH_X_X'=0} implies
\begin{align*}% \label{eq_d_GH_leq_d'_GH_hat}
\begin{split}
d_{GH}(X,Y)&\leq d_{GH}(X,\widehat{X})+d_{GH}(\widehat{X},\widehat{Y})+d_{GH}(\widehat{Y},Y) \\
&=d_{GH}(\widehat{X},\widehat{Y}) \leq d^{\prime}_{GH}(\widehat{X},\widehat{Y}),
\end{split}
\end{align*}
where second equality follows from Proposition \ref{prop_d_GH_X_X'=0} and the last inequality follows from \eqref{eq_d_GH_leq_d'_GH}. 

To complete the proof, we construct iterated doublings $\widehat{X}$ and $\widehat{Y}$ such that $d'_{GH}(\widehat{X},\widehat{Y})\leq d_{GH}(X,Y)$.
% and $d_{GH}(\widehat{X},\widehat{Y})$ is attained on a {\bf{bijective}} correspondence $\widehat{C}$. 
Let $C$ be a correspondence which realizes $d_{GH}(X,Y)$. If $C$ is a bijection (in particular, $|X|=|Y|$), then there is nothing to prove. So we assume that $C$ is not a bijection. 

First, consider all the vertices $x\in X$ such that $D_{C}(x)>1$ and double each of them~$D_{C}(x)-1$ times. We get a new pseudo-metric space $\widehat{X}$ and a new correspondence~$C^{\prime}$ between $\widehat{X}$ and $Y$ which matches each double of $x$ with a single point of~$Y$. If~$C^{\prime}$ is a bijection, we set $\widehat{Y}=Y$ and we have 
\begin{align}\label{eq_d_GH_geq_d'_GH}
\begin{split}
d_{GH}(X,Y) &= \frac{1}{2} \max_{(x,y), (x', y')\in C} |  d_X(x,x')-d_Y(y,y') | \\
&= \frac{1}{2} \max_{(x,y), (x', y')\in C'} |  d_{\widehat{X}}(x,x')-d_{\widehat{Y}}(y,y') | \geq d'_{GH}(\widehat{X},\widehat{Y}),
\end{split}
\end{align}
where the second equality follows because the set 
$\{ |  d_X(x,x')-d_Y(y,y') |\} _{ (x,y), (x', y')\in C }$ coincides with 
$\{ |  d_{\widehat{X}}(x,x')-d_{\widehat{Y}}(y,y') | \}_{(x,y), (x', y')\in C'}$ and the last inequality follows from Definition \ref{d'gh}.

If $C'$ is not a bijection, then it is a single-valued surjective mapping from $\widehat{X}$ to~$Y$, which is not yet injective, so we perform the next step. Consider all the vertices $y\in Y$ such that $D_{C^{\prime}}(y)>1$ and double each of them $D_{C^{\prime}}(y)-1$ times. We get a new pseudo-metric space $\widehat{Y}$ and a new correspondence $\widehat{C}$ between $\widehat{X}$ and $\widehat{Y}$ which matches each double of $y$ with a single point of~$\widehat X$. Now, $\widehat{C}$ is an injective mapping from $\widehat{X}$ to $\widehat{Y}$, therefore it is a bijection. See Figure \ref{fig_bijection_C_hat} for an example of this procedure. Now the same argument as in \eqref{eq_d_GH_geq_d'_GH} establishes the claim. 
\begin{figure}
\begin{tikzpicture}[xscale=0.8]
\node[left] at (0,-0.5) {\footnotesize$x_2$};
\node[left] at (0,0.5) {\footnotesize$x_1$};
\coordinate (x2) at (0,-0.5); 
\coordinate (x1) at (0,0.5); 

\node[right] at (2,1) {\footnotesize$y_1$};
\node[right] at (2,0) {\footnotesize$y_2$};
\node[right] at (2,-1) {\footnotesize$y_3$};
\coordinate (y1) at (2,1); 
\coordinate (y2) at (2,0); 
\coordinate (y3) at (2,-1); 

\draw[dotted, thick] (x1)--(y3);
\draw[dotted, thick] (x1)--(y1);

\draw[dotted, thick] (x2)--(y1);
\draw[dotted, thick] (x2)--(y2);
\draw[dotted, thick] (x2)--(y3);

\draw[fill=blue, thick] (0,-0.5) circle (2pt);
\draw[fill=blue, thick] (0,0.5) circle (2pt);

\draw[fill=red, thick] (2,-1) circle (2pt);
\draw[fill=red, thick] (2,0) circle (2pt);
\draw[fill=red, thick] (2,1) circle (2pt);

\node at (1,-1.5) {$C$};

\begin{scope}[xshift=150]

\draw[dotted, thick] (0,0.8)--(2,1);
\draw[dotted, thick] (0,0.4)--(2,-1);

\draw[dotted, thick] (0,-0.1)--(2,1);
\draw[dotted, thick] (0,-0.5)--(2,0);
\draw[dotted, thick] (0,-0.9)--(2,-1);


\node[left] at (0,0.8) {\footnotesize$x_{1,1}$};
\node[left] at (0,0.4) {\footnotesize$x_{1,2}$};

\node[left] at (0,-0.1) {\footnotesize$x_{2,1}$};
\node[left] at (0,-0.5) {\footnotesize$x_{2,2}$};
\node[left] at (0,-0.9) {\footnotesize$x_{2,3}$};

\draw[fill=blue, thick] (0,0.8) circle (2pt);
\draw[fill=blue, thick] (0,0.4) circle (2pt);

\draw[fill=blue, thick] (0,-0.9) circle (2pt);
\draw[fill=blue, thick] (0,-0.5) circle (2pt);
\draw[fill=blue, thick] (0,-0.1) circle (2pt);

\node[right] at (2,1) {\footnotesize$y_1$};
\node[right] at (2,0) {\footnotesize$y_2$};
\node[right] at (2,-1) {\footnotesize$y_3$};

\draw[fill=red, thick] (2,-1) circle (2pt);
\draw[fill=red, thick] (2,0) circle (2pt);
\draw[fill=red, thick] (2,1) circle (2pt);

\node at (1,-1.5) {$C'$};
\end{scope}

\begin{scope}[xshift=300]
\draw[dotted, thick] (0,0.8)--(2,1.2);
\draw[dotted, thick] (0,0.4)--(2,-0.8);

\draw[dotted, thick] (0,-0.1)--(2,0.8);
\draw[dotted, thick] (0,-0.5)--(2,0);

\draw[dotted, thick] (0,-0.9)--(2,-1.2);

\node[left] at (0,0.8) {\footnotesize$x_{1,1}$};
\node[left] at (0,0.4) {\footnotesize$x_{1,2}$};

\node[left] at (0,-0.1) {\footnotesize$x_{2,1}$};
\node[left] at (0,-0.5) {\footnotesize$x_{2,2}$};
\node[left] at (0,-0.9) {\footnotesize$x_{2,3}$};

\draw[fill=blue, thick] (0,0.8) circle (2pt);
\draw[fill=blue, thick] (0,0.4) circle (2pt);

\draw[fill=blue, thick] (0,-0.9) circle (2pt);
\draw[fill=blue, thick] (0,-0.5) circle (2pt);
\draw[fill=blue, thick] (0,-0.1) circle (2pt);

\node[right] at (2,1.2) {\footnotesize$y_{1,1}$};
\node[right] at (2,0.8) {\footnotesize$y_{1,2}$};

\node[right] at (2,0) {\footnotesize$y_2$};

\node[right] at (2,-0.8) {\footnotesize$y_{3,1}$};
\node[right] at (2,-1.2) {\footnotesize$y_{3,2}$};

\draw[fill=red, thick] (2,1.2) circle (2pt);
\draw[fill=red, thick] (2,0.8) circle (2pt);

\draw[fill=red, thick] (2,0) circle (2pt);

\draw[fill=red, thick] (2,-.8) circle (2pt);
\draw[fill=red, thick] (2,-1.2) circle (2pt);

\node at (1,-1.5) {$\widehat C$};
\end{scope}
\end{tikzpicture}
\caption{From a correspondence to a bijection via iterated doublings.}
\label{fig_bijection_C_hat}
\end{figure}
\end{proof}

The proof of the last proposition also gives the following proposition. This could be helpful in proving other stability results. 

\begin{proposition}
Any correspondence between finite sets can be written as a composition of doublings and a single bijection. 
\end{proposition}

Next we show that the doubling of simplicial complexes preserves the double homology of the corresponding moment-angle complexes. 

\begin{proposition}\label{prop_doubling_HHZK}
Let $K'$ be obtained from $K$ by doubling a vertex. Then, 
\[
\HH_\ast(\mathcal{Z}_K) \cong \HH_\ast(\mathcal{Z}_{K'}).
\]
\end{proposition}
\begin{proof}
Let $K'$ be obtained by doubling of $K$ at $i\in [m]$. We recall the chain complex~\eqref{CH} and define the chain map 
\begin{equation*}%\label{eq_chain_map}
  \varphi \colon \CH_\ast(\mathcal{Z}_{K'}) = \Bigl(\bigoplus_{I\subset [m]\sqcup \{i'\} }\widetilde{H}_\ast(K'_I),\partial'\Bigr) \to \CH_\ast(\mathcal{Z}_{K}) = \Bigl(\bigoplus_{J\subset [m]}
  \widetilde{H}_\ast(K_J),\partial'\Bigr) 
\end{equation*}
by the property that for $\alpha\in \widetilde{H}_\ast(K'_I)$, 
\[
  \varphi(\alpha)=\begin{cases} 0 & \text{if } i'\in I;\\
  \alpha &\text{if } i' \notin I.
  \end{cases}
\]

We claim that the chain map $\varphi$ defined above 
% ~\eqref{eq_chain_map} 
is a weak equivalence. Since $\varphi$ is surjective, it suffices to show that $\ker \varphi$ is acyclic. 
Observe that 
\[
  \ker \varphi \cong \bigoplus_{i'\in I \subset [m]\sqcup \{i'\}} \widetilde{H}_\ast\left(K'_I\right)=
  \bigoplus_{L\subset[m]}\widetilde H_*(K'_{L\sqcup\{i'\}}).
\]
Let 
$T_n \colonequals \{ L \subset [m] \colon |L\setminus \{i\} | \geq n \}$
and define a decreasing filtration 
\[
  \ker\varphi=F_0\supset F_1\supset\cdots\supset F_n\supset\cdots
\]
with
\[
  F_n = \bigoplus_{L\in T_n}\widetilde H_*(K'_{L\sqcup\{i'\}}),\quad
  F_n/F_{n+1}=\bigoplus_{L\subset[m]\colon
  |L\setminus\{i\}|=n}\widetilde H_*(K'_{L\sqcup\{i'\}}).
\]
The associated spectral sequence has $E^0_n=(F_n/F_{n+1},\overline{\partial'})$, where the differential $\overline{\partial'}$ induced by $\partial'$, decomposes as a direct sum
\[
  \bigoplus_{i\notin L,\,|L|=n} \Bigl( \widetilde{H}_\ast(K'_{L\sqcup\{i'\}}) \to \widetilde{H}_\ast(K'_{L\sqcup \{i,i'\}})\Bigr). 
\]
Each map in the parentheses above is an isomorphism, because $K'_{L\sqcup\{i'\}}\subset K'_{L\sqcup\{i,i'\}}$ is a homotopy equivalence. Hence, the $E_1$-page of the spectral sequence is zero, so $\ker\varphi$ is acyclic. \end{proof}

\begin{proposition}\label{cor_Wasserstein_doubling}
Suppose $\widehat{X}$ is a pseudo-metric space obtained from $X$ by an arbitrary number of doubling operations performed at arbitrary points. Then the persistent double homology modules $\PHHZ(X)$ and $\PHHZ(\widehat X)$ are isomorphic.
\end{proposition}
\begin{proof}
This follows from Proposition \ref{prop_doubling_HHZK} and obvious functorial properties of the doubling construction.
\end{proof}




\subsection{Stability for $\mathcal{PHZ}$}
First, we establish a stability result for the bigraded persistence module $\mathcal{PHZ}(X)$ of a finite pseudo-metric space $(X,d_X)$, see Definition~\ref{bgph}. 

% The aim of this subsection is to 
% give an upper bound for the interleaving distance between $\mathcal{PHZ}_X$ and $\mathcal{PHZ}_Y$. 

\begin{theorem}\label{thm_BB_stable}
For two finite pseudo-metric spaces  $(X,d_X)$ and $(Y, d_Y)$ of the same cardinality, we have
\[
  d_{\IL}(\mathcal{PHZ}(X),\mathcal{PHZ}(Y))\leq
  2d_{GH}^{\prime}(X,Y),
\]
where $d'_{GH}$ is the modified Gromov--Hausdorff distance, see Definition \ref{d'gh}.
\end{theorem}
\begin{proof}
Let $\theta \colon X \to Y$ be the bijection that realizes $d'_{GH}(X,Y)$. Then, for arbitrary subset $J\subset X$,  we have 
\begin{equation}\label{eq_d_prime_subset}
d'_{GH}(J, \theta(J)) \leq d'_{GH}(X,Y).
\end{equation}
Let $\mathcal{PH}(J)$ and $\mathcal{PH}{(\theta(J))}$ be the ordinary persistent homology modules~\eqref{eq_PH} corresponding to the subspaces $J$ and 
$\theta(J)$, respectively. Then, 
\begin{equation}\label{eq_W_infty_d_ptime}
  d_{\IL}\bigl(\mathcal{PH}(J), \mathcal{PH}(\theta(J))\bigl)
    \leq 2d_{GH}(J, \theta(J)) \leq 2d'_{GH}(J, \theta(J)) \leq 2d'_{GH}(X,Y),
\end{equation}
where the first inequality follows from the stability of persistent homology (Theorem~\ref{stabph}),
the second follows by Definition~\ref{d'gh} and the third is~\eqref{eq_d_prime_subset}. Hence, 
\begin{multline*}
  d_\IL(\mathcal{PHZ}(X), \mathcal{PHZ}(Y))= 
  d_\IL\Bigl( \bigoplus_{J\subset X} \mathcal{PH}(J), \bigoplus_{J\subset X}\mathcal{PH}(\theta(J))\Bigr)
  \\
  \leq \max \bigl\{ d_\IL \bigl(\mathcal{PH}(J), \mathcal{PH}(\theta(J))\bigr) \mid J \subset X \bigr\}
  \leq 2d'_{GH}(X,Y),
\end{multline*}
where the first identity follows from~\ref{hoch-pers}, the second to last inequality follows from Proposition~\ref{oplus} and the last inequality follows from~\eqref{eq_W_infty_d_ptime}. 
\end{proof}

When using field coefficients, we also get a stability result for the bigraded barcodes using Theorem~\ref{prop_isometry}:

\begin{corollary}
Suppose $(X,d_X)$ and $(Y,d_Y)$ are two finite pseudo-metric spaces of the same cardinality. Let $\BB(X)$ and $\BB(Y)$ be the bigraded barcodes corresponding to the persistence modules $\mathcal{PHZ}(X)$ and $\mathcal{PHZ}(Y)$. Then, 
\[
  W_\infty(\BB(X), \BB(Y)) \leq 2d'_{GH}(X,Y). 
\]
\end{corollary}

The inequality in Theorem~\ref{thm_BB_stable} does not hold if we replace $d'_{GH}$ by $d_{GH}$
% with $d_{GH}^{\prime}$ replaced by $d_{GH}$ 
on the right hand side. Indeed, let $Y=X\sqcup \{x'\}$ be the doubling of $X$ at a point $x\in X$, see Definition~\ref{def_doubling_metric_sp}. Then $d_{GH}(X,Y)=0$ by Proposition~\ref{prop_d_GH_X_X'=0}. On the other hand, $d_{\IL}(\mathcal{PHZ}(X),\mathcal{PHZ}(Y))\ne0$ even when $X$ consists of two points with nonzero distance. The reason is that at $t=0$ we have $R(X,0)=K$ is two disjoint points, while $R(Y,0)=K'$ is a union of a point and a segment, so $H_*(\mathcal Z_K)\ne H_*(\mathcal Z_{K'})$.



\subsection{Stability for $\mathcal{PHHZ}$} 
The main result of this subsection (Theorem~\ref{thm_BB_HH_stable}) shows that the interleaving  distance between persistence modules $\mathcal{PHHZ}(X)$ and $\mathcal{PHHZ}(Y)$ defined in \eqref{eq_PHHZ} for two finite pseudo-metric spaces $(X,d_X)$ and $(Y,d_Y)$ is bounded above by the usual Gromov--Hausdorff distance between $X$ and $Y$. It also tells  us that the persistent double homology module $\mathcal{PHHZ}(X)$ is more stable than the persistence module $\mathcal{PHZ}(X)$ defined by the ordinary homology of moment-angle complexes. 

\begin{theorem}\label{thm_BB_HH_stable}
Let $X$ and $Y$ be finite pseudo-metric spaces. Then
\[
d_{\IL}(\mathcal{PHHZ}(X), \mathcal{PHHZ}(Y))\leq 2d_{GH}(X,Y). 
\]
\end{theorem}
\begin{proof}
Let $\widehat X$ and $\widehat Y$ be finite pseudo-metric spaces of the same cardinality obtained as iterated doublings of $X$ and $Y$ by the procedure discussed in the proof of Proposition~\ref{prop_dGH_d_prime_GH}. Then, we have 
\begin{multline*}
  d_{\IL}(\mathcal{PHHZ}(X), \mathcal{PHHZ}(Y))
  = d_{\IL}(\mathcal{PHHZ}(\widehat X), \mathcal{PHHZ}(\widehat Y))\\ \leq 
  d_{\IL}(\mathcal{PHZ}(\widehat X), \mathcal{PHZ}(\widehat Y))\leq
  2d'_{GH}(\widehat X,\widehat Y)=2d_{GH}(X,Y).
\end{multline*}
Here the first identity follows from Proposition~\ref{cor_Wasserstein_doubling}. 
The second inequality follows from decomposition~\eqref{phhcomposite} and 
Proposition~\ref{prop_d_IL_composition}. The third inequality is Theorem \ref{thm_BB_stable} and 
the last identity is  Proposition~\ref{prop_dGH_d_prime_GH}. 
\end{proof}

When using field coefficients we also obtain stability for the bigraded barcodes using Theorem~\ref{prop_isometry}:

\begin{corollary}
Let $\BDB(X)$ and  $\BDB(Y)$ be the bigraded barcodes corresponding to the persistence modules $\mathcal{PHHZ}(X)$ and $\mathcal{PHHZ}(Y)$, respectively. Then, we have 
\[
W_\infty(\BDB(X), \BDB(Y)) \leq 2d_{GH}(X,Y). 
\]
\end{corollary}



\bibliographystyle{alpha}

\begin{thebibliography}{AAAA}

\bibitem[AP]{ab-pa19}
Abramyan, Semyon; Panov, Taras. \emph{Higher Whitehead products in moment-angle complexes and substitution of simplicial complexes.}  Tr. Mat. Inst. Steklova~305 (2019), 7--28 (Russian);
Proc. Steklov Inst. Math.~305 (2019), 1--21 (English translation).

\bibitem[BC]{BoCr}
Botnan, Magnus Bakke; Crawley-Boevey, William.
\textit{Decomposition of persistence modules.} 
Proc. Amer. Math. Soc. vol.~148 (2020), no.~11, 4581--4596. 

\bibitem[BP]{BP-book}
Buchstaber, Victor; Panov, Taras. \textit{Toric Topology.} Mathematical Surveys and Monographs, vol.~204, American Mathematical Society, Providence, RI, 2015.


\bibitem[BBC]{BBC}
Bahri, Anthony; Bendersky, Martin; Cohen, Frederick R.
\textit{Polyhedral products and features of their homotopy theory.} 
Handbook of homotopy theory.
CRC Press/Chapman Hall Handb. Math. Ser.
CRC Press, Boca Raton, FL, 2020, 103--144.


\bibitem[BBI]{BBI}
Burago, Dmitri; Burago, Yuri;  Ivanov, Sergei. \textit{A course in metric geometry.}
Graduate Studies in Mathematics, vol.~33, American Mathematical Society, Providence, RI, 2001.

%\bibitem[BM]{BM}
%Bubenik, Peter; Mili\'cevi\'c, Nikola. \textit{Homological algebra for persistence modules.} 
%Found. Comput. Math.~21 (2021), no.~5, 1233--1278. 

\bibitem[BSS]{b-s-s}
Bubenik, Peter; Scott, Jonathan; Stanley, Donald. 
\emph{Exact weights, path metrics, and algebraic Wasserstein distances}. J. Appl. and Comput. Topology (2022).

\bibitem[BS]{BuSc}
Bubenik, Peter; Scott, Jonathan. 
\textit{Categorification of persistent homology}. 
Discrete Comput. Geom.~51 (2014), no.~3, 600--627. 

\bibitem[Ca]{C20}
Carlsson, Gunnar. \emph{Persistent homology and applied homotopy theory}. In \emph{Handbook of Homotopy Theory}. CRC Press/Chapman Hall Handb. Math. Ser., CRC Press, Boca Raton, FL, 2020, pp.~297--330.


\bibitem[CFL+]{CFLMRW}
Chazal, Fr\'ed\'eric;  Fasy, Brittany;  Lecci, Fabrizio;   Michel, Bertrand;   Rinaldo, Alessandro;    Wasserman, Larry.  
\emph{Subsampling methods for persistent homology.}
%In Proceedings of the 32nd International Conference on Machine Learning. Francis Bach and David Blei, editors.
Proceedings of Machine Learning Research~37 (2015), 2143--2151.
%volume 37 of Proceedings of Machine Learning Research, pages 21432151, Lille, France, 0709 July 2015. PMLR. URL:
http://proceedings.mlr.press/v37/chazal15.html.

\bibitem[CZ]{CZ}
Carlsson, Gunnar; Zomorodian, Afra.
\emph{The theory of multidimensional persistence}. Discrete Comput. Geom.~42 (2009), no.~1, 71--93.

\bibitem[CDO]{c-d-o14}
Chazal, Fr\'ed\'eric; de Silva, Vin; Oudot, Steve. \emph{Persistence stability for geometric complexes}. Geom. Dedicata~173 (2014), 193--214.

\bibitem[CC]{Ch}
Chazal, Fr\'ed\'eric; Cohen-Steiner, David; Guiba, Leonidas J.; M\'emoli, Facundo; Oudot, Steve Y. \emph{Gromov--Hausdorff stable signatures for shapes using persistence}. Eurographics Symposium on Geometry Processing, vol.~28 (2009), no.~5, 11~pp.

\bibitem[CS]{CSGO}
Chazal, Fr\'ed\'eric; de Silva, Vin; Glisse, Marc; Oudot, Steve. \emph{The structure and stability of persistence modules}. Springer Briefs in Mathematics. Springer, 2016.

\bibitem[CEH]{c-e-h07}
Cohen-Steiner, David; Edelsbrunner, Herbert; Harer, John. \emph{Stability of persistence diagrams}. Discrete Comput. Geom.~37 (2007), no.~1, 103--120.

\bibitem[Cr]{Cr}
Crawley-Boevey, William. 
\emph{Decomposition of pointwise finite-dimensional persistence modules.}
J. Algebra Appl., vol.~14 (2015), no.~5, 1550066, 8~pp. 


\bibitem[GM]{GM-arXiv}
G\'omez, Mario;  M\'emoli, Facundo.
\emph{Curvature sets over persistence diagrams}. 
arXiv:2103.04470 [math.AT].



\bibitem[Le]{Les}
Lesnick, Michael. \emph{The theory of the interleaving distance on multidimensional persistence modules.} 
Found. Comput. Math., vol.~15 (2015), no.~3, 613--650. 

\bibitem[LPSS]{l-p-s-s}
Limonchenko, Ivan; Panov, Taras; Song, Jongbaek; Stanley, Donald. \emph{Double cohomology of moment-angle complexes}. Adv. Math. 432 (2023), Paper No. 109274, 34 pp.

\bibitem[LFLX]{l-f-l-x23}
Liu, Xiang; Feng, Feng; L\"u, Zhi; Xia, Kelin. \emph{Persistent Tor-algebra for protein-protein interaction analysis}. Briefings in Bioinformatics~24, issue~2 (2023); bbad046.
http://doi.org/10.1093/bib/bbad046.

\bibitem[LX]{li-xi22}
Liu, Xiang; Xia, Kelin.
\emph{Persistent Tor-algebra based stacking ensemble learning (PTA-SEL) for protein-protein binding affinity prediction}.
Proceedings of Machine Learning Research~196 (2022), 237--247.
http://proceedings.mlr.press/v196/liu22a.html.
%Proceedings of Topological, Algebraic, and Geometric Learning Workshops~2022, PMLR~196 (2022).


\bibitem[SV]{SV-arXiv}
Valenzuela Ruiz, Carlos Gabriel; Stanley, Donald.
\emph{Double homology and wedge-decomposable simplicial complexes}.
arXiv:2308.15702 [math.AT].

\bibitem[SWB]{SWB22}
Solomon, Elchanan; Wagner, Alexander; Bendich, Paul.
\emph{From geometry to topology: inverse theorems for distributed persistence}. In 38th International Symposium on Computational Geometry (SoCG 2022). Leibniz International Proceedings in Informatics (LIPIcs)~224 (2022), pp.~61:1-61:16.
%Schloss Dagstuhl. Leibniz-Zentrum f\"ur Informatik, Wadern,
http://doi.org/10.4230/LIPIcs.SoCG.2022.61.


\bibitem[ZC]{CZ05}
Zomorodian, Afra; Carlsson, Gunnar. 
\emph{Computing persistent homology}. 
Discrete Comput. Geom.~33 (2005), no.~2, 249--274.

\end{thebibliography}

\end{document}
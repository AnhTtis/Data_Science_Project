% !TEX root = main.tex
% Input and language
\usepackage[utf8]{inputenc}

% Math
%\usepackage{amsmath}
\ifthenelse{\boolean{acmartstyle}}{}{
\usepackage{amssymb}	
}

\usepackage{stmaryrd}
\usepackage{bussproofs}
\usepackage{mathtools}
%\usepackage{fontawesome}
\usepackage{bbold}
\usepackage{qtree}

% Formatting
\usepackage{ifthen}
\usepackage{xspace}
\usepackage{fancybox}
\usepackage{hhline}

\usepackage{soul}
 
%\usepackage{ulem}
% \input{\macrospath/ben-macros-diagrams.tex}
\usepackage{xcolor}
\usepackage{multirow}
\usepackage{microtype}

\usepackage{hyperref}
%\usepackage[hidelinks,bookmarks,bookmarksopen,bookmarksdepth=2]{hyperref}

\hypersetup{colorlinks=true}
\hypersetup{hidelinks}

\usepackage[colorinlistoftodos]{todonotes}
%\setuptodonotes{color=blue!10}
\usepackage{ifthen}
\usepackage{proof}
\usepackage{pifont}
\usepackage{appendix}
\capturecounter{theorem}
% \capturecounter{definition}



%%%%%%%
%% LATEX SHORTCUTS
%%%%%%%
\newcommand{\sem}[1]{\interp{#1}}
\newcommand{\ignore}[1]{}
 \newcommand{\sep}{\hspace*{0.5cm}}
% \newcommand{\ms}{\medskip}
\newcommand{\ms}{\smallskip} %Giulio
\newcommand{\mathintitle}[2]{\texorpdfstring{#1}{#2}}
\newcommand{\colspace}{@{\hspace{.5cm}}}
\newcommand{\myinput}[1]{\ifthenelse{\boolean{withimages}}{\input{#1}}{}}
\newcommand{\spc}{@{\hspace{.5cm}}}

% for references
\newcommand{\reflemma}[1]{Lemma~\ref{l:#1}}
\newcommand{\reflemmap}[2]{Lemma~\ref{l:#1}.\ref{p:#1-#2}}
\newcommand{\reflemmapp}[3]{Lemma~\ref{l:#1}.\ref{p:#1-#2}.\ref{p:#1-#2-#3}}
\newcommand{\reflemmappp}[4]{Lemma~\ref{l:#1}.\ref{p:#1-#2}.\ref{p:#1-#2-#3}.\ref{p:#1-#2-#3-#4}}
\newcommand{\reflemmas}[2]{Lemmas~\ref{l:#1} and \ref{l:#2}} %Giulio
\newcommand{\reflemmasp}[4]{Lemmas~\ref{l:#1}.\ref{p:#1-#2} and \ref{l:#3}.\ref{p:#3-#4}}
\newcommand{\reflemmasps}[3]{Lemmas~\ref{l:#1}.\ref{p:#1-#2}-\ref{p:#1-#3}} %Giulio
\newcommand{\reflemmaeq}[1]{{L.\ref{l:#1}}}
\newcommand{\reflemmaeqp}[2]{{L.\ref{l:#1}.\ref{p:#1-#2}}}
\newcommand{\reflemmapappendix}[2]{Lemma~\ref{lappendix:#1}.\ref{pappendix:#1-#2}} %Giulio
\newcommand{\reflemmaspsappendix}[3]{Lemmas~\ref{lappendix:#1}.\ref{pappendix:#1-#2}-\ref{pappendix:#1-#3}} %Giulio
\newcommand{\refpoint}[1]{Point~\ref{p:#1}}
\newcommand{\refpoints}[2]{Points~\ref{p:#1}-\ref{p:#2}}
\newcommand{\refpointappendix}[1]{Point~\ref{pappendix:#1}}
\newcommand{\refeqpoint}[1]{Point~\eqref{p:#1}} %Giulio
\newcommand{\refpointeq}[1]{P.\ref{p:#1}}
\newcommand{\refpointp}[2]{Point~\ref{p:#1}.\ref{p:#1-#2}}
\newcommand{\refpointmute}[1]{\ref{p:#1}}
\newcommand{\refcorollary}[1]{Corollary~\ref{c:#1}}
\newcommand{\refcorollaryp}[2]{Corollary~\ref{c:#1}.\ref{p:#1-#2}}
\newcommand{\refth}[1]{Theorem~\ref{th:#1}}
\newcommand{\refthp}[2]{Theorem~\ref{th:#1}.\ref{p:#1-#2}}
\newcommand{\refthm}[1]{Thm.~\ref{thm:#1}}
\newcommand{\refthms}[2]{Thm.~\ref{thm:#1} and \ref{thm:#2}} %Giulio
\newcommand{\refthmp}[2]{Thm.~\ref{thm:#1}.\ref{p:#1-#2}}
\newcommand{\refthmsps}[3]{Thm.~\ref{thm:#1}.\ref{p:#1-#2}-\ref{p:#1-#3}}
\newcommand{\reftm}[1]{Theorem~\ref{tm:#1}}
\newcommand{\reftmp}[2]{Theorem~\ref{tm:#1}.\ref{p:#1-#2}}
\newcommand{\refprop}[1]{Prop.~\ref{prop:#1}}
\newcommand{\refprops}[2]{Prop.~\ref{prop:#1}-\ref{prop:#2}} %Giulio
\newcommand{\refpropp}[2]{Prop.~\ref{prop:#1}.\ref{p:#1-#2}} %Giulio
\newcommand{\refpropsp}[4]{Propositions~\ref{prop:#1}.\ref{p:#1-#2} and \ref{prop:#3}.\ref{p:#3-#4}} %Giulio
\newcommand{\refpropsps}[3]{Propositions~\ref{prop:#1}.\ref{p:#1-#2}-\ref{p:#1-#3}} %Giulio
\newcommand{\refpropps}[3]{Prop.~\ref{prop:#1}.\ref{p:#1-#2}-\ref{p:#1-#3}} %Giulio
\newcommand{\refproppp}[3]{Prop.~\ref{prop:#1}.\ref{p:#1-#2}.\ref{p:#1-#2-#3}} %Giulio
\newcommand{\refproppappendix}[2]{Prop.~\ref{propappendix:#1}.\ref{pappendix:#1-#2}} %Giulio
\newcommand{\refsect}[1]{Sect.~\ref{sect:#1}}
\newcommand{\refsects}[2]{Sect.~\ref{sect:#1}-\ref{sect:#2}}
\newcommand{\refsubsect}[1]{Subsect.~\ref{subsect:#1}}
\newcommand{\refssect}[1]{Subsect.~\ref{ssect:#1}}
\newcommand{\refapp}[1]{Appendix~\ref{app:#1} (p.~\pageref{app:#1})}
\newcommand{\reftab}[1]{Table~\ref{tab:#1}}
\newcommand{\reftabs}[2]{Tables~\ref{tab:#1} and \ref{tab:#2}} %Giulio
\renewcommand{\refeq}[1]{(\ref{eq:#1})} %renewcommand to avoid conflict with package mathtools
\newcommand{\reffig}[1]{Fig.~\ref{fig:#1}}
\newcommand{\reffigs}[2]{Fig.~\ref{fig:#1} and \ref{fig:#2}} %Giulio
\newcommand{\refcoro}[1]{Cor.~\ref{coro:#1}}
\newcommand{\refcor}[1]{Cor.\,\ref{coro:#1}}
\newcommand{\refdef}[1]{Definition~\ref{def:#1}}
\newcommand{\refdefp}[2]{Definition~\ref{def:#1}.\ref{p:#1-#2}}
\newcommand{\refrem}[1]{Remark~\ref{rem:#1}}
\newcommand{\refremp}[2]{Remark~\ref{rem:#1}.\ref{p:#1-#2}} %Giulio
%\newcommand{\refrmk}[1]{Remark~\ref{rmk:#1}} %Giulio
\newcommand{\refrmk}[1]{Rmk.~\ref{rmk:#1}} %Giulio
\newcommand{\refrmkp}[2]{Remark~\ref{rmk:#1}.\ref{p:#1-#2}} %Giulio
\newcommand{\refrmksps}[3]{Remarks~\ref{rmk:#1}.\ref{p:#1-#2}-\ref{p:#1-#3}} %Giulio
\newcommand{\refex}[1]{Ex.~\ref{ex:#1}}

% macro for cases in proofs
% \renewcommand{\case}[1]{{\bf Case #1.}} %to comment in sigplanconf.cls
\newcommand{\casealt}[1]{{\bf #1.}}
\newcommand{\caselight}[1]{\textit{#1}}

%%%%%%%
%% ABBREVIATIONS
%%%%%%%
\newcommand{\ie}{\textit{i.e.}\xspace}
\newcommand{\eg}{\textit{e.g.}\xspace}
\newcommand{\ih}{\textit{i.h.}\xspace}
\newcommand{\lat}{\mbox{$\lambda$-term}}

\newcommand{\linlogic}{linear logic\xspace}
\newcommand{\Linlogic}{Linear logic\xspace}
\newcommand{\pn}{proof net\xspace}
\newcommand{\Pn}{Proof net\xspace}
\newcommand{\pns}{proof nets\xspace}
\newcommand{\Pns}{Proof nets\xspace}

\newcommand{\wlhr}{WLHR}

\newcommand{\activep}{substitutive\xspace}
\newcommand{\Activep}{Substitutive\xspace}
\newcommand{\inactivep}{applicative\xspace}
\newcommand{\Inactivep}{Applicative\xspace}

\newcommand{\evaluable}{evaluable\xspace}
\newcommand{\Evaluable}{Evaluable\xspace}

%%%%%%%
%% TEXT FORMATTING
%%%%%%%
\newcommand{\deff}[1]{\textbf{#1}}
\newcommand{\boldemph}[1]{\textbf{#1}}
\newcommand{\scol}{\mathbin;}

\newcommand{\underlinecolor}[2]{{\color{#1}\underline{\black{#2}}\color{black}}}
\newcommand{\overlinecolor}[2]{{\color{#1}\overline{\black{#2}}\color{black}}}

\newcommand{\undlinered}[1]{\underlinecolor{red}{#1}}
\newcommand{\ovlinered}[1]{\overlinecolor{red}{#1}}

\newcommand{\RED}[1]{{\color{red} {#1}}}
\newcommand{\blue}[1]{{\color{blue} {#1}}}
\newcommand{\pink}[1]{{\color{magenta} {#1}}}
\newcommand{\brown}[1]{{\color{brown} {#1}}}
\newcommand{\green}[1]{{\color{green} {#1}}}
\newcommand{\darkgreen}[1]{{\color{green!50!black} {#1}}}
\newcommand{\black}[1]{{\color{black} {#1}}}
\newcommand{\purple}[1]{{\color{purple} {#1}}}
\newcommand{\orange}[1]{{\color{orange} {#1}}}
\newcommand{\gray}[1]{{\color{gray} {#1}}}

\newcommand{\ben}[1]{{\RED{#1}}}
%\newcommand{\ben}[1]{{#1}}
\newcommand{\bben}[1]{\sout{{\ben{#1}}}}
\newcommand{\cben}[2]{\RED{#2}}
%\renewcommand{\cben}[2]{{#2}}
\newcommand{\pablo}[1]{{\darkgreen{#1}}}
%\renewcommand{\pablo}[1]{#1}
\newcommand{\cpablo}[2]{{\darkgreen{#2}}}
%\renewcommand{\cpablo}[2]{#2}
\newcommand{\damiano}[1]{{\blue{#1}}}
\newcommand{\cdamiano}[2]{{\blue{#2}}}
\newcommand{\claudio}[1]{{\purple{#1}}}
\newcommand{\cclaudio}[2]{{\purple{#2}}}
%\newcommand{\giulio}[1]{{\brown{#1}}}
%\newcommand{\giulio}[1]{\textcolor{blue}{#1}}
\newcommand{\giulio}[1]{#1}
%\newcommand{\giulio}{}

\newcommand{\adr}[1]{{\blue{#1}}} %Adrienne
\newcommand{\cadr}[2]{{\blue{#2}}} %Adrienne
\newcommand{\cf}[1]{{\pink{#1}}} %Claudia

%%%%%%%
%% GENERIC MATH
%%%%%%%
% \newcommand{\defeq}{\mathrel{:=}}
\newcommand{\defeq}{\coloneqq} %Giulio
\newcommand{\eqdef}{\eqqcolon} %Giulio
% \newcommand{\grameq}{\mathrel{::=}}
\newcommand{\grameq}{\Coloneqq} %Giulio
\newcommand{\set}[1]{\{#1\}}
\newcommand{\disunion}{\uplus}
\newcommand{\card}[1]{\# #1}
\newcommand{\nat}{\mathbb{N}}
\newcommand{\size}[1]{|#1|}
% c'era una definizione precedente di sizeap (ora commentata) che pero' credo fosse inutilizzata
\newcommand{\sizeap}[1]{\size{#1}_@}
\renewcommand{\sizeap}[1]{\size{#1}}
\newcommand{\dummyarg}{\cdot}
\newcommand{\LeftRightarrow}{\Lleftarrow\!\!\!\!\Rrightarrow}

%%%%%%%
%% SYMBOLIZED LETTERS
%%%%%%%
\newcommand{\db}{{\tt dB}}
\newcommand{\dbv}{{\tt dBv}}
\newcommand{\lssym}{{\tt ls}}
\newcommand{\ls}{{\tt ls}}
\newcommand{\vartt}{{\tt var}}
\newcommand{\gc}{{\tt gc}}
\newcommand{\Bsym}{{\tt B}}
\newcommand{\lsvsym}{{\tt lsv}}
\newcommand{\vsym}{\mathsf{v}}
\newcommand{\tX}{\mathtt X}
\newcommand{\amsym}{{\tt am}}
\newcommand{\lamsym}{\l}
\newcommand{\apsym}{@}
\newcommand{\updsym}{u}
%\newcommand{\varsym}{v}
\newcommand{\admsym}{{\mathtt c}}
\newcommand{\noadmsym}{p}
% \newcommand{\mulsym}{m}
\newcommand{\mulsym}{\msym} %Giulio
\newcommand{\mulsymone}{\mulsym_1} %Giulio
\newcommand{\mulsymtwo}{\mulsym_2} %Giulio
%\newcommand{\isym}{{\mathtt i}}
\newcommand{\bsym}{{\mathtt b}}

%%%%%%%
%% LINEAR SUBSTITUTION CALCULUS
%%%%%%%
\newcommand{\lsc}{LSC}
\newcommand{\wlsc}{WLSC}
\newcommand{\wlscname}{{\tt Name}}
\newcommand{\wlscvaluelr}{{\tt Value}^{\tt LR}}
\newcommand{\wlscvaluerl}{{\tt Value}^{\tt RL}}
\newcommand{\wlscneed}{{\tt Need}}

\newcommand{\llsub}{\l_{lsub}}
\renewcommand{\l}{\lambda}
\newcommand{\isub}[2]{\{#1/#2\}}
\renewcommand{\isub}[2]{\{#1{\shortleftarrow}#2\}}
\newcommand{\esub}[2]{[#1/#2]}
\renewcommand{\esub}[2]{[#1{\shortleftarrow}#2]}
\newcommand{\fv}[1]{{\tt fv}(#1)}
\newcommand{\bv}[1]{{\tt bv}(#1)}
\newcommand{\varsplit}[3]{#1_{[#3]_{#2}}}

%%%%%%%
%% NORMAL FORMS
%%%%%%%

% \newcommand{\mnf}[1]{{\tt m}(#1)}
\newcommand{\mnf}[1]{{\msym}(#1)} %Giulio
\newcommand{\enf}[1]{{\esym}(#1)} %Giulio
\newcommand{\sigmnf}[1]{{\sigm}(#1)} %Giulio
\newcommand{\nf}{\mathsf{nf}} %Giulio
\newcommand{\nfwh}{\mathsf{nf}_{wh}} %Giulio
\newcommand{\nfo}[1]{\nf_\osym(#1)} %Giulio
\newcommand{\shufnf}{w} %Giulio

%%%%%%%
%% REWRITING RELATIONS
%%%%%%%
% basic macros
\newcommand{\rootRew}[1]{\mapsto_{#1}}
\newcommand{\Rew}[1]{\rightarrow_{#1}}
\newcommand{\Rewn}[1]{\rightarrow_{#1}^*}
\newcommand{\lRew}[1]{\; \mbox{}_{#1}{\leftarrow}\ }
\newcommand{\lRewn}[1]{\; \mbox{}^{*}_{#1}{\leftarrow}\ }
\newcommand{\lRewp}[1]{\; \mbox{}^{+}_{#1}{\leftarrow}\ }
\newcommand{\betalazy}{{\beta}} %Giulio


% call-by-name root rules
\newcommand{\rtodb}{\rootRew{\db}}
\newcommand{\rtols}{\rootRew{\lssym}}
\newcommand{\rtolsc}[1]{\stackrel{#1}{\mapsto}_\lssym}
% \newcommand{\rtom}{\rootRew{\msym}}
% \newcommand{\rtoe}{\rootRew{\esym}}
% \newcommand{\rtoei}{\rootRew{\eisym}}
\newcommand{\mult}{\mathsf{m}} %Giulio
\newcommand{\expo}{\mathsf{e}} %Giulio
\newcommand{\expoabs}{\expo_{\abssym}} %Giulio
\newcommand{\expovar}{\expo_{\varsym}} %Giulio
\newcommand{\rtom}{\rootRew{\mult}} %Giulio
\newcommand{\rtoe}{\rootRew{\expo}} %Giulio
\newcommand{\rtoeabs}{\rootRew{\expoabs}} 
\newcommand{\rtoevar}{\rootRew{\expovar}} 
\newcommand{\rtoei}{\rootRew{\expo\isym}} %Giulio
\newcommand{\rtolazy}{\rootRew{\betalazy}} %Giulio


% call-by-value root rules
% \newcommand{\rtobv}{\rootRew{\beta\vsym}}
% \newcommand{\rtodbv}{\rootRew{\db\vsym}}
\newcommand{\rtobv}{\rootRew{\betav}} %Giulio
\newcommand{\rtobabs}{\rootRew{\betaabs}} 
\newcommand{\rtobvar}{\rootRew{\betavar}} 
\newcommand{\rtosigma}{\rootRew{\sigma}} %Giulio
\newcommand{\rtodbv}{\rootRew{\db_v}} %Giulio
\newcommand{\rtolsv}{\rootRew{\lssym\vsym}}
\newcommand{\rtolsvp}{\rootRew{\lssym\vsym'}}
\newcommand{\rtolsvc}[1]{\stackrel{#1}{\mapsto}_{\lssym\vsym}}

\newcommand{\rtoin}{\rootRew{\inert}}

\newcommand{\slsym}{\sigma_1}
\newcommand{\srsym}{\sigma_3}
\newcommand{\srsymext}{\sigma_3'}
\newcommand{\scomsym}{\sigma_{\mathtt{com}}}

\newcommand{\rtosl}{\rootRew{\slsym}}
\newcommand{\rtosr}{\rootRew{\srsym}}
\newcommand{\rtosrext}{\rootRew{\srsymext}}
\newcommand{\rtoscom}{\rootRew{\scomsym}}

% call-by-name (weak linear head reduction)
\newcommand{\tob}{\Rew{\beta}}
\newcommand{\rtowhls}{\rtols} % this one is redundant but used in a proof
\newcommand{\towhl}{\stackrel{\mathtt{wh}}{\multimap}}
\newcommand{\towhldb}{\stackrel{\mathtt{wh}}{\multimap}_\db}
\newcommand{\towhlls}{\stackrel{\mathtt{wh}}{\multimap}_\lssym}
\renewcommand{\towhl}{\togen}
\renewcommand{\towhldb}{\togenm}
\renewcommand{\towhlls}{\togene}
\newcommand{\towhls}[1][\ast]{\overset{\mathtt{wh}}{\multimap}\!\!{}^{#1}}
\newcommand{\tolazy}{\Rew{\betalazy}}
\newcommand{\tonof}{\Rew{\betanof}}

% call-by-value (super-strategy)
\newcommand{\towhlv}{\multimap_\vsym}
% \newcommand{\tobv}{\Rew{\beta\vsym}}
% \newcommand{\tobvm}{\Rew{\beta\msym}}
\newcommand{\betav}{{\beta_v}} %Giulio
\newcommand{\abssym}{\lambda} 
\newcommand{\varsym}{y} 
\newcommand{\betaabs}{{\beta_{\!\abssym}}} 
\newcommand{\betavar}{{\beta_{\varsym}}}
\newcommand{\rbetav}{{\rsym\betav}} %Giulio
%\newcommand{\betavm}{{\beta_v\msym}} %Giulio
\newcommand{\betavm}{{\bilancia\beta_v}} %Giulio
\newcommand{\betashuf}{\betavm} %Giulio
\newcommand{\betavc}{{\beta_v\csym}} %Giulio
\newcommand{\tobv}{\Rew{\betav}} %Giulio
\newcommand{\tobabs}{\Rew{\betaabs}} 
\newcommand{\tobvar}{\Rew{\betavar}} 
\newcommand{\torbv}{\Rew{\rbetav}} %Giulio
\newcommand{\tobvm}{\Rew{\betavm}} %Giulio
\newcommand{\tobshuf}{\tobvm} %Giulio
\newcommand{\tobvc}{\Rew{\betavc}} %Giulio
\newcommand{\betain}{\beta_{\isym}} %Giulio
% \newcommand{\inert}{\isym} 
\newcommand{\inert}{\betain} %Giulio
\newcommand{\rinert}{{\rsym\betain}} %Giulio
\newcommand{\toin}{\Rew{\inert}}
\newcommand{\torin}{\Rew{\rinert}}
\newcommand{\toinm}{\Rew{\isym\msym}}
\newcommand{\toinc}{\Rew{\betain\csym}} %Giulio

\newcommand{\tosig}{\Rew{\sigma}} %Giulio$
%\newcommand{\sigm}{{\sigma\msym}}
\newcommand{\sigm}{\bilancia{\sigma}}
\newcommand{\sigmext}{\bilancia{\sigma'}}
% \newcommand{\sigmeq}{{\sigm_{\sim}\!}} %Giulio
\newcommand{\sigmeq}{{\sim_{\sigm}\!}} %Giulio
\newcommand{\sigmeqext}{{\sigmext_{\sim}\!}} %Giulio
\newcommand{\tosigm}{\Rew{\sigm}} %Giulio
\newcommand{\tosigmext}{\Rew{\sigmext}} %Giulio
\newcommand{\tosigmeq}{\Rew{\sigmeq}} %Giulio
\newcommand{\tosigmeqext}{\Rew{\sigmeqext}} %Giulio

\newcommand{\sigl}{\bilancia{\sigma}_1}
\newcommand{\sigr}{\bilancia{\sigma}_3}
\newcommand{\tosl}{\Rew{\sigl}}
\newcommand{\tosr}{\Rew{\sigr}}
\newcommand{\tosrext}{\Rew{\srsymext}}
% \newcommand{\tosl}{\Rew{\sigma_1\msym}} %Giulio
% \newcommand{\tosr}{\Rew{\sigma_3\msym}} %Giulio

% \newcommand{\toperm}{\Rew{\beta\msym\sigma}}
\newcommand{\toperm}{\Rew{\vmsym}} %Giulio
\newcommand{\toshuf}{\tovm} %Giulio
\newcommand{\tovm}{\Rew{\vmsym}} %Giulio
\newcommand{\tovmext}{\Rew{\vmext}} %Giulio
\newcommand{\tovmeq}{\Rew{\vmeq}} %Giulio
\newcommand{\tovmeqext}{\Rew{\vmeqext}} %Giulio

% non-strict call-by-value
\newcommand{\towhlcek}{\stackrel{\mathtt{ns}}{\multimap}_\vsym}
\newcommand{\towhlcekdb}{\stackrel{\mathtt{ns}}{\multimap}_\dbv}
\newcommand{\towhlcekls}{\stackrel{\mathtt{ns}}{\multimap}_\lsvsym}
\renewcommand{\towhlcek}{\togen}
\renewcommand{\towhlcekdb}{\togenm}
\renewcommand{\towhlcekls}{\togene}


% strict call-by-value
\newcommand{\towhllam}{\stackrel{\mathtt{s}}{\multimap}_\vsym}
\newcommand{\towhllamdb}{\stackrel{\mathtt{s}}{\multimap}_\dbv}
\newcommand{\towhllamls}{\stackrel{\mathtt{s}}{\multimap}_\lsvsym}
\renewcommand{\towhllam}{\togen}
\renewcommand{\towhllamdb}{\togenm}
\renewcommand{\towhllamls}{\togene}


% call-by-need
\newcommand{\towhlsam}{\stackrel{\mathtt{nd}}{\multimap}}
\newcommand{\towhlsamdb}{\stackrel{\mathtt{nd}}{\multimap}_\db}
\newcommand{\towhlsamls}{\stackrel{\mathtt{nd}}{\multimap}_\lsvsym}
\renewcommand{\towhlsam}{\togen}
\renewcommand{\towhlsamdb}{\togenm}
\renewcommand{\towhlsamls}{\togene}


% reduction rules for oriented structural equivalence 
\newcommand{\tostructrev}{\Lleftarrow}
\newcommand{\tostructsym}{\LeftRightarrow}
\newcommand{\tostructrevgc}{\tostructrev_{\structrulegc}}
\newcommand{\tostructrevdup}{\tostructrev_{\structruledup}}
\newcommand{\tostructrevap}{\tostructrev_{\structruleap}}
\newcommand{\tostructreves}{\tostructrev_{\structrulees}}
\newcommand{\tostructrevcom}{\tostructrev_{\structrulecom}}

% generic linear rewriting
\newcommand{\esym}{{\mathtt e}}
\newcommand{\isym}{i}
\newcommand{\rsym}{{\mathtt r}}
\newcommand{\zsym}{{\mathtt z}}
\newcommand{\eisym}{\esym\isym}
\newcommand{\msym}{{\mathtt m}}
\newcommand{\fsym}{f}
\newcommand{\expsym}{{\mathtt{exp}}}
\newcommand{\subsym}{{\mathsf{sub}}}
\newcommand{\psym}{{\mathtt p}}
\newcommand{\ssym}{{\mathtt s}}
\newcommand{\fmsym}{{\fsym\msym}} %Giulio
\newcommand{\fmmsym}{{\fsym\msym\msym}} %Giulio
\newcommand{\fcsym}{{\fsym\csym}} %Giulio
\newcommand{\wsym}{{\mathtt w}} %Giulio
\newcommand{\wmsym}{{\wsym\msym}} %Giulio
% \newcommand{\vsym}{{\mathtt w}} %Giulio
%\newcommand{\bilancia}{\msym}
%\newcommand{\bilanciasym}{\faBalanceScale}
\newcommand{\bilanciasym}{\flat}
% \newcommand{\bilancia}{\mbox{\tiny \bilanciasym}}
\newcommand{\bilancia}[1]{{#1}^{\bilanciasym\!}}
%\newcommand{\vmsym}{{\vsym\msym}} %Giulio
% \newcommand{\vmsym}{\bilancia{\vsym}} 
% \newcommand{\vmext}{\bilancia{\vsym'}} 
\newcommand{\vmsym}{\mathsf{shuf}} 
\newcommand{\shuf}{\vmsym} %Giulio
\newcommand{\vmext}{\mathtt{sh}'} 
\newcommand{\shufext}{\vmsym'} 
\newcommand{\vmeq}{{\vmsym_{\sim}\!}} %Giulio
\newcommand{\vmeqext}{{\vmext_{\sim}\!}} %Giulio
% \newcommand{\shufeq}{\vmeq} %Giulio
\newcommand{\shufeq}{\shufextth} %Giulio
\newcommand{\shufeqprime}{\sim_\shuf} %Giulio
\newcommand{\shufeqext}{\shufeqext} %Giulio
\newcommand{\tsym}{{\mathtt t}} %Giulio
\newcommand{\tmsym}{{\tsym\msym}} %Giulio
\newcommand{\rtogenm}{\mapsto_\msym}
\newcommand{\rtogene}{\mapsto_\esym}
\newcommand{\togen}{\multimap}
\newcommand{\togenm}{\multimap_\msym}
\newcommand{\togene}{\multimap_\esym}
\newcommand{\togenep}{\multimap_{\esym'}}
\newcommand{\togenx}{\multimap_{\mathtt x}}

\newcommand{\togenpar}[1]{\stackrel{#1}{\multimap}}

% \newcommand{\tom}{\Rew{\msym}}
% \newcommand{\toe}{\Rew{\esym}}
% \newcommand{\toei}{\Rew{\esym\isym}}
\newcommand{\tom}{\Rew{\mult}}
\newcommand{\toe}{\Rew{\expo}}
\newcommand{\toeabs}{\Rew{\expoabs}}
\newcommand{\toevar}{\Rew{\expovar}}

\newcommand{\toei}{\Rew{\expo\isym}}

\newcommand{\torm}{\Rew{\rsym\mult}}
\newcommand{\tore}{\Rew{\rsym\expo}}

% miscellaneous rewriting relations
\newcommand{\toam}{\Rew{\amsym}}

%%%%%%%
%% EQUIVALENCES
%%%%%%%
\newcommand{\alphaequiv}{=_\alpha}
\newcommand{\eqstruct}{\equiv}
\newcommand{\tostruct}{\eqstruct}
\newcommand{\tostructgc}{\tostruct_{gc}}
\newcommand{\tostructgcv}{\tostruct_{gcv}}
\newcommand{\tostructdup}{\tostruct_{dup}}
\newcommand{\tostructlam}{\tostruct_{\lambda}}
\newcommand{\tostructap}{\tostruct_{@}}
\newcommand{\aplsym}{@\textup{l}}
\newcommand{\aprsym}{@\textup{r}}
\newcommand{\essym}{[\cdot]}
\newcommand{\comsym}{\textup{com}}
\newcommand{\tostructapl}{\tostruct_{\aplsym}}
\newcommand{\tostructapr}{\tostruct_{\aprsym}}
\newcommand{\tostructes}{\tostruct_{\essym}}
\newcommand{\tostructcom}{\tostruct_{\comsym}}

\newcommand{\tostrapl}{\Rew{\aplsym}}
\newcommand{\tostrapr}{\Rew{\aprsym}}
\newcommand{\tostres}{\Rew{\essym}}


\newcommand{\equnstruct}{\overset\circ\tostruct}

\newcommand{\eqmstruct}{\overset\bullet\tostruct}
\newcommand{\eqmstructapl}{\eqmstruct_{\aplsym}}
\newcommand{\eqmstructapr}{\eqmstruct_{\aprsym}}
\newcommand{\eqmstructes}{\eqmstruct_{\essym}}
\newcommand{\eqmstructcom}{\eqmstruct_{\comsym}}

\newcommand{\eqstructapl}{\tostructapl}
\newcommand{\eqstructapr}{\tostructapr}
\newcommand{\eqstructes}{\tostructes}
\newcommand{\eqstructcom}{\tostructcom}


\newcommand{\structrulegc}{gc}
\newcommand{\structrulegcv}{gcv}
\newcommand{\structruledup}{dup}
\newcommand{\structruleap}{@}
\newcommand{\structruleapl}{@l}
\newcommand{\structruleapr}{@r}
\newcommand{\structrulees}{[\cdot]}
\newcommand{\structrulecom}{com}

\newcommand{\eqmam}{\equiv_{\tiny \mbox{MAM}}}
\newcommand{\eqmamsym}{\LeftRightarrow}
\newcommand{\eqcekd}{\equiv}
\newcommand{\eqcekdsym}{\LeftRightarrow}
\newcommand{\eqcekdapl}{\eqcekd_{\structruleapl}}
\newcommand{\eqcekdapr}{\eqcekd_{\structruleapr}}
\newcommand{\eqcekdcom}{\eqcekd_{\structrulecom}}
\newcommand{\eqcekdes}{\eqcekd_{\structrulees}}

\newcommand{\seqbar}{\bumpeq}
\newcommand{\seqbarp}{\seqbar'} %Giulio
\newcommand{\seqbarmut}{\seqbar_{\mut\mut}} %Giulio 

%%%%%%%
%% TERMS AND VARIABLES
%%%%%%%
% terms
\newcommand{\tm}{t}
\newcommand{\tmtwo}{u}
\newcommand{\tmthree}{s}
\newcommand{\tmfour}{r}
\newcommand{\tmfive}{q}
\newcommand{\tmsix}{p}

% co-terms
\newcommand{\cotm}{e}
\newcommand{\cotmtwo}{\cotm'}
\newcommand{\cotmthree}{\cotm''}
\newcommand{\cotmfour}{\cotm'''}

% terms for relations %%Adrienne
\newcommand{\tmrone}{a}
\newcommand{\tmrtwo}{b}

\newcommand{\tmronep}{\tmrone'}
\newcommand{\tmrtwop}{\tmrtwo'}

\newcommand{\tmronepp}{\tmronep'}
\newcommand{\tmrtwopp}{\tmrtwop'}

\newcommand{\tmrthree}{p}
\newcommand{\tmrfour}{q}
\newcommand{\tmrthreep}{\tmrthree'}
\newcommand{\tmrfourp}{\tmrfour'}

% terms with pedices
\newcommand{\tmfirst}{\tm_1}
\newcommand{\tmsec}{\tm_2}
\newcommand{\tmthird}{\tm_3}
\newcommand{\tmfourth}{\tm_4}
\newcommand{\tmfifth}{\tm_5}

\newcommand{\tmtwofirst}{\tmtwo_1}
\newcommand{\tmtwosec}{\tmtwo_2}
\newcommand{\tmtwothird}{\tmtwo_3}
\newcommand{\tmtwofourth}{\tmtwo_4}
\newcommand{\tmtwofifth}{\tmtwo_5}

\newcommand{\tmthreefirst}{\tmthree_1}
\newcommand{\tmthreesec}{\tmthree_2}
\newcommand{\tmthreethird}{\tmthree_3}
\newcommand{\tmthreefourth}{\tmthree_4}
\newcommand{\tmthreefifth}{\tmthree_5}

\newcommand{\tmfourfirst}{\tmfour_1}
\newcommand{\tmfoursec}{\tmfour_2}
\newcommand{\tmfourthird}{\tmfour_3}
\newcommand{\tmfourfourth}{\tmfour_4}
\newcommand{\tmfourfifth}{\tmfour_5}

\newcommand{\tmfivefirst}{\tmfive_1}
\newcommand{\tmfivesec}{\tmfive_2}
\newcommand{\tmfivethird}{\tmfive_3}
\newcommand{\tmfivefourth}{\tmfive_4}
\newcommand{\tmfivefifth}{\tmfive_5}

\newcommand{\tmsixfirst}{\tmsix_1}
\newcommand{\tmsixsec}{\tmsix_2}
\newcommand{\tmsixthird}{\tmsix_3}
\newcommand{\tmsixfourth}{\tmsix_4}
\newcommand{\tmsixfifth}{\tmsix_5}


% terms with prime
\newcommand{\tmp}{\tm'}
\newcommand{\tmtwop}{\tmtwo'}
\newcommand{\tmthreep}{\tmthree'}
\newcommand{\tmfourp}{\tmfour'}
\newcommand{\tmfivep}{\tmfive'}

%terms with prime and pedices - Adrienne
\newcommand{\tmpfirst}{\tmp_1}
\newcommand{\tmpsec}{\tmp_2}
\newcommand{\tmpthird}{\tmp_3}
\newcommand{\tmpfourth}{\tmp_4}
\newcommand{\tmpfifth}{\tmp_5}

% terms with double prime
\newcommand{\tmpp}{\tm''}
\newcommand{\tmtwopp}{\tmtwo''}
\newcommand{\tmthreepp}{\tmthree''}

\newcommand{\tmal}{\tilde{\tm}}
\newcommand{\tmtwoal}{\tilde{\tmtwo}}
\newcommand{\tmthreeal}{\tilde{\tmthree}}

% variables
\newcommand{\var}{x}
\newcommand{\vartwo}{y}
\newcommand{\varthree}{z}
\newcommand{\varfour}{w}

\newcommand{\varp}{\var'}
\newcommand{\vartwop}{\vartwo'}
\newcommand{\varthreep}{\varthree'}

\newcommand{\varONE}{\var_1}
\newcommand{\varTWO}{\var_2}
\newcommand{\varNTH}[1]{\var_{#1}}


% co-variables
\newcommand{\covar}{\alpha}
\newcommand{\covartwo}{\beta}
\newcommand{\covarthree}{\gamma}
\newcommand{\covarfour}{\delta}

% argument variables
\newcommand{\avar}{a}
\newcommand{\avartwo}{b}
\newcommand{\avarthree}{c}
\newcommand{\avarfour}{d}

% values
\newcommand{\val}{v}
\newcommand{\valtwo}{\val'}
\newcommand{\valthree}{\val''}

\newcommand{\valof}[1]{\val_#1} % Adrienne˛
\newcommand{\valNTH}[1]{\val_{#1}}

\newcommand{\valONE}{\val_1}
\newcommand{\valONEtwo}{\valONE'}
\newcommand{\valONEthree}{\valONE''}

\newcommand{\valTWO}{\val_2}
\newcommand{\valTWOtwo}{\valTWO'}
\newcommand{\valTWOthree}{\valTWO''}

\newcommand{\eval}{\explicit v}
\newcommand{\evaltwo}{\eval'}
\newcommand{\evalthree}{\eval''}


%\newcommand{\valp}{v_p}
%\newcommand{\valptwo}{\valp'}
%\newcommand{\valpthree}{\valp''}

%%values practical
\newcommand{\symvalp}{v_{p}}
\newcommand{\valp}{\symvalp}
\newcommand{\valptwo}{\valp'}
\newcommand{\valpthree}{\valp''}

\newcommand{\valpof}[1]{\val_{p#1}} % Adrienne˛
\newcommand{\valpNTH}[1]{\valp_{#1}}

\newcommand{\valpONE}{\valp_1}
\newcommand{\valpONEtwo}{\valpONE'}
\newcommand{\valpONEthree}{\valpONE''}

\newcommand{\valpTWO}{\valp_2}
\newcommand{\valpTWOtwo}{\valpTWO'}
\newcommand{\valpTWOthree}{\valpTWO''}

\newcommand{\valt}{v_t}
\newcommand{\valttwo}{\valt'}
\newcommand{\valtthree}{\valt''}

\newcommand{\lv}{\l_{\beta_v}}

%translations
\newcommand{\trans}[1]{#1^\circ}

%%%%%%%
%% CONTEXTS
%%%%%%%
%hole
\newcommand{\ctxholep}[1]{\langle #1\rangle}
\newcommand{\ctxhole}{\ctxholep{\cdot}}

%basic contexts
%basic contexts
\newcommand{\ctx}{C}
\newcommand{\ctxtwo}{\ctx'}
\newcommand{\ctxthree}{\ctx''}
\newcommand{\ctxfour}{\ctx'''}
\newcommand{\ctxp}[1]{\ctx\ctxholep{#1}}
\newcommand{\ctxtwop}[1]{\ctxtwo\ctxholep{#1}}
\newcommand{\ctxthreep}[1]{\ctxthree\ctxholep{#1}}
\newcommand{\ctxfourp}[1]{\ctxfour\ctxholep{#1}}

%substitution contexts
\newcommand{\sctx}{L}
\renewcommand{\sctx}{S}
\newcommand{\sctxtwo}{\sctx'}
\newcommand{\sctxthree}{\sctx''}
\newcommand{\sctxp}[1]{\sctx\ctxholep{#1}}
\newcommand{\sctxtwop}[1]{\sctxtwo\!\ctxholep{#1}}
\newcommand{\sctxthreep}[1]{\sctxthree\!\ctxholep{#1}}
\newcommand{\sctxOne}{\sctx_1}
\newcommand{\sctxTwo}{\sctx_2}
\newcommand{\sctxOnep}[1]{\sctxOne\ctxholep{#1}}
\newcommand{\sctxTwop}[1]{\sctxTwo\ctxholep{#1}}
% \newcommand{\sctxv}[1]{\sctx_{#1}}
% \newcommand{\sctxvtwo}[1]{\sctxtwo_{#1}}
% \newcommand{\sctxvthree}[1]{\sctxthree_{#1}}
% \newcommand{\sctxvp}[2]{\sctxv{#1}\ctxholep{#2}}
% \newcommand{\sctxvptwo}[2]{\sctxvtwo{#1}\ctxholep{#2}}
% \newcommand{\sctxvpthree}[2]{\sctxvthree{#1}\ctxholep{#2}}

\newcommand{\sctxONE}{L_{1}} 
\newcommand{\sctxONEtwo}{\sctxONE'}
\newcommand{\sctxONEp}[1]{\sctxONE\ctxholep{#1}}
\newcommand{\sctxONEtwop}[1]{\sctxONEtwo\ctxholep{#1}}

\newcommand{\sctxTWO}{L_{2}} 
\newcommand{\sctxTWOtwo}{\sctxTWO'}
\newcommand{\sctxTWOp}[1]{\sctxTWO\ctxholep{#1}}
\newcommand{\sctxTWOtwop}[1]{\sctxTWOtwo\ctxholep{#1}}

% inert substitution contexts
% \newcommand{\isctx}{L_{\mathtt{in}}}
\newcommand{\isctx}{L_\isym} %Giulio
\newcommand{\isctxtwo}{\isctx'}
\newcommand{\isctxthree}{\isctx''}
\newcommand{\isctxp}[1]{\isctx\ctxholep{#1}}
\newcommand{\isctxtwop}[1]{\isctxtwo\ctxholep{#1}}
\newcommand{\isctxthreep}[1]{\isctxthree\ctxholep{#1}}

\newcommand{\isctxONE}{L_{\isym 1}} 
\newcommand{\isctxONEtwo}{\isctxONE'}
\newcommand{\isctxONEthree}{\isctxONE''}
\newcommand{\isctxONEp}[1]{\isctxONE\ctxholep{#1}}
\newcommand{\isctxONEtwop}[1]{\isctxONEtwo\ctxholep{#1}}
\newcommand{\isctxONEthreep}[1]{\isctxONEthree\ctxholep{#1}}

\newcommand{\isctxTWO}{L_{\isym 2}} 
\newcommand{\isctxTWOtwo}{\isctxTWO'}
\newcommand{\isctxTWOp}[1]{\isctxTWO\ctxholep{#1}}
\newcommand{\isctxTWOtwop}[1]{\isctxTWOtwo\ctxholep{#1}}


% weak contexts
\newcommand{\wctx}{W}
\newcommand{\wctxtwo}{\wctx'}
\newcommand{\wctxthree}{\wctx''}
\newcommand{\wctxp}[1]{\wctx\ctxholep{#1}}
\newcommand{\wctxtwop}[1]{\wctxtwo\ctxholep{#1}}
\newcommand{\wctxthreep}[1]{\wctxthree\ctxholep{#1}}

% head contexts
\newcommand{\hctx}{H}
\newcommand{\hctxtwo}{\hctx'}
\newcommand{\hctxthree}{\hctx''}
\newcommand{\hctxp}[1]{\hctx\ctxholep{#1}}
\newcommand{\hctxtwop}[1]{\hctxtwo\ctxholep{#1}}

\newcommand{\hauxctx}{P}
\newcommand{\hauxctxtwo}{\hauxctx'}
\newcommand{\hauxctxthree}{\hauxctx''}
\newcommand{\hauxctxp}[1]{\hauxctx\ctxholep{#1}}
\newcommand{\hauxctxtwop}[1]{\hauxctxtwo\ctxholep{#1}}

%applicative contexts
\newcommand{\apctx}{A}
\newcommand{\apctxp}[1]{A\ctxholep{#1}}

% arbitrary contexts
\newcommand{\arbctx}{C}
\newcommand{\arbctxtwo}{\arbctx'}
\newcommand{\arbctxp}[1]{\arbctxp{#1}}
\newcommand{\arbctxtwop}[1]{\arbctxtwop{#1}}

% generic evaluation contexts (to be used in \renewcommand if needed)
\newcommand{\genevctx}{\mathsf{E}}
\newcommand{\genevctxtwo}{\genevctx'}
\newcommand{\genevctxp}[1]{\genevctx\ctxholep{#1}}
\newcommand{\genevctxtwop}[1]{\genevctxtwo\ctxholep{#1}}

% Trunk contexts (to be used in \renewcommand if needed)
\newcommand{\tctx}{T}
\newcommand{\tctxtwo}{\tctx'}
\newcommand{\tctxthree}{\tctx''}
\newcommand{\tctxfour}{\tctx'''}
\newcommand{\tctxfive}{\tctx_4}
\newcommand{\tctxp}[1]{\tctx\ctxholep{#1}}
\newcommand{\tctxtwop}[1]{\tctxtwo\ctxholep{#1}}
\newcommand{\tctxthreep}[1]{\tctxthree\ctxholep{#1}}
\newcommand{\tctxfourp}[1]{\tctxfour\ctxholep{#1}}
\newcommand{\tctxfivep}[1]{\tctxfive\ctxholep{#1}}


\newcommand{\tpctx}[2]{\startctx{#1}{#2}}
\newcommand{\tpctxp}[3]{\tpctx{#1}{#2}\ctxholep{#3}}

\newcommand{\tctxONE}{\tctx_1}
\newcommand{\tctxTWO}{\tctx_2}
\newcommand{\tctxONEtwo}{\tctx_1'}
\newcommand{\tctxTWOtwo}{\tctx_2'}
\newcommand{\tctxONEp}[1]{\tctxONE\ctxholep{#1}}
\newcommand{\tctxTWOp}[1]{\tctxTWO\ctxholep{#1}}
\newcommand{\tctxONEtwop}[1]{\tctxONEtwo\ctxholep{#1}}
\newcommand{\tctxTWOtwop}[1]{\tctxTWOtwo\ctxholep{#1}}

\newcommand{\tctxsup}{\tctx^*}
\newcommand{\tctxsupp}[1]{\tctxsup\ctxholep{#1}}

% evaluation contexts (set to generic by default)
\newcommand{\evctx}{E}
\newcommand{\evctxtwo}{\evctx'}
\newcommand{\evctxthree}{\evctx''}
\newcommand{\evctxp}[1]{\evctx\ctxholep{#1}}
\newcommand{\evctxtwop}[1]{\evctxtwo\ctxholep{#1}}
\newcommand{\evctxthreep}[1]{\evctxthree\ctxholep{#1}}

\newcommand{\evctxONE}{\evctx_1}
\newcommand{\evctxTWO}{\evctx_2}
\newcommand{\evctxONEtwo}{\evctx_1'}
\newcommand{\evctxTWOtwo}{\evctx_2'}
\newcommand{\evctxONEp}[1]{\evctxONE\ctxholep{#1}}
\newcommand{\evctxTWOp}[1]{\evctxTWO\ctxholep{#1}}
\newcommand{\evctxONEtwop}[1]{\evctxONEtwo\ctxholep{#1}}
\newcommand{\evctxTWOtwop}[1]{\evctxTWOtwo\ctxholep{#1}}

% weak evaluation contexts
\newcommand{\evwctx}{E_w}
\newcommand{\evwctxtwo}{\evwctx'}
\newcommand{\evwctxthree}{\evwctx''}
\newcommand{\evwctxp}[1]{\evwctx\ctxholep{#1}}
\newcommand{\evwctxtwop}[1]{\evwctxtwo\ctxholep{#1}}
\newcommand{\evwctxthreep}[1]{\evwctxthree\ctxholep{#1}}


% strong evaluation contexts
\newcommand{\evsctx}{S}
\newcommand{\evsctxtwo}{\evsctx'}
\newcommand{\evsctxthree}{\evsctx''}
\newcommand{\evsctxp}[1]{\evsctx\ctxholep{#1}}
\newcommand{\evsctxtwop}[1]{\evsctxtwo\ctxholep{#1}}
\newcommand{\evsctxthreep}[1]{\evsctxthree\ctxholep{#1}}


% striclty strong evaluation contexts
\newcommand{\evssctx}{E_s}
\newcommand{\evssctxtwo}{\evssctx'}
\newcommand{\evssctxthree}{\evssctx''}
\newcommand{\evssctxp}[1]{\evssctx\ctxholep{#1}}
\newcommand{\evssctxtwop}[1]{\evssctxtwo\ctxholep{#1}}
\newcommand{\evssctxthreep}[1]{\evssctxthree\ctxholep{#1}}

% zig-zag evaluation contexts
\newcommand{\zzctx}{Z}
\newcommand{\zzctxtwo}{\zzctx'}
\newcommand{\zzctxthree}{\zzctx''}
\newcommand{\zzctxp}[1]{\zzctx\ctxholep{#1}}
\newcommand{\zzctxtwop}[1]{\zzctxtwo\ctxholep{#1}}
\newcommand{\zzctxthreep}[1]{\zzctxthree\ctxholep{#1}}

% co-term contexts
\newcommand{\cotctx}{D}
\newcommand{\cotctxtwo}{\cotctx'}
\newcommand{\cotctxthree}{\cotctx''}
\newcommand{\cotctxfour}{\cotctx'''}
\newcommand{\cotctxp}[1]{\cotctx\ctxholep{#1}}
\newcommand{\cotctxtwop}[1]{\cotctxtwo\ctxholep{#1}}
\newcommand{\cotctxthreep}[1]{\cotctxthree\ctxholep{#1}}
\newcommand{\cotctxfourp}[1]{\cotctxfour\ctxholep{#1}}

% Mu-tilde contexts
\newcommand{\muctx}{M}
\newcommand{\muctxtwo}{\muctx'}
\newcommand{\muctxthree}{\muctx''}
\newcommand{\muctxfour}{\muctx'''}
\newcommand{\muctxp}[1]{\muctx\ctxholep{#1}}
\newcommand{\muctxtwop}[1]{\muctxtwo\ctxholep{#1}}
\newcommand{\muctxthreep}[1]{\muctxthree\ctxholep{#1}}
\newcommand{\muctxfourp}[1]{\muctxfour\ctxholep{#1}}

\newcommand{\muctxa}[1]{\muctx_{#1}}
\newcommand{\muctxatwo}[1]{\muctxtwo_{#1}}
\newcommand{\muctxathree}[1]{\muctxthree_{#1}}
\newcommand{\muctxafour}[1]{\muctxfour_{#1}}
\newcommand{\muctxap}[2]{\muctxa{#1}\ctxholep{#2}}
\newcommand{\muctxatwop}[2]{\muctxatwo{#1}\ctxholep{#2}}
\newcommand{\muctxathreep}[2]{\muctxathree{#1}\ctxholep{#2}}
\newcommand{\muctxafourp}[2]{\muctxafour{#1}\ctxholep{#2}}


% neutral contexts
\newcommand{\neuctx}{N}
\newcommand{\neuctxtwo}{\neuctx'}
\newcommand{\neuctxthree}{\neuctx''}
\newcommand{\neuctxp}[1]{\neuctx\ctxholep{#1}}
\newcommand{\neuctxtwop}[1]{\neuctxtwo\ctxholep{#1}}
\newcommand{\neuctxthreep}[1]{\neuctxthree\ctxholep{#1}}


% neutral terms

\newcommand{\neutral}{n}
\newcommand{\neutraltwo}{\neutral'}
\newcommand{\neutralthree}{\neutral''}
\newcommand{\neutralfour}{\neutral'''}

%Left-to-Right Evaluation Contexts
\newcommand{\levctx}{L}
\newcommand{\levctxtwo}{\levctx'}
\newcommand{\levctxthree}{\levctx''}
\newcommand{\levctxp}[1]{\levctx\ctxholep{#1}}
\newcommand{\levctxtwop}[1]{\levctxtwo\ctxholep{#1}}
\newcommand{\levctxthreep}[1]{\levctxthree\ctxholep{#1}}

\newcommand{\levctxONE}{L_1}
\newcommand{\levctxONEtwo}{\levctxONE'}

\newcommand{\levctxONEp}[1]{\levctxONE\ctxholep{#1}}
\newcommand{\levctxONEtwop}[1]{\levctxONEtwo\ctxholep{#1}}

%Left-to-Right Normal Evaluation Contexts
\newcommand{\lnevctx}{L_n}
\newcommand{\lnevctxtwo}{\lnevctx'}
\newcommand{\lnevctxthree}{\lnevctx''}
\newcommand{\lnevctxp}[1]{\lnevctx\ctxholep{#1}}
\newcommand{\lnevctxtwop}[1]{\lnevctxtwo\ctxholep{#1}}
\newcommand{\lnevctxthreep}[1]{\lnevctxthree\ctxholep{#1}}

\newcommand{\lnevctxONE}{l_n}
\newcommand{\lnevctxONEtwo}{\lnevctxONE'}

\newcommand{\lnevctxONEp}[1]{\lnevctxONE\ctxholep{#1}}
\newcommand{\lnevctxONEtwop}[1]{\lnevctxONEtwo\ctxholep{#1}}

% Right-to-Left Evaluation Contexts
\newcommand{\revctx}{R}
\newcommand{\revctxtwo}{\revctx'}
\newcommand{\revctxthree}{\revctx''}
\newcommand{\revctxp}[1]{\revctx\ctxholep{#1}}
\newcommand{\revctxtwop}[1]{\revctxtwo\ctxholep{#1}}
\newcommand{\revctxthreep}[1]{\revctxthree\ctxholep{#1}}

\newcommand{\rsubevctx}{\overline R}
\newcommand{\rsubevctxtwo}{\rsubevctx'}
\newcommand{\rsubevctxthree}{\rsubevctx''}
\newcommand{\rsubevctxp}[1]{\rsubevctx\ctxholep{#1}}
\newcommand{\rsubevctxtwop}[1]{\rsubevctxtwo\ctxholep{#1}}
\newcommand{\rsubevctxthreep}[1]{\rsubevctxthree\ctxholep{#1}}

% \newcommand{\evvctx}[1]{\evctx_{#1}}
% \newcommand{\evvctxtwo}[1]{\evctxtwo_{#1}}
% \newcommand{\evvctxthree}[1]{G_{#1}}
% \newcommand{\evvctxp}[2]{\evvctx{#1}\ctxholep{#2}}
% \newcommand{\evvctxptwo}[2]{\evvctxtwo{#1}\ctxholep{#2}}
% \newcommand{\evvctxpthree}[2]{\evvctxthree{#1}\ctxholep{#2}}

% macros for substitution contexts decorated with \varsplit
\newcommand{\sctxvs}[2]{\varsplit{\sctx}{#1}{#2}}
\newcommand{\sctxvstwo}[2]{\varsplit{\sctxtwo}{#1}{#2}}
\newcommand{\sctxvsthree}[2]{\varsplit{\sctxthree}{#1}{#2}}
\newcommand{\sctxvsfour}[2]{\varsplit{\sctxfour}{#1}{#2}}
\newcommand{\sctxvsp}[3]{\sctxvs{#1}{#2}\ctxholep{#3}}
\newcommand{\sctxvsptwo}[3]{\sctxvstwo{#1}{#2}\ctxholep{#3}}
\newcommand{\sctxvspthree}[3]{\sctxvsthree{#1}{#2}\ctxholep{#3}}
\newcommand{\sctxvspfour}[3]{\sctxvsfour{#1}{#2}\ctxholep{#3}}
%
\newcommand{\sctxvsOne}[2]{\varsplit{\sctxOne\,\!}{#1}{#2}}
\newcommand{\sctxvsTwo}[2]{\varsplit{\sctxTwo\,\!}{#1}{#2}}
\newcommand{\sctxvsOnep}[3]{\sctxvsOne{#1}{#2}\ctxholep{#3}}
\newcommand{\sctxvsTwop}[3]{\sctxvsTwo{#1}{#2}\ctxholep{#3}}

% macros for even more substution contexts (decorated with a widehat)
\newcommand{\sctxal}{\widehat{\sctx}}
\newcommand{\sctxaltwo}{\widehat{\sctxtwo}}
\newcommand{\sctxalthree}{\widehat{\sctxthree}}
\newcommand{\sctxalfour}{\widehat{\sctxfour}}
\newcommand{\sctxpal}[1]{\sctxal\ctxholep{#1}}
\newcommand{\sctxpaltwo}[1]{\sctxaltwo\ctxholep{#1}}
\newcommand{\sctxpalthree}[1]{\sctxalthree\ctxholep{#1}}
\newcommand{\sctxpalfour}[1]{\sctxalfour\ctxholep{#1}}

% macros for evaluation contexts three and four
%\newcommand{\evctxthree}{\whctx''}
\newcommand{\evctxfour}{\evctx'''}
%\newcommand{\evctxthreep}[1]{\evctxthree\ctxholep{#1}}
\newcommand{\evctxfourp}[1]{\evctxfour\ctxholep{#1}}
% [pablo]:
% At some point I introduced \evctxpthree (instead of \evctxthreep),
% sorry for the inconsistency!
\newcommand{\evctxpthree}[1]{\evctxthree\ctxholep{#1}}
\newcommand{\evctxpfour}[1]{\evctxfour\ctxholep{#1}}
%

% macros for even more evaluation contexts (decorated with a widehat)
\newcommand{\evctxal}{\widehat{\evctx}}
\newcommand{\evctxaltwo}{\widehat{\evctxtwo}}
\newcommand{\evctxalthree}{\widehat{\evctxthree}}
\newcommand{\evctxalfour}{\widehat{\evctxfour}}
\newcommand{\evctxpal}[1]{\evctxal\ctxholep{#1}}
\newcommand{\evctxpaltwo}[1]{\evctxaltwo\ctxholep{#1}}
\newcommand{\evctxpalthree}[1]{\evctxalthree\ctxholep{#1}}
\newcommand{\evctxpalfour}[1]{\evctxalfour\ctxholep{#1}}

% macros for evaluation contexts decorated with \varsplit
\newcommand{\evctxvs}[2]{\varsplit{\evctx}{#1}{#2}}
\newcommand{\evctxvstwo}[2]{\varsplit{\evctxtwo}{#1}{#2}}
\newcommand{\evctxvsthree}[2]{\varsplit{\evctxthree}{#1}{#2}}
\newcommand{\evctxvsfour}[2]{\varsplit{\evctxfour}{#1}{#2}}
\newcommand{\evctxvsp}[3]{\evctxvs{#1}{#2}\ctxholep{#3}}
\newcommand{\evctxvsptwo}[3]{\evctxvstwo{#1}{#2}\ctxholep{#3}}
\newcommand{\evctxvspthree}[3]{\evctxvsthree{#1}{#2}\ctxholep{#3}}
\newcommand{\evctxvspfour}[3]{\evctxvsfour{#1}{#2}\ctxholep{#3}}

% weak head contexts (call-by-name, a.k.a. weak linear head reduction)
\newcommand{\whctx}{H}
\newcommand{\whctxtwo}{\whctx'}
\newcommand{\whctxp}[1]{\whctx\ctxholep{#1}}
\newcommand{\whctxtwop}[1]{\whctxtwo\ctxholep{#1}}

% call-by-value contexts
\newcommand{\cbvctx}{V}
\newcommand{\cbvctxtwo}{\cbvctx'}
\newcommand{\cbvctxthree}{\cbvctx''}
\newcommand{\cbvctxfour}{\cbvctx'''}
\newcommand{\cbvctxfive}{\cbvctx''''}
\newcommand{\cbvctxsix}{\cbvctx'''''}
\newcommand{\cbvctxseven}{\cbvctx''''''}
\newcommand{\cbvctxp}[1]{\cbvctx\ctxholep{#1}}
\newcommand{\cbvctxtwop}[1]{\cbvctxtwo\ctxholep{#1}}
\newcommand{\cbvctxthreep}[1]{\cbvctxthree\ctxholep{#1}}
\newcommand{\cbvctxfourp}[1]{\cbvctxfour\ctxholep{#1}}
\newcommand{\cbvctxfivep}[1]{\cbvctxfive\ctxholep{#1}}
\newcommand{\cbvctxsixp}[1]{\cbvctxsix\ctxholep{#1}}
\newcommand{\cbvctxsevenp}[1]{\cbvctxseven\ctxholep{#1}}
\newcommand{\cbvctxhat}{W}
\newcommand{\cbvctxhatp}[1]{\cbvctxhat\ctxholep{#1}}

% strict call-by-value contexts
\newcommand{\scbvctx}{S}
\newcommand{\scbvctxtwo}{\scbvctx'}
\newcommand{\scbvctxp}[1]{\scbvctx\ctxholep{#1}}
\newcommand{\scbvctxtwop}[1]{\scbvctxtwo\ctxholep{#1}}

% call-by-need contexts
\newcommand{\cbndctx}{N}
\newcommand{\cbndctxtwo}{\cbndctx'}
\newcommand{\cbndctxthree}{\cbndctx''}
\newcommand{\cbndctxfour}{\cbndctx'''}
\newcommand{\cbndctxp}[1]{\cbndctx\ctxholep{#1}}
\newcommand{\cbndctxtwop}[1]{\cbndctxtwo\ctxholep{#1}}
\newcommand{\cbndctxthreep}[1]{\cbndctxthree\ctxholep{#1}}
\newcommand{\cbndctxfourp}[1]{\cbndctxfour\ctxholep{#1}}
\newcommand{\cbndctxhat}{M}
\newcommand{\cbndctxhattwo}{\cbndctxhat'}
\newcommand{\cbndctxhatthree}{\cbndctxhat''}
\newcommand{\cbndctxhatp}[1]{\cbndctxhat\ctxholep{#1}}
\newcommand{\cbndctxhattwop}[1]{\cbndctxhattwo\ctxholep{#1}}
\newcommand{\cbndctxhatthreep}[1]{\cbndctxhatthree\ctxholep{#1}}


%%%%%%%
%% ABSTRACT MACHINES
%%%%%%%

\newcommand{\commone}{\skeval\csym_1}
\newcommand{\commtwo}{\skeval\csym_2}
\newcommand{\commthree}{\skeval\csym_3}
\newcommand{\commfour}{\skback\csym_4}
\newcommand{\commfive}{\skback\csym_5}
\newcommand{\commsix}{\skback\csym_6}


% \newcommand{\genmach}{\mathtt M}
\newcommand{\tomachhole}[1]{\leadsto_{#1}}
\newcommand{\tomach}{\tomachhole{}}
\newcommand{\tomachm}{\tomachhole{\mulsym}}
\newcommand{\tomachmv}{\tomachhole{\mulsym\val}}
\newcommand{\tomachmi}{\tomachhole{\mulsym\isym}}
\newcommand{\tomachmone}{\tomachhole{\mulsymone}}
\newcommand{\tomachmtwo}{\tomachhole{\mulsymtwo}}
\newcommand{\tomache}{\tomachhole{\esym}}
\newcommand{\tomacheone}{\tomachhole{\esym_1}} %Giulio
\newcommand{\tomachetwo}{\tomachhole{\esym_2}} %Giulio
\newcommand{\tomachei}{\tomachhole{\osym\esym\csym}}
\newcommand{\tomachee}{\tomachhole{\osym\esym\ssym}}
\newcommand{\tomacha}{\tomachhole{\admsym}}
\newcommand{\tomachaone}{\tomachhole{\admsym_1}}
\newcommand{\tomachatwo}{\tomachhole{\admsym_2}}
\newcommand{\tomachathree}{\tomachhole{\admsym_3}}
\newcommand{\tomachasub}[1]{\tomachhole{\admsym_{#1}}}
\newcommand{\tomachasubev}[1]{\tomachhole{\tiny \skeval\admsym_{#1}}}
\newcommand{\tomachasubbt}[1]{\tomachhole{\tiny \skback\admsym_{#1}}}
\newcommand{\tomachnoa}{\tomachhole{\noadmsym}}
\newcommand{\tomachx}{\tomachhole{\mathtt{x}}}
\newcommand{\tomachasubone}{\tomachhole\commone}
\newcommand{\tomachasubtwo}{\tomachhole\commtwo}
\newcommand{\tomachasubthree}{\tomachhole\commthree}
\newcommand{\tomachasubfour}{\tomachhole\commfour}
\newcommand{\tomachasubfive}{\tomachhole\commfive}
\newcommand{\tomachasubsix}{\tomachhole\commsix}
\newcommand{\tomachasubseven}{\tomachasub{7}}

\newcommand{\tomacho}{\tomachhole{\osym}}
\newcommand{\tomachb}{\tomachhole{\beta}} %Giulio

\newcommand{\tomachsx}{\tomachhole{\ssym\mathtt{x}}}
\newcommand{\tomachux}{\tomachhole{\usym\mathtt{x}}}
\newcommand{\admnf}[1]{\mathtt{nf}_{\admsym}(#1)}
\newcommand{\tomachc}{\tomachhole{\admsym}}
\newcommand{\tomachcp}[1]{\tomachhole{\admsym#1}}
\newcommand{\tomachcone}{\tomachhole{\admsym_1}}
\newcommand{\tomachctwo}{\tomachhole{\admsym_2}}
\newcommand{\tomachcthree}{\tomachhole{\admsym_3}}
\newcommand{\tomachcfour}{\tomachhole{\admsym_4}}
\newcommand{\tomachcfive}{\tomachhole{\admsym_5}}
\newcommand{\tomachcsix}{\tomachhole{\admsym_6}}
\newcommand{\tomachcseven}{\tomachhole{\admsym_7}}
\newcommand{\tomachceight}{\tomachhole{\admsym_8}}
\newcommand{\tomachcnine}{\tomachhole{\admsym_9}}
\newcommand{\tomachcten}{\tomachhole{\admsym_{10}}}
\newcommand{\tomachceleven}{\tomachhole{\admsym_{11}}}
\newcommand{\tomachctwelve}{\tomachhole{\admsym_{12}}}
\newcommand{\tomachcthirteen}{\tomachhole{\admsym_{13}}}
\newcommand{\tomachcfourteen}{\tomachhole{\admsym_{14}}}

\newcommand{\tomachconetofive}{\tomachhole{\admsym_{1-5}}}

\newcommand{\tomachp}{\tomachhole{\psym}}
\newcommand{\tomachsm}{\tomachhole{\msym}}
\newcommand{\tomachsmv}{\tomachhole{\msym\vsym}}
\newcommand{\tomachsmi}{\tomachhole{\msym\isym}}
\newcommand{\tomachse}{\tomachhole{\esym}}
\newcommand{\tomachseone}{\tomachhole{\esym_1}} %Giulio
\newcommand{\tomachsetwo}{\tomachhole{\esym_2}} %Giulio
\newcommand{\tomachum}{\tomachhole{\usym\msym}}
\newcommand{\tomachue}{\tomachhole{\usym\esym}}
\newcommand{\tomachom}{\tomachhole{\osym\msym}}
%\newcommand{\tomachfm}{\tomachhole{\osym\msym}}
%\newcommand{\tomachfe}{\tomachhole{\osym\esym}}


% code
\newcommand{\code}{\overline{\tm}}
\newcommand{\codetwo}{\overline{\tmtwo}}
\newcommand{\codethree}{\overline{\tmthree}}
\newcommand{\codefour}{\overline{\tmfour}}
\newcommand{\codefive}{\overline{\tmfive}}
\newcommand{\codeval}{\overline{\val}}
\newcommand{\codevalt}{\overline{\valt}}
\newcommand{\codevalp}{\overline{\valp}}
\newcommand{\codevaltwo}{\overline{\valtwo}}
\newcommand{\codegconst}{\overline{\gconst}}
\newcommand{\codesinert}{\overline{\sinert}}
\newcommand{\codefire}{\bar{\fire}}
\newcommand{\codesfire}{\bar{\sfire}}

% closures
\newcommand{\clos}{c}
\newcommand{\clostwo}{c'}
\newcommand{\closthree}{c''}
\newcommand{\decclos}{\decode{\clos}}

%% environments
%\newcommand{\env}{e}
%\newcommand{\envtwo}{e'}
%\newcommand{\envthree}{e''}
%\newcommand{\envfour}{e'''}
%\newcommand{\envp}[1]{\env\ctxholep{#1}}
%\newcommand{\envtwop}[1]{\envtwo\ctxholep{#1}}
%\newcommand{\envthreep}[1]{\envthree\ctxholep{#1}}
%\newcommand{\envfourp}[1]{\envfour\ctxholep{#1}}
%\newcommand{\decenv}{\decode{\env}}
%\newcommand{\decenvtwo}{\decode{\envtwo}}
%\newcommand{\decenvthree}{\decode{\envthree}}
%\newcommand{\decenvfour}{\decode{\envfour}}
%\newcommand{\decenvp}[1]{\decenv\ctxholep{#1}}
%\newcommand{\decenvtwop}[1]{\decenvtwo\ctxholep{#1}}
%\newcommand{\decenvthreep}[1]{\decenvthree\ctxholep{#1}}
%\newcommand{\decenvfourp}[1]{\decenvfour\ctxholep{#1}}


\newcommand{\bag}{B}
\newcommand{\bagtwo}{C}
\newcommand{\bagthree}{D}
%\newcommand{\bagfour}{e}


% global environments
\newcommand{\emptyenv}{\epsilon}
\newcommand{\genv}{E}
\newcommand{\genvtwo}{\genv'}
\newcommand{\genvthree}{\genv''}
\newcommand{\genvfour}{\genv'''}
\newcommand{\genvp}[1]{\genv\ctxholep{#1}}
\newcommand{\genvtwop}[1]{\genvtwo\ctxholep{#1}}
\newcommand{\genvthreep}[1]{\genvthree\ctxholep{#1}}
\newcommand{\genvfourp}[1]{\genvfour\ctxholep{#1}}
\newcommand{\decgenv}{\decode{\genv}}
\newcommand{\decgenvtwo}{\decode{\genvtwo}}
\newcommand{\decgenvthree}{\decode{\genvthree}}
\newcommand{\decgenvfour}{\decode{\genvfour}}
\newcommand{\decgenvpx}[2]{\ctxholep{#2}\decode{#1}}
\newcommand{\decgenvp}[1]{\decgenvpx\genv{#1}}
\newcommand{\decgenvtwop}[1]{\decgenvpx\genvtwo{#1}}
\newcommand{\decgenvthreep}[1]{\decgenvpx\genvthree{#1}}
\newcommand{\decgenvfourp}[1]{\decgenvpx\genvfour{#1}}
\newcommand{\econsx}[2]{#1\cons#2} % in the grammar
\newcommand{\econs}[2]{#1#2} % abbreviated

\newcommand{\genvweak}{\genv_{\mathrm w}}
\newcommand{\genvweaktwo}{\genvtwo_{\mathrm w}}
\newcommand{\genvweakthree}{\genvthree_{\mathrm w}}
\newcommand{\genvtrunk}{\genv_{\mathrm t}}
\newcommand{\genvtrunktwo}{\genvtwo_{\mathrm t}}
\newcommand{\genvtrunkthree}{\genvthree_{\mathrm t}}

% \newcommand{\stctx}[1]{\evctx_{#1}}
% \newcommand{\stctxp}[2]{\evctx_{#1}\ctxholep{#2}}
\newcommand{\stctx}[1]{\ctx_{#1}} %Giulio
\newcommand{\stctxp}[2]{\ctx_{#1}\ctxholep{#2}} %Giulio

% stacks
\newcommand{\stempty}{\epsilon}
\newcommand{\cons}{:}
\newcommand{\fnst}[2]{\mathbf{f}(#1,#2)}
\newcommand{\nfnst}[2]{(#1,#2)}
\newcommand{\argst}[1]{\mathbf{a}(#1)}
\newcommand{\esst}[3]{\mathbf{s}(#1,#2,#3)}
\newcommand{\nesst}[3]{(#2,#1,#3)}
\newcommand{\stack}{\pi}
\newcommand{\stacktwo}{\pi'}
\newcommand{\stackthree}{\pi''}
\newcommand{\stackfour}{\pi'''}
\newcommand{\stackp}[1]{\stack\ctxholep{#1}}
\newcommand{\stacktwop}[1]{\stacktwo\ctxholep{#1}}
\newcommand{\stackthreep}[1]{\stackthree\ctxholep{#1}}
\newcommand{\decstack}{\decode{\stack}}
\newcommand{\decstacktwo}{\decode{\stacktwo}}
\newcommand{\decstackthree}{\decode{\stackthree}}
\newcommand{\decstempty}{\decode{\stempty}}
\newcommand{\decodestack}[2]{\ctxholep{#1}\decode{#2}}
\newcommand{\decstackp}[1]{\decodestack{#1}{\stack}}
\newcommand{\decstacktwop}[1]{\decodestack{#1}{\stacktwo}}
\newcommand{\decstackthreep}[1]{\decodestack{#1}{\stackthree}}
\newcommand{\decstackfourp}[1]{\decodestack{#1}{\stackfour}}
\newcommand{\decstemptyp}[1]{\decodestack{#1}{\stempty}} %Giulio

\newcommand{\decodeinv}[2]{\ctxholep{#2}\decode{#1}}

\newcommand{\samst}{\sigma}

% heaps
\newcommand{\samhp}{H}
\newcommand{\heapempty}{\epsilon}
\newcommand{\decheap}{\decode \heap}
\newcommand{\decheapp}[1]{{#1}^{\heap}}
\newcommand{\decheappp}[2]{{#1}^{#2}}

% pointers
\newcommand{\ptr}{p}
\newcommand{\ptrtwo}{q}
\newcommand{\ptrthree}{r}
\newcommand{\ptrfour}{s}

% states
\ifthenelse{\boolean{acmartstyle}}{
	\renewcommand{\state}{s}
	}{
	\newcommand{\state}{s}
}
\newcommand{\statetwo}{s'}
\newcommand{\statethree}{s''}
\newcommand{\kamstate}[3]{#1\mid#2\mid#3}
\newcommand{\cekstate}[3]{#1\mid#2\mid#3}
\newcommand{\lamstate}[3]{#1\mid#2\mid#3}
\newcommand{\mamstate}[3]{#1\mid#2\mid#3}
\newcommand{\scekstate}[4]{#1\mid#2\mid#3\mid#4}
\newcommand{\wamstate}[4]{#1\mid#2\mid#3\mid#4}
\newcommand{\mgwamstate}[3]{#1\mid#2\mid#3}
\newcommand{\pwamstate}[4]{#1\mid#2\mid#4\mid#3}
\newcommand{\pwamcons}{\bullet}
\newcommand{\envslice}{\!\upharpoonleft}
\newcommand{\envslicevar}[1]{\envslice_{#1}}
%\newcommand{\pwamclosed}[1]{#1\ \mathsf{closed}}
\newcommand{\pwamclosed}[1]{#1 \text{ is closed}}

% KAM transitions
\newcommand{\tokamlam}{\Rew{\lamsym}}
\newcommand{\tokamap}{\Rew{\apsym}}
\newcommand{\tokamvar}{\Rew{\varsym}}
\newcommand{\tokam}{\Rew{\mathtt{KAM}}}
\newcommand{\kamnfapp}[1]{\mathtt{nf}_@(#1)}

% CEK transitions
\newcommand{\toceklamone}{\Rew{\lamsym_1}}
\newcommand{\toceklamtwo}{\Rew{\lamsym_2}}
\newcommand{\tocekap}{\Rew{\apsym}}
\newcommand{\tocekvar}{\Rew{\varsym}}
\newcommand{\tocek}{\Rew{\mathtt{CEK}}}
\newcommand{\tocekaplamtwo}{\Rew{@/\l_2}}
\newcommand{\ceknfaplamtwo}[1]{\mathtt{nf}_{@/\l_2}(#1)}

% LAM transitions
\newcommand{\tolamlamone}{\Rew{\lamsym_1}}
\newcommand{\tolamlamtwo}{\Rew{\lamsym_2}}
\newcommand{\tolamap}{\Rew{\apsym}}
\newcommand{\tolamvar}{\Rew{\varsym}}
\newcommand{\tolam}{\Rew{\mathtt{LAM}}}

% SAM transitions
\newcommand{\tosamvar}{\Rew \varsym}
\newcommand{\tosamapp}{\Rew \apsym}
\newcommand{\tosamlam}{\Rew\lamsym}
\newcommand{\tosamup}{\Rew u}
\newcommand{\tosam}{\Rew{\mathtt{SAM}}}
\newcommand{\tosams}{\tosam^\ast}
\newcommand{\tosamvapp}{\Rew{v/@}}
\newcommand{\samnfvapp}[1]{\mathtt{nf}_{v/@}(#1)}

% Generic machine
\newcommand{\hypst}{\sigma}
\newcommand{\hypsttwo}{\sigma'}
\newcommand{\heap}{H}
\newcommand{\heaptwo}{H'}
\newcommand{\heapthree}{H''}
\newcommand{\con}{\between}
\newcommand{\subst}[2]{\mathbf{s}(#1,#2)}
\newcommand{\marker}{\mathsf{m}}
\newcommand{\mkfnst}[2]{(#1)_{#2}}
\newcommand{\mksubst}[2]{{\esub{#1}{-}}_{#2}}
\newcommand{\togmapl}{\rightsquigarrow_{@_l}}
\newcommand{\togmapr}{\rightsquigarrow_{@_r}}
\newcommand{\togmapb}{\rightsquigarrow_{\overline{@}}}
\newcommand{\togmsbl}{\rightsquigarrow_{[\cdot]_l}}
\newcommand{\togmsbr}{\rightsquigarrow_{[\cdot]_r}}
\newcommand{\togmsbb}{\rightsquigarrow_{\overline{[\cdot]}}}
\newcommand{\togmdb}{\rightsquigarrow_{\db}}
\newcommand{\togmls}{\rightsquigarrow_{\lssym}}
\newcommand{\togmdbv}{\rightsquigarrow_{\dbv}}
\newcommand{\togmdbvp}{\rightsquigarrow_{\dbv'}}
\newcommand{\togmlsv}{\rightsquigarrow_{\lsvsym}}
\newcommand{\togmlsvp}{\rightsquigarrow_{\lsvsym'}}
\newcommand{\togmlam}{\rightsquigarrow_{\l}}
\newcommand{\togmvar}{\rightsquigarrow_{v}}
\newcommand{\togma}{\rightsquigarrow_{\mathtt a}}
\newcommand{\togmm}{\rightsquigarrow_{\mathtt m}}
\newcommand{\togme}{\rightsquigarrow_{\mathtt e}}
\newcommand{\togmx}{\rightsquigarrow_{\mathtt x}}
\newcommand{\puresctx}{\underline{\sctx}}
\newcommand{\puresctxp}[1]{\underline{\sctx}\ctxholep{#1}}

% CBV analysis
\newcommand{\togenvx}[1]{\togenpar{#1}}
\newcommand{\togenv}{\togenvx{\cbvctx}}
\newcommand{\togenvn}[1]{\stackrel{\cbvctx}{\multimap}\!^{#1}\,}
\newcommand{\togenve}{\stackrel{\cbvctx}{\multimap_{\esym}}}
\newcommand{\togenvm}{\stackrel{\cbvctx}{\multimap_{\msym}}}

% CBV analysis2
\newcommand{\sizectx}[1]{\size{#1}}

% MAM transitions
\newcommand{\rename}[1]{\renamenop{(#1)}}
\newcommand{\renamenop}[1]{#1^\alpha}
\newcommand{\tomam}{\Rew{\mathtt{MAM}}}

% executions
\newcommand{\exec}{\rho}
\newcommand{\execp}{\rho'}
\newcommand{\execpp}{\rho''}
\newcommand{\exectwo}{\sigma}

% decoding
\newcommand{\decode}[1]{\llbracket #1\rrbracket}
\renewcommand{\decode}[1]{\underline{#1}}
%\newcommand{\decclos}[1]{\llparenthesis #1\rrparenthesis}
%\newcommand{\decstack}[2]{\llparenthesis #1\rrparenthesis_{#2}}
\newcommand{\hpfun}[1]{\widehat{#1}}
\newcommand{\ptpred}[1]{\mathrm{pred}(#1)}
\newcommand{\decgm}[1]{\llparenthesis #1\rrparenthesis}

% measures
% \newcommand{\sizebv}[1]{\size{#1}_{\beta\vsym}}
\newcommand{\sizebv}[1]{\size{#1}_{\beta_v}} %Giulio
\newcommand{\sizebabs}[1]{\size{#1}_{\betaabs}} 
\newcommand{\sizein}[1]{\size{#1}_{\betain}}
% \newcommand{\sizebvm}[1]{\size{#1}_{\beta\msym}}
\newcommand{\sizebvm}[1]{\size{#1}_{\betavm}} %Giulio
\newcommand{\sizebshuf}[1]{\sizebvm{#1}} %Giulio
\newcommand{\sizesigm}[1]{\size{#1}_{\sigm}} %Giulio
\newcommand{\sizevm}[1]{\size{#1}_{\vmsym}} %Giulio
\newcommand{\sizeinm}[1]{\size{#1}_{\isym\msym}}
\newcommand{\sizees}[1]{\size{#1}_{[\ ]}}
\newcommand{\sizelam}[1]{\size{#1}_{\l}}
\newcommand{\sizeadm}[1]{\size{#1}_{\admsym}}
\newcommand{\sizelog}[1]{\size{#1}_{\noadmsym}}
\newcommand{\sizevar}[1]{\size{#1}_{v}}
\newcommand{\sizelamone}[1]{\size{#1}_{\l_1}}
\newcommand{\sizelamtwo}[1]{\size{#1}_{\l_2}}
\newcommand{\sizei}[1]{\size{#1}_{\isym}}
\newcommand{\sizeei}[1]{\size{#1}_{\expo\isym}} %Giulio
\newcommand{\sizeb}[1]{\size{#1}_{\bsym}}
\newcommand{\sizef}[1]{\size{#1}_{\betaf}}
\newcommand{\sizex}[1]{\size{#1}_{\mathtt{x}}}

\newcommand{\sizeue}[1]{\size{#1}_{\usym\esym}}
\newcommand{\sizeuei}[1]{\size{#1}_{\osym\esym\csym}}
\newcommand{\sizeuee}[1]{\size{#1}_{\osym\esym\ssym}}
\newcommand{\sizeum}[1]{\size{#1}_{\osym\msym}}
\newcommand{\sizeoe}[1]{\size{#1}_{\osym\esym}}

%%%%%%%%%%
%%  Sizes on terms %Giulio
%%%%%%%%%%
\newcommand{\nes}[1]{|#1|_\textup{ES}} %number of explicit substitutions %Giulio

%%%%%%%%%
%%   SECD   %%
%%%%%%%%%

\newcommand{\fstack}{D}
\newcommand{\fstacktwo}{D'}
\newcommand{\fstackthree}{D''}
\newcommand{\fstackp}[1]{\fstack\ctxholep{#1}}
\newcommand{\fstacktwop}[1]{\fstacktwo\ctxholep{#1}}
\newcommand{\fstackthreep}[1]{\fstackthree\ctxholep{#1}}

% decoded parts of an abstract machine
\newcommand{\dstackp}[1]{\decode{\stack}\ctxholep{#1}}
\newcommand{\dstacktwop}[1]{\decode{\stacktwo}\ctxholep{#1}}
\newcommand{\dstackthreep}[1]{\decode{\stackthree}\ctxholep{#1}}
\newcommand{\denvp}[1]{\decode{\env}\ctxholep{#1}}
\newcommand{\denvtwop}[1]{\decode{\envtwo}\ctxholep{#1}}
\newcommand{\denvsubonep}[1]{\decode{\env_1}\ctxholep{#1}}
\newcommand{\denvsubtwop}[1]{\decode{\env_2}\ctxholep{#1}}
\newcommand{\dfstackp}[1]{\decode{\fstack}\ctxholep{#1}}
\newcommand{\dgenvp}[1]{\decode{\genv}\ctxholep{#1}}
\newcommand{\dgenvtwop}[1]{\decode{\genvtwo}\ctxholep{#1}}
\newcommand{\dgenvsubonep}[1]{\decode{\genv_1}\ctxholep{#1}}
\newcommand{\dgenvsubtwop}[1]{\decode{\genv_2}\ctxholep{#1}}

%%%%%%%%%%%%%%%
%%   Amortized Analysis  %%
%%%%%%%%%%%%%%%
\newcommand{\bad}{\bullet}
\newcommand{\good}{\circ}

\newcommand{\esubg}[2]{[#1{\shortleftarrow}#2]^{\good}}
\newcommand{\esubb}[2]{[#1{\shortleftarrow}#2]^{\bad}}
\newcommand{\esubu}[2]{[#1{\shortleftarrow}#2]^{*}}
\newcommand{\rtolsvg}{\rootRew{\lssym\vsym\good}}
\newcommand{\rtolsvb}{\rootRew{\lssym\vsym\bad}}
\newcommand{\togeneg}{\Rew{e\good}}
\newcommand{\togeneb}{\Rew{e\bad}}
\newcommand{\togeneu}{\Rew{e*}}

\newcommand{\deriv}{d}
\newcommand{\derivp}{d'} %Giulio
\newcommand{\derivpp}{d''} %Giulio
\newcommand{\derivtwo}{e}
\newcommand{\derivthree}{f}
\newcommand{\derivfour}{g}

\newcommand{\sizehole}[2]{|#2|_{#1}}
\newcommand{\sizeeg}[1]{\sizehole{\esym\good}{#1}}
\newcommand{\sizeeb}[1]{\sizehole{\esym\bad}{#1}}
\newcommand{\sizedb}[1]{\sizehole{\db}{#1}}
% \newcommand{\sizee}[1]{\sizehole{\esym}{#1}}
% \newcommand{\sizem}[1]{\sizehole{\msym}{#1}}
\newcommand{\sizee}[1]{\sizehole{\expo}{#1}} %Giulio
\newcommand{\sizeeabs}[1]{\sizehole{\expoabs}{#1}} 
\newcommand{\sizeevar}[1]{\sizehole{\expovar}{#1}} 
\newcommand{\sizem}[1]{\sizehole{\mult}{#1}} %Giulio
\newcommand{\sizevsub}[1]{\sizehole{\vsub}{#1}} %Giulio
\newcommand{\sizevsubk}[1]{\sizehole{\vsubk}{#1}} %Giulio
\newcommand{\sizemi}[1]{\sizehole{\mult\isym}{#1}} %Giulio
\newcommand{\sizemv}[1]{\sizehole{\mult\vsym}{#1}} %Giulio
\newcommand{\sizeg}[1]{\sizehole\good{#1}}
%\newcommand{\sizep}[1]{\sizeholep{#1}}
\newcommand{\sizemuld}[1]{\sizehole{@\bad}{#1}}
% \newcommand{\sizefree}[1]{\sizehole{\tt free}{#1}}
\newcommand{\sizefree}[1]{\sizehole{\mathsf{free}}{#1}} %Giulio
\newcommand{\sizecomm}[1]{\sizehole{\mathsf{com}}{#1}} %Giulio
\newcommand{\sizew}[1]{\sizehole{\osym}{#1}} %Giulio

%%%%%%%%%%%%%%%
%%   Amortized Analysis for cbv  %%
%%%%%%%%%%%%%%%

\newcommand{\tosgene}{\multimap_{\ctxhole \mathtt e}}
\newcommand{\tofgene}{\multimap_{\bad \mathtt e}}
\newcommand{\toagene}{\multimap_{\good \mathtt e}}
\newcommand{\ssize}[1]{|#1|_{\ctxhole \mathtt e}}
\newcommand{\fsize}[1]{|#1|_{\bad \mathtt e}}
\newcommand{\asize}[1]{|#1|_{\good \mathtt e}}

%%%%%%%%%%%%%%%
%%   LAZY KAM              %%
%%%%%%%%%%%%%%%

\newcommand{\headst}[1]{\mathbf{h}(#1)}

%%%%%%%%%%%%%%%
%%   ENVIRONMENTS   %%
%%%%%%%%%%%%%%%

%\usepackage{amsthm}


%%\theoremstyle{plain}
%    \newtheorem{theorem}{Theorem}[section]
%    \newtheorem{lemma}[theorem]{Lemma}
%%    \newtheorem*{lemmanonum}{Lemma}
%    \newtheorem{corollary}[theorem]{Corollary}
%    \newtheorem{proposition}[theorem]{Proposition}
%%\theoremstyle{definition}
%    \newtheorem{definition}[theorem]{Definition}
%%\theoremstyle{remark}
%    \newtheorem{remark}[theorem]{Remark}

\newcommand{\distil}{{\tt D}}
\newcommand{\calculus}{{\tt C}}
\renewcommand{\calculus}{\togen}
\newcommand{\mach}{\mathsf{M}}

\newcommand{\wnamed}{well-named}
\newcommand{\Wnamed}{Well-named}
\newcommand{\WNamed}{Well-Named}
\newcommand{\gwnamed}{globally well-named}
\newcommand{\Gwnamed}{Globally well-named}
\newcommand{\lwnamed}{locally well-named}
\newcommand{\Lwnamed}{Locally well-named}


\newcommand{\dumpempty}{\epsilon}
\renewcommand{\dump}{D}
\newcommand{\dumptwo}{\dump'}
\newcommand{\dumpthree}{\dump''}
\newcommand{\decdump}{\decode \dump}
\newcommand{\decdumpp}[1]{\decdump \ctxholep{#1}}
\newcommand{\decdumptwo}{\decode{\dumptwo}}
\newcommand{\decdumpthree}{\decode{\dumpthree}}
\newcommand{\decdumptwop}[1]{\decdumptwo\ctxholep{#1}}
\newcommand{\decdumpthreep}[1]{\decdumpthree\ctxholep{#1}}

\newcommand{\closprop}{every closure in $\state$ is closed}
\newcommand{\globclosprop}[1]{the global closure #1 of $\state$ is closed}
\newcommand{\subprop}{any code in $\state$ is a literal subterm of $\code$}
\newcommand{\subalphaprop}{any code in $\state$ is $\alpha$-equivalent to a subterm of the initial code of $\state$}
\newcommand{\gwnameprop}{the global closure of $\state$ is \wnamed}
\newcommand{\lwnameprop}{any closure in $\state$ is \wnamed}
\newcommand{\envprop}{the length of any environment in $\state$ is bound by $\size\code$}
\newcommand{\genvprop}{the length of the global environment in $\state$ is bound by $\sizem\exec$}

\newcommand{\invariantshyp}[1]{be a #1 reachable state whose initial code $\code$ is \wnamed}

\newcommand{\globinvariantshyp}[1]{be a #1 state reached by an execution $\exec$ of initial \wnamed\ code $\code$}

\newcommand{\distillationStatement}{is a reflective distillery. In particular, on a reachable state $\state$ we have}

\newcommand{\pwammark}{\Box}
\newcommand{\dual}{\bot}

\newcommand{\support}[1]{\Delta(#1)}

\newcommand{\varordstep}{\varord^1}
\newcommand{\varord}{\prec}
\newcommand{\varordeq}{\preceq}

\newcommand{\todb}{\Rew{\db}}
\newcommand{\tols}{\Rew{\ls}}
\newcommand{\toB}{\Rew{\Bsym}}
\newcommand{\togc}{\Rew{\gc}}
\newcommand{\toneq}{\Rew{\neq}}
\newcommand{\toap}{\Rew{@}}
\newcommand{\toabs}{\Rew{\l}}
\newcommand{\tovar}{\Rew{\vartt}}

\newcommand{\toeval}{\stackrel{\evctx}{\rightarrow}_{\esym}}

\newcommand{\tomachnoap}{\Rew{\neg c_1}}
% commented during the study of intersection types
%\newcommand{\sizenoap}[1]{|#1|_{\neg c_1}}
%\newcommand{\sizeap}[1]{|#1|_{c_1}}
\newcommand{\sizecomtwo}[1]{|#1|_{c_2}}

\newcommand{\sizels}[1]{|#1|_{\lssym}}

\renewcommand{\rtodb}{\rootRew{\msym}}
\renewcommand{\rtols}{\rootRew{\esym}}
\renewcommand{\rtodbv}{\rootRew{\msym}}
\renewcommand{\rtolsv}{\rootRew{\esym}}
\renewcommand{\rtolsvg}{\rootRew{\esym\good}}
\renewcommand{\rtolsvb}{\rootRew{\esym\bad}}

%%%% COSTANTS

\newcommand{\const}{a}
\newcommand{\consttwo}{b}
\newcommand{\constthree}{c}

% inert terms
\newcommand{\itm}{i}
\newcommand{\itmtwo}{\itm'} 
\newcommand{\itmthree}{\itm''}
\newcommand{\itmfour}{\itm'''} 
\newcommand{\itmONE}{i_1}
\newcommand{\itmONEtwo}{\itmONE'} 
\newcommand{\itmONEthree}{\itmONE''}
\newcommand{\itmONEfour}{\itmONE'''}
\newcommand{\itmTWO}{i_2}
\newcommand{\itmTWOtwo}{\itmTWO'} 
\newcommand{\itmTWOthree}{\itmTWO''}
\newcommand{\itmTWOfour}{\itmTWO'''}

%inert applicative
\newcommand{\itmapp}{\mathbb{i}}
\newcommand{\itmapptwo}{\itmapp'} 
\newcommand{\itmappthree}{\itmapp''}
\newcommand{\itmappfour}{\itmapp'''} 
\newcommand{\itmappONE}{\itmapp_1}
\newcommand{\itmappONEtwo}{\itmappONE'} 
\newcommand{\itmappTWO}{\itmapp_2}
\newcommand{\itmappTWOtwo}{\itmappTWO'} 

\newcommand{\itms}{i_s}
\newcommand{\ntms}{n_s}

% generalized constants
 \newcommand{\gconst}{i} 
\newcommand{\gconsttwo}{\gconst'}
\newcommand{\gconstthree}{\gconst''}
\newcommand{\gconstfour}{\gconst'''}

% strong inert terms
 \newcommand{\sinert}{\mathbb{i}} 
\newcommand{\sinerttwo}{\sinert'}
\newcommand{\sinertthree}{\sinert''}


% \newcommand{\econst}{\explicit i}
\newcommand{\econst}{\explicit \gconst} %Giulio
\newcommand{\econsttwo}{\econst'}
\newcommand{\econstthree}{\econst''}


\newcommand{\gconstp}{i_p}
\newcommand{\gconsttwop}{\gconstp'}
\newcommand{\gconstptwo}{\gconsttwop}
\newcommand{\gconstthreep}{\gconstp''}
\newcommand{\gconstpthree}{\gconstthreep}


% fireballs
\newcommand{\fire}{f}
\newcommand{\firetwo}{g}
\newcommand{\firetwop}{\firetwo'}
\newcommand{\firethree}{h}
\newcommand{\firefour}{\fire'''}
\newcommand{\firep}{\fire'}
\newcommand{\firepp}{\fire''}
% strong fireballs
\newcommand{\sfire}{\mathbb{f}}
\newcommand{\sfiretwo}{\sfire'}
\newcommand{\sfirethree}{\sfire''}
\newcommand{\sfirefour}{\sfire'''}

\newcommand{\fireONE}{\fire_1}
\newcommand{\fireONEtwo}{\firetwo_1}

\newcommand{\fireTWO}{\fire_2}
\newcommand{\fireTWOtwo}{\firetwo_2}



% fireballs with pedices
\newcommand{\firefirst}{\fire_1}
\newcommand{\firesec}{\fire_2}
\newcommand{\firethird}{\fire_3}
\newcommand{\firefourth}{\fire_4}
\newcommand{\firefifth}{\fire_5}

\newcommand{\firetwofirst}{\firetwo_1}
\newcommand{\firetwosec}{\firetwo_2}
\newcommand{\firetwothird}{\firetwo_3}
\newcommand{\firetwofourth}{\firetwo_4}
\newcommand{\firetwofifth}{\firetwo_5}

\newcommand{\firethreefirst}{\firethree_1}
\newcommand{\firethreesec}{\firethree_2}
\newcommand{\firethreethird}{\firethree_3}
\newcommand{\firethreefourth}{\firethree_4}
\newcommand{\firethreefifth}{\firethree_5}

\newcommand{\firefourfirst}{\firefour_1}
\newcommand{\firefoursec}{\firefour_2}
\newcommand{\firefourthird}{\firefour_3}
\newcommand{\firefourfourth}{\firefour_4}
\newcommand{\firefourfifth}{\firefour_5}


% explicit fireballs
\newcommand{\efire}{\explicit f}
\newcommand{\efiretwo}{\explicit g}
\newcommand{\efirethree}{\explicit h}
\newcommand{\efirefour}{\explicit i}

\newcommand{\explicit}[1]{\overline{#1}}

\newcommand{\tovs}{\Rew{\vsym\ssym}}
% \newcommand{\betaf}{\fsym}
\newcommand{\betaf}{\beta_{\!\fsym}} %Giulio
\newcommand{\betanof}{\lnot\betaf} %Giulio
\newcommand{\rbetaf}{{\rsym\betaf}}
\newcommand{\rtof}{\rootRew{\betaf}}
\newcommand{\tof}{\Rew{\betaf}}
\newcommand{\torf}{\Rew{\rbetaf}}
\newcommand{\tossf}{\Rew{\ssym\ssym\betaf}}
\newcommand{\tosf}{\Rew{\ssym\betaf}}
\newcommand{\tozf}{\Rew{\zsym\betaf}}
\newcommand{\fsub}{{\fsym\subsym}} %Giulio
\newcommand{\vsub}{{\vsym\subsym}} %Giulio
\newcommand{\vsubeq}{{\vsub_\eqstruct}\!} %Giulio
\newcommand{\tofsub}{\Rew{\fsub}}
\newcommand{\tovsub}{\Rew{\vsub}}
\newcommand{\tovsubk}{\Rew{\vsubk}} %Giulio
\newcommand{\torvsub}{\Rew{\rsym\vsub}}
\newcommand{\tovsubeq}{\Rew{\vsubeq}}

\newcommand{\rtofm}{\rootRew{\fsym\msym}}
\newcommand{\tofm}{\Rew{\fmsym}} %Giulio
\newcommand{\tofmm}{\Rew{\fmmsym}} %Giulio
\newcommand{\rtow}{\rootRew{\wsym}}
\newcommand{\tow}{\Rew{\wsym}} %Giulio
\newcommand{\towm}{\Rew{\wmsym}} %Giulio
% \newcommand{\tofmperm}{\Rew{\fmsym\sigma}}
\newcommand{\tofmperm}{\Rew{\tmsym}} %Giulio

\newcommand{\betafc}{\betaf{\csym}} %Giulio
\newcommand{\tofc}{\Rew{\betafc}} %Giulio

\newcommand{\pevctx}{C}
\newcommand{\pevctxtwo}{C'}
\newcommand{\pevctxthree}{C''}
\newcommand{\pevctxp}[1]{\pevctx\ctxholep{#1}}
\newcommand{\pevctxtwop}[1]{\pevctxtwo\ctxholep{#1}}
\newcommand{\pevctxthreep}[1]{\pevctxthree\ctxholep{#1}}

\newcommand{\pctx}{\pevctx}
\newcommand{\pctxtwo}{\pevctxtwo}
\newcommand{\pctxthree}{\pevctxthree}
\newcommand{\pctxp}[1]{\pctx\ctxholep{#1}}
\newcommand{\pctxtwop}[1]{\pctxtwo\ctxholep{#1}}
\newcommand{\pctxthreep}[1]{\pctxthree\ctxholep{#1}}

\newcommand{\mctx}{B}
% \newcommand{\mctx}{\mbox{\footnotesize \bilanciasym}}
\newcommand{\mctxtwo}{\pevctx'}
\newcommand{\mctxthree}{\pevctx''}
\newcommand{\mctxp}[1]{\mctx\ctxholep{#1}}
\newcommand{\mctxtwop}[1]{\mctxtwo\ctxholep{#1}}
\newcommand{\mctxthreep}[1]{\mctxthree\ctxholep{#1}}


% \newcommand{\psctx}{\pevctx_\vartwo}
% \newcommand{\psctxtwo}{\pevctxtwo_\vartwo}
% \newcommand{\psctxthree}{\pevctxthree_\vartwo}
% \newcommand{\psctxp}[1]{\psctx\ctxholep{#1}}
% \newcommand{\psctxtwop}[1]{\psctxtwo\ctxholep{#1}}
% \newcommand{\psctxthreep}[1]{\psctxthree\ctxholep{#1}}
% 
% \newcommand{\ssctx}{\sctx_{\vartwo}}
% \newcommand{\ssctxtwo}{\sctxtwo_{\vartwo}}
% \newcommand{\ssctxthree}{\sctxthree_{\vartwo}}
% \newcommand{\ssctxp}[1]{\ssctx\ctxholep{#1}}
% \newcommand{\ssctxtwop}[1]{\ssctxtwo\ctxholep{#1}}
% \newcommand{\ssctxthreep}[1]{\ssctxthree\ctxholep{#1}}

\newcommand{\psctx}[1]{\pevctx_{#1}}
\newcommand{\psctxtwo}[1]{\pevctxtwo_{#1}}
\newcommand{\psctxthree}[1]{\pevctxthree_{#1}}
\newcommand{\psctxp}[2]{\psctx{#1}\ctxholep{#2}}
\newcommand{\psctxtwop}[2]{\psctxtwo{#1}\ctxholep{#2}}
\newcommand{\psctxthreep}[2]{\psctxthree{#1}\ctxholep{#2}}
\newcommand{\ssctx}[1]{\sctx_{#1}}
\newcommand{\ssctxtwo}[1]{\sctxtwo_{#1}}
\newcommand{\ssctxthree}[1]{\sctxthree_{#1}}
\newcommand{\ssctxp}[2]{\ssctx{#1}\ctxholep{#2}}
\newcommand{\ssctxtwop}[2]{\ssctxtwo{#1}\ctxholep{#2}}
\newcommand{\ssctxthreep}[2]{\ssctxthree{#1}\ctxholep{#2}}


\newcommand{\unfsym}{\rotatebox[origin=c]{-90}{$\rightarrow$}}
\newcommand{\unf}[1]{#1\unfsym\,}
\newcommand{\relunf}[2]{\unf{#1}_{#2}}

\newcommand{\alive}{\val}
\newcommand{\dead}{\gconst}

\newcommand{\lab}{l}
\newcommand{\labtwo}{\beta}
\newcommand{\labthree}{\gamma}

\newcommand{\fireball}{fireball}
\newcommand{\Fireball}{Fireball}

\newcommand{\dentry}[2]{#1\Diamond#2}

\newcommand{\usym}{{\mathtt u}}
\newcommand{\csym}{{\mathtt c}}
\newcommand{\lsym}{{\mathtt l}}
\newcommand{\osym}{{\mathtt o}}
\newcommand{\togens}{\multimap_{\fsym}}
\newcommand{\togensm}{\multimap_{\msym}}
\newcommand{\togense}{\multimap_{\esym}}

%\newcommand{\togenf}{\multimap_{\osym}}
\newcommand{\togenfm}{\multimap_{\osym\msym}}
\newcommand{\togenfe}{\multimap_{\osym\esym}}
\newcommand{\togenfes}{\multimap_{\osym\esym\ssym}}
\newcommand{\togenfec}{\multimap_{\osym\esym\csym}}

\newcommand{\togenu}{\multimap_{\usym\fsym}}
\newcommand{\togenum}{\multimap_{\usym\msym}}
\newcommand{\togenue}{\multimap_{\usym\esym}}
\newcommand{\togenlu}{\multimap_{\osym\fsym}}
\newcommand{\togenlum}{\multimap_{\osym\msym}}
\newcommand{\togenlue}{\multimap_{\osym\esym}}
\newcommand{\togenluee}{\multimap_{\osym\esym\ssym}}
\newcommand{\togenluei}{\multimap_{\osym\esym\csym}}





\newcommand{\la}[1]{\lambda #1.}
\newcommand{\tmseven}{m}
\newcommand{\tmeight}{n}
\newcommand{\tmnine}{o}

\newcommand{\actx}{A}
\newcommand{\actxtwo}{A'}
\newcommand{\actxthree}{A''}
\newcommand{\actxp}[1]{\actx\ctxholep{#1}}
\newcommand{\actxtwop}[1]{\actxtwo\ctxholep{#1}}
\newcommand{\actxthreep}[1]{\actxthree\ctxholep{#1}}

\newcommand{\ictx}{I}
\newcommand{\ictxtwo}{I'}
\newcommand{\ictxthree}{I''}
\newcommand{\ictxp}[1]{\ictx\ctxholep{#1}}
\newcommand{\ictxtwop}[1]{\ictxtwo\ctxholep{#1}}
\newcommand{\ictxthreep}[1]{\ictxthree\ctxholep{#1}}

\newcommand{\ictxfirst}{\ictx_1}
\newcommand{\ictxfirstp}[1]{\ictxfirst\ctxholep{#1}}
\newcommand{\ictxsec}{\ictx_2}
\newcommand{\ictxsecp}[1]{\ictxsec\ctxholep{#1}}
\newcommand{\ictxthird}{\ictx_3}
\newcommand{\ictxthirdp}[1]{\ictxthird\ctxholep{#1}}
\newcommand{\ictxfourth}{\ictx_4}
\newcommand{\ictxfourthp}[1]{\ictxfourth\ctxholep{#1}}
\newcommand{\ictxfifth}{\ictx_5}
\newcommand{\ictxfifthp}[1]{\ictxfifth\ctxholep{#1}}

\newcommand{\ictxtwofirst}{\ictxtwo_1}
\newcommand{\ictxtwofirstp}[1]{\ictxtwofirst\ctxholep{#1}}
\newcommand{\ictxtwosec}{\ictxtwo_2}
\newcommand{\ictxtwosecp}[1]{\ictxtwosec\ctxholep{#1}}
\newcommand{\ictxtwothird}{\ictxtwo_3}
\newcommand{\ictxtwothirdp}[1]{\ictxtwothird\ctxholep{#1}}
\newcommand{\ictxtwofourth}{\ictxtwo_4}
\newcommand{\ictxtwofourthp}[1]{\ictxtwofourth\ctxholep{#1}}
\newcommand{\ictxtwofifth}{\ictxtwo_5}
\newcommand{\ictxtwofifthp}[1]{\ictxtwofifth\ctxholep{#1}}

\newcommand{\ictxthreefirst}{\ictxthree_1}
\newcommand{\ictxthreefirstp}[1]{\ictxthreefirst\ctxholep{#1}}
\newcommand{\ictxthreesec}{\ictxthree_2}
\newcommand{\ictxthreesecp}[1]{\ictxthreesec\ctxholep{#1}}
\newcommand{\ictxthreethird}{\ictxthree_3}
\newcommand{\ictxthreethirdp}[1]{\ictxthreethird\ctxholep{#1}}
\newcommand{\ictxthreefourth}{\ictxthree_4}
\newcommand{\ictxthreefourthp}[1]{\ictxthreefourth\ctxholep{#1}}
\newcommand{\ictxthreefifth}{\ictxthree_5}
\newcommand{\ictxthreefifthp}[1]{\ictxthreefifth\ctxholep{#1}}


% Trivial machine
\newcommand{\tmac}[3]{(#1,#2,#3)}

% Useful Machine with Constants
\newcommand{\maca}[5]{#2 & #3 & #4 & #5 & #1}
\newcommand{\macanew}[6]{#2 & #3 & #4 & #5 & #6 & #1}
\newcommand{\usefmaca}[4]{#2 & #3 & #4 & #1}
\newcommand{\mac}[5]{(#2,#3,#4,#5,#1)}
\newcommand{\macsix}[6]{(#2,#3,#4,#5,#6,#1)}
\newcommand{\usefmac}[4]{(#2,#3,#4,#1)}

\newcommand{\glamst}[4]{(#1,#2,#3,#4)}
\newcommand{\glamsttab}[4]{#1 &#2 &#3 &#4} %Giulio
\newcommand{\eglamst}[4]{(#1,#2,#3,#4)}
\newcommand{\sglamst}[6]{(#1,#2,#3,#4,#5,#6)}
\newcommand{\sized}[1]{|#1|_{\dump}}
\newcommand{\sizecom}[1]{|#1|_c}
\newcommand{\sizecbv}[1]{|#1|_{\tt CBV}}
\newcommand{\sizecomphone}[1]{|#1|_{c_{1-5}}}
\newcommand{\sizecomsix}[1]{|#1|_{c_6}}
\newcommand{\tomachphone}{\Rew{m,c_{1-5}}}
\newcommand{\tomachphtwo}{\Rew{c_6,e}}

\newcommand{\external}{shallow}
\newcommand{\External}{Shallow}
\newcommand{\internal}{chain}
\newcommand{\Internal}{Chain}
\newcommand{\basic}{basic}

\newcommand{\stackitem}{\phi}
\newcommand{\stackitemtwo}{\psi}
\newcommand{\stackitemthree}{\theta}
%\newcommand{\pair}[2]{#1@#2}
\newcommand{\labval}{\alive}
\newcommand{\labin}{\dead}
\newcommand{\herval}[1]{#1^{\labval}}
\newcommand{\labe}[1]{#1^\lab} %Giulio
\newcommand{\herin}[1]{#1^\labin} %Giulio
\newcommand{\decodeheap}[2]{\decheappp{#2}{#1}}

\newcommand{\decodep}[2]{\decode{#1}\ctxholep{#2}}

% Decoding of a machine with constants
%\decodep{\genv}{\decodep{\dump}{\decodestack{\decodeheap{\heap}{\code}}{\stack}}}


%%%%

% proofs 
\newcommand{\myproof}[1]{
\ifthenelse{\boolean{omitproofs}}{\begin{IEEEproof} Proof available but omitted for readability. \end{IEEEproof}}{#1}}

\newcommand{\redex}{R}


\newcommand{\Micro}{Explicit}

%%%% MACHINES
\newcommand{\FC}{FBC\xspace}
\newcommand{\fb}{FBC\xspace}
\newcommand{\FB}{FBC\xspace}
\newcommand{\fast}{Unchaining\xspace}
\newcommand{\ShFC}{\Micro\ \FC\xspace}
\newcommand{\EFC}{EFC\xspace}
\newcommand{\UsFC}{Useful \FC\xspace}
\newcommand{\FFC}{\fast \FC\xspace}
\newcommand{\UFC}{\FC\xspace}
\newcommand{\GLAM}{Open \glam}
\newcommand{\oglam}{Open \glam}
\newcommand{\glam}{G\lam}
\newcommand{\lam}{LAM\xspace} %Giulio
\newcommand{\glamour}{GLA\-MOUr\xspace}
\newcommand{\easy}{Easy\xspace}
\newcommand{\eglamour}{\easy \glamour}
\newcommand{\Fast}{Fast\xspace}
\newcommand{\ve}{BE\xspace}
\newcommand{\veglamour}{\ve \glamour}
\newcommand{\fglamour}{\Fast \glamour}
\newcommand{\vf}{BEST\xspace}
\newcommand{\vfglamour}{\vf \glamour}
\newcommand{\uglamour}{Unchaining \glamour}

\newcommand{\sglamour}{Strong \glamour}
\newcommand{\zzglamour}{Zig-Zag \glamour}
\newcommand{\Fglamour}{\fast \glamour}
\newcommand{\naif}{Na\"if\xspace}
\newcommand{\nam}{NAM\xspace}


\newcommand{\esmeas}[1]{|#1|_{[\cdot]}}

\newcommand{\decodefun}{\decode{{ }\cdot{ }}}

\newcommand{\towhlcekannot}[1]{\stackrel{\mathtt{ns}}{\multimap}_{#1}}
\renewcommand{\towhlcekannot}[1]{\multimap_{#1}}
\renewcommand{\dbv}{\msym}
\renewcommand{\lsvsym}{\esym}

\newcommand{\symb}{symbol\xspace}
\newcommand{\Symb}{Symbol\xspace}
\newcommand{\symbs}{symbols\xspace}
\newcommand{\Symbs}{Symbols\xspace}

\newcommand{\levy}{{L{\'e}vy}\xspace}
\newcommand{\gregoire}{Gr{\'{e}}goire\xspace}

\newcommand{\startctx}[2]{\overleftarrow{#1}^{#2}}

% Equality checking
\newcommand{\foify}[2]{\tau_{#1}(#2)}
\newcommand{\appl}{@}
\newcommand{\abst}{\Lambda}
\newcommand{\es}{\mathtt{ES}}
\newcommand{\node}{\mathtt{n}}

%%%%%%% A Strong Distillery %%%%%%


\newcommand{\prefix}{\prec_p}
\newcommand{\outin}{\prec_O}
\newcommand{\leftright}{\prec_L}
\newcommand{\leftout}{\prec_{\lo}}
\newcommand{\lefttor}{\prec}
\newcommand{\lo}{LO\xspace}
\newcommand{\lou}{\lo U\xspace}
\newcommand{\ilo}{i\lo}
\newcommand{\ilou}{i\lou}
\newcommand{\rlo}{r\lo}
\newcommand{\rlou}{r\lou}
\newcommand{\lob}{\lo$\beta$}
\newcommand{\ilob}{i\lob}
\newcommand{\nalo}{na\lo}

\newcommand{\toblo}{\Rew{\mbox{\tiny LO}\beta}}
\newcommand{\tolo}{\Rew{\mbox{\tiny LO}}}


\newcommand{\lfv}[1]{{\tt lfv}(#1)}

\newcommand{\skamstate}[5]{#2\mid#3\mid#4\mid#5\mid#1}
\newcommand{\skeval}{\textcolor{blue}{\blacktriangledown}}
\newcommand{\skback}{\textcolor{red}{\blacktriangle}}

\newcommand{\phase}{\skphase}
\newcommand{\phasetwo}{\phase'}
\newcommand{\phasethree}{\phase''}

\newcommand{\evalph}{\textcolor{blue}{\blacktriangledown}}
\newcommand{\evalphw}{\textcolor{blue}{\blacktriangleleft_\wsym}}
\newcommand{\evalphlw}{\textcolor{blue}{\blacktriangleright_\wsym}}
\newcommand{\evalphrw}{\textcolor{blue}{\blacktriangleleft_\wsym}}
\newcommand{\evalphs}{\textcolor{orange}{\blacktriangleright_\ssym}}
\newcommand{\evalphun}{\textcolor{blue}{\blacktriangledown_*}}
\newcommand{\backph}{\textcolor{red}{\blacktriangle_\bsym}}
\newcommand{\backphr}{\textcolor{red}{\blacktriangleleft_\bsym}}
\newcommand{\backphl}{\textcolor{red}{\blacktriangleleft_\bsym}}
\newcommand{\backphup}{\textcolor{green}{\blacktriangle}}
\newcommand{\backphw}{\textcolor{red}{\blacktriangle_\wsym}}
\newcommand{\backphs}{\textcolor{red}{\blacktriangle_\ssym}}
\newcommand{\backphun}{\textcolor{red}{\blacktriangle_*}}



\newcommand{\compatible}{\propto}
\newcommand{\skap}[2]{(#1,#2)}
\newcommand{\sktr}[3]{(#1,#2,#3)}
\newcommand{\skframe}{F}
\newcommand{\skframetail}{\skframe_{\mathrm t}}
\newcommand{\skframeweak}{\skframe_{\mathrm w}}
\newcommand{\skframeweaktwo}{\skframetwo_{\mathrm w}}
\newcommand{\skframetrunk}{\skframe_{\mathrm t}}
\newcommand{\skframetrunktwo}{\skframetwo_{\mathrm t}}
\newcommand{\skframetwo}{\skframe'}
\newcommand{\skframethree}{\skframe''}
\newcommand{\skframefour}{\skframe'''}
\newcommand{\skboundvar}{\skeval}
%\newcommand{\skerased}{\triangleleft}
\newcommand{\openscope}{\skeval}
\newcommand{\openscopem}[1]{\skeval #1}
\newcommand{\closescope}{\skback}
\newcommand{\closescopem}[1]{\skback#1}
\newcommand{\skphase}{\varphi}
\newcommand{\skaframe}{A}
\newcommand{\genvsub}{S}

\newcommand{\varset}{\vartheta}
\newcommand{\sknf}{n}
\newcommand{\skneut}{u}
\newcommand{\skvalue}{v}
\newcommand{\skvalueof}[1]{\skvalue^{#1}}
\newcommand{\skvalueT}{\skvalueof{\varset}}
\newcommand{\skstructure}{s}
\newcommand{\skstructureof}[1]{\skstructure^{#1}}
\newcommand{\skstructureT}{\skstructureof{\varset}}
\newcommand{\skl}{\Lambda}
\newcommand{\sklp}[1]{\Lambda(#1)}


\newcommand{\skammachine}{Strong MAM\xspace}
\newcommand{\rmeasure}[1]{\size{#1}}
\newcommand{\fmeasure}[1]{\mathbf{m}_{\skback}(#1)}
\newcommand{\numof}[1]{\#_{#1}}

\newcommand\scalemath[2]{\medskip\scalebox{#1}{\mbox{\ensuremath{\displaystyle #2}}}\medskip}

\newcommand{\TODO}[1]{\textcolor{red}{#1}}

\newcommand{\structural}{head\xspace}
\newcommand{\tail}{tail\xspace}
\newcommand{\substitutive}{balanced\xspace}
\newcommand{\wellformed}{well-formed\xspace}

\newcommand{\genvbal}{B}

\newcommand{\decodecompat}[2]{\decode{(#1,#2)}}
\newcommand{\decodetr}[3]{\decode{(#1,#2,#3)}}



\newcommand{\skevctx}{C}
\newcommand{\skevctxtwo}{\skevctx'}
\newcommand{\skevctxthree}{\skevctx''}
\newcommand{\skevctxp}[1]{\skevctx\ctxholep{#1}}
\newcommand{\skevctxtwop}[1]{\skevctxtwo\ctxholep{#1}}
\newcommand{\skevctxthreep}[1]{\skevctxthree\ctxholep{#1}}
\newcommand{\skisleft}{\ \textsf{\textup{left}}}

\newcommand{\tosubx}{\to_{\mathtt{x}}}

\newcommand{\sizecomev}[1]{|#1|_{\skeval \csym}}
\newcommand{\sizecombt}[1]{|#1|_{\skback \csym}}
\newcommand{\polsize}[2]{|#1|_{#2}}

\newcommand{\withproofs}[1]{\ifthenelse{\boolean{withproofs}}{#1}{}}

\newcommand{\withoutproofs}[1]{\ifthenelse{\boolean{withproofs}}{}{#1}}


% shallow contexts
\newcommand{\shctx}{S}
\newcommand{\shctxtwo}{\shctx'}
\newcommand{\shctxthree}{\shctx''}
\newcommand{\shctxfour}{\shctx'''}
\newcommand{\shctxp}[1]{\shctx\ctxholep{#1}}
\newcommand{\shctxtwop}[1]{\shctxtwo\ctxholep{#1}}
\newcommand{\shctxthreep}[1]{\shctxthree\ctxholep{#1}}
\newcommand{\shctxfourp}[1]{\shctxfour\ctxholep{#1}}




%%%%%%% Separating Fireballs %%%%%%%%

\newcommand{\alphaeq}{=_\alpha}



%%%%%%% CBV and Open Terms %%%%%%%%

\newcommand{\SN}[1]{\mathtt{SN}_{#1}}

%%%%%%% Rimandi in appendice %%%%%%%%%
% \newcommand{\NoteProof}[1]{\marginpar{\scriptsize \ Proof in Appendix, p.\,{\pageref{#1}}}} %Giulio
% \newcommand{\NoteState}[1]{\marginpar{\scriptsize \ Stated at p.~{\pageref{#1}}}} %Giulio
\newcommand{\NoteProof}[1]{\withproofs{\marginpar{\scriptsize \ \ Proof p.\,{\pageref{#1}}}}} %Giulio
% \renewcommand{\NoteProof}[1]{} % Ben
\newcommand{\NoteState}[1]{\withproofs{\marginpar{\scriptsize \ \ See p.~{\pageref{#1}}}}} %Giulio
% \renewcommand{\NoteState}[1]{} % Ben

\newcommand{\indsub}[1]{\sigma_{#1}}
%\newcommand{\undef}{\bot}
\newcommand{\ecnf}[1]{\mathtt{nf}_{\esym\admsym}(#1)}
\newcommand{\vsubterms}{\Lambda_\vsub}
\newcommand{\vsubkterms}{\Lambda_{\vsubk}} %Giulio

%\newcommand{\fire}{\mathtt{fire}}
\newcommand{\vsubcalc}{\lambda_\vsub}
\newcommand{\vsubkcalc}{\lambda_{\vsubk}}
\newcommand{\vsubkmcalc}{\lambda_{\vsubkm}}
\newcommand{\firecalc}{\lambda_\mathsf{fire}}
\newcommand{\sfirecalc}{\mathsf{Split }\lambda_\mathsf{fire}}
\newcommand{\shufcalc}{\lambda_\shuf}
\newcommand{\shufcalcm}{\lambda_\bilancia{\shuf}}
\newcommand{\plotcalc}{\lambda_\mathsf{Plot}}
\newcommand{\vseqsym}{\mathsf{vseq}}
\newcommand{\vseqcalc}{\lambda_{\vseqsym}}

\newcommand{\proper}{clean\xspace}
\newcommand{\Proper}{Clean\xspace}
\newcommand{\harmless}{harmless\xspace}
\newcommand{\Harmless}{Harmless\xspace}

\newcommand{\quiet}{inert\xspace}
\newcommand{\Quiet}{Inert\xspace}
\newcommand{\qterm}{q}
\newcommand{\qtermtwo}{\qterm'}
\newcommand{\qtermthree}{\qterm''}

%\newcommand{\doubt}[1]{\gray{#1}}
\newcommand{\doubt}[1]{}

\newcommand{\fireth}{\simeq_{\betaf}}
\newcommand{\vsubth}{\simeq_{\vsub}}
\newcommand{\vsubeqth}{\simeq_{\vsubeq}}

\newcommand{\shufth}{\simeq_{\shuf}}
\newcommand{\shufextth}{\shufth^\mathsf{ext}}

\newcommand{\letexp}{\mathtt{let}}

\newcommand{\stabs}{S}
\newcommand{\stabstwo}{\stabs'}
\newcommand{\stabsthree}{\stabs''}
\newcommand{\stabsfour}{\stabs'''}
\newcommand{\decstabs}{\decode{\stabs}} %Giulio
\newcommand{\decstabspx}[2]{\decodep{#1}{#2}} %Giulio
\newcommand{\decstabsp}[1]{\decstabspx\stabs{#1}} %Giulio
\newcommand{\decstabstwop}[1]{\decstabspx\stabstwo{#1}} %Giulio

\newcommand{\dvar}[2]{(#1,#2)}


%%%%%%%%%%%% Lambdabar-mutilde-calculus
\newcommand{\lambdamucalc}{\lambdabar\tilde{\mu}}
\newcommand{\lbarmui}{\lambdamucalc_J}
\newcommand{\cm}{c}
\newcommand{\cmp}{\cm'}
\newcommand{\cmtwo}{\cm'}
\newcommand{\cmthree}{\cm''}
\newcommand{\cmfour}{\cm'''}
\newcommand{\comm}[2]{\langle #1 \!\mid\! #2 \rangle}
\newcommand{\lbar}[3]{\lambda (#1,#2). #3}
%\newcommand{\lambdabar}{\bar{\lambda}}
\newcommand{\mutildesym}{\tilde{\mu}}
\newcommand{\mut}{\tilde{\mu}}
\newcommand{\mutilde}[2]{\mutildesym #1.#2}
\newcommand{\stacker}[2]{#1 \! \cdot \! #2}
\newcommand{\append}[2]{#1  @  #2}
\newcommand{\envctx}{E}
\newcommand{\envctxp}[1]{\envctx\ctxholep{#1}}
\newcommand{\cmctx}{C}
\newcommand{\cmctxtwo}{\cmctx'}
\newcommand{\cmctxthree}{\cmctx''}
\newcommand{\cmctxp}[1]{\cmctx\ctxholep{#1}}
\newcommand{\cmctxtwop}[1]{\cmctxtwo\ctxholep{#1}}
\newcommand{\cmctxthreep}[1]{\cmctxthree\ctxholep{#1}}
\newcommand{\rtobvmu}{\rootRew{\betav\mu}}
\renewcommand{\rtobvmu}{\rootRew{\lambdabar}} % beniamino
\newcommand{\rtomut}{\rootRew{\tilde{\mu}}}
\newcommand{\tobvmu}{\Rew{\betav\mu}}
\renewcommand{\tobvmu}{\Rew{\lambdabar}} % beniamino
\newcommand{\tomut}{\Rew{\tilde{\mu}}}
\newcommand{\tolbarmut}{\Rew{\vseqsym}} %Giulio
\newcommand{\tovseq}{\Rew{\vseqsym}} %Giulio
\newcommand{\tovseqeq}{{\tovseq}_\seqbar} %Giulio
\newcommand{\vseq}{{\vseqsym}} %Giulio
\newcommand{\tolbarmuteq}{{\tolbarmut}_\seqbar} %Giulio
\newcommand{\isubtwo}[4]{\{#1\shortleftarrow #2, #3\shortleftarrow#4\}}
\newcommand{\transl}[2]{\underline{#1\bullet#2}}
\newcommand{\tolbarmu}[1]{\underline{#1}}
\newcommand{\tolbarmuv}[1]{#1^\bullet}
\newcommand{\cotransl}[1]{#1^\diamond}
\newcommand{\cotranslp}[2]{#1^\diamond\ctxholep{#2}}
\newcommand{\Rule}{\mathsf{r}}
\newcommand{\torule}{\to_\Rule}
\newcommand{\sizemut}[1]{\size{#1}_{\mut}}
\newcommand{\sizebvmu}[1]{\size{#1}_{\betav\mu}}
\newcommand{\sizelambdamu}[1]{\size{#1}_{\lambdamucalc}}
\newcommand{\sizevseq}[1]{\size{#1}_{\vseq}}
\newcommand{\sizelbar}[1]{\size{#1}_{\lambdabar}}

%\newenvironment{varitemize}{\begin{itemize}}{\end{itemize}}
\newenvironment{varitemize}
{
\begin{list}{\labelitemi}
{
% \setlength{\itemsep}{1pt}
%  \setlength{\topsep}{1pt}
%  \setlength{\parsep}{1pt}
%  \setlength{\partopsep}{1pt}
%  \setlength{\leftmargin}{15pt}
%  \setlength{\rightmargin}{0pt}
%  \setlength{\itemindent}{0pt}
%  \setlength{\labelsep}{5pt}
%  \setlength{\labelwidth}{10pt}
\setlength{\itemsep}{.7pt}
 \setlength{\topsep}{.7pt}
 \setlength{\parsep}{.7pt}
 \setlength{\partopsep}{.7pt}
 \setlength{\leftmargin}{15pt}
 \setlength{\rightmargin}{0pt}
 \setlength{\itemindent}{0pt}
 \setlength{\labelsep}{5pt}
 \setlength{\labelwidth}{15pt}
}}
{
 \end{list} 
}

\newcounter{numberone}
\newcounter{numberoneroman}
\newcounter{numberonealph}

%\newenvironment{varenumerate}{\begin{enumerate}}{\end{enumerate}}
\newenvironment{varenumerate}
{
\begin{list}{\arabic{numberone}.}
{
 \usecounter{numberone}
 \setlength{\itemsep}{.7pt}
 \setlength{\topsep}{.7pt}
 \setlength{\parsep}{.7pt}
 \setlength{\partopsep}{.7pt}
 \setlength{\leftmargin}{15pt}
 \setlength{\rightmargin}{0pt}
 \setlength{\itemindent}{0pt}
 \setlength{\labelsep}{5pt}
 \setlength{\labelwidth}{15pt}
}}
{
\end{list} 
}

\newenvironment{varenumerateroman}
{
\begin{list}{\roman{numberoneroman}.}
{
 \usecounter{numberoneroman}
 \setlength{\itemsep}{.7pt}
 \setlength{\topsep}{.7pt}
 \setlength{\parsep}{.7pt}
 \setlength{\partopsep}{.7pt}
 \setlength{\leftmargin}{15pt}
 \setlength{\rightmargin}{0pt}
 \setlength{\itemindent}{0pt}
 \setlength{\labelsep}{5pt}
 \setlength{\labelwidth}{15pt}
}}
{
\end{list} 
}

\newenvironment{varenumeratealph}
{
\begin{list}{\alph{numberonealph}.}
{
 \usecounter{numberonealph}
 \setlength{\itemsep}{.7pt}
 \setlength{\topsep}{.7pt}
 \setlength{\parsep}{.7pt}
 \setlength{\partopsep}{.7pt}
 \setlength{\leftmargin}{15pt}
 \setlength{\rightmargin}{0pt}
 \setlength{\itemindent}{0pt}
 \setlength{\labelsep}{5pt}
 \setlength{\labelwidth}{15pt}
}}
{
\end{list} 
}


\newcommand{\csub}[2]{\{\!\{#1{\shortleftarrow}#2\}\!\}}

\newcommand{\ceval}{\csym_{\textcolor{blue}{\wsym}}}
\newcommand{\csearch}{\csym_{\textcolor{orange}{\ssym}}}
\newcommand{\cback}{\csym_{\textcolor{red}{\bsym}}}
\newcommand{\cnoteval}{\csym_{\textcolor{orange}{\ssym},\textcolor{red}{\bsym}}}


\newcommand{\tomachuphole}[2]{\stackrel{#1}{\leadsto}_{#2}}
\newcommand{\absset}[2]{\lambda_{#1}(#2)}
\newcommand{\vsubk}{\vsub_{k}}
\newcommand{\vsubkm}{\vsubk^\bullet}
\newcommand{\vsubtoker}[1]{#1^+}
\newcommand{\kertovsub}[1]{#1^-}
\newcommand{\esubm}[2]{[#1{\shortleftarrow}#2]^\bullet}
\newcommand{\esubun}[2]{[#1{\shortleftarrow}#2]^\circ}
\newcommand{\tolab}{\Rew{\llbracket\rrbracket}}
\newcommand{\rtolab}{\rootRew{\llbracket\rrbracket}}

\newcommand{\cbn}{CbN\xspace}
\newcommand{\cbv}{CbV\xspace}
\newcommand{\ocbv}{Open \cbv}
\newcommand{\ccbv}{Closed \cbv}
\newcommand{\scbv}{Strong \cbv}

\newcommand{\compil}[1]{#1^\circ}
\newcommand{\sizebeta}[1]{\size{#1}_\beta}
\newcommand{\tostrat}{\rightarrow}
\newcommand{\tomachine}{\tomachhole\mach}

\newcommand{\ephm}[1]{\emph{#1}}

% programs
\newcommand{\prog}{p}
\newcommand{\progtwo}{q}
\newcommand{\progthree}{r}
\newcommand{\progp}{\prog'}
\newcommand{\progtwop}{\progtwo'}
\newcommand{\progthreep}{\progthree'}


\newcommand{\expr}{e}
\newcommand{\exprtwo}{\expr'}
\newcommand{\mset}[1]{[#1]}
%\newcommand{\emptymset}{\mset{\,}}
\newcommand{\emptymset}{\zero}

% positive types
\newcommand{\ptype}{M}
\newcommand{\ptypetwo}{N}
\newcommand{\ptypethree}{O}
\newcommand{\zero}{\mathbf{0}}

% negative types
\newcommand{\ntype}{L}
\newcommand{\ntypetwo}{\ntype'}
\newcommand{\ntypethree}{\ntype''}

% positive types
\newcommand{\iptype}{M^i}
\newcommand{\iptypetwo}{N^i}
\newcommand{\iptypethree}{O^i}

% negative types
\newcommand{\intype}{L^i}
\newcommand{\intypetwo}{\intype}
\newcommand{\intypethree}{\intype}


% type contexts
\newcommand{\typctx}{\Gamma}
\newcommand{\typctxtwo}{\Delta}
\newcommand{\typctxthree}{\Pi}

% type derivation
\newcommand{\tder}{\pi}
\newcommand{\tdertwo}{\sigma}
\newcommand{\tderthree}{\rho}

\newcommand{\ruleAp}{@}
\newcommand{\ruleAx}{\mathsf{ax}}

\newcommand{\appendOp}{@}
\newcommand{\hastype}{\!:\!}


\newcommand{\domain}[1]{\mathsf{dom}(#1)}
\newcommand{\typelist}[1]{\underline{#1}}

\newcommand{\splitc}{split\xspace}
\newcommand{\Splitc}{Split\xspace}

\newcommand{\tofoc}{\Rew{foc}}

%\newcommand{\ssym}{\mathsf{s}}
\newcommand{\sitm}{\itm_{\ssym}}
\newcommand{\sitmtwo}{\itmtwo_{\ssym}}
\renewcommand{\sfire}{\fire_{\ssym}}
\newcommand{\sval}{\val_{\ssym}}

\makeatletter
\newsavebox{\@brx}
\newcommand{\llangle}[1][]{\savebox{\@brx}{\(\m@th{#1\langle}\)}%
  \mathopen{\copy\@brx\kern-0.7\wd\@brx\usebox{\@brx}}}
\newcommand{\rrangle}[1][]{\savebox{\@brx}{\(\m@th{#1\rangle}\)}%
  \mathclose{\copy\@brx\kern-0.7\wd\@brx\usebox{\@brx}}}
\makeatother

\newcommand{\ctxholefp}[1]{\llangle #1\rrangle}
\newcommand{\ctxholef}{\ctxholefp{\cdot}}
\newcommand{\ctxfp}[1]{\ctx\ctxholefp{#1}}
\newcommand{\ctxtwofp}[1]{\ctxtwo\ctxholefp{#1}}
\newcommand{\ctxthreefp}[1]{\ctxthree\ctxholefp{#1}}
\newcommand{\ctxfourfp}[1]{\ctxfour\ctxholefp{#1}}

\newcommand{\symfont}[1]{\mathtt{#1}}
\newcommand{\lassensym}{\symfont{las}}
\newcommand{\vscsym}{\symfont{vsc}}
\newcommand{\rtob}{\rootRew{\beta}}
\newcommand{\rtolas}{\rootRew{\lassensym}}
\newcommand{\tolas}{\Rew{\lassensym}} %Adrienne
%\newcommand{\bslas}[1]{\Downarrow^{#1}}
%\newcommand{\bslass}{\Downarrow} %%Adrienne
%\newcommand{\bslasdiv}{\not\Downarrow} %% Adrienne

\newcommand{\ntm}{n}
\newcommand{\ntmtwo}{\ntm'}
\newcommand{\ntmthree}{\ntm''}
\newcommand{\ntmfour}{\ntm'''}


\newcommand{\bslasax}{{\Downarrow}\textsc{-ax}}
\newcommand{\bslasapm}{{\Downarrow}\textsc{-@m}}
\newcommand{\bslasapi}{{\Downarrow}\textsc{-@i}}
\newcommand{\bslasapvar}{{\Downarrow}\textsc{-@}\var}
\newcommand{\bslasese}{{\Downarrow}\textsc{-[e]}}\newcommand{\bslasesi}{{\Downarrow}\textsc{-[i]}}

\newcommand{\bsvscpax}{{\Downarrow}\textsc{-ax}}
\newcommand{\bsvscpapm}{{\Downarrow}\textsc{-@m}}
\newcommand{\bsvscpapi}{{\Downarrow}\textsc{-@i}}
\newcommand{\bsvscpapvar}{{\Downarrow}\textsc{-@}\var}
\newcommand{\bsvscpese}{{\Downarrow}\textsc{-[e]}}\newcommand{\bsvscpesi}{{\Downarrow}\textsc{-[i]}}

\newcommand{\bsvsctax}{{\Downarrow}\textsc{-ax}}
\newcommand{\bsvsctapm}{{\Downarrow}\textsc{-@m}}
\newcommand{\bsvsctapi}{{\Downarrow}\textsc{-@i}}
\newcommand{\bsvsctapvar}{{\Downarrow}\textsc{-@}\var}
\newcommand{\bsvsctese}{{\Downarrow}\textsc{-[e]}}\newcommand{\bsvsctesi}{{\Downarrow}\textsc{-[i]}}

\newcommand{\bsvscax}{{\Downarrow}\textsc{-ax}}
\newcommand{\bsvscapm}{{\Downarrow}\textsc{-@m}}
\newcommand{\bsvscapi}{{\Downarrow}\textsc{-@i}}
\newcommand{\bsvscapvar}{{\Downarrow}\textsc{-@}\var}
\newcommand{\bsvscese}{{\Downarrow}\textsc{-[e]}}
\newcommand{\bsvscesi}{{\Downarrow}\textsc{-[i]}}

\newcommand{\ntmONE}{n_1}
\newcommand{\ntmONEtwo}{\ntmONE'}
\newcommand{\ntmONEthree}{\ntmONE''}
\newcommand{\ntmONEfour}{\ntmONE'''}
\newcommand{\ntmTWO}{n_2}
\newcommand{\ntmTWOtwo}{\ntmTWO'}
\newcommand{\ntmTWOthree}{\ntmTWO''}
\newcommand{\ntmTWOfour}{\ntmTWO'''}
\newcommand{\ntmof}[1]{\ntm_#1}

\newcommand{\lctx}{L}
\newcommand{\lctxtwo}{\lctx'}
\newcommand{\lctxthree}{\lctx''}
\newcommand{\lctxp}[1]{\lctx\ctxholep{#1}}
\newcommand{\lctxtwop}[1]{\lctxtwo\ctxholep{#1}}
\newcommand{\lctxthreep}[1]{\lctxthree\ctxholep{#1}}


\newcommand{\rctx}{R}
\newcommand{\rctxtwo}{\rctx'}
\newcommand{\rctxthree}{\rctx''}
\newcommand{\rctxp}[1]{\rctx\ctxholep{#1}}
\newcommand{\rctxtwop}[1]{\rctxtwo\ctxholep{#1}}
\newcommand{\rctxthreep}[1]{\rctxthree\ctxholep{#1}}


\newcommand{\tolw}{\Rew{l}}
\newcommand{\torw}{\Rew{r}}

\newcommand{\Id}{\symfont{I}}


\newcommand{\letin}[3]{{\sf let}\ #1=#2\ {\sf in}\ #3}

\renewcommand{\fire}{\ntm}
\renewcommand{\firetwo}{\ntmtwo}



\newcommand{\cal}[1]{\mathcal{#1}}
\newcommand{\relsym}{{\cal R}}
%\newcommand{\rel}{\, \relsym\, }
\newcommand{\rel}{~\relsym~}
\newcommand{\lassenop}[1]{{#1}^{\cal L}}
\newcommand{\howeop}[1]{{#1}^{\cal H}}
\newcommand{\reltwosym}{{\cal R'}}
\newcommand{\reltwo}{~\reltwosym~}

\newcommand{\lasrelsym}{\lassenop\relsym  }
\newcommand{\lasrel}{\, \lasrelsym\,  }

\newcommand{\mlassenopsym}{{\cal L}^M}
\newcommand{\mlassenop}[1]{{#1}^{\mlassenopsym}}
\newcommand{\mlasrelsym}{\mlassenop\relsym  }
\newcommand{\mlasrel}{\, \mlasrelsym\,  }

\newcommand{\fsimsym}{{\cal S}}
\newcommand{\fsim}{\, \fsimsym\, }
\newcommand{\fsimsymtwo}{{\cal S'}}
\newcommand{\fsimtwo}{\, \fsimsymtwo\, }
\newcommand{\fsimy}{\preceq_\osym}
\newcommand{\lasfsim}{\, \lassenop\fsimsym\,  }

\newcommand{\lasrule}[1]{($\lassenop{(\cdot)}$-#1)\xspace}
\newcommand{\lasruleinj}{\lasrule{inj}}
\newcommand{\lasrulevar}{\lasrule{var}}
\newcommand{\lasruleabs}{\lasrule{abs}}
\newcommand{\lasruleap}{\lasrule{@}}
\newcommand{\lasrulees}{\lasrule{ES}}
\newcommand{\lasrulesub}{\lasrule{sub}}
\newcommand{\lasruleprojleft}{\lasrule{proj}}
\newcommand{\lasrulestreq}{\lasrule{str-eq}}

\newcommand{\compose}{\circ}

\newcommand{\bstepmute}{\Downarrow}
\newcommand{\bstep}[1]{\bstepmute_{#1}}

\newcommand{\bsteprule}[1]{($\bstepmute$-#1)\xspace}
\newcommand{\bstepruleval}{\bsteprule{value}}
\newcommand{\bstepruleexp}{\bsteprule{exp}}
\newcommand{\bstepruleestep}{\bsteprule{$\esym$-step}}
\newcommand{\bsteprulemstep}{\bsteprule{$\msym$-step}}
\newcommand{\bstepruleinert}{\bsteprule{Inert-@}}
\newcommand{\bstepruleesclos}{\bsteprule{Inert-ES}}

\newcommand{\nind}{n}
\newcommand{\nindtwo}{m}
\newcommand{\nindthree}{o}
\newcommand{\nindfour}{p}



\newcommand{\fbis}{\, R\, }
\newcommand{\fbisy}{\sime_\fsym}
\newcommand{\setside}[2]{\{#1 \, | \, #2\}}
%%\renewcommand{\isctx}{I}

\renewcommand{\gconst}{i}

\renewcommand{\indsub}[1]{\sigma_{#1}}

\newcommand{\supp}[1]{|#1|}
\newcommand{\nfext}[1]{\,\langle#1\rangle_{\tt nf}\, }

%%%%%%%%%%%%CLAUDIA%%%%%%
%% sub-reduction contexts %Claudia
\newcommand{\ievctx}{S}
%\newcommand{hole}[1]{\ctxholep {1}}
%\newcommand{\isctxp}[1]{\isctx\ctxholep{#1}}
\newcommand{\ievctxp}[1]{\ievctx\ctxholep{#1}}
\newcommand{\subred}{\textsc{s}}
\newcommand{\rtos}{\rootRew{\subred}} 
\newcommand{\tos}{\Rew{\subred}} 

\usepackage{proof}
%\newcommand{\add}[2]{#1 \cons #2 }
\newcommand{\add}[2]{#1 + #2 }
\newcommand{\EE}{\genv}
\newcommand{\FF}{F}
\newcommand{\CC}{\ctx}
\newcommand{\eenv}{\emptyenv}
\newcommand{\tmf}{\fire}
\newcommand{\tmr}{r}
\newcommand{\tms}{s}
\newcommand{\tmu}{u}
\newcommand{\tmn}{n}
\newcommand{\tp}{p}
\newcommand{\tmq}{q}

\newcommand{\red}[1]{\rightarrow}
\newcommand{\redx}[1]{\rightarrow_{#1}}

\newcommand{\pair}[2]{#1;#2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newcommand{\rels}{\preceq}
%\newcommand{\rels}{~\rel~}
%\newcommand{\relsc}{~ \rel\!^{\mathsf{SC}} ~}
\newcommand{\relscsym}{\overline\relsym}
\newcommand{\relsc}{~\relscsym~}
\newcommand{\relnf}[1]{~#1_{\textsc{nf}}~}
\newcommand{\relf}[1]{~#1_{\textsc{f}}~}
\newcommand{\relb}[1]{~#1_{\textsc{b}}~}

\newcommand{\wnf}{\texttt{wnf}}

\newcommand{\lift}[1]{#1^{\uparrow}}
\newcommand{\FV}[1]{\mathsf{FV}(#1)}
%\newcommand{\E}[1]{\EE^{#1}}
\newcommand{\bagext}[2]{{#1}^{#2}}
\newcommand{\nwsym}{\neg\wsym}
\newcommand{\rinj}{\relscsym\mbox{-}\textsc{inj}}
\newcommand{\rvar}{\relscsym\mbox{-}\textsc{var}}
\newcommand{\rlam}{\relscsym\mbox{-}\textsc{lam}}
\newcommand{\rapp}{\relscsym\mbox{-}\textsc{app}}
\newcommand{\rsub}{\relscsym\mbox{-}\textsc{sub}}
\newcommand{\rsubv}{\relscsym\mbox{-}\textsc{sub}_{\val}}
\newcommand{\rsubi}{\relscsym\mbox{-}\textsc{sub}_{\itm}}
%\newcommand{\rsubinw}{\relscsym\mbox{-}\textsc{sub}_{\nwsym}}
%\newcommand{\rsubiw}{\relscsym\mbox{-}\textsc{sub}_{\wsym}}
\renewcommand{\rbag}{\relscsym\mbox{-}\textsc{bag}}


%% Adrienne
\newcommand{\naft}{\mathit{naf}}
\newcommand{\enft}{\mathit{enf}}
\newcommand{\renft}{\mathit{renf}}

\newcommand{\nafet}{\mathit{nafex}}
\newcommand{\nafext}{\mathit{vscx}}
\newcommand{\esenft}{\mathit{ES-enf}}
\newcommand{\wenft}{\mathit{wenf}}
\newcommand{\wpnft}{\mathit{wpnf}}

\newcommand{\openfp}[1]{\ctxholep{#1}_{\enft}}
\newcommand{\openf}{\ctxhole_{\enft}}
\newcommand{\relenf}{\openfp\relsym}
\newcommand{\lasrelenfsym}{\openfp\lasrelsym}
\newcommand{\lasrelenf}{\, \lasrelenfsym \,}
\newcommand{\isubst}[2]{\isub#2#1}

\newcommand{\enfbt}{\mathit{enf-b}}
\newcommand{\openfbp}[1]{\ctxholep{#1}_{\enfbt}}
\newcommand{\openfb}{\ctxhole_{\enfbt}}
\newcommand{\relenfb}{\openfbp\relsym}

\newcommand{\opnafp}[1]{\ctxholep{#1}_{\naft}}
\newcommand{\opnaf}{\ctxhole_{\naft}}
\newcommand{\relnaf}{\opnafp\relsym}
\newcommand{\lasrelnafsym}{\opnafp\lasrelsym}
\newcommand{\lasrelnaf}{\, \lasrelnafsym \,}

\newcommand{\nafbt}{\mathit{naf-b}}
\newcommand{\opnafbp}[1]{\ctxholep{#1}_{\nafbt}}
\newcommand{\opnafb}{\ctxhole_{\nafbt}}
\newcommand{\relnafb}{\opnafbp\relsym}

\newcommand{\nafebt}{\mathit{nafe-b}}
\newcommand{\opnafebp}[1]{\ctxholep{#1}_{\nafebt}}
\newcommand{\opnafeb}{\ctxhole_{\nafebt}}
\newcommand{\relnafeb}{\opnafebp\relsym}

\newcommand{\opnafep}[1]{\ctxholep{#1}_{\nafet}}
\newcommand{\opnafe}{\ctxhole_{\nafet}}
\newcommand{\relnafe}{\opnafep\relsym}
\newcommand{\lasrelnafesym}{\opnafep\lasrelsym}
\newcommand{\lasrelnafe}{\, \lasrelnafesym \,}

\newcommand{\opnafexp}[1]{\ctxholep{#1}_{\nafext}}
\newcommand{\opnafex}{\ctxhole_{\nafext}}
\newcommand{\relnafex}{\opnafexp\relsym}
\newcommand{\lasrelnafexsym}{\opnafexp\lasrelsym}
\newcommand{\lasrelnafex}{\, \lasrelnafexsym \,}


\newcommand{\mlasrelnafexsym}{\opnafexp\mlasrelsym}
\newcommand{\mlasrelnafex}{\, \lasrelnafexsym \,}

\newcommand{\nafextp}[1]{\mathit{nafe-#1}}

\newcommand{\opnafexxp}[2]{\ctxholep{#1}_{\nafextp{#2}]}}
\newcommand{\opnafexx}[1]{\ctxhole_{\nafextp#1}}
\newcommand{\relnafexx}[1]{\opnafexxp\relsym#1}
\newcommand{\lasrelnafexxsym}[1]{\opnafexxp\lasrelsym#1}
\newcommand{\lasrelnafexx}[1]{\, \lasrelnafexxsym#1 \,}

\newcommand{\opsufp}[1]{\ctxholep{#1}_{suf}}
\newcommand{\opsuf}{\ctxhole_{suf}}
\newcommand{\relsuf}{\opsufp\relsym}
\newcommand{\lasrelsufsym}{\opsufp\lasrelsym}
\newcommand{\lasrelsuf}{\, \lasrelsufsym \,}

\newcommand{\opesenfp}[1]{\ctxholep{#1}_{\esenft}}
\newcommand{\opesenf}{\ctxhole_{\esenft}}
\newcommand{\relesenf}{\opesenfp\relsym}
\newcommand{\lasrelesenfsym}{\opesenfp\lasrelsym}
\newcommand{\lasrelesenf}{\, \lasrelesenfsym \,}

\newcommand{\opwenfp}[1]{\ctxholep{#1}_{\wenft}}
\newcommand{\opwenf}{\ctxhole_{\wenft}}
\newcommand{\relwenf}{\opwenfp\relsym}
\newcommand{\lasrelwenfsym}{\opwenfp\lasrelsym}
\newcommand{\lasrelwenf}{\, \lasrelwenfsym \,}

\newcommand{\opwpnfp}[1]{\ctxholep{#1}_{\wpnft}}
\newcommand{\opwpnf}{\ctxhole_{\wpnft}}
\newcommand{\relwpnf}{\opwpnfp\relsym}
\newcommand{\lasrelwpnfsym}{\opwpnfp\lasrelsym}
\newcommand{\lasrelwpnf}{\, \lasrelwpnfsym \,}


\newcommand{\enfbisim}{\simeq_{\enft}}
\newcommand{\nafbisim}{\simeq_{\naft}}
\newcommand{\nafebisim}{\simeq_{\nafet}}
\newcommand{\sufbisim}{\simeq_{suf}}
\newcommand{\wenfbisim}{\simeq_{\wenft}}
\newcommand{\esenfbisim}{\simeq_{\esenft}}
\newcommand{\wpnfbisim}{\simeq_{\wpnft}}

\newcommand{\enfsim}{\le_{\enft}}
\newcommand{\nafsim}{\le_{\naft}}
\newcommand{\sufsim}{\le_{suf}}
\newcommand{\esenfsim}{\le_{\esenft}}

\newcommand{\toetav}{\Rew{\eta_v}}
\newcommand{\tovsce}{\Rew{\equivsone}}

%\newcommand{\bsvsc}{\bslass_{vsc}}
%\newcommand{\bslam}{\bslass_{\lambda}}

\newcommand{\equivsone}{\equiv_{\sigma_1}}
\newcommand{\equivsthree}{\equiv_{\sigma_3}}
\newcommand{\equivexsthree}{\equiv_{ex\sigma_3}}
\newcommand{\equivsthreeb}{\equiv_{\sigma_{3'}}}
\newcommand{\equivcom}{\equiv_{{\mathtt{com}}}}
\newcommand{\equivs}{\equiv_{\sigma_3 / \mathtt{com}}}
\newcommand{\equivx}{\equiv_{M}}
\newcommand{\equivlid}{\equiv_{lid}}
\newcommand{\equivass}{\equiv_{ass}}
\newcommand{\equivrad}{\equiv_{rad}}
\newcommand{\equivlad}{\equiv_{lad}}
\newcommand{\equivexrad}{\equiv_{exrad}}
\newcommand{\equivscr}{\equiv_{vscr}}
\newcommand{\equivdup}{\equiv_{dup}}
\newcommand{\streq}{\equiv_{str}}

\newcommand{\rtosone}{\rootRew{\sigma_1}}
\newcommand{\tosone}{\Rew{\sigma_1}}
\newcommand{\rtosthree}{\rootRew{\sigma_3}}
\newcommand{\tosthree}{\Rew{\sigma_3}}

\newcommand{\tosoneorthree}{\Rew{\sigma_{1/3}}}

\newcommand{\atm}{a}
\newcommand{\atmtwo}{\atm'}

%% Weak i-th contexts
\newcommand{\weaknormalcontextsym}{\mathcal{W}}
\newcommand{\weaknormalcontextsymtwo}{\mathcal{W'}}

\newcommand{\wnisctx}[1]{\weaknormalcontextsym_{=#1}}
\newcommand{\wnisctxtwo}[1]{\weaknormalcontextsymtwo_{=#1}}

\newcommand{\wnisctxp}[2]{\wnisctx{#1}\ctxholep{#2}}
\newcommand{\wnisctxtwop}[2]{\wnisctxtwo{#1}\ctxholep{#2}}

\newcommand{\wnictx}[1]{\weaknormalcontextsym_{\rightarrow#1}}
\newcommand{\wnictxtwo}[1]{\weaknormalcontextsymtwo_{\rightarrow#1}}

\newcommand{\wnictxp}[2]{\wnictx{#1}\ctxholep{#2}}
\newcommand{\wnictxtwop}[2]{\wnictxtwo{#1}\ctxholep{#2}}

%Weak normal contexts
\newcommand{\wnctx}{\weaknormalcontextsym}
\newcommand{\wnctxtwo}{\wnctx'}
\newcommand{\wnctxthree}{\wnctx''}
\newcommand{\wnctxp}[1]{\wnctx\ctxholep{#1}}
\newcommand{\wnctxtwop}[1]{\wnctxtwo\ctxholep{#1}}
\newcommand{\wnctxthreep}[1]{\wnctxthree\ctxholep{#1}}

\newcommand{\wnctxONE}{\weaknormalcontextsym_1}
\newcommand{\wnctxONEtwo}{\wnctxONE'}
\newcommand{\wnctxONEp}[1]{\wnctxONE\ctxholep{#1}}
\newcommand{\wnctxONEtwop}[1]{\wnctxONEtwo\ctxholep{#1}}

%Claudia

\newcommand{\true}{\mathtt{true}}
\newcommand{\false}{\mathtt{false}}

\newcommand{\R}{\relsym}

\newcommand{\Rnaf}{\relsym_{\naft}}
\newcommand{\Renf}{\relsym_{\enft}}

\newcommand{\leqcbn}{\precsim_{cbn}}
\newcommand{\eqcbn}{\simeq_{cbn}}
\newcommand{\leqncbv}{\precsim_{nai}}
\newcommand{\eqncbv}{\simeq_{nai}}
\newcommand{\leqenf}{\precsim_{\enft}}
\newcommand{\leqrenf}{\precsim_{\renft}}
\newcommand{\eqenf}{\simeq_{\enft}}
\newcommand{\leqnaf}{\precsim_{\naft}}
\newcommand{\leqnafe}{\precsim_{\nafet}}
\newcommand{\leqnafex}{\precsim_{\nafext}}
\newcommand{\eqnaf}{\simeq_{\naft}}
\newcommand{\eqnafex}{\simeq_{\nafext}}
\newcommand{\leqnafexx}[1]{\precsim_{\nafextp#1}}
\newcommand{\leqwenf}{\precsim_{\wenft}} %Adrienne
\newcommand{\leqwpnf}{\precsim_{\wpnft}} %Adrienne
\newcommand{\leqesenf}{\precsim_{\esenft}} %Adrienne
\newcommand{\tovsc}{\Rew{\vscsym}}
\newcommand{\toL}{\Rew{\textsc{l}}}
\newcommand{\tonL}{\Rew{\neg\textsc{l}}}

\newcommand{\howopsym}{{\cal H}}
\newcommand{\lassenopsym}{{\cal L}}
\newcommand{\sclift}{\lassenopsym_{\textsc{lift}}}
\newcommand{\scvar}{\lassenopsym_{\textsc{var}}}
\newcommand{\scabs}{\lassenopsym_{\l}}
\newcommand{\scapp}{\lassenopsym_{@}}
\newcommand{\scsub}{\lassenopsym_{\textsc{sub}}}
\newcommand{\scstuck}{\lassenopsym_{\textsc{stuck}}}
\newcommand{\scctx}{\lassenopsym_{\textsc{ctx-plug}}}
\newcommand{\scesub}{\lassenopsym_{\textsc{esub}}}
\newcommand{\scequivx}{\lassenopsym_{\equivx}}
\newcommand{\scequivxx}[1]{\lassenopsym_{\equiv_#1}}

\newcommand{\msclift}{\mlassenopsym_{\textsc{lift}}}
\newcommand{\mscvar}{\mlassenopsym_{\textsc{var}}}
\newcommand{\mscabs}{\mlassenopsym_{\l}}
\newcommand{\mscapp}{\mlassenopsym_{@}}
\newcommand{\mscesub}{\mlassenopsym_{\textsc{esub}}}
\newcommand{\mscsub}{\mlassenopsym_{\textsc{sub}}}
\newcommand{\mscequivx}{\mlassenopsym_{\equivx}}

\newcommand{\equivc}{\simeq_C}
\newcommand{\leqc}{\precsim_C}
\newcommand{\eqcv}{\simeq_C^v}
\newcommand{\leqcv}{\precsim_C^v}

\newcommand{\equivbohmtree}{\simeq_B}


%Curry and Turing fixed point combinator
\newcommand{\curryfix}{Y_v}
\newcommand{\curryfixaux}{\Xi_v}
\newcommand{\turingfix}{\Theta_v}

\newcommand{\curryfixn}{Y}
\newcommand{\curryfixauxn}{\Xi}
\newcommand{\turingfixn}{\Theta}


%Big steps systems
\newcommand{\VSCptxt}{VSCp\xspace}
\newcommand{\vscpsym}{\symfont{vscp}}
\newcommand{\vsctsym}{\symfont{vsc}_{\sigma_1}}
\newcommand{\lassym}{\symfont{las}}

\newcommand{\bssym}{\Downarrow} 
\newcommand{\bss}{\bssym\,}
\newcommand{\bs}[1]{\bssym^{#1}}
\newcommand{\bsdiv}{\not\bss} 

\newcommand{\bswh}{\Downarrow_{wh}\,} 
\newcommand{\bswhdiv}{\not\bswh} 

\newcommand{\bsweak}{\Downarrow_{w}\,} 
\newcommand{\bsweakdiv}{\not\bsweak} 

\newcommand{\bslassym}{\Downarrow_{\lassym}}
\newcommand{\bslass}{\bslassym\,}
\newcommand{\bslas}[1]{\bslassym^{#1}}
\newcommand{\bslasdiv}{\not\bslass} %% Adrienne

\newcommand{\bswsym}{\Downarrow_{\mathtt{w}}} 
\newcommand{\bsws}{\bswsym\,}
\newcommand{\bsw}[1]{\bswsym^{#1}}
\newcommand{\bswdiv}{\not\bsws} 

\newcommand{\bsvscpsym}{\Downarrow_{\vscpsym}}
\newcommand{\bsvscps}{\bsvscpsym\,}
\newcommand{\bsvscp}[1]{\bsvscpsym^{#1}}
\newcommand{\bsvscpdiv}{\not\bsvscps} 

\newcommand{\bsvsctsym}{\Downarrow_{\vsctsym}}
\newcommand{\bsvscts}{\bsvsctsym\,}
\newcommand{\bsvsct}[1]{\bsvsctsym^{#1}}
\newcommand{\bsvsctdiv}{\not\bsvscts} 

\newcommand{\bsvscsym}{\Downarrow_{\vscsym}}
\newcommand{\bsvscs}{\bsvscsym\,}
\newcommand{\bsvsc}[1]{\bsvscsym^{#1}}
\newcommand{\bsvscdiv}{\not\bsvscs} 

\newcommand{\tovscp}{\Rew{\vscpsym}}
\newcommand{\tovsct}{\Rew{\vsctsym}}


\newcommand{\VSC}{\text{VSC}\xspace}
\newcommand{\VSCmodulo}{\VSC_{\sigma_1}}

\newcommand{\toh}{\Rew{\symfont{h}}} 

\newcommand{\bohm}{B{\"o}hm }

%Macros for enf and naf text

\renewcommand{\enf}{$\mathsf{enf}$\xspace}
\newcommand{\Enf}{$\mathsf{Enf}$\xspace}
\newcommand{\eagernfbisimulation}{eager normal form bisimulation\xspace}
\newcommand{\eagernfbisimulations}{eager normal form bisimulations\xspace}
\newcommand{\eagernfbisimilarity}{eager normal form bisimilarity\xspace}
\newcommand{\eagernfbisimilar}{eager normal form bisimilar\xspace}

\newcommand{\naf}{$\mathsf{naf}$\xspace}
\newcommand{\Naf}{$\mathsf{Naf}$\xspace}

\newcommand{\nafbisimulation}{weak practical normal form bisimulation\xspace}
\newcommand{\nafbisimulations}{weak practical normal form bisimulations\xspace}
\newcommand{\nafbisimilarity}{weak practical normal form bisimilarity\xspace}
\newcommand{\nafbisimilar}{weak practically normal form bisimilar\xspace}

\newcommand{\nafe}{$\mathsf{nafex}$\xspace}
\newcommand{\Nafe}{$\mathsf{Nafex}$\xspace}


\newcommand{\nafebisimulation}{weak normal form bisimulation\xspace}
\newcommand{\nafebisimulations}{weak normal form bisimulations\xspace}
\newcommand{\nafebisimilarity}{weak normal form bisimilarity\xspace}
\newcommand{\nafebisimilar}{weak normal form bisimilar\xspace}


\newcommand{\nafex}{$\mathsf{nafex}$\xspace}
\newcommand{\Nafex}{$\mathsf{Nafex}$\xspace}


\newcommand{\nafexbisimulation}{weak structural normal form bisimulation\xspace}
\newcommand{\nafexbisimulations}{weak structural normal form bisimulations\xspace}
\newcommand{\nafexbisimilarity}{weak structural normal form bisimilarity\xspace}
\newcommand{\nafexbisimilar}{weak structurally normal form bisimilar\xspace}

\newcommand{\omegaleft}{\Omega_{L}}
\newcommand{\omegaright}{\Omega_{R}}


\newcommand{\equivetav}{\equiv_{\eta_v}}
\newcommand{\equivbetav}{=_{\betav}}

% Glue rule

\newcommand{\rtoglue}{\rootRew{\symfont{glue}}}
\newcommand{\toglue}{\Rew{\symfont{glue}}}

\newcommand{\cbnfp}[1]{\ctxholep{#1}_{cbn}}
\newcommand{\relcbn}{\cbnfp\relsym}
\newcommand{\ncbvfp}[1]{\ctxholep{#1}_{nai}}
\newcommand{\relncbv}{\ncbvfp\relsym}

\newcommand{\etav}{\eta_v}

\newcommand{\equivcp}[1]{\simeq_C^{#1}}
\newcommand{\leqcp}[1]{\precsim_C^{#1}}
%\newcommand{\eqcv}{\simeq_C^v}
%\newcommand{\leqcv}{\precsim_C^v}

\newcommand{\eqcn}{\simeq_C^n}
\newcommand{\leqcn}{\precsim_C^n}




%%%Type macros

% multi types
\newcommand{\mtype}{M}
\newcommand{\mtypetwo}{N}
\newcommand{\mtypep}{\mtype'}
\newcommand{\mtypetwop}{\mtypetwo'}
\newcommand{\emptytype}{[~]}

\newcommand{\multitype}[2]{[{#2}_{1},\ldots,{#2}_{#1}]}

% linear types
\newcommand{\ltype}{L}
\newcommand{\ltypetwo}{\ntype'}
\newcommand{\ltypethree}{\ntype''}

% type variables/ based types

\newcommand{\vartype}{X}
\newcommand{\vartypetwo}{Y}


% type contexts
\newcommand{\typectx}{\Gamma}
\newcommand{\typectxtwo}{\Delta}
\newcommand{\typectxthree}{\Pi}

\newcommand{\emptytypectx}{\emptyset}

% type derivation
\newcommand{\typeder}{\pi}
\newcommand{\typederp}{\typeder'}
\newcommand{\typedertwo}{\sigma}
\newcommand{\typederthree}{\rho}
\newcommand{\typedertwop}{\typedertwo'}
\newcommand{\typederthreep}{\typederthree'}

\newcommand{\typingruleApp}{@}
\newcommand{\typingruleAx}{\mathsf{ax}}
\newcommand{\typingruleAbs}{\lambda}
\newcommand{\typingruleMany}{\mathsf{many}}
\newcommand{\typingruleES}{\mathsf{es}}

%\newcommand{\appendOp}{@}
%\newcommand{\hastype}{\!:\!}
%
%
%\newcommand{\domain}[1]{\mathsf{dom}(#1)}
%\newcommand{\typelist}[1]{\underline{#1}}

\newcommand{\types}{\vdash}


%Type equivalence

\newcommand{\leqtype}{\precsim_{type}}
\newcommand{\equivtype}{\simeq_{type}}


\newcommand{\leqtypetwo}{\precsim_{\symfont{TYPE-\eta_v}}}
\newcommand{\equivtypetwo}{\sim_{\symfont{TYPE-\eta_v}}}


% Generic bisimulations

\newcommand{\nft}{\mathit{nf}}

\newcommand{\nfp}[1]{\ctxholep{#1}_{\nft}}
\newcommand{\opnf}{\ctxhole_{\nft}}
\newcommand{\relnfsym}{\nfp\relsym}
\renewcommand{\relnf}{\, \relnfsym \,}
\newcommand{\lasrelnfsym}{\opnfp\lasrelsym}
\newcommand{\lasrelnf}{\, \lasrelnfsym \,}


% Interpretation
\newcommand{\intertypep}[1]{\llbracket #1 \rrbracket_{\symfont{TYPE}}}
\newcommand{\interp}[1]{\llbracket #1 \rrbracket}
\newcommand{\dom}{\mathcal{D}}
\newcommand{\applaw}{\cdot}
\newcommand{\intertype}{\intertypep{~}}
\newcommand{\inter}{\interp{~}}
\newcommand{\domtype}{\mathcal{D}_{\symfont{TYPE}}}

\newcommand{\VSCx}{$\text{VSC}_M$}
\newcommand{\vscx}{\symfont{mir}_{M}}
\newcommand{\vscxp}[1]{\symfont{mir}_{#1}}
\newcommand{\leqvscx}{\precsim_{\vscx}}
%\newcommand{\leqnet}{\precsim_{\mathsf{net}}}

\newcommand{\opvscxp}[1]{\ctxholep{#1}_{\vscx}}
\newcommand{\opvscx}{\ctxhole_{\vscx}}
\newcommand{\relvscx}{\opvscxp\relsym}



\newcommand{\net}{$\mathsf{net}$\xspace}
\newcommand{\Net}{$\mathsf{Net}$\xspace}

\newcommand{\tderiv}{\Phi}
\newcommand{\tderivp}{\tderiv'} %Maico
\newcommand{\tderivpp}{\tderiv''} %Maico
\newcommand{\tderivtwo}{\Psi}

\newcommand{\derive}[2]{#1 \derives #2}
\newcommand{\concl}[4]{\derive{#1}{#2 \vdash #3 \hastype #4}}

\newcommand{\derives}{\vartriangleright}

\newcommand{\xmark}{\text{\ding{55}}}
\newcommand{\towh}{\Rew{wh}}
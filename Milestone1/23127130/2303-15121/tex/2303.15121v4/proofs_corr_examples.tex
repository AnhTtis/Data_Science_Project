%------------------------
% Proofs of corollaries
%------------------------
\section{Proof of corollaries for examples} \label{sec:proof_corr}
%
%---------------------------------------------
% Proof of Corollary for d-dim subspace
%---------------------------------------------
\subsection{Proof of Corollary \ref{cor:subspace}}
Since $\tanconeB = \calK$ for any $B \in \calK$, we choose  $B = A^*$. We will bound the terms $\gamma_2(\calK \cap \frobsphere, \norm{\cdot}_F)$, $\gamma_1(\calK \cap \frobsphere, \norm{\cdot}_2)$ using \eqref{eq:gamma_bound}. We first employ the simplified bound 
%
\begin{equation*}
    \gamma_1(\calK \cap \frobsphere, \norm{\cdot}_2) \leq \gamma_1(\calK \cap \frobsphere, \norm{\cdot}_F)
\end{equation*}
%
since $\norm{\cdot}_2 \leq \norm{\cdot}_F$. Now the set $\calK \cap \frobball \subset \matR^{n \times n}$ is a $d$-dimensional unit ball w.r.t the $\norm{\cdot}_F$ norm, hence it follows\footnote{We simply treat a matrix $X \in \matR^{n \times n}$ by its vector form $\vect(X) \in \matR^{n^2}$.} from standard volumetric estimates (see for e.g. \cite[Corollary 4.2.13]{HDPbook}) that 
%
\begin{equation*}
    \calN(\calK \cap \frobball, \norm{\cdot}_F, \epsilon) \leq \left(\frac{3}{\epsilon} \right)^d \quad \text{ for } \epsilon  \leq 1
\end{equation*}
%
and $\calN(\calK \cap \frobball, \norm{\cdot}_F, \epsilon) = 1$ for $\epsilon > 1$. Since $\diam(\calK \cap \frobball) = 2$, it follows from \eqref{eq:gamma_bound} that for $\alpha = 1,2$, 
%
\begin{align*}
  \gamma_{\alpha}(\calK \cap \frobsphere, \norm{\cdot}_F) \lesssim \gamma_{\alpha}(\calK \cap \frobball, \norm{\cdot}_F) \lesssim \int_{0}^{1} d^{1/\alpha} \log^{1/\alpha}\left(\frac{3}{\epsilon} \right) d\epsilon \lesssim d^{1/\alpha},
\end{align*}
%
where the first inequality holds since $\calK \cap \frobsphere \subset \calK \cap \frobball$. This completes the proof.

%---------------------------------------------
% Proof of Corollary for l_1 ball case
%---------------------------------------------
\subsection{Proof of Corollary \ref{cor:sparse_example}} \label{subsec:proof_corr_sparse}
Since $A^*$ is $k$-sparse, we can bound $w(\tanconeAstar \cap \frobsphere)$ as 
%
\begin{equation*}
    w(\tanconeAstar \cap \frobsphere) \lesssim \sqrt{k \log(n^2/k) + k}  =: \beta(n,k);
\end{equation*}
%
see for instance \cite[Section 4.3]{Tropp2015} which can be directly applied to our setting. Then using \eqref{eq:talag_maj_meas_thm} and the fact $\norm{\cdot}_2 \leq \norm{\cdot}_F$, we obtain 
%
\begin{equation*}
    \gamma_2(\tanconeAstar \cap \frobsphere, \norm{\cdot}_2) \leq \gamma_2(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F) \lesssim w(\tanconeAstar \cap \frobsphere) \lesssim \beta(n,k).
\end{equation*}
%
Now starting with the inequality $\gamma_1(\tanconeAstar \cap \frobsphere, \norm{\cdot}_2) \leq \gamma_1(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F)$, we seek to bound the term $\gamma_1(\tanconeAstar  \cap \frobsphere, \norm{\cdot}_F)$ using \eqref{eq:gamma_bound}. To this end, we can use Sudakov's minoration inequality\footnote{see for instance \cite[Theorem 7.4.1]{HDPbook}; the canonical metric therein is $\norm{\cdot}_F$.} which yields for any $\epsilon > 0$,
%
\begin{equation} \label{eq:sparse_proof_bd1}
  \log \calN(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F, \epsilon) \lesssim \frac{w^2(\tanconeAstar \cap \frobsphere)}{\epsilon^2} \lesssim \frac{\beta^2(n,k)}{\epsilon^2}.
\end{equation}
%
We can also obtain an alternate bound on $\calN(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F, \epsilon)$ by using the following useful fact \cite[Exercise 4.2.10]{HDPbook}: for a metric space $(\calS,d)$ and $\calS' \subset \calS$, it holds for $\epsilon > 0$ that $\calN(\calS', d,\epsilon) \leq \calN(\calS, d,\epsilon/2)$. Applied to our setting, this yields the bound
%
\begin{align}  \label{eq:sparse_proof_bd2}
  \calN(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F, \epsilon) \leq  \calN(\frobsphere, \norm{\cdot}_F, \epsilon/2) \leq \calN(\frobball, \norm{\cdot}_F, \epsilon/4) \leq \left(\frac{12}{\epsilon} \right)^{n^2},
\end{align}
%
where the final bound follows directly from \cite[Corollary 4.2.13]{HDPbook}. Hence from \eqref{eq:sparse_proof_bd1}, \eqref{eq:sparse_proof_bd2}, we have for all $\epsilon > 0$ that
%
\begin{equation*}
    \log \calN(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F, \epsilon) \lesssim \min \set{\frac{\beta^2(n,k)}{\epsilon^2}, {n^2}\log \left(\frac{12}{\epsilon} \right)}.
\end{equation*}
%
%
Since $\diam(\tanconeAstar \cap \frobsphere) = 2$, we can employ \eqref{eq:gamma_bound} to obtain the bound 
%
\begin{align} \label{eq:sparse_proof_bd3}
    \gamma_1(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F) \leq \int_{0}^{2} \log \calN(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F, \epsilon) d\epsilon \lesssim 
    \underbrace{\int_{0}^{\epsilon_1} n^2 \log(12/\epsilon) d\epsilon}_{u_1} + \underbrace{\int_{\epsilon_1}^{2} \frac{\beta^2(n,k)}{\epsilon^2} d\epsilon}_{u_2},
\end{align}
%
for any $\epsilon_1 \in (0,2)$. It is easy to verify that 
%
\begin{align*}
u_1 &= n^2 \epsilon_1 \left(\log\left(\frac{12}{\epsilon_1}\right) + 1 \right) \leq 2 n^2 \epsilon_1 \log\left(\frac{12}{\epsilon_1}\right), \\
%
\text{ and } u_2 &= \left(\frac{2-\epsilon_1}{2\epsilon_1} \right) \beta^2(n,k).
\end{align*}
%
Using this in \eqref{eq:sparse_proof_bd3}, and choosing $\epsilon_1 = \beta(n,k)/n$, we obtain the bound 
%
\begin{align*}
    \gamma_1(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F) \lesssim n \beta(n,k) \left[\log\left(\frac{n}{\beta(n,k)} \right) + 1 \right].
\end{align*}
%
The statement of the corollary now follows directly. Note that for the above choice of $\epsilon_1$ to be in the interval $(0,2)$, we need $n \geq \beta(n,k)/2$ to hold but this is always satisfied.

%-----------------------
% Convex regression
%-----------------------
\subsection{Proof of Corollary \ref{cor:convex_reg_biv}} \label{subsec:proof_cor_convexreg_biv}
The proof relies on using metric entropy bounds developed in \cite[Section 4]{Kur2020ConvexRI} for the collection of convex functions lying within a ball around $f_0$. In what follows, we will borrow some notations and definitions from \cite{Kur2020ConvexRI}.

Let $\calS$ denote an equispaced $n \times n$ grid of $\Omega = [0,1/\sqrt{2}]^2$ with spacing $\delta = \frac{1}{(n-1)\sqrt{2}}$ along each axis. Note that $\Omega$ lies within the unit $\ell_2$ ball of $\matR^2$ (centered at origin). This is a requirement for the results in \cite{Kur2020ConvexRI} to hold, but can be ensured by a suitable scaling. For any function defined on $\Omega$, let us define the quasi-norm
%
\begin{equation*}
\ell_{\calS}(f,\Omega,p) = \left(\frac{1}{\abs{\Omega \cap \calS}} \sum_{b \in \Omega \cap \calS} \abs{f(b)}^p \right)^{1/p}.
\end{equation*}
%
Then for any convex $f_0$ defined on $\Omega$, and $x > 0$, define a ball  centered at $f_0$,
%
\begin{equation*}
    \calB_{\calS}^p(f_0;x;\Omega) = \set{f: \Omega \rightarrow \matR \text{ s.t $f$ is convex and } \ell_{\calS}(f-f_0,\Omega,p) \leq x}.
\end{equation*}
%
Now denoting $\calKtil = \calK - A^*$, note that
%
\begin{equation*}
    \calKtil \cap x \frobball = \set{A - A^*: \ A \in \calK, \ \norm{A - A^*}_F \leq x}.
\end{equation*}
%
We need to bound the metric entropy $\log \calN(\calKtil \cap x \frobball, \norm{\cdot}_F, \epsilon)$. To this end, it is not difficult to verify that 
%
\begin{equation} \label{eq:covreg_tmp1}
    \calN(\calKtil \cap x \frobball, \norm{\cdot}_F, \epsilon) = \calN\left(\calB_{\calS}^2\left(f_0;\frac{x}{n};\Omega \right), \ell_{\calS}(\cdot,\Omega,2), \frac{\epsilon}{n} \right).
\end{equation}
%
%
The RHS of \eqref{eq:covreg_tmp1} is bounded by \cite[Corollary 4.2]{Kur2020ConvexRI}, which in our setup implies
%
%
\begin{equation*}
    \log \calN(\calKtil \cap x \frobball, \norm{\cdot}_F, \epsilon) = \log \calN\left(\calB_{\calS}^2\left(f_0;\frac{x}{n};\Omega \right), \ell_{\calS}(\cdot,\Omega,2), \frac{\epsilon}{n} \right) \leq c^s K \left(\frac{x}{\epsilon}\right) \log^s n
\end{equation*}
%
%
for some constant $c > 0$. Moreover, using standard volumetric estimates as earlier (e.g., \cite[Proposition 4.2.12, Corollary 4.2.13]{HDPbook}), we also have
$\log \calN(\calKtil \cap x \frobball, \norm{\cdot}_F, \epsilon) \leq n^2 \log(6x/\epsilon)$, thus implying 
%
\begin{equation*}
    \log \calN(\calKtil \cap x \frobball, \norm{\cdot}_F, \epsilon) \leq \min \set{c^s K \left(\frac{x}{\epsilon}\right) \log^s n, n^2 \log\left(\frac{6x}{\epsilon} \right)}.
\end{equation*}
%
Now it remains to bound the gamma functionals by deploying \eqref{eq:gamma_bound}.
%
\begin{enumerate}
\item ({\bf Bounding $\gamma_1(\calKtil \cap x\frobball, \norm{\cdot}_2)$}). Since $\diam(\calKtil \cap x\frobball) = 2x$, we have using \eqref{eq:gamma_bound}, for any $0 < \epsilon_1 < 2x$, that
%
%
%
\begin{align*}
    \gamma_1(\calKtil \cap x\frobball, \norm{\cdot}_2) \leq \gamma_1(\calKtil \cap x\frobball, \norm{\cdot}_F) 
    &\lesssim \int_0^{2x} \log \calN(\calKtil \cap x \frobball, \norm{\cdot}_F, \epsilon) d\epsilon \\
    %
    &\lesssim n^2 \int_0^{\epsilon_1} \log\left(\frac{6x}{\epsilon}\right) d\epsilon + c^s K x \log^s n \int_{\epsilon_1}^{2x} \frac{1}{\epsilon} d\epsilon \\
    &\lesssim n^2 \epsilon_1 \log\left(\frac{6x}{\epsilon_1}\right) + c^s Kx \log^s n \log\left(\frac{2x}{\epsilon_1}\right).
\end{align*}
%
%
%
In the final inequality above, we used similar calculations as within the proof of Corollary \ref{cor:sparse_example}. Choosing $\epsilon_1 = \frac{c^s K x \log^s n}{n^2}$ then implies
%
\begin{align*}
 \gamma_1(\calKtil \cap x\frobball, \norm{\cdot}_F)  \lesssim  x c^s K \log^s n \log\left(\frac{n^2}{c^s K \log^s n} \right) 
\end{align*}
%
where we note that $\epsilon_1 < 2x$ is ensured provided $n^2 \geq K c^s \log^s n$.

\item ({\bf Bounding $\gamma_2(\calKtil \cap x\frobball, \norm{\cdot}_2)$}). Again using \eqref{eq:gamma_bound}, we obtain
%
%
\begin{align*}
    \gamma_2(\calKtil \cap x\frobball, \norm{\cdot}_2) 
    &\leq \gamma_2(\calKtil \cap x\frobball, \norm{\cdot}_F) \\
    %
    &\lesssim \int_0^{2x} \log^{1/2} \calN(\calKtil \cap x \frobball, \norm{\cdot}_F, \epsilon) d\epsilon \\
    %
    &\lesssim \int_0^{2x} c^{s/2} \frac{(Kx)^{1/2}}{\sqrt{\epsilon}} \log^{s/2} n \ d\epsilon \\
    &\lesssim x c^{s/2} K^{1/2} \log^{s/2} n
\end{align*}
%
\end{enumerate}
Plugging these bounds in Theorem \ref{thm:no_tancone_Struc}, we see that the dependence on $x$ cancels out from all terms barring the additive term at the end. Since Theorem $2$ is true for any $x > 0$, we can now take the limit $x = 0$ to obtain the corollary.

%-----------------------
% Lipschitz regression
%-----------------------
\subsection{Proof of Corollary \ref{cor:lipschitz_reg_examp}} \label{subsec:proof_cor_lipreg}

\rev{
We start by constructing $B \in \calK$ that is close to $A^*$, and each row of which is ``piecewise affine''. We will denote $X_{i,:}$ to be the $i$th row of a matrix $X$. 
%
%
\begin{lemma} \label{lem:approx_affine}
    For any $A \in \calK$, there exists $B \in \calK$ such that $B_{i,:}$ has at most $l_i + 1$ affine pieces, slopes equal to $\pm L_i$, and $\abs{B_{i,j} - B_{i,j+1}} = L_i/T$ for all $i,j$ so that 
    %
    \begin{equation*}
        \norm{A - B}_F^2 \leq \frac{4n^3}{T^2} \left(\sum_{i=1}^n \frac{L_i^2}{l_i^2} \right).
    \end{equation*}
\end{lemma}
%
\begin{proof}
    The proof follows by using the arguments in \cite[Lemma 3.1]{neykov19b} to approximate $A_{i,:}$ by $B_{i,:}$ where $B_{i,:}$ has at most $l_i + 1$ pieces and the length of each piece is at most $k_i := \lfloor n/l_i \rfloor$, such that 
    %
    \begin{equation*}
        \abs{B_{i,j} - A_{i,j}} \leq 2k_i \frac{L_i}{T} \leq \frac{2nL_i}{l_i T}.
    \end{equation*}
    %
    This implies the stated bound in the lemma, the details are omitted.
\end{proof}
%
We will next bound the Gaussian width $w(\tanconeB \cap \frobball)$ by following the steps in \cite[Section 3.1]{neykov19b}. To this end, denote the monotone sequence cone $\monot_m := \set{v \in \matR^m: v_1 \leq v_2 \leq \cdots \leq v_m}$. The following result follows directly from \cite[Lemma 3.2]{neykov19b}.
%
\begin{lemma} \label{lem:tancone_subset}
    Let $B \in \calK$ be as in Lemma \ref{lem:approx_affine}. For each $i \in [n]$, let $T_{i,1}, \dots, T_{i,l_i + 1}$ be a disjoint partition of $[n]$ such that $B_{i,:}$ is piecewise affine on each $T_{i,j}$ with $s_{i,j}$ denoting the sign of the slope (for $j=1,\dots,l_i+1$). Then 
    %
    \begin{equation*}
        \tanconeB \subset \set{U \in \matR^{n \times n}: U_{i,:} \in \left(- s_{i,1} \monot_{\abs{T_{i,1}}} \right) \times \cdots \times \left(- s_{i,l_i + 1} \monot_{\abs{T_{i,l_i+1}}} \right)} =: \mathcal{C}_{B}.
    \end{equation*}
   %
\end{lemma}
%
Now recall the definition of the statistical dimension of a cone \cite{lotz14} $\mathcal{C} \subset \matR^n$, denoted $\nu(\mathcal{C})$, where
%
\begin{equation*}
    \nu(\mathcal{C}) :=  \expec\left[\left(\sup_{v \in \mathcal{C}, \norm{v}_2 \leq 1} v^\top g \right)^2 \right]
\end{equation*}
%
for $g \sim \mathcal{N}(0,I_n)$. Since $\vect(\tanconeB^\top) \subset \vect(\mathcal{C}_{B}^\top)$, this implies $\nu(\vect(\tanconeB^\top)) \leq \nu(\vect(\mathcal{C}_{B}^\top))$; here $\vect(\cdot)$ and transpose operations are applied element-wise. It then follows that 
%
\begin{align*}
    \vect(\tanconeB^\top) \leq \vect(\mathcal{C}_{B}^\top) = \sum_{i=1}^{n} \sum_{j=1}^{l_i+1} \nu(-s_{i,j} \monot_{\abs{T_{i,j}}}) = \sum_{i=1}^{n} \sum_{j=1}^{l_i+1} \nu(\monot_{\abs{T_{i,j}}})
    \leq \sum_{i=1}^{n} (l_i + 1)  \log\left(\frac{e n}{l_i + 1} \right)
\end{align*}
%
where the last inequality follows from bounds on the statistical dimension of monotone cones \cite{lotz14} and Jensen's inequality. By Cauchy-Schwarz, we then have that 
%
\begin{equation*}
   w(\tanconeB \cap \frobball) \leq \sqrt{\expec \left[\left(\sup_{V \in \tanconeB \cap \frobball} \dotprod{G}{V} \right)^2 \right]} = \sqrt{\nu(\vect(\tanconeB^\top))} \leq \left(\sum_{i=1}^{n} (l_i + 1)  \log\left(\frac{e n}{l_i + 1} \right) \right)^{1/2} 
\end{equation*}
%
It then follows using \eqref{eq:talag_maj_meas_thm} that 
%
\begin{align}\label{eq:gamma_2_bds_lip}
    \gamma_2(\tanconeB \cap \frobsphere, \norm{\cdot}_F) \lesssim \gamma_2(\tanconeB \cap \frobball, \norm{\cdot}_F) \lesssim \left(\underbrace{\sum_{i=1}^{n} (l_i + 1)  \log\left(\frac{e n}{l_i + 1} \right)}_{=: \alpha_n} \right)^{1/2}.
\end{align}
%
It remains to bound $\gamma_1(\tanconeB \cap \frobsphere, \norm{\cdot}_F)$. As in the proofs of the previous corollaries, we use Sudakov minoration along with covering number bounds for $\frobball$ to obtain (for any $\epsilon > 0$)
%
\begin{equation*}
    \log \calN(\tanconeB \cap \frobball, \norm{\cdot}_F, \epsilon) \lesssim \min \set{\frac{\alpha_n}{\epsilon^2}, n^2 \log \left(\frac{12}{\epsilon} \right)}.
\end{equation*}
%
Then we have for any $\epsilon \in (0,2)$
%
\begin{align*}
    \gamma_1(\tanconeB \cap \frobball, \norm{\cdot}_F) \lesssim \int_{0}^{\epsilon_1} n^2 \log(12/\epsilon) d\epsilon + \int_{\epsilon_1}^{2} \frac{\alpha_n}{\epsilon^2} d\epsilon.
\end{align*}
%
Choosing $\epsilon_1 = \frac{\sqrt{\alpha_n}}{n}$, we obtain (analogous to the calculation in Section \ref{subsec:proof_corr_sparse})
%
\begin{align}\label{eq:gamma_1_bds_lip}
    \gamma_1(\tanconeB \cap \frobball, \norm{\cdot}_F) \lesssim n\sqrt{\alpha_n} \left[\log(\frac{n}{\sqrt{\alpha_n}}) + 1 \right].
\end{align}
%
For simplicity, we set $l_i = l$ and use $L_i \leq L$ for each $i \in [n]$. Using the estimates in \eqref{eq:gamma_2_bds_lip}, \eqref{eq:gamma_1_bds_lip} in Theorem \ref{thm:main_err_tangent_cone}, we have for 
%
\begin{equation} \label{eq:T_Lipreg_bd}
    T \gtrsim J^4(A^*) \max \set{n(l+1) \log(\frac{en}{l+1}), \log^2(1/\delta)}
\end{equation}
%
that with probability at least $1-\delta$,
%
\begin{align*}
    \norm{\est{A} - A^*}_F &\lesssim J(A^*) \left(\frac{\log(1/\delta) + \sqrt{n(l+1) \log(\frac{en}{l+1})}}{\sqrt{T}} + \frac{n^{3/2} (l+1)^{1/2} \log^{3/2}(\frac{en}{l+1})}{T}\right) + J^{2}(A^*) \frac{n^4 L^2}{T^2 l^2} \\
    %
    &\lesssim J^2(A^*) \left[ \frac{\log(1/\delta)}{\sqrt{T}} + \sqrt{l} \left(\max\set{\sqrt{\frac{n\log n}{T}}, \frac{(n \log n)^{3/2}}{T}} \right) + \left(\frac{n^4 L^2}{T^2} \right) \frac{1}{l^2} \right].
\end{align*}
%
Now for the choice 
\begin{equation} \label{eq:l_bd_Lipreg}
    l = \left \lfloor \left(\frac{n^4L^2/ T^2}{\max\set{\sqrt{\frac{n \log n}{T}}, \frac{(n\log n)^{3/2}}{T}}} \right)^{2/5} \right\rfloor 
    = \left \lfloor \frac{\frac{n^{7/5} L^{4/5}}{T^{3/5} (\log n)^{1/5}}}{\left(\max\set{1,\frac{n\log n}{\sqrt{T}}} \right)^{2/5}} \right\rfloor
\end{equation}
%
we obtain the stated bound on $\norm{\est{A} - A^*}_F$ in the corollary. Moreover, using \eqref{eq:l_bd_Lipreg} in \eqref{eq:T_Lipreg_bd}, we obtain after some simplifications the sufficient condition in \eqref{eq:T_bd_lipreg_fin}.
}
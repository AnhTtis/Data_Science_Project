%------------------
% Proofs
%--------------------
\section{Proof outline} \label{sec:proof}
%
% Technical tools
\subsection{Technical tools} \label{subsec:tools}
%\todo{Add concentration results and possibly other technical results that will be needed in the proofs later.}
%
For a set of matrices $\calA$, let us define the terms 
%
\begin{equation} \label{eq:rad_frob_spec}
d_F(\calA) = \sup_{A \in \calA} \norm{A}_F, \quad d_2(\calA) = \sup_{A \in \calA} \norm{A}_2,
\end{equation}
%
which can be thought of as other types of complexity measures of the set $\calA$ (the ``radius'' of $\calA$). 

The following result from \cite{krahmer14} provides a concentration bound for the suprema of second order subgaussian chaos processes involving positive semidefinite (p.s.d) matrices. 
%
\begin{theorem}[\cite{krahmer14}] \label{thm:krahmer_chaos}
Let $\calA$ be a set of matrices and $\xi$ be a vector whose entries are independent, zero-mean, variance $1$, and are $L$-subgaussian random variables. Denote
%
\begin{align*}
P &= \gamma_2(\calA, \norm{\cdot}_2) [\gamma_2(\calA, \norm{\cdot}_2) + d_F(\calA)] + d_F(\calA) d_2(\calA) \\
%
V &= d_2(\calA)[\gamma_2(\calA, \norm{\cdot}_2) + d_F(\calA)], \quad \text {and} \quad U = d_2^2(\calA)    
\end{align*}
%
where $d_2, d_F$ are as in \eqref{eq:rad_frob_spec}. Then there exist constants $c_1,c_2 > 0$ depending only on $L$ such that for any $t > 0$ it holds that 
%
\begin{equation*}
    \prob\left(\sup_{A \in \calA} \abs{\norm{A \xi}_2^2 - \expec[\norm{A \xi}_2^2]} \geq c_1 P + t \right) \leq 2\exp\left(-c_2 \min \set{\frac{t^2}{V^2}, \frac{t}{U}} \right).
\end{equation*}
\end{theorem}
%
%
We will also use the following result from \cite{dirksen15} for bounding the suprema of general second order subgaussian chaos processes, where the matrices are not necessarily p.s.d. The bound on moments in part $1$ is stated on page $15$ in \cite{dirksen15}; part $2$ follows by passing from moment bounds to tail bounds in a standard manner via Markov's inequality, see for example \cite[Lemma A.1]{dirksen15}.
%
%
\begin{theorem}[\cite{dirksen15}] \label{thm:dirksen_chaos_conc}
Let $\calA$ be a set of matrices and $\xi$ be a vector whose entries are independent, zero-mean, $1$-subgaussian random variables. For $A \in \calA$, denote $C_A(\xi) := \xi^\top A \xi - \expec[\xi^\top A \xi]$. With $d_2, d_F$ as in \eqref{eq:rad_frob_spec}, the following is true.
%
\begin{enumerate}
    \item There exists a universal constant $c > 0$ such that for any $p \geq 1$,
    %
    \begin{align*}
        \left(\expec \sup_{A \in \calA} \abs{C_A(\xi)}^p \right)^{1/p} 
        &\leq  c \left(\gamma_1(\calA,\norm{\cdot}_2) + \gamma_2(\calA,\norm{\cdot}_F) +\sqrt{p} d_F(\calA) + p d_2(\calA) \right) 
        \\ 
        &= c \varrho(\calA,p).
    \end{align*}
    %
     

    \item There exists a universal constant $c' > 0$ (depending on $c$) such that for any $u \geq 1$, 
    %
    \begin{equation*}
        \prob \left(\sup_{A \in \calA} \abs{C_A(\xi)} \geq c' \varrho(\calA,u) \right) \leq e^{-u}.
    \end{equation*}
\end{enumerate}
 %
\end{theorem}

%------------------------
% Proof of theorem
%-----------------------
%
\subsection{Proof of Theorem \ref{thm:main_err_tangent_cone}}
Let us define the matrices (each of size $n \times T$)
%
\begin{align*}
    \Xtil = [x_2 \cdots x_{T+1}], \ X = [x_1 \cdots x_T], \ \text{ and } E = [\eta_2 \cdots \eta_{T+1}],
\end{align*}
%
so that $\Xtil = A^* X + E$ with $x_0 = 0$ and $x_1 = \eta_1$. Then, \eqref{eq:Aest_convex} can be rewritten as 
%
\begin{equation} \label{eq:Aest_convex_matform}
    \est{A} \in \argmin{A \in \calK} \norm{\Xtil - A X}_F^2.
\end{equation}
%
% 

\paragraph{Step 1.} Our starting point is the following inequality which follows from first-order optimality conditions for constrained convex programs.
%
%
\begin{lemma} \label{lem:ineq_first_ord_cond}
For any $B \in \calK$ the solution $\est{A}$ of \eqref{eq:Aest_convex_matform} satisfies
%
\begin{equation*}
    \norm{(\est{A} - B)X}_F^2 \leq \dotprod{(\est{A} -  B) X}{E} + \norm{(A^* - B) X}_F \norm{(\est{A} - B) X}_F.
\end{equation*}
%
%
%
\begin{proof}
We first expand $\norm{\Xtil - \est{A} X}_F^2$ as 
%
\begin{align}
   \norm{\Xtil - \est{A} X}_F^2 
   &= \norm{\Xtil - B X}_F^2 + \norm{(B - \est{A}) X}_F^2 + 2\dotprod{\Xtil - B X}{(B - \est{A}) X} \nonumber \\
   %
   &= \norm{\Xtil - B X}_F^2 - \norm{(B - \est{A}) X}_F^2 + 2\dotprod{\Xtil - \est{A} X}{(B - \est{A}) X} \nonumber \\
   %
   &\leq \norm{\Xtil - B X}_F^2 - \norm{(B - \est{A}) X}_F^2 \label{eq:temp_1}
\end{align}
%
where the last inequality follows due to $\dotprod{\Xtil - \est{A} X}{(B - \est{A}) X} \leq 0$ by the first order optimality condition for $\est{A}$. 
Using $\Xtil = A^* X + E$, we obtain 
%
\begin{align*}
 \norm{\Xtil - \est{A} X}_F^2 &= \norm{(\est{A} - A^*) X}_F^2 + \norm{E}_F^2 + 2\dotprod{(A^* - \est{A})X}{E},   \\
 %
 \norm{\Xtil - B X}_F^2 - \norm{(B - \est{A}) X}_F^2 &= \norm{(A^* - B)X}_F^2 + \norm{E}_F^2 \\ &+ 2\dotprod{(A^*-B)X}{E} - \norm{(B-\est{A})X}_F^2.
\end{align*}
%
%
Plugging these expressions in \eqref{eq:temp_1} leads to the inequality
%
\begin{equation}
\norm{(A^* - \est{A})X}_F^2 \leq \norm{(A^* - B) X}_F^2 + 2\dotprod{(\est{A} - B) X}{E} - \norm{(B - \est{A}) X}_F^2. \label{eq:temp_2}
\end{equation}
%
Expanding the left-hand side (LHS) of \eqref{eq:temp_2} leads to the lower bound
%
\begin{align*}
\norm{(A^* - \est{A})X}_F^2 
&= \norm{(A^* - B)X}_F^2 + \norm{(B - \est{A})X}_F^2 + 2\dotprod{(A^*-B)X}{(B-\est{A}X)} \\
%
&\geq \norm{(A^* - B)X}_F^2 + \norm{(B - \est{A})X}_F^2 - 2\norm{(A^* - B)X}_F \norm{(B - \est{A})X}_F,    
\end{align*}
%
and plugging this in \eqref{eq:temp_2} readily leads to the stated inequality in the lemma.
\end{proof}
%
\end{lemma}
%
Our next goal is to bound the terms appearing in Lemma \ref{lem:ineq_first_ord_cond}. 
%
%
\paragraph{Step 2.}  Consider first the term $\norm{(\est{A} - B) X}_F^2$ which can be written as
%
\begin{equation*}
  \norm{(\est{A} - B) X}_F^2 = \sum_{t=0}^{T} \norm{(\est{A} - B)x_t}_2^2 = \norm{(I_T \otimes (\est{A} - B)) \vect(X)}_2^2.
\end{equation*}%
%
One can verify that $\vect(X) = \Gamma \xi$ where 
%
\begin{equation*}
\Gamma =  \begin{bmatrix}
   I_n & 0 & \hdots & 0\\ 
   A^* & I_n & \hdots & 0\\ 
  \vdots  &  & \ddots & \vdots\\
  (A^*)^{T-1} & \hdots & A^* & I_n
 \end{bmatrix} \in \matR^{Tn \times Tn}, \quad 
 \xi = \begin{bmatrix}
   \eta_1 \\ 
   \eta_2 \\ 
  \vdots \\
  \eta_T
 \end{bmatrix} \in \matR^{Tn},
\end{equation*}
%
and so, we can write $\norm{(\est{A} - B) X}_F^2 = \norm{(I_T \otimes (\est{A} - B)) \Gamma \xi}_2^2$. As shown in \cite{Jedra20}, we can bound $\norm{\Gamma}_2 \leq J(A^*)$; recall its definition from  \eqref{eq:stab_param}. Now let us define the set
%
\begin{equation*}
    \tanconeBtil := \set{(I_T \otimes A) \Gamma: A \in \tanconeB \cap \frobsphere};
\end{equation*}
%
we then clearly have 
$$\frac{(I_T \otimes (\est{A} - B)) \Gamma}{\norm{\est{A} - B}_F} = \left(I_T \otimes \left(\frac{\est{A} - B}{\norm{\est{A} - B}_F} \right)\right) \Gamma \in \tanconeBtil$$ 
%
%
since $\est{A} - B \in \tanconeB$. Therefore we can bound the term $\norm{(\est{A} - B) X}_F^2$ as 
%
\begin{equation} \label{eq:temp_3}
    \left( \inf_{W \in \tanconeBtil} \norm{W \xi}_2^2 \right) \norm{\est{A} - B}_F^2 \leq \norm{(\est{A} - B) X}_F^2 \leq \norm{\est{A} - B}_F^2 \left(\sup_{W \in \tanconeBtil} \norm{W \xi}_2^2 \right).
\end{equation}
%
The term $\norm{W \xi}_2^2$ is a second order subgaussian chaos involving p.s.d matrices, and we wish to control its infimum and supremum over the set $\tanconeBtil$ in \eqref{eq:temp_3}. This is done using Theorem \ref{thm:krahmer_chaos} and leads to the following lemma.
%
\begin{lemma} \label{lem:psd_chaos_conc_bounds}
Denote $\Ubar, \Vbar, \Pbar$ as
%
\begin{align*}
    \Ubar &= J^2(A^*), \quad \Vbar = J(A^*)\left[\gamma_2(\tanconeBtil, \norm{\cdot}_2) + \sqrt{T} J(A^*)\right], \\
    %
    \Pbar &= \gamma_2(\tanconeBtil, \norm{\cdot}_2)\left[\gamma_2(\tanconeBtil, \norm{\cdot}_2) + \sqrt{T} J(A^*) \right] + \sqrt{T} J^2(A^*).
\end{align*}
%
Then there exist constants $c_1, c_2 > 0$ depending only on $L$ such that for any $t > 0$, it holds with probability at least $1 - 2\exp(-c_2 \min\set{\frac{t^2}{\Vbar^2}, \frac{t}{\Ubar}})$ that 
%
\begin{enumerate}
    \item $\inf_{W \in \tanconeBtil} \norm{W \xi}_2^2 \geq T - c_1 \Pbar - t$, and

    \item $\sup_{W \in \tanconeBtil} \norm{W \xi}_2^2 \leq T J^2(A^*) + c_1 \Pbar + t$. 
\end{enumerate}
\end{lemma}
%
%
%
\begin{proof}
We will use Theorem \ref{thm:krahmer_chaos} to obtain the stated bounds. Let us first bound the terms $d_F(\tanconeBtil), d_2(\tanconeBtil)$ as follows.
%
\begin{equation} \label{eq:df_bound_temp1}
    d_F(\tanconeBtil) = \sup_{W \in \tanconeBtil} \norm{W}_F = \sup_{A \in \tanconeB \cap \frobsphere} \norm{(I_T \otimes A) \Gamma}_F \leq J(A^*) \sqrt{T}
\end{equation}
%
since $\norm{(I_T \otimes A) \Gamma}_F \leq \norm{\Gamma}_2 \norm{I_T \otimes A}_F \leq J(A^*) \sqrt{T}$ for any $A \in \tanconeB \cap \frobsphere$. Furthermore, 
%
\begin{equation} \label{eq:d2_bound_temp1}
d_2(\tanconeBtil) = \sup_{W \in \tanconeBtil} \norm{W}_2 = \sup_{A \in \tanconeB \cap \frobsphere} \norm{(I_T \otimes A) \Gamma}_2 \leq J(A^*)
\end{equation}
%
since $\norm{(I_T \otimes A) \Gamma}_2 \leq \norm{A}_2 \norm{\Gamma}_2 \leq \norm{A}_F \norm{\Gamma}_2 \leq J(A^*)$ for all $A \in \tanconeB \cap \frobsphere$. 

Next, we use almost matching bounds on $\expec[\norm{(I_T \otimes A) \Gamma \xi}_2^2]$ holding uniformly over $A \in \tanconeB \cap \frobsphere$ as
%
\begin{equation*}
    \expec[\norm{(I_T \otimes A) \Gamma \xi}_2^2] = \norm{(I_T \otimes A) \Gamma}_F^2 = \ \ 
    \begin{cases}
       \leq T J^2(A^*) \\
       \geq T \norm{A}_F^2 = T
    \end{cases}
\end{equation*}
%
where for the lower bound we used the fact that $A$ appears $T$ times within $(I_T \otimes A) \Gamma$. Finally, one can readily verify that the terms $\Pbar, \Ubar, \Vbar$ are (resp.) upper bounds for $P, U$ and $V$, the latter terms defined in Theorem \ref{thm:krahmer_chaos}. This concludes the proof. 
%
%
\end{proof}
%
%
Hence the event in Lemma \ref{lem:psd_chaos_conc_bounds} implies the bounds 
%
\begin{align}
    \norm{(\est{A} - B) X}_F^2 &\geq \norm{\est{A} - B}_F^2 (T - c_1 \Pbar - t), \label{eq:temp_bd_11} \\
    \norm{(\est{A} - B) X}_F &\leq \norm{\est{A} - B}_F (T J^2(A^*) + c_1 \Pbar + t)^{1/2}, \label{eq:temp_bd_12} \\
     \text { and } \ \norm{(A^* - B) X}_F &\leq \norm{A^* - B}_F (T J^2(A^*) + c_1 \Pbar + t)^{1/2}. \label{eq:temp_bd_13}
\end{align}
%
%
%
\paragraph{Step 3.} Our goal now is to control the term $\dotprod{(\est{A} -  B) X}{E}$. We can first bound it as 
%
\begin{equation*}
    \dotprod{(\est{A} -  B) X}{E} = \norm{\est{A} -  B}_F \left\langle\left(\frac{\est{A} -  B}{\norm{\est{A} -  B}_F}\right) X, E \right \rangle \leq  \norm{\est{A} -  B}_F \left(\sup_{A \in \tanconeB \cap \frobsphere} \dotprod{AX}{E} \right).
\end{equation*}
%
It remains to control the supremum term, which in fact is the supremum of a second order subgaussian chaos involving matrices that are not necessarily p.s.d (as will be seen in the proof below). This is achieved via Theorem \ref{thm:dirksen_chaos_conc} and leads to the following lemma.
%
\begin{lemma} \label{lem:gen_chaos_conc_bds}
For any $u \geq 1$, we have with probability at least $1 - \exp(-u)$, 
%
\begin{equation*}
    \sup_{A \in \tanconeB \cap \frobsphere} \abs{\dotprod{AX}{E}} \leq 
    c_3 \left(u J(A^*) + \sqrt{u T} J(A^*) + \gamma_1(\tanconeBtil, \norm{\cdot}_2) + \gamma_2(\tanconeBtil, \norm{\cdot}_F) \right)
\end{equation*}
%
for some constant $c_3 > 0$ depending only on $L$.
\end{lemma}
%
%
\begin{proof}
We begin by rewriting $\dotprod{AX}{E}$ as 
%
\begin{align*}
    \dotprod{AX}{E} = \dotprod{A^\top E}{X} = \dotprod{(I_T \otimes A^\top)\xitil}{\Gamma \xi} = \xitil^\top ((I_T \otimes A) \Gamma) \xi \ \text{ where } \ \xitil = \vect(E) = \begin{bmatrix}
   \eta_2 \\ 
   \eta_3 \\ 
  \vdots \\
  \eta_{T+1}
 \end{bmatrix} \in \matR^{Tn}.
\end{align*}
%
%\denis{$E$ is composed by $\eta_j$ for $j=1,\dots,T$, and the same for $\xi$. In fact, $\xi=\vect(E)$. Why $\xitil$ has appeared?} \hemant{Yes indeed, notice that $\xitil$ is a ``shifted'' version of $\xi$ as the indexing for $\xi$ goes from $1$ to $T$. We need both $\xi$ and $\xitil$ to write down $\dotprod{AX}{E}$, at least initially as in above equation.} \denis{I still do not understand: $\langle A^\top E,X\rangle = \langle (I_T \otimes A^\top)\xi,\Gamma\xi\rangle$? There is no $\eta_{T+1}$ in $E$ or $X$? Why it is shifted?}
%
Denoting $\eta \in \matR^{(T+1)n}$ to be the vector formed by stacking $\eta_1,\dots,\eta_{T+1}$, we can further simplify $\xitil^\top ((I_T \otimes A) \Gamma) \xi$ as 
%
\begin{equation*}
    \xitil^\top ((I_T \otimes A) \Gamma) \xi 
    %
    = \eta^\top \underbrace{\begin{bmatrix}
   0 &  0 \\ 
   (I_T \otimes A)\Gamma &  0
 \end{bmatrix}}_{M_A} \eta 
 %
 = \eta^\top M_{A} \eta. 
\end{equation*}
%
This in particular implies $\expec[\dotprod{AX}{E}] = \expec[\eta^\top M_{A} \eta] = 0$. Denoting the set 
%
%
\begin{equation*}
    \mathcal{M} = \set{M_A : A \in \tanconeB \cap \frobsphere}
\end{equation*}
%
%
we obtain
%
$$\sup_{A \in \tanconeB \cap \frobsphere} \dotprod{AX}{E} = \sup_{M_A \in \mathcal{M}} \eta^\top M_{A} \eta.$$
%
We now use Theorem \ref{thm:dirksen_chaos_conc} to control this suprema. To this end, we observe that
%
\begin{align*}
d_F(\mathcal{M}) &= \sup_{M_A \in \mathcal{M}} \norm{M_A}_F = \sup_{A \in \tanconeB \cap \frobsphere} \norm{(I_T \otimes A)\Gamma}_F \leq \sqrt{T} J(A^*), \tag{\text{using \eqref{eq:df_bound_temp1}}} \\
%
d_2(\mathcal{M}) &= \sup_{M_A \in \mathcal{M}} \norm{M_A}_2 = \sup_{A \in \tanconeB \cap \frobsphere} \norm{(I_T \otimes A)\Gamma}_2 \leq J(A^*) \tag{using \eqref{eq:d2_bound_temp1}}.
\end{align*}
%
It is easy to see that $\gamma_{\alpha}(\mathcal{M}, \norm{\cdot}) = \gamma_{\alpha}(\tanconeBtil, \norm{\cdot})$ where $\norm{\cdot}$ denotes any matrix norm. Then by using Theorem \ref{thm:dirksen_chaos_conc} with $\xi$ therein corresponding to $\frac{\eta}{L}$, we readily arrive at the statement of the lemma.
%
%
\end{proof}
%
The event in Lemma \ref{lem:gen_chaos_conc_bds} implies the bound
%
\begin{align}
    \dotprod{(\est{A} -  B) X}{E} 
    &\leq  c_3 \norm{\est{A} -  B}_F \left(u J(A^*) + \sqrt{u T} J(A^*) + \gamma_1(\tanconeBtil, \norm{\cdot}_2) + \gamma_2(\tanconeBtil, \norm{\cdot}_F) \right) \nonumber \\
    &= c_3  \varrho(\tanconeBtil, u)  \norm{\est{A} -  B}_F\label{eq:temp_bd_14}
\end{align}
%
with $\varrho(\cdot, \cdot)$ as defined in Theorem \ref{thm:dirksen_chaos_conc}. 
%
%
\paragraph{Step 4: Putting it together.} Using the results from \eqref{eq:temp_bd_11}, \eqref{eq:temp_bd_12}, \eqref{eq:temp_bd_13}, \eqref{eq:temp_bd_14} in Lemma \ref{lem:ineq_first_ord_cond}, we have with probability at least $1 - 2\exp(-c_2 \min\set{\frac{t^2}{\Vbar^2}, \frac{t}{\Ubar}}) - \exp(-u)$  that 
%
%
%
\begin{align}
    \norm{\est{A} - B}_F^2 (T - c_1 \Pbar - t) 
    &\leq c_3 \varrho(\tanconeBtil, u) \norm{\est{A} - B}_F  + \norm{A^* - B}_F \norm{\est{A} - B}_F \left(T J^2(A^*) + c_1 \Pbar + t \right) \nonumber \\
    %
    \iff \norm{\est{A} - B}_F &\leq c_3 \frac{\varrho(\tanconeBtil, u)}{T - c_1 \Pbar - t} + \norm{A^* - B}_F \left(\frac{T J^2(A^*) + c_1 \Pbar + t}{T - c_1 \Pbar - t} \right). \label{eq:est_bd_put_together_1}
\end{align}
%
%
Our aim is to simplify the above bounds and also showcase the dependency on the local tangent cone $\tanconeB$. To this end, the following claim is useful.
%
\begin{claim} \label{claim:gamma_func_bds}
    For any $\alpha \geq 1$, 
    %
    %
    \begin{align*}
        \gamma_{\alpha}(\tanconeBtil, \norm{\cdot}_2) 
        &\leq J(A^*) \gamma_{\alpha}(\tanconeB \cap \frobsphere, \norm{\cdot}_2), \\
        %
         \gamma_{\alpha}(\tanconeBtil, \norm{\cdot}_F) &\leq \sqrt{T} J(A^*) \gamma_{\alpha}(\tanconeB \cap \frobsphere, \norm{\cdot}_F).
    \end{align*}
    %
    %
\end{claim}
%
\begin{proof}
    For any $X,Y \in \tanconeB \cap \frobsphere$, consider the matrices $A_1 = (I_n \otimes X) \Gamma$ and $A_2 = (I_n \otimes Y) \Gamma$. Clearly, $\norm{A_1 - A_2}_2 \leq J(A^*) \norm{X - Y}_2$ and $\norm{A_1 - A_2}_F \leq \sqrt{T} J(A^*) \norm{X - Y}_F$. This then readily implies the stated bounds using the definition of $\gamma_{\alpha}$ functionals.
\end{proof}
%
Claim \ref{claim:gamma_func_bds} leads to the following bounds on the terms $\Pbar, \Vbar$.
%
\begin{align*}
    \Pbar &\leq \Pbar_1 := J^2(A^*) \left(\gamma_{2}^2(\tanconeB \cap \frobsphere, \norm{\cdot}_2) +\sqrt{T} \gamma_{2}(\tanconeB \cap \frobsphere, \norm{\cdot}_2) + \sqrt{T} \right) \\
    %
    \Vbar &\leq \Vbar_1 := J^2(A^*) \left(\gamma_{2}(\tanconeB \cap \frobsphere, \norm{\cdot}_2) +\sqrt{T} \right)
\end{align*}
%
Furthermore, for $1 \leq u \leq T$ we can bound $\varrho(\tanconeBtil, u)$ as
%
\begin{equation*}
    \varrho(\tanconeBtil, u) \leq J(A^*) \left(2\sqrt{uT} + \gamma_1(\tanconeB \cap \frobsphere, \norm{\cdot}_2) + \sqrt{T} \gamma_2(\tanconeB \cap \frobsphere, \norm{\cdot}_F) \right). 
\end{equation*}
%
The above considerations lead to the following simplification of \eqref{eq:est_bd_put_together_1},
%
\begin{align}
    \norm{\est{A} - B}_F \leq c_3 &\frac{J(A^*) \left(2\sqrt{uT} + \gamma_1(\tanconeB \cap \frobsphere, \norm{\cdot}_2) + \sqrt{T} \gamma_2(\tanconeB \cap \frobsphere, \norm{\cdot}_F) \right)}{T - c_1 \Pbar_1 - t} \nonumber \\
    &+ \norm{A^* - B}_F \frac{T J^2(A^*) + c_1 \Pbar_1 + t}{T - c_1 \Pbar_1 - t} \label{eq:est_bd_put_together_2}
\end{align}
%
which holds with probability at least $1 - 2\exp(-c_2 \min\{\frac{t^2}{\Vbar_1^2}, \frac{t}{\Ubar_1}\}) - \exp(-u)$.

Now choosing $t = \Vbar_1 \sqrt{u} $, note that
%
\begin{equation*}
    \min\set{\frac{t^2}{\Vbar_1^2}, \frac{t}{\Ubar_1}} = \min\set{u, \sqrt{u} \frac{\Vbar_1}{\Ubar}} \geq \min(u, \sqrt{u}) = \sqrt{u}
\end{equation*}
%
where the inequality holds since $\Vbar_1 \geq \Ubar$, and the final equality uses the condition $u \geq 1$. 
Also note that \eqref{eq:est_bd_put_together_2} holds provided $c_1 \Pbar_1 + t < T$. Using the condition $u \geq 1$, it is then easily verified that 
%
$$c_1 \Pbar_1 + t \leq  c_1' J^2(A^*) \left(\gamma_2^2(\tanconeB \cap \frobsphere, \norm{\cdot}_2) + \sqrt{T} \gamma_2(\tanconeB \cap \frobsphere, \norm{\cdot}_2) + \sqrt{uT} \right)$$
%
for some constant $c_1' > 0$ depending on $c_1$. 
%\denis{In $\overline{P}_1$ there is $\sqrt{T}$, but in the new estimate there is only $\sqrt{uT}$, which came from $t$, but since $u\leq T$, then $\sqrt{uT}$ is of order $T$ and not $\sqrt{T}$?} 
So it suffices to ensure that $c_1 \Pbar_1 + t \leq T/2$ for which a sufficient condition is  
%
%
\begin{align} \label{eq:temp_4}
    J^2(A^*) \left(\frac{\gamma_2^2(\tanconeB \cap \frobsphere, \norm{\cdot}_2)}{T} + \frac{\gamma_2(\tanconeB \cap \frobsphere, \norm{\cdot}_2)}{\sqrt{T}} + \sqrt{\frac{u}{T}} \right) \leq \frac{1}{2 c_1'}.
\end{align}
%
Since $J(A^*) \geq 1$, hence \eqref{eq:temp_4} holds provided 
$$T \geq c_1'' J^4(A^*) \max\set{\gamma_2^2(\tanconeB \cap \frobsphere, \norm{\cdot}_2), u}$$
%
for a suitably large constant $c_1'' > 1$ (depending on $c_1'$). Observe that the above condition implies $u \leq T$.

The above considerations are summarized in the form of the following theorem. 
%
%
\begin{theorem}
    There exist constants $C_1, C_2, C_3, C_4 > 0$ depending only on $L$ such that the following is true. For any $u \geq 1$ and $B \in \calK$, suppose that 
    %
    $$T \geq C_1 J^4(A^*) \max\set{\gamma_2^2(\tanconeB \cap \frobsphere, \norm{\cdot}_2), u}.$$ 
    %
    Then with probability at least $1 - C_2\exp(-C_3 \sqrt{u})$, the estimate $\est{A}$ in \eqref{eq:Aest_convex_matform} satisfies
    %
    \begin{equation*}
      \norm{\est{A} - B}_F \leq C_4 J(A^*) \left(\sqrt{\frac{u}{T}} + \frac{\gamma_1(\tanconeB \cap \frobsphere, \norm{\cdot}_2)}{T} + \frac{\gamma_2(\tanconeB \cap \frobsphere, \norm{\cdot}_F)}{\sqrt{T}} \right) 
    + 3 J^2(A^*) \norm{A^* - B}_F.    
    \end{equation*}
\end{theorem}
%
%
The statement of Theorem \ref{thm:main_err_tangent_cone} is obtained by choosing $u = \frac{1}{C_3^2} \log^2(\frac{C_2}{\delta})$ for any $\delta \in (0,1)$, and by the triangle inequality
%
%
\begin{align*}
   \norm{\est{A} - A^*}_F &\leq  \norm{\est{A} - B}_F +  \norm{A^* - B}_F \\
   %
   &\leq C_4 J(A^*) \left(\sqrt{\frac{u}{T}} + \frac{\gamma_1(\tanconeB \cap \frobsphere, \norm{\cdot}_2)}{T} + \frac{\gamma_2(\tanconeB \cap \frobsphere, \norm{\cdot}_F)}{\sqrt{T}} \right) 
    + 4 J^2(A^*) \norm{A^* - B}_F.
\end{align*}
%
This completes the proof.

%---------------------------------------------
% Proof of Corollary for d-dim subspace
%---------------------------------------------
\subsection{Proof of Corollary \ref{cor:subspace}}
Since $\tanconeB = \calK$ for any $B \in \calK$, we choose  $B = A^*$. We will bound the terms $\gamma_2(\calK \cap \frobsphere, \norm{\cdot}_F)$, $\gamma_1(\calK \cap \frobsphere, \norm{\cdot}_2)$ using \eqref{eq:gamma_bound}. We first employ the simplified bound 
%
\begin{equation*}
    \gamma_1(\calK \cap \frobsphere, \norm{\cdot}_2) \leq \gamma_1(\calK \cap \frobsphere, \norm{\cdot}_F)
\end{equation*}
%
since $\norm{\cdot}_2 \leq \norm{\cdot}_F$. Now the set $\calK \cap \frobball \subset \matR^{n \times n}$ is a $d$-dimensional unit ball w.r.t the $\norm{\cdot}_F$ norm, hence it follows\footnote{We simply treat a matrix $X \in \matR^{n \times n}$ by its vector form $\vect(X) \in \matR^{n^2}$.} from standard volumetric estimates (see for e.g. \cite[Corollary 4.2.13]{HDPbook}) that 
%
\begin{equation*}
    \calN(\calK \cap \frobball, \norm{\cdot}_F, \epsilon) \leq \left(\frac{3}{\epsilon} \right)^d \quad \text{ for } \epsilon  \leq 1
\end{equation*}
%
and $\calN(\calK \cap \frobball, \norm{\cdot}_F, \epsilon) = 1$ for $\epsilon > 1$. Since $\diam(\calK \cap \frobball) = 2$, it follows from \eqref{eq:gamma_bound} that for $\alpha = 1,2$, 
%
\begin{align*}
  \gamma_{\alpha}(\calK \cap \frobsphere, \norm{\cdot}_F) \lesssim \gamma_{\alpha}(\calK \cap \frobball, \norm{\cdot}_F) \lesssim \int_{0}^{1} d^{1/\alpha} \log^{1/\alpha}\left(\frac{3}{\epsilon} \right) d\epsilon \lesssim d^{1/\alpha},
\end{align*}
%
where the first inequality holds since $\calK \cap \frobsphere \subset \calK \cap \frobball$. This completes the proof.

%---------------------------------------------
% Proof of Corollary for l_1 ball case
%---------------------------------------------
\subsection{Proof of Corollary \ref{cor:sparse_example}}
Since $A^*$ is $k$-sparse, we can bound $w(\tanconeAstar \cap \frobsphere)$ as 
%
\begin{equation*}
    w(\tanconeAstar \cap \frobsphere) \lesssim \sqrt{k \log(n^2/k) + k}  =: \beta(n,k);
\end{equation*}
%
see for instance \cite[Section 4.3]{Tropp2015} which can be directly applied to our setting. Then using \eqref{eq:talag_maj_meas_thm} and the fact $\norm{\cdot}_2 \leq \norm{\cdot}_F$, we obtain 
%
\begin{equation*}
    \gamma_2(\tanconeAstar \cap \frobsphere, \norm{\cdot}_2) \leq \gamma_2(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F) \lesssim w(\tanconeAstar \cap \frobsphere) \lesssim \beta(n,k).
\end{equation*}
%
Now starting with the inequality $\gamma_1(\tanconeAstar \cap \frobsphere, \norm{\cdot}_2) \leq \gamma_1(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F)$, we seek to bound the term $\gamma_1(\tanconeAstar  \cap \frobsphere, \norm{\cdot}_F)$ using \eqref{eq:gamma_bound}. To this end, we can use Sudakov's minoration inequality\footnote{see for instance \cite[Theorem 7.4.1]{HDPbook}; the canonical metric therein is $\norm{\cdot}_F$.} which yields for any $\epsilon > 0$,
%
\begin{equation} \label{eq:sparse_proof_bd1}
  \log \calN(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F, \epsilon) \lesssim \frac{w^2(\tanconeAstar \cap \frobsphere)}{\epsilon^2} \lesssim \frac{\beta^2(n,k)}{\epsilon^2}.
\end{equation}
%
We can also obtain an alternate bound on $\calN(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F, \epsilon)$ by using the following useful fact \cite[Exercise 4.2.10]{HDPbook}: for a metric space $(\calS,d)$ and $\calS' \subset \calS$, it holds for $\epsilon > 0$ that $\calN(\calS', d,\epsilon) \leq \calN(\calS, d,\epsilon/2)$. Applied to our setting, this yields the bound
%
\begin{align}  \label{eq:sparse_proof_bd2}
  \calN(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F, \epsilon) \leq  \calN(\frobsphere, \norm{\cdot}_F, \epsilon/2) \leq \calN(\frobball, \norm{\cdot}_F, \epsilon/4) \leq \left(\frac{12}{\epsilon} \right)^{n^2},
\end{align}
%
where the final bound follows directly from \cite[Corollary 4.2.13]{HDPbook}. Hence from \eqref{eq:sparse_proof_bd1}, \eqref{eq:sparse_proof_bd2}, we have for all $\epsilon > 0$ that
%
\begin{equation*}
    \log \calN(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F, \epsilon) \lesssim \min \set{\frac{\beta^2(n,k)}{\epsilon^2}, {n^2}\log \left(\frac{12}{\epsilon} \right)}.
\end{equation*}
%
%
Since $\diam(\tanconeAstar \cap \frobsphere) = 2$, we can employ \eqref{eq:gamma_bound} to obtain the bound 
%
\begin{align} \label{eq:sparse_proof_bd3}
    \gamma_1(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F) \leq \int_{0}^{2} \log \calN(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F, \epsilon) d\epsilon \lesssim 
    \underbrace{\int_{0}^{\epsilon_1} n^2 \log(12/\epsilon) d\epsilon}_{u_1} + \underbrace{\int_{\epsilon_1}^{2} \frac{\beta^2(n,k)}{\epsilon^2} d\epsilon}_{u_2},
\end{align}
%
for any $\epsilon_1 \in (0,2)$. It is easy to verify that 
%
\begin{align*}
u_1 &= n^2 \epsilon_1 \left(\log\left(\frac{12}{\epsilon_1}\right) + 1 \right) \leq 2 n^2 \epsilon_1 \log\left(\frac{12}{\epsilon_1}\right), \\
%
\text{ and } u_2 &= \left(\frac{2-\epsilon_1}{2\epsilon_1} \right) \beta^2(n,k).
\end{align*}
%
Using this in \eqref{eq:sparse_proof_bd3}, and choosing $\epsilon_1 = \beta(n,k)/n$, we obtain the bound 
%
\begin{align*}
    \gamma_1(\tanconeAstar \cap \frobsphere, \norm{\cdot}_F) \lesssim n \beta(n,k) \left[\log\left(\frac{n}{\beta(n,k)} \right) + 1 \right].
\end{align*}
%
The statement of the corollary now follows directly. Note that for the above choice of $\epsilon_1$ to be in the interval $(0,2)$, we need $n \geq \beta(n,k)/2$ to hold but this is always satisfied.
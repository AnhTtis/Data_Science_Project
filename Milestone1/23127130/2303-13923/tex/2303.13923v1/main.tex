\documentclass[11pt]{amsart}

\usepackage{graphicx} % Required for inserting images
\usepackage{mathtools}
\usepackage{amsfonts,amsmath,amssymb,amsthm}
\usepackage{latexsym}
\usepackage[normalem]{ulem} %L'option normalem change l'emphasize de la bibliographie par défaut, cf http://blog.dorian-depriester.fr/latex/bibtex-une-bibliographie-dans-les-regles-de-lart

\usepackage[a4paper]{geometry}
\geometry{top=3.52cm, bottom=2.52cm, left=2.5cm, right=2.5cm}

\usepackage{tikz}
\usepackage{xfrac}
\usepackage{enumitem}
\usepackage{marvosym}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{todonotes}


\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem*{theorem*}{Theorem}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem*{proposition*}{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{property}[theorem]{Property}
\newtheorem{claim}[theorem]{Claim}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{question}[theorem]{Question}
\newtheorem{notation}[theorem]{Notation}

\newtheorem{remark}[theorem]{Remark}

\newtheorem{maintheorem}{Theorem}
\renewcommand*{\themaintheorem}{\Alph{maintheorem}}

\newcommand\restr[2]{{% we make the whole thing an ordinary symbol
  \left.\kern-\nulldelimiterspace % automatically resize the bar with \right
  #1 % the function
  \vphantom{\big|} % pretend it's a little taller at normal size
  \right|_{#2} % this is the delimiter
  }}

  
%%%%%%%%%%%%%% COMMANDES GOG
\usepackage{tikz,pgfplots}
\pgfdeclarelayer{bg}    % declare background layer
\pgfplotsset{compat=1.15}
\pgfsetlayers{bg, main} 
\usetikzlibrary{patterns} %for the oblique lines
\usetikzlibrary{positioning} %for loops
\usepackage{wrapfig}
\tikzset{c/.style={every coordinate/.try}} %to change spot of a coordinate
\newcommand{\zbimh}[4] % start, stop, bend big, bend small. Ex: \zbimh{(0,0)}{(1,0)}{80}{10}
{
\begin{pgfonlayer}{bg} 
\foreach \i in {1,...,7}
	{
	\draw #1 edge [bend left=#3, draw=none] node[pos=\i/8](a\i){}#2;
	\draw #1 edge [bend left=#4, draw=none] node[pos=\i/8](b\i ){}#2;
	}
\begin{scope}[every coordinate/.style={shift={(0,0.08*rand-0.08*rand)}}]
\filldraw[pattern=north west lines, pattern color=cyan!80!white, draw=cyan] plot [smooth] coordinates {#1 ([c]a1) ([c]a2) ([c]a3) ([c]a4) ([c]a5) ([c]a6) ([c]a7) #2} -- plot [smooth] coordinates {#2 ([c]b7) ([c]b6) ([c]b5) ([c]b4) ([c]b3) ([c]b2) ([c]b1) #1};
\end{scope}
\end{pgfonlayer}
}

\newcommand{\zbimv}[4] % départ, arrivée, tordage ext, tordage int. Ex: \sisimatete{(0,0)}{(1,0)}{80}{10}
{
\begin{pgfonlayer}{bg} 
\foreach \i in {1,...,7}
{
\draw #1 edge [bend left=#3, draw=none] node[pos=\i/8](a\i){}#2;
\draw #1 edge [bend left=#4, draw=none] node[pos=\i/8](b\i ){}#2;
}
\begin{scope}[every coordinate/.style={shift={(0.08*rand-0.08*rand,0)}}]
\filldraw[pattern=north west lines, pattern color=cyan!80!white, draw=cyan] plot [smooth] coordinates {#1 ([c]a1) ([c]a2) ([c]a3) ([c]a4) ([c]a5) ([c]a6) ([c]a7) #2} -- plot [smooth] coordinates {#2 ([c]b7) ([c]b6) ([c]b5) ([c]b4) ([c]b3) ([c]b2) ([c]b1) #1};
\end{scope}
\end{pgfonlayer}
}

\newcommand{\zbimo}[4] % départ, arrivée, tordage ext, tordage int. Ex: \sisimatete{(0,0)}{(1,0)}{80}{10}
{
\begin{pgfonlayer}{bg} 
\foreach \i in {1,...,7}
{
\draw #1 edge [out=0,in=-120, draw=none, distance=10cm] node[pos=\i/8](a\i){}#2;
\draw #1 edge [out=0,in=-120, draw=none, distance=7cm] node[pos=\i/8](b\i ){}#2;
}
\begin{scope}[every coordinate/.style={shift={(0.08*rand-0.08*rand,0)}}]
\filldraw[pattern=north west lines, pattern color=cyan!80!white, draw=cyan] plot [smooth] coordinates {#1 ([c]a1) ([c]a2) ([c]a3) ([c]a4) ([c]a5) ([c]a6) ([c]a7) #2} -- plot [smooth] coordinates {#2 ([c]b7) ([c]b6) ([c]b5) ([c]b4) ([c]b3) ([c]b2) ([c]b1) #1};
\end{scope}
\end{pgfonlayer}
}

\newcommand{\zbimc}[4] % vertex, starting angle (0 is horizontal), ending angle, looseness Ex: \sisimatete{(0,0)}{(1,0)}{80}{10}
{
{\tikzset{every loop/.style={in=#2,out=#3,looseness=#4}}
 \begin{pgfonlayer}{bg}
 \foreach \i in {1,...,5}
{
\draw #1 edge [loop, draw=none] node[pos=(\i-0.5)/5](a\i){} ();
}
\begin{scope}[every coordinate/.style={shift={(0.08*rand-0.08*rand,0.08*rand-0.08*rand)}}]
\filldraw[pattern=north west lines, pattern color=cyan!80!white, draw=cyan] plot [smooth] coordinates {#1 ([c]a1) ([c]a2) ([c]a3) ([c]a4) ([c]a5) #1};
\end{scope}
\end{pgfonlayer}
}
}

\usepackage{tikz}
\usetikzlibrary{positioning, automata}
\usetikzlibrary{decorations.markings} %for arrows
\usetikzlibrary{arrows.meta} %for arrow tips
\usetikzlibrary{calc} %to do calculations on coordinates
\newcommand{\mylinewidth}{1pt}

\newcommand{\vertex}{\node [circle, draw, inner sep=0pt, minimum size=4pt, fill=black]} %vertices

\title[Expansion properties of Whitehead moves]{Expansion properties of Whitehead moves \\ on cubic graphs}

\author{Laura Grave de Peralta} 
\address{Research Institute in Mathematics and Physics, UCLouvain, Chemin du Cyclotron 2, B--1348 Louvain--la--Neuve, Belgium}

\author{Alexander Kolpakov}
\address{Institut de Math\'ematiques, Universit\'e de Neuch\^atel, Rue Emile--Argand 11, CH--2000 Neuch\^atel, Suisse / Switzerland}

\date{February 2023}

\begin{document}

\maketitle

\begin{abstract}
    The present note studies the ``graph of graphs'' that has cubic graphs as vertices connected by edges represented by the so--called Whitehead moves. We study its conductance and expansion properties, and the adjacency spectrum. 
\end{abstract}

\setcounter{tocdepth}{1}
%\tableofcontents

%\listoftodos

%\todo[inline]{Still not sure about the title, but this we can change later. --Sasha}

\section{Introduction}\label{section-wm:intro}
The present note is concerned with the graph of $3$--regular, or cubic, graphs, and associated objects, such as triangulations and pants decompositions of surfaces. Such a ``graph of graphs'' $\Gamma_n$, represents what can be informally described as the ``deformations space'' of cubic graphs on $2n$ vertices under the Whitehead moves. In particular, we shall investigate its expansion property. 

Expansion is an important notion for families of graphs: we wish to find explicit families of graphs with good expansion properties. In particular, one of the interests of studying expansion is because random walks converge ``quickly'' to the stationary distribution and how quickly they do is controlled by the second largest eigenvalue of the transition matrix. This notion of \emph{rapid mixing} turns out to be a very useful measure of expansion for many purposes. 

We introduce the notion of \emph{outer conductance} because there is no standard definition of expansion for directed non--regular multigraphs, despite them being a natural class of objects to consider. 

\emph{Outer conductance} captures how easy it is to escape a given subset of the graph. Therefore, having the outer conductance tend to 0 is a way of saying that the graphs have poor mixing and therefore cannot be ``expanders'' in this sense. 

Let $g$ be a cubic graph (we allow graphs with multiple edges and loops), with set of vertices $V(g)$, and set of edges $E(g)$. Then, for an edge $e \in E(g)$ which is not a loop, there are two possible Whitehead moves $w^{(1)}_e$ and $w^{(2)}_e$ on $e$, depicted in \Cref{wm-fig:Whitehead-move}, which are local transformations of $g$. If $e \in E(g)$ is a loop, we assume that the respective Whitehead moves have no effect on $g$.

\begin{figure}[ht]
\centering
\includegraphics[scale=0.35]{whitehead-move.pdf}
\caption{ Two possible Whitehead moves performed on an edge $\varepsilon$. } \label{wm-fig:Whitehead-move}
\end{figure}

Let the vertices of $\Gamma_n$ be all possible cubic graphs on $2n$ vertices ($n\geq 1$) up to isomorphism, where two vertices $g_1, g_2 \in V(\Gamma)$ are connected by a directed edge for each Whitehead move $w_\varepsilon$, for $\varepsilon \in E(g_1)$, such that $w_\varepsilon(g_1)$ is isomorphic to $g_2$. It is easy to see that being related by a Whitehead move is an equivalence relation on the set of isomorphism classes of cubic graphs on $2n$ vertices ($n \geq 1$). 

Such a graph of graphs is related to moduli spaces of surface triangulations \cite{DP1, DP2} and pants decomposition of surfaces \cite{RafiTao}, although not entirely equivalent to said objects.
The definition considered here is a directed version of the graph of graphs considered in \cite{RafiTao}. Since Whitehead moves are reversible, our graph of graphs is quasi--isometric to the one considered in \cite{RafiTao}. The graph of graphs considered in \cite{RafiTao} is quasi--isometric to the ``wide'' component of the thick part of the moduli space of a genus $g\geq 2$ surface. This means that $\Gamma_n$ describes pants decompositions of the genus $g = n+1$ surface in which the set of separating curves contains only sufficiently short geodesics. And so is the directed version considered here. Similar local transformations are considered in \cite{Hatcher} and two such pants decompositions represent adjacent vertices in $\Gamma_n$ if they are connected by an $A$--move, as described in \cite{Hatcher}, while an $S$--move (also following \cite{Hatcher}) is always performed on a handle that corresponds to a loop in the pants decomposition graph, and thus is not taken into account when passing to $\Gamma_n$.

Thus, knowing the combinatorial properties of $\Gamma_n$ could be useful in the study of the geometric and combinatorial properties of the former.

Here, we introduce a variation $\phi_{out}$ of the usual notion of conductance and show that this quantity tends to $0$ for the family $\Gamma_n$ of cubic graphs on $2n$ vertices.

In the present note, we show that the following statements hold.

\begin{maintheorem}[\Cref{wm-thm:graph-of-graphs}]
Let $\Gamma_n$ be the graph of cubic graphs on $2n$ ($n\geq 1$) vertices connected by Whitehead moves. Then $\phi_{out}(\Gamma_n) \rightarrow 0$, as $n\to \infty$.
\end{maintheorem}

\begin{maintheorem}[\Cref{thm:graph-of-graphs-1}]
Let $\Gamma_n$ be the graph of cubic graphs on $2n$ ($n\geq 1$) vertices. Then the number of length $\ell$ paths in $\Gamma_n$ is asymptotically $\sim \rho^\ell_n$, with $\rho_n$ a Perron number. 
\end{maintheorem}

We also describe how Whitehead moves interact with graph automorphisms in \Cref{wm-section:autom}.

Finally, in \Cref{wm-section:related} and \Cref{wm-section:open-questions}, we mention some connections and open questions related to $\Gamma_n$.

\section{Conductance and expansion}\label{section-wm:conductance-and-expansion}

Let $G$ be a connected directed graph with vertex set $V(G)$ and edge set $E(G)$. For a subset $S \subset V(G)$, let $d(S)$ denote the sum of vertex out--degrees in $S$, i.e. $d(S) = \sum_{v\in S} deg_{out}(v)$, where $d_{out}(v)$ is the number of edge of the form $(v,u)$ where $v,u \in V(G)$. The \textit{boundary} $\partial(S)$ of a vertex subset $S \subset V(G)$ is defined as the number of directed edges in $E(G)$ joining a vertex in $S$ with a vertex in $V(G) \setminus S$, that is $\partial (S) = \{ e=(u,v) \in E(G) \ | \ u \in S \ , v \in S^c \} $. 

The \textit{outer--conductance} of $S \subset V(G)$ is defined as follows:
\[
\phi_{out}(S) =  \frac{|\partial(S)|}{\min\{ d(S), d(V(G) - S)  \}}
\]
and the outer--conductance of $G$ is
\[
\phi_{out}(G) = \min_{S \subset V(G)} \phi_{out}(S).
\]

This is a generalization of the notion of conductance \cite{Chung}. Since we work with directed graphs, the definition is adapted so that the volume is measured with respect to the number of out--going edges. By doing so the outer--conductance measures how hard it is to escape a subset of the graph.

As a generalisation of the notion of expander families to the case of directed graphs with vertex degrees (both out--degree and in--degree) growing with the number of vertices, we introduce \Cref{wm-def:outer_expander}.

\begin{definition}\label{wm-def:outer_expander}
We say that a sequence of directed graphs $G_n$ with out--degree and in--degree growing with the number of vertices  is an outer--expander family if the conductance $\phi_{out}(G_n)$ is uniformly bounded away from 0 as $n$ tends to infinity. 
\end{definition}

Now we prove our first assertion. 

\begin{theorem}\label{wm-thm:graph-of-graphs}
Let $\Gamma_n$ be the directed graph of cubic graphs on $2n$ ($n\geq 1$) vertices connected by Whitehead moves. Then $\Gamma_n$ is connected and $\phi_{out}(\Gamma_n) \rightarrow 0$, as $n\to \infty$. Therefore, the family $\{\Gamma_n\}_{n \in \mathbb{N}}$ is not a family of outer--expanders.
\end{theorem}

\section{Proof of \texorpdfstring{\Cref{wm-thm:graph-of-graphs}}{Main theorem}} \label{section-wm:proof-theorem}

Let $\Gamma_n$ be the directed graph of (isomorphism classes of) cubic graphs on $2n$ vertices ($n \geq 1$). The following two claims will imply \Cref{wm-thm:graph-of-graphs}.

\subsection*{$\Gamma_n$ is connected.} 

This follows from \cite{RafiTao}. Even simpler, by means of Whitehead moves we can bring every cubic graph to a certain uniquely determined cubic tree. 

\begin{figure}[ht]
\centering
\includegraphics[scale=0.3]{cycle-1.pdf}
\caption{ Performing a Whitehead move on the edge $\varepsilon = (v_0, v_1)$ that belongs to a $k$--cycle $C_k$ in $g \in V(\Gamma_n)$. } \label{wm-fig:cycle-1}
\end{figure}

Let $g$ be a cubic graph, and let $C_k$ be an indecomposable  $k$--cycle (with $k\geq 2$) in $g$, i.e. an induced cycle subgraph where no edge of $g$ connects any two vertices of $C_k$, except the edges of $C_k$ itself. If we perform a Whitehead move on the edge $\varepsilon$ that belongs to a $k$--cycle $C_k$, a part of which is depicted in \Cref{wm-fig:cycle-1}, we obtain a modified graph (partly) depicted in \Cref{wm-fig:cycle-2}.

\begin{figure}[ht]
\centering
\includegraphics[scale=0.3]{cycle-2.pdf}
\caption{ A $(k-1)$--cycle $C_{k-1}$ in $\tilde{g} = w_\varepsilon(g)$: the edge $\varepsilon = (v, w)$ does not belong to $C_{k-1}$. } \label{wm-fig:cycle-2}
\end{figure}

The overall changes in the structure of $\tilde{g} = w_\varepsilon(g)$ as compared to $g$ are local and amount to the following:
\begin{itemize}
\item The $k$--cycle $C_k$ has been transformed into a $(k-1)$--cycle $C_{k-1}$ ;
\item If $v_1$, $w_1$ were part of an $l$--cycle $C_l$ then $C_l$ was transformed into an $(l+1)$--cycle $C_{l+1}$;
\item Same applies to any cycle that previously contained $w_0$ and/or $v_0$.
\end{itemize} 

By performing a total of $k-1$ Whitehead moves on the edges in $C_k$, we reduce it to a loop, as depicted in \Cref{wm-fig:cycle-3}. Here we reduced the total amount of $k$--cycles with $k\geq 2$ by one, although the lengths of some other cycles could have been augmented.

\begin{figure}[ht]
\centering
\includegraphics[scale=0.3]{cycle-3.pdf}
\caption{ A $k$--cycle $C_k$ ($k \geq 2$) is reduced to a loop by $k-1$ consecutive Whitehead moves. } \label{wm-fig:cycle-3}
\end{figure}

By repeating the above procedure on the remaining $k$--cycles (with $k \geq 2$) of the resulting graph, we shall reduce it to what we call a $(n,b)$--cubic tree, an example of which is depicted in \Cref{fig:tree-1}. Such a tree has $2n$ vertices and $b = n+1$ loops (note that $b$ is the $1$st Betty number of the initial graph $g$, since Whitehead moves preserve the number of vertices and edges of $g$, as well as the rank of $\pi_1(g)$).

\begin{figure}[ht]
\centering
\includegraphics[scale=0.3]{2-3-cubic-tree.pdf}
\caption{ A $(2, 3)$--cubic tree } \label{fig:tree-1}
\end{figure}

There exists a natural isomorphism between our $(n,b)$--cubic trees with a chosen loop (i.e. rooted $(n,b)$--cubic trees with a chosen loop $\varepsilon^*$ as a root), and binary rooted trees. Namely, let us take a rooted $(n,b)$--cubic tree $(T, \varepsilon^*)$ and remove all the loops as well as the edge $(v^*, v)$ adjacent to $\varepsilon^*$ (with $\varepsilon^*$ being a loop at vertex $v$). The result, $(\tilde{T},v^*)$ is a binary rooted tree on $2n-1$ vertices with $n$ leaves.

As shown in ~\Cref{fig:tree-2}, a tree rotation can be achieved by a Whitehead move. Thus, $(\tilde{T},v^*)$ can be brought to the unique complete rooted binary tree $T_n$ on $n$ vertices, cf. \cite[\S 12 -- \S 13]{CLRS} for more information on binary trees and tree rebalancing. This proves that $\Gamma_n$ is connected.

\begin{figure}[ht]
\centering
\includegraphics[scale=0.35]{tree-rotation.pdf}
\caption{A left and right rotation of a rooted binary tree (corresponding to an $(n, b)$--cubic tree with root $\varepsilon^*$) realised by a Whitehead move on edge $e$. Here $P$, $Q$ are the vertices of $\varepsilon$, and $A$, $B$, and $C$ are the respective sub--trees } \label{fig:tree-2}
\end{figure}
 
\subsection*{The outer--conductance of $\Gamma_n$ tends to 0.} 
Let $B_n \subset V(\Gamma_n)$  be the set of (isomorphism classes of) connected cubic graphs on $2n$ vertices that have at least one bridge.  We shall estimate the probability $\mathbb{P}(g \in B_n)$ asymptotically. For this matter, notice that if $U_n = V(\Gamma_n)$ is the set of unlabelled cubic graphs (i.e. their isomorphism classes), and $L_n$ is the set of labelled ones, then $\mathbb{P}(g \in U_n \mbox{ has a bridge}) = \mathbb{P}(g \in L_n \mbox{ has a bridge}) + o(1)$, since asymptotically virtually all graphs in $L_n$ have \textit{no non--trivial} automorphisms \cite{Bollobas}, and thus $|L_n| \sim|U_n| \cdot (2n)!$, as $n\to \infty$.

A \textit{bridge} in a connected graph is an edge such that its removal produces several connected components. A graph with a bridge is called \textit{bridged}, while a graph that has no bridges at all is called \textit{bridgeless}. 

A \textit{Hamiltonian circuit} in a (connected) graph is a closed edge path without self--intersection that visits each vertex once. A graph is called \textit{Hamiltonian} if it admits a Hamiltonian circuit. 

It is clear that a graph that has a bridge cannot be Hamiltonian, and that every Hamiltonian cubic graph is bridgeless. 

Let $Bridged = \{ g \in L_n \ | \ g \mbox{ has a bridge}  \}$ and $Looped = \{ g \in L_n \ | \ g \mbox{ has a loop} \}$, and let $nH$ be the set of graphs in $L_n$ that do not have a Hamiltonian circuit. Then
\begin{equation*}
\mathbb{P}(g \in Looped) \leq \mathbb{P}(g \in Bridged) \leq \mathbb{P}(g \in Looped) + \mathbb{P}(g \notin Looped \mbox{ \& } g \in nH),
\end{equation*}
since $Looped \subseteq Bridged$, as well as $Bridged \subseteq nH$.

By applying \cite[Theorem~9.5]{JLR}, we have that $\mathbb{P}(g \in Looped) = 1 - e^{-1} + o(1)$, while \cite[Theorem~9.23]{JLR} implies that $\mathbb{P}(g \notin Looped \mbox{ and } g \in nH) = o(1)$, as $n\to \infty$. Thus, $\mathbb{P}(g \in Bridged) = 1 - e^{-1} + o(1)$ asymptotically, as $n\to \infty$.

Together with the remarks above about the probabilities for labelled and unlabelled graphs, we obtain that $\mathbb{P}(g \in B_n)$, for $g \in V(\Gamma_n)$, satisfies $\mathbb{P}(g \in B_n) = 1 - e^{-1} + o(1)$, as $n\to \infty$. Thus, $|B_n| \sim (1 - e^{-1}) |V(\Gamma_n)|$, and $|V(\Gamma_n)\setminus B_n| \sim e^{-1} |V(\Gamma_n)|$. 

Note that the only vertices in $B_n$ connected with vertices in $V(\Gamma_n)\setminus B_n$ are those $g \in B_n$ having a single bridge, and the corresponding Whitehead moves have to be performed exactly on the bridge edge of $g$. 

Indeed, let $g \in V(\Gamma_n)$ have at least one bridge and let $\varepsilon^*=(u,v)$ denote one of its bridges. Then we can check case--by--case what the result of a Whitehead move on $\varepsilon^*$ could be. 

For this purpose, let us introduce the following equivalence relation on the vertices of $g$: for $v,w \in V(g)$, we write $ v \sim_g w$ if and only if there are two edge--disjoint paths connecting $v$ to $w$. Then we write $[v]_g= \{ w \in V(g) \ s.t. \ v \sim_g w \}$ for the equivalence class of $v$.

Let $\{a,b,c,d\}$ be the vertices adjacent to the bridge $\varepsilon^* \in E(g)$, and let $\tilde{g} = w_{\varepsilon^*}(g)$ be the graph resulting from a Whitehead move performed on $\varepsilon^*$. Then we consider the following five possible cases.  

\paragraph*{1.} $[a]_g = [b]_g = [c]_g = [d]_g$: in this case $\varepsilon^*$ is not a bridge neither in $g$, nor in $\tilde{g}$, cf. \Cref{wm-fig:whitehead-1a,wm-fig:whitehead-1b}. 

\paragraph*{2.}  $[a]_g = [b]_g = [c]_g \neq [d]_g$: same as above, $\varepsilon^*$ is not a bridge neither in $g$, nor in $\tilde{g}$, cf. \Cref{wm-fig:whitehead-2a,wm-fig:whitehead-2b}. 

\paragraph*{3.}  $[a]_g = [b]_g \neq [c]_g = [d]_g$: in this case, $\varepsilon^*$ is a bridge in $g$, but not in $\tilde{g}$, cf. \Cref{wm-fig:whitehead-3a,wm-fig:whitehead-3b}. 

\paragraph*{4.}  $[a]_g = [b]_g \neq [c]_g$ , $[a]_g = [b]_g \neq [d]_g$, and $[c]_g \neq [d]_g$: again, $\varepsilon^*$ is a bridge in $g$, but not in $\tilde{g}$, cf. \Cref{wm-fig:whitehead-4a,wm-fig:whitehead-4b}.

\paragraph*{5.}  $[a]_g , [b]_g , [c]_g , [d]_g$ are all distinct: obviously, $\varepsilon^*$ is a bridge in both $g$ and $\tilde{g}$, cf. \Cref{wm-fig:whitehead-5a,wm-fig:whitehead-5b}.

\begin{figure}[h!]
\begin{minipage}[b]{0.45\textwidth}
\centering
\begin{tikzpicture}[scale=0.5]
\vertex (a) at (-1,1)[label=above left:$a$]{};
\vertex (b) at (-1,-1)[label=below left:$b$]{};
\vertex (u) at (0,0)[label=below right:$u$]{};
\vertex (v) at (2,0)[label=below left :$v$]{};
\vertex (c) at (3,1)[label=above right:$c$]{};
\vertex (d) at (3,-1)[label=below right:$d$]{};

\zbimh{(a)}{(c)}{120}{10};
\zbimv{(b)}{(a)}{120}{10};
\zbimv{(c)}{(d)}{120}{10};
\zbimh{(d)}{(b)}{120}{10};

\draw (a) edge [line width=1pt] (u);
\draw (b) edge [line width=1pt] (u);
\draw (u) edge [line width=1pt] node [above, fill=none] {$\varepsilon^*$} (v);
\draw (c) edge [line width=1pt] (v);
\draw (d) edge [line width=1pt] (v);
\end{tikzpicture}
\caption{ Local picture inside $g$ when  $[a]_g = [b]_g = [c]_g = [d]_g$ } \label{wm-fig:whitehead-1a}
\end{minipage}
%
\hfill
%
\begin{minipage}[b]{0.45\textwidth}
\centering
\begin{tikzpicture}[scale=0.5]
\vertex (a) at (-1,2)[label=above left:$a$]{};
\vertex (b) at (-1,-2)[label=below left:$b$]{};
\vertex (u) at (0,1)[label=below left:$u$]{};
\vertex (v) at (0,-1)[label=above left:$v$]{};
\vertex (c) at (1,2)[label=above right:$c$]{};
\vertex (d) at (1,-2)[label=below right:$d$]{};

\zbimh{(a)}{(c)}{120}{10};
\zbimv{(b)}{(a)}{120}{10};
\zbimv{(c)}{(d)}{120}{10};
\zbimh{(d)}{(b)}{120}{10};

\draw (a) edge [line width=1pt] (u);
\draw (c) edge [line width=1pt] (u);
\draw (v) edge [line width=1pt] node [right, fill=none] {$\varepsilon^*$} (u);
\draw (b) edge [line width=1pt] (v);
\draw (d) edge [line width=1pt] (v);
\end{tikzpicture}
\caption{ Local picture inside $\tilde{g}$ when  $[a]_g = [b]_g = [c]_g = [d]_g$ } \label{wm-fig:whitehead-1b}
\end{minipage}
\end{figure}

\begin{figure}[ht]
\begin{minipage}[b]{0.45\textwidth}
\centering
\begin{tikzpicture}[scale=0.5]
\vertex (a) at (-1,1)[label=above left:$a$]{};
\vertex (b) at (-1,-1)[label=below left:$b$]{};
\vertex (u) at (0,0)[label=below right:$u$]{};
\vertex (v) at (2,0)[label=below left:$v$]{};
\vertex (c) at (3,1)[label=above right:$c$]{};
\vertex (d) at (3,-1)[label=above right:$d$]{};

\zbimh{(a)}{(c)}{120}{10};
\zbimv{(b)}{(a)}{120}{10};
\zbimc{(d)}{-90}{0}{30};

\draw (a) edge [line width=1pt] (u);
\draw (b) edge [line width=1pt] (u);
\draw (u) edge [line width=1pt] node [above, fill=none] {$\varepsilon^*$} (v);
\draw (c) edge [line width=1pt] (v);
\draw (d) edge [line width=1pt] (v);
\end{tikzpicture}
\caption{ Local picture inside $g$ when $[a]_g = [b]_g = [c]_g \neq [d]_g$} \label{wm-fig:whitehead-2a}
\end{minipage}
%
\hfill
%
\begin{minipage}[b]{0.45\textwidth}
\centering
\begin{tikzpicture}[scale=0.5]
\vertex (a) at (-1,2)[label=above left:$a$]{};
\vertex (b) at (-1,-2)[label=below left:$b$]{};
\vertex (u) at (0,1)[label=below left:$u$]{};
\vertex (v) at (0,-1)[label=above left:$v$]{};
\vertex (c) at (1,2)[label=above right:$c$]{};
\vertex (d) at (1,-2)[label=above right:$d$]{};

\zbimh{(a)}{(c)}{120}{10};
\zbimv{(b)}{(a)}{120}{10};
\zbimc{(d)}{-90}{0}{30};

\draw (a) edge [line width=1pt] (u);
\draw (c) edge [line width=1pt] (u);
\draw (v) edge [line width=1pt] node [right, fill=none] {$\varepsilon^*$} (u);
\draw (b) edge [line width=1pt] (v);
\draw (d) edge [line width=1pt] (v);
\end{tikzpicture}
\caption{ Local picture inside $\tilde{g}$ when $[a]_g = [b]_g = [c]_g \neq [d]_g$ } \label{wm-fig:whitehead-2b}
\end{minipage}
\end{figure}

\begin{figure}[ht]
\begin{minipage}[b]{0.45\textwidth}
\centering
\begin{tikzpicture}[scale=0.5]
\vertex (a) at (-1,1)[label=above left:$a$]{};
\vertex (b) at (-1,-1)[label=below left:$b$]{};
\vertex (u) at (0,0)[label=below right:$u$]{};
\vertex (v) at (2,0)[label=below left:$v$]{};
\vertex (c) at (3,1)[label=above right:$c$]{};
\vertex (d) at (3,-1)[label=below left:$d$]{};

\zbimv{(c)}{(d)}{120}{10};
\zbimv{(b)}{(a)}{120}{10};

\draw (a) edge [line width=1pt] (u);
\draw (b) edge [line width=1pt] (u);
\draw (u) edge [line width=1pt] node [above, fill=none] {$\varepsilon^*$} (v);
\draw (c) edge [line width=1pt] (v);
\draw (d) edge [line width=1pt] (v);
\end{tikzpicture}
\caption{Local picture inside g when $[a]_g = [b]_g \neq [c]_g = [d]_g$} \label{wm-fig:whitehead-3a}
\end{minipage}
%
\hfill
%
\begin{minipage}[b]{0.45\textwidth}
\centering
\begin{tikzpicture}[scale=0.5]
\vertex (a) at (-1,2)[label=above left:$a$]{};
\vertex (b) at (-1,-2)[label=below left:$b$]{};
\vertex (u) at (0,1)[label=below left:$u$]{};
\vertex (v) at (0,-1)[label=above left:$v$]{};
\vertex (c) at (1,2)[label=above right:$c$]{};
\vertex (d) at (1,-2)[label=below left:$d$]{};

\zbimv{(c)}{(d)}{120}{10};
\zbimv{(b)}{(a)}{120}{10};

\draw (a) edge [line width=1pt] (u);
\draw (c) edge [line width=1pt] (u);
\draw (v) edge [line width=1pt] node [right, fill=none] {$\varepsilon^*$} (u);
\draw (b) edge [line width=1pt] (v);
\draw (d) edge [line width=1pt] (v);
\end{tikzpicture}
\caption{Local picture inside $\tilde{g}$ when $[a]_g = [b]_g \neq [c]_g = [d]_g$} \label{wm-fig:whitehead-3b}
\end{minipage}
\end{figure}

\begin{figure}[ht]
\begin{minipage}[b]{0.45\textwidth}
\centering
\begin{tikzpicture}[scale=0.5]
\vertex (a) at (-1,1)[label=above left:$a$]{};
\vertex (b) at (-1,-1)[label=below left:$b$]{};
\vertex (u) at (0,0)[label=below right:$u$]{};
\vertex (v) at (2,0)[label=below left:$v$]{};
\vertex (c) at (3,1)[label=above right:$c$]{};
\vertex (d) at (3,-1)[label=below left:$d$]{};

\zbimc{(c)}{-90}{30}{30};
\zbimc{(d)}{-90}{30}{30};
\zbimv{(b)}{(a)}{120}{10};

\draw (a) edge [line width=1pt] (u);
\draw (b) edge [line width=1pt] (u);
\draw (u) edge [line width=1pt] node [above, fill=none] {$\varepsilon^*$} (v);
\draw (c) edge [line width=1pt] (v);
\draw (d) edge [line width=1pt] (v);
\end{tikzpicture}
\caption{ Local picture inside $g$ when $[a]_g = [b]_g \neq [c]_g$ , $[a]_g = [b]_g \neq [d]_g$, and $[c]_g \neq [d]_g$ } \label{wm-fig:whitehead-4a}
\end{minipage}
%
\hfill
%
\begin{minipage}[b]{0.45\textwidth}
\centering
\begin{tikzpicture}[scale=0.5]
\vertex (a) at (-1,2)[label=above left:$a$]{};
\vertex (b) at (-1,-2)[label=below left:$b$]{};
\vertex (u) at (0,1)[label=below left:$u$]{};
\vertex (v) at (0,-1)[label=above left:$v$]{};
\vertex (c) at (1,2)[label=above right:$c$]{};
\vertex (d) at (1,-2)[label=below left:$d$]{};

\zbimc{(c)}{-90}{30}{30};
\zbimc{(d)}{-90}{30}{30};
\zbimv{(b)}{(a)}{120}{10};

\draw (a) edge [line width=1pt] (u);
\draw (c) edge [line width=1pt] (u);
\draw (v) edge [line width=1pt] node [right, fill=none] {$\varepsilon^*$} (u);
\draw (b) edge [line width=1pt] (v);
\draw (d) edge [line width=1pt] (v);
\end{tikzpicture}
\caption{ Local picture inside $\tilde{g}$ when $[a]_g = [b]_g \neq [c]_g$ , $[a]_g = [b]_g \neq [d]_g$, and $[c]_g \neq [d]_g$ } \label{wm-fig:whitehead-4b}
\end{minipage}
\end{figure}


\begin{figure}[ht]
\begin{minipage}[t]{0.45\textwidth}
\centering
\begin{tikzpicture}[scale=0.5]
\vertex (a) at (-1,1)[label=above right:$a$]{};
\vertex (b) at (-1,-1)[label=below right:$b$]{};
\vertex (u) at (0,0)[label=below right:$u$]{};
\vertex (v) at (2,0)[label=below left:$v$]{};
\vertex (c) at (3,1)[label=above right:$c$]{};
\vertex (d) at (3,-1)[label=below left:$d$]{};

\zbimc{(c)}{-90}{30}{30};
\zbimc{(d)}{-90}{30}{30};
\zbimc{(a)}{90}{180}{30};
\zbimc{(b)}{180}{-90}{30};

\draw (a) edge [line width=1pt] (u);
\draw (b) edge [line width=1pt] (u);
\draw (u) edge [line width=1pt] node [above, fill=none] {$\varepsilon^*$} (v);
\draw (c) edge [line width=1pt] (v);
\draw (d) edge [line width=1pt] (v);
\end{tikzpicture}
\caption{ Local picture inside $g$ when $[a]_g , [b]_g , [c]_g , [d]_g$ are all distinct } \label{wm-fig:whitehead-5a}
\end{minipage}
%
\hfill
%
\begin{minipage}[t]{0.45\textwidth}
\centering
\begin{tikzpicture}[scale=0.5]
\vertex (a) at (-1,2)[label=above right:$a$]{};
\vertex (b) at (-1,-2)[label=below right:$b$]{};
\vertex (u) at (0,1)[label=below left:$u$]{};
\vertex (v) at (0,-1)[label=above left:$v$]{};
\vertex (c) at (1,2)[label=above right:$c$]{};
\vertex (d) at (1,-2)[label=below left:$d$]{};

\zbimc{(c)}{-90}{30}{30};
\zbimc{(d)}{-90}{30}{30};
\zbimc{(a)}{90}{180}{30};
\zbimc{(b)}{180}{-90}{30};

\draw (a) edge [line width=1pt] (u);
\draw (c) edge [line width=1pt] (u);
\draw (v) edge [line width=1pt] node [right, fill=none] {$\varepsilon^*$} (u);
\draw (b) edge [line width=1pt] (v);
\draw (d) edge [line width=1pt] (v);
\end{tikzpicture}
\caption{Local picture inside $\tilde{g}$ when $[a]_g , [b]_g , [c]_g , [d]_g$ are all distinct } \label{wm-fig:whitehead-5b}
\end{minipage}
\end{figure}

\newpage
According to the observations above, if a bridged graph $g \in B_n$ can be transformed into a bridgeless one $\tilde{g} = w_\varepsilon(g)$, then $\varepsilon$ is the only bridge of $g$. Every time, both Whitehead moves either succeed or fail to bring $\tilde{g}$ outside $B_n$. This implies that $|\partial(B_n)| \leq 2 |B_n|$. Thus the outer--conductance of the set $B_n$ satisfies 
\begin{align*}
\phi_{out}(B_n) &= \frac{|\partial(B_n)|}{\min\{ d(B_n), d(V(\Gamma_n)\setminus B_n) \}} \leq \frac{2 |B_n|}{ 6n |V(\Gamma_n)\setminus B_n|} \sim \\
&\sim \frac{2 |V(\Gamma_n)| (1-e^{-1})}{6n |V(\Gamma_n)| e^{-1}} = \frac{e-1}{3n} \to 0,
\end{align*} 
as $n\to \infty$. \hfill $\square$

\section{Adjacency spectrum}

Let $A$ be a non--zero square $k\times k$ ($k\geq 2$) matrix with non--negative integer entries. Such a matrix is called \textit{non--negative}, for brevity. If all the entries of $A$ are actually positive, then $A$ is called \textit{positive}.

If there exists a permutation matrix $P$ such that $PAP^{-1}$ has upper--triangular block form, $A$ is called \textit{reducible}. Otherwise, $A$ is \textit{irreducible}.

For $i \in \{1, \dots, k\}$, the \textit{$i$--th period} of $A$ is the least positive integer $m$ such that the $i$--th diagonal entry of $A^m$ is positive. If $A$ is irreducible, then all its periods coincide, and each of them equals \textit{the period} of $A$. If the period of $A$ equals $1$, then $A$ is called \textit{aperiodic}. 

An aperiodic and irreducible non--negative matrix $A$ is called \textit{primitive}. If $A$ is a primitive matrix, then its spectral radius is a Perron number, as a consequence of the Perron--Frobenius theorem \cite{LM}. Recall that a Perron number is an algebraic integer $\rho > 1$ such that all of its other Galois conjugates have modulus strictly less than $\rho$. Perron numbers often appear in dynamical context, cf. \cite{LM}. Another property of the spectral radius of a primitive matrix $A$ is that this eigenvalue has multiplicity one.  

Let $\Gamma$ be a directed graph, and let $A$ be its adjacency matrix defined as follows:
\begin{equation*}
A_{uv} = \mbox{ the number of directed edges joining } u \mbox{ to } v, \mbox{ if } u\neq v, \mbox{ and }
\end{equation*}
\begin{equation*}
A_{vv} = \mbox{ the number of loops incident to } v.
\end{equation*}
Then $A$ is irreducible if and only if $\Gamma$ is \textit{strongly connected}, i.e. there exists a path of directed edges in $\Gamma$ between any pair of distinct vertices. If $\Gamma$ is strongly connected and the greatest common divisor of its directed cycles equals $1$, then $A$ is aperiodic, and thus primitive. Thus, in this case we can deduce that the spectral radius of $A$ is a Perron number by considering the combinatorics of $\Gamma$.

\begin{theorem}\label{thm:graph-of-graphs-1}
Let $\Gamma_n$ be the graph of cubic graphs on $2n$ ($n\geq 1$) vertices. Then the number of length $\ell$ paths in $\Gamma_n$ is asymptotically $\sim \rho^\ell_n$, with $\rho_n$ a Perron number. 
\end{theorem}

%\todo[inline]{need to add the rest of the proof}

\subsection{Proof of Theorem \ref{thm:graph-of-graphs-1}}

Let $\Gamma_n$ be the graph of graphs on $2n$ vertices ($n \geq 1$), and let $A_n = A(\Gamma_n)$ be its adjacency matrix. We want to show that $A_n$ is primitive. This would imply that its spectral radius $\rho_n = \rho(A_n)$ is a multiplicity $1$ eigenvalue with a positive eigenvector $v$, and that $\rho_n$ is a Perron number. The asymptotic number of paths is then a standard computation.

For every $n\geq 1$, there exists an $(n, b)$--cubic tree $t\in V(\Gamma_n)$, with $b = n+1 \geq 2$ loops $\varepsilon_1, \dots, \varepsilon_b$.
Then, $w_{\varepsilon_i}(t) = t$, for any $i=1, \dots, b$, and thus $\Gamma_n$ has loops. This implies that $\Gamma_n$ is aperiodic\footnote{There are also edge cycles of coprime length $\geq 2$ in the $\Gamma_n$ with $n\geq 3$, as can be seen from the fact that $\Gamma_3$ embeds into $\Gamma_n$, $n\geq 4$, and $\Gamma_3$ has cycles of length e.g. $2$ and $3$}.

We already know that that $\Gamma_n$ is strongly connected, as in Theorem~\ref{wm-thm:graph-of-graphs} we prove that $\Gamma_n$ is connected as a directed graph. Thus, we obtain that $A_n$ is also primitive, and can now apply the Perron--Frobenius theorem.  \hfill $\square$

\subsection{Remark on the thin neighbourhood.} It appears that $\Gamma_n$ is itself a relatively ``thin'' neighbourhood of $B_n$. Indeed, we each length $k$ cycle in a graph $g \in V(\Gamma_n)$ can be reduced by $k-2$ Whitehead moves to a $2$--cycle, and one more Whitehead move will create an edge incident to a loop. The standard asymptotic bound on girth is $\mathrm{girth}(g) \lesssim 2 \log_2 n$. If $v = |V(\Gamma_n)|$, then $v \sim n^n$ \cite{Bollobas}, and thus each vertex of $\Gamma_n$ happens to be within $\sim \log_2 \log_2 v$ distance from $B_n$. As shown in \cite{RafiTao}, the diameter of $\Gamma_n$ satisfies $d = \mathrm{diam}(\Gamma_n) \sim n \log_2 n$, and thus each vetrex of $\Gamma_n$ is within $\log_2 d$ of $B_n$.

\section{Edge orbits and automorphisms}\label{wm-section:autom}

Below we make some remarks on how performing Whitehead moves on edges equivalent under graph automorphisms affects the resulting graph. 

%\todo[inline]{Need to say something about $w^1_e$ and $w^2_e$ as it is a new notation. -- Sasha}

\begin{proposition}\label{wm-prop:autom-wm}
Let $g$ be a trivalent graph and $e,f \in E(g)$. Suppose there exists an automorphism $\alpha \in Aut(g)$ of $g$ such that $\alpha(e) = f, \alpha(v_i) = w_i$ and $\alpha(e_i) = f_i$ for the corresponding indices and that all the $v_i$'s and $w_i$'s are distinct (see \ref{wm-fig-star-e} and \ref{wm-fig-star-f}).

Then, if we perform the same Whitehead move on both sides, that is we choose one of the following pairs of transformations:

\begin{enumerate}
\item $w_e^1 : (v_1,v_2)(v_3,v_4) \mapsto (v_1,v_3)(v_2,v_4)$ and $w_f^1(g) : (w_1,w_2)(w_3,w_4) \mapsto (w_1,w_3)(w_2,w_4)$; or

\item $w_e^2 : (v_1,v_2)(v_3,v_4) \mapsto (v_1,v_4)(v_2,v_3)$ and $w_f^2 : (w_1,w_2)(w_3,w_4) \mapsto (w_1,w_4)(w_2,w_3)$,
\end{enumerate}

then the resulting graphs are isomorphic $w_e^1(g) \cong w_f^1(g)$ and $w_e^2(g) \cong w_f^2(g)$.
\end{proposition}

\begin{figure}[h!]
\begin{minipage}[b]{0.45\textwidth}
\centering
\begin{tikzpicture}
\vertex (a) at (-1,1)[label=above left:$v_1$]{};
\vertex (b) at (-1,-1)[label=below left:$v_2$]{};
\vertex (u) at (0,0)[label=below right:$e_1$]{};
\vertex (v) at (2,0)[label=below left:$e_2$]{};
\vertex (c) at (3,1)[label=above right:$v_3$]{};
\vertex (d) at (3,-1)[label=below right:$v_4$]{};

\draw (a) edge [line width=1pt] (u);
\draw (b) edge [line width=1pt] (u);
\draw (u) edge [line width=1pt] node [above, fill=none] {$e$} (v);
\draw (c) edge [line width=1pt] (v);
\draw (d) edge [line width=1pt] (v);

\end{tikzpicture}
\caption{ The neighbourhood of $e$  } \label{wm-fig-star-e}
\end{minipage}
\hfill
\begin{minipage}[b]{0.45\textwidth}

\centering
\begin{tikzpicture}
\vertex (a) at (-1,1)[label=above left:$w_1$]{};
\vertex (b) at (-1,-1)[label=below left:$w_2$]{};
\vertex (u) at (0,0)[label=below right:$f_1$]{};
\vertex (v) at (2,0)[label=below left:$f_2$]{};
\vertex (c) at (3,1)[label=above right:$w_3$]{};
\vertex (d) at (3,-1)[label=below right:$w_4$]{};

\draw (a) edge [line width=1pt] (u);
\draw (c) edge [line width=1pt] (v);
\draw (v) edge [line width=1pt] node [above, fill=none] {$f$} (u);
\draw (b) edge [line width=1pt] (u);
\draw (d) edge [line width=1pt] (v);
\end{tikzpicture}
\caption{ The neighbourhood of $f$ } \label{wm-fig-star-f}
\end{minipage}
\end{figure}
\begin{proof}

Suppose we perform a Whitehead move of type (1). Consider $g_1 = g \setminus St(e)$ and $g_2 = \alpha(g) \setminus St(f)$ where $St(e)$, resp. $St(f)$, is the star of $f$, resp. $e$ (i.e. the set of incident vertices and edges to $e$, resp. $f$).

Then the map $\alpha$ induces $\overline{\alpha} : g_1 \to g_2$ which is an isomorphism.

Now consider $\gamma_1 = w_e^1(g) \setminus St(e)$ and $\gamma_2  = w_f^1(g) \setminus St(f)$. Since a Whitehead move is a local transformation, we have that $g_1 = \gamma_1$ and $g_2 = \gamma_2$. Thus, we obtain a map $\overline{\alpha} : \gamma_1 \to \gamma_2$, and this map is a graph isomorphism.

Now we can extend $\overline{\alpha}$ to a map from $\gamma_1 = w_e^1(g)$ to $\gamma_2 = w_f^1(g)$ in the unique possible way, because $v_1$ and $v_3$ have a unique common neighbour in $St_{w_e^1(g)}(e)$ and the same applies to $w_1, w_3$ in $St_{w_f^1(g)}(f)$. The same can be done for $v_2, v_4$ and $w_2, w_4$. Thus, the map obtained is a graph isomorphism between $\gamma_1$ and $\gamma_2$.

Note that exactly the same proof applies if we perform a Whitehead move of type (2).
\end{proof}

Note also that the same proof works if, for example, $v_1 = v_3$ and $w_1 = w_3$ and/or $v_2 = v_4$ and $w_2 = w_4$. The main point being that multiple edges still allow extending the automorphism. 

We also have a sort of converse. 

\begin{proposition}
Suppose $w_e^k(g) \cong w_f^k(g)$ via a map $\psi$ such that $\psi(e^*) = f^*, \psi(v_i^*) = w_i^*$ and $\psi(e_i^* ) = f_i^*$ for the corresponding indices $i$ (see \Cref{wm-isom-star-e,wm-isom-star-f}). Then, there exists $\overline{\psi} \in Aut(g)$ such that $\overline{\psi}(e) = f$.
\end{proposition}

\begin{figure}[h!!]
\begin{minipage}[b]{0.45\textwidth}
\centering
\begin{tikzpicture}
\vertex (a) at (-1,1)[label=above left:$v_1^*$]{};
\vertex (b) at (-1,-1)[label=below left:$v_2^*$]{};
\vertex (u) at (0,0)[label=below right:$e_1^*$]{};
\vertex (v) at (2,0)[label=below left:$e_2^*$]{};
\vertex (c) at (3,1)[label=above right:$v_3^*$]{};
\vertex (d) at (3,-1)[label=below right:$v_4^*$]{};
\draw (a) edge [line width=1pt] (u);
\draw (b) edge [line width=1pt] (u);
\draw (u) edge [line width=1pt] node [above, fill=none] {$e^*$} (v);
\draw (c) edge [line width=1pt] (v);
\draw (d) edge [line width=1pt] (v);

\end{tikzpicture}
\caption{ The neighbourhood of $e^*$ in $w_e^k(g)$  } \label{wm-isom-star-e}
\end{minipage}
\hfill
\begin{minipage}[b]{0.45\textwidth}

\centering
\begin{tikzpicture}
\vertex (a) at (-1,1)[label=above left:$w_1^*$]{};
\vertex (b) at (-1,-1)[label=below left:$w_2^*$]{};
\vertex (u) at (0,0)[label=below right:$f_1^*$]{};
\vertex (v) at (2,0)[label=below left:$f_2^*$]{};
\vertex (c) at (3,1)[label=above right:$w_3^*$]{};
\vertex (d) at (3,-1)[label=below right:$w_4^*$]{};

\draw (a) edge [line width=1pt] (u);
\draw (c) edge [line width=1pt] (v);
\draw (v) edge [line width=1pt] node [above, fill=none] {$f^*$} (u);
\draw (b) edge [line width=1pt] (u);
\draw (d) edge [line width=1pt] (v);

\end{tikzpicture}
\caption{ The neighbourhood of $f^*$ in $w_f^k(g)$ } \label{wm-isom-star-f}
\end{minipage}
\end{figure}

\begin{proof} 
Starting from the two graphs, re--apply the corresponding Whitehead moves, that is either apply on both sides $w_e^1$ and $w_f^1$ or $w_e^2$ and $w_f^2$ . The two graphs obtained are isomorphic, and on both sides you retrieve $g$. Now you can apply \Cref{wm-prop:autom-wm} and thus obtain the desired $\overline{\psi}$.
\end{proof}

\begin{proposition}
    Suppose $g_1$ and $g_2$ are isomorphic trivalent graphs via a map $\phi$. Suppose $g_1 = w_e^1(h_1)$ and $g_2 = w_f^1(h_2)$. Suppose that the map $\phi$ maps $e^* = w_e^1(e)$ to $f^* = w_e^1(f)$ and the incident vertices $v_i^*$ to $w_i^*$ as in \Cref{wm-isom-star-e,wm-isom-star-f}. Then $h_1$ and $h_2$ are isomorphic and there exists an isomorphism $\psi : h_1 \to h_2$ that maps $e$ onto $f$.
\end{proposition}

\begin{proof}
    Consider $\Gamma_1 = g_1 \setminus St(e^*)$ and $\Gamma_2 = g_2 \setminus St(f^*)$. Then $\phi$ induces $\overline{\phi} : \Gamma_1 \to \Gamma_2$ and $\overline{\phi}$ is an isomorphism of graphs. Note that since a Whitehead move is a local transformation, we have that $\Gamma_1 = h_1 \setminus St(e)$ and $\Gamma_2 = h_2 \setminus St(f)$ thus $\overline{\phi}$ can be seen as a map from $h_1 \setminus St(e)$ to $h_2 \setminus St(f)$. We will now extend $\overline{\phi}$ to an isomorphism $\psi : h_1 \to h_2$.

    Suppose the transformation $h_1 \to g_1$ was doing (as local changes described in $h_1$) $(v_1 v_3)(v_2v_4) \to (v_1 v_2 )(v_3)(v_4)$ and the transformation $h_2 \to g_2$ was doing (as local changes in $h_2$) $(w_1w_2)(w_3w_4) \to (w_1 w_2)(w_3 w_4)$.This is always possible up to relabelling the graphs.
    Then $\{e_1\}=St_{h_1}(v_1) \cap St_{h_1}(v_3), \{e_2\}=St_{h_1}(v_2) \cap St_{h_1}(v_4), \{f_1\}=St_{h_2}(w_1) \cap St_{h_2}(w_3), \{f_2\}=St_{h_2}(w_2) \cap St_{h_2}(w_4)$ and we define $\psi : h_1 \to h_2$  as follows. We set $\psi(e_i)=f_i$ and $\restr{\psi}{h_1\setminus St(e)} = \overline{\phi}$. Obviously $\psi$ is an isomorphism of graphs and it maps $e$ to $f$ because we extend it to preserve adjacency. 
\end{proof}

\section{Related objects}\label{wm-section:related}

Above we consider the graph of graphs $\Gamma_n$ of all possible cubic graphs on $2n$ vertices, where two vertices, $g_1, g_2 \in V(\Gamma_n)$, are connected by a directed edge for each Whitehead move $w_\varepsilon$, for $\varepsilon \in E(g_1)$, such that $w_\varepsilon(g_1)$ is isomorphic to $g_2$ vertices up to isomorphism.

However, there are several ways to modify this definition. Indeed, we could modify the edges of $\Gamma_n$ in order to turn it into an undirected graph, a simple graph or other types of graphs. These modifications can provide relations between the graph of graphs and other mathematical problems. In this section we will explore some of these connections.

\subsubsection{Matchings on graphs}\label{wm-related:matchings}

If two edges $e$, $f$ in $g \in \Gamma_n$ are not incident to each other, then $w_e(g)$ and $w_f(g)$ commute. That is, if we want to apply consecutively the two transformations, it will yield the same graph. This comes from Whitehead moves being local transformations of the graph. Thus, if the two local transformations are ``far away'' from each other, they commute. We will call this a \emph{simultaneous Whitehead move on the set $\{e, f\}$} or \emph{simultaneous WM} for short.

Thus, we can modify slightly the edges of $\Gamma_n$ to make it into a simple directed graph in the following way.  Say $g_1, g_2 \in V(\Gamma_n)$, are connected by an undirected edge if there exists some Whitehead move on some set of non--incident edges of $g_1$ mapping $g_1$ to $g_2$.

Then, the maximal number of edges one could choose in $g_1$ to perform a simultaneous WM is the cardinality of a maximum matching in $g_1$. Thus, determining the degree of $\Gamma_n$ as defined in this paragraph is closely related to the number of matchings in a trivalent multigraph, though the two quantities are not necessarily equal. Indeed, the number of maximum matchings in $g_1$ yields an upper bound on the degree of $g_1$ in $\Gamma_n$. 

\subsubsection{Outer space and its spine}\label{wm-related:out}

In \cite{culler1986moduli}, Culler and Vogtmann introduced a space $X_n$ on which the group $Out(F_n)$ acts. This space can be thought of as analogous to the Teichm\"uller space of a surface with the action of the mapping class group of the surface. 

The description of $X_n$ is complicated, and we will not detail it here. We will only briefly mention the relevant aspects of this object and how it could relate to our graph of graphs.

The space $X_n$ is an infinite, finite--dimensional simplicial complex. A point in a simplex in $X_n$ can be thought of as a metric graph (we assign lengths to the edges of the graph) with fundamental group $F_n$ and some labelling on its edges representing an element $\phi \in Out(F_n)$ (these are called \emph{marked metric graphs}). 
Two given $k$--simplices $x_1$ and $x_2$ share a face of codimension $1$ if passing from the representative of $x_1$ to the one of $x_2$ can be obtained by quotienting an edge and re--opening it. Thus, some simplices have open faces : the ones where collapsing an edge would change the fundamental group on the underlying graph (that is, ``killing'' a generator of $F_n$).
Note that maximal dimension simplices correspond to marked trivalent metric graphs.

The space $X_n$ admits a \emph{spine} $K_n$ which is a deformation retract of $X_n$ in which we ``forget'' about the lengths of the edges. This spine $K_n$ has the structure of a simplicial complex, in fact it can be identified with the geometric realization of the partially ordered set of open simplices of $X_n$\footnote{This is, word for word, the description given in \cite{vogtmann2002automorphisms}}. The group $Out(F_n)$ acts on $K_n$ with compact quotient. 

Our graph of graphs $\Gamma_n$ is related to $K_n/Out(F_n)$ in the following way.
First, we need to slightly modify the graph $\Gamma_n$: say $g_1, g_2 \in V(\Gamma_n)$ are connected by a directed edge from $g_1$ to $g_2$ for each edge $e \in g_1$ such that $w_e^1(g) \cong g_2$ or $w_e^2(g) \cong g_2$. That is, we record on which edge we performed the Whitehead move but not the type of Whitehead move.

A vertex $g \in \Gamma_n$ has fundamental group isomorphic to $F_n$ and thus corresponds to a simplex in $K_n/Out(F_n)$. In particular, since $g$ is a cubic graph, it corresponds to a maximal simplex in $K_n/Out(F_n)$. Thus, two vertices $g_1$ and $g_2$ are adjacent in $\Gamma_n$ if and only if the corresponding simplices in $K_n/Out(F_n)$ share a face of codimension $1$ (a \textit{wall}). 

If we set $w(g_1, g_2) = \min \{ \#E(g_1, g_2), \#E(g_2, g_1)\} $, then the number $w(g_1, g_2)$ represents the number of walls shared by the corresponding simplices in $K_n/Out(F_n)$. Moreover, the edges chosen to perform the Whitehead moves on indicate the edges to collapse to describe the shared walls. Thus, our graph of graphs can be thought as encoding adjacency between maximal simplices in $K_n/Out(F_n)$ while keeping track of their shared walls.

% \section{Open questions}\label{wm-section:open-questions}
% By analogy to the above, we can define the graph of graphs $\Gamma^{(k)}_n$ for $k$--regular graphs on $n$ vertices, with $k\geq 4$. However, in this case, most of the $k$--regular graphs will be Hamiltonian, even if they have loops. Thus, our approach by creating a bottleneck on the set of bridged graphs will not work. 

% \begin{question}
% Is $\{\Gamma^{(k)}_n\}_{n \in \mathbb{N}}$ an expander family (w.r.t. conductance) of graphs, for $k\geq 4$?
% \end{question}

% Another question is related to edge switching in trivalent graphs, cf. \cite{Fosdick}. It is easy to see that a Whitehead move can be realised as an edge switch. Thus, the switching graph $\Sigma_n$ defined in \cite{Fosdick} (with one modification: its vertices should be considered as isomorphism types of graphs), contains the graph of graphs. However, edge switching is a more ``global'' operation than a Whitehead move, and thus Theorem~\ref{wm-thm:graph-of-graphs} implies nothing about the expansion properties of the family of switching graphs.

% \begin{question}
% Is $\{\Sigma_n\}_{n \in \mathbb{N}}$ an expander family (w.r.t. conductance) of graphs?
% \end{question}

% Finally, the relation between $\Gamma_n$ and $K_n/Out(F_n)$, $n \geq 2$, described in \Cref{wm-related:out} has not been exploited in this note. We can thus formulate the following (very vague) question.

% \begin{question}
% Can the graph of graphs help understand better $Out(F_n)$? What properties of $\Gamma_n$ could yield information about $Out(F_n)$, $K_n$ or other related objects?
% \end{question}

\section*{Acknowledgements}
Both authors were supported by the Swiss National Science Foundation project no.~PP00P2--202667. This first author is now supported by the FWO and the F.R.S.--FNRS under the Excellence of Science (EOS) programme project ID~40007542.

{
\renewcommand*\MakeUppercase[1]{#1}
\bibliographystyle{alpha}							%Style alpha : les références sont notées avec nom de l'auteur et année.
\bibliography{biblio}						%On appelle la bibliographie
}
\end{document}


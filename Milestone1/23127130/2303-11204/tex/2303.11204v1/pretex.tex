\usepackage{algorithm,algorithmic,amsfonts,amsmath,amssymb,mathtools,mathrsfs,bbm,float}
\usepackage{graphicx,epic,eepic,epsfig,latexsym,verbatim,color}
\usepackage[shortlabels]{enumitem}
 
\usepackage{tikz}
\usetikzlibrary{chains}
\usetikzlibrary{fit}
\usepackage{pgflibraryarrows}		%optional
\usepackage{pgflibrarysnakes}	

\usepackage{epsfig}
\usetikzlibrary{shapes.symbols,patterns} % for source symbols
\usepackage{pgfplots}

\usepackage[strict]{changepage}
\usepackage{hyperref}
\hypersetup{colorlinks=true,citecolor=blue,linkcolor=blue,filecolor=blue,urlcolor=blue,breaklinks=true}

\usepackage[marginal]{footmisc}
\usepackage{url}
\usepackage{theorem}


\newtheorem{definition}{Definition}
\newtheorem{proposition}{Proposition}
\newtheorem{lemma}[proposition]{Lemma}

\newtheorem{fact}{Fact}
\newtheorem{theorem}[proposition]{Theorem}

\newtheorem{corollary}[proposition]{Corollary}
\newtheorem{conjecture}{Conjecture}
%%% table
 

\def\squareforqed{\hbox{\rlap{$\sqcap$}$\sqcup$}}
\def\qed{\ifmmode\squareforqed\else{\unskip\nobreak\hfil
\penalty50\hskip1em\null\nobreak\hfil\squareforqed
\parfillskip=0pt\finalhyphendemerits=0\endgraf}\fi}
\def\endenv{\ifmmode\;\else{\unskip\nobreak\hfil
\penalty50\hskip1em\null\nobreak\hfil\;
\parfillskip=0pt\finalhyphendemerits=0\endgraf}\fi}
\newenvironment{proof}{\noindent \textbf{{Proof~} }}{\hfill $\blacksquare$}

\newcounter{remark}
\newenvironment{remark}[1][]{\refstepcounter{remark}\par\medskip\noindent%
\textbf{Remark~\theremark #1} }{\medskip}


% \newenvironment{example}{\noindent \textbf{{Example~}}}{}
\newcounter{example}
\newenvironment{example}[1][]{\refstepcounter{example}\par\medskip\noindent%
\textbf{Example~\theexample #1} }{\medskip}

\newcommand{\exampleTitle}[1]{\textbf{(#1)}}
\newcommand{\remarkTitle}[1]{\textbf{(#1)}}
\newcommand{\proofComment}[1]{\exampleTitle{#1}}

\newenvironment{beweis}[1]{\noindent\textbf{Proof~{#1}~} }{\qed}

% Align := properly in math mode
\mathchardef\ordinarycolon\mathcode`\:
\mathcode`\:=\string"8000
\def\vcentcolon{\mathrel{\mathop\ordinarycolon}}
\begingroup \catcode`\:=\active
  \lowercase{\endgroup
  \let :\vcentcolon
  }

%%% boxes
\usepackage{cleveref}
\usepackage{graphicx}
\usepackage{xcolor}



\definecolor{darkblue}{RGB}{0,76,156}
\definecolor{darkkblue}{RGB}{0,0,153}
\definecolor{blue2}{RGB}{102,178,255}
\definecolor{darkred}{RGB}{195,0,0}



\RequirePackage[framemethod=default]{mdframed}
\newmdenv[skipabove=7pt,
skipbelow=7pt,
backgroundcolor=darkblue!15,
innerleftmargin=5pt,
innerrightmargin=5pt,
innertopmargin=5pt,
leftmargin=0cm,
rightmargin=0cm,
innerbottommargin=5pt,
linewidth=1pt]{tBox}


\newmdenv[skipabove=7pt,
skipbelow=7pt,
backgroundcolor=blue2!25,
innerleftmargin=5pt,
innerrightmargin=5pt,
innertopmargin=5pt,
leftmargin=0cm,
rightmargin=0cm,
innerbottommargin=5pt,
linewidth=1pt]{dBox}

\newmdenv[skipabove=7pt,
skipbelow=7pt,
backgroundcolor=darkred!15,
innerleftmargin=5pt,
innerrightmargin=5pt,
innertopmargin=5pt,
leftmargin=0cm,
rightmargin=0cm,
innerbottommargin=5pt,
linewidth=1pt]{rBox}

%%% adaptive paranthesis
% \makeatletter
% \def\resetMathstrut@{%
%     \setbox\z@\hbox{%
%         \mathchardef\@tempa\mathcode`\[\relax
%         \def\@tempb##1"##2##3{\the\textfont"##3\char"}%
%         \expandafter\@tempb\meaning\@tempa \relax
%     }%
%     \ht\Mathstrutbox@\ht\z@ \dp\Mathstrutbox@\dp\z@}
% \makeatother
% \begingroup
% \catcode`(\active \xdef({\left\string(}
% \catcode`)\active \xdef){\right\string)}
% \endgroup
% \mathcode`(="8000 \mathcode`)="8000

\newcommand{\nc}{\newcommand}
% \nc{\rnc}{\renewcommand}
% \nc{\beg}{\begin{equation}}
% \nc{\eeq}{\end{equation}}
% \nc{\beqa}{\begin{eqnarray}}
% \nc{\eeqa}{\end{eqnarray}}
% \nc{\lbar}[1]{\overline{#1}}
\nc{\bra}[1]{\langle#1|}
\nc{\ket}[1]{|#1\rangle}
\nc{\ketbra}[2]{|#1\rangle\!\langle#2|}
\nc{\braket}[2]{\langle#1|#2\rangle}
\newcommand{\braandket}[3]{\langle #1|#2|#3\rangle}

\nc{\proj}[1]{| #1\rangle\!\langle #1 |}
\nc{\avg}[1]{\langle#1\rangle}
%\rnc{\max}{\operatorname{max}}
\nc{\rank}{\operatorname{Rank}}
\nc{\smfrac}[2]{\mbox{$\frac{#1}{#2}$}}
\nc{\tr}{\operatorname{tr}}
\nc{\ox}{\otimes}
\nc{\dg}{\dagger}
\nc{\dn}{\downarrow}
\nc{\cA}{{\cal A}}
\nc{\cB}{{\cal B}}
\nc{\cC}{{\cal C}}
\nc{\cD}{{\cal D}}
\nc{\cE}{{\cal E}}
\nc{\cF}{{\cal F}}
\nc{\cG}{{\cal G}}
\nc{\cH}{{\cal H}}
\nc{\cI}{{\cal I}}
\nc{\cJ}{{\cal J}}
\nc{\cK}{{\cal K}}
\nc{\cL}{{\cal L}}
\nc{\cM}{{\cal M}}
\nc{\cN}{{\cal N}}
\nc{\cO}{{\cal O}}
\nc{\cP}{{\cal P}}
\nc{\cQ}{{\cal Q}}
\nc{\cR}{{\cal R}}
\nc{\cS}{{\cal S}}
\nc{\cT}{{\cal T}}
\nc{\cU}{{\cal U}}
\nc{\cV}{{\cal V}}
\nc{\cX}{{\cal X}}
\nc{\cY}{{\cal Y}}
\nc{\cZ}{{\cal Z}}
\nc{\cW}{{\cal W}}
\nc{\csupp}{{\operatorname{csupp}}}
\nc{\qsupp}{{\operatorname{qsupp}}}
\nc{\var}{{\operatorname{var}}}
\nc{\rar}{\rightarrow}
\nc{\lrar}{\longrightarrow}
\nc{\polylog}{{\operatorname{polylog}}}
%\nc{\1}{{\mathds{1}}}
\nc{\wt}{{\operatorname{wt}}}
% \nc{\av}[1]{{\left\langle {#1} \right\rangle}}
\nc{\supp}{{\operatorname{supp}}}

\nc{\argmin}{{\operatorname{argmin}}}
\nc{\pd}[2]{\frac{\partial #1}{\partial #2}}

\def\a{\alpha}
\def\b{\beta}
\def\di{\diamondsuit}
\def\d{\delta}
\def\e{\epsilon}
\def\ve{\varepsilon}
\def\z{\zeta}
\def\h{\eta}
\def\t{\theta}
\def\i{\mathbf{i}}
\def\k{\kappa}
\def\ll{\lambda}
\def\m{\mu}
\def\n{\nu}
\def\x{\xi}
\def\p{\pi}
\def\r{\rho}
\def\s{\sigma}
\def\ta{\tau}
\def\u{\upsilon}
\def\ph{\varphi}
\def\c{\chi}
\def\ps{\psi}
\def\o{\omega}

\def\G{\Gamma}
\def\D{\Delta}
\def\T{\Theta}
\def\L{\Lambda}
\def\X{\Xi}
\def\P{\Pi}
\def\S{\Sigma}
\def\U{\Upsilon}
\def\Ph{\Phi}
\def\Ps{\Psi}
\def\O{\Omega}
\def\w{\omega}

\nc{\RR}{{{\mathbb R}}}
\nc{\CC}{{{\mathbb C}}}
\nc{\FF}{{{\mathbb F}}}
\nc{\NN}{{{\mathbb N}}}
\nc{\ZZ}{{{\mathbb Z}}}
\nc{\PP}{{{\mathbb P}}}
\nc{\QQ}{{{\mathbb Q}}}
\nc{\UU}{{{\mathbb U}}}
\nc{\EE}{{{\mathbb E}}}
\nc{\id}{{\operatorname{id}}}
\newcommand{\cvartheta}{{\widetilde\vartheta}}
\nc{\CHSH}{{\operatorname{CHSH}}}

\newcommand{\Op}{\operatorname}
% wcl
% \nc{\be}{\begin{equation}}
% \nc{\ee}{\end{equation}}
% \nc{\bea}{\begin{eqnarray}
% \nc{\eea}{\end{eqnarray}}
% \nc{\<}{\langle}
% \rnc{\>}{\rangle}
% \nc{\Hom}[2]{\mbox{Hom}(\CC^{#1},\CC^{#2})}
\nc{\rU}{\mbox{U}}
\def\lpmm{ \left(\rule{0pt}{1.8ex}\right. \! }
\def\rpmm{ \! \left.\rule{0pt}{1.8ex}\right) }
\def\lbm{ \left[\rule{0pt}{2.1ex}\right. }
\def\rbm{ \left.\rule{0pt}{2.1ex}\right] }
\def\lpm{ \left(\rule{0pt}{2.1ex}\right. \!}
\def\rpm{ \!\left.\rule{0pt}{2.1ex}\right) }
\def\lbL{ \left[\rule{0pt}{2.4ex}\right. \!}
\def\rbL{ \!\left.\rule{0pt}{2.4ex}\right] }
\def\lpL{ \left(\rule{0pt}{2.4ex}\right.\!\!}
\def\rpL{ \!\! \left.\rule{0pt}{2.4ex}\right)}
\def\lpH{ \left(\rule{0pt}{3.0ex}\right.\!\!}
\def\rpH{ \!\! \left.\rule{0pt}{3.0ex}\right)}
\def\llH{ \left|\rule{0pt}{3.0ex}\right.\!}
\def\rlH{ \!\left.\rule{0pt}{3.0ex}\right|}
\def\llL{ \left|\rule{0pt}{2.4ex}\right.\!}
\def\rlL{ \!\left.\rule{0pt}{2.4ex}\right|}
\def\llm{ \left|\rule{0pt}{2.1ex}\right.\!}
\def\rlm{ \!\left.\rule{0pt}{2.1ex}\right|}
% switching between |i> or |e_i> for the standard basis
% \nc{\ob}[1]{e_{#1}}
\nc{\ob}[1]{#1}
\nc{\Var}[1]{\Op{Var}[#1]}

\nc{\SEP}{{\text{\rm SEP}}}
\nc{\NS}{{\text{\rm NS}}}
\nc{\LOCC}{{\text{\rm LOCC}}}
\nc{\PPT}{{\text{\rm PPT}}}
\nc{\EXT}{{\text{\rm EXT}}}
% \nc{\NS}{{\text{NS}}}
\nc{\Sym}{{\operatorname{Sym}}}

%\nc{\ln}{{\text{ln}}}

\nc{\ERLO}{{E_{\text{r,LO}}}}
\nc{\ERLOCC}{{E_{\text{r,LOCC}}}}
\nc{\ERPPT}{{E_{\text{r,PPT}}}}
\nc{\ERLOCCinfty}{{E^{\infty}_{\text{r,LOCC}}}}
\nc{\Aram}{{\operatorname{\sf A}}}
\newtheorem{problem}{Problem}
\newtheorem{note}[problem]{Note}

\newcommand{\Choi}{Choi-Jamio\l{}kowski }
\newcommand{\eps}{\varepsilon}
\newcommand{\CPTP}{\text{\rm CPTP}}

%\RequirePackage{doi}
\usepackage{hyperref}
\hypersetup{colorlinks=true,citecolor=blue,linkcolor=blue,filecolor=blue,urlcolor=blue,breaklinks=true}

%% tikz corrodinate
\makeatletter
\def\grd@save@target#1{%
  \def\grd@target{#1}}
\def\grd@save@start#1{%
  \def\grd@start{#1}}
\tikzset{
  grid with coordinates/.style={
    to path={%
      \pgfextra{%
        \edef\grd@@target{(\tikztotarget)}%
        \tikz@scan@one@point\grd@save@target\grd@@target\relax
        \edef\grd@@start{(\tikztostart)}%
        \tikz@scan@one@point\grd@save@start\grd@@start\relax
        \draw[minor help lines,magenta] (\tikztostart) grid (\tikztotarget);
        \draw[major help lines] (\tikztostart) grid (\tikztotarget);
        \grd@start
        \pgfmathsetmacro{\grd@xa}{\the\pgf@x/1cm}
        \pgfmathsetmacro{\grd@ya}{\the\pgf@y/1cm}
        \grd@target
        \pgfmathsetmacro{\grd@xb}{\the\pgf@x/1cm}
        \pgfmathsetmacro{\grd@yb}{\the\pgf@y/1cm}
        \pgfmathsetmacro{\grd@xc}{\grd@xa + \pgfkeysvalueof{/tikz/grid with coordinates/major step}}
        \pgfmathsetmacro{\grd@yc}{\grd@ya + \pgfkeysvalueof{/tikz/grid with coordinates/major step}}
        \foreach \x in {\grd@xa,\grd@xc,...,\grd@xb}
        \node[anchor=north] at (\x,\grd@ya) {\pgfmathprintnumber{\x}};
        \foreach \y in {\grd@ya,\grd@yc,...,\grd@yb}
        \node[anchor=east] at (\grd@xa,\y) {\pgfmathprintnumber{\y}};
      }
    }
  },
  minor help lines/.style={
    help lines,
    step=\pgfkeysvalueof{/tikz/grid with coordinates/minor step}
  },
  major help lines/.style={
    help lines,
    line width=\pgfkeysvalueof{/tikz/grid with coordinates/major line width},
    step=\pgfkeysvalueof{/tikz/grid with coordinates/major step}
  },
  grid with coordinates/.cd,
  minor step/.initial=.2,
  major step/.initial=1,
  major line width/.initial=2pt,
}
\makeatother


% restatable problems environment
\usepackage{thmtools}
\usepackage{thm-restate}
\usepackage{etoolbox}
\makeatletter
\def\problem@s{}
\newcounter{problems@cnt}
\declaretheorem[name=\textcolor{darkred}{Problem}]{thmproblem}
\newenvironment{problems}{%
  \stepcounter{problems@cnt}%
  % fully expand the counter representation
  % before calling \restatable
  \begingroup\edef\x{\endgroup
    \noexpand\restatable{thmproblem}{problem\Alph{problems@cnt}}%
  }\x
}{\endrestatable
  % add to \problem@s the command
  % \problem<letter>*
  \xappto\problem@s{%
    \expandafter\noexpand\csname problem\Alph{problems@cnt}\endcsname*%
  }%
}
\newcommand{\allproblems}{\problem@s}
\makeatother
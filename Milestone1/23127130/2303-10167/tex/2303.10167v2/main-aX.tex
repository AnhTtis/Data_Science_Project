\documentclass[sn-mathphys]{sn-jnl}% Math and Physical Sciences Reference Style
%%\documentclass[sn-aps]{sn-jnl}% American Physical Society (APS) Reference Style
%%\documentclass[sn-vancouver]{sn-jnl}% Vancouver Reference Style
%%\documentclass[sn-apa]{sn-jnl}% APA Reference Style
%%\documentclass[sn-chicago]{sn-jnl}% Chicago-based Humanities Reference Style
%%\documentclass[sn-standardnature]{sn-jnl}% Standard Nature Portfolio Reference Style
%%\documentclass[default]{sn-jnl}% Default
%%\documentclass[default,iicol]{sn-jnl}% Default with double column layout

%%%% Standard Packages
%%<additional latex packages if required can be included here>
%%%%
\usepackage{amsmath,mathtools,enumerate}
\usepackage[numbers]{natbib}

%%%%%=============================================================================%%%%
%%%%  Remarks: This template is provided to aid authors with the preparation
%%%%  of original research articles intended for submission to journals published 
%%%%  by Springer Nature. The guidance has been prepared in partnership with 
%%%%  production teams to conform to Springer Nature technical requirements. 
%%%%  Editorial and presentation requirements differ among journal portfolios and 
%%%%  research disciplines. You may find sections in this template are irrelevant 
%%%%  to your work and are empowered to omit any such section if allowed by the 
%%%%  journal you intend to submit to. The submission guidelines and policies 
%%%%  of the journal take precedence. A detailed User Manual is available in the 
%%%%  template package for technical guidance.
%%%%%=============================================================================%%%%

\jyear{2022}%

% equation environments
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
\newcommand{\beqa}{\begin{eqnarray}}
\newcommand{\eeqa}{\end{eqnarray}}


\newcommand{\bfy}{\boldsymbol{y}}
\newcommand{\bfX}{\boldsymbol{X}}
\newcommand{\bfeps}{\boldsymbol{\eps}}
\newcommand{\bfdelta}{\boldsymbol{\delta}}
\newcommand{\bfone}{\boldsymbol{1}}
%\newcommand{\bfQ}{\boldsymbol{Q}}
\newcommand{\bfzero}{\boldsymbol{0}}

\newcommand{\bfB}{\boldsymbol{B}}
%%\newcommand{\bfA}{\boldsymbol{A}}
%%\newcommand{\bfR}{\boldsymbol{R}}

\newcommand{\dd}{\mathrm{d}}
\newcommand{\sdef}{\stackrel{def}{=}}
\newcommand{\Rbb}{\mathbb{R}}
\newcommand{\bfQ}{\boldsymbol{Q}}
\newcommand{\bfD}{\boldsymbol{D}}
\newcommand{\bfw}{\boldsymbol{w}}
\newcommand{\bfR}{\boldsymbol{R}}

%% as per the requirement new theorem styles can be included as shown below
\theoremstyle{thmstyleone}%
\newtheorem{theorem}{Theorem}%  meant for continuous numbers
%%\newtheorem{theorem}{Theorem}[section]% meant for sectionwise numbers
%% optional argument [theorem] produces theorem numbering sequence instead of independent numbers for Proposition
\newtheorem{proposition}[theorem]{Proposition}% 
%%\newtheorem{proposition}{Proposition}% to get separate numbers for theorem and proposition etc.

\theoremstyle{thmstyletwo}%
\newtheorem{example}{Example}%
\newtheorem{remark}{Remark}%

\theoremstyle{thmstylethree}%
\newtheorem{definition}{Definition}%

\raggedbottom
%%\unnumbered% uncomment this for unnumbered level heads

\begin{document}

\title[Generalized PaLD]{Generalized partitioned local depth}

%%=============================================================%%
%% Prefix	-> \pfx{Dr}
%% GivenName	-> \fnm{Joergen W.}
%% Particle	-> \spfx{van der} -> surname prefix
%% FamilyName	-> \sur{Ploeg}
%% Suffix	-> \sfx{IV}
%% NatureName	-> \tanm{Poet Laureate} -> Title after name
%% Degrees	-> \dgr{MSc, PhD}
%% \author*[1,2]{\pfx{Dr} \fnm{Joergen W.} \spfx{van der} \sur{Ploeg} \sfx{IV} \tanm{Poet Laureate} 
%%                 \dgr{MSc, PhD}}\email{iauthor@gmail.com}
%%=============================================================%%

\author*[1]{\fnm{Kenneth S.} \sur{Berenhaut}}\email{berenhks@wfu.edu}
\equalcont{These authors contributed equally to this work.}
\author[2]{\fnm{John D.} \sur{Foley}}\email{foley@metsci.com}
\equalcont{These authors contributed equally to this work.}

\author[1,3]{\fnm{Liangdongsheng} \sur{Lyu}}\email{ll675@cam.ac.uk}


\affil*[1]{\orgdiv{Department of Statistical Sciences}, \orgname{Wake Forest University}, \orgaddress{\street{127 Manchester Hall}, \city{Winston-Salem}, \postcode{27109}, \state{NC}, \country{USA}}}

\affil[2]{\orgname{Metron, Inc.}, \orgaddress{\street{1818 Library St., \# 600}, \city{Reston}, \postcode{20190}, \state{VA}, \country{USA}}}

\affil[3]{\orgdiv{Department of Pure Mathematics and Mathematical Statistics}, \orgname{University of Cambridge}, \orgaddress{\street{Wilberforce Road}, \city{Cambridge}, \postcode{CB3 0WA}, \country{UK}}}


\abstract{In this paper we provide a generalization of the concept of cohesion as introduced recently by Berenhaut, Moore and Melvin [{\em Proceedings of the National Academy of Sciences}, {\bf 119} (4) (2022)]. The formulation presented builds on the technique of partitioned local depth by distilling two key probabilistic concepts: {\em local relevance} and {\em support division}. Earlier results are extended within the new context, and examples of applications to revealing communities in data with uncertainty are included.}

%%==================================%%
%% sample for unstructured abstract %%
%%==================================%%

% \abstract{The abstract serves both as a general introduction to the topic and as a brief, non-technical summary of the main results and their implications. Authors are advised to check the author instructions for the journal they are submitting to for word limits and if structural elements like subheadings, citations, or equations are permitted.}

\keywords{community structure, networks, cohesion, local depth}

\maketitle

\section{Introduction}\label{intro}


Uncovering structural communities and clusters within complex data can be of interest across disciplines. In \cite{bmm22}, the authors harness the richness of a social perspective to derive community network structure in the presence of heterogeneity. Therein, a key concept of locality to a pair of data points is provided leading to informative measures of (local) depth and cohesion. In this paper, we provide a generalization of this approach, by distilling two key probabilistic concepts: {\em local relevance} and {\em support division}.

The notion of {\em local (community) depth} introduced in \cite{bmm22} builds on existing approaches to data depth (see for instance \cite{kleindessner2017lens,zuo2000general}). Partitioning the probabilities defining local depth leads to a quantity referred to as {\em cohesion}, which can be understood as a measure of locally perceived closeness. The resulting framework also gives rise to a natural threshold for distinguishing strongly and weakly cohesive pairs and provides an alternative perspective for the concept of near neighbors. Topological features of the data can be considered via networks of pairwise cohesion, and meaningful structure can be identified without additional inputs (e.g., number of clusters or neighborhood size), optimization criteria, iterative procedures, or distributional assumptions.
For a review of the general method, referred to as {\em partitioned local depth} (PaLD), see Section \ref{form}; for further details see \cite{bmm22}, and the references therein.

It is crucial to note the importance of accounting for varying local density, particularly in applications involving complex evolutionary processes (see, for instance,  \cite{campello2020density,breunig2000lof, domingues2018comparative, everitt1979unresolved}, and examples in \cite{bmm22}). In \cite{bmm22}, relative positioning is considered through distance comparisons within triples of points, which may be of value in nonmetric and high-dimensional settings. 

% Here, we build on the probabilistic framework for PaLD, by considering two key probabilistic concepts: {\em local relevance} and {\em support division}. Local relevance, quantifies the relevance of points to direct pair-wise comparisons, while support division captures how such points divide closeness between members in pairs of interest. Integrating these concepts allows PaLD to be applicable to problems wherein relative comparisons may be inherently uncertain. 

Now, consider a given finite set of interest, $S$. If, for $x,y,z\in S$, we have definitive answers to questions of the form ``Is $z$ more similar to $x$ than to $y$?'', then PaLD community analysis can proceed directly \cite{bmm22,bddp22}.  
Still, these may not be the most informative answers to such queries.  For example, answers might instead have inherent variability, e.g.,  80\% of information available suggests that $z$ is more similar to $x$ than to $y$. It may, on the other hand, be the case that there is some true, definitive answer but this answer is subject to inherent uncertainty.

\vspace{.2in}

\noindent {\bf Example.}  Figure \ref{fig_cultural} displays community structure for cultural distance information obtained in \cite{mu20} from two recent waves of the World Values Survey (2005 to 2009 and 2010 to 2014) \cite{in14}. Distances are computed using the cultural fixation index (CFST), which is a measure built on the framework of fixation indices from population biology \cite{bell2009culture,cavalli1994history}. Note that PaLD employs within-triplet comparisons and allows for the employment of such application-dependent, non-Euclidean measures of dissimilarity.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{CountryCommunities.png}
\caption{Cultural communities from survey data; adapted from \cite{bmm22} with permission.}
\label{fig_cultural}
\end{figure}
% India, though, are culturally distinct from other regions, relatively and locally, in a collective fashion, and 

The data reflects that while, culturally speaking, regions within the United States are far more similar to each other than regions within India, the latter displays similar levels of strong internal cohesion. In Figure \ref{fig_cultural}A coloured edges correspond to strong mutual cohesion as result from partitioning local depths. See Section \ref{form}, below, for a review of the derivation of such networks. \qed

\vspace{.2in}

% The distance structure employed in the above example suggests potential value in a generalization of PaLD that does not require definitive dissimilarity comparisons. The PaLD approach can provide valuable structure so long as informative distance comparisons are discernible (see \cite{bmm22}). 

The remainder of the paper proceeds as follows. In Section 2, we provide some preliminaries and notation, including a review of the development of PaLD as introduced in \cite{bmm22}. Section 3 provides an introduction to the abstracted concepts of local relevance and support division, and the given generalization of PaLD, and Section 4 follows with theoretical results on properties of cohesion mirroring those in \cite{bmm22}, for the new scenario. Section 5 includes mention of potential applications to multiple dissimilarity measures, event-based data and data uncertainty.

We now turn to some preliminaries and notation.

\section{Preliminaries and notation}\label{form}

Suppose $S=\{a_1,a_2,\dots, a_n\}$ is a finite set with a corresponding notion of pairwise dissimilarity or distance $\dd: S \times S \rightarrow \Rbb $.  For any pair $(x,y)\in S\times S$, the set of relevant local data, $U_{x,y}$, is defined to be the set of elements $z\in S$ which are as close to $x$ as $y$ is to $x$, or as close to $y$ as $x$ is to $y$, i.e.  
\beq
U_{x,y} \sdef \{z \in S \mid \dd(z,x) \le \dd(y,x)  ~{\rm or }~ \dd(z,y) \le \dd(x,y)\}.
\label{local_focus}
\eeq
From a social perspective, the set, $U_{x,y}$, local to the pair of individuals $(x,y)$, consists of individuals with alignment-based impetus for involvement in a ``conflict" between $x$ and $y$ (see Section {\it Social Framework} in \cite{bmm22} for discussion of the underlying social latent space and related references). In the case of a symmetric distance, $U_{x,y}$ is comprised of those $z$ as close to $x$ or $y$ as they are to each other. The sense of local could be altered depending on applications.

The local depth of $x$, $\ell_S(x)$, is a measure of local support, which leverages the concept of local that is implicit in the definition of  $\{ U_{x,y} \}$:
\beq
\ell(x)\sdef \ell_{S,\dd}(x) = P(\dd(Z,x)<\dd(Z,Y))+ \frac{1}{2} P(\dd(Z,x)=\dd(Z,Y)), \label{local_depth}
\eeq
where $Y$ is selected uniformly at random from the set $S\setminus\{x\}$ and $Z$ is selected uniformly at random from the local set $U_{x,Y}$ (see Figure \ref{fig_Uxy}). For convenience, the term resolving ties in distance (via coin flip), in (\ref{local_depth}), will be suppressed in what follows.
The important concept of cohesion can then be obtained through partitioning of the probabilities defining $\ell$. In particular, we have that $C_{x,w}$, the cohesion of $w$ to $x$, is given by
\beq
C_{x,w}\sdef P\left( Z=w,\dd(Z,x)<\dd(Z,Y) \right).  \label{cohesion}
\eeq
\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\textwidth,trim={2cm 4cm 2cm 5cm},clip]{RMplotnewxrandYrandZ6.pdf}
\caption{The local focus for a fixed point $x$ and a random point $Y$, in two-dimensional Euclidean space. The points in red are outside the focus. Those in green (and $Z$ in blue) are in the focus and closer to $x$ while those in grey are closer to $Y$.}
\label{fig_Uxy}
\end{figure}

The \emph{cohesion network} is the weighted, directed graph with node set $S$ and edge weights $\{C_{x,w}\}$; typically, an undirected version is displayed by considering the minimum of the bi-directional cohesions for each edge pair, with thicker edges depicting larger weights. Unless stated otherwise, we will employ the Fruchterman-Reingold algorithm \cite{fruchterman1991graph} to display cohesion networks. Through cohesion, the dissimilarity measure, $\dd$, is locally adapted, to reflect relative locally-based support (see, for example Figure \ref{fig_cultural}). For additional discussion and applications of PaLD, in the context of considerations of data depth, embedding, clustering and near-neighbours see \cite{bmm22}.

As mentioned, though PaLD is formulated in terms of $\dd$, the above definitions in (\ref{local_focus}), (\ref{local_depth}) and (\ref{cohesion}) depend only on \emph{relative} closeness comparisons--e.g., whether $z$ is closer to $x$ than it is to $y$. Thus, as has been observed in \cite{bmm22,bddp22}, an oracle for triplet comparisons is sufficient to determine the directed cohesion network.  
%In essence, given a look up table to compare all triplets, a cohesion network can be determined. 
Note that previous work has suggested that one can often more reliably provide distance comparisons than exact numerical evaluations \cite{kleindessner2017lens, ukkonen2017crowdsourced}. 

As we will see in the next section, due to its probabilistic formulation, PaLD is quite readily adapted to include uncertain dissimilarities.

\section{Generalized PaLD} \label{formu}

Whereas membership of a given $z$ in the local focus $U_{x,y}$ is assumed to be captured by an indicator in $\{0, 1\}$ in (\ref{local_focus}), we will generalize the notion of ``locality'' to a pair $(x,y)$, probabilistically. In a similar manner, support from $Z$ can be formulated stochastically, to give generalized concepts of local depth as in (\ref{local_depth}) and cohesion as in (\ref{cohesion}).          

\vspace{.2in}

% \begin{wrapfigure}{l}{0.25\textwidth} %this figure will be at the left
%     \centering
%     \includegraphics[width=0.28\textwidth]{Generative.png}
% \end{wrapfigure}

\noindent {\bf Example.} Before proceeding with formal definitions, consider the simple generative process for triplet comparisons depicted in Figure \ref{fig_generative}. Here we assume that $x$, $y$ and $z$ do not have fixed locations and instead are observed randomly in neighborhoods of corresponding base locations\footnote{The base locations could be the true locations for fixed objects that are observed with random noise, or the center of a localized distribution.}. We could be interested in evaluating long-run probabilities for events such as $\dd(z,x)<\dd(y,x)$  or $\dd(z,x)<\dd(z,y)$. Note that absolute comparisons may not be fully informative, here. \qed  
% For example, a probability $p \in [0, 1]$ for the event $\dd(z,x)<\dd(z,y)$ can model $z$ being closer to $x$ than $y$ for a proportion $p$ of observations.  

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.35\textwidth]{Generative.png}
\caption{Conceptual generative process for \emph{random} triplet comparisons.}
\label{fig_generative}
\end{figure}

We now introduce the abstracted concepts of local relevance and support division. 

\subsection{Local relevance and support division} \label{lrsd} 
We are interested in generalized definitions of local focus, local depth and cohesion, which reflect uncertainty in dissimilarities. 
% Loosely speaking, {\em local relevance} quantifies how locally relevant a third party is to two competing entities, while {\em support division} captures a division of support between two entities from a third party. 
% These new, probabilistic concepts capture fundamental aspects of local structure, and provide essential elements for revealing communities in data via PaLD. 

For fixed $x,y\in S$, membership in the local focus $U_{x,y}$ can be generalized as follows. 
For each $x,y,z\in S$, define the {\em local relevance of $z$ to the pair $(x,y)$}, $R_{x,y,z}$, via
\beq
R_{x,y,z}\sdef P( z \mbox{ is local to the pair } (x,y) );
\label{local_relevance}
\eeq

\noindent we may also consider the full array, $\bfR \sdef [R_{x,y,z}]$. To obtain constructions for local depth and cohesion, here, we require a mechanism to sample an element, $Z\in S$, local to $(x,y)$. For this, we consider the process of selecting uniformly at random an element $\tilde{Z}\in S$, and with probability $R_{x,y,\tilde{Z}}$ taking this as the value of $Z$, repeating the process until a $Z$ is determined. It is not difficult to see that, for $z\in S$,
\beq
P\left( Z=z \right) = P_{x,y}\left( Z=z \right) = \frac{R_{x,y,z}}{\sum_{w\in S} R_{x,y,w}}.\label{sample_Z}
\eeq
 % Note that compared to (\ref{local_focus}) the present reformation of local relevance (\ref{local_relevance})  a property $R_{x,y,z}$ of the triple $(x,y,z)$ in lieu membership in a set $z \in U_{x,y}$ allows for customized handling the situation when 
 % $d(z,x) = d(y,x)$ (or  $d(z,y) = d(x,y)$).  Though this issue is often not significant when $d$ takes continuous values, it may be require consideration for discrete values $d$--e.g., shortest path lengths in a simple graph--if ``ties'' occur frequently.
% The support from a locally relevant $Z$ to the pair $(x,y)$ can be agglomerated to arrive at a probabilistically defined measure of local depth which can then be partitioned to obtain cohesion, as before. %As we will discuss in greater detail  in \ref{results}, the total amount of support is a conserved quantity under assumptions 
\noindent Setting
\beq
Q_{x,y,z}\sdef P( z \mbox{ supports $x$ over $y$}),
\label{support_division}
\eeq
\noindent and $\bfQ\sdef[Q_{x,y,z}]$, the {\em local depth} of $x$ is then given by
\beq
\ell(x)\sdef \ell_{S,\bfR,\bfQ}(x) := P(\mbox{$Z$ supports $x$}), 
\label{local_depth_gen}
\eeq  
where, $Y$ is selected uniformly from $S\setminus \{x\}$, and $Z$ is selected local to the pair $(x,Y)$ with relative weight as in (\ref{sample_Z}).  Likewise, the {\em cohesion} of $w$ to $x$, $C_{x,w}$, generalizes directly as in (\ref{cohesion}):
\beq
C_{x,w}\sdef P( Z=w,\mbox{$Z$ supports $x$}).
\eeq

% Note that the issue of ties is directly part of the formulation. The coin flip introduced in  (\ref{local_depth}), under a distance function $\dd$, corresponds to the convention that when $\dd(z,x)=\dd(z,y)$, the support from z is divided evenly between $x$ and $y$.  

We will assume, throughout, the following basic structural properties on the arrays $\bfR$ and $\bfQ$. Suppose $x,y,z\in S$, 

\vspace{.2in}

\noindent (a) $0 \leq R_{x,y,z},Q_{x,y,z} \leq 1$,    
~~~~~~ (b) $R_{x,y,z}=R_{y,x,z}$,\\
(c)  $Q_{x,y,z}=1-Q_{y,x,z}$,
 ~~~~~~~~~   (d) $R_{x,y,x}=R_{x,y,y}=1$.

% \begin{enumerate}[(a)]
% \item $0 \leq Q_{x,y,z},R_{x,y,z} \leq 1$,
% \item $R_{x,y,z}=R_{y,x,z}$,
% \item $Q_{x,y,z}=1-Q_{y,x,z}$,
% \item $R_{x,y,x}=R_{x,y,y}=1$.
% \end{enumerate}
\vspace{.2in}

\noindent In (a), we are expressing the fact that the entries in $\bfR$ and $\bfQ$ represent probabilities; in (b), we have that local relevance does not depend on the ordering of $x$ and $y$, (c) reflects the fact that $Z$ supports either $x$ or $y$ (and there is no loss in probability) and (d) states that any individual is locally relevant to any pair in which it is an element. 

An algorithmic formalization of PaLD, generalized for uncertainty, then follows as in Figure \ref{fig_reference}. The implementation takes the specification of local relevance and support division (through $\bfR$ and $\bfQ$, respectively) as input, to output cohesion. 
% In particular,
% \begin{itemize}
%     \item sampling $Y \neq x$ appears as the factor $1/(n-1)$;
%     \item sampling a locally relevant $Z$ appears as the factor ${R_{ijz}}/({\sum_{w} R_{ijw}})$; and
%     \item dividing support from $Z$ appears as the factor $Q_{ijz}$.
% \end{itemize}

\begin{figure}[H]
     \centering
{
\fbox{%
    \parbox{0.9\textwidth}{ %\small
    {\bf Algorithm} Computing the matrix of partitioned local depths, $C=[C_{x,w}]$.
    
   \vspace{1mm}
    {\bf Input:} arrays $R$ and $Q$ of size $n \times n \times n $:

     \vspace{-.3in}
     
\beqa
R_{ijz} &=& P\left( z {\rm ~ is ~ local ~ to ~ the ~ pair ~} (i,j) \right) {\rm ~~ and}  \nonumber \\ 
Q_{ijz} &=& P\left( z {\rm ~ supports ~} i {\rm ~ over ~} j  \right)
\nonumber
\eeqa

 \vspace{-.1in}
 
{\bf function} PaLD($R$,$Q$)

\hspace*{4mm} 
$C \leftarrow {\{0\}}_{i,j=1}^n$

\hspace*{4mm} 
{\bf for} $i=1$ to $n$ %{\bf do}

\hspace*{4mm} \hspace*{4mm} 
{\bf for} $j=1$ to $n$ satisfying $j\neq i$ %{\bf do}

\hspace*{4mm} \hspace*{4mm} \hspace*{4mm}
{\bf for} $z=1$ to $n$ %{\bf do}

\hspace*{4mm} \hspace*{4mm} \hspace*{4mm} \hspace*{4mm}
$C_{iz} \leftarrow C_{iz} + \frac{1}{n-1}
%\left( 
\frac{R_{ijz}}{\sum_{w} R_{ijw}} 
%\right)  
Q_{ijz}$
% \hspace*{4mm} 
% $C \leftarrow C / (n-1)$

\hspace*{4mm} 
{\bf return} $C$
}
}
}
\vspace{.1in}

  \caption{Pseudo-code for the reference implementation of the generalized PaLD algorithm. The output is the matrix of cohesion values describing pair-wise relationship cohesion. Local depths can be obtained from the row sums of the output matrix, $C$.}
  \label{fig_reference}
\end{figure}

Note that for a given distance function $\dd:S\times S\rightarrow \Rbb$, setting
\beqa
R_{x,y,z} &=& \begin{cases}
1, & \text{if } z\in U_{x,y} \\
0, & \text{otherwise}
\end{cases}, \label{RPaLD}
\eeqa
\noindent and 
\beqa
Q_{x,y,z} &=& 
\begin{cases}
1, & \text{if } \dd(z, x) < \dd(z, y) \\
1/2, & \text{if } \dd(z, x) = \dd(z, y)\\
0, & \text{otherwise}
\end{cases}, \label{QPaLD}
\eeqa

\noindent the 
computation
 of cohesion in \cite{bmm22} is recovered.  
 
Before turning to some applications, we summarize some theoretical results, which generalize and shed light on those given in \cite{bmm22}. 

\section{Results} \label{results}

In this section, we provide results regarding properties of cohesion, mirroring those in \cite{bmm22}, including  (a) {\em dissipation of cohesion under separation}, (b) {\em irrelevance of density under separation}, and (c) {\em dissipation of cohesion for concentrated sets of increasing size}, in the context of uncertainty; proofs can be found in Appendix \ref{proofs}. Throughout, unless stated otherwise, we will assume that the arrays $\bfR$ and $\bfQ$ are fixed, and satisfy the basic assumptions (a)--(d), listed in Section \ref{lrsd}. In addition, $x\in S$ is fixed, $Y$ is selected uniformly at random from $S\setminus \{x\}$ and $Z$ is selected as in Eq. (\ref{sample_Z}).

We begin with three definitions regarding structural properties of the set $S$ with respect to the arrays $\bfR$ and $\bfQ$. The first provides conditions under which two disjoint subsets, $A$ and $B$, of $S$ are {\em sufficiently separated}. In essence, for $c,c^*\in A$ and $d \in B$, $c^*$ is local to the pair $(c,d)$ and fully supports $c$ in that context, while $d$ is not local to the pair $(c,c^*)$.

\vspace{.2in}

\noindent {\bf Definition.} (Sufficiently Separated) Suppose $A,B\subseteq S$. The set $A$ is said to be \textit{sufficiently separated from} $B$ (with respect to $\bfR$ and $\bfQ$) if $A\cap B =\emptyset$, and for all $c,c^*\in A$ and $d\in B$, the following hold:

\noindent ~~~~ (a) $R_{c,d,c^*}=1$,~~~ (b) $R_{c,c^*,d}=0$, 
~~~ (c) $Q_{c,d,c^*}=1$,
% ~~~ (d) $Q_{c,,d}=0$.



\noindent The sets $A$ and $B$ are said to be (mutually) \textit{sufficiently separated} if $A$ is \textit{sufficiently separated from} $B$, and $B$ is sufficiently separated $A$. \hfill \qed

\vspace{.2in}

The second definition is crucial to stating Theorem \ref{irrel_dens}, and addresses equivalence of {\em ordinal} structure for two subsets of $S$ of equal cardinality. 

\vspace{.2in}

\noindent {\bf Definition.} (Equivalence of Ordinal Structure) Suppose two sets $A,B$ satisfy $A=\{a_1,a_2,\dots,a_m\}$, and $B=\{b_1,b_2,\dots,b_m\}$, then $A$ and $B$ are said to have \textit{equivalent ordinal structure}, if they are $(\bfR,\bfQ)$-equivalent, i.e, for $i,j,k\in \{1,2,\dots,m\}$, 
\beq 
R_{a_i,a_j,a_k}=R_{b_i,b_j,b_k} \mbox{    and    } Q_{a_i,a_j,a_k}=Q_{b_i,b_j,b_k}. 
\eeq
\hfill \qed

\vspace{.2in}

Finally, the following definition suggests a point-like property of one subset, $B \subseteq S$, with respect to another, $A$. In particular if locality to any given pair of elements of $A$ is constant over the set $B$, and all elements of $B$ fully support other elements of $B$ in comparisons with elements of $A$, then $B$ is concentrated with respect to $A$.

\vspace{.2in}

\noindent {\bf Definition.} (Concentrated) Suppose $A,B\subseteq S$, then $B$ is said to be \textit{concentrated with respect to} $A$ (for given $\bfR$ and $\bfQ$), if there exists a function $f: A \times A \rightarrow [0,1]$, such that 
\beq
Q_{a,b,b^*} = 0 \mbox{~~~~and~~~~}
R_{a,a^*,b} = f(a,a^*), 
\eeq

\noindent for $a,a^* \in A$ and $b,b^* \in B$. \hfill \qed

\vspace{.2in}

We have the following results regarding properties of cohesion. Proofs are provided in Appendix A. 

\begin{theorem} (Dissipation of cohesion under separation) Suppose $\bfR$ and $\bfQ$ are fixed, $S$ is a disjoint union of $A$ and $B$, and $A$ and $B$ are sufficiently separated with respect to $\bfR$ and $\bfQ$, then the between-set cohesion values are zero, i.e., $C_{a,b}$ = $C_{b,a}=0$ for $a \in A$ and $b \in B$.
\end{theorem}

\noindent {\bf Proof}. See Appendix A. \qed

\begin{theorem} \label{irrel_dens} (Irrelevance of density under separation) Suppose $A=\{a_1,a_2,\dots,a_m\}$ and $A'=\{a'_1,a'_2,\dots,a'_m\}$ have equivalent ordinal structure and $S=A\cup B$ (resp. $S'=A'\cup B$), for some set $B$, where $A$ and $B$ (resp $A'$ and $B$) are sufficiently separated. Then for any $1 \leq i,j \leq m$, $C_{a_i,a_j} = C_{a'_i,a'_j}$, i.e., the corresponding (within-set) pair-wise cohesion values are equal.  
\end{theorem}

\noindent {\bf Proof}. See Appendix A. \qed

\begin{theorem} (Dissipation of cohesion for concentrated sets of increasing size) Suppose $S$ is a disjoint union of $A$ and $B$, and $B$ is sufficiently separated from, and concentrated with respect to $A$. Then, for $a \in A$ and $b \in B$, the cohesion of $b$ to $a$ tends to zero as $\lvert B\rvert$ tends to infinity.
\end{theorem}

\noindent {\bf Proof}. See Appendix A. \qed

\vspace{.2in}

The next result follows from the probabilistic definition of local depth along with the assumptions (c) and (d), from Section 3.1, namely 
\beq
Q_{x,y,z}=1-Q_{y,x,z} \mbox{~~~~and~~~~} R_{x,y,x}=R_{x,y,y}=1. \nonumber
\eeq

\noindent Here, the first assumption provides conservation of probability and the second guarantees proper selection of $Z$.

\begin{theorem} (Conservation of Cohesion) We have 
\beq
\frac{n}{2}=\sum_{x\in S} \ell_S(x) =\sum_{x,w\in S}C_{x,w}.
\eeq
\end{theorem}
\qed

Finally, in \cite{bmm22}, a threshold distinguishing strong from weak cohesion is provided. In particular, define 

\beq
T_{S,\dd}\sdef P(Z=W,\dd(Z,X)< \dd(Z,Y))=\frac{1}{2n}\sum_{x\in S}C_{x,x},
\label{TSd}
\eeq

\noindent where $X, Y, Z$ and $W$ are selected uniformly at random from $S$, $S\setminus \{x\}$, $U_{X,Y}$ and $U_{X,Y}$, respectively. For the generalization provided here, the analogue of the final equality in (\ref{TSd}) no longer necessarily holds, but we do have the following. 

\begin{theorem}
Set $T\sdef T_{S,\bfR,\bfQ}=P(Z=W, Z \mbox{ supports } X)$. Then 
\beq
T\leq \frac{1}{2n}\sum_{x\in S}C_{x,x}. \label{thresholdbd}
\eeq
\end{theorem}

\noindent {\bf Proof}. See Appendix A. \qed

\vspace{.2in}

% \bmhead{Complexity and implementation}

We now turn to discussion of some potential applications. 

\section{Applications}\label{apps}

In this section we consider applications of the concepts of local relevance and support division in revealing community structure in complex data. Results follow upon determination of the arrays $\bfR$ and $\bfQ$. 

%The method is applicable in instances (a) where one has varying pairwise dissimilarities (either based on given data or underlying distributions), or (b) where dissimilarities are difficult to define given data complexity. 

% formalize all this ***

% For (a), consider the underlying set $S$. Suppose we have a function $\delta:S \times S\rightarrow \cup_{n=1}^{\infty} \Rbb^n$ 

% Time points may be associated over pairs, or not. permute ***

% moving points. 

% many measurements over the entire structure. strands, molecules, fingerprints. 

% main idea -- combining distances.

% set of sets!


% Note that the method allows as well for instances which permit direct evaluation of statements such as those in (\ref{local_relevance}) and (\ref{support_division}). 

% Otherwise, it could be that 

% function  one might wish to consider incorporating dissimilarities across multiple dimensions, layers or components.  

% The case of the latter, reduces to consideration of direct evaluation of statements such as those in (\ref{local_relevance}) and (\ref{support_division}). 


% The case of the former could involve multiple dissimilarity values 

\subsection{Combining multiple dissimilarity measures} \label{cultural}

Our ability to reason directly from local relevance and support division allows for flexibility to combine multiple, possibly conflicting, dissimilarity measures. Instead of linearly combining such measures to form one, we can proceed probabilistically.
%, while interpreting our aggregation method from the social perspective. 
% In general, combining multiple dissimilarity measures is challenging. For instance, the cultural values example in Figure \ref{fig_cultural} employs a joint cultural distance \cite{mu20} that combined information from dozens of social dimensions measured by hundreds of survey questions.  

%  Building a joint distance requires that competing dissimilarity measures be placed on a common scale in order to interpret what the joint measure means.  Even if a well-calibrated joint measure $d$ is produced, the social interpretation of $d$ when input into PaLD may not be appropriate. Because $\bfR$ and $\bfQ$ will be arrays of indicators in $\{0, 1\}$, the resolution of conflicting of dissimilarity measures cannot account for close calls.  Rather than to adopting approaches like those in \ref{uncertainty} model close calls with uncertainty, we can directly aggregate multiple $\bfR$ and $\bfQ$ arrays computed from competing    

\vspace{.2in} 

\noindent {\bf Example.} Recall the cultural values data considered earlier in Figure \ref{fig_cultural}. Distances for politically-related questions are provided at \cite{CD23} for the dimensions of {\em Politics}, {\em Democracy}, {\em Egalitarianism}, {\em Conservatism}, {\em Neoliberalism}, {\em Authoritarianism}, {\em Libertarianism}, {\em Change}, and {\em Social}. 
We will focus, here, on the subset of 25 European countries (out of 27) for which there is complete data for these dimensions. Define the respective resulting distance matrices as $\bfD_1,\bfD_2,\dots,\bfD_9$.

Consider two potential methods for combining the pairwise distance information for the countries to obtain cohesion networks. In one, we could obtain a single distance matrix, via simple linear weighting, i.e., for a non-negative weight vector, $\bfw=(w_1,w_2,\dots,w_9)$ satisfying $\sum_i w_i=1$,
\beq
\bfD^*_w\sdef w_1\bfD_1+w_2\bfD_2+\cdots+w_9\bfD_9.\label{Dstar}
\eeq
\noindent and proceed with PaLD, as in \cite{bmm22}.
Alternatively, we could obtain respective arrays $\bfR_1,\bfR_2,\dots,\bfR_9$ and $\bfQ_1,\bfQ_2,\dots,\bfQ_9$, and weight these to give
\beq
\bfR^*_w\sdef w_1\bfR_1+w_2\bfR_2+\cdots+w_9\bfR_9,\label{Rstar}
\eeq
\noindent and
\beq
\bfQ^*_w\sdef w_1\bfQ_1+w_2\bfQ_2+\cdots+w_9\bfQ_9.\label{Qstar}
\eeq
Figure \ref{fig_one_dist} contains a display of the cohesion networks resulting from weight vectors where the relative weight on $\bfD_9$ (for the {\em Social} dimension, with equal weights for others), increases through the values $0,0.5,1.0,2.0,10,100$. 

\begin{figure}[h]
    \centering
  \includegraphics[width=0.8\textwidth,trim={0cm 12cm 0cm 0cm},clip]{combineD2grid.pdf}
\caption{Cohesion networks based on $D^*$ as the relative weight on the {\em Social} dimension increases through the values $0,0.5,1.0,2.0,10,100$. Ties above the threshold in (\ref{thresholdbd}) are displayed. The layout for each plot is that based on the {\em Social} dimension in isolation.}
\label{fig_one_dist}
\end{figure}

Figure \ref{fig_combine_R_Q} contains a display of the cohesion networks resulting from weight vectors where the relative weights on $R_9$ and $Q_9$ increase through the same values $0,0.5,1.0,2.0,10,100$. 

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth,trim={0cm 12cm 0cm 0cm},clip]{combineRQ2grid.pdf}
\caption{Cohesion networks based on $R^*$ and $Q^*$ as the relative weight on the {\em Social} dimension increases through the values $0,0.5,1.0,2.0,10,100$. Ties above the threshold in (\ref{thresholdbd}) are displayed. The layout for each plot is that based on the {\em Social} dimension in isolation.}
\label{fig_combine_R_Q}
\end{figure}

Note some added stability in the cohesion network, as the weight on the {\em Social} dimension increases.  
% Such weightings are interpretable from the social and probabilistic perspectives, as well. When a larger weight is placed on the arrays for the {\em Social} dimension, the category accounts for  a larger proportion of ``votes’’ in determining local relevance and support division as compared to the case of equal weighting. 
% That is,  we interpret the values in $\bfR$ as  being appearing in the local focus of a randomly selected political distance.  
% \beq
% R_{x,y,z} = P( z \mbox{ is local to the pair } (x,y) ).
% \label{local_relevance_combine}
% \eeq
% \noindent Likewise, 
% \beq
% Q_{x,y,z} = P( z \mbox{ supports $x$ over $y$}),
% \label{support_division_combine}
% \eeq
% \noindent is the probability of support after randomly selecting a political distance.
Further considerations of combining measures is work in progress.   

\subsection{Event-based data} \label{event}

Another potential application of the concepts of local relevance and support division is to similarity determined by multiple events. For instance, consider a set $S$ of individuals, where for each pair $(x,y)\in S\times S$, we have a set of dissimilarities $A_{x,y}$, each with non-zero cardinality $N_{x,y}\sdef\lvert A_{x,y}\rvert$. Note that it is not necessary that $N_{x,y}$ be constant over pairs $(x,y)$. There are several ways in which such similarities might arise. Consider the following example. 

\vspace{,2in}

\noindent {\bf Example.} Suppose we have competing entities for which multiple events determine pair-wise distance, e.g. firms in different markets or competitors in an athletic context. For fixed $x,y,z\in S$, values for $Q_{x,y,z}$ and $R_{x,y,z}$ can be determined as probabilities through random (potentially weighted) selections from $A_{x,y}$, $A_{y,z}$ and $A_{x,z}$. For concreteness, in Figure \ref{fig_NBA}, we consider a cohesion network based on pair-wise similarities determined by competitiveness in games played between teams during the 2021--2022 season of the National Basketball Association (NBA). Here, similarity in a particular event (game) was determined as the proportion of (absolute) point differential to overall game point total. For instance, a score of 110-90 would result in a competitiveness score of $\lvert 110-90\rvert/(110+90)=0.10$. Note that, in this case, the values of $\{N_{x,y}\}$ vary between 2 and 4. The edges corresponding to {\em strong} pairwise cohesions above the threshold bound in (\ref{thresholdbd}) are displayed, in  Figure \ref{fig_NBA}. Note that the figure shows a general gradient from weaker teams at the top right to stronger teams at the bottom left. The largest cohesion is between the Dallas Mavericks and Brooklyn Nets, while the lowest is between the Phoenix Suns and the Charlotte Hornets. Some weaker teams display relative competitiveness with stronger teams head-to-head, such as the Detroit Pistons with the Denver Nuggets (two games with proportional point differentials of 6/(117+111) and 5/(105+110)). 
%The full cohesion matrix is supplied in the supplementary information. 

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth,trim={2cm 2cm 2cm 2cm},clip]{NBA2021.pdf}
\caption{The cohesion network for the 2021--2022 NBA basketball season based on proportional point differentials. Shading of nodes is according to mean proportional point differential; the highest is for the Phoenix Suns (0.034122; red) and lowest is for the Portland Trail Blazers (-0.04019; yellow). Edge-width is proportional to mutual cohesion. Note that team names have been abbreviated for display.}
\label{fig_NBA}
\end{figure}

%\bmhead{Research directions}
Similar ideas could also be used, when the events are drawn from sampling pairs of entities (and measuring dissimilarities) over time.


\subsection{Data uncertainty}\label{uncertainty}

If, 
%as suggested in Figure \ref{fig_generative}, 
we have information regarding data uncertainty, then, for fixed $x,y,z\in S$, it is possible, to adjust $R_{x,y,z}$ and $Q_{x,y,z}$ from indicators, as in (\ref{RPaLD}) and (\ref{QPaLD}), directly to probabilities. That is, $R_{x,y,z}$ could reflect the probability of membership of $z$ in the local focus of $(x,y)$ and $Q_{x,y,z}$, the probability of $z$ being closer to $x$ than to $y$.  More generally, adjustment for various sources of uncertainty becomes possible and has the potential advantage of making cohesion continuous in the data.      

\vspace{.2in}

\noindent {\bf Example.}
If we assume a sufficiently simple model, exact calculations of $\bfR$ and $\bfQ$ are relatively straightforward.  
Suppose that $\epsilon>0$ is fixed and each $a\in S$ is real-valued with true value $a^\ast\in S^\ast$, where $a^\ast$ is uniformly distributed in an $\epsilon$-ball centered at $a$ (and $S^\ast$ is the set of true values). We can then compute the arrays $\bfR$ and $\bfQ$, in terms of corresponding entries in the set $S^\ast$. 
If $\epsilon$  accurately reflects measurement uncertainty, then cohesion can be more faithfully modeled. 

In this scenario, cohesion can be seen to be stable with respect to small changes in the data. Rather than having discrete jumps, due to discontinuities in (\ref{RPaLD}) and (\ref{QPaLD}), a positive $\epsilon$ (e.g., reflecting the precision used to store the data) makes cohesion a continuous function of $S$. For instance, for $x,y,z\in S$, with $x<y<z$, 
if $z$ is sufficiently close to $y$ (relative to $\epsilon$), then $z$ is in the local focus with probability one, i.e., $R_{x,y,z}=1$.  However, if $z$ is gradually increased (moving farther from $y$), $R_{x,y,z}$ transitions to the value zero. 

 Finally, we can consider how cohesion varies as $\epsilon$ increases, in a manner similar to persistent homology \cite{wasserman2018topological}.
It is currently work in progress to consider higher dimensional scenarios and more complex settings. 


% For concreteness, consider determining conflict relevance $R_{x,y,z}$ for a fixed $y < x < z$. Then, $\dd(z, x) = \dd(y, x)$ when $z =b\sdef 2x - y$.
% %as opposed being either zero or one, as in (\ref{RPaLD}).  
% As $z$ increases, so does $\dd(z, x)$ and conflict relevance $R_{x,y,z}$ gradually approaches zero.  Indeed, $R_{x,y,z}$ reaches zero when $z = b + 4 \epsilon$ since $(x^\ast, y^\ast) = (x+\epsilon, y-\epsilon)$ maximizes $\dd(x^\ast, y^\ast)$ while minimizing  $\dd(x^\ast, z^\ast)$. Then, the right boundary point of $U_{x^\ast, y^\ast}$ is $b + 3 \epsilon$ so that $z = b + 4 \epsilon$ implies that set of $z^\ast \in U_{x^\ast, y^\ast}$ has measure zero. Symmetrically, 
% $R_{x,y,z}$ reaches one when $z = 2x - y - 4 \epsilon$.  In essence, uncertainty adjustment results capture how $\bfR$ and $\bfQ$ transition between zero and one as the data move continuously.    

% Computing closed forms for $\bfR$ and $\bfQ$ is relatively straightforward for the one dimensional problem posed here, but generalization to higher dimensions entails further analysis. 
% It is currently work in progress to consider higher dimensional scenarios, and more complex settings. 

% *** Possible to end here? ***

% It turns out that, after appropriate parameterization, the expressions for $R_{x,y,z}$ and $Q_{x,y,z}$ coincide.  

% Define $\dd$ so that for $a,b\in S$, $\dd(a,b)=\lvert a-b\rvert$. For fixed $x$, $y$ and $z$, the conflict relevance $R_{x,y,z}$ is determined by the distance of $z$ to the closer of $x$ and $y$. We will only consider the situation where $\epsilon$ is small relative to the values of $\dd$, so that the $\epsilon$-neighborhoods of the elements of $S$ are disjoint. In particular, this implies that if the true value $z^\ast$ is not between $x$ and $y$, then $z^\ast$ will be consistently closer to either $x^\ast$ or $y^\ast$. When $z^\ast$ \emph{is} between $x$ and $y$, it is within the local focus.

% Defining 
% \beq
% \delta = \delta_{x,y}(z, \epsilon)\sdef \frac{\max\{ \dd(y,x) - \dd(z,x),  \dd(x,y) - \dd(z,y) \} }{2\epsilon},
% \label{def_delta}
% \eeq
% \noindent Figure \ref{fig_1d_R_Q} plots $R_{x,y,z}$ as $\delta$ transitions from $-2$ to $2$, where $\delta \le -2$ implies $R_{x,y,z}=0$ while $\delta \ge 2$ implies $R_{x,y,z}=1$ (see Appendix \ref{A2} for details).

% Similarly, define
% \beq
% \beta = \beta_{x,y}(z, \epsilon) \sdef \frac{z- \frac{1}{2} (x + y)}{\epsilon} = \frac{\dd(z,y) - \dd(z,x)}{2\epsilon},
% \label{def_beta}
% \eeq
% to reflect the distance of $z$ to the midpoint between $x$ and $y$. Figure \ref{fig_1d_R_Q} plots $Q_{x,y,z}$ as $\beta$ transitions from $-2$ to $2$, where $\beta \le -2$ implies $Q_{x,y,z}=0$ while $\beta \ge 2$ implies $Q_{x,y,z}=1$.  

% \begin{figure}[th]
%     \centering
%     \includegraphics[width=0.8\textwidth]{R_Q_same.png}
% \caption{One-dimensional example of adjusting $\bfR$ and $\bfQ$ to be probabilities; see (\ref{def_delta}-\ref{def_beta}) for definitions of $\delta$ and $\beta$ and Appendix \ref{A2} for the closed form expression.}
% \label{fig_1d_R_Q}
% \end{figure}


% Derivations of the entries in $\bfR$ and $\bfQ$, in terms of $\dd$, are provided in Appendix \ref{A2}. Generalizing to higher dimensions, one could develop approximations of $\bfR$ and $\bfQ$ that are also functions of $\dd$. 

\section{Conclusion}\label{sec13}

The generalization of partitioned local depth, developed here, enhances PaLD's theoretical underpinnings and broadens the potential application of cohesion to complex data.  
Two key probabilistic concepts, conflict relevance and support division, are introduced leading to an extended probabilistic framework for revealing communities in data.

Base properties of the resulting cohesion values have been proven and initial potential applications in the contexts of multiple dissimilarity measures, event-based data and data uncertainty are discussed. It is hoped that this work may lead to further consideration of general community structure in data. 

\backmatter


\bmhead{Acknowledgments}
The authors thank Katherine Moore, Richard Darling, several individuals at Metron, Inc., and others for stimulating discussions on communities in data.   



\begin{appendices}

\section{Proofs of results} \label{proofs}

%\subsection
%\noindent {Proofs of results} \label{proofs}

\noindent {\bf Proof of Theorem 1.}  Suppose $a \in A$ and $b \in B$, $Y$ is selected uniformly at random, and for $s \in S$,
\beq
P(Z=s) = \frac{R_{a,Y,s}}{\sum_{w}{R_{a,Y,w}}}.
\eeq
\noindent Then partitioning according to the location of $Y$, and employing the definition in (\ref{cohesion}), 
\beq
C_{a,b} = P\left( Z=b,  \mbox{   $Z$ supports $a$}, Y \in A\right) + P\left( Z=b,  \mbox{   $Z$ supports $a$}, Y \in B\right). \label{partY}
\eeq

\noindent In the case that $Y \in A$, since $A$ is sufficiently separated from $B$, $R_{a,Y,b}=0$. If $Y\in B$, since $B$ is sufficiently separated from $A$, $Q_{a,Y,b}=0$, and hence $C_{a,b}=0$. Similarly, $C_{b,a}=0$. \hfill \qed

\vspace{.2in}

\noindent {\bf Proof of Theorem 2.} Suppose that $1 \leq i, j \leq m$ are fixed and set $x=a_i$ and $w=a_j$ (resp. $x^{\prime}=a_i^{\prime}$ and $\left.w^{\prime}=a_j^{\prime}\right)$. As in (\ref{partY}),
\beq
C_{a,b} = P\left( Z=b,  \mbox{   $Z$ supports $a$}, Y \in A\right) + P\left( Z=b,  \mbox{   $Z$ supports $a$}, Y \in B\right). 
\eeq

In the case $Y \in A$ (resp. $Y' \in A'$), since $A$ and $A'$ are separated from $B$, $R_{x,Y,b}=R_{x',Y',b}=0$ for all $b \in B$, and hence, since $A$ and $A'$ have equivalent ordinal structure,
\beq
P\left( Z=w,  \mbox{   $Z$ supports $x$}\mid Y \in A\right) = P\left( Z=w',  \mbox{   $Z$ supports $x'$}\mid Y \in A'\right).
\eeq

\noindent On the other hand, if $Y \in B$, then since $A$ is sufficiently separated from $B$, $R_{x,Y,w}=1$ and $Q_{x,Y,w}=1$, and since $B$ is sufficiently separated from $A$, for $b \in B$, $R_{x,Y,b}=1$ and $Q_{x,Y,b}=0$. Therefore,
\beq
P\left( Z=w,  \mbox{   $Z$ supports $x$}\mid Y \in B\right) = \frac{1}{n}
= P\left( Z=w',  \mbox{   $Z$ supports $x'$}\mid Y \in B\right).
\eeq
\noindent Since $P(Y \in A)=P\left(Y \in A^{\prime}\right)$, the result now follows. \hfill \qed

\vspace{.2in}

\noindent {\bf Proof of Theorem 3.} Suppose $a \in A$ and $b \in B$. Since $B$ is sufficiently separated from $A$, $Q_{a,y,b}=0$ for all $y \in B$, and hence, 
\beq
P\left( Z=b,  \mbox{   $Z$ supports $a$}, Y \in B\right) = 0.  
\eeq

\noindent For $y \in A$,  since $B$ is concentrated with respect to $A$,
\beq
P\left( Z=b,  \mbox{   $Z$ supports $a$}\mid Y =y\right) \leq \frac{f(a,y)}{\lvert B\rvert f(a,y)}=\frac{1}{\lvert B\rvert}, 
\eeq
\noindent and hence 
\beqa
C_{a,b} &=& P\left( Z=b,  \mbox{   $Z$ supports $a$}, Y \in B\right) \nonumber \\
&~&~~~~~~+ P\left( Z=b,  \mbox{   $Z$ supports $a$}, Y \in A\right)\leq \frac{1}{\lvert B\rvert}, 
\eeqa
\noindent and the results follows. \hfill \qed

\vspace{.2in}

\noindent {\bf Proof of Theorem 5.} The proof follows as in \cite{bmm22}, except, whereas therein $P(Z=W)=P(Z=X)$, here by the assumption (d) in Section \ref{lrsd}, $R_{X,Y,W}\leq R_{X,Y,X}$, and hence
\beq
P(Z=W)\leq P(Z=X)=\frac{1}{n} \sum_x P(Z=x)=\frac{1}{n} \sum_x P(Z=x, Z \mbox{ supports } x).
\eeq
The result follows by employing the definition of $C_{x, x}$, the assumption (b) in Section \ref{lrsd} and leveraging the symmetry in the selection of $X$ and $Y$. \hfill \qed
% An appendix contains supplementary information that is not an essential part of the text itself but which may be helpful in providing a more comprehensive understanding of the research problem or it is information that is too cumbersome to be included in the body of the paper.

% \subsection{Closed forms to adjust for measurement uncertainty} \label{A2}

% Here we provide details  regarding the curve given in Figure \ref{fig_1d_R_Q}.  
% Recall that each $x\in S$ is a real-valued measurement with corresponding true value $x^\ast$ uniformly distributed within $\epsilon$ of $x$. 
% As a function of $\delta$, as given in (\ref{def_delta}), we have
% \beq
% R_{x,y,z} = R(\delta) = 
% \begin{cases}
% 0 & \text{if } \delta \le -2   \\
% \frac{1}{12} + \frac{1}{4} (\delta + 1) + \frac{1}{4} (\delta + 1)^2 + \frac{1}{12} (\delta + 1)^3 & \text{if } \delta\in [-2,-1]   \\
% \frac{1}{2} + \frac{1}{2} \delta - \frac{1}{12} \delta^3  & \text{if } \delta \in [-1,1]  \\
% \frac{11}{12} + \frac{1}{4} (\delta - 1) - \frac{1}{4} (\delta - 1)^2 + \frac{1}{12} (\delta - 1)^3 & \text{if } \delta\in [1,2]   \\
% 1 & \text{if } \delta  \ge 2 
% \end{cases}.
% \label{1d_Q}
% \eeq
% to be the probability of membership of $z^\ast$ within the local focus $U_{{x}^\ast,{y}^\ast}$.  The correction to the linear relationship 
% $\frac{1}{2} + \frac{1}{2} \delta$ occurs since, for any pair $(x^\ast, y^\ast)$, the mass $z^\ast$ is within $\dd(x^\ast, y^\ast)$ contained in $[0, 2 \epsilon]$. That is, the upper limit on $z^\ast$ within the local focus is at most $z + \epsilon$ while the lower limit is at least  $z - \epsilon$.  Assuming without loss of generality that $y < x < z$, the relevant boundary point for the local focus is $b^\ast = 2x^\ast - y^\ast$. Thus,  $b^\ast$ determines when ${z}^\ast$  is in the local focus and
% \beqa
% R_{x,y,z} &=& \frac{1}{8\epsilon^3}\int_{x-\epsilon}^{x+\epsilon} \int_{y-\epsilon}^{y+\epsilon} \int_{z-\epsilon}^{z+\epsilon} I (z < b^\ast) ~\dd z^\ast \dd y^\ast \dd x^\ast 
% \nonumber \\
% &=&  \frac{1}{8\epsilon^3}\int_{x-\epsilon}^{x+\epsilon} \int_{y-\epsilon}^{y+\epsilon} \int_{z-\epsilon }^{\min \{z+\epsilon, b^\ast \} } \dd z^\ast \dd y^\ast \dd x^\ast.
% \eeqa
% In (\ref{1d_Q}), the polynomial form changes at $\delta = 1$ because the area of $(x^\ast, y^\ast)$ such that $b^\ast$ is less than $z - \epsilon$ vanishes and the correction term dampens rate of change as $\delta$ further.
% Due to symmetry, the correction term has the opposite sign for negative $\delta$. 


% Moreover, as a function of $\beta$, we have that $Q_{x,y,z} = Q(\beta)= R(\beta=\delta)$ and $Q(\beta)$ is the probability of ${z}^\ast$ being closer to ${x}^\ast$ than ${y}^\ast$.  In this case, we assume without loss of generality that $y < z < x$ so that the boundary point dividing support from ${z}^\ast$  is $m^\ast = \frac{1}{2}x^\ast + \frac{1}{2}y^\ast$. In this way,
% \beqa
% Q_{x,y,z} &=& \frac{1}{8\epsilon^3}\int_{x-\epsilon}^{x+\epsilon} \int_{y-\epsilon}^{y+\epsilon} \int_{z-\epsilon}^{z+\epsilon} I (z > m^\ast) ~ \dd z^\ast \dd y^\ast \dd x^\ast 
% \nonumber \\
% &=&  \frac{1}{8\epsilon^3}\int_{x-\epsilon}^{x+\epsilon} \int_{y-\epsilon}^{y+\epsilon} \int_{\max\{m^\ast, z-\epsilon \}}^{z+\epsilon } \dd z^\ast \dd y^\ast \dd x^\ast.
% \eeqa
% Here the polynomial form changes at $\beta = 1$ because the area of $(x^\ast, y^\ast)$ such that $m^\ast$ is less than $z - \epsilon$ is precisely half the total area--i.e., ${2\epsilon^2}$--and the line $y^\ast = - x^\ast + x + y$  such that $m^\ast = z - \epsilon$ demarcates a more gradual rate of change as $\beta$ increases.



%%=============================================%%
%% For submissions to Nature Portfolio Journals %%
%% please use the heading ``Extended Data''.   %%
%%=============================================%%

%%=============================================================%%
%% Sample for another appendix section			       %%
%%=============================================================%%

%% \section{Example of another appendix section}\label{secA2}%
%% Appendices may be used for helpful, supporting or essential material that would otherwise 
%% clutter, break up or be distracting to the text. Appendices can consist of sections, figures, 
%% tables and equations etc.

\end{appendices}

\vspace{.2in}

\noindent {\bf Conflict of interest statement:} On behalf of all authors, the corresponding author states that there is no conflict of interest.

%%===========================================================================================%%
%% If you are submitting to one of the Nature Portfolio journals, using the eJP submission   %%
%% system, please include the references within the manuscript file itself. You may do this  %%
%% by copying the reference list from your .bbl file, paste it into the main manuscript .tex %%
%% file, and delete the associated \verb+\bibliography+ commands.                            %%
%%===========================================================================================%%

\bibliography{sn-bibliography}% common bib file
%% if required, the content of .bbl file can be included here once bbl is generated
%%\input sn-article.bbl

%% Default %%
%%\input sn-sample-bib.tex%

\end{document}

\end{document}

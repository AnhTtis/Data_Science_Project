For the evaluation of the performance only events with at least 2 $b$-tagged jets are considered. This is a common requirement in physics analysis to reduce the contribution from the multi-jet background.
This requirement is not imposed during training as it is found to reduce the performance as a result of the reduction in training statistics.
% Therefore, no such requirement was placed on the training and validation dataset.

\subsection{Jet parton assignment}

Although Topographs predict the kinematics of injected particles,
the most important measure of performance is the association of jets to partons.
Efficiencies of reconstructing the whole event correctly are shown in \cref{tab:efficiencies} for varying jet and $b$-jet multiplicities.
Only events which are fully reconstructable are considered.
Topographs and \spanet show very similar performance across all jet multiplicities, with sub-percent differences in the reconstruction efficiencies.
% For both, the `Mean' and the `Best' the Topograph model slightly outperforms the \spanet model in most multiplicities.
Both clearly outperform the $\chi^2$ method by around $10\%$ with larger differences at higher jet multiplicities.


% \begin{table}[h]
%     \centering
%     \caption{Efficiencies of correctly assigning all jets in the event to the \ttbar decay products in different jet multiplicities.
%     All decay products have to be matched to a jet for the event to be considered in the efficiency calculation.
%     The top two rows compare the mean efficiencies of \spanet and Topographs from five models trained with different seeds for the initialisation.
%     The bottom two rows show the efficiencies of the best of these five models where best is determined solely on the efficiency in the 6ji2b multiplicity.
%     Additionally, the efficiencies of the $\chi^2$ method are shown. 
%     For the $\chi^2$ method the two $b$-jets of the top quark decays are required to be $b$-tagged.
%     As all reported efficiencies require two or more $b$-tagged jets, this causes no issues for these.
%     No requirement of the jets from the $W$ boson decay being not $b$-tagged are placed as this lowers the overall efficiency.
%     Added more stuff with no tagging requirements for chi2 and all kinds of options for Topographs.
%     Written in cursive are efficiencies which are most likely incorrect, as in 6j2bi there can be fewer than 4 light jets and these events are not explicitly vetoed but only the scores of the $b$-tagged jets set to 0, so it will probably pick the remaining highest pT $b$-tagged jet for a light jet which is not really what is wanted?
%     The higher efficiency for each multiplicity is highlighted in bold.
%     Why does efficiency drop when requiring $b$-jets to be $b$-tagged for 7 jets for topograph while it isn't for 6 jets (or only very slightly)}
%     \label{tab:efficiencies}
%     \begin{tabular}{c|c|cccccc} 
%         \hline \hline
%         $\mathrm{N}_{jets}$ & & $6$ & $6$ & $7$ & $7$ & $\geq6$ & $\geq6$ \\ 
%         $\mathrm{N}_{$b$-jets}$ & & $2$ & $\geq2$ & $2$ & $\geq2$ & $2$ & $\geq2$ \\
%         \hline 
%         \multirow{2}{*}{Mean} & \spanet & $\mathbf{81.43 \pm 0.03}$ & $79.45 \pm 0.07$ & $64.47 \pm 0.08$ & $62.38 \pm 0.12$ & $68.48 \pm 0.06$ & $65.76 \pm 0.08$ \\ 
%         & Topograph & $81.39 \pm 0.07$ & $\mathbf{79.56 \pm 0.07}$ & $\mathbf{65.00 \pm 0.08}$ & $\mathbf{62.94 \pm 0.10}$ & $\mathbf{68.78 \pm 0.05}$ & $\mathbf{66.20 \pm 0.07}$ \\ 
%         \hline
%         \multirow{4}{*}{Best} & \spanet & $\mathbf{81.47}$ & $79.56$ & $64.69$ & $62.86$ & $68.65$ & $66.05$ \\
%         & Topograph & $81.42$ & $\mathbf{79.67}$ & $\mathbf{65.09}$ & $\mathbf{63.06}$ & $\mathbf{68.92}$ & $\mathbf{66.37}$ \\ 
%         % & Topograph bs as b & $81.4$ & $79.6$ & $62.8$ & $61.1$ & $67.6$ & $65.2$ \\
%         & $\chi^2$ & $72.73$ & $70.94$ & $54.28$ & $52.11$ & $58.57$ & $55.90$ \\
%         \hline \hline
%     \end{tabular}
% \end{table}


% \begin{table*}[tb]
%     \centering
%     \caption{Event reconstruction efficiencies (\%) for the $\chi^2$ method, the \spanet model and our Topograph model in different jet and $b$-jet multiplicities.
%     Five models are trained with different random initialisations for both \spanet and Topographs.
%     The mean and standard deviation of the five models are shown, and the best model corresponds to the training with the highest efficiency for events with at least six jets and exactly two $b$-jets is picked.
%     The highest efficiency for each multiplicity is highlighted in bold.}
%     \label{tab:efficiencies}
%     \begin{tabularx}{0.95\textwidth}{Y|Y|YY|YYY} 
%         \toprule
%          & & \multicolumn{2}{c|}{Mean} & \multicolumn{3}{c}{Best} \\ 
%          $N_{jets}$ & $N_{b-\mathrm{jets}}$ & \spanet & Topograph & \spanet & Topograph & $\chi^2$ \\ 
%          \midrule
%          $6$ & $2$ & $\mathbf{81.43 \pm 0.03}$ & $81.39 \pm 0.07$ & $\mathbf{81.47}$ & $81.42$ & $72.73$ \\
%          $6$ & $\geq2$ & $79.45 \pm 0.07$ & $\mathbf{79.56 \pm 0.07}$ & $79.56$ & $\mathbf{79.67}$ & $70.94$ \\
%          $7$ & $2$ & $64.47 \pm 0.08$ & $\mathbf{65.00 \pm 0.08}$ & $64.69$ & $\mathbf{65.09}$ & $54.28$ \\
%          $7$ & $\geq2$ & $62.38 \pm 0.12$ & $\mathbf{62.94 \pm 0.10}$ & $62.86$ & $\mathbf{63.06}$ & $52.11$ \\
%          $\geq6$ & $2$ & $68.48 \pm 0.06$ & $\mathbf{68.78 \pm 0.05}$ & $68.65$ & $\mathbf{68.92}$ & $58.57$ \\
%          $\geq6$ & $\geq2$ & $65.76 \pm 0.08$ & $\mathbf{66.20 \pm 0.07}$ & $66.05$ & $\mathbf{66.37}$ & $55.90$ \\
%          \bottomrule
%     \end{tabularx}
% \end{table*}



\begin{figure}[ht]
    \centering
% \begin{subfigure}[b]{0.4\textwidth}
    \includegraphics[width=0.45\textwidth]{figures/results/w_masses_components}
    \caption{Reconstructed $W$ boson invariant mass $m_W$ using jets assigned by the Topograph (solid), \spanet (dashed), and the $\chi^2$ method (dash-dot).
    Events are categorised into correct (green) and incorrect assignments (orange), with events missing a parton at reconstruction level labelled as impossible (blue).}
    % Normalised and stacked distributions can be found in \cref{app:plots}.}
    \label{fig:reco_mass_comparison_w}
\end{figure}

\begin{figure}[ht]
    \centering
    % \end{subfigure}
    % \begin{subfigure}[b]{0.4\textwidth}
    \includegraphics[width=0.45\textwidth]{figures/results/top_masses_components}
    % \caption{ }
    % \end{subfigure}
    \caption{Reconstructed top quark invariant mass $m_{top}$ using jets assigned by the Topograph (solid), \spanet (dashed), and the $\chi^2$ method (dash-dot).
    Events are categorised into correct (green) and incorrect assignments (orange), with events missing a parton at reconstruction level labelled as impossible (blue).
    % Events where the correct triplet is assigned to the top quark but with the incorrect matching account for 5\% of the incorrect events for Topographs and \spanet, and 3\% for $\chi^2$.
    }
    % Normalised and stacked distributions can be found in \cref{app:plots}.}
    \label{fig:reco_mass_comparison_top}
    % The different colours show the different types of events based on the assignment of the model: correct, incorrect, impossible.}
\end{figure}


\begin{table*}[tb]
    \centering
    \caption{Percentage of events with at most $N$ incorrectly matched partons using the $\chi^2$ method, \spanet and Topographs.
    Events are categorised based on the number of partons matched to jets at truth level.
    The highest efficiency is highlighted in bold.}
    \label{tab:correct_jets}
    \begin{tabularx}{0.95\textwidth}{YY|YYYYYY}
        \toprule
        $N_{partons}$ &  & \multicolumn{6}{c}{Incorrectly matched partons [\%]} \\
        matched & Model & 0 & $\leq1$ & $\leq2$ & $\leq3$ & $\leq4$ & $\leq5$  \\
         \midrule
        \multirow{3}{*}{3} & \spanet & $34.34\pm0.65$ & $74.88\pm0.59$ & $98.03\pm0.19$ & $100.00\pm0.00$ & - & -\\
         & Topograph & $\mathbf{36.57\pm0.66}$ & $77.80\pm0.57$ & $98.70\pm0.15$ & $100.00\pm0.00$ & - & -\\
         & $\chi^2$ & $34.30\pm0.65$ & $\mathbf{80.12\pm0.54}$ & $\mathbf{99.05\pm0.13}$ & $100.00\pm0.00$ & - & -\\
         \midrule
        \multirow{3}{*}{4} & \spanet & $35.69\pm0.28$ & $64.53\pm0.28$ & $90.99\pm0.17$ & $99.41\pm0.04$ & $100.00\pm0.00$ & - \\
         & Topograph & $\mathbf{37.74\pm0.28}$ & $\mathbf{67.06\pm0.27}$ & $\mathbf{92.21\pm0.16}$ & $99.53\pm0.04$ & $100.00\pm0.00$ & - \\
         & $\chi^2$ & $31.01\pm0.27$ & $63.84\pm0.28$ & $92.19\pm0.16$ & $\mathbf{99.73\pm0.03}$ & $100.00\pm0.00$ & - \\
         \midrule
        \multirow{3}{*}{5} & \spanet & $44.74\pm0.19$ & $64.87\pm0.18$ & $86.92\pm0.13$ & $97.91\pm0.05$ & $99.94\pm0.01$ & $100.00\pm0.00$ \\
         & Topograph & $\mathbf{46.57\pm0.19}$ & $\mathbf{66.88\pm0.18}$ & $\mathbf{88.58\pm0.12}$ & $\mathbf{98.45\pm0.05}$ & $\mathbf{99.96\pm0.01}$ & $100.00\pm0.00$ \\
         & $\chi^2$ & $32.36\pm0.18$ & $58.27\pm0.19$ & $84.70\pm0.14$ & $98.21\pm0.05$ & $99.94\pm0.01$ & $100.00\pm0.00$ \\
         \midrule
        \multirow{3}{*}{6} & \spanet & $66.05\pm0.23$ & $74.43\pm0.21$ & $90.06\pm0.14$ & $96.22\pm0.09$ & $99.52\pm0.03$ & $99.98\pm0.01$ \\
         & Topograph & $\mathbf{67.03\pm0.22}$ & $\mathbf{75.71\pm0.20}$ & $\mathbf{91.33\pm0.13}$ & $\mathbf{97.03\pm0.08}$ & $\mathbf{99.70\pm0.03}$ & $\mathbf{100.00\pm0.00}$ \\
         & $\chi^2$ & $55.90\pm0.24$ & $64.93\pm0.23$ & $84.14\pm0.17$ & $93.97\pm0.11$ & $99.43\pm0.04$ & $99.98\pm0.01$ \\
        \bottomrule
    \end{tabularx}
\end{table*}

\Cref{fig:reco_mass_comparison_w,fig:reco_mass_comparison_top} show the reconstructed $W$ boson and top quark invariant masses.
%  using the jets assigned to the decay products based on the three different methods.
The distributions are shown separately for events with the correct and incorrect jet assignments, as well as events which are not possible to be fully reconstructed due to not all partons being matched to reconstructed jets (impossible).
Events where the correct triplet is assigned to the top quark but with the incorrect matching account for 5\% of the incorrect events for Topographs and \spanet, and 3\% for $\chi^2$.
All methods are able to reconstruct candidates closest to the particle mass, with a broader distribution for events without the corresponding partons matched to jets in the event.
Normalised and stacked distributions can be found in \cref{app:plots}.
% The distributions are separated based on the quality of the event:
% correct events are events where the method assigned all jets correctly to the considered particle. 
% incorrect events are events where the method did not assign all jets correctly to the considered particle.
% impossible events have at least one parton of the decay of the particle not matched to a jet and therefore no method can correctly reconstruct these events.
% Important to note is that events labelled as incorrect for tops can have the correct three jets assigned to the top but the $b$-jet is labeled as one of the $W$ boson jets and vice versa.
\spanet and Topographs have very similar distributions showing no difference in potential sculpting of the mass distributions.
% A difference to the distributions of the $\chi^2$ method is that due to the lower efficiencies of the method it has more events in the incorrect category but fewer in the correct category.
The $\chi^2$ method has distributions which are shifted towards slightly higher values compare to \spanet and Topographs.


For events which do not contain all partons in the final state, it is of interest to see how many of the partons are correctly matched to jets.
In \cref{tab:correct_jets} the matching efficiencies of only the partons which are present in the event are compared for the three approaches.
The Topograph performs slightly better than \spanet, with higher efficiencies for correctly matching all available partons or only one incorrectly matched parton.
Both Topographs and \spanet are substantially better than the $\chi^2$ at correctly identifying all available partons.
It should be noted that the perfect reconstruction in this case is substantially lower than the fully reconstructable events in \cref{tab:efficiencies}.

% \cref{fig:correct_jets} shows the distribution of the number of correctly identified jets for the three methods.
% The distribution is further split into incorrect and impossible events.
% All three methods have a peak at four correctly identified jets for incorrect events. 
% This can be explained by events where the correct six jets were identified by the method but two jets were swapped around.
% The Topograph model has on average a higher amount of correctly identified jets for both incorrect and impossible events.
% \spanet has a slightly lower amount of correctly identified jets but still clearly outperforms the $\chi^2$ method.
% However, the \spanet model is opposed to the Topograph model not trained to identify each single jet but triplets instead explaining this smaller average while still having virtually the same performance in overall event efficiencies.
% \cref{fig:additional_jets} shows the distribution of jets associated to a decay product even though the jet did not come from the \ttbar decay.
% Again, the distribution is split into incorrect and impossible events.
% As for the impossible events there is at least one decay product not being matched to a jet, at least one associated jet has to be an additional jet.
% On average the Topograph model has the lowest number of additional jets included so selecting the correct jets the most.
% \spanet has slightly worse performance, while the $\chi^2$ method is again significantly worse.

% \begin{figure}
%     \centering
%     \begin{subfigure}[b]{0.4\textwidth}
%         \includegraphics[width=\textwidth]{figures/results/correctly_identified_jets_incorrect}
%         \caption{ }
%         \label{fig:correct_jets:inc}
%     \end{subfigure}
%     \begin{subfigure}[b]{0.4\textwidth}
%         \includegraphics[width=\textwidth]{figures/results/correctly_identified_jets_impossible}
%         \caption{ }
%         \label{fig:correct_jets:imp}
%     \end{subfigure}
%     \caption{Number of correctly identified jets for \subref{fig:correct_jets:inc} incorrectly assigned and \subref{fig:correct_jets:imp} impossible events.}
%     \label{fig:correct_jets}
% \end{figure}

% \begin{figure}
%     \centering
%     \begin{subfigure}[b]{0.4\textwidth}
%         \includegraphics[width=\textwidth]{figures/results/additional_jets_incorrect}
%         \caption{ }
%         \label{fig:additional_jets:inc}
%     \end{subfigure}
%     \begin{subfigure}[b]{0.4\textwidth}
%         \includegraphics[width=\textwidth]{figures/results/additional_jets_impossible}
%         \caption{ }
%         \label{fig:additional_jets:imp}
%     \end{subfigure}
%     \caption{Number of jets associated to the decay products of the \ttbar decay which do not come from the \ttbar decay for \subref{fig:additional_jets:inc} incorrectly assigned and \subref{fig:additional_jets:imp} impossible events}
%     \label{fig:additional_jets}
% \end{figure}

In \cref{tab:flavour_jet_efficiencies} we break down the matching efficiencies of jets in incorrect events by the truth flavour of the jet. 
The jet truth flavour is assigned using $\Delta R$ matching to $B$- and $C$-hadrons.
We observe that Topographs and \spanet have similar jet matching efficiencies for all jet flavours.
Topographs have a slightly higher efficiency for $b$-jets, which correspond to the jets coming from the $b$-quarks in the top quark decays as well as in matching light jets to the quarks in the $W$ boson decay.
The $\chi^2$ method has the largest efficiency drop for truth flavour $c$-jets.
This results from $c$-jets being mis-identified by the $b$-tagging, which in the $\chi^2$ method allows them to be matched to the $b$-quarks from the top decays.

\begin{table}[h]
    \centering
    \caption{Efficiencies (\%) of correctly associating a jet to its corresponding parton for the $\chi^2$ method, \spanet and Topographs.
    Jets are categorised into their truth flavour using parton matching. Only jets coming from the $\ttbar$ decays in events with at least one incorrect assignment are considered.
    The highest efficiency is highlighted in bold.}
    \label{tab:flavour_jet_efficiencies}    
    \begin{tabularx}{0.475\textwidth}{Y|YYY}
        \toprule
        Correct & \spanet & Topograph  & $\chi^2$ \\
        \midrule
        $b$-jets  & $58.94\pm0.29$ & $\mathbf{59.99\pm0.29}$  & $57.68\pm0.25$ \\
        $c-$jets  & $55.08\pm0.39$ & $\mathbf{55.81\pm0.39}$  & $50.38\pm0.34$ \\
        light jets  & $70.42\pm0.22$ & $\mathbf{72.01\pm0.22}$  & $68.51\pm0.20$ \\
        \bottomrule
    \end{tabularx}
\end{table}


\begin{table*}[tb]
    \centering
    \caption{Efficiencies (\%) of correctly associating a jet to the corresponding parton for events with at least one incorrect assignment for the $\chi^2$ method, \spanet and Topographs.
    Top quarks are classified by the momentum of the corresponding $b$-quark.
    % The top three rows show the partons from the same top quark which $b$-quark was generated with a larger \pt than of the other top quark.
    The quarks from the $W$ boson decays are ordered by their \pt.
    The highest efficiency is highlighted in bold.
    % The last three rows show the same efficiencies but for the top quark which $b$-quark was generated with a lower \pt.
    % Only incorrect events are considered.}
    }
    \label{tab:pt_jet_efficiencies}   
    \begin{tabularx}{0.95\textwidth}{YY|YYY}
        \toprule
         & Correctly identified & \spanet & Topograph & $\chi^2$ \\
        \midrule
        \multirow{3}{*}{\shortstack{top quark\\ (leading $b$)}} & $b$-quark  & $61.83\pm0.40$ & $\mathbf{62.94\pm0.40}$ & $59.17\pm0.35$ \\
        & Leading quark ($W$)  & $67.79\pm0.38$ & $\mathbf{68.92\pm0.39}$ & $61.80\pm0.35$ \\
        & Subleading quark ($W$)  & $63.22\pm0.40$ & $\mathbf{64.70\pm0.40}$ & $65.09\pm0.34$ \\
        \midrule
        \multirow{3}{*}{\shortstack{top quark\\ (subleading $b$)}} & $b$-quark  & $56.05\pm0.41$ & $\mathbf{57.03\pm0.41}$ & $56.20\pm0.36$ \\
        & Leading quark ($W$)  & $67.49\pm0.38$ & $\mathbf{68.22\pm0.39}$ & $61.30\pm0.35$ \\
        & Subleading quark ($W$)  & $66.41\pm0.39$ & $\mathbf{68.31\pm0.39}$ & $65.94\pm0.34$ \\
        \bottomrule
    \end{tabularx}
\end{table*}


The matching efficiencies of partons in incorrect events are shown in \cref{tab:pt_jet_efficiencies}.
Here we see that the $\chi^2$ method mostly performs worse for matching jets to the quarks in the $W$ boson decay.
Topographs and \spanet show similar behaviour, with the slightly better performance in Topographs for incorrect events evenly distributed across all partons.

% It should be noted that the performance of \spanet increases when using the partial training on incomplete events.
% However, partial trainings are also expected to improve the performance of Topographs, which will also benefit from seeing events where only the $b$-quark is missing but where the two jets from the $W$ boson can still be correctly assigned.


\subsection{Interpreting edge scores}


Due to the individual edge scores, the confidence of the combinatoric assignment from Topographs can be obtained by aggregating the edge scores.
This could be used to filter events as likely to be incorrect, as well as identify events for which it is not possible to match jets to all partons.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.45\textwidth]{figures/results/score_topograph}
    \caption{Event matching score for events with the correct assignment (green), incorrect assignment (orange) and non fully-reconstructable events (impossible, blue).}
    \label{fig:score_topograph_all}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[width=0.45\textwidth]{figures/results/score_topograph_impossible}
    \caption{Event matching score for non-fully reconstructable events, categorised by the number of correctly assigned jets.}
    % For five jets (orange), this represents a single missing parton but where all remaining partons are correctly matched.}
    \label{fig:score_topograph_impossible}
\end{figure}

In \cref{fig:score_topograph_all} the product of assigned jet edge scores is used as an event matching score. 
There is reasonable separation between events with a correct assignment and those with the incorrect and impossible assignments.
However, a shoulder towards higher values is visible for the impossible events.

In \cref{fig:score_topograph_impossible} the impossible events are categorised into the number of jets which are correctly assigned.
It can be seen that the score is still high for events where there is a single parton missing, but all remaining partons are correctly matched to jets.
Whether using this score to remove events will benefit other down-stream applications, such as top quark mass measurements would need to be tested.
% \cref{fig:score_topograph:impossible} shows the same distribution and also split depending on the number of jets which are correctly identified.
% The shoulder seen in the overall distribution solely comes from events where five jets are correctly identified.
% Reducing the number of correct jets to four or at most three jets, the distribution shifts towards lower values.
% \begin{figure}
%     \centering
%     \includegraphics[width=0.4\textwidth]{figures/results/score_topograph_impossible}
%     \caption{Score distribution of the Topograph model for impossible events. 
%     The impossible events are further categorised based on how many jets are associated correctly by the model.
%     \label{fig:score_topograph:impossible}
% \end{figure}


\subsection{Regression performance}


Instead of reconstructing the top quark and $W$ boson kinematics from the matched jets, Topographs are trained to predict their properties directly.
\Cref{fig:regression_pt_w} compares the resolution of the $W$ boson \pt and \cref{fig:regression_pt_top} the top quark \pt from the Topograph regression networks and the invariant system of the assigned jets.
The predictions are shown for both correct and incorrect jet assignments.
% It shows the true parton quantity subtracted by the predicted quantity and divided by the true parton quantity.
% The \pt value predicted by the regression as well as the \pt value obtained from reconstructing the particle from the jet with the association of the model is shown.
% The distributions are further separated into correctly reconstructed particles and incorrectly reconstructed particles.
% For the incorrect events, the reconstructed quantity using the matched jets is also shown.


\begin{figure}[h]
    \centering
    % \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=0.45\textwidth]{figures/results/regression_w_pt}
        \label{fig:regression_pt_w}
    % \end{subfigure}
    % \begin{subfigure}[b]{0.4\textwidth}
    % \end{subfigure}
    \caption{Resolution of the reconstructed \pt of the $W$ boson from the Topograph.
    Comparing the prediction from the invariant system of the assigned jets (solid line) and the Topograph regression network (dashed line) for correct assigned events (green) and incorrect assigned events (orange).}
    % Compared are different options of retrieving the \pt of the parton: taking the jets assigned to the decay products of the parton by the model, reconstructing the parton, and retrieving its \pt or taking the regression prediction.
    % The candidates are split into correct and incorrect candidates.
    % For incorrect candidates additionally, the \pt taking the jets matched to the decay products of the parton on truth level is shown.
    % It is not included for correct candidates as it would by definition be the same as for the model assignment.
    % \todo{maybe different ordering or splitting up correct and incorrect into two plots}}
\end{figure}

\begin{figure}[h]
    \centering
    % \begin{subfigure}[b]{0.4\textwidth}
    % \end{subfigure}
    % \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=0.45\textwidth]{figures/results/regression_top_pt}
        \label{fig:regression_pt_top}
    % \end{subfigure}
    \caption{Resolution of the reconstructed \pt of the top quark from the Topograph.
    Comparing the prediction from the invariant system of the assigned jets (solid line) and the Topograph regression network (dashed line) for correct assigned events (green) and incorrect assigned events (orange).}
    % Compared are different options of retrieving the \pt of the parton: taking the jets assigned to the decay products of the parton by the model, reconstructing the parton, and retrieving its \pt or taking the regression prediction.
    % The candidates are split into correct and incorrect candidates.
    % For incorrect candidates additionally, the \pt taking the jets matched to the decay products of the parton on truth level is shown.
    % It is not included for correct candidates as it would by definition be the same as for the model assignment.
    % \todo{maybe different ordering or splitting up correct and incorrect into two plots}}
\end{figure}

For events with all jets correctly assigned, using the \pt values from the Topograph regression networks leads to a narrower peak than the reconstructed quantities, demonstrating a more accurate prediction.
They also show a reduced bias compared to the values reconstructed solely using the jets.
% Additionally, the peak for the $W$ boson for the reconstructed quantity is shifted towards higher values.
% A similar, but not as pronounced shift can be seen for the top quark \pt. 
% No such shift is visible for the regression predictions.
For events with incorrectly assigned jets, no difference is observed between the two predictions.
This shows that the Topograph is not learning to guess the \pt from the training data, but instead is using the associated jets.
% The regression prediction as well as the reconstructed value using the model prediction perform similar for the incorrect events. 
% The resolution is clearly worse than for the correct events.
% However, the resolution is also worse when considering the reconstructed value using the truth matched jets.
Accurate reconstruction of the intermediate particles has a strong dependence on whether the model has correctly assigned jets to partons.
% A worse reconstruction leads to a worse assignment.
There are no biases observed using either method for the top quark and $W$ boson, and 
There is very little difference for reconstruction of the top quark $\eta$ and $\phi$ coordinates.
However reconstructing the $W$ boson $\eta$ and $\phi$ coordinates using the assigned jets performs better than the prediction from the network.
In all cases, the Topograph is trained to predict the momentum components $p_x, p_y, p_z$ rather than $p_\mathrm{T},\eta,\phi$.



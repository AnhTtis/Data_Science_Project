% CVPR 2023 Paper Template
% based on the CVPR template provided by Ming-Ming Cheng (https://github.com/MCG-NKU/CVPR_Template)
% modified and extended by Stefan Roth (stefan.roth@NOSPAMtu-darmstadt.de)

\documentclass[10pt,twocolumn,letterpaper]{article}

%%%%%%%%% PAPER TYPE  - PLEASE UPDATE FOR FINAL VERSION
% \usepackage[review]{cvpr}      % To produce the REVIEW version
\usepackage{cvpr}              % To produce the CAMERA-READY version
% \usepackage[pagenumbers]{cvpr} % To force page numbers, e.g. for an arXiv version

% Include other packages here, before hyperref.
\usepackage{url}
\usepackage[utf8]{inputenc} %
\usepackage[T1]{fontenc}    %
\usepackage{xcolor}
\usepackage{textcomp}
\usepackage{float}
\usepackage{gensymb}
\usepackage{nicefrac}       %
\usepackage{microtype}      %
\usepackage{mathtools}
\usepackage{lipsum}
\usepackage{graphicx}
\usepackage[shortlabels]{enumitem}
\usepackage{wrapfig}
\usepackage{bm}
\usepackage{amsmath, amsthm, amsfonts}
\usepackage{amssymb}
\usepackage{thmtools, thm-restate}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{multirow}
\usepackage{booktabs}
\newcommand{\indep}{\perp \!\!\! \perp}
\usepackage{color}
\usepackage{mathrsfs}
\usepackage{colortbl}
\newtheorem*{remark}{Remark}
\usepackage{algpseudocode}

\newcommand{\ls}[1]{{\color{red}{\bf\sf [LS: #1]}}}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\newcommand{\sign}{\text{sign}}
\newtheorem{theorem}{Theorem}

% equation across pages.
\allowdisplaybreaks

% It is strongly recommended to use hyperref, especially for the review version.
% hyperref with option pagebackref eases the reviewers' job.
% Please disable hyperref *only* if you encounter grave issues, e.g. with the
% file validation for the camera-ready version.
%
% If you comment hyperref and then uncomment it, you should delete
% ReviewTempalte.aux before re-running LaTeX.
% (Or just hit 'q' on the first LaTeX run, let it finish, and you
%  should be clear).
\usepackage[pagebackref,breaklinks,colorlinks]{hyperref}
\usepackage{marvosym}
% \usepackage[symbol]{footmisc}
% \renewcommand{\thefootnote}{\fnsymbol{footnote}}
% \renewcommand*{\thefootnote}{\fnsymbol{footnote}}

% Support for easy cross-referencing
\usepackage[capitalize]{cleveref}
\crefname{section}{Sec.}{Secs.}
\Crefname{section}{Section}{Sections}
\Crefname{table}{Table}{Tables}
\crefname{table}{Tab.}{Tabs.}


%%%%%%%%% PAPER ID  - PLEASE UPDATE
\def\cvprPaperID{12401} % *** Enter the CVPR Paper ID here
\def\confName{CVPR}
\def\confYear{2023}
\makeatletter
\def\thanks#1{\protected@xdef\@thanks{\@thanks
        \protect\footnotetext{#1}}}
\makeatother

%\usepackage[accsupp]{axessibility}
%\usepackage{axessibility}

\begin{document}

%%%%%%%%% TITLE - PLEASE UPDATE
%\title{Appendix for ``Robust Generalization against Photon-Limited Corruptions \\ via Worst-Case Sharpness Minimization''}
\title{Robust Generalization against Photon-Limited Corruptions \\ via Worst-Case Sharpness Minimization}

\vspace{-5mm}
\author{
	Zhuo Huang$^{1,\dagger}$,\  
	Miaoxi Zhu$^{2,\dagger}$\thanks{\scriptsize{$^{\dagger}$Equal contribution. $^1$Syndey AI Centre, The University of Sydney; $^2$National Engineering Research Center for Multimedia Software, Institute of Artificial Intelligence, School of Computer Science and Hubei Key Laboratory of Multimedia and Network Communication Engineering, Wuhan University; $^3$JD Explore Academy; $^4$Department of Automation, University of Science and Technology of China; $^5$Key Laboratory of Intelligent Perception and Systems for High-Dimensional Information of Ministry of Education, School of Computer Science and Engineering, Nanjing University of Science and Technology; $^6$Department of Computer Science, Hong Kong Baptist University}. Correspondence to Jun Yu (\texttt{harryjun@ustc.edu.cn}). Our code is available at \href{https://github.com/zhuohuangai/SharpDRO}{https://github.com/zhuohuangai/SharpDRO}},\  % \thanks{Equal contributions.}
	Xiaobo Xia$^1$,\ 
	Li Shen$^3$,\ 
	Jun Yu$^{4, }\textsuperscript{\Letter}$,\\ % \thanks{Correspondence to Jun Yu.}
	Chen Gong$^5$,\ 
	Bo Han$^6$,\ 
	Bo Du$^2$,\ 
	Tongliang Liu$^1$ \\[1ex]
}
\vspace{-3mm}

\maketitle


\vspace{-5mm}
%
%%%%%%%%% ABSTRACT
\begin{abstract}
Robust generalization aims to tackle the most challenging data distributions which are rare in the training set and contain severe noises, i.e., photon-limited corruptions. Common solutions such as distributionally robust optimization (DRO) focus on the worst-case empirical risk to ensure low training error on the uncommon noisy distributions. However, due to the over-parameterized model being optimized on scarce worst-case data, DRO fails to produce a smooth loss landscape, thus struggling on generalizing well to the test set. Therefore, instead of focusing on the worst-case risk minimization, we propose SharpDRO by penalizing the sharpness of the worst-case distribution, which measures the loss changes around the neighbor of learning parameters. Through worst-case sharpness minimization, the proposed method successfully produces a flat loss curve on the corrupted distributions, thus achieving robust generalization. Moreover, by considering whether the distribution annotation is available, we apply SharpDRO to two problem settings and design a worst-case selection process for robust generalization. Theoretically, we show that SharpDRO has a great convergence guarantee. Experimentally, we simulate photon-limited corruptions using CIFAR10/100 and ImageNet30 datasets and show that SharpDRO exhibits a strong generalization ability against severe corruptions and exceeds well-known baseline methods with large performance gains.
\end{abstract}

\input{textfile/introduction}
\input{textfile/background}
\input{textfile/method}
\input{textfile/experiments}


\vspace{-1mm}
\section{Conclusion}
\vspace{-1mm}
\label{sec:conclusion}
In this paper, we proposed a SharpDRO approach to enhance the generalization performance of DRO methods. Specifically, we focus on minimizing the sharpness of worst-case data to learn flat loss surfaces. As a result, SharpDRO is more robust to severe corruptions compared to other methods. Moreover, we apply SharpDRO to distribution-aware and distribution-agnostic settings and proposed an OOD detection process to select the worst-case data when the distribution index is not known. Extensive quantitative and qualitative experiments have been conducted to show that SharpDRO can deal with the most challenging corrupted distributions and achieve improved generalization results compared to well-known baseline methods.

%
%\section{Acknowledgements}
%Li Shen is supported by STI 2030-Major Projects No. 2021ZD0201405. Zhuo Huang was supported by JD Technology Scholarship for Postgraduate Research in Artificial Intelligence No. SC4103. Xiaobo Xia was supported by Australian Research Council Projects DE-190101473 and Google PhD Fellowship. Jun Yu was supported by Natural Science Foundation of China (62276242), CAAI-Huawei MindSpore Open Fund (CAAIXSJLJJ-2021-016B, CAAIXSJLJJ-2022-001A), Anhui Province Key Research and Development Program (202104a05020007), USTC-IAT Application Sci. \& Tech. Achievement Cultivation Program (JL06521001Y), Sci. \& Tech. Innovation Special Zone (20-163-14-LZ-001-004-01). Chen Gong was supported by NSF of China No. 61973162, NSF of Jiangsu Province No. BZ2021013, NSF for Distinguished Young Scholar of Jiangsu Province No. BK20220080, and CAAI-Huawei MindSpore Open Fund. Bo Han was supported by NSFC Young Scientists Fund No. 62006202, Guangdong Basic and Applied Basic Research Foundation No. 2022A1515011652 and RGC Early Career Scheme No. 22200720. Tongliang Liu was partially supported by Australian Research Council Projects IC-190100031, LP-220100527, DP-220102121, and FT-220100318.

%%%%%%%%% REFERENCES
{\small
	\bibliographystyle{ieee_fullname}
	\bibliography{egbib}
}


\input{textfile/appendix}

\end{document}

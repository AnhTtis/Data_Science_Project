\section{Numerical experiments}
\label{sec:num_exp}

Before we present the proof of our main result, we illustrate our theoretical findings with some numerical examples confirming the rates and the $\kappa$-dependence in our error bounds. In the following we will hence compute discrete minimizers
$$
\solh = \underset{\testfunh \in \VSh}{\mbox{arg\hspace{2pt}min}}\hspace{1pt}\energy(\testfunh) 
$$
in $\mathcal{P}_1$-spaces $\VSh$ for different mesh sizes $h$ and different material parameters $\kappa$. Note that, just like analytical minimizers, discrete minimizers can be at most unique up to gauge transformations, i.e., if $\solh \in \VSh$ is a minimizer, so is $\exp(-\ci \theta) \solh$ for any $\theta \in [-\pi,\pi)$. 


\subsection{Implementation}

For the discretization in space with linear Lagrange finite elements, we use the open source Python tool FEniCS \cite[version 2018.1.0]{Fenics}. 
%
 To compute a discrete minimizer, we applied a steepest descent approach
using an implicit Euler method for the $L^2$ gradient flow. 
A direct application yields the following nonlinear iteration
%
\begin{align}
	\ipsymLtwo{\solh^{n+1}}{ \testfunh } = \ipsymLtwo{\solh^{n}}{ \testfunh } - \tau \, \dualp{\energy'(\solh^{n+1})}{\testfunh} ,
\end{align}
%
where $\tau>0$ is some parameter. To avoid the solution of nonlinear systems several times, we replace $\energy'(u^{n+1})$ by the linearization
%
\begin{align}
	\dualp{\energy'(\solh^{n+1})}{\testfunh} \to  \abilmag{\solh^{n+1}}{\testfunh} + \kappa^2 \Real \int_\Omega (|\solh^{n}|^2 - 1) \solh^{n+1} \testfunh^* \,dx,
\end{align}
%
and thus have to solve the following linear system for $\solh^{n+1} \in \VSh$
%
\begin{align}
	\ipsymLtwo{\solh^{n+1}}{ \testfunh } 
	+ 
	\tau \, \abilmag{\solh^{n+1}}{\testfunh} 
	+
	 \tau \, \kappa^2 \Real \int_\Omega (|\solh^{n}|^2 - 1) \solh^{n+1} \testfunh^* \,dx
	  = 
	  \ipsymLtwo{\solh^{n}}{ \testfunh }
\end{align}
for all $\testfunh \in \VSh$.
%
In our experiments, we  set $\Omega = [0,1] \times [0,1] \subset \R^2$,
and use 
on the finest grid the initial value $\sol_0 = 0.8 + 0.6 \ci$. For the coarser grids, we project this reference solution and use this as a starting value.
%
The magnetic potential is chosen as
%
\begin{equation}
	\MagF(x,y) :=  \sqrt{2} \begin{pmatrix}
		\sin(\pi x) \cos(\pi y) \\ -  \cos(\pi x) \sin(\pi y)
	\end{pmatrix} , 
\end{equation}
%
and satisfies the assumptions in \eqref{eq:ass_\MagF_for_H2}.
%
Further, we set $\tau = \kappa^{-2}$, and used the stopping criterion
%
$ \kappa^{-2} | \energy(\solh^{n+1}) - \energy(\solh^{n})| < \delta $
for a tolerance $\delta = 10^{-9}$. Below this tolerance, we use a Newton method for the equation $\energy^{\prime}(\solh)=0$ with the previous approximation $\solh^{n}$ as starting value and the same stopping criterion, but $\delta = 10^{-12}$.
%
The code to reproduce the results presented in this paper is available at \url{\mycode}.

Let us note that the steepest descent approach as described above can potentially also find local minimizers of $\energy$ in $\VSh$, depending on the choice of the initial value. However, we also note that global minimizers are typically found more easily and that local minimizers (that are not global minimizers) can be identified and discarded by comparing the energy levels. 

Finally, let us also mention that the phase of the minimizer (i.e. which $\exp(- \ci \theta) u_h$ we find for some $\theta \in [-\pi,\pi)$) depends only on the choice of the initial value. Hence, it is important to start the steepest descent method always with the same initial value in order to ensure a reasonable comparison between minimizers on different meshes (since phase differences might otherwise dominate the error).

\subsection{Numerical results}

We first illustrate the convergence in the spatial parameter $\h$ for different values of $\kappa$.
To this end, we computed a reference solution on a finer grid using $\h_{\text{max}} \sim  2.5 \cdot 10^{-3}$. %0.00248592 
%
In order to numerically verify Assumption~\ref{ass:cinfsup} on the local uniqueness of the computed minimizers, we proceeded as in Remark~\ref{rem:loc_uniq} and computed the $5$ smallest eigenvalues (in absolute value) of $\energy''$ and collected them in Table~\ref{tab:eigs_L2}.
We observe that the first eigenvalue is essentially zero up to numerical precision and we verified that it indeed belongs to $\ci \solh$. The second smallest eigenvalue is clearly bounded away from zero, and the computed minimum is hence indeed locally unique in the sense of Definition~\ref{def-local-uniqueness}.
%
\begin{table}
	\begin{center}
		\begin{tabular}{ |c|c|c|c|c|c| } 
			\hline
			$\kappa$ & 		$\lambda_1 $ &	$\lambda_2 $ &	$\lambda_3 $ &	$\lambda_4 $ &	$\lambda_5 $  \\
			\hline
			$8$ & \Zeile{1.70e-14 }{ 4.15e-02 }{ 4.15e-02 }{ 1.18e-01 }{ 1.20e-01 } \\ 
			\hline
			$ 10$	& \Zeile{2.86e-14 }{ 3.37e-02 }{ 3.37e-02 }{ 3.78e-02 }{ 1.07e-01}\\ 
			\hline
			$ 17$	& \Zeile{3.93e-11 }{ 1.59e-03 }{ 1.99e-03 }{ 9.12e-03 }{ 9.50e-03 } \\ 
			\hline
			$ 24$	& \Zeile{1.19e-12 }{ 8.94e-04 }{ 3.52e-03 }{ 3.52e-03 }{ 9.59e-03 } \\ 
			\hline
		\end{tabular}
	\end{center}
	\caption{
		The numerically computed $5$ smallest eigenvalues of $\energy''(\solh)$ with reference solution $\solh$ and $\kappa = 8,10,17,24$.}
	\label{tab:eigs_L2}
\end{table}



In order to compare the results for different values of $\kappa$, we divide the error in the $\HonekappaSpace$- and $L^2$-norm by $\kappa^2$
and the energy by $\kappa^4$, see Figure~\ref{fig:convergence}. Here we recall that according to Corollary~\ref{cor:main_Lagrange} we expect the $\HonekappaSpace$-error to convergence with the rate $\kappa^2 \h$, the $L^2$-error with the rate $\kappa^2 \h^2$ and the energy-error with the rate $\kappa^4 \h^2$. 
%
Indeed, we observe the predicted asymptotic convergence in $\h$ and, in particular, the numerical experiments confirm the $\kappa$-scaling in our error estimates. The plot further indicates that the constants in front of the normalized errors are independent of $\kappa$.
Further, we observe in Figure~\ref{fig:uniformness} the uniform boundedness of $\Honekappa{\solh}$ and $\energy(\solh)$ as predicted in Lemma~\ref{lem:bound_general_uH}.



\begin{figure}
	\centering
     \begin{subfigure}{0.45\textwidth}
  			\resizebox{1.0\textwidth}{!}{\input{error_plot_H1.tex}}	
%    		\caption{Error}
     	\end{subfigure}
     \hfill
          \begin{subfigure}{0.45\textwidth}
      \resizebox{1.0\textwidth}{!}{\input{error_plot_L2.tex}}	
%     	\input{tikz/error_plot_L2.tex}
%     	\caption{Error}
     \end{subfigure}
 \hfill
      \begin{subfigure}{0.45\textwidth}
    \resizebox{1.0\textwidth}{!}{\input{error_plot_energy.tex}}
% 	\input{tikz/error_plot_energy.tex}
% 	\caption{Error}
 \end{subfigure}
 \hfill
 \begin{subfigure}{0.45\textwidth}
 %\vspace{-21mm}
  %\hspace{8mm}
  \resizebox{0.85\textwidth}{!}{\begin{centering}\ref{Legendforall}\end{centering}}\\[4.0em]
\end{subfigure}
%
%\ref{Legendforall}
%
\caption{Convergence in the mesh size $\h$ for $\kappa$-weighted errors
	in the $\HonekappaSpace$- and $L^2$-norm and for the energy,
	for $\kappa = 8,10,17,24$. The errors between $\sol$ and $\solh$ in $L^2$ and $\HonekappaSpace$ are scaled by $\kappa^{-2}$ and the error in energy by $\kappa^{-4}$. The dotted lines indicate the corresponding errors (in $L^2$ and $\HonekappaSpace$ respectively) between $\sol$ and its best-approximation $\textup{R}_{\kappa,\h}(u)$ in $\VSh$ with respect to 
	$\abilmagstabsym{\cdot}{\cdot}$, cf. \eqref{best-approxi-H1kappa}.
	The dashed lines indicate order $\mathcal{O}(\h)$ in the upper left figure, and 
	order $\mathcal{O}(\h^2)$ in the upper left and bottom right figure.
}
\label{fig:convergence}
\end{figure}




\begin{figure}
	\centering
	\begin{subfigure}{0.45\textwidth}
		\resizebox{1.0\textwidth}{!}{\input{plot_H01_norm.tex}}	
		%    		\caption{Error}
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.45\textwidth}
		\resizebox{1.0\textwidth}{!}{\input{plot_energy_comparison.tex}}	
	\end{subfigure}
\ref{Legendforall}
%
\caption{Boundedness of the scaled $\HonekappaSpace$-norm and energy $\energy$ with respect to $\h$ for $\kappa = 8,10,17,24$.
		The dotted lines show the energy of the best-approximation $\textup{R}_{\kappa,\h}(u)$ in $\VSh$
		with respect to $\abilmagstabsym{\cdot}{\cdot}$.
%
}
\label{fig:uniformness}
\end{figure}



Let us also note that for larger values of $\kappa$, we observe a preasymptotic behavior in $\h$. We expect that this is related to the smallness condition for $\kappa \Csol \h$ stated in the theorem, which is required below in Lemma~\ref{lem:du_F_inf_sup_solvability_discrete} for the discrete inf-sup stability. Since beyond the (numerically observed) threshold $\kappa h < 1$, the errors coincide for all values of $\kappa$, this is still in alignment with our theory. 
 

To further investigate the preasymptotic effect, we added a comparison of our errors with the 
 	best-approximation $\textup{R}_{\kappa,\h}(u)$ in $\VSh$ with respect to 
 $\abilmagstabsym{\cdot}{\cdot}$. To be precise, for our reference solution $\sol$, we computed the orthogonal projection $\textup{R}_{\kappa,\h}(u) \in \VSh$ such that
 \begin{align}
 \label{best-approxi-H1kappa}
 \abilmagstabsym{\sol  - \textup{R}_{\kappa,\h}(\sol)}{\phi_h} = 0, \quad \text{for all} \quad \phi_h \in \VSh .
 \end{align}
%
By comparing our errors $\Honekappa{ u - u_h}$ with $\Honekappa{ u - \textup{R}_{\kappa,\h}(u) }$, we can identify possible numerical pollution effects related to $\kappa$. The corresponding results are depicted in Figure \ref{fig:convergence} and reveal a very interesting phenomenon. Contrary to $\solh$ itself, the best-approximation does not show any visible preasymptotic convergence. On the contrary, in the asymptotic regime both approximations have a very similar behavior and follow the expected rates closely. Since both errors are expected to behave asymptotically as
\begin{align}
\Honekappa{ \sol - \solh} + \Honekappa{ \sol - \textup{R}_{\kappa,\h}(\sol) } \lesssim \kappa \min \{ 1 , \h \kappa \} 
\end{align}
(due to the energy bounds $\Honekappa{\sol}+\Honekappa{\solh}\lesssim \kappa$), we suspect that the necessary resolution condition $\h \kappa \lesssim 1$ will only become visible for larger values of $\kappa$, whereas the preasymptotic convergence of $\solh$ must be related to the smallness condition $\kappa \Csol \h$. This is further supported by the right-hand side of Figure~\ref{fig:uniformness}, where we compare the energy $\energy(\,\textup{R}_{\kappa,\h}(u) \,)$ of the best-approximation with the energy $\energy(\solh)$ of the actual minimizer in $\VSh$. We can see that, in the preasymptotic regime, the energy of $\textup{R}_{\kappa,\h}(u)$ is indeed significantly larger than the one of $\solh$. This explains why good approximations are not found on coarse meshes and indicates that one cannot capture the correct vortex pattern on meshes which do not satisfy some further resolution condition on $\h$ with respect to $\kappa$.

In our second experiment, we first computed for $\kappa = 20$
the discrete minimizers for different values of 
$h \approx 8\cdot 10^{-2}, 4\cdot 10^{-2}, 2\cdot 10^{-2}, 1 \cdot 10^{-2} $ ,
see Figure~\ref{fig:diff_solutions_in_h}.
%
We observe that the number of vortices remains constant on the different discretization levels, but 
the minimizer is rotated by $\frac{\pi}{2}$. A simple calculation show that by our choice of $\MagF$ this rotation of the coordinate system leaves the energy invariant. In particular, this illustrates that the density $|u|^2$ of minimizers is not necessarily unique and that convergence of discrete minimizers can only be expected up to a subsequence, even for a fixed gauge condition.
%
On the other hand, we plotted the minimizers for the values $\kappa=8,10,17,24$, see Figure~\ref{fig:diff_solutions}.
%
We observe that the number of vortices increases with larger values of $\kappa$, which is in agreement with analytical results \cite{Aftalion99,SaS07}.

\begin{figure}[t!]
	\centering
	\begin{subfigure}{0.2\textwidth}
%		\includegraphics[width=1.4\textwidth]{tikz/plasma/plot_sol_kappa_20_h3.png}	
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_20_h3.png}		
%		\includegraphics[width=1.4\textwidth]{tikz/red_blue/plot_sol_kappa_20_h3.png}	
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.2\textwidth}
%		\includegraphics[width=1.4\textwidth]{tikz/plasma/plot_sol_kappa_20_h4.png}	
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_20_h4.png}	
%		\includegraphics[width=1.4\textwidth]{tikz/red_blue/plot_sol_kappa_20_h4.png}
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.2\textwidth}
%		\includegraphics[width=1.4\textwidth]{tikz/plasma/plot_sol_kappa_20_h5.png}	
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_20_h5.png}	
%		\includegraphics[width=1.4\textwidth]{tikz/red_blue/plot_sol_kappa_20_h5.png}	
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.2\textwidth}
%		\includegraphics[width=1.4\textwidth]{tikz/plasma/plot_sol_kappa_20_h6.png}
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_20_h6.png}
%		\includegraphics[width=1.4\textwidth]{tikz/red_blue/plot_sol_kappa_20_h6.png}
	\end{subfigure}

	\caption{Minimizers for the Ginzburg--Landau parameter $\kappa =20$ and different mesh widths 
		$h \approx 8\cdot 10^{-2}, 4\cdot 10^{-2}, 2\cdot 10^{-2}, 1 \cdot 10^{-2} $ 
		(from left to right).}
	\label{fig:diff_solutions_in_h}
\end{figure}



\begin{figure}[t!]
	\centering
	\begin{subfigure}{0.2\textwidth}
%		\includegraphics[width=1.4\textwidth]{tikz/plasma/plot_sol_kappa_8_h8.png}	
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_8_h8.png}	
%		\includegraphics[width=1.4\textwidth]{tikz/red_blue/plot_sol_kappa_8_h8.png}	
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.2\textwidth}
%		\includegraphics[width=1.4\textwidth]{tikz/plasma/plot_sol_kappa_10_h8.png}		
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_10_h8.png}	
%		\includegraphics[width=1.4\textwidth]{tikz/red_blue/plot_sol_kappa_10_h8.png}	
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.2\textwidth}
%		\includegraphics[width=1.4\textwidth]{tikz/plasma/plot_sol_kappa_17_h8.png}	
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_17_h8.png}	
%		\includegraphics[width=1.4\textwidth]{tikz/red_blue/plot_sol_kappa_17_h8.png}		
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.2\textwidth}
%		\includegraphics[width=1.4\textwidth]{tikz/plasma/plot_sol_kappa_24_h8.png}
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_24_h8.png}
%		\includegraphics[width=1.4\textwidth]{tikz/red_blue/plot_sol_kappa_24_h8.png}
	\end{subfigure}
	\caption{Different minimizers corresponding to the Ginzburg--Landau parameters $\kappa = 8,10,17,24$ (from left to right) for $\h \approx 2.5 \cdot 10^{-3}$.
	}
	\label{fig:diff_solutions}
\end{figure}


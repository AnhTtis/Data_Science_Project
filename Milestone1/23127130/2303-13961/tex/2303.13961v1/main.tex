\section{Space discretization and main results}
\label{sec:main}


Let us consider some finite dimensional finite element space $\VSh$ which is a subspace of $H^1(\Omega)$ and
where we recall that we assume $\Omega$ to be a polygonal (or polyhedral) Lipschitz domain. 
By $\h$ we denote a spatial parameter which tends to zero for a finer spatial resolution.
We consider the closed subspace $\VShperp$ of $\VSh$
given by
$\VShperp = \VSh \cap (\ci \sol)^\perp \subset \Honeperp$
with orthogonality with respect to $\ipsymLtwo{\cdot}{\cdot}$.
Further, we denote by $\projLtwoisol : \Honeperp \rightarrow \VShperp$ the orthogonal projection satisfying
%
\begin{equation}
	\abilmagstabsym{\projLtwoisol w}{\testfunh} = 	\abilmagstabsym{w}{\testfunh}, \quad \text{ for all } \testfunh \in \VShperp.
\end{equation}
%
In the following assumption, we introduce some abstract conditions which are sufficient to carry out our error analysis and which are later verified for our examples.

\begin{assumption}  \label{ass:FEM_space}
	The family of (non-empty) finite element spaces $\VSh$ has the following properties:
	
\bulletpoint{a} The  family of spaces $\VSh$ is dense in $H^1(\Omega)$ in the sense that for each $\testfunh \in H^1$ we have
%
\begin{equation}
	\lim\limits_{\h \to 0} \inf\limits_{\testfunh \in \VSh } \norm{H^1}{\testfun - \testfunh} = 0 .
\end{equation}

\bulletpoint{b} Let $w \in \Honeperp$ and $f \in L^2$ such that $\abilmagstabsym{w}{\testfun} = \ipsymLtwo{f}{\testfun}$ for all $\testfun \in \Honeperp$. Then, it holds
\begin{equation} \label{eq:ass_bound_H1kappa}
	\Honekappa{w - \projLtwoisol w} \lesssim  h \norm{L^2}{f} ,
\end{equation}
%
where the constant is independent of $h$ and $\kappa$.
\end{assumption}

The most prominent example that fulfills Assumption \ref{ass:FEM_space} are linear Lagrange finite element spaces which are discussed at the end of this section. Property (a) is obvious and to verify property (b), one first replaces $\norm{L^2}{f}$ by $\Htwokappa{w}$, and uses (for a convex domain $\Omega$) $H^2$-regularity. We give the details below.
%
Another, non-trivial example of generalized finite elements spaces is presented in Section~\ref{sec:lod}.
%

Recall that we want to minimize the functional $\energy$ from \eqref{eq:energy_functional_times_kappa2} over $\VSh$, i.e.,
%
\begin{equation} \label{eq:energy_functional_discrete}
	\energy(\solh) = \inf\limits_{\testfunh \in \VSh }
	\energy(\testfunh),\qquad \energy(\testfunh)  = \frac12 \int_\Omega |\nabla \testfunh + \ci \kappa \MagF \testfunh |^2 + \frac{\kappa^2}{2}  \bigl( 1- |\testfunh|^2 \bigr)^2\,dx .
\end{equation}
%
Note that since $\VSh$ is finite dimensional, the existence of a minimizer $\solh$
is always guaranteed.
%
Our first result shows bounds on the discrete minimizer $\solh$ in different norms and the corresponding energy, which are independent of $\h$ and behave in the parameter $\kappa$ the same way as the exact minimizer $\sol$ studied in Theorem~\ref{thm:cont_minimizer}. The proof is postponed to Section~\ref{sec:proofs}.

\begin{lemma} \label{lem:bound_general_uH}
	For all $\h>0$ let $\solh$ be a minimizer of \eqref{eq:energy_functional_discrete}.
	Then
	there hold the bounds
	%
	\begin{equation}
		\energy(\solh) \lesssim   \kappa^2
		\qquad 
		\norm{L^2}{\solh} \lesssim 1,
		\qquad
		\norm{L^2}{\nabla \solh}  \lesssim   \kappa,
		 \qquad
		\Honekappa{\solh} \lesssim  \kappa ,
	\end{equation}
	%
	where the hidden constants are independent of $\h$ and $\kappa$.
\end{lemma}

Our main findings are collected in the following theorem. 
We provide error bounds for the discrete minimizers which are explicit in the parameter $\kappa$ and the mesh width $\h$.
%
In addition, we show that the error behaves as the quasi-best approximation of $\Honeperp$ in $\VShperp$.


\begin{theorem} \label{thm:main}
Let Assumption~\ref{ass:cinfsup} and \ref{ass:FEM_space} hold, and let $\h \leq \h_0$ be sufficiently small such that in particular $\kappa \Csol \h$	is small. Then, there is neighborhood $\Nbh \subset H^1(\Omega)$ of
each discrete minimizer $\solh$ of \eqref{eq:energy_functional_discrete} such that there is a unique minimizer $\sol \in \Nbh$ of \eqref{eq:energy_functional_times_kappa2} with 
%
\begin{equation}
	\ipsymLtwo{\solh}{\ci \sol} = 0,
\end{equation}
%
and we have the error bounds
%
\begin{align}
	\Honekappa{ \sol - \solh}  &\lesssim 
	(1 + \kappa \Csol \h)
	\inf_{\testfunh \in \VShperp}	\Honekappa{\sol- \testfunh }, 
	\\  
	%
	\norm{L^2}{ \sol - \solh}  &\lesssim 
	\h \, \Csol \,
	(1 + \kappa \Csol \h)
	 \inf_{\testfunh \in \VShperp}	\Honekappa{\sol- \testfunh }  ,
\end{align}
%
%
as well as the following estimate on the error in the energy 
%
\begin{align}
	0\leq 	\energy(\solh) - \energy(\sol) 
	&\lesssim \Honekappa{\sol -\solh}^2 \,
	\bigl( 
	1
	+
	\kappa^{1/2} \Honekappa{\sol -\solh}
	+
	\kappa \Honekappa{\sol -\solh}^2 \bigr),
\end{align}
%
where the hidden constants are independent of $\kappa$, $\Csol$, and $\h$.
\end{theorem}

The proof is divided in several steps which are outlined in detail in Section~\ref{sec:proofs}.
%
The first application of the results are Lagrangian finite elements.
%
In the following, we denote by $\Th$ a conforming family of partitions of the domain $\Omega$ consisting of simplical elements $K$. For the space $\Pone(K)$ of complex-valued polynomials of degree less than or equal to $1$ on $K$, we consider the finite element space
%
\begin{equation} \label{eq:defVh}
	\VSh \coloneqq \{ \testfunh  \in H^1(\Omega) \mid   \testfunh |_K \in \Pone(K) 
	\text{  for all  } 
	K \in \Th \} .
\end{equation}
%
We assume that the partition $\Th$ is shape-regular and
%
the $L^2$-projection,  defined via $	\ipsymLtwo{\Ltwoproj v}{\testfunh} = \ipsymLtwo{ v}{\testfunh}$ for all $\testfunh \in \VSh$, is $H^1$-stable, i.e.,
%
\begin{equation} \label{eq:H1_stab_L2_proj}
	\norm{H^1}{ \Ltwoproj \testfun} \lesssim \norm{H^1}{\testfun} ,
\end{equation}
%
with a constant  independent of $\h$. This condition is always fulfilled for quasi-uniform triangulations, but is also valid for certain adaptively refined meshes.
%
For a detailed discussion on criteria when \eqref{eq:H1_stab_L2_proj} holds, we refer to \cite{BanY14,DieST21}.
%
In this setting, we obtain convergence rates which are explicit in the parameter $\kappa$ and the mesh width $\h$.

\begin{corollary} \label{cor:main_Lagrange}
Let the conditions of Theorem~\ref{thm:main} hold, and assume in addition that $\Omega$ is convex.
For Lagrangian finite elements which satisfy \eqref{eq:H1_stab_L2_proj}, the error bounds in Theorem~\ref{thm:main}
	can be further estimated by
	%
	\begin{align}
		\Honekappa{ \sol - \solh}  \lesssim \kappa^2 \h
		\qquad
		\text{and}
		\qquad
		\norm{L^2(\Omega)}{ \sol - \solh}  \lesssim  \Csol \kappa^2 \h^2 ,
	\end{align}
%
	where the hidden constants are independent of $\kappa$, $\Csol$, and $\h$.
\end{corollary}

The proof is presented in Section~\ref{sec:proofs}.



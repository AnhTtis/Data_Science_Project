\section{Numerical experiments}
\label{sec:num_exp}

Before we present the proof of our main result, we illustrate our theoretical findings with some numerical examples confirming the rates and the $\kappa$-dependence in our error bounds.



\subsection{Implementation}

For the discretization in space with linear Lagrange finite elements, we use the open source Python tool FEniCS \cite[version 2018.1.0]{Fenics}. 
%
 To compute a discrete minimizer, we applied a steepest descent approach
using an implicit Euler method for the $L^2$ gradient flow. 
A direct application yields the following nonlinear iteration
%
\begin{align}
	\ipsymLtwo{\solh^{n+1}}{ \testfunh } = \ipsymLtwo{\solh^{n}}{ \testfunh } - \tau \, \dualp{\energy'(\solh^{n+1})}{\testfunh} ,
\end{align}
%
where $\tau>0$ is some parameter. To avoid the solution of nonlinear systems several times, we replace $\energy'(u^{n+1})$ by the linearization
%
\begin{align}
	\dualp{\energy'(\solh^{n+1})}{\testfunh} \to  \abilmag{\solh^{n+1}}{\testfunh} + \kappa^2 \Real \int_\Omega (|\solh^{n}|^2 - 1) \solh^{n+1} \testfunh^* \,dx,
\end{align}
%
and thus have to solve the following linear system for $\solh^{n+1} \in \VSh$
%
\begin{align}
	\ipsymLtwo{\solh^{n+1}}{ \testfunh } 
	+ 
	\tau \, \abilmag{\solh^{n+1}}{\testfunh} 
	+
	 \tau \, \kappa^2 \Real \int_\Omega (|\solh^{n}|^2 - 1) \solh^{n+1} \testfunh^* \,dx
	  = 
	  \ipsymLtwo{\solh^{n}}{ \testfunh }
\end{align}
for all $\testfunh \in \VSh$.
%
In our experiments, we  set $\Omega = [0,1] \times [0,1] \subset \R^2$,
and use the initial value $\sol_0 = 0.8 + 0.6 \ci$. The magnetic potential is chosen as
%
\begin{equation}
	\MagF(x,y) :=  \sqrt{2} \begin{pmatrix}
		\sin(\pi x) \cos(\pi y) \\ -  \cos(\pi x) \sin(\pi y)
	\end{pmatrix} , 
\end{equation}
%
and satisfies the assumptions in \eqref{eq:ass_\MagF_for_H2}.
%
Further, we set $\tau = \kappa^{-2}$, and used the stopping criterion
%
$ \kappa^{-2} | \energy(\solh^{n+1}) - \energy(\solh^{n})| < \delta $
for a tolerance $\delta = 10^{-10}$. 
%
The code to reproduce the results presented in this paper is available at \url{\mycode}.

\subsection{Numerical results}

We first illustrate the convergence in the spatial parameter $\h$ for different values of $\kappa$.
To this end, we computed a reference solution on a finer grid using $\h_{\text{max}} \sim  2.5 \cdot 10^{-3}$. 
In order to compare the results for different values of $\kappa$, we divide the error in the $\HonekappaSpace$- and $L^2$-norm by $\kappa^2$
and the energy by $\kappa^4$, see Figure~\ref{fig:convergence}. Here we recall that according to Corollary~\ref{cor:main_Lagrange} we expect the $\HonekappaSpace$-error to convergence with the rate $\kappa^2 \h$, the $L^2$-error with the rate $\kappa^2 \h^2$ and the energy-error with the rate $\kappa^4 \h^2$. 
%
Indeed, we observe the predicted convergence in $\h$ and, in particular, the numerical experiments confirm the $\kappa$-scaling in our error estimates. The plot further indicates that the constants in front of the normalized errors are independent of $\kappa$.

\begin{figure}
	\centering
     \begin{subfigure}{0.3\textwidth}
  			\resizebox{1.0\textwidth}{!}{\input{error_plot_H1.tex}}	
%    		\caption{Error}
     	\end{subfigure}
     \hfill
          \begin{subfigure}{0.3\textwidth}
      \resizebox{1.0\textwidth}{!}{\input{error_plot_L2.tex}}	
     \end{subfigure}
 \hfill
      \begin{subfigure}{0.3\textwidth}
    \resizebox{1.0\textwidth}{!}{\input{error_plot_energy.tex}}	
 \end{subfigure}
%
\ref{Legendforall}
%
\caption{Convergence in the mesh size $\h$ for $\kappa$-weighted errors
	in the $\HonekappaSpace$- and $L^2$-norm and for the energy,
	for $\kappa = 8,12,24$. The errors in $L^2$ and $\HonekappaSpace$ are scaled by $\kappa^{-2}$ and the error in energy by $\kappa^{-4}$.
	The dashed lines indicate order $\mathcal{O}(\h)$ in the left figure, and 
	order $\mathcal{O}(\h^2)$ in the center and right figure.
}
\label{fig:convergence}
\end{figure}


Let us also note that for larger values of $\kappa$, we observe a preasymptotic behavior in $\h$. We expect that this is related to the smallness condition for $\kappa \Csol \h$ stated in the theorem, which is required below in Lemma~\ref{lem:du_F_inf_sup_solvability_discrete} for the discrete inf-sup stability. Since beyond the (numerically observed) threshold $\kappa h < 1$, the errors coincide for all values of $\kappa$, this is still in alignment with our theory. 

In our second experiment, we first computed for $\kappa = 20$
the discrete minimizers for different values of 
$h \approx 8\cdot 10^{-2}, 4\cdot 10^{-2}, 2\cdot 10^{-2}, 1 \cdot 10^{-2} $ ,
see Figure~\ref{fig:diff_solutions_in_h}.
%
We observe that the number of vortices remains constant on the different discretization levels, but 
the minimizer is rotated by $\frac{\pi}{2}$. A simple calculation show that by our choice of $\MagF$ this rotation of the coordinate system leaves the energy invariant. In particular, this illustrates that the density $|u|^2$ of minimizers is not necessarily unique and that convergence of discrete minimizers can only be expected up to a subsequence, even for a fixed gauge condition.
%
On the other hand, we plotted the minimizers for different values of $\kappa=8,14,16,24$, see Figure~\ref{fig:diff_solutions}.
%
We observe that the number of vortices increases with larger values of $\kappa$, which is in agreement with analytical results \cite{Aftalion99,SaS07}.

\begin{figure}[t!]
	\centering
	\begin{subfigure}{0.2\textwidth}
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_20_h3.png}		
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.2\textwidth}
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_20_h4.png}	
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.2\textwidth}
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_20_h5.png}	
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.2\textwidth}
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_20_h6.png}
	\end{subfigure}

	\caption{Minimizers for the Ginzburg--Landau parameter $\kappa =20$ and different mesh widths 
		$h \approx 8\cdot 10^{-2}, 4\cdot 10^{-2}, 2\cdot 10^{-2}, 1 \cdot 10^{-2} $ 
		(from left to right).}
	\label{fig:diff_solutions_in_h}
\end{figure}


\begin{figure}[t!]
	\centering
	\begin{subfigure}{0.2\textwidth}
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_8_h8.png}	
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.2\textwidth}	
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_14_h8.png}	
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.2\textwidth}
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_16_h8.png}		
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.2\textwidth}
		\includegraphics[width=1.4\textwidth]{plot_sol_kappa_24_h8.png}
	\end{subfigure}
	\caption{Different minimizers corresponding to the Ginzburg--Landau parameters $\kappa = 8,14,16,24$ (from left to right) for $\h \approx 2.5 \cdot 10^{-3}$.
	}
	\label{fig:diff_solutions}
\end{figure}